<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Brief Bioinform</journal-id>
    <journal-id journal-id-type="iso-abbrev">Brief Bioinform</journal-id>
    <journal-id journal-id-type="publisher-id">bib</journal-id>
    <journal-title-group>
      <journal-title>Briefings in Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1467-5463</issn>
    <issn pub-type="epub">1477-4054</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10703497</article-id>
    <article-id pub-id-type="pmid">38061196</article-id>
    <article-id pub-id-type="doi">10.1093/bib/bbad449</article-id>
    <article-id pub-id-type="publisher-id">bbad449</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Problem Solving Protocol</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CellTICS: an explainable neural network for cell-type identification and interpretation based on single-cell RNA-seq data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Yin</surname>
          <given-names>Qingyang</given-names>
        </name>
        <aff><institution>Department of Quantitative and Computational Biology, University of Southern California</institution>, <addr-line>1050 Childs Way, Los Angeles, CA 90089</addr-line>, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Chen</surname>
          <given-names>Liang</given-names>
        </name>
        <!--liang.chen@usc.edu-->
        <aff><institution>Department of Quantitative and Computational Biology, University of Southern California</institution>, <addr-line>1050 Childs Way, Los Angeles, CA 90089</addr-line>, <country country="US">United States</country></aff>
        <xref rid="cor1" ref-type="corresp"/>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="cor1">Corresponding author: Liang Chen. Email: <email>liang.chen@usc.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>1</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-12-07">
      <day>07</day>
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>07</day>
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <volume>25</volume>
    <issue>1</issue>
    <elocation-id>bbad449</elocation-id>
    <history>
      <date date-type="received">
        <day>27</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>30</day>
        <month>10</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>11</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="bbad449.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Identifying cell types is crucial for understanding the functional units of an organism. Machine learning has shown promising performance in identifying cell types, but many existing methods lack biological significance due to poor interpretability. However, it is of the utmost importance to understand what makes cells share the same function and form a specific cell type, motivating us to propose a biologically interpretable method. CellTICS prioritizes marker genes with cell-type-specific expression, using a hierarchy of biological pathways for neural network construction, and applying a multi-predictive-layer strategy to predict cell and sub-cell types. CellTICS usually outperforms existing methods in prediction accuracy. Moreover, CellTICS can reveal pathways that define a cell type or a cell type under specific physiological conditions, such as disease or aging. The nonlinear nature of neural networks enables us to identify many novel pathways. Interestingly, some of the pathways identified by CellTICS exhibit differential expression “variability” rather than differential expression across cell types, indicating that expression stochasticity within a pathway could be an important feature characteristic of a cell type. Overall, CellTICS provides a biologically interpretable method for identifying and characterizing cell types, shedding light on the underlying pathways that define cellular heterogeneity and its role in organismal function. CellTICS is available at <ext-link xlink:href="https://github.com/qyyin0516/CellTICS" ext-link-type="uri">https://github.com/qyyin0516/CellTICS</ext-link>.</p>
    </abstract>
    <kwd-group>
      <kwd>explainable neural network</kwd>
      <kwd>cell type identification</kwd>
      <kwd>pathways</kwd>
      <kwd>scRNA-seq data</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>R01GM137428</award-id>
        <award-id>R01NS104041</award-id>
        <award-id>R01NS125276</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="12"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="sec1">
    <title>INTRODUCTION</title>
    <p>Single-cell RNA-sequencing (scRNA-seq) provides expression profiles of individual cells and molecularly defines cell states or phenotypes [<xref rid="ref1" ref-type="bibr">1</xref>]. It also has the potential to identify cell types, which are functional units of an organism and crucial to other downstream research investigations. Recently, machine learning has been widely applied to identifying cell types. Typically, a machine-learning model is built using a reference dataset with well-curated cell-type labels. Then, the model is applied to the query dataset to predict its cell types. Deep learning has consistently shown promising performances in cell-type identification for various architectures and the customization of hyperparameters [<xref rid="ref2" ref-type="bibr">2</xref>]. Numerous neural network architectures have contributed to these achievements, including artificial neural networks [<xref rid="ref3" ref-type="bibr">3</xref>, <xref rid="ref4" ref-type="bibr">4</xref>], convolutional neural networks [<xref rid="ref5" ref-type="bibr">5</xref>, <xref rid="ref6" ref-type="bibr">6</xref>], graph-based networks [<xref rid="ref7" ref-type="bibr">7</xref>, <xref rid="ref8" ref-type="bibr">8</xref>], generative models (autoencoders or generative adversarial networks) [<xref rid="ref9" ref-type="bibr">9–11</xref>] and attention-based models (transformers) [<xref rid="ref12" ref-type="bibr">12</xref>, <xref rid="ref13" ref-type="bibr">13</xref>]. Moreover, recent advances in multimodal learning show its immense potential in bioinformatics [<xref rid="ref14" ref-type="bibr">14</xref>, <xref rid="ref15" ref-type="bibr">15</xref>]. However, these deep learning-based models are usually black-box models, lacking interpretability. Moreover, predicting at the sub-cell-type level has always been more challenging, even though it provides higher resolution and can unveil valuable insights into cell heterogeneity [<xref rid="ref16" ref-type="bibr">16</xref>]. Motivated by existing limitations, this study aims to address both the aspects of biological interpretability and sub-cell-level prediction.</p>
    <p>In the field of computational biology, interpretable neural networks are constructed using prior biological knowledge, such as gene ontology and pathway information, to improve the interpretability of deep learning. For instance, DrugCell [<xref rid="ref17" ref-type="bibr">17</xref>] uses a visible neural network that predicts anti-cancer drug responses by leveraging biological process information from the Gene Ontology (GO) database [<xref rid="ref18" ref-type="bibr">18</xref>]. P-NET [<xref rid="ref19" ref-type="bibr">19</xref>] is a biologically informed deep-learning model for prostate cancer discovery. Liu et al. [<xref rid="ref20" ref-type="bibr">20</xref>] introduced an interpretable deep neural network that faithfully captures the underlying chemical mechanism of transcription factor binding to DNA. CancerIDP [<xref rid="ref21" ref-type="bibr">21</xref>] is an interpretable neural network that predicts cancer patients’ survival based on drug prescriptions and personal transcriptomes. In these models, neurons are imbued with biological meaning (GO terms, pathways, etc.), and certain automatic computational procedures, like DeepLIFT [<xref rid="ref22" ref-type="bibr">22</xref>], are employed to evaluate the significance of these neurons. Hence, these models significantly enhance human understanding of hidden mechanisms [<xref rid="ref23" ref-type="bibr">23</xref>] and have shown remarkable success in both predicting classification labels and explaining results. Nevertheless, there are few studies that focus on the application of interpretable neural networks for cell type annotation and the interpretation of the factors that define a cell type.</p>
    <p>Inspired by the success of interpretable neural networks, this study presents <bold>CellTICS</bold> (<bold>Cell</bold>-<bold>T</bold>ype <bold>I</bold>dentifi<bold>C</bold>ation based on <bold>S</bold>cRNA-seq), a biologically explainable neural network for cell-type identification and interpretation based on single-cell RNA-seq data. In CellTICS, marker genes are prioritized as interpretable features. The network architecture of CellTICS follows the hierarchy of pathways acquired from the Reactome database [<xref rid="ref24" ref-type="bibr">24</xref>] and adopts a two-stage strategy to predict cell and sub-cell types. What sets CellTICS apart is its innovative approach of utilizing multiple prediction layers to aggregate information from various pathway levels. This unique multi-predictive-layer strategy greatly enhances the accuracy of the pathway-guided encoder’s predictions. The superior classification performance of CellTICS is demonstrated by applying it to several public datasets and comparing it with other cell-type annotation methods. More importantly, the interpretability of CellTICS provides clues about which pathway characteristics are essential to define a cell type or a cell type under a specific physiological condition. This information is often missed by traditional methods, making CellTICS a valuable tool for understanding the biology of cellular heterogeneity.</p>
    <p>The remaining sections of this article are organized as follows. In the “<xref rid="sec2" ref-type="sec">2</xref> Material and methods” section, an overview of the utilized datasets is provided, followed by a detailed explanation of the CellTICS model and its associated parameters, and the description of other methods used for comparison along with the evaluation criteria. In the “<xref rid="sec3" ref-type="sec">3</xref> Results and discussions” section, a comprehensive discussion of the results and innovative aspects of this work is undertaken. It commences with the presentation of cell-type and sub-cell-type annotation results. Following that, CellTICS’s capability to uncover novel pathways and their characteristics related to expression stochasticity are explored. Its application in the context of the aging process and autism spectrum disorder (ASD) is also examined. Finally, in the “<xref rid="sec4" ref-type="sec">4</xref> Conclusion” section, the study is drawn to a close by summarizing the key findings and insights derived from our research.</p>
  </sec>
  <sec id="sec2">
    <title>MATERIALS AND METHODS</title>
    <p>The schematic pipeline of CellTICS is shown in <xref rid="f1" ref-type="fig">Figure 1</xref>. In CellTICS, marker genes are selected based on their expression levels in the training set. The neural network is constructed as the hierarchy of Reactome pathways. A two-stage deep learning strategy is employed to predict both cell types and sub-cell types. In the first stage, a feedforward neural network is trained for cell-type prediction, with a predictive layer corresponding to each pathway hidden layer. Subsequently, in the second stage, multiple sub-neural networks are trained for sub-cell-type prediction, building upon the predicted outcomes from the first stage. Each sub-neural network is also equipped with multiple predictive layers for hidden layers. At each stage, prediction results from all predictive layers are aggregated through a voting mechanism. Furthermore, during the training procedure, important pathways that contribute to (sub-)cell-type prediction can be identified by comparing the activation values of neural networks corresponding to cells belonging to different cell types. More details are as follows.</p>
    <fig position="float" id="f1">
      <label>Figure 1</label>
      <caption>
        <p><bold>The pipeline of CellTICS.</bold> (<bold>A</bold>) Marker genes are prioritized by considering their cell-type-specific high and low expression measures. (<bold>B</bold>) The Reactome pathways are used to construct the network hierarchy. (<bold>C</bold>) A neural network constructed by the pathway hierarchy is trained and then used to predict cell types of the test set. The predicted results from all predictive layers are integrated by voting. (<bold>D</bold>) Based on the predicted results of the first stage, several sub-neural networks are trained for sub-cell-type prediction. Important pathways defining a cell type (or a sub-cell type) can be obtained by comparing their activation values across different cell types.</p>
      </caption>
      <graphic xlink:href="bbad449f1" position="float"/>
    </fig>
    <sec id="sec2a">
      <title>Datasets</title>
      <p>The capabilities of CellTICS were showcased using scRNA-seq data from three mouse brain studies [<xref rid="ref25" ref-type="bibr">25–27</xref>] and two human studies [<xref rid="ref28" ref-type="bibr">28</xref>, <xref rid="ref29" ref-type="bibr">29</xref>]. Its predictive accuracy was evaluated across a total of 10 analysis tasks, including both intra-dataset and inter-dataset predictions (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). The entire process of the data processing and handling is illustrated in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1</xref>.</p>
      <sec id="sec2a1">
        <title>Raw scRNA-seq data processing</title>
        <p>The detailed datasets used in this study included the level-5 mouse brain data (L5MB), DropViz hippocampus (DropViz HC), DropViz frontal cortex (DropViz FC), and human peripheral blood mononuclear (PBMC) data, all of which were initially in raw read count format. In contrast, the aging mouse brain (AMB) and autism spectrum disorder (ASD) data were first scaled to 10,000 transcripts per cell and then subjected to logarithmically transformed. As a result, a normalization step was necessary for the L5MB, DropViz HC, DropViz FC, and PBMC data.</p>
        <p>Let us denote <inline-formula><tex-math notation="LaTeX" id="ImEquation1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$expr_{c,g}$\end{document}</tex-math></inline-formula> as the normalized expression measure for gene <inline-formula><tex-math notation="LaTeX" id="ImEquation2">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$g$\end{document}</tex-math></inline-formula> in cell <inline-formula><tex-math notation="LaTeX" id="ImEquation3">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$c$\end{document}</tex-math></inline-formula>. The normalization is performed as Equation <xref rid="deqn01" ref-type="disp-formula">1</xref>, where <inline-formula><tex-math notation="LaTeX" id="ImEquation4">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$m_{c,g}$\end{document}</tex-math></inline-formula> is the gene-level read count (UMI-based), and <inline-formula><tex-math notation="LaTeX" id="ImEquation5">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$G$\end{document}</tex-math></inline-formula> is the total number of genes. Subsequently, quality control for all data was performed by the R package scater [<xref rid="ref30" ref-type="bibr">30</xref>], filtering out cells and genes with poor quality. </p>
        <disp-formula id="deqn01">
          <label>(1)</label>
          <tex-math notation="LaTeX" id="DmEquation1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*}&amp; expr_{c,g}=log_{2}\left(10000\frac{m_{c,g}}{\sum_{g^{\prime}=1}^{G}m_{c,g^{\prime}}}+1\right)\end{align*}\end{document}</tex-math>
        </disp-formula>
      </sec>
      <sec id="sec2a2">
        <title>Training sets and test sets preparation</title>
        <p>The L5MB, DropViz HC and DropViz FC datasets contained information on cell types and sub-cell types. To represent intra-dataset predictions, these datasets were split into a training set and a test set using the R package caret [<xref rid="ref31" ref-type="bibr">31</xref>] with 75% of the original data allocated to the training set, stratified by cell types.</p>
        <p>The AMB data contained mouse brain cells for the young and old age groups as well as their cell types and sub-cell types. We created three analysis tasks based on the data. The first one was the original whole dataset (AMB whole), incorporating age status into the cell-type labels to create our own sub-cell-type labels (e.g. old-cell-type-A versus young-cell-type-A). Next, the AMB whole dataset was split into a training set and a test set with 75% of the original data allocated to the training set, stratified by cell types. The other two analysis tasks were designed for inter-dataset prediction for both cell types and original sub-cell types. Specifically, the old data were treated as the training set and the young data as the test set (AMB OY), or vice versa (AMB YO).</p>
        <p>The PBMC data were sequenced by the 10X Genomics v2 (10Xv2), the 10X Genomics v3 (10Xv3) and the Drop-seq protocols. The three major cell type groups were lymphoid cells (including sub-cell types: B cells, CD4 T cells, cytotoxic T cells and natural killer cells), myeloid cells (including sub-cell types: CD14+ monocytes, CD16+ monocytes, dendritic cells and plasmacytoid dendritic cells) and megakaryocytes [<xref rid="ref32" ref-type="bibr">32</xref>]. Based on the PBMC data, three analysis tasks were created to test the cross-protocol prediction, a special case of inter-dataset prediction. Firstly, the 10Xv3 data were used as the training set, and the 10Xv2 data were the test set (PBMC 32). Secondly, the 10Xv2 data were the training set, and the Drop-seq data were the test set (PBMC 2D). Lastly, the Drop-seq data were the training set, and the 10Xv3 data were the test set (PBMC D3).</p>
        <p>The ASD data contained human brain data for the ASD and control groups. To explore the mechanism of ASD at the cell-type level, this work incorporated the disease status into the cell-type labels to create the sub-cell-type labels (e.g. ASD-cell-type-A versus control-cell-type-A). This study focused exclusively on 11 neuron cell types, namely L2/3, L4, L5/6, L5/6-CC, IN-PV, IN-SST, IN-SV2C, IN-VIP, Neu-mat, Neu-NRGN-I and Neu-NRGN-II. Subsequently, the dataset was split into a training set and a test set with 75% of the original data allocated to the training set, stratified by cell types. The processed data were written into CSV files and uploaded to Zenodo (see ‘Code and Data Availability’). The CSV file sizes have also been included in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>.</p>
      </sec>
    </sec>
    <sec id="sec2d">
      <title>The CellTICS model</title>
      <sec id="sec2d1">
        <title>Marker gene prioritization</title>
        <p>A feature selection step was performed to prioritize marker genes, which could help enhance the prediction performance of the CellTICS model. The cell-type-specific high expression measure for a gene <inline-formula><tex-math notation="LaTeX" id="ImEquation6">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$g$\end{document}</tex-math></inline-formula> in cell type <inline-formula><tex-math notation="LaTeX" id="ImEquation7">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$t$\end{document}</tex-math></inline-formula> is defined as Equation <xref rid="deqn02" ref-type="disp-formula">2</xref>, where <inline-formula><tex-math notation="LaTeX" id="ImEquation8">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\tau _{g}$\end{document}</tex-math></inline-formula>, <inline-formula><tex-math notation="LaTeX" id="ImEquation9">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\hat{x}_{t,g}$\end{document}</tex-math></inline-formula> are determined by Equation <xref rid="deqn03" ref-type="disp-formula">3</xref> and Equation <xref rid="deqn04" ref-type="disp-formula">4</xref>. Here, <inline-formula><tex-math notation="LaTeX" id="ImEquation10">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$n$\end{document}</tex-math></inline-formula> is the total number of cell types, and <inline-formula><tex-math notation="LaTeX" id="ImEquation11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$expr_{t,g}$\end{document}</tex-math></inline-formula> is the normalized expression measure for the gene in cell type <inline-formula><tex-math notation="LaTeX" id="ImEquation12">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$t$\end{document}</tex-math></inline-formula>. Pseudo number 1 is added to avoid extremely large fold changes among lowly expressed genes. Thus, <inline-formula><tex-math notation="LaTeX" id="ImEquation13">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$0\leq \varphi _{t,g}\leq 1$\end{document}</tex-math></inline-formula>. The cell-type-specificity measure is a modification of the tissue-specificity measure proposed by Jiang et al. [<xref rid="ref33" ref-type="bibr">33</xref>]. A larger <inline-formula><tex-math notation="LaTeX" id="ImEquation14">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\varphi _{t,g}$\end{document}</tex-math></inline-formula> value suggests that the gene is specifically highly expressed in this cell type. For the cell type with the maximum expression, <inline-formula><tex-math notation="LaTeX" id="ImEquation15">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\varphi _{t,g}=\tau _{g}$\end{document}</tex-math></inline-formula>, otherwise <inline-formula><tex-math notation="LaTeX" id="ImEquation16">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\varphi _{t,g}&lt;\tau _{g}$\end{document}</tex-math></inline-formula>. </p>
        <disp-formula id="deqn02">
          <label>(2)</label>
          <tex-math notation="LaTeX" id="DmEquation2">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*} &amp; \varphi_{t,g}=\tau_{g}\hat{x}_{t,g} \end{align*}\end{document}</tex-math>
        </disp-formula>
        <disp-formula id="deqn03">
          <label>(3)</label>
          <tex-math notation="LaTeX" id="DmEquation3">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*} &amp; \tau_{g}=\frac{\sum_{t=1}^{n}(1-\hat{x}_{t,g})}{n-1} \end{align*}\end{document}</tex-math>
        </disp-formula>
        <disp-formula id="deqn04">
          <label>(4)</label>
          <tex-math notation="LaTeX" id="DmEquation4">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*} &amp; \hat{x}_{t,g}=\frac{expr_{t,g}+1}{\max_{1\leq t^{\prime}\leq n}expr_{t^{\prime},g}+1} \end{align*}\end{document}</tex-math>
        </disp-formula>
        <p>Similarly, the cell-type-specific low expression measure for a gene <inline-formula><tex-math notation="LaTeX" id="ImEquation17">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$g$\end{document}</tex-math></inline-formula> in cell type <inline-formula><tex-math notation="LaTeX" id="ImEquation18">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$t$\end{document}</tex-math></inline-formula> is defined as Equation <xref rid="deqn05" ref-type="disp-formula">5</xref>, where <inline-formula><tex-math notation="LaTeX" id="ImEquation19">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\omega _{g}$\end{document}</tex-math></inline-formula>, <inline-formula><tex-math notation="LaTeX" id="ImEquation20">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\hat{z}_{t,g}$\end{document}</tex-math></inline-formula> are determined by Equation <xref rid="deqn06" ref-type="disp-formula">6</xref> and Equation <xref rid="deqn07" ref-type="disp-formula">7</xref>. Thus, <inline-formula><tex-math notation="LaTeX" id="ImEquation21">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$0\leq \rho _{t,g}\leq 1$\end{document}</tex-math></inline-formula>. A larger <inline-formula><tex-math notation="LaTeX" id="ImEquation22">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\rho _{t,g}$\end{document}</tex-math></inline-formula> value suggests that the gene is specifically lowly expressed in this cell type. </p>
        <disp-formula id="deqn05">
          <label>(5)</label>
          <tex-math notation="LaTeX" id="DmEquation5">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*} &amp; \rho_{t,g}=\omega_{g}\hat{z}_{t,g} \end{align*}\end{document}</tex-math>
        </disp-formula>
        <disp-formula id="deqn06">
          <label>(6)</label>
          <tex-math notation="LaTeX" id="DmEquation6">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*} &amp; \omega_{g}=\frac{\sum_{t=1}^{n}(1-\hat{z}_{t,g})}{n-1} \end{align*}\end{document}</tex-math>
        </disp-formula>
        <disp-formula id="deqn07">
          <label>(7)</label>
          <tex-math notation="LaTeX" id="DmEquation7">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*} &amp; \hat{z}_{t,g}=\frac{\min_{1\leq t^{\prime}\leq n}expr_{t^{\prime},g}+1}{expr_{t,g}+1} \end{align*}\end{document}</tex-math>
        </disp-formula>
        <p>To select cell-type-specific highly expressed or lowly expressed genes, for a gene <inline-formula><tex-math notation="LaTeX" id="ImEquation23">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$g$\end{document}</tex-math></inline-formula> in cell type <inline-formula><tex-math notation="LaTeX" id="ImEquation24">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$t$\end{document}</tex-math></inline-formula>, if <inline-formula><tex-math notation="LaTeX" id="ImEquation25">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\varphi _{t,g}$\end{document}</tex-math></inline-formula> was greater than the <inline-formula><tex-math notation="LaTeX" id="ImEquation26">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$100\alpha $\end{document}</tex-math></inline-formula>th quantile of <inline-formula><tex-math notation="LaTeX" id="ImEquation27">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\varphi $\end{document}</tex-math></inline-formula> in cell type <inline-formula><tex-math notation="LaTeX" id="ImEquation28">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$t$\end{document}</tex-math></inline-formula>, the gene would be selected as a marker gene for the cell type. Similarly, for another gene <inline-formula><tex-math notation="LaTeX" id="ImEquation29">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$g^{\prime}$\end{document}</tex-math></inline-formula> in cell type <inline-formula><tex-math notation="LaTeX" id="ImEquation30">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$t^{\prime}$\end{document}</tex-math></inline-formula>, if <inline-formula><tex-math notation="LaTeX" id="ImEquation31">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\rho _{t^{\prime},g^{\prime}}$\end{document}</tex-math></inline-formula> was greater than the <inline-formula><tex-math notation="LaTeX" id="ImEquation32">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$100\beta $\end{document}</tex-math></inline-formula>th quantile of <inline-formula><tex-math notation="LaTeX" id="ImEquation33">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\rho $\end{document}</tex-math></inline-formula> in cell type <inline-formula><tex-math notation="LaTeX" id="ImEquation34">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$t^{\prime}$\end{document}</tex-math></inline-formula>, the gene would be also selected as a marker gene for the cell type. All marker genes from all cell types were combined as the result of the feature selection step. These marker genes were used to compress both the training set and the test set.</p>
      </sec>
      <sec id="sec2d2">
        <title>Pathway hierarchy</title>
        <p>All levels of the pathway hierarchy were acquired from the Reactome database, which could be represented as a tree. The pathway hierarchies for mice, humans, and rats were available in CellTICS. The tree was composed of internal nodes representing hierarchical pathways and leaves representing genes. Pathways at the highest level were connected to the root node, and edges and nodes not related to the selected marker genes were excluded. To formally formulate the network, the parameter <inline-formula><tex-math notation="LaTeX" id="ImEquation35">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$l$\end{document}</tex-math></inline-formula> was introduced to specify the number of considered levels (i.e. the number of hidden layers of the neural network). When <inline-formula><tex-math notation="LaTeX" id="ImEquation36">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$l$\end{document}</tex-math></inline-formula> was specified, a subtree of the original tree could be constructed. If the upper depth of a leaf was larger than <inline-formula><tex-math notation="LaTeX" id="ImEquation37">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$l$\end{document}</tex-math></inline-formula>, the excessive parental level(s) of the leave would be excluded and the leaf would be connected to upper-level pathways. If the upper depth of a leaf was smaller than <inline-formula><tex-math notation="LaTeX" id="ImEquation38">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$l$\end{document}</tex-math></inline-formula>, artificial nodes would be added to represent the parents of the leaf. From the subtree, a binary mask matrix <inline-formula><tex-math notation="LaTeX" id="ImEquation39">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$M$\end{document}</tex-math></inline-formula> was generated to suggest the connectivity of two entities in adjacent layers. If the two entities had no connection, the corresponding entry in <inline-formula><tex-math notation="LaTeX" id="ImEquation40">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$M$\end{document}</tex-math></inline-formula> was 0; otherwise, it would be 1.</p>
      </sec>
      <sec id="sec2d3">
        <title>Neural network construction</title>
        <p>A feedforward neural network was constructed based on the mask matrix. We first trained the network for cell-type prediction and then trained several sub-neural networks for sub-cell-type prediction. Thus, after obtaining the predicted cell types for the test set, the test set was divided into subsets based on these predictions, and similarly, the training set was separated based on the true cell types. Then, sub-cell-type prediction was performed for each cell type.</p>
        <p>The detailed architecture of the CellTICS neural network is shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2</xref>. In the neural network, each node represents an entity such as a gene, pathway, or cell type, and each edge represents the relationship between the entities connected by the edge. The input layer comprises a set of genes. The input data are the expression level of these genes, whose dimension is the number of genes assigned to the bottom pathway level. For each layer, the input is denoted as <inline-formula><tex-math notation="LaTeX" id="ImEquation41">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$x$\end{document}</tex-math></inline-formula> and the output is denoted as <inline-formula><tex-math notation="LaTeX" id="ImEquation42">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$y$\end{document}</tex-math></inline-formula>. The output of the layer is calculated using Equation <xref rid="deqn08" ref-type="disp-formula">8</xref>, where <inline-formula><tex-math notation="LaTeX" id="ImEquation43">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$f$\end{document}</tex-math></inline-formula> is the activation function, <inline-formula><tex-math notation="LaTeX" id="ImEquation44">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$M$\end{document}</tex-math></inline-formula> is the mask matrix, <inline-formula><tex-math notation="LaTeX" id="ImEquation45">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$W$\end{document}</tex-math></inline-formula> is the weight matrix, and <inline-formula><tex-math notation="LaTeX" id="ImEquation46">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$b$\end{document}</tex-math></inline-formula> is the bias vector. Here <inline-formula><tex-math notation="LaTeX" id="ImEquation47">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$MW$\end{document}</tex-math></inline-formula> is the element-wise multiplication of <inline-formula><tex-math notation="LaTeX" id="ImEquation48">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$M$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ImEquation49">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$W$\end{document}</tex-math></inline-formula> (i.e. Hadamard product). The activation function is the tanh function (Equation <xref rid="deqn09" ref-type="disp-formula">9</xref>). The activation values are related to the importance measures of pathways, and they will be elaborated upon in <xref rid="sec2d4" ref-type="sec">2.2.4</xref>. The dimension of each hidden layer is in accordance with the mask matrix <inline-formula><tex-math notation="LaTeX" id="ImEquation50">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$M$\end{document}</tex-math></inline-formula>. To obtain the prediction for each cell, a predictive layer is added after each hidden layer. The dimension of each prediction layer equals the number of cell types. The probability of a cell being classified as the <inline-formula><tex-math notation="LaTeX" id="ImEquation51">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$i$\end{document}</tex-math></inline-formula>th cell type is calculated using the softmax function (Equation <xref rid="deqn10" ref-type="disp-formula">10</xref>), where <inline-formula><tex-math notation="LaTeX" id="ImEquation52">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C$\end{document}</tex-math></inline-formula> is the total number of cell types and <inline-formula><tex-math notation="LaTeX" id="ImEquation53">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$z$\end{document}</tex-math></inline-formula> is the input of the softmax function. The cell is assigned to the class with the highest probability. Finally, the predictions from all predictive layers are integrated by voting to obtain the final prediction result. </p>
        <disp-formula id="deqn08">
          <label>(8)</label>
          <tex-math notation="LaTeX" id="DmEquation8">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*} &amp; y=f[(MW)x+b] \end{align*}\end{document}</tex-math>
        </disp-formula>
        <disp-formula id="deqn09">
          <label>(9)</label>
          <tex-math notation="LaTeX" id="DmEquation9">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*} &amp; f=tanh(z)=\frac{e^{z}-e^{-z}}{e^{z}+e^{-z}} \end{align*}\end{document}</tex-math>
        </disp-formula>
        <disp-formula id="deqn10">
          <label>(10)</label>
          <tex-math notation="LaTeX" id="DmEquation10">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*} &amp; \sigma_{i}=\frac{e^{z_{i}}}{\sum_{c=1}^{C}e^{z_{c}}} \end{align*}\end{document}</tex-math>
        </disp-formula>
      </sec>
      <sec id="sec2d4">
        <title>Important pathway identification</title>
        <p>To identify important pathways for distinguishing each (sub-) cell type, CellTICS utilized activation values during the training procedure. Specifically, the activation values were calculated for each pathway in every layer in the CellTICS neural network. For a given pathway <inline-formula><tex-math notation="LaTeX" id="ImEquation54">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p$\end{document}</tex-math></inline-formula> and cell type <inline-formula><tex-math notation="LaTeX" id="ImEquation55">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$t$\end{document}</tex-math></inline-formula>, the average activation value (<inline-formula><tex-math notation="LaTeX" id="ImEquation56">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$A_{t,p}$\end{document}</tex-math></inline-formula>) was computed across all cells of that type. These average activation values were then sorted in descending order across all cell types, obtaining a list (<inline-formula><tex-math notation="LaTeX" id="ImEquation57">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$A_{(1),p}$\end{document}</tex-math></inline-formula>,<inline-formula><tex-math notation="LaTeX" id="ImEquation58">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$A_{(2),p}$\end{document}</tex-math></inline-formula>,...,<inline-formula><tex-math notation="LaTeX" id="ImEquation59">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$A_{(T),p}$\end{document}</tex-math></inline-formula>), where <inline-formula><tex-math notation="LaTeX" id="ImEquation60">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T$\end{document}</tex-math></inline-formula> is the total number of cell types. To quantify the importance of pathway <inline-formula><tex-math notation="LaTeX" id="ImEquation61">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p$\end{document}</tex-math></inline-formula>, the difference between the first and second largest average activation values, Equation <xref rid="deqn11" ref-type="disp-formula">11</xref>, was computed. Due to the possibility of a pathway <inline-formula><tex-math notation="LaTeX" id="ImEquation62">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p$\end{document}</tex-math></inline-formula> being included in the paths of multiple prediction layers, there might be several <inline-formula><tex-math notation="LaTeX" id="ImEquation63">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$d_{p}$\end{document}</tex-math></inline-formula> values. For instance, a pathway located on the first hidden layer (level 1) could be present in the network paths leading to prediction level 1, level 2, and so on, until the final hidden layer was reached. Hence, the maximum value of <inline-formula><tex-math notation="LaTeX" id="ImEquation64">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$d_{p}$\end{document}</tex-math></inline-formula> among all paths of such nested networks was selected as the final importance measure of the pathway and denoted as <inline-formula><tex-math notation="LaTeX" id="ImEquation65">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula>. If the importance value <inline-formula><tex-math notation="LaTeX" id="ImEquation66">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> exceeded a predefined threshold (default: 0.1), pathway <inline-formula><tex-math notation="LaTeX" id="ImEquation67">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p$\end{document}</tex-math></inline-formula> would be deemed important for the cell type corresponding to <inline-formula><tex-math notation="LaTeX" id="ImEquation68">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$A_{(1),p}$\end{document}</tex-math></inline-formula>. </p>
        <disp-formula id="deqn11">
          <label>(11)</label>
          <tex-math notation="LaTeX" id="DmEquation11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*}&amp; d_{p}=A_{(1),p}-A_{(2),p}\end{align*}\end{document}</tex-math>
        </disp-formula>
      </sec>
    </sec>
    <sec id="sec2i">
      <title>Parameter settings</title>
      <p>The CellTICS model was trained by the Adam optimizer with the cross-entropy loss function with L2 regularization. To optimize the performance of the CellTICS model, the parameters were tuned using grid search with 5-fold cross-validation. The default values for threshold values (<inline-formula><tex-math notation="LaTeX" id="ImEquation69">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\alpha $\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ImEquation70">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\beta $\end{document}</tex-math></inline-formula>) are 0.95 and 0.9, respectively. The default value for the number of hidden layers of the neural network (<inline-formula><tex-math notation="LaTeX" id="ImEquation71">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$l$\end{document}</tex-math></inline-formula>) is 5. The default hyperparameters for the minibatch size, learning rate, and regularization parameter are 32, 0.001, and 0.0001, respectively. The default number of epochs is 10 for cell-type prediction and 50 for sub-cell-type prediction.</p>
    </sec>
    <sec id="sec2j">
      <title>Method comparison</title>
      <p>This work compared the performance of CellTICS with six other methods to evaluate its predictive performance. The compared methods were SingleR [<xref rid="ref34" ref-type="bibr">34</xref>], scmap [<xref rid="ref35" ref-type="bibr">35</xref>] (containing scmap-cluster and scmap-cell), CHETAH [<xref rid="ref36" ref-type="bibr">36</xref>], scPred [<xref rid="ref37" ref-type="bibr">37</xref>], and ACTINN [<xref rid="ref3" ref-type="bibr">3</xref>]. We selected these specific models based on their representation of major categories within cell type annotation methods, encompassing correlation-based methods (SingleR, scmap, and CHETAH), supervised classification-based methods (scPred), and traditional neural networks (ACTINN) [<xref rid="ref38" ref-type="bibr">38</xref>]. Noteworthy, we compared CellTICS with ACTINN, a traditional neural network-based method. This choice was made to assess CellTICS’s proficiency in accurate cell classification and check whether its interpretability sacrifices the prediction accuracy. The default parameter settings of these tools were used unless mentioned otherwise. For scmap, the unassigned threshold, which represents a similarity threshold, was set to <inline-formula><tex-math notation="LaTeX" id="ImEquation72">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$-1$\end{document}</tex-math></inline-formula>.</p>
    </sec>
    <sec id="sec2k">
      <title>Evaluation criteria</title>
      <sec id="sec2k1">
        <title>Evaluation of cell type prediction</title>
        <p>The performance of CellTICS and the compared methods were evaluated using two metrics: accuracy (ACC) and macro-averaged F1 scores (macro F1 scores). ACC measures the percentage of cells correctly classified, while the F1 score is the harmonic mean of precision and recall. The macro F1 score is computed by taking the arithmetic mean of all per-class F1 scores and is useful when dealing with class imbalance problems, which are common in cell-type classification.</p>
      </sec>
      <sec id="sec2k2">
        <title>Evaluation of important pathway identification</title>
        <p>To demonstrate the unique advantages of CellTICS in identifying cell-type important pathways, the gene set enrichment analysis (GSEA) [<xref rid="ref39" ref-type="bibr">39</xref>] was utilized for comparison. GSEA is a method for evaluating cumulative changes in the expression of multiple genes belonging to a gene set (i.e. a pathway). It can be used to identify pathways exhibiting differential gene expression between cell types, between the young and old cells of a specific cell type, or between diseased and healthy cells of a cell type.</p>
        <p>The logarithmic fold change (logFC) was calculated as a differential expression measure for a gene by computing the difference of average log-normalized count data in different groups. Subsequently, the R package ReactomePA [<xref rid="ref40" ref-type="bibr">40</xref>] was used to perform GSEA and identify important pathways with a <italic toggle="yes">P</italic>-value less than 0.05. Finally, the important pathways found by CellTICS and GSEA were compared.</p>
        <p>For pathways identified by CellTICS but not by GSEA, Wilcoxon signed-rank tests were further performed to examine the variation difference, instead of the traditional mean difference, between groups. Thus, for each important pathway identified by CellTICS, the coefficient of variation (CV) of all genes in both groups (e.g. cells of cell type A versus other cells, or old cells of cell type A versus young cells of cell type A) was calculated. Consequently, a Wilcoxon signed-rank test on the CV values of the two groups was performed to assess the significance of variation differences.</p>
      </sec>
    </sec>
  </sec>
  <sec id="sec3">
    <title>RESULTS AND DISCUSSIONS</title>
    <sec id="sec3a">
      <title>Identification of cell and sub-cell types</title>
      <p>To illustrate the predictive power of CellTICS for (sub-)cell-type identification, we compared CellTICS with six other methods for 10 analysis tasks (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). The procedure was repeated five times across all datasets, and the average ACC and macro F1 scores were computed.</p>
      <p>The results for the cell-type identification and the sub-cell-type identification are shown in <xref rid="f2" ref-type="fig">Figure 2</xref>. Clearly, CellTICS outperforms the other methods in almost all datasets, since the performance of CellTICS is usually the best, that is, exhibiting higher scores and smaller performance variations. Although most methods can obtain high ACC for major cell type identification (<xref rid="f2" ref-type="fig">Figure 2A</xref>), the sensitivity of many methods is not satisfactory enough as reflected by the low macro F1 scores in <xref rid="f2" ref-type="fig">Figure 2B</xref>. However, CellTICS stands out with an average macro F1 score between 0.9406 and 0.9993 for the considered datasets. Classifying sub-cell types is a more challenging task, while CellTICS is still superior in most methods (<xref rid="f2" ref-type="fig">Figure 2C</xref> and <xref rid="f2" ref-type="fig">Figure 2D</xref>). The performance of these models for each analysis task is illustrated in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S3</xref>.</p>
      <fig position="float" id="f2">
        <label>Figure 2</label>
        <caption>
          <p><bold>The prediction performance of CellTICS and other cell-type identification methods.</bold> A total of 10 analysis tasks were conducted to generate the boxplots. In each of these tasks, the average ACC and macro F1 scores based on five analysis repeats were used. (<bold>A</bold>) The ACC for cell-type identification. (<bold>B</bold>) The macro F1 score for cell-type identification. (<bold>C</bold>) The ACC for sub-cell-type identification. (<bold>D</bold>) The macro F1 score for sub-cell-type identification.</p>
        </caption>
        <graphic xlink:href="bbad449f2" position="float"/>
      </fig>
      <p>We also compared CellTICS with the original marker gene selection to CellTICS with highly variable gene (HVG) selection (top 2,000, 5,000, or 10,000 HVGs). As shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S4</xref>, the performance of original CellTICS is significantly better than using the top 2,000 HVGs, while it is comparable with using the top 5,000 and 10,000 HVGs. In the ASD data analysis, CellTICS’s marker gene prioritization performs much better than the HVG approaches (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figures S4A</xref>–<xref rid="sup1" ref-type="supplementary-material">D</xref>).</p>
      <p>CellTICS is robust in cell type and sub-cell type identification. We ran CellTICS 20 times and observed very small variations in the accuracy and macro F1 scores for all cell type prediction and sub-cell type prediction (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S5</xref>). Also, CellTICS is computationally efficient. As shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>, for the L5MB dataset which included about 20,000 cells and about 28,000 genes, the whole runtime (including training and testing) was about 23 min.</p>
      <p>One major distinctive part of CellTICS is the multi-predictive-layer strategy, which greatly improves the prediction accuracy and prediction power. <xref rid="f3" ref-type="fig">Figure 3</xref> demonstrates the effectiveness of this strategy by comparing the performance of the original CellTICS with that of CellTICS containing only one prediction layer on the L5MB dataset. The results show that multiple prediction layers can significantly enhance the ACC and macro F1 score of the predictions. For cell type classification, the ACC is improved from 0.7711 to 0.9997, while the macro F1 score is improved from 0.1244 to 0.9878. In sub-cell type classification, the improvement is even more significant, with the ACC increasing from 0.0303 to 0.9035 and the macro F1 score increasing from 0.0003 to 0.7142. These findings demonstrate that the multi-predictive-layer strategy adopted by CellTICS can substantially improve the accuracy of predictions, providing a more nuanced and comprehensive understanding of cell heterogeneity and disease processes. The key advantage of this approach is that it allows for the aggregation of information from different levels of pathway hierarchy, particularly those at the bottom levels which represent more detailed pathways. By leveraging the unique information content available at each level, the network can capture both the broad functional relationships between pathways and the more specific functional roles played by individual pathways.</p>
      <fig position="float" id="f3">
        <label>Figure 3</label>
        <caption>
          <p><bold>The importance of the multi-predictive-layer strategy.</bold> The average ACC and macro F1 scores of the original CellTICS and CellTICS with only one prediction layer are shown for cell-type and sub-cell-type identification on the L5MB dataset.</p>
        </caption>
        <graphic xlink:href="bbad449f3" position="float"/>
      </fig>
      <p>Another noteworthy property of CellTICS is its ability to make predictions at the sub-cell-type level. CellTICS outperforms most methods in most cases (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figures S3C</xref>–<xref rid="sup1" ref-type="supplementary-material">D</xref>), even for the L5MB dataset, where the number of sub-cell types is relatively large (i.e. 220). It also implies that CellTICS has the potential to handle the class imbalance problem since the percentage of sub-cell types in the L5MB test set varies from 0.01 to 5.01%. The success in predicting sub-cell types suggests that CellTICS can better facilitate the construction of cell atlas in complex tissues to a deeper level. At this level, the identification of rare cell types might hold special significance [<xref rid="ref41" ref-type="bibr">41</xref>]. Rare cell types are sporadic within a large population of cells, and their marker genes may exhibit very weak signals. However, CellTICS can capture these signals by incorporating both highly and lowly expressed marker genes of all cell types. Particularly, the inclusion of cell-type-specific lowly expressed genes offers valuable insights as their expression remains uniquely low in certain cell types, which is often overlooked in traditional marker gene prioritization. The comparison between CellTICS’s marker genes and HVGs supports this assertion.</p>
      <p>The trade-off between interpretability and prediction accuracy for deep neural networks is a common challenge in machine learning. As the complexity of the model increases to achieve higher accuracy, its interpretability tends to decrease. However, the hidden layers of CellTICS follow the pathway hierarchy and reflect the real relationships between pathway nodes in a cell. The above results and discussions show that CellTICS can achieve high prediction accuracy. In the following sections, CellTICS’s interpretability will be demonstrated.</p>
    </sec>
    <sec id="sec3b">
      <title>CellTICS identifies important pathways missed by GSEA</title>
      <p>Many deep learning models designed for cell type annotation lack the ability to uncover what defines a cell type, which has prompted us to emphasize achieving biological interpretability. In addition to predicting cell types accurately and identifying the genes that contribute to the prediction (i.e. important features), CellTICS can also pinpoint important pathways (i.e. important neurons in the neural network architecture) that define (sub-) cell types or cell types under a specific physiological condition. This capability represents the most distinctive aspect of this study. Traditionally GSEA is typically used to identify pathways with enriched gene expression changes between cell types. In this section, the comparison between the two approaches will be shown.</p>
      <p>For the AMB whole dataset, we compared the important pathways of each cell type identified by CellTICS with those by GSEA and also compared the results for distinguishing old cells from young cells of a specific cell type. As shown in <xref rid="f4" ref-type="fig">Figure 4A</xref>, CellTICS and GSEA share some important pathways for both cell type classification and aging status classification. Moreover, CellTICS discovers many important pathways missed by GSEA, as it can identify nonlinear characteristics of the pathway and capture potential interactions among genes. Some pathways identified by GSEA are not essential in defining cell types, suggesting that the simple add-up of differential signals of genes in a pathway is not necessarily an important cell-type-specific characteristic.</p>
      <fig position="float" id="f4">
        <label>Figure 4</label>
        <caption>
          <p><bold>Comparison between CellTICS and GSEA.</bold> (<bold>A</bold>) The number of important pathways distinguishing cell types or age groups identified by CellTICS (<inline-formula><tex-math notation="LaTeX" id="ImEquation73">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}\geq 0.1$\end{document}</tex-math></inline-formula>) or GSEA. Pathways important for either old or young cells across all cell types are combined for the “Old or young cells” category. (<bold>B</bold>) Shared pathways between CellTICS and GSEA. The cumulative fraction of pathways identified by GSEA is plotted along pathways with decreasing <inline-formula><tex-math notation="LaTeX" id="ImEquation74">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> values in CellTICS.</p>
        </caption>
        <graphic xlink:href="bbad449f4" position="float"/>
      </fig>
      <p>Generally, pathways with larger importance scores of CellTICS (<inline-formula><tex-math notation="LaTeX" id="ImEquation75">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> values) are more likely to be identified by GSEA (<xref rid="f4" ref-type="fig">Figure 4B</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S6</xref>). In <xref rid="f4" ref-type="fig">Figure 4B</xref>, pathways from CellTICS are sorted by <inline-formula><tex-math notation="LaTeX" id="ImEquation76">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> in descending order, and the cumulative fraction of pathways shared between CellTICS and GSEA is shown. The overlapping fraction is generally higher for pathways with higher <inline-formula><tex-math notation="LaTeX" id="ImEquation77">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> values. Although the number of pathways passing the <inline-formula><tex-math notation="LaTeX" id="ImEquation78">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> threshold of 0.1 is small for VASC (vascular), OLG (oligodendrocyte), and EPC (ependymocyte) cells (<xref rid="f4" ref-type="fig">Figure 4A</xref>), the pattern still holds for these cell types when ordering pathways by <inline-formula><tex-math notation="LaTeX" id="ImEquation79">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> without imposing a cutoff (<xref rid="f4" ref-type="fig">Figure 4B</xref>). Alternatively, the <inline-formula><tex-math notation="LaTeX" id="ImEquation80">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> threshold was adjusted from 0.1 to 0.2 and 0.3 for CellTICS and then compared the results with GSEA. As shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S6</xref>, the overlapping fractions are higher when the threshold for CellTICS is more stringent.</p>
      <p>The advantage of CellTICS over GSEA is that CellTICS can aggregate differential signals nonlinearly via a neural network approach, while GSEA aggregates the differential signals from individual genes of the same pathway in a linear way. Additionally, CellTICS compares the average activation scores of a pathway between the considered cell type and all other cell types in a pairwise fashion. However, GSEA pools all other cell types together and compares them with the considered cell type.</p>
      <p>Knowing pathways that define a (sub-)cell type is particularly valuable because it allows for a better understanding of the molecule dynamics of the cell and how they contribute to predicting a (sub-)cell type. By uncovering cell-type-specific pathways, CellTICS provides a more comprehensive and interpretable view of the underlying biological processes.</p>
    </sec>
    <sec id="sec3c">
      <title>Expression stochasticity of a pathway could be cell-type specific</title>
      <p>As shown in <xref rid="sec3b" ref-type="sec">3.2</xref>, some pathways identified by CellTICS do not show significant differential gene expression at the individual gene level and are not identified by GSEA. To explore their underlying mechanisms, we tested the hypothesis that a pathway’s expression stochasticity, measured by the coefficient of variation, could be a cell-type-specific characteristic. For the AMB whole dataset, a Wilcoxon signed-rank test was performed on the coefficient of variation values of two groups (cell type A versus other cell types, or old cells of cell type A versus young cells of cell type A) for the important pathways discovered by CellTICS but not by GSEA. Interestingly, among the eight important pathways (with a <inline-formula><tex-math notation="LaTeX" id="ImEquation81">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> threshold of 0.3 and not identified by GSEA) for the aging-related pathway discovery, seven of them were discovered in EPCs. Therefore, the differential variation results for pathways related to EPCs are presented in <xref rid="f5" ref-type="fig">Figure 5</xref>. Three out of the seven (<xref rid="f5" ref-type="fig">Figure 5A</xref>) pathways uniquely identified by CellTICS exhibit a significant difference in expression stochasticity between old and young EPCs, and 10 out of 12 (<xref rid="f5" ref-type="fig">Figure 5B</xref>) pathways did so for the comparison between EPCs and other cells (<italic toggle="yes">P</italic>-value <inline-formula><tex-math notation="LaTeX" id="ImEquation82">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\leq 0.05$\end{document}</tex-math></inline-formula>, Wilcoxon tests on CVs). Results for other cell types are shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figures S7</xref>–<xref rid="sup1" ref-type="supplementary-material">S11</xref>, with 14.3–61.1% of their important pathways passing the Wilcoxon tests. These results suggest that expression stochasticity within a pathway could be an essential feature for defining a cell type or a specific age group, which is distinctive for a cell type annotation model. Other studies have also reported that expression stochasticity is important and may affect organism functionality, viability, and flexibility to adapt to environments [<xref rid="ref42" ref-type="bibr">42–44</xref>].</p>
      <fig position="float" id="f5">
        <label>Figure 5</label>
        <caption>
          <p><bold>Important pathways exhibiting differential expression stochasticity.</bold> The differential expression stochasticity of pathways is assessed by Wilcoxon tests for (<bold>A</bold>) different age groups of ependymocytes or (<bold>B</bold>) ependymocytes versus other cell types. Only pathways with <inline-formula><tex-math notation="LaTeX" id="ImEquation83">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p} \geq 0.3$\end{document}</tex-math></inline-formula> in CellTICS but not identified by GSEA are shown. The red dashed lines mark the <italic toggle="yes">P</italic>-value cutoff of 0.05.</p>
        </caption>
        <graphic xlink:href="bbad449f5" position="float"/>
      </fig>
      <p>Based on the findings in <xref rid="f5" ref-type="fig">Figure 5A</xref>, ‘mitotic anaphase’ emerges as one of the most significant important pathways to distinguish age groups of EPCs. According to Hu et al. [<xref rid="ref45" ref-type="bibr">45</xref>], the anaphase-promoting complex/cyclosome (APC/C) is a novel cellular aging regulator based on its indispensable role in the regulation of lifespan and its involvement in age-associated diseases of eukaryotic organisms. This consistency reinforces the results.</p>
      <p>Interestingly, pathways not identified by GSEA but with a higher importance score (<inline-formula><tex-math notation="LaTeX" id="ImEquation84">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula>) are usually more likely to exhibit significantly different expression stochasticity (<italic toggle="yes">P</italic>-value <inline-formula><tex-math notation="LaTeX" id="ImEquation85">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\leq 0.05$\end{document}</tex-math></inline-formula>, Wilcoxon tests on CVs). As shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S12</xref>, approximately 24–79% of the top 100 pathways identified by CellTICS, but overlooked by GSEA, exhibit statistical significance. For most cell types (EPC, NEURON, OLG, VASC, ASC, and old/young cells), there is a decreasing trend in the cumulative overlapping fractions with smaller <inline-formula><tex-math notation="LaTeX" id="ImEquation86">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> values. The only exception is the IMMUNE cell type. Therefore, for many cell types, expression stochasticity is another important characteristic for a pathway to define the cell type. A similar conclusion can be made when comparing results using different <inline-formula><tex-math notation="LaTeX" id="ImEquation87">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> thresholds (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S13</xref>).</p>
    </sec>
    <sec id="sec3d">
      <title>Important pathways for cell types undergoing aging</title>
      <p>Aging-related pathways shown above were based on the two-stage sub-cell-type identification for the AMB whole data. Due to the challenging task of sub-cell-type identification and to achieve more accurate aging-related pathway identification, we carried out the machine learning model for each cell type separately in a single-stage procedure to separate old cells from young cells. <xref rid="f6" ref-type="fig">Figure 6A</xref> shows the UpSet plot of the number of important aging-related pathways (<inline-formula><tex-math notation="LaTeX" id="ImEquation88">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p} \geq 0.1$\end{document}</tex-math></inline-formula>) for each cell type. Interestingly, 19 important aging-related pathways are shared by all cell types, suggesting common and essential mechanisms underlying the aging process for all considered cell types.</p>
      <fig position="float" id="f6">
        <label>Figure 6</label>
        <caption>
          <p><bold>Aging-related pathways identified by CellTICS.</bold> (<bold>A</bold>) The UpSet plot showing the number of important aging pathways for different cell types (<inline-formula><tex-math notation="LaTeX" id="ImEquation89">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p} \geq 0.1$\end{document}</tex-math></inline-formula>). (<bold>B</bold>) GSEA and Wilcoxon tests on CVs for the 19 aging-related pathways shared by all cell types. The corresponding <italic toggle="yes">P</italic>-values are shown. Also, the bar plots show the number of pathways passing GSEA or Wilcoxon tests for each cell type (<italic toggle="yes">P</italic>-values <inline-formula><tex-math notation="LaTeX" id="ImEquation90">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\leq 0.05$\end{document}</tex-math></inline-formula>).</p>
        </caption>
        <graphic xlink:href="bbad449f6" position="float"/>
      </fig>
      <p>To investigate the 19 pathways important for aging, both GSEA and the variation-based Wilcoxon signed-rank test were performed. <xref rid="f6" ref-type="fig">Figure 6B</xref> shows that although the 19 pathways are aging-related for all cell types according to CellTICS, differential expression (significant GSEA <italic toggle="yes">P</italic>-values) or the differential expression stochasticity (significant Wilcoxon test <italic toggle="yes">P</italic>-values) can only be detected in a subset of cell types. Notably, these pathways are more likely to exhibit differential expression for astrocytes, while they are more likely to show differential expression stochasticity for immune cells. Although immune cells do not conform to the trend of “larger <inline-formula><tex-math notation="LaTeX" id="ImEquation91">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula>, more likely to pass Wilcoxon tests” (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S12</xref>), which means they may not use expression stochasticity to distinguish themselves from other cell types, they utilize it to differentiate old and young cells (<xref rid="f6" ref-type="fig">Figure 6B</xref>).</p>
      <p>Furthermore, our work reveals that pathways related to nonsense-mediated mRNA decay (NMD) played an important role in the aging process. NMD is a translation-coupled mechanism that eliminates mRNAs containing premature translation-termination codons [<xref rid="ref46" ref-type="bibr">46</xref>, <xref rid="ref47" ref-type="bibr">47</xref>]. In this analysis, “NMD enhanced by the exon junction complex” and “NMD independent of the exon junction complex” were discovered as important aging pathways. Current experimental research has revealed that RNA surveillance via NMD is crucial for longevity in daf-2/insulin/IGF-1 mutant C. elegans [<xref rid="ref48" ref-type="bibr">48</xref>]. The computational results in mice can complement this understanding of the role of NMD in the aging process.</p>
    </sec>
    <sec id="sec3e">
      <title>Important pathways for ASD</title>
      <p>The ASD dataset served as a demonstration of how CellTICS could identify important pathways associated with disease. The results are shown in <xref rid="f7" ref-type="fig">Figure 7</xref>. Similarly, we compared the pathways identified by CellTICS (<inline-formula><tex-math notation="LaTeX" id="ImEquation92">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p} \geq 0.1$\end{document}</tex-math></inline-formula>) that distinguish between disease status to those identified by GSEA. Despite some overlaps, CellTICS discovered many more unique pathways (<xref rid="f7" ref-type="fig">Figure 7A</xref>). Then, the <inline-formula><tex-math notation="LaTeX" id="ImEquation93">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> threshold was tightened to 0.3 and Wilcoxon tests were performed to compare the coefficient of variation of the ASD and the control groups for these CellTICS-unique pathways. The tests show that 57 out of 75 disease pathways exhibit a significant variation difference (<xref rid="f7" ref-type="fig">Figure 7B</xref>), suggesting most of these ASD-related pathways exhibited expression stochasticity.</p>
      <fig position="float" id="f7">
        <label>Figure 7</label>
        <caption>
          <p><bold>Important pathways for ASD.</bold> (<bold>A</bold>) The number of important pathways distinguishing disease status identified by CellTICS (<inline-formula><tex-math notation="LaTeX" id="ImEquation94">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p} \geq 0.1$\end{document}</tex-math></inline-formula>) or GSEA. (<bold>B</bold>) The number of pathways identified by CellTICS but not by GSEA (<inline-formula><tex-math notation="LaTeX" id="ImEquation95">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p} \geq 0.3$\end{document}</tex-math></inline-formula>) with the information whether they pass the Wilcoxon tests on CVs (<italic toggle="yes">P</italic>-values <inline-formula><tex-math notation="LaTeX" id="ImEquation96">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\leq 0.05$\end{document}</tex-math></inline-formula>). (<bold>C</bold>) Top 15 CellTICS-unique pathways (<inline-formula><tex-math notation="LaTeX" id="ImEquation97">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p} \geq 0.3$\end{document}</tex-math></inline-formula>) ordered by their significance of the Wilcoxon test on CVs. The red dashed line marks the <italic toggle="yes">P</italic>-value of 0.05. The color of each pathway indicates whether the ASD group exhibits a higher or lower coefficient of variation. (<bold>D</bold>) Top 15 important ASD pathways ordered by <inline-formula><tex-math notation="LaTeX" id="ImEquation98">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> value. Cell types corresponding to each pathway are also shown.</p>
        </caption>
        <graphic xlink:href="bbad449f7" position="float"/>
      </fig>
      <p>The top 15 disease pathways (<inline-formula><tex-math notation="LaTeX" id="ImEquation99">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p} \geq 0.3$\end{document}</tex-math></inline-formula>, but not identified by GSEA) exhibiting the most significant differential expression stochasticity are shown in <xref rid="f7" ref-type="fig">Figure 7C</xref>, and the top 15 important ASD pathways ordered by <inline-formula><tex-math notation="LaTeX" id="ImEquation100">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> values are shown in <xref rid="f7" ref-type="fig">Figure 7D</xref>. As expected, the pathway with the highest <inline-formula><tex-math notation="LaTeX" id="ImEquation101">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> value is “nervous system development”, which is consistent with the etiology of ASD. The analysis reveals that ‘axon guidance’ is among the top three terms with the largest <inline-formula><tex-math notation="LaTeX" id="ImEquation102">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> value (<xref rid="f7" ref-type="fig">Figure 7D</xref>) and also ranked third for the differential expression stochasticity analysis (<xref rid="f7" ref-type="fig">Figure 7C</xref>). Notably, cortical abnormalities and genetic evidence support the notion that dysregulated axonal growth and guidance are critical developmental processes underlying the clinical manifestations of ASD [<xref rid="ref49" ref-type="bibr">49</xref>]. The findings further reinforce the importance of axon guidance in ASD.</p>
    </sec>
  </sec>
  <sec id="sec4">
    <title>CONCLUSION</title>
    <p>This study introduces CellTICS, a biologically explainable neural network tailored for cell-type identification and interpretation using single-cell RNA-seq data. CellTICS adopts a two-stage strategy to predict cell types and sub-cell types, and its innovative multi-predictive-layer strategy significantly enhances the prediction accuracy. The prediction accuracy of CellTICS is validated through comparison with alternative methods across various datasets.</p>
    <p>Moreover, CellTICS can discover important pathways that are missed by conventional methods like GSEA. These pathways may be characterized by their cell-type-specific expression stochasticity, as quantified by the coefficient of variation in Wilcoxon tests.</p>
    <p>Furthermore, the applications of CellTICS in the context of the aging process and ASD underscore its relevance for cell type identification under different physiological conditions. This adaptability is invaluable for gaining insights into how the aging process or specific diseases impact individuals across various cell types. In summary, CellTICS offers a powerful and biologically interpretable tool for advancing our understanding of cellular dynamics and their role in various health and disease states.</p>
    <boxed-text id="box01" position="float">
      <sec id="sec28a">
        <title>Key Points</title>
        <list list-type="bullet">
          <list-item>
            <p>Innovative Interpretability: CellTICS is significantly different from the traditional ‘black box’ deep learning models, offering biologically interpretable insights into cell type prediction.</p>
          </list-item>
          <list-item>
            <p>Accuracy Unleashed: With CellTICS, we have pushed the boundaries of accuracy in the identification of cell types and sub-cell types using single-cell RNA sequencing data, providing a sharper lens into the cellular world.</p>
          </list-item>
          <list-item>
            <p>Pathways Illuminated: CellTICS uncovers the hidden pathways that define unique cell types. It sheds light on the profound influence of expression stochasticity in cell type delineation which is missed by traditional analysis.</p>
          </list-item>
          <list-item>
            <p>Disease and Aging Unveiled: CellTICS excels at the identification of pathways that set cell types apart under diverse physiological conditions, providing valuable insights into the dynamic changes in cellular landscapes of disease and aging.</p>
          </list-item>
        </list>
      </sec>
    </boxed-text>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>supplementary_information_bbad449</label>
      <media xlink:href="supplementary_information_bbad449.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>ACKNOWLEDGMENTS</title>
    <p>The authors thank all members of the Chen lab for their discussions and suggestions throughout this study. This work was supported by the National Institutes of Health (R01GM137428, R01NS104041, and R01NS125276 to L.C.).</p>
  </ack>
  <sec sec-type="data-availability" id="sec19a">
    <title>CODE AND DATA AVAILABILITY</title>
    <p>The CSV data underlying this article are available in Zenodo, at <ext-link xlink:href="https://doi.org/10.5281/zenodo.7829597" ext-link-type="uri">https://doi.org/10.5281/zenodo.7829597</ext-link>. Links for accessing the original datasets are available in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>. Codes for CellTICS and all need libraries information are available at <ext-link xlink:href="https://github.com/qyyin0516/CellTICS" ext-link-type="uri">https://github.com/qyyin0516/CellTICS</ext-link>. Specifically, CellTICS was implemented using Python 3 (version 3.9.2), and the libraries involved were numpy (1.23.1), pandas (1.2.3), keras (2.9.0), tensorflow (2.9.0), networkx (2.6.3) and biomart (0.9.2). The computational tasks were executed on a Linux system equipped with two NVIDIA Tesla V100 GPUs and a memory capacity of up to 180 gigabytes. Related pathway findings are also shown on the GitHub page. For data processing and statistical analysis, we employed R (version 4.1.2). Additionally, we used the following R packages: Scater (1.22.0), caret (6.0-93) and ReactomePA (1.38.0). Besides, the HVGs were found using Python package scanpy (1.9.3).</p>
  </sec>
  <sec id="sec19n">
    <title>AUTHOR CONTRIBUTIONS STATEMENT</title>
    <p>Q.Y. and L.C. designed the research. Q.Y. implemented the methods and carried out the analyses. L.C. supervised the project. Q.Y. and L.C. discussed the results and contributed to the manuscript writing.</p>
  </sec>
  <notes id="bio3">
    <title>Author Biographies</title>
    <p><bold>Qingyang Yin</bold> is a Ph.D. student in the Department of Quantitative and Computational Biology at the University of Southern California.</p>
    <sec sec-type="author-bio" id="sec20a">
      <p><bold>Liang Chen</bold> is a professor in the Department of Quantitative and Computational Biology at the University of Southern California.</p>
    </sec>
  </notes>
  <ref-list id="bib1">
    <title>References</title>
    <ref id="ref1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tammela</surname>  <given-names>T</given-names></string-name>, <string-name><surname>Sage</surname>  <given-names>J</given-names></string-name></person-group>. <article-title>Investigating tumor heterogeneity in mouse models</article-title>. <source>Annu Rev Cancer Biol</source>  <year>2020</year>;<volume>19</volume>(<issue>6</issue>):<fpage>99</fpage>–<lpage>119</lpage>.</mixed-citation>
    </ref>
    <ref id="ref2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Molho</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Ding</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Li</surname>  <given-names>Z</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Deep learning in single-cell analysis</article-title>. <source>arXiv preprint</source>  <year>2022</year>; <comment>2210.12385</comment>.</mixed-citation>
    </ref>
    <ref id="ref3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ma</surname>  <given-names>F</given-names></string-name>, <string-name><surname>Pellegrini</surname>  <given-names>M</given-names></string-name></person-group>. <article-title>ACTINN: automated identification of cell types in single cell RNA sequencing</article-title>. <source>Bioinformatics</source>  <year>2020</year>;<volume>36</volume>(<issue>2</issue>):<fpage>533</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">31359028</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xie</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Gao</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Wang</surname>  <given-names>C</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>SuperCT: a supervised-learning framework for enhanced characterization of single-cell transcriptomic profiles</article-title>. <source>Bioinformatics</source>  <year>2019</year>;<volume>47</volume>(<issue>8</issue>):<fpage>e48</fpage>.</mixed-citation>
    </ref>
    <ref id="ref5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jia</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Lysenko</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Boroevich</surname>  <given-names>KA</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>scDeepInsight: a supervised cell-type identification method for scRNA-seq data with deep learning</article-title>. <source>Brief Bioinform</source>  <year>2023</year>;<volume>24</volume>(<issue>5</issue>):<fpage>bbad266</fpage>.<pub-id pub-id-type="pmid">37523217</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vasighizaker</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Zhou</surname>  <given-names>L</given-names></string-name>, <string-name><surname>Rueda</surname>  <given-names>L</given-names></string-name></person-group>. <article-title>Cell type identification via convolutional neural networks and self-organizing maps on single-cell RNA-seq data</article-title>. In: <source>Proceedings of the 12th ACM Conference on Bioinformatics, Computational Biology, and Health Informatics</source>, <year>2021</year>. <volume>Article 91</volume>, p. <fpage>1</fpage>–<lpage>6</lpage>.</mixed-citation>
    </ref>
    <ref id="ref7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname>  <given-names>T</given-names></string-name>, <string-name><surname>Bai</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Nabavi</surname>  <given-names>S</given-names></string-name></person-group>. <article-title>Single-cell classification using graph convolutional networks</article-title>. <source>BMC Bioinformatics</source>  <year>2021</year>;<volume>22</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>23</lpage>.<pub-id pub-id-type="pmid">33388027</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shao</surname>  <given-names>X</given-names></string-name>, <string-name><surname>Yang</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Zhuang</surname>  <given-names>X</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>scDeepSort: a pre-trained cell-type annotation method for single-cell transcriptomics using deep learning with a weighted graph neural network</article-title>. <source>Nucleic Acids Res</source>  <year>2021</year>;<volume>49</volume>(<issue>21</issue>):<fpage>e122</fpage>.<pub-id pub-id-type="pmid">34500471</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yin</surname>  <given-names>Q</given-names></string-name>, <string-name><surname>Wang</surname>  <given-names>Y</given-names></string-name>, <string-name><surname>Guan</surname>  <given-names>J</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>scIAE: an integrative autoencoder-based ensemble classification framework for single-cell RNA-seq data</article-title>. <source>Brief Bioinform</source>  <year>2022</year>;<volume>23</volume>(<issue>1</issue>):<fpage>bbab508</fpage>.<pub-id pub-id-type="pmid">34913057</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lopez</surname>  <given-names>R</given-names></string-name>, <string-name><surname>Regier</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Cole</surname>  <given-names>MB</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Deep generative modeling for single-cell transcriptomics</article-title>. <source>Nat Methods</source>  <year>2018</year>;<volume>15</volume>(<issue>12</issue>):<fpage>1053</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">30504886</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tran</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Nguyen</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Tran</surname>  <given-names>B</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Fast and precise single-cell data analysis using a hierarchical autoencoder</article-title>. <source>Nat Commun</source>  <year>2021</year>;<volume>12</volume>(<issue>1</issue>):<fpage>1029</fpage>.<pub-id pub-id-type="pmid">33589635</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Song</surname>  <given-names>T</given-names></string-name>, <string-name><surname>Dai</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Wang</surname>  <given-names>S</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>TransCluster: a cell-type identification method for single-cell RNA-seq data using deep learning based on transformer</article-title>. <source>Front Genet</source>  <year>2022</year>;<volume>13</volume>:<fpage>1038919</fpage>.<pub-id pub-id-type="pmid">36303549</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Xu</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Tao</surname>  <given-names>W</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Transformer for one stop interpretable cell type annotation</article-title>. <source>Nat Commun</source>  <year>2023</year>;<volume>14</volume>(<issue>1</issue>):<fpage>223</fpage>.<pub-id pub-id-type="pmid">36641532</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dehghan</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Razzaghi</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Abbasi</surname>  <given-names>K</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>TripletMultiDTI: multimodal representation learning in drug-target interaction prediction with triplet loss function</article-title>. <source>Exp Syst Appl</source>  <year>2023</year>;<volume>232</volume>:<fpage>120754</fpage>.</mixed-citation>
    </ref>
    <ref id="ref15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rafiei</surname>  <given-names>F</given-names></string-name>, <string-name><surname>Zeraati</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Abbasi</surname>  <given-names>K</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>DeepTraSynergy: drug combinations using multimodal deep learning with transformers</article-title>. <source>Bioinformatics</source>  <year>2023</year>;<volume>39</volume>(<issue>8</issue>):<fpage>btad438</fpage>.<pub-id pub-id-type="pmid">37467066</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pettit</surname>  <given-names>JB</given-names></string-name>, <string-name><surname>Tomer</surname>  <given-names>R</given-names></string-name>, <string-name><surname>Achim</surname>  <given-names>K</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Identifying cell types from spatially referenced single-cell expression datasets</article-title>. <source>PLoS Comput Biol</source>  <year>2014</year>;<volume>10</volume>(<issue>9</issue>):<fpage>e1003824</fpage>.<pub-id pub-id-type="pmid">25254363</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kuenzi</surname>  <given-names>BM</given-names></string-name>, <string-name><surname>Park</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Fong</surname>  <given-names>SH</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Predicting drug response and synergy using a deep learning model of human cancer cells</article-title>. <source>Cancer Cell</source>  <year>2020</year>;<volume>38</volume>(<issue>5</issue>):<fpage>672</fpage>–<lpage>84</lpage>.<pub-id pub-id-type="pmid">33096023</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ashburner</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Ball</surname>  <given-names>CA</given-names></string-name>, <string-name><surname>Blake</surname>  <given-names>JA</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Gene ontology: tool for the unification of biology</article-title>. <source>Nat Genet</source>  <year>2000</year>;<volume>25</volume>(<issue>1</issue>):<fpage>25</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">10802651</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Elmarakeby</surname>  <given-names>HA</given-names></string-name>, <string-name><surname>Hwang</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Arafeh</surname>  <given-names>R</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Biologically informed deep neural network for prostate cancer discovery</article-title>. <source>Nature</source>  <year>2021</year>;<volume>598</volume>(<issue>7880</issue>):<fpage>348</fpage>–<lpage>52</lpage>.<pub-id pub-id-type="pmid">34552244</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname>  <given-names>Y</given-names></string-name>, <string-name><surname>Barr</surname>  <given-names>K</given-names></string-name>, <string-name><surname>Reinitz</surname>  <given-names>J</given-names></string-name></person-group>. <article-title>Fully interpretable deep learning model of transcriptional control</article-title>. <source>Bioinformatics</source>  <year>2020</year>;<volume>36</volume>(<issue>Supplement_1</issue>):<fpage>i499</fpage>–<lpage>507</lpage>.<pub-id pub-id-type="pmid">32657418</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sun</surname>  <given-names>B</given-names></string-name>, <string-name><surname>Chen</surname>  <given-names>L</given-names></string-name></person-group>. <article-title>Interpretable deep learning for improving cancer patient survival based on personal transcriptomes</article-title>. <source>Sci Rep</source>  <year>2023</year>;<volume>13</volume>(<issue>1</issue>):<fpage>11344</fpage>.<pub-id pub-id-type="pmid">37443344</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shrikumar</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Greenside</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Kundaje</surname>  <given-names>A</given-names></string-name></person-group>. <article-title>Learning important features through propagating activation differences</article-title>. <source>arXiv preprint</source>  <year>2017</year>;<fpage>1704.02685</fpage>.</mixed-citation>
    </ref>
    <ref id="ref23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Novakovsky</surname>  <given-names>G</given-names></string-name>, <string-name><surname>Dexter</surname>  <given-names>N</given-names></string-name>, <string-name><surname>Libbrecht</surname>  <given-names>MW</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Obtaining genetics insights from deep learning via explainable artificial intelligence</article-title>. <source>Nat Rev Genet</source>  <year>2022</year>;<volume>24</volume>(<issue>2</issue>):<fpage>125</fpage>–<lpage>37</lpage>.<pub-id pub-id-type="pmid">36192604</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref24">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Joshi-Tope</surname>  <given-names>G</given-names></string-name>, <string-name><surname>Gillespie</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Vastrik</surname>  <given-names>I</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Reactome: a knowledgebase of biological pathways</article-title>. <source>Nucleic Acids Res</source>  <year>2005</year>;<volume>33</volume>(<issue>Supplement_1</issue>):<fpage>D428</fpage>–<lpage>32</lpage>.<pub-id pub-id-type="pmid">15608231</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zeisel</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Hochgerner</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Lönnerberg</surname>  <given-names>P</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Molecular architecture of the mouse nervous system</article-title>. <source>Nucleic Acids Res</source>  <year>2018</year>;<volume>174</volume>(<issue>4</issue>):<fpage>999</fpage>–<lpage>1014</lpage>.</mixed-citation>
    </ref>
    <ref id="ref26">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Saunders</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Macosko</surname>  <given-names>EZ</given-names></string-name>, <string-name><surname>Wysoker</surname>  <given-names>A</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Molecular diversity and specializations among the cells of the adult mouse brain</article-title>. <source>Nucleic Acids Res</source>  <year>2018</year>;<volume>174</volume>(<issue>4</issue>):<fpage>1015</fpage>–<lpage>30</lpage>.</mixed-citation>
    </ref>
    <ref id="ref27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ximerakis</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Lipnick</surname>  <given-names>SL</given-names></string-name>, <string-name><surname>Innes</surname>  <given-names>BT</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Molecular diversity and specializations among the cells of the adult mouse brain</article-title>. <source>Nat Neurosci</source>  <year>2019</year>;<volume>22</volume>(<issue>10</issue>):<fpage>1696</fpage>–<lpage>708</lpage>.<pub-id pub-id-type="pmid">31551601</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref28">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Abdelaal</surname>  <given-names>T</given-names></string-name>, <string-name><surname>Michielsen</surname>  <given-names>L</given-names></string-name>, <string-name><surname>Cats</surname>  <given-names>D</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>A comparison of automatic cell identification methods for single-cell RNA sequencing data</article-title>. <source>Genome Biol</source>  <year>2019</year>;<volume>20</volume>(<issue>1</issue>):<fpage>194</fpage>.<pub-id pub-id-type="pmid">31500660</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref29">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Velmeshev</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Schirmer</surname>  <given-names>L</given-names></string-name>, <string-name><surname>Jung</surname>  <given-names>D</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Single-cell genomics identifies cell type-specific molecular changes in autism</article-title>. <source>Science</source>  <year>2019</year>;<volume>364</volume>(<issue>6441</issue>):<fpage>685</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">31097668</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref30">
      <label>30.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McCarthy</surname>  <given-names>DJ</given-names></string-name>, <string-name><surname>Campbell</surname>  <given-names>KR</given-names></string-name>, <string-name><surname>Lun</surname>  <given-names>AT</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Scater: pre-processing, quality control, normalization and visualization of single-cell RNA-seq data in R</article-title>. <source>Bioinformatics</source>  <year>2017</year>;<volume>33</volume>(<issue>8</issue>):<fpage>1179</fpage>–<lpage>86</lpage>.<pub-id pub-id-type="pmid">28088763</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref31">
      <label>31.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kuhn</surname>  <given-names>M</given-names></string-name></person-group>. <article-title>Building predictive models in R using the caret package</article-title>. <source>J Stat Softw</source>  <year>2008</year>;<volume>28</volume>:<fpage>1</fpage>–<lpage>26</lpage>.<pub-id pub-id-type="pmid">27774042</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref32">
      <label>32.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><collab>Miltenyi Biotec</collab></person-group>. <source>Peripheral blood — Whole blood — Handbook</source>. <comment>https://www.miltenyibiotec.com/US-en/resources/macs-handbook/human-cells-and-organs/human-cell-sources/blood-human.html</comment> (<comment>11 September 2023, date last accessed</comment>).</mixed-citation>
    </ref>
    <ref id="ref33">
      <label>33.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jiang</surname>  <given-names>W</given-names></string-name>, <string-name><surname>Chen</surname>  <given-names>L</given-names></string-name></person-group>. <article-title>Tissue specificity of gene expression evolves across mammal species</article-title>. <source>J Comput Biol</source>  <year>2022</year>;<volume>29</volume>(<issue>8</issue>):<fpage>880</fpage>–<lpage>91</lpage>.<pub-id pub-id-type="pmid">35776510</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref34">
      <label>34.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aran</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Looney</surname>  <given-names>AP</given-names></string-name>, <string-name><surname>Liu</surname>  <given-names>L</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Reference-based analysis of lung single-cell sequencing reveals a transitional profibrotic macrophage</article-title>. <source>Nat Immunol</source>  <year>2019</year>;<volume>20</volume>(<issue>2</issue>):<fpage>163</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">30643263</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref35">
      <label>35.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kiselev</surname>  <given-names>VY</given-names></string-name>, <string-name><surname>Yiu</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Hemberg</surname>  <given-names>M</given-names></string-name></person-group>. <article-title>Scmap: projection of single-cell RNA-seq data across data sets</article-title>. <source>Nat Immunol</source>  <year>2018</year>;<volume>15</volume>(<issue>5</issue>):<fpage>359</fpage>–<lpage>62</lpage>.</mixed-citation>
    </ref>
    <ref id="ref36">
      <label>36.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>De Kanter</surname>  <given-names>JK</given-names></string-name>, <string-name><surname>Lijnzaad</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Candelli</surname>  <given-names>T</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>CHETAH: a selective, hierarchical cell type identification method for single-cell RNA sequencing</article-title>. <source>Nucleic Acids Res</source>  <year>2019</year>;<volume>47</volume>(<issue>16</issue>):<fpage>e95</fpage>.<pub-id pub-id-type="pmid">31226206</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref37">
      <label>37.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Alquicira-Hernandez</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Sathe</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Ji</surname>  <given-names>HP</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>scPred: accurate supervised method for cell-type classification from single-cell RNA-seq data</article-title>. <source>Genome Biol</source>  <year>2019</year>;<volume>20</volume>(<issue>1</issue>):<fpage>264</fpage>.<pub-id pub-id-type="pmid">31829268</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref38">
      <label>38.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pasquini</surname>  <given-names>G</given-names></string-name>, <string-name><surname>Arias</surname>  <given-names>JE</given-names></string-name>, <string-name><surname>Schäfer</surname>  <given-names>P</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Automated methods for cell type annotation on scRNA-seq data</article-title>. <source>Comput Struct Biotechnol J</source>  <year>2021</year>;<volume>19</volume>:<fpage>961</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">33613863</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref39">
      <label>39.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Subramanian</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Tamayo</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Mootha</surname>  <given-names>VK</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>. <source>Proc Natl Acad Sci U S A</source>  <year>2005</year>;<volume>102</volume>(<issue>43</issue>):<fpage>15545</fpage>–<lpage>50</lpage>.<pub-id pub-id-type="pmid">16199517</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref40">
      <label>40.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yu</surname>  <given-names>G</given-names></string-name>, <string-name><surname>He</surname>  <given-names>QY</given-names></string-name></person-group>. <article-title>ReactomePA: an R/Bioconductor package for reactome pathway analysis and visualization</article-title>. <source>Mol Biosyst</source>  <year>2016</year>;<volume>12</volume>(<issue>2</issue>):<fpage>477</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">26661513</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref41">
      <label>41.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Leary</surname>  <given-names>JR</given-names></string-name>, <string-name><surname>Xu</surname>  <given-names>Y</given-names></string-name>, <string-name><surname>Morrison</surname>  <given-names>AB</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Sub-cluster identification through semi-supervised optimization of rare-cell silhouettes (SCISSORS) in single-cell RNA-sequencing</article-title>. <source>Bioinformatics</source>  <year>2023</year>;<volume>39</volume>(<issue>8</issue>):<fpage>btad449</fpage>.<pub-id pub-id-type="pmid">37498558</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref42">
      <label>42.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Meng</surname>  <given-names>X</given-names></string-name>, <string-name><surname>Reed</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Lai</surname>  <given-names>S</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Stochastic scanning events on the GCN4 mRNA 5<inline-formula><tex-math notation="LaTeX" id="ImEquation103">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$^\prime $\end{document}</tex-math></inline-formula> untranslated region generate cell-to-cell heterogeneity in the yeast nutritional stress response</article-title>. <source>Nucleic Acids Res</source>  <year>2023</year>;<volume>51</volume>(<issue>13</issue>):<fpage>6609</fpage>–<lpage>21</lpage>.<pub-id pub-id-type="pmid">37246646</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref43">
      <label>43.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>de Jong</surname>  <given-names>TV</given-names></string-name>, <string-name><surname>Moshkin</surname>  <given-names>YM</given-names></string-name>, <string-name><surname>Guryev</surname>  <given-names>V</given-names></string-name></person-group>. <article-title>Gene expression variability: the other dimension in transcriptome analysis</article-title>. <source>Physiol Genomics</source>  <year>2019</year>;<volume>51</volume>(<issue>5</issue>):<fpage>145</fpage>–<lpage>58</lpage>.<pub-id pub-id-type="pmid">30875273</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref44">
      <label>44.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kaern</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Elston</surname>  <given-names>TC</given-names></string-name>, <string-name><surname>Blake</surname>  <given-names>WJ</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Stochasticity in gene expression: from theories to phenotypes</article-title>. <source>Nucleic Acids Res</source>  <year>2005</year>;<volume>6</volume>(<issue>6</issue>):<fpage>451</fpage>–<lpage>64</lpage>.</mixed-citation>
    </ref>
    <ref id="ref45">
      <label>45.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hu</surname>  <given-names>X</given-names></string-name>, <string-name><surname>Jin</surname>  <given-names>X</given-names></string-name>, <string-name><surname>Cao</surname>  <given-names>X</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>The anaphase-promoting complex/Cyclosome is a cellular ageing regulator</article-title>. <source>Int J Mol Sci</source>  <year>2022</year>;<volume>23</volume>(<issue>23</issue>):<fpage>15327</fpage>.<pub-id pub-id-type="pmid">36499653</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref46">
      <label>46.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brogna</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Wen</surname>  <given-names>J</given-names></string-name></person-group>. <article-title>Nonsense-mediated mRNA decay (NMD) mechanisms</article-title>. <source>Nat Struct Mol Biol</source>  <year>2009</year>;<volume>16</volume>(<issue>2</issue>):<fpage>107</fpage>–<lpage>13</lpage>.<pub-id pub-id-type="pmid">19190664</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref47">
      <label>47.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>  <given-names>Z</given-names></string-name>, <string-name><surname>Vuong</surname>  <given-names>JK</given-names></string-name>, <string-name><surname>Zhang</surname>  <given-names>M</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Inhibition of nonsense-mediated RNA decay by ER stress</article-title>. <source>RNA</source>  <year>2017</year>;<volume>23</volume>(<issue>3</issue>):<fpage>378</fpage>–<lpage>94</lpage>.<pub-id pub-id-type="pmid">27940503</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref48">
      <label>48.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Son</surname>  <given-names>HG</given-names></string-name>, <string-name><surname>Seo</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Ham</surname>  <given-names>S</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>RNA surveillance via nonsense-mediated mRNA decay is crucial for longevity in daf-2/insulin/IGF-1 mutant C. Elegans</article-title>. <source>Nat Commun</source>  <year>2017</year>;<volume>8</volume>(<issue>1</issue>): <fpage>1</fpage>–<lpage>11</lpage>.<pub-id pub-id-type="pmid">28232747</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref49">
      <label>49.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McFadden</surname>  <given-names>K</given-names></string-name>, <string-name><surname>Minshew</surname>  <given-names>NJ</given-names></string-name></person-group>. <article-title>Evidence for dysregulation of axonal growth and guidance in the etiology of ASD</article-title>. <source>Front Hum Neurosci</source>  <year>2013</year>;<volume>7</volume>:<fpage>671</fpage>.<pub-id pub-id-type="pmid">24155705</pub-id>
</mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Brief Bioinform</journal-id>
    <journal-id journal-id-type="iso-abbrev">Brief Bioinform</journal-id>
    <journal-id journal-id-type="publisher-id">bib</journal-id>
    <journal-title-group>
      <journal-title>Briefings in Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1467-5463</issn>
    <issn pub-type="epub">1477-4054</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10703497</article-id>
    <article-id pub-id-type="pmid">38061196</article-id>
    <article-id pub-id-type="doi">10.1093/bib/bbad449</article-id>
    <article-id pub-id-type="publisher-id">bbad449</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Problem Solving Protocol</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CellTICS: an explainable neural network for cell-type identification and interpretation based on single-cell RNA-seq data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Yin</surname>
          <given-names>Qingyang</given-names>
        </name>
        <aff><institution>Department of Quantitative and Computational Biology, University of Southern California</institution>, <addr-line>1050 Childs Way, Los Angeles, CA 90089</addr-line>, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Chen</surname>
          <given-names>Liang</given-names>
        </name>
        <!--liang.chen@usc.edu-->
        <aff><institution>Department of Quantitative and Computational Biology, University of Southern California</institution>, <addr-line>1050 Childs Way, Los Angeles, CA 90089</addr-line>, <country country="US">United States</country></aff>
        <xref rid="cor1" ref-type="corresp"/>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="cor1">Corresponding author: Liang Chen. Email: <email>liang.chen@usc.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>1</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-12-07">
      <day>07</day>
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>07</day>
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <volume>25</volume>
    <issue>1</issue>
    <elocation-id>bbad449</elocation-id>
    <history>
      <date date-type="received">
        <day>27</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>30</day>
        <month>10</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>11</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="bbad449.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Identifying cell types is crucial for understanding the functional units of an organism. Machine learning has shown promising performance in identifying cell types, but many existing methods lack biological significance due to poor interpretability. However, it is of the utmost importance to understand what makes cells share the same function and form a specific cell type, motivating us to propose a biologically interpretable method. CellTICS prioritizes marker genes with cell-type-specific expression, using a hierarchy of biological pathways for neural network construction, and applying a multi-predictive-layer strategy to predict cell and sub-cell types. CellTICS usually outperforms existing methods in prediction accuracy. Moreover, CellTICS can reveal pathways that define a cell type or a cell type under specific physiological conditions, such as disease or aging. The nonlinear nature of neural networks enables us to identify many novel pathways. Interestingly, some of the pathways identified by CellTICS exhibit differential expression “variability” rather than differential expression across cell types, indicating that expression stochasticity within a pathway could be an important feature characteristic of a cell type. Overall, CellTICS provides a biologically interpretable method for identifying and characterizing cell types, shedding light on the underlying pathways that define cellular heterogeneity and its role in organismal function. CellTICS is available at <ext-link xlink:href="https://github.com/qyyin0516/CellTICS" ext-link-type="uri">https://github.com/qyyin0516/CellTICS</ext-link>.</p>
    </abstract>
    <kwd-group>
      <kwd>explainable neural network</kwd>
      <kwd>cell type identification</kwd>
      <kwd>pathways</kwd>
      <kwd>scRNA-seq data</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>R01GM137428</award-id>
        <award-id>R01NS104041</award-id>
        <award-id>R01NS125276</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="12"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="sec1">
    <title>INTRODUCTION</title>
    <p>Single-cell RNA-sequencing (scRNA-seq) provides expression profiles of individual cells and molecularly defines cell states or phenotypes [<xref rid="ref1" ref-type="bibr">1</xref>]. It also has the potential to identify cell types, which are functional units of an organism and crucial to other downstream research investigations. Recently, machine learning has been widely applied to identifying cell types. Typically, a machine-learning model is built using a reference dataset with well-curated cell-type labels. Then, the model is applied to the query dataset to predict its cell types. Deep learning has consistently shown promising performances in cell-type identification for various architectures and the customization of hyperparameters [<xref rid="ref2" ref-type="bibr">2</xref>]. Numerous neural network architectures have contributed to these achievements, including artificial neural networks [<xref rid="ref3" ref-type="bibr">3</xref>, <xref rid="ref4" ref-type="bibr">4</xref>], convolutional neural networks [<xref rid="ref5" ref-type="bibr">5</xref>, <xref rid="ref6" ref-type="bibr">6</xref>], graph-based networks [<xref rid="ref7" ref-type="bibr">7</xref>, <xref rid="ref8" ref-type="bibr">8</xref>], generative models (autoencoders or generative adversarial networks) [<xref rid="ref9" ref-type="bibr">9–11</xref>] and attention-based models (transformers) [<xref rid="ref12" ref-type="bibr">12</xref>, <xref rid="ref13" ref-type="bibr">13</xref>]. Moreover, recent advances in multimodal learning show its immense potential in bioinformatics [<xref rid="ref14" ref-type="bibr">14</xref>, <xref rid="ref15" ref-type="bibr">15</xref>]. However, these deep learning-based models are usually black-box models, lacking interpretability. Moreover, predicting at the sub-cell-type level has always been more challenging, even though it provides higher resolution and can unveil valuable insights into cell heterogeneity [<xref rid="ref16" ref-type="bibr">16</xref>]. Motivated by existing limitations, this study aims to address both the aspects of biological interpretability and sub-cell-level prediction.</p>
    <p>In the field of computational biology, interpretable neural networks are constructed using prior biological knowledge, such as gene ontology and pathway information, to improve the interpretability of deep learning. For instance, DrugCell [<xref rid="ref17" ref-type="bibr">17</xref>] uses a visible neural network that predicts anti-cancer drug responses by leveraging biological process information from the Gene Ontology (GO) database [<xref rid="ref18" ref-type="bibr">18</xref>]. P-NET [<xref rid="ref19" ref-type="bibr">19</xref>] is a biologically informed deep-learning model for prostate cancer discovery. Liu et al. [<xref rid="ref20" ref-type="bibr">20</xref>] introduced an interpretable deep neural network that faithfully captures the underlying chemical mechanism of transcription factor binding to DNA. CancerIDP [<xref rid="ref21" ref-type="bibr">21</xref>] is an interpretable neural network that predicts cancer patients’ survival based on drug prescriptions and personal transcriptomes. In these models, neurons are imbued with biological meaning (GO terms, pathways, etc.), and certain automatic computational procedures, like DeepLIFT [<xref rid="ref22" ref-type="bibr">22</xref>], are employed to evaluate the significance of these neurons. Hence, these models significantly enhance human understanding of hidden mechanisms [<xref rid="ref23" ref-type="bibr">23</xref>] and have shown remarkable success in both predicting classification labels and explaining results. Nevertheless, there are few studies that focus on the application of interpretable neural networks for cell type annotation and the interpretation of the factors that define a cell type.</p>
    <p>Inspired by the success of interpretable neural networks, this study presents <bold>CellTICS</bold> (<bold>Cell</bold>-<bold>T</bold>ype <bold>I</bold>dentifi<bold>C</bold>ation based on <bold>S</bold>cRNA-seq), a biologically explainable neural network for cell-type identification and interpretation based on single-cell RNA-seq data. In CellTICS, marker genes are prioritized as interpretable features. The network architecture of CellTICS follows the hierarchy of pathways acquired from the Reactome database [<xref rid="ref24" ref-type="bibr">24</xref>] and adopts a two-stage strategy to predict cell and sub-cell types. What sets CellTICS apart is its innovative approach of utilizing multiple prediction layers to aggregate information from various pathway levels. This unique multi-predictive-layer strategy greatly enhances the accuracy of the pathway-guided encoder’s predictions. The superior classification performance of CellTICS is demonstrated by applying it to several public datasets and comparing it with other cell-type annotation methods. More importantly, the interpretability of CellTICS provides clues about which pathway characteristics are essential to define a cell type or a cell type under a specific physiological condition. This information is often missed by traditional methods, making CellTICS a valuable tool for understanding the biology of cellular heterogeneity.</p>
    <p>The remaining sections of this article are organized as follows. In the “<xref rid="sec2" ref-type="sec">2</xref> Material and methods” section, an overview of the utilized datasets is provided, followed by a detailed explanation of the CellTICS model and its associated parameters, and the description of other methods used for comparison along with the evaluation criteria. In the “<xref rid="sec3" ref-type="sec">3</xref> Results and discussions” section, a comprehensive discussion of the results and innovative aspects of this work is undertaken. It commences with the presentation of cell-type and sub-cell-type annotation results. Following that, CellTICS’s capability to uncover novel pathways and their characteristics related to expression stochasticity are explored. Its application in the context of the aging process and autism spectrum disorder (ASD) is also examined. Finally, in the “<xref rid="sec4" ref-type="sec">4</xref> Conclusion” section, the study is drawn to a close by summarizing the key findings and insights derived from our research.</p>
  </sec>
  <sec id="sec2">
    <title>MATERIALS AND METHODS</title>
    <p>The schematic pipeline of CellTICS is shown in <xref rid="f1" ref-type="fig">Figure 1</xref>. In CellTICS, marker genes are selected based on their expression levels in the training set. The neural network is constructed as the hierarchy of Reactome pathways. A two-stage deep learning strategy is employed to predict both cell types and sub-cell types. In the first stage, a feedforward neural network is trained for cell-type prediction, with a predictive layer corresponding to each pathway hidden layer. Subsequently, in the second stage, multiple sub-neural networks are trained for sub-cell-type prediction, building upon the predicted outcomes from the first stage. Each sub-neural network is also equipped with multiple predictive layers for hidden layers. At each stage, prediction results from all predictive layers are aggregated through a voting mechanism. Furthermore, during the training procedure, important pathways that contribute to (sub-)cell-type prediction can be identified by comparing the activation values of neural networks corresponding to cells belonging to different cell types. More details are as follows.</p>
    <fig position="float" id="f1">
      <label>Figure 1</label>
      <caption>
        <p><bold>The pipeline of CellTICS.</bold> (<bold>A</bold>) Marker genes are prioritized by considering their cell-type-specific high and low expression measures. (<bold>B</bold>) The Reactome pathways are used to construct the network hierarchy. (<bold>C</bold>) A neural network constructed by the pathway hierarchy is trained and then used to predict cell types of the test set. The predicted results from all predictive layers are integrated by voting. (<bold>D</bold>) Based on the predicted results of the first stage, several sub-neural networks are trained for sub-cell-type prediction. Important pathways defining a cell type (or a sub-cell type) can be obtained by comparing their activation values across different cell types.</p>
      </caption>
      <graphic xlink:href="bbad449f1" position="float"/>
    </fig>
    <sec id="sec2a">
      <title>Datasets</title>
      <p>The capabilities of CellTICS were showcased using scRNA-seq data from three mouse brain studies [<xref rid="ref25" ref-type="bibr">25–27</xref>] and two human studies [<xref rid="ref28" ref-type="bibr">28</xref>, <xref rid="ref29" ref-type="bibr">29</xref>]. Its predictive accuracy was evaluated across a total of 10 analysis tasks, including both intra-dataset and inter-dataset predictions (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). The entire process of the data processing and handling is illustrated in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1</xref>.</p>
      <sec id="sec2a1">
        <title>Raw scRNA-seq data processing</title>
        <p>The detailed datasets used in this study included the level-5 mouse brain data (L5MB), DropViz hippocampus (DropViz HC), DropViz frontal cortex (DropViz FC), and human peripheral blood mononuclear (PBMC) data, all of which were initially in raw read count format. In contrast, the aging mouse brain (AMB) and autism spectrum disorder (ASD) data were first scaled to 10,000 transcripts per cell and then subjected to logarithmically transformed. As a result, a normalization step was necessary for the L5MB, DropViz HC, DropViz FC, and PBMC data.</p>
        <p>Let us denote <inline-formula><tex-math notation="LaTeX" id="ImEquation1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$expr_{c,g}$\end{document}</tex-math></inline-formula> as the normalized expression measure for gene <inline-formula><tex-math notation="LaTeX" id="ImEquation2">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$g$\end{document}</tex-math></inline-formula> in cell <inline-formula><tex-math notation="LaTeX" id="ImEquation3">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$c$\end{document}</tex-math></inline-formula>. The normalization is performed as Equation <xref rid="deqn01" ref-type="disp-formula">1</xref>, where <inline-formula><tex-math notation="LaTeX" id="ImEquation4">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$m_{c,g}$\end{document}</tex-math></inline-formula> is the gene-level read count (UMI-based), and <inline-formula><tex-math notation="LaTeX" id="ImEquation5">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$G$\end{document}</tex-math></inline-formula> is the total number of genes. Subsequently, quality control for all data was performed by the R package scater [<xref rid="ref30" ref-type="bibr">30</xref>], filtering out cells and genes with poor quality. </p>
        <disp-formula id="deqn01">
          <label>(1)</label>
          <tex-math notation="LaTeX" id="DmEquation1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*}&amp; expr_{c,g}=log_{2}\left(10000\frac{m_{c,g}}{\sum_{g^{\prime}=1}^{G}m_{c,g^{\prime}}}+1\right)\end{align*}\end{document}</tex-math>
        </disp-formula>
      </sec>
      <sec id="sec2a2">
        <title>Training sets and test sets preparation</title>
        <p>The L5MB, DropViz HC and DropViz FC datasets contained information on cell types and sub-cell types. To represent intra-dataset predictions, these datasets were split into a training set and a test set using the R package caret [<xref rid="ref31" ref-type="bibr">31</xref>] with 75% of the original data allocated to the training set, stratified by cell types.</p>
        <p>The AMB data contained mouse brain cells for the young and old age groups as well as their cell types and sub-cell types. We created three analysis tasks based on the data. The first one was the original whole dataset (AMB whole), incorporating age status into the cell-type labels to create our own sub-cell-type labels (e.g. old-cell-type-A versus young-cell-type-A). Next, the AMB whole dataset was split into a training set and a test set with 75% of the original data allocated to the training set, stratified by cell types. The other two analysis tasks were designed for inter-dataset prediction for both cell types and original sub-cell types. Specifically, the old data were treated as the training set and the young data as the test set (AMB OY), or vice versa (AMB YO).</p>
        <p>The PBMC data were sequenced by the 10X Genomics v2 (10Xv2), the 10X Genomics v3 (10Xv3) and the Drop-seq protocols. The three major cell type groups were lymphoid cells (including sub-cell types: B cells, CD4 T cells, cytotoxic T cells and natural killer cells), myeloid cells (including sub-cell types: CD14+ monocytes, CD16+ monocytes, dendritic cells and plasmacytoid dendritic cells) and megakaryocytes [<xref rid="ref32" ref-type="bibr">32</xref>]. Based on the PBMC data, three analysis tasks were created to test the cross-protocol prediction, a special case of inter-dataset prediction. Firstly, the 10Xv3 data were used as the training set, and the 10Xv2 data were the test set (PBMC 32). Secondly, the 10Xv2 data were the training set, and the Drop-seq data were the test set (PBMC 2D). Lastly, the Drop-seq data were the training set, and the 10Xv3 data were the test set (PBMC D3).</p>
        <p>The ASD data contained human brain data for the ASD and control groups. To explore the mechanism of ASD at the cell-type level, this work incorporated the disease status into the cell-type labels to create the sub-cell-type labels (e.g. ASD-cell-type-A versus control-cell-type-A). This study focused exclusively on 11 neuron cell types, namely L2/3, L4, L5/6, L5/6-CC, IN-PV, IN-SST, IN-SV2C, IN-VIP, Neu-mat, Neu-NRGN-I and Neu-NRGN-II. Subsequently, the dataset was split into a training set and a test set with 75% of the original data allocated to the training set, stratified by cell types. The processed data were written into CSV files and uploaded to Zenodo (see ‘Code and Data Availability’). The CSV file sizes have also been included in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>.</p>
      </sec>
    </sec>
    <sec id="sec2d">
      <title>The CellTICS model</title>
      <sec id="sec2d1">
        <title>Marker gene prioritization</title>
        <p>A feature selection step was performed to prioritize marker genes, which could help enhance the prediction performance of the CellTICS model. The cell-type-specific high expression measure for a gene <inline-formula><tex-math notation="LaTeX" id="ImEquation6">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$g$\end{document}</tex-math></inline-formula> in cell type <inline-formula><tex-math notation="LaTeX" id="ImEquation7">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$t$\end{document}</tex-math></inline-formula> is defined as Equation <xref rid="deqn02" ref-type="disp-formula">2</xref>, where <inline-formula><tex-math notation="LaTeX" id="ImEquation8">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\tau _{g}$\end{document}</tex-math></inline-formula>, <inline-formula><tex-math notation="LaTeX" id="ImEquation9">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\hat{x}_{t,g}$\end{document}</tex-math></inline-formula> are determined by Equation <xref rid="deqn03" ref-type="disp-formula">3</xref> and Equation <xref rid="deqn04" ref-type="disp-formula">4</xref>. Here, <inline-formula><tex-math notation="LaTeX" id="ImEquation10">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$n$\end{document}</tex-math></inline-formula> is the total number of cell types, and <inline-formula><tex-math notation="LaTeX" id="ImEquation11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$expr_{t,g}$\end{document}</tex-math></inline-formula> is the normalized expression measure for the gene in cell type <inline-formula><tex-math notation="LaTeX" id="ImEquation12">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$t$\end{document}</tex-math></inline-formula>. Pseudo number 1 is added to avoid extremely large fold changes among lowly expressed genes. Thus, <inline-formula><tex-math notation="LaTeX" id="ImEquation13">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$0\leq \varphi _{t,g}\leq 1$\end{document}</tex-math></inline-formula>. The cell-type-specificity measure is a modification of the tissue-specificity measure proposed by Jiang et al. [<xref rid="ref33" ref-type="bibr">33</xref>]. A larger <inline-formula><tex-math notation="LaTeX" id="ImEquation14">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\varphi _{t,g}$\end{document}</tex-math></inline-formula> value suggests that the gene is specifically highly expressed in this cell type. For the cell type with the maximum expression, <inline-formula><tex-math notation="LaTeX" id="ImEquation15">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\varphi _{t,g}=\tau _{g}$\end{document}</tex-math></inline-formula>, otherwise <inline-formula><tex-math notation="LaTeX" id="ImEquation16">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\varphi _{t,g}&lt;\tau _{g}$\end{document}</tex-math></inline-formula>. </p>
        <disp-formula id="deqn02">
          <label>(2)</label>
          <tex-math notation="LaTeX" id="DmEquation2">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*} &amp; \varphi_{t,g}=\tau_{g}\hat{x}_{t,g} \end{align*}\end{document}</tex-math>
        </disp-formula>
        <disp-formula id="deqn03">
          <label>(3)</label>
          <tex-math notation="LaTeX" id="DmEquation3">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*} &amp; \tau_{g}=\frac{\sum_{t=1}^{n}(1-\hat{x}_{t,g})}{n-1} \end{align*}\end{document}</tex-math>
        </disp-formula>
        <disp-formula id="deqn04">
          <label>(4)</label>
          <tex-math notation="LaTeX" id="DmEquation4">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*} &amp; \hat{x}_{t,g}=\frac{expr_{t,g}+1}{\max_{1\leq t^{\prime}\leq n}expr_{t^{\prime},g}+1} \end{align*}\end{document}</tex-math>
        </disp-formula>
        <p>Similarly, the cell-type-specific low expression measure for a gene <inline-formula><tex-math notation="LaTeX" id="ImEquation17">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$g$\end{document}</tex-math></inline-formula> in cell type <inline-formula><tex-math notation="LaTeX" id="ImEquation18">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$t$\end{document}</tex-math></inline-formula> is defined as Equation <xref rid="deqn05" ref-type="disp-formula">5</xref>, where <inline-formula><tex-math notation="LaTeX" id="ImEquation19">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\omega _{g}$\end{document}</tex-math></inline-formula>, <inline-formula><tex-math notation="LaTeX" id="ImEquation20">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\hat{z}_{t,g}$\end{document}</tex-math></inline-formula> are determined by Equation <xref rid="deqn06" ref-type="disp-formula">6</xref> and Equation <xref rid="deqn07" ref-type="disp-formula">7</xref>. Thus, <inline-formula><tex-math notation="LaTeX" id="ImEquation21">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$0\leq \rho _{t,g}\leq 1$\end{document}</tex-math></inline-formula>. A larger <inline-formula><tex-math notation="LaTeX" id="ImEquation22">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\rho _{t,g}$\end{document}</tex-math></inline-formula> value suggests that the gene is specifically lowly expressed in this cell type. </p>
        <disp-formula id="deqn05">
          <label>(5)</label>
          <tex-math notation="LaTeX" id="DmEquation5">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*} &amp; \rho_{t,g}=\omega_{g}\hat{z}_{t,g} \end{align*}\end{document}</tex-math>
        </disp-formula>
        <disp-formula id="deqn06">
          <label>(6)</label>
          <tex-math notation="LaTeX" id="DmEquation6">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*} &amp; \omega_{g}=\frac{\sum_{t=1}^{n}(1-\hat{z}_{t,g})}{n-1} \end{align*}\end{document}</tex-math>
        </disp-formula>
        <disp-formula id="deqn07">
          <label>(7)</label>
          <tex-math notation="LaTeX" id="DmEquation7">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*} &amp; \hat{z}_{t,g}=\frac{\min_{1\leq t^{\prime}\leq n}expr_{t^{\prime},g}+1}{expr_{t,g}+1} \end{align*}\end{document}</tex-math>
        </disp-formula>
        <p>To select cell-type-specific highly expressed or lowly expressed genes, for a gene <inline-formula><tex-math notation="LaTeX" id="ImEquation23">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$g$\end{document}</tex-math></inline-formula> in cell type <inline-formula><tex-math notation="LaTeX" id="ImEquation24">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$t$\end{document}</tex-math></inline-formula>, if <inline-formula><tex-math notation="LaTeX" id="ImEquation25">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\varphi _{t,g}$\end{document}</tex-math></inline-formula> was greater than the <inline-formula><tex-math notation="LaTeX" id="ImEquation26">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$100\alpha $\end{document}</tex-math></inline-formula>th quantile of <inline-formula><tex-math notation="LaTeX" id="ImEquation27">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\varphi $\end{document}</tex-math></inline-formula> in cell type <inline-formula><tex-math notation="LaTeX" id="ImEquation28">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$t$\end{document}</tex-math></inline-formula>, the gene would be selected as a marker gene for the cell type. Similarly, for another gene <inline-formula><tex-math notation="LaTeX" id="ImEquation29">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$g^{\prime}$\end{document}</tex-math></inline-formula> in cell type <inline-formula><tex-math notation="LaTeX" id="ImEquation30">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$t^{\prime}$\end{document}</tex-math></inline-formula>, if <inline-formula><tex-math notation="LaTeX" id="ImEquation31">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\rho _{t^{\prime},g^{\prime}}$\end{document}</tex-math></inline-formula> was greater than the <inline-formula><tex-math notation="LaTeX" id="ImEquation32">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$100\beta $\end{document}</tex-math></inline-formula>th quantile of <inline-formula><tex-math notation="LaTeX" id="ImEquation33">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\rho $\end{document}</tex-math></inline-formula> in cell type <inline-formula><tex-math notation="LaTeX" id="ImEquation34">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$t^{\prime}$\end{document}</tex-math></inline-formula>, the gene would be also selected as a marker gene for the cell type. All marker genes from all cell types were combined as the result of the feature selection step. These marker genes were used to compress both the training set and the test set.</p>
      </sec>
      <sec id="sec2d2">
        <title>Pathway hierarchy</title>
        <p>All levels of the pathway hierarchy were acquired from the Reactome database, which could be represented as a tree. The pathway hierarchies for mice, humans, and rats were available in CellTICS. The tree was composed of internal nodes representing hierarchical pathways and leaves representing genes. Pathways at the highest level were connected to the root node, and edges and nodes not related to the selected marker genes were excluded. To formally formulate the network, the parameter <inline-formula><tex-math notation="LaTeX" id="ImEquation35">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$l$\end{document}</tex-math></inline-formula> was introduced to specify the number of considered levels (i.e. the number of hidden layers of the neural network). When <inline-formula><tex-math notation="LaTeX" id="ImEquation36">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$l$\end{document}</tex-math></inline-formula> was specified, a subtree of the original tree could be constructed. If the upper depth of a leaf was larger than <inline-formula><tex-math notation="LaTeX" id="ImEquation37">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$l$\end{document}</tex-math></inline-formula>, the excessive parental level(s) of the leave would be excluded and the leaf would be connected to upper-level pathways. If the upper depth of a leaf was smaller than <inline-formula><tex-math notation="LaTeX" id="ImEquation38">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$l$\end{document}</tex-math></inline-formula>, artificial nodes would be added to represent the parents of the leaf. From the subtree, a binary mask matrix <inline-formula><tex-math notation="LaTeX" id="ImEquation39">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$M$\end{document}</tex-math></inline-formula> was generated to suggest the connectivity of two entities in adjacent layers. If the two entities had no connection, the corresponding entry in <inline-formula><tex-math notation="LaTeX" id="ImEquation40">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$M$\end{document}</tex-math></inline-formula> was 0; otherwise, it would be 1.</p>
      </sec>
      <sec id="sec2d3">
        <title>Neural network construction</title>
        <p>A feedforward neural network was constructed based on the mask matrix. We first trained the network for cell-type prediction and then trained several sub-neural networks for sub-cell-type prediction. Thus, after obtaining the predicted cell types for the test set, the test set was divided into subsets based on these predictions, and similarly, the training set was separated based on the true cell types. Then, sub-cell-type prediction was performed for each cell type.</p>
        <p>The detailed architecture of the CellTICS neural network is shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2</xref>. In the neural network, each node represents an entity such as a gene, pathway, or cell type, and each edge represents the relationship between the entities connected by the edge. The input layer comprises a set of genes. The input data are the expression level of these genes, whose dimension is the number of genes assigned to the bottom pathway level. For each layer, the input is denoted as <inline-formula><tex-math notation="LaTeX" id="ImEquation41">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$x$\end{document}</tex-math></inline-formula> and the output is denoted as <inline-formula><tex-math notation="LaTeX" id="ImEquation42">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$y$\end{document}</tex-math></inline-formula>. The output of the layer is calculated using Equation <xref rid="deqn08" ref-type="disp-formula">8</xref>, where <inline-formula><tex-math notation="LaTeX" id="ImEquation43">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$f$\end{document}</tex-math></inline-formula> is the activation function, <inline-formula><tex-math notation="LaTeX" id="ImEquation44">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$M$\end{document}</tex-math></inline-formula> is the mask matrix, <inline-formula><tex-math notation="LaTeX" id="ImEquation45">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$W$\end{document}</tex-math></inline-formula> is the weight matrix, and <inline-formula><tex-math notation="LaTeX" id="ImEquation46">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$b$\end{document}</tex-math></inline-formula> is the bias vector. Here <inline-formula><tex-math notation="LaTeX" id="ImEquation47">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$MW$\end{document}</tex-math></inline-formula> is the element-wise multiplication of <inline-formula><tex-math notation="LaTeX" id="ImEquation48">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$M$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ImEquation49">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$W$\end{document}</tex-math></inline-formula> (i.e. Hadamard product). The activation function is the tanh function (Equation <xref rid="deqn09" ref-type="disp-formula">9</xref>). The activation values are related to the importance measures of pathways, and they will be elaborated upon in <xref rid="sec2d4" ref-type="sec">2.2.4</xref>. The dimension of each hidden layer is in accordance with the mask matrix <inline-formula><tex-math notation="LaTeX" id="ImEquation50">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$M$\end{document}</tex-math></inline-formula>. To obtain the prediction for each cell, a predictive layer is added after each hidden layer. The dimension of each prediction layer equals the number of cell types. The probability of a cell being classified as the <inline-formula><tex-math notation="LaTeX" id="ImEquation51">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$i$\end{document}</tex-math></inline-formula>th cell type is calculated using the softmax function (Equation <xref rid="deqn10" ref-type="disp-formula">10</xref>), where <inline-formula><tex-math notation="LaTeX" id="ImEquation52">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C$\end{document}</tex-math></inline-formula> is the total number of cell types and <inline-formula><tex-math notation="LaTeX" id="ImEquation53">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$z$\end{document}</tex-math></inline-formula> is the input of the softmax function. The cell is assigned to the class with the highest probability. Finally, the predictions from all predictive layers are integrated by voting to obtain the final prediction result. </p>
        <disp-formula id="deqn08">
          <label>(8)</label>
          <tex-math notation="LaTeX" id="DmEquation8">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*} &amp; y=f[(MW)x+b] \end{align*}\end{document}</tex-math>
        </disp-formula>
        <disp-formula id="deqn09">
          <label>(9)</label>
          <tex-math notation="LaTeX" id="DmEquation9">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*} &amp; f=tanh(z)=\frac{e^{z}-e^{-z}}{e^{z}+e^{-z}} \end{align*}\end{document}</tex-math>
        </disp-formula>
        <disp-formula id="deqn10">
          <label>(10)</label>
          <tex-math notation="LaTeX" id="DmEquation10">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*} &amp; \sigma_{i}=\frac{e^{z_{i}}}{\sum_{c=1}^{C}e^{z_{c}}} \end{align*}\end{document}</tex-math>
        </disp-formula>
      </sec>
      <sec id="sec2d4">
        <title>Important pathway identification</title>
        <p>To identify important pathways for distinguishing each (sub-) cell type, CellTICS utilized activation values during the training procedure. Specifically, the activation values were calculated for each pathway in every layer in the CellTICS neural network. For a given pathway <inline-formula><tex-math notation="LaTeX" id="ImEquation54">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p$\end{document}</tex-math></inline-formula> and cell type <inline-formula><tex-math notation="LaTeX" id="ImEquation55">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$t$\end{document}</tex-math></inline-formula>, the average activation value (<inline-formula><tex-math notation="LaTeX" id="ImEquation56">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$A_{t,p}$\end{document}</tex-math></inline-formula>) was computed across all cells of that type. These average activation values were then sorted in descending order across all cell types, obtaining a list (<inline-formula><tex-math notation="LaTeX" id="ImEquation57">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$A_{(1),p}$\end{document}</tex-math></inline-formula>,<inline-formula><tex-math notation="LaTeX" id="ImEquation58">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$A_{(2),p}$\end{document}</tex-math></inline-formula>,...,<inline-formula><tex-math notation="LaTeX" id="ImEquation59">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$A_{(T),p}$\end{document}</tex-math></inline-formula>), where <inline-formula><tex-math notation="LaTeX" id="ImEquation60">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T$\end{document}</tex-math></inline-formula> is the total number of cell types. To quantify the importance of pathway <inline-formula><tex-math notation="LaTeX" id="ImEquation61">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p$\end{document}</tex-math></inline-formula>, the difference between the first and second largest average activation values, Equation <xref rid="deqn11" ref-type="disp-formula">11</xref>, was computed. Due to the possibility of a pathway <inline-formula><tex-math notation="LaTeX" id="ImEquation62">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p$\end{document}</tex-math></inline-formula> being included in the paths of multiple prediction layers, there might be several <inline-formula><tex-math notation="LaTeX" id="ImEquation63">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$d_{p}$\end{document}</tex-math></inline-formula> values. For instance, a pathway located on the first hidden layer (level 1) could be present in the network paths leading to prediction level 1, level 2, and so on, until the final hidden layer was reached. Hence, the maximum value of <inline-formula><tex-math notation="LaTeX" id="ImEquation64">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$d_{p}$\end{document}</tex-math></inline-formula> among all paths of such nested networks was selected as the final importance measure of the pathway and denoted as <inline-formula><tex-math notation="LaTeX" id="ImEquation65">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula>. If the importance value <inline-formula><tex-math notation="LaTeX" id="ImEquation66">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> exceeded a predefined threshold (default: 0.1), pathway <inline-formula><tex-math notation="LaTeX" id="ImEquation67">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p$\end{document}</tex-math></inline-formula> would be deemed important for the cell type corresponding to <inline-formula><tex-math notation="LaTeX" id="ImEquation68">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$A_{(1),p}$\end{document}</tex-math></inline-formula>. </p>
        <disp-formula id="deqn11">
          <label>(11)</label>
          <tex-math notation="LaTeX" id="DmEquation11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*}&amp; d_{p}=A_{(1),p}-A_{(2),p}\end{align*}\end{document}</tex-math>
        </disp-formula>
      </sec>
    </sec>
    <sec id="sec2i">
      <title>Parameter settings</title>
      <p>The CellTICS model was trained by the Adam optimizer with the cross-entropy loss function with L2 regularization. To optimize the performance of the CellTICS model, the parameters were tuned using grid search with 5-fold cross-validation. The default values for threshold values (<inline-formula><tex-math notation="LaTeX" id="ImEquation69">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\alpha $\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ImEquation70">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\beta $\end{document}</tex-math></inline-formula>) are 0.95 and 0.9, respectively. The default value for the number of hidden layers of the neural network (<inline-formula><tex-math notation="LaTeX" id="ImEquation71">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$l$\end{document}</tex-math></inline-formula>) is 5. The default hyperparameters for the minibatch size, learning rate, and regularization parameter are 32, 0.001, and 0.0001, respectively. The default number of epochs is 10 for cell-type prediction and 50 for sub-cell-type prediction.</p>
    </sec>
    <sec id="sec2j">
      <title>Method comparison</title>
      <p>This work compared the performance of CellTICS with six other methods to evaluate its predictive performance. The compared methods were SingleR [<xref rid="ref34" ref-type="bibr">34</xref>], scmap [<xref rid="ref35" ref-type="bibr">35</xref>] (containing scmap-cluster and scmap-cell), CHETAH [<xref rid="ref36" ref-type="bibr">36</xref>], scPred [<xref rid="ref37" ref-type="bibr">37</xref>], and ACTINN [<xref rid="ref3" ref-type="bibr">3</xref>]. We selected these specific models based on their representation of major categories within cell type annotation methods, encompassing correlation-based methods (SingleR, scmap, and CHETAH), supervised classification-based methods (scPred), and traditional neural networks (ACTINN) [<xref rid="ref38" ref-type="bibr">38</xref>]. Noteworthy, we compared CellTICS with ACTINN, a traditional neural network-based method. This choice was made to assess CellTICS’s proficiency in accurate cell classification and check whether its interpretability sacrifices the prediction accuracy. The default parameter settings of these tools were used unless mentioned otherwise. For scmap, the unassigned threshold, which represents a similarity threshold, was set to <inline-formula><tex-math notation="LaTeX" id="ImEquation72">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$-1$\end{document}</tex-math></inline-formula>.</p>
    </sec>
    <sec id="sec2k">
      <title>Evaluation criteria</title>
      <sec id="sec2k1">
        <title>Evaluation of cell type prediction</title>
        <p>The performance of CellTICS and the compared methods were evaluated using two metrics: accuracy (ACC) and macro-averaged F1 scores (macro F1 scores). ACC measures the percentage of cells correctly classified, while the F1 score is the harmonic mean of precision and recall. The macro F1 score is computed by taking the arithmetic mean of all per-class F1 scores and is useful when dealing with class imbalance problems, which are common in cell-type classification.</p>
      </sec>
      <sec id="sec2k2">
        <title>Evaluation of important pathway identification</title>
        <p>To demonstrate the unique advantages of CellTICS in identifying cell-type important pathways, the gene set enrichment analysis (GSEA) [<xref rid="ref39" ref-type="bibr">39</xref>] was utilized for comparison. GSEA is a method for evaluating cumulative changes in the expression of multiple genes belonging to a gene set (i.e. a pathway). It can be used to identify pathways exhibiting differential gene expression between cell types, between the young and old cells of a specific cell type, or between diseased and healthy cells of a cell type.</p>
        <p>The logarithmic fold change (logFC) was calculated as a differential expression measure for a gene by computing the difference of average log-normalized count data in different groups. Subsequently, the R package ReactomePA [<xref rid="ref40" ref-type="bibr">40</xref>] was used to perform GSEA and identify important pathways with a <italic toggle="yes">P</italic>-value less than 0.05. Finally, the important pathways found by CellTICS and GSEA were compared.</p>
        <p>For pathways identified by CellTICS but not by GSEA, Wilcoxon signed-rank tests were further performed to examine the variation difference, instead of the traditional mean difference, between groups. Thus, for each important pathway identified by CellTICS, the coefficient of variation (CV) of all genes in both groups (e.g. cells of cell type A versus other cells, or old cells of cell type A versus young cells of cell type A) was calculated. Consequently, a Wilcoxon signed-rank test on the CV values of the two groups was performed to assess the significance of variation differences.</p>
      </sec>
    </sec>
  </sec>
  <sec id="sec3">
    <title>RESULTS AND DISCUSSIONS</title>
    <sec id="sec3a">
      <title>Identification of cell and sub-cell types</title>
      <p>To illustrate the predictive power of CellTICS for (sub-)cell-type identification, we compared CellTICS with six other methods for 10 analysis tasks (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). The procedure was repeated five times across all datasets, and the average ACC and macro F1 scores were computed.</p>
      <p>The results for the cell-type identification and the sub-cell-type identification are shown in <xref rid="f2" ref-type="fig">Figure 2</xref>. Clearly, CellTICS outperforms the other methods in almost all datasets, since the performance of CellTICS is usually the best, that is, exhibiting higher scores and smaller performance variations. Although most methods can obtain high ACC for major cell type identification (<xref rid="f2" ref-type="fig">Figure 2A</xref>), the sensitivity of many methods is not satisfactory enough as reflected by the low macro F1 scores in <xref rid="f2" ref-type="fig">Figure 2B</xref>. However, CellTICS stands out with an average macro F1 score between 0.9406 and 0.9993 for the considered datasets. Classifying sub-cell types is a more challenging task, while CellTICS is still superior in most methods (<xref rid="f2" ref-type="fig">Figure 2C</xref> and <xref rid="f2" ref-type="fig">Figure 2D</xref>). The performance of these models for each analysis task is illustrated in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S3</xref>.</p>
      <fig position="float" id="f2">
        <label>Figure 2</label>
        <caption>
          <p><bold>The prediction performance of CellTICS and other cell-type identification methods.</bold> A total of 10 analysis tasks were conducted to generate the boxplots. In each of these tasks, the average ACC and macro F1 scores based on five analysis repeats were used. (<bold>A</bold>) The ACC for cell-type identification. (<bold>B</bold>) The macro F1 score for cell-type identification. (<bold>C</bold>) The ACC for sub-cell-type identification. (<bold>D</bold>) The macro F1 score for sub-cell-type identification.</p>
        </caption>
        <graphic xlink:href="bbad449f2" position="float"/>
      </fig>
      <p>We also compared CellTICS with the original marker gene selection to CellTICS with highly variable gene (HVG) selection (top 2,000, 5,000, or 10,000 HVGs). As shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S4</xref>, the performance of original CellTICS is significantly better than using the top 2,000 HVGs, while it is comparable with using the top 5,000 and 10,000 HVGs. In the ASD data analysis, CellTICS’s marker gene prioritization performs much better than the HVG approaches (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figures S4A</xref>–<xref rid="sup1" ref-type="supplementary-material">D</xref>).</p>
      <p>CellTICS is robust in cell type and sub-cell type identification. We ran CellTICS 20 times and observed very small variations in the accuracy and macro F1 scores for all cell type prediction and sub-cell type prediction (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S5</xref>). Also, CellTICS is computationally efficient. As shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>, for the L5MB dataset which included about 20,000 cells and about 28,000 genes, the whole runtime (including training and testing) was about 23 min.</p>
      <p>One major distinctive part of CellTICS is the multi-predictive-layer strategy, which greatly improves the prediction accuracy and prediction power. <xref rid="f3" ref-type="fig">Figure 3</xref> demonstrates the effectiveness of this strategy by comparing the performance of the original CellTICS with that of CellTICS containing only one prediction layer on the L5MB dataset. The results show that multiple prediction layers can significantly enhance the ACC and macro F1 score of the predictions. For cell type classification, the ACC is improved from 0.7711 to 0.9997, while the macro F1 score is improved from 0.1244 to 0.9878. In sub-cell type classification, the improvement is even more significant, with the ACC increasing from 0.0303 to 0.9035 and the macro F1 score increasing from 0.0003 to 0.7142. These findings demonstrate that the multi-predictive-layer strategy adopted by CellTICS can substantially improve the accuracy of predictions, providing a more nuanced and comprehensive understanding of cell heterogeneity and disease processes. The key advantage of this approach is that it allows for the aggregation of information from different levels of pathway hierarchy, particularly those at the bottom levels which represent more detailed pathways. By leveraging the unique information content available at each level, the network can capture both the broad functional relationships between pathways and the more specific functional roles played by individual pathways.</p>
      <fig position="float" id="f3">
        <label>Figure 3</label>
        <caption>
          <p><bold>The importance of the multi-predictive-layer strategy.</bold> The average ACC and macro F1 scores of the original CellTICS and CellTICS with only one prediction layer are shown for cell-type and sub-cell-type identification on the L5MB dataset.</p>
        </caption>
        <graphic xlink:href="bbad449f3" position="float"/>
      </fig>
      <p>Another noteworthy property of CellTICS is its ability to make predictions at the sub-cell-type level. CellTICS outperforms most methods in most cases (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figures S3C</xref>–<xref rid="sup1" ref-type="supplementary-material">D</xref>), even for the L5MB dataset, where the number of sub-cell types is relatively large (i.e. 220). It also implies that CellTICS has the potential to handle the class imbalance problem since the percentage of sub-cell types in the L5MB test set varies from 0.01 to 5.01%. The success in predicting sub-cell types suggests that CellTICS can better facilitate the construction of cell atlas in complex tissues to a deeper level. At this level, the identification of rare cell types might hold special significance [<xref rid="ref41" ref-type="bibr">41</xref>]. Rare cell types are sporadic within a large population of cells, and their marker genes may exhibit very weak signals. However, CellTICS can capture these signals by incorporating both highly and lowly expressed marker genes of all cell types. Particularly, the inclusion of cell-type-specific lowly expressed genes offers valuable insights as their expression remains uniquely low in certain cell types, which is often overlooked in traditional marker gene prioritization. The comparison between CellTICS’s marker genes and HVGs supports this assertion.</p>
      <p>The trade-off between interpretability and prediction accuracy for deep neural networks is a common challenge in machine learning. As the complexity of the model increases to achieve higher accuracy, its interpretability tends to decrease. However, the hidden layers of CellTICS follow the pathway hierarchy and reflect the real relationships between pathway nodes in a cell. The above results and discussions show that CellTICS can achieve high prediction accuracy. In the following sections, CellTICS’s interpretability will be demonstrated.</p>
    </sec>
    <sec id="sec3b">
      <title>CellTICS identifies important pathways missed by GSEA</title>
      <p>Many deep learning models designed for cell type annotation lack the ability to uncover what defines a cell type, which has prompted us to emphasize achieving biological interpretability. In addition to predicting cell types accurately and identifying the genes that contribute to the prediction (i.e. important features), CellTICS can also pinpoint important pathways (i.e. important neurons in the neural network architecture) that define (sub-) cell types or cell types under a specific physiological condition. This capability represents the most distinctive aspect of this study. Traditionally GSEA is typically used to identify pathways with enriched gene expression changes between cell types. In this section, the comparison between the two approaches will be shown.</p>
      <p>For the AMB whole dataset, we compared the important pathways of each cell type identified by CellTICS with those by GSEA and also compared the results for distinguishing old cells from young cells of a specific cell type. As shown in <xref rid="f4" ref-type="fig">Figure 4A</xref>, CellTICS and GSEA share some important pathways for both cell type classification and aging status classification. Moreover, CellTICS discovers many important pathways missed by GSEA, as it can identify nonlinear characteristics of the pathway and capture potential interactions among genes. Some pathways identified by GSEA are not essential in defining cell types, suggesting that the simple add-up of differential signals of genes in a pathway is not necessarily an important cell-type-specific characteristic.</p>
      <fig position="float" id="f4">
        <label>Figure 4</label>
        <caption>
          <p><bold>Comparison between CellTICS and GSEA.</bold> (<bold>A</bold>) The number of important pathways distinguishing cell types or age groups identified by CellTICS (<inline-formula><tex-math notation="LaTeX" id="ImEquation73">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}\geq 0.1$\end{document}</tex-math></inline-formula>) or GSEA. Pathways important for either old or young cells across all cell types are combined for the “Old or young cells” category. (<bold>B</bold>) Shared pathways between CellTICS and GSEA. The cumulative fraction of pathways identified by GSEA is plotted along pathways with decreasing <inline-formula><tex-math notation="LaTeX" id="ImEquation74">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> values in CellTICS.</p>
        </caption>
        <graphic xlink:href="bbad449f4" position="float"/>
      </fig>
      <p>Generally, pathways with larger importance scores of CellTICS (<inline-formula><tex-math notation="LaTeX" id="ImEquation75">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> values) are more likely to be identified by GSEA (<xref rid="f4" ref-type="fig">Figure 4B</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S6</xref>). In <xref rid="f4" ref-type="fig">Figure 4B</xref>, pathways from CellTICS are sorted by <inline-formula><tex-math notation="LaTeX" id="ImEquation76">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> in descending order, and the cumulative fraction of pathways shared between CellTICS and GSEA is shown. The overlapping fraction is generally higher for pathways with higher <inline-formula><tex-math notation="LaTeX" id="ImEquation77">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> values. Although the number of pathways passing the <inline-formula><tex-math notation="LaTeX" id="ImEquation78">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> threshold of 0.1 is small for VASC (vascular), OLG (oligodendrocyte), and EPC (ependymocyte) cells (<xref rid="f4" ref-type="fig">Figure 4A</xref>), the pattern still holds for these cell types when ordering pathways by <inline-formula><tex-math notation="LaTeX" id="ImEquation79">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> without imposing a cutoff (<xref rid="f4" ref-type="fig">Figure 4B</xref>). Alternatively, the <inline-formula><tex-math notation="LaTeX" id="ImEquation80">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> threshold was adjusted from 0.1 to 0.2 and 0.3 for CellTICS and then compared the results with GSEA. As shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S6</xref>, the overlapping fractions are higher when the threshold for CellTICS is more stringent.</p>
      <p>The advantage of CellTICS over GSEA is that CellTICS can aggregate differential signals nonlinearly via a neural network approach, while GSEA aggregates the differential signals from individual genes of the same pathway in a linear way. Additionally, CellTICS compares the average activation scores of a pathway between the considered cell type and all other cell types in a pairwise fashion. However, GSEA pools all other cell types together and compares them with the considered cell type.</p>
      <p>Knowing pathways that define a (sub-)cell type is particularly valuable because it allows for a better understanding of the molecule dynamics of the cell and how they contribute to predicting a (sub-)cell type. By uncovering cell-type-specific pathways, CellTICS provides a more comprehensive and interpretable view of the underlying biological processes.</p>
    </sec>
    <sec id="sec3c">
      <title>Expression stochasticity of a pathway could be cell-type specific</title>
      <p>As shown in <xref rid="sec3b" ref-type="sec">3.2</xref>, some pathways identified by CellTICS do not show significant differential gene expression at the individual gene level and are not identified by GSEA. To explore their underlying mechanisms, we tested the hypothesis that a pathway’s expression stochasticity, measured by the coefficient of variation, could be a cell-type-specific characteristic. For the AMB whole dataset, a Wilcoxon signed-rank test was performed on the coefficient of variation values of two groups (cell type A versus other cell types, or old cells of cell type A versus young cells of cell type A) for the important pathways discovered by CellTICS but not by GSEA. Interestingly, among the eight important pathways (with a <inline-formula><tex-math notation="LaTeX" id="ImEquation81">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> threshold of 0.3 and not identified by GSEA) for the aging-related pathway discovery, seven of them were discovered in EPCs. Therefore, the differential variation results for pathways related to EPCs are presented in <xref rid="f5" ref-type="fig">Figure 5</xref>. Three out of the seven (<xref rid="f5" ref-type="fig">Figure 5A</xref>) pathways uniquely identified by CellTICS exhibit a significant difference in expression stochasticity between old and young EPCs, and 10 out of 12 (<xref rid="f5" ref-type="fig">Figure 5B</xref>) pathways did so for the comparison between EPCs and other cells (<italic toggle="yes">P</italic>-value <inline-formula><tex-math notation="LaTeX" id="ImEquation82">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\leq 0.05$\end{document}</tex-math></inline-formula>, Wilcoxon tests on CVs). Results for other cell types are shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figures S7</xref>–<xref rid="sup1" ref-type="supplementary-material">S11</xref>, with 14.3–61.1% of their important pathways passing the Wilcoxon tests. These results suggest that expression stochasticity within a pathway could be an essential feature for defining a cell type or a specific age group, which is distinctive for a cell type annotation model. Other studies have also reported that expression stochasticity is important and may affect organism functionality, viability, and flexibility to adapt to environments [<xref rid="ref42" ref-type="bibr">42–44</xref>].</p>
      <fig position="float" id="f5">
        <label>Figure 5</label>
        <caption>
          <p><bold>Important pathways exhibiting differential expression stochasticity.</bold> The differential expression stochasticity of pathways is assessed by Wilcoxon tests for (<bold>A</bold>) different age groups of ependymocytes or (<bold>B</bold>) ependymocytes versus other cell types. Only pathways with <inline-formula><tex-math notation="LaTeX" id="ImEquation83">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p} \geq 0.3$\end{document}</tex-math></inline-formula> in CellTICS but not identified by GSEA are shown. The red dashed lines mark the <italic toggle="yes">P</italic>-value cutoff of 0.05.</p>
        </caption>
        <graphic xlink:href="bbad449f5" position="float"/>
      </fig>
      <p>Based on the findings in <xref rid="f5" ref-type="fig">Figure 5A</xref>, ‘mitotic anaphase’ emerges as one of the most significant important pathways to distinguish age groups of EPCs. According to Hu et al. [<xref rid="ref45" ref-type="bibr">45</xref>], the anaphase-promoting complex/cyclosome (APC/C) is a novel cellular aging regulator based on its indispensable role in the regulation of lifespan and its involvement in age-associated diseases of eukaryotic organisms. This consistency reinforces the results.</p>
      <p>Interestingly, pathways not identified by GSEA but with a higher importance score (<inline-formula><tex-math notation="LaTeX" id="ImEquation84">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula>) are usually more likely to exhibit significantly different expression stochasticity (<italic toggle="yes">P</italic>-value <inline-formula><tex-math notation="LaTeX" id="ImEquation85">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\leq 0.05$\end{document}</tex-math></inline-formula>, Wilcoxon tests on CVs). As shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S12</xref>, approximately 24–79% of the top 100 pathways identified by CellTICS, but overlooked by GSEA, exhibit statistical significance. For most cell types (EPC, NEURON, OLG, VASC, ASC, and old/young cells), there is a decreasing trend in the cumulative overlapping fractions with smaller <inline-formula><tex-math notation="LaTeX" id="ImEquation86">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> values. The only exception is the IMMUNE cell type. Therefore, for many cell types, expression stochasticity is another important characteristic for a pathway to define the cell type. A similar conclusion can be made when comparing results using different <inline-formula><tex-math notation="LaTeX" id="ImEquation87">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> thresholds (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S13</xref>).</p>
    </sec>
    <sec id="sec3d">
      <title>Important pathways for cell types undergoing aging</title>
      <p>Aging-related pathways shown above were based on the two-stage sub-cell-type identification for the AMB whole data. Due to the challenging task of sub-cell-type identification and to achieve more accurate aging-related pathway identification, we carried out the machine learning model for each cell type separately in a single-stage procedure to separate old cells from young cells. <xref rid="f6" ref-type="fig">Figure 6A</xref> shows the UpSet plot of the number of important aging-related pathways (<inline-formula><tex-math notation="LaTeX" id="ImEquation88">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p} \geq 0.1$\end{document}</tex-math></inline-formula>) for each cell type. Interestingly, 19 important aging-related pathways are shared by all cell types, suggesting common and essential mechanisms underlying the aging process for all considered cell types.</p>
      <fig position="float" id="f6">
        <label>Figure 6</label>
        <caption>
          <p><bold>Aging-related pathways identified by CellTICS.</bold> (<bold>A</bold>) The UpSet plot showing the number of important aging pathways for different cell types (<inline-formula><tex-math notation="LaTeX" id="ImEquation89">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p} \geq 0.1$\end{document}</tex-math></inline-formula>). (<bold>B</bold>) GSEA and Wilcoxon tests on CVs for the 19 aging-related pathways shared by all cell types. The corresponding <italic toggle="yes">P</italic>-values are shown. Also, the bar plots show the number of pathways passing GSEA or Wilcoxon tests for each cell type (<italic toggle="yes">P</italic>-values <inline-formula><tex-math notation="LaTeX" id="ImEquation90">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\leq 0.05$\end{document}</tex-math></inline-formula>).</p>
        </caption>
        <graphic xlink:href="bbad449f6" position="float"/>
      </fig>
      <p>To investigate the 19 pathways important for aging, both GSEA and the variation-based Wilcoxon signed-rank test were performed. <xref rid="f6" ref-type="fig">Figure 6B</xref> shows that although the 19 pathways are aging-related for all cell types according to CellTICS, differential expression (significant GSEA <italic toggle="yes">P</italic>-values) or the differential expression stochasticity (significant Wilcoxon test <italic toggle="yes">P</italic>-values) can only be detected in a subset of cell types. Notably, these pathways are more likely to exhibit differential expression for astrocytes, while they are more likely to show differential expression stochasticity for immune cells. Although immune cells do not conform to the trend of “larger <inline-formula><tex-math notation="LaTeX" id="ImEquation91">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula>, more likely to pass Wilcoxon tests” (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S12</xref>), which means they may not use expression stochasticity to distinguish themselves from other cell types, they utilize it to differentiate old and young cells (<xref rid="f6" ref-type="fig">Figure 6B</xref>).</p>
      <p>Furthermore, our work reveals that pathways related to nonsense-mediated mRNA decay (NMD) played an important role in the aging process. NMD is a translation-coupled mechanism that eliminates mRNAs containing premature translation-termination codons [<xref rid="ref46" ref-type="bibr">46</xref>, <xref rid="ref47" ref-type="bibr">47</xref>]. In this analysis, “NMD enhanced by the exon junction complex” and “NMD independent of the exon junction complex” were discovered as important aging pathways. Current experimental research has revealed that RNA surveillance via NMD is crucial for longevity in daf-2/insulin/IGF-1 mutant C. elegans [<xref rid="ref48" ref-type="bibr">48</xref>]. The computational results in mice can complement this understanding of the role of NMD in the aging process.</p>
    </sec>
    <sec id="sec3e">
      <title>Important pathways for ASD</title>
      <p>The ASD dataset served as a demonstration of how CellTICS could identify important pathways associated with disease. The results are shown in <xref rid="f7" ref-type="fig">Figure 7</xref>. Similarly, we compared the pathways identified by CellTICS (<inline-formula><tex-math notation="LaTeX" id="ImEquation92">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p} \geq 0.1$\end{document}</tex-math></inline-formula>) that distinguish between disease status to those identified by GSEA. Despite some overlaps, CellTICS discovered many more unique pathways (<xref rid="f7" ref-type="fig">Figure 7A</xref>). Then, the <inline-formula><tex-math notation="LaTeX" id="ImEquation93">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> threshold was tightened to 0.3 and Wilcoxon tests were performed to compare the coefficient of variation of the ASD and the control groups for these CellTICS-unique pathways. The tests show that 57 out of 75 disease pathways exhibit a significant variation difference (<xref rid="f7" ref-type="fig">Figure 7B</xref>), suggesting most of these ASD-related pathways exhibited expression stochasticity.</p>
      <fig position="float" id="f7">
        <label>Figure 7</label>
        <caption>
          <p><bold>Important pathways for ASD.</bold> (<bold>A</bold>) The number of important pathways distinguishing disease status identified by CellTICS (<inline-formula><tex-math notation="LaTeX" id="ImEquation94">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p} \geq 0.1$\end{document}</tex-math></inline-formula>) or GSEA. (<bold>B</bold>) The number of pathways identified by CellTICS but not by GSEA (<inline-formula><tex-math notation="LaTeX" id="ImEquation95">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p} \geq 0.3$\end{document}</tex-math></inline-formula>) with the information whether they pass the Wilcoxon tests on CVs (<italic toggle="yes">P</italic>-values <inline-formula><tex-math notation="LaTeX" id="ImEquation96">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\leq 0.05$\end{document}</tex-math></inline-formula>). (<bold>C</bold>) Top 15 CellTICS-unique pathways (<inline-formula><tex-math notation="LaTeX" id="ImEquation97">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p} \geq 0.3$\end{document}</tex-math></inline-formula>) ordered by their significance of the Wilcoxon test on CVs. The red dashed line marks the <italic toggle="yes">P</italic>-value of 0.05. The color of each pathway indicates whether the ASD group exhibits a higher or lower coefficient of variation. (<bold>D</bold>) Top 15 important ASD pathways ordered by <inline-formula><tex-math notation="LaTeX" id="ImEquation98">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> value. Cell types corresponding to each pathway are also shown.</p>
        </caption>
        <graphic xlink:href="bbad449f7" position="float"/>
      </fig>
      <p>The top 15 disease pathways (<inline-formula><tex-math notation="LaTeX" id="ImEquation99">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p} \geq 0.3$\end{document}</tex-math></inline-formula>, but not identified by GSEA) exhibiting the most significant differential expression stochasticity are shown in <xref rid="f7" ref-type="fig">Figure 7C</xref>, and the top 15 important ASD pathways ordered by <inline-formula><tex-math notation="LaTeX" id="ImEquation100">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> values are shown in <xref rid="f7" ref-type="fig">Figure 7D</xref>. As expected, the pathway with the highest <inline-formula><tex-math notation="LaTeX" id="ImEquation101">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> value is “nervous system development”, which is consistent with the etiology of ASD. The analysis reveals that ‘axon guidance’ is among the top three terms with the largest <inline-formula><tex-math notation="LaTeX" id="ImEquation102">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> value (<xref rid="f7" ref-type="fig">Figure 7D</xref>) and also ranked third for the differential expression stochasticity analysis (<xref rid="f7" ref-type="fig">Figure 7C</xref>). Notably, cortical abnormalities and genetic evidence support the notion that dysregulated axonal growth and guidance are critical developmental processes underlying the clinical manifestations of ASD [<xref rid="ref49" ref-type="bibr">49</xref>]. The findings further reinforce the importance of axon guidance in ASD.</p>
    </sec>
  </sec>
  <sec id="sec4">
    <title>CONCLUSION</title>
    <p>This study introduces CellTICS, a biologically explainable neural network tailored for cell-type identification and interpretation using single-cell RNA-seq data. CellTICS adopts a two-stage strategy to predict cell types and sub-cell types, and its innovative multi-predictive-layer strategy significantly enhances the prediction accuracy. The prediction accuracy of CellTICS is validated through comparison with alternative methods across various datasets.</p>
    <p>Moreover, CellTICS can discover important pathways that are missed by conventional methods like GSEA. These pathways may be characterized by their cell-type-specific expression stochasticity, as quantified by the coefficient of variation in Wilcoxon tests.</p>
    <p>Furthermore, the applications of CellTICS in the context of the aging process and ASD underscore its relevance for cell type identification under different physiological conditions. This adaptability is invaluable for gaining insights into how the aging process or specific diseases impact individuals across various cell types. In summary, CellTICS offers a powerful and biologically interpretable tool for advancing our understanding of cellular dynamics and their role in various health and disease states.</p>
    <boxed-text id="box01" position="float">
      <sec id="sec28a">
        <title>Key Points</title>
        <list list-type="bullet">
          <list-item>
            <p>Innovative Interpretability: CellTICS is significantly different from the traditional ‘black box’ deep learning models, offering biologically interpretable insights into cell type prediction.</p>
          </list-item>
          <list-item>
            <p>Accuracy Unleashed: With CellTICS, we have pushed the boundaries of accuracy in the identification of cell types and sub-cell types using single-cell RNA sequencing data, providing a sharper lens into the cellular world.</p>
          </list-item>
          <list-item>
            <p>Pathways Illuminated: CellTICS uncovers the hidden pathways that define unique cell types. It sheds light on the profound influence of expression stochasticity in cell type delineation which is missed by traditional analysis.</p>
          </list-item>
          <list-item>
            <p>Disease and Aging Unveiled: CellTICS excels at the identification of pathways that set cell types apart under diverse physiological conditions, providing valuable insights into the dynamic changes in cellular landscapes of disease and aging.</p>
          </list-item>
        </list>
      </sec>
    </boxed-text>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>supplementary_information_bbad449</label>
      <media xlink:href="supplementary_information_bbad449.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>ACKNOWLEDGMENTS</title>
    <p>The authors thank all members of the Chen lab for their discussions and suggestions throughout this study. This work was supported by the National Institutes of Health (R01GM137428, R01NS104041, and R01NS125276 to L.C.).</p>
  </ack>
  <sec sec-type="data-availability" id="sec19a">
    <title>CODE AND DATA AVAILABILITY</title>
    <p>The CSV data underlying this article are available in Zenodo, at <ext-link xlink:href="https://doi.org/10.5281/zenodo.7829597" ext-link-type="uri">https://doi.org/10.5281/zenodo.7829597</ext-link>. Links for accessing the original datasets are available in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>. Codes for CellTICS and all need libraries information are available at <ext-link xlink:href="https://github.com/qyyin0516/CellTICS" ext-link-type="uri">https://github.com/qyyin0516/CellTICS</ext-link>. Specifically, CellTICS was implemented using Python 3 (version 3.9.2), and the libraries involved were numpy (1.23.1), pandas (1.2.3), keras (2.9.0), tensorflow (2.9.0), networkx (2.6.3) and biomart (0.9.2). The computational tasks were executed on a Linux system equipped with two NVIDIA Tesla V100 GPUs and a memory capacity of up to 180 gigabytes. Related pathway findings are also shown on the GitHub page. For data processing and statistical analysis, we employed R (version 4.1.2). Additionally, we used the following R packages: Scater (1.22.0), caret (6.0-93) and ReactomePA (1.38.0). Besides, the HVGs were found using Python package scanpy (1.9.3).</p>
  </sec>
  <sec id="sec19n">
    <title>AUTHOR CONTRIBUTIONS STATEMENT</title>
    <p>Q.Y. and L.C. designed the research. Q.Y. implemented the methods and carried out the analyses. L.C. supervised the project. Q.Y. and L.C. discussed the results and contributed to the manuscript writing.</p>
  </sec>
  <notes id="bio3">
    <title>Author Biographies</title>
    <p><bold>Qingyang Yin</bold> is a Ph.D. student in the Department of Quantitative and Computational Biology at the University of Southern California.</p>
    <sec sec-type="author-bio" id="sec20a">
      <p><bold>Liang Chen</bold> is a professor in the Department of Quantitative and Computational Biology at the University of Southern California.</p>
    </sec>
  </notes>
  <ref-list id="bib1">
    <title>References</title>
    <ref id="ref1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tammela</surname>  <given-names>T</given-names></string-name>, <string-name><surname>Sage</surname>  <given-names>J</given-names></string-name></person-group>. <article-title>Investigating tumor heterogeneity in mouse models</article-title>. <source>Annu Rev Cancer Biol</source>  <year>2020</year>;<volume>19</volume>(<issue>6</issue>):<fpage>99</fpage>–<lpage>119</lpage>.</mixed-citation>
    </ref>
    <ref id="ref2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Molho</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Ding</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Li</surname>  <given-names>Z</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Deep learning in single-cell analysis</article-title>. <source>arXiv preprint</source>  <year>2022</year>; <comment>2210.12385</comment>.</mixed-citation>
    </ref>
    <ref id="ref3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ma</surname>  <given-names>F</given-names></string-name>, <string-name><surname>Pellegrini</surname>  <given-names>M</given-names></string-name></person-group>. <article-title>ACTINN: automated identification of cell types in single cell RNA sequencing</article-title>. <source>Bioinformatics</source>  <year>2020</year>;<volume>36</volume>(<issue>2</issue>):<fpage>533</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">31359028</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xie</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Gao</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Wang</surname>  <given-names>C</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>SuperCT: a supervised-learning framework for enhanced characterization of single-cell transcriptomic profiles</article-title>. <source>Bioinformatics</source>  <year>2019</year>;<volume>47</volume>(<issue>8</issue>):<fpage>e48</fpage>.</mixed-citation>
    </ref>
    <ref id="ref5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jia</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Lysenko</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Boroevich</surname>  <given-names>KA</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>scDeepInsight: a supervised cell-type identification method for scRNA-seq data with deep learning</article-title>. <source>Brief Bioinform</source>  <year>2023</year>;<volume>24</volume>(<issue>5</issue>):<fpage>bbad266</fpage>.<pub-id pub-id-type="pmid">37523217</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vasighizaker</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Zhou</surname>  <given-names>L</given-names></string-name>, <string-name><surname>Rueda</surname>  <given-names>L</given-names></string-name></person-group>. <article-title>Cell type identification via convolutional neural networks and self-organizing maps on single-cell RNA-seq data</article-title>. In: <source>Proceedings of the 12th ACM Conference on Bioinformatics, Computational Biology, and Health Informatics</source>, <year>2021</year>. <volume>Article 91</volume>, p. <fpage>1</fpage>–<lpage>6</lpage>.</mixed-citation>
    </ref>
    <ref id="ref7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname>  <given-names>T</given-names></string-name>, <string-name><surname>Bai</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Nabavi</surname>  <given-names>S</given-names></string-name></person-group>. <article-title>Single-cell classification using graph convolutional networks</article-title>. <source>BMC Bioinformatics</source>  <year>2021</year>;<volume>22</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>23</lpage>.<pub-id pub-id-type="pmid">33388027</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shao</surname>  <given-names>X</given-names></string-name>, <string-name><surname>Yang</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Zhuang</surname>  <given-names>X</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>scDeepSort: a pre-trained cell-type annotation method for single-cell transcriptomics using deep learning with a weighted graph neural network</article-title>. <source>Nucleic Acids Res</source>  <year>2021</year>;<volume>49</volume>(<issue>21</issue>):<fpage>e122</fpage>.<pub-id pub-id-type="pmid">34500471</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yin</surname>  <given-names>Q</given-names></string-name>, <string-name><surname>Wang</surname>  <given-names>Y</given-names></string-name>, <string-name><surname>Guan</surname>  <given-names>J</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>scIAE: an integrative autoencoder-based ensemble classification framework for single-cell RNA-seq data</article-title>. <source>Brief Bioinform</source>  <year>2022</year>;<volume>23</volume>(<issue>1</issue>):<fpage>bbab508</fpage>.<pub-id pub-id-type="pmid">34913057</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lopez</surname>  <given-names>R</given-names></string-name>, <string-name><surname>Regier</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Cole</surname>  <given-names>MB</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Deep generative modeling for single-cell transcriptomics</article-title>. <source>Nat Methods</source>  <year>2018</year>;<volume>15</volume>(<issue>12</issue>):<fpage>1053</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">30504886</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tran</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Nguyen</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Tran</surname>  <given-names>B</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Fast and precise single-cell data analysis using a hierarchical autoencoder</article-title>. <source>Nat Commun</source>  <year>2021</year>;<volume>12</volume>(<issue>1</issue>):<fpage>1029</fpage>.<pub-id pub-id-type="pmid">33589635</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Song</surname>  <given-names>T</given-names></string-name>, <string-name><surname>Dai</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Wang</surname>  <given-names>S</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>TransCluster: a cell-type identification method for single-cell RNA-seq data using deep learning based on transformer</article-title>. <source>Front Genet</source>  <year>2022</year>;<volume>13</volume>:<fpage>1038919</fpage>.<pub-id pub-id-type="pmid">36303549</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Xu</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Tao</surname>  <given-names>W</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Transformer for one stop interpretable cell type annotation</article-title>. <source>Nat Commun</source>  <year>2023</year>;<volume>14</volume>(<issue>1</issue>):<fpage>223</fpage>.<pub-id pub-id-type="pmid">36641532</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dehghan</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Razzaghi</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Abbasi</surname>  <given-names>K</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>TripletMultiDTI: multimodal representation learning in drug-target interaction prediction with triplet loss function</article-title>. <source>Exp Syst Appl</source>  <year>2023</year>;<volume>232</volume>:<fpage>120754</fpage>.</mixed-citation>
    </ref>
    <ref id="ref15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rafiei</surname>  <given-names>F</given-names></string-name>, <string-name><surname>Zeraati</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Abbasi</surname>  <given-names>K</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>DeepTraSynergy: drug combinations using multimodal deep learning with transformers</article-title>. <source>Bioinformatics</source>  <year>2023</year>;<volume>39</volume>(<issue>8</issue>):<fpage>btad438</fpage>.<pub-id pub-id-type="pmid">37467066</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pettit</surname>  <given-names>JB</given-names></string-name>, <string-name><surname>Tomer</surname>  <given-names>R</given-names></string-name>, <string-name><surname>Achim</surname>  <given-names>K</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Identifying cell types from spatially referenced single-cell expression datasets</article-title>. <source>PLoS Comput Biol</source>  <year>2014</year>;<volume>10</volume>(<issue>9</issue>):<fpage>e1003824</fpage>.<pub-id pub-id-type="pmid">25254363</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kuenzi</surname>  <given-names>BM</given-names></string-name>, <string-name><surname>Park</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Fong</surname>  <given-names>SH</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Predicting drug response and synergy using a deep learning model of human cancer cells</article-title>. <source>Cancer Cell</source>  <year>2020</year>;<volume>38</volume>(<issue>5</issue>):<fpage>672</fpage>–<lpage>84</lpage>.<pub-id pub-id-type="pmid">33096023</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ashburner</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Ball</surname>  <given-names>CA</given-names></string-name>, <string-name><surname>Blake</surname>  <given-names>JA</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Gene ontology: tool for the unification of biology</article-title>. <source>Nat Genet</source>  <year>2000</year>;<volume>25</volume>(<issue>1</issue>):<fpage>25</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">10802651</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Elmarakeby</surname>  <given-names>HA</given-names></string-name>, <string-name><surname>Hwang</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Arafeh</surname>  <given-names>R</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Biologically informed deep neural network for prostate cancer discovery</article-title>. <source>Nature</source>  <year>2021</year>;<volume>598</volume>(<issue>7880</issue>):<fpage>348</fpage>–<lpage>52</lpage>.<pub-id pub-id-type="pmid">34552244</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname>  <given-names>Y</given-names></string-name>, <string-name><surname>Barr</surname>  <given-names>K</given-names></string-name>, <string-name><surname>Reinitz</surname>  <given-names>J</given-names></string-name></person-group>. <article-title>Fully interpretable deep learning model of transcriptional control</article-title>. <source>Bioinformatics</source>  <year>2020</year>;<volume>36</volume>(<issue>Supplement_1</issue>):<fpage>i499</fpage>–<lpage>507</lpage>.<pub-id pub-id-type="pmid">32657418</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sun</surname>  <given-names>B</given-names></string-name>, <string-name><surname>Chen</surname>  <given-names>L</given-names></string-name></person-group>. <article-title>Interpretable deep learning for improving cancer patient survival based on personal transcriptomes</article-title>. <source>Sci Rep</source>  <year>2023</year>;<volume>13</volume>(<issue>1</issue>):<fpage>11344</fpage>.<pub-id pub-id-type="pmid">37443344</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shrikumar</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Greenside</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Kundaje</surname>  <given-names>A</given-names></string-name></person-group>. <article-title>Learning important features through propagating activation differences</article-title>. <source>arXiv preprint</source>  <year>2017</year>;<fpage>1704.02685</fpage>.</mixed-citation>
    </ref>
    <ref id="ref23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Novakovsky</surname>  <given-names>G</given-names></string-name>, <string-name><surname>Dexter</surname>  <given-names>N</given-names></string-name>, <string-name><surname>Libbrecht</surname>  <given-names>MW</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Obtaining genetics insights from deep learning via explainable artificial intelligence</article-title>. <source>Nat Rev Genet</source>  <year>2022</year>;<volume>24</volume>(<issue>2</issue>):<fpage>125</fpage>–<lpage>37</lpage>.<pub-id pub-id-type="pmid">36192604</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref24">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Joshi-Tope</surname>  <given-names>G</given-names></string-name>, <string-name><surname>Gillespie</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Vastrik</surname>  <given-names>I</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Reactome: a knowledgebase of biological pathways</article-title>. <source>Nucleic Acids Res</source>  <year>2005</year>;<volume>33</volume>(<issue>Supplement_1</issue>):<fpage>D428</fpage>–<lpage>32</lpage>.<pub-id pub-id-type="pmid">15608231</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zeisel</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Hochgerner</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Lönnerberg</surname>  <given-names>P</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Molecular architecture of the mouse nervous system</article-title>. <source>Nucleic Acids Res</source>  <year>2018</year>;<volume>174</volume>(<issue>4</issue>):<fpage>999</fpage>–<lpage>1014</lpage>.</mixed-citation>
    </ref>
    <ref id="ref26">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Saunders</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Macosko</surname>  <given-names>EZ</given-names></string-name>, <string-name><surname>Wysoker</surname>  <given-names>A</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Molecular diversity and specializations among the cells of the adult mouse brain</article-title>. <source>Nucleic Acids Res</source>  <year>2018</year>;<volume>174</volume>(<issue>4</issue>):<fpage>1015</fpage>–<lpage>30</lpage>.</mixed-citation>
    </ref>
    <ref id="ref27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ximerakis</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Lipnick</surname>  <given-names>SL</given-names></string-name>, <string-name><surname>Innes</surname>  <given-names>BT</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Molecular diversity and specializations among the cells of the adult mouse brain</article-title>. <source>Nat Neurosci</source>  <year>2019</year>;<volume>22</volume>(<issue>10</issue>):<fpage>1696</fpage>–<lpage>708</lpage>.<pub-id pub-id-type="pmid">31551601</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref28">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Abdelaal</surname>  <given-names>T</given-names></string-name>, <string-name><surname>Michielsen</surname>  <given-names>L</given-names></string-name>, <string-name><surname>Cats</surname>  <given-names>D</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>A comparison of automatic cell identification methods for single-cell RNA sequencing data</article-title>. <source>Genome Biol</source>  <year>2019</year>;<volume>20</volume>(<issue>1</issue>):<fpage>194</fpage>.<pub-id pub-id-type="pmid">31500660</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref29">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Velmeshev</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Schirmer</surname>  <given-names>L</given-names></string-name>, <string-name><surname>Jung</surname>  <given-names>D</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Single-cell genomics identifies cell type-specific molecular changes in autism</article-title>. <source>Science</source>  <year>2019</year>;<volume>364</volume>(<issue>6441</issue>):<fpage>685</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">31097668</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref30">
      <label>30.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McCarthy</surname>  <given-names>DJ</given-names></string-name>, <string-name><surname>Campbell</surname>  <given-names>KR</given-names></string-name>, <string-name><surname>Lun</surname>  <given-names>AT</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Scater: pre-processing, quality control, normalization and visualization of single-cell RNA-seq data in R</article-title>. <source>Bioinformatics</source>  <year>2017</year>;<volume>33</volume>(<issue>8</issue>):<fpage>1179</fpage>–<lpage>86</lpage>.<pub-id pub-id-type="pmid">28088763</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref31">
      <label>31.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kuhn</surname>  <given-names>M</given-names></string-name></person-group>. <article-title>Building predictive models in R using the caret package</article-title>. <source>J Stat Softw</source>  <year>2008</year>;<volume>28</volume>:<fpage>1</fpage>–<lpage>26</lpage>.<pub-id pub-id-type="pmid">27774042</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref32">
      <label>32.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><collab>Miltenyi Biotec</collab></person-group>. <source>Peripheral blood — Whole blood — Handbook</source>. <comment>https://www.miltenyibiotec.com/US-en/resources/macs-handbook/human-cells-and-organs/human-cell-sources/blood-human.html</comment> (<comment>11 September 2023, date last accessed</comment>).</mixed-citation>
    </ref>
    <ref id="ref33">
      <label>33.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jiang</surname>  <given-names>W</given-names></string-name>, <string-name><surname>Chen</surname>  <given-names>L</given-names></string-name></person-group>. <article-title>Tissue specificity of gene expression evolves across mammal species</article-title>. <source>J Comput Biol</source>  <year>2022</year>;<volume>29</volume>(<issue>8</issue>):<fpage>880</fpage>–<lpage>91</lpage>.<pub-id pub-id-type="pmid">35776510</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref34">
      <label>34.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aran</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Looney</surname>  <given-names>AP</given-names></string-name>, <string-name><surname>Liu</surname>  <given-names>L</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Reference-based analysis of lung single-cell sequencing reveals a transitional profibrotic macrophage</article-title>. <source>Nat Immunol</source>  <year>2019</year>;<volume>20</volume>(<issue>2</issue>):<fpage>163</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">30643263</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref35">
      <label>35.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kiselev</surname>  <given-names>VY</given-names></string-name>, <string-name><surname>Yiu</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Hemberg</surname>  <given-names>M</given-names></string-name></person-group>. <article-title>Scmap: projection of single-cell RNA-seq data across data sets</article-title>. <source>Nat Immunol</source>  <year>2018</year>;<volume>15</volume>(<issue>5</issue>):<fpage>359</fpage>–<lpage>62</lpage>.</mixed-citation>
    </ref>
    <ref id="ref36">
      <label>36.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>De Kanter</surname>  <given-names>JK</given-names></string-name>, <string-name><surname>Lijnzaad</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Candelli</surname>  <given-names>T</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>CHETAH: a selective, hierarchical cell type identification method for single-cell RNA sequencing</article-title>. <source>Nucleic Acids Res</source>  <year>2019</year>;<volume>47</volume>(<issue>16</issue>):<fpage>e95</fpage>.<pub-id pub-id-type="pmid">31226206</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref37">
      <label>37.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Alquicira-Hernandez</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Sathe</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Ji</surname>  <given-names>HP</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>scPred: accurate supervised method for cell-type classification from single-cell RNA-seq data</article-title>. <source>Genome Biol</source>  <year>2019</year>;<volume>20</volume>(<issue>1</issue>):<fpage>264</fpage>.<pub-id pub-id-type="pmid">31829268</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref38">
      <label>38.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pasquini</surname>  <given-names>G</given-names></string-name>, <string-name><surname>Arias</surname>  <given-names>JE</given-names></string-name>, <string-name><surname>Schäfer</surname>  <given-names>P</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Automated methods for cell type annotation on scRNA-seq data</article-title>. <source>Comput Struct Biotechnol J</source>  <year>2021</year>;<volume>19</volume>:<fpage>961</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">33613863</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref39">
      <label>39.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Subramanian</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Tamayo</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Mootha</surname>  <given-names>VK</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>. <source>Proc Natl Acad Sci U S A</source>  <year>2005</year>;<volume>102</volume>(<issue>43</issue>):<fpage>15545</fpage>–<lpage>50</lpage>.<pub-id pub-id-type="pmid">16199517</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref40">
      <label>40.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yu</surname>  <given-names>G</given-names></string-name>, <string-name><surname>He</surname>  <given-names>QY</given-names></string-name></person-group>. <article-title>ReactomePA: an R/Bioconductor package for reactome pathway analysis and visualization</article-title>. <source>Mol Biosyst</source>  <year>2016</year>;<volume>12</volume>(<issue>2</issue>):<fpage>477</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">26661513</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref41">
      <label>41.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Leary</surname>  <given-names>JR</given-names></string-name>, <string-name><surname>Xu</surname>  <given-names>Y</given-names></string-name>, <string-name><surname>Morrison</surname>  <given-names>AB</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Sub-cluster identification through semi-supervised optimization of rare-cell silhouettes (SCISSORS) in single-cell RNA-sequencing</article-title>. <source>Bioinformatics</source>  <year>2023</year>;<volume>39</volume>(<issue>8</issue>):<fpage>btad449</fpage>.<pub-id pub-id-type="pmid">37498558</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref42">
      <label>42.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Meng</surname>  <given-names>X</given-names></string-name>, <string-name><surname>Reed</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Lai</surname>  <given-names>S</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Stochastic scanning events on the GCN4 mRNA 5<inline-formula><tex-math notation="LaTeX" id="ImEquation103">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$^\prime $\end{document}</tex-math></inline-formula> untranslated region generate cell-to-cell heterogeneity in the yeast nutritional stress response</article-title>. <source>Nucleic Acids Res</source>  <year>2023</year>;<volume>51</volume>(<issue>13</issue>):<fpage>6609</fpage>–<lpage>21</lpage>.<pub-id pub-id-type="pmid">37246646</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref43">
      <label>43.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>de Jong</surname>  <given-names>TV</given-names></string-name>, <string-name><surname>Moshkin</surname>  <given-names>YM</given-names></string-name>, <string-name><surname>Guryev</surname>  <given-names>V</given-names></string-name></person-group>. <article-title>Gene expression variability: the other dimension in transcriptome analysis</article-title>. <source>Physiol Genomics</source>  <year>2019</year>;<volume>51</volume>(<issue>5</issue>):<fpage>145</fpage>–<lpage>58</lpage>.<pub-id pub-id-type="pmid">30875273</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref44">
      <label>44.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kaern</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Elston</surname>  <given-names>TC</given-names></string-name>, <string-name><surname>Blake</surname>  <given-names>WJ</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Stochasticity in gene expression: from theories to phenotypes</article-title>. <source>Nucleic Acids Res</source>  <year>2005</year>;<volume>6</volume>(<issue>6</issue>):<fpage>451</fpage>–<lpage>64</lpage>.</mixed-citation>
    </ref>
    <ref id="ref45">
      <label>45.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hu</surname>  <given-names>X</given-names></string-name>, <string-name><surname>Jin</surname>  <given-names>X</given-names></string-name>, <string-name><surname>Cao</surname>  <given-names>X</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>The anaphase-promoting complex/Cyclosome is a cellular ageing regulator</article-title>. <source>Int J Mol Sci</source>  <year>2022</year>;<volume>23</volume>(<issue>23</issue>):<fpage>15327</fpage>.<pub-id pub-id-type="pmid">36499653</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref46">
      <label>46.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brogna</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Wen</surname>  <given-names>J</given-names></string-name></person-group>. <article-title>Nonsense-mediated mRNA decay (NMD) mechanisms</article-title>. <source>Nat Struct Mol Biol</source>  <year>2009</year>;<volume>16</volume>(<issue>2</issue>):<fpage>107</fpage>–<lpage>13</lpage>.<pub-id pub-id-type="pmid">19190664</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref47">
      <label>47.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>  <given-names>Z</given-names></string-name>, <string-name><surname>Vuong</surname>  <given-names>JK</given-names></string-name>, <string-name><surname>Zhang</surname>  <given-names>M</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Inhibition of nonsense-mediated RNA decay by ER stress</article-title>. <source>RNA</source>  <year>2017</year>;<volume>23</volume>(<issue>3</issue>):<fpage>378</fpage>–<lpage>94</lpage>.<pub-id pub-id-type="pmid">27940503</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref48">
      <label>48.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Son</surname>  <given-names>HG</given-names></string-name>, <string-name><surname>Seo</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Ham</surname>  <given-names>S</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>RNA surveillance via nonsense-mediated mRNA decay is crucial for longevity in daf-2/insulin/IGF-1 mutant C. Elegans</article-title>. <source>Nat Commun</source>  <year>2017</year>;<volume>8</volume>(<issue>1</issue>): <fpage>1</fpage>–<lpage>11</lpage>.<pub-id pub-id-type="pmid">28232747</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref49">
      <label>49.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McFadden</surname>  <given-names>K</given-names></string-name>, <string-name><surname>Minshew</surname>  <given-names>NJ</given-names></string-name></person-group>. <article-title>Evidence for dysregulation of axonal growth and guidance in the etiology of ASD</article-title>. <source>Front Hum Neurosci</source>  <year>2013</year>;<volume>7</volume>:<fpage>671</fpage>.<pub-id pub-id-type="pmid">24155705</pub-id>
</mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Brief Bioinform</journal-id>
    <journal-id journal-id-type="iso-abbrev">Brief Bioinform</journal-id>
    <journal-id journal-id-type="publisher-id">bib</journal-id>
    <journal-title-group>
      <journal-title>Briefings in Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1467-5463</issn>
    <issn pub-type="epub">1477-4054</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10703497</article-id>
    <article-id pub-id-type="pmid">38061196</article-id>
    <article-id pub-id-type="doi">10.1093/bib/bbad449</article-id>
    <article-id pub-id-type="publisher-id">bbad449</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Problem Solving Protocol</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CellTICS: an explainable neural network for cell-type identification and interpretation based on single-cell RNA-seq data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Yin</surname>
          <given-names>Qingyang</given-names>
        </name>
        <aff><institution>Department of Quantitative and Computational Biology, University of Southern California</institution>, <addr-line>1050 Childs Way, Los Angeles, CA 90089</addr-line>, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Chen</surname>
          <given-names>Liang</given-names>
        </name>
        <!--liang.chen@usc.edu-->
        <aff><institution>Department of Quantitative and Computational Biology, University of Southern California</institution>, <addr-line>1050 Childs Way, Los Angeles, CA 90089</addr-line>, <country country="US">United States</country></aff>
        <xref rid="cor1" ref-type="corresp"/>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="cor1">Corresponding author: Liang Chen. Email: <email>liang.chen@usc.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>1</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-12-07">
      <day>07</day>
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>07</day>
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <volume>25</volume>
    <issue>1</issue>
    <elocation-id>bbad449</elocation-id>
    <history>
      <date date-type="received">
        <day>27</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>30</day>
        <month>10</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>11</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="bbad449.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Identifying cell types is crucial for understanding the functional units of an organism. Machine learning has shown promising performance in identifying cell types, but many existing methods lack biological significance due to poor interpretability. However, it is of the utmost importance to understand what makes cells share the same function and form a specific cell type, motivating us to propose a biologically interpretable method. CellTICS prioritizes marker genes with cell-type-specific expression, using a hierarchy of biological pathways for neural network construction, and applying a multi-predictive-layer strategy to predict cell and sub-cell types. CellTICS usually outperforms existing methods in prediction accuracy. Moreover, CellTICS can reveal pathways that define a cell type or a cell type under specific physiological conditions, such as disease or aging. The nonlinear nature of neural networks enables us to identify many novel pathways. Interestingly, some of the pathways identified by CellTICS exhibit differential expression “variability” rather than differential expression across cell types, indicating that expression stochasticity within a pathway could be an important feature characteristic of a cell type. Overall, CellTICS provides a biologically interpretable method for identifying and characterizing cell types, shedding light on the underlying pathways that define cellular heterogeneity and its role in organismal function. CellTICS is available at <ext-link xlink:href="https://github.com/qyyin0516/CellTICS" ext-link-type="uri">https://github.com/qyyin0516/CellTICS</ext-link>.</p>
    </abstract>
    <kwd-group>
      <kwd>explainable neural network</kwd>
      <kwd>cell type identification</kwd>
      <kwd>pathways</kwd>
      <kwd>scRNA-seq data</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>R01GM137428</award-id>
        <award-id>R01NS104041</award-id>
        <award-id>R01NS125276</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="12"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="sec1">
    <title>INTRODUCTION</title>
    <p>Single-cell RNA-sequencing (scRNA-seq) provides expression profiles of individual cells and molecularly defines cell states or phenotypes [<xref rid="ref1" ref-type="bibr">1</xref>]. It also has the potential to identify cell types, which are functional units of an organism and crucial to other downstream research investigations. Recently, machine learning has been widely applied to identifying cell types. Typically, a machine-learning model is built using a reference dataset with well-curated cell-type labels. Then, the model is applied to the query dataset to predict its cell types. Deep learning has consistently shown promising performances in cell-type identification for various architectures and the customization of hyperparameters [<xref rid="ref2" ref-type="bibr">2</xref>]. Numerous neural network architectures have contributed to these achievements, including artificial neural networks [<xref rid="ref3" ref-type="bibr">3</xref>, <xref rid="ref4" ref-type="bibr">4</xref>], convolutional neural networks [<xref rid="ref5" ref-type="bibr">5</xref>, <xref rid="ref6" ref-type="bibr">6</xref>], graph-based networks [<xref rid="ref7" ref-type="bibr">7</xref>, <xref rid="ref8" ref-type="bibr">8</xref>], generative models (autoencoders or generative adversarial networks) [<xref rid="ref9" ref-type="bibr">9–11</xref>] and attention-based models (transformers) [<xref rid="ref12" ref-type="bibr">12</xref>, <xref rid="ref13" ref-type="bibr">13</xref>]. Moreover, recent advances in multimodal learning show its immense potential in bioinformatics [<xref rid="ref14" ref-type="bibr">14</xref>, <xref rid="ref15" ref-type="bibr">15</xref>]. However, these deep learning-based models are usually black-box models, lacking interpretability. Moreover, predicting at the sub-cell-type level has always been more challenging, even though it provides higher resolution and can unveil valuable insights into cell heterogeneity [<xref rid="ref16" ref-type="bibr">16</xref>]. Motivated by existing limitations, this study aims to address both the aspects of biological interpretability and sub-cell-level prediction.</p>
    <p>In the field of computational biology, interpretable neural networks are constructed using prior biological knowledge, such as gene ontology and pathway information, to improve the interpretability of deep learning. For instance, DrugCell [<xref rid="ref17" ref-type="bibr">17</xref>] uses a visible neural network that predicts anti-cancer drug responses by leveraging biological process information from the Gene Ontology (GO) database [<xref rid="ref18" ref-type="bibr">18</xref>]. P-NET [<xref rid="ref19" ref-type="bibr">19</xref>] is a biologically informed deep-learning model for prostate cancer discovery. Liu et al. [<xref rid="ref20" ref-type="bibr">20</xref>] introduced an interpretable deep neural network that faithfully captures the underlying chemical mechanism of transcription factor binding to DNA. CancerIDP [<xref rid="ref21" ref-type="bibr">21</xref>] is an interpretable neural network that predicts cancer patients’ survival based on drug prescriptions and personal transcriptomes. In these models, neurons are imbued with biological meaning (GO terms, pathways, etc.), and certain automatic computational procedures, like DeepLIFT [<xref rid="ref22" ref-type="bibr">22</xref>], are employed to evaluate the significance of these neurons. Hence, these models significantly enhance human understanding of hidden mechanisms [<xref rid="ref23" ref-type="bibr">23</xref>] and have shown remarkable success in both predicting classification labels and explaining results. Nevertheless, there are few studies that focus on the application of interpretable neural networks for cell type annotation and the interpretation of the factors that define a cell type.</p>
    <p>Inspired by the success of interpretable neural networks, this study presents <bold>CellTICS</bold> (<bold>Cell</bold>-<bold>T</bold>ype <bold>I</bold>dentifi<bold>C</bold>ation based on <bold>S</bold>cRNA-seq), a biologically explainable neural network for cell-type identification and interpretation based on single-cell RNA-seq data. In CellTICS, marker genes are prioritized as interpretable features. The network architecture of CellTICS follows the hierarchy of pathways acquired from the Reactome database [<xref rid="ref24" ref-type="bibr">24</xref>] and adopts a two-stage strategy to predict cell and sub-cell types. What sets CellTICS apart is its innovative approach of utilizing multiple prediction layers to aggregate information from various pathway levels. This unique multi-predictive-layer strategy greatly enhances the accuracy of the pathway-guided encoder’s predictions. The superior classification performance of CellTICS is demonstrated by applying it to several public datasets and comparing it with other cell-type annotation methods. More importantly, the interpretability of CellTICS provides clues about which pathway characteristics are essential to define a cell type or a cell type under a specific physiological condition. This information is often missed by traditional methods, making CellTICS a valuable tool for understanding the biology of cellular heterogeneity.</p>
    <p>The remaining sections of this article are organized as follows. In the “<xref rid="sec2" ref-type="sec">2</xref> Material and methods” section, an overview of the utilized datasets is provided, followed by a detailed explanation of the CellTICS model and its associated parameters, and the description of other methods used for comparison along with the evaluation criteria. In the “<xref rid="sec3" ref-type="sec">3</xref> Results and discussions” section, a comprehensive discussion of the results and innovative aspects of this work is undertaken. It commences with the presentation of cell-type and sub-cell-type annotation results. Following that, CellTICS’s capability to uncover novel pathways and their characteristics related to expression stochasticity are explored. Its application in the context of the aging process and autism spectrum disorder (ASD) is also examined. Finally, in the “<xref rid="sec4" ref-type="sec">4</xref> Conclusion” section, the study is drawn to a close by summarizing the key findings and insights derived from our research.</p>
  </sec>
  <sec id="sec2">
    <title>MATERIALS AND METHODS</title>
    <p>The schematic pipeline of CellTICS is shown in <xref rid="f1" ref-type="fig">Figure 1</xref>. In CellTICS, marker genes are selected based on their expression levels in the training set. The neural network is constructed as the hierarchy of Reactome pathways. A two-stage deep learning strategy is employed to predict both cell types and sub-cell types. In the first stage, a feedforward neural network is trained for cell-type prediction, with a predictive layer corresponding to each pathway hidden layer. Subsequently, in the second stage, multiple sub-neural networks are trained for sub-cell-type prediction, building upon the predicted outcomes from the first stage. Each sub-neural network is also equipped with multiple predictive layers for hidden layers. At each stage, prediction results from all predictive layers are aggregated through a voting mechanism. Furthermore, during the training procedure, important pathways that contribute to (sub-)cell-type prediction can be identified by comparing the activation values of neural networks corresponding to cells belonging to different cell types. More details are as follows.</p>
    <fig position="float" id="f1">
      <label>Figure 1</label>
      <caption>
        <p><bold>The pipeline of CellTICS.</bold> (<bold>A</bold>) Marker genes are prioritized by considering their cell-type-specific high and low expression measures. (<bold>B</bold>) The Reactome pathways are used to construct the network hierarchy. (<bold>C</bold>) A neural network constructed by the pathway hierarchy is trained and then used to predict cell types of the test set. The predicted results from all predictive layers are integrated by voting. (<bold>D</bold>) Based on the predicted results of the first stage, several sub-neural networks are trained for sub-cell-type prediction. Important pathways defining a cell type (or a sub-cell type) can be obtained by comparing their activation values across different cell types.</p>
      </caption>
      <graphic xlink:href="bbad449f1" position="float"/>
    </fig>
    <sec id="sec2a">
      <title>Datasets</title>
      <p>The capabilities of CellTICS were showcased using scRNA-seq data from three mouse brain studies [<xref rid="ref25" ref-type="bibr">25–27</xref>] and two human studies [<xref rid="ref28" ref-type="bibr">28</xref>, <xref rid="ref29" ref-type="bibr">29</xref>]. Its predictive accuracy was evaluated across a total of 10 analysis tasks, including both intra-dataset and inter-dataset predictions (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). The entire process of the data processing and handling is illustrated in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1</xref>.</p>
      <sec id="sec2a1">
        <title>Raw scRNA-seq data processing</title>
        <p>The detailed datasets used in this study included the level-5 mouse brain data (L5MB), DropViz hippocampus (DropViz HC), DropViz frontal cortex (DropViz FC), and human peripheral blood mononuclear (PBMC) data, all of which were initially in raw read count format. In contrast, the aging mouse brain (AMB) and autism spectrum disorder (ASD) data were first scaled to 10,000 transcripts per cell and then subjected to logarithmically transformed. As a result, a normalization step was necessary for the L5MB, DropViz HC, DropViz FC, and PBMC data.</p>
        <p>Let us denote <inline-formula><tex-math notation="LaTeX" id="ImEquation1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$expr_{c,g}$\end{document}</tex-math></inline-formula> as the normalized expression measure for gene <inline-formula><tex-math notation="LaTeX" id="ImEquation2">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$g$\end{document}</tex-math></inline-formula> in cell <inline-formula><tex-math notation="LaTeX" id="ImEquation3">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$c$\end{document}</tex-math></inline-formula>. The normalization is performed as Equation <xref rid="deqn01" ref-type="disp-formula">1</xref>, where <inline-formula><tex-math notation="LaTeX" id="ImEquation4">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$m_{c,g}$\end{document}</tex-math></inline-formula> is the gene-level read count (UMI-based), and <inline-formula><tex-math notation="LaTeX" id="ImEquation5">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$G$\end{document}</tex-math></inline-formula> is the total number of genes. Subsequently, quality control for all data was performed by the R package scater [<xref rid="ref30" ref-type="bibr">30</xref>], filtering out cells and genes with poor quality. </p>
        <disp-formula id="deqn01">
          <label>(1)</label>
          <tex-math notation="LaTeX" id="DmEquation1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*}&amp; expr_{c,g}=log_{2}\left(10000\frac{m_{c,g}}{\sum_{g^{\prime}=1}^{G}m_{c,g^{\prime}}}+1\right)\end{align*}\end{document}</tex-math>
        </disp-formula>
      </sec>
      <sec id="sec2a2">
        <title>Training sets and test sets preparation</title>
        <p>The L5MB, DropViz HC and DropViz FC datasets contained information on cell types and sub-cell types. To represent intra-dataset predictions, these datasets were split into a training set and a test set using the R package caret [<xref rid="ref31" ref-type="bibr">31</xref>] with 75% of the original data allocated to the training set, stratified by cell types.</p>
        <p>The AMB data contained mouse brain cells for the young and old age groups as well as their cell types and sub-cell types. We created three analysis tasks based on the data. The first one was the original whole dataset (AMB whole), incorporating age status into the cell-type labels to create our own sub-cell-type labels (e.g. old-cell-type-A versus young-cell-type-A). Next, the AMB whole dataset was split into a training set and a test set with 75% of the original data allocated to the training set, stratified by cell types. The other two analysis tasks were designed for inter-dataset prediction for both cell types and original sub-cell types. Specifically, the old data were treated as the training set and the young data as the test set (AMB OY), or vice versa (AMB YO).</p>
        <p>The PBMC data were sequenced by the 10X Genomics v2 (10Xv2), the 10X Genomics v3 (10Xv3) and the Drop-seq protocols. The three major cell type groups were lymphoid cells (including sub-cell types: B cells, CD4 T cells, cytotoxic T cells and natural killer cells), myeloid cells (including sub-cell types: CD14+ monocytes, CD16+ monocytes, dendritic cells and plasmacytoid dendritic cells) and megakaryocytes [<xref rid="ref32" ref-type="bibr">32</xref>]. Based on the PBMC data, three analysis tasks were created to test the cross-protocol prediction, a special case of inter-dataset prediction. Firstly, the 10Xv3 data were used as the training set, and the 10Xv2 data were the test set (PBMC 32). Secondly, the 10Xv2 data were the training set, and the Drop-seq data were the test set (PBMC 2D). Lastly, the Drop-seq data were the training set, and the 10Xv3 data were the test set (PBMC D3).</p>
        <p>The ASD data contained human brain data for the ASD and control groups. To explore the mechanism of ASD at the cell-type level, this work incorporated the disease status into the cell-type labels to create the sub-cell-type labels (e.g. ASD-cell-type-A versus control-cell-type-A). This study focused exclusively on 11 neuron cell types, namely L2/3, L4, L5/6, L5/6-CC, IN-PV, IN-SST, IN-SV2C, IN-VIP, Neu-mat, Neu-NRGN-I and Neu-NRGN-II. Subsequently, the dataset was split into a training set and a test set with 75% of the original data allocated to the training set, stratified by cell types. The processed data were written into CSV files and uploaded to Zenodo (see ‘Code and Data Availability’). The CSV file sizes have also been included in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>.</p>
      </sec>
    </sec>
    <sec id="sec2d">
      <title>The CellTICS model</title>
      <sec id="sec2d1">
        <title>Marker gene prioritization</title>
        <p>A feature selection step was performed to prioritize marker genes, which could help enhance the prediction performance of the CellTICS model. The cell-type-specific high expression measure for a gene <inline-formula><tex-math notation="LaTeX" id="ImEquation6">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$g$\end{document}</tex-math></inline-formula> in cell type <inline-formula><tex-math notation="LaTeX" id="ImEquation7">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$t$\end{document}</tex-math></inline-formula> is defined as Equation <xref rid="deqn02" ref-type="disp-formula">2</xref>, where <inline-formula><tex-math notation="LaTeX" id="ImEquation8">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\tau _{g}$\end{document}</tex-math></inline-formula>, <inline-formula><tex-math notation="LaTeX" id="ImEquation9">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\hat{x}_{t,g}$\end{document}</tex-math></inline-formula> are determined by Equation <xref rid="deqn03" ref-type="disp-formula">3</xref> and Equation <xref rid="deqn04" ref-type="disp-formula">4</xref>. Here, <inline-formula><tex-math notation="LaTeX" id="ImEquation10">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$n$\end{document}</tex-math></inline-formula> is the total number of cell types, and <inline-formula><tex-math notation="LaTeX" id="ImEquation11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$expr_{t,g}$\end{document}</tex-math></inline-formula> is the normalized expression measure for the gene in cell type <inline-formula><tex-math notation="LaTeX" id="ImEquation12">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$t$\end{document}</tex-math></inline-formula>. Pseudo number 1 is added to avoid extremely large fold changes among lowly expressed genes. Thus, <inline-formula><tex-math notation="LaTeX" id="ImEquation13">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$0\leq \varphi _{t,g}\leq 1$\end{document}</tex-math></inline-formula>. The cell-type-specificity measure is a modification of the tissue-specificity measure proposed by Jiang et al. [<xref rid="ref33" ref-type="bibr">33</xref>]. A larger <inline-formula><tex-math notation="LaTeX" id="ImEquation14">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\varphi _{t,g}$\end{document}</tex-math></inline-formula> value suggests that the gene is specifically highly expressed in this cell type. For the cell type with the maximum expression, <inline-formula><tex-math notation="LaTeX" id="ImEquation15">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\varphi _{t,g}=\tau _{g}$\end{document}</tex-math></inline-formula>, otherwise <inline-formula><tex-math notation="LaTeX" id="ImEquation16">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\varphi _{t,g}&lt;\tau _{g}$\end{document}</tex-math></inline-formula>. </p>
        <disp-formula id="deqn02">
          <label>(2)</label>
          <tex-math notation="LaTeX" id="DmEquation2">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*} &amp; \varphi_{t,g}=\tau_{g}\hat{x}_{t,g} \end{align*}\end{document}</tex-math>
        </disp-formula>
        <disp-formula id="deqn03">
          <label>(3)</label>
          <tex-math notation="LaTeX" id="DmEquation3">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*} &amp; \tau_{g}=\frac{\sum_{t=1}^{n}(1-\hat{x}_{t,g})}{n-1} \end{align*}\end{document}</tex-math>
        </disp-formula>
        <disp-formula id="deqn04">
          <label>(4)</label>
          <tex-math notation="LaTeX" id="DmEquation4">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*} &amp; \hat{x}_{t,g}=\frac{expr_{t,g}+1}{\max_{1\leq t^{\prime}\leq n}expr_{t^{\prime},g}+1} \end{align*}\end{document}</tex-math>
        </disp-formula>
        <p>Similarly, the cell-type-specific low expression measure for a gene <inline-formula><tex-math notation="LaTeX" id="ImEquation17">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$g$\end{document}</tex-math></inline-formula> in cell type <inline-formula><tex-math notation="LaTeX" id="ImEquation18">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$t$\end{document}</tex-math></inline-formula> is defined as Equation <xref rid="deqn05" ref-type="disp-formula">5</xref>, where <inline-formula><tex-math notation="LaTeX" id="ImEquation19">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\omega _{g}$\end{document}</tex-math></inline-formula>, <inline-formula><tex-math notation="LaTeX" id="ImEquation20">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\hat{z}_{t,g}$\end{document}</tex-math></inline-formula> are determined by Equation <xref rid="deqn06" ref-type="disp-formula">6</xref> and Equation <xref rid="deqn07" ref-type="disp-formula">7</xref>. Thus, <inline-formula><tex-math notation="LaTeX" id="ImEquation21">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$0\leq \rho _{t,g}\leq 1$\end{document}</tex-math></inline-formula>. A larger <inline-formula><tex-math notation="LaTeX" id="ImEquation22">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\rho _{t,g}$\end{document}</tex-math></inline-formula> value suggests that the gene is specifically lowly expressed in this cell type. </p>
        <disp-formula id="deqn05">
          <label>(5)</label>
          <tex-math notation="LaTeX" id="DmEquation5">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*} &amp; \rho_{t,g}=\omega_{g}\hat{z}_{t,g} \end{align*}\end{document}</tex-math>
        </disp-formula>
        <disp-formula id="deqn06">
          <label>(6)</label>
          <tex-math notation="LaTeX" id="DmEquation6">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*} &amp; \omega_{g}=\frac{\sum_{t=1}^{n}(1-\hat{z}_{t,g})}{n-1} \end{align*}\end{document}</tex-math>
        </disp-formula>
        <disp-formula id="deqn07">
          <label>(7)</label>
          <tex-math notation="LaTeX" id="DmEquation7">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*} &amp; \hat{z}_{t,g}=\frac{\min_{1\leq t^{\prime}\leq n}expr_{t^{\prime},g}+1}{expr_{t,g}+1} \end{align*}\end{document}</tex-math>
        </disp-formula>
        <p>To select cell-type-specific highly expressed or lowly expressed genes, for a gene <inline-formula><tex-math notation="LaTeX" id="ImEquation23">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$g$\end{document}</tex-math></inline-formula> in cell type <inline-formula><tex-math notation="LaTeX" id="ImEquation24">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$t$\end{document}</tex-math></inline-formula>, if <inline-formula><tex-math notation="LaTeX" id="ImEquation25">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\varphi _{t,g}$\end{document}</tex-math></inline-formula> was greater than the <inline-formula><tex-math notation="LaTeX" id="ImEquation26">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$100\alpha $\end{document}</tex-math></inline-formula>th quantile of <inline-formula><tex-math notation="LaTeX" id="ImEquation27">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\varphi $\end{document}</tex-math></inline-formula> in cell type <inline-formula><tex-math notation="LaTeX" id="ImEquation28">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$t$\end{document}</tex-math></inline-formula>, the gene would be selected as a marker gene for the cell type. Similarly, for another gene <inline-formula><tex-math notation="LaTeX" id="ImEquation29">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$g^{\prime}$\end{document}</tex-math></inline-formula> in cell type <inline-formula><tex-math notation="LaTeX" id="ImEquation30">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$t^{\prime}$\end{document}</tex-math></inline-formula>, if <inline-formula><tex-math notation="LaTeX" id="ImEquation31">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\rho _{t^{\prime},g^{\prime}}$\end{document}</tex-math></inline-formula> was greater than the <inline-formula><tex-math notation="LaTeX" id="ImEquation32">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$100\beta $\end{document}</tex-math></inline-formula>th quantile of <inline-formula><tex-math notation="LaTeX" id="ImEquation33">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\rho $\end{document}</tex-math></inline-formula> in cell type <inline-formula><tex-math notation="LaTeX" id="ImEquation34">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$t^{\prime}$\end{document}</tex-math></inline-formula>, the gene would be also selected as a marker gene for the cell type. All marker genes from all cell types were combined as the result of the feature selection step. These marker genes were used to compress both the training set and the test set.</p>
      </sec>
      <sec id="sec2d2">
        <title>Pathway hierarchy</title>
        <p>All levels of the pathway hierarchy were acquired from the Reactome database, which could be represented as a tree. The pathway hierarchies for mice, humans, and rats were available in CellTICS. The tree was composed of internal nodes representing hierarchical pathways and leaves representing genes. Pathways at the highest level were connected to the root node, and edges and nodes not related to the selected marker genes were excluded. To formally formulate the network, the parameter <inline-formula><tex-math notation="LaTeX" id="ImEquation35">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$l$\end{document}</tex-math></inline-formula> was introduced to specify the number of considered levels (i.e. the number of hidden layers of the neural network). When <inline-formula><tex-math notation="LaTeX" id="ImEquation36">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$l$\end{document}</tex-math></inline-formula> was specified, a subtree of the original tree could be constructed. If the upper depth of a leaf was larger than <inline-formula><tex-math notation="LaTeX" id="ImEquation37">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$l$\end{document}</tex-math></inline-formula>, the excessive parental level(s) of the leave would be excluded and the leaf would be connected to upper-level pathways. If the upper depth of a leaf was smaller than <inline-formula><tex-math notation="LaTeX" id="ImEquation38">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$l$\end{document}</tex-math></inline-formula>, artificial nodes would be added to represent the parents of the leaf. From the subtree, a binary mask matrix <inline-formula><tex-math notation="LaTeX" id="ImEquation39">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$M$\end{document}</tex-math></inline-formula> was generated to suggest the connectivity of two entities in adjacent layers. If the two entities had no connection, the corresponding entry in <inline-formula><tex-math notation="LaTeX" id="ImEquation40">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$M$\end{document}</tex-math></inline-formula> was 0; otherwise, it would be 1.</p>
      </sec>
      <sec id="sec2d3">
        <title>Neural network construction</title>
        <p>A feedforward neural network was constructed based on the mask matrix. We first trained the network for cell-type prediction and then trained several sub-neural networks for sub-cell-type prediction. Thus, after obtaining the predicted cell types for the test set, the test set was divided into subsets based on these predictions, and similarly, the training set was separated based on the true cell types. Then, sub-cell-type prediction was performed for each cell type.</p>
        <p>The detailed architecture of the CellTICS neural network is shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2</xref>. In the neural network, each node represents an entity such as a gene, pathway, or cell type, and each edge represents the relationship between the entities connected by the edge. The input layer comprises a set of genes. The input data are the expression level of these genes, whose dimension is the number of genes assigned to the bottom pathway level. For each layer, the input is denoted as <inline-formula><tex-math notation="LaTeX" id="ImEquation41">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$x$\end{document}</tex-math></inline-formula> and the output is denoted as <inline-formula><tex-math notation="LaTeX" id="ImEquation42">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$y$\end{document}</tex-math></inline-formula>. The output of the layer is calculated using Equation <xref rid="deqn08" ref-type="disp-formula">8</xref>, where <inline-formula><tex-math notation="LaTeX" id="ImEquation43">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$f$\end{document}</tex-math></inline-formula> is the activation function, <inline-formula><tex-math notation="LaTeX" id="ImEquation44">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$M$\end{document}</tex-math></inline-formula> is the mask matrix, <inline-formula><tex-math notation="LaTeX" id="ImEquation45">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$W$\end{document}</tex-math></inline-formula> is the weight matrix, and <inline-formula><tex-math notation="LaTeX" id="ImEquation46">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$b$\end{document}</tex-math></inline-formula> is the bias vector. Here <inline-formula><tex-math notation="LaTeX" id="ImEquation47">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$MW$\end{document}</tex-math></inline-formula> is the element-wise multiplication of <inline-formula><tex-math notation="LaTeX" id="ImEquation48">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$M$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ImEquation49">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$W$\end{document}</tex-math></inline-formula> (i.e. Hadamard product). The activation function is the tanh function (Equation <xref rid="deqn09" ref-type="disp-formula">9</xref>). The activation values are related to the importance measures of pathways, and they will be elaborated upon in <xref rid="sec2d4" ref-type="sec">2.2.4</xref>. The dimension of each hidden layer is in accordance with the mask matrix <inline-formula><tex-math notation="LaTeX" id="ImEquation50">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$M$\end{document}</tex-math></inline-formula>. To obtain the prediction for each cell, a predictive layer is added after each hidden layer. The dimension of each prediction layer equals the number of cell types. The probability of a cell being classified as the <inline-formula><tex-math notation="LaTeX" id="ImEquation51">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$i$\end{document}</tex-math></inline-formula>th cell type is calculated using the softmax function (Equation <xref rid="deqn10" ref-type="disp-formula">10</xref>), where <inline-formula><tex-math notation="LaTeX" id="ImEquation52">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$C$\end{document}</tex-math></inline-formula> is the total number of cell types and <inline-formula><tex-math notation="LaTeX" id="ImEquation53">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$z$\end{document}</tex-math></inline-formula> is the input of the softmax function. The cell is assigned to the class with the highest probability. Finally, the predictions from all predictive layers are integrated by voting to obtain the final prediction result. </p>
        <disp-formula id="deqn08">
          <label>(8)</label>
          <tex-math notation="LaTeX" id="DmEquation8">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*} &amp; y=f[(MW)x+b] \end{align*}\end{document}</tex-math>
        </disp-formula>
        <disp-formula id="deqn09">
          <label>(9)</label>
          <tex-math notation="LaTeX" id="DmEquation9">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*} &amp; f=tanh(z)=\frac{e^{z}-e^{-z}}{e^{z}+e^{-z}} \end{align*}\end{document}</tex-math>
        </disp-formula>
        <disp-formula id="deqn10">
          <label>(10)</label>
          <tex-math notation="LaTeX" id="DmEquation10">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*} &amp; \sigma_{i}=\frac{e^{z_{i}}}{\sum_{c=1}^{C}e^{z_{c}}} \end{align*}\end{document}</tex-math>
        </disp-formula>
      </sec>
      <sec id="sec2d4">
        <title>Important pathway identification</title>
        <p>To identify important pathways for distinguishing each (sub-) cell type, CellTICS utilized activation values during the training procedure. Specifically, the activation values were calculated for each pathway in every layer in the CellTICS neural network. For a given pathway <inline-formula><tex-math notation="LaTeX" id="ImEquation54">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p$\end{document}</tex-math></inline-formula> and cell type <inline-formula><tex-math notation="LaTeX" id="ImEquation55">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$t$\end{document}</tex-math></inline-formula>, the average activation value (<inline-formula><tex-math notation="LaTeX" id="ImEquation56">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$A_{t,p}$\end{document}</tex-math></inline-formula>) was computed across all cells of that type. These average activation values were then sorted in descending order across all cell types, obtaining a list (<inline-formula><tex-math notation="LaTeX" id="ImEquation57">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$A_{(1),p}$\end{document}</tex-math></inline-formula>,<inline-formula><tex-math notation="LaTeX" id="ImEquation58">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$A_{(2),p}$\end{document}</tex-math></inline-formula>,...,<inline-formula><tex-math notation="LaTeX" id="ImEquation59">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$A_{(T),p}$\end{document}</tex-math></inline-formula>), where <inline-formula><tex-math notation="LaTeX" id="ImEquation60">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$T$\end{document}</tex-math></inline-formula> is the total number of cell types. To quantify the importance of pathway <inline-formula><tex-math notation="LaTeX" id="ImEquation61">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p$\end{document}</tex-math></inline-formula>, the difference between the first and second largest average activation values, Equation <xref rid="deqn11" ref-type="disp-formula">11</xref>, was computed. Due to the possibility of a pathway <inline-formula><tex-math notation="LaTeX" id="ImEquation62">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p$\end{document}</tex-math></inline-formula> being included in the paths of multiple prediction layers, there might be several <inline-formula><tex-math notation="LaTeX" id="ImEquation63">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$d_{p}$\end{document}</tex-math></inline-formula> values. For instance, a pathway located on the first hidden layer (level 1) could be present in the network paths leading to prediction level 1, level 2, and so on, until the final hidden layer was reached. Hence, the maximum value of <inline-formula><tex-math notation="LaTeX" id="ImEquation64">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$d_{p}$\end{document}</tex-math></inline-formula> among all paths of such nested networks was selected as the final importance measure of the pathway and denoted as <inline-formula><tex-math notation="LaTeX" id="ImEquation65">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula>. If the importance value <inline-formula><tex-math notation="LaTeX" id="ImEquation66">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> exceeded a predefined threshold (default: 0.1), pathway <inline-formula><tex-math notation="LaTeX" id="ImEquation67">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$p$\end{document}</tex-math></inline-formula> would be deemed important for the cell type corresponding to <inline-formula><tex-math notation="LaTeX" id="ImEquation68">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$A_{(1),p}$\end{document}</tex-math></inline-formula>. </p>
        <disp-formula id="deqn11">
          <label>(11)</label>
          <tex-math notation="LaTeX" id="DmEquation11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{align*}&amp; d_{p}=A_{(1),p}-A_{(2),p}\end{align*}\end{document}</tex-math>
        </disp-formula>
      </sec>
    </sec>
    <sec id="sec2i">
      <title>Parameter settings</title>
      <p>The CellTICS model was trained by the Adam optimizer with the cross-entropy loss function with L2 regularization. To optimize the performance of the CellTICS model, the parameters were tuned using grid search with 5-fold cross-validation. The default values for threshold values (<inline-formula><tex-math notation="LaTeX" id="ImEquation69">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\alpha $\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ImEquation70">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\beta $\end{document}</tex-math></inline-formula>) are 0.95 and 0.9, respectively. The default value for the number of hidden layers of the neural network (<inline-formula><tex-math notation="LaTeX" id="ImEquation71">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$l$\end{document}</tex-math></inline-formula>) is 5. The default hyperparameters for the minibatch size, learning rate, and regularization parameter are 32, 0.001, and 0.0001, respectively. The default number of epochs is 10 for cell-type prediction and 50 for sub-cell-type prediction.</p>
    </sec>
    <sec id="sec2j">
      <title>Method comparison</title>
      <p>This work compared the performance of CellTICS with six other methods to evaluate its predictive performance. The compared methods were SingleR [<xref rid="ref34" ref-type="bibr">34</xref>], scmap [<xref rid="ref35" ref-type="bibr">35</xref>] (containing scmap-cluster and scmap-cell), CHETAH [<xref rid="ref36" ref-type="bibr">36</xref>], scPred [<xref rid="ref37" ref-type="bibr">37</xref>], and ACTINN [<xref rid="ref3" ref-type="bibr">3</xref>]. We selected these specific models based on their representation of major categories within cell type annotation methods, encompassing correlation-based methods (SingleR, scmap, and CHETAH), supervised classification-based methods (scPred), and traditional neural networks (ACTINN) [<xref rid="ref38" ref-type="bibr">38</xref>]. Noteworthy, we compared CellTICS with ACTINN, a traditional neural network-based method. This choice was made to assess CellTICS’s proficiency in accurate cell classification and check whether its interpretability sacrifices the prediction accuracy. The default parameter settings of these tools were used unless mentioned otherwise. For scmap, the unassigned threshold, which represents a similarity threshold, was set to <inline-formula><tex-math notation="LaTeX" id="ImEquation72">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$-1$\end{document}</tex-math></inline-formula>.</p>
    </sec>
    <sec id="sec2k">
      <title>Evaluation criteria</title>
      <sec id="sec2k1">
        <title>Evaluation of cell type prediction</title>
        <p>The performance of CellTICS and the compared methods were evaluated using two metrics: accuracy (ACC) and macro-averaged F1 scores (macro F1 scores). ACC measures the percentage of cells correctly classified, while the F1 score is the harmonic mean of precision and recall. The macro F1 score is computed by taking the arithmetic mean of all per-class F1 scores and is useful when dealing with class imbalance problems, which are common in cell-type classification.</p>
      </sec>
      <sec id="sec2k2">
        <title>Evaluation of important pathway identification</title>
        <p>To demonstrate the unique advantages of CellTICS in identifying cell-type important pathways, the gene set enrichment analysis (GSEA) [<xref rid="ref39" ref-type="bibr">39</xref>] was utilized for comparison. GSEA is a method for evaluating cumulative changes in the expression of multiple genes belonging to a gene set (i.e. a pathway). It can be used to identify pathways exhibiting differential gene expression between cell types, between the young and old cells of a specific cell type, or between diseased and healthy cells of a cell type.</p>
        <p>The logarithmic fold change (logFC) was calculated as a differential expression measure for a gene by computing the difference of average log-normalized count data in different groups. Subsequently, the R package ReactomePA [<xref rid="ref40" ref-type="bibr">40</xref>] was used to perform GSEA and identify important pathways with a <italic toggle="yes">P</italic>-value less than 0.05. Finally, the important pathways found by CellTICS and GSEA were compared.</p>
        <p>For pathways identified by CellTICS but not by GSEA, Wilcoxon signed-rank tests were further performed to examine the variation difference, instead of the traditional mean difference, between groups. Thus, for each important pathway identified by CellTICS, the coefficient of variation (CV) of all genes in both groups (e.g. cells of cell type A versus other cells, or old cells of cell type A versus young cells of cell type A) was calculated. Consequently, a Wilcoxon signed-rank test on the CV values of the two groups was performed to assess the significance of variation differences.</p>
      </sec>
    </sec>
  </sec>
  <sec id="sec3">
    <title>RESULTS AND DISCUSSIONS</title>
    <sec id="sec3a">
      <title>Identification of cell and sub-cell types</title>
      <p>To illustrate the predictive power of CellTICS for (sub-)cell-type identification, we compared CellTICS with six other methods for 10 analysis tasks (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). The procedure was repeated five times across all datasets, and the average ACC and macro F1 scores were computed.</p>
      <p>The results for the cell-type identification and the sub-cell-type identification are shown in <xref rid="f2" ref-type="fig">Figure 2</xref>. Clearly, CellTICS outperforms the other methods in almost all datasets, since the performance of CellTICS is usually the best, that is, exhibiting higher scores and smaller performance variations. Although most methods can obtain high ACC for major cell type identification (<xref rid="f2" ref-type="fig">Figure 2A</xref>), the sensitivity of many methods is not satisfactory enough as reflected by the low macro F1 scores in <xref rid="f2" ref-type="fig">Figure 2B</xref>. However, CellTICS stands out with an average macro F1 score between 0.9406 and 0.9993 for the considered datasets. Classifying sub-cell types is a more challenging task, while CellTICS is still superior in most methods (<xref rid="f2" ref-type="fig">Figure 2C</xref> and <xref rid="f2" ref-type="fig">Figure 2D</xref>). The performance of these models for each analysis task is illustrated in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S3</xref>.</p>
      <fig position="float" id="f2">
        <label>Figure 2</label>
        <caption>
          <p><bold>The prediction performance of CellTICS and other cell-type identification methods.</bold> A total of 10 analysis tasks were conducted to generate the boxplots. In each of these tasks, the average ACC and macro F1 scores based on five analysis repeats were used. (<bold>A</bold>) The ACC for cell-type identification. (<bold>B</bold>) The macro F1 score for cell-type identification. (<bold>C</bold>) The ACC for sub-cell-type identification. (<bold>D</bold>) The macro F1 score for sub-cell-type identification.</p>
        </caption>
        <graphic xlink:href="bbad449f2" position="float"/>
      </fig>
      <p>We also compared CellTICS with the original marker gene selection to CellTICS with highly variable gene (HVG) selection (top 2,000, 5,000, or 10,000 HVGs). As shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S4</xref>, the performance of original CellTICS is significantly better than using the top 2,000 HVGs, while it is comparable with using the top 5,000 and 10,000 HVGs. In the ASD data analysis, CellTICS’s marker gene prioritization performs much better than the HVG approaches (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figures S4A</xref>–<xref rid="sup1" ref-type="supplementary-material">D</xref>).</p>
      <p>CellTICS is robust in cell type and sub-cell type identification. We ran CellTICS 20 times and observed very small variations in the accuracy and macro F1 scores for all cell type prediction and sub-cell type prediction (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S5</xref>). Also, CellTICS is computationally efficient. As shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>, for the L5MB dataset which included about 20,000 cells and about 28,000 genes, the whole runtime (including training and testing) was about 23 min.</p>
      <p>One major distinctive part of CellTICS is the multi-predictive-layer strategy, which greatly improves the prediction accuracy and prediction power. <xref rid="f3" ref-type="fig">Figure 3</xref> demonstrates the effectiveness of this strategy by comparing the performance of the original CellTICS with that of CellTICS containing only one prediction layer on the L5MB dataset. The results show that multiple prediction layers can significantly enhance the ACC and macro F1 score of the predictions. For cell type classification, the ACC is improved from 0.7711 to 0.9997, while the macro F1 score is improved from 0.1244 to 0.9878. In sub-cell type classification, the improvement is even more significant, with the ACC increasing from 0.0303 to 0.9035 and the macro F1 score increasing from 0.0003 to 0.7142. These findings demonstrate that the multi-predictive-layer strategy adopted by CellTICS can substantially improve the accuracy of predictions, providing a more nuanced and comprehensive understanding of cell heterogeneity and disease processes. The key advantage of this approach is that it allows for the aggregation of information from different levels of pathway hierarchy, particularly those at the bottom levels which represent more detailed pathways. By leveraging the unique information content available at each level, the network can capture both the broad functional relationships between pathways and the more specific functional roles played by individual pathways.</p>
      <fig position="float" id="f3">
        <label>Figure 3</label>
        <caption>
          <p><bold>The importance of the multi-predictive-layer strategy.</bold> The average ACC and macro F1 scores of the original CellTICS and CellTICS with only one prediction layer are shown for cell-type and sub-cell-type identification on the L5MB dataset.</p>
        </caption>
        <graphic xlink:href="bbad449f3" position="float"/>
      </fig>
      <p>Another noteworthy property of CellTICS is its ability to make predictions at the sub-cell-type level. CellTICS outperforms most methods in most cases (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figures S3C</xref>–<xref rid="sup1" ref-type="supplementary-material">D</xref>), even for the L5MB dataset, where the number of sub-cell types is relatively large (i.e. 220). It also implies that CellTICS has the potential to handle the class imbalance problem since the percentage of sub-cell types in the L5MB test set varies from 0.01 to 5.01%. The success in predicting sub-cell types suggests that CellTICS can better facilitate the construction of cell atlas in complex tissues to a deeper level. At this level, the identification of rare cell types might hold special significance [<xref rid="ref41" ref-type="bibr">41</xref>]. Rare cell types are sporadic within a large population of cells, and their marker genes may exhibit very weak signals. However, CellTICS can capture these signals by incorporating both highly and lowly expressed marker genes of all cell types. Particularly, the inclusion of cell-type-specific lowly expressed genes offers valuable insights as their expression remains uniquely low in certain cell types, which is often overlooked in traditional marker gene prioritization. The comparison between CellTICS’s marker genes and HVGs supports this assertion.</p>
      <p>The trade-off between interpretability and prediction accuracy for deep neural networks is a common challenge in machine learning. As the complexity of the model increases to achieve higher accuracy, its interpretability tends to decrease. However, the hidden layers of CellTICS follow the pathway hierarchy and reflect the real relationships between pathway nodes in a cell. The above results and discussions show that CellTICS can achieve high prediction accuracy. In the following sections, CellTICS’s interpretability will be demonstrated.</p>
    </sec>
    <sec id="sec3b">
      <title>CellTICS identifies important pathways missed by GSEA</title>
      <p>Many deep learning models designed for cell type annotation lack the ability to uncover what defines a cell type, which has prompted us to emphasize achieving biological interpretability. In addition to predicting cell types accurately and identifying the genes that contribute to the prediction (i.e. important features), CellTICS can also pinpoint important pathways (i.e. important neurons in the neural network architecture) that define (sub-) cell types or cell types under a specific physiological condition. This capability represents the most distinctive aspect of this study. Traditionally GSEA is typically used to identify pathways with enriched gene expression changes between cell types. In this section, the comparison between the two approaches will be shown.</p>
      <p>For the AMB whole dataset, we compared the important pathways of each cell type identified by CellTICS with those by GSEA and also compared the results for distinguishing old cells from young cells of a specific cell type. As shown in <xref rid="f4" ref-type="fig">Figure 4A</xref>, CellTICS and GSEA share some important pathways for both cell type classification and aging status classification. Moreover, CellTICS discovers many important pathways missed by GSEA, as it can identify nonlinear characteristics of the pathway and capture potential interactions among genes. Some pathways identified by GSEA are not essential in defining cell types, suggesting that the simple add-up of differential signals of genes in a pathway is not necessarily an important cell-type-specific characteristic.</p>
      <fig position="float" id="f4">
        <label>Figure 4</label>
        <caption>
          <p><bold>Comparison between CellTICS and GSEA.</bold> (<bold>A</bold>) The number of important pathways distinguishing cell types or age groups identified by CellTICS (<inline-formula><tex-math notation="LaTeX" id="ImEquation73">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}\geq 0.1$\end{document}</tex-math></inline-formula>) or GSEA. Pathways important for either old or young cells across all cell types are combined for the “Old or young cells” category. (<bold>B</bold>) Shared pathways between CellTICS and GSEA. The cumulative fraction of pathways identified by GSEA is plotted along pathways with decreasing <inline-formula><tex-math notation="LaTeX" id="ImEquation74">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> values in CellTICS.</p>
        </caption>
        <graphic xlink:href="bbad449f4" position="float"/>
      </fig>
      <p>Generally, pathways with larger importance scores of CellTICS (<inline-formula><tex-math notation="LaTeX" id="ImEquation75">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> values) are more likely to be identified by GSEA (<xref rid="f4" ref-type="fig">Figure 4B</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S6</xref>). In <xref rid="f4" ref-type="fig">Figure 4B</xref>, pathways from CellTICS are sorted by <inline-formula><tex-math notation="LaTeX" id="ImEquation76">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> in descending order, and the cumulative fraction of pathways shared between CellTICS and GSEA is shown. The overlapping fraction is generally higher for pathways with higher <inline-formula><tex-math notation="LaTeX" id="ImEquation77">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> values. Although the number of pathways passing the <inline-formula><tex-math notation="LaTeX" id="ImEquation78">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> threshold of 0.1 is small for VASC (vascular), OLG (oligodendrocyte), and EPC (ependymocyte) cells (<xref rid="f4" ref-type="fig">Figure 4A</xref>), the pattern still holds for these cell types when ordering pathways by <inline-formula><tex-math notation="LaTeX" id="ImEquation79">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> without imposing a cutoff (<xref rid="f4" ref-type="fig">Figure 4B</xref>). Alternatively, the <inline-formula><tex-math notation="LaTeX" id="ImEquation80">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> threshold was adjusted from 0.1 to 0.2 and 0.3 for CellTICS and then compared the results with GSEA. As shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S6</xref>, the overlapping fractions are higher when the threshold for CellTICS is more stringent.</p>
      <p>The advantage of CellTICS over GSEA is that CellTICS can aggregate differential signals nonlinearly via a neural network approach, while GSEA aggregates the differential signals from individual genes of the same pathway in a linear way. Additionally, CellTICS compares the average activation scores of a pathway between the considered cell type and all other cell types in a pairwise fashion. However, GSEA pools all other cell types together and compares them with the considered cell type.</p>
      <p>Knowing pathways that define a (sub-)cell type is particularly valuable because it allows for a better understanding of the molecule dynamics of the cell and how they contribute to predicting a (sub-)cell type. By uncovering cell-type-specific pathways, CellTICS provides a more comprehensive and interpretable view of the underlying biological processes.</p>
    </sec>
    <sec id="sec3c">
      <title>Expression stochasticity of a pathway could be cell-type specific</title>
      <p>As shown in <xref rid="sec3b" ref-type="sec">3.2</xref>, some pathways identified by CellTICS do not show significant differential gene expression at the individual gene level and are not identified by GSEA. To explore their underlying mechanisms, we tested the hypothesis that a pathway’s expression stochasticity, measured by the coefficient of variation, could be a cell-type-specific characteristic. For the AMB whole dataset, a Wilcoxon signed-rank test was performed on the coefficient of variation values of two groups (cell type A versus other cell types, or old cells of cell type A versus young cells of cell type A) for the important pathways discovered by CellTICS but not by GSEA. Interestingly, among the eight important pathways (with a <inline-formula><tex-math notation="LaTeX" id="ImEquation81">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> threshold of 0.3 and not identified by GSEA) for the aging-related pathway discovery, seven of them were discovered in EPCs. Therefore, the differential variation results for pathways related to EPCs are presented in <xref rid="f5" ref-type="fig">Figure 5</xref>. Three out of the seven (<xref rid="f5" ref-type="fig">Figure 5A</xref>) pathways uniquely identified by CellTICS exhibit a significant difference in expression stochasticity between old and young EPCs, and 10 out of 12 (<xref rid="f5" ref-type="fig">Figure 5B</xref>) pathways did so for the comparison between EPCs and other cells (<italic toggle="yes">P</italic>-value <inline-formula><tex-math notation="LaTeX" id="ImEquation82">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\leq 0.05$\end{document}</tex-math></inline-formula>, Wilcoxon tests on CVs). Results for other cell types are shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figures S7</xref>–<xref rid="sup1" ref-type="supplementary-material">S11</xref>, with 14.3–61.1% of their important pathways passing the Wilcoxon tests. These results suggest that expression stochasticity within a pathway could be an essential feature for defining a cell type or a specific age group, which is distinctive for a cell type annotation model. Other studies have also reported that expression stochasticity is important and may affect organism functionality, viability, and flexibility to adapt to environments [<xref rid="ref42" ref-type="bibr">42–44</xref>].</p>
      <fig position="float" id="f5">
        <label>Figure 5</label>
        <caption>
          <p><bold>Important pathways exhibiting differential expression stochasticity.</bold> The differential expression stochasticity of pathways is assessed by Wilcoxon tests for (<bold>A</bold>) different age groups of ependymocytes or (<bold>B</bold>) ependymocytes versus other cell types. Only pathways with <inline-formula><tex-math notation="LaTeX" id="ImEquation83">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p} \geq 0.3$\end{document}</tex-math></inline-formula> in CellTICS but not identified by GSEA are shown. The red dashed lines mark the <italic toggle="yes">P</italic>-value cutoff of 0.05.</p>
        </caption>
        <graphic xlink:href="bbad449f5" position="float"/>
      </fig>
      <p>Based on the findings in <xref rid="f5" ref-type="fig">Figure 5A</xref>, ‘mitotic anaphase’ emerges as one of the most significant important pathways to distinguish age groups of EPCs. According to Hu et al. [<xref rid="ref45" ref-type="bibr">45</xref>], the anaphase-promoting complex/cyclosome (APC/C) is a novel cellular aging regulator based on its indispensable role in the regulation of lifespan and its involvement in age-associated diseases of eukaryotic organisms. This consistency reinforces the results.</p>
      <p>Interestingly, pathways not identified by GSEA but with a higher importance score (<inline-formula><tex-math notation="LaTeX" id="ImEquation84">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula>) are usually more likely to exhibit significantly different expression stochasticity (<italic toggle="yes">P</italic>-value <inline-formula><tex-math notation="LaTeX" id="ImEquation85">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\leq 0.05$\end{document}</tex-math></inline-formula>, Wilcoxon tests on CVs). As shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S12</xref>, approximately 24–79% of the top 100 pathways identified by CellTICS, but overlooked by GSEA, exhibit statistical significance. For most cell types (EPC, NEURON, OLG, VASC, ASC, and old/young cells), there is a decreasing trend in the cumulative overlapping fractions with smaller <inline-formula><tex-math notation="LaTeX" id="ImEquation86">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> values. The only exception is the IMMUNE cell type. Therefore, for many cell types, expression stochasticity is another important characteristic for a pathway to define the cell type. A similar conclusion can be made when comparing results using different <inline-formula><tex-math notation="LaTeX" id="ImEquation87">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> thresholds (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S13</xref>).</p>
    </sec>
    <sec id="sec3d">
      <title>Important pathways for cell types undergoing aging</title>
      <p>Aging-related pathways shown above were based on the two-stage sub-cell-type identification for the AMB whole data. Due to the challenging task of sub-cell-type identification and to achieve more accurate aging-related pathway identification, we carried out the machine learning model for each cell type separately in a single-stage procedure to separate old cells from young cells. <xref rid="f6" ref-type="fig">Figure 6A</xref> shows the UpSet plot of the number of important aging-related pathways (<inline-formula><tex-math notation="LaTeX" id="ImEquation88">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p} \geq 0.1$\end{document}</tex-math></inline-formula>) for each cell type. Interestingly, 19 important aging-related pathways are shared by all cell types, suggesting common and essential mechanisms underlying the aging process for all considered cell types.</p>
      <fig position="float" id="f6">
        <label>Figure 6</label>
        <caption>
          <p><bold>Aging-related pathways identified by CellTICS.</bold> (<bold>A</bold>) The UpSet plot showing the number of important aging pathways for different cell types (<inline-formula><tex-math notation="LaTeX" id="ImEquation89">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p} \geq 0.1$\end{document}</tex-math></inline-formula>). (<bold>B</bold>) GSEA and Wilcoxon tests on CVs for the 19 aging-related pathways shared by all cell types. The corresponding <italic toggle="yes">P</italic>-values are shown. Also, the bar plots show the number of pathways passing GSEA or Wilcoxon tests for each cell type (<italic toggle="yes">P</italic>-values <inline-formula><tex-math notation="LaTeX" id="ImEquation90">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\leq 0.05$\end{document}</tex-math></inline-formula>).</p>
        </caption>
        <graphic xlink:href="bbad449f6" position="float"/>
      </fig>
      <p>To investigate the 19 pathways important for aging, both GSEA and the variation-based Wilcoxon signed-rank test were performed. <xref rid="f6" ref-type="fig">Figure 6B</xref> shows that although the 19 pathways are aging-related for all cell types according to CellTICS, differential expression (significant GSEA <italic toggle="yes">P</italic>-values) or the differential expression stochasticity (significant Wilcoxon test <italic toggle="yes">P</italic>-values) can only be detected in a subset of cell types. Notably, these pathways are more likely to exhibit differential expression for astrocytes, while they are more likely to show differential expression stochasticity for immune cells. Although immune cells do not conform to the trend of “larger <inline-formula><tex-math notation="LaTeX" id="ImEquation91">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula>, more likely to pass Wilcoxon tests” (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S12</xref>), which means they may not use expression stochasticity to distinguish themselves from other cell types, they utilize it to differentiate old and young cells (<xref rid="f6" ref-type="fig">Figure 6B</xref>).</p>
      <p>Furthermore, our work reveals that pathways related to nonsense-mediated mRNA decay (NMD) played an important role in the aging process. NMD is a translation-coupled mechanism that eliminates mRNAs containing premature translation-termination codons [<xref rid="ref46" ref-type="bibr">46</xref>, <xref rid="ref47" ref-type="bibr">47</xref>]. In this analysis, “NMD enhanced by the exon junction complex” and “NMD independent of the exon junction complex” were discovered as important aging pathways. Current experimental research has revealed that RNA surveillance via NMD is crucial for longevity in daf-2/insulin/IGF-1 mutant C. elegans [<xref rid="ref48" ref-type="bibr">48</xref>]. The computational results in mice can complement this understanding of the role of NMD in the aging process.</p>
    </sec>
    <sec id="sec3e">
      <title>Important pathways for ASD</title>
      <p>The ASD dataset served as a demonstration of how CellTICS could identify important pathways associated with disease. The results are shown in <xref rid="f7" ref-type="fig">Figure 7</xref>. Similarly, we compared the pathways identified by CellTICS (<inline-formula><tex-math notation="LaTeX" id="ImEquation92">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p} \geq 0.1$\end{document}</tex-math></inline-formula>) that distinguish between disease status to those identified by GSEA. Despite some overlaps, CellTICS discovered many more unique pathways (<xref rid="f7" ref-type="fig">Figure 7A</xref>). Then, the <inline-formula><tex-math notation="LaTeX" id="ImEquation93">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> threshold was tightened to 0.3 and Wilcoxon tests were performed to compare the coefficient of variation of the ASD and the control groups for these CellTICS-unique pathways. The tests show that 57 out of 75 disease pathways exhibit a significant variation difference (<xref rid="f7" ref-type="fig">Figure 7B</xref>), suggesting most of these ASD-related pathways exhibited expression stochasticity.</p>
      <fig position="float" id="f7">
        <label>Figure 7</label>
        <caption>
          <p><bold>Important pathways for ASD.</bold> (<bold>A</bold>) The number of important pathways distinguishing disease status identified by CellTICS (<inline-formula><tex-math notation="LaTeX" id="ImEquation94">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p} \geq 0.1$\end{document}</tex-math></inline-formula>) or GSEA. (<bold>B</bold>) The number of pathways identified by CellTICS but not by GSEA (<inline-formula><tex-math notation="LaTeX" id="ImEquation95">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p} \geq 0.3$\end{document}</tex-math></inline-formula>) with the information whether they pass the Wilcoxon tests on CVs (<italic toggle="yes">P</italic>-values <inline-formula><tex-math notation="LaTeX" id="ImEquation96">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\leq 0.05$\end{document}</tex-math></inline-formula>). (<bold>C</bold>) Top 15 CellTICS-unique pathways (<inline-formula><tex-math notation="LaTeX" id="ImEquation97">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p} \geq 0.3$\end{document}</tex-math></inline-formula>) ordered by their significance of the Wilcoxon test on CVs. The red dashed line marks the <italic toggle="yes">P</italic>-value of 0.05. The color of each pathway indicates whether the ASD group exhibits a higher or lower coefficient of variation. (<bold>D</bold>) Top 15 important ASD pathways ordered by <inline-formula><tex-math notation="LaTeX" id="ImEquation98">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> value. Cell types corresponding to each pathway are also shown.</p>
        </caption>
        <graphic xlink:href="bbad449f7" position="float"/>
      </fig>
      <p>The top 15 disease pathways (<inline-formula><tex-math notation="LaTeX" id="ImEquation99">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p} \geq 0.3$\end{document}</tex-math></inline-formula>, but not identified by GSEA) exhibiting the most significant differential expression stochasticity are shown in <xref rid="f7" ref-type="fig">Figure 7C</xref>, and the top 15 important ASD pathways ordered by <inline-formula><tex-math notation="LaTeX" id="ImEquation100">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> values are shown in <xref rid="f7" ref-type="fig">Figure 7D</xref>. As expected, the pathway with the highest <inline-formula><tex-math notation="LaTeX" id="ImEquation101">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> value is “nervous system development”, which is consistent with the etiology of ASD. The analysis reveals that ‘axon guidance’ is among the top three terms with the largest <inline-formula><tex-math notation="LaTeX" id="ImEquation102">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$D_{p}$\end{document}</tex-math></inline-formula> value (<xref rid="f7" ref-type="fig">Figure 7D</xref>) and also ranked third for the differential expression stochasticity analysis (<xref rid="f7" ref-type="fig">Figure 7C</xref>). Notably, cortical abnormalities and genetic evidence support the notion that dysregulated axonal growth and guidance are critical developmental processes underlying the clinical manifestations of ASD [<xref rid="ref49" ref-type="bibr">49</xref>]. The findings further reinforce the importance of axon guidance in ASD.</p>
    </sec>
  </sec>
  <sec id="sec4">
    <title>CONCLUSION</title>
    <p>This study introduces CellTICS, a biologically explainable neural network tailored for cell-type identification and interpretation using single-cell RNA-seq data. CellTICS adopts a two-stage strategy to predict cell types and sub-cell types, and its innovative multi-predictive-layer strategy significantly enhances the prediction accuracy. The prediction accuracy of CellTICS is validated through comparison with alternative methods across various datasets.</p>
    <p>Moreover, CellTICS can discover important pathways that are missed by conventional methods like GSEA. These pathways may be characterized by their cell-type-specific expression stochasticity, as quantified by the coefficient of variation in Wilcoxon tests.</p>
    <p>Furthermore, the applications of CellTICS in the context of the aging process and ASD underscore its relevance for cell type identification under different physiological conditions. This adaptability is invaluable for gaining insights into how the aging process or specific diseases impact individuals across various cell types. In summary, CellTICS offers a powerful and biologically interpretable tool for advancing our understanding of cellular dynamics and their role in various health and disease states.</p>
    <boxed-text id="box01" position="float">
      <sec id="sec28a">
        <title>Key Points</title>
        <list list-type="bullet">
          <list-item>
            <p>Innovative Interpretability: CellTICS is significantly different from the traditional ‘black box’ deep learning models, offering biologically interpretable insights into cell type prediction.</p>
          </list-item>
          <list-item>
            <p>Accuracy Unleashed: With CellTICS, we have pushed the boundaries of accuracy in the identification of cell types and sub-cell types using single-cell RNA sequencing data, providing a sharper lens into the cellular world.</p>
          </list-item>
          <list-item>
            <p>Pathways Illuminated: CellTICS uncovers the hidden pathways that define unique cell types. It sheds light on the profound influence of expression stochasticity in cell type delineation which is missed by traditional analysis.</p>
          </list-item>
          <list-item>
            <p>Disease and Aging Unveiled: CellTICS excels at the identification of pathways that set cell types apart under diverse physiological conditions, providing valuable insights into the dynamic changes in cellular landscapes of disease and aging.</p>
          </list-item>
        </list>
      </sec>
    </boxed-text>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>supplementary_information_bbad449</label>
      <media xlink:href="supplementary_information_bbad449.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>ACKNOWLEDGMENTS</title>
    <p>The authors thank all members of the Chen lab for their discussions and suggestions throughout this study. This work was supported by the National Institutes of Health (R01GM137428, R01NS104041, and R01NS125276 to L.C.).</p>
  </ack>
  <sec sec-type="data-availability" id="sec19a">
    <title>CODE AND DATA AVAILABILITY</title>
    <p>The CSV data underlying this article are available in Zenodo, at <ext-link xlink:href="https://doi.org/10.5281/zenodo.7829597" ext-link-type="uri">https://doi.org/10.5281/zenodo.7829597</ext-link>. Links for accessing the original datasets are available in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>. Codes for CellTICS and all need libraries information are available at <ext-link xlink:href="https://github.com/qyyin0516/CellTICS" ext-link-type="uri">https://github.com/qyyin0516/CellTICS</ext-link>. Specifically, CellTICS was implemented using Python 3 (version 3.9.2), and the libraries involved were numpy (1.23.1), pandas (1.2.3), keras (2.9.0), tensorflow (2.9.0), networkx (2.6.3) and biomart (0.9.2). The computational tasks were executed on a Linux system equipped with two NVIDIA Tesla V100 GPUs and a memory capacity of up to 180 gigabytes. Related pathway findings are also shown on the GitHub page. For data processing and statistical analysis, we employed R (version 4.1.2). Additionally, we used the following R packages: Scater (1.22.0), caret (6.0-93) and ReactomePA (1.38.0). Besides, the HVGs were found using Python package scanpy (1.9.3).</p>
  </sec>
  <sec id="sec19n">
    <title>AUTHOR CONTRIBUTIONS STATEMENT</title>
    <p>Q.Y. and L.C. designed the research. Q.Y. implemented the methods and carried out the analyses. L.C. supervised the project. Q.Y. and L.C. discussed the results and contributed to the manuscript writing.</p>
  </sec>
  <notes id="bio3">
    <title>Author Biographies</title>
    <p><bold>Qingyang Yin</bold> is a Ph.D. student in the Department of Quantitative and Computational Biology at the University of Southern California.</p>
    <sec sec-type="author-bio" id="sec20a">
      <p><bold>Liang Chen</bold> is a professor in the Department of Quantitative and Computational Biology at the University of Southern California.</p>
    </sec>
  </notes>
  <ref-list id="bib1">
    <title>References</title>
    <ref id="ref1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tammela</surname>  <given-names>T</given-names></string-name>, <string-name><surname>Sage</surname>  <given-names>J</given-names></string-name></person-group>. <article-title>Investigating tumor heterogeneity in mouse models</article-title>. <source>Annu Rev Cancer Biol</source>  <year>2020</year>;<volume>19</volume>(<issue>6</issue>):<fpage>99</fpage>–<lpage>119</lpage>.</mixed-citation>
    </ref>
    <ref id="ref2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Molho</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Ding</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Li</surname>  <given-names>Z</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Deep learning in single-cell analysis</article-title>. <source>arXiv preprint</source>  <year>2022</year>; <comment>2210.12385</comment>.</mixed-citation>
    </ref>
    <ref id="ref3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ma</surname>  <given-names>F</given-names></string-name>, <string-name><surname>Pellegrini</surname>  <given-names>M</given-names></string-name></person-group>. <article-title>ACTINN: automated identification of cell types in single cell RNA sequencing</article-title>. <source>Bioinformatics</source>  <year>2020</year>;<volume>36</volume>(<issue>2</issue>):<fpage>533</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">31359028</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xie</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Gao</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Wang</surname>  <given-names>C</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>SuperCT: a supervised-learning framework for enhanced characterization of single-cell transcriptomic profiles</article-title>. <source>Bioinformatics</source>  <year>2019</year>;<volume>47</volume>(<issue>8</issue>):<fpage>e48</fpage>.</mixed-citation>
    </ref>
    <ref id="ref5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jia</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Lysenko</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Boroevich</surname>  <given-names>KA</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>scDeepInsight: a supervised cell-type identification method for scRNA-seq data with deep learning</article-title>. <source>Brief Bioinform</source>  <year>2023</year>;<volume>24</volume>(<issue>5</issue>):<fpage>bbad266</fpage>.<pub-id pub-id-type="pmid">37523217</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vasighizaker</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Zhou</surname>  <given-names>L</given-names></string-name>, <string-name><surname>Rueda</surname>  <given-names>L</given-names></string-name></person-group>. <article-title>Cell type identification via convolutional neural networks and self-organizing maps on single-cell RNA-seq data</article-title>. In: <source>Proceedings of the 12th ACM Conference on Bioinformatics, Computational Biology, and Health Informatics</source>, <year>2021</year>. <volume>Article 91</volume>, p. <fpage>1</fpage>–<lpage>6</lpage>.</mixed-citation>
    </ref>
    <ref id="ref7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname>  <given-names>T</given-names></string-name>, <string-name><surname>Bai</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Nabavi</surname>  <given-names>S</given-names></string-name></person-group>. <article-title>Single-cell classification using graph convolutional networks</article-title>. <source>BMC Bioinformatics</source>  <year>2021</year>;<volume>22</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>23</lpage>.<pub-id pub-id-type="pmid">33388027</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shao</surname>  <given-names>X</given-names></string-name>, <string-name><surname>Yang</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Zhuang</surname>  <given-names>X</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>scDeepSort: a pre-trained cell-type annotation method for single-cell transcriptomics using deep learning with a weighted graph neural network</article-title>. <source>Nucleic Acids Res</source>  <year>2021</year>;<volume>49</volume>(<issue>21</issue>):<fpage>e122</fpage>.<pub-id pub-id-type="pmid">34500471</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yin</surname>  <given-names>Q</given-names></string-name>, <string-name><surname>Wang</surname>  <given-names>Y</given-names></string-name>, <string-name><surname>Guan</surname>  <given-names>J</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>scIAE: an integrative autoencoder-based ensemble classification framework for single-cell RNA-seq data</article-title>. <source>Brief Bioinform</source>  <year>2022</year>;<volume>23</volume>(<issue>1</issue>):<fpage>bbab508</fpage>.<pub-id pub-id-type="pmid">34913057</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lopez</surname>  <given-names>R</given-names></string-name>, <string-name><surname>Regier</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Cole</surname>  <given-names>MB</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Deep generative modeling for single-cell transcriptomics</article-title>. <source>Nat Methods</source>  <year>2018</year>;<volume>15</volume>(<issue>12</issue>):<fpage>1053</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">30504886</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tran</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Nguyen</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Tran</surname>  <given-names>B</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Fast and precise single-cell data analysis using a hierarchical autoencoder</article-title>. <source>Nat Commun</source>  <year>2021</year>;<volume>12</volume>(<issue>1</issue>):<fpage>1029</fpage>.<pub-id pub-id-type="pmid">33589635</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Song</surname>  <given-names>T</given-names></string-name>, <string-name><surname>Dai</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Wang</surname>  <given-names>S</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>TransCluster: a cell-type identification method for single-cell RNA-seq data using deep learning based on transformer</article-title>. <source>Front Genet</source>  <year>2022</year>;<volume>13</volume>:<fpage>1038919</fpage>.<pub-id pub-id-type="pmid">36303549</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Xu</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Tao</surname>  <given-names>W</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Transformer for one stop interpretable cell type annotation</article-title>. <source>Nat Commun</source>  <year>2023</year>;<volume>14</volume>(<issue>1</issue>):<fpage>223</fpage>.<pub-id pub-id-type="pmid">36641532</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dehghan</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Razzaghi</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Abbasi</surname>  <given-names>K</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>TripletMultiDTI: multimodal representation learning in drug-target interaction prediction with triplet loss function</article-title>. <source>Exp Syst Appl</source>  <year>2023</year>;<volume>232</volume>:<fpage>120754</fpage>.</mixed-citation>
    </ref>
    <ref id="ref15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rafiei</surname>  <given-names>F</given-names></string-name>, <string-name><surname>Zeraati</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Abbasi</surname>  <given-names>K</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>DeepTraSynergy: drug combinations using multimodal deep learning with transformers</article-title>. <source>Bioinformatics</source>  <year>2023</year>;<volume>39</volume>(<issue>8</issue>):<fpage>btad438</fpage>.<pub-id pub-id-type="pmid">37467066</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pettit</surname>  <given-names>JB</given-names></string-name>, <string-name><surname>Tomer</surname>  <given-names>R</given-names></string-name>, <string-name><surname>Achim</surname>  <given-names>K</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Identifying cell types from spatially referenced single-cell expression datasets</article-title>. <source>PLoS Comput Biol</source>  <year>2014</year>;<volume>10</volume>(<issue>9</issue>):<fpage>e1003824</fpage>.<pub-id pub-id-type="pmid">25254363</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kuenzi</surname>  <given-names>BM</given-names></string-name>, <string-name><surname>Park</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Fong</surname>  <given-names>SH</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Predicting drug response and synergy using a deep learning model of human cancer cells</article-title>. <source>Cancer Cell</source>  <year>2020</year>;<volume>38</volume>(<issue>5</issue>):<fpage>672</fpage>–<lpage>84</lpage>.<pub-id pub-id-type="pmid">33096023</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ashburner</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Ball</surname>  <given-names>CA</given-names></string-name>, <string-name><surname>Blake</surname>  <given-names>JA</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Gene ontology: tool for the unification of biology</article-title>. <source>Nat Genet</source>  <year>2000</year>;<volume>25</volume>(<issue>1</issue>):<fpage>25</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">10802651</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Elmarakeby</surname>  <given-names>HA</given-names></string-name>, <string-name><surname>Hwang</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Arafeh</surname>  <given-names>R</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Biologically informed deep neural network for prostate cancer discovery</article-title>. <source>Nature</source>  <year>2021</year>;<volume>598</volume>(<issue>7880</issue>):<fpage>348</fpage>–<lpage>52</lpage>.<pub-id pub-id-type="pmid">34552244</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname>  <given-names>Y</given-names></string-name>, <string-name><surname>Barr</surname>  <given-names>K</given-names></string-name>, <string-name><surname>Reinitz</surname>  <given-names>J</given-names></string-name></person-group>. <article-title>Fully interpretable deep learning model of transcriptional control</article-title>. <source>Bioinformatics</source>  <year>2020</year>;<volume>36</volume>(<issue>Supplement_1</issue>):<fpage>i499</fpage>–<lpage>507</lpage>.<pub-id pub-id-type="pmid">32657418</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sun</surname>  <given-names>B</given-names></string-name>, <string-name><surname>Chen</surname>  <given-names>L</given-names></string-name></person-group>. <article-title>Interpretable deep learning for improving cancer patient survival based on personal transcriptomes</article-title>. <source>Sci Rep</source>  <year>2023</year>;<volume>13</volume>(<issue>1</issue>):<fpage>11344</fpage>.<pub-id pub-id-type="pmid">37443344</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shrikumar</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Greenside</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Kundaje</surname>  <given-names>A</given-names></string-name></person-group>. <article-title>Learning important features through propagating activation differences</article-title>. <source>arXiv preprint</source>  <year>2017</year>;<fpage>1704.02685</fpage>.</mixed-citation>
    </ref>
    <ref id="ref23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Novakovsky</surname>  <given-names>G</given-names></string-name>, <string-name><surname>Dexter</surname>  <given-names>N</given-names></string-name>, <string-name><surname>Libbrecht</surname>  <given-names>MW</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Obtaining genetics insights from deep learning via explainable artificial intelligence</article-title>. <source>Nat Rev Genet</source>  <year>2022</year>;<volume>24</volume>(<issue>2</issue>):<fpage>125</fpage>–<lpage>37</lpage>.<pub-id pub-id-type="pmid">36192604</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref24">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Joshi-Tope</surname>  <given-names>G</given-names></string-name>, <string-name><surname>Gillespie</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Vastrik</surname>  <given-names>I</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Reactome: a knowledgebase of biological pathways</article-title>. <source>Nucleic Acids Res</source>  <year>2005</year>;<volume>33</volume>(<issue>Supplement_1</issue>):<fpage>D428</fpage>–<lpage>32</lpage>.<pub-id pub-id-type="pmid">15608231</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zeisel</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Hochgerner</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Lönnerberg</surname>  <given-names>P</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Molecular architecture of the mouse nervous system</article-title>. <source>Nucleic Acids Res</source>  <year>2018</year>;<volume>174</volume>(<issue>4</issue>):<fpage>999</fpage>–<lpage>1014</lpage>.</mixed-citation>
    </ref>
    <ref id="ref26">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Saunders</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Macosko</surname>  <given-names>EZ</given-names></string-name>, <string-name><surname>Wysoker</surname>  <given-names>A</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Molecular diversity and specializations among the cells of the adult mouse brain</article-title>. <source>Nucleic Acids Res</source>  <year>2018</year>;<volume>174</volume>(<issue>4</issue>):<fpage>1015</fpage>–<lpage>30</lpage>.</mixed-citation>
    </ref>
    <ref id="ref27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ximerakis</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Lipnick</surname>  <given-names>SL</given-names></string-name>, <string-name><surname>Innes</surname>  <given-names>BT</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Molecular diversity and specializations among the cells of the adult mouse brain</article-title>. <source>Nat Neurosci</source>  <year>2019</year>;<volume>22</volume>(<issue>10</issue>):<fpage>1696</fpage>–<lpage>708</lpage>.<pub-id pub-id-type="pmid">31551601</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref28">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Abdelaal</surname>  <given-names>T</given-names></string-name>, <string-name><surname>Michielsen</surname>  <given-names>L</given-names></string-name>, <string-name><surname>Cats</surname>  <given-names>D</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>A comparison of automatic cell identification methods for single-cell RNA sequencing data</article-title>. <source>Genome Biol</source>  <year>2019</year>;<volume>20</volume>(<issue>1</issue>):<fpage>194</fpage>.<pub-id pub-id-type="pmid">31500660</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref29">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Velmeshev</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Schirmer</surname>  <given-names>L</given-names></string-name>, <string-name><surname>Jung</surname>  <given-names>D</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Single-cell genomics identifies cell type-specific molecular changes in autism</article-title>. <source>Science</source>  <year>2019</year>;<volume>364</volume>(<issue>6441</issue>):<fpage>685</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">31097668</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref30">
      <label>30.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McCarthy</surname>  <given-names>DJ</given-names></string-name>, <string-name><surname>Campbell</surname>  <given-names>KR</given-names></string-name>, <string-name><surname>Lun</surname>  <given-names>AT</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Scater: pre-processing, quality control, normalization and visualization of single-cell RNA-seq data in R</article-title>. <source>Bioinformatics</source>  <year>2017</year>;<volume>33</volume>(<issue>8</issue>):<fpage>1179</fpage>–<lpage>86</lpage>.<pub-id pub-id-type="pmid">28088763</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref31">
      <label>31.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kuhn</surname>  <given-names>M</given-names></string-name></person-group>. <article-title>Building predictive models in R using the caret package</article-title>. <source>J Stat Softw</source>  <year>2008</year>;<volume>28</volume>:<fpage>1</fpage>–<lpage>26</lpage>.<pub-id pub-id-type="pmid">27774042</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref32">
      <label>32.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><collab>Miltenyi Biotec</collab></person-group>. <source>Peripheral blood — Whole blood — Handbook</source>. <comment>https://www.miltenyibiotec.com/US-en/resources/macs-handbook/human-cells-and-organs/human-cell-sources/blood-human.html</comment> (<comment>11 September 2023, date last accessed</comment>).</mixed-citation>
    </ref>
    <ref id="ref33">
      <label>33.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jiang</surname>  <given-names>W</given-names></string-name>, <string-name><surname>Chen</surname>  <given-names>L</given-names></string-name></person-group>. <article-title>Tissue specificity of gene expression evolves across mammal species</article-title>. <source>J Comput Biol</source>  <year>2022</year>;<volume>29</volume>(<issue>8</issue>):<fpage>880</fpage>–<lpage>91</lpage>.<pub-id pub-id-type="pmid">35776510</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref34">
      <label>34.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aran</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Looney</surname>  <given-names>AP</given-names></string-name>, <string-name><surname>Liu</surname>  <given-names>L</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Reference-based analysis of lung single-cell sequencing reveals a transitional profibrotic macrophage</article-title>. <source>Nat Immunol</source>  <year>2019</year>;<volume>20</volume>(<issue>2</issue>):<fpage>163</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">30643263</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref35">
      <label>35.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kiselev</surname>  <given-names>VY</given-names></string-name>, <string-name><surname>Yiu</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Hemberg</surname>  <given-names>M</given-names></string-name></person-group>. <article-title>Scmap: projection of single-cell RNA-seq data across data sets</article-title>. <source>Nat Immunol</source>  <year>2018</year>;<volume>15</volume>(<issue>5</issue>):<fpage>359</fpage>–<lpage>62</lpage>.</mixed-citation>
    </ref>
    <ref id="ref36">
      <label>36.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>De Kanter</surname>  <given-names>JK</given-names></string-name>, <string-name><surname>Lijnzaad</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Candelli</surname>  <given-names>T</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>CHETAH: a selective, hierarchical cell type identification method for single-cell RNA sequencing</article-title>. <source>Nucleic Acids Res</source>  <year>2019</year>;<volume>47</volume>(<issue>16</issue>):<fpage>e95</fpage>.<pub-id pub-id-type="pmid">31226206</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref37">
      <label>37.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Alquicira-Hernandez</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Sathe</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Ji</surname>  <given-names>HP</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>scPred: accurate supervised method for cell-type classification from single-cell RNA-seq data</article-title>. <source>Genome Biol</source>  <year>2019</year>;<volume>20</volume>(<issue>1</issue>):<fpage>264</fpage>.<pub-id pub-id-type="pmid">31829268</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref38">
      <label>38.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pasquini</surname>  <given-names>G</given-names></string-name>, <string-name><surname>Arias</surname>  <given-names>JE</given-names></string-name>, <string-name><surname>Schäfer</surname>  <given-names>P</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Automated methods for cell type annotation on scRNA-seq data</article-title>. <source>Comput Struct Biotechnol J</source>  <year>2021</year>;<volume>19</volume>:<fpage>961</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">33613863</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref39">
      <label>39.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Subramanian</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Tamayo</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Mootha</surname>  <given-names>VK</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>. <source>Proc Natl Acad Sci U S A</source>  <year>2005</year>;<volume>102</volume>(<issue>43</issue>):<fpage>15545</fpage>–<lpage>50</lpage>.<pub-id pub-id-type="pmid">16199517</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref40">
      <label>40.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yu</surname>  <given-names>G</given-names></string-name>, <string-name><surname>He</surname>  <given-names>QY</given-names></string-name></person-group>. <article-title>ReactomePA: an R/Bioconductor package for reactome pathway analysis and visualization</article-title>. <source>Mol Biosyst</source>  <year>2016</year>;<volume>12</volume>(<issue>2</issue>):<fpage>477</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">26661513</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref41">
      <label>41.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Leary</surname>  <given-names>JR</given-names></string-name>, <string-name><surname>Xu</surname>  <given-names>Y</given-names></string-name>, <string-name><surname>Morrison</surname>  <given-names>AB</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Sub-cluster identification through semi-supervised optimization of rare-cell silhouettes (SCISSORS) in single-cell RNA-sequencing</article-title>. <source>Bioinformatics</source>  <year>2023</year>;<volume>39</volume>(<issue>8</issue>):<fpage>btad449</fpage>.<pub-id pub-id-type="pmid">37498558</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref42">
      <label>42.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Meng</surname>  <given-names>X</given-names></string-name>, <string-name><surname>Reed</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Lai</surname>  <given-names>S</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Stochastic scanning events on the GCN4 mRNA 5<inline-formula><tex-math notation="LaTeX" id="ImEquation103">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$^\prime $\end{document}</tex-math></inline-formula> untranslated region generate cell-to-cell heterogeneity in the yeast nutritional stress response</article-title>. <source>Nucleic Acids Res</source>  <year>2023</year>;<volume>51</volume>(<issue>13</issue>):<fpage>6609</fpage>–<lpage>21</lpage>.<pub-id pub-id-type="pmid">37246646</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref43">
      <label>43.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>de Jong</surname>  <given-names>TV</given-names></string-name>, <string-name><surname>Moshkin</surname>  <given-names>YM</given-names></string-name>, <string-name><surname>Guryev</surname>  <given-names>V</given-names></string-name></person-group>. <article-title>Gene expression variability: the other dimension in transcriptome analysis</article-title>. <source>Physiol Genomics</source>  <year>2019</year>;<volume>51</volume>(<issue>5</issue>):<fpage>145</fpage>–<lpage>58</lpage>.<pub-id pub-id-type="pmid">30875273</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref44">
      <label>44.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kaern</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Elston</surname>  <given-names>TC</given-names></string-name>, <string-name><surname>Blake</surname>  <given-names>WJ</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Stochasticity in gene expression: from theories to phenotypes</article-title>. <source>Nucleic Acids Res</source>  <year>2005</year>;<volume>6</volume>(<issue>6</issue>):<fpage>451</fpage>–<lpage>64</lpage>.</mixed-citation>
    </ref>
    <ref id="ref45">
      <label>45.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hu</surname>  <given-names>X</given-names></string-name>, <string-name><surname>Jin</surname>  <given-names>X</given-names></string-name>, <string-name><surname>Cao</surname>  <given-names>X</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>The anaphase-promoting complex/Cyclosome is a cellular ageing regulator</article-title>. <source>Int J Mol Sci</source>  <year>2022</year>;<volume>23</volume>(<issue>23</issue>):<fpage>15327</fpage>.<pub-id pub-id-type="pmid">36499653</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref46">
      <label>46.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brogna</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Wen</surname>  <given-names>J</given-names></string-name></person-group>. <article-title>Nonsense-mediated mRNA decay (NMD) mechanisms</article-title>. <source>Nat Struct Mol Biol</source>  <year>2009</year>;<volume>16</volume>(<issue>2</issue>):<fpage>107</fpage>–<lpage>13</lpage>.<pub-id pub-id-type="pmid">19190664</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref47">
      <label>47.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>  <given-names>Z</given-names></string-name>, <string-name><surname>Vuong</surname>  <given-names>JK</given-names></string-name>, <string-name><surname>Zhang</surname>  <given-names>M</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Inhibition of nonsense-mediated RNA decay by ER stress</article-title>. <source>RNA</source>  <year>2017</year>;<volume>23</volume>(<issue>3</issue>):<fpage>378</fpage>–<lpage>94</lpage>.<pub-id pub-id-type="pmid">27940503</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref48">
      <label>48.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Son</surname>  <given-names>HG</given-names></string-name>, <string-name><surname>Seo</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Ham</surname>  <given-names>S</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>RNA surveillance via nonsense-mediated mRNA decay is crucial for longevity in daf-2/insulin/IGF-1 mutant C. Elegans</article-title>. <source>Nat Commun</source>  <year>2017</year>;<volume>8</volume>(<issue>1</issue>): <fpage>1</fpage>–<lpage>11</lpage>.<pub-id pub-id-type="pmid">28232747</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref49">
      <label>49.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McFadden</surname>  <given-names>K</given-names></string-name>, <string-name><surname>Minshew</surname>  <given-names>NJ</given-names></string-name></person-group>. <article-title>Evidence for dysregulation of axonal growth and guidance in the etiology of ASD</article-title>. <source>Front Hum Neurosci</source>  <year>2013</year>;<volume>7</volume>:<fpage>671</fpage>.<pub-id pub-id-type="pmid">24155705</pub-id>
</mixed-citation>
    </ref>
  </ref-list>
</back>
