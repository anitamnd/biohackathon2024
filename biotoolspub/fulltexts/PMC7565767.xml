<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7565767</article-id>
    <article-id pub-id-type="publisher-id">3754</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-020-03754-5</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>LDkit: a parallel computing toolkit for linkage disequilibrium analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Tang</surname>
          <given-names>You</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Zhuo</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Chao</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Liu</surname>
          <given-names>Yuxin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yu</surname>
          <given-names>Helong</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Aoxue</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9791-7664</contrib-id>
        <name>
          <surname>Zhou</surname>
          <given-names>Yao</given-names>
        </name>
        <address>
          <email>zhouyao@caas.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label>Electrical and Information Engineering College, Jilin Agricultural Science and Technology University, Jilin, China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.410727.7</institution-id><institution-id institution-id-type="ISNI">0000 0001 0526 1937</institution-id><institution>Shenzhen Branch, Guangdong Laboratory for Lingnan Modern Agriculture; Genome Analysis Laboratory of the Ministry of Agriculture; Agricultural Genomics Institute at Shenzhen, </institution><institution>Chinese Academy of Agricultural Sciences, </institution></institution-wrap>Shenzhen, China </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.412243.2</institution-id><institution-id institution-id-type="ISNI">0000 0004 1760 1136</institution-id><institution>College of Horticulture and Landscape Architecture, </institution><institution>Northeast Agricultural University, </institution></institution-wrap>Harbin, China </aff>
      <aff id="Aff4"><label>4</label>Key Laboratory of Crop Biotechnology Breeding of the Ministry of Agriculture, Beidahuang Kenfeng Seed Co., Ltd., Harbin, China </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.464353.3</institution-id><institution-id institution-id-type="ISNI">0000 0000 9888 756X</institution-id><institution>Information Technology Academy, </institution><institution>Jilin Agricultural University, </institution></institution-wrap>Changchun, China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>16</day>
      <month>10</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>10</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>21</volume>
    <elocation-id>461</elocation-id>
    <history>
      <date date-type="received">
        <day>2</day>
        <month>6</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>15</day>
        <month>9</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Linkage disequilibrium (LD) analysis is broadly utilized in genetics to understand the evolutionary and demographic history and helps geneticists identify genes associated with interested inherited traits, such as diseases. There are some tools for linkage disequilibrium analysis either in a local or online way; however, there has been no such tool supporting both graphical user interface (GUI) and parallel computing.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We developed a GUI software called LDkit for LD analysis, which supports parallel computing. The LDkit supports both variant call format (VCF) and PLINK ‘ped + map’ format. At the same time, users could also just analyze a subset of individuals from the whole population. The LDkit reads the data by block and then paralleled the computation process by monitoring the usage of processes. Assessment on the Human 1000 genome data showed that when paralleled with 32 threads, the running time was reduced to less than 6 minutes from ~77 minutes using the chromosome 22 dataset with 1,103,547 SNPs and 2504 individuals.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">The software LDkit can be effectively used to calculate and plot LD decay, LD block, and linkage disequilibrium analysis between a site and a given region. Most importantly, both graphical user interface (GUI) and stand-alone packages are available for users’ convenience. LDkit was written in JAVA language under cross-platform support.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Population genetics</kwd>
      <kwd>Parallel computing</kwd>
      <kwd>Graphical user interface</kwd>
      <kwd>Linkage disequilibrium</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par14">Most of the population genetic analyses, such as detection of sites under selection, estimation of divergence time between different populations, positional cloning, and genome wide association studies (GWAS) are based on linkage disequilibrium (LD) theory, which has been investigated over 100 Years [<xref ref-type="bibr" rid="CR1">1</xref>]. For example, the degree and pattern of LD in different human populations were investigated to facilitate positional cloning [<xref ref-type="bibr" rid="CR2">2</xref>]; currently, this analysis has been replaced by GWAS when large markers are available [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>]. The decay of LD reflected the historical recombination of population, and LD blocks could be used to represent the patterns of LD and recombination hotspots [<xref ref-type="bibr" rid="CR5">5</xref>].</p>
    <p id="Par15">As there is growing interest in LD analysis, some software tools are available to provide analysis of LD decay and/or LD block, such as the LDlink, an online application designed for human genetics [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>]. The latest version of PLINK could be used for calculating LD through extensive use of bit-level parallelism, supporting both multicore and cluster parallelism [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>]. PLINK provides the most statistic for LD analysis, such as r, r<sup>2</sup>, D prime, and signed D prime; however, PLINK is not designed for LD analysis on purpose and has many inconveniences, for example, the output of PLINK is the pair-wise linkage result and takes up considerable storage space. Users need to analyze the large file further to visualize the pattern of LD decay. There is other software designed for LD analysis, like the recently published software PopLDdecay, which was designed to support the variant call format (VCF) and subgroup analysis; however, it does not support parallelism and could not be used for LD block analysis [<xref ref-type="bibr" rid="CR10">10</xref>]. LD analysis is time-consuming when there are a large number of variants and sample size. Although users could perform LD analysis on each chromosome to manually achieve parallelism, the analysis for large genome species with long chromosome length is still challenging. For example, the length of the wheat 3B chromosome is about 830 million base pairs, which is more than twice the size of the rice genome [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. Therefore, LD analysis of wheat populations using PopLDdecay may still take about one day to finish.</p>
    <p id="Par16">Here, we developed a package LDkit to provide an effective tool for LD analysis. For the convenience of users, we offer both a graphical user interface (GUI) that can be used on a personal computer and a stand-alone package on a cluster or cloud platform. The most common analysis, such as LD decay and LD block, is supported in the LDkit. In some situations, we are also interested in verifying whether a single variant is in linkage disequilibrium to the other or not, but no tool is available currently, which is accommodated as LD site in the LDkit.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par17">LDkit is developed in JAVA with supporting of parallel computing (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). We also designed the software with the advantages of other software such as PopLDdecay [<xref ref-type="bibr" rid="CR10">10</xref>] and Haploview [<xref ref-type="bibr" rid="CR13">13</xref>]. For example, LDkit supports both VCF and PLINK formats and could calculate the LD decay in a subpopulation as PopLDdecay. However, PopLDdecay does not support the LD block analysis, which is the main feature in Haploview. We designed LDkit supporting both LD decay and LD block analysis as Haploview. We also implemented the LD site analysis, which makes LDkit different from other tools. The results could be visualized directly in LDkit or through other software.<fig id="Fig1"><label>Fig. 1</label><caption><p>The LD decay analysis in LDkit. <bold>a</bold> The layout of the interface was designed according to the process of LD analysis. <bold>b</bold> The workflow of parallel analysis. <bold>c</bold> The figure of LD decay plotted by LDkit</p></caption><graphic xlink:href="12859_2020_3754_Fig1_HTML" id="MO1"/></fig></p>
    <sec id="Sec3">
      <title>Data preparation</title>
      <p id="Par18">LDkit accepts two widely used formats. The input file could be either VCF format or PLINK ‘ped + map’ format [<xref ref-type="bibr" rid="CR8">8</xref>]. LDkit is programmed using parallel computing technology so that there is no need to separate files by chromosomes. For minimizing the analysis steps when there are multiple subgroups, all subgroup information could be given in a single file, and the LD analysis for all subgroups will be performed at one-time submission.</p>
    </sec>
    <sec id="Sec4">
      <title>LD analysis</title>
      <p id="Par19">Two types of LD measurements D’ and r<sup>2</sup> were implemented in LDkit [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR15">15</xref>]. The statistic D’ is calculated using the same algorithm in PopLDdecay. Instead of the r<sup>2</sup> derived from D’ statistic as implemented in Haploview and PopLDdecay, the LDkit takes the squared Pearson correlation as PLINK (with –r2 flag). There are three different kinds of LD analyses supported by LDkit. In addition to supporting the most used LD decay and LD block analysis, LDkit also implemented a function to calculate linkage between a site and a given region, which is called the LD site.</p>
    </sec>
    <sec id="Sec5">
      <title>Parallel computing</title>
      <p id="Par20">As the multicore machine is easily available currently, we parallelized the computation in a multiple-threads way with specific optimization on programing (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). Firstly, the whole data will be read into memory and filtered at the same time. This step is currently not parallelized. Then, the entire data will be divided into <italic>N*2</italic> parts, <italic>N</italic> refers to the number of all available threads in the machine. Alternatively, the number of threads could be given by users to avoid the potential overuse of the computer resource. To reduce the channel blackout periods in this step, we optimized the program by balancing each thread’s usage using multiple virtual threads. Finally, the partial results from all partitions are gathered and combined into the final output.</p>
    </sec>
    <sec id="Sec6">
      <title>Visualization and output</title>
      <p id="Par21">LDkit could output the figure of LD decay or heatmap of the LD block directly. Different from other software, LDkit provides an adjustable view of LD decay to help users choose a better combination of parameters (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c). Users might want to plot the LD decay; accordingly, the initial results for plotting are provided by LDkit. It will be convenient for users to represent the result with other software such as R or python.</p>
    </sec>
  </sec>
  <sec id="Sec7">
    <title>Results and discussion</title>
    <sec id="Sec8">
      <title>LDkit interface</title>
      <p id="Par22">The main interface of LDkit is designed to include all sections, such as file inputs, parameter setting, selection of LD type and measurement, and plotting. All settings will be displayed on the right side for the user to double-check before running. Considering the long running time of large files, we designed a DNA logo in the bottom-right interface. The dynamic DNA logo indicates the working status of the task. Considering the multiple-task situation, we also developed a stand-alone package that could be used locally or on a cloud platform.</p>
    </sec>
    <sec id="Sec9">
      <title>LD decay analysis</title>
      <p id="Par23">To assess the performance of LDkit on LD decay analysis, we tested the software using the chromosome 22 dataset from the Human 1000 genome. There are 2,504 individuals and 219,790 variants in this dataset. For LD decay analysis, we only retained single nucleotide polymorphisms (SNPs) with a missing rate below 0.2 and an allele frequency higher than 0.01. The window size used to calculate pair-wise r<sup>2</sup> was set to 100 kb. Although the algorithms for calculating the r<sup>2</sup> in LDkit and PopLDdecay are different, the two software generated the same pattern of LD decay (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1). When only one thread was used, PopLDdecay is about 1 - 4 times faster than LDkit with almost the same memory usage. LDkit spent about 77 minutes, nearly twice as long as PopLDdecay (Table <xref rid="Tab1" ref-type="table">1</xref>). When the number of threads was set to 32, the runtime was reduced to less than 6 minutes. The memory used was not affected by the increasing number of threads and was comparable with PopLDdecay.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Comparison of performance on LD decay using PopLDdecay and LDkit</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">Population</th><th align="left" rowspan="2">Chromosome</th><th align="left" rowspan="2">Number of individuals</th><th align="left" rowspan="2">Number of SNPs</th><th align="left" colspan="2">Peak memory (GB)</th><th align="left" colspan="2">Running time (Minute)</th></tr><tr><th align="left">PopLDdecay</th><th align="left">LDkit</th><th align="left">PopLDdecay</th><th align="left">LDkit</th></tr></thead><tbody><tr><td align="left">CEU</td><td align="left">Chr22</td><td char="." align="char">183</td><td align="left">1,103,547</td><td align="left">9.87</td><td align="left">10.33</td><td align="left">2.15</td><td align="left">10.36</td></tr><tr><td align="left">CHS</td><td align="left">Chr22</td><td char="." align="char">171</td><td align="left">1,103,547</td><td align="left">9.1</td><td align="left">10.12</td><td align="left">2.03</td><td align="left">11.11</td></tr><tr><td align="left">ESN</td><td align="left">Chr22</td><td char="." align="char">173</td><td align="left">1,103,547</td><td align="left">9.36</td><td align="left">10.25</td><td align="left">2.09</td><td align="left">10.88</td></tr><tr><td align="left">GWD</td><td align="left">Chr22</td><td char="." align="char">180</td><td align="left">1,103,547</td><td align="left">9.74</td><td align="left">10.45</td><td align="left">2.11</td><td align="left">10.01</td></tr><tr><td align="left">IBS</td><td align="left">Chr22</td><td char="." align="char">162</td><td align="left">1,103,547</td><td align="left">9.2</td><td align="left">10.03</td><td align="left">2.01</td><td align="left">10.93</td></tr><tr><td align="left">All</td><td align="left">Chr22</td><td char="." align="char">2504</td><td align="left">1,103,547</td><td align="left">10.59</td><td align="left">11</td><td align="left">46.31</td><td align="left">77.47</td></tr></tbody></table></table-wrap></p>
      <p id="Par24">To systematically evaluate the performance of LDkit, we tested the running time of LDkit using different subpopulations under a various number of threads (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S1). We noticed that the running times on populations with similar population size were almost the same when using the same threads and the running time was reduced with the increasing number of threads, but the running time was not exactly linear with the number of threads or population sizes due to the time on resource monitoring. For example, for the IBS population with 162 individuals, the running time is about 11 minutes with one thread and decreased to about half a minute with 32 threads (Table <xref rid="Tab2" ref-type="table">2</xref>). We also observed that the running time is longer using 64 threads than that using 32 threads in a small population, while the running time decreases as the number of threads increases in a large population (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S1). We also compared the performance with PLINK under multiple threads situation (Table <xref rid="Tab2" ref-type="table">2</xref>). Using the same IBS population, PLINK took only one-fifth of the memory usage and 1.3–7.5 times faster than LDkit using different threads. However, only the time for calculating the pair-wise LD analysis was considered as PLINK does not support the following analysis.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Comparison of multiple-threads performance using PLINK and LDkit</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">Number of threads</th><th align="left" colspan="2">Peak memory (GB)</th><th align="left" colspan="2">Running time (Minute)</th><th align="left" colspan="2">File sizes (GB)</th></tr><tr><th align="left">PLINK 2.0</th><th align="left">LDkit</th><th align="left">PLINK 2.0</th><th align="left">LDkit</th><th align="left">PLINK 2.0</th><th align="left">LDkit</th></tr></thead><tbody><tr><td align="left">1</td><td align="left">1.05</td><td align="left">10.03</td><td align="left">0.44</td><td align="left">10.93</td><td align="left">13.97</td><td align="left">0.0019</td></tr><tr><td align="left">4</td><td align="left">1.05</td><td align="left">10.63</td><td align="left">0.43</td><td align="left">3.14</td><td align="left">13.97</td><td align="left">0.0019</td></tr><tr><td align="left">8</td><td align="left">1.05</td><td align="left">10.66</td><td align="left">0.42</td><td align="left">1.95</td><td align="left">13.97</td><td align="left">0.0019</td></tr><tr><td align="left">16</td><td align="left">1.05</td><td align="left">11.01</td><td align="left">0.42</td><td align="left">1.08</td><td align="left">13.97</td><td align="left">0.0019</td></tr><tr><td align="left">32</td><td align="left">1.05</td><td align="left">11.13</td><td align="left">0.41</td><td align="left">0.53</td><td align="left">13.97</td><td align="left">0.0019</td></tr><tr><td align="left">64</td><td align="left">1.05</td><td align="left">11.25</td><td align="left">0.43</td><td align="left">0.63</td><td align="left">13.97</td><td align="left">0.0019</td></tr></tbody></table></table-wrap><table-wrap id="Tab3"><label>Table 3</label><caption><p>Comparison of LDkit and Haploview using MHC region</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">Population</th><th align="left" rowspan="2">Number of individuals</th><th align="left" rowspan="2">Number of SNPs</th><th align="left" colspan="2">Peak memory (GB)</th><th align="left" colspan="2">Running time (Minute)</th></tr><tr><th align="left">LDkit</th><th align="left">Haploview</th><th align="left">LDkit</th><th align="left">Haploview</th></tr></thead><tbody><tr><td align="left">All</td><td align="left">2504</td><td align="left">97,900</td><td align="left">10.13</td><td align="left">1.00</td><td align="left">9.20</td><td align="left">200.00</td></tr><tr><td align="left">CEU</td><td align="left">183</td><td align="left">97,900</td><td align="left">10.66</td><td align="left">1.00</td><td align="left">4.90</td><td align="left">110.00</td></tr><tr><td align="left">CHS</td><td align="left">171</td><td align="left">97,900</td><td align="left">10.99</td><td align="left">1.00</td><td align="left">4.70</td><td align="left">105.00</td></tr><tr><td align="left">ESN</td><td align="left">173</td><td align="left">97,900</td><td align="left">11.22</td><td align="left">1.00</td><td align="left">5.10</td><td align="left">101.00</td></tr><tr><td align="left">GWD</td><td align="left">180</td><td align="left">97,900</td><td align="left">11.19</td><td align="left">1.00</td><td align="left">4.90</td><td align="left">103.00</td></tr><tr><td align="left">IBS</td><td align="left">162</td><td align="left">97,900</td><td align="left">11.28</td><td align="left">1.00</td><td align="left">4.80</td><td align="left">100.00</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec10">
      <title>LD block analysis</title>
      <p id="Par25">Both Haploview and LDkit provide the GUI and stand-alone package at the same time; the comparison of LD block could be performed under the personal computer using the GUI package. We used the MHC region (Chr6: 28,954,920-32,041,234) in the human genome for the evaluation of LD block analysis (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). Compared with Haploview, which is also a java program, LDkit performances much better at running time with more memory usage. For example, in the case of single-thread using, the running time of LDkit is less than 5 minutes, about 19 times faster than Haploview, while the memory usage has increased from 1 Gb to 10 Gb for IBS population with 162 individuals (Table <xref rid="Tab3" ref-type="table">3</xref>). We also evaluated the performance of LD block analysis using different population sizes. When tested using the whole population with 2,504 individuals, the running time of Haploview was about 200 minutes, while it was only 9.2 minutes for LDkit. For memory usage, the Haploview only needed about 1Gb memory, while the memory required by LDkit ranged from 10.13 to 11.28 Gb.<fig id="Fig2"><label>Fig. 2</label><caption><p>LD block analysis of the MHC region in different groups using LDkit. <bold>a</bold>–<bold>f</bold> All, CEU, CHS, ESN, GWD, and IBS</p></caption><graphic xlink:href="12859_2020_3754_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec11">
      <title>LD site analysis</title>
      <p id="Par26">Both LD decay and LD block only consider the linkage for local sites, while the LD site could be considered as the global linkage analysis. For example, the linkage between two paralogs located in different chromosomes. Currently, we only realized the function for calculating the linkage between one site and one region, which is called the LD site in LDkit. Considering the real situation of this function, LDkit generates linkage results in text format and could be plotted in other software like R and python.</p>
    </sec>
  </sec>
  <sec id="Sec12" sec-type="conclusion">
    <title>Conclusions</title>
    <p id="Par27">LDkit is a user-friendly JAVA software that could be used for LD analysis across multiple platforms. It was designed to provide an easy-to-use and fast tool for species with a large genome. We achieved the LDkit with both GUI and stand-alone packages supporting parallel computing. LDkit has conducted parallel computing programming to improve analysis efficiency and is comparable with other tools evaluated using the Human 1000 genome dataset. There are three functions (LD decay, LD block, and LD site) and two measurements (r<sup>2</sup> and D’) implemented in the LDkit, making it valuable under most of the LD analysis scenarios. Although LDkit has significant improvement in many parts, it performs better than the Haploview, which is also programmed using the JAVA language, other tools programmed with C/C++ performed much better than LDkit. The running time of LDkit is longer than PopLDdecay and PLINK at the same threads. However, LDkit provides the GUI package, making it easier to use compared with PopLDdecay and PLINK on a personal computer.</p>
    <p id="Par28">Furthermore, LDkit is much more efficient than PopLDdecay under a multiple-threads model. Although LDkit requires nine times more memory than Haploview for LD block analysis for the testing data, it is about 19 times faster at running time, and most importantly, the memory needed by LDkit could be satisfied in multicore machines under most situations, promising its application in the future. We offer the LDkit as an alternative tool for users who desire to perform the LD analysis in a fast way when a multicore machine is available.</p>
  </sec>
  <sec id="Sec13">
    <title>Availability and requirements</title>
    <p id="Par29">
      <list list-type="bullet">
        <list-item>
          <p id="Par30">Project name: LDkit</p>
        </list-item>
        <list-item>
          <p id="Par31">Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/tangyou79/LDkit">https://github.com/tangyou79/LDkit</ext-link></p>
        </list-item>
        <list-item>
          <p id="Par32">Operating system(s): Linux, Mac or Windows</p>
        </list-item>
        <list-item>
          <p id="Par33">Programming language: java</p>
        </list-item>
        <list-item>
          <p id="Par34">Other requirements: Java 1.8 or above</p>
        </list-item>
        <list-item>
          <p id="Par35">License: GNU GPL</p>
        </list-item>
        <list-item>
          <p id="Par36">Any restrictions to use by non-academics: LDkit is free and open to all users</p>
        </list-item>
      </list>
    </p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec25">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2020_3754_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1: Fig. S1</bold> Comparison of LD decay results between LDkit and PopLDdecay.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2020_3754_MOESM2_ESM.xlsx">
            <caption>
              <p><bold>Additional file 2: Table S1</bold> Running time using different parameters. <bold>Table S2</bold> Comparison of LD statistics in different software. <bold>Table S3</bold> Simulated genotypes for comparison of different software.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>LD</term>
        <def>
          <p id="Par4">Linkage disequilibrium</p>
        </def>
      </def-item>
      <def-item>
        <term>GUI</term>
        <def>
          <p id="Par5">Graphical user interface</p>
        </def>
      </def-item>
      <def-item>
        <term>GWAS</term>
        <def>
          <p id="Par6">Genome wide association studies</p>
        </def>
      </def-item>
      <def-item>
        <term>CEU</term>
        <def>
          <p id="Par7">Utah Residents (CEPH) with Northern and Western European Ancestry</p>
        </def>
      </def-item>
      <def-item>
        <term>CHS</term>
        <def>
          <p id="Par8">Southern Han Chinese</p>
        </def>
      </def-item>
      <def-item>
        <term>ESN</term>
        <def>
          <p id="Par9">Esan in Nigeria</p>
        </def>
      </def-item>
      <def-item>
        <term>GWD</term>
        <def>
          <p id="Par10">Gambian in Western Divisions in the Gambia</p>
        </def>
      </def-item>
      <def-item>
        <term>IBS</term>
        <def>
          <p id="Par11">Iberian Population in Spain</p>
        </def>
      </def-item>
      <def-item>
        <term>EAS</term>
        <def>
          <p id="Par12">East Asian</p>
        </def>
      </def-item>
      <def-item>
        <term>MHC</term>
        <def>
          <p id="Par13">Major histocompatibility complex</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s12859-020-03754-5.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Dr. Shusong Zheng from the Institute of Genetics and Developmental Biology, Chinese Academy of Sciences, for his valuable suggestions on the design and usability of this software.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors' contributions</title>
    <p>Y.T. and Z.L. performed the experiments with assistance from Y.L., C.W., H.Y., and Y.L.; Y.Z. and Y.T. designed the software; Y.Z. and A.W. supervised the research. Y.Z and A.W wrote the manuscripts. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by the National Natural Science Foundation of China (Grant No. 31801441) to Y.Z and the National Natural Science Foundation of China (Grant No. 31872120) to A.W.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>LDkit is open-source software. Both GUI and stand-alone packages of LDkit are freely available at GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/tangyou79/LDkit">https://github.com/tangyou79/LDkit</ext-link>).</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p id="Par37">Not applicable.</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p id="Par38">Not applicable.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par39">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sved</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>WG</given-names>
          </name>
        </person-group>
        <article-title>One Hundred Years of Linkage Disequilibrium</article-title>
        <source>Genetics</source>
        <year>2018</year>
        <volume>209</volume>
        <fpage>629</fpage>
        <lpage>636</lpage>
        <?supplied-pmid 29967057?>
        <pub-id pub-id-type="pmid">29967057</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lonjou</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Collins</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tapper</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Elahi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Maniatis</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Linkage disequilibrium in human populations</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2003</year>
        <volume>100</volume>
        <fpage>6069</fpage>
        <lpage>6074</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1031521100</pub-id>
        <pub-id pub-id-type="pmid">12721363</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>Wellcome Trust Case Control Consortium fname</collab>
        </person-group>
        <article-title>Genome-wide association study of 14,000 cases of seven common diseases and 3,000 shared controls</article-title>
        <source>Nature.</source>
        <year>2007</year>
        <volume>447</volume>
        <fpage>661</fpage>
        <lpage>678</lpage>
        <pub-id pub-id-type="doi">10.1038/nature05911</pub-id>
        <pub-id pub-id-type="pmid">17554300</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grove</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ripke</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Als</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>Mattheisen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Walters</surname>
            <given-names>RK</given-names>
          </name>
          <name>
            <surname>Won</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification of common genetic risk variants for autism spectrum disorder</article-title>
        <source>Nat Genet.</source>
        <year>2019</year>
        <volume>51</volume>
        <fpage>431</fpage>
        <lpage>444</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-019-0344-8</pub-id>
        <pub-id pub-id-type="pmid">30804558</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Twells</surname>
            <given-names>RCJ</given-names>
          </name>
          <name>
            <surname>Mein</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Phillips</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Hess</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Veijola</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gilbey</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Haplotype structure, LD blocks, and uneven recombination within the LRP5 gene</article-title>
        <source>Genome Res.</source>
        <year>2003</year>
        <volume>13</volume>
        <fpage>845</fpage>
        <lpage>855</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.563703</pub-id>
        <pub-id pub-id-type="pmid">12727905</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Machiela</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Chanock</surname>
            <given-names>SJ</given-names>
          </name>
        </person-group>
        <article-title>LDlink: A web-based application for exploring population-specific haplotype structure and linking correlated alleles of possible functional variants</article-title>
        <source>Bioinformatics.</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>3555</fpage>
        <lpage>3557</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv402</pub-id>
        <pub-id pub-id-type="pmid">26139635</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Machiela</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Chanock</surname>
            <given-names>SJ</given-names>
          </name>
        </person-group>
        <article-title>LDassoc: an online tool for interactively exploring genome-wide association study results and prioritizing variants for functional investigation</article-title>
        <source>Bioinformatics.</source>
        <year>2017</year>
        <volume>34</volume>
        <fpage>887</fpage>
        <lpage>889</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx561</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Purcell</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Neale</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Todd-Brown</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ferreira</surname>
            <given-names>MAR</given-names>
          </name>
          <name>
            <surname>Bender</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PLINK: A Tool Set for Whole-Genome Association and Population-Based Linkage Analyses</article-title>
        <source>Am J Hum Genet.</source>
        <year>2007</year>
        <volume>81</volume>
        <fpage>559</fpage>
        <lpage>575</lpage>
        <pub-id pub-id-type="doi">10.1086/519795</pub-id>
        <?supplied-pmid 17701901?>
        <pub-id pub-id-type="pmid">17701901</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Carson</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Tellier</surname>
            <given-names>LC</given-names>
          </name>
          <name>
            <surname>Vattikuti</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Purcell</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>JJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Second-generation PLINK: rising to the challenge of larger and richer datasets</article-title>
        <source>Gigascience</source>
        <year>2015</year>
        <volume>4</volume>
        <fpage>7</fpage>
        <pub-id pub-id-type="doi">10.1186/s13742-015-0047-8</pub-id>
        <pub-id pub-id-type="pmid">25722852</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Dong</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>JY</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>WM</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>TL</given-names>
          </name>
        </person-group>
        <article-title>PopLDdecay: a fast and effective tool for linkage disequilibrium decay analysis based on variant call format files</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <issue>10</issue>
        <fpage>1786</fpage>
        <lpage>1788</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty875</pub-id>
        <?supplied-pmid 30321304?>
        <pub-id pub-id-type="pmid">30321304</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <mixed-citation publication-type="other">Appels R, Eversole K, Feuillet C, Keller B, Rogers J, Stein N, et al. Shifting the limits in wheat research and breeding using a fully annotated reference genome. Science (80-). 2018;361:eaar7191. 10.1126/science.aar7191.</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">International Rice Genome Sequencing Project, Sasaki T. The map-based sequence of the rice genome. Nature. 2005;436:793–800. 10.1038/nature03895.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barrett</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Fry</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Maller</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Daly</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Haploview: analysis and visualization of LD and haplotype maps</article-title>
        <source>Bioinformatics.</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>263</fpage>
        <lpage>265</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bth457</pub-id>
        <?supplied-pmid 15297300?>
        <pub-id pub-id-type="pmid">15297300</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">Lewontin RC. The Interaction of selection and linkage. I. General considerations; heterotic models. Genetics. 1964;49:49–67.</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Hill WG, Robertson A. Linkage disequilibrium in finite populations. Theor Appl Genet. 1968;38. 10.1007/bf01245622.</mixed-citation>
    </ref>
  </ref-list>
</back>
