<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genet Sel Evol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genet. Sel. Evol</journal-id>
    <journal-title-group>
      <journal-title>Genetics, Selection, Evolution : GSE</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0999-193X</issn>
    <issn pub-type="epub">1297-9686</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3378429</article-id>
    <article-id pub-id-type="publisher-id">1297-9686-44-9</article-id>
    <article-id pub-id-type="pmid">22462519</article-id>
    <article-id pub-id-type="doi">10.1186/1297-9686-44-9</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>A phasing and imputation method for pedigreed populations that results in a single-stage genomic evaluation</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes" id="A1">
        <name>
          <surname>Hickey</surname>
          <given-names>John M</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>john.hickey@une.edu.au</email>
      </contrib>
      <contrib contrib-type="author" id="A2">
        <name>
          <surname>Kinghorn</surname>
          <given-names>Brian P</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>bkinghor@une.edu.au</email>
      </contrib>
      <contrib contrib-type="author" id="A3">
        <name>
          <surname>Tier</surname>
          <given-names>Bruce</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>btier@turing.une.edu.au</email>
      </contrib>
      <contrib contrib-type="author" id="A4">
        <name>
          <surname>van der Werf</surname>
          <given-names>Julius HJ</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>jvanderw@une.edu.au</email>
      </contrib>
      <contrib contrib-type="author" id="A5">
        <name>
          <surname>Cleveland</surname>
          <given-names>Matthew A</given-names>
        </name>
        <xref ref-type="aff" rid="I4">4</xref>
        <email>matthew.cleveland@genusplc.com</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>School of Environmental and Rural Science, University of New England, Armidale, Australia</aff>
    <aff id="I2"><label>2</label>Animal Genetics and Breeding Unit, University of New England (AGBU is a joint unit of NSW DPI and the University of New England), Armidale, Australia</aff>
    <aff id="I3"><label>3</label>Cooperative Research Centre for Sheep Industry Innovation, Armidale, Australia</aff>
    <aff id="I4"><label>4</label>Genus plc, 100 Bluegrass Commons Blvd., Suite 2200, Hendersonville, TN, 37075, USA</aff>
    <pub-date pub-type="collection">
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>19</day>
      <month>6</month>
      <year>2012</year>
    </pub-date>
    <volume>44</volume>
    <issue>1</issue>
    <fpage>9</fpage>
    <lpage>9</lpage>
    <history>
      <date date-type="received">
        <day>2</day>
        <month>11</month>
        <year>2011</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>3</month>
        <year>2012</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright ©2012 Hickey et al.; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2012</copyright-year>
      <copyright-holder>Hickey et al.; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://www.gsejournal.org/content/44/1/9"/>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Efficient, robust, and accurate genotype imputation algorithms make large-scale application of genomic selection cost effective. An algorithm that imputes alleles or allele probabilities for all animals in the pedigree and for all genotyped single nucleotide polymorphisms (SNP) provides a framework to combine all pedigree, genomic, and phenotypic information into a single-stage genomic evaluation.</p>
      </sec>
      <sec>
        <title>Methods</title>
        <p>An algorithm was developed for imputation of genotypes in pedigreed populations that allows imputation for completely ungenotyped animals and for low-density genotyped animals, accommodates a wide variety of pedigree structures for genotyped animals, imputes unmapped SNP, and works for large datasets. The method involves simple phasing rules, long-range phasing and haplotype library imputation and segregation analysis.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>Imputation accuracy was high and computational cost was feasible for datasets with pedigrees of up to 25 000 animals. The resulting single-stage genomic evaluation increased the accuracy of estimated genomic breeding values compared to a scenario in which phenotypes on relatives that were not genotyped were ignored.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>The developed imputation algorithm and software and the resulting single-stage genomic evaluation method provide powerful new ways to exploit imputation and to obtain more accurate genetic evaluations.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Genome-wide association studies and genetic evaluation systems using genomic information require large numbers of individuals that are both intensively phenotyped and densely genotyped for SNP across the genome to give reliable results. Dense SNP genotyping of the required number of individuals is still expensive. Therefore, research effort has focused on developing methods and strategies to impute genotypes from low-density platforms that are cheaper and easier to obtain. These imputation methods can be divided into two main categories, those that use linkage disequilibrium information (e.g. fastPHASE [<xref ref-type="bibr" rid="B1">1</xref>]; MaCH [<xref ref-type="bibr" rid="B2">2</xref>]; Beagle [<xref ref-type="bibr" rid="B3">3</xref>]; IMPUTE2 [<xref ref-type="bibr" rid="B4">4</xref>]) and those that use pedigree and linkage information e.g. [<xref ref-type="bibr" rid="B5">5</xref>-<xref ref-type="bibr" rid="B8">8</xref>]. Methods that use linkage disequilibrium information are suboptimal because they require at least some genotypes on each individual for which imputation is to be carried out. Some of the methods that use pedigree and linkage information are also less than optimal because they require all immediate ancestors to be densely genotyped. An optimal imputation strategy for practical application in breeding programs must (i) allow both ungenotyped and low-density genotyped animals to be imputed, (ii) be flexible with regard to which animals within the pedigree have high-density genotypes, (iii) use information from close and distant relatives and from close and distant SNP loci, (iv) function well in small and large datasets of moderately related individuals and (v) accurately impute genotypes for all animals in the pedigree for all SNP, including unmapped SNP.</p>
    <p>Single-stage genomic evaluations use all available pedigree, genomic, and phenotypic information in a single analysis to estimate breeding values. This can be achieved by using a relationship matrix that combines both pedigree and genomic information (<bold>SSMi</bold>) Misztal et al. [<xref ref-type="bibr" rid="B9">9</xref>]). From an imputation perspective, SSMi has at least three potential problems. First, in its original definition, it combines two relationship matrices (pedigree and genomic) that have two different base populations definitions, although solutions for this have been proposed recently [<xref ref-type="bibr" rid="B10">10</xref>,<xref ref-type="bibr" rid="B11">11</xref>]. Second, it can be thought of as a linear imputation method e.g. [<xref ref-type="bibr" rid="B12">12</xref>] that ignores the particulate nature of allelic inheritance. Third, while it can give different SNP different weights in the prediction equation [<xref ref-type="bibr" rid="B13">13</xref>], the implementation is usually by ‘GBLUP’ - genomic best linear unbiased prediction [<xref ref-type="bibr" rid="B14">14</xref>], which does not use variable selection (of SNP effects), such as method BayesB [<xref ref-type="bibr" rid="B15">15</xref>]. An imputation method that imputes genotypes for all animals in the pedigree for all SNP provides an alternative framework for single-stage genomic evaluations that avoids these problems.</p>
    <p>The first objective of this study was to develop a robust imputation method for pedigreed populations. The method involves simple phasing and imputation rules, long-range phasing and haplotype library imputation [<xref ref-type="bibr" rid="B16">16</xref>,<xref ref-type="bibr" rid="B17">17</xref>] as implemented in AlphaPhase1.1 [<xref ref-type="bibr" rid="B17">17</xref>], and segregation analysis [<xref ref-type="bibr" rid="B18">18</xref>]. It uses information from close and distant relatives and from close and distant SNP loci to impute genotypes for individuals for which genotype information may or may not be available, and for individuals which have close or distant relatives densely genotyped. A software package called AlphaImpute that implements the method has been made available. The second objective was to develop a single-stage genomic evaluation method (<bold>SSAI,</bold> standing for single-stage AlphaImpute) that is based on using the imputation method presented here to combine all pedigree, genomic, and phenotypic information and compare it to a method that ignores phenotypes for ungenotyped animals and to SSMi.</p>
    <p>The performance of AlphaImpute in terms of both accuracy and speed was evaluated using a dataset consisting of closely related pigs from a commercial breeding line and a multiple breed dairy cattle dataset and compared to IMPUTE2 [<xref ref-type="bibr" rid="B4">4</xref>], a widely used software package. The performance of SSAI was evaluated within the pig dataset using the empirical accuracy of the resulting estimated breeding values. It was compared to SSMi for the complete data, and with an analysis that did not use phenotypes on ungenotyped animals.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>Segregation analysis, long-range phasing, and haplotype library imputation</title>
      <p>AlphaImpute combines simple phasing and imputation rules, long-range phasing, haplotype libraries, and segregation analysis to impute genotypes of all animals in a pedigree for all genotyped SNP. The program imputes alleles, when it has information to do this, and probabilities based on the algorithm of Kerr and Kinghorn [<xref ref-type="bibr" rid="B18">18</xref>], when the information is incomplete using single locus information. Imputed genotypes are constructed as the sum of the alleles or allele probabilities.</p>
      <p>AlphaImpute proceeds by first separating out a set of animals that are genotyped at high-density. These animals have their SNP phased using long-range phasing and haplotype library imputation, generating haplotype libraries in the process [<xref ref-type="bibr" rid="B17">17</xref>]. Allele probabilities [<xref ref-type="bibr" rid="B18">18</xref>] are calculated for all SNP for all animals in the pedigree and alleles are imputed when these probabilities are &gt;0.99. This can be thought of as single-locus phasing. Once the single-locus phasing and the long-range phasing are completed, the haplotypes identified in the long-range phasing are matched to alleles phased by single-locus phasing. This matching step begins with parental and other ancestral haplotypes by processing the data from the oldest to the youngest individual in the pedigree. The second part of the matching step involves processing the haplotype libraries to see if the haplotypes that an animal carries exist in the library in animals that are not identified as ancestors within the available pedigree information. The haplotype libraries are updated with any new haplotypes that are identified during this process. These steps are iterated a number of times (user defined). Finally, using the updated dataset, which now includes a large number of imputed SNP, allele probabilities are re-calculated for all SNP for all animals in the pedigree. The complete algorithm is outlined in the Appendix.</p>
    </sec>
    <sec>
      <title>Test datasets</title>
      <p>The performance of AlphaImpute was tested using two real datasets, a pig and a bovine dataset that had genotype information spread sparsely across multiple generations. In these datasets, some animals had multiple generations of high-density genotyped ancestors available, while for others only some or none of the ancestors had high-density genotypes. The pig dataset (courtesy of PIC) involved a pedigree comprising 6 473 individuals, of which 3 534 were genotyped on the Illumina PorcineSNP60 BeadChip. Genotype information for chromosome 1 was used and after routine editing of the genotype data, 4 221 SNP with known genome locations remained. This population came from a single PIC breeding line and consequently the individuals were moderately to highly related to each other. The dairy cattle dataset (courtesy of LIC) involved a pedigree comprising 24 017 individuals, of which 5 057 were genotyped on the Illumina BovineSNP50 BeadChip. Genotype information for chromosome 1 was used and after routine editing of the genotype data, 2 297 SNP with known genome locations remained. This population was multiple-breed in nature, containing Holsteins, Jerseys, and crossbreds. In the pig dataset, most female and male ancestors were genotyped at high-density while in the cattle dataset only male ancestors were genotyped at high-density in most cases. In both datasets no other genotyping was used other than the low-density genotyping of the testing individuals.</p>
      <p>The genotyped animals were divided into training and testing sets. The training set was genotyped at high-density (for all SNP), while the testing sets had different proportions of their SNP masked and then imputed. In the pig dataset, the masked proportions were 99% (<bold>Pig99</bold>), 95% (<bold>Pig95</bold>), 90% (<bold>Pig90</bold>), and 85% (<bold>Pig85</bold>). In the cattle dataset, the masked proportions were 99% (<bold>Cat99</bold>), 95% (<bold>Cat95</bold>), 90% (<bold>Cat 90</bold>), and 85% (<bold>Cat85</bold>). These densities were roughly equivalent to 500, 2 500, 5 000 and 7 500 genome-wide low-density SNP arrays. The SNP on the low-density platforms were chosen by identifying evenly spaced 5 SNP windows across the chromosome and then choosing the SNP with the highest minor allele frequency from each window. For the pig data, the testing set comprised the 509 most recently born animals that were genotyped, which reflects a scenario where candidates for selection are genotyped at low density. For the cattle data, the testing set comprised 626 randomly selected individuals across generations that had both parents known in the pedigree but not necessarily genotyped.</p>
      <p>The accuracy of imputation of unmapped SNP was tested using the same data structures by running the program with a qualifier that does not invoke the long-range phasing and haplotype imputation steps. Therefore the only imputation carried out was based on simple single locus phasing and imputation rules and the segregation analysis procedures of Kerr and Kinghorn [<xref ref-type="bibr" rid="B18">18</xref>].</p>
      <p>This study used pre-existing data sets that were recorded independently of this study, therefore no ethical approval was required.</p>
    </sec>
    <sec>
      <title>Imputation accuracy</title>
      <p>The performance of AlphaImpute was compared to that of the software IMPUTE2 (Howie et al. [<xref ref-type="bibr" rid="B4">4</xref>]; Department of Statistics, University of Oxford, UK). IMPUTE2 was used with its default settings, and an effective population size of 1 000 was assumed. IMPUTE2 uses linkage disequilibrium information to perform imputation, requires each individual to be imputed to have some SNP genotypes and does not use pedigree information. Therefore, IMPUTE2 does not impute genotypes for ungenotyped animals in the pedigree. IMPUTE2 is a hidden-Markov model based pedigree-free imputation approach with methodological similarities to Beagle, MaCH, and fastPHASE, which have been compared to each other in several studies [<xref ref-type="bibr" rid="B4">4</xref>,<xref ref-type="bibr" rid="B19">19</xref>,<xref ref-type="bibr" rid="B20">20</xref>]. Generally speaking, they give similar results but Marchini and Howie [<xref ref-type="bibr" rid="B20">20</xref>] showed a slight advantage for IMPUTE2. Accuracy of imputation was measured as the correlation between true genotype with imputed genotype or genotype probability for reasons outlined in [<xref ref-type="bibr" rid="B21">21</xref>].</p>
      <p>AlphaImpute can also impute phased alleles or provide allele probabilities for animals in the pedigree that have low-density genotypes or no genotypes. The proportion of paternal or maternal phased alleles that was called without ambiguity (i.e. alleles rather than allele probabilities were called because haplotypes could be resolved unambiguously) was also explored. For this purpose, animals in the testing set were divided into six categories depending on their pattern of relationship to their most recent densely genotyped ancestors. The categories were: both parents genotyped (<bold>BothParents</bold>); sire and maternal grandsire (<bold>SireMGS</bold>); dam and paternal grandsire (<bold>DamPGS</bold>); sire only (<bold>Sire</bold>); dam only (<bold>Dam</bold>); and other relatives (<bold>Other</bold>). The numbers of animals in each category are given in Table <xref ref-type="table" rid="T1">1</xref> for the pig dataset and Table <xref ref-type="table" rid="T2">2</xref> for the cattle dataset.</p>
      <table-wrap position="float" id="T1">
        <label>Table 1</label>
        <caption>
          <p>Accuracy of imputation for the pig dataset</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th align="left"> </th>
              <th align="left"> </th>
              <th align="left">Pig99</th>
              <th align="left"> </th>
              <th align="left">Pig95</th>
              <th align="left"> </th>
              <th align="left">Pig90</th>
              <th align="left"> </th>
              <th align="left">Pig85</th>
              <th align="left"> </th>
              <th align="left">Unmapped</th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td align="left" valign="bottom">Category<sup>1</sup><hr/></td>
              <td align="left" valign="bottom">Count<sup>2</sup><hr/></td>
              <td align="left" valign="bottom">AI<sup>3</sup><hr/></td>
              <td align="left" valign="bottom">I2<sup>4</sup><hr/></td>
              <td align="left" valign="bottom">AI<sup>3</sup><hr/></td>
              <td align="left" valign="bottom">I2<sup>4</sup><hr/></td>
              <td align="left" valign="bottom">AI<sup>3</sup><hr/></td>
              <td align="left" valign="bottom">I2<sup>4</sup><hr/></td>
              <td align="left" valign="bottom">AI<sup>3</sup><hr/></td>
              <td align="left" valign="bottom">I2<sup>4</sup><hr/></td>
              <td align="left" valign="bottom">AI<sup>3</sup><hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">BothParents<hr/></td>
              <td align="left" valign="bottom">51<hr/></td>
              <td align="left" valign="bottom">0.98<hr/></td>
              <td align="left" valign="bottom">0.77<hr/></td>
              <td align="left" valign="bottom">0.99<hr/></td>
              <td align="left" valign="bottom">0.92<hr/></td>
              <td align="left" valign="bottom">1.00<hr/></td>
              <td align="left" valign="bottom">0.96<hr/></td>
              <td align="left" valign="bottom">1.00<hr/></td>
              <td align="left" valign="bottom">0.96<hr/></td>
              <td align="left" valign="bottom">0.83<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">SireMGS<hr/></td>
              <td align="left" valign="bottom">62<hr/></td>
              <td align="left" valign="bottom">0.93<hr/></td>
              <td align="left" valign="bottom">0.80<hr/></td>
              <td align="left" valign="bottom">0.98<hr/></td>
              <td align="left" valign="bottom">0.92<hr/></td>
              <td align="left" valign="bottom">0.99<hr/></td>
              <td align="left" valign="bottom">0.94<hr/></td>
              <td align="left" valign="bottom">0.99<hr/></td>
              <td align="left" valign="bottom">0.96<hr/></td>
              <td align="left" valign="bottom">0.78<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">DamPGS<hr/></td>
              <td align="left" valign="bottom">47<hr/></td>
              <td align="left" valign="bottom">0.96<hr/></td>
              <td align="left" valign="bottom">0.79<hr/></td>
              <td align="left" valign="bottom">0.98<hr/></td>
              <td align="left" valign="bottom">0.92<hr/></td>
              <td align="left" valign="bottom">0.99<hr/></td>
              <td align="left" valign="bottom">0.95<hr/></td>
              <td align="left" valign="bottom">0.99<hr/></td>
              <td align="left" valign="bottom">0.96<hr/></td>
              <td align="left" valign="bottom">0.82<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">Sire<hr/></td>
              <td align="left" valign="bottom">45<hr/></td>
              <td align="left" valign="bottom">0.89<hr/></td>
              <td align="left" valign="bottom">0.78<hr/></td>
              <td align="left" valign="bottom">0.97<hr/></td>
              <td align="left" valign="bottom">0.92<hr/></td>
              <td align="left" valign="bottom">0.99<hr/></td>
              <td align="left" valign="bottom">0.95<hr/></td>
              <td align="left" valign="bottom">0.99<hr/></td>
              <td align="left" valign="bottom">0.97<hr/></td>
              <td align="left" valign="bottom">0.78<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">Dam<hr/></td>
              <td align="left" valign="bottom">13<hr/></td>
              <td align="left" valign="bottom">0.90<hr/></td>
              <td align="left" valign="bottom">0.76<hr/></td>
              <td align="left" valign="bottom">0.96<hr/></td>
              <td align="left" valign="bottom">0.89<hr/></td>
              <td align="left" valign="bottom">0.98<hr/></td>
              <td align="left" valign="bottom">0.93<hr/></td>
              <td align="left" valign="bottom">0.98<hr/></td>
              <td align="left" valign="bottom">0.95<hr/></td>
              <td align="left" valign="bottom">0.73<hr/></td>
            </tr>
            <tr>
              <td align="left">Other</td>
              <td align="left">291</td>
              <td align="left">0.86</td>
              <td align="left">0.79</td>
              <td align="left">0.94</td>
              <td align="left">0.91</td>
              <td align="left">0.97</td>
              <td align="left">0.95</td>
              <td align="left">0.97</td>
              <td align="left">0.96</td>
              <td align="left">0.76</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p><sup>1</sup>Animals in the testing set were divided into six categories depending on their pattern of relationship to their most recent densely genotyped ancestors; the categories were: both parents genotyped (BothParents); sire and maternal grandsire (SireMGS); dam and paternal grandsire (DamPGS); sire only (Sire); dam only (Dam); and other relatives (Other); <sup>2</sup>Count refers to the number of individuals in each category; <sup>3</sup>AI = AlphaImpute; I2<sup>4</sup>=IMPUTE2.</p>
        </table-wrap-foot>
      </table-wrap>
      <table-wrap position="float" id="T2">
        <label>Table 2</label>
        <caption>
          <p>Accuracy of imputation for the cattle dataset</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th align="left"> </th>
              <th align="left"> </th>
              <th align="left">Cat99</th>
              <th align="left"> </th>
              <th align="left">Cat95</th>
              <th align="left"> </th>
              <th align="left">Cat90</th>
              <th align="left"> </th>
              <th align="left">Cat85</th>
              <th align="left"> </th>
              <th align="left">Unmapped</th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td align="left" valign="bottom">Category<sup>1</sup><hr/></td>
              <td align="left" valign="bottom">Count<sup>2</sup><hr/></td>
              <td align="left" valign="bottom">AI<sup>3</sup><hr/></td>
              <td align="left" valign="bottom">I2<sup>4</sup><hr/></td>
              <td align="left" valign="bottom">AI<sup>3</sup><hr/></td>
              <td align="left" valign="bottom">I2<sup>4</sup><hr/></td>
              <td align="left" valign="bottom">AI<sup>3</sup><hr/></td>
              <td align="left" valign="bottom">I2<sup>4</sup><hr/></td>
              <td align="left" valign="bottom">AI<sup>3</sup><hr/></td>
              <td align="left" valign="bottom">I2<sup>4</sup><hr/></td>
              <td align="left" valign="bottom">AI<sup>3</sup><hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">BothParents<hr/></td>
              <td align="left" valign="bottom">28<hr/></td>
              <td align="left" valign="bottom">0.97<hr/></td>
              <td align="left" valign="bottom">0.64<hr/></td>
              <td align="left" valign="bottom">0.99<hr/></td>
              <td align="left" valign="bottom">0.92<hr/></td>
              <td align="left" valign="bottom">0.99<hr/></td>
              <td align="left" valign="bottom">0.94<hr/></td>
              <td align="left" valign="bottom">1.00<hr/></td>
              <td align="left" valign="bottom">0.95<hr/></td>
              <td align="left" valign="bottom">0.85<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">SireMGS<hr/></td>
              <td align="left" valign="bottom">224<hr/></td>
              <td align="left" valign="bottom">0.87<hr/></td>
              <td align="left" valign="bottom">0.60<hr/></td>
              <td align="left" valign="bottom">0.97<hr/></td>
              <td align="left" valign="bottom">0.91<hr/></td>
              <td align="left" valign="bottom">0.98<hr/></td>
              <td align="left" valign="bottom">0.95<hr/></td>
              <td align="left" valign="bottom">0.99<hr/></td>
              <td align="left" valign="bottom">0.96<hr/></td>
              <td align="left" valign="bottom">0.82<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">DamPGS<hr/></td>
              <td align="left" valign="bottom">7<hr/></td>
              <td align="left" valign="bottom">0.92<hr/></td>
              <td align="left" valign="bottom">0.63<hr/></td>
              <td align="left" valign="bottom">0.97<hr/></td>
              <td align="left" valign="bottom">0.87<hr/></td>
              <td align="left" valign="bottom">0.98<hr/></td>
              <td align="left" valign="bottom">0.91<hr/></td>
              <td align="left" valign="bottom">0.98<hr/></td>
              <td align="left" valign="bottom">0.95<hr/></td>
              <td align="left" valign="bottom">0.84<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">Sire<hr/></td>
              <td align="left" valign="bottom">144<hr/></td>
              <td align="left" valign="bottom">0.86<hr/></td>
              <td align="left" valign="bottom">0.60<hr/></td>
              <td align="left" valign="bottom">0.96<hr/></td>
              <td align="left" valign="bottom">0.90<hr/></td>
              <td align="left" valign="bottom">0.98<hr/></td>
              <td align="left" valign="bottom">0.95<hr/></td>
              <td align="left" valign="bottom">0.98<hr/></td>
              <td align="left" valign="bottom">0.96<hr/></td>
              <td align="left" valign="bottom">0.82<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">Dam<hr/></td>
              <td align="left" valign="bottom">4<hr/></td>
              <td align="left" valign="bottom">0.95<hr/></td>
              <td align="left" valign="bottom">0.63<hr/></td>
              <td align="left" valign="bottom">0.98<hr/></td>
              <td align="left" valign="bottom">0.90<hr/></td>
              <td align="left" valign="bottom">0.99<hr/></td>
              <td align="left" valign="bottom">0.97<hr/></td>
              <td align="left" valign="bottom">0.99<hr/></td>
              <td align="left" valign="bottom">0.95<hr/></td>
              <td align="left" valign="bottom">0.85<hr/></td>
            </tr>
            <tr>
              <td align="left">Other</td>
              <td align="left">219</td>
              <td align="left">0.84</td>
              <td align="left">0.58</td>
              <td align="left">0.94</td>
              <td align="left">0.90</td>
              <td align="left">0.96</td>
              <td align="left">0.95</td>
              <td align="left">0.97</td>
              <td align="left">0.96</td>
              <td align="left">0.82</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p><sup>1</sup>Animals in the testing set were divided into six categories depending on their pattern of relationship to their most recent densely genotyped ancestors; the categories were: both parents genotyped (BothParents); sire and maternal grandsire (SireMGS); dam and paternal grandsire (DamPGS); sire only (Sire); dam only (Dam); and other relatives (Other); <sup>2</sup>Count refers to the number of individuals in each category; <sub>3</sub>AI=AlphaImpute; I2<sup>4</sup>=IMPUTE2</p>
          <p><sup>3</sup>AlphaI = AlphaImpute.</p>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>Single-stage genomic evaluations</title>
      <p>Single-stage genomic evaluations use all available pedigree, genomic, and phenotypic information in a single analysis to estimate breeding values [<xref ref-type="bibr" rid="B9">9</xref>]. SSAI uses AlphaImpute to generate imputed or observed genotypes for all animals in a pedigree for all genotyped SNP. These genotypes can be fitted in a genomic prediction model via GBLUP [<xref ref-type="bibr" rid="B14">14</xref>] or a Bayesian model such as BayesB [<xref ref-type="bibr" rid="B15">15</xref>]. This facilitates the inclusion of the phenotypes of all animals in the pedigree in the breeding value estimation model, including those of animals that are not genotyped.</p>
      <p>The performance of SSAI was evaluated in the pig dataset using three different growth and composition traits with heritabilities ranging from 0.38 to 0.62. This data was from the same pedigree as described previously but used SNP on all chromosomes rather than just chromosome 1. After routine editing of SNP, 52 843 SNP remained, of which 43 949 SNP were mapped to the 18 autosomal chromosomes and 8 894 SNP were unmapped. Unlike in the imputation scenarios described in the previous section, for the testing of SSAI, genotyped animals were only genotyped at high-density. The data were divided into a training and a validation set. The validation set comprised the same 509 genotyped animals from the most recent generation of the pedigree that were used for testing the imputation accuracy as described previously. These validation animals also had progeny test EBV (<bold>ptEBV</bold>) and accuracies from single-trait BLUP evaluations. The models for estimating ptEBV used the full PIC pedigree and all data included in a typical production run for each trait but no genomic information and also the phenotypes on the validation animals or their progeny were excluded. The mean accuracy of the ptEBV for the validation animals for each trait is given in Table <xref ref-type="table" rid="T3">3</xref>.</p>
      <table-wrap position="float" id="T3">
        <label>Table 3</label>
        <caption>
          <p>Performance of single-stage genomic evaluation in the pig dataset</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th align="left"> </th>
              <th align="left"> </th>
              <th colspan="3" align="left">Correlation between <sup>1</sup>gEBV and <sup>2</sup>ptEBV</th>
              <th align="left"> </th>
              <th colspan="2" align="left"><sup>3</sup>Number of phenotypes</th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td align="left" valign="bottom"><sup>4</sup>Trait<hr/></td>
              <td align="left" valign="bottom">h<sup>2</sup><hr/></td>
              <td align="left" valign="bottom"><sup>5</sup>SC1<hr/></td>
              <td align="left" valign="bottom"><sup>6,7</sup>SC2-SSAI<hr/></td>
              <td align="left" valign="bottom"><sup>8</sup>SC2-SSMi<hr/></td>
              <td align="left" valign="bottom">Average accuracy of ptEBV<hr/></td>
              <td align="left" valign="bottom">SC1<hr/></td>
              <td align="left" valign="bottom">SC2<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">1<hr/></td>
              <td align="left" valign="bottom">0.38<hr/></td>
              <td align="left" valign="bottom">0.51<hr/></td>
              <td align="left" valign="bottom">0.51<hr/></td>
              <td align="left" valign="bottom">0.54<hr/></td>
              <td align="left" valign="bottom">0.89<hr/></td>
              <td align="left" valign="bottom">2632<hr/></td>
              <td align="left" valign="bottom">4650<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">2<hr/></td>
              <td align="left" valign="bottom">0.58<hr/></td>
              <td align="left" valign="bottom">0.33<hr/></td>
              <td align="left" valign="bottom">0.51<hr/></td>
              <td align="left" valign="bottom">0.50<hr/></td>
              <td align="left" valign="bottom">0.94<hr/></td>
              <td align="left" valign="bottom">2643<hr/></td>
              <td align="left" valign="bottom">4784<hr/></td>
            </tr>
            <tr>
              <td align="left">3</td>
              <td align="left">0.62</td>
              <td align="left">0.42</td>
              <td align="left">0.60</td>
              <td align="left">0.55</td>
              <td align="left">0.94</td>
              <td align="left">2675</td>
              <td align="left">4840</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p><sup>1</sup>gEBV = genomic estimated breeding value; <sup>2</sup>ptEBV = progeny test estimated breeding value; <sup>3</sup>number of phenotypes available, as not all individuals that were genotyped were phenotyped for all traits; <sup>4</sup>the traits were growth and composition traits of pigs; <sup>5</sup>SC1 = only the phenotypes of the 3 025 genotyped animals that were not part of the validation population were used to train the prediction equation; <sup>6</sup>SC2 = the phenotypes of the 3 025 genotyped animals that were not part of the validation population and the phenotypes of the 2 939 other animals in the pedigree that were not genotyped were used to train the prediction equation; <sup>7</sup>SSAI = single stage methodology of AlphaImpute; <sup>8</sup>SSMi = single stage methodology of Misztal et al. [<xref ref-type="bibr" rid="B9">9</xref>].</p>
        </table-wrap-foot>
      </table-wrap>
      <p>Two different training sets were used. In scenario 1 (<bold>SC1</bold>), only the phenotypes of the 3 025 genotyped animals that were not part of the validation population were used to train the prediction equation. In scenario 2 (<bold>SC2</bold>), the phenotypes of the 3 025 genotyped animals that were not part of the validation population and the phenotypes of the 2 939 other animals in the pedigree that were not genotyped were used to train the prediction equation. Not all animals in the training population had phenotypes for all traits and the numbers of phenotypes included in the analysis for SC1 and SC2 for each trait are given in Table <xref ref-type="table" rid="T3">3</xref>.</p>
      <p>In order to evaluate the performance of SSAI, genomic estimated breeding values (gEBV) were estimated for SC1 using the Bayesian model BayesBFast [<xref ref-type="bibr" rid="B22">22</xref>] implemented in AlphaBayes [<xref ref-type="bibr" rid="B23">23</xref>]. For SC2, gEBV were estimated using SSAI and SSMi. For SC2, SSAI was applied by first using AlphaImpute to generate imputed genotypes and gEBV were then estimated by BayesBFast. AlphaBayes was chosen because it can include real numbers in its design matrix for the SNP. This is important because, when there is insufficient information to fully impute an allele (i.e. call the allele as a 0 or a 1) in the resulting genotypes, the sum of the allele probabilities generated by AlphaImpute are real numbers between 0 and 2, rather than the more usual 0, 1, or 2 integers used for coding genotypes. An alternative Bayesian genomic selection software package that rounds probabilities to integers was also tested and did not perform as well. For SC2, SSMi was implemented as described by Aguilar et al. [<xref ref-type="bibr" rid="B24">24</xref>], using BLUPF90.</p>
    </sec>
  </sec>
  <sec sec-type="results">
    <title>Results</title>
    <sec>
      <title>Performance of AlphaImpute</title>
      <sec>
        <title>Accuracy of imputation</title>
        <p>Genotypes imputed with AlphaImpute had very high accuracy across all categories of animals in both datasets and accuracies were greater than with IMPUTE2 (Tables <xref ref-type="table" rid="T1">1</xref> and <xref ref-type="table" rid="T2">2</xref>). The higher accuracy of AlphaImpute over IMPUTE2 increased with reducing density of the low-density panels. For both AlphaImpute and IMPUTE2, the correlation between true and imputed genotypes increased with increasing relatedness of the animal to be imputed with its most recent genotyped ancestors and as its genotype density increased. Animals that had both parents genotyped had imputation accuracies of 0.98, 0.99, 1.00, 1.00 for Pig99, Pig95, Pig90, and Pig85 for AlphaImpute, corresponding to accuracies of 0.77, 0.92, 0.96, and 0.96 for IMPUTE2. Animals that had both parents genotyped had accuracies of 0.97, 0.99, 0.99, and 1.00 respectively for Cat99, Cat95, Cat90, and Cat85 for AlphaImpute and of 0.64, 0.92, 0.94, and 0.95 for IMPUTE2.</p>
        <p>Sires and grandsires play an important role in commercial breeding programs and it may be economically feasible to use a genotyping strategy that involves genotyping these animals at high-density and candidates for selection at low-density. For the pig population, the SireMGS category of animals had imputation accuracies of 0.93, 0.98, 0.99, and 0.99 for Pig99, Pig95, Pig90, and Pig85 for AlphaImpute and of 0.80, 0.92, 0.94, and 0.96 for IMPUTE2. For the cattle population, the SireMGS category of animals had accuracies of imputation of 0.87, 0.97, 0.98, and 0.98 for Cat99, Cat95, Cat90, and Cat85 for AlphaImpute, and 0.60, 0.91, 0.95, and 0.96 for IMPUTE2.</p>
        <p>The distribution of imputation accuracies was skewed, with most animals having very high accuracy and a small number of individuals with much lower accuracy. The distribution of imputation accuracy is shown in Figure <xref ref-type="fig" rid="F1">1</xref> for the Pig99 and Pig95 scenarios. For Pig99, 14% of the animals had an imputation accuracy lower than 0.80 but it was never lower than 0.60. Imputation accuracy was very high for all animals that had both parents genotyped (Figure <xref ref-type="fig" rid="F2">2</xref>). Problems tended to arise for animals with no close ancestors genotyped (i.e. “Other”), especially for Pig99 (Figure <xref ref-type="fig" rid="F2">2</xref>).</p>
        <fig id="F1" position="float">
          <label>Figure 1</label>
          <caption>
            <p>Distribution of the correlations between true and imputed genotypes for the test animals for the (a) Pig99 and (b) Pig95 scenarios.</p>
          </caption>
          <graphic xlink:href="1297-9686-44-9-1"/>
        </fig>
        <fig id="F2" position="float">
          <label>Figure 2</label>
          <caption>
            <p><sup><bold>1</bold></sup><bold>Correlations between true and imputed genotypes for the test animals for the (a) Pig99 and (b) Pig95 scenarios, separated by category of animals.</bold><sup>1</sup>Animals in the testing set were divided into six categories depending on their pattern of relationship to their most recent densely genotyped ancestors; the categories were: both parents genotyped (BothParents); sire and maternal grandsire (SireMGS); dam and paternal grandsire (DamPGS); sire only (Sire); dam only (Dam); and other relatives (Other).</p>
          </caption>
          <graphic xlink:href="1297-9686-44-9-2"/>
        </fig>
        <p>The relationship between imputation accuracy and the minimum % paternal or maternal alleles called without ambiguity is shown in Figure <xref ref-type="fig" rid="F3">3</xref>. Animals with less than 90% of their alleles called without ambiguity tended to have a lower accuracy, suggesting that a threshold could be used to give a warning about the quality of imputation for animals that are likely to have large numbers of errors or that have low relationships to animals with high-density genotypes and, hence, little information for imputation. Figures <xref ref-type="fig" rid="F4">4</xref> and <xref ref-type="fig" rid="F5">5</xref> show the distribution of the % alleles called without ambiguity. This % was in line with expectations given the category that an animal belonged to. For example, for individuals for which only dams were genotyped (category <italic>Dam</italic>), the % of maternal alleles imputed was high.</p>
        <fig id="F3" position="float">
          <label>Figure 3</label>
          <caption>
            <p><bold>Scatter plots of the correlation between true and imputed genotypes for the test animals and the percent of paternal or maternal alleles called without ambiguity.</bold> (<bold>a</bold>) Paternal Pig99, (<bold>b</bold>) Maternal Pig99, (<bold>c</bold>) Paternal Pig95, (<bold>d</bold>) Maternal Pig95.</p>
          </caption>
          <graphic xlink:href="1297-9686-44-9-3"/>
        </fig>
        <fig id="F4" position="float">
          <label>Figure 4</label>
          <caption>
            <p><bold>Distribution of the percentage of paternal or maternal alleles called without ambiguity for the test animals for the Pig99 and Pig95 scenarios.</bold> (<bold>a</bold>) Paternal Pig99, (<bold>b</bold>) Maternal Pig99, (<bold>c</bold>) Paternal Pig95, (<bold>d</bold>) Maternal Pig95.</p>
          </caption>
          <graphic xlink:href="1297-9686-44-9-4"/>
        </fig>
        <fig id="F5" position="float">
          <label>Figure 5</label>
          <caption>
            <p><sup><bold>1</bold></sup><bold>Percentage of imputed paternal and maternal alleles for the test animals separated by the category of the animals.</bold> (<bold>a</bold>) Paternal Pig99, (<bold>b</bold>) Maternal Pig99, (<bold>c</bold>) Paternal Pig95, (<bold>d</bold>) Maternal Pig95. <sup>1</sup>Animals in the testing set were divided into six categories depending on their pattern of relationship to their most recent densely genotyped ancestors; the categories were: both parents genotyped (BothParents); sire and maternal grandsire (SireMGS); dam and paternal grandsire (DamPGS); sire only (Sire); dam only (Dam); and other relatives (Other).</p>
          </caption>
          <graphic xlink:href="1297-9686-44-9-5"/>
        </fig>
        <p>Imputation accuracy for unmapped SNP was lower than for mapped SNP, with accuracies ranging from 0.73 to 0.83 for the pig dataset (Table <xref ref-type="table" rid="T1">1</xref>) and 0.82 to 0.85 for the dairy cattle dataset (Table <xref ref-type="table" rid="T2">2</xref>). Within each dataset, the trend for increasing imputation accuracy with increasing levels of genotyping of immediate ancestors (i.e. parents and grandparents) that was observed for mapped SNP, was also observed for unmapped SNP. Imputation of unmapped SNP is based on single-locus phasing and imputation and segregation analysis and therefore gives an indication as to the power of this component for the purposes of imputation in comparison to the other components, which make explicit use of haplotypes.</p>
      </sec>
      <sec>
        <title>Computation time</title>
        <p>AlphaImpute has a number of options to increase its computational efficiency. When using the basic option, which performs long-range phasing and then does the imputation, it took 18 hours to carry out the imputation for the whole genome (i.e. the genotyped SNP on all 18 autosomes and the unmapped SNP) for the pig dataset on a Linux server with 16 processors and 96 GB of RAM (the RAM was not needed because memory requirements are not large). Applying the update option that uses previously phased data and therefore does not require the long-range phasing step to be re-run, decreased the computation time to six hours.</p>
      </sec>
    </sec>
    <sec>
      <title>Performance of SSAI</title>
      <p>The use of additional phenotype information on ungenotyped relatives in the pedigree resulted in gEBV with higher accuracy than ignoring this information (Table <xref ref-type="table" rid="T3">3</xref>). For trait 2 and trait 3, the accuracy of SC2-SSAI was 0.51 and 0.60, while for SC1 it was 0.39. For trait 1, there was no difference in the accuracy of gEBV. However, the accuracy was already high (0.51) for this trait. There was little overall difference in the accuracy of gEBV estimated from SC2-SSAI and SC2-SSMi. The computational time required for SSAI was greater than for SSMi because SSMi did not require AlphaImpute to be run.</p>
    </sec>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <p>AlphaImpute is a flexible tool that imputes genotypes and alleles accurately and quickly for datasets with large pedigrees and large numbers of genotyped markers. When pedigree information is available, it is more robust to data structure in terms of density of the low-density genotyping platform and relationships among animals than the widely used software IMPUTE2. The performance of IMPUTE2 dramatically dropped off as the complexity of imputation increased (i.e. lower relationships to high density animals, lower density genotyping). In this study, imputation by AlphaImpute was very accurate for two datasets that had very different features. The pig dataset comprised a group of highly related animals from a single line, whereas the cattle dataset was multiple-breed in nature but with groups of highly related animals within each breed. The pig dataset had many more females than males genotyped, while in the cattle dataset, most of the genotyped animals were male. In the pig dataset, the animals to be imputed came from the most recent generation but in the cattle dataset they were selected at random from across the pedigree. AlphaImpute has also been used in several commercial datasets in multiple species (data not shown). Almost without exception it gives results that are at least as good as the results presented in this study. The computational time required for some of these other datasets illustrates the computational cost for a wide variety of scenarios. Imputing a whole genome in a poultry pedigree of 18 000 birds took similar amounts of time (Andreas Kranis, personal communication) to that required for the pig dataset in this study (circa 18 hours for the full algorithm). Imputing using the full algorithm on a small dataset of 1500 animals took two hours, while the update option reduced this to 15 minutes. Imputing one chromosome for a pedigree of 300 000 animals was not feasible (Jarmilla Johnston, personal communication) and may require parallelizing the imputation steps. The numbers of animals, the depth of the pedigree, and the relationships between genotyped animals affect computation time.</p>
    <p>Most imputation methods include two steps, a phasing step that involves resolving the haplotypes of high-density genotyped animals, and an imputation step that involves identifying which combination of these haplotypes match the low-density genotyped animals or ungenotyped animals that have allele probabilities. The phasing step is the most difficult component. AlphaImpute uses the long-range phasing and haplotype library imputation capacity of AlphaPhase1.1 [<xref ref-type="bibr" rid="B17">17</xref>] to phase genotypes. This approach allows great flexibility in the pedigree structure among high-density genotyped animals. Multiple generations of high-density genotyped animals within constrained pedigree structures, such as having both parents being genotyped and large half sib family groups e.g. [<xref ref-type="bibr" rid="B6">6</xref>], are not needed. The high-density genotyped animals can be scattered across a pedigree, or all be from the same generation or have no recent pedigree links. Unmapped SNP are imputed using the algorithm of Kerr and Kinghorn [<xref ref-type="bibr" rid="B18">18</xref>] on a single-locus basis without using haplotype information.</p>
    <p>To tackle the problem of imputation, AlphaImpute combines long-range phasing, haplotype library imputation, simple phasing and imputation rules, and segregation analysis. It accesses and updates all this information by iterating across each gamete by accessing haplotypes of varying length and varying starting and ending positions, and passes down the pedigree, and through the haplotype libraries, eliminating ancestral or other haplotypes to accumulate evidence about the alleles that an individual carries at each SNP. It iterates this whole process a number of times before finally using segregation analysis [<xref ref-type="bibr" rid="B18">18</xref>] to re-calculate probabilities for alleles that are still missing. In a previous attempt at imputation [<xref ref-type="bibr" rid="B25">25</xref>,<xref ref-type="bibr" rid="B26">26</xref>], all genotype probabilities (i.e. without a truncation at &gt;0.99) were used to give a score for the match of each pair of haplotypes to the single-locus phasing information. This approach was impaired by the large number of haplotype pairs available and the resulting very high selection intensity for choosing the best-fitting haplotype pair with many haplotype combinations that have similar scores by random chance. Hence this approach was not used here.</p>
    <p>AlphaImpute provides phased alleles or allele probabilities for all genotyped SNP for all animals in the pedigree and resolves parent of origin of all alleles along each chromosome. Therefore, it can be used as an accurate haplotyping program when pedigree information is available. This allows interesting applications, such as modeling identity by descent probabilities for estimation of gEBV and QTL detection, or models where parent of origin is relevant, such as models with imprinting or crossbreeding effects [<xref ref-type="bibr" rid="B27">27</xref>].</p>
    <sec>
      <title>Strategy for routine use of AlphaImpute</title>
      <p>AlphaImpute was designed for routine use in commercial breeding programs that carry out imputation as often as weekly. In these circumstances, the data flow may be such that large numbers of new low-density genotyped animals are added weekly while new high-density genotyped animals may only be added every few weeks or months. The program has an update option for such a situation. This update option involves only phasing the high-density animals whenever significant numbers of new high-density genotyped animals are added. This dramatically reduces the computation time for the weekly imputation runs. Further options to increase flexibility of use include an ability to read in phased alleles from other haplotyping software (e.g. half-sib family haplotyping software [<xref ref-type="bibr" rid="B28">28</xref>]) under the condition that the parental origin of each phased allele is known, and to select a subset of the high-density genotyped individuals to have their haplotypes resolved by long-range phasing and haplotype library imputation. For example, this subset could be the key sires in a pedigree or it could be a subset of animals that could not have their phase resolved by half-sib family haplotype phasing.</p>
    </sec>
    <sec>
      <title>SSAI and increasing the accuracy of genomic selection</title>
      <p>Single-stage genomic evaluations [<xref ref-type="bibr" rid="B9">9</xref>] are appealing because they use all available pedigree, genomic, and phenotypic data, and may avoid bias that could be introduced by two-stage genomic selection strategies [<xref ref-type="bibr" rid="B29">29</xref>]. Both SSAI and SSMi increased the accuracy of the gEBV compared to the base scenario SC1 but SSAI did not outperform SSMi. SSAI uses a single base for all animals in the pedigree, which is determined by the allele frequencies in the data. In contrast, with SSMi the base is not necessarily the same for genotyped and pedigreed animals (although alternatives have been proposed [<xref ref-type="bibr" rid="B10">10</xref>,<xref ref-type="bibr" rid="B11">11</xref>] based on ideas of Powell et al. [<xref ref-type="bibr" rid="B30">30</xref>]). For the data analyzed here, the differences between these base populations may not have been large enough to result in dramatic differences in performance. The other difference between the methods was that SSMi used GBLUP, assuming equal variance at all SNP, whereas SSAI used a Bayesian method (BayesB) that allows for unequal variances for each SNP. BayesB has shown little benefit over GBLUP models if the traits are more polygenic in nature e.g. [<xref ref-type="bibr" rid="B31">31</xref>]. Finally, with millions of genotyped animals, SSMi may become computationally infeasible because it requires full inversion of two very dense matrices for the genotyped animals. SSAI does not require explicit inversion of any matrices and use of parallelized computation may make it a feasible method for datasets with millions of genotyped or imputed animals. Other solutions for single-stage methodology avoid the need for inversion are under development e.g. [Legarra A, Ducrocq V: Computational strategies for national integration of phenotypic, genomic and pedigree data in a single-step BLUP, submitted].</p>
      <p>One weakness of SSAI may be that the genotypes imputed will not be very different from two times the allele frequency (i.e. no information for imputation) for animals that are very distantly related to animals that are genotyped, or when only a small proportion of the animals in a dataset have genotype information. Given the prevalence of genotyping candidates for selection in breeding programs incorporating genomics, these distantly related and ungenotyped animals would contribute little information to the estimated breeding value of candidates for selection. However, if their phenotypes are useful to increase contemporary group sizes or provide contrasts with which breeding values can be estimated, an optimal solution may be to use a joint SSAI/SSMi approach. The SSMi approach automatically accounts for the uncertainty in imputation, which increases with decreasing relationship between genotyped individuals and individuals that are to be imputed [<xref ref-type="bibr" rid="B32">32</xref>,<xref ref-type="bibr" rid="B33">33</xref>]. Thus, there is a trade off between the more accurate imputation with SSAI and the more appropriate way of accounting for imputation error in SSMi.</p>
    </sec>
    <sec>
      <title>Availability</title>
      <p>Both AlphaImpute and AlphaBayes were written in Fortran 95 and are available for research purposes from <ext-link ext-link-type="uri" xlink:href="http://sites.google.com/site/hickeyjohn">http://sites.google.com/site/hickeyjohn</ext-link>.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusion</title>
    <p>A method and software package for phasing and imputation was developed for pedigreed populations and resulted in much better accuracies of imputed genotypes than IMPUTE2. The proposed method is fast, accurate, is robust to the pedigree structure of the genotyped animals, and can scale to large datasets. The data produced by the algorithm can be used directly in a single-stage genomic evaluation that combines all pedigree, genotypes and phenotypes in a single analysis.</p>
  </sec>
  <sec>
    <title>
      <bold>Competing interests</bold>
    </title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec>
    <title>
      <bold>Authors’ contributions</bold>
    </title>
    <p>JMH conceived the original ideas, designed the algorithm, and wrote the first version of the program under the supervision of BPK, BT, and JHJW. MAC contributed to the development of the ideas, algorithm, and program. JMH and MAC performed the analysis. JMH wrote the first draft of the paper. All authors read and approved the final manuscript.</p>
  </sec>
  <sec>
    <title>Appendix A - Description of the AlphaImpute algorithm</title>
    <p>There are three primary steps in AlphaImpute, (1) segregation analysis to calculate allele probabilities for each locus of each animal in the pedigree, (2) long-range phasing and haplotype library imputation to phase all high-density genotyped individuals and create a haplotype library for each genomic region for the dataset, and, (3) impute missing alleles by matching the allelic probabilities to haplotypes in the haplotype library.</p>
    <p>This algorithm is designed to work for biallelic SNP. SNP genotypes are coded as 0, 1, 2, or 3, where 0 is a homozygote, 1 heterozygote, 2 the alternative homozygote, and 3 is a missing genotype. SNP alleles are coded as 0 or 1.</p>
    <p><bold>Step 1.</bold> Using the algorithm of Kerr and Kinghorn (1996), calculate allele probabilities for each locus of each individual in the pedigree, using all pedigree and genotype information (both high and low density).</p>
    <p><bold>Step 2.</bold> Using the LRPHLI algorithm of Hickey et al. (2011) as implemented in AlphaPhase1.1, phase the individuals genotyped at high density a number of times and place the identified haplotypes in a library. LRPHLI divides chromosomes into cores of specified length (e.g. 100 SNP). By running LRPHLI a number of times, overlaps between cores are created and each locus is phased as part of different cores. This facilitates the identification of phasing error.</p>
    <p><bold>Step 3.</bold> Impute missing alleles by matching alleles imputed at <bold>Step 1</bold> to haplotypes phased at <bold>Step 2</bold>. This involves several sub-steps. These can be divided into major and minor sub-steps. Each sub-step is sequentially passed through; after each major sub-step, each minor sub-step is sequentially passed through. The description of <bold>Step 3</bold> will begin with a description of the minor sub-steps, followed by a description of the major sub-steps.</p>
    <p><bold>Minor sub-step 1.</bold><italic>Parent homozygous fill in.</italic> Fill in the allele of an offspring of a parent that has both its alleles filled in and has a resulting genotype that is homozygous.</p>
    <p><bold>Minor sub-step 2.</bold><italic>Phase complement.</italic> If the genotype at a locus for an individual is known and one of its alleles has been determined, then impute the missing allele as the complement of the genotype and the known phased allele.</p>
    <p><bold>Minor sub-step 3.</bold><italic>Impute parents from progeny complement.</italic> If one of the parental alleles is known and the other missing, then fill in the missing allele in the parent if at least one of its offspring is known to carry an allele that does not match the known allele in the parent. (e.g. if a sire has a 0 as one of its alleles and the other allele is missing but one of its offspring carries a 1 in the gamete received from the sire, then we can determine that the sire’s missing allele is 1).</p>
    <p><bold>Minor sub-step 4.</bold><italic>Make genotype.</italic> Any individual that has a missing genotype but has both alleles known, has its genotype filled in as the sum of the two alleles.</p>
    <p><bold>Major sub-step 1.</bold><italic>Convert allele probabilities to phase.</italic> Alleles with probabilities greater than 0.99 of being 0 or 1 are imputed.</p>
    <p><bold>Major sub-step 2.</bold><italic>Fill in base animals.</italic> If a base animal has high-density genotype information, it is filled in by arbitrarily assigning one of its haplotypes for one of its cores as coming from its paternal gamete and the other haplotype as coming from its maternal gamete. Haplotypes at other cores are appended to the central haplotypes where overlapping information can be used to determine which haplotype at an adjacent partially overlapping core matches the arbitrarily labeled paternal (maternal) haplotype.</p>
    <p><bold>Major sub-step 3.</bold><italic>Candidate haplotype library imputation of alleles.</italic> For each core of each round of the LRPHLI algorithm, all haplotypes that have been found and stored in the haplotype library are initially considered to be candidates for the true haplotype that an individual carries on its gametes. Within the core, all alleles that are known are compared to corresponding alleles in each of the haplotypes in the library. Haplotypes that have a number of disagreements greater than a small error threshold have their candidacy rejected. At the end of this loop, the surviving candidate haplotypes are checked for locations that have unanimous agreement about a particular allele. For alleles with complete agreement, a count of the suggested allele is incremented. Alleles are imputed if, at the end of passing across each core and each round of the LRPHLI algorithm, the count of whether the alleles are 0 or 1 is above a threshold in one direction and below a threshold in the other. This helps to prevent the use of phasing errors that originate from LRPHLI.</p>
    <p><bold>Major sub-step 4.</bold><italic>Imputation based on parental phase.</italic> This is similar to <bold>Major sub-step 3,</bold> with the exception that the process is restricted to individuals that have parents with high-density genotype information and the candidate haplotypes for each individual’s gametes are restricted to the two haplotypes that have been identified for each of its parents by the LRPHLI algorithm. Errors in phasing are accounted for in the same way as in <bold>Major sub-step 3</bold>.</p>
    <p><bold>Major sub-step 5.</bold><italic>Individual phase imputation.</italic> This is similar to <bold>Major sub-step 3,</bold> with the exception that the process is restricted to individuals that have high-density genotype information and the candidate haplotypes are restricted to the two haplotypes that have been identified for the individual by the LRPHLI algorithm. Effectively, it determines the parental origin of each of these haplotypes. Errors in phasing are accounted for in the same way as in <bold>Major sub-step 3</bold>.</p>
    <p><bold>Major sub-step 6.</bold><italic>Internal candidate haplotype library imputation of alleles.</italic> This step is similar to <bold>Major sub-step 3,</bold> with the exception that haplotype libraries are internally built using the information that has been previously imputed. Several different core lengths are used to define the length of the haplotypes and to ensure that errors can be accounted for in the same way as in <bold>Major sub-step 3</bold>.</p>
    <p><bold>Major sub-step 7.</bold><italic>Internal imputation based on parental phase.</italic> This step is similar to <bold>Major sub-set 4,</bold> with the exception that it is attempted for all animals in the pedigree on the basis that their parents may now have imputed high-density information. In the same way as <bold>Major sub-step 6</bold>, several core lengths are used to define the length of the haplotypes and to ensure that errors can be accounted for in the same way as in <bold>Major sub-step 3</bold>.</p>
    <p><bold>Major sub-step 8.</bold><italic>Imputation based on identifying where recombination occurs during inheritance from parent to offspring.</italic> Each gamete of an individual is examined from the beginning to the end and from the end to the beginning of the chromosome. In each direction, at loci where both the individual and its parent are heterozygous and have phase information resolved, this information is used to determine which of the parental gametes the individual received. Loci for which this cannot be determined but which are between two loci that (a) can be determined and (b) come from the same parental gamete, are assumed to come from this gamete (i.e. no double recombination event in between). Alleles are imputed in the individual when analysis in both directions of the chromosome has identified the same inherited gamete and when the parent is phased for this locus in the suggested gamete, subject to the restrictions that the number of recombination events for the individuals is less than a threshold and that the region in which two recombination events occurred exceeds a threshold length. <bold>Major sub-step 8</bold> is iterated a number of times with increasingly relaxed restrictions. After each iteration, the minor sub-steps are also carried out.</p>
    <p><bold>Major sub-step 9.</bold><italic>Recalculate genotype probabilities</italic>. Using the imputed genotype information, the allele probabilities and genotype probabilities are recalculated as in <bold>Step 1</bold>. Alleles that are still missing are imputed as the recalculated allele probability. Missing genotypes are imputed from the allelic probabilities when both alleles are still missing, in advance of the recalculation of allele probabilities, or from the imputed allele and the allele probability when only one allele was not imputed.</p>
    <sec>
      <title>Other miscellaneous steps</title>
      <p>Steps are also included to divide the data into the high and low density sets of animals, to edit the SNP data, check for Mendelian inconsistencies, and identify base parents.</p>
    </sec>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgments</title>
    <p>The research was funded by the Australian Research Council project LP100100880 of which Genus Plc, Aviagen LTD, and Pfizer are co-funders. LIC are acknowledged for providing the dairy cattle data. Andreas Kranis, Gregor Gorjanc, Jarmila Johnston, Birgit Gredler, Andres Legarra, and Gustavo de los Campos are acknowledged for useful discussions on various aspects of the research.</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Scheet</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Stephens</surname>
          <given-names>M</given-names>
        </name>
        <article-title>A fast and flexible statistical model for large-scale population genotype data: applications to inferring missing genotypes and haplotypic phase</article-title>
        <source>Am J Hum Genet</source>
        <year>2006</year>
        <volume>78</volume>
        <fpage>629</fpage>
        <lpage>644</lpage>
        <pub-id pub-id-type="doi">10.1086/502802</pub-id>
        <pub-id pub-id-type="pmid">16532393</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Li</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Abecasis</surname>
          <given-names>G</given-names>
        </name>
        <article-title>Mach 1.0: Rapid Haplotype Reconstruction and Missing Genotype Inference</article-title>
        <source>Am J Hum Genet</source>
        <year>2006</year>
        <volume>S79</volume>
        <fpage>2290</fpage>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Browning</surname>
          <given-names>SR</given-names>
        </name>
        <name>
          <surname>Browning</surname>
          <given-names>BL</given-names>
        </name>
        <article-title>Rapid and accurate haplotype phasing and missing-data inference for whole-genome association studies by use of localized haplotype clustering</article-title>
        <source>Am J Hum Genet</source>
        <year>2007</year>
        <volume>81</volume>
        <fpage>1084</fpage>
        <lpage>1097</lpage>
        <pub-id pub-id-type="doi">10.1086/521987</pub-id>
        <pub-id pub-id-type="pmid">17924348</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Howie</surname>
          <given-names>BN</given-names>
        </name>
        <name>
          <surname>Donnelly</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Marchini</surname>
          <given-names>J</given-names>
        </name>
        <article-title>A flexible and accurate genotype imputation method for the next generation of genome-wide association studies</article-title>
        <source>PLoS Genet</source>
        <year>2009</year>
        <volume>5</volume>
        <issue>6</issue>
        <fpage>e1000529</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1000529</pub-id>
        <pub-id pub-id-type="pmid">19543373</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Druet</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Georges</surname>
          <given-names>M</given-names>
        </name>
        <article-title>A Hidden Markov model combining linkage and linkage disequilibrium information for haplotype reconstruction and quantitative trait locus fine mapping</article-title>
        <source>Genetics</source>
        <year>2010</year>
        <volume>184</volume>
        <fpage>789</fpage>
        <lpage>798</lpage>
        <pub-id pub-id-type="doi">10.1534/genetics.109.108431</pub-id>
        <pub-id pub-id-type="pmid">20008575</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="other">
        <name>
          <surname>Habier</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Fernando</surname>
          <given-names>RL</given-names>
        </name>
        <name>
          <surname>Garrick</surname>
          <given-names>DJ</given-names>
        </name>
        <article-title>A combined strategy to infer high-density SNP haplotypes in large pedigrees</article-title>
        <source>Proceedings of the 9th World Congress on Genetics Applied to Livestock production: 1–6 August 2010; Leipzig</source>
        <fpage>pdf 09</fpage>
        <lpage>15</lpage>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Daetwyler</surname>
          <given-names>HD</given-names>
        </name>
        <name>
          <surname>Wiggans</surname>
          <given-names>GR</given-names>
        </name>
        <name>
          <surname>Hayes</surname>
          <given-names>BJ</given-names>
        </name>
        <name>
          <surname>Woolliams</surname>
          <given-names>JA</given-names>
        </name>
        <name>
          <surname>Goddard</surname>
          <given-names>ME</given-names>
        </name>
        <article-title>Imputation of missing genotypes from sparse to high density using long-range phasing</article-title>
        <source>Genetics</source>
        <year>2011</year>
        <volume>189</volume>
        <fpage>317</fpage>
        <lpage>327</lpage>
        <pub-id pub-id-type="doi">10.1534/genetics.111.128082</pub-id>
        <pub-id pub-id-type="pmid">21705746</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal">
        <name>
          <surname>VanRaden</surname>
          <given-names>PM</given-names>
        </name>
        <name>
          <surname>O’Connell</surname>
          <given-names>JR</given-names>
        </name>
        <name>
          <surname>Wiggans</surname>
          <given-names>GR</given-names>
        </name>
        <name>
          <surname>Weigel</surname>
          <given-names>KA</given-names>
        </name>
        <article-title>Genomic evaluations with many more genotypes</article-title>
        <source>Genet Sel Evol</source>
        <year>2011</year>
        <volume>43</volume>
        <fpage>10</fpage>
        <pub-id pub-id-type="doi">10.1186/1297-9686-43-10</pub-id>
        <pub-id pub-id-type="pmid">21366914</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Misztal</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Legarra</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Aguilar</surname>
          <given-names>I</given-names>
        </name>
        <article-title>Computing procedures for genetic evaluation including phenotypic, full pedigree, and genomic information</article-title>
        <source>J Dairy Sci</source>
        <year>2009</year>
        <volume>92</volume>
        <fpage>4648</fpage>
        <lpage>4655</lpage>
        <pub-id pub-id-type="doi">10.3168/jds.2009-2064</pub-id>
        <pub-id pub-id-type="pmid">19700728</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Vitezica</surname>
          <given-names>ZG</given-names>
        </name>
        <name>
          <surname>Aguilar</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Misztal</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Legarra</surname>
          <given-names>A</given-names>
        </name>
        <article-title>Bias in genomic predictions for populations under selection</article-title>
        <source>Genet Res (Camb)</source>
        <year>2011</year>
        <volume>93</volume>
        <fpage>357</fpage>
        <lpage>369</lpage>
        <pub-id pub-id-type="doi">10.1017/S001667231100022X</pub-id>
        <pub-id pub-id-type="pmid">21767459</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Meuwissen</surname>
          <given-names>THE</given-names>
        </name>
        <name>
          <surname>Luan</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Woolliams</surname>
          <given-names>JA</given-names>
        </name>
        <article-title>The unified approach to the use of genomic and pedigree information in genomic evaluations revisited</article-title>
        <source>J Anim Breed Genet</source>
        <year>2011</year>
        <volume>128</volume>
        <fpage>429</fpage>
        <lpage>439</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1439-0388.2011.00966.x</pub-id>
        <pub-id pub-id-type="pmid">22059576</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Gengler</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Mayeres</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Szydlowski</surname>
          <given-names>M</given-names>
        </name>
        <article-title>A simple method to approximate gene content in large pedigree populations: application to the myostatin gene in dual-purpose Belgian Blue cattle</article-title>
        <source>Animal</source>
        <year>2007</year>
        <volume>1</volume>
        <fpage>21</fpage>
        <lpage>28</lpage>
        <pub-id pub-id-type="doi">10.1017/S1751731107392628</pub-id>
        <pub-id pub-id-type="pmid">22444206</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Zhang</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Liu</surname>
          <given-names>JF</given-names>
        </name>
        <name>
          <surname>Ding</surname>
          <given-names>XD</given-names>
        </name>
        <name>
          <surname>Bijma</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>de Koning</surname>
          <given-names>DJ</given-names>
        </name>
        <name>
          <surname>Zhang</surname>
          <given-names>Q</given-names>
        </name>
        <article-title>Best linear unbiased prediction of genomic breeding values using trait-specific marker-derived relationship matrix</article-title>
        <source>PLoS ONE</source>
        <year>2010</year>
        <volume>5</volume>
        <fpage>e12648</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0012648</pub-id>
        <pub-id pub-id-type="pmid">20844593</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal">
        <name>
          <surname>VanRaden</surname>
          <given-names>PM</given-names>
        </name>
        <article-title>Efficient methods to compute genomic predictions</article-title>
        <source>J Dairy Sci</source>
        <year>2008</year>
        <volume>91</volume>
        <fpage>4414</fpage>
        <lpage>4423</lpage>
        <pub-id pub-id-type="doi">10.3168/jds.2007-0980</pub-id>
        <pub-id pub-id-type="pmid">18946147</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Meuwissen</surname>
          <given-names>THE</given-names>
        </name>
        <name>
          <surname>Hayes</surname>
          <given-names>BJ</given-names>
        </name>
        <name>
          <surname>Goddard</surname>
          <given-names>ME</given-names>
        </name>
        <article-title>Prediction of total genetic value using genome-wide dense marker maps</article-title>
        <source>Genetics</source>
        <year>2001</year>
        <volume>157</volume>
        <fpage>1819</fpage>
        <lpage>1829</lpage>
        <pub-id pub-id-type="pmid">11290733</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kong</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Masson</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Frigge</surname>
          <given-names>ML</given-names>
        </name>
        <name>
          <surname>Gylfason</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Zusmanovich</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Thorleifsson</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Olason</surname>
          <given-names>PI</given-names>
        </name>
        <name>
          <surname>Ingason</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Steinberg</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Rafnar</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Sulem</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Mouy</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Jonsson</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Thorsteinsdottir</surname>
          <given-names>U</given-names>
        </name>
        <name>
          <surname>Gudbjartsson</surname>
          <given-names>DF</given-names>
        </name>
        <name>
          <surname>Stefansson</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Stefansson</surname>
          <given-names>K</given-names>
        </name>
        <article-title>Detection of sharing by descent, long-range phasing and haplotype imputation</article-title>
        <source>Nat Genet</source>
        <year>2008</year>
        <volume>40</volume>
        <fpage>1068</fpage>
        <lpage>1075</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.216</pub-id>
        <pub-id pub-id-type="pmid">19165921</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Hickey</surname>
          <given-names>JM</given-names>
        </name>
        <name>
          <surname>Kinghorn</surname>
          <given-names>BP</given-names>
        </name>
        <name>
          <surname>Tier</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Wilson</surname>
          <given-names>JF</given-names>
        </name>
        <name>
          <surname>Dunstan</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>van der Werf</surname>
          <given-names>JHJ</given-names>
        </name>
        <article-title>A combined long-range phasing and long haplotype imputation method to impute phase for SNP genotypes</article-title>
        <source>Genet Sel Evol</source>
        <year>2011</year>
        <volume>43</volume>
        <fpage>12</fpage>
        <pub-id pub-id-type="doi">10.1186/1297-9686-43-12</pub-id>
        <pub-id pub-id-type="pmid">21388557</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kerr</surname>
          <given-names>RJ</given-names>
        </name>
        <name>
          <surname>Kinghorn</surname>
          <given-names>BP</given-names>
        </name>
        <article-title>An efficient algorithm for segregation analysis in large populations</article-title>
        <source>J Anim Breed Genet</source>
        <year>1996</year>
        <volume>113</volume>
        <fpage>457</fpage>
        <lpage>469</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1439-0388.1996.tb00636.x</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Hao</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Chudin</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>McElwee</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Schadt</surname>
          <given-names>EE</given-names>
        </name>
        <article-title>Accuracy of genome-wide imputation of untyped markers and impacts on statistical power for association studies</article-title>
        <source>BMC Genet</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>27</fpage>
        <pub-id pub-id-type="pmid">19531258</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Marchini</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Howie</surname>
          <given-names>B</given-names>
        </name>
        <article-title>Genotype imputation for genome-wide association studies</article-title>
        <source>Nat Rev Genet</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>499</fpage>
        <lpage>511</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg2796</pub-id>
        <pub-id pub-id-type="pmid">20517342</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Hickey</surname>
          <given-names>JM</given-names>
        </name>
        <name>
          <surname>Cross</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Babu</surname>
          <given-names>R</given-names>
        </name>
        <article-title>de los Campos G: Factors Affecting the Accuracy of Genotype Imputation in Populations from Several Maize Breeding Programs</article-title>
        <source>Crop Sci</source>
        <year>2012</year>
        <volume>52</volume>
        <fpage>654</fpage>
        <lpage>663</lpage>
        <pub-id pub-id-type="doi">10.2135/cropsci2011.07.0358</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="book">
        <name>
          <surname>Fernando</surname>
          <given-names>RL</given-names>
        </name>
        <source>Lecture Notes – Bayesian methods for GWAS</source>
        <year>2010</year>
        <publisher-name>UNE, Australia</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="book">
        <name>
          <surname>Hickey</surname>
          <given-names>JM</given-names>
        </name>
        <name>
          <surname>Tier</surname>
          <given-names>B</given-names>
        </name>
        <source>AlphaBayes: user manual</source>
        <year>2009</year>
        <publisher-name>UNE, Australia</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Aguilar</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Misztal</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Johnson</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Legarra</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Tsuruta</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Lawlor</surname>
          <given-names>T</given-names>
        </name>
        <article-title>A unified approach to utilize phenotypic, full pedigree, and genomic information for genetic evaluation of Holstein final score</article-title>
        <source>J Dairy Sci</source>
        <year>2010</year>
        <volume>93</volume>
        <fpage>743</fpage>
        <lpage>752</lpage>
        <pub-id pub-id-type="doi">10.3168/jds.2009-2730</pub-id>
        <pub-id pub-id-type="pmid">20105546</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="other">
        <name>
          <surname>Hickey</surname>
          <given-names>JM</given-names>
        </name>
        <name>
          <surname>Kinghorn</surname>
          <given-names>BP</given-names>
        </name>
        <name>
          <surname>Cleveland</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Tier</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>van der Werf</surname>
          <given-names>JHJ</given-names>
        </name>
        <article-title>Recursive Long Range Phasing And Long Haplotype Library Imputation: Application to Building A Global Haplotype Library for Holstein cattle</article-title>
        <source>Proceedings of the 9thWorld Congress on Genetics Applied to Livestock production: 1–6 August 2010; Leipzig</source>
        <fpage>pdf 09</fpage>
        <lpage>34</lpage>
      </mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Cleveland</surname>
          <given-names>MA</given-names>
        </name>
        <name>
          <surname>Hickey</surname>
          <given-names>JM</given-names>
        </name>
        <name>
          <surname>Kinghorn</surname>
          <given-names>BP</given-names>
        </name>
        <article-title>Genotype imputation for the prediction of genomic breeding values in non-genotyped and low-density genotyped individuals</article-title>
        <source>BMC Proceedings</source>
        <year>2011</year>
        <volume>5</volume>
        <fpage>S6</fpage>
        <pub-id pub-id-type="pmid">21624176</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="other">
        <name>
          <surname>Kinghorn</surname>
          <given-names>BP</given-names>
        </name>
        <name>
          <surname>Hickey</surname>
          <given-names>JM</given-names>
        </name>
        <name>
          <surname>van der Werf</surname>
          <given-names>JHJ</given-names>
        </name>
        <article-title>Reciprocal recurrent genomic selection for total genetic merit in crossbred individuals</article-title>
        <source>Proceedings of the 9thWorld Congress on Genetics Applied to Livestock production: 1–6 August 2010; Leipzig</source>
        <fpage>pdf 00</fpage>
        <lpage>36</lpage>
      </mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Windig</surname>
          <given-names>JJ</given-names>
        </name>
        <name>
          <surname>Meuwissen</surname>
          <given-names>THE</given-names>
        </name>
        <article-title>Rapid haplotype reconstruction in pedigrees with dense marker maps</article-title>
        <source>J Anim Breed Genet</source>
        <year>2004</year>
        <volume>121</volume>
        <fpage>2639</fpage>
      </mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Patry</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Ducrocq</surname>
          <given-names>V</given-names>
        </name>
        <article-title>Accounting for genomic pre-selection in national BLUP evaluations in dairy cattle</article-title>
        <source>Genet Sel Evol</source>
        <year>2011</year>
        <volume>43</volume>
        <fpage>30</fpage>
        <pub-id pub-id-type="doi">10.1186/1297-9686-43-30</pub-id>
        <pub-id pub-id-type="pmid">21851619</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Powell</surname>
          <given-names>JE</given-names>
        </name>
        <name>
          <surname>Visscher</surname>
          <given-names>PM</given-names>
        </name>
        <name>
          <surname>Goddard</surname>
          <given-names>ME</given-names>
        </name>
        <article-title>Reconciling the analysis of IBD and IBS in complex trait studies</article-title>
        <source>Nat Rev Genet</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>800</fpage>
        <lpage>805</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg2865</pub-id>
        <pub-id pub-id-type="pmid">20877324</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B31">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Clark</surname>
          <given-names>SA</given-names>
        </name>
        <name>
          <surname>Hickey</surname>
          <given-names>JM</given-names>
        </name>
        <name>
          <surname>van der Werf</surname>
          <given-names>JHJ</given-names>
        </name>
        <article-title>Different models of genetic variation and their effect on genomic evaluation</article-title>
        <source>Genet Sel Evol</source>
        <year>2011</year>
        <volume>43</volume>
        <fpage>18</fpage>
        <pub-id pub-id-type="doi">10.1186/1297-9686-43-18</pub-id>
        <pub-id pub-id-type="pmid">21575265</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B32">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Legarra</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Aguilar</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Misztal</surname>
          <given-names>I</given-names>
        </name>
        <article-title>A relationship matrix including full pedigree and genomic information</article-title>
        <source>J Dairy Sci</source>
        <year>2009</year>
        <volume>92</volume>
        <fpage>4656</fpage>
        <lpage>4663</lpage>
        <pub-id pub-id-type="doi">10.3168/jds.2009-2061</pub-id>
        <pub-id pub-id-type="pmid">19700729</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B33">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Christensen</surname>
          <given-names>O</given-names>
        </name>
        <name>
          <surname>Lund</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Genomic prediction when some animals are not genotyped</article-title>
        <source>Genet Sel Evol</source>
        <year>2010</year>
        <volume>42</volume>
        <fpage>2</fpage>
        <pub-id pub-id-type="doi">10.1186/1297-9686-42-2</pub-id>
        <pub-id pub-id-type="pmid">20105297</pub-id>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
