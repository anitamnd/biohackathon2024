<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d1 20130915//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4576695</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btv335</article-id>
    <article-id pub-id-type="publisher-id">btv335</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>FourCSeq: analysis of 4C sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Klein</surname>
          <given-names>Felix A.</given-names>
        </name>
        <xref ref-type="corresp" rid="btv335-COR1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pakozdi</surname>
          <given-names>Tibor</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Anders</surname>
          <given-names>Simon</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ghavi-Helm</surname>
          <given-names>Yad</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Furlong</surname>
          <given-names>Eileen E. M.</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Huber</surname>
          <given-names>Wolfgang</given-names>
        </name>
        <xref ref-type="corresp" rid="btv335-COR1">*</xref>
      </contrib>
      <aff>European Molecular Biology Laboratory (EMBL), Genome Biology Unit, Meyerhofstr. 1, 69117 Heidelberg, Germany</aff>
    </contrib-group>
    <author-notes>
      <corresp id="btv335-COR1">*To whom correspondence should be addressed.</corresp>
      <fn id="btv335-FN1">
        <p>Associate Editor: Gunnar Ratsch</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>10</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>01</day>
      <month>6</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>01</day>
      <month>6</month>
      <year>2015</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>31</volume>
    <issue>19</issue>
    <fpage>3085</fpage>
    <lpage>3091</lpage>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>8</month>
        <year>2014</year>
      </date>
      <date date-type="rev-recd">
        <day>8</day>
        <month>5</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>26</day>
        <month>5</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2015. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2015</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/" license-type="creative-commons">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> Circularized Chromosome Conformation Capture (4C) is a powerful technique for studying the spatial interactions of a specific genomic region called the ‘viewpoint’ with the rest of the genome, both in a single condition or comparing different experimental conditions or cell types. Observed ligation frequencies typically show a strong, regular dependence on genomic distance from the viewpoint, on top of which specific interaction peaks are superimposed. Here, we address the computational task to find these specific peaks and to detect changes between different biological conditions.</p>
      <p><bold>Results:</bold> We model the overall trend of decreasing interaction frequency with genomic distance by fitting a smooth monotonically decreasing function to suitably transformed count data. Based on the fit, <italic>z</italic>-scores are calculated from the residuals, and high <italic>z</italic>-scores are interpreted as peaks providing evidence for specific interactions. To compare different conditions, we normalize fragment counts between samples, and call for differential contact frequencies using the statistical method <bold>DESeq2</bold> adapted from RNA-Seq analysis.</p>
      <p><bold>Availability and implementation:</bold> A full end-to-end analysis pipeline is implemented in the R package <bold>FourCSeq</bold> available at <ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org">www.bioconductor.org</ext-link>.</p>
      <p><bold>Contact:</bold><email>felix.klein@embl.de</email> or <email>whuber@embl.de</email></p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv335/-/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Circularized Chromosome Conformation Capture (4C) couples the low-throughput Chromosome Conformation Capture (3C) technique (<xref rid="btv335-B3" ref-type="bibr">Dekker <italic>et</italic>
<italic>al.</italic>, 2002</xref>) for studying chromatin–chromatin interactions with high-throughput sequencing (<xref rid="btv335-B13" ref-type="bibr">Simonis <italic>et</italic>
<italic>al.</italic>, 2006</xref>; <xref rid="btv335-B15" ref-type="bibr">Stadhouders <italic>et</italic>
<italic>al.</italic>, 2013</xref>). 4C detects the contacts of a chosen viewpoint with, in principle, the entire genome. The 4C protocol consists of six main steps (<xref rid="btv335-B15" ref-type="bibr">Stadhouders <italic>et</italic>
<italic>al.</italic>, 2013</xref>). First, the chromatin is cross-linked with formaldehyde to fix DNA-protein complexes, thereby capturing DNA sequences that are in close spatial proximity. In the next step, the cross-linked chromatin is digested with a restriction enzyme. In the third step, the fragment ends from the digestion treatment are ligated under dilute conditions to favor intra-complex ligation, ligating DNA sequences that have been in close spatial proximity. After this, the cross-linking is reversed, followed by a second round of digestion with a different restriction enzyme to obtain smaller DNA molecules. These molecules are then circularized and amplified by polymerase chain reaction (PCR). The resulting library is sequenced. The possibility to multiplex several viewpoints in one sequencing library further increases the throughput.</p>
    <p>As result, the distribution of reads from a 4C sequencing library throughout the genome provides an estimate of the contact frequencies of the viewpoint with the rest of the genome. Overall, the 4C signal decreases with genomic distance from the viewpoint and reaches a constant level of noise for large distances. Specific interactions of DNA elements sit on top of this overall trend. One task is to identify positions that stand out from the general trend. Moreover, if 4C has been performed on samples with different cell types, developmental stages or experimental treatments, a second task is the detection of changes in interaction frequencies between the sample groups.</p>
    <p>Several analysis approaches for the first task, detection of interactions, have already been developed for 4C sequencing data. The approach by <xref rid="btv335-B17" ref-type="bibr">Thongjuea <italic>et</italic>
<italic>al.</italic> (2013)</xref> uses a non-parametric smoothing spline on library-size normalized count data to estimate the signal decrease with distance to the viewpoint and detects interactions by calculating <italic>z</italic>-scores from the residuals of this fit. Another approach, used by <xref rid="btv335-B19" ref-type="bibr">van de Werken <italic>et</italic>
<italic>al.</italic> (2012)</xref> and <xref rid="btv335-B14" ref-type="bibr">Splinter <italic>et</italic>
<italic>al.</italic> (2012)</xref> employs two complementary arms: in the proximity of the viewpoint, multi-scale visualization of a semi-quantitative contact map, remote from the viewpoint, an empirically estimated contact background model of binary contact profiles combined with a window-based enrichment and permutation analysis.</p>
    <p>Currently, methods are missing that use replicate information as the basis for data-driven error modeling to detect consistent peaks and to statistically infer changes in contact frequencies between different conditions.</p>
    <p>We address these needs with the following approach. We use a distance-dependent monotone fit to estimate the signal decay with increasing distance from the viewpoint, since the unspecific component of the signal decreases monotonically. As input to the fit we use variance-stabilized read count data (<xref rid="btv335-B1" ref-type="bibr">Anders and Huber, 2010</xref>). To detect strong interactions, we calculate <italic>z</italic>-scores from the fit residuals and associated <italic>P</italic>-values. For the comparison of different conditions we use the methods implemented in the <bold>DESeq2</bold> package (<xref rid="btv335-B9" ref-type="bibr">Love <italic>et</italic>
<italic>al.</italic>, 2014</xref>).</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Data preprocessing</title>
      <p>The data processing pipeline (<xref ref-type="fig" rid="btv335-F1">Fig. 1</xref>) starts from the reads of the 4C library. If several 4C libraries were multiplexed, the viewpoint primer sequences and, if present, additional barcodes, are used to demultiplex the sample and trim of the primer sequences. For the demultiplexing and trimming of primer sequences a Python script is included in the package. The remaining sequences are aligned to the full reference genome using a standard alignment tool.
<fig id="btv335-F1" orientation="portrait" position="float"><label>Fig. 1.</label><caption><p>Overall workflow of steps described in this paper</p></caption><graphic xlink:href="btv335f1p"/></fig>
</p>
      <p>The analysis pipeline of our R package starts with the binary alignment/map (BAM) files output from the alignment. The following steps are now described in more detail.</p>
      <sec>
        <title>2.1.1 Cutting the reference genome</title>
        <p>The input to the statistical analysis is a count table, with one row for each restriction fragment, and one column for each sample, with the table entries indicating how many reads have been assigned to each restriction fragment in each sample. By restriction fragment, we mean the sequences between the cutting sites of the first restriction enzyme, because this first digestion defines the resolution at which interactions can be seen in 4C. To define fragments, we cut the reference genome <italic>in silico</italic> using the recognition sequence of the first cutter. Fragments are delimited by adjacent cutting sites of the first restriction enzyme. The second restriction enzyme is used to reduce the size of the fragments for efficient circularization and PCR amplification. Correspondingly, fragment ends are defined as the genomic region between the start/end position of the fragment and the closest cutting site of the second enzyme (<xref ref-type="fig" rid="btv335-F2">Fig. 2</xref>a).
<fig id="btv335-F2" orientation="portrait" position="float"><label>Fig. 2.</label><caption><p>(<bold>a</bold>) Schematic of the rules to define valid fragments, i.e. fragments that are used subsequently in the analysis. The pink fragment end is smaller than the defined threshold, but since the other fragment end is valid, the fragment is kept for analysis. The red fragment is invalid because it does not contain a cutting site of the second restriction enzyme, and it is removed from the analysis. (<bold>b</bold>) If the sequencing primer starts at the first restriction enzyme cutting site, reads (green arrows) that start at the fragment ends and are oriented toward the fragment middle are kept for analysis. If the sequencing primer starts at the second restriction enzyme cutting site, reads (green arrows) that start right next to the cutting site of the second restriction enzyme and are directed toward the ends of the fragment are kept for analysis</p></caption><graphic xlink:href="btv335f2p"/></fig>
</p>
        <p>Because mainly fragments that contain a site for the second cutter are efficiently amplified, a fragment is considered valid if it contains at least one cutting site of the second enzyme and has long enough fragments ends. By default, we use a threshold of 20 nt.</p>
      </sec>
      <sec>
        <title>2.1.2 Mapping of primer sequences</title>
        <p>The primer sequence of the viewpoint is mapped to the reference genome to find the fragment that contains the viewpoint. This fragment is used to calculate the genomic distance to fragments on the same chromosome. More precisely, we use the genomic distance between the middle of the viewpoint fragment and the middle of the other fragment.</p>
      </sec>
      <sec>
        <title>2.1.3 Mapping reads to fragment ends</title>
        <p>To filter out non-informative reads, we use the following criteria, motivated by the 4C protocol. Only reads that fulfill the criteria are mapped to a fragment end. A first condition is that reads should start directly at a restriction enzyme cutting site. Additionally, the orientation of the read at the fragment end is important and defined by the protocol (<xref ref-type="fig" rid="btv335-F2">Fig. 2</xref>b). If the sequencing library was prepared with a primer starting next to a cutting site of the first cutting enzyme, reads should be directed toward the middle of the fragment. If instead the primer starts next to a cutting site of the second cutter, reads should be directed toward the fragment ends. The reads mapped to both fragment ends are combined for subsequent analysis. To check for consistency between replicates, we visualize scatter plots of count values (<xref ref-type="fig" rid="btv335-F3">Fig. 3</xref>).
<fig id="btv335-F3" orientation="portrait" position="float"><label>Fig. 3.</label><caption><p>Correlation between two biological replicates of the <italic>apterous</italic> CRM viewpoint for whole embryo tissue at 6–8 h after fertilization. In the plot, the pairwise distribution of count values per fragment is shown. The <italic>x</italic>- and <italic>y</italic>-axes (drawn in logarithm-like scale, with zero) correspond to the counts for the fragments in two biological replicate libraries for the same viewpoint and biological condition. The replicates show good concordance for higher count values. Fragments with 0 counts for both replicates are not shown</p></caption><graphic xlink:href="btv335f3p"/></fig>
</p>
      </sec>
    </sec>
    <sec>
      <title>2.2 Detecting interactions</title>
      <sec>
        <title>2.2.1 Variance-stabilizing transformation</title>
        <p>The count values usually span several orders of magnitude. If a logarithmic transformation were used for the count values, low abundance fragments would tend to show large standard deviations across samples. On the other hand, if untransformed data were used, the standard deviations across samples would be large for high abundance fragments. Such heteroscedasticity would skew the analysis toward either the fragments far from or close to the viewpoint. Therefore, we use the variance-stabilizing transformation <italic>v</italic> as introduced by <xref rid="btv335-B1" ref-type="bibr">Anders and Huber (2010)</xref> and implemented in the <bold>DESeq2</bold> package (<xref rid="btv335-B9" ref-type="bibr">Love <italic>et</italic>
<italic>al.</italic>, 2014</xref>) to transform the count <italic>k<sub>ij</sub></italic> of fragment <italic>i</italic> in sample <italic>j</italic> to <inline-formula><mml:math id="MM1"><mml:mrow><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. After transformation the standard deviations show less dependence on the fragment abundance (<xref ref-type="fig" rid="btv335-F4">Fig. 4</xref>).
<fig id="btv335-F4" orientation="portrait" position="float"><label>Fig. 4.</label><caption><p>Variance-stabilizing transformation. For each fragment, the mean and standard deviation of its count data were computed across all samples for the <italic>apterous</italic> CRM viewpoint. The plots visualize the distributions of these values for all fragments. Fragments close to the viewpoint are on the right side with higher count values. When the untransformed count data are considered (upper panel), the standard deviations are very large for high abundance fragments (close to the viewpoint). When the count data are considered on the logarithmic scale (middle panel), the standard deviations are large for low abundance fragments (far from the viewpoint). Both effects would make the analysis overly susceptible to noise either close to or far from the viewpoint. When a variance stabilizing transformation is applied, the standard deviations show less dependence on the fragment abundance, facilitating a more consistent statistical treatment across the whole dynamic range of the data</p></caption><graphic xlink:href="btv335f4p"/></fig>
</p>
      </sec>
      <sec>
        <title>2.2.2 Trend fitting</title>
        <p>The 4C signal decays with genomic distance from the viewpoint and converges toward a constant level of background. This decay trend <inline-formula><mml:math id="MM2"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is fitted using the transformed count values <inline-formula><mml:math id="MM3"><mml:mrow><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> as a function of the logarithm of the genomic distance <italic>d<sub>i</sub></italic> from each fragment <italic>i</italic> to the viewpoint.</p>
        <p>The <bold>FourCSeq</bold> package offers two choices for the distance dependence fit. Using the smooth monotone fit function of the <bold>fda</bold> package (<xref rid="btv335-B11" ref-type="bibr">Ramsay <italic>et</italic>
<italic>al.</italic>, 2014</xref>), we may choose to assume that the trend is symmetric around the viewpoint and fit a symmetric monotone curve on the combined data from both sides. Alternatively, we perform a monotone fit separately for each side of the viewpoint.</p>
        <p>The second option can be useful if one is interested in finding asymmetries in the interaction profiles of a viewpoint, which might be of particular interest at boundaries of topological domains (<xref rid="btv335-B4" ref-type="bibr">Dixon <italic>et</italic>
<italic>al.</italic>, 2012</xref>). For both methods, we provide standard parameters that work for a wide range of data and which can be adjusted by the user if necessary.</p>
        <p>An example of a symmetric monotone fit is shown in <xref ref-type="fig" rid="btv335-F5">Figure 5</xref>.
<fig id="btv335-F5" orientation="portrait" position="float"><label>Fig. 5.</label><caption><p>Symmetric monotone fit of the variance-stabilized count data over the logarithm of the distance from viewpoint for the <italic>apterous</italic> CRM viewpoint. The solid line shows the fit and the dashed line is the fit plus 3<italic>σ</italic></p></caption><graphic xlink:href="btv335f5p"/></fig>
</p>
      </sec>
      <sec>
        <title>2.2.3 <italic>z</italic>-scores of residuals</title>
        <p>To find specific interactions, i.e. fragments that show interaction frequencies higher than expected at a given distance from the viewpoint, we calculate <italic>z</italic>-scores from the residuals of the fit:
<disp-formula id="btv335-M1"><label>(1)</label><mml:math id="MM4"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="MM5"><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mtext>mad</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the median absolute deviation (a robust estimator of scale), <italic>i</italic> runs over all fragments and <italic>j</italic> over all samples. In principle, users can call specific interactions by looking for large, positive values of the <italic>z</italic>-score. To select the threshold, they can use known positive and likely negative control regions. A potential disadvantage of this approach is that no type I error control in the face of multiple testing is provided. Therefore, by default <bold>FourCSeq</bold> performs the following additional steps. The <italic>z</italic>-scores are converted into one-sided <italic>P</italic>-values using the standard Normal cumulative distribution function, and these are adjusted for multiple testing using the method of <xref rid="btv335-B2" ref-type="bibr">Benjamini and Hochberg (1995)</xref>. In this way, control of the false discovery rate (FDR) is provided. Specific interactions are then found by looking for fragments with small adjusted <italic>P</italic>-values; a large enough value of the effect size, <italic>z</italic> may be an additional requirement (Section 3.2). For the <italic>P</italic>-values to be well-calibrated in this approach, the <italic>z</italic>-scores should follow a standard Normal distribution under the null hypothesis, corresponding to fragments that are not affected by an interaction with the viewpoint. In the data that we examined (<xref rid="btv335-B5" ref-type="bibr">Ghavi-Helm <italic>et</italic>
<italic>al.</italic>, 2014</xref>), this assumption appeared reasonable; for their own data, users are advised to inspect quantile–quantile plots of <italic>z</italic> against <italic>N</italic>(0, 1), and histograms of the unadjusted <italic>P</italic>-values to asses the calibration. Example visualizations are provided in the package vignette.</p>
      </sec>
    </sec>
    <sec>
      <title>2.3 Differences between conditions</title>
      <p>We have observed the distance dependence of the signal to be variable between samples, and this needs to be taken into account for comparisons. Therefore, we calculate a matrix of normalization factors <italic>n<sub>ij</sub></italic>, such that the scaled read counts <inline-formula><mml:math id="MM6"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> for fragment <italic>i</italic> become comparable across the samples <italic>j.</italic> Moreover, we need the normalization factors to represent the fitted distance dependence on the scale of the raw counts. Hence, we back-transform the fitted values <italic>f<sub>ij</sub></italic> to the scale of raw counts and scale them to have unit geometric mean across samples to obtain the normalization factors:
<disp-formula id="btv335-M2"><label>(2)</label><mml:math id="MM7"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mroot><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>J</mml:mi></mml:mroot></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <italic>n<sub>ij</sub></italic> is the normalization factor and <inline-formula><mml:math id="MM8"><mml:mrow><mml:msup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the back transformed fitted value at the genomic distance <italic>d<sub>i</sub>.</italic> The index <italic>i</italic> runs over all fragments and <italic>j</italic> over all samples.</p>
      <p>To detect differences between conditions, we apply the methods implemented in the <bold>DESeq2</bold> package to the counts <italic>k<sub>ij</sub></italic> together with the normalization factors <italic>n<sub>ij</sub></italic> (<xref rid="btv335-B9" ref-type="bibr">Love <italic>et</italic>
<italic>al.</italic>, 2014</xref>). <bold>DESeq2</bold> is a statistical method for differential analysis of count data. Originally established for RNA-Seq (<xref rid="btv335-B1" ref-type="bibr">Anders and Huber, 2010</xref>), it has in the meanwhile also been shown to be useful for other sequencing-based assays, including ChIP-Seq (<xref rid="btv335-B12" ref-type="bibr">Ross-Innes <italic>et</italic>
<italic>al.</italic>, 2012</xref>), CLIP-Seq (<xref rid="btv335-B7" ref-type="bibr">König <italic>et</italic>
<italic>al.</italic>, 2011</xref>) and Hi-C (<xref rid="btv335-B10" ref-type="bibr">Pekowska <italic>et</italic>
<italic>al.</italic>, 2014</xref>). <bold>DESeq2</bold> allows analysis-of-variance (ANOVA) type analyses—including the simple pairwise comparison between two conditions—with an error model adapted to the technical and biological variability of the data. Technically, it does this via generalized linear models (GLMs) of the Negative Binomial (NB) family. To facilitate the application of NB-GLMs to experiments with small numbers of replicates, <bold>DESeq2</bold> uses an Empirical Bayes method to shrink (and stabilize) its estimates of dispersion and effect size parameters.</p>
      <p>For each fragment, a significant interaction change is called when the observed change between conditions is significantly stronger than what is expected from the size of the changes seen between replicates.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>To illustrate our approach, we use a 4C dataset of developing <italic>Drosophila melanogaster</italic> embryos (<xref rid="btv335-B5" ref-type="bibr">Ghavi-Helm <italic>et</italic>
<italic>al.</italic>, 2014</xref>). In this dataset, 103 viewpoints were selected throughout the <italic>D. melanogaster</italic> genome, with a focus on <italic>cis</italic>-regulatory modules (CRMs). Samples were taken from embryos at 2–4 h and 6–8 h after fertilization either using whole embryos or mesoderm-specific cells (<xref rid="btv335-B5" ref-type="bibr">Ghavi-Helm <italic>et</italic>
<italic>al.</italic>, 2014</xref>).</p>
    <sec>
      <title>3.1 Preprocessing</title>
      <p>Starting from FASTQ, files we used a Python program included in the <bold>FourCSeq</bold> package to demultiplex the libraries and trim off bar codes and adapters. Next, we aligned the reads to the dm3 reference genome with Novoalign (<ext-link ext-link-type="uri" xlink:href="http://www.novocraft.com">http://www.novocraft.com</ext-link>).</p>
      <p>For short restriction fragments, we observed the problem that reads contained the whole fragment and then continued through the cutting site of the second restriction enzyme into the ligated fragments (in most cases the viewpoint fragment). This often resulted in two possible alignments causing the reads to be reported as not uniquely mapping. To address this problem and rescue some of the shorter fragments we checked whether the restriction enzyme cutting site was found within unaligned reads. In such a case the end of the read was trimmed at the restriction enzyme cutting site and alignment was attempted again.</p>
      <p>We then generated a fragment reference and mapped the aligned reads to these fragments as described in Sections 2.1.1 and 2.1.3.</p>
      <p>For quality control, the percentage of reads mapping to valid fragments from all aligned reads was calculated. For our data this value was around 70–95% in most cases. A value in that range should be obtained for a 4C library. If the percentage is much smaller, the first region that should be investigated is the region around the viewpoint, where a single fragment can pile up a high percentage of the reads. Other possible reasons for low mapping percentages might be reads that map either to invalid fragments, which have been removed from analysis, or to new fragments, created by mutations relative to the reference genome.</p>
      <p>To check whether technical and biological replicates gave a similar signal, scatter plots of the replicates were generated. For our dataset, these plots showed good agreement for higher count values in most cases. However, at lower count values, the replicates showed higher relative variation, as is expected from Poisson noise. An example is shown in <xref ref-type="fig" rid="btv335-F3">Figure 3</xref>.</p>
    </sec>
    <sec>
      <title>3.2 Detecting interactions</title>
      <p>First, to reduce noise in the data, we removed fragments that had less than a median of 40 counts across all samples for one viewpoint. Second, we set aside fragments that were too close to the viewpoint, because the high ligation frequencies seen for these fragments tend to obscure any specific signal. The package used a heuristic to identify the boundaries of this masked out region around the viewpoint as those fragments where the observed signal for the first time increased between successive fragments. The parameters of the variance-stabilizing transformation were fitted on the count values of the remaining fragments (<xref ref-type="fig" rid="btv335-F4">Fig. 4</xref>). Next, the decay trend was fitted on the transformed scale using a monotone symmetric fit. The fit is shown in <xref ref-type="fig" rid="btv335-F5">Figure 5</xref>. <italic>z</italic>-scores and associated <italic>P</italic>-values were calculated from the fit residuals. Interactions were found by looking for fragments with <italic>z</italic>-scores larger than 3 in both replicates and an adjusted <italic>P</italic>-values smaller than 0.01 in at least one replicate. <xref ref-type="fig" rid="btv335-F7">Figure 7</xref> shows the results for one of the viewpoints in our dataset, which is located in a CRM close to the <italic>apterous</italic> (<italic>ap</italic>) gene. The fragments that showed an interaction are highlighted by red or orange dots.</p>
      <p>In mesoderm specific and whole embryo tissue at 6–8 h after fertilization the interaction of the viewpoint with the <italic>ap</italic> gene promoter on the right side of the viewpoint was captured. Further interactions were found as well, but could not be directly attributed to a specific genomic element. In general, we were able to detect interactions between 10 known enhancer-promoter pairs and many more interactions throughout the set of 103 viewpoint (<xref rid="btv335-B5" ref-type="bibr">Ghavi-Helm <italic>et</italic>
<italic>al.</italic>, 2014</xref>).</p>
    </sec>
    <sec>
      <title>3.3 Differences between conditions</title>
      <p>To detect differences between conditions, we used the method described in Section 2.3. <xref ref-type="fig" rid="btv335-F6">Figure 6</xref> shows the MA plot comparing mesoderm tissue and whole embryo for <italic>Drosophila</italic> embryos 6–8 h after fertilization, and an along-genome visualization of the results for the same viewpoint is shown in <xref ref-type="fig" rid="btv335-F7">Figure 7</xref>. Fragments that had an adjusted <italic>P</italic>-value of less than 0.01 in the Wald test are highlighted by blue points, or by orange points, if they additionally were called as an interaction in the depicted sample.
<fig id="btv335-F6" orientation="portrait" position="float"><label>Fig. 6.</label><caption><p>MA plot of the <italic>apterous</italic> CRM viewpoint 4C profile comparison between <italic>Drosophila</italic> embryo mesoderm tissue and whole embryo 6–8 h after fertilization. The <italic>y</italic>-axis shows the difference between log interaction counts for a given fragment which is plotted against the average log interaction counts per fragment on the <italic>x</italic>-axis. Red dots represent fragments that show differential interactions (<italic>p</italic>-adjusted &lt; 0.01)</p></caption><graphic xlink:href="btv335f6p"/></fig>
<fig id="btv335-F7" orientation="portrait" position="float"><label>Fig. 7.</label><caption><p>Detection of interactions and differences: The figure shows the plot generated by the <bold>FourCSeq</bold> to visualize the results. The upper four wide tracks show the variance-stabilized counts for two biological replicates of <italic>Drosophila</italic> embryo mesoderm tissue and whole embryo 6–8 h after fertilization for the <italic>apterous</italic> CRM viewpoint. The fit of the distance dependence is shown as solid green line and the dashed blue lines represent the fit <inline-formula><mml:math id="MM9"><mml:mrow><mml:mo>±</mml:mo><mml:mn>3</mml:mn><mml:mi>σ</mml:mi></mml:mrow></mml:math></inline-formula>. Interactions detected by <italic>z</italic>-score &gt; 3 in both replicates and <italic>p</italic>-adjusted &lt; 0.01 for at least one replicate are shown as red or orange points. Fragments represented by orange points additionally show a differential interactions (<italic>p</italic>-adjusted &lt; 0.01, differential Wald test). Differential changes in the contact profile that are not called as interactions are shown as blue points (<italic>p</italic>-adjusted &lt; 0.01, differential Wald test). The color bar below the 4C profiles shows whether the upper condition (green) or the lower condition (red) has the higher signal for the detected differences (<italic>p</italic>-adjusted &lt; 0.01). The calculated log2 fold change of the differential testing per fragment are shown above the track at the bottom, which shows the gene model of the region</p></caption><graphic xlink:href="btv335f7p"/></fig>
</p>
      <p>In general one can observe that the effect sizes for differential changes are very small, and the overall pattern of the interaction profiles remains largely unchanged, as we recently reported (<xref rid="btv335-B5" ref-type="bibr">Ghavi-Helm <italic>et</italic>
<italic>al.</italic>, 2014</xref>). Only 6% of identified interactions showed evidence of interaction changes across time and tissue context (<xref rid="btv335-B5" ref-type="bibr">Ghavi-Helm <italic>et</italic>
<italic>al.</italic>, 2014</xref>). However, for the strong interaction at the <italic>ap</italic> promoter we estimated a fold change of 2.25 between the conditions. Stronger contacts in the mesoderm tissue could be due to the fact that the <italic>ap</italic> gene is only expressed in the mesoderm.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>Our approach to detect peaks is broadly similar to that of the <bold>r3Cseq</bold> package (<xref rid="btv335-B17" ref-type="bibr">Thongjuea <italic>et</italic>
<italic>al.</italic>, 2013</xref>). However, while <bold>r3Cseq</bold> performs the fit on raw count scale, we use a variance-stabilizing transformation on the data to reduce biases deriving from the large dynamic range of the count data. To detect specific interactions, we fit the decay of the variance-stabilized 4C signal with distance from the viewpoint and calculate <italic>z</italic>-scores from the fit residuals. With this approach, we were able to detect long-range chromatin interactions that spanned genomic distances &gt; 100 kb in the compact <italic>Drosophila</italic> genome (<xref rid="btv335-B5" ref-type="bibr">Ghavi-Helm <italic>et</italic>
<italic>al.</italic>, 2014</xref>). A direct comparison of <bold>r3Cseq</bold> and <bold>FourCSeq</bold> on two mouse datasets from different labs, the Myb data of <xref rid="btv335-B17" ref-type="bibr">Thongjuea <italic>et</italic>
<italic>al.</italic> (2013)</xref> and the Ap2c data of <xref rid="btv335-B18" ref-type="bibr">Tsujimura <italic>et</italic>
<italic>al.</italic> (2015)</xref>, is provided in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv335/-/DC1">Supplementary File S1</ext-link>. It shows that <bold>r3Cseq</bold> is prone to over-calling interactions when the library has good coverage, while <bold>FourCSeq</bold> identifies interactions between the <italic>Tfap2c</italic> promoter and an annotated DNAseI hypersensitive region containing a brain enhancer with high specificity. On the other hand, for data with low agreement of fragment counts between replicates—possibly due to high rates of PCR duplicates—the statistical model <bold>FourCSeq</bold> does not call significant interactions, while <bold>r3Cseq</bold> reports a large set of peaks.</p>
    <p>Instead of only looking at fold changes from single or merged samples between conditions as in <bold>r3Cseq</bold>, we make use of the framework for differential expression analysis implemented in the <bold>DESeq2</bold> package to detect differences between groups of samples in different experimental conditions. With this approach, we take the variability between replicates of the data for each genomic position into account for the quantitative comparison of the fragment counts between conditions. The fold change between conditions is compared with the variability of the data between biological replicates, and differential interaction are called statistically significant only if the observed fold change between conditions is significantly higher than what it is expected based on the noise level in the data.</p>
    <p>Our implementation allows the use of any FASTA file as reference genome. For example, the dm3 genome was used for the data shown in Section 3. In contrast, the <bold>r3Cseq</bold> package is currently limited to the mm9, hg18 and hg19 genomes.</p>
    <p>The method of <xref rid="btv335-B19" ref-type="bibr">van de Werken <italic>et</italic>
<italic>al.</italic> (2012)</xref> uses a customized approach for aligning reads to a reference of fragment ends. The resulting coverage profiles can be further normalized and visualized with the tool that they provide. The results are plots of contact profiles and contact domainograms generated by analyzing the data with different window sizes. However, with this approach, comparisons between interaction profiles are only made qualitatively, and no statistical framework is provided.</p>
    <p>To integrate called interactions and differences with other genomic data the results from our package can be used within the Bioconductor framework of <italic>GenomicRanges</italic> (<xref rid="btv335-B8" ref-type="bibr">Lawrence <italic>et</italic>
<italic>al.</italic>, 2013</xref>). Furthermore, we provide the possibility to export the interaction profiles as bigWig files for visual inspection in a genome browser along with other tracks of interest.</p>
    <p>Our approach looks for localized, specific interactions and treats large-scale patterns that decrease with distance from the viewpoint as background (Section 2.2.3). In particular, changes in the background between conditions will be absorbed by the normalization (2). Although these choices are reasonable for analyses such those reported in <xref rid="btv335-B5" ref-type="bibr">Ghavi-Helm <italic>et</italic>
<italic>al.</italic> (2014)</xref>, studies that investigate large-scale reorganization of chromosomal structure will need different analytical approaches.</p>
    <p>Potential for improvement might lie in methods that adjust the 4C signal for the influences of fragment size, GC content and mappability. Such models exist for Hi-C and ChIA-PET data (<xref rid="btv335-B6" ref-type="bibr">Imakaev <italic>et al.</italic>, 2012</xref>; <xref rid="btv335-B20" ref-type="bibr">Yaffe and Tanay, 2011</xref>). However, due to the much smaller amount and viewpoint-centric nature of 4C data, the correct estimation of these biases and deconfounding them from the dominant distance-related effects is difficult. Moreover, in the differential analysis of interactions, much of the per-fragment biases will cancel out, as we essentially consider ratios.</p>
    <p>Our method has been thoroughly validated in the course of the analysis of more than 100 viewpoints in the developing <italic>Drosophila</italic> embryo. Positive controls of enhancer-promoter interactions were confirmed, and several newly detected long-range interactions were validated by DNA-FISH (<xref rid="btv335-B5" ref-type="bibr">Ghavi-Helm <italic>et</italic>
<italic>al.</italic>, 2014</xref>). We calculated the overlap between the identified interactions of all viewpoints from this 4C dataset and regulatory regions identified by DNaseI hypersensitivity sites (<xref rid="btv335-B16" ref-type="bibr">Thomas <italic>et</italic>
<italic>al.</italic>, 2011</xref>). This analysis showed significant enrichment overlap compared with a background set (<xref rid="btv335-B5" ref-type="bibr">Ghavi-Helm <italic>et</italic>
<italic>al.</italic>, 2014</xref>).</p>
    <p>In summary, our package provides the tools to analyze 4C sequencing data and integrate the results with other genomic features. Its use will help to further investigate and understand the role of chromatin 3D structure in biological processes such as gene regulation and embryogenesis.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_31_19_3085__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_btv335_Supplement_File_1.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank the members of the Huber group for discussion and comments, in particular A. Pękowska and B. Klaus for their valuable suggestions.</p>
  </ack>
  <sec>
    <title>Funding</title>
    <p>F.A.K., S.A. and W.H were supported by the <funding-source>EC FP7 Collaborative research project RADIANT</funding-source> (no. <award-id>305626</award-id>). T.P. was supported by an <funding-source>ITN</funding-source> grant (EvoNet) and DFG grant (FU750). E.E.M.F. was supported by a <funding-source>DFG</funding-source> (<award-id>FU 750</award-id>) grant and Y.G.-H. by an EMBO post-doctoral fellowship.</p>
    <p><italic>Conflict of Interest:</italic> none declared.</p>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="btv335-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anders</surname><given-names>S.</given-names></name><name><surname>Huber</surname><given-names>W.</given-names></name></person-group> (<year>2010</year>) <article-title>Differential expression analysis for sequence count data</article-title>. <source>Genome Biol.</source>, <volume>11</volume>, <fpage>R106</fpage>.<pub-id pub-id-type="pmid">20979621</pub-id></mixed-citation>
    </ref>
    <ref id="btv335-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Benjamini</surname><given-names>Y.</given-names></name><name><surname>Hochberg</surname><given-names>Y.</given-names></name></person-group> (<year>1995</year>) <article-title>Controlling the false discovery rate—a practical and powerful approach to multiple testing</article-title>. <source>J. R. Stat. Soc. Ser. B</source>, <volume>57</volume>, <fpage>289</fpage>–<lpage>300</lpage>.</mixed-citation>
    </ref>
    <ref id="btv335-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dekker</surname><given-names>J.</given-names></name><etal/></person-group> (<year>2002</year>) <article-title>Capturing chromosome conformation</article-title>. <source>Science</source>, <volume>295</volume>, <fpage>1306</fpage>–<lpage>1311</lpage>.<pub-id pub-id-type="pmid">11847345</pub-id></mixed-citation>
    </ref>
    <ref id="btv335-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dixon</surname><given-names>J.R.</given-names></name><etal/></person-group> (<year>2012</year>) <article-title>Topological domains in mammalian genomes identified by analysis of chromatin interactions</article-title>. <source>Nature</source>, <volume>485</volume>, <fpage>376</fpage>–<lpage>380</lpage>.<pub-id pub-id-type="pmid">22495300</pub-id></mixed-citation>
    </ref>
    <ref id="btv335-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ghavi-Helm</surname><given-names>Y.</given-names></name><etal/></person-group> (<year>2014</year>) <article-title>Enhancer loops appear stable during development and are associated with paused polymerase</article-title>. <source>Nature</source>, <volume>512</volume>, <fpage>96</fpage>–<lpage>100</lpage>.<pub-id pub-id-type="pmid">25043061</pub-id></mixed-citation>
    </ref>
    <ref id="btv335-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Imakaev</surname><given-names>M.</given-names></name><etal/></person-group> (<year>2012</year>) <article-title>Iterative correction of Hi-C data reveals hallmarks of chromosome organization</article-title>. <source>Nat. Methods</source>, <volume>9</volume>, <fpage>999</fpage>–<lpage>1003</lpage>.<pub-id pub-id-type="pmid">22941365</pub-id></mixed-citation>
    </ref>
    <ref id="btv335-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>König</surname><given-names>J.</given-names></name><etal/></person-group> (<year>2011</year>) <article-title>iCLIP–transcriptome-wide mapping of protein-RNA interactions with individual nucleotide resolution</article-title>. <source>J. Vis. Exp. JoVE</source>, <volume>50</volume>, <fpage>2638</fpage>.<pub-id pub-id-type="pmid">21559008</pub-id></mixed-citation>
    </ref>
    <ref id="btv335-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lawrence</surname><given-names>M.</given-names></name><etal/></person-group> (<year>2013</year>) <article-title>Software for computing and annotating genomic ranges</article-title>. <source>PLoS Comput. Biol.</source>, <volume>9</volume>, <fpage>e1003118</fpage>.<pub-id pub-id-type="pmid">23950696</pub-id></mixed-citation>
    </ref>
    <ref id="btv335-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Love</surname><given-names>M.I.</given-names></name><etal/></person-group> (<year>2014</year>) <article-title>Moderated estimation of fold change and dispersion for RNA-Seq data with DESeq2</article-title>. <source>Genome Biol.</source>, <volume>15</volume>, <fpage>550</fpage>.<pub-id pub-id-type="pmid">25516281</pub-id></mixed-citation>
    </ref>
    <ref id="btv335-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pekowska</surname><given-names>A.</given-names></name><etal/></person-group> (<year>2014</year>) <article-title>Neural lineage induction reveals multi-scale dynamics of 3d chromatin organization</article-title>. <source>bioRxiv.</source></mixed-citation>
    </ref>
    <ref id="btv335-B11">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Ramsay</surname><given-names>J.O.</given-names></name><etal/></person-group> (<year>2014</year>) <source>fda: Functional Data Analysis</source>. <comment>R Package Version 2.4.3</comment>.</mixed-citation>
    </ref>
    <ref id="btv335-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ross-Innes</surname><given-names>C.S.</given-names></name><etal/></person-group> (<year>2012</year>) <article-title>Differential oestrogen receptor binding is associated with clinical outcome in breast cancer</article-title>. <source>Nature</source>, <volume>481</volume>, <fpage>389</fpage>–<lpage>393</lpage>.<pub-id pub-id-type="pmid">22217937</pub-id></mixed-citation>
    </ref>
    <ref id="btv335-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Simonis</surname><given-names>M.</given-names></name><etal/></person-group> (<year>2006</year>) <article-title>Nuclear organization of active and inactive chromatin domains uncovered by chromosome conformation capture-on-chip (4C)</article-title>. <source>Nat. Genet.</source>, <volume>38</volume>, <fpage>1348</fpage>–<lpage>1354</lpage>.<pub-id pub-id-type="pmid">17033623</pub-id></mixed-citation>
    </ref>
    <ref id="btv335-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Splinter</surname><given-names>E.</given-names></name><etal/></person-group> (<year>2012</year>) <article-title>Determining long-range chromatin interactions for selected genomic sites using 4C-seq technology: from fixation to computation</article-title>. <source>Methods</source>, <volume>58</volume>, <fpage>221</fpage>–<lpage>230</lpage>.<pub-id pub-id-type="pmid">22609568</pub-id></mixed-citation>
    </ref>
    <ref id="btv335-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stadhouders</surname><given-names>R.</given-names></name><etal/></person-group> (<year>2013</year>) <article-title>Multiplexed chromosome conformation capture sequencing for rapid genome-scale high-resolution detection of long-range chromatin interactions</article-title>. <source>Nat. Protoc.</source>, <volume>8</volume>, <fpage>509</fpage>–<lpage>524</lpage>.<pub-id pub-id-type="pmid">23411633</pub-id></mixed-citation>
    </ref>
    <ref id="btv335-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thomas</surname><given-names>S.</given-names></name><etal/></person-group> (<year>2011</year>) <article-title>Dynamic reprogramming of chromatin accessibility during Drosophila embryo development</article-title>. <source>Genome Biol.</source>, <volume>12</volume>, <fpage>R43</fpage>.<pub-id pub-id-type="pmid">21569360</pub-id></mixed-citation>
    </ref>
    <ref id="btv335-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thongjuea</surname><given-names>S.</given-names></name><etal/></person-group> (<year>2013</year>) <article-title>r3Cseq: an R/Bioconductor package for the discovery of long-range genomic interactions from chromosome conformation capture and next-generation sequencing data</article-title>. <source>Nucleic Acids Res.</source>, <volume>41</volume>, <fpage>e132</fpage>.<pub-id pub-id-type="pmid">23671339</pub-id></mixed-citation>
    </ref>
    <ref id="btv335-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tsujimura</surname><given-names>T.</given-names></name><etal/></person-group> (<year>2015</year>) <article-title>A discrete transition zone organizes the topological and regulatory autonomy of the adjacent <italic>Tfap2c</italic> and <italic>Bmp7</italic> genes</article-title>. <source>PLoS Genet.</source>, <volume>11</volume>, <fpage>e1004897</fpage>.<pub-id pub-id-type="pmid">25569170</pub-id></mixed-citation>
    </ref>
    <ref id="btv335-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van de Werken</surname><given-names>H.J.G.</given-names></name><etal/></person-group> (<year>2012</year>) <article-title>Robust 4C-seq data analysis to screen for regulatory DNA interactions</article-title>. <source>Nat. Methods</source>, <volume>9</volume>, <fpage>969</fpage>–<lpage>972</lpage>.<pub-id pub-id-type="pmid">22961246</pub-id></mixed-citation>
    </ref>
    <ref id="btv335-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yaffe</surname><given-names>E.</given-names></name><name><surname>Tanay</surname><given-names>A.</given-names></name></person-group> (<year>2011</year>) <article-title>Probabilistic modeling of Hi-C contact maps eliminates systematic biases to characterize global chromosomal architecture</article-title>. <source>Nat. Genet.</source>, <volume>43</volume>, <fpage>1059</fpage>–<lpage>1065</lpage>.<pub-id pub-id-type="pmid">22001755</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
