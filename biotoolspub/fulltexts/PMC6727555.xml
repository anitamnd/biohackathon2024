<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6727555</article-id>
    <article-id pub-id-type="publisher-id">3031</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-019-3031-y</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Fast and accurate average genome size and 16S rRNA gene average copy number computation in metagenomic data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5830-3328</contrib-id>
        <name>
          <surname>Pereira-Flores</surname>
          <given-names>Emiliano</given-names>
        </name>
        <address>
          <email>epereira@mpi-bremen.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Glöckner</surname>
          <given-names>Frank Oliver</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Fernandez-Guerra</surname>
          <given-names>Antonio</given-names>
        </name>
        <address>
          <email>afernand@mpi-bremen.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0491 3210</institution-id><institution-id institution-id-type="GRID">grid.419529.2</institution-id><institution>Microbial Genomics and Bioinformatics Research Group, </institution><institution>Max Planck Institute for Marine Microbiology, </institution></institution-wrap>Celsiusstraße 1, 28359 Bremen, Germany </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0000 9397 8745</institution-id><institution-id institution-id-type="GRID">grid.15078.3b</institution-id><institution>Department of Life Sciences and Chemistry, </institution><institution>Jacobs University Bremen gGmbH, </institution></institution-wrap>Campus Ring 1, 28759 Bremen, Germany </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 1033 7684</institution-id><institution-id institution-id-type="GRID">grid.10894.34</institution-id><institution>Alfred Wegener Institute - Helmholtz Center for Polar- and Marine Research, </institution></institution-wrap>Am Handelshafen 12, 27570 Bremerhaven, Germany </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 8948</institution-id><institution-id institution-id-type="GRID">grid.4991.5</institution-id><institution>Oxford e-Research Centre, </institution><institution>University of Oxford, </institution></institution-wrap>Oxford, OX1 3QG UK </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>5</day>
      <month>9</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>5</day>
      <month>9</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>453</elocation-id>
    <history>
      <date date-type="received">
        <day>18</day>
        <month>2</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>16</day>
        <month>8</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Metagenomics caused a quantum leap in microbial ecology. However, the inherent size and complexity of metagenomic data limit its interpretation. The quantification of metagenomic traits in metagenomic analysis workflows has the potential to improve the exploitation of metagenomic data. Metagenomic traits are organisms’ characteristics linked to their performance. They are measured at the genomic level taking a random sample of individuals in a community. As such, these traits provide valuable information to uncover microorganisms’ ecological patterns. The Average Genome Size (AGS) and the 16S rRNA gene Average Copy Number (ACN) are two highly informative metagenomic traits that reflect microorganisms’ ecological strategies as well as the environmental conditions they inhabit.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">Here, we present the ags.sh and acn.sh tools, which analytically derive the AGS and ACN metagenomic traits. These tools represent an advance on previous approaches to compute the AGS and ACN traits. Benchmarking shows that ags.sh is up to 11 times faster than state-of-the-art tools dedicated to the estimation AGS. Both ags.sh and acn.sh show comparable or higher accuracy than existing tools used to estimate these traits. To exemplify the applicability of both tools, we analyzed the 139 prokaryotic metagenomes of TARA Oceans and revealed the ecological strategies associated with different water layers.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3">We took advantage of recent advances in gene annotation to develop the ags.sh and acn.sh tools to combine easy tool usage with fast and accurate performance. Our tools compute the AGS and ACN metagenomic traits on unassembled metagenomes and allow researchers to improve their metagenomic data analysis to gain deeper insights into microorganisms’ ecology. The ags.sh and acn.sh tools are publicly available using Docker container technology at <ext-link ext-link-type="uri" xlink:href="https://github.com/pereiramemo/AGS-and-ACN-tools">https://github.com/pereiramemo/AGS-and-ACN-tools</ext-link>.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (10.1186/s12859-019-3031-y) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Microbial ecology</kwd>
      <kwd>Metagenomics</kwd>
      <kwd>Functional traits</kwd>
      <kwd>Average genome size</kwd>
      <kwd>16S rRNA gene average copy number</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001655</institution-id>
            <institution>Deutscher Akademischer Austauschdienst</institution>
          </institution-wrap>
        </funding-source>
        <award-id>57129354</award-id>
        <principal-award-recipient>
          <name>
            <surname>Pereira-Flores</surname>
            <given-names>Emiliano</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100008725</institution-id>
            <institution>Agencia Nacional de Investigación e Innovación</institution>
          </institution-wrap>
        </funding-source>
        <award-id>POS_EXT_2012_1_10105</award-id>
        <principal-award-recipient>
          <name>
            <surname>Pereira-Flores</surname>
            <given-names>Emiliano</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100010661</institution-id>
            <institution>Horizon 2020 Framework Programme</institution>
          </institution-wrap>
        </funding-source>
        <award-id>634486</award-id>
        <principal-award-recipient>
          <name>
            <surname>Fernandez-Guerra</surname>
            <given-names>Antonio</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par15">Advances in high-throughput sequencing technologies have pushed forward metagenomic studies, allowing the generation of massive amounts of data. As a consequence, metagenomics has become crucial to study microorganisms’ ecology [<xref ref-type="bibr" rid="CR1">1</xref>]. Nonetheless, making sense of the metagenomic data is a complex and computationally intensive task. Commonly, metagenomes consist of many short-read sequences obtained from numerous different species, many of which are unknown.</p>
    <p id="Par16">Functional trait based-analyses offer an opportunity to improve our understanding of microorganisms’ ecology [<xref ref-type="bibr" rid="CR2">2</xref>–<xref ref-type="bibr" rid="CR4">4</xref>]. In particular, community functional traits measured at the genome level in a random sample of individuals (i.e., metagenomic traits), can help to uncover ecological patterns in short-read metagenomic data [<xref ref-type="bibr" rid="CR5">5</xref>]. Functional traits are defined as characteristics of an organism that are linked to its performance, and consequently, influence its ecology and evolution [<xref ref-type="bibr" rid="CR6">6</xref>]. Previous studies have used metagenomic traits to explain different aspects of microbial ecology, including why microorganisms live in a particular environment or how they respond to environmental changes [<xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR9">9</xref>].</p>
    <p id="Par17">The Average Genome Size (AGS) and the 16S rRNA gene Average Copy Number (ACN) are two metagenomic traits that can be computed from unassembled metagenomic data and provide valuable information to study the ecology of microbes. The genome size is known to be associated with environmental complexity and the organisms’ lifestyle [<xref ref-type="bibr" rid="CR9">9</xref>–<xref ref-type="bibr" rid="CR11">11</xref>]. Larger genomes tend to contain a more diverse metabolic repertoire, which in turn allows organisms to metabolize a greater diversity of substrates and inhabit heterogeneous environments [<xref ref-type="bibr" rid="CR12">12</xref>]. Further, the AGS of a metagenome is important from a statistical perspective: the larger the AGS, the lower is the probability of sampling a specific gene. Hence, in order to avoid potential biases, this trait should be taken into account in gene-centric comparative metagenomics [<xref ref-type="bibr" rid="CR13">13</xref>]. Lastly, the AGS can be used to estimate the proportion of an average-sized genome that has been sequenced to exhaustion, which can help to determine an appropriate sequencing depth, in particular when the aim is to generate metagenome-assembled genomes (MAGs) [<xref ref-type="bibr" rid="CR14">14</xref>]. On the other hand, the 16S rRNA gene average copy number provides additional insights into the ecology of microorganisms. The 16S rRNA gene copy number in prokaryote genomes is known to vary from 1 to 15 [<xref ref-type="bibr" rid="CR15">15</xref>]. This trait is associated with different growth strategies: organisms with low copy numbers tend to utilize resources more efficiently and inhabit oligotrophic environments, while those with high copy numbers can grow more rapidly under favorable conditions [<xref ref-type="bibr" rid="CR16">16</xref>–<xref ref-type="bibr" rid="CR18">18</xref>].</p>
    <p id="Par18">Currently, there are two publicly available tools dedicated to the computation of the AGS in metagenomes: the Genome relative Abundance and Average Size (GAAS) [<xref ref-type="bibr" rid="CR19">19</xref>] and MicrobeCensus [<xref ref-type="bibr" rid="CR20">20</xref>]. GAAS computes the AGS based on a BLAST search [<xref ref-type="bibr" rid="CR21">21</xref>] against a reference database of microbial genomes. It was the first tool developed for the computation of the AGS, and although useful at its time, the runtime renders it highly impractical due to the now available large volume of metagenomes. Also, the fact that GAAS relies on genome databases to estimate the AGS, limits its accuracy when analyzing metagenomic samples containing novel taxa [<xref ref-type="bibr" rid="CR20">20</xref>]. Alternatively, MicrobeCensus computes the AGS based on the abundance information of 30 universally distributed single-copy genes, following an approach initially proposed by Raes [<xref ref-type="bibr" rid="CR22">22</xref>]: the AGS is estimated based on the abundance-weighted average of these marker genes, using optimized gene weights and empirically determined proportionality constants. Although MicrobeCensus has been shown to be considerably more accurate and faster than GAAS, the rapid increase of data generated by high-throughput sequencing technologies can still challenge its applicability.</p>
    <p id="Par19">For the ACN estimation, there are three publicly available tools able to predict this trait in metagenomic and amplicon data (i.e., PICRUSt [<xref ref-type="bibr" rid="CR23">23</xref>], CopyRighter [<xref ref-type="bibr" rid="CR24">24</xref>] and PAPRICA [<xref ref-type="bibr" rid="CR25">25</xref>]). The approaches implemented in these tools are based on the work of Kembel et al. (2012) [<xref ref-type="bibr" rid="CR26">26</xref>], which showed that the 16S rRNA gene copy number can be predicted based on the phylogenetic relationships of environmental sequences to reference organisms with known gene copy numbers. Although these tools can be used to estimate the ACN, their objective is to correct for copy number counts when estimating organisms’ abundances. They comprise a series of computationally intensive tasks, and their accuracy has been shown to be limited when analyzing taxa for which there are no close representatives in the reference phylogenies [<xref ref-type="bibr" rid="CR27">27</xref>].</p>
    <p id="Par20">In this work, we developed two tools, which analytically derive the Average Genome Size (AGS) and 16S rRNA gene Average Copy Number (ACN) in prokaryotic metagenomes (ags.sh and acn.sh, respectively). Our implementations exploit recent advances in gene annotation algorithms to make methodological improvements for the estimation of these traits. We show that the ags.sh and acn.sh tools can rapidly and accurately predict the AGS and ACN, respectively. Compared to other tools used to estimate these traits, ags.sh and acn.sh represent an improvement in terms of accuracy and computational speed. Lastly, we analyzed the AGS and ACN in the TARA Oceans dataset [<xref ref-type="bibr" rid="CR28">28</xref>], where we demonstrate the applicability of our tools and the value of these traits to reveal the ecological strategies adopted by microbial communities to cope with different environmental conditions.</p>
  </sec>
  <sec id="Sec2">
    <title>Materials and methods</title>
    <sec id="Sec3">
      <title>Implementation</title>
      <p id="Par21">The ags.sh and acn.sh tools were written in AWK, Bash, and R, and are provided as command line applications.</p>
      <sec id="Sec4">
        <title>Average genome size computation tool (ags.sh)</title>
        <p id="Par22">ags.sh computes the Average Genome Size (AGS) and Number of Genomes (NGs) in metagenomic samples, based on the annotation of 35 single-copy genes that are universally present in prokaryotes [<xref ref-type="bibr" rid="CR22">22</xref>] (Additional file <xref rid="MOESM1" ref-type="media">1</xref>). The workflow of ags.sh consists of the following steps: 1) Short-read sequences are filtered by length and trimmed with BBDuk [<xref ref-type="bibr" rid="CR29">29</xref>] (optional step); 2) Open Reading Frames (ORFs) are predicted in the short-read sequences with FragGeneScan-Plus [<xref ref-type="bibr" rid="CR30">30</xref>, <xref ref-type="bibr" rid="CR31">31</xref>] (optional step); 3) Single-copy genes are annotated with UProC [<xref ref-type="bibr" rid="CR32">32</xref>]; 4) The gene coverage is estimated as the total number of annotated base pairs divided by the gene length; 5) The NGs is computed as the mean coverage of the 35 single-copy genes (see Eq. <xref rid="Equ1" ref-type="">1</xref>); 6) The AGS is computed as the ratio of the total number of base pairs to the NGs (see Eq. <xref rid="Equ2" ref-type="">2</xref>).
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{NGs}=\frac{1}{35}\sum \limits_{\mathrm{i}=1}^{35}\frac{\mathrm{gene}\_{\mathrm{bp}}_i}{\mathrm{gene}\_{\mathrm{length}}_{\mathrm{i}}} $$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mi>NGs</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>35</mml:mn></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>35</mml:mn></mml:munderover><mml:mfrac><mml:mrow><mml:mtext>gene</mml:mtext><mml:mo>_</mml:mo><mml:msub><mml:mi>bp</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mtext>gene</mml:mtext><mml:mo>_</mml:mo><mml:msub><mml:mtext>length</mml:mtext><mml:mi mathvariant="normal">i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="12859_2019_3031_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par23">
          <disp-formula id="Equ2">
            <label>2</label>
            <alternatives>
              <tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{AGS}=\frac{\mathrm{total}\_\mathrm{bp}}{\mathrm{NGs}} $$\end{document}</tex-math>
              <mml:math id="M4" display="block">
                <mml:mi>AGS</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mtext>total</mml:mtext>
                    <mml:mo>_</mml:mo>
                    <mml:mi>bp</mml:mi>
                  </mml:mrow>
                  <mml:mi>NGs</mml:mi>
                </mml:mfrac>
              </mml:math>
              <graphic xlink:href="12859_2019_3031_Article_Equ2.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
        <p id="Par24">Where “gene_bp<sub>i</sub>” and “gene_length<sub>i</sub>” are the number of annotated base pairs and length of marker gene “i”, and “total_bp” is the total number of base pairs in the target metagenome.</p>
        <p id="Par25">To annotate the single-copy genes, we created an UProC database. We downloaded the eggNOG database version 4.5 [<xref ref-type="bibr" rid="CR33">33</xref>], selected the amino acid sequences (full-alignment files) used to create the Hidden Markov Model profiles of the 35 single-copy genes, applied the SEG low complexity filtering tool of the NCBI Blast+ 2.2 Suite [<xref ref-type="bibr" rid="CR21">21</xref>] on these sequences, and created the UProC database with the <italic>uproc-makedb</italic> command.</p>
      </sec>
      <sec id="Sec5">
        <title>16S rRNA gene average copy number computation tool (acn.sh)</title>
        <p id="Par26">The workflow implemented in the acn.sh tool, consists of annotating the 16S rRNA genes with SortMeRNA 2.0 [<xref ref-type="bibr" rid="CR34">34</xref>], estimating the 16S rRNA gene coverage as the number of annotated base pairs divided by the 16S rRNA gene length, and computing the ACN as the ratio of the 16S rRNA gene coverage to the NGs (see Eq. <xref rid="Equ3" ref-type="">3</xref>). The 16S rRNA gene length in this tool is set to 1542 bp, which corresponds to the full-length 16S rRNA gene of <italic>Escherichia coli</italic>. To run SortMeRNA, we use its prepackaged silva-bac-16 s-id90 and silva-arc-16 s-id95 16S rRNA gene sequence databases.</p>
        <p id="Par27">
          <disp-formula id="Equ3">
            <label>3</label>
            <alternatives>
              <tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{ACN}=\frac{16\mathrm{S}\_\mathrm{gene}\_\mathrm{bp}/16\mathrm{S}\_\mathrm{gene}\_\mathrm{length}}{\mathrm{NGs}} $$\end{document}</tex-math>
              <mml:math id="M6" display="block">
                <mml:mi>ACN</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mn>16</mml:mn>
                    <mml:mi mathvariant="normal">S</mml:mi>
                    <mml:mo>_</mml:mo>
                    <mml:mtext>gene</mml:mtext>
                    <mml:mo>_</mml:mo>
                    <mml:mi>bp</mml:mi>
                    <mml:mo>/</mml:mo>
                    <mml:mn>16</mml:mn>
                    <mml:mi mathvariant="normal">S</mml:mi>
                    <mml:mo>_</mml:mo>
                    <mml:mtext>gene</mml:mtext>
                    <mml:mo>_</mml:mo>
                    <mml:mtext>length</mml:mtext>
                  </mml:mrow>
                  <mml:mi>NGs</mml:mi>
                </mml:mfrac>
              </mml:math>
              <graphic xlink:href="12859_2019_3031_Article_Equ3.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
        <p id="Par28">Where “16S_gene_bp” and “16S_gene_length” are the number of annotated base pairs and the 16S rRNA gene length, respectively, and “NGs” is the number of genomes in the target metagenome.</p>
      </sec>
    </sec>
    <sec id="Sec6">
      <title>Data acquisition, pre-processing, and analysis</title>
      <p id="Par29">The 139 prokaryotic metagenomes of the TARA Oceans dataset were downloaded from the European Nucleotide Archive [<xref ref-type="bibr" rid="CR35">35</xref>] (ENA:PRJEB1787). To pre-process the metagenomic short-read data, we applied the following procedure. We clipped the adapter sequences (obtained from Shinichi Sunagawa personal communication, July 21, 2015) with the BBDuk tool of the BBMap 35.00 suite [<xref ref-type="bibr" rid="CR29">29</xref>]; We then merged the paired-end reads with VSEARCH 2.3.4 [<xref ref-type="bibr" rid="CR36">36</xref>], quality trimmed all reads at Q20 and filtered out sequences shorter than 45 bp using BBDuk; Lastly, we de-replicated the quality-controlled sequences with VSEARCH.</p>
      <p id="Par30">We estimated the Average Genome Size (AGS) and the 16S rRNA gene Average Copy Number (ACN) in the 139 metagenomes with the ags.sh and acn.sh tools, respectively. To run the ags.sh tool we used the minimum length parameter set to 100 bp. To filter significant 16S rRNA gene sequence alignments when running the acn.sh tool, we used an e-value of 1e-5. We selected a matching subset of 63 TARA Oceans metagenomes representing the Surface (SRF), Deep Chlorophyll Maximum (DCM) and Mesopelagic (MES) water layers in 21 sampling stations [<xref ref-type="bibr" rid="CR28">28</xref>], to analyze the changes of the AGS and ACN between water layers.</p>
      <p id="Par31">To test whether the AGS and ACN values differ between water layers, we applied a paired Wilcoxon rank-sum test between each pair of water layers, using the <italic>wilcox.test</italic> function of the vegan R package [<xref ref-type="bibr" rid="CR37">37</xref>].</p>
      <p id="Par32">We used TARA Oceans’ taxonomic abundance profile computed by Sunagawa et al. 2015 based on the annotation of 16S rDNA Operational Taxonomic Units (OTUs), to search for genera that correlated with the AGS and ACN. First, we removed singletons and genera with a total relative abundance lower than 0.001%, and computed the genera relative abundance in each metagenome (total sum scaling standardization). Subsequently, we selected the genera for which their correlation with either of these traits had a <italic>p</italic>-value lower than 0.001 after applying the Bonferroni correction for multiple comparisons. Additionally, we compared the AGS with the functional richness computed by Sunagawa et al. in the 139 TARA Oceans metagenomes.</p>
    </sec>
    <sec id="Sec7">
      <title>Simulation of metagenomic datasets</title>
      <p id="Par33">To assess the performance of our tools, we created three simulated metagenomic datasets (i.e., General, Infant Gut, and Marine). Each dataset is composed of 50 metagenomes, and all metagenomes have a size of two million reads. The metagenomes of the General dataset were simulated based on a random selection of prokaryotic species. The Infant Gut and Marine datasets approximate the taxonomic composition of the microbial communities found in the infant’s gut and marine environments, respectively.</p>
      <p id="Par34">To create each of the three simulated metagenomic datasets, we first created a reference dataset of complete genome sequences and the abundance profiles to define the community composition of each metagenome. In the case of the General genome reference dataset, we randomly selected 500 genera from all the prokaryotic genera in the NCBI RefSeq database [<xref ref-type="bibr" rid="CR38">38</xref>] and downloaded a maximum of three genome sequences per genus with an assembly status of “Complete genome” (on November 8, 2017). The resulting dataset comprised 751 different species. For the Infant Gut genome reference dataset, we used the genus taxonomic annotation of the metagenome-assembled genomes (MAGs) generated by Sharon et al. (2013) [<xref ref-type="bibr" rid="CR39">39</xref>] obtained from fecal samples collected from a premature infant, to guide the selection of species. We downloaded for each species one genome with an assembly status of “Complete genome” from the NCBI RefSeq database. If a species did not have a complete representative genome, we randomly selected another species with the same genus affiliation. The Infant Gut reference genome dataset contains 95 different species. Finally, the Marine reference genome dataset was created based on the taxonomic composition of TARA Oceans 16S rDNA Operational Taxonomic Units (OTUs) described by [<xref ref-type="bibr" rid="CR28">28</xref>]. We selected 172 genera for which there was at least one representative completely sequenced genome and downloaded a maximum of three genomes per genus from RefSeq, irrespective of their species affiliation. This database comprises 308 species.</p>
      <p id="Par35">To define the community profile of each metagenome, we randomly selected between 20 and 80 genomes from a reference dataset and assigned the genome abundances by sampling from a lognormal distribution with mean 1 and standard deviation of 0.5. We used these profiles together with the corresponding reference genome sequence data as an input to run MetaSim v0.9.5 [<xref ref-type="bibr" rid="CR40">40</xref>], where we set the read length to 300 bp and the substitution rate to 1 × 10<sup>− 3</sup>.</p>
      <p id="Par36">Lastly, we simulated a second Marine metagenomic dataset of 50 metagenomes (i.e., Marine dataset-2). This dataset was generated using the marine abundance profiles and reference genome dataset mentioned above; however, in this case, we simulated merged paired-end reads and varied their length according to the following distribution: p(50 bp) = 0.05; p(110 bp) = 0.15; p(150 bp) = 0.15; p(165 bp) = 0.5; p(180 bp) = 0.15. In addition, the substitution rate along each read was set to increase from 1 × 10<sup>− 4</sup> to 9.9 × 10<sup>− 2</sup>. The simulated short-read sequences were merged using VSEARCH [<xref ref-type="bibr" rid="CR36">36</xref>] with default parameters. With this read length distribution and error rates, we aimed to generate a more realistic dataset. It has similar characteristics as the metagenomic data obtained using Illumina HiSeq 2000 sequencing technology (as the prokaryotic metagenomes of the TARA Oceans dataset), and the majority of Illumina sequencing technologies in general [<xref ref-type="bibr" rid="CR41">41</xref>].</p>
      <p id="Par37">In Additional file <xref rid="MOESM2" ref-type="media">2</xref>, we show the taxonomic composition of the reference datasets of complete genome sequences, and in Additional file <xref rid="MOESM3" ref-type="media">3</xref>, we show details of the simulated metagenomic datasets.</p>
    </sec>
    <sec id="Sec8">
      <title>Benchmarking and validation</title>
      <p id="Par38">To benchmark the wall-clock runtime of ags.sh against MicrobeCensus, we randomly selected five (pre-processed) metagenomes of the TARA Oceans dataset and subsampled these to two million paired-end reads with the seqtk v1 tool [<xref ref-type="bibr" rid="CR42">42</xref>]. Next, we ran the AGS computation on each metagenome three times with both tools, using a different number of threads in each run (i.e., 4, 8, and 16). All the computations were performed in a workstation with Intel(R) Xeon(R) CPU E7–4820 v4 @ 2.00GHz.</p>
      <p id="Par39">To benchmark the accuracy of ags.sh against MicrobeCensus, we computed the AGS in the metagenomes of the General, Infant Gut, and Marine simulated datasets with both tools and compared it with the real AGS. To assess the accuracy of these tools in relation to the read length, we trimmed the 3′ end of the reads to simulate metagenomic datasets of different read lengths. Namely, for each of the General, Marine, and Infant Gut datasets, we trimmed the simulated 300 bp reads to 100 bp, 120 bp, 130 bp, 140 bp, 150 bp, 160 bp, 170 bp, 180 bp, and 200 bp. We processed a total of 500 metagenomes per dataset.</p>
      <p id="Par40">In these analyses, ags.sh was run with default parameters and MicrobeCensus was set to process the total number of reads in a metagenome. To derive the real AGS of a simulated metagenome, we computed the sum of the lengths of its component genomes weighted by their respective abundance, divided by the total abundance of genomes (see Eq. <xref rid="Equ4" ref-type="">4</xref>). The genome abundances were obtained from the abundance profiles used to simulate the metagenomes. To quantify the accuracy, we computed the Pearson’s correlation and Absolute Percentage Error (APE) (see Eq. <xref rid="Equ5" ref-type="">5</xref>) of the AGS computed by ags.sh and MicrobeCensus, with respect to the real AGS.</p>
      <p id="Par41">
        <disp-formula id="Equ4">
          <label>4</label>
          <alternatives>
            <tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\mathrm{AGS}}_{\mathrm{real}}=\frac{1}{\mathrm{total}\_\mathrm{abund}}\sum \limits_{\mathrm{i}=1}^{\mathrm{k}}\mathrm{genome}\_{\mathrm{length}}_{\mathrm{i}}\times \mathrm{genome}\_{\mathrm{abund}}_{\mathrm{i}} $$\end{document}</tex-math>
            <mml:math id="M8" display="block">
              <mml:msub>
                <mml:mi>AGS</mml:mi>
                <mml:mtext>real</mml:mtext>
              </mml:msub>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mn>1</mml:mn>
                <mml:mrow>
                  <mml:mtext>total</mml:mtext>
                  <mml:mo>_</mml:mo>
                  <mml:mtext>abund</mml:mtext>
                </mml:mrow>
              </mml:mfrac>
              <mml:munderover>
                <mml:mo>∑</mml:mo>
                <mml:mrow>
                  <mml:mi mathvariant="normal">i</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:mi mathvariant="normal">k</mml:mi>
              </mml:munderover>
              <mml:mtext>genome</mml:mtext>
              <mml:mo>_</mml:mo>
              <mml:msub>
                <mml:mtext>length</mml:mtext>
                <mml:mi mathvariant="normal">i</mml:mi>
              </mml:msub>
              <mml:mo>×</mml:mo>
              <mml:mtext>genome</mml:mtext>
              <mml:mo>_</mml:mo>
              <mml:msub>
                <mml:mtext>abund</mml:mtext>
                <mml:mi mathvariant="normal">i</mml:mi>
              </mml:msub>
            </mml:math>
            <graphic xlink:href="12859_2019_3031_Article_Equ4.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p id="Par42">Where “total_abund” is the total abundance in the target metagenome, and “genome_length<sub>i</sub>” and “genome_abund<sub>i</sub>” are the length and abundance of genome “i”, respectively.</p>
      <p id="Par43">
        <disp-formula id="Equ5">
          <label>5</label>
          <alternatives>
            <tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{APE}=100\times \left|\frac{\mathrm{Ref}-\mathrm{Est}}{\mathrm{Ref}}\right| $$\end{document}</tex-math>
            <mml:math id="M10" display="block">
              <mml:mi>APE</mml:mi>
              <mml:mo>=</mml:mo>
              <mml:mn>100</mml:mn>
              <mml:mo>×</mml:mo>
              <mml:mfenced close="|" open="|">
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mi>Ref</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mi>Est</mml:mi>
                  </mml:mrow>
                  <mml:mi>Ref</mml:mi>
                </mml:mfrac>
              </mml:mfenced>
            </mml:math>
            <graphic xlink:href="12859_2019_3031_Article_Equ5.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p id="Par44">Where “Ref” and “Est” are the reference and estimated trait values, respectively.</p>
      <p id="Par45">To compare ags.sh vs. MicrobeCensus on real data, we computed the AGS with these tools on a randomly selected subset of 50 (pre-processed) metagenomes of TARA Oceans. To accelerate the computation of the AGS, we randomly subsampled the metagenomes to two million reads using the seqtk v1 tool [<xref ref-type="bibr" rid="CR42">42</xref>].</p>
      <p id="Par46">To measure the wall-clock running time of acn.sh, we used the same five TARA Oceans metagenomes subsampled to two million paired-end reads and previously used to benchmark the ags.sh running time. Next, we ran acn.sh using different thread numbers (i.e., 4, 8, and 16) and measured the wall-clock running time. These computations were performed in a workstation with Intel(R) Xeon(R) CPU E7–4820 v4 @ 2.00 GHz.</p>
      <p id="Par47">To benchmark the accuracy of acn.sh, we compared it with PICRUSt [<xref ref-type="bibr" rid="CR23">23</xref>], CopyRighter [<xref ref-type="bibr" rid="CR24">24</xref>], and PAPRICA [<xref ref-type="bibr" rid="CR25">25</xref>]. We computed the ACN with these four tools in the three simulated metagenomic datasets, where we also trimmed the 3′ end of the metagenomic reads to produce different read lengths (i.e., 100 bp, 150 bp, 200 bp, and 300 bp). We then computed the Pearson’s correlation and APE between the predicted and real ACNs.</p>
      <p id="Par48">To compute the ACN with acn.sh, we ran the tool with default parameters. To compute the ACN with CopyRighter and PICRUSt, we applied the following procedure: 1) Reads containing 16S rRNA genes were identified with SortMeRNA 2.0 [<xref ref-type="bibr" rid="CR34">34</xref>]; 2) 16S rRNA gene sequences were extracted and clustered at 99% identity with VSEARCH 2.3.4 [<xref ref-type="bibr" rid="CR36">36</xref>]; 3) Cluster centroid sequences were blasted against the GreenGenes databases GG2012 (release October 2012) and GG2013 (release May 2013) [<xref ref-type="bibr" rid="CR43">43</xref>], using BLASTN [<xref ref-type="bibr" rid="CR21">21</xref>] with an e-value of 0.001 and an identity threshold of 99%; 4) The 16S rRNA gene copy numbers of the best hits were parsed out of the respective lookup tables (ssu_img40_gg201210.txt and 16S_13_5_precalculated.tab for CopyRighter and PICRUSt, downloaded from [<xref ref-type="bibr" rid="CR44">44</xref>, <xref ref-type="bibr" rid="CR45">45</xref>], respectively); 5) The ACN was computed as the average of the predicted 16S rRNA gene copy number (i.e., 16S rRNA gene copy number of the best hits), weighted by the abundance of the cluster represented by the respective query sequence (see Eq. <xref rid="Equ6" ref-type="">6</xref>).</p>
      <p id="Par49">To compute the ACN with PAPRICA, we used the cluster centroid sequences to run the paprica-run.sh script using the –large parameter for the paprica-place_it.py script (i.e., to increase the memory utilization). Then, we computed the average of the 16S rRNA gene copy numbers predicted for these sequences, weighted by the respective cluster abundances (see Eq. <xref rid="Equ6" ref-type="">6</xref>).</p>
      <p id="Par50">
        <disp-formula id="Equ6">
          <label>6</label>
          <alternatives>
            <tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\mathrm{ACN}}_{\mathrm{est}}=\frac{1}{\mathrm{total}\_\mathrm{abund}}\sum \limits_{\mathrm{i}=1}^{\mathrm{k}}\mathrm{pred}\_\mathrm{copy}\_{\mathrm{num}}_{\mathrm{i}}\times \mathrm{cluster}\_{\mathrm{abund}}_{\mathrm{i}} $$\end{document}</tex-math>
            <mml:math id="M12" display="block">
              <mml:msub>
                <mml:mi>ACN</mml:mi>
                <mml:mi>est</mml:mi>
              </mml:msub>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mn>1</mml:mn>
                <mml:mrow>
                  <mml:mtext>total</mml:mtext>
                  <mml:mo>_</mml:mo>
                  <mml:mtext>abund</mml:mtext>
                </mml:mrow>
              </mml:mfrac>
              <mml:munderover>
                <mml:mo>∑</mml:mo>
                <mml:mrow>
                  <mml:mi mathvariant="normal">i</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:mi mathvariant="normal">k</mml:mi>
              </mml:munderover>
              <mml:mtext>pred</mml:mtext>
              <mml:mo>_</mml:mo>
              <mml:mtext>copy</mml:mtext>
              <mml:mo>_</mml:mo>
              <mml:msub>
                <mml:mi>num</mml:mi>
                <mml:mi mathvariant="normal">i</mml:mi>
              </mml:msub>
              <mml:mo>×</mml:mo>
              <mml:mtext>cluster</mml:mtext>
              <mml:mo>_</mml:mo>
              <mml:msub>
                <mml:mtext>abund</mml:mtext>
                <mml:mi mathvariant="normal">i</mml:mi>
              </mml:msub>
            </mml:math>
            <graphic xlink:href="12859_2019_3031_Article_Equ6.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p id="Par51">Where “pred_copy_num<sub>i</sub>” and “cluster_abund<sub>i</sub>” are the predicted 16S rRNA gene copy number and cluster size of query sequence “i”, and “total_abund”, is the total number of identified 16S rRNA gene sequences in a metagenome.</p>
      <p id="Par52">Similarly, as described above, we computed the real ACN of a metagenome, as the sum of the 16S rRNA gene copy numbers of its component genomes weighted by their respective abundance and divided by the total abundance of genomes (see Eq. <xref rid="Equ7" ref-type="">7</xref>). The 16S rRNA gene copy numbers were obtained from the NCBI features annotation.</p>
      <p id="Par53">
        <disp-formula id="Equ7">
          <label>7</label>
          <alternatives>
            <tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\mathrm{ACN}}_{\mathrm{real}}=\frac{1}{\mathrm{total}\_\mathrm{abund}}\sum \limits_{\mathrm{i}=1}^{\mathrm{k}}\mathrm{genome}\_\mathrm{copy}\_{\mathrm{num}}_{\mathrm{i}}\times \mathrm{g}\mathrm{enome}\_{\mathrm{abund}}_{\mathrm{i}} $$\end{document}</tex-math>
            <mml:math id="M14" display="block">
              <mml:msub>
                <mml:mi>ACN</mml:mi>
                <mml:mtext>real</mml:mtext>
              </mml:msub>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mn>1</mml:mn>
                <mml:mrow>
                  <mml:mtext>total</mml:mtext>
                  <mml:mo>_</mml:mo>
                  <mml:mtext>abund</mml:mtext>
                </mml:mrow>
              </mml:mfrac>
              <mml:munderover>
                <mml:mo>∑</mml:mo>
                <mml:mrow>
                  <mml:mi mathvariant="normal">i</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:mi mathvariant="normal">k</mml:mi>
              </mml:munderover>
              <mml:mtext>genome</mml:mtext>
              <mml:mo>_</mml:mo>
              <mml:mtext>copy</mml:mtext>
              <mml:mo>_</mml:mo>
              <mml:msub>
                <mml:mi>num</mml:mi>
                <mml:mi mathvariant="normal">i</mml:mi>
              </mml:msub>
              <mml:mo>×</mml:mo>
              <mml:mi mathvariant="normal">g</mml:mi>
              <mml:mtext>enome</mml:mtext>
              <mml:mo>_</mml:mo>
              <mml:msub>
                <mml:mtext>abund</mml:mtext>
                <mml:mi mathvariant="normal">i</mml:mi>
              </mml:msub>
            </mml:math>
            <graphic xlink:href="12859_2019_3031_Article_Equ7.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p id="Par54">Where the “total_abund” is the total abundance in the target metagenome, and “genome_copy_num<sub>i</sub>” and “genome_abund<sub>i</sub>” are the 16S rRNA gene copy number and abundance of genome “i”, respectively.</p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Results and discussion</title>
    <p id="Par55">Our implementation to compute the AGS is based on the annotation of 35 prokaryotic universally distributed single-copy genes identified by Raes et al., (2007) [<xref ref-type="bibr" rid="CR22">22</xref>]. Most of these genes are part of the translation machinery and essential for cellular life. The main finding that allowed us to develop ags.sh (and in turn acn.sh), is that the annotation of the 35 marker genes in unassembled metagenomes, using new, fast and accurate tools, can be used to rapidly estimate the genes’ coverage, which accurately approximates the total number of genomes (NGs). Thus, we can derive the AGS analytically, as the ratio of NGs and the total number of base pairs in a metagenome. However, to estimate the NGs it is crucial to perform a precise annotation of the single-copy genes. To this end, we include in ags.sh an option to filter and trim sequence reads to obtain the optimal read lengths for the annotation of single-copy genes (see Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). The computation of the 16S rRNA gene average copy number follows a similar methodology: we estimate the coverage of the 16S rRNA genes and divided it by the NGs (see Fig. <xref rid="Fig1" ref-type="fig">1</xref>b).
<fig id="Fig1"><label>Fig. 1</label><caption><p>Workflows implemented in the ags.sh and acn.sh tools. <bold>a</bold> ags.sh workflow consists of the following steps: 1) Filtering out and trimming reads to obtain an appropriate read length range using the BBduk tool [<xref ref-type="bibr" rid="CR29">29</xref>] (optional step); 2) Predicting the Open Reading Frames (ORFs) with FragGeneScan-plus [<xref ref-type="bibr" rid="CR30">30</xref>] (optional step); 3) Annotating the single-copy genes in the ORF’s amino acid sequences with UProC [<xref ref-type="bibr" rid="CR32">32</xref>]; 4) Computing the Number of Genomes (NGs) as the mean gene coverage of the single-copy genes; 5) Counting the total number of base pairs; 6) Computing the Average Genome Size (AGS) as the ratio of the total number of base pairs to the NGs. <bold>b</bold> The tasks performed by acn.sh are as follows: 1) Annotating the 16S rRNA genes with SortMeRNA [<xref ref-type="bibr" rid="CR34">34</xref>]; 2) Computing the 16S rRNA gene coverage as the number of annotated base pairs divided by the 16S rRNA gene length; 3) Parsing the NGs from the ags.sh output; 4) Computing the ratio of the 16S rRNA gene coverage to the NGs to derive the 16S rRNA gene Average Copy Number (ACN)</p></caption><graphic xlink:href="12859_2019_3031_Fig1_HTML" id="MO1"/></fig></p>
    <sec id="Sec10">
      <title>Benchmarking the average genome size computation tool (ags.sh)</title>
      <p id="Par56">Firstly, we benchmarked the wall-clock runtime of ags.sh against MicrobeCensus (see Fig. <xref rid="Fig2" ref-type="fig">2</xref>a and Additional file <xref rid="MOESM4" ref-type="media">4</xref>). We used a subset of five TARA Oceans metagenomes subsampled to two million paired-end reads (see Materials and Methods), to measure the runtime of these tools with increasing number of threads (i.e., 4, 8 and 16). In this analysis, we also benchmarked the runtime of ags.sh using previously predicted Open Reading Frame (ORF) amino acid sequences. We consider this is a likely scenario when using our tool, given that the prediction of ORFs is a standard procedure in most metagenomic analysis workflows. With and without the ORF prediction step, ags.sh was on average 6.6 and 12.6 times faster than MicrobeCensus, respectively. Ags.sh also showed a greater runtime improvement when we increased the number of threads from 4 to 16. The acceleration achieved by our implementation is the result of using a fork of FragGeneScan-plus [<xref ref-type="bibr" rid="CR30">30</xref>, <xref ref-type="bibr" rid="CR31">31</xref>] and the UProC program [<xref ref-type="bibr" rid="CR32">32</xref>] for the ORF prediction and gene annotation, respectively. FragGeneScan-plus is several times faster than FragGeneScan [<xref ref-type="bibr" rid="CR46">46</xref>], and has the same prediction accuracy, while UProC is up to three orders of magnitude faster and more sensitive than profile-based methods on unassembled short-read sequences. Reducing the runtime also has consequences for the AGS estimation accuracy, given that all the metagenomic data available can be readily used to compute this trait.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Benchmarking the running time and accuracy ags.sh against MicrobeCensus. <bold>a</bold> Plot comparing the running time of ags.sh with MicrobeCensus. We compared the wall-clock runtime between both tools using 4, 8, and 16 threads, in five TARA Oceans metagenomes subsampled to two million paired-end reads. We also compared the ags.sh runtime using previously predicted Open Reading Frames (ORFs). When the ORF prediction procedure was included, ags.sh was 11 times faster than MicrobeCensus using 16 threads. <bold>b</bold> Scatter plots comparing the accuracy of the AGS computed by ags.sh (upper panel) and MicrobeCensus (lower panel) with the reference AGS in the metagenomes of the Marine dataset-2. <bold>c</bold> Scatter plot comparing the AGS computed by ags.sh and MicrobeCensus in 50 TARA Oceans metagenomes, randomly subsampled to two million reads. The black line shown in the scatter plots from b) and c) represents the one-to-one relationship. The absolute percentage error was computed as 100 x |(AGS<sub>ref</sub> - AGS<sub>est</sub>)/AGS<sub>ref</sub>|, where AGS<sub>est</sub> and AGS<sub>ref</sub> are the estimated and reference AGS, respectively. MdAPE acronym stands for Median Absolute Percentage Error</p></caption><graphic xlink:href="12859_2019_3031_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par57">Secondly, we compared the accuracy of ags.sh against MicrobeCensus. We used both tools to estimate the AGS in the simulated metagenomes of three different datasets we generated (i.e., General, Infant Gut, and Marine datasets; see Material and Methods). Simulated data allowed us to calculate the real AGS in the metagenomes, which we used as a reference to evaluate the accuracy of these tools. Each simulated dataset is composed of 50 metagenomes of two million reads of 300 bp, which were trimmed to different read lengths, to evaluate the accuracy of the tools as a function of the read length.</p>
      <p id="Par58">The analysis showed that the performance of both tools changed very little between datasets, and ags.sh had comparable or higher accuracy than MicrobeCensus in metagenomes with a read length between 120 and 200 bp (see Additional file <xref rid="MOESM5" ref-type="media">5</xref> and Additional file <xref rid="MOESM6" ref-type="media">6</xref>). The Pearson’s correlation values showed marginal differences between both tools and remained practically constant within each dataset when the read length was changed. However, the error values revealed that the accuracy of ags.sh varies with the read length, with a trend of having higher accuracy than MicrobeCensus in metagenomes with a read length between 120 and 200 bp. MicrobeCensus was less affected by the read length and outperformed ags.sh in metagenomes with read lengths of 100 and 300 bp.</p>
      <p id="Par59">The optimal read length range observed for our tool reflects the read length in which UProC has an optimal sensitivity and specificity. In essence, if the reads are too short there is a lower sensitivity, and consequently, the AGS is overestimated (NGs underestimated). Conversely, when the reads are too long, there is a lower specificity and the AGS is underestimated (NGs overestimated).</p>
      <p id="Par60">It is important to point out that ags.sh has an option to remove and trim metagenomic reads to obtain appropriate read lengths. This way, it can always process metagenomic reads where it has its highest accuracy.</p>
      <p id="Par61">In addition, to test these tools in a more realistic scenario, we generated a second simulated Marine metagenomic dataset (i.e., Marine dataset-2). Marine dataset-2 is composed of 50 metagenomes of two million merged paired-end reads, with a length that varies from 100 to 180 bp, and with an error rate increasing along each read from 1 × 10<sup>− 4</sup> to 9.9 × 10<sup>− 2</sup>. With such data characteristics, we simulate the data generated by Illumina HiSeq 2000 sequencing technology, and in particular, the characteristics of TARA Oceans metagenomes, which we analyzed as an example application of our tools (see below). In Fig. <xref rid="Fig2" ref-type="fig">2</xref>b, we show the scatter plots comparing the estimated AGS using ags.sh and MicrobeCensus, vs. the reference AGS. In this example, MicrobeCensus produced more biased estimates: the tool consistently underestimated the AGS. The Pearson’s correlation and median of the Absolute Percentage Errors (MdAPEs) were 1.8% and 0.95 for ags.sh, and 4.5% and 0.89 for MicrobeCensus, respectively.</p>
      <p id="Par62">Lastly, we compared the AGS obtained with ags.sh and MicrobeCensus on real data. We used these tools to compute the AGS in 50 metagenomes of the TARA Oceans dataset (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c). To reduce the computation time, we randomly subsampled the metagenomes to two million reads. Although the AGSs computed with both tools were highly correlated (Pearson’s r = 0.97), MicrobeCensus showed a similar pattern regarding the underestimation of the AGS as observed in the simulated data, which indicates that the predictions of our tool are closer to the true AGS of these samples. The bias observed in MicrobeCensus estimates might be explained by the fact that this tool is based on a series of empirically determined constants, resulting in a somewhat limited generalization.</p>
    </sec>
    <sec id="Sec11">
      <title>Benchmarking the 16S rRNA gene average copy number estimation tool (acn.sh)</title>
      <p id="Par63">Analog to the previous benchmark analysis, we measured the wall-clock runtime of acn.sh using 4, 8, and 16 threads on the five subsampled metagenomes of TARA Oceans (see Fig. <xref rid="Fig3" ref-type="fig">3</xref>a and Additional file <xref rid="MOESM7" ref-type="media">7</xref>). In this evaluation, we observed that acn.sh scales very well with the number of threads and is able to process approximately one million reads per minute using eight threads. The most computationally intensive task performed by acn.sh, is the annotation of the 16S rRNA genes with SortMeRNA [<xref ref-type="bibr" rid="CR34">34</xref>], which determines the runtime. SortMeRNA has an optimal accuracy-speed trade-off, making it very convenient for the computation of this trait in metagenomic data. In addition, given that acn.sh depends on the NGs estimated with ags.sh, we benchmarked the running time of ags.sh plus acn.sh. When both tools are taken into account, we observed that a two million paired-end reads metagenome is processed in less than four minutes using eight threads.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Evaluating the running time of acn.sh and benchmarking its accuracy against CopyRighter. <bold>a</bold> Plot showing the wall-clock runtime of acn.sh, and the running time of ags.sh plus acn.sh, using 4, 8, and 16 threads, for the computation of the 16S rRNA gene Average Copy Number (ACN) in five TARA Oceans metagenomes subsampled to two million paired-end reads. <bold>b</bold> Scatter plot comparing the ACN computed by acn.sh (upper panel) and CopyRighter (lower panel) with the reference ACN in the metagenomes of the Marine dataset-2. The black line shown in the plot represents the one-to-one relationship. Similarly as above, we applied the following formula to compute the absolute percentage error: 100 x |(ACN<sub>ref</sub> - ACN<sub>est</sub>)/ACN<sub>ref</sub>|, where ACN<sub>est</sub> and ACN<sub>ref</sub> are the estimated and reference ACN, respectively</p></caption><graphic xlink:href="12859_2019_3031_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par64">We also compared the accuracy of acn.sh with PICRUSt, CopyRighter, and PAPRICA (see Additional file <xref rid="MOESM8" ref-type="media">8</xref> and Additional file <xref rid="MOESM9" ref-type="media">9</xref>). As described above, we used acn.sh to compute the ACN in the simulated metagenomes of the General, Infant Gut, and Marine datasets, trimmed to different read lengths. We then computed the real ACN, which we used as a reference to assess the accuracy of these tools. This analysis showed that acn.sh is considerably more accurate than the other three tools. As observed for ags.sh, acn.sh had comparable performance in the three datasets: while the correlation coefficients were not affected by the read length, the APE values increased in metagenomes of 100 and 300 bp. The under- and overestimation of the NGs computed by ags.sh limited the accuracy in these latter two cases. When considering an appropriate read length (i.e., 150 and 200 bp), the correlation and MdAPE values ranged from 0.9 to 0.94, and from 2.9 to 6.4%, respectively.</p>
      <p id="Par65">Conversely, the performance of PICRUSt, CopyRighter, and PAPRICA varied between datasets, especially between the Infant Gut and Marine datasets, where we observed their highest and lowest performance, respectively. For instance, the correlation and MdAPE values of PAPRICA, which showed the highest accuracy of the three in the Infant Gut dataset, went from 0.78 to 0.48, and from 3.2 to 15.8%, respectively, in the metagenomes of 100 bp. Such finding is likely to reflect the low representation of sequenced environmental taxa in reference phylogenies, which is known to limit the prediction power of these tools [<xref ref-type="bibr" rid="CR27">27</xref>].</p>
      <p id="Par66">In Fig. <xref rid="Fig3" ref-type="fig">3</xref>b and c, we show the scatter plots comparing the ACN computed with acn.sh and CopyRighter vs. the reference ACN in the Marine dataset-2. We selected CopyRighter for this comparison since it performed (moderately) better than PICRUSt and PAPRICA in the Marine dataset. The scatter plots show the superiority of acn.sh for the computation of the ACN, particularly evidenced by the correlation coefficients (Pearson’s r = 0.9 and Pearson’s r = 0.54 for acn.sh and CopyRighter, respectively). However, we stress that PICRUSt, CopyRighter, and PAPRICA aim to correct for the copy number variation when analyzing the composition of 16S rRNA gene Operational Taxonomic Units (OTUs), and were not designed to compute the ACN. Therefore, these tools implement a more complex approach based on the phylogenetic annotation of the 16S rRNA genes.</p>
    </sec>
    <sec id="Sec12">
      <title>Analysis of the average genome size and 16S rRNA gene copy number in TARA oceans metagenomes</title>
      <p id="Par67">We computed the AGS and ACN in the 139 prokaryotic metagenomes of TARA Oceans (using complete metagenomic samples) to analyze microorganisms’ ecological strategies associated with different marine environmental conditions. Firstly, we conducted pairwise comparisons of the AGS and ACN between water layers. For this task, we used a matching subset of 63 TARA Oceans metagenomes that represent the surface (SRF), deep chlorophyll maximum (DCM) and mesopelagic (MES) water layers in 21 sampling stations across the globe [<xref ref-type="bibr" rid="CR28">28</xref>]. The results showed that apart from the ACN of the SRF and DCM water layers, all other water layers have significant differences in their trait values (paired Wilcoxon rank-sum test; all <italic>p</italic>-values &lt; 0.05; see Additional file <xref rid="MOESM10" ref-type="media">10</xref>). As observed previously [<xref ref-type="bibr" rid="CR16">16</xref>], we found that the two traits were significantly correlated among themselves (Pearson’s r = 0.38; <italic>p</italic>-value = 0.0023) (see Fig. <xref rid="Fig4" ref-type="fig">4</xref>a; Additional file <xref rid="MOESM11" ref-type="media">11</xref>).
<fig id="Fig4"><label>Fig. 4</label><caption><p>Exploratory analyses performed on TARA Oceans metagenomes. <bold>a</bold> Scatter plot comparing the AGS and ACN in the matching subset of 63 TARA Oceans metagenomes representing the surface, deep chlorophyll maximum and mesopelagic water layers (SRF, DCM, and MES, respectively) in 21 sampling sites. The box plots in the lower and left-hand side panels show the distributions of the Average Genome Size (AGS) and 16S rRNA gene Average Copy Number (ACN) in the SRF, DCM, and MES water layers. For the sake of clarity, two metagenomes with relatively large AGS or ACN values were not included in the plot. These are the TARA_076_DCM_0.22–3 with an AGS = 5,036,010 bp and TARA_064_DCM_0.22–3 with an ACN = 2.4. <bold>b</bold> Scatter plots comparing the AGS with the log relative abundance of the <italic>Herbiconiux</italic> and <italic>Candidatus Pelagibacter</italic> genera (upper and lower panel, respectively) in TARA Oceans metagenomes. <italic>Herbiconiux</italic> and <italic>Candidatus Pelagibacter</italic> genera had the strongest positive and negative Pearson’s correlations with the AGS, respectively. <bold>c</bold> Scatter plot comparing the ACN with the log relative abundance of the <italic>Glaciecola</italic> genus in TARA Oceans metagenomes. This genus showed the strongest positive Pearson’s correlation with the ACN. The abundance of these genera was computed by Sunagawa et al. based on the annotation of 16S rDNA Operational Taxonomic Units (OTUs). <bold>d</bold> Scatter plot comparing the AGS with the functional richness of TARA Oceans metagenomes. The functional richness was computed by Sunagawa et al. based on the abundance estimation of eggNOG orthologous groups</p></caption><graphic xlink:href="12859_2019_3031_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par68">The distributions of the ACN values resemble the differences in minimum generation times between water layers, computed by Sunagawa et al. 2015 for the same metagenomes. As shown by Vieira-Silva &amp; Rocha (2010) [<xref ref-type="bibr" rid="CR17">17</xref>], the 16S rRNA gene copy number has a strong correlation with the growth rate of microorganisms.</p>
      <p id="Par69">Additionally, based on the analysis of the 139 TARA Oceans metagenomes, we observed significant correlations between both traits and the sampling depth in the water column (AGS vs. water depth: Pearson’s r = 0.46; ACN vs. water depth: Pearson’s r = 0.28; all <italic>p</italic>-values &lt; 0.001; Additional file <xref rid="MOESM11" ref-type="media">11</xref>). Similar findings relating the genome size and 16S rRNA copy number with water depth have been previously described [<xref ref-type="bibr" rid="CR47">47</xref>, <xref ref-type="bibr" rid="CR48">48</xref>]. We also obtained a significant correlation between the ACN and water temperature after controlling for water depth (Pearson’s r = − 0.34 and <italic>p</italic>-value &lt; 0.001; Additional file <xref rid="MOESM11" ref-type="media">11</xref>), which was not observed for the AGS. This result could be explained by the fact that psychrophiles are slower growers than expected, given their growth-associated genomic traits [<xref ref-type="bibr" rid="CR17">17</xref>]. That is, for the same minimal generation times, organisms inhabiting colder marine environments tend to have a greater 16S rRNA gene copy number to compensate for slower enzymatic activity.</p>
      <p id="Par70">Based on the taxonomic annotation of the rDNA Operational Taxonomic Units (OTUs) obtained by Sunagawa et al. 2015 for TARA Oceans metagenomes, we looked for genera associated with the variability of the AGS and ACN traits. This analysis revealed that the genera <italic>Herbiconiux</italic> and <italic>Candidatus Pelagibacter</italic> had the strongest positive and negative correlations with the AGS, respectively, and the genus <italic>Glaciecola</italic> had the strongest positive correlation with the ACN (see Fig. <xref rid="Fig4" ref-type="fig">4</xref>b and c; Additional file <xref rid="MOESM11" ref-type="media">11</xref>). <italic>Herbiconiux</italic> species tend to have a relatively large genome size, often above 6 Mbp, while <italic>Candidatus Pelagibacter</italic> has a streamlined genome, which is around 1.3 Mbp. On the other hand, sequenced species of <italic>Glaciecola</italic> contain from four to five rRNA gene operons [<xref ref-type="bibr" rid="CR49">49</xref>]. These are marine microorganisms with extreme values in their genomic traits, and represent different ecological strategies associated with different environments (see below). We note that we did not find any genus with a significant negative correlation with the ACN. That is, the ACN, which tends to be low, appears to vary between metagenomes, mainly when these have a higher abundance of organisms with a high 16S rRNA gene copy number.</p>
      <p id="Par71">Lastly, we compared the AGS of TARA Oceans metagenomes, with the functional richness estimated by Sunagawa et al. 2015 based on the annotation of eggNOG orthologous groups [<xref ref-type="bibr" rid="CR33">33</xref>]. We observed a highly significant correlation between these two metagenomic traits (Pearson’s r = 0.52 and <italic>p</italic>-value &lt; 0.0001; see Fig. <xref rid="Fig4" ref-type="fig">4</xref>d and Additional file <xref rid="MOESM11" ref-type="media">11</xref>). This result was expected, given that the number of genes in prokaryotes is known to be linearly related to the genome size [<xref ref-type="bibr" rid="CR50">50</xref>]. However, the nature of this relationship using the community AGS and functional richness offers new insights into the ecology of marine microbial communities. The AGS explained a moderate amount of the functional richness variation (R<sup>2</sup> = 0.27). Several other factors can influence the community functional richness and AGS. For example, the functional richness is also highly correlated with the taxonomic richness and water depth (Pearson’s r = 0.85 and 0.65, respectively; all <italic>p</italic>-values &lt; 0.0001; Additional file <xref rid="MOESM11" ref-type="media">11</xref>). A plausible explanation, in line with previous work characterizing prokaryotic ecological strategies [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR51">51</xref>], is that more heterogeneous environmental conditions, which appear to be found in deeper water layers [<xref ref-type="bibr" rid="CR28">28</xref>, <xref ref-type="bibr" rid="CR52">52</xref>], result in a higher functional and taxonomic richness and more complex ecological interactions. In turn, a higher complexity of the ecological interactions and a greater environmental heterogeneity, increase the demand for larger gene repertories, and consequently, larger genomes.</p>
      <p id="Par72">Taken together, these exploratory analyses indicate that surface marine microbial communities are characterized by a small AGS and low ACN. Such trait values denote the presence of efficient, slow growers and specialist organisms (i.e., k-strategist), in agreement with the oligotrophic environmental conditions commonly found in marine surface waters. On the contrary, microbial communities from the DCM and MES water layers exhibited a larger AGS and greater ACN, which indicate that organisms inhabiting deeper layers tend to have a more diverse metabolism and grow faster (i.e., r-strategist). As such, these organisms respond better to environmental changes and can exploit intensively nutrient rich micro-niches [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR53">53</xref>, <xref ref-type="bibr" rid="CR54">54</xref>].</p>
    </sec>
  </sec>
  <sec id="Sec13">
    <title>Conclusions</title>
    <p id="Par73">In this work, we developed the ags.sh and acn.sh tools that accurately and rapidly compute the average genome size and 16S rRNA gene average copy number in unassembled prokaryotic metagenomes. The quantification of these traits provides a powerful approach to characterize microbial ecological strategies. We benchmarked and evaluated the performance of these tools using simulated metagenomic datasets composed of contrasting microbial communities. In these analyses, we showed that the ags.sh tool is up to 11 times faster with comparable or higher accuracy than MicrobeCensus. Reducing the computation time is a valuable improvement given the large data volumes generated by current sequencing technologies. Ags.sh can be readily used to process a comprehensive metagenomic sample for the estimation of the AGS, as exemplarily applied here on TARA Oceans metagenomes. Given that MicrobeCensus is already a highly accurate tool, there was little room for improvement in this sense, and ags.sh only showed a moderate improvement in accuracy regarding the absolute error rates. However, the fact that ags.sh derives the AGS analytically makes it more reliable in comparison to MicrobeCensus. Lastly, our benchmarking analysis of the acn.sh tool showed that it has remarkable accuracy and outperforms the ACN computation approaches based on the copy number predictions of PICRUSt, CopyRighter, and PAPRICA. The fact that acn.sh is exclusively dedicated to the computation of the ACN allows to considerably simplify the analysis workflow.</p>
    <p id="Par74">The exploratory analyses performed on TARA Oceans metagenomes demonstrate the applicability of our tools to compute the AGS and ACN traits on unassembled metagenomic data, and predict the dominant ecological strategies taking place within microbial communities.</p>
    <p id="Par75">We note that the results presented here, show that the AGS and ACN can be derived analytically based on the annotation of single-copy and 16S rRNA genes. Accordingly, future implementations of the ags.sh and acn.sh tools have the potential to improve in speed and accuracy, as gene annotation tools continue to advance. Additionally, in future implementations, it will be of particular interest to include the computation of the AGS and ACN variances [<xref ref-type="bibr" rid="CR55">55</xref>].</p>
  </sec>
  <sec id="Sec14">
    <title>Availability and requirements</title>
    <p id="Par76">Project name: AGS-and-ACN tools</p>
    <p id="Par77">Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/pereiramemo/AGS-and-ACN-tools">https://github.com/pereiramemo/AGS-and-ACN-tools</ext-link></p>
    <p id="Par78">Operating system(s): Platform independent.</p>
    <p id="Par79">Programming language: AWK, Bash, and R.</p>
    <p id="Par80">Other requirements: Docker.</p>
    <p id="Par81">License: GNU General Public License v3.0.</p>
    <p id="Par82">Any restrictions to use by non-academics: none.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional files</title>
    <sec id="Sec15">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2019_3031_MOESM1_ESM.xlsx">
            <label>Additional file 1:</label>
            <caption>
              <p>Single-copy genes universally present in prokaryotes. Table showing the COG number of the 35 single-copy genes identified by Raes et al. (2007), and the number of sequences included in each COG. (XLSX 42 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2019_3031_MOESM2_ESM.xlsx">
            <label>Additional file 2:</label>
            <caption>
              <p>Reference genome datasets. Excel sheets with the accession, taxid, organism name, and FTP URL of the genomes used to generate the simulated metagenomic datasets. (XLSX 105 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="12859_2019_3031_MOESM3_ESM.xlsx">
            <label>Additional file 3:</label>
            <caption>
              <p>Simulated metagenomic datasets. Table showing main characteristics describing the simulated metagenomic datasets. (XLSX 10 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="12859_2019_3031_MOESM4_ESM.xlsx">
            <label>Additional file 4:</label>
            <caption>
              <p>Benchmarking the running time of ags.sh against MicrobeCensus. Table showing the mean running time of ags.sh and MicrobeCensus using 4, 8, and 16 threads, for the estimation of the AGS in five TARA Oceans metagenomes subsampled to two million paired-end reads. (XLSX 35 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="12859_2019_3031_MOESM5_ESM.pdf">
            <label>Additional file 5:</label>
            <caption>
              <p>Benchmarking the accuracy of ags.sh against MicrobeCensus: figure illustration. Plots of the Pearson’s correlation coefficients (upper panel) and absolute percentage error (APE) value distributions (lower panel) of the AGS computed by ags.sh and MicrobeCensus, with respect to the reference AGS. The comparisons were performed using the simulated metagenomes of different read length of the General, Infant Gut, and Marine datasets. For the sake of clarity, 70 outlier APE values (2.3% of the total data) were not included in the plot. (PDF 60 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="12859_2019_3031_MOESM6_ESM.xlsx">
            <label>Additional file 6:</label>
            <caption>
              <p>Benchmarking the accuracy of ags.sh against MicrobeCensus: summary statistics. Table showing the Medians, Means and Standard Deviations of the Average Percentage Error (i.e., MdAPE, MAPE, and SDAPE, respectively), and Pearson’s r correlation coefficients obtained in the analysis benchmarking the accuracy of ags.sh against MicrobeCensus. (XLSX 41 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM7">
          <media xlink:href="12859_2019_3031_MOESM7_ESM.xlsx">
            <label>Additional file 7:</label>
            <caption>
              <p>Evaluating the running time of acn.sh. Table showing the mean running time of acn.sh, and ags.sh plus acn.sh, using 4, 8, and 16 threads, for the estimation of the ACN in five TARA Oceans metagenomes subsampled to two million paired-end reads. (XLSX 35 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM8">
          <media xlink:href="12859_2019_3031_MOESM8_ESM.pdf">
            <label>Additional file 8:</label>
            <caption>
              <p>Benchmarking the accuracy of acn.sh against PICRUSt, CopyRighter, and PAPRICA: figure illustration. Plots of the Pearson’s correlation coefficient (upper panel) and the absolute percentage error (APE) value distributions (lower panel) of the ACN computed by acn.sh, PICRUSt, CopyRighter, and PAPRICA, with respect to the reference ACN. As mentioned above, we compared these tools using simulated metagenomes of different read length of the General, Infant Gut, and Marine datasets. For the sake of clarity, 100 outlier APE values (4.2% of the total data) were not included in the plot. (PDF 62 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM9">
          <media xlink:href="12859_2019_3031_MOESM9_ESM.xlsx">
            <label>Additional file 9:</label>
            <caption>
              <p>Benchmarking the accuracy of acn.sh against PICRUSt, CopyRighter, and PAPRICA: summary statistics. Table showing the Medians, Means and Standard Deviations of the Average Percentage Error (i.e., MdAPE, MAPE, and SDAPE, respectively), and Pearson’s r correlation coefficients obtained in the analysis benchmarking the accuracy of acn.sh against PICRUSt, CopyRighter, and PAPRICA. (XLSX 38 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM10">
          <media xlink:href="12859_2019_3031_MOESM10_ESM.xlsx">
            <label>Additional file 10:</label>
            <caption>
              <p>Comparing the AGS and ACN of TARA Oceans metagenomes between water layers. Table showing details of the Wilcoxon rank-sum tests, performed to evaluate the differentiation of TARA Oceans metagenomes from different water layers according to their AGS, and ACN. The comparisons were made on a matching subset of 63 metagenomes, obtained from the surface, deep chlorophyll maximum, and mesopelagic water layers (SRF, DCM, and MES, respectively), at 21 sampling sites. (XLSX 44 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM11">
          <media xlink:href="12859_2019_3031_MOESM11_ESM.xlsx">
            <label>Additional file 11:</label>
            <caption>
              <p>Exploring the variability of the AGS and ACN of TARA Oceans metagenomes. Table with details of the Pearson correlation tests between and among the AGS and ACN, and the functional and taxonomic richness of TARA Ocean metagenomes, and the water depth and temperature of the sampling sites. (XLSX 34 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>ACN</term>
        <def>
          <p id="Par4">16S rRNA gene Average Copy Number</p>
        </def>
      </def-item>
      <def-item>
        <term>AGS</term>
        <def>
          <p id="Par5">Average Genome Size</p>
        </def>
      </def-item>
      <def-item>
        <term>APE</term>
        <def>
          <p id="Par6">Absolute Percentage Error</p>
        </def>
      </def-item>
      <def-item>
        <term>DCM</term>
        <def>
          <p id="Par7">Deep Chlorophyll Maximum</p>
        </def>
      </def-item>
      <def-item>
        <term>MAGs</term>
        <def>
          <p id="Par8">Metagenome Assembled Genomes</p>
        </def>
      </def-item>
      <def-item>
        <term>MdAPEs</term>
        <def>
          <p id="Par9">Median of the Absolute Percentage Errors</p>
        </def>
      </def-item>
      <def-item>
        <term>MES</term>
        <def>
          <p id="Par10">Mesopelagic</p>
        </def>
      </def-item>
      <def-item>
        <term>NGs</term>
        <def>
          <p id="Par11">Number of Genomes</p>
        </def>
      </def-item>
      <def-item>
        <term>ORFs</term>
        <def>
          <p id="Par12">Open Reading Frames</p>
        </def>
      </def-item>
      <def-item>
        <term>OTUs</term>
        <def>
          <p id="Par13">Operational Taxonomic Units</p>
        </def>
      </def-item>
      <def-item>
        <term>SRF</term>
        <def>
          <p id="Par14">Surface</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>This work was accomplished using computational facilities provided by the Max Planck Society.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>EP-F wrote the software, performed the analyses and drafted the manuscript. EP-F and AF-G conceived and designed the experiments. FOG, AF-G, and EP-F discussed the results. All authors contributed to writing the manuscript and approved the final version.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>EP-F was supported by a Ph.D. fellowship of the German Academic Exchange Service (DAAD) and the Uruguayan National Research and Innovation Agency (ANII). AF-G received funding from the European Union’s Horizon 2020 research and innovation program [Blue Growth: Unlocking the potential of Seas and Oceans] under grant agreement no. [634486] 436 (project acronym INMARE). None of the funding bodies played a role in the design of the study, collection, analysis, and interpretation of data and in writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>ags.sh and acn.sh are free software distributed under the GNU General Public License v3.0. These tools are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/pereiramemo/AGS-and-ACN-tools">https://github.com/pereiramemo/AGS-and-ACN-tools</ext-link>, where we also provide their source code.</p>
    <p>In the Additional file <xref rid="MOESM2" ref-type="media">2</xref>, we provide the RefSeq (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/refseq/">https://www.ncbi.nlm.nih.gov/refseq</ext-link>) assembly accession number of the genome sequences used to simulate the metagenomic datasets.</p>
    <p>The metagenomic data analyzed here can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/ena">https://www.ebi.ac.uk/ena</ext-link> (study accession PRJEB1787).</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p id="Par83">Not applicable.</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p id="Par84">Not applicable.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par85">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gilbert</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Dupont</surname>
            <given-names>CL</given-names>
          </name>
        </person-group>
        <article-title>Microbial metagenomics: beyond the genome</article-title>
        <source>Annu Rev Mar Sci</source>
        <year>2011</year>
        <volume>3</volume>
        <fpage>347</fpage>
        <lpage>371</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-marine-120709-142811</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Violle</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Reich</surname>
            <given-names>PB</given-names>
          </name>
          <name>
            <surname>Pacala</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Enquist</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Kattge</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>The emergence and promise of functional biogeography</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2014</year>
        <volume>111</volume>
        <issue>38</issue>
        <fpage>13690</fpage>
        <lpage>13696</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1415442111</pub-id>
        <pub-id pub-id-type="pmid">25225414</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krause</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Le Roux</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Niklaus</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Van Bodegom</surname>
            <given-names>PM</given-names>
          </name>
          <name>
            <surname>Lennon</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Bertilsson</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Trait-based approaches for understanding microbial biodiversity and ecosystem functioning</article-title>
        <source>Front Microbiol</source>
        <year>2014</year>
        <volume>5</volume>
        <fpage>251</fpage>
        <pub-id pub-id-type="doi">10.3389/fmicb.2014.00251</pub-id>
        <pub-id pub-id-type="pmid">24904563</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martiny</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Lennon</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Martiny</surname>
            <given-names>AC</given-names>
          </name>
        </person-group>
        <article-title>Microbiomes in light of traits: a phylogenetic perspective</article-title>
        <source>Science</source>
        <year>2015</year>
        <volume>350</volume>
        <issue>6261</issue>
        <fpage>aac9323</fpage>
        <pub-id pub-id-type="doi">10.1126/science.aac9323</pub-id>
        <pub-id pub-id-type="pmid">26542581</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fierer</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Barberán</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Laughlin</surname>
            <given-names>DC</given-names>
          </name>
        </person-group>
        <article-title>Seeing the forest for the genes: using metagenomics to infer the aggregated traits of microbial communities</article-title>
        <source>Front Microbiol</source>
        <year>2014</year>
        <volume>5</volume>
        <fpage>614</fpage>
        <pub-id pub-id-type="doi">10.3389/fmicb.2014.00614</pub-id>
        <pub-id pub-id-type="pmid">25429288</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McGill</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Enquist</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Weiher</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Westoby</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Rebuilding community ecology from functional traits</article-title>
        <source>Trends Ecol Evol</source>
        <year>2006</year>
        <volume>21</volume>
        <issue>4</issue>
        <fpage>178</fpage>
        <lpage>185</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tree.2006.02.002</pub-id>
        <pub-id pub-id-type="pmid">16701083</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Raes</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Letunic</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Yamada</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Jensen</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Toward molecular trait-based ecology through integration of biogeochemical, geographical and metagenomic data</article-title>
        <source>Mol Syst Biol</source>
        <year>2011</year>
        <volume>7</volume>
        <fpage>473</fpage>
        <pub-id pub-id-type="doi">10.1038/msb.2011.6</pub-id>
        <pub-id pub-id-type="pmid">21407210</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barberán</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fernández-Guerra</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bohannan</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Casamayor</surname>
            <given-names>EO</given-names>
          </name>
        </person-group>
        <article-title>Exploration of community traits as ecological markers in microbial metagenomes</article-title>
        <source>Mol Ecol</source>
        <year>2012</year>
        <volume>21</volume>
        <issue>8</issue>
        <fpage>1909</fpage>
        <lpage>1917</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1365-294X.2011.05383.x</pub-id>
        <pub-id pub-id-type="pmid">22121910</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barberán</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ramirez</surname>
            <given-names>KS</given-names>
          </name>
          <name>
            <surname>Leff</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Bradford</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Wall</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Fierer</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Why are some microbes more ubiquitous than others? Predicting the habitat breadth of soil bacteria</article-title>
        <source>Ecol Lett</source>
        <year>2014</year>
        <volume>17</volume>
        <issue>7</issue>
        <fpage>794</fpage>
        <lpage>802</lpage>
        <pub-id pub-id-type="doi">10.1111/ele.12282</pub-id>
        <pub-id pub-id-type="pmid">24751288</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lauro</surname>
            <given-names>FM</given-names>
          </name>
          <name>
            <surname>McDougald</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Egan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rice</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The genomic basis of trophic strategy in marine bacteria</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2009</year>
        <volume>106</volume>
        <issue>37</issue>
        <fpage>15527</fpage>
        <lpage>15533</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0903507106</pub-id>
        <pub-id pub-id-type="pmid">19805210</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Walter</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ley</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>The human gut microbiome: ecology and recent evolutionary changes</article-title>
        <source>Annu Rev Microbiol</source>
        <year>2011</year>
        <volume>65</volume>
        <fpage>411</fpage>
        <lpage>429</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-micro-090110-102830</pub-id>
        <pub-id pub-id-type="pmid">21682646</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guieysse</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wuertz</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Metabolically versatile large-genome prokaryotes</article-title>
        <source>Curr Opin Biotechnol</source>
        <year>2012</year>
        <volume>23</volume>
        <issue>3</issue>
        <fpage>467</fpage>
        <lpage>473</lpage>
        <pub-id pub-id-type="doi">10.1016/j.copbio.2011.12.022</pub-id>
        <pub-id pub-id-type="pmid">22226959</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Beszteri</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Temperton</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Frickenhaus</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Giovannoni</surname>
            <given-names>SJ</given-names>
          </name>
        </person-group>
        <article-title>Average genome size: a potential source of bias in comparative metagenomics</article-title>
        <source>ISME J.</source>
        <year>2010</year>
        <volume>4</volume>
        <issue>8</issue>
        <fpage>1075</fpage>
        <lpage>1077</lpage>
        <pub-id pub-id-type="doi">10.1038/ismej.2010.29</pub-id>
        <pub-id pub-id-type="pmid">20336158</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">Royalty TM, Steen AD. Simulation-based approaches to characterize the effect of sequencing depth on the quantity and quality of metagenome-assembled genomes. bioRxiv. 2018. 10.1101/356840.</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rainey</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Ward-Rainey</surname>
            <given-names>NL</given-names>
          </name>
          <name>
            <surname>Janssen</surname>
            <given-names>PH</given-names>
          </name>
          <name>
            <surname>Hippe</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Stackebrandt</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Clostridium paradoxum DSM 7308(T) contains multiple 16S rRNA genes with heterogeneous intervening sequences</article-title>
        <source>Microbiology.</source>
        <year>1996</year>
        <volume>142</volume>
        <issue>8</issue>
        <fpage>2087</fpage>
        <lpage>2095</lpage>
        <pub-id pub-id-type="doi">10.1099/13500872-142-8-2087</pub-id>
        <pub-id pub-id-type="pmid">8760921</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roller</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Stoddard</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Schmidt</surname>
            <given-names>TM</given-names>
          </name>
        </person-group>
        <article-title>Exploiting rRNA operon copy number to investigate bacterial reproductive strategies</article-title>
        <source>Nat Microbiol</source>
        <year>2016</year>
        <volume>1</volume>
        <issue>11</issue>
        <fpage>16160</fpage>
        <pub-id pub-id-type="doi">10.1038/nmicrobiol.2016.160</pub-id>
        <pub-id pub-id-type="pmid">27617693</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vieira-Silva</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rocha</surname>
            <given-names>EP</given-names>
          </name>
        </person-group>
        <article-title>The systemic imprint of growth and its uses in ecological (meta)genomics</article-title>
        <source>PLoS Genet</source>
        <year>2010</year>
        <volume>6</volume>
        <issue>1</issue>
        <fpage>e1000808</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1000808</pub-id>
        <pub-id pub-id-type="pmid">20090831</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Klappenbach</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Dunbar</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schmidt</surname>
            <given-names>TM</given-names>
          </name>
        </person-group>
        <article-title>rRNA operon copy number reflects ecological strategies of bacteria</article-title>
        <source>Appl Environ Microbiol</source>
        <year>2000</year>
        <volume>66</volume>
        <issue>4</issue>
        <fpage>1328</fpage>
        <lpage>1333</lpage>
        <pub-id pub-id-type="doi">10.1128/AEM.66.4.1328-1333.2000</pub-id>
        <pub-id pub-id-type="pmid">10742207</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Angly</surname>
            <given-names>FE</given-names>
          </name>
          <name>
            <surname>Willner</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Prieto-Davó</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Edwards</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Schmieder</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Vega-Thurber</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The GAAS metagenomic tool and its estimations of viral and microbial average genome size in four major biomes</article-title>
        <source>PLoS Comput Biol</source>
        <year>2009</year>
        <volume>5</volume>
        <issue>12</issue>
        <fpage>e1000593</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1000593</pub-id>
        <pub-id pub-id-type="pmid">20011103</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nayfach</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pollard</surname>
            <given-names>KS</given-names>
          </name>
        </person-group>
        <article-title>Average genome size estimation improves comparative metagenomics and sheds light on the functional ecology of the human microbiome</article-title>
        <source>Genome Biol</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>51</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-015-0611-7</pub-id>
        <pub-id pub-id-type="pmid">25853934</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Camacho</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Coulouris</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Avagyan</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Papadopoulos</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bealer</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>BLAST+: architecture and applications</article-title>
        <source>BMC Bioinformatics</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>421</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-10-421</pub-id>
        <pub-id pub-id-type="pmid">20003500</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Raes</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Korbel</surname>
            <given-names>JO</given-names>
          </name>
          <name>
            <surname>Lercher</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Von Mering</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Prediction of effective genome size in metagenomic samples</article-title>
        <source>Genome Biol</source>
        <year>2007</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>R10</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2007-8-1-r10</pub-id>
        <pub-id pub-id-type="pmid">17224063</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langille</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>Zaneveld</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Caporaso</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>McDonald</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Knights</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Reyes</surname>
            <given-names>JA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Predictive functional profiling of microbial communities using 16S rRNA marker gene sequences</article-title>
        <source>Nat Biotechnol</source>
        <year>2013</year>
        <volume>31</volume>
        <issue>9</issue>
        <fpage>814</fpage>
        <lpage>821</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2676</pub-id>
        <pub-id pub-id-type="pmid">23975157</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Angly</surname>
            <given-names>FE</given-names>
          </name>
          <name>
            <surname>Dennis</surname>
            <given-names>PG</given-names>
          </name>
          <name>
            <surname>Skarshewski</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vanwonterghem</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Hugenholtz</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Tyson</surname>
            <given-names>GW</given-names>
          </name>
        </person-group>
        <article-title>CopyRighter: a rapid tool for improving the accuracy of microbial community profiles through lineage-specific gene copy number correction</article-title>
        <source>Microbiome.</source>
        <year>2014</year>
        <volume>2</volume>
        <fpage>11</fpage>
        <pub-id pub-id-type="doi">10.1186/2049-2618-2-11</pub-id>
        <pub-id pub-id-type="pmid">24708850</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bowman</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Ducklow</surname>
            <given-names>HW</given-names>
          </name>
        </person-group>
        <article-title>Microbial communities can be described by metabolic structure: a general framework and application to a seasonally variable, depth-stratified microbial community from the coastal West Antarctic peninsula</article-title>
        <source>PLoS One</source>
        <year>2015</year>
        <volume>10</volume>
        <issue>8</issue>
        <fpage>e0135868</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0135868</pub-id>
        <pub-id pub-id-type="pmid">26285202</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kembel</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Eisen</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>JL</given-names>
          </name>
        </person-group>
        <article-title>Incorporating 16S gene copy number information improves estimates of microbial diversity and abundance</article-title>
        <source>PLoS Comput Biol</source>
        <year>2012</year>
        <volume>8</volume>
        <issue>10</issue>
        <fpage>e1002743</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1002743</pub-id>
        <pub-id pub-id-type="pmid">23133348</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Louca</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Doebeli</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Parfrey</surname>
            <given-names>LW</given-names>
          </name>
        </person-group>
        <article-title>Correcting for 16S rRNA gene copy numbers in microbiome surveys remains an unsolved problem</article-title>
        <source>Microbiome.</source>
        <year>2018</year>
        <volume>6</volume>
        <issue>1</issue>
        <fpage>41</fpage>
        <pub-id pub-id-type="doi">10.1186/s40168-018-0420-9</pub-id>
        <pub-id pub-id-type="pmid">29482646</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sunagawa</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Coelho</surname>
            <given-names>LP</given-names>
          </name>
          <name>
            <surname>Chaffron</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kultima</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Labadie</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Salazar</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Structure and function of the global ocean microbiome</article-title>
        <source>Science.</source>
        <year>2015</year>
        <volume>348</volume>
        <issue>6237</issue>
        <fpage>1261359</fpage>
        <pub-id pub-id-type="doi">10.1126/science.1261359</pub-id>
        <pub-id pub-id-type="pmid">25999513</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Brian Bushnell. BBMap download | <ext-link ext-link-type="uri" xlink:href="http://sourceforge.net">SourceForge.net</ext-link>. <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/bbmap/">https://sourceforge.net/projects/bbmap/</ext-link>. Accessed 7 Jan 2019.</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">Kim D, Hahn AS, Wu SJ, Hanson NW, Konwar KM, Hallam SJ. FragGeneScan-plus for scalable high-throughput short-read open reading frame prediction. In: 2015 IEEE Conference on Computational Intelligence in Bioinformatics and Computational Biology (CIBCB); 2015 Aug 12-15. Niagara Falls: IEEE; 2015. p. 1–8. Available from: <ext-link ext-link-type="uri" xlink:href="http://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&amp;arnumber=7300341&amp;isnumber=7300268">http://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&amp;arnumber=7300341&amp;isnumber=7300268</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">unipept/FragGeneScanPlusPlus: Scalable high-throughput short-read open reading frame prediction. <ext-link ext-link-type="uri" xlink:href="https://github.com/unipept/FragGeneScanPlusPlus">https://github.com/unipept/FragGeneScanPlusPlus</ext-link>. Accessed 7 Jan 2019.</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meinicke</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>UProC: tools for ultra-fast protein domain classification</article-title>
        <source>Bioinformatics.</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>9</issue>
        <fpage>1382</fpage>
        <lpage>1388</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu843</pub-id>
        <pub-id pub-id-type="pmid">25540185</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huerta-Cepas</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Szklarczyk</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Forslund</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Cook</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Heller</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Walter</surname>
            <given-names>MC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>eggNOG 4.5: a hierarchical orthology framework with improved functional annotations for eukaryotic, prokaryotic and viral sequences</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <issue>D1</issue>
        <fpage>D286</fpage>
        <lpage>D293</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv1248</pub-id>
        <pub-id pub-id-type="pmid">26582926</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kopylova</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Noé</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Touzet</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>SortMeRNA: fast and accurate filtering of ribosomal RNAs in metatranscriptomic data</article-title>
        <source>Bioinformatics.</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>24</issue>
        <fpage>3211</fpage>
        <lpage>3217</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts611</pub-id>
        <pub-id pub-id-type="pmid">23071270</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harrison</surname>
            <given-names>PW</given-names>
          </name>
          <name>
            <surname>Alako</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Amid</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Cerdeño-Tárraga</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cleland</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Holt</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The European nucleotide archive in 2018</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <issue>D1</issue>
        <fpage>D84</fpage>
        <lpage>D88</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky1078</pub-id>
        <pub-id pub-id-type="pmid">30395270</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rognes</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Flouri</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Nichols</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Quince</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Mahé</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>VSEARCH: a versatile open source tool for metagenomics</article-title>
        <source>PeerJ.</source>
        <year>2016</year>
        <volume>4</volume>
        <fpage>e2584</fpage>
        <pub-id pub-id-type="doi">10.7717/peerj.2584</pub-id>
        <pub-id pub-id-type="pmid">27781170</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <mixed-citation publication-type="other">Oksanen J, Blanchet FG, Friendly M, Kindt R, Legendre P, Mcglinn D, et al. Vegan: community ecology package. 2017. R package version 2.4–5. <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=vegan">https://CRAN.R-project.org/package=vegan</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’Leary</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Brister</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Ciufo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Haddad</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>McVeigh</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reference sequence (RefSeq) database at NCBI: current status, taxonomic expansion, and functional annotation</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <issue>D1</issue>
        <fpage>D733</fpage>
        <lpage>D745</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv1189</pub-id>
        <pub-id pub-id-type="pmid">26553804</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sharon</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Morowitz</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>BC</given-names>
          </name>
          <name>
            <surname>Costello</surname>
            <given-names>EK</given-names>
          </name>
          <name>
            <surname>Relman</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Banfield</surname>
            <given-names>JF</given-names>
          </name>
        </person-group>
        <article-title>Time series community genomics analysis reveals rapid shifts in bacterial species, strains, and phage during infant gut colonization</article-title>
        <source>Genome Res</source>
        <year>2013</year>
        <volume>23</volume>
        <issue>1</issue>
        <fpage>111</fpage>
        <lpage>120</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.142315.112</pub-id>
        <pub-id pub-id-type="pmid">22936250</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Richter</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Ott</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Auch</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Schmid</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Huson</surname>
            <given-names>DH</given-names>
          </name>
        </person-group>
        <article-title>MetaSim: a sequencing simulator for genomics and metagenomics</article-title>
        <source>PLoS One</source>
        <year>2008</year>
        <volume>3</volume>
        <issue>10</issue>
        <fpage>e3373</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0003373</pub-id>
        <pub-id pub-id-type="pmid">18841204</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quince</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Walker</surname>
            <given-names>AW</given-names>
          </name>
          <name>
            <surname>Simpson</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Loman</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Segata</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Shotgun metagenomics, from sampling to analysis</article-title>
        <source>Nat Biotechnol</source>
        <year>2017</year>
        <volume>35</volume>
        <issue>9</issue>
        <fpage>833</fpage>
        <lpage>844</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3935</pub-id>
        <pub-id pub-id-type="pmid">28898207</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <mixed-citation publication-type="other">lh3/seqtk: Toolkit for processing sequences in FASTA/Q formats. <ext-link ext-link-type="uri" xlink:href="https://github.com/lh3/seqtk">https://github.com/lh3/seqtk</ext-link>. Accessed 7 Jan 2019.</mixed-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McDonald</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Price</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Goodrich</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Nawrocki</surname>
            <given-names>EP</given-names>
          </name>
          <name>
            <surname>Desantis</surname>
            <given-names>TZ</given-names>
          </name>
          <name>
            <surname>Probst</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An improved Greengenes taxonomy with explicit ranks for ecological and evolutionary analyses of bacteria and archaea</article-title>
        <source>ISME J</source>
        <year>2012</year>
        <volume>6</volume>
        <issue>3</issue>
        <fpage>610</fpage>
        <lpage>618</lpage>
        <pub-id pub-id-type="doi">10.1038/ismej.2011.139</pub-id>
        <pub-id pub-id-type="pmid">22134646</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <mixed-citation publication-type="other">fangly/AmpliCopyrighter: CopyRighter. <ext-link ext-link-type="uri" xlink:href="https://github.com/fangly/AmpliCopyrighter">https://github.com/fangly/AmpliCopyrighter</ext-link>. Accessed 10 May 2019.</mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <mixed-citation publication-type="other">PICRUSt 1.1.3 documentation. <ext-link ext-link-type="uri" xlink:href="https://picrust.github.io/picrust/picrust_precalculated_files.html#greengenes-v13-5-and-img-4">https://picrust.github.io/picrust/picrust_precalculated_files.html#greengenes-v13-5-and-img-4</ext-link>. Accessed 10 May 2019.</mixed-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rho</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ye</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>FragGeneScan: predicting genes in short and error-prone reads</article-title>
        <source>Nucleic Acids Res</source>
        <year>2010</year>
        <volume>38</volume>
        <issue>20</issue>
        <fpage>e191</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkq747</pub-id>
        <pub-id pub-id-type="pmid">20805240</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lauro</surname>
            <given-names>FM</given-names>
          </name>
          <name>
            <surname>Bartlett</surname>
            <given-names>DH</given-names>
          </name>
        </person-group>
        <article-title>Prokaryotic lifestyles in deep sea habitats</article-title>
        <source>Extremophiles.</source>
        <year>2008</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>15</fpage>
        <lpage>25</lpage>
        <pub-id pub-id-type="doi">10.1007/s00792-006-0059-5</pub-id>
        <pub-id pub-id-type="pmid">17225926</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Konstantinidis</surname>
            <given-names>KT</given-names>
          </name>
          <name>
            <surname>Braff</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Karl</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>DeLong</surname>
            <given-names>EF</given-names>
          </name>
        </person-group>
        <article-title>Comparative metagenomic analysis of a microbial community residing at a depth of 4,000 meters at station ALOHA in the North Pacific subtropical gyre</article-title>
        <source>Appl Environ Microbiol</source>
        <year>2009</year>
        <volume>75</volume>
        <issue>16</issue>
        <fpage>5345</fpage>
        <lpage>5355</lpage>
        <pub-id pub-id-type="doi">10.1128/AEM.00473-09</pub-id>
        <pub-id pub-id-type="pmid">19542347</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stoddard</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Hein</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Roller</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Schmidt</surname>
            <given-names>TM</given-names>
          </name>
        </person-group>
        <article-title>rrnDB: improved tools for interpreting rRNA gene abundance in bacteria and archaea and a new foundation for future development</article-title>
        <source>Nucleic Acids Res</source>
        <year>2015</year>
        <volume>43</volume>
        <issue>D1</issue>
        <fpage>D593</fpage>
        <lpage>D598</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gku1201</pub-id>
        <pub-id pub-id-type="pmid">25414355</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hou</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Distinct gene number-genome size relationships for eukaryotes and non-eukaryotes: gene content estimation for dinoflagellate genomes</article-title>
        <source>PLoS One</source>
        <year>2009</year>
        <volume>4</volume>
        <issue>9</issue>
        <fpage>e6978</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0006978</pub-id>
        <pub-id pub-id-type="pmid">19750009</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Verster</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Borenstein</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Competitive lottery-based assembly of selected clades in the human gut microbiome</article-title>
        <source>Microbiome.</source>
        <year>2018</year>
        <volume>6</volume>
        <issue>1</issue>
        <fpage>186</fpage>
        <pub-id pub-id-type="doi">10.1186/s40168-018-0571-8</pub-id>
        <pub-id pub-id-type="pmid">30340536</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stocker</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Marine microbes see a sea of gradients</article-title>
        <source>Science.</source>
        <year>2012</year>
        <volume>338</volume>
        <issue>6107</issue>
        <fpage>628</fpage>
        <lpage>633</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1208929</pub-id>
        <pub-id pub-id-type="pmid">23118182</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>López-Pérez</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gonzaga</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Martin-Cuadrado</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Onyshchenko</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Ghavidel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ghai</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genomes of surface isolates of Alteromonas macleodii: the life of a widespread marine opportunistic copiotroph</article-title>
        <source>Sci Rep</source>
        <year>2012</year>
        <volume>2</volume>
        <fpage>696</fpage>
        <pub-id pub-id-type="doi">10.1038/srep00696</pub-id>
        <pub-id pub-id-type="pmid">23019517</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bentkowski</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Van Oosterhout</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Mock</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>A model of genome size evolution for prokaryotes in stable and fluctuating environments</article-title>
        <source>Genome Biol Evol</source>
        <year>2015</year>
        <volume>7</volume>
        <issue>8</issue>
        <fpage>2344</fpage>
        <lpage>2351</lpage>
        <pub-id pub-id-type="doi">10.1093/gbe/evv148</pub-id>
        <pub-id pub-id-type="pmid">26242601</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Violle</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Enquist</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>McGill</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Albert</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Hulshof</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The return of the variance: intraspecific variability in community ecology</article-title>
        <source>Trends Ecol Evol</source>
        <year>2012</year>
        <volume>27</volume>
        <issue>4</issue>
        <fpage>244</fpage>
        <lpage>252</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tree.2011.11.014</pub-id>
        <pub-id pub-id-type="pmid">22244797</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
