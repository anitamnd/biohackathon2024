<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10159649</article-id>
    <article-id pub-id-type="pmid">37079739</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad260</article-id>
    <article-id pub-id-type="publisher-id">btad260</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Structural Bioinformatics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>RING-PyMOL: residue interaction networks of structural ensembles and molecular dynamics</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Del Conte</surname>
          <given-names>Alessio</given-names>
        </name>
        <aff><institution>Department of Biomedical Sciences, University of Padua</institution>, Padova 35121, <country country="IT">Italy</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-0362-8218</contrib-id>
        <name>
          <surname>Monzon</surname>
          <given-names>Alexander Miguel</given-names>
        </name>
        <aff><institution>Department of Information Engineering, University of Padua</institution>, Padova 35121, <country country="IT">Italy</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Clementel</surname>
          <given-names>Damiano</given-names>
        </name>
        <aff><institution>Department of Biomedical Sciences, University of Padua</institution>, Padova 35121, <country country="IT">Italy</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Camagni</surname>
          <given-names>Giorgia F</given-names>
        </name>
        <aff><institution>Department of Biomedical Sciences, University of Padua</institution>, Padova 35121, <country country="IT">Italy</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7013-5785</contrib-id>
        <name>
          <surname>Minervini</surname>
          <given-names>Giovanni</given-names>
        </name>
        <aff><institution>Department of Biomedical Sciences, University of Padua</institution>, Padova 35121, <country country="IT">Italy</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4525-7793</contrib-id>
        <name>
          <surname>Tosatto</surname>
          <given-names>Silvio C E</given-names>
        </name>
        <aff><institution>Department of Biomedical Sciences, University of Padua</institution>, Padova 35121, <country country="IT">Italy</country></aff>
        <xref rid="btad260-cor1" ref-type="corresp"/>
        <!--silvio.tosatto@unipd.it-->
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8210-2390</contrib-id>
        <name>
          <surname>Piovesan</surname>
          <given-names>Damiano</given-names>
        </name>
        <aff><institution>Department of Biomedical Sciences, University of Padua</institution>, Padova 35121, <country country="IT">Italy</country></aff>
        <xref rid="btad260-cor1" ref-type="corresp"/>
        <!--damiano.piovesan@unipd.it-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Cowen</surname>
          <given-names>Lenore</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad260-cor1">Corresponding authors. Silvio C E Tosatto, Department of Biomedical Sciences, University of Padua, Padova, 35121, Italy. E-mail: <email>silvio.tosatto@unipd.it</email>; Damiano Piovesan, Department of Biomedical Sciences, University of Padua, Padova, 35121, Italy. E-mail: <email>damiano.piovesan@unipd.it</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-04-20">
      <day>20</day>
      <month>4</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>20</day>
      <month>4</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>5</issue>
    <elocation-id>btad260</elocation-id>
    <history>
      <date date-type="received">
        <day>26</day>
        <month>10</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>21</day>
        <month>3</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>17</day>
        <month>4</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>17</day>
        <month>4</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>04</day>
        <month>5</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad260.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title> </title>
        <p>RING-PyMOL is a plugin for PyMOL providing a set of analysis tools for structural ensembles and molecular dynamic simulations. RING-PyMOL combines residue interaction networks, as provided by the RING software, with structural clustering to enhance the analysis and visualization of the conformational complexity. It combines precise calculation of non-covalent interactions with the power of PyMOL to manipulate and visualize protein structures. The plugin identifies and highlights correlating contacts and interaction patterns that can explain structural allostery, active sites, and structural heterogeneity connected with molecular function. It is easy to use and extremely fast, processing and rendering hundreds of models and long trajectories in seconds. RING-PyMOL generates a number of interactive plots and output files for use with external tools. The underlying RING software has been improved extensively. It is 10 times faster, can process mmCIF files and it identifies typed interactions also for nucleic acids.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>
          <ext-link xlink:href="https://github.com/BioComputingUP/ring-pymol" ext-link-type="uri">https://github.com/BioComputingUP/ring-pymol</ext-link>
        </p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Union’s Horizon 2020 research and innovation program</institution>
          </institution-wrap>
        </funding-source>
        <award-id>778247</award-id>
        <award-id>823886</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Non-covalent interactions are responsible for the conformational stability and molecular function of biological polymers. The analysis of interaction patterns and their dynamics provides the ground to study the function of proteins (<xref rid="btad260-B7" ref-type="bibr">del Sol et al. 2006</xref>). Despite their importance, identifying relevant interactions from atomic coordinates is not trivial.</p>
    <p>The analytical calculation of structure energy to detect non-covalent interactions is impractical; in particular when analyzing conformations in large structural ensembles or long molecular dynamics (MD). An efficient solution is to detect interactions based on geometrical rules which approximate experimental observation. The residue interaction networks (RINs) generated adopting this approach have been effectively used to analyze protein dynamics and allosteric regulation, for a recent review, see <xref rid="btad260-B2" ref-type="bibr">Liang et al. (2020</xref>).</p>
    <p>An example of software for an efficient calculation of RINs is RING (<xref rid="btad260-B3" ref-type="bibr">Martin et al. 2011</xref>; <xref rid="btad260-B4" ref-type="bibr">Piovesan et al. 2016</xref>; <xref rid="btad260-B1" ref-type="bibr">Clementel et al. 2022</xref>). RING infers contacts and their type (hydrogen bond, ionic bond, π–π stack, etc.) based on a set of simple rules, and it has been recently updated in order to process multi-state structures. A number of other tools can efficiently calculate and analyze protein interactions in multi-state structures (<xref rid="btad260-B6" ref-type="bibr">Sladek et al. 2021</xref>; <xref rid="btad260-B8" ref-type="bibr">Song et al. 2022</xref>); however, only few allow to visualize the full set of interactions in a structure viewer and none of them is integrated into PyMOL (<xref rid="btad260-B5" ref-type="bibr">Schrödinger, LLC, 2015</xref>). Natively, PyMOL is not designed to analyze MD simulations and only a handful of plugins have been designed to process that type of data. For example, PyProGA (<xref rid="btad260-B6" ref-type="bibr">Sladek et al. 2021</xref>) calculates RINs to identify conformational relationships in dynamic structures exploiting graph mathematics, however, compared to RING, the calculated contacts do not reflect physical principles. Both RING and PyProGA do not show calculated interactions in the structure. PyMOL natively can detect polar (hydrogen bonds) and π–π/π–cation interactions; however, ionic and van Der Waals are missing and the π interactions are imprecise. Moreover, the calculation is performed internally, i.e. it is not accessible via the public API, therefore making it difficult to implement additional calculation without modifying the source code.</p>
    <p>Here we present RING-PyMOL, a PyMOL plugin implemented in Python that wraps the RING program (<xref rid="btad260-B1" ref-type="bibr">Clementel et al. 2022</xref>) and implements additional components to visualize and analyze non-covalent interactions in both single- and multi-state structures. RING-PyMOL combines high-quality non-covalent interactions as provided by RING, with the power of PyMOL to manipulate and visualize protein structures. For multi-state structures, featured RING-PyMOL calculations include RMSD-based clustering and interaction correlations.</p>
    <p>The plugin can generate the network either using a local instance of the RING executable or directly querying the RING webserver (<xref rid="btad260-B1" ref-type="bibr">Clementel et al. 2022</xref>). The RING executable can be freely downloaded from the URL <ext-link xlink:href="https://biocomputingup.it/download" ext-link-type="uri">https://biocomputingup.it/download</ext-link>. The RING-PyMOL plugin is available at URL <ext-link xlink:href="https://github.com/BioComputingUP/ring-pymol" ext-link-type="uri">https://github.com/BioComputingUP/ring-pymol</ext-link>.</p>
  </sec>
  <sec>
    <title>2 Implementation</title>
    <p>The RING-PyMOL plugin has a graphical user interface to interact with the PyMOL environment and depends on the RING executable and few standard Python libraries (Pmw, Qt-Material, BioPython, Networkx, Pandas, Seaborn, Scipy, and Numpy).</p>
    <p>RING-PyMOL is installed as any other PyMOL plugins by importing the package file or the package folder or just providing the repository link. Interactions are rendered as Compiled Graphics Objects which, since based on OpenGL, is very fast and lightweight, allowing to visualize contacts in structures of any size and number of states seamlessly.</p>
    <p>The external RING component has been improved extensively (<xref rid="btad260-B1" ref-type="bibr">Clementel et al. 2022</xref>). It is now easier to install, it does not require setting environment variables, and the source code has been updated to the C++17 standard. RING now provides typed interactions also for nucleic acid in addition to amino acids and can process mmCIF files natively. The RING algorithm has been optimized and it is about 10 times faster. However, the greatest improvement is that it can now process ensemble conformations (i.e. NMR structure with multiple models) and MD. Multi-state structure analyses are based on the calculation of probabilistic networks and time-dependent network trajectories.</p>
    <sec>
      <title>2.1 Single-state structures</title>
      <p>When working with a single-state structure, e.g. X-ray structure, RING-PyMOL executes RING and immediately shows non-covalent intra- and inter-molecular interactions as lines connecting atoms. The visualization is managed directly at the PyMOL level. In the menu panel, calculated interactions and participating nodes are available as object groups, one for the edges and another for the residues involved in the interaction; different objects correspond to different types of interaction. The plugin allows to modify edge visualization (color, width, and transparency), select intra- or inter-chain interactions and generates a number of helper plots to visualize chain–chain interactions and secondary structure connectivity.</p>
    </sec>
    <sec>
      <title>2.2 MD simulations and structural ensembles</title>
      <p>RING-PyMOL offers its greatest power when used with structural ensembles and MD simulations. Multi-state analyses include: (i) visualization of interactions frequencies; (ii) probabilistic contact maps; (iii) contacts correlation statistics; and (iv) structure-based hierarchical clustering. Interaction frequencies are useful to highlight dynamic contacts and to filter out stable contacts, i.e. those not changing over time or across conformations. The probabilistic contact maps are useful to visualize global rearrangements and identify dynamic subregions. Contact correlations (Pearson’s correlation coefficient) are computed on a matrix where the columns represent the states and rows are the number of contacts for each position in the sequence. The statistics can be calculated either considering all interactions or specifically for a single interaction type. Contact correlations are also listed in an interactive table which can be used to focus on subsets of interactions and identify stable (or transient) interactions and pairs of correlating (or anti-correlating) contacts, e.g. those involved in allosteric communication. The hierarchical clustering is useful to reduce the states without losing important information, e.g. when analyzing long MD simulations (<xref rid="btad260-F1" ref-type="fig">Fig. 1</xref>). The clustering is calculated on an all-versus-all root-mean-square deviation (RMSD) matrix obtained after superimposing all the conformations with the Bio.PDB.Superimposer module of BioPython. The structure hierarchy is provided as a dendrogram while cluster assignments are plotted in a heatmap to visualize conformational transitions along the simulation. Representative conformations are stored in standard PyMOL structure objects and can be used as a starting point for further analyses.</p>
      <fig position="float" id="btad260-F1">
        <label>Figure 1.</label>
        <caption>
          <p>RING-PyMOL analysis of a MD simulation. Snapshots have been derived from a simulation of the STIM1 protein (PDB 2K60) run for 100 ns and sampled every 0.8 ns generating 125 states. (A) Cluster assignments for all states. Different colors represent different clusters. The yellow layout indicates those states shown in (B). The legend indicates the states selected as clusters representatives. (B) RMSD-based structural hierarchy visualized as a dendrogram. The clustering, using default parameters and 2.5 Å cutoff, generated 16 different clusters. The dashed line indicates the cutoff (5.5 Å) used to select the representative conformations shown in (C). (C) Patterns of π–π and π–cation interactions in the selected conformations. Interacting residues are displayed as sticks and colored by element, different states show different contact patterns.</p>
        </caption>
        <graphic xlink:href="btad260f1" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>3 Summary</title>
    <p>We implemented RING-PyMOL to easily visualize non-covalent interaction patterns in multi-state structures and molecular dynamic trajectories directly in the PyMOL viewer. Contact correlations, structural clustering in relation to time can highlight significant conformational rearrangements, and identify key residues, functional sites, and allosteric communication pathways.</p>
  </sec>
</body>
<back>
  <sec>
    <title>Funding</title>
    <p>RING-PyMOL is a service of the Italian node of ELIXIR. This project received funding from the European Union’s Horizon 2020 research and innovation program [778247, 823886].</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad260-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Clementel</surname><given-names>D</given-names></string-name>, <string-name><surname>Del Conte</surname><given-names>A</given-names></string-name>, <string-name><surname>Monzon</surname><given-names>AM</given-names></string-name></person-group> et al <article-title>RING 3.0: fast generation of probabilistic residue interaction networks from structural ensembles</article-title>. <source>Nucleic Acids Res</source><year>2022</year>;<volume>50</volume>:W651–6.</mixed-citation>
    </ref>
    <ref id="btad260-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liang</surname><given-names>Z</given-names></string-name>, <string-name><surname>Verkhivker</surname><given-names>GM</given-names></string-name>, <string-name><surname>Hu</surname><given-names>G</given-names></string-name></person-group> et al <article-title>Integration of network models and evolutionary analysis into high-throughput modeling of protein dynamics and allosteric regulation: theory, tools and applications</article-title>. <source>Brief Bioinform</source><year>2020</year>:<volume>21</volume>:<fpage>815</fpage>–<lpage>35</lpage>.<pub-id pub-id-type="pmid">30911759</pub-id></mixed-citation>
    </ref>
    <ref id="btad260-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Martin</surname><given-names>AJM</given-names></string-name>, <string-name><surname>Vidotto</surname><given-names>M</given-names></string-name>, <string-name><surname>Boscariol</surname><given-names>F</given-names></string-name></person-group> et al <article-title>RING: networking interacting residues, evolutionary information and energetics in protein structures</article-title>. <source>Bioinformatics</source><year>2011</year>;<volume>27</volume>:<fpage>2003</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">21493660</pub-id></mixed-citation>
    </ref>
    <ref id="btad260-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Piovesan</surname><given-names>D</given-names></string-name>, <string-name><surname>Minervini</surname><given-names>G</given-names></string-name>, <string-name><surname>Tosatto</surname><given-names>SCE</given-names></string-name></person-group> et al <article-title>The RING 2.0 web server for high quality residue interaction networks</article-title>. <source>Nucleic Acids Res</source><year>2016</year>;<volume>44</volume>:W367–74.</mixed-citation>
    </ref>
    <ref id="btad260-B5">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Schrödinger</surname><given-names>LLC.</given-names></string-name></person-group> (<year>2015</year>) The PyMOL molecular graphics system, version 2.5.</mixed-citation>
    </ref>
    <ref id="btad260-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sladek</surname><given-names>V</given-names></string-name>, <string-name><surname>Yamamoto</surname><given-names>Y</given-names></string-name>, <string-name><surname>Harada</surname><given-names>R</given-names></string-name></person-group> et al <article-title>pyProGA—a PyMOL plugin for protein residue network analysis</article-title>. <source>PLoS One</source><year>2021</year>;<volume>16</volume>:<fpage>e0255167</fpage>.<pub-id pub-id-type="pmid">34329304</pub-id></mixed-citation>
    </ref>
    <ref id="btad260-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>del Sol</surname><given-names>A</given-names></string-name>, <string-name><surname>Fujihashi</surname><given-names>H</given-names></string-name>, <string-name><surname>Amoros</surname><given-names>D</given-names></string-name></person-group> et al <article-title>Residues crucial for maintaining short paths in network communication mediate signaling in proteins</article-title>. <source>Mol Syst Biol</source><year>2006</year>;<volume>2</volume>:2006.0019.</mixed-citation>
    </ref>
    <ref id="btad260-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Song</surname><given-names>W</given-names></string-name>, <string-name><surname>Corey</surname><given-names>RA</given-names></string-name>, <string-name><surname>Ansell</surname><given-names>TB</given-names></string-name></person-group> et al <article-title>PyLipID: a python package for analysis of protein–lipid interactions from molecular dynamics simulations</article-title>. <source>J Chem Theory Comput</source><year>2022</year>;<volume>18</volume>:<fpage>1188</fpage>–<lpage>201</lpage>.<pub-id pub-id-type="pmid">35020380</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
