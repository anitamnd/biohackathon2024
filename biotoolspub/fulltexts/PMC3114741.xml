<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3114741</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-12-124</article-id>
    <article-id pub-id-type="pmid">21526987</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-12-124</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><monospace>Proteinortho</monospace>: Detection of (Co-)orthologs in large-scale analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes" id="A1">
        <name>
          <surname>Lechner</surname>
          <given-names>Marcus</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>lechner@staff.uni-marburg.de</email>
      </contrib>
      <contrib contrib-type="author" id="A2">
        <name>
          <surname>Findeiß</surname>
          <given-names>Sven</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <xref ref-type="aff" rid="I4">4</xref>
        <email>sven@bioinf.uni-leipzig.de</email>
      </contrib>
      <contrib contrib-type="author" id="A3">
        <name>
          <surname>Steiner</surname>
          <given-names>Lydia</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <xref ref-type="aff" rid="I3">3</xref>
        <xref ref-type="aff" rid="I4">4</xref>
        <email>lydia@bioinf.uni-leipzig.de</email>
      </contrib>
      <contrib contrib-type="author" id="A4">
        <name>
          <surname>Marz</surname>
          <given-names>Manja</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>manja@staff.uni-marburg.de</email>
      </contrib>
      <contrib contrib-type="author" id="A5">
        <name>
          <surname>Stadler</surname>
          <given-names>Peter F</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <xref ref-type="aff" rid="I4">4</xref>
        <xref ref-type="aff" rid="I5">5</xref>
        <xref ref-type="aff" rid="I6">6</xref>
        <xref ref-type="aff" rid="I7">7</xref>
        <xref ref-type="aff" rid="I8">8</xref>
        <xref ref-type="aff" rid="I9">9</xref>
        <email>studla@bioinf.uni-leipzig.de</email>
      </contrib>
      <contrib contrib-type="author" id="A6">
        <name>
          <surname>Prohaska</surname>
          <given-names>Sonja J</given-names>
        </name>
        <xref ref-type="aff" rid="I3">3</xref>
        <xref ref-type="aff" rid="I4">4</xref>
        <email>sonja@bioinf.uni-leipzig.de</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>RNA Bioinformatics Group, Department of Pharmaceutical Chemistry, Philipps-University Marburg, Marbacher Weg 6, D-35037 Marburg, Germany</aff>
    <aff id="I2"><label>2</label>Bioinformatics Group, Department of Computer Science, Härtelstraße 16-18, D-04107, Leipzig, Germany</aff>
    <aff id="I3"><label>3</label>Bioinformatics in EvoDevo Group, Department of Computer Science, University of Leipzig, Härtelstraße 16-18, D-04107, Leipzig, Germany</aff>
    <aff id="I4"><label>4</label>Interdisciplinary Center for Bioinformatics, University of Leipzig, Härtelstraße 16-18, D-04107, Leipzig, Germany</aff>
    <aff id="I5"><label>5</label>Max Planck Institute for Mathematics in the Sciences, Inselstraße 22 D-04103 Leipzig, Germany</aff>
    <aff id="I6"><label>6</label>Fraunhofer Institute for Cell Therapy and Immunology, Perlickstraße 1, D-04103 Leipzig, Germany</aff>
    <aff id="I7"><label>7</label>Institute for Theoretical Chemistry, University of Vienna, Währingerstraße 17, A-1090 Wien, Austria</aff>
    <aff id="I8"><label>8</label>Center for non-coding RNA in Technology and Health, University of Copenhagen, Grønnegårdsvej 3, DK-1870 Frederiksberg C, Denmark</aff>
    <aff id="I9"><label>9</label>Santa Fe Institute, 1399 Hyde Park Rd, Santa Fe, NM 87501, USA</aff>
    <pub-date pub-type="collection">
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>28</day>
      <month>4</month>
      <year>2011</year>
    </pub-date>
    <volume>12</volume>
    <fpage>124</fpage>
    <lpage>124</lpage>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>12</month>
        <year>2010</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>4</month>
        <year>2011</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright ©2011 Lechner et al; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2011</copyright-year>
      <copyright-holder>Lechner et al; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://www.biomedcentral.com/1471-2105/12/124"/>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Orthology analysis is an important part of data analysis in many areas of bioinformatics such as comparative genomics and molecular phylogenetics. The ever-increasing flood of sequence data, and hence the rapidly increasing number of genomes that can be compared simultaneously, calls for efficient software tools as brute-force approaches with quadratic memory requirements become infeasible in practise. The rapid pace at which new data become available, furthermore, makes it desirable to compute genome-wide orthology relations for a given dataset rather than relying on relations listed in databases.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>The program <monospace>Proteinortho</monospace> described here is a stand-alone tool that is geared towards large datasets and makes use of distributed computing techniques when run on multi-core hardware. It implements an extended version of the reciprocal best alignment heuristic. We apply <monospace>Proteinortho</monospace> to compute orthologous proteins in the complete set of all 717 eubacterial genomes available at NCBI at the beginning of 2009. We identified thirty proteins present in 99% of all bacterial proteomes.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p><monospace>Proteinortho</monospace> significantly reduces the required amount of memory for orthology analysis compared to existing tools, allowing such computations to be performed on off-the-shelf hardware.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Genome annotation largely depends on the determination of sequence intervals that are homologous, and if possible, orthologous to sequences of known identity and function in related genomes. Orthologous genes (orthologs) are derived from a common ancestor by a speciation event [<xref ref-type="bibr" rid="B1">1</xref>]. Orthologs are of particular interest because they can be expected to have maintained at least part of their (ancestral) biological function. For protein-coding genes, several well-known databases, including <monospace>InParanoid</monospace>[<xref ref-type="bibr" rid="B2">2</xref>], <monospace>OrthoMCL-DB</monospace>[<xref ref-type="bibr" rid="B3">3</xref>], <monospace>COG-database</monospace>[<xref ref-type="bibr" rid="B4">4</xref>], <monospace>Homogene</monospace>[<xref ref-type="bibr" rid="B5">5</xref>], <monospace>eggNOG</monospace>[<xref ref-type="bibr" rid="B6">6</xref>], <monospace>OMA Browser</monospace>[<xref ref-type="bibr" rid="B7">7</xref>] and <monospace>Ensembl Compara</monospace>[<xref ref-type="bibr" rid="B8">8</xref>] compile such information. Their content is restricted to data <italic>previously </italic>published in comprehensive databases of protein sequences such as <monospace>UniProt</monospace>[<xref ref-type="bibr" rid="B9">9</xref>]. Updates with additional proteomic data thus are published relatively infrequently. Modern high-throughput technologies, however, produce huge amounts of protein data and even larger amounts of transcript data that are computationally translated to putative polypeptide sequences. Oftentimes, therefore, it would be desirable to generate the orthology relation for a particular dataset, so that the availability of orthology data does not limit the set of species or genes that can be included.</p>
    <p>The computation of genome-wide orthology data, however, is a challenging and time consuming task with the currently available tools. In many cases, orthologs cannot be identified unambiguously by means of sequence comparison. The main difficulty arises from the presence of paralogs (homologous genes within the same genome) which can make it very difficult to recognize the correct ortholog among the other homologs. Gene duplications following the speciation, furthermore, create two or more genes in one lineage that are, collectively, orthologous to one or more genes in another lineage. Such genes are known as co-orthologs [<xref ref-type="bibr" rid="B10">10</xref>].</p>
    <p>The most widely used approach to identify (putative) orthologs between two species is the <italic>reciprocal best alignment heuristic </italic>[<xref ref-type="bibr" rid="B11">11</xref>-<xref ref-type="bibr" rid="B15">15</xref>]. <italic>This approach </italic>was more recently extended e.g. in <monospace>OrthoMCL</monospace>[<xref ref-type="bibr" rid="B16">16</xref>] and <monospace>MultiParanoid</monospace>[<xref ref-type="bibr" rid="B17">17</xref>] to detect (co-)orthologs within multiple species. All these tools, however, are limited to relatively small sets of species. In practise, analyzing the complete proteomes of more than about 50 prokaryote species goes beyond the capabilities of standard hardware and requires access to supercomputer resources. This limitation arises from both, technical issues such as insufficient parallelization and the algorithmic design that requires all reasonable alignments for each input protein to be held in the memory for efficient access in the clustering stage. <monospace>Proteinortho</monospace> is specifically designed to deal with hundreds of species together containing millions of proteins. It achieves this performance both by optimizing the implementation and by modifying the reciprocal best alignment method in a way that allows alignment processing on the fly.</p>
  </sec>
  <sec>
    <title>Results and Discussion</title>
    <sec>
      <title>Orthology prediction</title>
      <sec>
        <title>Theory</title>
        <p>As for other approaches to large-scale orthology detection, the starting point is a complete collection of pairwise comparisons, typically performed using <monospace>blast</monospace>. For simplicity of presentation, we assume that the individual sequences that are compared represent proteins, although algorithms and pipelines are applicable also to other sequence data such as non-coding RNA genes or conserved DNA regions. Typically, the results of pairwise comparisons are ranked by similarity, for instance based on <monospace>blast</monospace> statistics, evolutionary distances, or genome rearrangement analysis [<xref ref-type="bibr" rid="B7">7</xref>,<xref ref-type="bibr" rid="B16">16</xref>,<xref ref-type="bibr" rid="B18">18</xref>]. High-ranking alignments across multiple species then have to be combined in order to determine orthologous groups. However, these groups usually do not readily provide detailed insights since they can contain large numbers of related genes for each species. Hence, meaningful units have to be identified. For this purpose, a variety of clustering algorithms has been applied to determine <italic>Clusters of Orthologous Groups </italic>(COGs). The <monospace>MCL</monospace>-algorithm for instance uses a stochastic flow simulation to determine meaningful COGs [<xref ref-type="bibr" rid="B16">16</xref>,<xref ref-type="bibr" rid="B19">19</xref>,<xref ref-type="bibr" rid="B20">20</xref>]. In addition, <monospace>MultiParanoid</monospace> explicitly searches and tags in-paralogs, i.e., recent paralogs that represent species-specific gene expansions. This strategy requires to directly compare proteins within each species. Alternatively, data were curated by manual postprocessing [<xref ref-type="bibr" rid="B4">4</xref>].</p>
        <p>We will argue here that orthology determination can be understood as the problem of finding <italic>nearly </italic>disjoint maximal <italic>nearly</italic>-complete multipartite subgraphs in an edge-weighted directed graph <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i1.gif"/></inline-formula> whose vertices are the proteins in the input set, and whose edges connect certain pairs of similar proteins of different species. The edge weights <italic>ω</italic><sub><italic>x</italic>→<italic>y </italic></sub>encode the similarity of <italic>x </italic>and <italic>y</italic>. In our implementation, the bit score of the <monospace>blast</monospace> alignment (<italic>x </italic>→ <italic>y</italic>) will serve as edge weight. An <italic>E</italic>-value cut-off is used beyond which <monospace>blast</monospace> alignments are not included into <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i1.gif"/></inline-formula>.</p>
        <p>In order to motivate our point of view, we first consider an idealized dataset (see Figure <xref ref-type="fig" rid="F1">1</xref>) in which (1) each protein <italic>x </italic>(from species <italic>A</italic>) has at most one ortholog in any other species <italic>B </italic>≠ <italic>A</italic>, (2) if <italic>y </italic>∈ <italic>B </italic>is an ortholog of <italic>x </italic>∈ <italic>A</italic>, then a <monospace>blast</monospace> search of <italic>x </italic>against <italic>B </italic>yields at least one alignment and (3) the unique best alignment of query <italic>x </italic>against <italic>B </italic>is the true ortholog <italic>y </italic>of <italic>x</italic>. In this case, the well-know "reciprocal best alignment heuristic" (RBAH), also known as "reciprocal best hits" (RBH) [<xref ref-type="bibr" rid="B11">11</xref>], can be used to retrieve the correct ortholog set. To see this, we construct a subgraph <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i2.gif"/></inline-formula> of <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i1.gif"/></inline-formula> as follows: For each protein <italic>x </italic>in species <italic>A </italic>and a given species <italic>B </italic>≠ <italic>A </italic>we retain only the arc with maximal weight:<disp-formula id="bmcM1"><label>(1)</label><graphic xlink:href="1471-2105-12-124-i3.gif"/></disp-formula></p>
        <fig id="F1" position="float">
          <label>Figure 1</label>
          <caption>
            <p><bold>Orthology relations</bold>. Idealized dataset for two species <italic>A </italic>and <italic>B</italic>. Proteins <italic>x </italic>∈ <italic>A </italic>and <italic>y </italic>∈ <italic>B </italic>are depicted by open boxes. Orthology relations between proteins <italic>x </italic>and <italic>y </italic>are represented by grey shadows. Arrows indicate alignments above a certain cut-off from the search of <italic>x </italic>against <italic>B</italic>. Solid lines refer to the best alignments. Cases (1), (2), and (3) cannot occur by definition in an idealized dataset, but of course do appear in real life applications.</p>
          </caption>
          <graphic xlink:href="1471-2105-12-124-1"/>
        </fig>
        <p>The symmetric subgraph of <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i2.gif"/></inline-formula>, containing only reciprocal best alignments, can be regarded as an undirected graph ϒ<italic><sub>RBAH</sub></italic>. By construction, any two vertices are connected by edges in ϒ<italic><sub>RBAH </sub></italic>if and only if they are orthologs. A set of orthologs therefore corresponds to a complete multipartite subgraph of <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i2.gif"/></inline-formula> in which every species is represented at most once. Furthermore, we note that these subgraphs are disjoint, i.e., ortholog sets correspond to the connected components of <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i2.gif"/></inline-formula>.</p>
        <p>When applied to real data, however, RBAH usually gives rise to several artifacts. In general, therefore, it does not produce correct and complete sets of orthologs. First, gene duplications produce co-orthologs, destroying the uniqueness of best <monospace>blast</monospace> alignments. The <monospace>blast</monospace> comparison of two species both containing two co-orthologs will in general produce slightly different scores among those genes, so that <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i2.gif"/></inline-formula> in general will not contain all arcs between them, see Figure <xref ref-type="fig" rid="F2">2a</xref>. RBAH now extracts the symmetric part of <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i2.gif"/></inline-formula>, i.e., it removes all non-reciprocal edges. Thus the undirected graph ϒ<italic><sub>RBAH </sub></italic>has an edge {<italic>x</italic>, <italic>y</italic>} if and only if both (<italic>x</italic>, <italic>y</italic>) and (<italic>y</italic>, <italic>x</italic>) are arcs in <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i2.gif"/></inline-formula>. A missing arc in the example of Figure <xref ref-type="fig" rid="F2">2a</xref> thus translates into a missing edge in ϒ<italic><sub>RBAH</sub></italic>. Ortholog sets, therefore, are still located in disjoint connected components, but they are only approximately multipartite and there is no guarantee that they remain connected. As a remedy, it could be proposed to use the <italic>k</italic>-best <monospace>blast</monospace> alignments instead of a single best one. This leads, however, to another type of artifact: If distant homologs or spurious <monospace>blast</monospace> alignments with scores above the <monospace>blast</monospace> threshold are present, see Figure <xref ref-type="fig" rid="F2">2b</xref>, the inclusion of up to <italic>k </italic>alignments can result in edges between paralogous but non-orthologous proteins.</p>
        <fig id="F2" position="float">
          <label>Figure 2</label>
          <caption>
            <p><bold>Adaptive RBAH</bold>. Reciprocal best alignment heuristic (RBAH). (a) If there is a pair of divergent co-orthologs <italic>x</italic><sub>1</sub>, <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i4.gif"/></inline-formula>, and <italic>y</italic><sub>1 </sub>and <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i5.gif"/></inline-formula>, resp., it is possible that there are no <italic>reciprocal </italic>best <monospace>blast</monospace> alignments. In this situation, RBAH will not identify any orthologs. (b) One possible remedy is to include the second best <monospace>blast</monospace> alignment (<italic>n </italic>= 2). However, in this case highly similar orthologs (<italic>x</italic><sub>2 </sub>and <italic>y</italic><sub>2 </sub>as well as <italic>x</italic><sub>3 </sub>and <italic>y</italic><sub>3</sub>), which in principle can clearly be divided, can get combined. (c) <monospace>Proteinortho</monospace> uses an adaptive approach that is (1) flexible with respect to the number of more diverged orthologs in absence of a reciprocal best <monospace>blast</monospace> alignment and (2) will not intermix orthologous groups that can be disentangled easily because of large differences in pairwise similarity.</p>
          </caption>
          <graphic xlink:href="1471-2105-12-124-2"/>
        </fig>
        <p>In order to reduce such problems, we suggest to introduce a similarity cut-off value that itself depends on the quality of the matches, i.e., to consider all those <monospace>blast</monospace> alignments of each query against a given species whose <italic>E</italic>-values are only slightly smaller (by a factor <italic>f </italic>&lt; 1) than the queries' best <monospace>blast</monospace> alignments. More precisely,<disp-formula id="bmcM2"><label>(2)</label><graphic xlink:href="1471-2105-12-124-i6.gif"/></disp-formula></p>
        <p>This has two advantages: it retains edges to likely co-orthologs while at the same time reducing the number of edges that are inserted in <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i7.gif"/></inline-formula>.</p>
        <p>The symmetric part ϒ* of <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i7.gif"/></inline-formula> now retains more edges than ϒ<italic><sub>RBAH</sub></italic>. In particular, it includes all the edges connecting similar co-orthologs. On the other hand, the threshold at fairly high bit scores disconnects at least most of the more distant homologs. Sets of (co-)orthologs thus appear in ϒ* as nearly complete multipartite subgraphs. Typically they will contain more than one node from the same species, among them, in particular, all in-paralogs. Although this approach strongly reduces the problem with spurious edges, ϒ* may also contain additional edges connecting two or more sets of (co-)orthologs.</p>
        <p>The problem of finding maximal complete multipartite subgraphs of a graph is NP complete [<xref ref-type="bibr" rid="B21">21</xref>]. Furthermore, we have seen above that ϒ* may lack a few edges which should connect orthologs ("false negatives"), while at the same time there are also some additional "false positive" edges. In a two-species comparison there is no information that could compensate missing and spurious edges, while in the multi-species case, the graph ϒ* is in a sense "self-correcting" since we can formulate orthology detection as an optimization problem. More precisely, we search for a decomposition of ϒ* into a disjoint collection of complete multipartite subgraphs so that the number of edge insertions and deletions is minimized.</p>
        <p>Since no efficient approaches to this combinatorial optimization problem seem to be known, it appears fruitful to resort to a heuristic approach that employs a somewhat different point of view: nearly complete multipartite subgraphs are very dense subgraphs, which in our case either form connected components on their own, or which are connected to other dense clusters by a few additional edges. The problem thus is to determine for each connected component ϒ* of whether it is sufficiently densely connected, and if not, to partition it into its densely connected components by removing the spurious edges connecting them. Here, we approach this issue by means of spectral partitioning [<xref ref-type="bibr" rid="B22">22</xref>], see Additional File <xref ref-type="supplementary-material" rid="S1">1</xref> for a detailed description.</p>
        <p>We remark, finally, that one could efficiently add the explicit determination of in-paralogs after ϒ* has been constructed, although currently this is not implemented in <monospace>Proteinortho</monospace>. Following e.g. <monospace>InParanoid</monospace>, sets of in-paralogs are subsets of proteins from the same species within the same connected component ϒ* of that are more similar to each other than to any protein in another species. It is sufficient, thus, to determine alignment scores for pairs of nodes from the same species within connected components of ϒ*. As in <monospace>MultiParanoid</monospace>, in-paralogs could be collapsed to a single node.</p>
      </sec>
      <sec>
        <title>Implementation</title>
        <sec>
          <title><monospace>Blast</monospace> searches</title>
          <p><monospace>Proteinortho</monospace> expects <monospace>fasta</monospace> files containing either nucleic acid or amino acid sequences as input. <monospace>Proteinortho</monospace> does not build a large database containing all proteins but rather keeps the protein complements of different species separate. This has multiple advantages: (1) the <monospace>blast</monospace> step can be partitioned into multiple runs. The available processor cores are used efficiently as each <monospace>blast</monospace> process can utilize one processor core to the full, which is usually not the case if threading is handled by <monospace>blast</monospace> itself. Furthermore, the <monospace>blast</monospace> jobs can be distributed to several computers in a network. (2) The computationally expensive <monospace>blast</monospace> search of species against themselves (which is implicit in searching a comprehensive protein database) can be avoided. (3) The <italic>E</italic>-values returned by <monospace>blast</monospace> depend only on the proteome of each input species, not on the database of all input sequences. Therefore, <monospace>Proteinortho</monospace> implicitly enforces higher similarity for related proteomes but allows lower levels of similarity for larger evolutionary distances. Conceptually, this replaces the normalization of the scores employed e.g. by <monospace>OrthoMCL</monospace>. (4) The scope of the analysis can be extended without the need to re-compute <monospace>blast</monospace> comparisons that have already been computed earlier. The <italic>E</italic>-values remain unchanged when species are included or excluded from the analysis. <monospace>Proteinortho</monospace> can use several PCs with a shared storage (such as an NFS file system). The implementation of distributed computing is illustrated in Additional File <xref ref-type="supplementary-material" rid="S2">2</xref>. Furthermore, cluster infrastructure (e.g. <monospace>MPI</monospace> or <monospace>SGE</monospace>) is supported. A benchmark illustrating the performance improvements is shown in Figure <xref ref-type="fig" rid="F3">3a</xref>. <monospace>Proteinortho</monospace> is faster than <monospace>OrthoMCL</monospace> even if only a single processor core is available and gains much of its practical advantage from parallelization. In applications to large numbers of species, for which <monospace>Proteinortho</monospace> is primarily intended, handling <monospace>blast</monospace> alignments dominates the spectral partitioning step by several orders of magnitude. As <monospace>blast</monospace> and the memory consumption of holding the graph structure for clustering are limiting, we do not investigate the complexity of the clustering step itself in detail.</p>
          <fig id="F3" position="float">
            <label>Figure 3</label>
            <caption>
              <p><bold>Benchmarks</bold>. CPU time and memory requirements of <monospace>Proteinortho</monospace>. (a) The speed benchmark was performed using an <italic>E. coli </italic>strain with 4132 proteins on an eight core Intel Xeon system using one thread (1) and eight threads (8) at 2.33 GHz. The encoded proteins were used multiple times to simulate multiple (identical) species. This is the worst case scenario for <monospace>Proteinortho</monospace> since in this case every protein has a link to at least one protein in every other species. <monospace>Proteinortho</monospace> is significantly faster than <monospace>OrthoMCL</monospace>. Using multiple threads we observe a substantial speed up. (b) The memory benchmark is performed using the same set as in (a). <monospace>OrthoMCL</monospace> quickly exhausts memory for larger sets. <monospace>Proteinortho</monospace> clearly performs more efficient, even though this artificial scenario is a more complex case than real world analysis. Both benchmarks outline that <monospace>Proteinortho</monospace> allows comprehensive studies which were not possible before.</p>
            </caption>
            <graphic xlink:href="1471-2105-12-124-3"/>
          </fig>
          <p>Most importantly, the algorithm outlined in the previous section avoids the memory bottleneck that limits previous approaches. Suppose our input set comprises <italic>N </italic>species with, on average, <italic>m </italic>genes. The size of the input is thus <italic>n </italic>= <italic>N </italic>× <italic>m </italic>proteins. Instead of storing all <italic>n </italic>× <italic>n </italic>pairwise <monospace>blast</monospace> scores, <monospace>Proteinortho</monospace> processes the comparisons between any two species <italic>A </italic>and <italic>B </italic>immediately: first the <monospace>blast</monospace> alignments are filtered by two additional criteria: (1) The alignment must exhibit a minimum level of sequence identity. (2) The alignment must cover at least a minimum fraction of the query protein. This second rule ensures that fusion genes such as rice OsUK/UPRT1 [<xref ref-type="bibr" rid="B23">23</xref>] are eventually assigned as homologs of the dominating part of the protein. Then equ.(2) is evaluated for all <italic>x </italic>in <italic>A</italic>, so that <monospace>Proteinortho</monospace> directly constructs the sparse graph <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i7.gif"/></inline-formula>, while <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i1.gif"/></inline-formula> does not need to be stored at all. <monospace>Proteinortho</monospace> therefore uses chained arrays, requiring only <italic>n </italic>× <italic>k </italic>entries, where <italic>k </italic>is the average number of nearly optimal <monospace>blast</monospace> alignments per gene, and <italic>k </italic>= <italic>a </italic>× <italic>N</italic>, where <italic>a </italic>is the average number of (co-)orthologs of a gene in a single species. The value of <italic>a </italic>is independent of the size of the dataset. Empirically, we found <italic>a </italic>≤ 1 in all datasets investigated so far. Thus <monospace>Proteinortho</monospace> saves a factor <italic>n</italic><sup>2</sup>/<italic>N</italic><sup>2</sup><italic>ma </italic>= <italic>m</italic>/<italic>a </italic>≥ <italic>m </italic>of memory. Note that prokaryotes have <italic>m </italic>≈ 10<sup>3 </sup>... 10<sup>4 </sup>proteins.</p>
        </sec>
        <sec>
          <title>Spectral partitioning</title>
          <p>First we reduce the problem by determining the connected components ϒ* of since these can be treated separately. We use the well-known breath-first search approach [<xref ref-type="bibr" rid="B24">24</xref>] to this end. In order to check whether a connected component Ξ is sufficiently dense to represent a single set of co-orthologs we compute its normalized algebraic connectivity <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i8.gif"/></inline-formula>. Here <italic>n </italic>is the number of vertices of Ξ and <italic>αalpha</italic><sub>2 </sub>is 2nd-smallest eigenvalue of the graph Laplacian <bold>L </bold>= <bold>D </bold>- <bold>A </bold>of Ξ [<xref ref-type="bibr" rid="B25">25</xref>]. Here <bold>A </bold>is the adjacency matrix of Ξ and <bold>D </bold>is the diagonal matrix of the vertex degrees. The eigenvalue <italic>αalpha</italic><sub>2 </sub>can be computed iteratively, see Additional File <xref ref-type="supplementary-material" rid="S1">1</xref>. Values of <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i9.gif"/></inline-formula> indicate dense clusters that most likely correspond to coherent sets of (co-)orthologs. Small values <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i10.gif"/></inline-formula>, on the other hand indicate that Ξ has a low connectivity and either consists of two or more dense components or it has (nearly) tree-like protrusions. Very large components <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i11.gif"/></inline-formula> can arise when genes duplicate frequently and diverge quickly according to the duplication-degeneration-complementation (DDC) model [<xref ref-type="bibr" rid="B26">26</xref>].</p>
          <p>The "Fiedler vector" <bold>x</bold><sub>2</sub>, i.e., the eigenvector of <bold>L </bold>to eigenvalue <italic>α</italic><sub>2 </sub>can be used to find a partition of Ξ into two connected components, one consisting of the vertices for which <bold>x</bold><sub>2 </sub>has positive entries and one for which <bold>x</bold><sub>2 </sub>has negative entries [<xref ref-type="bibr" rid="B27">27</xref>]. This decomposition is iterated until Ξ is partitioned into components with algebraic connectivity <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i10.gif"/></inline-formula> above a certain threshold value and tree-like pieces, which most likely correspond to false-positive edges of ϒ*. In order to speed up the computation, trees are therefore removed from the component Ξ before the algebraic connectivity and the Fiedler vector is computed. This is achieved by iteratively removing a vertex of degree 1 and its adjacent edge. This step is not performed if <monospace>Proteinortho</monospace> is used to compare only two species.</p>
          <p>We remark that the memory and CPU consumption for the clustering step of <monospace>OrthoMCL</monospace> can be drastically reduced by using a novel algorithm [<xref ref-type="bibr" rid="B28">28</xref>], reaching a performance that is theoretically comparable to spectral partitioning as used by <monospace>Proteinortho</monospace> (see Additional File <xref ref-type="supplementary-material" rid="S1">1</xref>). Both require only the storage of edge or adjacency lists. The current implementation of spectral partitioning could be further optimized e.g. by employing the Lanczos algorithm [<xref ref-type="bibr" rid="B29">29</xref>] for computing the eigenvalues. Spectral partitioning on average scales as <italic>O</italic>(<italic>n</italic><sup>2</sup><italic>k</italic>). This leads to an expected runtime of <italic>O</italic>(<italic>N</italic><sup>3</sup>) for <monospace>Proteinortho</monospace> which is comparable to the <italic>O</italic>(<italic>N</italic><sup>3 </sup>log <italic>N</italic>) complexity bound achieved for COG clustering in [<xref ref-type="bibr" rid="B28">28</xref>].</p>
        </sec>
      </sec>
    </sec>
    <sec>
      <title>
        <bold>Evaluation of </bold>
        <monospace>Proteinortho</monospace>
      </title>
      <p>We compared <monospace>Proteinortho</monospace> with the COG-database [<xref ref-type="bibr" rid="B4">4</xref>] and <monospace>OrthoMCL</monospace>[<xref ref-type="bibr" rid="B3">3</xref>]. The latter is the main competitor in terms of speed and memory. The <monospace>COG</monospace>-database provides a manually curated dataset that can be regarded as more reliable than fully automated approaches. For benchmark analysis, a set of 16 randomly chosen bacteria from three different classes (six Gram-positive bacilli, six gamma- and four alpha-proteobacteria) are used. The input set comprises 53, 623 protein sequences.</p>
      <p>Figure <xref ref-type="fig" rid="F4">4</xref> summarizes the size distribution of co-ortholog sets for the three approaches. Using default settings (<italic>E</italic>-value cutoff 10<sup>-10</sup>, algebraic connectivity threshold <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i12.gif"/></inline-formula>, minimum 25% identity, 50% coverage of query sequence, similarity threshold <italic>f </italic>= 0.95) Both <monospace>Proteinortho</monospace> and <monospace>OrthoMCL</monospace> report fewer groups than listed in the <monospace>COG</monospace>-database. This is not surprising, however, since the <monospace>COG</monospace>-database relies on less restrictive criteria and thus tends to include multiple co-orthologs, while both stand-alone tools apply clustering algorithms that attempt to split the large components whenever possible.</p>
      <fig id="F4" position="float">
        <label>Figure 4</label>
        <caption>
          <p><bold>Coverage completion</bold>. Comparison of the results of <monospace>Proteinortho</monospace> with different thresholds of the normalized algebraic connectivity <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i13.gif"/></inline-formula> with the <monospace>COG</monospace>-database and <monospace>OrthoMCL</monospace> for a dataset consisting of 16 randomly chosen bacterial proteomes. The vertical dashed line marks the transition from clusters containing mainly a single ortholog from each species to sets including co-orthologs. The <monospace>COG</monospace>-database reports many large groups which often include co-orthologous proteins. <monospace>OrthoMCL</monospace> and <monospace>Proteinortho</monospace> focus on highly connected subsets in order to find orthologous sets and thus split those groups. Thereby, <monospace>Proteinortho</monospace>'s clustering algorithm becomes more stringent with increasing values of <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i10.gif"/></inline-formula> in splitting in particular large groups. While these groups are left intact for <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i14.gif"/></inline-formula>, thresholds of 0.5 and higher drastically reduce the fraction of included co-orthologs.</p>
        </caption>
        <graphic xlink:href="1471-2105-12-124-4"/>
      </fig>
      <p>Figure <xref ref-type="fig" rid="F5">5</xref> presents the outcome in more detail. <monospace>Proteinortho</monospace> and <monospace>OrthoMCL</monospace> report comparable results. <monospace>Proteinortho</monospace> is more stringent. The amount of completely new groups which have to be regarded as false positives is considerably lower. <monospace>OrthoMCL</monospace> reports slightly more groups. Even though both tools were applied with the same E-value threshold the results vary due to the different <monospace>blast</monospace> strategies: <monospace>OrthoMCL</monospace> employs one large database containing all proteins, while <monospace>Proteinortho</monospace> uses species-specific databases. Most pairwise <italic>E</italic>-values derived by <monospace>Proteinortho</monospace> thus tend to be somewhat larger than those derived by <monospace>OrthoMCL</monospace> for the same set of proteins. In turn, <monospace>OrthoMCL</monospace> reports some more and larger groups. However, the overall outcome can be regarded as similar while the runtime and memory requirements of <monospace>Proteinortho</monospace> are substantially reduced in comparison to <monospace>OrthoMCL</monospace>.</p>
      <fig id="F5" position="float">
        <label>Figure 5</label>
        <caption>
          <p><bold>Comparison of results</bold>. Comparison of <monospace>OrthoMCL</monospace> and <monospace>Proteinortho</monospace> to the <monospace>COG</monospace>-database. The following assignments were defined: identity: the group equals a <monospace>COG</monospace>-group; subset: the group is subset of a <monospace>COG</monospace>-group, at least two proteins are equal; superset: the group is a superset of a <monospace>COG</monospace>-group, at least two proteins are equal; new: none of the above-noted criteria matched. Both tools reveal comparable results with respect to the manually curated <monospace>COG</monospace>-database. <monospace>OrthoMCL</monospace> covers more identical and differently composed groups while <monospace>Proteinortho</monospace> is more restrictive and reports fewer new groups which are not present in the <monospace>COG</monospace>-database. All groups with less than six species were omitted from the <monospace>OrthoMCL</monospace> and <monospace>Proteinortho</monospace> data. See Additional File <xref ref-type="supplementary-material" rid="S2">2</xref> for comparisons with different minimal coverage.</p>
        </caption>
        <graphic xlink:href="1471-2105-12-124-5"/>
      </fig>
    </sec>
    <sec>
      <title>Domain-wide commons</title>
      <p>In order to demonstrate that <monospace>Proteinortho</monospace> is suitable for large-scale analysis we asked <italic>Which proteins can be found in all bacterial species? </italic>Proteins that are conserved domain-wide are likely to be useful for the construction of a phylogeny of eubacteria as an alternative to the prevalent usage of 16<italic>S </italic>rRNA sequences [<xref ref-type="bibr" rid="B30">30</xref>]. They can also serve as protein-based markers for identifying novel bacterial species as members of an established phylogenetic group. In addition, they can give insight into basic protein equipment of bacterial life. Hence, we applied <monospace>Proteinortho</monospace> to the set of all eubacterial proteomes available at NCBI at the beginning of 2009 (Additional File <xref ref-type="supplementary-material" rid="S3">3</xref>).</p>
      <p>The input dataset comprises 2, 155, 620 proteins annotated in 717 bacterial genomes. The <monospace>Proteinortho</monospace> run took less than two weeks using 50 processor cores (Intel Xeon at 2.00-2.33 GHz) distributed over multiple PCs. Only 2 GB memory were required. <monospace>OrthoMCL</monospace> could not be employed for this task on the hardware available in our lab. Extrapolating from the benchmarks in Figure <xref ref-type="fig" rid="F3">3</xref>, we estimate that hundreds of gigabytes of memory and years of runtime would have been required.</p>
      <p><monospace>Proteinortho</monospace> identified 152 proteins as core of the bacterial protein complement, occurring in at least 90% of all 717 free-living and endosymbiotic bacteria. Of these, 32 are ribosomal subunits. The 30 apparently most indispensable proteins, occurring in 99% of all bacteria, are:</p>
      <p>Elongation factor Tu (often co-orthologous to elongation factor 1-alpha)</p>
      <p>Elongation factor G</p>
      <p>Translation initiation factor IF-2</p>
      <p>RNA polymerase subunits <italic>β </italic>and <italic>β'</italic></p>
      <p>ATP-dependent metalloprotease FtsH</p>
      <p>O-sialoglycoprotein endopeptidase</p>
      <p>Methionine aminopeptidase</p>
      <p>F0F1 ATP synthase subunits <italic>α </italic>and <italic>β</italic></p>
      <p>Dimethyladenosine transferase</p>
      <p>1 ribosomal protein of the <italic>30S </italic>rRNA subunit</p>
      <p>3 ribosomal proteins of the <italic>50S </italic>rRNA subunit</p>
      <p>3 GTP-binding proteins</p>
      <p>12 tRNA synthetases</p>
      <p>A more detailed list, including unique identifiers for groups of proteins can be found in the supplemental material. The sensitivity of <monospace>Proteinortho</monospace> in this survey is limited by incomplete annotation in many species, which we complemented here by <monospace>tblastn</monospace> searches with fairly restrictive cut-off values, see Methods for details. Figure <xref ref-type="fig" rid="F6">6</xref> summarizes the results quantitatively, emphasizing the effect of incomplete annotation. We remark that this example also shows that <monospace>Proteinortho</monospace> can be used to complement existing annotations in an automatic fashion.</p>
      <fig id="F6" position="float">
        <label>Figure 6</label>
        <caption>
          <p><bold>Orthologous groups</bold>. Number of orthologous groups present in nearly all bacterial species. The dashed line represents <monospace>Proteinortho</monospace> results based on the NCBI annotation. Using <monospace>tblastn</monospace> the annotation was complemented with high scoring genomic matches (solid curve). Note that this is a cumulative plot, i.e., each group of co-orthologs present in <italic>x </italic>species is also included in the count of groups contained in <italic>x</italic>' &lt;<italic>x </italic>species.</p>
        </caption>
        <graphic xlink:href="1471-2105-12-124-6"/>
      </fig>
      <p>Nevertheless, about one third of the 30 most conserved proteins could not be recovered in the genomes of the two species with the smallest proteomes in our dataset: <italic>Candidatus Carsonella ruddii PV </italic>and <italic>Candidatus Sulcia muelleri GWSS</italic>. Both are endosymbionts that are considered as organelle-like [<xref ref-type="bibr" rid="B31">31</xref>,<xref ref-type="bibr" rid="B32">32</xref>]. Numerous genes that are otherwise considered to be essential for life have been reported as missing in both species. A more detailed and larger list of domain-wide common proteins can be downloaded at <ext-link ext-link-type="uri" xlink:href="http://bioinf.pharmazie.uni-marburg.de/supplements/proteinortho/">http://bioinf.pharmazie.uni-marburg.de/supplements/proteinortho/</ext-link>.</p>
    </sec>
  </sec>
  <sec>
    <title>Conclusions</title>
    <p><monospace>Proteinortho</monospace> implements a <monospace>blast</monospace>-based approach to determine sets of (co-)orthologous proteins or nucleic acid sequences that generalizes the reciprocal best alignment heuristic. The software is optimized for large datasets, and in particular provides a drastic reduction of the memory requirements compared to earlier tools. It can therefore be run on off-the-shelf PC hardware for large datasets. Our implementation scales very well with the number of available processor cores. The <monospace>blast</monospace> searches can be trivially parallelized and distributed easily to multiple PCs without the need for a cluster management system, while deployment to existing cluster infrastructure is also supported.</p>
    <p><monospace>Proteinortho</monospace> views orthology detection as a variant of graph clustering since co-orthologous sets correspond to maximal complete multipartite subgraphs, which at the same time are well separated from each other. Due to the unavoidable noise in the real data, however, co-orthologous sets appear as dense subgraphs without clearly recognizable low-weight cuts. This property is measured quite well by the algebraic connectivity. At the same time, low-weight cuts between dense regions are identified very well by the corresponding Fiedler vector. We therefore employ spectral partitioning instead of a direct graph clustering approach. The quality of the co-orthologous sets proposed by <monospace>Proteinortho</monospace> is comparable to the performance of <monospace>OrthoMCL</monospace>.</p>
    <p>Both time and memory requirements are significantly reduced compared to earlier approaches, enabling applications that were infeasible before. For instance, we applied <monospace>Proteinortho</monospace> to the complete set of 2.1 million proteins from the 717 bacterial genomes available at NCBI at the beginning of 2009. We found 30 proteins that are present in more than 99% of the investigated sequences.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <p>All analysis with <monospace>Proteinortho</monospace> and <monospace>OrthoMCL</monospace> were applied using default values unless described otherwise. These are <italic>E </italic>- <italic>value </italic>&lt; 10<sup>-10</sup>, 25% percent identity, Markov Inflation Index of 1.5 for <monospace>OrthoMCL</monospace> and <italic>E</italic>-value &lt; 10<sup>-10</sup>, 25% percent identity, adaptive best alignments similarity of <italic>f </italic>= 0.95, algebraic connectivity &gt; 0.1 for <monospace>Proteinortho</monospace>. <monospace>OrthoMCL</monospace> version 1.4 was downloaded from <ext-link ext-link-type="uri" xlink:href="http://OrthoMCL.org/common/downloads/">http://OrthoMCL.org/common/downloads/</ext-link>.</p>
    <p>Speed and memory benchmark were performed multiple times using the proteome of <italic>Escherichia coli K12 substr. MG1655 </italic>data from the NCBI. The protein ids were renamed systematically to prevent duplicated ids for benchmarking purposes which cannot be handled by <monospace>Proteinortho</monospace>. A script continuously observed the memory consumption and reported the maximum peak for each run, Figure <xref ref-type="fig" rid="F3">3</xref>.</p>
    <p>For the domain-wide commons we applied <monospace>Proteinortho</monospace> with default values of the parameters. Bacterial proteomes and genomes were downloaded from NCBI <ext-link ext-link-type="ftp" xlink:href="ftp://ftp.ncbi.nih.gov/genomes/Bacteria/">ftp://ftp.ncbi.nih.gov/genomes/Bacteria/</ext-link> in March 2009. A detailed list can be found in Additional File <xref ref-type="supplementary-material" rid="S3">3</xref>. In order to recover missing annotation, we selected all orthologous groups covering at least 75% of all species that are good candidates of domain-wide commons. The unique set of sequences of each orthologous group was blasted against all genomes that lack an annotated ortholog using <monospace>tblastn</monospace> (<italic>E</italic>-value &lt; 10<sup>-20</sup>). The sequence of the best alignment was then added to the orthologous group.</p>
    <p>For evaluation we used the proteome data from the <monospace>COG</monospace>-database <ext-link ext-link-type="ftp" xlink:href="ftp://ftp.ncbi.nih.gov/pub/COG/COG/">ftp://ftp.ncbi.nih.gov/pub/COG/COG/</ext-link> downloaded in November 2009. We have chosen <italic>Bacillus halodurans, Bacillus subtilis, Lactococcus lactis, Listeria innocua, Streptococcus pneumoniae TIGR4, Streptococcus pyogenes M1 GAS </italic>from the Gram-positive bacilli class, <italic>Buchnera sp. APS, Escherichia coli K12, Pasteurella multocida, Salmonella typhimurium LT2, Vibrio cholerae, Yersinia pestis </italic>from the gamma proteobacteria class and <italic>Brucella melitensis, Caulobacter vibrioides, Mesorhizobium loti, Rickettsia prowazekii </italic>from the alpha proteobacteria class. Both, <monospace>Proteinortho</monospace> and <monospace>OrthoMCL</monospace> were applied to this set. All groups with proteins covering at least 6 species were compared to the <monospace>COG</monospace>-database, illustrated in Figure <xref ref-type="fig" rid="F4">4</xref> and Figure <xref ref-type="fig" rid="F5">5</xref>.</p>
  </sec>
  <sec>
    <title>Availability</title>
    <p>The source code of <monospace>Proteinortho</monospace> can be obtained under the GPLv2 (or later) from <ext-link ext-link-type="uri" xlink:href="http://www.bioinf.uni-leipzig.de/Software/proteinortho/">http://www.bioinf.uni-leipzig.de/Software/proteinortho/</ext-link></p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>SP implemented an initial RBAH prototype. ML implemented, optimized, and evaluated the later versions of the program. All authors contributed to the details of implementation, testing and interpretation of the data, and collaborated in writing and approved the final manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional File 1</title>
        <p><bold>Algebraic connectivity and Fiedler vector</bold>. Iterative approximation of the Algebraic Connectivity using the Fiedler Vector.</p>
      </caption>
      <media xlink:href="1471-2105-12-124-S1.PDF" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S2">
      <caption>
        <title>Additional File 2</title>
        <p><bold>Supplemental figures</bold>. Supplemental Figures showing how multiple instances of <monospace>Proteinortho</monospace> can cooperate and how the comparison to <monospace>OrthoMCL</monospace> looks using smaller cutoffs.</p>
      </caption>
      <media xlink:href="1471-2105-12-124-S2.PDF" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S3">
      <caption>
        <title>Additional File 3</title>
        <p><bold>Species list for domain wide commons</bold>. Table of species and accession numbers used in this analysis.</p>
      </caption>
      <media xlink:href="1471-2105-12-124-S3.PDF" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgements</title>
    <p>This work was supported in part by DFG STA-850/6, STA-850/2, EU-project "Quantomics" and VW-project "Complex networks" and SPP 1258: "Sensory and regulatory RNAs in Prokaryotes".</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Fitch</surname>
          <given-names>WM</given-names>
        </name>
        <article-title>Distinguishing homologous from analogous proteins</article-title>
        <source>Syst Zool</source>
        <year>1970</year>
        <volume>19</volume>
        <issue>2</issue>
        <fpage>99</fpage>
        <lpage>113</lpage>
        <pub-id pub-id-type="doi">10.2307/2412448</pub-id>
        <pub-id pub-id-type="pmid">5449325</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="other">
        <name>
          <surname>Berglund</surname>
          <given-names>AC</given-names>
        </name>
        <name>
          <surname>Sjölund</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Ostlund</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Sonnhammer</surname>
          <given-names>EL</given-names>
        </name>
        <article-title>InParanoid 6: eukaryotic ortholog clusters with inparalogs</article-title>
        <source>Nucleic Acids Res</source>
        <year>2008</year>
        <issue>36 Database</issue>
        <fpage>D263</fpage>
        <lpage>266</lpage>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="other">
        <name>
          <surname>Chen</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Mackey</surname>
          <given-names>AJ</given-names>
        </name>
        <name>
          <surname>Stoeckert</surname>
          <given-names>CJ</given-names>
          <suffix>Jr</suffix>
        </name>
        <name>
          <surname>Roos</surname>
          <given-names>DS</given-names>
        </name>
        <article-title>OrthoMCL-DB: querying a comprehensive multi-species collection of ortholog groups</article-title>
        <source>Nucleic Acids Res</source>
        <year>2006</year>
        <issue>34 Database</issue>
        <fpage>D363</fpage>
        <lpage>368</lpage>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Tatusov</surname>
          <given-names>RL</given-names>
        </name>
        <name>
          <surname>Galperin</surname>
          <given-names>MY</given-names>
        </name>
        <name>
          <surname>Natale</surname>
          <given-names>DA</given-names>
        </name>
        <name>
          <surname>Koonin</surname>
          <given-names>EV</given-names>
        </name>
        <article-title>The COG database: a tool for genome-scale analysis of protein functions and evolution</article-title>
        <source>Nucleic Acids Res</source>
        <year>2000</year>
        <volume>28</volume>
        <fpage>33</fpage>
        <lpage>36</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/28.1.33</pub-id>
        <pub-id pub-id-type="pmid">10592175</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="other">
        <name>
          <surname>Wheeler</surname>
          <given-names>DL</given-names>
        </name>
        <name>
          <surname>Barrett</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Benson</surname>
          <given-names>DA</given-names>
        </name>
        <name>
          <surname>Bryant</surname>
          <given-names>SH</given-names>
        </name>
        <name>
          <surname>Canese</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Chetvernin</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Church</surname>
          <given-names>DM</given-names>
        </name>
        <name>
          <surname>Dicuccio</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Edgar</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Federhen</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Feolo</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Geer</surname>
          <given-names>LY</given-names>
        </name>
        <name>
          <surname>Helmberg</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Kapustin</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Khovayko</surname>
          <given-names>O</given-names>
        </name>
        <name>
          <surname>Landsman</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Lipman</surname>
          <given-names>DJ</given-names>
        </name>
        <name>
          <surname>Madden</surname>
          <given-names>TL</given-names>
        </name>
        <name>
          <surname>Maglott</surname>
          <given-names>DR</given-names>
        </name>
        <name>
          <surname>Miller</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Ostell</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Pruitt</surname>
          <given-names>KD</given-names>
        </name>
        <name>
          <surname>Schuler</surname>
          <given-names>GD</given-names>
        </name>
        <name>
          <surname>Shumway</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Sequeira</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Sherry</surname>
          <given-names>ST</given-names>
        </name>
        <name>
          <surname>Sirotkin</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Souvorov</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Starchenko</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Tatusov</surname>
          <given-names>RL</given-names>
        </name>
        <name>
          <surname>Tatusova</surname>
          <given-names>TA</given-names>
        </name>
        <name>
          <surname>Wagner</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Yaschenko</surname>
          <given-names>E</given-names>
        </name>
        <article-title>Database resources of the National Center for Biotechnology Information</article-title>
        <source>Nucleic Acids Res</source>
        <year>2008</year>
        <issue>36 Database</issue>
        <fpage>D13</fpage>
        <lpage>21</lpage>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="other">
        <name>
          <surname>Jensen</surname>
          <given-names>LJ</given-names>
        </name>
        <name>
          <surname>Julien</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Kuhn</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>von Mering</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Muller</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Doerks</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Bork</surname>
          <given-names>P</given-names>
        </name>
        <article-title>eggNOG: automated construction and annotation of orthologous groups of genes</article-title>
        <source>Nucleic Acids Res</source>
        <year>2008</year>
        <issue>36 Database</issue>
        <fpage>D250</fpage>
        <lpage>254</lpage>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Schneider</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Dessimoz</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Gonnet</surname>
          <given-names>GH</given-names>
        </name>
        <article-title>OMA Browser-exploring orthologous relations across 352 complete genomes</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <issue>16</issue>
        <fpage>2180</fpage>
        <lpage>2182</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btm295</pub-id>
        <pub-id pub-id-type="pmid">17545180</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="other">
        <name>
          <surname>Hubbard</surname>
          <given-names>TJ</given-names>
        </name>
        <name>
          <surname>Aken</surname>
          <given-names>BL</given-names>
        </name>
        <name>
          <surname>Beal</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Ballester</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Caccamo</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Chen</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Clarke</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Coates</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Cunningham</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Cutts</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Down</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Dyer</surname>
          <given-names>SC</given-names>
        </name>
        <name>
          <surname>Fitzgerald</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Fernandez-Banet</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Graf</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Haider</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Hammond</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Herrero</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Holland</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Howe</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Howe</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Johnson</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Kahari</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Keefe</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Kokocinski</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Kulesha</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Lawson</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Longden</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Melsopp</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Megy</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Meidl</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Ouverdin</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Parker</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Prlic</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Rice</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Rios</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Schuster</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Sealy</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Severin</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Slater</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Smedley</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Spudich</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Trevanion</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Vilella</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Vogel</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>White</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Wood</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Cox</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Curwen</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Durbin</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Fernandez-Suarez</surname>
          <given-names>XM</given-names>
        </name>
        <name>
          <surname>Flicek</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Kasprzyk</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Proctor</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Searle</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Smith</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Ureta-Vidal</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Birney</surname>
          <given-names>E</given-names>
        </name>
        <article-title>Ensembl 2007</article-title>
        <source>Nucleic Acids Res</source>
        <year>2007</year>
        <issue>35 Database</issue>
        <fpage>D610</fpage>
        <lpage>617</lpage>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="other">
        <collab>UniProt Consortium</collab>
        <article-title>The Universal Protein Resource (UniProt) in 2010</article-title>
        <source>Nucleic Acids Res</source>
        <year>2010</year>
        <issue>38 Database</issue>
        <fpage>D142</fpage>
        <lpage>8</lpage>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Koonin</surname>
          <given-names>EV</given-names>
        </name>
        <article-title>Orthologs, paralogs, and evolutionary genomics</article-title>
        <source>Annu Rev Genet</source>
        <year>2005</year>
        <volume>39</volume>
        <fpage>309</fpage>
        <lpage>38</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev.genet.39.073003.114725</pub-id>
        <pub-id pub-id-type="pmid">16285863</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Bork</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Dandekar</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Diaz-Lazcoz</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Eisenhaber</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Huynen</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Yuan</surname>
          <given-names>Y</given-names>
        </name>
        <article-title>Predicting function: from genes to genomes and back</article-title>
        <source>J Mol Biol</source>
        <year>1998</year>
        <volume>283</volume>
        <issue>4</issue>
        <fpage>707</fpage>
        <lpage>725</lpage>
        <pub-id pub-id-type="doi">10.1006/jmbi.1998.2144</pub-id>
        <pub-id pub-id-type="pmid">9790834</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Rivera</surname>
          <given-names>MC</given-names>
        </name>
        <name>
          <surname>Jain</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Moore</surname>
          <given-names>JE</given-names>
        </name>
        <name>
          <surname>Lake</surname>
          <given-names>JA</given-names>
        </name>
        <article-title>Genomic evidence for two functionally distinct gene classes</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>1998</year>
        <volume>95</volume>
        <issue>11</issue>
        <fpage>6239</fpage>
        <lpage>6244</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.95.11.6239</pub-id>
        <pub-id pub-id-type="pmid">9600949</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Hirsh</surname>
          <given-names>AE</given-names>
        </name>
        <name>
          <surname>Fraser</surname>
          <given-names>HB</given-names>
        </name>
        <article-title>Protein dispensability and rate of evolution</article-title>
        <source>Nature</source>
        <year>2001</year>
        <volume>411</volume>
        <issue>6841</issue>
        <fpage>1046</fpage>
        <lpage>1049</lpage>
        <pub-id pub-id-type="doi">10.1038/35082561</pub-id>
        <pub-id pub-id-type="pmid">11429604</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Remm</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Storm</surname>
          <given-names>CE</given-names>
        </name>
        <name>
          <surname>Sonnhammer</surname>
          <given-names>EL</given-names>
        </name>
        <article-title>Automatic clustering of orthologs and in-paralogs from pairwise species comparisons</article-title>
        <source>J Mol Biol</source>
        <year>2001</year>
        <volume>314</volume>
        <issue>5</issue>
        <fpage>1041</fpage>
        <lpage>1052</lpage>
        <pub-id pub-id-type="doi">10.1006/jmbi.2000.5197</pub-id>
        <pub-id pub-id-type="pmid">11743721</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Jordan</surname>
          <given-names>IK</given-names>
        </name>
        <name>
          <surname>Rogozin</surname>
          <given-names>IB</given-names>
        </name>
        <name>
          <surname>Wolf</surname>
          <given-names>YI</given-names>
        </name>
        <name>
          <surname>Koonin</surname>
          <given-names>EV</given-names>
        </name>
        <article-title>Essential genes are more evolutionarily conserved than are nonessential genes in bacteria</article-title>
        <source>Genome Res</source>
        <year>2002</year>
        <volume>12</volume>
        <issue>6</issue>
        <fpage>962</fpage>
        <lpage>968</lpage>
        <pub-id pub-id-type="pmid">12045149</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Li</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Stoeckert</surname>
          <given-names>CJ</given-names>
          <suffix>Jr</suffix>
        </name>
        <name>
          <surname>Roos</surname>
          <given-names>DS</given-names>
        </name>
        <article-title>OrthoMCL: identification of ortholog groups for eukaryotic genomes</article-title>
        <source>Genome Res</source>
        <year>2003</year>
        <volume>13</volume>
        <issue>9</issue>
        <fpage>2178</fpage>
        <lpage>2189</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.1224503</pub-id>
        <pub-id pub-id-type="pmid">12952885</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Alexeyenko</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Tamas</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Liu</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Sonnhammer</surname>
          <given-names>EL</given-names>
        </name>
        <article-title>Automatic clustering of orthologs and inparalogs shared by multiple proteomes</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <issue>14</issue>
        <fpage>e9</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl213</pub-id>
        <pub-id pub-id-type="pmid">16873526</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Fu</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Chen</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Vacic</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Nan</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Zhong</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Jiang</surname>
          <given-names>T</given-names>
        </name>
        <article-title>MSOAR: a high-throughput ortholog assignment system based on genome rearrangement</article-title>
        <source>J Comput Biol</source>
        <year>2007</year>
        <volume>14</volume>
        <issue>9</issue>
        <fpage>1160</fpage>
        <lpage>1175</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2007.0048</pub-id>
        <pub-id pub-id-type="pmid">17990975</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="book">
        <name>
          <surname>van Dongen</surname>
          <given-names>SM</given-names>
        </name>
        <article-title>Graph Clustering by Flow Simulation</article-title>
        <source>PhD thesis</source>
        <year>2000</year>
        <publisher-name>University of Utrecht, The Netherlands</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Enright</surname>
          <given-names>AJ</given-names>
        </name>
        <name>
          <surname>Van Dongen</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Ouzounis</surname>
          <given-names>CA</given-names>
        </name>
        <article-title>An efficient algorithm for large-scale detection of protein families</article-title>
        <source>Nucleic Acids Res</source>
        <year>2002</year>
        <volume>30</volume>
        <issue>7</issue>
        <fpage>1575</fpage>
        <lpage>1584</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/30.7.1575</pub-id>
        <pub-id pub-id-type="pmid">11917018</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Cornaz</surname>
          <given-names>D</given-names>
        </name>
        <article-title>A linear programming formulation for the maximum complete multipartite subgraph problem</article-title>
        <source>Math Program, Ser B</source>
        <year>2006</year>
        <volume>105</volume>
        <fpage>329</fpage>
        <lpage>344</lpage>
        <pub-id pub-id-type="doi">10.1007/s10107-005-0656-6</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="book">
        <name>
          <surname>Guattery</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Miller</surname>
          <given-names>GL</given-names>
        </name>
        <article-title>On the performance of spectral graph partitioning methods</article-title>
        <source>Proceedings of the sixth annual ACM-SIAM Symposium on Discrete Algorithms</source>
        <year>1995</year>
        <publisher-name>Philadelphia, PA: Society for Industrial and Applied Mathematics</publisher-name>
        <fpage>233</fpage>
        <lpage>242</lpage>
      </mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Sikdar</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Kim</surname>
          <given-names>JS</given-names>
        </name>
        <article-title>Expression of a natural fusion gene for uracil phosphoribosyltransferase and uridine kinase from rice shows growth retardation by 5-fluorouridine or 5-fluorouracil in Escherichia coli</article-title>
        <source>African Journal of Biotechnology</source>
        <year>2010</year>
        <volume>9</volume>
        <issue>9</issue>
        <fpage>1295</fpage>
        <lpage>1303</lpage>
      </mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Hopcroft</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Tarjan</surname>
          <given-names>R</given-names>
        </name>
        <article-title>Efficient algorithms for graph manipulation</article-title>
        <source>Commun ACM</source>
        <year>1973</year>
        <volume>16</volume>
        <fpage>372</fpage>
        <lpage>378</lpage>
        <pub-id pub-id-type="doi">10.1145/362248.362272</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Fiedler</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Algebraic Connectivity of Graphs</article-title>
        <source>Czechoslovak Math J</source>
        <year>1973</year>
        <volume>23</volume>
        <fpage>298</fpage>
        <lpage>305</lpage>
      </mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Force</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Lynch</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Pickett</surname>
          <given-names>FB</given-names>
        </name>
        <name>
          <surname>Amores</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Yan</surname>
          <given-names>YL</given-names>
        </name>
        <name>
          <surname>Postlethwait</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Preservation of duplicate genes by complementary, degenerative mutations</article-title>
        <source>Genetics</source>
        <year>1999</year>
        <volume>151</volume>
        <issue>4</issue>
        <fpage>1531</fpage>
        <lpage>1545</lpage>
        <pub-id pub-id-type="pmid">10101175</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Fiedler</surname>
          <given-names>M</given-names>
        </name>
        <article-title>A property of eigenvectors of nonnegative symmetric matrices and its application to graph theory</article-title>
        <source>Czechoslovak Math J</source>
        <year>1975</year>
        <volume>25</volume>
        <fpage>619</fpage>
        <lpage>633</lpage>
      </mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kristensen</surname>
          <given-names>DM</given-names>
        </name>
        <name>
          <surname>Kannan</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Coleman</surname>
          <given-names>MK</given-names>
        </name>
        <name>
          <surname>Wolf</surname>
          <given-names>YI</given-names>
        </name>
        <name>
          <surname>Sorokin</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Koonin</surname>
          <given-names>EV</given-names>
        </name>
        <name>
          <surname>Mushegian</surname>
          <given-names>A</given-names>
        </name>
        <article-title>A low-polynomial algorithm for assembling clusters of orthologous groups from intergenomic symmetric best matches</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>1481</fpage>
        <lpage>1487</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq229</pub-id>
        <pub-id pub-id-type="pmid">20439257</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lanczos</surname>
          <given-names>C</given-names>
        </name>
        <article-title>An Iteration Method for the Solution of the Eigenvalue Problem of Linear Differential and Integral Operators</article-title>
        <source>J Res Natl Bureau Standards</source>
        <year>1950</year>
        <volume>45</volume>
        <fpage>255</fpage>
        <lpage>281</lpage>
      </mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Pruesse</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Quast</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Knittel</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Fuchs</surname>
          <given-names>BM</given-names>
        </name>
        <name>
          <surname>Ludwig</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Peplies</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Glöckner</surname>
          <given-names>FO</given-names>
        </name>
        <article-title>SILVA: a comprehensive online resource for quality checked and aligned ribosomal RNA sequence data compatible with ARB</article-title>
        <source>Nucleic Acids Res</source>
        <year>2007</year>
        <volume>35</volume>
        <issue>21</issue>
        <fpage>7188</fpage>
        <lpage>7196</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkm864</pub-id>
        <pub-id pub-id-type="pmid">17947321</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B31">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Nakabachi</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Yamashita</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Toh</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Ishikawa</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Dunbar</surname>
          <given-names>HE</given-names>
        </name>
        <name>
          <surname>Moran</surname>
          <given-names>NA</given-names>
        </name>
        <name>
          <surname>Hattori</surname>
          <given-names>M</given-names>
        </name>
        <article-title>The 160-kilobase genome of the bacterial endosymbiont Carsonella</article-title>
        <source>Science</source>
        <year>2006</year>
        <volume>314</volume>
        <issue>5797</issue>
        <fpage>267</fpage>
        <pub-id pub-id-type="doi">10.1126/science.1134196</pub-id>
        <pub-id pub-id-type="pmid">17038615</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B32">
      <mixed-citation publication-type="journal">
        <name>
          <surname>McCutcheon</surname>
          <given-names>JP</given-names>
        </name>
        <name>
          <surname>Moran</surname>
          <given-names>NA</given-names>
        </name>
        <article-title>Parallel genomic evolution and metabolic interdependence in an ancient symbiosis</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2007</year>
        <volume>104</volume>
        <issue>49</issue>
        <fpage>19392</fpage>
        <lpage>19397</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0708855104</pub-id>
        <pub-id pub-id-type="pmid">18048332</pub-id>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3114741</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-12-124</article-id>
    <article-id pub-id-type="pmid">21526987</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-12-124</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><monospace>Proteinortho</monospace>: Detection of (Co-)orthologs in large-scale analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes" id="A1">
        <name>
          <surname>Lechner</surname>
          <given-names>Marcus</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>lechner@staff.uni-marburg.de</email>
      </contrib>
      <contrib contrib-type="author" id="A2">
        <name>
          <surname>Findeiß</surname>
          <given-names>Sven</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <xref ref-type="aff" rid="I4">4</xref>
        <email>sven@bioinf.uni-leipzig.de</email>
      </contrib>
      <contrib contrib-type="author" id="A3">
        <name>
          <surname>Steiner</surname>
          <given-names>Lydia</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <xref ref-type="aff" rid="I3">3</xref>
        <xref ref-type="aff" rid="I4">4</xref>
        <email>lydia@bioinf.uni-leipzig.de</email>
      </contrib>
      <contrib contrib-type="author" id="A4">
        <name>
          <surname>Marz</surname>
          <given-names>Manja</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>manja@staff.uni-marburg.de</email>
      </contrib>
      <contrib contrib-type="author" id="A5">
        <name>
          <surname>Stadler</surname>
          <given-names>Peter F</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <xref ref-type="aff" rid="I4">4</xref>
        <xref ref-type="aff" rid="I5">5</xref>
        <xref ref-type="aff" rid="I6">6</xref>
        <xref ref-type="aff" rid="I7">7</xref>
        <xref ref-type="aff" rid="I8">8</xref>
        <xref ref-type="aff" rid="I9">9</xref>
        <email>studla@bioinf.uni-leipzig.de</email>
      </contrib>
      <contrib contrib-type="author" id="A6">
        <name>
          <surname>Prohaska</surname>
          <given-names>Sonja J</given-names>
        </name>
        <xref ref-type="aff" rid="I3">3</xref>
        <xref ref-type="aff" rid="I4">4</xref>
        <email>sonja@bioinf.uni-leipzig.de</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>RNA Bioinformatics Group, Department of Pharmaceutical Chemistry, Philipps-University Marburg, Marbacher Weg 6, D-35037 Marburg, Germany</aff>
    <aff id="I2"><label>2</label>Bioinformatics Group, Department of Computer Science, Härtelstraße 16-18, D-04107, Leipzig, Germany</aff>
    <aff id="I3"><label>3</label>Bioinformatics in EvoDevo Group, Department of Computer Science, University of Leipzig, Härtelstraße 16-18, D-04107, Leipzig, Germany</aff>
    <aff id="I4"><label>4</label>Interdisciplinary Center for Bioinformatics, University of Leipzig, Härtelstraße 16-18, D-04107, Leipzig, Germany</aff>
    <aff id="I5"><label>5</label>Max Planck Institute for Mathematics in the Sciences, Inselstraße 22 D-04103 Leipzig, Germany</aff>
    <aff id="I6"><label>6</label>Fraunhofer Institute for Cell Therapy and Immunology, Perlickstraße 1, D-04103 Leipzig, Germany</aff>
    <aff id="I7"><label>7</label>Institute for Theoretical Chemistry, University of Vienna, Währingerstraße 17, A-1090 Wien, Austria</aff>
    <aff id="I8"><label>8</label>Center for non-coding RNA in Technology and Health, University of Copenhagen, Grønnegårdsvej 3, DK-1870 Frederiksberg C, Denmark</aff>
    <aff id="I9"><label>9</label>Santa Fe Institute, 1399 Hyde Park Rd, Santa Fe, NM 87501, USA</aff>
    <pub-date pub-type="collection">
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>28</day>
      <month>4</month>
      <year>2011</year>
    </pub-date>
    <volume>12</volume>
    <fpage>124</fpage>
    <lpage>124</lpage>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>12</month>
        <year>2010</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>4</month>
        <year>2011</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright ©2011 Lechner et al; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2011</copyright-year>
      <copyright-holder>Lechner et al; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://www.biomedcentral.com/1471-2105/12/124"/>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Orthology analysis is an important part of data analysis in many areas of bioinformatics such as comparative genomics and molecular phylogenetics. The ever-increasing flood of sequence data, and hence the rapidly increasing number of genomes that can be compared simultaneously, calls for efficient software tools as brute-force approaches with quadratic memory requirements become infeasible in practise. The rapid pace at which new data become available, furthermore, makes it desirable to compute genome-wide orthology relations for a given dataset rather than relying on relations listed in databases.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>The program <monospace>Proteinortho</monospace> described here is a stand-alone tool that is geared towards large datasets and makes use of distributed computing techniques when run on multi-core hardware. It implements an extended version of the reciprocal best alignment heuristic. We apply <monospace>Proteinortho</monospace> to compute orthologous proteins in the complete set of all 717 eubacterial genomes available at NCBI at the beginning of 2009. We identified thirty proteins present in 99% of all bacterial proteomes.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p><monospace>Proteinortho</monospace> significantly reduces the required amount of memory for orthology analysis compared to existing tools, allowing such computations to be performed on off-the-shelf hardware.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Genome annotation largely depends on the determination of sequence intervals that are homologous, and if possible, orthologous to sequences of known identity and function in related genomes. Orthologous genes (orthologs) are derived from a common ancestor by a speciation event [<xref ref-type="bibr" rid="B1">1</xref>]. Orthologs are of particular interest because they can be expected to have maintained at least part of their (ancestral) biological function. For protein-coding genes, several well-known databases, including <monospace>InParanoid</monospace>[<xref ref-type="bibr" rid="B2">2</xref>], <monospace>OrthoMCL-DB</monospace>[<xref ref-type="bibr" rid="B3">3</xref>], <monospace>COG-database</monospace>[<xref ref-type="bibr" rid="B4">4</xref>], <monospace>Homogene</monospace>[<xref ref-type="bibr" rid="B5">5</xref>], <monospace>eggNOG</monospace>[<xref ref-type="bibr" rid="B6">6</xref>], <monospace>OMA Browser</monospace>[<xref ref-type="bibr" rid="B7">7</xref>] and <monospace>Ensembl Compara</monospace>[<xref ref-type="bibr" rid="B8">8</xref>] compile such information. Their content is restricted to data <italic>previously </italic>published in comprehensive databases of protein sequences such as <monospace>UniProt</monospace>[<xref ref-type="bibr" rid="B9">9</xref>]. Updates with additional proteomic data thus are published relatively infrequently. Modern high-throughput technologies, however, produce huge amounts of protein data and even larger amounts of transcript data that are computationally translated to putative polypeptide sequences. Oftentimes, therefore, it would be desirable to generate the orthology relation for a particular dataset, so that the availability of orthology data does not limit the set of species or genes that can be included.</p>
    <p>The computation of genome-wide orthology data, however, is a challenging and time consuming task with the currently available tools. In many cases, orthologs cannot be identified unambiguously by means of sequence comparison. The main difficulty arises from the presence of paralogs (homologous genes within the same genome) which can make it very difficult to recognize the correct ortholog among the other homologs. Gene duplications following the speciation, furthermore, create two or more genes in one lineage that are, collectively, orthologous to one or more genes in another lineage. Such genes are known as co-orthologs [<xref ref-type="bibr" rid="B10">10</xref>].</p>
    <p>The most widely used approach to identify (putative) orthologs between two species is the <italic>reciprocal best alignment heuristic </italic>[<xref ref-type="bibr" rid="B11">11</xref>-<xref ref-type="bibr" rid="B15">15</xref>]. <italic>This approach </italic>was more recently extended e.g. in <monospace>OrthoMCL</monospace>[<xref ref-type="bibr" rid="B16">16</xref>] and <monospace>MultiParanoid</monospace>[<xref ref-type="bibr" rid="B17">17</xref>] to detect (co-)orthologs within multiple species. All these tools, however, are limited to relatively small sets of species. In practise, analyzing the complete proteomes of more than about 50 prokaryote species goes beyond the capabilities of standard hardware and requires access to supercomputer resources. This limitation arises from both, technical issues such as insufficient parallelization and the algorithmic design that requires all reasonable alignments for each input protein to be held in the memory for efficient access in the clustering stage. <monospace>Proteinortho</monospace> is specifically designed to deal with hundreds of species together containing millions of proteins. It achieves this performance both by optimizing the implementation and by modifying the reciprocal best alignment method in a way that allows alignment processing on the fly.</p>
  </sec>
  <sec>
    <title>Results and Discussion</title>
    <sec>
      <title>Orthology prediction</title>
      <sec>
        <title>Theory</title>
        <p>As for other approaches to large-scale orthology detection, the starting point is a complete collection of pairwise comparisons, typically performed using <monospace>blast</monospace>. For simplicity of presentation, we assume that the individual sequences that are compared represent proteins, although algorithms and pipelines are applicable also to other sequence data such as non-coding RNA genes or conserved DNA regions. Typically, the results of pairwise comparisons are ranked by similarity, for instance based on <monospace>blast</monospace> statistics, evolutionary distances, or genome rearrangement analysis [<xref ref-type="bibr" rid="B7">7</xref>,<xref ref-type="bibr" rid="B16">16</xref>,<xref ref-type="bibr" rid="B18">18</xref>]. High-ranking alignments across multiple species then have to be combined in order to determine orthologous groups. However, these groups usually do not readily provide detailed insights since they can contain large numbers of related genes for each species. Hence, meaningful units have to be identified. For this purpose, a variety of clustering algorithms has been applied to determine <italic>Clusters of Orthologous Groups </italic>(COGs). The <monospace>MCL</monospace>-algorithm for instance uses a stochastic flow simulation to determine meaningful COGs [<xref ref-type="bibr" rid="B16">16</xref>,<xref ref-type="bibr" rid="B19">19</xref>,<xref ref-type="bibr" rid="B20">20</xref>]. In addition, <monospace>MultiParanoid</monospace> explicitly searches and tags in-paralogs, i.e., recent paralogs that represent species-specific gene expansions. This strategy requires to directly compare proteins within each species. Alternatively, data were curated by manual postprocessing [<xref ref-type="bibr" rid="B4">4</xref>].</p>
        <p>We will argue here that orthology determination can be understood as the problem of finding <italic>nearly </italic>disjoint maximal <italic>nearly</italic>-complete multipartite subgraphs in an edge-weighted directed graph <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i1.gif"/></inline-formula> whose vertices are the proteins in the input set, and whose edges connect certain pairs of similar proteins of different species. The edge weights <italic>ω</italic><sub><italic>x</italic>→<italic>y </italic></sub>encode the similarity of <italic>x </italic>and <italic>y</italic>. In our implementation, the bit score of the <monospace>blast</monospace> alignment (<italic>x </italic>→ <italic>y</italic>) will serve as edge weight. An <italic>E</italic>-value cut-off is used beyond which <monospace>blast</monospace> alignments are not included into <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i1.gif"/></inline-formula>.</p>
        <p>In order to motivate our point of view, we first consider an idealized dataset (see Figure <xref ref-type="fig" rid="F1">1</xref>) in which (1) each protein <italic>x </italic>(from species <italic>A</italic>) has at most one ortholog in any other species <italic>B </italic>≠ <italic>A</italic>, (2) if <italic>y </italic>∈ <italic>B </italic>is an ortholog of <italic>x </italic>∈ <italic>A</italic>, then a <monospace>blast</monospace> search of <italic>x </italic>against <italic>B </italic>yields at least one alignment and (3) the unique best alignment of query <italic>x </italic>against <italic>B </italic>is the true ortholog <italic>y </italic>of <italic>x</italic>. In this case, the well-know "reciprocal best alignment heuristic" (RBAH), also known as "reciprocal best hits" (RBH) [<xref ref-type="bibr" rid="B11">11</xref>], can be used to retrieve the correct ortholog set. To see this, we construct a subgraph <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i2.gif"/></inline-formula> of <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i1.gif"/></inline-formula> as follows: For each protein <italic>x </italic>in species <italic>A </italic>and a given species <italic>B </italic>≠ <italic>A </italic>we retain only the arc with maximal weight:<disp-formula id="bmcM1"><label>(1)</label><graphic xlink:href="1471-2105-12-124-i3.gif"/></disp-formula></p>
        <fig id="F1" position="float">
          <label>Figure 1</label>
          <caption>
            <p><bold>Orthology relations</bold>. Idealized dataset for two species <italic>A </italic>and <italic>B</italic>. Proteins <italic>x </italic>∈ <italic>A </italic>and <italic>y </italic>∈ <italic>B </italic>are depicted by open boxes. Orthology relations between proteins <italic>x </italic>and <italic>y </italic>are represented by grey shadows. Arrows indicate alignments above a certain cut-off from the search of <italic>x </italic>against <italic>B</italic>. Solid lines refer to the best alignments. Cases (1), (2), and (3) cannot occur by definition in an idealized dataset, but of course do appear in real life applications.</p>
          </caption>
          <graphic xlink:href="1471-2105-12-124-1"/>
        </fig>
        <p>The symmetric subgraph of <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i2.gif"/></inline-formula>, containing only reciprocal best alignments, can be regarded as an undirected graph ϒ<italic><sub>RBAH</sub></italic>. By construction, any two vertices are connected by edges in ϒ<italic><sub>RBAH </sub></italic>if and only if they are orthologs. A set of orthologs therefore corresponds to a complete multipartite subgraph of <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i2.gif"/></inline-formula> in which every species is represented at most once. Furthermore, we note that these subgraphs are disjoint, i.e., ortholog sets correspond to the connected components of <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i2.gif"/></inline-formula>.</p>
        <p>When applied to real data, however, RBAH usually gives rise to several artifacts. In general, therefore, it does not produce correct and complete sets of orthologs. First, gene duplications produce co-orthologs, destroying the uniqueness of best <monospace>blast</monospace> alignments. The <monospace>blast</monospace> comparison of two species both containing two co-orthologs will in general produce slightly different scores among those genes, so that <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i2.gif"/></inline-formula> in general will not contain all arcs between them, see Figure <xref ref-type="fig" rid="F2">2a</xref>. RBAH now extracts the symmetric part of <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i2.gif"/></inline-formula>, i.e., it removes all non-reciprocal edges. Thus the undirected graph ϒ<italic><sub>RBAH </sub></italic>has an edge {<italic>x</italic>, <italic>y</italic>} if and only if both (<italic>x</italic>, <italic>y</italic>) and (<italic>y</italic>, <italic>x</italic>) are arcs in <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i2.gif"/></inline-formula>. A missing arc in the example of Figure <xref ref-type="fig" rid="F2">2a</xref> thus translates into a missing edge in ϒ<italic><sub>RBAH</sub></italic>. Ortholog sets, therefore, are still located in disjoint connected components, but they are only approximately multipartite and there is no guarantee that they remain connected. As a remedy, it could be proposed to use the <italic>k</italic>-best <monospace>blast</monospace> alignments instead of a single best one. This leads, however, to another type of artifact: If distant homologs or spurious <monospace>blast</monospace> alignments with scores above the <monospace>blast</monospace> threshold are present, see Figure <xref ref-type="fig" rid="F2">2b</xref>, the inclusion of up to <italic>k </italic>alignments can result in edges between paralogous but non-orthologous proteins.</p>
        <fig id="F2" position="float">
          <label>Figure 2</label>
          <caption>
            <p><bold>Adaptive RBAH</bold>. Reciprocal best alignment heuristic (RBAH). (a) If there is a pair of divergent co-orthologs <italic>x</italic><sub>1</sub>, <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i4.gif"/></inline-formula>, and <italic>y</italic><sub>1 </sub>and <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i5.gif"/></inline-formula>, resp., it is possible that there are no <italic>reciprocal </italic>best <monospace>blast</monospace> alignments. In this situation, RBAH will not identify any orthologs. (b) One possible remedy is to include the second best <monospace>blast</monospace> alignment (<italic>n </italic>= 2). However, in this case highly similar orthologs (<italic>x</italic><sub>2 </sub>and <italic>y</italic><sub>2 </sub>as well as <italic>x</italic><sub>3 </sub>and <italic>y</italic><sub>3</sub>), which in principle can clearly be divided, can get combined. (c) <monospace>Proteinortho</monospace> uses an adaptive approach that is (1) flexible with respect to the number of more diverged orthologs in absence of a reciprocal best <monospace>blast</monospace> alignment and (2) will not intermix orthologous groups that can be disentangled easily because of large differences in pairwise similarity.</p>
          </caption>
          <graphic xlink:href="1471-2105-12-124-2"/>
        </fig>
        <p>In order to reduce such problems, we suggest to introduce a similarity cut-off value that itself depends on the quality of the matches, i.e., to consider all those <monospace>blast</monospace> alignments of each query against a given species whose <italic>E</italic>-values are only slightly smaller (by a factor <italic>f </italic>&lt; 1) than the queries' best <monospace>blast</monospace> alignments. More precisely,<disp-formula id="bmcM2"><label>(2)</label><graphic xlink:href="1471-2105-12-124-i6.gif"/></disp-formula></p>
        <p>This has two advantages: it retains edges to likely co-orthologs while at the same time reducing the number of edges that are inserted in <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i7.gif"/></inline-formula>.</p>
        <p>The symmetric part ϒ* of <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i7.gif"/></inline-formula> now retains more edges than ϒ<italic><sub>RBAH</sub></italic>. In particular, it includes all the edges connecting similar co-orthologs. On the other hand, the threshold at fairly high bit scores disconnects at least most of the more distant homologs. Sets of (co-)orthologs thus appear in ϒ* as nearly complete multipartite subgraphs. Typically they will contain more than one node from the same species, among them, in particular, all in-paralogs. Although this approach strongly reduces the problem with spurious edges, ϒ* may also contain additional edges connecting two or more sets of (co-)orthologs.</p>
        <p>The problem of finding maximal complete multipartite subgraphs of a graph is NP complete [<xref ref-type="bibr" rid="B21">21</xref>]. Furthermore, we have seen above that ϒ* may lack a few edges which should connect orthologs ("false negatives"), while at the same time there are also some additional "false positive" edges. In a two-species comparison there is no information that could compensate missing and spurious edges, while in the multi-species case, the graph ϒ* is in a sense "self-correcting" since we can formulate orthology detection as an optimization problem. More precisely, we search for a decomposition of ϒ* into a disjoint collection of complete multipartite subgraphs so that the number of edge insertions and deletions is minimized.</p>
        <p>Since no efficient approaches to this combinatorial optimization problem seem to be known, it appears fruitful to resort to a heuristic approach that employs a somewhat different point of view: nearly complete multipartite subgraphs are very dense subgraphs, which in our case either form connected components on their own, or which are connected to other dense clusters by a few additional edges. The problem thus is to determine for each connected component ϒ* of whether it is sufficiently densely connected, and if not, to partition it into its densely connected components by removing the spurious edges connecting them. Here, we approach this issue by means of spectral partitioning [<xref ref-type="bibr" rid="B22">22</xref>], see Additional File <xref ref-type="supplementary-material" rid="S1">1</xref> for a detailed description.</p>
        <p>We remark, finally, that one could efficiently add the explicit determination of in-paralogs after ϒ* has been constructed, although currently this is not implemented in <monospace>Proteinortho</monospace>. Following e.g. <monospace>InParanoid</monospace>, sets of in-paralogs are subsets of proteins from the same species within the same connected component ϒ* of that are more similar to each other than to any protein in another species. It is sufficient, thus, to determine alignment scores for pairs of nodes from the same species within connected components of ϒ*. As in <monospace>MultiParanoid</monospace>, in-paralogs could be collapsed to a single node.</p>
      </sec>
      <sec>
        <title>Implementation</title>
        <sec>
          <title><monospace>Blast</monospace> searches</title>
          <p><monospace>Proteinortho</monospace> expects <monospace>fasta</monospace> files containing either nucleic acid or amino acid sequences as input. <monospace>Proteinortho</monospace> does not build a large database containing all proteins but rather keeps the protein complements of different species separate. This has multiple advantages: (1) the <monospace>blast</monospace> step can be partitioned into multiple runs. The available processor cores are used efficiently as each <monospace>blast</monospace> process can utilize one processor core to the full, which is usually not the case if threading is handled by <monospace>blast</monospace> itself. Furthermore, the <monospace>blast</monospace> jobs can be distributed to several computers in a network. (2) The computationally expensive <monospace>blast</monospace> search of species against themselves (which is implicit in searching a comprehensive protein database) can be avoided. (3) The <italic>E</italic>-values returned by <monospace>blast</monospace> depend only on the proteome of each input species, not on the database of all input sequences. Therefore, <monospace>Proteinortho</monospace> implicitly enforces higher similarity for related proteomes but allows lower levels of similarity for larger evolutionary distances. Conceptually, this replaces the normalization of the scores employed e.g. by <monospace>OrthoMCL</monospace>. (4) The scope of the analysis can be extended without the need to re-compute <monospace>blast</monospace> comparisons that have already been computed earlier. The <italic>E</italic>-values remain unchanged when species are included or excluded from the analysis. <monospace>Proteinortho</monospace> can use several PCs with a shared storage (such as an NFS file system). The implementation of distributed computing is illustrated in Additional File <xref ref-type="supplementary-material" rid="S2">2</xref>. Furthermore, cluster infrastructure (e.g. <monospace>MPI</monospace> or <monospace>SGE</monospace>) is supported. A benchmark illustrating the performance improvements is shown in Figure <xref ref-type="fig" rid="F3">3a</xref>. <monospace>Proteinortho</monospace> is faster than <monospace>OrthoMCL</monospace> even if only a single processor core is available and gains much of its practical advantage from parallelization. In applications to large numbers of species, for which <monospace>Proteinortho</monospace> is primarily intended, handling <monospace>blast</monospace> alignments dominates the spectral partitioning step by several orders of magnitude. As <monospace>blast</monospace> and the memory consumption of holding the graph structure for clustering are limiting, we do not investigate the complexity of the clustering step itself in detail.</p>
          <fig id="F3" position="float">
            <label>Figure 3</label>
            <caption>
              <p><bold>Benchmarks</bold>. CPU time and memory requirements of <monospace>Proteinortho</monospace>. (a) The speed benchmark was performed using an <italic>E. coli </italic>strain with 4132 proteins on an eight core Intel Xeon system using one thread (1) and eight threads (8) at 2.33 GHz. The encoded proteins were used multiple times to simulate multiple (identical) species. This is the worst case scenario for <monospace>Proteinortho</monospace> since in this case every protein has a link to at least one protein in every other species. <monospace>Proteinortho</monospace> is significantly faster than <monospace>OrthoMCL</monospace>. Using multiple threads we observe a substantial speed up. (b) The memory benchmark is performed using the same set as in (a). <monospace>OrthoMCL</monospace> quickly exhausts memory for larger sets. <monospace>Proteinortho</monospace> clearly performs more efficient, even though this artificial scenario is a more complex case than real world analysis. Both benchmarks outline that <monospace>Proteinortho</monospace> allows comprehensive studies which were not possible before.</p>
            </caption>
            <graphic xlink:href="1471-2105-12-124-3"/>
          </fig>
          <p>Most importantly, the algorithm outlined in the previous section avoids the memory bottleneck that limits previous approaches. Suppose our input set comprises <italic>N </italic>species with, on average, <italic>m </italic>genes. The size of the input is thus <italic>n </italic>= <italic>N </italic>× <italic>m </italic>proteins. Instead of storing all <italic>n </italic>× <italic>n </italic>pairwise <monospace>blast</monospace> scores, <monospace>Proteinortho</monospace> processes the comparisons between any two species <italic>A </italic>and <italic>B </italic>immediately: first the <monospace>blast</monospace> alignments are filtered by two additional criteria: (1) The alignment must exhibit a minimum level of sequence identity. (2) The alignment must cover at least a minimum fraction of the query protein. This second rule ensures that fusion genes such as rice OsUK/UPRT1 [<xref ref-type="bibr" rid="B23">23</xref>] are eventually assigned as homologs of the dominating part of the protein. Then equ.(2) is evaluated for all <italic>x </italic>in <italic>A</italic>, so that <monospace>Proteinortho</monospace> directly constructs the sparse graph <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i7.gif"/></inline-formula>, while <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i1.gif"/></inline-formula> does not need to be stored at all. <monospace>Proteinortho</monospace> therefore uses chained arrays, requiring only <italic>n </italic>× <italic>k </italic>entries, where <italic>k </italic>is the average number of nearly optimal <monospace>blast</monospace> alignments per gene, and <italic>k </italic>= <italic>a </italic>× <italic>N</italic>, where <italic>a </italic>is the average number of (co-)orthologs of a gene in a single species. The value of <italic>a </italic>is independent of the size of the dataset. Empirically, we found <italic>a </italic>≤ 1 in all datasets investigated so far. Thus <monospace>Proteinortho</monospace> saves a factor <italic>n</italic><sup>2</sup>/<italic>N</italic><sup>2</sup><italic>ma </italic>= <italic>m</italic>/<italic>a </italic>≥ <italic>m </italic>of memory. Note that prokaryotes have <italic>m </italic>≈ 10<sup>3 </sup>... 10<sup>4 </sup>proteins.</p>
        </sec>
        <sec>
          <title>Spectral partitioning</title>
          <p>First we reduce the problem by determining the connected components ϒ* of since these can be treated separately. We use the well-known breath-first search approach [<xref ref-type="bibr" rid="B24">24</xref>] to this end. In order to check whether a connected component Ξ is sufficiently dense to represent a single set of co-orthologs we compute its normalized algebraic connectivity <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i8.gif"/></inline-formula>. Here <italic>n </italic>is the number of vertices of Ξ and <italic>αalpha</italic><sub>2 </sub>is 2nd-smallest eigenvalue of the graph Laplacian <bold>L </bold>= <bold>D </bold>- <bold>A </bold>of Ξ [<xref ref-type="bibr" rid="B25">25</xref>]. Here <bold>A </bold>is the adjacency matrix of Ξ and <bold>D </bold>is the diagonal matrix of the vertex degrees. The eigenvalue <italic>αalpha</italic><sub>2 </sub>can be computed iteratively, see Additional File <xref ref-type="supplementary-material" rid="S1">1</xref>. Values of <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i9.gif"/></inline-formula> indicate dense clusters that most likely correspond to coherent sets of (co-)orthologs. Small values <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i10.gif"/></inline-formula>, on the other hand indicate that Ξ has a low connectivity and either consists of two or more dense components or it has (nearly) tree-like protrusions. Very large components <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i11.gif"/></inline-formula> can arise when genes duplicate frequently and diverge quickly according to the duplication-degeneration-complementation (DDC) model [<xref ref-type="bibr" rid="B26">26</xref>].</p>
          <p>The "Fiedler vector" <bold>x</bold><sub>2</sub>, i.e., the eigenvector of <bold>L </bold>to eigenvalue <italic>α</italic><sub>2 </sub>can be used to find a partition of Ξ into two connected components, one consisting of the vertices for which <bold>x</bold><sub>2 </sub>has positive entries and one for which <bold>x</bold><sub>2 </sub>has negative entries [<xref ref-type="bibr" rid="B27">27</xref>]. This decomposition is iterated until Ξ is partitioned into components with algebraic connectivity <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i10.gif"/></inline-formula> above a certain threshold value and tree-like pieces, which most likely correspond to false-positive edges of ϒ*. In order to speed up the computation, trees are therefore removed from the component Ξ before the algebraic connectivity and the Fiedler vector is computed. This is achieved by iteratively removing a vertex of degree 1 and its adjacent edge. This step is not performed if <monospace>Proteinortho</monospace> is used to compare only two species.</p>
          <p>We remark that the memory and CPU consumption for the clustering step of <monospace>OrthoMCL</monospace> can be drastically reduced by using a novel algorithm [<xref ref-type="bibr" rid="B28">28</xref>], reaching a performance that is theoretically comparable to spectral partitioning as used by <monospace>Proteinortho</monospace> (see Additional File <xref ref-type="supplementary-material" rid="S1">1</xref>). Both require only the storage of edge or adjacency lists. The current implementation of spectral partitioning could be further optimized e.g. by employing the Lanczos algorithm [<xref ref-type="bibr" rid="B29">29</xref>] for computing the eigenvalues. Spectral partitioning on average scales as <italic>O</italic>(<italic>n</italic><sup>2</sup><italic>k</italic>). This leads to an expected runtime of <italic>O</italic>(<italic>N</italic><sup>3</sup>) for <monospace>Proteinortho</monospace> which is comparable to the <italic>O</italic>(<italic>N</italic><sup>3 </sup>log <italic>N</italic>) complexity bound achieved for COG clustering in [<xref ref-type="bibr" rid="B28">28</xref>].</p>
        </sec>
      </sec>
    </sec>
    <sec>
      <title>
        <bold>Evaluation of </bold>
        <monospace>Proteinortho</monospace>
      </title>
      <p>We compared <monospace>Proteinortho</monospace> with the COG-database [<xref ref-type="bibr" rid="B4">4</xref>] and <monospace>OrthoMCL</monospace>[<xref ref-type="bibr" rid="B3">3</xref>]. The latter is the main competitor in terms of speed and memory. The <monospace>COG</monospace>-database provides a manually curated dataset that can be regarded as more reliable than fully automated approaches. For benchmark analysis, a set of 16 randomly chosen bacteria from three different classes (six Gram-positive bacilli, six gamma- and four alpha-proteobacteria) are used. The input set comprises 53, 623 protein sequences.</p>
      <p>Figure <xref ref-type="fig" rid="F4">4</xref> summarizes the size distribution of co-ortholog sets for the three approaches. Using default settings (<italic>E</italic>-value cutoff 10<sup>-10</sup>, algebraic connectivity threshold <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i12.gif"/></inline-formula>, minimum 25% identity, 50% coverage of query sequence, similarity threshold <italic>f </italic>= 0.95) Both <monospace>Proteinortho</monospace> and <monospace>OrthoMCL</monospace> report fewer groups than listed in the <monospace>COG</monospace>-database. This is not surprising, however, since the <monospace>COG</monospace>-database relies on less restrictive criteria and thus tends to include multiple co-orthologs, while both stand-alone tools apply clustering algorithms that attempt to split the large components whenever possible.</p>
      <fig id="F4" position="float">
        <label>Figure 4</label>
        <caption>
          <p><bold>Coverage completion</bold>. Comparison of the results of <monospace>Proteinortho</monospace> with different thresholds of the normalized algebraic connectivity <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i13.gif"/></inline-formula> with the <monospace>COG</monospace>-database and <monospace>OrthoMCL</monospace> for a dataset consisting of 16 randomly chosen bacterial proteomes. The vertical dashed line marks the transition from clusters containing mainly a single ortholog from each species to sets including co-orthologs. The <monospace>COG</monospace>-database reports many large groups which often include co-orthologous proteins. <monospace>OrthoMCL</monospace> and <monospace>Proteinortho</monospace> focus on highly connected subsets in order to find orthologous sets and thus split those groups. Thereby, <monospace>Proteinortho</monospace>'s clustering algorithm becomes more stringent with increasing values of <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i10.gif"/></inline-formula> in splitting in particular large groups. While these groups are left intact for <inline-formula><inline-graphic xlink:href="1471-2105-12-124-i14.gif"/></inline-formula>, thresholds of 0.5 and higher drastically reduce the fraction of included co-orthologs.</p>
        </caption>
        <graphic xlink:href="1471-2105-12-124-4"/>
      </fig>
      <p>Figure <xref ref-type="fig" rid="F5">5</xref> presents the outcome in more detail. <monospace>Proteinortho</monospace> and <monospace>OrthoMCL</monospace> report comparable results. <monospace>Proteinortho</monospace> is more stringent. The amount of completely new groups which have to be regarded as false positives is considerably lower. <monospace>OrthoMCL</monospace> reports slightly more groups. Even though both tools were applied with the same E-value threshold the results vary due to the different <monospace>blast</monospace> strategies: <monospace>OrthoMCL</monospace> employs one large database containing all proteins, while <monospace>Proteinortho</monospace> uses species-specific databases. Most pairwise <italic>E</italic>-values derived by <monospace>Proteinortho</monospace> thus tend to be somewhat larger than those derived by <monospace>OrthoMCL</monospace> for the same set of proteins. In turn, <monospace>OrthoMCL</monospace> reports some more and larger groups. However, the overall outcome can be regarded as similar while the runtime and memory requirements of <monospace>Proteinortho</monospace> are substantially reduced in comparison to <monospace>OrthoMCL</monospace>.</p>
      <fig id="F5" position="float">
        <label>Figure 5</label>
        <caption>
          <p><bold>Comparison of results</bold>. Comparison of <monospace>OrthoMCL</monospace> and <monospace>Proteinortho</monospace> to the <monospace>COG</monospace>-database. The following assignments were defined: identity: the group equals a <monospace>COG</monospace>-group; subset: the group is subset of a <monospace>COG</monospace>-group, at least two proteins are equal; superset: the group is a superset of a <monospace>COG</monospace>-group, at least two proteins are equal; new: none of the above-noted criteria matched. Both tools reveal comparable results with respect to the manually curated <monospace>COG</monospace>-database. <monospace>OrthoMCL</monospace> covers more identical and differently composed groups while <monospace>Proteinortho</monospace> is more restrictive and reports fewer new groups which are not present in the <monospace>COG</monospace>-database. All groups with less than six species were omitted from the <monospace>OrthoMCL</monospace> and <monospace>Proteinortho</monospace> data. See Additional File <xref ref-type="supplementary-material" rid="S2">2</xref> for comparisons with different minimal coverage.</p>
        </caption>
        <graphic xlink:href="1471-2105-12-124-5"/>
      </fig>
    </sec>
    <sec>
      <title>Domain-wide commons</title>
      <p>In order to demonstrate that <monospace>Proteinortho</monospace> is suitable for large-scale analysis we asked <italic>Which proteins can be found in all bacterial species? </italic>Proteins that are conserved domain-wide are likely to be useful for the construction of a phylogeny of eubacteria as an alternative to the prevalent usage of 16<italic>S </italic>rRNA sequences [<xref ref-type="bibr" rid="B30">30</xref>]. They can also serve as protein-based markers for identifying novel bacterial species as members of an established phylogenetic group. In addition, they can give insight into basic protein equipment of bacterial life. Hence, we applied <monospace>Proteinortho</monospace> to the set of all eubacterial proteomes available at NCBI at the beginning of 2009 (Additional File <xref ref-type="supplementary-material" rid="S3">3</xref>).</p>
      <p>The input dataset comprises 2, 155, 620 proteins annotated in 717 bacterial genomes. The <monospace>Proteinortho</monospace> run took less than two weeks using 50 processor cores (Intel Xeon at 2.00-2.33 GHz) distributed over multiple PCs. Only 2 GB memory were required. <monospace>OrthoMCL</monospace> could not be employed for this task on the hardware available in our lab. Extrapolating from the benchmarks in Figure <xref ref-type="fig" rid="F3">3</xref>, we estimate that hundreds of gigabytes of memory and years of runtime would have been required.</p>
      <p><monospace>Proteinortho</monospace> identified 152 proteins as core of the bacterial protein complement, occurring in at least 90% of all 717 free-living and endosymbiotic bacteria. Of these, 32 are ribosomal subunits. The 30 apparently most indispensable proteins, occurring in 99% of all bacteria, are:</p>
      <p>Elongation factor Tu (often co-orthologous to elongation factor 1-alpha)</p>
      <p>Elongation factor G</p>
      <p>Translation initiation factor IF-2</p>
      <p>RNA polymerase subunits <italic>β </italic>and <italic>β'</italic></p>
      <p>ATP-dependent metalloprotease FtsH</p>
      <p>O-sialoglycoprotein endopeptidase</p>
      <p>Methionine aminopeptidase</p>
      <p>F0F1 ATP synthase subunits <italic>α </italic>and <italic>β</italic></p>
      <p>Dimethyladenosine transferase</p>
      <p>1 ribosomal protein of the <italic>30S </italic>rRNA subunit</p>
      <p>3 ribosomal proteins of the <italic>50S </italic>rRNA subunit</p>
      <p>3 GTP-binding proteins</p>
      <p>12 tRNA synthetases</p>
      <p>A more detailed list, including unique identifiers for groups of proteins can be found in the supplemental material. The sensitivity of <monospace>Proteinortho</monospace> in this survey is limited by incomplete annotation in many species, which we complemented here by <monospace>tblastn</monospace> searches with fairly restrictive cut-off values, see Methods for details. Figure <xref ref-type="fig" rid="F6">6</xref> summarizes the results quantitatively, emphasizing the effect of incomplete annotation. We remark that this example also shows that <monospace>Proteinortho</monospace> can be used to complement existing annotations in an automatic fashion.</p>
      <fig id="F6" position="float">
        <label>Figure 6</label>
        <caption>
          <p><bold>Orthologous groups</bold>. Number of orthologous groups present in nearly all bacterial species. The dashed line represents <monospace>Proteinortho</monospace> results based on the NCBI annotation. Using <monospace>tblastn</monospace> the annotation was complemented with high scoring genomic matches (solid curve). Note that this is a cumulative plot, i.e., each group of co-orthologs present in <italic>x </italic>species is also included in the count of groups contained in <italic>x</italic>' &lt;<italic>x </italic>species.</p>
        </caption>
        <graphic xlink:href="1471-2105-12-124-6"/>
      </fig>
      <p>Nevertheless, about one third of the 30 most conserved proteins could not be recovered in the genomes of the two species with the smallest proteomes in our dataset: <italic>Candidatus Carsonella ruddii PV </italic>and <italic>Candidatus Sulcia muelleri GWSS</italic>. Both are endosymbionts that are considered as organelle-like [<xref ref-type="bibr" rid="B31">31</xref>,<xref ref-type="bibr" rid="B32">32</xref>]. Numerous genes that are otherwise considered to be essential for life have been reported as missing in both species. A more detailed and larger list of domain-wide common proteins can be downloaded at <ext-link ext-link-type="uri" xlink:href="http://bioinf.pharmazie.uni-marburg.de/supplements/proteinortho/">http://bioinf.pharmazie.uni-marburg.de/supplements/proteinortho/</ext-link>.</p>
    </sec>
  </sec>
  <sec>
    <title>Conclusions</title>
    <p><monospace>Proteinortho</monospace> implements a <monospace>blast</monospace>-based approach to determine sets of (co-)orthologous proteins or nucleic acid sequences that generalizes the reciprocal best alignment heuristic. The software is optimized for large datasets, and in particular provides a drastic reduction of the memory requirements compared to earlier tools. It can therefore be run on off-the-shelf PC hardware for large datasets. Our implementation scales very well with the number of available processor cores. The <monospace>blast</monospace> searches can be trivially parallelized and distributed easily to multiple PCs without the need for a cluster management system, while deployment to existing cluster infrastructure is also supported.</p>
    <p><monospace>Proteinortho</monospace> views orthology detection as a variant of graph clustering since co-orthologous sets correspond to maximal complete multipartite subgraphs, which at the same time are well separated from each other. Due to the unavoidable noise in the real data, however, co-orthologous sets appear as dense subgraphs without clearly recognizable low-weight cuts. This property is measured quite well by the algebraic connectivity. At the same time, low-weight cuts between dense regions are identified very well by the corresponding Fiedler vector. We therefore employ spectral partitioning instead of a direct graph clustering approach. The quality of the co-orthologous sets proposed by <monospace>Proteinortho</monospace> is comparable to the performance of <monospace>OrthoMCL</monospace>.</p>
    <p>Both time and memory requirements are significantly reduced compared to earlier approaches, enabling applications that were infeasible before. For instance, we applied <monospace>Proteinortho</monospace> to the complete set of 2.1 million proteins from the 717 bacterial genomes available at NCBI at the beginning of 2009. We found 30 proteins that are present in more than 99% of the investigated sequences.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <p>All analysis with <monospace>Proteinortho</monospace> and <monospace>OrthoMCL</monospace> were applied using default values unless described otherwise. These are <italic>E </italic>- <italic>value </italic>&lt; 10<sup>-10</sup>, 25% percent identity, Markov Inflation Index of 1.5 for <monospace>OrthoMCL</monospace> and <italic>E</italic>-value &lt; 10<sup>-10</sup>, 25% percent identity, adaptive best alignments similarity of <italic>f </italic>= 0.95, algebraic connectivity &gt; 0.1 for <monospace>Proteinortho</monospace>. <monospace>OrthoMCL</monospace> version 1.4 was downloaded from <ext-link ext-link-type="uri" xlink:href="http://OrthoMCL.org/common/downloads/">http://OrthoMCL.org/common/downloads/</ext-link>.</p>
    <p>Speed and memory benchmark were performed multiple times using the proteome of <italic>Escherichia coli K12 substr. MG1655 </italic>data from the NCBI. The protein ids were renamed systematically to prevent duplicated ids for benchmarking purposes which cannot be handled by <monospace>Proteinortho</monospace>. A script continuously observed the memory consumption and reported the maximum peak for each run, Figure <xref ref-type="fig" rid="F3">3</xref>.</p>
    <p>For the domain-wide commons we applied <monospace>Proteinortho</monospace> with default values of the parameters. Bacterial proteomes and genomes were downloaded from NCBI <ext-link ext-link-type="ftp" xlink:href="ftp://ftp.ncbi.nih.gov/genomes/Bacteria/">ftp://ftp.ncbi.nih.gov/genomes/Bacteria/</ext-link> in March 2009. A detailed list can be found in Additional File <xref ref-type="supplementary-material" rid="S3">3</xref>. In order to recover missing annotation, we selected all orthologous groups covering at least 75% of all species that are good candidates of domain-wide commons. The unique set of sequences of each orthologous group was blasted against all genomes that lack an annotated ortholog using <monospace>tblastn</monospace> (<italic>E</italic>-value &lt; 10<sup>-20</sup>). The sequence of the best alignment was then added to the orthologous group.</p>
    <p>For evaluation we used the proteome data from the <monospace>COG</monospace>-database <ext-link ext-link-type="ftp" xlink:href="ftp://ftp.ncbi.nih.gov/pub/COG/COG/">ftp://ftp.ncbi.nih.gov/pub/COG/COG/</ext-link> downloaded in November 2009. We have chosen <italic>Bacillus halodurans, Bacillus subtilis, Lactococcus lactis, Listeria innocua, Streptococcus pneumoniae TIGR4, Streptococcus pyogenes M1 GAS </italic>from the Gram-positive bacilli class, <italic>Buchnera sp. APS, Escherichia coli K12, Pasteurella multocida, Salmonella typhimurium LT2, Vibrio cholerae, Yersinia pestis </italic>from the gamma proteobacteria class and <italic>Brucella melitensis, Caulobacter vibrioides, Mesorhizobium loti, Rickettsia prowazekii </italic>from the alpha proteobacteria class. Both, <monospace>Proteinortho</monospace> and <monospace>OrthoMCL</monospace> were applied to this set. All groups with proteins covering at least 6 species were compared to the <monospace>COG</monospace>-database, illustrated in Figure <xref ref-type="fig" rid="F4">4</xref> and Figure <xref ref-type="fig" rid="F5">5</xref>.</p>
  </sec>
  <sec>
    <title>Availability</title>
    <p>The source code of <monospace>Proteinortho</monospace> can be obtained under the GPLv2 (or later) from <ext-link ext-link-type="uri" xlink:href="http://www.bioinf.uni-leipzig.de/Software/proteinortho/">http://www.bioinf.uni-leipzig.de/Software/proteinortho/</ext-link></p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>SP implemented an initial RBAH prototype. ML implemented, optimized, and evaluated the later versions of the program. All authors contributed to the details of implementation, testing and interpretation of the data, and collaborated in writing and approved the final manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional File 1</title>
        <p><bold>Algebraic connectivity and Fiedler vector</bold>. Iterative approximation of the Algebraic Connectivity using the Fiedler Vector.</p>
      </caption>
      <media xlink:href="1471-2105-12-124-S1.PDF" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S2">
      <caption>
        <title>Additional File 2</title>
        <p><bold>Supplemental figures</bold>. Supplemental Figures showing how multiple instances of <monospace>Proteinortho</monospace> can cooperate and how the comparison to <monospace>OrthoMCL</monospace> looks using smaller cutoffs.</p>
      </caption>
      <media xlink:href="1471-2105-12-124-S2.PDF" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S3">
      <caption>
        <title>Additional File 3</title>
        <p><bold>Species list for domain wide commons</bold>. Table of species and accession numbers used in this analysis.</p>
      </caption>
      <media xlink:href="1471-2105-12-124-S3.PDF" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgements</title>
    <p>This work was supported in part by DFG STA-850/6, STA-850/2, EU-project "Quantomics" and VW-project "Complex networks" and SPP 1258: "Sensory and regulatory RNAs in Prokaryotes".</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Fitch</surname>
          <given-names>WM</given-names>
        </name>
        <article-title>Distinguishing homologous from analogous proteins</article-title>
        <source>Syst Zool</source>
        <year>1970</year>
        <volume>19</volume>
        <issue>2</issue>
        <fpage>99</fpage>
        <lpage>113</lpage>
        <pub-id pub-id-type="doi">10.2307/2412448</pub-id>
        <pub-id pub-id-type="pmid">5449325</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="other">
        <name>
          <surname>Berglund</surname>
          <given-names>AC</given-names>
        </name>
        <name>
          <surname>Sjölund</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Ostlund</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Sonnhammer</surname>
          <given-names>EL</given-names>
        </name>
        <article-title>InParanoid 6: eukaryotic ortholog clusters with inparalogs</article-title>
        <source>Nucleic Acids Res</source>
        <year>2008</year>
        <issue>36 Database</issue>
        <fpage>D263</fpage>
        <lpage>266</lpage>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="other">
        <name>
          <surname>Chen</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Mackey</surname>
          <given-names>AJ</given-names>
        </name>
        <name>
          <surname>Stoeckert</surname>
          <given-names>CJ</given-names>
          <suffix>Jr</suffix>
        </name>
        <name>
          <surname>Roos</surname>
          <given-names>DS</given-names>
        </name>
        <article-title>OrthoMCL-DB: querying a comprehensive multi-species collection of ortholog groups</article-title>
        <source>Nucleic Acids Res</source>
        <year>2006</year>
        <issue>34 Database</issue>
        <fpage>D363</fpage>
        <lpage>368</lpage>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Tatusov</surname>
          <given-names>RL</given-names>
        </name>
        <name>
          <surname>Galperin</surname>
          <given-names>MY</given-names>
        </name>
        <name>
          <surname>Natale</surname>
          <given-names>DA</given-names>
        </name>
        <name>
          <surname>Koonin</surname>
          <given-names>EV</given-names>
        </name>
        <article-title>The COG database: a tool for genome-scale analysis of protein functions and evolution</article-title>
        <source>Nucleic Acids Res</source>
        <year>2000</year>
        <volume>28</volume>
        <fpage>33</fpage>
        <lpage>36</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/28.1.33</pub-id>
        <pub-id pub-id-type="pmid">10592175</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="other">
        <name>
          <surname>Wheeler</surname>
          <given-names>DL</given-names>
        </name>
        <name>
          <surname>Barrett</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Benson</surname>
          <given-names>DA</given-names>
        </name>
        <name>
          <surname>Bryant</surname>
          <given-names>SH</given-names>
        </name>
        <name>
          <surname>Canese</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Chetvernin</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Church</surname>
          <given-names>DM</given-names>
        </name>
        <name>
          <surname>Dicuccio</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Edgar</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Federhen</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Feolo</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Geer</surname>
          <given-names>LY</given-names>
        </name>
        <name>
          <surname>Helmberg</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Kapustin</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Khovayko</surname>
          <given-names>O</given-names>
        </name>
        <name>
          <surname>Landsman</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Lipman</surname>
          <given-names>DJ</given-names>
        </name>
        <name>
          <surname>Madden</surname>
          <given-names>TL</given-names>
        </name>
        <name>
          <surname>Maglott</surname>
          <given-names>DR</given-names>
        </name>
        <name>
          <surname>Miller</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Ostell</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Pruitt</surname>
          <given-names>KD</given-names>
        </name>
        <name>
          <surname>Schuler</surname>
          <given-names>GD</given-names>
        </name>
        <name>
          <surname>Shumway</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Sequeira</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Sherry</surname>
          <given-names>ST</given-names>
        </name>
        <name>
          <surname>Sirotkin</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Souvorov</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Starchenko</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Tatusov</surname>
          <given-names>RL</given-names>
        </name>
        <name>
          <surname>Tatusova</surname>
          <given-names>TA</given-names>
        </name>
        <name>
          <surname>Wagner</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Yaschenko</surname>
          <given-names>E</given-names>
        </name>
        <article-title>Database resources of the National Center for Biotechnology Information</article-title>
        <source>Nucleic Acids Res</source>
        <year>2008</year>
        <issue>36 Database</issue>
        <fpage>D13</fpage>
        <lpage>21</lpage>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="other">
        <name>
          <surname>Jensen</surname>
          <given-names>LJ</given-names>
        </name>
        <name>
          <surname>Julien</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Kuhn</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>von Mering</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Muller</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Doerks</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Bork</surname>
          <given-names>P</given-names>
        </name>
        <article-title>eggNOG: automated construction and annotation of orthologous groups of genes</article-title>
        <source>Nucleic Acids Res</source>
        <year>2008</year>
        <issue>36 Database</issue>
        <fpage>D250</fpage>
        <lpage>254</lpage>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Schneider</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Dessimoz</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Gonnet</surname>
          <given-names>GH</given-names>
        </name>
        <article-title>OMA Browser-exploring orthologous relations across 352 complete genomes</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <issue>16</issue>
        <fpage>2180</fpage>
        <lpage>2182</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btm295</pub-id>
        <pub-id pub-id-type="pmid">17545180</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="other">
        <name>
          <surname>Hubbard</surname>
          <given-names>TJ</given-names>
        </name>
        <name>
          <surname>Aken</surname>
          <given-names>BL</given-names>
        </name>
        <name>
          <surname>Beal</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Ballester</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Caccamo</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Chen</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Clarke</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Coates</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Cunningham</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Cutts</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Down</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Dyer</surname>
          <given-names>SC</given-names>
        </name>
        <name>
          <surname>Fitzgerald</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Fernandez-Banet</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Graf</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Haider</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Hammond</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Herrero</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Holland</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Howe</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Howe</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Johnson</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Kahari</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Keefe</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Kokocinski</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Kulesha</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Lawson</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Longden</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Melsopp</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Megy</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Meidl</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Ouverdin</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Parker</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Prlic</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Rice</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Rios</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Schuster</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Sealy</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Severin</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Slater</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Smedley</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Spudich</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Trevanion</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Vilella</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Vogel</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>White</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Wood</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Cox</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Curwen</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Durbin</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Fernandez-Suarez</surname>
          <given-names>XM</given-names>
        </name>
        <name>
          <surname>Flicek</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Kasprzyk</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Proctor</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Searle</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Smith</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Ureta-Vidal</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Birney</surname>
          <given-names>E</given-names>
        </name>
        <article-title>Ensembl 2007</article-title>
        <source>Nucleic Acids Res</source>
        <year>2007</year>
        <issue>35 Database</issue>
        <fpage>D610</fpage>
        <lpage>617</lpage>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="other">
        <collab>UniProt Consortium</collab>
        <article-title>The Universal Protein Resource (UniProt) in 2010</article-title>
        <source>Nucleic Acids Res</source>
        <year>2010</year>
        <issue>38 Database</issue>
        <fpage>D142</fpage>
        <lpage>8</lpage>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Koonin</surname>
          <given-names>EV</given-names>
        </name>
        <article-title>Orthologs, paralogs, and evolutionary genomics</article-title>
        <source>Annu Rev Genet</source>
        <year>2005</year>
        <volume>39</volume>
        <fpage>309</fpage>
        <lpage>38</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev.genet.39.073003.114725</pub-id>
        <pub-id pub-id-type="pmid">16285863</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Bork</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Dandekar</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Diaz-Lazcoz</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Eisenhaber</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Huynen</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Yuan</surname>
          <given-names>Y</given-names>
        </name>
        <article-title>Predicting function: from genes to genomes and back</article-title>
        <source>J Mol Biol</source>
        <year>1998</year>
        <volume>283</volume>
        <issue>4</issue>
        <fpage>707</fpage>
        <lpage>725</lpage>
        <pub-id pub-id-type="doi">10.1006/jmbi.1998.2144</pub-id>
        <pub-id pub-id-type="pmid">9790834</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Rivera</surname>
          <given-names>MC</given-names>
        </name>
        <name>
          <surname>Jain</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Moore</surname>
          <given-names>JE</given-names>
        </name>
        <name>
          <surname>Lake</surname>
          <given-names>JA</given-names>
        </name>
        <article-title>Genomic evidence for two functionally distinct gene classes</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>1998</year>
        <volume>95</volume>
        <issue>11</issue>
        <fpage>6239</fpage>
        <lpage>6244</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.95.11.6239</pub-id>
        <pub-id pub-id-type="pmid">9600949</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Hirsh</surname>
          <given-names>AE</given-names>
        </name>
        <name>
          <surname>Fraser</surname>
          <given-names>HB</given-names>
        </name>
        <article-title>Protein dispensability and rate of evolution</article-title>
        <source>Nature</source>
        <year>2001</year>
        <volume>411</volume>
        <issue>6841</issue>
        <fpage>1046</fpage>
        <lpage>1049</lpage>
        <pub-id pub-id-type="doi">10.1038/35082561</pub-id>
        <pub-id pub-id-type="pmid">11429604</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Remm</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Storm</surname>
          <given-names>CE</given-names>
        </name>
        <name>
          <surname>Sonnhammer</surname>
          <given-names>EL</given-names>
        </name>
        <article-title>Automatic clustering of orthologs and in-paralogs from pairwise species comparisons</article-title>
        <source>J Mol Biol</source>
        <year>2001</year>
        <volume>314</volume>
        <issue>5</issue>
        <fpage>1041</fpage>
        <lpage>1052</lpage>
        <pub-id pub-id-type="doi">10.1006/jmbi.2000.5197</pub-id>
        <pub-id pub-id-type="pmid">11743721</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Jordan</surname>
          <given-names>IK</given-names>
        </name>
        <name>
          <surname>Rogozin</surname>
          <given-names>IB</given-names>
        </name>
        <name>
          <surname>Wolf</surname>
          <given-names>YI</given-names>
        </name>
        <name>
          <surname>Koonin</surname>
          <given-names>EV</given-names>
        </name>
        <article-title>Essential genes are more evolutionarily conserved than are nonessential genes in bacteria</article-title>
        <source>Genome Res</source>
        <year>2002</year>
        <volume>12</volume>
        <issue>6</issue>
        <fpage>962</fpage>
        <lpage>968</lpage>
        <pub-id pub-id-type="pmid">12045149</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Li</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Stoeckert</surname>
          <given-names>CJ</given-names>
          <suffix>Jr</suffix>
        </name>
        <name>
          <surname>Roos</surname>
          <given-names>DS</given-names>
        </name>
        <article-title>OrthoMCL: identification of ortholog groups for eukaryotic genomes</article-title>
        <source>Genome Res</source>
        <year>2003</year>
        <volume>13</volume>
        <issue>9</issue>
        <fpage>2178</fpage>
        <lpage>2189</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.1224503</pub-id>
        <pub-id pub-id-type="pmid">12952885</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Alexeyenko</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Tamas</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Liu</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Sonnhammer</surname>
          <given-names>EL</given-names>
        </name>
        <article-title>Automatic clustering of orthologs and inparalogs shared by multiple proteomes</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <issue>14</issue>
        <fpage>e9</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl213</pub-id>
        <pub-id pub-id-type="pmid">16873526</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Fu</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Chen</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Vacic</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Nan</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Zhong</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Jiang</surname>
          <given-names>T</given-names>
        </name>
        <article-title>MSOAR: a high-throughput ortholog assignment system based on genome rearrangement</article-title>
        <source>J Comput Biol</source>
        <year>2007</year>
        <volume>14</volume>
        <issue>9</issue>
        <fpage>1160</fpage>
        <lpage>1175</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2007.0048</pub-id>
        <pub-id pub-id-type="pmid">17990975</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="book">
        <name>
          <surname>van Dongen</surname>
          <given-names>SM</given-names>
        </name>
        <article-title>Graph Clustering by Flow Simulation</article-title>
        <source>PhD thesis</source>
        <year>2000</year>
        <publisher-name>University of Utrecht, The Netherlands</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Enright</surname>
          <given-names>AJ</given-names>
        </name>
        <name>
          <surname>Van Dongen</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Ouzounis</surname>
          <given-names>CA</given-names>
        </name>
        <article-title>An efficient algorithm for large-scale detection of protein families</article-title>
        <source>Nucleic Acids Res</source>
        <year>2002</year>
        <volume>30</volume>
        <issue>7</issue>
        <fpage>1575</fpage>
        <lpage>1584</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/30.7.1575</pub-id>
        <pub-id pub-id-type="pmid">11917018</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Cornaz</surname>
          <given-names>D</given-names>
        </name>
        <article-title>A linear programming formulation for the maximum complete multipartite subgraph problem</article-title>
        <source>Math Program, Ser B</source>
        <year>2006</year>
        <volume>105</volume>
        <fpage>329</fpage>
        <lpage>344</lpage>
        <pub-id pub-id-type="doi">10.1007/s10107-005-0656-6</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="book">
        <name>
          <surname>Guattery</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Miller</surname>
          <given-names>GL</given-names>
        </name>
        <article-title>On the performance of spectral graph partitioning methods</article-title>
        <source>Proceedings of the sixth annual ACM-SIAM Symposium on Discrete Algorithms</source>
        <year>1995</year>
        <publisher-name>Philadelphia, PA: Society for Industrial and Applied Mathematics</publisher-name>
        <fpage>233</fpage>
        <lpage>242</lpage>
      </mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Sikdar</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Kim</surname>
          <given-names>JS</given-names>
        </name>
        <article-title>Expression of a natural fusion gene for uracil phosphoribosyltransferase and uridine kinase from rice shows growth retardation by 5-fluorouridine or 5-fluorouracil in Escherichia coli</article-title>
        <source>African Journal of Biotechnology</source>
        <year>2010</year>
        <volume>9</volume>
        <issue>9</issue>
        <fpage>1295</fpage>
        <lpage>1303</lpage>
      </mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Hopcroft</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Tarjan</surname>
          <given-names>R</given-names>
        </name>
        <article-title>Efficient algorithms for graph manipulation</article-title>
        <source>Commun ACM</source>
        <year>1973</year>
        <volume>16</volume>
        <fpage>372</fpage>
        <lpage>378</lpage>
        <pub-id pub-id-type="doi">10.1145/362248.362272</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Fiedler</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Algebraic Connectivity of Graphs</article-title>
        <source>Czechoslovak Math J</source>
        <year>1973</year>
        <volume>23</volume>
        <fpage>298</fpage>
        <lpage>305</lpage>
      </mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Force</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Lynch</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Pickett</surname>
          <given-names>FB</given-names>
        </name>
        <name>
          <surname>Amores</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Yan</surname>
          <given-names>YL</given-names>
        </name>
        <name>
          <surname>Postlethwait</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Preservation of duplicate genes by complementary, degenerative mutations</article-title>
        <source>Genetics</source>
        <year>1999</year>
        <volume>151</volume>
        <issue>4</issue>
        <fpage>1531</fpage>
        <lpage>1545</lpage>
        <pub-id pub-id-type="pmid">10101175</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Fiedler</surname>
          <given-names>M</given-names>
        </name>
        <article-title>A property of eigenvectors of nonnegative symmetric matrices and its application to graph theory</article-title>
        <source>Czechoslovak Math J</source>
        <year>1975</year>
        <volume>25</volume>
        <fpage>619</fpage>
        <lpage>633</lpage>
      </mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kristensen</surname>
          <given-names>DM</given-names>
        </name>
        <name>
          <surname>Kannan</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Coleman</surname>
          <given-names>MK</given-names>
        </name>
        <name>
          <surname>Wolf</surname>
          <given-names>YI</given-names>
        </name>
        <name>
          <surname>Sorokin</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Koonin</surname>
          <given-names>EV</given-names>
        </name>
        <name>
          <surname>Mushegian</surname>
          <given-names>A</given-names>
        </name>
        <article-title>A low-polynomial algorithm for assembling clusters of orthologous groups from intergenomic symmetric best matches</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>1481</fpage>
        <lpage>1487</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq229</pub-id>
        <pub-id pub-id-type="pmid">20439257</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lanczos</surname>
          <given-names>C</given-names>
        </name>
        <article-title>An Iteration Method for the Solution of the Eigenvalue Problem of Linear Differential and Integral Operators</article-title>
        <source>J Res Natl Bureau Standards</source>
        <year>1950</year>
        <volume>45</volume>
        <fpage>255</fpage>
        <lpage>281</lpage>
      </mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Pruesse</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Quast</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Knittel</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Fuchs</surname>
          <given-names>BM</given-names>
        </name>
        <name>
          <surname>Ludwig</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Peplies</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Glöckner</surname>
          <given-names>FO</given-names>
        </name>
        <article-title>SILVA: a comprehensive online resource for quality checked and aligned ribosomal RNA sequence data compatible with ARB</article-title>
        <source>Nucleic Acids Res</source>
        <year>2007</year>
        <volume>35</volume>
        <issue>21</issue>
        <fpage>7188</fpage>
        <lpage>7196</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkm864</pub-id>
        <pub-id pub-id-type="pmid">17947321</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B31">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Nakabachi</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Yamashita</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Toh</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Ishikawa</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Dunbar</surname>
          <given-names>HE</given-names>
        </name>
        <name>
          <surname>Moran</surname>
          <given-names>NA</given-names>
        </name>
        <name>
          <surname>Hattori</surname>
          <given-names>M</given-names>
        </name>
        <article-title>The 160-kilobase genome of the bacterial endosymbiont Carsonella</article-title>
        <source>Science</source>
        <year>2006</year>
        <volume>314</volume>
        <issue>5797</issue>
        <fpage>267</fpage>
        <pub-id pub-id-type="doi">10.1126/science.1134196</pub-id>
        <pub-id pub-id-type="pmid">17038615</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B32">
      <mixed-citation publication-type="journal">
        <name>
          <surname>McCutcheon</surname>
          <given-names>JP</given-names>
        </name>
        <name>
          <surname>Moran</surname>
          <given-names>NA</given-names>
        </name>
        <article-title>Parallel genomic evolution and metabolic interdependence in an ancient symbiosis</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2007</year>
        <volume>104</volume>
        <issue>49</issue>
        <fpage>19392</fpage>
        <lpage>19397</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0708855104</pub-id>
        <pub-id pub-id-type="pmid">18048332</pub-id>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
