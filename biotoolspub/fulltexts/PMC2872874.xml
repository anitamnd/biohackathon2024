<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1465-6906</issn>
    <issn pub-type="epub">1465-6914</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2872874</article-id>
    <article-id pub-id-type="publisher-id">gb-2010-11-2-r14</article-id>
    <article-id pub-id-type="pmid">20132535</article-id>
    <article-id pub-id-type="doi">10.1186/gb-2010-11-2-r14</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Gene ontology analysis for RNA-seq: accounting for selection bias</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="A1">
        <name>
          <surname>Young</surname>
          <given-names>Matthew D</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>myoung@wehi.edu.au</email>
      </contrib>
      <contrib contrib-type="author" id="A2">
        <name>
          <surname>Wakefield</surname>
          <given-names>Matthew J</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>wakefield@wehi.edu.au</email>
      </contrib>
      <contrib contrib-type="author" id="A3">
        <name>
          <surname>Smyth</surname>
          <given-names>Gordon K</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>smyth@wehi.edu.au</email>
      </contrib>
      <contrib contrib-type="author" corresp="yes" id="A4">
        <name>
          <surname>Oshlack</surname>
          <given-names>Alicia</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>oshlack@wehi.edu.au</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Bioinformatics Division, The Walter and Eliza Hall Institute of Medical Research, 1G Royal Parade, Parkville 3052, Australia</aff>
    <pub-date pub-type="ppub">
      <year>2010</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>4</day>
      <month>2</month>
      <year>2010</year>
    </pub-date>
    <volume>11</volume>
    <issue>2</issue>
    <fpage>R14</fpage>
    <lpage>R14</lpage>
    <history>
      <date date-type="received">
        <day>1</day>
        <month>12</month>
        <year>2009</year>
      </date>
      <date date-type="rev-recd">
        <day>14</day>
        <month>1</month>
        <year>2010</year>
      </date>
      <date date-type="accepted">
        <day>4</day>
        <month>2</month>
        <year>2010</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright Â©2010 Young et al.; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2010</copyright-year>
      <copyright-holder>Young et al.; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <license-p>This is an open access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://genomebiology.com/2010/11/2/R14"/>
    <abstract abstract-type="short">
      <p>GOseq is a method for GO analysis of RNA-seq data that takes into account the length bias inherent in RNA-seq</p>
    </abstract>
    <abstract>
      <p>We present GOseq, an application for performing Gene Ontology (GO) analysis on RNA-seq data. GO analysis is widely used to reduce complexity and highlight biological processes in genome-wide expression studies, but standard methods give biased results on RNA-seq data due to over-detection of differential expression for long and highly expressed transcripts. Application of GOseq to a prostate cancer data set shows that GOseq dramatically changes the results, highlighting categories more consistent with the known biology.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Next generation sequencing of RNA (RNA-seq) gives unprecedented detail about the transcriptional landscape of an organism. Not only is it possible to accurately measure expression levels of transcripts in a sample [<xref ref-type="bibr" rid="B1">1</xref>], but this new technology promises to deliver a range of additional benefits, such as the investigation of alternative splicing [<xref ref-type="bibr" rid="B2">2</xref>], allele specific expression [<xref ref-type="bibr" rid="B3">3</xref>] and RNA editing [<xref ref-type="bibr" rid="B4">4</xref>]. However, in order to accurately make use of the data, it is vital that analysis techniques are developed to take into account the technical features of RNA-seq output. As many of the specific technical properties of RNA-seq data are not present in previous technologies such as microarrays, naive application of the same analysis methodologies, developed for these older technologies, may lead to bias in the results.</p>
    <p>In RNA-seq experiments the expression level of a transcript is estimated from the number of reads that map to that transcript. In many applications, the expected read count for a transcript is proportional to the gene's expression level multiplied by its transcript length. Therefore, even when two transcripts are expressed at the same level, differences in length will yield differing numbers of total reads. One consequence of this is that longer transcripts give more statistical power for detecting differential expression between samples [<xref ref-type="bibr" rid="B5">5</xref>]. Similarly, more highly expressed transcripts have a greater number of reads and greater power to detect differential expression. Hence, long or highly expressed transcripts are more likely to be detected as differentially expressed compared with their short and/or lowly expressed counterparts. The fact that statistical power increases with the number of reads is an unavoidable property of count data, which cannot be removed by normalization or re-scaling. Consequently, it is unsurprising that this selection bias has been shown to exist in a range of different experiments performed using different analysis methods, experimental designs and sequencing platforms [<xref ref-type="bibr" rid="B5">5</xref>]. When performing systems biology analyses, failure to account for this effect will lead to biased results.</p>
    <p>One simple, but extremely widely used, systems biology technique for highlighting biological processes is gene category over-representation analysis. In order to perform this analysis, genes are grouped into categories by some common biological property and then tested to find categories that are over represented amongst the differentially expressed genes. Gene Ontology (GO) categories are commonly used in this technique and there are many tools available for performing GO analysis - for example, EasyGO [<xref ref-type="bibr" rid="B6">6</xref>], GOminer [<xref ref-type="bibr" rid="B7">7</xref>], GOstat [<xref ref-type="bibr" rid="B8">8</xref>], GOToolBox [<xref ref-type="bibr" rid="B9">9</xref>], topGO [<xref ref-type="bibr" rid="B10">10</xref>], GSEA [<xref ref-type="bibr" rid="B11">11</xref>], DAVID [<xref ref-type="bibr" rid="B12">12</xref>] (see supplementary data 1 in Huang da <italic>et al</italic>. [<xref ref-type="bibr" rid="B12">12</xref>] for a more complete list). Although these tools have some differences in methodology [<xref ref-type="bibr" rid="B12">12</xref>], they all rely on similar underlying assumptions about the distribution of differentially expressed (DE) genes. Specifically, it is assumed that all genes are independent and equally likely to be selected as DE, under the null hypothesis. It is this assumption that makes the standard GO analysis methods unsuitable for RNA-seq data due to the bias in detecting differential expression for genes with a high number of reads. It follows then that when using a standard analysis, any category containing a preponderance of long genes will be more likely to show up as over-represented than a category with genes of average length. Similarly, categories with highly expressed genes are also more likely to be found as over-represented than categories of lowly expressed genes. Having identified this issue, it is possible to compensate for the effect of selection bias in the statistical test of a category's enrichment among differentially expressed genes.</p>
    <p>This paper will be concerned with developing a statistical methodology that enables the application of GO analysis to RNA-seq data by properly incorporating the effect of selection bias. Using published RNA-seq data, we will show that accounting for this effect leads to significantly different results, which agree much better with previous microarray studies and the known biology than the results of an uncorrected analysis.</p>
  </sec>
  <sec>
    <title>Results</title>
    <p>Because it is so widely used, we choose to focus our category testing on GO analysis. The techniques developed here apply more generally, however, to any analysis that looks for over-representation of some category of interest amongst differentially expressed genes. For example, alternative analyses might look for over-representation of KEGG (Kyoto Encyclopedia of Genes and Genomes) pathways, gene sets in the Molecular Signatures Database [<xref ref-type="bibr" rid="B11">11</xref>], or gene lists derived from earlier microarray experiments.</p>
    <p>To illustrate the methodology, the GOseq technique was applied to an experiment examining the effects of androgen stimulation on a human prostate cancer cell line, LNCaP [<xref ref-type="bibr" rid="B13">13</xref>]. This published data set includes more than 17 million short cDNA reads obtained for both the treated and untreated cell line and sequenced on Illumina's 1G genome analyzer. These reads were re-mapped back to the reference genome and the number of reads per gene was recorded (see Additional file <xref ref-type="supplementary-material" rid="S1">1</xref> for details). Examples of the methodology throughout the paper are made using this data set and we show that the GOseq method makes a substantial difference to the results of the GO analysis, which are more consistent with prior knowledge of the system.</p>
    <sec>
      <title>GO analysis</title>
      <p>Standard methods for testing over-representation of a GO category assume that, under the null hypothesis, each gene has equal probability of being detected as DE. Under this assumption, the number of genes associated with a category that overlap with the set of DE genes follows a hypergeometric distribution. Hence the GO test can be conducted using Fisher's exact test, which uses the hypergeometric distribution, or Pearson's chi-square test, which is a computationally convenient approximation [<xref ref-type="bibr" rid="B12">12</xref>]. Because of the existence of selection bias, genes with more reads are more likely to be detected as DE, violating the assumption behind the hypergeometric distribution. Therefore, these standard test distributions should not be used for GO analysis with RNA-seq data. Instead, we need a new test that corrects for selection bias.</p>
    </sec>
    <sec>
      <title>Selection bias</title>
      <p>Transcript length bias will affect GO analysis if the sets of genes associated with GO categories contain a non-random set of genes, with either a preponderance of short or long genes. To test individual categories for a length distribution bias, we assessed the length of genes within 7,873 unique GO categories associated with human genes in the GO consortium database [<xref ref-type="bibr" rid="B14">14</xref>]. The length distribution of the genes in these categories varied widely, with some categories containing an over-representation of long genes and some with relatively short genes (Figure <xref ref-type="fig" rid="F1">1a</xref>). A Mann-Whitney U test (also known as a Wilcoxon rank-sum test) was performed on each category to test whether the median length of genes in that GO category differed from the global median length across all categories. Figure <xref ref-type="fig" rid="F1">1b</xref> shows a histogram of the Mann-Whitney <italic>P</italic>-values. The clear excess of low <italic>P</italic>-values indicates the existence of GO categories with many long or short genes. Therefore, we expect that a standard analysis of GO category enrichment among DE genes, which ignores transcript length, to be significantly affected by the transcript length bias inherent to RNA-seq.</p>
      <fig id="F1" position="float">
        <label>Figure 1</label>
        <caption>
          <p><bold>Length distribution of genes in Gene Ontology categories</bold>. <bold>(a) </bold>The distribution of average gene lengths in GO categories on a log10 scale. The GO category gene length is given by the median length of the genes within the category. <bold>(b) </bold><italic>P</italic>-values for the two-sided Mann-Whitney U test comparing the median length of genes in a GO category with the overall distribution of genes for 7,873 GO categories. The excess of low <italic>P</italic>-values shows that there are many GO categories that contain a set of significantly long or short genes.</p>
        </caption>
        <graphic xlink:href="gb-2010-11-2-r14-1"/>
      </fig>
    </sec>
    <sec>
      <title>The GOseq method</title>
      <p>In order to correct for selection bias in category testing, we propose the following three-step methodology. First, the genes that are significantly DE between conditions are identified. The GOseq method works with any procedure for identifying DE genes. Second, the likelihood of DE as a function of transcript length is quantified. This is obtained by fitting a monotonic function to DE versus transcript length data. Finally, the DE versus length function is incorporated into the statistical test of each category's significance. This final step takes into account the lengths of the genes that make up each category.</p>
      <p>The first step in the GOseq procedure is to determine which genes are differentially expressed. For the prostate cancer data set, a <italic>P</italic>-value for differential expression between the treated and untreated cells was obtained for each gene using a Poisson exact test, equivalent to Fisher's exact test [<xref ref-type="bibr" rid="B15">15</xref>-<xref ref-type="bibr" rid="B17">17</xref>]. These <italic>P</italic>-values were then corrected for multiple testing [<xref ref-type="bibr" rid="B18">18</xref>] and the false discovery rate was set at 10<sup>-4</sup>. Figure <xref ref-type="fig" rid="F2">2a</xref> shows a plot of the proportion of DE genes as a function of length. A strong trend towards a higher rate of differential expression for genes with longer transcripts is evident. Figure <xref ref-type="fig" rid="F2">2b</xref> shows a similar trend towards more differential expression for genes with a higher total number of reads. As expected, the trend is stronger for total read count compared to transcript length. Other statistical methods for determining differential expression between samples show a similar trend of increasing proportion of DE genes with gene length, even when working with data normalized by dividing by transcript length, such as RPKM transformed data [<xref ref-type="bibr" rid="B19">19</xref>] (Figure S1b,c in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). Non-statistical methods for determining DE, such as using a fold-change cutoff, can show a decreasing trend in the proportion of DE as a function of gene length (Figure S1a in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). Any trend observed in the data is modeled by the second step of the GOseq procedure.</p>
      <fig id="F2" position="float">
        <label>Figure 2</label>
        <caption>
          <p><bold>Differential expression as a function of gene length and read count</bold>. <bold>(a) </bold>The proportion of DE genes is plotted as a function of the transcript length. Each point represents the percentage of genes called DE in a bin of 300 genes plotted against the median gene length for the bin. The green line is the probability weighting function obtained by fitting a monotonic cubic spline with 6 knots to the binary data. A clear trend towards more detected differential expression at longer gene lengths can be seen. <bold>(b) </bold>The same, except instead of transcript length, the total number of reads for each gene was used. Again, a trend towards more DE for genes with more reads can be seen. Note the greater range of probabilities compared to (a).</p>
        </caption>
        <graphic xlink:href="gb-2010-11-2-r14-2"/>
      </fig>
      <p>In the second step, a probability weighting function (PWF) is estimated from the data. The PWF quantifies how the probability of a gene selected as DE changes as a function of its transcript length. To estimate this trend function, each gene is assigned a binary value (zero or one), according to whether or not the gene is found to be DE. A monotonic spline with 6 knots is then fitted to this binary data series using the transcript length of each gene as predictor (see Materials and methods). Monotonicity is imposed as the power to detect DE using statistical tests increases monotonically with an increasing number of reads. Figure <xref ref-type="fig" rid="F2">2</xref> also shows the resulting probability weighting function for the prostate cancer data set. The PWF then forms the null hypothesis for our enrichment test.</p>
      <p>Unlike GO analysis for microarray data, the null probability distribution does not conform to a standard distribution, precluding an analytical solution for determining the probability of a category being over-represented among DE genes. However, the <italic>P</italic>-value for each category can be computed using a resampling strategy. For the final step of the GOseq method, resampling was performed by randomly selecting a set of genes, the same size as the set of DE genes, and counting the number of genes associated with the GO category of interest. This random selection weights the chance of choosing a gene by its length or read count, from the previously fitted probability weighting function. The resampling is repeated many times and the resulting distribution of GO category membership is taken to approximate the shape of the true probability distribution. This sampling distribution allows calculation of a <italic>P</italic>-value for each GO category being over-represented in the set of DE genes while taking selection bias into account.</p>
    </sec>
    <sec>
      <title>The Wallenius approximation</title>
      <p>Although accurate, random sampling is very computationally intensive, particularly when a fine granularity in <italic>P</italic>-value is needed to distinguish between large numbers of categories. In order to make the calculation in the final step of the GOseq procedure computationally manageable, we implemented an alternative approximation technique, based on an extension of the hypergeometric distribution known as the Wallenius non-central hypergeometric distribution [<xref ref-type="bibr" rid="B20">20</xref>]. This distribution extends the hypergeometric distribution to the case where the probability of success and failure differ. The GOseq implementation of the approximation assumes that all genes within a category have the same probability of being chosen, but this probability is different from the probability of choosing genes outside this category. The mean of the probability weightings for each gene within/outside the category is defined as the common probability of choosing a gene within/outside that category. While the Wallenius approximation is obviously a simplification, it is significantly closer to the true distribution than the standard hypergeometric distribution.</p>
      <p>Although the accuracy lost by using the Wallenius approximation is not negligible, the gain in computational efficiency is dramatic. Furthermore, the ability to differentiate the most highly over-represented categories from one another (Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>) makes the Wallenius approximation an attractive alternative, particularly when the range of the probability weighting function is moderate.</p>
    </sec>
    <sec>
      <title>Comparisons of GOseq with the standard GO analysis</title>
      <p>To compare the results from the GOseq procedure to the standard GO analysis used on microarray data, we applied both methods to the prostate cancer data set. For each method a list of GO categories ordered by significance was generated. Figure <xref ref-type="fig" rid="F3">3</xref> compares the ranks of the GO categories between the GOseq method and hypergeometric method as a function of gene length (Figure <xref ref-type="fig" rid="F3">3a</xref>) or total read count (Figure <xref ref-type="fig" rid="F3">3b</xref>) within categories. As expected, categories with shorter than average length move up in rank (become more significant) when length bias has been taken into account with the GOseq method. Similarly, categories with longer than average genes are ranked lower by GOseq than the standard method. Furthermore, when accounting for gene length bias, of the 25 categories most significantly over-represented using GOseq and the standard method, 8 are discrepant between the methods (Tables <xref ref-type="table" rid="T1">1</xref> and <xref ref-type="table" rid="T2">2</xref>). This highlights the fact that accounting for biases in detecting DE makes a significant difference to the biology identified from the results.</p>
      <fig id="F3" position="float">
        <label>Figure 3</label>
        <caption>
          <p><bold>Change in Gene Ontology category rank between the standard and GOseq methodologies</bold>. <bold>(a) </bold>Change in rank of GO categories going from the hypergeometric method to GOseq correcting for length bias plotted against the log of the average gene length of the category. <bold>(b) </bold>Change in rank of GO categories going from the hypergeometric method to GOseq correcting for total read count plotted against the log of the average number of counts of each gene in the category. A trend for the standard method to underestimate significance for GO categories containing short (or highly expressed) genes and overestimate significance for GO categories containing long (or underexpressed) genes can be clearly seen.</p>
        </caption>
        <graphic xlink:href="gb-2010-11-2-r14-3"/>
      </fig>
      <table-wrap id="T1" position="float">
        <label>Table 1</label>
        <caption>
          <p>Gene Ontology categories ranked in the top 25 in the standard method but not in length bias adjusted GOseq</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left">GOID</th>
              <th align="left">Term</th>
              <th align="center">Ontology</th>
              <th align="center">Rank standard</th>
              <th align="center">Rank GOseq</th>
              <th align="center">Average gene length in category</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">GO:0005622</td>
              <td align="left">Intracellular</td>
              <td align="center">CC</td>
              <td align="center">9</td>
              <td align="center">38</td>
              <td align="center">2,710</td>
            </tr>
            <tr>
              <td align="left">GO:0005524</td>
              <td align="left">ATP binding</td>
              <td align="center">MF</td>
              <td align="center">12</td>
              <td align="center">113</td>
              <td align="center">3,133</td>
            </tr>
            <tr>
              <td align="left">GO:0008270</td>
              <td align="left">Zinc ion binding</td>
              <td align="center">MF</td>
              <td align="center">13</td>
              <td align="center">145</td>
              <td align="center">2,817</td>
            </tr>
            <tr>
              <td align="left">GO:0016020</td>
              <td align="left">Membrane</td>
              <td align="center">CC</td>
              <td align="center">16</td>
              <td align="center">702</td>
              <td align="center">2,571</td>
            </tr>
            <tr>
              <td align="left">GO:0046872</td>
              <td align="left">Metal ion binding</td>
              <td align="center">MF</td>
              <td align="center">17</td>
              <td align="center">255</td>
              <td align="center">2,734</td>
            </tr>
            <tr>
              <td align="left">GO:0006355</td>
              <td align="left">Regulation of transcription, DNA-dependent</td>
              <td align="center">BP</td>
              <td align="center">19</td>
              <td align="center">266</td>
              <td align="center">2,752</td>
            </tr>
            <tr>
              <td align="left">GO:0000139</td>
              <td align="left">Golgi membrane</td>
              <td align="center">CC</td>
              <td align="center">22</td>
              <td align="center">28</td>
              <td align="center">2,855</td>
            </tr>
            <tr>
              <td align="left">GO:0016740</td>
              <td align="left">Transferase activity</td>
              <td align="center">MF</td>
              <td align="center">25</td>
              <td align="center">116</td>
              <td align="center">2,721</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>The median gene length of all categories are significantly longer than average using a Mann-Whitney test. BP, biological process; CC, cellular component; MF, molecular function.</p>
        </table-wrap-foot>
      </table-wrap>
      <table-wrap id="T2" position="float">
        <label>Table 2</label>
        <caption>
          <p>Gene Ontology categories ranked in the top 25 in length bias adjusted GOseq but not in the standard method</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left">GOID</th>
              <th align="left">Term</th>
              <th align="center">Ontology</th>
              <th align="center">Rank standard</th>
              <th align="center">Rank GOseq</th>
              <th align="center">Average gene length in category</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">GO:0006414</td>
              <td align="left">Translational elongation</td>
              <td align="center">BP</td>
              <td align="center">92</td>
              <td align="center">8</td>
              <td align="center">708*</td>
            </tr>
            <tr>
              <td align="left">GO:0000786</td>
              <td align="left">Nucleosome</td>
              <td align="center">CC</td>
              <td align="center">64</td>
              <td align="center">14</td>
              <td align="center">1,345*</td>
            </tr>
            <tr>
              <td align="left">GO:0006334</td>
              <td align="left">nucleosome assembly</td>
              <td align="center">BP</td>
              <td align="center">70</td>
              <td align="center">17</td>
              <td align="center">1,362*</td>
            </tr>
            <tr>
              <td align="left">GO:0043687</td>
              <td align="left">Post-translational protein modification</td>
              <td align="center">BP</td>
              <td align="center">50</td>
              <td align="center">20</td>
              <td align="center">1,830</td>
            </tr>
            <tr>
              <td align="left">GO:0019787</td>
              <td align="left">Small conjugating protein ligase activity</td>
              <td align="center">MF</td>
              <td align="center">65</td>
              <td align="center">25</td>
              <td align="center">1,928</td>
            </tr>
            <tr>
              <td align="left">GO:0016192</td>
              <td align="left">Vesicle-mediated transport</td>
              <td align="center">BP</td>
              <td align="center">28</td>
              <td align="center">22</td>
              <td align="center">2,765</td>
            </tr>
            <tr>
              <td align="left">GO:0006412</td>
              <td align="left">Translation</td>
              <td align="center">BP</td>
              <td align="center">104</td>
              <td align="center">23</td>
              <td align="center">1,472</td>
            </tr>
            <tr>
              <td align="left">GO:0051246</td>
              <td align="left">Regulation of protein metabolic process</td>
              <td align="center">BP</td>
              <td align="center">66</td>
              <td align="center">24</td>
              <td align="center">1,609</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Three of these categories (marked with asterisks) have genes significantly shorter than average length (Mann-Whitney <italic>P</italic>-value &lt; 0.05). BP, biological process; CC, cellular component; MF, molecular function.</p>
        </table-wrap-foot>
      </table-wrap>
      <p>The standard GOseq analysis was also compared to both the random sampling strategy and the more computationally efficient Wallenius approximation. <italic>P</italic>-values for over-representation of DE genes for each GO category were generated using random sampling with a high number of repetitions (200,000). These <italic>P</italic>-values were then compared to <italic>P</italic>-values calculated using the standard hypergeometric test and GOseq utilizing the Wallenius approximation. Comparison of the categories' <italic>P</italic>-values demonstrate a large discrepancy between the GOseq method and the hypergeometric method, as well as very little difference between GOseq using sampling or Wallenius (Figure <xref ref-type="fig" rid="F4">4a</xref>; Figure S3 in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). Furthermore, we compared the top ranked lists of enriched GO categories between two methods by plotting the number of discrepancies between the methods for a given list size (Figure <xref ref-type="fig" rid="F4">4b</xref>). This plot shows that for the prostate cancer data set, approximately 20% of GO categories that appear using the standard analysis are not present when GOseq is used and vice versa. The high number of discrepancies for short lists shows that failure to account for length bias impairs analysis, even if we are only interested in a small number of categories. Reassuringly, the Wallenius approximation closely approximates GOseq using high repetition sampling with very few changes in <italic>P</italic>-values or rankings of categories. Similar results are seen for other RNA-seq datasets (data not shown).</p>
      <fig id="F4" position="float">
        <label>Figure 4</label>
        <caption>
          <p><bold>Comparison of GOseq and the standard hypergeometric methods</bold>. <bold>(a) </bold>The <italic>P</italic>-values generated with GOseq using the Wallenius approximation and the standard hypergeometric method are plotted against the <italic>P</italic>-values calculated with GOseq using random sampling (200k repeats). The Wallenius method (green crosses) shows good agreement with the high resolution (200,000 repeats) random sampling. A large discrepancy in <italic>P</italic>-values is seen between GOseq and the hypergeometric method. <bold>(a) </bold>The number of discrepancies between lists is shown for a given list size. The black line compares GOseq using high resolution sampling with the hypergeometric method. The red line compares GOseq using high resolution sampling with the Wallenius approximation. Again, GOseq using the Wallenius method shows little difference from GOseq using the random sampling method (with 200k repeats) while the hypergeometric method shows a large number (approximately 20%) of discrepancies.</p>
        </caption>
        <graphic xlink:href="gb-2010-11-2-r14-4"/>
      </fig>
    </sec>
    <sec>
      <title>Measuring GOseq's accuracy by comparison with microarray data</title>
      <p>The GOseq method clearly makes a substantial difference to the categories selected when performing a GO analysis. In order to demonstrate that accounting for length bias produces more reliable results, we compared the results of GOseq and the standard test to the GO analysis from a microarray experiment that does not show any gene length bias [<xref ref-type="bibr" rid="B5">5</xref>]. For the comparison of RNA-seq and microarrays, a data set was used that compares the exact same liver and kidney samples on the two platforms [<xref ref-type="bibr" rid="B21">21</xref>] (see Materials and methods). Figure <xref ref-type="fig" rid="F5">5</xref> plots the fraction of microarray GO categories recovered from the RNA-seq data using the hypergeometric and GOseq methods, as a function of the number of GO categories considered. It can be seen that GOseq gives categories more consistent with the microarray platform (<italic>P </italic>= 0.067), indicating that accounting for length bias gives a GO analysis with better performance.</p>
      <fig id="F5" position="float">
        <label>Figure 5</label>
        <caption>
          <p><bold>A comparison of Gene Ontology analysis using RNA-seq and microarrays on the same samples</bold>. The fraction of GO categories identified by RNA-seq data that overlap with the microarray GO analysis are shown as a function of the number of categories selected. RNA-seq data have been analyzed using GOseq and hypergeometric methods. The GOseq categories have a consistently higher overlap with the microarray GO categories than the standard method.</p>
        </caption>
        <graphic xlink:href="gb-2010-11-2-r14-5"/>
      </fig>
    </sec>
    <sec>
      <title>Transcript length bias versus read count bias</title>
      <p>As transcript length bias is a technical effect, it is always necessary to correct for it when performing category testing on RNA-seq data. However, the bias in power to detect DE in longer genes arises from an increase in the total number of reads for each gene, where the number of reads is given by transcript length multiplied by expression level. Therefore, there may be circumstances where it is desirable to correct for the effect of expression level on power to detect DE, in addition to the contribution from transcript length, that is, total read count bias (for further discussion see Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). The GOseq method is capable of handling both types of bias. We have mainly focused on transcript length bias as it will always need to be accounted for and because the decision to account for expression level or not ultimately depends on the questions the user wishes to answer.</p>
      <p>To assess the impact of total read count bias, GOseq was used to analyze the prostate cancer data set accounting for read count bias. As expected, correcting for read count bias results in even greater differences compared to the standard hypergeometric method than just correcting for length bias alone. When read count bias is corrected for in the prostate cancer data set, more than 50% of significant GO categories are different from the list of significant GO categories obtained using the standard hypergeometric method (Figure <xref ref-type="fig" rid="F6">6</xref>). This is true even for the very top GO categories - there is only one GO category that appears in the top ten in both the standard and read count adjusted lists (Tables <xref ref-type="table" rid="T3">3</xref> and <xref ref-type="table" rid="T4">4</xref>).</p>
      <fig id="F6" position="float">
        <label>Figure 6</label>
        <caption>
          <p><bold>Change in most significant categories when correcting for total read count bias or length bias versus the standard method</bold>. A plot of the number of discrepancies in the most significant GO categories generated using different methods. This plot compares the length bias correcting version of GOseq to the standard hypergeometric method (green line) and the total read count bias correcting version of GO-seq to the standard hypergeometric method (black line).</p>
        </caption>
        <graphic xlink:href="gb-2010-11-2-r14-6"/>
      </fig>
      <table-wrap id="T3" position="float">
        <label>Table 3</label>
        <caption>
          <p>Top ten Gene Ontology categories using the standard method</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left">GOID</th>
              <th align="left">Term</th>
              <th align="center">Ontology</th>
              <th align="center">Rank standard</th>
              <th align="center">Rank GOseq</th>
              <th align="center">Median read count of genes in category</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">GO:0005515</td>
              <td align="left">Protein binding</td>
              <td align="center">MF</td>
              <td align="center">1</td>
              <td align="center">11</td>
              <td align="center">206</td>
            </tr>
            <tr>
              <td align="left">GO:0005737</td>
              <td align="left">Cytoplasm</td>
              <td align="center">CC</td>
              <td align="center">2</td>
              <td align="center">111</td>
              <td align="center">238</td>
            </tr>
            <tr>
              <td align="left">GO:0005634</td>
              <td align="left">Nucleus</td>
              <td align="center">CC</td>
              <td align="center">3</td>
              <td align="center">4,303</td>
              <td align="center">228</td>
            </tr>
            <tr>
              <td align="left">GO:0000166</td>
              <td align="left">Nucleotide binding</td>
              <td align="center">MF</td>
              <td align="center">4</td>
              <td align="center">2,546</td>
              <td align="center">252</td>
            </tr>
            <tr>
              <td align="left">GO:0005829</td>
              <td align="left">Cytosol</td>
              <td align="center">CC</td>
              <td align="center">5</td>
              <td align="center">1,192</td>
              <td align="center">349</td>
            </tr>
            <tr>
              <td align="left">GO:0005783</td>
              <td align="left">Endoplasmic reticulum</td>
              <td align="center">CC</td>
              <td align="center">6</td>
              <td align="center">6</td>
              <td align="center">197</td>
            </tr>
            <tr>
              <td align="left">GO:0003677</td>
              <td align="left">DNA binding</td>
              <td align="center">MF</td>
              <td align="center">7</td>
              <td align="center">2,109</td>
              <td align="center">189</td>
            </tr>
            <tr>
              <td align="left">GO:0005794</td>
              <td align="left">Golgi apparatus</td>
              <td align="center">CC</td>
              <td align="center">8</td>
              <td align="center">26</td>
              <td align="center">213</td>
            </tr>
            <tr>
              <td align="left">GO:0005622</td>
              <td align="left">Intracellular</td>
              <td align="center">CC</td>
              <td align="center">9</td>
              <td align="center">3,592</td>
              <td align="center">187</td>
            </tr>
            <tr>
              <td align="left">GO:0016874</td>
              <td align="left">Ligase activity</td>
              <td align="center">MF</td>
              <td align="center">10</td>
              <td align="center">88</td>
              <td align="center">353</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>BP, biological process; CC, cellular component; MF, molecular function.</p>
        </table-wrap-foot>
      </table-wrap>
      <table-wrap id="T4" position="float">
        <label>Table 4</label>
        <caption>
          <p>Top ten Gene Ontology categories using GOseq adjusted for total read count bias</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left">GOID</th>
              <th align="left">Term</th>
              <th align="center">Ontology</th>
              <th align="center">Rank standard</th>
              <th align="center">Rank GOseq</th>
              <th align="center">Median read count of genes in category</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">GO:0016020</td>
              <td align="left">Membrane</td>
              <td align="center">CC</td>
              <td align="center">16</td>
              <td align="center">1</td>
              <td align="center">91</td>
            </tr>
            <tr>
              <td align="left">GO:0005886</td>
              <td align="left">Plasma membrane</td>
              <td align="center">CC</td>
              <td align="center">96</td>
              <td align="center">2</td>
              <td align="center">50</td>
            </tr>
            <tr>
              <td align="left">GO:0005887</td>
              <td align="left">Integral to plasma membrane</td>
              <td align="center">CC</td>
              <td align="center">313</td>
              <td align="center">3</td>
              <td align="center">36</td>
            </tr>
            <tr>
              <td align="left">GO:0005576</td>
              <td align="left">Extracellular region</td>
              <td align="center">CC</td>
              <td align="center">4,310</td>
              <td align="center">4</td>
              <td align="center">18</td>
            </tr>
            <tr>
              <td align="left">GO:0015020</td>
              <td align="left">Glucuronosyl transferase activity</td>
              <td align="center">MF</td>
              <td align="center">388</td>
              <td align="center">5</td>
              <td align="center">10</td>
            </tr>
            <tr>
              <td align="left">GO:0005783</td>
              <td align="left">Endoplasmic reticulum</td>
              <td align="center">CC</td>
              <td align="center">6</td>
              <td align="center">6</td>
              <td align="center">197</td>
            </tr>
            <tr>
              <td align="left">GO:0016021</td>
              <td align="left">Integral to membrane</td>
              <td align="center">CC</td>
              <td align="center">179</td>
              <td align="center">7</td>
              <td align="center">68</td>
            </tr>
            <tr>
              <td align="left">GO:0006470</td>
              <td align="left">Protein amino acid dephosphorylation</td>
              <td align="center">BP</td>
              <td align="center">31</td>
              <td align="center">8</td>
              <td align="center">224</td>
            </tr>
            <tr>
              <td align="left">GO:0045944</td>
              <td align="left">Positive regulation of transcription from RNA polymerase II promoter</td>
              <td align="center">BP</td>
              <td align="center">39</td>
              <td align="center">9</td>
              <td align="center">133</td>
            </tr>
            <tr>
              <td align="left">GO:0007049</td>
              <td align="left">Cell cycle</td>
              <td align="center">BP</td>
              <td align="center">14</td>
              <td align="center">10</td>
              <td align="center">202</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>BP, biological process; CC, cellular component; MF, molecular function.</p>
        </table-wrap-foot>
      </table-wrap>
    </sec>
  </sec>
  <sec>
    <title>Discussion</title>
    <sec>
      <title>Biological relevance of selected categories</title>
      <p>To determine the effect of GOseq on the ability to draw biologically meaningful conclusions, the top ten GO categories using the standard hypergeometric method and the read count adjusted GOseq method were compared in the prostate cancer data set (Tables <xref ref-type="table" rid="T3">3</xref> and <xref ref-type="table" rid="T4">4</xref>). We found that categories identified by GOseq are more consistent with previous studies looking at the relationship of androgens with prostate cancer. The role of androgens in prostate cancer is well supported, with androgen required in rodent prostate cancer induction models, and castration prior to puberty being protective against prostate cancer. Androgen is thought to be responsible for promotion of prostate cancer progression through enhancing the androgen regulated processes of growth and cellular activity. In normal prostate, androgen supports the secretary epithelial, which turns over at a rate of 1 to 2% of cells per day, and most prostate cancers are derived from these cells [<xref ref-type="bibr" rid="B22">22</xref>]. Based on this biological knowledge the prior expectation is that there will be an increase in cellular activity, proliferation and secretion in LNCaP cells in response to androgen. Previous microarray experiments have shown that LNCaP cells retain androgen responsiveness and that most genes upregulated are involved in the production of seminal fluid [<xref ref-type="bibr" rid="B23">23</xref>].</p>
      <p>In the standard analysis, the top ten GO categories indicate a change in intracellular genes, including nuclear and DNA binding genes (Table <xref ref-type="table" rid="T3">3</xref>). The top ten categories using GOseq with total read count adjustment indicate significant changes at membranes and extracellular space, transcriptional upregulation, and in cell cycle genes (Table <xref ref-type="table" rid="T4">4</xref>). The categories identified as most significant by GOseq therefore better match the known biology of androgen response in prostate cancer. The genes that are significant only with the length bias adjustment (Table <xref ref-type="table" rid="T2">2</xref>) include four categories consistent with increased translation and protein production, vesical mediated transport consistent with secretion, and two categories related to nucleosomes consistent with increased replication. The category of small conjugating protein ligase activity is supported by the previously reported up-regulation of ubiquitin ligases UBE2C and HSPC150 [<xref ref-type="bibr" rid="B23">23</xref>].</p>
    </sec>
    <sec>
      <title>Possibility of true biological trends in gene length</title>
      <p>A key assumption of GOseq is that longer genes are not of biologically greater interest than shorter genes, <italic>per se</italic>. This assumption is supported by microarray data, where no systematic trend between gene length and differential expression has been observed [<xref ref-type="bibr" rid="B5">5</xref>]. The authors find it hard to imagine that any genuine biological process could induce a trend in differential expression versus gene length comparable in magnitude to the technical trend that is removed by GOseq. Nevertheless, users should be aware that any biological trend in DE versus gene length will be adjusted for by GOseq.</p>
    </sec>
    <sec>
      <title>Using the Wallenius approximation</title>
      <p>The reduction in computation afforded by the Wallenius approximation is predicated on the assumption that the variance in the probability weighting within categories is low. Hence, the approximation will perform better for a probability weighting function with a low range of probabilities. When the range in probabilities as a function of gene length or read count is large, random sampling performs better than the Wallenius approximation, even at a relatively small number of replicates. The probability weighting function for read count bias has a larger range in probabilities compared to the PWF for length bias in the prostate cancer data set (Figure <xref ref-type="fig" rid="F2">2</xref>) and so random sampling may be more appropriate when accounting for total read count bias.</p>
    </sec>
    <sec>
      <title>GOseq and other technologies</title>
      <p>GOseq with total read count adjustment is relevant for other tag-based next generation expression profiling technologies, such as SAGE or CAGE, which have no transcript length bias [<xref ref-type="bibr" rid="B24">24</xref>]. Even without length bias, statistical power to detect differential expression still depends on the expression level of each transcript and correcting for this bias will generally be desirable in this context.</p>
      <p>GO analysis of microarray expression data has so far ignored the possibility of selection bias, but such bias clearly does exist. It is well known that fold changes are more precisely estimated for microarray probes at higher intensity levels, so selection bias is likely to exist as a function of intensity. Furthermore, most microarray platforms have multiple probes for some genes. Genes with more probes will have a great chance of being selected as DE, assuming the analysis is conducted probe-wise. The methodology developed here for RNA-seq could easily be adapted to GO analysis of microarray data, and would likely yield benefits in terms of biological relevance.</p>
    </sec>
    <sec>
      <title>GOseq software</title>
      <p>In order to implement the GOseq method, we developed a set of freely available R functions, which includes functions for calculating the significance of over-representation of each GO category amongst DE genes. These functions give the user the option of selecting which type of bias they wish to compensate for (transcript length bias or total read count bias). The option of using random sampling or the Wallenius approximation is also available. The ability of the user to supply their own categories for unbiased testing is also included. The software is freely available and can be downloaded from our website [<xref ref-type="bibr" rid="B25">25</xref>].</p>
    </sec>
  </sec>
  <sec>
    <title>Conclusions</title>
    <p>Here we have developed a statistical framework for GO analysis for use with RNA-seq data. It is mathematically indisputable that all commonly used criteria for judging DE interact with gene length and read count. This provides a well understood causal model of why length bias exists and why it needs to be accounted for. The GOseq method is able to account for such biases when performing GO analysis. We find that the new method makes a substantial difference to the categories identified as the most significant. We show that the GOseq method is able to recover well established microarray results more readily than existing methods of GO analysis of RNA-seq data. Furthermore, using an androgen treated prostate cancer data set we find that the most significant categories identified using GOseq match the known biology better than existing methods.</p>
  </sec>
  <sec sec-type="materials|methods">
    <title>Materials and methods</title>
    <p>All the statistical analyses were performed in R [<xref ref-type="bibr" rid="B26">26</xref>]. The methods are described in detail in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref> and outlined briefly here.</p>
    <sec>
      <title>The prostate cancer data set</title>
      <p>The LNCap cell line was treated with androgen. Mock treated and treated cell lines were sequenced using the Illumina GA 1 [<xref ref-type="bibr" rid="B13">13</xref>]. Raw 35-bp RNA-seq reads were provided and mapped to the human genome using Bowtie. Each mapped read was associated with an ENSEMBL gene. A Poisson exact test [<xref ref-type="bibr" rid="B15">15</xref>,<xref ref-type="bibr" rid="B16">16</xref>] was used to determine differential expression between treated and mock-treated LNCap cells.</p>
    </sec>
    <sec>
      <title>The liver versus kidney data set</title>
      <p>Genome-wide expression was measured in liver and kidney using RNA-seq on the Illumina GA I and hybridization of the same samples to Affymetrix HG-U133 Plus 2.0 arrays. The sample preparation and data analysis was designed to maximize the similarity between the microarray and RNA-seq experiments (see Marioni <italic>et al</italic>. [<xref ref-type="bibr" rid="B21">21</xref>]). Differential expression between kidney and liver was determined using an empirical Bayes modified t-statistic on the microarray platform and <italic>P</italic>-values for DE were downloaded from their website. For the RNA-seq experiment, the data were normalized using TMM normalization [<xref ref-type="bibr" rid="B27">27</xref>] and a negative binomial exact test was used to determine DE [<xref ref-type="bibr" rid="B16">16</xref>]. To test the GOseq method, we used the genes called DE from the microarray experiment to calculate the significance of over-representation of each GO category using the standard GO analysis methods. We also calculated <italic>P</italic>-values for each GO category being over-represented among genes that were DE in the RNA-seq data, using both the GOseq and hypergeometric methods. GOseq's ability to outperform the hypergeometric method, as measured by its ability to reproduce the results of the microarray GO analysis, was quantified by calculating a <italic>P</italic>-value for the difference in the two methods being due to chance. To do this, a NULL was chosen under which both methods were equally likely to correctly recover each microarray GO category, with this likelihood given by a binomial distribution.</p>
    </sec>
    <sec>
      <title>The probability weighting function</title>
      <p>To calculate the PWF, a cubic spline with a montonicity constraint is fitted to the binary data series where a value of 1 refers to a DE gene and 0 refers to a non-DE gene. This fit can be calculated against either the length of the gene or the read counts of a gene. We used the R function pcls in the mgcv package to generate the fit.</p>
    </sec>
    <sec>
      <title>Calculating significance of categories</title>
      <p>Random samples of genes are created by selecting a subset of genes from the experiment, with each gene weighted by the probability derived from the PWF. Each random sample contains the same number of genes as the set of DE genes. For each sample the number of genes with a given GO category is calculated. Many samples are generated in order to produce a null distribution from which the <italic>P</italic>-value for the significance of a category can be estimated.</p>
      <p>To implement the Wallenius approximation, we used the BiasedUrn package in R. The 'odds' parameter is defined as the relative probability of genes within a category to the genes outside the category. The 'odds' ratio is calculated by taking the mean of the values from the PWF for each gene in the set and dividing by the mean of the values from the PWF for genes outside the set.</p>
    </sec>
  </sec>
  <sec>
    <title>Abbreviations</title>
    <p>DE: differentially expressed; GO: Gene Ontology; PWF: probability weighting function.</p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>AO, GKS, and MJW conceived of the idea. AO, MDY, and GKS conceived and performed the analysis. MDY wrote the software. MJW interpreted biological results. MDY, MJW, GKS, and AO wrote the paper. All authors read and approved the final manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1</title>
        <p>A Word document containing supplementary methods, discussion and results. Particular attention is given to technical details of the GOseq method.</p>
      </caption>
      <media xlink:href="gb-2010-11-2-r14-S1.doc" mimetype="application" mime-subtype="msword">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgements</title>
    <p>We thank Mark Robinson for providing insightful discussion and some R code and to Yoav Gilad for critical reading of the manuscript. We thank Gene Yeo and Michael Lovci for providing raw RNA-seq data.</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Fu</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Fu</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Guo</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Yan</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Xu</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Hu</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Menzel</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Chen</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Zeng</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Khaitovich</surname>
          <given-names>P</given-names>
        </name>
        <article-title>Estimating accuracy of RNA-Seq and microarrays with proteomics.</article-title>
        <source>BMC Genomics</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>161</fpage>
        <pub-id pub-id-type="pmid">19371429</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Wang</surname>
          <given-names>ET</given-names>
        </name>
        <name>
          <surname>Sandberg</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Luo</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Khrebtukova</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Zhang</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Mayr</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Kingsmore</surname>
          <given-names>SF</given-names>
        </name>
        <name>
          <surname>Schroth</surname>
          <given-names>GP</given-names>
        </name>
        <name>
          <surname>Burge</surname>
          <given-names>CB</given-names>
        </name>
        <article-title>Alternative isoform regulation in human tissue transcriptomes.</article-title>
        <source>Nature</source>
        <year>2008</year>
        <volume>456</volume>
        <fpage>470</fpage>
        <lpage>476</lpage>
        <pub-id pub-id-type="pmid">18978772</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Wang</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Sun</surname>
          <given-names>Q</given-names>
        </name>
        <name>
          <surname>McGrath</surname>
          <given-names>SD</given-names>
        </name>
        <name>
          <surname>Mardis</surname>
          <given-names>ER</given-names>
        </name>
        <name>
          <surname>Soloway</surname>
          <given-names>PD</given-names>
        </name>
        <name>
          <surname>Clark</surname>
          <given-names>AG</given-names>
        </name>
        <article-title>Transcriptome-wide identification of novel imprinted genes in neonatal mouse brain.</article-title>
        <source>PloS One</source>
        <year>2008</year>
        <volume>3</volume>
        <fpage>e3839</fpage>
        <pub-id pub-id-type="pmid">19052635</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Wahlstedt</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Daniel</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Enstero</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Ohman</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Large-scale mRNA sequencing determines global regulation of RNA editing during brain development.</article-title>
        <source>Genome Res</source>
        <year>2009</year>
        <volume>19</volume>
        <fpage>978</fpage>
        <lpage>986</lpage>
        <pub-id pub-id-type="pmid">19420382</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Oshlack</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Wakefield</surname>
          <given-names>MJ</given-names>
        </name>
        <article-title>Transcript length bias in RNA-seq data confounds systems biology.</article-title>
        <source>Biol Direct</source>
        <year>2009</year>
        <volume>4</volume>
        <fpage>14</fpage>
        <pub-id pub-id-type="pmid">19371405</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Zhou</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Su</surname>
          <given-names>Z</given-names>
        </name>
        <article-title>EasyGO: Gene Ontology-based annotation and functional enrichment analysis tool for agronomical species.</article-title>
        <source>BMC Genomics</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>246</fpage>
        <pub-id pub-id-type="pmid">17645808</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Zeeberg</surname>
          <given-names>BR</given-names>
        </name>
        <name>
          <surname>Feng</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>MD</given-names>
        </name>
        <name>
          <surname>Fojo</surname>
          <given-names>AT</given-names>
        </name>
        <name>
          <surname>Sunshine</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Narasimhan</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Kane</surname>
          <given-names>DW</given-names>
        </name>
        <name>
          <surname>Reinhold</surname>
          <given-names>WC</given-names>
        </name>
        <name>
          <surname>Lababidi</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Bussey</surname>
          <given-names>KJ</given-names>
        </name>
        <name>
          <surname>Riss</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Barrett</surname>
          <given-names>JC</given-names>
        </name>
        <name>
          <surname>Weinstein</surname>
          <given-names>JN</given-names>
        </name>
        <article-title>GoMiner: a resource for biological interpretation of genomic and proteomic data.</article-title>
        <source>Genome biology</source>
        <year>2003</year>
        <volume>4</volume>
        <fpage>R28</fpage>
        <pub-id pub-id-type="pmid">12702209</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Beissbarth</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Speed</surname>
          <given-names>TP</given-names>
        </name>
        <article-title>GOstat: find statistically overrepresented Gene Ontologies within a group of genes.</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <fpage>1464</fpage>
        <lpage>1465</lpage>
        <pub-id pub-id-type="pmid">14962934</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Martin</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Brun</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Remy</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Mouren</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Thieffry</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Jacq</surname>
          <given-names>B</given-names>
        </name>
        <article-title>GOToolBox: functional analysis of gene datasets based on Gene Ontology.</article-title>
        <source>Genome Biol</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>R101</fpage>
        <pub-id pub-id-type="pmid">15575967</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Alexa</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Rahnenfuhrer</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Lengauer</surname>
          <given-names>T</given-names>
        </name>
        <article-title>Improved scoring of functional groups from gene expression data by decorrelating GO graph structure.</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>1600</fpage>
        <lpage>1607</lpage>
        <pub-id pub-id-type="pmid">16606683</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Subramanian</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Tamayo</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Mootha</surname>
          <given-names>VK</given-names>
        </name>
        <name>
          <surname>Mukherjee</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Ebert</surname>
          <given-names>BL</given-names>
        </name>
        <name>
          <surname>Gillette</surname>
          <given-names>MA</given-names>
        </name>
        <name>
          <surname>Paulovich</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Pomeroy</surname>
          <given-names>SL</given-names>
        </name>
        <name>
          <surname>Golub</surname>
          <given-names>TR</given-names>
        </name>
        <name>
          <surname>Lander</surname>
          <given-names>ES</given-names>
        </name>
        <name>
          <surname>Mesirov</surname>
          <given-names>JP</given-names>
        </name>
        <article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles.</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2005</year>
        <volume>102</volume>
        <fpage>15545</fpage>
        <lpage>15550</lpage>
        <pub-id pub-id-type="pmid">16199517</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Huang da</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Sherman</surname>
          <given-names>BT</given-names>
        </name>
        <name>
          <surname>Lempicki</surname>
          <given-names>RA</given-names>
        </name>
        <article-title>Systematic and integrative analysis of large gene lists using DAVID bioinformatics resources.</article-title>
        <source>Nat Protoc</source>
        <year>2009</year>
        <volume>4</volume>
        <fpage>44</fpage>
        <lpage>57</lpage>
        <pub-id pub-id-type="pmid">19131956</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Li</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Lovci</surname>
          <given-names>MT</given-names>
        </name>
        <name>
          <surname>Kwon</surname>
          <given-names>YS</given-names>
        </name>
        <name>
          <surname>Rosenfeld</surname>
          <given-names>MG</given-names>
        </name>
        <name>
          <surname>Fu</surname>
          <given-names>XD</given-names>
        </name>
        <name>
          <surname>Yeo</surname>
          <given-names>GW</given-names>
        </name>
        <article-title>Determination of tag density required for digital transcriptome analysis: application to an androgen-sensitive prostate cancer model.</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2008</year>
        <volume>105</volume>
        <fpage>20179</fpage>
        <lpage>20184</lpage>
        <pub-id pub-id-type="pmid">19088194</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Ashburner</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Ball</surname>
          <given-names>CA</given-names>
        </name>
        <name>
          <surname>Blake</surname>
          <given-names>JA</given-names>
        </name>
        <name>
          <surname>Botstein</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Butler</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Cherry</surname>
          <given-names>JM</given-names>
        </name>
        <name>
          <surname>Davis</surname>
          <given-names>AP</given-names>
        </name>
        <name>
          <surname>Dolinski</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Dwight</surname>
          <given-names>SS</given-names>
        </name>
        <name>
          <surname>Eppig</surname>
          <given-names>JT</given-names>
        </name>
        <name>
          <surname>Harris</surname>
          <given-names>MA</given-names>
        </name>
        <name>
          <surname>Hill</surname>
          <given-names>DP</given-names>
        </name>
        <name>
          <surname>Issel-Tarver</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Kasarskis</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Lewis</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Matese</surname>
          <given-names>JC</given-names>
        </name>
        <name>
          <surname>Richardson</surname>
          <given-names>JE</given-names>
        </name>
        <name>
          <surname>Ringwald</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Rubin</surname>
          <given-names>GM</given-names>
        </name>
        <name>
          <surname>Sherlock</surname>
          <given-names>G</given-names>
        </name>
        <article-title>Gene ontology: tool for the unification of biology. The Gene Ontology Consortium.</article-title>
        <source>Nat Genet</source>
        <year>2000</year>
        <volume>25</volume>
        <fpage>25</fpage>
        <lpage>29</lpage>
        <pub-id pub-id-type="pmid">10802651</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Robinson</surname>
          <given-names>MD</given-names>
        </name>
        <name>
          <surname>Smyth</surname>
          <given-names>GK</given-names>
        </name>
        <article-title>Moderated statistical tests for assessing differences in tag abundance.</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>2881</fpage>
        <lpage>2887</lpage>
        <pub-id pub-id-type="pmid">17881408</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Robinson</surname>
          <given-names>MD</given-names>
        </name>
        <name>
          <surname>Smyth</surname>
          <given-names>GK</given-names>
        </name>
        <article-title>Small-sample estimation of negative binomial dispersion, with applications to SAGE data.</article-title>
        <source>Biostatistics</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>321</fpage>
        <lpage>332</lpage>
        <pub-id pub-id-type="pmid">17728317</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Robinson</surname>
          <given-names>MD</given-names>
        </name>
        <name>
          <surname>McCarthy</surname>
          <given-names>DJ</given-names>
        </name>
        <name>
          <surname>Smyth</surname>
          <given-names>GK</given-names>
        </name>
        <article-title>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data.</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>26</volume>
        <fpage>139</fpage>
        <lpage>140</lpage>
        <pub-id pub-id-type="pmid">19910308</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Benjamini</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Hochberg</surname>
          <given-names>Y</given-names>
        </name>
        <article-title>Controlling the false discovery rate: a pratical and powerful approach to multiple testing.</article-title>
        <source>J R Stat Soc Series B (Methodological)</source>
        <year>1995</year>
        <volume>57</volume>
        <fpage>289</fpage>
        <lpage>300</lpage>
      </mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Mortazavi</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Williams</surname>
          <given-names>BA</given-names>
        </name>
        <name>
          <surname>McCue</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Schaeffer</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Wold</surname>
          <given-names>B</given-names>
        </name>
        <article-title>Mapping and quantifying mammalian transcriptomes by RNA-Seq.</article-title>
        <source>Nat Methods</source>
        <year>2008</year>
        <volume>5</volume>
        <fpage>621</fpage>
        <lpage>628</lpage>
        <pub-id pub-id-type="pmid">18516045</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="book">
        <name>
          <surname>Wallenius</surname>
          <given-names>KT</given-names>
        </name>
        <source>Biased sampling: the non-central hypegeometric probability distribution.</source>
        <year>1963</year>
        <publisher-name>PhD: Stanford University</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Marioni</surname>
          <given-names>JC</given-names>
        </name>
        <name>
          <surname>Mason</surname>
          <given-names>CE</given-names>
        </name>
        <name>
          <surname>Mane</surname>
          <given-names>SM</given-names>
        </name>
        <name>
          <surname>Stephens</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Gilad</surname>
          <given-names>Y</given-names>
        </name>
        <article-title>RNA-seq: an assessment of technical reproducibility and comparison with gene expression arrays.</article-title>
        <source>Genome Res</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>1509</fpage>
        <lpage>1517</lpage>
        <pub-id pub-id-type="pmid">18550803</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Feldman</surname>
          <given-names>BJ</given-names>
        </name>
        <name>
          <surname>Feldman</surname>
          <given-names>D</given-names>
        </name>
        <article-title>The development of androgen-independent prostate cancer.</article-title>
        <source>Nat Rev Cancer</source>
        <year>2001</year>
        <volume>1</volume>
        <fpage>34</fpage>
        <lpage>45</lpage>
        <pub-id pub-id-type="pmid">11900250</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal">
        <name>
          <surname>DePrimo</surname>
          <given-names>SE</given-names>
        </name>
        <name>
          <surname>Diehn</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Nelson</surname>
          <given-names>JB</given-names>
        </name>
        <name>
          <surname>Reiter</surname>
          <given-names>RE</given-names>
        </name>
        <name>
          <surname>Matese</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Fero</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Tibshirani</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Brown</surname>
          <given-names>PO</given-names>
        </name>
        <name>
          <surname>Brooks</surname>
          <given-names>JD</given-names>
        </name>
        <article-title>Transcriptional programs activated by exposure of human prostate cancer cells to androgen.</article-title>
        <source>Genome Biol</source>
        <year>2002</year>
        <volume>3</volume>
        <fpage>RESEARCH0032</fpage>
        <pub-id pub-id-type="pmid">12184806</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal">
        <name>
          <surname>t Hoen</surname>
          <given-names>PA</given-names>
        </name>
        <name>
          <surname>Ariyurek</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Thygesen</surname>
          <given-names>HH</given-names>
        </name>
        <name>
          <surname>Vreugdenhil</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Vossen</surname>
          <given-names>RH</given-names>
        </name>
        <name>
          <surname>de Menezes</surname>
          <given-names>RX</given-names>
        </name>
        <name>
          <surname>Boer</surname>
          <given-names>JM</given-names>
        </name>
        <name>
          <surname>van Ommen</surname>
          <given-names>GJ</given-names>
        </name>
        <name>
          <surname>den Dunnen</surname>
          <given-names>JT</given-names>
        </name>
        <article-title>Deep sequencing-based expression analysis shows major advances in robustness, resolution and inter-lab portability over five microarray platforms.</article-title>
        <source>Nucleic Acids Res</source>
        <year>2008</year>
        <volume>36</volume>
        <fpage>e141</fpage>
        <pub-id pub-id-type="pmid">18927111</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="other">
        <article-title>GOseq software</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://bioinf.wehi.edu.au/software/goseq/">http://bioinf.wehi.edu.au/software/goseq/</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="other">
        <article-title>The R Project for Statistical Computing</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.r-project.org/">http://www.r-project.org/</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="other">
        <name>
          <surname>Robinson</surname>
          <given-names>MD</given-names>
        </name>
        <name>
          <surname>Oshlack</surname>
          <given-names>A</given-names>
        </name>
        <article-title>A scaling normalization method for differential expression analysis of RNA-seq data.</article-title>
        <source>Genome Biology</source>
        <year>2010</year>
        <comment> in press </comment>
      </mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Langmead</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Trapnell</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Pop</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Salzberg</surname>
          <given-names>SL</given-names>
        </name>
        <article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome.</article-title>
        <source>Genome Biol</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>R25</fpage>
        <pub-id pub-id-type="pmid">19261174</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="other">
        <article-title>Ensembl BioMart</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.biomart.org">http://www.biomart.org</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Barnard</surname>
          <given-names>GA</given-names>
        </name>
        <article-title>Contribution to the discussion of Professor Bartlet's paper.</article-title>
        <source>J Roy Stat Soc Series B (Methodological)</source>
        <year>1963</year>
        <volume>25</volume>
        <fpage>294</fpage>
      </mixed-citation>
    </ref>
    <ref id="B31">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Efraimidis</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Spirakis</surname>
          <given-names>PG</given-names>
        </name>
        <article-title>Weighted random sampling with a reservoir.</article-title>
        <source>Information Processing Lett</source>
        <year>2005</year>
        <volume>97</volume>
        <fpage>181</fpage>
        <lpage>185</lpage>
      </mixed-citation>
    </ref>
    <ref id="B32">
      <mixed-citation publication-type="book">
        <name>
          <surname>Smyth</surname>
          <given-names>GK</given-names>
        </name>
        <person-group person-group-type="editor">Gentleman R, Care V, Dudoit S, Irizarry R, Huber W</person-group>
        <article-title>Limma: linear models for microarray data.</article-title>
        <source>Bioinformatics and Computational Biology Solutions using R and Bioconductor</source>
        <year>2005</year>
        <publisher-name>New York: Springer</publisher-name>
        <fpage>397</fpage>
        <lpage>420</lpage>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
