<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Algorithms Mol Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Algorithms Mol Biol</journal-id>
    <journal-title-group>
      <journal-title>Algorithms for Molecular Biology : AMB</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1748-7188</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3549825</article-id>
    <article-id pub-id-type="publisher-id">1748-7188-7-34</article-id>
    <article-id pub-id-type="pmid">23216990</article-id>
    <article-id pub-id-type="doi">10.1186/1748-7188-7-34</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Alignment-free phylogeny of whole genomes using underlying subwords</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes" id="A1">
        <name>
          <surname>Comin</surname>
          <given-names>Matteo</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>comin@dei.unipd.it</email>
      </contrib>
      <contrib contrib-type="author" id="A2">
        <name>
          <surname>Verzotto</surname>
          <given-names>Davide</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>verzotto@dei.unipd.it</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Department of Information Engineering, University of Padova, Padova, Italy</aff>
    <pub-date pub-type="collection">
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>6</day>
      <month>12</month>
      <year>2012</year>
    </pub-date>
    <volume>7</volume>
    <fpage>34</fpage>
    <lpage>34</lpage>
    <history>
      <date date-type="received">
        <day>19</day>
        <month>9</month>
        <year>2012</year>
      </date>
      <date date-type="accepted">
        <day>29</day>
        <month>11</month>
        <year>2012</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright ©2012 Comin and Verzotto; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2012</copyright-year>
      <copyright-holder>Comin and Verzotto; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://www.almob.org/content/7/1/34"/>
    <abstract>
      <sec>
        <title>Background</title>
        <p>With the progress of modern sequencing technologies a large number of complete genomes are now available. Traditionally the comparison of two related genomes is carried out by sequence alignment. There are cases where these techniques cannot be applied, for example if two genomes do not share the same set of genes, or if they are not alignable to each other due to low sequence similarity, rearrangements and inversions, or more specifically to their lengths when the organisms belong to different species. For these cases the comparison of complete genomes can be carried out only with ad hoc methods that are usually called alignment-free methods.</p>
      </sec>
      <sec>
        <title>Methods</title>
        <p>In this paper we propose a distance function based on subword compositions called Underlying Approach (UA). We prove that the matching statistics, a popular concept in the field of string algorithms able to capture the statistics of common words between two sequences, can be derived from a small set of “independent” subwords, namely the irredundant common subwords. We define a distance-like measure based on these subwords, such that each region of genomes contributes only once, thus avoiding to count shared subwords a multiple number of times. In a nutshell, this filter discards subwords occurring in regions covered by other more significant subwords.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>The Underlying Approach (UA) builds a scoring function based on this set of patterns, called underlying. We prove that this set is by construction linear in the size of input, without overlaps, and can be efficiently constructed. Results show the validity of our method in the reconstruction of phylogenetic trees, where the Underlying Approach outperforms the current state of the art methods. Moreover, we show that the accuracy of UA is achieved with a very small number of subwords, which in some cases carry meaningful biological information.</p>
      </sec>
      <sec>
        <title>Availability</title>
        <p>
          <ext-link ext-link-type="uri" xlink:href="http://www.dei.unipd.it/~ciompin/main/underlying.html">http://www.dei.unipd.it/∼ciompin/main/underlying.html</ext-link>
        </p>
      </sec>
    </abstract>
    <kwd-group>
      <kwd>Phylogeny</kwd>
      <kwd>Alignment-free algorithms</kwd>
      <kwd>Pattern discovery</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>The global spread of low-cost high-throughput sequencing technologies has made a large number of complete genomes publicly available, and this number is still growing rapidly. In contrast, only few computational methods can really handle as input entire chromosomes, or entire genomes.</p>
    <p>Traditionally the comparison of related genomes is carried out by sequence alignment. Popular methods extract gene-specific sequences from all species under examination and build a multiple sequence alignment for each gene
[<xref ref-type="bibr" rid="B1">1</xref>]. Then all multiple sequence alignments are merged to form the final phylogeny. Other methods
[<xref ref-type="bibr" rid="B2">2</xref>] use genes as a dictionary, counting the presence or absence of a gene. This gene profile is then used to derive a similarity score. However, if the genomes in question do not share a common set of genes, or if they cannot be aligned to each other, e.g., due to substantially different lengths, these traditional techniques cannot be applied. As a general example, in a pairwise comparison of genomes popular alignment tools rely on a specific order of elements for each genome sequence, and on a set of sparse shared seeds that should then be extended to obtain a global alignment. Therefore low sequence similarity, rearrangements, and inversions can cause major problems in identifying a possible alignment and thus the actual sequence similarity.</p>
    <p>Furthermore, when considering whole genomes, the global alignment of large sequences has become a prohibitive task even for supercomputers, hence simply infeasible. To overcome these obstacles, in the last ten years a variety of alignment-free methods have been proposed. In principle they are all based on counting procedures that characterize a sequence based on its constituents, e.g., <italic>k</italic>-mers
[<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B4">4</xref>].</p>
    <p>An important aspect in phylogeny reconstruction is the fact that gene-based methods strictly focus on comparing the coding regions of genomes, which can account for as little as 1% of the genomic sequence in humans
[<xref ref-type="bibr" rid="B5">5</xref>]. Whereas it is known that the use of whole genomes may provide more robust information when comparing different organisms
[<xref ref-type="bibr" rid="B6">6</xref>]. Also most alignment-free methods in the literature use only a portion of complete genomes
[<xref ref-type="bibr" rid="B7">7</xref>]. For instance, there are approaches that use only genic regions
[<xref ref-type="bibr" rid="B3">3</xref>] or mitochondria; other methods filter out regions that are highly repetitive or with low complexity
[<xref ref-type="bibr" rid="B4">4</xref>]. Recently, it has been shown that the evolutionary information is also carried by non-genic regions
[<xref ref-type="bibr" rid="B8">8</xref>]. For certain viruses, we are not even able to estimate a complete phylogeny by analyzing their genes, since these organisms may share a very limited genetic material
[<xref ref-type="bibr" rid="B7">7</xref>].</p>
    <p>Sims <italic>et al.</italic> recently applied the Feature Frequency Profiles method (FFP) presented in
[<xref ref-type="bibr" rid="B4">4</xref>] to compute a whole-genome phylogeny of mammals
[<xref ref-type="bibr" rid="B8">8</xref>]—i.e., large eukaryotic genomes including the human genome — and of bacteria. This method needs to estimate the parameter <italic>k</italic> in order to compute a feature vector for each sequence, where the vector represents the frequency of each possible <italic>k</italic>-mer. Each feature vector is then normalized by the total number of <italic>k</italic>-mers found (i.e., by the sequence length minus <italic>k-1</italic>), obtaining a probability distribution vector, or feature frequency profile, for each genome. FFP finally computes the distance matrix between all pairs of genomes by applying the Jensen-Shannon
[<xref ref-type="bibr" rid="B9">9</xref>] divergence to their frequency profiles.</p>
    <p>This general characterization of strings based on their subsequence composition closely resembles some of the information theory problems, and is tightly related with the compression of strings. In fact, compositional methods can be viewed as the reinterpretation of data compression methods, well known in the literature
[<xref ref-type="bibr" rid="B10">10</xref>,<xref ref-type="bibr" rid="B11">11</xref>]. For a comprehensive survey on the importance and implications of data compression methods in computational biology, we refer the reader to
[<xref ref-type="bibr" rid="B12">12</xref>].</p>
    <p>When comparing entire genomes we want to avoid that large non-coding regions, which by nature tend to be highly repetitive, may contribute to our scoring function a multiple number of times, thus misleading the final similarity score. In fact, while analyzing massive genomes, the number of repeated patterns is very high, particularly in the non-genic regions. Furthermore if we allow mismatches the number of patterns can grows exponentially
[<xref ref-type="bibr" rid="B13">13</xref>-<xref ref-type="bibr" rid="B15">15</xref>]. In this paper we will address this problem by controlling the distribution of subwords over the sequences under consideration, so that their contribution will not be overcounted.</p>
    <p>Moreover, when comparing genomes it is well known that different evolutionary mechanisms can take place. In this framework, two closely related species are expected to share larger portions of DNA than two distant ones, whereby also other large complements and reverse-complements, or inversions, may occur
[<xref ref-type="bibr" rid="B16">16</xref>]. In this work we will take into account all these symmetries, in order to define a measure of similarity between whole genomes.</p>
    <sec>
      <title>Matching statistics</title>
      <p>Among the many distance measures proposed in the literature, which in most cases are dealing with <italic>k</italic>-mers, an effective and particularly elegant method is the Average Common Subword approach (ACS), introduced by Ulitsky <italic>et al.</italic>[<xref ref-type="bibr" rid="B7">7</xref>]. They use a popular concept in the field of string algorithms, known as matching statistics
[<xref ref-type="bibr" rid="B17">17</xref>]. In short, given two sequences <italic>s</italic><sub>1</sub> and <italic>s</italic><sub>2</sub>, where <italic>s</italic><sub>1</sub> is the reference sequence, the matching statistic is a vector <italic>l</italic> such that <italic>l</italic>
[<italic>i</italic>] is the length of the longest subword starting at position <italic>i</italic> of <italic>s</italic><sub>1</sub> that is also a subword of <italic>s</italic><sub>2</sub>, for every possible position <italic>i</italic> of <italic>s</italic><sub>1</sub>(see Table
<xref ref-type="table" rid="T1">1</xref>).</p>
      <table-wrap position="float" id="T1">
        <label>Table 1</label>
        <caption>
          <p>
            <bold>Example of matching statistics </bold>
            <bold>
              <italic>l</italic>
            </bold>
            <sub>
              <bold>1</bold>
            </sub>
            <bold>[</bold>
            <bold>
              <italic>i</italic>
            </bold>
            <bold>] and </bold>
            <bold>
              <italic>l</italic>
            </bold>
            <sub>
              <bold>2</bold>
            </sub>
            <bold>[</bold>
            <bold>
              <italic>j</italic>
            </bold>
            <bold>] for the strings </bold>
            <bold>
              <italic>s</italic>
            </bold>
            <sub>
              <bold>1</bold>
            </sub>
            <bold> = </bold>
            <monospace>ACACGTAC</monospace>
            <bold>and </bold>
            <bold>
              <italic>s</italic>
            </bold>
            <sub>
              <bold>2</bold>
            </sub>
            <bold> = </bold>
            <monospace>TACGTGTA</monospace>
          </p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="left"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th colspan="9" align="left"> </th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td align="left" valign="bottom"><italic>s</italic><sub>1</sub>[<italic>i</italic>]<hr/></td>
              <td align="center" valign="bottom">
                <monospace>A</monospace>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <monospace>C</monospace>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <monospace>A</monospace>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <monospace>C</monospace>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <monospace>G</monospace>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <monospace>T</monospace>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <monospace>A</monospace>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <monospace>C</monospace>
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left" valign="bottom"><italic>l</italic><sub>1</sub>[<italic>i</italic>]<hr/></td>
              <td align="center" valign="bottom">2<hr/></td>
              <td align="center" valign="bottom">1<hr/></td>
              <td align="center" valign="bottom">4<hr/></td>
              <td align="center" valign="bottom">3<hr/></td>
              <td align="center" valign="bottom">3<hr/></td>
              <td align="center" valign="bottom">3<hr/></td>
              <td align="center" valign="bottom">2<hr/></td>
              <td align="center" valign="bottom">1<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"><italic>s</italic><sub>2</sub>[<italic>j</italic>]<hr/></td>
              <td align="center" valign="bottom">
                <monospace>T</monospace>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <monospace>A</monospace>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <monospace>C</monospace>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <monospace>G</monospace>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <monospace>T</monospace>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <monospace>G</monospace>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <monospace>T</monospace>
                <hr/>
              </td>
              <td align="center" valign="bottom">
                <monospace>A</monospace>
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left"><italic>l</italic><sub>2</sub>[<italic>j</italic>]</td>
              <td align="center">3</td>
              <td align="center">4</td>
              <td align="center">3</td>
              <td align="center">2</td>
              <td align="center">1</td>
              <td align="center">3</td>
              <td align="center">2</td>
              <td align="center">1</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>A popular measure of similarity between strings is the average of this vector. In fact the general form of ACS is: </p>
      <p>
        <disp-formula>
          <mml:math id="M1" name="1748-7188-7-34-i1" overflow="scroll">
            <mml:mrow>
              <mml:mtext mathvariant="italic">ACS</mml:mtext>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>s</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
              </mml:msub>
              <mml:mo>,</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>s</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mn>2</mml:mn>
                </mml:mrow>
              </mml:msub>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mo>∑</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>|</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>s</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>|</mml:mo>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mi>l</mml:mi>
                  <mml:mo>[</mml:mo>
                  <mml:mi>i</mml:mi>
                  <mml:mo>]</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mo>|</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>s</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>|</mml:mo>
                </mml:mrow>
              </mml:mfrac>
              <mml:mi>.</mml:mi>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>We can notice the similarity with the cross entropy of two probability distributions <italic>P</italic> and <italic>Q</italic>: </p>
      <p>
        <disp-formula>
          <mml:math id="M2" name="1748-7188-7-34-i2" overflow="scroll">
            <mml:mrow>
              <mml:mi>H</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>P</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>Q</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mo>−</mml:mo>
              <mml:munder accentunder="true">
                <mml:mrow>
                  <mml:mi mathsize="big">∑</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>x</mml:mi>
                </mml:mrow>
              </mml:munder>
              <mml:mi>p</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>x</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mtext>log</mml:mtext>
              <mml:mi>q</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>x</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>,</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p> where <italic>p</italic>(<italic>x</italic>) log<italic> q</italic>(<italic>x</italic>) measures the number of bits needed to code an event <italic>x</italic> from <italic>P</italic> if a different coding scheme based on <italic>Q</italic> is used, averaged over all possible events <italic>x</italic>.</p>
      <p>From the theoretical prospective it can be shown
[<xref ref-type="bibr" rid="B7">7</xref>] that the ACS approach mimics the cross entropy estimated between two large sequences generated by a finite-state Markov process. In practice, this is closely related to the Kullback-Leibler information divergence, and represents the minimum number of bits needed to describe one string, given the other: <italic>D</italic><sub><italic>KL</italic></sub>(<italic>P </italic>∥<italic> Q</italic>) =<italic> H</italic>(<italic>P</italic>,<italic>Q</italic>) −<italic> H</italic>(<italic>P</italic>). This is perhaps the most frequently used information-theoretic similarity measure.</p>
      <p>The advantage of using the matching statistics is that it is not based on fixed-length subwords, but it can capture also variable length matches, in contrast to most methods that are based on fixed sets of <italic>k</italic>-mers. In fact, with the latter the choice of the parameter <italic>k</italic> is critical, and every method needs to estimate <italic>k</italic> from the data under examination, typically using empirical measurements
[<xref ref-type="bibr" rid="B4">4</xref>].</p>
      <p>For this reason ACS proved to be useful for reconstructing whole-genome phylogenies of viruses, bacteria, and eukaryotes, outperforming in most cases the state-of-the-art methods
[<xref ref-type="bibr" rid="B7">7</xref>].</p>
    </sec>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <p>In this section we propose a distance measure between entire genomes based on the notion of underlying subwords. In order to build a sound similarity measure between genomes, we need first to study the properties of the matching statistics. Our first contribution is the characterization of the subwords that are needed to compute the matching statistics. A second contribution is the selection of these subwords so that the resulting similarity measure does not contain overcounts. Our main idea is to avoid overlaps between selected subwords, more precisely by discarding common subwords occurring in regions covered by other more significant subwords.</p>
    <sec>
      <title>Irredundant common subwords</title>
      <p>In the literature, the values <italic>l</italic>[<italic>i</italic>] used by the ACS approach are called the <italic>matching statistics</italic>, as described in detail by Gusfield
[<xref ref-type="bibr" rid="B17">17</xref>]. Our first contribution is to characterize the matching statistics in order to identify which subwords are essentials.</p>
      <p>It is well known that the total number of distinct subwords of any length found in a sequence of length <italic>n</italic> can be at most Θ(<italic>n</italic><sup>2</sup>). Remarkably a notable family of fewer than <italic>2n</italic> subwords exist that is maximal in the host sequence, in the sense that it is impossible to extend a word in this class by appending one or more characters to it without losing some of its occurrences
[<xref ref-type="bibr" rid="B18">18</xref>]. It has been shown that the matching statistics can be derived from this set of maximal subwords
[<xref ref-type="bibr" rid="B19">19</xref>]. Here we will further tighten this bound by showing that to compute the matching statistics it is enough to consider a subset of the maximal subwords, called <italic>irredundant common subwords</italic>.</p>
      <p>The notion of irredundancy was introduced in
[<xref ref-type="bibr" rid="B20">20</xref>] and later modified for the problem of protein comparison
[<xref ref-type="bibr" rid="B21">21</xref>,<xref ref-type="bibr" rid="B22">22</xref>]. It proved useful in different contexts from data compression
[<xref ref-type="bibr" rid="B23">23</xref>] to the identification of transcription factors
[<xref ref-type="bibr" rid="B24">24</xref>]. In this paper we introduce the concept of <italic>irredundant common subwords</italic> (i.e., without mismatches/wildcards). This ensures that there exists a close correspondence between the irredundant common subwords and the matching statistics.</p>
      <sec>
        <title>Definition 1</title>
        <p>(Irredundant/Redundant common subword) A common subword <italic>w</italic> is <italic>irredundant</italic> if and only if at least an occurrence of <italic>w</italic> in <italic>s</italic><sub>1</sub> or <italic>s</italic><sub>2</sub> is not covered by other common subwords. A common subword that does not satisfy this condition is called a redundant common subword.</p>
        <p>We observe that the number of irredundant common subwords
<inline-formula><mml:math id="M3" name="1748-7188-7-34-i3" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="script">I</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> is bounded by <italic>m</italic> + <italic>n</italic>, where |<italic>s</italic><sub>1</sub>| =<italic> n </italic>and |<italic>s</italic><sub>2</sub>| =<italic> m</italic>, since it is a subset of the set of <italic>maximal common subwords</italic> (see
[<xref ref-type="bibr" rid="B19">19</xref>,<xref ref-type="bibr" rid="B25">25</xref>] for a more complete treatment of this topic).</p>
      </sec>
      <sec>
        <title>Proposition 1</title>
        <p>The matching statistics
<inline-formula><mml:math id="M4" name="1748-7188-7-34-i4" overflow="scroll"><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> can be computed by combining together all and only the irredundant common subwords of <italic>s</italic><sub>1</sub> and <italic>s</italic><sub>2</sub>.</p>
      </sec>
      <sec>
        <title>Proof</title>
        <p>To show that the vector
<inline-formula><mml:math id="M5" name="1748-7188-7-34-i5" overflow="scroll"><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> can be derived from the irredundant common subwords, we define a new vector of scores <italic>l</italic><sub><italic>w </italic></sub>for each subword <italic>w</italic>, where <italic>l</italic><sub><italic>w</italic></sub>[<italic>j</italic>] = |<italic>w</italic>|−<italic>j</italic> + 1 represents the length of each suffix <italic>j</italic> of <italic>w</italic>, with <italic>j </italic>= 1,…,|<italic>w</italic>|. Then, for each subword <italic>w</italic> in
<inline-formula><mml:math id="M6" name="1748-7188-7-34-i6" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">I</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> we superimpose the vector <italic>l</italic><sub><italic>w </italic></sub>on all the occurrences of <italic>w</italic> in <italic>s</italic><sub>1</sub>. For each position <italic>i</italic>, in <italic>s</italic><sub>1</sub>,
<inline-formula><mml:math id="M7" name="1748-7188-7-34-i7" overflow="scroll"><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> is the maximum value of the scores <italic>ma</italic><italic>x</italic><sub><italic>w</italic></sub>(<italic>l</italic><sub><italic>w</italic></sub>[<italic>j</italic>]), such that <italic>k</italic> + <italic>j </italic>=<italic> i </italic>and <italic>k</italic> is an occurrence of <italic>w</italic>.</p>
        <p>To complete the proof we have to show that every occurrence of a common subword of <italic>s</italic><sub>1</sub> and <italic>s</italic><sub>2</sub> is covered by some occurrence of a subword in
<inline-formula><mml:math id="M8" name="1748-7188-7-34-i8" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">I</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula>. By definition of irredundant common subword, any occurrence of a subword corresponds to an irredundant common subwords or is covered by some subword in
<inline-formula><mml:math id="M9" name="1748-7188-7-34-i9" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">I</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula>. Moreover every irredundant common subword <italic>w</italic> has at least an occurrence <italic>i</italic> that is not covered by other subwords. Thus,
<inline-formula><mml:math id="M10" name="1748-7188-7-34-i10" overflow="scroll"><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> corresponds exactly to |<italic>w</italic>| and the subword <italic>w</italic> is necessary to compute the matching statistics. In conclusion, by using the method described above for
<inline-formula><mml:math id="M11" name="1748-7188-7-34-i11" overflow="scroll"><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>, we can compute for each position the length of the maximum common subword starting in that location, which corresponds to the matching statistics. □</p>
        <p>In summary, the notion of irredundant common subwords is useful to decompose the information provided by the matching statistics into several patterns. Unfortunately these subwords can still overlap in some position. This might lead to an overcount in the matching statistics, in which the same region of the string contributes more than once. Our aim is to remove the possibility of overcount by filtering the most representative common subwords for each region of the sequences <italic>s</italic><sub>1</sub> and <italic>s</italic><sub>2</sub>, which will also remove all overlaps.</p>
      </sec>
    </sec>
    <sec>
      <title>Underlying subwords</title>
      <p>When comparing entire genomes we want to avoid that large non-coding regions, which by nature tend to be highly repetitive, may contribute to the similarity score a multiple number of times, thus misleading the final score. In fact, while analyzing massive genomes, the number of repeated patterns is very high, particularly in the non-genic regions. Therefore we need to filter out part of this information, and select the “best” common subword, by some measure, for each region of the sequences.</p>
      <p>In this regard, we must recall the definition of pattern priority and of underlying pattern, adapted from
[<xref ref-type="bibr" rid="B26">26</xref>] to the case of pairwise sequence comparison. We will take as input the irredundant common subwords and the underlying quorum <italic>u </italic>= 2, i.e. they must appears at least twice. Let now <italic>w</italic> and <italic>w</italic><sup><italic>′</italic></sup> be two distinct subwords. We say that <italic>w</italic> has priority over <italic>w</italic><sup><italic>′</italic></sup>, or <italic>w</italic>→<italic>w</italic><sup><italic>′</italic></sup>, if and only if either |<italic>w</italic>| ≥ |<italic>w</italic><sup><italic>′</italic></sup>|, or |<italic>w</italic>| = |<italic>w</italic><sup><italic>′</italic></sup>| and the first occurrence of <italic>w</italic> appears before the first occurrence of <italic>w</italic><sup><italic>′</italic></sup>. In this case, every subword can be defined just by its length and one of its starting positions in the sequences, meaning that any set of subwords is totally ordered with respect to the priority rule. We say that an occurrence <italic>l</italic> of <italic>w</italic> is <italic>tied</italic> to an occurrence <italic>l</italic><sup><italic>′</italic></sup> of a subword <italic>w</italic><sup><italic>′</italic></sup>, if the two occurrences overlap, i.e. ([<italic>l</italic>,
<italic>l</italic> + |<italic>w</italic>| − 1]∩<italic>l</italic><sup><italic>′</italic></sup>,
<italic>l</italic><sup><italic>′</italic></sup> + |<italic>w</italic><sup><italic>′</italic></sup>| − 1]) ≠<italic> ∅</italic>, and <italic>w</italic><sup><italic>′</italic></sup>→<italic>w</italic>. Otherwise, we say that <italic>l</italic> is <italic>untied</italic> from <italic>l</italic><sup><italic>′</italic></sup>.</p>
      <sec>
        <title>Definition 2</title>
        <p>(Underlying subword) A set of subwords
<inline-formula><mml:math id="M12" name="1748-7188-7-34-i12" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">U</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>⊆</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">I</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> is said to be <italic>underlying</italic> if and only if: </p>
        <p>(i) every subword <italic>w</italic> in
<inline-formula><mml:math id="M13" name="1748-7188-7-34-i13" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">U</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula>, called an <italic>underlying subword</italic>, has at least two occurrences, one in <italic>s</italic><sub>1</sub> and the other in <italic>s</italic><sub>2</sub>, that are untied from all the untied occurrences of other subwords in
<inline-formula><mml:math id="M14" name="1748-7188-7-34-i14" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">U</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>∖</mml:mo><mml:mi>w</mml:mi></mml:math></inline-formula>, and</p>
        <p>(ii) there does not exist a subword
<inline-formula><mml:math id="M15" name="1748-7188-7-34-i15" overflow="scroll"><mml:mi>w</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">I</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>∖</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">U</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> such that <italic>w</italic> has at least two untied occurrences, one per sequence, from all the untied occurrences of subwords in
<inline-formula><mml:math id="M16" name="1748-7188-7-34-i16" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">U</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula>.</p>
        <p>This subset of
<inline-formula><mml:math id="M17" name="1748-7188-7-34-i17" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">I</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> is composed only by those subwords that rank higher with our priority rule with respect to <italic>s</italic><sub>1</sub>. In fact, if there are overlaps between subwords that are in
<inline-formula><mml:math id="M18" name="1748-7188-7-34-i18" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">I</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula>, we will select only the subwords with the highest priority. Similarly to the score <italic>ACS</italic>(<italic>s</italic><sub>1</sub><italic>s</italic><sub>2</sub>), the set
<inline-formula><mml:math id="M19" name="1748-7188-7-34-i19" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">U</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> is asymmetric and depends on the order of the two sequences; we will address this issue in Section “A distance-like measure based on underlying subwords”. As for the underlying patterns
[<xref ref-type="bibr" rid="B26">26</xref>], one can show that the set of underlying subwords exists, and is unique. As a corollary we know that the untied occurrences of the underlying subwords can be mapped into the sequences <italic>s</italic><sub>1</sub> and <italic>s</italic><sub>2</sub> without overlaps. Moreover, by definition, the total length of the untied occurrences cannot exceed the length of the sequences. These two properties are crucial when building a similarity measure, because any similarity that is based on these subwords will count the contribution of a region of the sequence only once.</p>
      </sec>
    </sec>
    <sec>
      <title>Efficient computation of underlying subwords</title>
      <p>To summarize we select the irredundant common subwords that best fit each region of <italic>s</italic><sub>1</sub> and <italic>s</italic><sub>2</sub>, employing a technique that we call <italic>Underlying Approach</italic> or, in short, UA. This technique is based on a simple pipeline. We first select the irredundant common subwords and subsequently filter out the subwords that are not underlying. From a different perspective, we start from the smallest set of subwords that captures the matching statistics and remove the overlaps by applying our priority rule. In the following we show how to compute the irredundant common subwords and the matching statistics, and then we present an approach for the selection of the underlying subwords among these subwords. The general structure of the Underlying Approach (UA) is the following: </p>
      <p>• 1) Compute the set of the irredundant common subwords
<inline-formula><mml:math id="M20" name="1748-7188-7-34-i20" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">I</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula></p>
      <p>• 2) Rank all subwords in
<inline-formula><mml:math id="M21" name="1748-7188-7-34-i21" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">I</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> according to the priority and initialize
<inline-formula><mml:math id="M22" name="1748-7188-7-34-i22" overflow="scroll"><mml:mi mathvariant="bold-script">U</mml:mi></mml:math></inline-formula> to an empty set.</p>
      <p>• 3) Iteratively select a subwords <italic>p</italic> from
<inline-formula><mml:math id="M23" name="1748-7188-7-34-i23" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">I</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> following the ranking.</p>
      <p>• 4a) If <italic>p</italic> has at least two untied occurrences: add <italic>p</italic> to
<inline-formula><mml:math id="M24" name="1748-7188-7-34-i24" overflow="scroll"><mml:mi mathvariant="bold-script">U</mml:mi></mml:math></inline-formula> and update the corresponding regions of Γ(see next) in which <italic>p</italic> occurs;</p>
      <p>• 4b) otherwise, discard <italic>p</italic> and return to (3).</p>
      <sec>
        <title>Discovery of the irredundant common subwords</title>
        <p>In step (1) we construct the generalized suffix tree
<inline-formula><mml:math id="M25" name="1748-7188-7-34-i25" overflow="scroll"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> of <italic>s</italic><sub>1</sub> and <italic>s</italic><sub>2</sub>. We recall that an occurrence of a subword is (left)right-maximal if it cannot be covered from the (left)right by some other common subword. The first step consists in making a depth-first traversal of all nodes of
<inline-formula><mml:math id="M26" name="1748-7188-7-34-i26" overflow="scroll"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula>, and coloring each internal node with the colors of its leaves (each color corresponds to an input sequence). In this traversal, for each leaf <italic>i</italic> of
<inline-formula><mml:math id="M27" name="1748-7188-7-34-i27" overflow="scroll"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula>, we capture the lowest ancestor of <italic>i</italic> having both the colors <italic>c</italic><sub>1</sub> and <italic>c</italic><sub>2</sub>, say the node <italic>w</italic>. Then, <italic>w</italic> is a common subword, and <italic>i</italic> is one of its right-maximal occurrences (in <italic>s</italic><sub>1</sub> or in <italic>s</italic><sub>2</sub>); we select all subwords having at least one right-maximal occurrence. The resulting set will be linear in the size of the sequences, that is <italic>O</italic>(<italic>m</italic> + <italic>n</italic>). This is only a superset of the irredundant common subwords, since the occurrences of these subwords could be not left-maximal.</p>
        <p>In a second phase, we map the length of each right-maximal occurrence <italic>i</italic> into
<inline-formula><mml:math id="M28" name="1748-7188-7-34-i28" overflow="scroll"><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>, and, using Proposition 1, we check which occurrences <italic>i</italic> have length greater than or equal to the length stored in the location <italic>i</italic>−1 (for locations <italic>i </italic>≥ 2). These occurrences are also left-maximal, since they cannot be covered by a subword appearing at position <italic>i</italic>−1. Finally we can retain all subwords that have at least an occurrence that is both right- and left-maximal, i.e, the set of irredundant common subwords
<inline-formula><mml:math id="M29" name="1748-7188-7-34-i29" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">I</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula>. Note that, by employing the above technique, we are able to directly discover the irredundant common subwords and the matching statistics
<inline-formula><mml:math id="M30" name="1748-7188-7-34-i30" overflow="scroll"><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>.</p>
        <p>The construction of the generalized suffix tree
<inline-formula><mml:math id="M31" name="1748-7188-7-34-i31" overflow="scroll"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> and the subsequent extraction of the irredundant common subwords
<inline-formula><mml:math id="M32" name="1748-7188-7-34-i32" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">I</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> can be completed in time and space linear in the size of sequences.</p>
      </sec>
      <sec>
        <title>Selection of the underlying subwords</title>
        <p>In this section we describe, given the set of the irredundant common subwords
<inline-formula><mml:math id="M33" name="1748-7188-7-34-i33" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">I</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula>, how to filter out the subwords that are not underlying, obtaining the set of underlying subwords
<inline-formula><mml:math id="M34" name="1748-7188-7-34-i34" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">U</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula>.</p>
        <p>The extraction of underlying subwords takes as input the set
<inline-formula><mml:math id="M35" name="1748-7188-7-34-i35" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">I</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> and the tree
<inline-formula><mml:math id="M36" name="1748-7188-7-34-i36" overflow="scroll"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> from the previous section. First we need to sort all subwords in
<inline-formula><mml:math id="M37" name="1748-7188-7-34-i37" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">I</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> according to the priority rule (step 2). Then, starting from the top subword, we analyze iteratively all subwords by checking their untied occurrences (step 3). If the subword passes a validity test we select it as underlying (step 4a), otherwise we move on with the next subword (step 4b). The two key steps of this algorithm are: sorting the subwords (step 2) and checking for their untied occurrences (step 4a).</p>
        <p>Step 2 is implemented as follows. For all subwords we retrieve their lengths and first occurrences in <italic>s</italic><sub>1</sub> from the tree
<inline-formula><mml:math id="M38" name="1748-7188-7-34-i38" overflow="scroll"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula>. Then each subword is characterized by its length and the first occurrence. Since these are integers in the range [0,<italic>n</italic>] we can apply radix sort
[<xref ref-type="bibr" rid="B27">27</xref>], first by length and then by occurrence. This step can be done in linear time.</p>
        <p>In order to implement step 4a we need to define the vector Γ of <italic>n</italic> booleans, representing the locations of <italic>s</italic><sub>1</sub>. If Γ[<italic>i</italic>] is <sc>true</sc>, then the location <italic>i</italic> is covered by some untied occurrence. We also preprocess the input tree and add a link for all nodes <italic>v</italic> to the closest irredundant ancestor, say <italic>prec</italic>(<italic>v</italic>). This can be done by traversing the tree in preorder. During the visit of a the node <italic>v</italic> if it is not irredundant we transmit to the children <italic>prec</italic>(<italic>v</italic>) otherwise if <italic>v</italic> is irredundant we transmit <italic>v</italic>. This preprocess can be implemented is linear time and space.</p>
        <p>For each subword <italic>w</italic> in
<inline-formula><mml:math id="M39" name="1748-7188-7-34-i39" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">I</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> we consider the list
<inline-formula><mml:math id="M40" name="1748-7188-7-34-i40" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> of occurrences to be checked. All
<inline-formula><mml:math id="M41" name="1748-7188-7-34-i41" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are initialized in the following way. Every leaf <italic>v</italic>, that represent a position <italic>i</italic>, send its value <italic>i</italic> to the location list of the closest irredundant ancestor using the link <italic>prec</italic>(<italic>v</italic>). Again this preprocess takes linear time and space since all positions appear in exactly one location list. We will updated these lists
<inline-formula><mml:math id="M42" name="1748-7188-7-34-i42" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> only with the occurrences to be checked, i.e. that are not covered by some underlying subword already discovered. We start analyzing the top subword <italic>w</italic> and for this case
<inline-formula><mml:math id="M43" name="1748-7188-7-34-i43" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is composed by all the occurrences of <italic>w</italic>.</p>
        <p>For each occurrence <italic>i</italic> of <italic>w</italic> we need to check only its first and last location in the vector Γ; i.e., we need to check the locations Γ[<italic>i</italic>] and Γ[<italic>i</italic> + |<italic>w</italic>|−1]. If one of these two values is set to <sc>true</sc>, then <italic>i</italic> is tied by some subword <italic>w</italic><sup><italic>′</italic></sup>. Otherwise, if both the values are set to <sc>false</sc>, then <italic>i</italic> must be untied from all other subwords. Since all subwords already evaluated are not shorter than <italic>w</italic>, then they cannot cover some locations in Γ[<italic>i</italic>,<italic>i</italic> + |<italic>w</italic>|−1] without also covering Γ[<italic>i</italic>] or Γ[<italic>i</italic> + |<italic>w</italic>|−1]. Thus, if Γ[<italic>i</italic>] and Γ[<italic>i</italic> + |<italic>w</italic>|−1] are both set to <sc>false</sc>, we mark this occurrence <italic>i</italic> as untied for the subword <italic>w</italic> and update the vector Γaccordingly.</p>
        <p>If Γ[<italic>i</italic>] is <sc>true</sc> we can completely discard the occurrence <italic>i</italic>, for the subword <italic>w</italic> and also for all its prefixes, that are represented by the ancestors of <italic>w</italic> in the tree
<inline-formula><mml:math id="M44" name="1748-7188-7-34-i44" overflow="scroll"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula>. Thus the occurrence <italic>i</italic> will no longer be evaluated for any other subword.</p>
        <p>If Γ[<italic>i</italic>] is <sc>false</sc> and Γ[<italic>i</italic> + |<italic>w</italic>|−1] is <sc>true</sc>, we need to further evaluate this occurrence for some ancestors of <italic>w</italic>. In this case, one can compute the longest prefix, <italic>w</italic><sup><italic>′</italic></sup>, of <italic>w</italic> such that Γ[<italic>i</italic> + |<italic>w</italic><sup><italic>′</italic></sup>|−1] is set to <sc>false</sc> and <italic>w</italic><sup><italic>′</italic></sup>is an irredundant common subword. Then the occurrence <italic>i</italic> is inserted into the list
<inline-formula><mml:math id="M45" name="1748-7188-7-34-i45" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">L</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math></inline-formula>.</p>
        <p>This step is performed by first computing the length <italic>d </italic>&lt; |<italic>w</italic>| such that Γ[<italic>i</italic> + <italic>d</italic>−1] is <sc>false</sc> and Γ[<italic>i</italic> + <italic>d</italic>] is <sc>true</sc>, and then retrieving the corresponding prefix <italic>w</italic><sup><italic>′</italic></sup> of <italic>w</italic> in the tree that spells an irredundant common subword with length equal to or shorter than <italic>d</italic>. We can compute <italic>d</italic> by means of a <italic>length table </italic><italic>χ</italic> in support (or in place) of the boolean vector Γ. For each untied occurrence <italic>i</italic> of <italic>w</italic>, <italic>χ </italic>stores the values [1,2,…,|<italic>w</italic>|] in the locations [<italic>i</italic>,<italic>i</italic> + 1,…,<italic>i</italic> + |<italic>w</italic>|−1], similarly to the proof of Proposition 1. Using this auxiliary table we can compute the value of <italic>d</italic> for the location under study <italic>i</italic> as <italic>d </italic>= |<italic>w</italic>|−<italic>χ</italic>[<italic>i</italic> + |<italic>w</italic>|−1].</p>
        <p>Now, to select <italic>w</italic><sup><italic>′</italic></sup>, the longest prefix of <italic>w</italic> with |<italic>w</italic><sup><italic>′</italic></sup>| ≤<italic> d</italic>, we employ an algorithm proposed by Kopelowitz and Lewenstein
[<xref ref-type="bibr" rid="B28">28</xref>] for solving the <italic>weighted ancestor problem</italic>, where weights correspond to the length of words spelled in the path from the root to each node, in case of a suffix tree. In the weighted ancestor problem one preprocesses a weighted tree to support fast predecessor queries on the path from a query node to the root. That is, with a linear preprocessing on a tree of height <italic>n</italic>, using the above algorithm it is possible to locate any ancestor node <italic>w</italic><sup><italic>′</italic></sup> that has a weight less than <italic>d</italic> in time <italic>O</italic>(loglog<italic>n</italic>). In our case, the maximum length for an irredundant subword is min{<italic>m</italic>,
<italic>n</italic>}, thus we can find a suitable ancestor <italic>w</italic><sup><italic>′ </italic></sup>of <italic>w</italic> in time <italic>O</italic>(loglogmin{<italic>m</italic>,<italic>n</italic>}), with <italic>O</italic>(<italic>m</italic> + <italic>n</italic>) preprocessing of the tree
<inline-formula><mml:math id="M46" name="1748-7188-7-34-i46" overflow="scroll"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula>.</p>
        <p>At the end of the process, if the subword <italic>w</italic> has at least one untied occurrence per sequence, then we mark <italic>w</italic> as underlying subword. Otherwise, all the occurrences of <italic>w</italic> that are not covered are sent to its ancestors, using the previous procedure.</p>
        <p>To analyze the overall complexity we need to compute how many times the same location <italic>i</italic> is evaluated. Suppose, for example, that <italic>i</italic> belongs to
<inline-formula><mml:math id="M47" name="1748-7188-7-34-i47" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">L</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> of the subword <italic>w</italic>. The location <italic>i</italic> is evaluated again for some
<inline-formula><mml:math id="M48" name="1748-7188-7-34-i48" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula>, and inserted into the list
<inline-formula><mml:math id="M49" name="1748-7188-7-34-i49" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">L</mml:mi></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:msub></mml:math></inline-formula>, only if Γ[<italic>i</italic>] is <sc>false</sc> and Γ[<italic>i</italic> + |<italic>w</italic>|−1] is <sc>true</sc>. Note that the locations not already covered are in the range [<italic>i</italic>,<italic>i</italic> + |<italic>w</italic>|−<italic>d</italic>−1], with <italic>d </italic>&gt; 0. Then, the subword
<inline-formula><mml:math id="M50" name="1748-7188-7-34-i50" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula> is the longest prefix of <italic>w</italic> that is an irredundant common subword and that lives completely in the locations [<italic>i</italic>,<italic>i</italic> + |<italic>w</italic>|−<italic>d</italic>−1]; however
<inline-formula><mml:math id="M51" name="1748-7188-7-34-i51" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula> may not cover the entire interval. Now, the occurrence <italic>i</italic> will be evaluated again only if there exists another subword <italic>w</italic><sup><italic>′</italic></sup> that overlaps with
<inline-formula><mml:math id="M52" name="1748-7188-7-34-i52" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula>, and that has a higher priority with respect to
<inline-formula><mml:math id="M53" name="1748-7188-7-34-i53" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula>. The worst case is when <italic>w</italic><sup><italic>′</italic></sup>ends exactly at position <italic>i</italic> + |<italic>w</italic>|−<italic>d</italic>−1 and overlaps with
<inline-formula><mml:math id="M54" name="1748-7188-7-34-i54" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula> by only one location. Since <italic>w</italic><sup><italic>′</italic></sup>must be evaluated before
<inline-formula><mml:math id="M55" name="1748-7188-7-34-i55" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula>, then
<inline-formula><mml:math id="M56" name="1748-7188-7-34-i56" overflow="scroll"><mml:mo>|</mml:mo><mml:msup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>′</mml:mi></mml:mrow></mml:msup><mml:mo>|</mml:mo><mml:mo>≥</mml:mo><mml:mo>|</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>|</mml:mo></mml:math></inline-formula>. Thus the worst case is when the two subwords have about the same length. In this settings the length of the subword
<inline-formula><mml:math id="M57" name="1748-7188-7-34-i57" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula> can be at most (|<italic>w</italic>|−<italic>d</italic>)/2. We can iterate this argument at most <italic>O</italic>(log|<italic>w</italic>|) times for the same position <italic>i</italic>. Therefore any location can be evaluated at most <italic>O</italic>(logmin{<italic>m</italic>,<italic>n</italic>}) times. In conclusion, our approach requires <italic>O</italic>((<italic>m</italic> + <italic>n</italic>)logmin{<italic>m</italic>,<italic>n</italic>}loglogmin{<italic>m</italic>,<italic>n</italic>}) time and <italic>O</italic>(<italic>m</italic> + <italic>n</italic>) space to discover the set of all underlying subwords
<inline-formula><mml:math id="M58" name="1748-7188-7-34-i58" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">U</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula>.</p>
      </sec>
    </sec>
    <sec>
      <title>Extension to inversions and complements</title>
      <p>In this section we discuss the extension of the algorithmic structure discussed above to accommodate also inversion and complement matches.</p>
      <p>A simple idea is to concatenate each sequence with its inverse and its complement, while keeping separate the occurrences coming from direct matches, inversions, and complements. In brief, we first define
<inline-formula><mml:math id="M59" name="1748-7188-7-34-i59" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> as the concatenation of a string <italic>x</italic> with its inverse, followed by its complement, in this exact order. Then, we compute the irredundant common subwords,
<inline-formula><mml:math id="M60" name="1748-7188-7-34-i60" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">I</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:msub></mml:math></inline-formula>, on the sequences <italic>s</italic><sub>1</sub>and
<inline-formula><mml:math id="M61" name="1748-7188-7-34-i61" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula>. We subsequently select the underlying subwords by ranking all the irredundant common subwords in the set
<inline-formula><mml:math id="M62" name="1748-7188-7-34-i62" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">I</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:msub></mml:math></inline-formula>. Using the same algorithm described above we compute the set
<inline-formula><mml:math id="M63" name="1748-7188-7-34-i63" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">U</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:msub></mml:math></inline-formula>, and then we map each subword occurrence to the reference sequences <italic>s</italic><sub>1</sub>. This will include also inversions and complements of <italic>s</italic><sub>2</sub> that are shared by <italic>s</italic><sub>1</sub>. In this way, we can store all the untied occurrences and consider all possible matches for each region of <italic>s</italic><sub>1</sub>.</p>
      <p>In this framework, we choose to take into account all these symmetries, and thus the experiments presented will use this extended approach. We will also measure the contribution of inversions and complements to our similarity measure.</p>
    </sec>
    <sec>
      <title>A distance-like measure based on underlying subwords</title>
      <p>In the following we report the basic steps of our distance-like measure. Let us assume that we have computed
<inline-formula><mml:math id="M64" name="1748-7188-7-34-i64" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">U</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula>, and the other specular set
<inline-formula><mml:math id="M65" name="1748-7188-7-34-i65" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">U</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula>. For every subword
<inline-formula><mml:math id="M66" name="1748-7188-7-34-i66" overflow="scroll"><mml:mi>w</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">U</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> we sum up the score
<inline-formula><mml:math id="M67" name="1748-7188-7-34-i67" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>w</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:munderover><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:mi>w</mml:mi><mml:mo>|</mml:mo><mml:mo>(</mml:mo><mml:mo>|</mml:mo><mml:mi>w</mml:mi><mml:mo>|</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:math></inline-formula> in <italic>UA</italic>(<italic>s</italic><sub>1</sub><italic>s</italic><sub>2</sub>), where
<inline-formula><mml:math id="M68" name="1748-7188-7-34-i68" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:math></inline-formula> is the number of its untied occurrences in <italic>s</italic><sub>1</sub>, similarly to ACS
[<xref ref-type="bibr" rid="B7">7</xref>]. Then, we average <italic>UA</italic>(<italic>s</italic><sub>1</sub>,
<italic>s</italic><sub>2</sub>) over the length of the first sequence, <italic>s</italic><sub>1</sub>, yielding </p>
      <p>
        <disp-formula>
          <mml:math id="M69" name="1748-7188-7-34-i69" overflow="scroll">
            <mml:mrow>
              <mml:mtext mathvariant="italic">UA</mml:mtext>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>s</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
              </mml:msub>
              <mml:mo>,</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>s</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mn>2</mml:mn>
                </mml:mrow>
              </mml:msub>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:munder>
                    <mml:mrow>
                      <mml:mo mathsize="big">∑</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>w</mml:mi>
                      <mml:mo>∈</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi mathvariant="bold-script">U</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>s</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>,</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>s</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:munder>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mi>h</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>w</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>s</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mo stretchy="false">|</mml:mo>
                  <mml:mi>w</mml:mi>
                  <mml:mo stretchy="false">|</mml:mo>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mo stretchy="false">|</mml:mo>
                  <mml:mi>w</mml:mi>
                  <mml:mo stretchy="false">|</mml:mo>
                  <mml:mo>+</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mn>2</mml:mn>
                  <mml:mi>n</mml:mi>
                </mml:mrow>
              </mml:mfrac>
              <mml:mi>.</mml:mi>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p> This is a similarity score that is large when two sequences are similar, therefore we take its inverse.</p>
      <p>Moreover, for a fixed sequence <italic>s</italic><sub>1</sub> this score can also grow with the length of <italic>s</italic><sub>2</sub>, since the probability of having a match in <italic>s</italic><sub>1</sub>increases with the length of <italic>s</italic><sub>2</sub>. For this reason, we consider the measure log<sub>4</sub>(|<italic>s</italic><sub>2</sub>|)/<italic>UA</italic>(<italic>s</italic><sub>1</sub>,<italic>s</italic><sub>2</sub>); we use a base-4 logarithm since DNA sequences have four bases. Another issue with the above formula is the fact that it is not equal to zero for <italic>s</italic><sub>1</sub> =<italic> s</italic><sub>2</sub>; thus we subtract the correction term log<sub>4</sub>(|<italic>s</italic><sub>1</sub>|)/<italic>UA</italic>(<italic>s</italic><sub>1</sub>,<italic>s</italic><sub>1</sub>), which ensures that this condition is always satisfied. Since
<inline-formula><mml:math id="M70" name="1748-7188-7-34-i70" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">U</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> contains only one subword, the sequence <italic>s</italic><sub>1</sub> itself, which trivially has only one untied occurrence in <italic>s</italic><sub>1</sub>, this yields to <italic>UA</italic>(<italic>s</italic><sub>1</sub>,<italic>s</italic><sub>1</sub>) = |<italic>s</italic><sub>1</sub>|(|<italic>s</italic><sub>1</sub>| + 1)/(2|<italic>s</italic><sub>1</sub>|) = (|<italic>s</italic><sub>1</sub>| + 1)/2. The following formulas accommodate all of these observations in a symmetrical distance-like measure <italic>d</italic><sub><italic>UA</italic></sub>(<italic>s</italic><sub>1</sub>,<italic>s</italic><sub>2</sub>) between the sequences <italic>s</italic><sub>1</sub> and <italic>s</italic><sub>2</sub>: </p>
      <p>
        <disp-formula>
          <mml:math id="M71" name="1748-7188-7-34-i71" overflow="scroll">
            <mml:mrow>
              <mml:mover accent="false">
                <mml:mrow>
                  <mml:mtext mathvariant="italic">UA</mml:mtext>
                </mml:mrow>
                <mml:mo accent="true">¯</mml:mo>
              </mml:mover>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>s</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
              </mml:msub>
              <mml:mo>,</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>s</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mn>2</mml:mn>
                </mml:mrow>
              </mml:msub>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mtext>log</mml:mtext>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>4</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>(</mml:mo>
                  <mml:mo>|</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>s</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>|</mml:mo>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext mathvariant="italic">UA</mml:mtext>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>s</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>s</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mfrac>
              <mml:mo>−</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mn>2</mml:mn>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mtext>log</mml:mtext>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>4</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>(</mml:mo>
                  <mml:mo>|</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>s</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>|</mml:mo>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mo>|</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>s</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>|</mml:mo>
                  <mml:mo>+</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
              </mml:mfrac>
              <mml:mo>,</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula>
          <mml:math id="M72" name="1748-7188-7-34-i72" overflow="scroll">
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>d</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext mathvariant="italic">UA</mml:mtext>
                </mml:mrow>
              </mml:msub>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>s</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
              </mml:msub>
              <mml:mo>,</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>s</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mn>2</mml:mn>
                </mml:mrow>
              </mml:msub>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mover accent="false">
                    <mml:mrow>
                      <mml:mtext mathvariant="italic">UA</mml:mtext>
                    </mml:mrow>
                    <mml:mo accent="true">¯</mml:mo>
                  </mml:mover>
                  <mml:mo>(</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>s</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>s</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>)</mml:mo>
                  <mml:mo>+</mml:mo>
                  <mml:mover accent="false">
                    <mml:mrow>
                      <mml:mtext mathvariant="italic">UA</mml:mtext>
                    </mml:mrow>
                    <mml:mo accent="true">¯</mml:mo>
                  </mml:mover>
                  <mml:mo>(</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>s</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>s</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mn>2</mml:mn>
                </mml:mrow>
              </mml:mfrac>
              <mml:mi>.</mml:mi>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>We can easily see that the correction term rapidly converges to zero as |<italic>s</italic><sub>1</sub>| increases. Moreover, we notice that <italic>d</italic><sub><italic>UA</italic></sub>(<italic>s</italic><sub>1</sub>,<italic>s</italic><sub>2</sub>) grows as the two sequences <italic>s</italic><sub>1</sub> and <italic>s</italic><sub>2</sub> diverge. From now we will simply refer to the measure <italic>d</italic><sub><italic>UA</italic></sub>(<italic>s</italic><sub>1</sub>,<italic>s</italic><sub>2</sub>) as the Underlying Approach measure, or <italic>UA</italic>.</p>
    </sec>
  </sec>
  <sec sec-type="results">
    <title>Results</title>
    <sec>
      <title>Genome datasets and reference taxonomies</title>
      <p>We assess the effectiveness of the Underlying Approach on the estimation of whole-genome phylogenies of different organisms. We tested our distance function on three types of datasets: viruses, prokaryotes, and unicellular eukaryotes.</p>
      <p>In the first dataset we selected 54 virus isolates of the 2009 human pandemic <italic>Influenza A – subtype H1N1</italic>, also called the “Swine Flu.” The Influenza A virion has eight segments of viral RNA with different functions. These RNAs are directly extracted from infected host cells, and synthesized into complementary DNA by reverse transcription reaction, where a specific gene amplification is performed for each segment
[<xref ref-type="bibr" rid="B29">29</xref>]. We concatenate these segments according to their conventional order given by the literature
[<xref ref-type="bibr" rid="B30">30</xref>]; this step, in general, does not affect the final phylogeny computed by our algorithm, and is used to sort subwords by location. The resulting sequences are very similar to each other, and have lengths in the order of 13,200 nucleotides each, accounting for a total of 714,402 b. To compute a reference taxonomic tree, we perform multiple sequence alignment using the ClustalW2
[<xref ref-type="bibr" rid="B31">31</xref>] tool<sup>a</sup> as suggested by many scientific articles on the 2009 Swine Flu
[<xref ref-type="bibr" rid="B29">29</xref>,<xref ref-type="bibr" rid="B30">30</xref>]. Then, we compute the tree using the <italic>Dnaml</italic> tool from the PHYLIP
[<xref ref-type="bibr" rid="B32">32</xref>] software package,<sup>b</sup> which implements the maximum likelihood method for aligned DNA sequences. In <italic>Dnaml</italic> we used the parameters suggested in
[<xref ref-type="bibr" rid="B29">29</xref>,<xref ref-type="bibr" rid="B30">30</xref>], which consider empirical base frequencies, constant rate variation among sites (with no weights), a transition ratio of 2.0, and best tree search based on proper searching heuristics.</p>
      <p>In the second dataset we selected 18 prokaryotic organisms among the species used in
[<xref ref-type="bibr" rid="B7">7</xref>] for a DNA phylogenomic inference. We chose the species whose phylogenomic tree can be inferred by well-established methods in the literature (see Table
<xref ref-type="table" rid="T2">2</xref>). The organisms come from both the major prokaryotic domains: Archaea, 8 organisms in total, and Bacteria, 10 organisms in total. The sequences in question have lengths ranging from 0.6 Mbp to 8 Mbp, accounting for a total 48 Mbp. We compute their tree-of-life by using genes that code for the 16S RNA, the main RNA molecule inside the small ribosomal subunit characterizing prokaryotes and widely used to reconstruct their phylogeny; the considered sequences are called 16S rDNA. We can extract a multiple alignment of 16S rDNA sequences of the selected organisms from the Ribosomal Database Project
[<xref ref-type="bibr" rid="B33">33</xref>];<sup>c</sup> our experiments are based on the release 8.1. Next, we perform a maximum likelihood estimation on the aligned set of sequences, employing <italic>Dnaml</italic> from PHYLIP with standard parameters, in order to compute a reference tree based on the resulting estimation.</p>
      <table-wrap position="float" id="T2">
        <label>Table 2</label>
        <caption>
          <p>
            <bold>Benchmark for prokaryotes – </bold>
            <bold>
              <italic>Archaea </italic>
            </bold>
            <bold>&amp;</bold>
            <bold>
              <italic>Bacteria </italic>
            </bold>
            <bold>domains</bold>
          </p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="left"/>
            <col align="justify"/>
            <col align="justify"/>
            <col align="left"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th align="left">
                <bold>Accession No.</bold>
              </th>
              <th align="left">
                <bold>Domain</bold>
              </th>
              <th align="left">
                <bold>Organism</bold>
              </th>
              <th align="left">
                <bold>Size</bold>
              </th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td align="left" valign="bottom">
                <monospace>BA000002</monospace>
                <hr/>
              </td>
              <td align="justify" valign="bottom">
                <italic>archaea</italic>
                <hr/>
              </td>
              <td align="justify" valign="bottom">aeropyrum pernix str. K1<hr/></td>
              <td align="left" valign="bottom">1.7 Mbp<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">
                <monospace>AE000782</monospace>
                <hr/>
              </td>
              <td align="justify" valign="bottom">
                <italic>archaea</italic>
                <hr/>
              </td>
              <td align="justify" valign="bottom">archaeoglobus fulgidus str. DSM 4304<hr/></td>
              <td align="left" valign="bottom">2.2 Mbp<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">
                <monospace>AE009439</monospace>
                <hr/>
              </td>
              <td align="justify" valign="bottom">
                <italic>archaea</italic>
                <hr/>
              </td>
              <td align="justify" valign="bottom">methanopyrus kandleri str. AV19<hr/></td>
              <td align="left" valign="bottom">1.7 Mbp<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">
                <monospace>AE010299</monospace>
                <hr/>
              </td>
              <td align="justify" valign="bottom">
                <italic>archaea</italic>
                <hr/>
              </td>
              <td align="justify" valign="bottom">methanosarcina acetivorans str. C2A<hr/></td>
              <td align="left" valign="bottom">5.8 Mbp<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">
                <monospace>AE009441</monospace>
                <hr/>
              </td>
              <td align="justify" valign="bottom">
                <italic>archaea</italic>
                <hr/>
              </td>
              <td align="justify" valign="bottom">pyrobaculum aerophilum str. IM2<hr/></td>
              <td align="left" valign="bottom">2.3 Mbp<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">
                <monospace>AL096836</monospace>
                <hr/>
              </td>
              <td align="justify" valign="bottom">
                <italic>archaea</italic>
                <hr/>
              </td>
              <td align="justify" valign="bottom">pyrococcus abyssi<hr/></td>
              <td align="left" valign="bottom">1.8 Mbp<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">
                <monospace>AE009950</monospace>
                <hr/>
              </td>
              <td align="justify" valign="bottom">
                <italic>archaea</italic>
                <hr/>
              </td>
              <td align="justify" valign="bottom">pyrococcus furiosus str. DSM 3638<hr/></td>
              <td align="left" valign="bottom">1.9 Mbp<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">
                <monospace>AE000520</monospace>
                <hr/>
              </td>
              <td align="justify" valign="bottom">
                <italic>archaea</italic>
                <hr/>
              </td>
              <td align="justify" valign="bottom">treponema pallidum sp. pall. str. Nichols<hr/></td>
              <td align="left" valign="bottom">1.2 Mbp<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">
                <monospace>AE017225</monospace>
                <hr/>
              </td>
              <td align="justify" valign="bottom">
                <italic>bacteria</italic>
                <hr/>
              </td>
              <td align="justify" valign="bottom">bacillus anthracis str. Sterne<hr/></td>
              <td align="left" valign="bottom">5.3 Mbp<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">
                <monospace>AL009126</monospace>
                <hr/>
              </td>
              <td align="justify" valign="bottom">
                <italic>bacteria</italic>
                <hr/>
              </td>
              <td align="justify" valign="bottom">bacillus subtilis subsp. subtilis str. 168<hr/></td>
              <td align="left" valign="bottom">4.3 Mbp<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">
                <monospace>AE013218</monospace>
                <hr/>
              </td>
              <td align="justify" valign="bottom">
                <italic>bacteria</italic>
                <hr/>
              </td>
              <td align="justify" valign="bottom">buchnera aphidicola str. Sg<hr/></td>
              <td align="left" valign="bottom">651 kbp<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">
                <monospace>AL111168</monospace>
                <hr/>
              </td>
              <td align="justify" valign="bottom">
                <italic>bacteria</italic>
                <hr/>
              </td>
              <td align="justify" valign="bottom">campylobacter jejuni sp. jej. str. NCTC 11168<hr/></td>
              <td align="left" valign="bottom">1.7 Mbp<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">
                <monospace>AE002160</monospace>
                <hr/>
              </td>
              <td align="justify" valign="bottom">
                <italic>bacteria</italic>
                <hr/>
              </td>
              <td align="justify" valign="bottom">chlamydia muridarum str. MoPn/Wiess-Nigg<hr/></td>
              <td align="left" valign="bottom">1.1 Mbp<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">
                <monospace>AM884176</monospace>
                <hr/>
              </td>
              <td align="justify" valign="bottom">
                <italic>bacteria</italic>
                <hr/>
              </td>
              <td align="justify" valign="bottom">chlamydia trachomatis str. L2/434/Bu<hr/></td>
              <td align="left" valign="bottom">1.1 Mbp<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">
                <monospace>AE016828</monospace>
                <hr/>
              </td>
              <td align="justify" valign="bottom">
                <italic>bacteria</italic>
                <hr/>
              </td>
              <td align="justify" valign="bottom">coxiella burnetii str. RSA 493<hr/></td>
              <td align="left" valign="bottom">2.0 Mbp<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">
                <monospace>AE017285</monospace>
                <hr/>
              </td>
              <td align="justify" valign="bottom">
                <italic>bacteria</italic>
                <hr/>
              </td>
              <td align="justify" valign="bottom">desulfovibrio vulgaris sp. vulg. str. Hildenb.<hr/></td>
              <td align="left" valign="bottom">3.6 Mbp<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">
                <monospace>L42023</monospace>
                <hr/>
              </td>
              <td align="justify" valign="bottom">
                <italic>bacteria</italic>
                <hr/>
              </td>
              <td align="justify" valign="bottom">haemophilus influenzae str. Rd KW20<hr/></td>
              <td align="left" valign="bottom">1.9 Mbp<hr/></td>
            </tr>
            <tr>
              <td align="left">
                <monospace>CP001037</monospace>
              </td>
              <td align="justify">
                <italic>bacteria</italic>
              </td>
              <td align="justify">nostoc punctiforme str. PCC 73102</td>
              <td align="left">8.4 Mbp</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Prokaryotic taxa used in our experiments, divided by domain. For each entity, we list the accession number in the NCBI genome database, the complete name and strain, and the genome size.</p>
        </table-wrap-foot>
      </table-wrap>
      <p>In the third dataset we selected five eukaryotic organisms of the protozoan genus <italic>Plasmodium</italic> whose genomes have been completely sequenced (Table
<xref ref-type="table" rid="T3">3</xref>). <italic>Plasmodium</italic> are unicellular eukaryotic parasites best known as the etiological agents of malaria infectious disease. The sequences have lengths ranging from 18 Mbp to 24 Mbp, accounting for a total 106 Mbp. We used as reference tree the taxonomy computed by Martinsen <italic>et al.</italic>[<xref ref-type="bibr" rid="B34">34</xref>], as suggested by the Tree of Life Project.</p>
      <table-wrap position="float" id="T3">
        <label>Table 3</label>
        <caption>
          <p>Plasmodium are parasites known as causative agents of malaria in different hosts and geographic regions</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th align="left">
                <bold>Parasite</bold>
              </th>
              <th align="left">
                <bold>Host</bold>
              </th>
              <th align="left">
                <bold>Region</bold>
              </th>
              <th align="left">
                <bold>Size</bold>
              </th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td align="left" valign="bottom">P. berghei<hr/></td>
              <td align="left" valign="bottom">rodent<hr/></td>
              <td align="left" valign="bottom">Africa<hr/></td>
              <td align="left" valign="bottom">18.5 Mbp<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">P. chabaudi<hr/></td>
              <td align="left" valign="bottom">rodent<hr/></td>
              <td align="left" valign="bottom">Africa<hr/></td>
              <td align="left" valign="bottom">18.8 Mbp<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">P. falciparum<hr/></td>
              <td align="left" valign="bottom">human<hr/></td>
              <td align="left" valign="bottom">Africa, Asia &amp; S./C. America<hr/></td>
              <td align="left" valign="bottom">23.3 Mbp<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">P. knowlesi<hr/></td>
              <td align="left" valign="bottom">macaque<hr/></td>
              <td align="left" valign="bottom">Southeast Asia<hr/></td>
              <td align="left" valign="bottom">23.7 Mbp<hr/></td>
            </tr>
            <tr>
              <td align="left">P. vivax</td>
              <td align="left">human</td>
              <td align="left">Africa, Asia &amp; S./C. America</td>
              <td align="left">22.6 Mbp</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>The right-most column lists the size of each complete DNA genome.</p>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>Whole-genome phylogeny reconstruction</title>
      <p>We exploited the above datasets to compare our method, the Underlying Approach (UA), with other efficient state-of-the-art approaches in the whole-genome phylogeny reconstruction challenge: ACS
[<xref ref-type="bibr" rid="B7">7</xref>], FFP
[<xref ref-type="bibr" rid="B4">4</xref>]<sup>d</sup> and FFP<sub><italic>RY</italic></sub>. The FFP<sub><italic>RY </italic></sub>method, in contrast to FFP, employs the Purine-Pyrimidine reduced alphabet (RY) which is composed by two character classes: <monospace>[A,G]</monospace> (both purine bases, denoted by <monospace>R</monospace>) <monospace>[C,T]</monospace> (both pyrimidines, denoted by <monospace>Y</monospace>). We implemented the ACS method by ourselves, while for FFP and FFP<sub><italic>RY</italic></sub> we used the FFP package release 3.14 available online.</p>
      <p>We reconstruct the phylogenomic trees from the distance matrices using the Neighbor-joining method as implemented in the PHYLIP package. We compare the resulting topologies with the respective reference trees using the symmetric difference of Robinson and Foulds (R-F) and the triplet distance. For two unrooted binary trees with <italic>n </italic>≥ 3 leaves, the R-F score is in the range [0,2<italic>n</italic>−6]. A score equal to 0 means that the two trees are isomorphic, while 2<italic>n</italic>−6 means that all non-trivial bipartitions are different. The R-F difference between two or more trees can be computed using the TreeDist tool from the PHYLIP package.</p>
      <p>We ran FFP and FFP<sub><italic>RY </italic></sub>for different values of <italic>k</italic> (the fixed subword length) as suggested by
[<xref ref-type="bibr" rid="B4">4</xref>], retaining the best results in agreement with the reference trees. Table
<xref ref-type="table" rid="T4">4</xref> compares our method with the other state-of-the-art approaches, by showing the R-F difference with respect to the reference taxonomy tree.</p>
      <table-wrap position="float" id="T4">
        <label>Table 4</label>
        <caption>
          <p>Comparison of whole-genome phylogeny reconstructions</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="left"/>
            <col align="left"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th align="left">
                <bold>Species</bold>
              </th>
              <th align="left">
                <bold>Group</bold>
              </th>
              <th align="center">
                <bold>UA</bold>
              </th>
              <th align="center">
                <bold>ACS</bold>
              </th>
              <th align="center">
                <bold>FFP</bold>
              </th>
              <th align="center">
                <bold>FFP</bold>
                <sub>
                  <bold>
                    <italic>RY</italic>
                  </bold>
                </sub>
              </th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td align="left" valign="bottom">Influenza A<hr/></td>
              <td align="left" valign="bottom">Viruses<hr/></td>
              <td align="center" valign="bottom"><bold>80</bold>/102<hr/></td>
              <td align="center" valign="bottom">84/102<hr/></td>
              <td align="center" valign="bottom">100/102<hr/></td>
              <td align="center" valign="bottom">96/102<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">
                <italic>Archaea</italic>
                <hr/>
              </td>
              <td align="left" valign="bottom">Prokaryotes<hr/></td>
              <td align="center" valign="bottom"><bold>4</bold>/10<hr/></td>
              <td align="center" valign="bottom"><bold>4</bold>/10<hr/></td>
              <td align="center" valign="bottom">6/10<hr/></td>
              <td align="center" valign="bottom">6/10<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">
                <italic>Bacteria</italic>
                <hr/>
              </td>
              <td align="left" valign="bottom">Prokaryotes<hr/></td>
              <td align="center" valign="bottom"><bold>6</bold>/14<hr/></td>
              <td align="center" valign="bottom">10/14<hr/></td>
              <td align="center" valign="bottom"><bold>6</bold>/14<hr/></td>
              <td align="center" valign="bottom">10/14<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">Arch. &amp; Bact.<hr/></td>
              <td align="left" valign="bottom">Prokaryotes<hr/></td>
              <td align="center" valign="bottom"><bold>20</bold>/30<hr/></td>
              <td align="center" valign="bottom">22/30<hr/></td>
              <td align="center" valign="bottom"><bold>20</bold>/30<hr/></td>
              <td align="center" valign="bottom">22/30<hr/></td>
            </tr>
            <tr>
              <td align="left">Plasmodium</td>
              <td align="left">Eukaryotes</td>
              <td align="center"><bold>0</bold>/4</td>
              <td align="center"><bold>0</bold>/4</td>
              <td align="center">4/4</td>
              <td align="center"><bold>0</bold>/4</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Normalized Robinson-Foulds scores with the corresponding reference tree. For each dataset the best results are in bold.</p>
        </table-wrap-foot>
      </table-wrap>
      <p>Our method, UA, achieves good performance in every test considering the R-F difference with the reference taxonomy tree, and very good performance if we further analyze the resulting phylogenies, as in Figures
<xref ref-type="fig" rid="F1">1</xref>,
<xref ref-type="fig" rid="F2">2</xref>, and
<xref ref-type="fig" rid="F3">3</xref>. For every dataset the best results are shown in bold. We can observe that UA is constantly the best performing method, and that this advantage becomes more evident for large dataset, where sequences share large parts, such as the Influenza A (H1N1) viruses.</p>
      <fig id="F1" position="float">
        <label>Figure 1</label>
        <caption>
          <p><bold>Whole-genome phylogeny of the 2009 world pandemic Influenza A (H1N1) generated by UA.</bold> In green and red are represent the two main clades, where the green Mexico/4108 is probably the closest isolate to the origin of the influenza. In blue and orange are two of the possible early evolutions of the viral disease. The organisms which do not fall into one of the two main clades according to the literature are in black.</p>
        </caption>
        <graphic xlink:href="1748-7188-7-34-1"/>
      </fig>
      <fig id="F2" position="float">
        <label>Figure 2</label>
        <caption>
          <p><bold>Whole-genome phylogeny of prokaryotes by UA.</bold> In red are the branches of the <italic>Archaea</italic> domain, while in green are those of the <italic>Bacteria</italic> domain. Clusters of other organisms are highlighted with different colors. Only two organisms do not fall into the correct clade: Methanosarcina acetivorans – archaea (in cyan) and Desulfovibrio vulgaris subspecies vulgaris – bacteria (in black).</p>
        </caption>
        <graphic xlink:href="1748-7188-7-34-2"/>
      </fig>
      <fig id="F3" position="float">
        <label>Figure 3</label>
        <caption>
          <p>
            <bold>Whole-genome phylogeny of the genus </bold>
            <bold>
              <italic>Plasmodium </italic>
            </bold>
            <bold>by UA, with our whole-genome distance highlighted on the branches.</bold>
          </p>
        </caption>
        <graphic xlink:href="1748-7188-7-34-3"/>
      </fig>
      <p>The Robinson and Foulds distance is a standard method to evaluate topological discordance between trees. However when dealing with large trees it is known that small variations can generate very large R-F scores (typically, already for <italic>n</italic>∼10). For this reason we conducted a second series of experiments using the triplet distance
[<xref ref-type="bibr" rid="B35">35</xref>]. The triplet distance is a more refined measure that does not suffer this problem. Moreover, to better compare all taxonomies, we report the triplet distance between all trees. Tables
<xref ref-type="table" rid="T5">5</xref>,
<xref ref-type="table" rid="T6">6</xref> and
<xref ref-type="table" rid="T7">7</xref> show the triplet distance between all trees for all datasets. This more refined measure confirms the applicability of UA with respect to FFP and ACS.</p>
      <table-wrap position="float" id="T5">
        <label>Table 5</label>
        <caption>
          <p>Comparison of whole-genome phylogeny of influenza virus</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="left"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th align="left">
                <bold>Viruses</bold>
              </th>
              <th align="center">
                <bold>Reference</bold>
              </th>
              <th align="center">
                <bold>UA</bold>
              </th>
              <th align="center">
                <bold>ACS</bold>
              </th>
              <th align="center">
                <bold>FFP</bold>
              </th>
              <th align="center">
                <bold>FFP</bold>
                <sub>
                  <bold>
                    <italic>RY</italic>
                  </bold>
                </sub>
              </th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td align="left" valign="bottom">Reference<hr/></td>
              <td align="center" valign="bottom">0.0<hr/></td>
              <td align="center" valign="bottom">0.60<hr/></td>
              <td align="center" valign="bottom">0.63<hr/></td>
              <td align="center" valign="bottom">0.86<hr/></td>
              <td align="center" valign="bottom">0.88<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">UA<hr/></td>
              <td align="center" valign="bottom">
                <bold>0.60</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">0.0<hr/></td>
              <td align="center" valign="bottom">0.30<hr/></td>
              <td align="center" valign="bottom">0.81<hr/></td>
              <td align="center" valign="bottom">0.74<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">ACS<hr/></td>
              <td align="center" valign="bottom">0.63<hr/></td>
              <td align="center" valign="bottom">0.30<hr/></td>
              <td align="center" valign="bottom">0.0<hr/></td>
              <td align="center" valign="bottom">0.83<hr/></td>
              <td align="center" valign="bottom">0.81<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">FFP<hr/></td>
              <td align="center" valign="bottom">0.86<hr/></td>
              <td align="center" valign="bottom">0.81<hr/></td>
              <td align="center" valign="bottom">0.83<hr/></td>
              <td align="center" valign="bottom">0.0<hr/></td>
              <td align="center" valign="bottom">0.73<hr/></td>
            </tr>
            <tr>
              <td align="left">FFP<sub><italic>RY</italic></sub></td>
              <td align="center">0.88</td>
              <td align="center">0.74</td>
              <td align="center">0.81</td>
              <td align="center">0.73</td>
              <td align="center">0.0</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Normalized triplet distance between all trees. The best results are in bold.</p>
        </table-wrap-foot>
      </table-wrap>
      <table-wrap position="float" id="T6">
        <label>Table 6</label>
        <caption>
          <p>Comparison of whole-genome phylogeny of prokaryotes</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="left"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th align="left">
                <bold>Prokaryotes</bold>
              </th>
              <th align="center">
                <bold>Reference</bold>
              </th>
              <th align="center">
                <bold>UA</bold>
              </th>
              <th align="center">
                <bold>ACS</bold>
              </th>
              <th align="center">
                <bold>FFP</bold>
              </th>
              <th align="center">
                <bold>FFP</bold>
                <sub>
                  <bold>
                    <italic>RY</italic>
                  </bold>
                </sub>
              </th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td align="left" valign="bottom">Reference<hr/></td>
              <td align="center" valign="bottom">0.0<hr/></td>
              <td align="center" valign="bottom">0.24<hr/></td>
              <td align="center" valign="bottom">0.37<hr/></td>
              <td align="center" valign="bottom">0.62<hr/></td>
              <td align="center" valign="bottom">0.39<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">UA<hr/></td>
              <td align="center" valign="bottom">
                <bold>0.24</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">0.0<hr/></td>
              <td align="center" valign="bottom">0.37<hr/></td>
              <td align="center" valign="bottom">0.55<hr/></td>
              <td align="center" valign="bottom">0.47<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">ACS<hr/></td>
              <td align="center" valign="bottom">0.37<hr/></td>
              <td align="center" valign="bottom">0.37<hr/></td>
              <td align="center" valign="bottom">0.0<hr/></td>
              <td align="center" valign="bottom">0.59<hr/></td>
              <td align="center" valign="bottom">0.48<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">FFP<hr/></td>
              <td align="center" valign="bottom">0.62<hr/></td>
              <td align="center" valign="bottom">0.55<hr/></td>
              <td align="center" valign="bottom">0.59<hr/></td>
              <td align="center" valign="bottom">0.0<hr/></td>
              <td align="center" valign="bottom">0.57<hr/></td>
            </tr>
            <tr>
              <td align="left">FFP<sub><italic>RY</italic></sub></td>
              <td align="center">0.39</td>
              <td align="center">0.47</td>
              <td align="center">0.48</td>
              <td align="center">0.57</td>
              <td align="center">0.0</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Comparison of Whole-Genome Phylogeny of Prokaryotes. Normalized triplet distance between all trees. The best results are in bold.</p>
        </table-wrap-foot>
      </table-wrap>
      <table-wrap position="float" id="T7">
        <label>Table 7</label>
        <caption>
          <p>
            <bold>Comparison of whole-genome phylogeny of </bold>
            <bold>
              <italic>Plasmodium</italic>
            </bold>
          </p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="left"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th align="left">
                <bold>Plasmodium</bold>
              </th>
              <th align="center">
                <bold>Reference</bold>
              </th>
              <th align="center">
                <bold>UA</bold>
              </th>
              <th align="center">
                <bold>ACS</bold>
              </th>
              <th align="center">
                <bold>FFP</bold>
              </th>
              <th align="center">
                <bold>FFP</bold>
                <sub>
                  <bold>
                    <italic>RY</italic>
                  </bold>
                </sub>
              </th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td align="left" valign="bottom">Reference<hr/></td>
              <td align="center" valign="bottom">0.0<hr/></td>
              <td align="center" valign="bottom">0.0<hr/></td>
              <td align="center" valign="bottom">0.0<hr/></td>
              <td align="center" valign="bottom">0.4<hr/></td>
              <td align="center" valign="bottom">0.0<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">UA<hr/></td>
              <td align="center" valign="bottom">
                <bold>0.0</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">0.0<hr/></td>
              <td align="center" valign="bottom">0.0<hr/></td>
              <td align="center" valign="bottom">0.3<hr/></td>
              <td align="center" valign="bottom">0.0<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">ACS<hr/></td>
              <td align="center" valign="bottom">
                <bold>0.0</bold>
                <hr/>
              </td>
              <td align="center" valign="bottom">0.0<hr/></td>
              <td align="center" valign="bottom">0.0<hr/></td>
              <td align="center" valign="bottom">0.3<hr/></td>
              <td align="center" valign="bottom">0.0<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">FFP<hr/></td>
              <td align="center" valign="bottom">0.4<hr/></td>
              <td align="center" valign="bottom">0.3<hr/></td>
              <td align="center" valign="bottom">0.0<hr/></td>
              <td align="center" valign="bottom">0.0<hr/></td>
              <td align="center" valign="bottom">0.3<hr/></td>
            </tr>
            <tr>
              <td align="left">FFP<sub><italic>RY</italic></sub></td>
              <td align="center">
                <bold>0.0</bold>
              </td>
              <td align="center">0.0</td>
              <td align="center">0.0</td>
              <td align="center">0.3</td>
              <td align="center">0.0</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Normalized triplet distance between all trees. The best results are in bold.</p>
        </table-wrap-foot>
      </table-wrap>
      <p>In more detail, Figure
<xref ref-type="fig" rid="F1">1</xref> shows that our approach can distinguish the two main clades of the 2009 Influenza A-H1N1 (in green and red), which have been outlined in
[<xref ref-type="bibr" rid="B30">30</xref>]. The origin of the flu could reside in the Mexican isolate (Mexico/4108, in green), from which all other green isolates may have ensued. Two sub-clades for the U.S. states of California and Texas are highlighted within the red clade, most probably corresponding to the first major evolutions of the viral disease.</p>
      <p>Similar results are obtained for the second dataset, as shown in Figure
<xref ref-type="fig" rid="F2">2</xref>. UA can easily distinguish the Archaea domain, in red, from the Bacteria domain, in green, and also other sub-clades with respect to the reference tree (these sub-clades are highlighted in the figure with different colors). The organisms in black do not form a clade with other organisms in the reference tree. For the third dataset (Figure
<xref ref-type="fig" rid="F3">3</xref>), the whole-genome phylogeny of the genus <italic>Plasmodium</italic> generated by UA corresponds exactly to the taxonomy found in the literature.</p>
      <p>The accuracy results are promising, but we believe that of equal interest are the patterns used for the classification. Our approach, by construction, uses only a very small number of patterns. For this reason we report in Table
<xref ref-type="table" rid="T8">8</xref> some statistics for the underlying subwords selected, averaged over all experiments. We can notice that the number of irredundant patterns is in general smaller than the length of the genomes, and this is a first form of information filtering. Moreover we can observe that only a few underlying subwords are selected on average among the irredundant common subwords. This number is always very small when compared with all possible irredundant subwords, and much smaller than the length of the sequences.</p>
      <table-wrap position="float" id="T8">
        <label>Table 8</label>
        <caption>
          <p>Main statistics for the underlying approach averaged over all experiments</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th align="left">
                <bold>Counting</bold>
              </th>
              <th align="left">
                <bold>Influenza A</bold>
              </th>
              <th align="left">
                <bold>Arch. &amp; Bact.</bold>
              </th>
              <th align="left">
                <bold>Plasmodium</bold>
              </th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td align="left" valign="bottom">Min genome size<hr/></td>
              <td align="left" valign="bottom">12,976 b<hr/></td>
              <td align="left" valign="bottom">650 kbp<hr/></td>
              <td align="left" valign="bottom">18,524 kbp<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">Max genome size<hr/></td>
              <td align="left" valign="bottom">13,611 b<hr/></td>
              <td align="left" valign="bottom">8,350 kbp<hr/></td>
              <td align="left" valign="bottom">23,730 kbp<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">Average genome size<hr/></td>
              <td align="left" valign="bottom">13,230 b<hr/></td>
              <td align="left" valign="bottom">2,700 kbp<hr/></td>
              <td align="left" valign="bottom">21,380 kbp<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">Irredundants
<inline-formula><mml:math id="M73" name="1748-7188-7-34-i73" overflow="scroll"><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">I</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:math></inline-formula><hr/></td>
              <td align="left" valign="bottom">3,722<hr/></td>
              <td align="left" valign="bottom">3,167 k<hr/></td>
              <td align="left" valign="bottom">16,354 k<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">Underlying subwords<hr/></td>
              <td align="left" valign="bottom">60<hr/></td>
              <td align="left" valign="bottom">112 k<hr/></td>
              <td align="left" valign="bottom">706 k<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">
                <inline-formula>
                  <mml:math id="M74" name="1748-7188-7-34-i74" overflow="scroll">
                    <mml:mo>|</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi mathvariant="bold-script">U</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>s</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>,</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>s</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>|</mml:mo>
                  </mml:math>
                </inline-formula>
                <hr/>
              </td>
              <td> </td>
              <td> </td>
              <td> </td>
            </tr>
            <tr>
              <td align="left" valign="bottom">Min |<italic>w</italic>| in
<inline-formula><mml:math id="M75" name="1748-7188-7-34-i75" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">U</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula><hr/></td>
              <td align="left" valign="bottom">6<hr/></td>
              <td align="left" valign="bottom">10<hr/></td>
              <td align="left" valign="bottom">12<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">Max |<italic>w</italic>| in
<inline-formula><mml:math id="M76" name="1748-7188-7-34-i76" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">U</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula><hr/></td>
              <td align="left" valign="bottom">1,615<hr/></td>
              <td align="left" valign="bottom">25<hr/></td>
              <td align="left" valign="bottom">266<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">Average |<italic>w</italic>| in
<inline-formula><mml:math id="M77" name="1748-7188-7-34-i77" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-script">U</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula><hr/></td>
              <td align="left" valign="bottom">264<hr/></td>
              <td align="left" valign="bottom">14<hr/></td>
              <td align="left" valign="bottom">20<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">Untied inversions<hr/></td>
              <td align="left" valign="bottom">28%<hr/></td>
              <td align="left" valign="bottom">31%<hr/></td>
              <td align="left" valign="bottom">33%<hr/></td>
            </tr>
            <tr>
              <td align="left">Untied complements</td>
              <td align="left">22%</td>
              <td align="left">20%</td>
              <td align="left">19%</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>Similar considerations can be drawn for the underlying subwords length. On average they can be very long, especially with respect to FFP that uses only k-mers with <italic>k</italic> in the range [5,10]. Furthermore, each underlying subword occurs only a few times per sequence, and in general about one occurrence per sequence. Removing the high-frequency subwords, we can notice that the underlying subwords typically have length ≥ log<sub>4</sub> min{<italic>m</italic>,<italic>n</italic>}, and in the case of viruses they can be very large, capturing more information than FFP. The longest underlying subwords appear in the virus dataset, and they are on the order of a thousand bases. We checked if these subwords may have some biological meaning and we found that in some cases they correspond to whole viral segments that are shared between two genomes. This confirms that, in some cases, the underlying subwords used for classification can capture some biological insight.</p>
      <p>Another interesting aspect is the contribution of inversions and complements in our similarity measure, with respect to the classical notion of match. We compute the average number of occurrences used in our scoring function that is due to inversions and complements. The contribution of inversions and complements is about 28-33% and 19-20%, respectively. This fact may be due to the nature of the sequences considered, but we believe that this topic deserves more attention.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusion</title>
    <p>In conclusion, we have shown that the underlying subwords can be used for the reconstruction of phylogenetic trees. Preliminary experiments have shown very good performance in the identification of major clusters for viruses, prokaryotes, and unicellular eukaryotes. An important observation that distinguishes our methods from the others is that only a small number of underlying subwords is used in our distance, nevertheless the results are promising. From this fact we can speculate that only a very limited number of subwords is needed to establish the phylogeny of genomic sequences. Thus, an interesting problem that can be addressed using the underlying subwords is the selection of probes for DNA chips.</p>
    <p>In the future, we plan to extend this method for the comparison of whole genomes based on short reads coming from next-generation sequencing, instead of using assembled genomes.</p>
  </sec>
  <sec>
    <title>Endnotes</title>
    <p><sup>a</sup> ClustalW2 is available at
<ext-link ext-link-type="uri" xlink:href="http://www.ebi.ac.uk/Tools/msa/clustalw2">http://www.ebi.ac.uk/Tools/msa/clustalw2</ext-link>.</p>
    <p><sup>b</sup> PHYLIP (phylogenetic inference package) is a free computational phylogenetics software package available at
<ext-link ext-link-type="uri" xlink:href="http://evolution.genetics.washington.edu/phylip">http://evolution.genetics.washington.edu/phylip</ext-link>.</p>
    <p><sup>c</sup> The Ribosomal Database Project is available at
<ext-link ext-link-type="uri" xlink:href="http://rdp.cme.msu.edu">http://rdp.cme.msu.edu</ext-link>.</p>
    <p><sup>d</sup> The FFP software package release 3.14 is available at
<ext-link ext-link-type="uri" xlink:href="http://ffp-phylogeny.sourceforge.net">http://ffp-phylogeny.sourceforge.net</ext-link>.</p>
  </sec>
  <sec>
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec>
    <title>Authors’ contributions</title>
    <p>All authors contributed equally to this study. All authors read and approved the final manuscript.</p>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgements</title>
    <p>M.C. was partially supported by the Ateneo Project “Pattern discovery and computational problems for whole genomes comparison” of the University of Padova. The authors would like to thank prof. Benny Chor for providing the data and for helpful discussions. We thank the reviewers for their careful read and thoughtful comments on the paper.</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Wildman</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Uddin</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Opazo</surname>
          <given-names>JC</given-names>
        </name>
        <name>
          <surname>Liu</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Lefort</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Guindon</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Gascuel</surname>
          <given-names>O</given-names>
        </name>
        <name>
          <surname>Grossman</surname>
          <given-names>LI</given-names>
        </name>
        <name>
          <surname>Romero</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Goodman</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Genomics, biogeography, and the diversification of placental mammals</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2007</year>
        <volume>104</volume>
        <fpage>14395</fpage>
        <lpage>14400</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0704342104</pub-id>
        <pub-id pub-id-type="pmid">17728403</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Huynen</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Bork</surname>
          <given-names>P</given-names>
        </name>
        <article-title>Measuring genome evolution</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>1998</year>
        <volume>95</volume>
        <fpage>5849</fpage>
        <lpage>5856</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.95.11.5849</pub-id>
        <pub-id pub-id-type="pmid">9600883</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Chor</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Horn</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Goldman</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Levy</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Massingham</surname>
          <given-names>T</given-names>
        </name>
        <article-title>Genomic DNA k-mer spectra: models and modalities</article-title>
        <source>Genome Biol</source>
        <year>2009</year>
        <volume>10</volume>
        <issue>10</issue>
        <fpage>R108</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2009-10-10-r108</pub-id>
        <pub-id pub-id-type="pmid">19814784</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Sims</surname>
          <given-names>GE</given-names>
        </name>
        <name>
          <surname>Jun</surname>
          <given-names>SRR</given-names>
        </name>
        <name>
          <surname>Wu</surname>
          <given-names>GA</given-names>
        </name>
        <name>
          <surname>Kim</surname>
          <given-names>SH</given-names>
        </name>
        <article-title>Alignment-free genome comparison with feature frequency profiles (FFP) and optimal resolutions</article-title>
        <source>Proc Nat Acad Sci USA</source>
        <year>2009</year>
        <volume>106</volume>
        <issue>8</issue>
        <fpage>2677</fpage>
        <lpage>2682</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0813249106</pub-id>
        <pub-id pub-id-type="pmid">19188606</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Venter</surname>
          <given-names>C</given-names>
        </name>
        <etal/>
        <article-title>The sequence of the human genome</article-title>
        <source>Science</source>
        <year>2001</year>
        <volume>291</volume>
        <fpage>1305</fpage>
        <lpage>1350</lpage>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Delsuc</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Brinkmann</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Philippe</surname>
          <given-names>H</given-names>
        </name>
        <article-title>Phylogenomics and the reconstruction of the tree of life</article-title>
        <source>Nat Rev Genet</source>
        <year>2005</year>
        <volume>6</volume>
        <fpage>361</fpage>
        <lpage>375</lpage>
        <pub-id pub-id-type="pmid">15861208</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Ulitsky</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Burstein</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Tuller</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Chor</surname>
          <given-names>B</given-names>
        </name>
        <article-title>The average common substring approach to phylogenomic reconstruction</article-title>
        <source>J Comput Biol</source>
        <year>2006</year>
        <volume>13</volume>
        <issue>2</issue>
        <fpage>336</fpage>
        <lpage>350</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2006.13.336</pub-id>
        <pub-id pub-id-type="pmid">16597244</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Sims</surname>
          <given-names>GE</given-names>
        </name>
        <name>
          <surname>Jun</surname>
          <given-names>SR</given-names>
        </name>
        <name>
          <surname>Wu</surname>
          <given-names>GA</given-names>
        </name>
        <name>
          <surname>Kim</surname>
          <given-names>SH</given-names>
        </name>
        <article-title>Whole-genome phylogeny of mammals: Evolutionary information in genic and nongenic regions</article-title>
        <source>Proc Nat Acad Sci USA</source>
        <year>2009</year>
        <volume>106</volume>
        <issue>40</issue>
        <fpage>17077</fpage>
        <lpage>17082</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0909377106</pub-id>
        <pub-id pub-id-type="pmid">19805074</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lin</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Divergence measures based on the Shannon entropy</article-title>
        <source>IEEE T Inform Theory</source>
        <year>1991</year>
        <volume>37</volume>
        <fpage>145</fpage>
        <lpage>151</lpage>
        <pub-id pub-id-type="doi">10.1109/18.61115</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Apostolico</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Comin</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Parida</surname>
          <given-names>L</given-names>
        </name>
        <article-title>Mining, compressing and classifying with extensible motifs</article-title>
        <source>Algorithms Mol Biol</source>
        <year>2006</year>
        <volume>1</volume>
        <fpage>4</fpage>
        <pub-id pub-id-type="doi">10.1186/1748-7188-1-4</pub-id>
        <pub-id pub-id-type="pmid">16722593</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="book">
        <name>
          <surname>Apostolico</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Comin</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Parida</surname>
          <given-names>L</given-names>
        </name>
        <article-title>Motifs in Ziv-Lempel-Welch Clef</article-title>
        <source>Proceedings of IEEE DCC Data Compression Conference</source>
        <year>2004</year>
        <publisher-name>IEEE Computer Society</publisher-name>
        <fpage>72</fpage>
        <lpage>81</lpage>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Giancarlo</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Scaturro</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Utro</surname>
          <given-names>F</given-names>
        </name>
        <article-title>Textual data compression in computational biology: a synopsis</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>13</issue>
        <fpage>1575</fpage>
        <lpage>1586</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp117</pub-id>
        <pub-id pub-id-type="pmid">19251772</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Iliopoulos</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Mchugh</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Peterlongo</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Pisanti</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Rytter</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Sagot</surname>
          <given-names>MF</given-names>
        </name>
        <article-title>A first approach to finding common motifs with gaps</article-title>
        <source>Int J Foundations Comput Sci</source>
        <year>2005</year>
        <volume>16</volume>
        <issue>6</issue>
        <fpage>1145</fpage>
        <lpage>1154</lpage>
        <pub-id pub-id-type="doi">10.1142/S0129054105003716</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Apostolico</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Comin</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Parida</surname>
          <given-names>L</given-names>
        </name>
        <article-title>Conservative extraction of over-represented extensible motifs</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <issue>Suppl 1</issue>
        <fpage>i9</fpage>
        <lpage>i18</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti1051</pub-id>
        <pub-id pub-id-type="pmid">15961503</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Apostolico</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Comin</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Parida</surname>
          <given-names>L</given-names>
        </name>
        <article-title>VARUN: discovering extensible motifs under saturation constraints</article-title>
        <source>IEEE/ACM Trans Comput Biol Bioinformatics</source>
        <year>2010</year>
        <volume>7</volume>
        <issue>4</issue>
        <fpage>752</fpage>
        <lpage>762</lpage>
      </mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kong</surname>
          <given-names>SG</given-names>
        </name>
        <name>
          <surname>Fan</surname>
          <given-names>WL</given-names>
        </name>
        <name>
          <surname>Chen</surname>
          <given-names>HD</given-names>
        </name>
        <name>
          <surname>Hsu</surname>
          <given-names>ZT</given-names>
        </name>
        <name>
          <surname>Zhou</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Zheng</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Lee</surname>
          <given-names>HC</given-names>
        </name>
        <article-title>Inverse symmetry in complete genomes and whole-genome inverse duplication</article-title>
        <source>PLoS ONE</source>
        <year>2009</year>
        <volume>4</volume>
        <issue>11</issue>
        <fpage>e7553</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0007553</pub-id>
        <pub-id pub-id-type="pmid">19898631</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="book">
        <name>
          <surname>Gusfield</surname>
          <given-names>D</given-names>
        </name>
        <source>Algorithms on Strings, Trees, and Sequences: Computer Science and Computational Biology</source>
        <year>1997</year>
        <publisher-name>New York, USA: Cambridge University Press</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Apostolico</surname>
          <given-names>A</given-names>
        </name>
        <article-title>The myriad virtues of subword trees</article-title>
        <source>Combinatorial Algorithms on Words, A. Apostolico, Z. Galil (Eds.)</source>
        <year>1985</year>
        <volume>12</volume>
        <fpage>85</fpage>
        <lpage>96</lpage>
      </mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="book">
        <name>
          <surname>Apostolico</surname>
          <given-names>A</given-names>
        </name>
        <person-group person-group-type="editor">Elomaa T, Mannila H, Orponen P</person-group>
        <article-title>Maximal words in sequence comparisons based on subword composition</article-title>
        <source>Algorithms and Applications, Volume 6060 of Lecture Notes in Computer Science</source>
        <year>2010</year>
        <publisher-name>Berlin: Springer-Verlag</publisher-name>
        <fpage>34</fpage>
        <lpage>44</lpage>
      </mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Apostolico</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Parida</surname>
          <given-names>L</given-names>
        </name>
        <article-title>Incremental paradigms of motif discovery</article-title>
        <source>J Comput Biol</source>
        <year>2004</year>
        <volume>11</volume>
        <fpage>15</fpage>
        <lpage>25</lpage>
        <pub-id pub-id-type="doi">10.1089/106652704773416867</pub-id>
        <pub-id pub-id-type="pmid">15072686</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Comin</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Verzotto</surname>
          <given-names>D</given-names>
        </name>
        <article-title>Classification of protein sequences by means of irredundant patterns</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <issue>Suppl. 1</issue>
        <fpage>S16</fpage>
        <pub-id pub-id-type="pmid">20122187</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Comin</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Verzotto</surname>
          <given-names>D</given-names>
        </name>
        <article-title>The Irredundant Class method for remote homology detection of protein sequences</article-title>
        <source>J Comput Biol</source>
        <year>2011</year>
        <volume>18</volume>
        <issue>12</issue>
        <fpage>1819</fpage>
        <lpage>1829</lpage>
        <comment>[
<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1089/cmb.2010.0171">http://dx.doi.org/10.1089/cmb.2010.0171</ext-link>]</comment>
        <pub-id pub-id-type="doi">10.1089/cmb.2010.0171</pub-id>
        <pub-id pub-id-type="pmid">21548811</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Apostolico</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Comin</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Parida</surname>
          <given-names>L</given-names>
        </name>
        <article-title>Bridging lossy and lossless compression by motif pattern discovery</article-title>
        <source>Lect Notes Comput Sci</source>
        <year>2006</year>
        <volume>4123</volume>
        <fpage>793</fpage>
        <lpage>813</lpage>
        <pub-id pub-id-type="doi">10.1007/11889342_51</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Comin</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Parida</surname>
          <given-names>L</given-names>
        </name>
        <article-title>Detection of subtle variations as consensus motifs</article-title>
        <source>Theor Comput Sci</source>
        <year>2008</year>
        <volume>395</volume>
        <issue>2-3</issue>
        <fpage>158</fpage>
        <lpage>170</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tcs.2008.01.017</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Ukkonen</surname>
          <given-names>E</given-names>
        </name>
        <article-title>Maximal and minimal representations of gapped and non-gapped motifs of a string</article-title>
        <source>Theor Comput Sci</source>
        <year>2009</year>
        <volume>410</volume>
        <issue>43</issue>
        <fpage>4341</fpage>
        <lpage>4349</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tcs.2009.07.015</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="book">
        <name>
          <surname>Comin</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Verzotto</surname>
          <given-names>D</given-names>
        </name>
        <person-group person-group-type="editor">Elloumi M, Zomaya AY</person-group>
        <article-title>Comparing, ranking and filtering motifs with character classes: application to biological sequences analysis</article-title>
        <source>Biological Knowledge Discovery Handbook: Preprocessing, Mining and Postprocessing of Biological Data</source>
        <year>2013</year>
        <publisher-name>Wiley</publisher-name>
        <fpage>chapter 13</fpage>
        <lpage>chapter 13</lpage>
      </mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="book">
        <name>
          <surname>Cormen</surname>
          <given-names>TH</given-names>
        </name>
        <name>
          <surname>Leiserson</surname>
          <given-names>CE</given-names>
        </name>
        <name>
          <surname>Rivest</surname>
          <given-names>RL</given-names>
        </name>
        <source>Introduction To Algorithms, chap. 9</source>
        <year>1990</year>
        <publisher-name>MIT Press</publisher-name>
        <comment>178–180</comment>
      </mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="book">
        <name>
          <surname>Kopelowitz</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Lewenstein</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Dynamic weighted ancestors</article-title>
        <source>Proceedings of the Eighteenth Annual ACM-SIAM Symposium on Discrete Algorithms (SODA 2007)</source>
        <year>2007</year>
        <publisher-name>Society for Industrial and Applied Mathematics Philadelphia SIAM</publisher-name>
        <fpage>565</fpage>
        <lpage>574</lpage>
      </mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Smith</surname>
          <given-names>GJD</given-names>
        </name>
        <name>
          <surname>Vijaykrishna</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Bahl</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Lycett</surname>
          <given-names>SJ</given-names>
        </name>
        <name>
          <surname>Worobey</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Pybus</surname>
          <given-names>OG</given-names>
        </name>
        <name>
          <surname>Ma</surname>
          <given-names>SK</given-names>
        </name>
        <name>
          <surname>Cheung</surname>
          <given-names>CL</given-names>
        </name>
        <name>
          <surname>Raghwani</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Bhatt</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Peiris</surname>
          <given-names>JSM</given-names>
        </name>
        <name>
          <surname>Guan</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Rambaut</surname>
          <given-names>A</given-names>
        </name>
        <article-title>Origins and evolutionary genomics of the 2009 swine-origin H1N1 Influenza A epidemic</article-title>
        <source>Nature. Nature Publishing Group</source>
        <year>2009</year>
        <volume>459</volume>
        <issue>7250</issue>
        <fpage>1122</fpage>
        <lpage>1125</lpage>
      </mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Shiino</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Okabe</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Yasui</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Sunagawa</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Ujike</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Obuchi</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Kishida</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Xu</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Takashita</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Anraku</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Ito</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Doi</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Ejima</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Sugawara</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Horikawa</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Yamazaki</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Kato</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Oguchi</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Fujita</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Odagiri</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Tashiro</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Watanabe</surname>
          <given-names>H</given-names>
        </name>
        <article-title>Molecular Evolutionary Analysis of the Influenza A(H1N1)pdm, May–September, 2009: Temporal and Spatial Spreading Profile of the Viruses in Japan</article-title>
        <source>PLoS ONE</source>
        <year>2010</year>
        <volume>5</volume>
        <issue>6</issue>
        <fpage>e11057</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0011057</pub-id>
        <pub-id pub-id-type="pmid">20548780</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B31">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Thompson</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Higgins</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Gibson</surname>
          <given-names>T</given-names>
        </name>
        <article-title>CLUSTAL W: improving the sensitivity of progressive multiple sequence alignment through sequence weighting, position-specific gap penalties and weight matrix choice</article-title>
        <source>Nucleic Acids Res</source>
        <year>1994</year>
        <volume>22</volume>
        <fpage>4673</fpage>
        <lpage>4680</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/22.22.4673</pub-id>
        <pub-id pub-id-type="pmid">7984417</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B32">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Felsenstein</surname>
          <given-names>J</given-names>
        </name>
        <article-title>PHYLIP – Phylogeny Inference Package (Version 3.2)</article-title>
        <source>Cladistics</source>
        <year>1989</year>
        <volume>5</volume>
        <fpage>164</fpage>
        <lpage>166</lpage>
      </mixed-citation>
    </ref>
    <ref id="B33">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Cole</surname>
          <given-names>JR</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>Q</given-names>
        </name>
        <name>
          <surname>Cardenas</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Fish</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Chai</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Farris</surname>
          <given-names>RJ</given-names>
        </name>
        <name>
          <surname>Kulam-Syed-Mohideen</surname>
          <given-names>AS</given-names>
        </name>
        <name>
          <surname>McGarrell</surname>
          <given-names>DM</given-names>
        </name>
        <name>
          <surname>Marsh</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Garrity</surname>
          <given-names>GM</given-names>
        </name>
        <name>
          <surname>Tiedje</surname>
          <given-names>JM</given-names>
        </name>
        <article-title>The Ribosomal Database Project: improved alignments and new tools for rRNA analysis</article-title>
        <source>Nucleic Acids Res</source>
        <year>2009</year>
        <volume>37</volume>
        <fpage>D141</fpage>
        <lpage>D145</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkn879</pub-id>
        <pub-id pub-id-type="pmid">19004872</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B34">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Martinsen</surname>
          <given-names>ES</given-names>
        </name>
        <name>
          <surname>Perkins</surname>
          <given-names>SL</given-names>
        </name>
        <name>
          <surname>Schall</surname>
          <given-names>JJ</given-names>
        </name>
        <article-title>A three-genome phylogeny of malaria parasites (Plasmodium and closely related genera): Evolution of life-history traits and host switches</article-title>
        <source>Mol Phylogenet Evol</source>
        <year>2008</year>
        <volume>47</volume>
        <fpage>261</fpage>
        <lpage>273</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ympev.2007.11.012</pub-id>
        <pub-id pub-id-type="pmid">18248741</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B35">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Critchlow</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Pearl</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Qian</surname>
          <given-names>C</given-names>
        </name>
        <article-title>The triples distance for rooted bifurcating phylogenetic trees</article-title>
        <source>Syst Biol</source>
        <year>1996</year>
        <volume>45</volume>
        <issue>3</issue>
        <fpage>323</fpage>
        <lpage>334</lpage>
        <pub-id pub-id-type="doi">10.1093/sysbio/45.3.323</pub-id>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
