<?properties open_access?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1460-2059</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2723002</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btp352</article-id>
    <article-id pub-id-type="publisher-id">btp352</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group>
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>The Sequence Alignment/Map format and SAMtools</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Heng</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="author-notes" rid="FN1">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Handsaker</surname>
          <given-names>Bob</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="author-notes" rid="FN1">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wysoker</surname>
          <given-names>Alec</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fennell</surname>
          <given-names>Tim</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ruan</surname>
          <given-names>Jue</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Homer</surname>
          <given-names>Nils</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Marth</surname>
          <given-names>Gabor</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Abecasis</surname>
          <given-names>Goncalo</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>6</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Durbin</surname>
          <given-names>Richard</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">
          <sup>*</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <collab>1000 Genome Project Data Processing Subgroup</collab>
        <xref ref-type="aff" rid="AFF1">
          <sup>7</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><sup>1</sup> Wellcome Trust Sanger Institute, Wellcome Trust Genome Campus, Cambridge, CB10 1SA, UK, <sup>2</sup>Broad Institute of MIT and Harvard, Cambridge, MA 02141, USA, <sup>3</sup>Beijing Institute of Genomics, Chinese Academy of Science, Beijing 100029, China, <sup>4</sup>Department of Computer Science, University of California Los Angeles, Los Angeles, CA 90095, <sup>5</sup>Department of Biology, Boston College, Chestnut Hill, MA 02467, <sup>6</sup>Center for Statistical Genetics, Department of Biostatistics, University of Michigan, Ann Arbor, MI 48109, USA and <sup>7</sup><ext-link ext-link-type="uri" xlink:href="http://1000genomes.org">http://1000genomes.org</ext-link></aff>
    <author-notes>
      <corresp id="COR1"><sup>*</sup>To whom correspondence should be addressed.</corresp>
      <fn id="FN1">
        <p><sup>†</sup>The authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors.</p>
      </fn>
      <fn>
        <p>Associate Editor: Alfonso Valencia</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>8</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>8</day>
      <month>6</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>8</day>
      <month>6</month>
      <year>2009</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>25</volume>
    <issue>16</issue>
    <fpage>2078</fpage>
    <lpage>2079</lpage>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>4</month>
        <year>2009</year>
      </date>
      <date date-type="rev-recd">
        <day>28</day>
        <month>5</month>
        <year>2009</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>5</month>
        <year>2009</year>
      </date>
    </history>
    <permissions>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Summary:</bold> The Sequence Alignment/Map (SAM) format is a generic alignment format for storing read alignments against reference sequences, supporting short and long reads (up to 128 Mbp) produced by different sequencing platforms. It is flexible in style, compact in size, efficient in random access and is the format in which alignments from the 1000 Genomes Project are released. SAMtools implements various utilities for post-processing alignments in the SAM format, such as indexing, variant caller and alignment viewer, and thus provides universal tools for processing read alignments.</p>
      <p>
        <bold>Availability:</bold>
        <ext-link ext-link-type="uri" xlink:href="http://samtools.sourceforge.net">http://samtools.sourceforge.net</ext-link>
      </p>
      <p>
        <bold>Contact:</bold>
        <email>rd@sanger.ac.uk</email>
      </p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>1 INTRODUCTION</title>
    <p>With the advent of novel sequencing technologies such as Illumina/Solexa, AB/SOLiD and Roche/454 (Mardis, <xref ref-type="bibr" rid="B4">2008</xref>), a variety of new alignment tools (Langmead <italic>et al.</italic>, <xref ref-type="bibr" rid="B2">2009</xref>; Li <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">2008</xref>) have been designed to realize efficient read mapping against large reference sequences, including the human genome. These tools generate alignments in different formats, however, complicating downstream processing. A common alignment format that supports all sequence types and aligners creates a well-defined interface between alignment and downstream analyses, including variant detection, genotyping and assembly.</p>
    <p>The Sequence Alignment/Map (SAM) format is designed to achieve this goal. It supports single- and paired-end reads and combining reads of different types, including color space reads from AB/SOLiD. It is designed to scale to alignment sets of 10<sup>11</sup> or more base pairs, which is typical for the deep resequencing of one human individual.</p>
    <p>In this article, we present an overview of the SAM format and briefly introduce the companion SAMtools software package. A detailed format specification and the complete documentation of SAMtools are available at the SAMtools web site.</p>
  </sec>
  <sec sec-type="methods" id="SEC2">
    <title>2 METHODS</title>
    <sec id="SEC2.1">
      <title>2.1 The SAM format</title>
      <sec id="SEC2.1.1">
        <title>2.1.1 Overview of the SAM format</title>
        <p>The SAM format consists of one header section and one alignment section. The lines in the header section start with character ‘<monospace>@</monospace>’, and lines in the alignment section do not. All lines are TAB delimited. An example is shown in <xref ref-type="fig" rid="F1">Figure 1</xref>b.
<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>Example of extended CIGAR and the pileup output. (<bold>a</bold>) Alignments of one pair of reads and three single-end reads. (<bold>b</bold>) The corresponding SAM file. The ‘<monospace>@SQ</monospace>’ line in the header section gives the order of reference sequences. Notably, <monospace>r001</monospace> is the name of a read pair. According to <monospace>FLAG</monospace> 163 (=1 + 2 + 32 + 128), the read mapped to position 7 is the second read in the pair (128) and regarded as properly paired (1 + 2); its mate is mapped to 37 on the reverse strand (32). Read <monospace>r002</monospace> has three soft-clipped (unaligned) bases. The coordinate shown in SAM is the position of the first aligned base. The CIGAR string for this alignment contains a <monospace>P</monospace> (padding) operation which correctly aligns the inserted sequences. Padding operations can be absent when an aligner does not support multiple sequence alignment. The last six bases of read <monospace>r003</monospace> map to position 9, and the first five to position 29 on the reverse strand. The hard clipping operation <monospace>H</monospace> indicates that the clipped sequence is not present in the sequence field. The <monospace>NM</monospace> tag gives the number of mismatches. Read <monospace>r004</monospace> is aligned across an intron, indicated by the <monospace>N</monospace> operation. (<bold>c</bold>) Simplified pileup output by SAMtools. Each line consists of reference name, sorted coordinate, reference base, the number of reads covering the position and read bases. In the fifth field, a dot or a comma denotes a base identical to the reference; a dot or a capital letter denotes a base from a read mapped on the forward strand, while a comma or a lowercase letter on the reverse strand.</p></caption><graphic xlink:href="btp352f1"/></fig>
</p>
        <p>In SAM, each alignment line has 11 mandatory fields and a variable number of optional fields. The mandatory fields are briefly described in <xref ref-type="table" rid="T1">Table 1</xref>. They must be present but their value can be a ‘<monospace>⋆</monospace>’ or a zero (depending on the field) if the corresponding information is unavailable. The optional fields are presented as key-value pairs in the format of <monospace>TAG:TYPE:VALUE</monospace>. They store extra information from the platform or aligner. For example, the ‘<monospace>RG</monospace>’ tag keeps the ‘read group’ information for each read. In combination with the ‘<monospace>@RG</monospace>’ header lines, this tag allows each read to be labeled with metadata about its origin, sequencing center and library. The SAM format specification gives a detailed description of each field and the predefined <monospace>TAG</monospace>s.</p>
      </sec>
      <sec id="SEC2.1.2">
        <title>2.1.2 Extended CIGAR</title>
        <p>The standard CIGAR description of pairwise alignment defines three operations: ‘<monospace>M</monospace>’ for match/mismatch, ‘<monospace>I</monospace>’ for insertion compared with the reference and ‘<monospace>D</monospace>’ for deletion. The extended CIGAR proposed in SAM added four more operations: ‘<monospace>N</monospace>’ for skipped bases on the reference, ‘<monospace>S</monospace>’ for soft clipping, ‘<monospace>H</monospace>’ for hard clipping and ‘<monospace>P</monospace>’ for padding. These support splicing, clipping, multi-part and padded alignments. <xref ref-type="fig" rid="F1">Figure 1</xref> shows examples of CIGAR strings for different types of alignments.</p>
      </sec>
      <sec id="SEC2.1.3">
        <title>2.1.3 Binary Alignment/Map format</title>
        <p>To improve the performance, we designed a companion format Binary Alignment/Map (BAM), which is the binary representation of SAM and keeps exactly the same information as SAM. BAM is compressed by the BGZF library, a generic library developed by us to achieve fast random access in a zlib-compatible compressed file. An example alignment of 112 Gbp of Illumina GA data requires 116 GB of disk space (1.0 byte per input base), including sequences, base qualities and all the meta information generated by MAQ. Most of this space is used to store the base qualities.</p>
      </sec>
      <sec id="SEC2.1.4">
        <title>2.1.4 Sorting and indexing</title>
        <p>A SAM/BAM file can be unsorted, but sorting by coordinate is used to streamline data processing and to avoid loading extra alignments into memory. A position-sorted BAM file can be indexed. We combine the UCSC binning scheme (Kent <italic>et al.</italic>, <xref ref-type="bibr" rid="B1">2002</xref>) and simple linear indexing to achieve fast random retrieval of alignments overlapping a specified chromosomal region. In most cases, only one seek call is needed to retrieve alignments in a region.</p>
      </sec>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 SAMtools software package</title>
      <p>SAMtools is a library and software package for parsing and manipulating alignments in the SAM/BAM format. It is able to convert from other alignment formats, sort and merge alignments, remove PCR duplicates, generate per-position information in the pileup format (<xref ref-type="fig" rid="F1">Fig. 1</xref>c), call SNPs and short indel variants, and show alignments in a text-based viewer. For the example alignment of 112 Gbp Illumina GA data, SAMtools took about 10 h to convert from the MAQ format and 40 min to index with &lt;30 MB memory. Conversion is slower mainly because compression with zlib is slower than decompression. External sorting writes temporary BAM files and would typically be twice as slow as conversion.</p>
      <p>SAMtools has two separate implementations, one in C and the other in Java, with slightly different functionality.
<table-wrap id="T1" position="float"><label>Table 1.</label><caption><p>Mandatory fields in the SAM format</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th align="left" rowspan="1" colspan="1">No.</th><th align="left" rowspan="1" colspan="1">Name</th><th align="left" rowspan="1" colspan="1">Description</th></tr></thead><tbody align="left"><tr><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1"><monospace>QNAME</monospace></td><td align="left" rowspan="1" colspan="1">Query NAME of the read or the read pair</td></tr><tr><td align="left" rowspan="1" colspan="1">2</td><td align="left" rowspan="1" colspan="1"><monospace>FLAG</monospace></td><td align="left" rowspan="1" colspan="1">Bitwise FLAG (pairing, strand, mate strand, etc.)</td></tr><tr><td align="left" rowspan="1" colspan="1">3</td><td align="left" rowspan="1" colspan="1"><monospace>RNAME</monospace></td><td align="left" rowspan="1" colspan="1">Reference sequence NAME</td></tr><tr><td align="left" rowspan="1" colspan="1">4</td><td align="left" rowspan="1" colspan="1"><monospace>POS</monospace></td><td align="left" rowspan="1" colspan="1">1-Based leftmost POSition of clipped alignment</td></tr><tr><td align="left" rowspan="1" colspan="1">5</td><td align="left" rowspan="1" colspan="1"><monospace>MAPQ</monospace></td><td align="left" rowspan="1" colspan="1">MAPping Quality (Phred-scaled)</td></tr><tr><td align="left" rowspan="1" colspan="1">6</td><td align="left" rowspan="1" colspan="1"><monospace>CIGAR</monospace></td><td align="left" rowspan="1" colspan="1">Extended CIGAR string (operations: <monospace>MIDNSHP</monospace>)</td></tr><tr><td align="left" rowspan="1" colspan="1">7</td><td align="left" rowspan="1" colspan="1"><monospace>MRNM</monospace></td><td align="left" rowspan="1" colspan="1">Mate Reference NaMe (‘=’ if same as <monospace>RNAME</monospace>)</td></tr><tr><td align="left" rowspan="1" colspan="1">8</td><td align="left" rowspan="1" colspan="1"><monospace>MPOS</monospace></td><td align="left" rowspan="1" colspan="1">1-Based leftmost Mate POSition</td></tr><tr><td align="left" rowspan="1" colspan="1">9</td><td align="left" rowspan="1" colspan="1"><monospace>ISIZE</monospace></td><td align="left" rowspan="1" colspan="1">Inferred Insert SIZE</td></tr><tr><td align="left" rowspan="1" colspan="1">10</td><td align="left" rowspan="1" colspan="1"><monospace>SEQ</monospace></td><td align="left" rowspan="1" colspan="1">Query SEQuence on the same strand as the reference</td></tr><tr><td align="left" rowspan="1" colspan="1">11</td><td align="left" rowspan="1" colspan="1"><monospace>QUAL</monospace></td><td align="left" rowspan="1" colspan="1">Query QUALity (ASCII-33=Phred base quality)</td></tr></tbody></table></table-wrap>
</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="SEC3">
    <title>3 CONCLUSIONS</title>
    <p>We designed and implemented a generic alignment format, SAM, which is simple to work with and flexible enough to keep most information from various sequencing platforms and read aligners. The equivalent binary representation, BAM, is compact in size and supports fast retrieval of alignments in specified regions. Using positional sorting and indexing, applications can perform stream-based processing on specific genomic regions without loading the entire file into memory. The SAM/BAM format, together with SAMtools, separates the alignment step from downstream analyses, enabling a generic and modular approach to the analysis of genomic sequencing data.</p>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>We are grateful to James Bonfield for the comments on indexing and to SAMtools users for testing the software as it has matured.</p>
    <p><italic>Funding</italic>: Wellcome Trust/077192/Z/05/Z; <funding-source>NIH</funding-source> Hapmap/1000 Genomes Project grant (U54HG002750 to B.H.).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>WJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The human genome browser at UCSC</article-title>
        <source>Genome Res.</source>
        <year>2002</year>
        <volume>12</volume>
        <fpage>996</fpage>
        <lpage>1006</lpage>
        <pub-id pub-id-type="pmid">12045153</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title>
        <source>Genome Biol.</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>R25</fpage>
        <pub-id pub-id-type="pmid">19261174</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mapping short DNA sequencing reads and calling variants using mapping quality scores</article-title>
        <source>Genome Res.</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>1851</fpage>
        <lpage>1858</lpage>
        <pub-id pub-id-type="pmid">18714091</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mardis</surname>
            <given-names>ER</given-names>
          </name>
        </person-group>
        <article-title>Next-generation DNA sequencing methods</article-title>
        <source>Annu. Rev. Genomics Hum. Genet.</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>387</fpage>
        <lpage>402</lpage>
        <pub-id pub-id-type="pmid">18576944</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1460-2059</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2723002</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btp352</article-id>
    <article-id pub-id-type="publisher-id">btp352</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group>
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>The Sequence Alignment/Map format and SAMtools</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Heng</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="author-notes" rid="FN1">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Handsaker</surname>
          <given-names>Bob</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="author-notes" rid="FN1">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wysoker</surname>
          <given-names>Alec</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fennell</surname>
          <given-names>Tim</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ruan</surname>
          <given-names>Jue</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Homer</surname>
          <given-names>Nils</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Marth</surname>
          <given-names>Gabor</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Abecasis</surname>
          <given-names>Goncalo</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>6</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Durbin</surname>
          <given-names>Richard</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">
          <sup>*</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <collab>1000 Genome Project Data Processing Subgroup</collab>
        <xref ref-type="aff" rid="AFF1">
          <sup>7</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><sup>1</sup> Wellcome Trust Sanger Institute, Wellcome Trust Genome Campus, Cambridge, CB10 1SA, UK, <sup>2</sup>Broad Institute of MIT and Harvard, Cambridge, MA 02141, USA, <sup>3</sup>Beijing Institute of Genomics, Chinese Academy of Science, Beijing 100029, China, <sup>4</sup>Department of Computer Science, University of California Los Angeles, Los Angeles, CA 90095, <sup>5</sup>Department of Biology, Boston College, Chestnut Hill, MA 02467, <sup>6</sup>Center for Statistical Genetics, Department of Biostatistics, University of Michigan, Ann Arbor, MI 48109, USA and <sup>7</sup><ext-link ext-link-type="uri" xlink:href="http://1000genomes.org">http://1000genomes.org</ext-link></aff>
    <author-notes>
      <corresp id="COR1"><sup>*</sup>To whom correspondence should be addressed.</corresp>
      <fn id="FN1">
        <p><sup>†</sup>The authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors.</p>
      </fn>
      <fn>
        <p>Associate Editor: Alfonso Valencia</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>8</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>8</day>
      <month>6</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>8</day>
      <month>6</month>
      <year>2009</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>25</volume>
    <issue>16</issue>
    <fpage>2078</fpage>
    <lpage>2079</lpage>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>4</month>
        <year>2009</year>
      </date>
      <date date-type="rev-recd">
        <day>28</day>
        <month>5</month>
        <year>2009</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>5</month>
        <year>2009</year>
      </date>
    </history>
    <permissions>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Summary:</bold> The Sequence Alignment/Map (SAM) format is a generic alignment format for storing read alignments against reference sequences, supporting short and long reads (up to 128 Mbp) produced by different sequencing platforms. It is flexible in style, compact in size, efficient in random access and is the format in which alignments from the 1000 Genomes Project are released. SAMtools implements various utilities for post-processing alignments in the SAM format, such as indexing, variant caller and alignment viewer, and thus provides universal tools for processing read alignments.</p>
      <p>
        <bold>Availability:</bold>
        <ext-link ext-link-type="uri" xlink:href="http://samtools.sourceforge.net">http://samtools.sourceforge.net</ext-link>
      </p>
      <p>
        <bold>Contact:</bold>
        <email>rd@sanger.ac.uk</email>
      </p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>1 INTRODUCTION</title>
    <p>With the advent of novel sequencing technologies such as Illumina/Solexa, AB/SOLiD and Roche/454 (Mardis, <xref ref-type="bibr" rid="B4">2008</xref>), a variety of new alignment tools (Langmead <italic>et al.</italic>, <xref ref-type="bibr" rid="B2">2009</xref>; Li <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">2008</xref>) have been designed to realize efficient read mapping against large reference sequences, including the human genome. These tools generate alignments in different formats, however, complicating downstream processing. A common alignment format that supports all sequence types and aligners creates a well-defined interface between alignment and downstream analyses, including variant detection, genotyping and assembly.</p>
    <p>The Sequence Alignment/Map (SAM) format is designed to achieve this goal. It supports single- and paired-end reads and combining reads of different types, including color space reads from AB/SOLiD. It is designed to scale to alignment sets of 10<sup>11</sup> or more base pairs, which is typical for the deep resequencing of one human individual.</p>
    <p>In this article, we present an overview of the SAM format and briefly introduce the companion SAMtools software package. A detailed format specification and the complete documentation of SAMtools are available at the SAMtools web site.</p>
  </sec>
  <sec sec-type="methods" id="SEC2">
    <title>2 METHODS</title>
    <sec id="SEC2.1">
      <title>2.1 The SAM format</title>
      <sec id="SEC2.1.1">
        <title>2.1.1 Overview of the SAM format</title>
        <p>The SAM format consists of one header section and one alignment section. The lines in the header section start with character ‘<monospace>@</monospace>’, and lines in the alignment section do not. All lines are TAB delimited. An example is shown in <xref ref-type="fig" rid="F1">Figure 1</xref>b.
<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>Example of extended CIGAR and the pileup output. (<bold>a</bold>) Alignments of one pair of reads and three single-end reads. (<bold>b</bold>) The corresponding SAM file. The ‘<monospace>@SQ</monospace>’ line in the header section gives the order of reference sequences. Notably, <monospace>r001</monospace> is the name of a read pair. According to <monospace>FLAG</monospace> 163 (=1 + 2 + 32 + 128), the read mapped to position 7 is the second read in the pair (128) and regarded as properly paired (1 + 2); its mate is mapped to 37 on the reverse strand (32). Read <monospace>r002</monospace> has three soft-clipped (unaligned) bases. The coordinate shown in SAM is the position of the first aligned base. The CIGAR string for this alignment contains a <monospace>P</monospace> (padding) operation which correctly aligns the inserted sequences. Padding operations can be absent when an aligner does not support multiple sequence alignment. The last six bases of read <monospace>r003</monospace> map to position 9, and the first five to position 29 on the reverse strand. The hard clipping operation <monospace>H</monospace> indicates that the clipped sequence is not present in the sequence field. The <monospace>NM</monospace> tag gives the number of mismatches. Read <monospace>r004</monospace> is aligned across an intron, indicated by the <monospace>N</monospace> operation. (<bold>c</bold>) Simplified pileup output by SAMtools. Each line consists of reference name, sorted coordinate, reference base, the number of reads covering the position and read bases. In the fifth field, a dot or a comma denotes a base identical to the reference; a dot or a capital letter denotes a base from a read mapped on the forward strand, while a comma or a lowercase letter on the reverse strand.</p></caption><graphic xlink:href="btp352f1"/></fig>
</p>
        <p>In SAM, each alignment line has 11 mandatory fields and a variable number of optional fields. The mandatory fields are briefly described in <xref ref-type="table" rid="T1">Table 1</xref>. They must be present but their value can be a ‘<monospace>⋆</monospace>’ or a zero (depending on the field) if the corresponding information is unavailable. The optional fields are presented as key-value pairs in the format of <monospace>TAG:TYPE:VALUE</monospace>. They store extra information from the platform or aligner. For example, the ‘<monospace>RG</monospace>’ tag keeps the ‘read group’ information for each read. In combination with the ‘<monospace>@RG</monospace>’ header lines, this tag allows each read to be labeled with metadata about its origin, sequencing center and library. The SAM format specification gives a detailed description of each field and the predefined <monospace>TAG</monospace>s.</p>
      </sec>
      <sec id="SEC2.1.2">
        <title>2.1.2 Extended CIGAR</title>
        <p>The standard CIGAR description of pairwise alignment defines three operations: ‘<monospace>M</monospace>’ for match/mismatch, ‘<monospace>I</monospace>’ for insertion compared with the reference and ‘<monospace>D</monospace>’ for deletion. The extended CIGAR proposed in SAM added four more operations: ‘<monospace>N</monospace>’ for skipped bases on the reference, ‘<monospace>S</monospace>’ for soft clipping, ‘<monospace>H</monospace>’ for hard clipping and ‘<monospace>P</monospace>’ for padding. These support splicing, clipping, multi-part and padded alignments. <xref ref-type="fig" rid="F1">Figure 1</xref> shows examples of CIGAR strings for different types of alignments.</p>
      </sec>
      <sec id="SEC2.1.3">
        <title>2.1.3 Binary Alignment/Map format</title>
        <p>To improve the performance, we designed a companion format Binary Alignment/Map (BAM), which is the binary representation of SAM and keeps exactly the same information as SAM. BAM is compressed by the BGZF library, a generic library developed by us to achieve fast random access in a zlib-compatible compressed file. An example alignment of 112 Gbp of Illumina GA data requires 116 GB of disk space (1.0 byte per input base), including sequences, base qualities and all the meta information generated by MAQ. Most of this space is used to store the base qualities.</p>
      </sec>
      <sec id="SEC2.1.4">
        <title>2.1.4 Sorting and indexing</title>
        <p>A SAM/BAM file can be unsorted, but sorting by coordinate is used to streamline data processing and to avoid loading extra alignments into memory. A position-sorted BAM file can be indexed. We combine the UCSC binning scheme (Kent <italic>et al.</italic>, <xref ref-type="bibr" rid="B1">2002</xref>) and simple linear indexing to achieve fast random retrieval of alignments overlapping a specified chromosomal region. In most cases, only one seek call is needed to retrieve alignments in a region.</p>
      </sec>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 SAMtools software package</title>
      <p>SAMtools is a library and software package for parsing and manipulating alignments in the SAM/BAM format. It is able to convert from other alignment formats, sort and merge alignments, remove PCR duplicates, generate per-position information in the pileup format (<xref ref-type="fig" rid="F1">Fig. 1</xref>c), call SNPs and short indel variants, and show alignments in a text-based viewer. For the example alignment of 112 Gbp Illumina GA data, SAMtools took about 10 h to convert from the MAQ format and 40 min to index with &lt;30 MB memory. Conversion is slower mainly because compression with zlib is slower than decompression. External sorting writes temporary BAM files and would typically be twice as slow as conversion.</p>
      <p>SAMtools has two separate implementations, one in C and the other in Java, with slightly different functionality.
<table-wrap id="T1" position="float"><label>Table 1.</label><caption><p>Mandatory fields in the SAM format</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th align="left" rowspan="1" colspan="1">No.</th><th align="left" rowspan="1" colspan="1">Name</th><th align="left" rowspan="1" colspan="1">Description</th></tr></thead><tbody align="left"><tr><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1"><monospace>QNAME</monospace></td><td align="left" rowspan="1" colspan="1">Query NAME of the read or the read pair</td></tr><tr><td align="left" rowspan="1" colspan="1">2</td><td align="left" rowspan="1" colspan="1"><monospace>FLAG</monospace></td><td align="left" rowspan="1" colspan="1">Bitwise FLAG (pairing, strand, mate strand, etc.)</td></tr><tr><td align="left" rowspan="1" colspan="1">3</td><td align="left" rowspan="1" colspan="1"><monospace>RNAME</monospace></td><td align="left" rowspan="1" colspan="1">Reference sequence NAME</td></tr><tr><td align="left" rowspan="1" colspan="1">4</td><td align="left" rowspan="1" colspan="1"><monospace>POS</monospace></td><td align="left" rowspan="1" colspan="1">1-Based leftmost POSition of clipped alignment</td></tr><tr><td align="left" rowspan="1" colspan="1">5</td><td align="left" rowspan="1" colspan="1"><monospace>MAPQ</monospace></td><td align="left" rowspan="1" colspan="1">MAPping Quality (Phred-scaled)</td></tr><tr><td align="left" rowspan="1" colspan="1">6</td><td align="left" rowspan="1" colspan="1"><monospace>CIGAR</monospace></td><td align="left" rowspan="1" colspan="1">Extended CIGAR string (operations: <monospace>MIDNSHP</monospace>)</td></tr><tr><td align="left" rowspan="1" colspan="1">7</td><td align="left" rowspan="1" colspan="1"><monospace>MRNM</monospace></td><td align="left" rowspan="1" colspan="1">Mate Reference NaMe (‘=’ if same as <monospace>RNAME</monospace>)</td></tr><tr><td align="left" rowspan="1" colspan="1">8</td><td align="left" rowspan="1" colspan="1"><monospace>MPOS</monospace></td><td align="left" rowspan="1" colspan="1">1-Based leftmost Mate POSition</td></tr><tr><td align="left" rowspan="1" colspan="1">9</td><td align="left" rowspan="1" colspan="1"><monospace>ISIZE</monospace></td><td align="left" rowspan="1" colspan="1">Inferred Insert SIZE</td></tr><tr><td align="left" rowspan="1" colspan="1">10</td><td align="left" rowspan="1" colspan="1"><monospace>SEQ</monospace></td><td align="left" rowspan="1" colspan="1">Query SEQuence on the same strand as the reference</td></tr><tr><td align="left" rowspan="1" colspan="1">11</td><td align="left" rowspan="1" colspan="1"><monospace>QUAL</monospace></td><td align="left" rowspan="1" colspan="1">Query QUALity (ASCII-33=Phred base quality)</td></tr></tbody></table></table-wrap>
</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="SEC3">
    <title>3 CONCLUSIONS</title>
    <p>We designed and implemented a generic alignment format, SAM, which is simple to work with and flexible enough to keep most information from various sequencing platforms and read aligners. The equivalent binary representation, BAM, is compact in size and supports fast retrieval of alignments in specified regions. Using positional sorting and indexing, applications can perform stream-based processing on specific genomic regions without loading the entire file into memory. The SAM/BAM format, together with SAMtools, separates the alignment step from downstream analyses, enabling a generic and modular approach to the analysis of genomic sequencing data.</p>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>We are grateful to James Bonfield for the comments on indexing and to SAMtools users for testing the software as it has matured.</p>
    <p><italic>Funding</italic>: Wellcome Trust/077192/Z/05/Z; <funding-source>NIH</funding-source> Hapmap/1000 Genomes Project grant (U54HG002750 to B.H.).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>WJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The human genome browser at UCSC</article-title>
        <source>Genome Res.</source>
        <year>2002</year>
        <volume>12</volume>
        <fpage>996</fpage>
        <lpage>1006</lpage>
        <pub-id pub-id-type="pmid">12045153</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title>
        <source>Genome Biol.</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>R25</fpage>
        <pub-id pub-id-type="pmid">19261174</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mapping short DNA sequencing reads and calling variants using mapping quality scores</article-title>
        <source>Genome Res.</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>1851</fpage>
        <lpage>1858</lpage>
        <pub-id pub-id-type="pmid">18714091</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mardis</surname>
            <given-names>ER</given-names>
          </name>
        </person-group>
        <article-title>Next-generation DNA sequencing methods</article-title>
        <source>Annu. Rev. Genomics Hum. Genet.</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>387</fpage>
        <lpage>402</lpage>
        <pub-id pub-id-type="pmid">18576944</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1460-2059</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2723002</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btp352</article-id>
    <article-id pub-id-type="publisher-id">btp352</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group>
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>The Sequence Alignment/Map format and SAMtools</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Heng</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="author-notes" rid="FN1">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Handsaker</surname>
          <given-names>Bob</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="author-notes" rid="FN1">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wysoker</surname>
          <given-names>Alec</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fennell</surname>
          <given-names>Tim</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ruan</surname>
          <given-names>Jue</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Homer</surname>
          <given-names>Nils</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Marth</surname>
          <given-names>Gabor</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Abecasis</surname>
          <given-names>Goncalo</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>6</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Durbin</surname>
          <given-names>Richard</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">
          <sup>*</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <collab>1000 Genome Project Data Processing Subgroup</collab>
        <xref ref-type="aff" rid="AFF1">
          <sup>7</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><sup>1</sup> Wellcome Trust Sanger Institute, Wellcome Trust Genome Campus, Cambridge, CB10 1SA, UK, <sup>2</sup>Broad Institute of MIT and Harvard, Cambridge, MA 02141, USA, <sup>3</sup>Beijing Institute of Genomics, Chinese Academy of Science, Beijing 100029, China, <sup>4</sup>Department of Computer Science, University of California Los Angeles, Los Angeles, CA 90095, <sup>5</sup>Department of Biology, Boston College, Chestnut Hill, MA 02467, <sup>6</sup>Center for Statistical Genetics, Department of Biostatistics, University of Michigan, Ann Arbor, MI 48109, USA and <sup>7</sup><ext-link ext-link-type="uri" xlink:href="http://1000genomes.org">http://1000genomes.org</ext-link></aff>
    <author-notes>
      <corresp id="COR1"><sup>*</sup>To whom correspondence should be addressed.</corresp>
      <fn id="FN1">
        <p><sup>†</sup>The authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors.</p>
      </fn>
      <fn>
        <p>Associate Editor: Alfonso Valencia</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>8</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>8</day>
      <month>6</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>8</day>
      <month>6</month>
      <year>2009</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>25</volume>
    <issue>16</issue>
    <fpage>2078</fpage>
    <lpage>2079</lpage>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>4</month>
        <year>2009</year>
      </date>
      <date date-type="rev-recd">
        <day>28</day>
        <month>5</month>
        <year>2009</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>5</month>
        <year>2009</year>
      </date>
    </history>
    <permissions>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Summary:</bold> The Sequence Alignment/Map (SAM) format is a generic alignment format for storing read alignments against reference sequences, supporting short and long reads (up to 128 Mbp) produced by different sequencing platforms. It is flexible in style, compact in size, efficient in random access and is the format in which alignments from the 1000 Genomes Project are released. SAMtools implements various utilities for post-processing alignments in the SAM format, such as indexing, variant caller and alignment viewer, and thus provides universal tools for processing read alignments.</p>
      <p>
        <bold>Availability:</bold>
        <ext-link ext-link-type="uri" xlink:href="http://samtools.sourceforge.net">http://samtools.sourceforge.net</ext-link>
      </p>
      <p>
        <bold>Contact:</bold>
        <email>rd@sanger.ac.uk</email>
      </p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>1 INTRODUCTION</title>
    <p>With the advent of novel sequencing technologies such as Illumina/Solexa, AB/SOLiD and Roche/454 (Mardis, <xref ref-type="bibr" rid="B4">2008</xref>), a variety of new alignment tools (Langmead <italic>et al.</italic>, <xref ref-type="bibr" rid="B2">2009</xref>; Li <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">2008</xref>) have been designed to realize efficient read mapping against large reference sequences, including the human genome. These tools generate alignments in different formats, however, complicating downstream processing. A common alignment format that supports all sequence types and aligners creates a well-defined interface between alignment and downstream analyses, including variant detection, genotyping and assembly.</p>
    <p>The Sequence Alignment/Map (SAM) format is designed to achieve this goal. It supports single- and paired-end reads and combining reads of different types, including color space reads from AB/SOLiD. It is designed to scale to alignment sets of 10<sup>11</sup> or more base pairs, which is typical for the deep resequencing of one human individual.</p>
    <p>In this article, we present an overview of the SAM format and briefly introduce the companion SAMtools software package. A detailed format specification and the complete documentation of SAMtools are available at the SAMtools web site.</p>
  </sec>
  <sec sec-type="methods" id="SEC2">
    <title>2 METHODS</title>
    <sec id="SEC2.1">
      <title>2.1 The SAM format</title>
      <sec id="SEC2.1.1">
        <title>2.1.1 Overview of the SAM format</title>
        <p>The SAM format consists of one header section and one alignment section. The lines in the header section start with character ‘<monospace>@</monospace>’, and lines in the alignment section do not. All lines are TAB delimited. An example is shown in <xref ref-type="fig" rid="F1">Figure 1</xref>b.
<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>Example of extended CIGAR and the pileup output. (<bold>a</bold>) Alignments of one pair of reads and three single-end reads. (<bold>b</bold>) The corresponding SAM file. The ‘<monospace>@SQ</monospace>’ line in the header section gives the order of reference sequences. Notably, <monospace>r001</monospace> is the name of a read pair. According to <monospace>FLAG</monospace> 163 (=1 + 2 + 32 + 128), the read mapped to position 7 is the second read in the pair (128) and regarded as properly paired (1 + 2); its mate is mapped to 37 on the reverse strand (32). Read <monospace>r002</monospace> has three soft-clipped (unaligned) bases. The coordinate shown in SAM is the position of the first aligned base. The CIGAR string for this alignment contains a <monospace>P</monospace> (padding) operation which correctly aligns the inserted sequences. Padding operations can be absent when an aligner does not support multiple sequence alignment. The last six bases of read <monospace>r003</monospace> map to position 9, and the first five to position 29 on the reverse strand. The hard clipping operation <monospace>H</monospace> indicates that the clipped sequence is not present in the sequence field. The <monospace>NM</monospace> tag gives the number of mismatches. Read <monospace>r004</monospace> is aligned across an intron, indicated by the <monospace>N</monospace> operation. (<bold>c</bold>) Simplified pileup output by SAMtools. Each line consists of reference name, sorted coordinate, reference base, the number of reads covering the position and read bases. In the fifth field, a dot or a comma denotes a base identical to the reference; a dot or a capital letter denotes a base from a read mapped on the forward strand, while a comma or a lowercase letter on the reverse strand.</p></caption><graphic xlink:href="btp352f1"/></fig>
</p>
        <p>In SAM, each alignment line has 11 mandatory fields and a variable number of optional fields. The mandatory fields are briefly described in <xref ref-type="table" rid="T1">Table 1</xref>. They must be present but their value can be a ‘<monospace>⋆</monospace>’ or a zero (depending on the field) if the corresponding information is unavailable. The optional fields are presented as key-value pairs in the format of <monospace>TAG:TYPE:VALUE</monospace>. They store extra information from the platform or aligner. For example, the ‘<monospace>RG</monospace>’ tag keeps the ‘read group’ information for each read. In combination with the ‘<monospace>@RG</monospace>’ header lines, this tag allows each read to be labeled with metadata about its origin, sequencing center and library. The SAM format specification gives a detailed description of each field and the predefined <monospace>TAG</monospace>s.</p>
      </sec>
      <sec id="SEC2.1.2">
        <title>2.1.2 Extended CIGAR</title>
        <p>The standard CIGAR description of pairwise alignment defines three operations: ‘<monospace>M</monospace>’ for match/mismatch, ‘<monospace>I</monospace>’ for insertion compared with the reference and ‘<monospace>D</monospace>’ for deletion. The extended CIGAR proposed in SAM added four more operations: ‘<monospace>N</monospace>’ for skipped bases on the reference, ‘<monospace>S</monospace>’ for soft clipping, ‘<monospace>H</monospace>’ for hard clipping and ‘<monospace>P</monospace>’ for padding. These support splicing, clipping, multi-part and padded alignments. <xref ref-type="fig" rid="F1">Figure 1</xref> shows examples of CIGAR strings for different types of alignments.</p>
      </sec>
      <sec id="SEC2.1.3">
        <title>2.1.3 Binary Alignment/Map format</title>
        <p>To improve the performance, we designed a companion format Binary Alignment/Map (BAM), which is the binary representation of SAM and keeps exactly the same information as SAM. BAM is compressed by the BGZF library, a generic library developed by us to achieve fast random access in a zlib-compatible compressed file. An example alignment of 112 Gbp of Illumina GA data requires 116 GB of disk space (1.0 byte per input base), including sequences, base qualities and all the meta information generated by MAQ. Most of this space is used to store the base qualities.</p>
      </sec>
      <sec id="SEC2.1.4">
        <title>2.1.4 Sorting and indexing</title>
        <p>A SAM/BAM file can be unsorted, but sorting by coordinate is used to streamline data processing and to avoid loading extra alignments into memory. A position-sorted BAM file can be indexed. We combine the UCSC binning scheme (Kent <italic>et al.</italic>, <xref ref-type="bibr" rid="B1">2002</xref>) and simple linear indexing to achieve fast random retrieval of alignments overlapping a specified chromosomal region. In most cases, only one seek call is needed to retrieve alignments in a region.</p>
      </sec>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 SAMtools software package</title>
      <p>SAMtools is a library and software package for parsing and manipulating alignments in the SAM/BAM format. It is able to convert from other alignment formats, sort and merge alignments, remove PCR duplicates, generate per-position information in the pileup format (<xref ref-type="fig" rid="F1">Fig. 1</xref>c), call SNPs and short indel variants, and show alignments in a text-based viewer. For the example alignment of 112 Gbp Illumina GA data, SAMtools took about 10 h to convert from the MAQ format and 40 min to index with &lt;30 MB memory. Conversion is slower mainly because compression with zlib is slower than decompression. External sorting writes temporary BAM files and would typically be twice as slow as conversion.</p>
      <p>SAMtools has two separate implementations, one in C and the other in Java, with slightly different functionality.
<table-wrap id="T1" position="float"><label>Table 1.</label><caption><p>Mandatory fields in the SAM format</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th align="left" rowspan="1" colspan="1">No.</th><th align="left" rowspan="1" colspan="1">Name</th><th align="left" rowspan="1" colspan="1">Description</th></tr></thead><tbody align="left"><tr><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1"><monospace>QNAME</monospace></td><td align="left" rowspan="1" colspan="1">Query NAME of the read or the read pair</td></tr><tr><td align="left" rowspan="1" colspan="1">2</td><td align="left" rowspan="1" colspan="1"><monospace>FLAG</monospace></td><td align="left" rowspan="1" colspan="1">Bitwise FLAG (pairing, strand, mate strand, etc.)</td></tr><tr><td align="left" rowspan="1" colspan="1">3</td><td align="left" rowspan="1" colspan="1"><monospace>RNAME</monospace></td><td align="left" rowspan="1" colspan="1">Reference sequence NAME</td></tr><tr><td align="left" rowspan="1" colspan="1">4</td><td align="left" rowspan="1" colspan="1"><monospace>POS</monospace></td><td align="left" rowspan="1" colspan="1">1-Based leftmost POSition of clipped alignment</td></tr><tr><td align="left" rowspan="1" colspan="1">5</td><td align="left" rowspan="1" colspan="1"><monospace>MAPQ</monospace></td><td align="left" rowspan="1" colspan="1">MAPping Quality (Phred-scaled)</td></tr><tr><td align="left" rowspan="1" colspan="1">6</td><td align="left" rowspan="1" colspan="1"><monospace>CIGAR</monospace></td><td align="left" rowspan="1" colspan="1">Extended CIGAR string (operations: <monospace>MIDNSHP</monospace>)</td></tr><tr><td align="left" rowspan="1" colspan="1">7</td><td align="left" rowspan="1" colspan="1"><monospace>MRNM</monospace></td><td align="left" rowspan="1" colspan="1">Mate Reference NaMe (‘=’ if same as <monospace>RNAME</monospace>)</td></tr><tr><td align="left" rowspan="1" colspan="1">8</td><td align="left" rowspan="1" colspan="1"><monospace>MPOS</monospace></td><td align="left" rowspan="1" colspan="1">1-Based leftmost Mate POSition</td></tr><tr><td align="left" rowspan="1" colspan="1">9</td><td align="left" rowspan="1" colspan="1"><monospace>ISIZE</monospace></td><td align="left" rowspan="1" colspan="1">Inferred Insert SIZE</td></tr><tr><td align="left" rowspan="1" colspan="1">10</td><td align="left" rowspan="1" colspan="1"><monospace>SEQ</monospace></td><td align="left" rowspan="1" colspan="1">Query SEQuence on the same strand as the reference</td></tr><tr><td align="left" rowspan="1" colspan="1">11</td><td align="left" rowspan="1" colspan="1"><monospace>QUAL</monospace></td><td align="left" rowspan="1" colspan="1">Query QUALity (ASCII-33=Phred base quality)</td></tr></tbody></table></table-wrap>
</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="SEC3">
    <title>3 CONCLUSIONS</title>
    <p>We designed and implemented a generic alignment format, SAM, which is simple to work with and flexible enough to keep most information from various sequencing platforms and read aligners. The equivalent binary representation, BAM, is compact in size and supports fast retrieval of alignments in specified regions. Using positional sorting and indexing, applications can perform stream-based processing on specific genomic regions without loading the entire file into memory. The SAM/BAM format, together with SAMtools, separates the alignment step from downstream analyses, enabling a generic and modular approach to the analysis of genomic sequencing data.</p>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>We are grateful to James Bonfield for the comments on indexing and to SAMtools users for testing the software as it has matured.</p>
    <p><italic>Funding</italic>: Wellcome Trust/077192/Z/05/Z; <funding-source>NIH</funding-source> Hapmap/1000 Genomes Project grant (U54HG002750 to B.H.).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>WJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The human genome browser at UCSC</article-title>
        <source>Genome Res.</source>
        <year>2002</year>
        <volume>12</volume>
        <fpage>996</fpage>
        <lpage>1006</lpage>
        <pub-id pub-id-type="pmid">12045153</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title>
        <source>Genome Biol.</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>R25</fpage>
        <pub-id pub-id-type="pmid">19261174</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mapping short DNA sequencing reads and calling variants using mapping quality scores</article-title>
        <source>Genome Res.</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>1851</fpage>
        <lpage>1858</lpage>
        <pub-id pub-id-type="pmid">18714091</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mardis</surname>
            <given-names>ER</given-names>
          </name>
        </person-group>
        <article-title>Next-generation DNA sequencing methods</article-title>
        <source>Annu. Rev. Genomics Hum. Genet.</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>387</fpage>
        <lpage>402</lpage>
        <pub-id pub-id-type="pmid">18576944</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1460-2059</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2723002</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btp352</article-id>
    <article-id pub-id-type="publisher-id">btp352</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group>
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>The Sequence Alignment/Map format and SAMtools</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Heng</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="author-notes" rid="FN1">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Handsaker</surname>
          <given-names>Bob</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="author-notes" rid="FN1">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wysoker</surname>
          <given-names>Alec</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fennell</surname>
          <given-names>Tim</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ruan</surname>
          <given-names>Jue</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Homer</surname>
          <given-names>Nils</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Marth</surname>
          <given-names>Gabor</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Abecasis</surname>
          <given-names>Goncalo</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>6</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Durbin</surname>
          <given-names>Richard</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">
          <sup>*</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <collab>1000 Genome Project Data Processing Subgroup</collab>
        <xref ref-type="aff" rid="AFF1">
          <sup>7</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><sup>1</sup> Wellcome Trust Sanger Institute, Wellcome Trust Genome Campus, Cambridge, CB10 1SA, UK, <sup>2</sup>Broad Institute of MIT and Harvard, Cambridge, MA 02141, USA, <sup>3</sup>Beijing Institute of Genomics, Chinese Academy of Science, Beijing 100029, China, <sup>4</sup>Department of Computer Science, University of California Los Angeles, Los Angeles, CA 90095, <sup>5</sup>Department of Biology, Boston College, Chestnut Hill, MA 02467, <sup>6</sup>Center for Statistical Genetics, Department of Biostatistics, University of Michigan, Ann Arbor, MI 48109, USA and <sup>7</sup><ext-link ext-link-type="uri" xlink:href="http://1000genomes.org">http://1000genomes.org</ext-link></aff>
    <author-notes>
      <corresp id="COR1"><sup>*</sup>To whom correspondence should be addressed.</corresp>
      <fn id="FN1">
        <p><sup>†</sup>The authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors.</p>
      </fn>
      <fn>
        <p>Associate Editor: Alfonso Valencia</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>8</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>8</day>
      <month>6</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>8</day>
      <month>6</month>
      <year>2009</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>25</volume>
    <issue>16</issue>
    <fpage>2078</fpage>
    <lpage>2079</lpage>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>4</month>
        <year>2009</year>
      </date>
      <date date-type="rev-recd">
        <day>28</day>
        <month>5</month>
        <year>2009</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>5</month>
        <year>2009</year>
      </date>
    </history>
    <permissions>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Summary:</bold> The Sequence Alignment/Map (SAM) format is a generic alignment format for storing read alignments against reference sequences, supporting short and long reads (up to 128 Mbp) produced by different sequencing platforms. It is flexible in style, compact in size, efficient in random access and is the format in which alignments from the 1000 Genomes Project are released. SAMtools implements various utilities for post-processing alignments in the SAM format, such as indexing, variant caller and alignment viewer, and thus provides universal tools for processing read alignments.</p>
      <p>
        <bold>Availability:</bold>
        <ext-link ext-link-type="uri" xlink:href="http://samtools.sourceforge.net">http://samtools.sourceforge.net</ext-link>
      </p>
      <p>
        <bold>Contact:</bold>
        <email>rd@sanger.ac.uk</email>
      </p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>1 INTRODUCTION</title>
    <p>With the advent of novel sequencing technologies such as Illumina/Solexa, AB/SOLiD and Roche/454 (Mardis, <xref ref-type="bibr" rid="B4">2008</xref>), a variety of new alignment tools (Langmead <italic>et al.</italic>, <xref ref-type="bibr" rid="B2">2009</xref>; Li <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">2008</xref>) have been designed to realize efficient read mapping against large reference sequences, including the human genome. These tools generate alignments in different formats, however, complicating downstream processing. A common alignment format that supports all sequence types and aligners creates a well-defined interface between alignment and downstream analyses, including variant detection, genotyping and assembly.</p>
    <p>The Sequence Alignment/Map (SAM) format is designed to achieve this goal. It supports single- and paired-end reads and combining reads of different types, including color space reads from AB/SOLiD. It is designed to scale to alignment sets of 10<sup>11</sup> or more base pairs, which is typical for the deep resequencing of one human individual.</p>
    <p>In this article, we present an overview of the SAM format and briefly introduce the companion SAMtools software package. A detailed format specification and the complete documentation of SAMtools are available at the SAMtools web site.</p>
  </sec>
  <sec sec-type="methods" id="SEC2">
    <title>2 METHODS</title>
    <sec id="SEC2.1">
      <title>2.1 The SAM format</title>
      <sec id="SEC2.1.1">
        <title>2.1.1 Overview of the SAM format</title>
        <p>The SAM format consists of one header section and one alignment section. The lines in the header section start with character ‘<monospace>@</monospace>’, and lines in the alignment section do not. All lines are TAB delimited. An example is shown in <xref ref-type="fig" rid="F1">Figure 1</xref>b.
<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>Example of extended CIGAR and the pileup output. (<bold>a</bold>) Alignments of one pair of reads and three single-end reads. (<bold>b</bold>) The corresponding SAM file. The ‘<monospace>@SQ</monospace>’ line in the header section gives the order of reference sequences. Notably, <monospace>r001</monospace> is the name of a read pair. According to <monospace>FLAG</monospace> 163 (=1 + 2 + 32 + 128), the read mapped to position 7 is the second read in the pair (128) and regarded as properly paired (1 + 2); its mate is mapped to 37 on the reverse strand (32). Read <monospace>r002</monospace> has three soft-clipped (unaligned) bases. The coordinate shown in SAM is the position of the first aligned base. The CIGAR string for this alignment contains a <monospace>P</monospace> (padding) operation which correctly aligns the inserted sequences. Padding operations can be absent when an aligner does not support multiple sequence alignment. The last six bases of read <monospace>r003</monospace> map to position 9, and the first five to position 29 on the reverse strand. The hard clipping operation <monospace>H</monospace> indicates that the clipped sequence is not present in the sequence field. The <monospace>NM</monospace> tag gives the number of mismatches. Read <monospace>r004</monospace> is aligned across an intron, indicated by the <monospace>N</monospace> operation. (<bold>c</bold>) Simplified pileup output by SAMtools. Each line consists of reference name, sorted coordinate, reference base, the number of reads covering the position and read bases. In the fifth field, a dot or a comma denotes a base identical to the reference; a dot or a capital letter denotes a base from a read mapped on the forward strand, while a comma or a lowercase letter on the reverse strand.</p></caption><graphic xlink:href="btp352f1"/></fig>
</p>
        <p>In SAM, each alignment line has 11 mandatory fields and a variable number of optional fields. The mandatory fields are briefly described in <xref ref-type="table" rid="T1">Table 1</xref>. They must be present but their value can be a ‘<monospace>⋆</monospace>’ or a zero (depending on the field) if the corresponding information is unavailable. The optional fields are presented as key-value pairs in the format of <monospace>TAG:TYPE:VALUE</monospace>. They store extra information from the platform or aligner. For example, the ‘<monospace>RG</monospace>’ tag keeps the ‘read group’ information for each read. In combination with the ‘<monospace>@RG</monospace>’ header lines, this tag allows each read to be labeled with metadata about its origin, sequencing center and library. The SAM format specification gives a detailed description of each field and the predefined <monospace>TAG</monospace>s.</p>
      </sec>
      <sec id="SEC2.1.2">
        <title>2.1.2 Extended CIGAR</title>
        <p>The standard CIGAR description of pairwise alignment defines three operations: ‘<monospace>M</monospace>’ for match/mismatch, ‘<monospace>I</monospace>’ for insertion compared with the reference and ‘<monospace>D</monospace>’ for deletion. The extended CIGAR proposed in SAM added four more operations: ‘<monospace>N</monospace>’ for skipped bases on the reference, ‘<monospace>S</monospace>’ for soft clipping, ‘<monospace>H</monospace>’ for hard clipping and ‘<monospace>P</monospace>’ for padding. These support splicing, clipping, multi-part and padded alignments. <xref ref-type="fig" rid="F1">Figure 1</xref> shows examples of CIGAR strings for different types of alignments.</p>
      </sec>
      <sec id="SEC2.1.3">
        <title>2.1.3 Binary Alignment/Map format</title>
        <p>To improve the performance, we designed a companion format Binary Alignment/Map (BAM), which is the binary representation of SAM and keeps exactly the same information as SAM. BAM is compressed by the BGZF library, a generic library developed by us to achieve fast random access in a zlib-compatible compressed file. An example alignment of 112 Gbp of Illumina GA data requires 116 GB of disk space (1.0 byte per input base), including sequences, base qualities and all the meta information generated by MAQ. Most of this space is used to store the base qualities.</p>
      </sec>
      <sec id="SEC2.1.4">
        <title>2.1.4 Sorting and indexing</title>
        <p>A SAM/BAM file can be unsorted, but sorting by coordinate is used to streamline data processing and to avoid loading extra alignments into memory. A position-sorted BAM file can be indexed. We combine the UCSC binning scheme (Kent <italic>et al.</italic>, <xref ref-type="bibr" rid="B1">2002</xref>) and simple linear indexing to achieve fast random retrieval of alignments overlapping a specified chromosomal region. In most cases, only one seek call is needed to retrieve alignments in a region.</p>
      </sec>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 SAMtools software package</title>
      <p>SAMtools is a library and software package for parsing and manipulating alignments in the SAM/BAM format. It is able to convert from other alignment formats, sort and merge alignments, remove PCR duplicates, generate per-position information in the pileup format (<xref ref-type="fig" rid="F1">Fig. 1</xref>c), call SNPs and short indel variants, and show alignments in a text-based viewer. For the example alignment of 112 Gbp Illumina GA data, SAMtools took about 10 h to convert from the MAQ format and 40 min to index with &lt;30 MB memory. Conversion is slower mainly because compression with zlib is slower than decompression. External sorting writes temporary BAM files and would typically be twice as slow as conversion.</p>
      <p>SAMtools has two separate implementations, one in C and the other in Java, with slightly different functionality.
<table-wrap id="T1" position="float"><label>Table 1.</label><caption><p>Mandatory fields in the SAM format</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th align="left" rowspan="1" colspan="1">No.</th><th align="left" rowspan="1" colspan="1">Name</th><th align="left" rowspan="1" colspan="1">Description</th></tr></thead><tbody align="left"><tr><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1"><monospace>QNAME</monospace></td><td align="left" rowspan="1" colspan="1">Query NAME of the read or the read pair</td></tr><tr><td align="left" rowspan="1" colspan="1">2</td><td align="left" rowspan="1" colspan="1"><monospace>FLAG</monospace></td><td align="left" rowspan="1" colspan="1">Bitwise FLAG (pairing, strand, mate strand, etc.)</td></tr><tr><td align="left" rowspan="1" colspan="1">3</td><td align="left" rowspan="1" colspan="1"><monospace>RNAME</monospace></td><td align="left" rowspan="1" colspan="1">Reference sequence NAME</td></tr><tr><td align="left" rowspan="1" colspan="1">4</td><td align="left" rowspan="1" colspan="1"><monospace>POS</monospace></td><td align="left" rowspan="1" colspan="1">1-Based leftmost POSition of clipped alignment</td></tr><tr><td align="left" rowspan="1" colspan="1">5</td><td align="left" rowspan="1" colspan="1"><monospace>MAPQ</monospace></td><td align="left" rowspan="1" colspan="1">MAPping Quality (Phred-scaled)</td></tr><tr><td align="left" rowspan="1" colspan="1">6</td><td align="left" rowspan="1" colspan="1"><monospace>CIGAR</monospace></td><td align="left" rowspan="1" colspan="1">Extended CIGAR string (operations: <monospace>MIDNSHP</monospace>)</td></tr><tr><td align="left" rowspan="1" colspan="1">7</td><td align="left" rowspan="1" colspan="1"><monospace>MRNM</monospace></td><td align="left" rowspan="1" colspan="1">Mate Reference NaMe (‘=’ if same as <monospace>RNAME</monospace>)</td></tr><tr><td align="left" rowspan="1" colspan="1">8</td><td align="left" rowspan="1" colspan="1"><monospace>MPOS</monospace></td><td align="left" rowspan="1" colspan="1">1-Based leftmost Mate POSition</td></tr><tr><td align="left" rowspan="1" colspan="1">9</td><td align="left" rowspan="1" colspan="1"><monospace>ISIZE</monospace></td><td align="left" rowspan="1" colspan="1">Inferred Insert SIZE</td></tr><tr><td align="left" rowspan="1" colspan="1">10</td><td align="left" rowspan="1" colspan="1"><monospace>SEQ</monospace></td><td align="left" rowspan="1" colspan="1">Query SEQuence on the same strand as the reference</td></tr><tr><td align="left" rowspan="1" colspan="1">11</td><td align="left" rowspan="1" colspan="1"><monospace>QUAL</monospace></td><td align="left" rowspan="1" colspan="1">Query QUALity (ASCII-33=Phred base quality)</td></tr></tbody></table></table-wrap>
</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="SEC3">
    <title>3 CONCLUSIONS</title>
    <p>We designed and implemented a generic alignment format, SAM, which is simple to work with and flexible enough to keep most information from various sequencing platforms and read aligners. The equivalent binary representation, BAM, is compact in size and supports fast retrieval of alignments in specified regions. Using positional sorting and indexing, applications can perform stream-based processing on specific genomic regions without loading the entire file into memory. The SAM/BAM format, together with SAMtools, separates the alignment step from downstream analyses, enabling a generic and modular approach to the analysis of genomic sequencing data.</p>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>We are grateful to James Bonfield for the comments on indexing and to SAMtools users for testing the software as it has matured.</p>
    <p><italic>Funding</italic>: Wellcome Trust/077192/Z/05/Z; <funding-source>NIH</funding-source> Hapmap/1000 Genomes Project grant (U54HG002750 to B.H.).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>WJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The human genome browser at UCSC</article-title>
        <source>Genome Res.</source>
        <year>2002</year>
        <volume>12</volume>
        <fpage>996</fpage>
        <lpage>1006</lpage>
        <pub-id pub-id-type="pmid">12045153</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title>
        <source>Genome Biol.</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>R25</fpage>
        <pub-id pub-id-type="pmid">19261174</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mapping short DNA sequencing reads and calling variants using mapping quality scores</article-title>
        <source>Genome Res.</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>1851</fpage>
        <lpage>1858</lpage>
        <pub-id pub-id-type="pmid">18714091</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mardis</surname>
            <given-names>ER</given-names>
          </name>
        </person-group>
        <article-title>Next-generation DNA sequencing methods</article-title>
        <source>Annu. Rev. Genomics Hum. Genet.</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>387</fpage>
        <lpage>402</lpage>
        <pub-id pub-id-type="pmid">18576944</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1460-2059</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2723002</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btp352</article-id>
    <article-id pub-id-type="publisher-id">btp352</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group>
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>The Sequence Alignment/Map format and SAMtools</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Heng</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="author-notes" rid="FN1">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Handsaker</surname>
          <given-names>Bob</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="author-notes" rid="FN1">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wysoker</surname>
          <given-names>Alec</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fennell</surname>
          <given-names>Tim</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ruan</surname>
          <given-names>Jue</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Homer</surname>
          <given-names>Nils</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Marth</surname>
          <given-names>Gabor</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Abecasis</surname>
          <given-names>Goncalo</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>6</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Durbin</surname>
          <given-names>Richard</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">
          <sup>*</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <collab>1000 Genome Project Data Processing Subgroup</collab>
        <xref ref-type="aff" rid="AFF1">
          <sup>7</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><sup>1</sup> Wellcome Trust Sanger Institute, Wellcome Trust Genome Campus, Cambridge, CB10 1SA, UK, <sup>2</sup>Broad Institute of MIT and Harvard, Cambridge, MA 02141, USA, <sup>3</sup>Beijing Institute of Genomics, Chinese Academy of Science, Beijing 100029, China, <sup>4</sup>Department of Computer Science, University of California Los Angeles, Los Angeles, CA 90095, <sup>5</sup>Department of Biology, Boston College, Chestnut Hill, MA 02467, <sup>6</sup>Center for Statistical Genetics, Department of Biostatistics, University of Michigan, Ann Arbor, MI 48109, USA and <sup>7</sup><ext-link ext-link-type="uri" xlink:href="http://1000genomes.org">http://1000genomes.org</ext-link></aff>
    <author-notes>
      <corresp id="COR1"><sup>*</sup>To whom correspondence should be addressed.</corresp>
      <fn id="FN1">
        <p><sup>†</sup>The authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors.</p>
      </fn>
      <fn>
        <p>Associate Editor: Alfonso Valencia</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>8</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>8</day>
      <month>6</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>8</day>
      <month>6</month>
      <year>2009</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>25</volume>
    <issue>16</issue>
    <fpage>2078</fpage>
    <lpage>2079</lpage>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>4</month>
        <year>2009</year>
      </date>
      <date date-type="rev-recd">
        <day>28</day>
        <month>5</month>
        <year>2009</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>5</month>
        <year>2009</year>
      </date>
    </history>
    <permissions>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Summary:</bold> The Sequence Alignment/Map (SAM) format is a generic alignment format for storing read alignments against reference sequences, supporting short and long reads (up to 128 Mbp) produced by different sequencing platforms. It is flexible in style, compact in size, efficient in random access and is the format in which alignments from the 1000 Genomes Project are released. SAMtools implements various utilities for post-processing alignments in the SAM format, such as indexing, variant caller and alignment viewer, and thus provides universal tools for processing read alignments.</p>
      <p>
        <bold>Availability:</bold>
        <ext-link ext-link-type="uri" xlink:href="http://samtools.sourceforge.net">http://samtools.sourceforge.net</ext-link>
      </p>
      <p>
        <bold>Contact:</bold>
        <email>rd@sanger.ac.uk</email>
      </p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>1 INTRODUCTION</title>
    <p>With the advent of novel sequencing technologies such as Illumina/Solexa, AB/SOLiD and Roche/454 (Mardis, <xref ref-type="bibr" rid="B4">2008</xref>), a variety of new alignment tools (Langmead <italic>et al.</italic>, <xref ref-type="bibr" rid="B2">2009</xref>; Li <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">2008</xref>) have been designed to realize efficient read mapping against large reference sequences, including the human genome. These tools generate alignments in different formats, however, complicating downstream processing. A common alignment format that supports all sequence types and aligners creates a well-defined interface between alignment and downstream analyses, including variant detection, genotyping and assembly.</p>
    <p>The Sequence Alignment/Map (SAM) format is designed to achieve this goal. It supports single- and paired-end reads and combining reads of different types, including color space reads from AB/SOLiD. It is designed to scale to alignment sets of 10<sup>11</sup> or more base pairs, which is typical for the deep resequencing of one human individual.</p>
    <p>In this article, we present an overview of the SAM format and briefly introduce the companion SAMtools software package. A detailed format specification and the complete documentation of SAMtools are available at the SAMtools web site.</p>
  </sec>
  <sec sec-type="methods" id="SEC2">
    <title>2 METHODS</title>
    <sec id="SEC2.1">
      <title>2.1 The SAM format</title>
      <sec id="SEC2.1.1">
        <title>2.1.1 Overview of the SAM format</title>
        <p>The SAM format consists of one header section and one alignment section. The lines in the header section start with character ‘<monospace>@</monospace>’, and lines in the alignment section do not. All lines are TAB delimited. An example is shown in <xref ref-type="fig" rid="F1">Figure 1</xref>b.
<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>Example of extended CIGAR and the pileup output. (<bold>a</bold>) Alignments of one pair of reads and three single-end reads. (<bold>b</bold>) The corresponding SAM file. The ‘<monospace>@SQ</monospace>’ line in the header section gives the order of reference sequences. Notably, <monospace>r001</monospace> is the name of a read pair. According to <monospace>FLAG</monospace> 163 (=1 + 2 + 32 + 128), the read mapped to position 7 is the second read in the pair (128) and regarded as properly paired (1 + 2); its mate is mapped to 37 on the reverse strand (32). Read <monospace>r002</monospace> has three soft-clipped (unaligned) bases. The coordinate shown in SAM is the position of the first aligned base. The CIGAR string for this alignment contains a <monospace>P</monospace> (padding) operation which correctly aligns the inserted sequences. Padding operations can be absent when an aligner does not support multiple sequence alignment. The last six bases of read <monospace>r003</monospace> map to position 9, and the first five to position 29 on the reverse strand. The hard clipping operation <monospace>H</monospace> indicates that the clipped sequence is not present in the sequence field. The <monospace>NM</monospace> tag gives the number of mismatches. Read <monospace>r004</monospace> is aligned across an intron, indicated by the <monospace>N</monospace> operation. (<bold>c</bold>) Simplified pileup output by SAMtools. Each line consists of reference name, sorted coordinate, reference base, the number of reads covering the position and read bases. In the fifth field, a dot or a comma denotes a base identical to the reference; a dot or a capital letter denotes a base from a read mapped on the forward strand, while a comma or a lowercase letter on the reverse strand.</p></caption><graphic xlink:href="btp352f1"/></fig>
</p>
        <p>In SAM, each alignment line has 11 mandatory fields and a variable number of optional fields. The mandatory fields are briefly described in <xref ref-type="table" rid="T1">Table 1</xref>. They must be present but their value can be a ‘<monospace>⋆</monospace>’ or a zero (depending on the field) if the corresponding information is unavailable. The optional fields are presented as key-value pairs in the format of <monospace>TAG:TYPE:VALUE</monospace>. They store extra information from the platform or aligner. For example, the ‘<monospace>RG</monospace>’ tag keeps the ‘read group’ information for each read. In combination with the ‘<monospace>@RG</monospace>’ header lines, this tag allows each read to be labeled with metadata about its origin, sequencing center and library. The SAM format specification gives a detailed description of each field and the predefined <monospace>TAG</monospace>s.</p>
      </sec>
      <sec id="SEC2.1.2">
        <title>2.1.2 Extended CIGAR</title>
        <p>The standard CIGAR description of pairwise alignment defines three operations: ‘<monospace>M</monospace>’ for match/mismatch, ‘<monospace>I</monospace>’ for insertion compared with the reference and ‘<monospace>D</monospace>’ for deletion. The extended CIGAR proposed in SAM added four more operations: ‘<monospace>N</monospace>’ for skipped bases on the reference, ‘<monospace>S</monospace>’ for soft clipping, ‘<monospace>H</monospace>’ for hard clipping and ‘<monospace>P</monospace>’ for padding. These support splicing, clipping, multi-part and padded alignments. <xref ref-type="fig" rid="F1">Figure 1</xref> shows examples of CIGAR strings for different types of alignments.</p>
      </sec>
      <sec id="SEC2.1.3">
        <title>2.1.3 Binary Alignment/Map format</title>
        <p>To improve the performance, we designed a companion format Binary Alignment/Map (BAM), which is the binary representation of SAM and keeps exactly the same information as SAM. BAM is compressed by the BGZF library, a generic library developed by us to achieve fast random access in a zlib-compatible compressed file. An example alignment of 112 Gbp of Illumina GA data requires 116 GB of disk space (1.0 byte per input base), including sequences, base qualities and all the meta information generated by MAQ. Most of this space is used to store the base qualities.</p>
      </sec>
      <sec id="SEC2.1.4">
        <title>2.1.4 Sorting and indexing</title>
        <p>A SAM/BAM file can be unsorted, but sorting by coordinate is used to streamline data processing and to avoid loading extra alignments into memory. A position-sorted BAM file can be indexed. We combine the UCSC binning scheme (Kent <italic>et al.</italic>, <xref ref-type="bibr" rid="B1">2002</xref>) and simple linear indexing to achieve fast random retrieval of alignments overlapping a specified chromosomal region. In most cases, only one seek call is needed to retrieve alignments in a region.</p>
      </sec>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 SAMtools software package</title>
      <p>SAMtools is a library and software package for parsing and manipulating alignments in the SAM/BAM format. It is able to convert from other alignment formats, sort and merge alignments, remove PCR duplicates, generate per-position information in the pileup format (<xref ref-type="fig" rid="F1">Fig. 1</xref>c), call SNPs and short indel variants, and show alignments in a text-based viewer. For the example alignment of 112 Gbp Illumina GA data, SAMtools took about 10 h to convert from the MAQ format and 40 min to index with &lt;30 MB memory. Conversion is slower mainly because compression with zlib is slower than decompression. External sorting writes temporary BAM files and would typically be twice as slow as conversion.</p>
      <p>SAMtools has two separate implementations, one in C and the other in Java, with slightly different functionality.
<table-wrap id="T1" position="float"><label>Table 1.</label><caption><p>Mandatory fields in the SAM format</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th align="left" rowspan="1" colspan="1">No.</th><th align="left" rowspan="1" colspan="1">Name</th><th align="left" rowspan="1" colspan="1">Description</th></tr></thead><tbody align="left"><tr><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1"><monospace>QNAME</monospace></td><td align="left" rowspan="1" colspan="1">Query NAME of the read or the read pair</td></tr><tr><td align="left" rowspan="1" colspan="1">2</td><td align="left" rowspan="1" colspan="1"><monospace>FLAG</monospace></td><td align="left" rowspan="1" colspan="1">Bitwise FLAG (pairing, strand, mate strand, etc.)</td></tr><tr><td align="left" rowspan="1" colspan="1">3</td><td align="left" rowspan="1" colspan="1"><monospace>RNAME</monospace></td><td align="left" rowspan="1" colspan="1">Reference sequence NAME</td></tr><tr><td align="left" rowspan="1" colspan="1">4</td><td align="left" rowspan="1" colspan="1"><monospace>POS</monospace></td><td align="left" rowspan="1" colspan="1">1-Based leftmost POSition of clipped alignment</td></tr><tr><td align="left" rowspan="1" colspan="1">5</td><td align="left" rowspan="1" colspan="1"><monospace>MAPQ</monospace></td><td align="left" rowspan="1" colspan="1">MAPping Quality (Phred-scaled)</td></tr><tr><td align="left" rowspan="1" colspan="1">6</td><td align="left" rowspan="1" colspan="1"><monospace>CIGAR</monospace></td><td align="left" rowspan="1" colspan="1">Extended CIGAR string (operations: <monospace>MIDNSHP</monospace>)</td></tr><tr><td align="left" rowspan="1" colspan="1">7</td><td align="left" rowspan="1" colspan="1"><monospace>MRNM</monospace></td><td align="left" rowspan="1" colspan="1">Mate Reference NaMe (‘=’ if same as <monospace>RNAME</monospace>)</td></tr><tr><td align="left" rowspan="1" colspan="1">8</td><td align="left" rowspan="1" colspan="1"><monospace>MPOS</monospace></td><td align="left" rowspan="1" colspan="1">1-Based leftmost Mate POSition</td></tr><tr><td align="left" rowspan="1" colspan="1">9</td><td align="left" rowspan="1" colspan="1"><monospace>ISIZE</monospace></td><td align="left" rowspan="1" colspan="1">Inferred Insert SIZE</td></tr><tr><td align="left" rowspan="1" colspan="1">10</td><td align="left" rowspan="1" colspan="1"><monospace>SEQ</monospace></td><td align="left" rowspan="1" colspan="1">Query SEQuence on the same strand as the reference</td></tr><tr><td align="left" rowspan="1" colspan="1">11</td><td align="left" rowspan="1" colspan="1"><monospace>QUAL</monospace></td><td align="left" rowspan="1" colspan="1">Query QUALity (ASCII-33=Phred base quality)</td></tr></tbody></table></table-wrap>
</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="SEC3">
    <title>3 CONCLUSIONS</title>
    <p>We designed and implemented a generic alignment format, SAM, which is simple to work with and flexible enough to keep most information from various sequencing platforms and read aligners. The equivalent binary representation, BAM, is compact in size and supports fast retrieval of alignments in specified regions. Using positional sorting and indexing, applications can perform stream-based processing on specific genomic regions without loading the entire file into memory. The SAM/BAM format, together with SAMtools, separates the alignment step from downstream analyses, enabling a generic and modular approach to the analysis of genomic sequencing data.</p>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>We are grateful to James Bonfield for the comments on indexing and to SAMtools users for testing the software as it has matured.</p>
    <p><italic>Funding</italic>: Wellcome Trust/077192/Z/05/Z; <funding-source>NIH</funding-source> Hapmap/1000 Genomes Project grant (U54HG002750 to B.H.).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>WJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The human genome browser at UCSC</article-title>
        <source>Genome Res.</source>
        <year>2002</year>
        <volume>12</volume>
        <fpage>996</fpage>
        <lpage>1006</lpage>
        <pub-id pub-id-type="pmid">12045153</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title>
        <source>Genome Biol.</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>R25</fpage>
        <pub-id pub-id-type="pmid">19261174</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mapping short DNA sequencing reads and calling variants using mapping quality scores</article-title>
        <source>Genome Res.</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>1851</fpage>
        <lpage>1858</lpage>
        <pub-id pub-id-type="pmid">18714091</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mardis</surname>
            <given-names>ER</given-names>
          </name>
        </person-group>
        <article-title>Next-generation DNA sequencing methods</article-title>
        <source>Annu. Rev. Genomics Hum. Genet.</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>387</fpage>
        <lpage>402</lpage>
        <pub-id pub-id-type="pmid">18576944</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1460-2059</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2723002</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btp352</article-id>
    <article-id pub-id-type="publisher-id">btp352</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group>
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>The Sequence Alignment/Map format and SAMtools</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Heng</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="author-notes" rid="FN1">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Handsaker</surname>
          <given-names>Bob</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="author-notes" rid="FN1">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wysoker</surname>
          <given-names>Alec</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fennell</surname>
          <given-names>Tim</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ruan</surname>
          <given-names>Jue</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Homer</surname>
          <given-names>Nils</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Marth</surname>
          <given-names>Gabor</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Abecasis</surname>
          <given-names>Goncalo</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>6</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Durbin</surname>
          <given-names>Richard</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">
          <sup>*</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <collab>1000 Genome Project Data Processing Subgroup</collab>
        <xref ref-type="aff" rid="AFF1">
          <sup>7</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><sup>1</sup> Wellcome Trust Sanger Institute, Wellcome Trust Genome Campus, Cambridge, CB10 1SA, UK, <sup>2</sup>Broad Institute of MIT and Harvard, Cambridge, MA 02141, USA, <sup>3</sup>Beijing Institute of Genomics, Chinese Academy of Science, Beijing 100029, China, <sup>4</sup>Department of Computer Science, University of California Los Angeles, Los Angeles, CA 90095, <sup>5</sup>Department of Biology, Boston College, Chestnut Hill, MA 02467, <sup>6</sup>Center for Statistical Genetics, Department of Biostatistics, University of Michigan, Ann Arbor, MI 48109, USA and <sup>7</sup><ext-link ext-link-type="uri" xlink:href="http://1000genomes.org">http://1000genomes.org</ext-link></aff>
    <author-notes>
      <corresp id="COR1"><sup>*</sup>To whom correspondence should be addressed.</corresp>
      <fn id="FN1">
        <p><sup>†</sup>The authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors.</p>
      </fn>
      <fn>
        <p>Associate Editor: Alfonso Valencia</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>8</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>8</day>
      <month>6</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>8</day>
      <month>6</month>
      <year>2009</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>25</volume>
    <issue>16</issue>
    <fpage>2078</fpage>
    <lpage>2079</lpage>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>4</month>
        <year>2009</year>
      </date>
      <date date-type="rev-recd">
        <day>28</day>
        <month>5</month>
        <year>2009</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>5</month>
        <year>2009</year>
      </date>
    </history>
    <permissions>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Summary:</bold> The Sequence Alignment/Map (SAM) format is a generic alignment format for storing read alignments against reference sequences, supporting short and long reads (up to 128 Mbp) produced by different sequencing platforms. It is flexible in style, compact in size, efficient in random access and is the format in which alignments from the 1000 Genomes Project are released. SAMtools implements various utilities for post-processing alignments in the SAM format, such as indexing, variant caller and alignment viewer, and thus provides universal tools for processing read alignments.</p>
      <p>
        <bold>Availability:</bold>
        <ext-link ext-link-type="uri" xlink:href="http://samtools.sourceforge.net">http://samtools.sourceforge.net</ext-link>
      </p>
      <p>
        <bold>Contact:</bold>
        <email>rd@sanger.ac.uk</email>
      </p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>1 INTRODUCTION</title>
    <p>With the advent of novel sequencing technologies such as Illumina/Solexa, AB/SOLiD and Roche/454 (Mardis, <xref ref-type="bibr" rid="B4">2008</xref>), a variety of new alignment tools (Langmead <italic>et al.</italic>, <xref ref-type="bibr" rid="B2">2009</xref>; Li <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">2008</xref>) have been designed to realize efficient read mapping against large reference sequences, including the human genome. These tools generate alignments in different formats, however, complicating downstream processing. A common alignment format that supports all sequence types and aligners creates a well-defined interface between alignment and downstream analyses, including variant detection, genotyping and assembly.</p>
    <p>The Sequence Alignment/Map (SAM) format is designed to achieve this goal. It supports single- and paired-end reads and combining reads of different types, including color space reads from AB/SOLiD. It is designed to scale to alignment sets of 10<sup>11</sup> or more base pairs, which is typical for the deep resequencing of one human individual.</p>
    <p>In this article, we present an overview of the SAM format and briefly introduce the companion SAMtools software package. A detailed format specification and the complete documentation of SAMtools are available at the SAMtools web site.</p>
  </sec>
  <sec sec-type="methods" id="SEC2">
    <title>2 METHODS</title>
    <sec id="SEC2.1">
      <title>2.1 The SAM format</title>
      <sec id="SEC2.1.1">
        <title>2.1.1 Overview of the SAM format</title>
        <p>The SAM format consists of one header section and one alignment section. The lines in the header section start with character ‘<monospace>@</monospace>’, and lines in the alignment section do not. All lines are TAB delimited. An example is shown in <xref ref-type="fig" rid="F1">Figure 1</xref>b.
<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>Example of extended CIGAR and the pileup output. (<bold>a</bold>) Alignments of one pair of reads and three single-end reads. (<bold>b</bold>) The corresponding SAM file. The ‘<monospace>@SQ</monospace>’ line in the header section gives the order of reference sequences. Notably, <monospace>r001</monospace> is the name of a read pair. According to <monospace>FLAG</monospace> 163 (=1 + 2 + 32 + 128), the read mapped to position 7 is the second read in the pair (128) and regarded as properly paired (1 + 2); its mate is mapped to 37 on the reverse strand (32). Read <monospace>r002</monospace> has three soft-clipped (unaligned) bases. The coordinate shown in SAM is the position of the first aligned base. The CIGAR string for this alignment contains a <monospace>P</monospace> (padding) operation which correctly aligns the inserted sequences. Padding operations can be absent when an aligner does not support multiple sequence alignment. The last six bases of read <monospace>r003</monospace> map to position 9, and the first five to position 29 on the reverse strand. The hard clipping operation <monospace>H</monospace> indicates that the clipped sequence is not present in the sequence field. The <monospace>NM</monospace> tag gives the number of mismatches. Read <monospace>r004</monospace> is aligned across an intron, indicated by the <monospace>N</monospace> operation. (<bold>c</bold>) Simplified pileup output by SAMtools. Each line consists of reference name, sorted coordinate, reference base, the number of reads covering the position and read bases. In the fifth field, a dot or a comma denotes a base identical to the reference; a dot or a capital letter denotes a base from a read mapped on the forward strand, while a comma or a lowercase letter on the reverse strand.</p></caption><graphic xlink:href="btp352f1"/></fig>
</p>
        <p>In SAM, each alignment line has 11 mandatory fields and a variable number of optional fields. The mandatory fields are briefly described in <xref ref-type="table" rid="T1">Table 1</xref>. They must be present but their value can be a ‘<monospace>⋆</monospace>’ or a zero (depending on the field) if the corresponding information is unavailable. The optional fields are presented as key-value pairs in the format of <monospace>TAG:TYPE:VALUE</monospace>. They store extra information from the platform or aligner. For example, the ‘<monospace>RG</monospace>’ tag keeps the ‘read group’ information for each read. In combination with the ‘<monospace>@RG</monospace>’ header lines, this tag allows each read to be labeled with metadata about its origin, sequencing center and library. The SAM format specification gives a detailed description of each field and the predefined <monospace>TAG</monospace>s.</p>
      </sec>
      <sec id="SEC2.1.2">
        <title>2.1.2 Extended CIGAR</title>
        <p>The standard CIGAR description of pairwise alignment defines three operations: ‘<monospace>M</monospace>’ for match/mismatch, ‘<monospace>I</monospace>’ for insertion compared with the reference and ‘<monospace>D</monospace>’ for deletion. The extended CIGAR proposed in SAM added four more operations: ‘<monospace>N</monospace>’ for skipped bases on the reference, ‘<monospace>S</monospace>’ for soft clipping, ‘<monospace>H</monospace>’ for hard clipping and ‘<monospace>P</monospace>’ for padding. These support splicing, clipping, multi-part and padded alignments. <xref ref-type="fig" rid="F1">Figure 1</xref> shows examples of CIGAR strings for different types of alignments.</p>
      </sec>
      <sec id="SEC2.1.3">
        <title>2.1.3 Binary Alignment/Map format</title>
        <p>To improve the performance, we designed a companion format Binary Alignment/Map (BAM), which is the binary representation of SAM and keeps exactly the same information as SAM. BAM is compressed by the BGZF library, a generic library developed by us to achieve fast random access in a zlib-compatible compressed file. An example alignment of 112 Gbp of Illumina GA data requires 116 GB of disk space (1.0 byte per input base), including sequences, base qualities and all the meta information generated by MAQ. Most of this space is used to store the base qualities.</p>
      </sec>
      <sec id="SEC2.1.4">
        <title>2.1.4 Sorting and indexing</title>
        <p>A SAM/BAM file can be unsorted, but sorting by coordinate is used to streamline data processing and to avoid loading extra alignments into memory. A position-sorted BAM file can be indexed. We combine the UCSC binning scheme (Kent <italic>et al.</italic>, <xref ref-type="bibr" rid="B1">2002</xref>) and simple linear indexing to achieve fast random retrieval of alignments overlapping a specified chromosomal region. In most cases, only one seek call is needed to retrieve alignments in a region.</p>
      </sec>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 SAMtools software package</title>
      <p>SAMtools is a library and software package for parsing and manipulating alignments in the SAM/BAM format. It is able to convert from other alignment formats, sort and merge alignments, remove PCR duplicates, generate per-position information in the pileup format (<xref ref-type="fig" rid="F1">Fig. 1</xref>c), call SNPs and short indel variants, and show alignments in a text-based viewer. For the example alignment of 112 Gbp Illumina GA data, SAMtools took about 10 h to convert from the MAQ format and 40 min to index with &lt;30 MB memory. Conversion is slower mainly because compression with zlib is slower than decompression. External sorting writes temporary BAM files and would typically be twice as slow as conversion.</p>
      <p>SAMtools has two separate implementations, one in C and the other in Java, with slightly different functionality.
<table-wrap id="T1" position="float"><label>Table 1.</label><caption><p>Mandatory fields in the SAM format</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th align="left" rowspan="1" colspan="1">No.</th><th align="left" rowspan="1" colspan="1">Name</th><th align="left" rowspan="1" colspan="1">Description</th></tr></thead><tbody align="left"><tr><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1"><monospace>QNAME</monospace></td><td align="left" rowspan="1" colspan="1">Query NAME of the read or the read pair</td></tr><tr><td align="left" rowspan="1" colspan="1">2</td><td align="left" rowspan="1" colspan="1"><monospace>FLAG</monospace></td><td align="left" rowspan="1" colspan="1">Bitwise FLAG (pairing, strand, mate strand, etc.)</td></tr><tr><td align="left" rowspan="1" colspan="1">3</td><td align="left" rowspan="1" colspan="1"><monospace>RNAME</monospace></td><td align="left" rowspan="1" colspan="1">Reference sequence NAME</td></tr><tr><td align="left" rowspan="1" colspan="1">4</td><td align="left" rowspan="1" colspan="1"><monospace>POS</monospace></td><td align="left" rowspan="1" colspan="1">1-Based leftmost POSition of clipped alignment</td></tr><tr><td align="left" rowspan="1" colspan="1">5</td><td align="left" rowspan="1" colspan="1"><monospace>MAPQ</monospace></td><td align="left" rowspan="1" colspan="1">MAPping Quality (Phred-scaled)</td></tr><tr><td align="left" rowspan="1" colspan="1">6</td><td align="left" rowspan="1" colspan="1"><monospace>CIGAR</monospace></td><td align="left" rowspan="1" colspan="1">Extended CIGAR string (operations: <monospace>MIDNSHP</monospace>)</td></tr><tr><td align="left" rowspan="1" colspan="1">7</td><td align="left" rowspan="1" colspan="1"><monospace>MRNM</monospace></td><td align="left" rowspan="1" colspan="1">Mate Reference NaMe (‘=’ if same as <monospace>RNAME</monospace>)</td></tr><tr><td align="left" rowspan="1" colspan="1">8</td><td align="left" rowspan="1" colspan="1"><monospace>MPOS</monospace></td><td align="left" rowspan="1" colspan="1">1-Based leftmost Mate POSition</td></tr><tr><td align="left" rowspan="1" colspan="1">9</td><td align="left" rowspan="1" colspan="1"><monospace>ISIZE</monospace></td><td align="left" rowspan="1" colspan="1">Inferred Insert SIZE</td></tr><tr><td align="left" rowspan="1" colspan="1">10</td><td align="left" rowspan="1" colspan="1"><monospace>SEQ</monospace></td><td align="left" rowspan="1" colspan="1">Query SEQuence on the same strand as the reference</td></tr><tr><td align="left" rowspan="1" colspan="1">11</td><td align="left" rowspan="1" colspan="1"><monospace>QUAL</monospace></td><td align="left" rowspan="1" colspan="1">Query QUALity (ASCII-33=Phred base quality)</td></tr></tbody></table></table-wrap>
</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="SEC3">
    <title>3 CONCLUSIONS</title>
    <p>We designed and implemented a generic alignment format, SAM, which is simple to work with and flexible enough to keep most information from various sequencing platforms and read aligners. The equivalent binary representation, BAM, is compact in size and supports fast retrieval of alignments in specified regions. Using positional sorting and indexing, applications can perform stream-based processing on specific genomic regions without loading the entire file into memory. The SAM/BAM format, together with SAMtools, separates the alignment step from downstream analyses, enabling a generic and modular approach to the analysis of genomic sequencing data.</p>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>We are grateful to James Bonfield for the comments on indexing and to SAMtools users for testing the software as it has matured.</p>
    <p><italic>Funding</italic>: Wellcome Trust/077192/Z/05/Z; <funding-source>NIH</funding-source> Hapmap/1000 Genomes Project grant (U54HG002750 to B.H.).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>WJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The human genome browser at UCSC</article-title>
        <source>Genome Res.</source>
        <year>2002</year>
        <volume>12</volume>
        <fpage>996</fpage>
        <lpage>1006</lpage>
        <pub-id pub-id-type="pmid">12045153</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title>
        <source>Genome Biol.</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>R25</fpage>
        <pub-id pub-id-type="pmid">19261174</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mapping short DNA sequencing reads and calling variants using mapping quality scores</article-title>
        <source>Genome Res.</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>1851</fpage>
        <lpage>1858</lpage>
        <pub-id pub-id-type="pmid">18714091</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mardis</surname>
            <given-names>ER</given-names>
          </name>
        </person-group>
        <article-title>Next-generation DNA sequencing methods</article-title>
        <source>Annu. Rev. Genomics Hum. Genet.</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>387</fpage>
        <lpage>402</lpage>
        <pub-id pub-id-type="pmid">18576944</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
