<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature Communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7670471</article-id>
    <article-id pub-id-type="publisher-id">19562</article-id>
    <article-id pub-id-type="doi">10.1038/s41467-020-19562-7</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Computer vision for pattern detection in chromosome contact maps</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1126-1535</contrib-id>
        <name>
          <surname>Matthey-Doret</surname>
          <given-names>Cyril</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9283-674X</contrib-id>
        <name>
          <surname>Baudry</surname>
          <given-names>Lyam</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Breuer</surname>
          <given-names>Axel</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Montagne</surname>
          <given-names>Rémi</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-6185-1592</contrib-id>
        <name>
          <surname>Guiglielmoni</surname>
          <given-names>Nadège</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3490-0579</contrib-id>
        <name>
          <surname>Scolari</surname>
          <given-names>Vittore</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jean</surname>
          <given-names>Etienne</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Campeas</surname>
          <given-names>Arnaud</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chanut</surname>
          <given-names>Philippe Henri</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9758-3112</contrib-id>
        <name>
          <surname>Oriol</surname>
          <given-names>Edgar</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Méot</surname>
          <given-names>Adrien</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Politis</surname>
          <given-names>Laurent</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Vigouroux</surname>
          <given-names>Antoine</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3380-6214</contrib-id>
        <name>
          <surname>Moreau</surname>
          <given-names>Pierrick</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3086-1173</contrib-id>
        <name>
          <surname>Koszul</surname>
          <given-names>Romain</given-names>
        </name>
        <address>
          <email>romain.koszul@pasteur.fr</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3523-2453</contrib-id>
        <name>
          <surname>Cournac</surname>
          <given-names>Axel</given-names>
        </name>
        <address>
          <email>acournac@pasteur.fr</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label>Institut Pasteur, Unité Régulation Spatiale des Génomes, CNRS, UMR 3525, C3BI USR 3756, Paris, France </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.462844.8</institution-id><institution-id institution-id-type="ISNI">0000 0001 2308 1657</institution-id><institution>Sorbonne Université, Collège Doctoral, </institution></institution-wrap>F-75005 Paris, France </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.424921.8</institution-id><institution-id institution-id-type="ISNI">0000 0001 2150 6084</institution-id><institution>ENGIE, Global Energy Management, </institution></institution-wrap>Paris, France </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.428999.7</institution-id><institution-id institution-id-type="ISNI">0000 0001 2353 6535</institution-id><institution>Institut Pasteur, Synthetic Biology Group, </institution></institution-wrap>Paris, France </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>16</day>
      <month>11</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>11</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>11</volume>
    <elocation-id>5795</elocation-id>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>6</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>16</day>
        <month>10</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Chromosomes of all species studied so far display a variety of higher-order organisational features, such as self-interacting domains or loops. These structures, which are often associated to biological functions, form distinct, visible patterns on genome-wide contact maps generated by chromosome conformation capture approaches such as Hi-C. Here we present Chromosight, an algorithm inspired from computer vision that can detect patterns in contact maps. Chromosight has greater sensitivity than existing methods on synthetic simulated data, while being faster and applicable to any type of genomes, including bacteria, viruses, yeasts and mammals. Our method does not require any prior training dataset and works well with default parameters on data generated with various protocols.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">Chromatin loops bridging distant loci within chromosomes can be detected by a variety of techniques such as Hi-C. Here the authors present Chromosight, an algorithm applied on mammalian, bacterial, viral and yeast genomes, able to detect various types of pattern in chromosome contact maps, including chromosomal loops.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Bioinformatics</kwd>
      <kwd>Nuclear organization</kwd>
      <kwd>Data processing</kwd>
      <kwd>Genome informatics</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100010663</institution-id>
            <institution>EC | EU Framework Programme for Research and Innovation H2020 | H2020 Priority Excellent Science | H2020 European Research Council (H2020 Excellent Science - European Research Council)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>771813</award-id>
        <principal-award-recipient>
          <name>
            <surname>Koszul</surname>
            <given-names>Romain</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100001665</institution-id>
            <institution>Agence Nationale de la Recherche (French National Research Agency)</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par3">Proximity ligation derivatives of the chromosome conformation capture (3C) technique<sup><xref ref-type="bibr" rid="CR1">1</xref></sup> such as Hi–C<sup><xref ref-type="bibr" rid="CR2">2</xref></sup> or ChIA-PET<sup><xref ref-type="bibr" rid="CR3">3</xref></sup> determine the average contact frequencies between DNA segments within a genome, computed over hundreds of thousands of cells.These approaches have unveiled a wide variety of chromatin 3D structures in a broad range of organisms. For instance, in all species studied so far, sub-division of chromosomes into self-interacting domains associated with various functions have been observed<sup><xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR5">5</xref></sup> (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). In addition, chromatin loops bridging distant loci within a chromosome (from a few kb to a Mb) are also commonly detected by Hi–C, such as during mammalian interphase<sup><xref ref-type="bibr" rid="CR6">6</xref></sup> or yeast mitotic metaphase<sup><xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR9">9</xref></sup>. Other spatial structures are more peculiar, and sometimes specific to some organisms. For instance, the contact maps of most bacteria display a secondary diagonal perpendicular to the main one<sup><xref ref-type="bibr" rid="CR10">10</xref>–<xref ref-type="bibr" rid="CR12">12</xref></sup>, reflecting the bridging of chromosome replichores (i.e. arms) by the structural maintenance of chromosome complex (SMC) condensin<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>, a ring-shaped molecular motor able to entrap and travel along DNA molecules<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>. Smaller straight, or loosely bent, secondary diagonals, also perpendicular to the main diagonal, can also be observed in some maps, reflecting potentially long DNA hairpins or dynamic sliding asymmetrical contacts (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). Such “hairpin-like” configuration is for instance observed near the origin of replication of the <italic>Bacillus subtilis</italic> genome, were it was originally described as a “bow shaped” structure<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. The formation of these different structures can vary depending on the stage of the cell cycle,<sup><xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR10">10</xref>,<xref ref-type="bibr" rid="CR14">14</xref></sup>, the state of cell differentiation<sup><xref ref-type="bibr" rid="CR15">15</xref></sup> or viral infection<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. Different molecular mechanisms have been proposed to explain the patterns visible on the contact maps, and for a similar pattern, these mechanisms or their regulation can differ. Although detailing these mechanisms is beyond the scope of the present work, one can note that in mammals the CCCTC-binding factor (CTCF) protein is enriched at loop anchors (i.e. the regions bridged together). It has been proposed that CTCF acts as a roadblock to the SMC molecular motor cohesin, which travels along chromatin. Cohesins promote the formation of chromatin loops, potentially through a loop extrusion mechanisms in which two chromatin filaments are extruded through the cohesin ring<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>). When cohesin encounters a roadblock along one of the filament, chromatin displacement stops in this direction. As a consequence, two roadblocks at two distant loci will stop cohesin progression along both filaments, resulting in a stabilised loop. Such stable loops are then visible in bulk genomics techniques such as Hi–C (for more insights on the putative mechanisms, see for instance<sup><xref ref-type="bibr" rid="CR17">17</xref>,<xref ref-type="bibr" rid="CR18">18</xref></sup>). Other patterns such as the perpendicular “hairpin” can be explained by alternative scenarios, for instance where cohesin is continuously loaded at a discrete position along the chromatin while being unloaded before hitting a roadblock. A single roadblock combined with continuous cohesin loading in an adjacent locus could result in a bent, bow-shaped pattern, as proposed in<sup><xref ref-type="bibr" rid="CR10">10</xref>,<xref ref-type="bibr" rid="CR19">19</xref>,<xref ref-type="bibr" rid="CR20">20</xref></sup>. A large body of work, exploiting genetics and chromosome engineering approaches, aims at characterising the regulation and the functional relationships of these 3D features with DNA processes such as repair, gene expression or segregation. Although most structural features can be identified by eye on the contact maps, automated detection is essential to quantify and facilitate the biological and physical interpretation of the data generated through these experiments. While border detection can be achieved quite efficiently using different methods (segmentation, break-point detection, etc; ref. <sup><xref ref-type="bibr" rid="CR21">21</xref></sup>), the calling of loops, as well as other more peculiar features such as “hairpin-like” signals, remains challenging.<fig id="Fig1"><label>Fig. 1</label><caption><title>Chromosight workflow and benchmark.</title><p><bold>a</bold> Examples of distinct patterns visible on contact maps (loop, border and hairpin) and the corresponding chromosight kernels. <bold>b</bold> Matrix preprocessing involves normalisation balancing followed by the computation of observed/expected contacts. Only contacts between bins separated by a user-defined maximum distance are considered. The preprocessed matrix is then convolved with a kernel representing the pattern of interest. For each pixel of the matrix, a Pearson correlation coefficient is computed between the kernel and the surrounding window. A threshold is applied on the coefficients and a connected component labelling algorithm is used to separate groups of pixels (i.e. foci) with high correlation values. For each focus, the coordinates with the highest correlation value are used as the pattern coordinates. Coordinates located in poorly covered regions are discarded. <bold>c</bold> Comparison of Chromosight with different loop callers. Top: F1 score, Precision and Sensitivity scores assessed on labelled synthetic Hi–C data. Higher is better. <bold>d</bold> Run-time. <bold>e</bold> Memory usage according to maximum scanning distance and the amount of subsampled contact events, respectively. Means and standard deviations (grey areas) are plotted.</p></caption><graphic xlink:href="41467_2020_19562_Fig1_HTML" id="d30e462"/></fig></p>
    <p id="Par4">Most tools aiming at detecting DNA loops in contact maps rely on statistical approaches and search for pixel regions enriched in contact counts, such as Cloops<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>, HiCCUPS<sup><xref ref-type="bibr" rid="CR23">23</xref></sup>, HiCExplorer<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>, diffHic<sup><xref ref-type="bibr" rid="CR25">25</xref></sup>, FitHiC2<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>, HOMER<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>. These programs can be computationally intensive and take several hours of computation for standard human Hi–C datasets (reviewed in ref. <sup><xref ref-type="bibr" rid="CR22">22</xref></sup>), or require specialised hardware such as GPU (HiCCUPS). In addition, most if not all of them were developed from, and for, human data. As a consequence, they suffer from a lack of sensitivity and fail to detect biologically relevant structures not only in non-model organisms but also in popular species with compact genomes such as budding yeast (<italic>Saccharomyces cerevisiae</italic>) or bacteria where the scales of the structures are considerably smaller than in mammalian genomes. Here we present <italic>Chromosight</italic>, an algorithm that, when applied on mammalian, bacterial, viral and yeast genome-wide contact maps, quickly and efficiently detects and/or quantifies any type of pattern, with a specific focus on chromosomal loops. Different species were chosen to reflect the diversity of genome-wide contact maps observed in living organisms. For instance, loop contact patterns have been observed in these four clades, but with very different scales and visibility. In human (genome size: ~3 Gb), interphase chromosomes display loops bridging chromatin loci separated by  ~20 kb to 20 Mb. The structures are reflected by well-defined, discrete dots in the contact maps, away from the main diagonal. In contrast, the mitotic chromosomes of <italic>S. cerevisiae</italic> and fission yeast <italic>Schizosaccharomyces pombe</italic> (genome sizes: ~12 Mb) organise into arrays of loops spanning ~5–50 kb, i.e. much smaller than the loops observed along mammalian interphase chromosomes<sup><xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR9">9</xref></sup>. Because of their proximity to the main diagonal in standard Hi–C experiments, the signal generated by those loops is more difficult to call. Loops have been observed in bacteria as well. For instance, in <italic>B. subtilis</italic> (genome size: 4.1 Mb), a few weak, discrete loop signals were observed but never directly quantified<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. In addition to loops, self-interacting domains have also been described in these different species, that differ in size and nature. For instance, topologically associating domains<sup><xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR28">28</xref></sup> have a mean size of 1 Mb (from 200 kb to 6 Mb) in human and mice, compared to the small, chromosome interacting domains (CID) of bacteria that range in size between a few dozens to a couple hundreds kb<sup><xref ref-type="bibr" rid="CR10">10</xref>,<xref ref-type="bibr" rid="CR29">29</xref>,<xref ref-type="bibr" rid="CR30">30</xref></sup>. Besides this limitation, most programs are limited to domain or loop calling and remain unable to call de novo different contact patterns such as DNA hairpins or the asymmetric patterns seen in species such as <italic>B. subtilis</italic><sup><xref ref-type="bibr" rid="CR10">10</xref></sup>.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>Presentation and benchmark of Chromosight</title>
      <p id="Par5">Chromosight takes a single, whole-genome contact map in sparse and compressed format as an input. It applies a balancing normalization procedure<sup><xref ref-type="bibr" rid="CR31">31</xref></sup> to attenuate experimental biases. A detrending procedure, to remove distance-dependent contact decay due to polymeric behaviour, is then applied, which consists in dividing each pixel by its expected value under the polymer behaviour (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). A template (kernel) representing a 3D structure of interest (e.g. a loop, a boundary,...) is fed to the program and sought for in the image of the contact map through two steps (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). First, the map is subdivided into sub-images correlated to the template; then, the sub-images with the highest correlation values are labelled as template representations (i.e. potential matches, see Methods). Correlation coefficients are computed by convolving the template over the contact map. To reduce computation time, the template can be approximated using truncated singular value decomposition (tSVD) (Supplementary Note <xref rid="MOESM1" ref-type="media">1</xref><sup><xref ref-type="bibr" rid="CR32">32</xref></sup>). To identify the regions with high correlation values (i.e. correlation foci), Chromosight uses Connected Component Labelling (CCL). Finally, the maximum within each correlation focus is extracted and its coordinates in the contact map determined.</p>
      <p id="Par6">We decided to benchmark Chromosight against 4 existing programs by running them in loop-calling mode on synthetic Hi–C data mimicking mitotic chromosomes of <italic>S. cerevisiae</italic> (“Methods” and Supplementary Fig. <xref rid="MOESM1" ref-type="media">1</xref>). Whereas Chromosight displays a precision (i.e. proportion of true positives among detected patterns) comparable to the other programs, its sensitivity (i.e. proportion of relevant patterns detected) is more than threefold higher (~70%) compared to the second-best program Hicexplorer (~20%) (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c). As a result, Chromosight’s F1 score, a metric that considers both precision and sensitivity, is also threefold higher, reflecting the effectiveness of the program at detecting more significant loops in this synthetic case study (Supplementary Fig. <xref rid="MOESM1" ref-type="media">2a</xref>). To further benchmark the program’s performance, we ran the three best CPU-based programs (Cooltools, Hicexplorer, Chromosight) on high resolution (10 kb), human genome-wide experimental contact maps. Chromosight outperforms existing methods regarding computing time (Fig. <xref rid="Fig1" ref-type="fig">1</xref>d), without straining RAM (Fig. <xref rid="Fig1" ref-type="fig">1</xref>e). For instance, on a single CPU core, it detects loops at maximum distance of 5 Mb within ~5 min compared to ~17 and 30 min for Cooltools and Hicexplorer, respectively.</p>
      <p id="Par7">To get a sense of the differences between the softwares when applied to experimental human contact maps, we compared them with default parameters on Hi–C data generated from GM12878 cell lines<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>. Compared to Chromosight, we first noticed that other programs missed multiple loops which were clearly visible on the maps (e.g. Supplementary Fig. <xref rid="MOESM1" ref-type="media">3a</xref>). For instance, Chromosight found 85% of the loops detected by Cooltools, the software with the highest precision in our benchmark, while overall identifying a much larger number of loops (37,955 vs. 6264, respectively) (Supplementary Fig. <xref rid="MOESM1" ref-type="media">3c</xref>). We then measured the proportion of loops with both anchors overlapping CTCF peaks identified from ChIP-seq<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>. Almost all (~95%) loops detected by Hiccups and Cooltools, the most conservative programs, co-localize with CTCF enriched sites, compared to ~64% for the loops detected by Chromosight and Hicexplorer (Supplementary Fig. <xref rid="MOESM1" ref-type="media">3b</xref>). Chromosight (and Hicexplorer) indeed detects multiple weaker loops, visible on the maps and arranged in grid-like patterns, but often with only one anchor falling into a well-defined CTCF enriched site. Some of these weaker loops’ anchors may be less enriched in CTCF, which would cause ChIP-seq peak calling algorithms to discard them because of parameters such as intensity thresholds, or minimum inter-peak distances. This means that more sensitive loop callers could result in lower CTCF peak overlap, not because of inaccurate detection, but rather because of the CTCF peaks cutoffs. On the other hand, less sensitive loop callers would call the strongest loops associated with the strongest CTCF peaks. We can also not exclude that a portion of the less intense loops called by Chromosight are linked to different protein complexes or mechanisms. More investigations will further dissect the nature of these loops.</p>
    </sec>
    <sec id="Sec4">
      <title>Detection and quantification of loops in a compact genome</title>
      <p id="Par8">Hi–C contact maps of budding and fission yeast chromosomes generated from synchronised cells during meiosis<sup><xref ref-type="bibr" rid="CR35">35</xref></sup> and mitosis<sup><xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR9">9</xref></sup> display arrays of chromatin loops. Recent work further showed that <italic>S. cerevisiae</italic> mitotic loops are mediated and regulated by the SMC complex cohesin<sup><xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR8">8</xref></sup>. Chromosight loop calling on data from ref. <sup><xref ref-type="bibr" rid="CR8">8</xref></sup> identified 974 loops along <italic>S. cerevisiae</italic> mitotic chromosomes (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a). An enrichment analysis shows that half (50%) of the anchors of those mitotic loops consist in loci enriched in the cohesin subunit Scc1 (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b), (<italic>P</italic>  &lt; 10<sup>−16</sup>). The loop signal spectrum in mitosis shows the most stable loops are ~20 kb long (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c). This size is also found in the <italic>S. pombe</italic> yeast, which has longer chromosomes.<fig id="Fig2"><label>Fig. 2</label><caption><title>Applications on yeast genomes.</title><p><bold>a</bold> Zoom-in of the contact map of chromosome 5 of <italic>S. cerevisiae</italic> with synchronised ChIP-Seq signal of Scc1 protein (cohesin) at 2 kb resolution with detected loops and border patterns,<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>. The darker, the more contacts. <bold>b</bold> Pileup plots of windows centered on detected loops with the number of detections. Barplots of the proportion of Scc1 peaks for anchors of detected loops and associated <italic>p</italic>-value (Fisher test, two-sided). <bold>c</bold> Loop spectrum showing scores in function of the loop size in <italic>S. cerevisiae</italic> (974 loops) and <italic>S. pombe</italic> (1484 loops). Curves represent lowess-smoothed data for easier interpretation with 95% confidence intervals. <bold>d</bold> Number of loops detected only in G1 phase, M phase, or in both. For each category, the pileup of each set of coordinates is shown for both G1 and M conditions (mitotic data<sup><xref ref-type="bibr" rid="CR8">8</xref></sup> subsampled from 44M to 5.8M contacts for comparison with G1<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>).</p></caption><graphic xlink:href="41467_2020_19562_Fig2_HTML" id="d30e708"/></fig></p>
      <p id="Par9">On the other hand, loop calling on contact maps generated from cells in G1, where cohesin does not stably binds to chromosomes, yielded only 115 loops (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d and Supplementary Fig. <xref rid="MOESM1" ref-type="media">4a</xref>). Interestingly, this pool of loops appears different from the group of loops detected during mitosis suggesting that cohesin independent processes act on chromosomal loop formation in yeast (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d and Supplementary Fig. <xref rid="MOESM1" ref-type="media">4a</xref>). Notably, loop anchors were enriched in highly expressed genes (HEG) (Supplementary Fig. <xref rid="MOESM1" ref-type="media">4a</xref>).</p>
      <p id="Par10">To validate the biological relevancy of the loops detected by Chromosight during mitosis, we further analysed their dependency and association to cohesin using the quantification mode implemented in the program (Methods and Supplementary Fig. <xref rid="MOESM1" ref-type="media">5a</xref>). This mode allows to precisely compute the correlation scores on a set of input coordinates with a generic kernel. We computed the “loop spectrum” (Loop score versus size) for pairs of cohesin ChIP-seq peaks separated by increasing genomic distances. A characteristic size of 20 kb was clearly visible on the spectrum during mitosis, whereas the spectrum in G1 appeared flat (Supplementary Fig. <xref rid="MOESM1" ref-type="media">5b</xref>). This analysis highlights the role of cohesin in mediating regular loop structures during mitosis and shows how Chromosight can be used to precisely quantify spatial patterns like chromosome loops.</p>
      <p id="Par11">To test the ability of Chromosight to detect loops in a genetically disturbed context, they were called on contact data of a mutant depleted for the SMC holocomplex member Pds5 (Precocious Dissociation of Sisters)<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>. This protein regulates cohesin loop formation through two independent pathways<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>, and its depletion leads to the formation of loops over longer distances than in wild-type yeast. One anchor of loops in Pds5 depleted cells appeared to be the centromeres, as suggested by visual inspection of the maps<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>. However, loop patterns are shadowed by a strong boundary signal appearing at the centromeres, which makes their visual identification challenging. Loop calling using Chromosight confirmed this observation, as the anchors of the loops called were strongly enriched at centromeric regions (Supplementary Fig. <xref rid="MOESM1" ref-type="media">4b</xref>, <italic>P</italic>  &lt; 10<sup>−16</sup>)). This analysis shows that Chromosight is able to robustly quantify global reorganisation of genome architecture.</p>
      <p id="Par12">Finally, we called domain boundaries (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a, border kernel) on the G1 maps, identifying 473 instances of boundaries mostly associated with HEG as well (Supplementary Fig. <xref rid="MOESM1" ref-type="media">4b</xref>).</p>
    </sec>
    <sec id="Sec5">
      <title>Exploration of various genomes and patterns</title>
      <p id="Par13">To further test the versatility of Chromosight, we called all three kernels described in Fig. <xref rid="Fig1" ref-type="fig">1</xref>a, i.e. loops, borders and hairpins (Supplementary Fig. <xref rid="MOESM1" ref-type="media">6</xref>) in Hi–C contact maps of human lymphoblastoids (GM12878)<sup><xref ref-type="bibr" rid="CR36">36</xref></sup> (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a).<fig id="Fig3"><label>Fig. 3</label><caption><title>Applications to various genomes.</title><p><bold>a</bold> Zoom-in of contact map for chromosome 2 of <italic>Homo sapiens</italic> at 10 kb resolution<sup><xref ref-type="bibr" rid="CR36">36</xref></sup> with Chromosight detection of loop, border and hairpin patterns. The darker, the more contacts. <bold>b</bold> Left: pileup plots of windows centered on detected loops, borders and hairpins with the number of detections. Right: bar plots showing proportion in Rad21 peaks for detected loops, proportion in CTCF peaks for detected borders and proportion of NIPBL peaks for detected hairpins and associated <italic>p</italic>-value (Fisher test, two-sided). <bold>c</bold> Detection of loops in the <italic>B. subtilis</italic> genome. Subset of the <italic>B. subtilis</italic> genome-wide contact map near the replication origin. The darker, the more contacts. Loops are called with Chromosight and annotated with blue circles. Under the contact map the ChIP-chip signal deposition of <italic>B. subtilis</italic> SMC is plotted<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>.  The pileup plot of the detected loops, and a bar plot showing enrichment of SMC in the anchors of the detected loops (Fisher test, two-sided), are indicated underneath. <bold>d</bold> Contact map of the Epstein Barr virus genome<sup><xref ref-type="bibr" rid="CR38">38</xref></sup>. Called loops using Chromosight are indicated with blue circles. The ChIP-seq deposition signal of Rad21 and CTCF is plotted under the map. Associated pileup plot of the detections is indicated underneath.</p></caption><graphic xlink:href="41467_2020_19562_Fig3_HTML" id="d30e833"/></fig></p>
      <p id="Par14">With default parameters, Chromosight identified 18,839 loops (compared to ≃10,000 detected in ref. <sup><xref ref-type="bibr" rid="CR6">6</xref></sup>) whose anchors fall mostly (~ 58%, <italic>P</italic> &lt; 10<sup>−16</sup>) into loci enriched in cohesin subunit Rad21 (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b). Decreasing the detection threshold (Pearson coefficient parameter) allows to detect lower intensity but relevant patterns (Supplementary Fig. <xref rid="MOESM1" ref-type="media">7a</xref>). The program also identified 9638 borders, ~75% of which coincide with CTCF binding sites, compared to ~14% expected (<italic>P</italic> &lt; 10<sup>−16</sup>). In human, TADs are known to be delimited by CTCF-enriched sites, suggesting that Chromosight does indeed correctly identify boundaries involved in TADs delimitation. Finally, Chromosight detected 3,782 hairpin-like structures (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b), a pattern not systematically sought for in Hi–C maps. The chromosome coordinates for this pattern appeared enriched in cohesin loading factor NIPBL (2 fold effect, <italic>P</italic> &lt; 10<sup>−16</sup>), suggesting that these hairpin-like structures could be interpreted as cohesin loading points (Supplementary Fig. <xref rid="MOESM1" ref-type="media">6</xref>). To test for a role of cohesin and NIPBL in generating these patterns, we quantified loops and hairpins on contact maps generated from cells depleted either in cohesin or NIPBL. Both conditions were associated with a disappearance of the detected patterns (Supplementary Fig. <xref rid="MOESM1" ref-type="media">8</xref>), further supporting their formation hypothesis. Finally, we called loops de novo along the genomes of various animals from the DNA Zoo project<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>, showing that stable loops of ≃100–150 kb are a conserved feature of animal genomes (Supplementary Fig. <xref rid="MOESM1" ref-type="media">9</xref>).</p>
      <p id="Par15">The loop detection efficiency was also tested using noisier, compact genomic contact maps. We applied it on the 3C-seq data generated from bacterium <italic>B. subtilis</italic><sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. Chromosight identified 109 loops distributed throughout the chromosome (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c). Annotation of loop anchor positions showed a strong enrichment with the bacteria Smc-ScpAB condensin complexes (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c). Some of these loops were surprisingly large, bridging loci separated by more than 100 kb (Supplementary Fig. <xref rid="MOESM1" ref-type="media">10</xref>) (for a genome size of 4.1 Mb). Several of these large loops may correspond to the bridging of replichores at positions symmetric with respect to the origin of replication (Supplementary Fig. <xref rid="MOESM1" ref-type="media">10</xref>). This is in agreement with<sup><xref ref-type="bibr" rid="CR10">10</xref></sup> which showed how SMC condensin SMC-ScpAB complexes loaded at sites adjacent to the origin of replication of the chromosome tether the left and right chromosome arms together while traveling from the origin to the terminus.</p>
      <p id="Par16">Finally, we used Chromosight to detect loops on contact data generated using pair-end tag sequencing (ChIA-PET)<sup><xref ref-type="bibr" rid="CR38">38</xref></sup>, which captures contacts between DNA segments associated to a protein of interest. We used ChIA-PET data for CTCF from human lymphoblastoids<sup><xref ref-type="bibr" rid="CR38">38</xref></sup> binned at a very high resolution (500 bp). Lymphoblastoids are immortalised B lymphocytes, they contain episomes of the Epstein Barr Virus (EBV), a DNA virus that is approximately 172 kb in size and is involved in the development of certain tumours<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>. Surprisingly, Chromosight detected several loops (5) inside the genome of the Epstein Barr virus<sup><xref ref-type="bibr" rid="CR38">38</xref></sup>. These loops, of a few dozen kb in size, coincide with the position of the cohesin (Rad21) and CTCF binding sites present along the viral genome (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d). Such interactions have been suggested from 3C qPCR data<sup><xref ref-type="bibr" rid="CR40">40</xref></sup>. Automatic detection now unambiguously supports a specific viral chromosome structure that could impact the transcriptional regulation and metabolism of the virus<sup><xref ref-type="bibr" rid="CR40">40</xref></sup>.</p>
    </sec>
    <sec id="Sec6">
      <title>Application to different proximity ligation protocols</title>
      <p id="Par17">Besides Hi–C, Chromosight can be applied on contact data generated with alternative protocols developed to explore various aspect of chromosomal organisation (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a). We retrieved publicly available datasets from asynchronous human cells spanning a range of techniques (i.e. ChIA-PET, DNA SPRITE, HiChIP and Micro-C) from the 4D Nucleome Data Portal<sup><xref ref-type="bibr" rid="CR41">41</xref></sup>, and applied loops detection in the resulting contact maps. In situ ChIA-PET<sup><xref ref-type="bibr" rid="CR42">42</xref></sup> quantifies the contact network mediated by a specific protein of interest thanks to the addition of an immunoprecipitation step. Chromosight required adjustment of a single parameter to produce visually satisfying loop calling in in situ ChIA-PET data. We then performed loop detection on DNA Split-Pool Recognition of Interactions by Tag Extension (SPRITE) data<sup><xref ref-type="bibr" rid="CR43">43</xref></sup>. This approach requires cross-linking and fragmentation of chromatin but does not use ligation. Instead, it splits the content into 96-well plates with barcode molecules in each well. The barcode signature allows clustering of complexes that were originally part of a higher-order chromatin structure in the nucleus. Chromosight was able to detect patterns that visually correspond to loops, although the noise present in this original proof-of-principle dataset made detection challenging. We then analysed HiChIP data<sup><xref ref-type="bibr" rid="CR44">44</xref></sup>, a protocol similar to ChIA-PET but with a better signal-to-noise ratio, and that requires a lower amount of input DNA. The results of loop calling on HiChIP matrices were very close to those from Hi–C (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a). Finally, loops were called on the Micro-C data recently generated from human embryonic stem cells (hESC)<sup><xref ref-type="bibr" rid="CR45">45</xref></sup>. Micro-C uses MNase digestion and a dual crosslink procedure, which allows a contact resolution down to the nucleosome scale. This approach resulted in the highest number of loops (~45,000 Fig. <xref rid="Fig4" ref-type="fig">4</xref>b); a visual inspection confirmed that most of them appeared relevant. The number of detected loops in each protocol is directly dependent on the coverage, but these analyses show that Chromosight can conveniently be used for the analysis of data generated through various proximity ligation protocols with minimal, if any, tuning.<fig id="Fig4"><label>Fig. 4</label><caption><title>Analyses with data from alternative contact technologies.</title><p><bold>a</bold> Magnification of <italic>Homo sapiens</italic> chromosome 2 contact maps generated with five different experimental methods (around STAT1 gene; bin:10 kb): Hi–C<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>, In situ ChiA-PET of CTCF<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>, DNA SPRITE<sup><xref ref-type="bibr" rid="CR43">43</xref></sup>, HiChIP of cohesin<sup><xref ref-type="bibr" rid="CR44">44</xref></sup>, Micro-C<sup><xref ref-type="bibr" rid="CR45">45</xref></sup>. All cells are cycling GM12878 cell types except for Micro-C (hESC). Blue circles: loops detected using Chromosight. The corresponding number of reads in each of the genome-wide map is indicated above the panels. The parameter (if any) notified to Chromosight is also indicated above each map. <bold>b</bold> Number of loops detected using Chromosight with default parameters for the five datasets. <bold>c</bold> Left: loop spectrum computed using Chromosight in quantify mode on pairs of cohesin peaks for the five datasets (Methods). Curves represent lowess-smoothed data with 95% confidence intervals. Right: associated pileup plots of the quantified positions for the five different experimental methods.</p></caption><graphic xlink:href="41467_2020_19562_Fig4_HTML" id="d30e1014"/></fig></p>
      <p id="Par18">In parallel to the loop calling mode, we also used Chromosight in its quantify mode to measure the loop signal between pairs of cohesin peaks as a function of their genomic distance for the different protocols in asynchronous human cells (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c). The resulting spectra were quite similar, with loop scores peaking around 120 kb for each protocol. Surprisingly, a secondary peak was also clearly visible at 250 kb, corresponding to about twice the fundamental frequency. This peak was clearest with the Micro-C data. These peaks were absent from dataset generated directly on mitotic condensed chromosomes (<italic>T</italic> = 0 from ref. <sup><xref ref-type="bibr" rid="CR46">46</xref></sup>), but using the same ChIP-seq dataset (Supplementary Fig. <xref rid="MOESM1" ref-type="media">8c</xref>). The median distance between cohesin peaks called from ChIP-seq was 468 kb, suggesting that this parameter didn’t introduce a bias accounting in the 120 kb. This double peak in the distribution of cohesin contacts as a function of their genomic distance in interphase cells remains to be validated independently, and its signification characterised.</p>
    </sec>
    <sec id="Sec7">
      <title>Point and click mode</title>
      <p id="Par19">In addition to the kernels presented here (loops, borders, hairpins), visual inspection of the contact maps may inspire scientists to seek for new patterns of interest for quantitative analysis. We have therefore included a “point and click” mode that allows easy manual inspection of Hi–C contact maps to select patterns identified by users. The user clicks on positions corresponding to patterns of interests. For each position, a window will be drawn by the program. A new kernel is then automatically generated by summing all windows and applying a Gaussian filter to attenuate the fluctuations resulting from the small number of selected positions. This kernel can then be used in the other modes of Chromosight (detection, quantification) for further analyses.</p>
      <p id="Par20">We illustrate this functionality to investigate the pattern of centromere-centromere interactions in yeast. Yeasts contact maps are scattered with cross-shaped dots corresponding to inter-chromosomal contacts between peri-centromeric positions. This cross-shaped pattern is characteristic of the Rabl configuration of those genomes, where all centromeres are maintained in the vicinity of each other at the level of the microtubule organising center<sup><xref ref-type="bibr" rid="CR47">47</xref>,<xref ref-type="bibr" rid="CR48">48</xref></sup>. As a result, peri-centromeric regions collide with each other more frequently than with the rest of the genome, resulting in a distinct trans pattern. In budding yeast, the 16 centromeres result in 120 discrete, inter-chromosomal cross-shaped dots. We selected (by double-clicking) 15 patterns of these <italic>S. cerevisiae</italic> centromere contacts. The resulting kernel was then used to perform the detection of similar structures in the genome contact map of another yeast species, <italic>Candida albicans</italic>, a diploid opportunistic pathogen which contains 8 pairs of chromosomes (resolution: 5 kb, ref. <sup><xref ref-type="bibr" rid="CR49">49</xref></sup>).</p>
      <p id="Par21">Using the kernel generated de novo from the <italic>S. cerevisiae</italic> contact map, Chromosight automatically detected 26 out of the 28 inter-centromeric patterns of <italic>C. albicans</italic>, along with one false positive (most likely a genome misassembly, located at the edge of the map) (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). These positions are nevertheless sufficient to point at centromere positions, and can for instance then be used to characterise their genomic coordinates<sup><xref ref-type="bibr" rid="CR47">47</xref></sup>.<fig id="Fig5"><label>Fig. 5</label><caption><title>Point and click mode.</title><p><bold>a</bold> Whole-genome contact map of <italic>S. cerevisiae</italic><sup><xref ref-type="bibr" rid="CR8">8</xref></sup> with 15 inter-centromere patterns that were selected by hand. Darker means more contacts. <bold>b</bold> Chromosight generates a new kernel by summing all the selected patterns and applying a Gaussian filter. <bold>c</bold> Chromosight detection of the inter-centromeres patterns in the whole-genome contact map of <italic>C. albicans</italic><sup><xref ref-type="bibr" rid="CR49">49</xref></sup> with the resulting pileup plot of the 27 detections.</p></caption><graphic xlink:href="41467_2020_19562_Fig5_HTML" id="d30e1099"/></fig></p>
      <p id="Par22">Note that, although subtelomeric regions in yeast tend to cluster in yeast nuclei and therefore display discrete contacts reminiscent of those of peri-centromeric contacts, Chromosight was able to discriminate between those two patterns, detecting specifically inter-centromeric interactions. The program was therefore able to correctly assess the subtle geometrical differences between these two patterns. Overall, this analysis shows the ability of Chromosight to quickly detect any type of user-defined pattern. We anticipate that many more patterns will be added to the catalogue of visual patterns linked to different molecular mechanisms of chromosome architecture.</p>
    </sec>
  </sec>
  <sec id="Sec8" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par23">In this work, we present Chromosight, a computer vision program to detect 3D structures in chromosome contact maps. We show that Chromosight outmatches other programs designed to detect chromosome loops, and that it can be used to extract other biologically relevant patterns generated through different chromosome capture derivatives.</p>
    <p id="Par24">Chromosight is versatile and we expect that additional pattern configurations will be added by the community, such as stripes, bow-shaped patterns, patterns associated to misassemblies or structural variations (e.g. inversions, translocations...) or any pattern of interest that the user can propose. The approach could therefore be used to investigate structural rearrangements in cancer cells, for instance, although the sensitivity of the program to detect rearrangements taking place in only a fraction of a population of cells remains to be tested. Similarly, the potential of the approach to develop new Hi–C based genome scaffolding algorithms could also be explored in the future<sup><xref ref-type="bibr" rid="CR50">50</xref>,<xref ref-type="bibr" rid="CR51">51</xref></sup>. The program has a great flexibility that allows to work with diverse biological data and address different questions, either using the de novo calling mode or the quantification mode. For instance, the possibility of varying the size of the loop kernel allows to optimise it for different conditions: larger kernels are more tolerant to noisy data (Fig <xref rid="Fig3" ref-type="fig">3</xref>c) as they dampen the fluctuations whereas smaller kernels allow to detect loops very close to the main diagonal (Supplementary Fig. <xref rid="MOESM1" ref-type="media">7</xref>).</p>
    <p id="Par25">A possible extension of the present approach is the addition of an iterative feedback step to the general flowchart of the current algorithm. Indeed, the output pileup after the first run of detection can be reused in another iteration of detection on the same data. This step could allow a finer adaptation to the data and to detect patterns a little further away from the initial kernel while keeping the basic characteristics.</p>
    <p id="Par26">With decreasing sequencing costs, new experimental protocols and optimised methods for amplifying specific genomic regions, we expect that the folding of the genomes of many species will be investigated in the near future using chromosome contact techniques. The algorithmic approach we present here provides a computational and statistical framework for the discovery of new principles governing chromosome architecture.</p>
  </sec>
  <sec id="Sec9">
    <title>Methods</title>
    <sec id="Sec10">
      <title>Simulation of Hi–C matrices</title>
      <p id="Par27">Simulated matrices were generated using a bootstrap strategy based on Hi–C data from chromosome 5 of mitotic <italic>S. cerevisiae</italic><sup><xref ref-type="bibr" rid="CR7">7</xref></sup> at 2 kb resolution. Three main features were extracted from the yeast contact data (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1</xref>): the probability of contact as a function of the genomic distance (<italic>P</italic>(<italic>s</italic>)), the positions of borders detected by HicSeg v1.1<sup><xref ref-type="bibr" rid="CR52">52</xref></sup> and positions of loops detected manually on chromosome 5. Positions from loops and borders were then aggregated into pileups of 17 × 17 pixels. We generated 2000 simulated matrices of 289 × 289 pixels. A first probability map of the same dimension is generated by making a diagonal gradient from <italic>P</italic>(<italic>s</italic>) representing the polymer behaviour. For each of the 2000 generated matrices, two additional probability maps are generated. The first by placing several occurrences of the border pileup on the diagonal, where the distance between borders follows a normal distribution fitted on the experimental coordinates. The second probability map is generated by adding the loop kernel 2–100 pixels away from the diagonal with the constraint that it must be aligned vertically and horizontally with border coordinates. For each generated matrix, the product of the <italic>P</italic>(<italic>s</italic>), borders and loops probability maps is then computed and used as a probability law to sample contact positions while keeping the same number of reads as the experimental map. This simulation method is implemented in the script chromo_simul.py, which can be found on the github repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/koszullab/chromosight_analyses_scripts">https://github.com/koszullab/chromosight_analyses_scripts</ext-link>.</p>
    </sec>
    <sec id="Sec11">
      <title>Benchmarking</title>
      <p id="Par28">To benchmark precision, sensitivity and F1 score, the simulated Hi–C data set with known loop coordinates were used. Each algorithm was run with a range of 60-180 parameter combinations (Supplementary Fig. <xref rid="MOESM1" ref-type="media">2</xref>) on 2000 simulated matrices and F1 score was calculated on the ensemble of results for each parameter combination separately (Supplementary Table <xref rid="MOESM1" ref-type="media">1</xref>). For each software, scores used in the final benchmark (Fig. <xref rid="Fig1" ref-type="fig">1</xref>) are those from the parameter combination that yielded the highest F1 score.</p>
      <p id="Par29">For the performance benchmark, HiCCUPS and HOMER were excluded. The former because it runs on GPU, and the latter because it uses genomic alignments as input and is much slower. The dataset used is a published high coverage Hi–C library<sup><xref ref-type="bibr" rid="CR36">36</xref></sup> from human lymphoblastoid cell lines (GM12878). To compare RAM usage across programs, this dataset was subsampled at 10%, 20%, 30%, 40% and 50% contacts and the maximum scanning distance was set to 2 Mbp. To compare CPU time, all programs were run on the full dataset, at different maximum scanning distances, with a minimum scanning distance of 0 and all other parameters left to default. All programs were run on a single thread, on a Intel(R) Core(TM) i7-8700K CPU at 3.70 GHz with 32 GB of available RAM.</p>
      <p id="Par30">Software versions used in the benchmark are Chromosight v0.9.0, hicexplorer v3.3.1, cooltools v0.2.0, homer 4.10 and hiccups 1.6.2. Input data, scripts and results of both benchmarks are available on Zenodo (10.5281/zenodo.3742095)</p>
    </sec>
    <sec id="Sec12">
      <title>Preprocessing of Hi–C matrices</title>
      <p id="Par31">Chromosight accepts input Hi–C data in cool format<sup><xref ref-type="bibr" rid="CR53">53</xref></sup>. Prior to detection, Chromosight balances the whole-genome matrix using the ICE algorithm<sup><xref ref-type="bibr" rid="CR31">31</xref></sup> to account for Hi–C associated biases. For each intrachromosomal matrix, the observed/expected contact ratios are then computed by dividing each pixel by the mean of its diagonal. This erases the diagonal gradient due to the power-law relationship between genomic distance and contact probability, thus emphasising local variations in the signal (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). Intra-chromosomal contacts above a user-defined distance are discarded to constrain the analysis to relevant scales and improve performances.</p>
    </sec>
    <sec id="Sec13">
      <title>Calculation of Pearson coefficients</title>
      <p id="Par32">Correlation coefficients are computed by convolving the template over the contact map. Convolution algorithms are often used in computer vision where images are typically dense. Hi–C contact maps, on the other hand, can be very sparse. Chromosight’s convolution algorithm is therefore designed to be fast and memory efficient on sparse matrices. It can also exclude missing bins when computing correlation coefficients. Those bins appear as white lines on Hi–C matrices and can be caused by repeated sequences or low coverage regions.</p>
      <p id="Par33">The contact map can be considered an image <sc>IMG</sc><sub><sc>CONT</sc></sub> where the intensity of each pixel <sc>IMG</sc><sub><sc>CONT</sc></sub>[<italic>i</italic>, <italic>j</italic>] represents the contact probability between loci <italic>i</italic> and <italic>j</italic> of the chromosome. In that context, each pattern of interest can be considered a template image <sc>IMG</sc><sub><sc>TMP</sc></sub> with <italic>M</italic><sub><sc>TMP</sc></sub> rows and <italic>N</italic><sub><sc>TMP</sc></sub> columns.</p>
      <p id="Par34">The correlation operation consists in sliding the template (<sc>IMG</sc><sub><sc>TMP</sc></sub>) over the image (<sc>IMG</sc><sub><sc>CONT</sc></sub>) and measuring, for each template position, the similarity between the template and its overlap in the image. We used the Pearson correlation coefficient as a the measure of similarity between the two images. The output of this matching procedure is an image of correlation coefficients <sc>IMG</sc><sub><sc>CORR</sc></sub> such that<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\rm{IMG}}}_{{\rm{CORR}}}[i,j]={\rm{Corr}}\,\left({{\rm{IMG}}}_{{\rm{CONT}}}\left[i-\frac{{M}_{{\rm{TMP}}}}{2}:i+\frac{{M}_{{\rm{TMP}}}}{2},j-\frac{{N}_{{\rm{TMP}}}}{2}:j+\frac{{N}_{{\rm{TMP}}}}{2}\right],\ {{\rm{IMG}}}_{{\rm{TMP}}}\right)$$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mrow><mml:mi mathvariant="normal">IMG</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">CORR</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="normal">Corr</mml:mi><mml:mspace width="0.25em"/><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">IMG</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">CONT</mml:mi></mml:mrow></mml:msub><mml:mfenced close="]" open="["><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">TMP</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>:</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">TMP</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">TMP</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>:</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">TMP</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="0.33em"/><mml:msub><mml:mrow><mml:mi mathvariant="normal">IMG</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">TMP</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2020_19562_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where the correlation operator <italic>C</italic><italic>o</italic><italic>r</italic><italic>r</italic>( ⋅ , ⋅ ) is defined as<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\rm{Corr}}\,\left({{\rm{IMG}}}_{{{X}}},{{\rm{IMG}}}_{{{Y}}}\right)	= \frac{{\rm{cov}}\,({{\rm{IMG}}}_{{{X}}},{{\rm{IMG}}}_{{{Y}}})}{{\rm{std}}\,({{\rm{IMG}}}_{{{X}}})\cdot {\rm{std}}\,({{\rm{IMG}}}_{{{Y}}})}\\ 	=\frac{{\mathop {\sum} \limits _{(m,n)\in X\cap Y}}({{\rm{IMG}}}_{{{X}}}[m,n]-\overline{{{\rm{IMG}}}_{{{X}}}})\cdot ({{\rm{IMG}}}_{{{Y}}}[m,n]-\overline{{{\rm{IMG}}}_{{{Y}}}})}{\sqrt{{\mathop {\sum} \limits_{(m,n)\in X\cap Y}}{({{\rm{IMG}}}_{{{X}}}[m,n]-\overline{{{\rm{IMG}}}_{{{X}}}})}^{2}}\cdot \sqrt{{\mathop {\sum} \limits_{(m,n)\in X\cap Y}}{({{\rm{IMG}}}_{{{Y}}}[m,n]-\overline{{{\rm{IMG}}}_{{{Y}}}})}^{2}}}$$\end{document}</tex-math><mml:math id="M4"><mml:mi mathvariant="normal">Corr</mml:mi><mml:mspace width="0.25em"/><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">IMG</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">IMG</mml:mi></mml:mrow><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">cov</mml:mi><mml:mspace width="0.25em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">IMG</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">IMG</mml:mi></mml:mrow><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">std</mml:mi><mml:mspace width="0.25em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">IMG</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:mi mathvariant="normal">std</mml:mi><mml:mspace width="0.25em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">IMG</mml:mi></mml:mrow><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:mi>X</mml:mi><mml:mo>∩</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">IMG</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">IMG</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">IMG</mml:mi></mml:mrow><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">IMG</mml:mi></mml:mrow><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:mi>X</mml:mi><mml:mo>∩</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">IMG</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">IMG</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msqrt><mml:mo>⋅</mml:mo><mml:msqrt><mml:mrow><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:mi>X</mml:mi><mml:mo>∩</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">IMG</mml:mi></mml:mrow><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">IMG</mml:mi></mml:mrow><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41467_2020_19562_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq1"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{{\rm{IMG}}}=\frac{1}{| X\cap Y| }\sum _{(m,n)\in X\cap Y}{\rm{IMG}}[m,n]$$\end{document}</tex-math><mml:math id="M6"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">IMG</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>∣</mml:mo><mml:mi>X</mml:mi><mml:mo>∩</mml:mo><mml:mi>Y</mml:mi><mml:mo>∣</mml:mo></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:mi>X</mml:mi><mml:mo>∩</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal">IMG</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2020_19562_Article_IEq1.gif"/></alternatives></inline-formula>, <italic>X</italic> ∩ <italic>Y</italic> is the set of pixel coordinates that are valid in image <sc>IMG</sc><sub><italic>X</italic></sub> and in image <sc>IMG</sc><sub><italic>Y</italic></sub>, and ∣<italic>X</italic> ∩ <italic>Y</italic>∣ is the number of valid pixels in <sc>IMG</sc><sub><italic>X</italic></sub> and <sc>IMG</sc><sub><italic>Y</italic></sub>. A pixel in <sc>IMG</sc><sub><sc>CONT</sc></sub> is defined as valid when it is outside a region with missing bins.</p>
    </sec>
    <sec id="Sec14">
      <title>Separation of high-correlation foci</title>
      <p id="Par35">Selection is done by localising specific local maxima within <sc>IMG</sc><sub><sc>CORR</sc></sub>. We proceeded as follows: first, we discard all points (<italic>i</italic>, <italic>j</italic>) where <sc>IMG</sc><sub><sc>CORR</sc></sub>[<italic>i</italic>, <italic>j</italic>] &lt; <italic>τ</italic><sub><sc>CORR</sc></sub>. An adjacency graph <italic>A</italic><sub><italic>d</italic><italic>x</italic><italic>d</italic></sub> is then generated from the <italic>d</italic> remaining points. The value of <italic>A</italic>[<italic>i</italic>, <italic>j</italic>] is a boolean indicating the (four-way) adjacency status between the <italic>i</italic>th and <italic>j</italic>th nonzero pixels. The scipy implementation of the CCL algorithm for sparse graphs<sup><xref ref-type="bibr" rid="CR54">54</xref></sup> is then used on <italic>A</italic> to label the different contiguous foci of nonzero pixels. Foci with less than two pixels are discarded. For each focus, the pixel with the highest coefficient is determined as the pattern coordinate.</p>
      <p id="Par36">Patterns are then filtered out if they overlap too many empty pixels or are too close from another detected pattern. The remaining candidates in <sc>IMG</sc><sub><sc>CORR</sc></sub> are scanned by decreasing order of magnitude: every time a candidate is appended to the list of selected local maxima, all its neighbouring candidates are discarded. The proportion of empty pixels allowed and the minimum separation between two patterns are also user defined parameters.</p>
    </sec>
    <sec id="Sec15">
      <title>Biological analyses</title>
      <p id="Par37">Pairs of reads were aligned independently using Bowtie2 (v2.3.4.1) with --very-sensitive-local against the <italic>S. cerevisiae</italic> SC288 reference genome (GCF000146045.2). Uncuts, loops and religation events were filtered as described in ref. <sup><xref ref-type="bibr" rid="CR55">55</xref></sup>. Contact data were binned at 2 kb and normalised using the ICE balancing method<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>. Hi–C matrices were generated from fastq files using hicstuff v2.3.0<sup><xref ref-type="bibr" rid="CR56">56</xref></sup>. Detection for biological analyses of yeast and human data was performed with default parameters using a 7 × 7 loop kernel available in Chromosight using --pattern loops_small unless mentioned otherwise. For enrichment analysis, cohesin peaks were defined using ChIP-seq data from<sup><xref ref-type="bibr" rid="CR57">57</xref></sup>. Raw reads were aligned with bowtie2 and only mapped positions with Mapping Quality superior to 30 were kept and signals were also binned at 2 kb to synchronise with Hi–C data. Peaks of cohesins were considered with ChIP/input  &gt;  1.5 and peaks closer than 10 kb to centromeres or rDNA were removed.</p>
      <p id="Par38">Annotation of highly expressed genes was done using RNA-seq data from<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>. Alignment was done as above. The distribution of the number of reads for each 2 kb bin was computed and the top 20% of the distribution were considered bins with high transcription. For border annotation, a set of plus or minus 1 bin on the detected positions is used. For human data, hg19 genome assembly was used with same strategy for alignment, construction and normalisation of contact data. ChIPseq peaks were retrieved from UCSC database (Supplementary Table <xref rid="MOESM1" ref-type="media">2</xref>). <italic>B. subtilis</italic> data were aligned with the PY79 genome version and the SMC signal was extracted using ChIP-chip data from<sup><xref ref-type="bibr" rid="CR58">58</xref></sup> and processed as described previously<sup><xref ref-type="bibr" rid="CR10">10</xref>,<xref ref-type="bibr" rid="CR59">59</xref></sup>. Peaks were annotated with the find_peaks function from scipy (v1.4.1), with parameters threshold = 0.1, width = 50. ChIA-PET data were processed as Hi–C data except that the contact maps were binned at a 500bp resolution. Epstein-Barr virus (EBV) genome, strain B95-8 (V01555.2) sequence was used to align the reads from EBV. For the detection in the different proximity ligation protocols, we retrieved publicly available data sets from the 4D Nucleome Data Portal<sup><xref ref-type="bibr" rid="CR41">41</xref></sup>, and applied loops detection in the resulting contact maps of the mcool files at 10 kb resolution with the default settings by possibly changing one option that is indicated in (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a).</p>
    </sec>
    <sec id="Sec16">
      <title>Reporting summary</title>
      <p id="Par39">Further information on research design is available in the <xref rid="MOESM3" ref-type="media">Nature Research Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec17">
      <supplementary-material content-type="local-data" id="MOESM1">
        <media xlink:href="41467_2020_19562_MOESM1_ESM.pdf">
          <caption>
            <p>Supplementary Information</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM2">
        <media xlink:href="41467_2020_19562_MOESM2_ESM.pdf">
          <caption>
            <p>Peer Review</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM3">
        <media xlink:href="41467_2020_19562_MOESM3_ESM.pdf">
          <caption>
            <p>Reporting Summary</p>
          </caption>
        </media>
      </supplementary-material>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Peer review information</bold> <italic>Nature Communications</italic> thanks Vera Pancaldi, and the other, anonymous, reviewer(s) for their contribution to the peer review of this work. Peer reviewer reports are available.</p>
    </fn>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>These authors contributed equally: Lyam Baudry, Axel Breuer.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> is available for this paper at 10.1038/s41467-020-19562-7.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>This work was initiated during a Hackathon between Institut Pasteur scientists and ENGIE engineers. We would like to thank all the people that allow the organisation of this event especially Anne-Gaelle Coutris, Romain Tchertchian and Olivier Gascuel. Julien Mozziconacci, Frédéric Beckouët and all the members of Spatial Regulation of Genomes unit are thanked for stimulating discussions and feedback. This work used the computational and storage services (TARS cluster) provided by the IT department at Institut Pasteur, Paris. C.M.-D. was supported by the Pasteur—Paris University (PPU) International PhD Program. A.B. works within the framework of a “Mécénat Compétence” contract of the company ENGIE. V.S. is the recipient of a Roux-Cantarini Pasteur fellowship. This research was supported by funding to R.K. from the European Research Council under the Horizon 2020 Program (ERC grant agreement 771813) and by ANR JCJC 2019, “Apollo” allocated to A.C.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>All authors contributed to the design of the algorithm. C.M.-D., A.B., L.B., A.C. implemented it. C.M.-D., R.M., L.B. compared to other algorithms. L.B. and A.C. designed strategy for simulations of data. C.M.-D., P.M., R.K. and A.C. analysed biological data and interpreted results. C.M.-D., A.B., L.B., R.K. and A.C. wrote the paper. All authors read and approved the final paper.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>All data associated with this study are publicly available and their reference numbers are listed in Supplementary Tables <xref rid="MOESM1" ref-type="media">2</xref> and <xref rid="MOESM1" ref-type="media">3</xref>. Intermediate results, benchmark code and data are available on Zenodo (10.5281/zenodo.3742095).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>Software and documentation available at <ext-link ext-link-type="uri" xlink:href="https://github.com/koszullab/chromosight">https://github.com/koszullab/chromosight</ext-link>. All scripts required to reproduce figures and analyses are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/koszullab/chromosight_analyses_scripts">https://github.com/koszullab/chromosight_analyses_scripts</ext-link>.</p>
  </notes>
  <notes id="FPar1" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par40">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dekker</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rippe</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Dekker</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kleckner</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Capturing chromosome conformation</article-title>
        <source>Science</source>
        <year>2002</year>
        <volume>295</volume>
        <fpage>1306</fpage>
        <lpage>1311</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1067799</pub-id>
        <?supplied-pmid 11847345?>
        <pub-id pub-id-type="pmid">11847345</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lieberman-Aiden</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive mapping of long-range interactions reveals folding principles of the human genome</article-title>
        <source>Science</source>
        <year>2009</year>
        <volume>326</volume>
        <fpage>289</fpage>
        <lpage>293</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1181369</pub-id>
        <?supplied-pmid 19815776?>
        <pub-id pub-id-type="pmid">19815776</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fullwood</surname>
            <given-names>MJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An oestrogen-receptor-alpha-bound human chromatin interactome</article-title>
        <source>Nature</source>
        <year>2009</year>
        <volume>462</volume>
        <fpage>58</fpage>
        <lpage>64</lpage>
        <pub-id pub-id-type="doi">10.1038/nature08497</pub-id>
        <?supplied-pmid 19890323?>
        <pub-id pub-id-type="pmid">19890323</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dixon</surname>
            <given-names>JR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Topological domains in mammalian genomes identified by analysis of chromatin interactions</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>485</volume>
        <fpage>376</fpage>
        <lpage>380</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11082</pub-id>
        <?supplied-pmid 3356448?>
        <pub-id pub-id-type="pmid">22495300</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nora</surname>
            <given-names>EP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Spatial partitioning of the regulatory landscape of the x-inactivation centre</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>485</volume>
        <fpage>381</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11049</pub-id>
        <?supplied-pmid 3555144?>
        <pub-id pub-id-type="pmid">22495304</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rao</surname>
            <given-names>SSP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A 3d map of the human genome at kilobase resolution reveals principles of chromatin looping</article-title>
        <source>Cell</source>
        <year>2014</year>
        <volume>159</volume>
        <fpage>1665</fpage>
        <lpage>80</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2014.11.021</pub-id>
        <?supplied-pmid 25497547?>
        <pub-id pub-id-type="pmid">25497547</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dauban</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Regulation of cohesin-mediated chromosome folding by eco1 and other partners</article-title>
        <source>Mol. Cell</source>
        <year>2020</year>
        <volume>77</volume>
        <fpage>1279</fpage>
        <lpage>1293</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2020.01.019</pub-id>
        <?supplied-pmid 32032532?>
        <pub-id pub-id-type="pmid">32032532</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Garcia-Luis</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fact mediates cohesin function on chromatin</article-title>
        <source>Nat. Struct. Mol. Biol.</source>
        <year>2019</year>
        <volume>26</volume>
        <fpage>970</fpage>
        <lpage>979</lpage>
        <pub-id pub-id-type="doi">10.1038/s41594-019-0307-x</pub-id>
        <?supplied-pmid 31582854?>
        <pub-id pub-id-type="pmid">31582854</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tanizawa</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>K-D</given-names>
          </name>
          <name>
            <surname>Iwasaki</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Noma</surname>
            <given-names>K-I</given-names>
          </name>
        </person-group>
        <article-title>Architectural alterations of the fission yeast genome during the cell cycle</article-title>
        <source>Nat. Struct. Mol. Biol.</source>
        <year>2017</year>
        <volume>24</volume>
        <fpage>965</fpage>
        <lpage>976</lpage>
        <pub-id pub-id-type="doi">10.1038/nsmb.3482</pub-id>
        <?supplied-pmid 28991264?>
        <pub-id pub-id-type="pmid">28991264</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marbouty</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Condensin-and replication-mediated bacterial chromosome folding and origin condensation revealed by hi-c and super-resolution imaging</article-title>
        <source>Mol. cell</source>
        <year>2015</year>
        <volume>59</volume>
        <fpage>588</fpage>
        <lpage>602</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2015.07.020</pub-id>
        <?supplied-pmid 26295962?>
        <pub-id pub-id-type="pmid">26295962</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Umbarger</surname>
            <given-names>MA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The three-dimensional architecture of a bacterial genome and its alteration by genetic perturbation</article-title>
        <source>Mol. Cell</source>
        <year>2011</year>
        <volume>44</volume>
        <fpage>252</fpage>
        <lpage>264</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2011.09.010</pub-id>
        <?supplied-pmid 22017872?>
        <pub-id pub-id-type="pmid">22017872</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marbouty</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Baudry</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Cournac</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Koszul</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Scaffolding bacterial genomes and probing host-virus interactions in gut microbiome by proximity ligation (chromosome capture) assay</article-title>
        <source>Sc. Adv.</source>
        <year>2017</year>
        <volume>3</volume>
        <fpage>e1602105</fpage>
        <pub-id pub-id-type="doi">10.1126/sciadv.1602105</pub-id>
        <pub-id pub-id-type="pmid">28232956</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nasmyth</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Haering</surname>
            <given-names>CH</given-names>
          </name>
        </person-group>
        <article-title>Cohesin: Its roles and mechanisms</article-title>
        <source>Ann. Rev. Gen.</source>
        <year>2009</year>
        <volume>43</volume>
        <fpage>525</fpage>
        <lpage>558</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-genet-102108-134233</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Naumova</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Organization of the mitotic chromosome</article-title>
        <source>Science</source>
        <year>2013</year>
        <volume>342</volume>
        <fpage>948</fpage>
        <lpage>953</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1236083</pub-id>
        <?supplied-pmid 24200812?>
        <pub-id pub-id-type="pmid">24200812</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bonev</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multiscale 3d genome rewiring during mouse neural development</article-title>
        <source>Cell</source>
        <year>2017</year>
        <volume>171</volume>
        <fpage>557</fpage>
        <lpage>572</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2017.09.043</pub-id>
        <?supplied-pmid 5651218?>
        <pub-id pub-id-type="pmid">29053968</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heinz</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcription elongation can affect genome 3d structure</article-title>
        <source>Cell</source>
        <year>2018</year>
        <volume>174</volume>
        <fpage>1522</fpage>
        <lpage>1536</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2018.07.047</pub-id>
        <?supplied-pmid 30146161?>
        <pub-id pub-id-type="pmid">30146161</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fudenberg</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Formation of chromosomal domains by loop extrusion</article-title>
        <source>Cell Rep.</source>
        <year>2016</year>
        <volume>15</volume>
        <fpage>2038</fpage>
        <lpage>2049</lpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2016.04.085</pub-id>
        <?supplied-pmid 4889513?>
        <pub-id pub-id-type="pmid">27210764</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Banigan</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Mirny</surname>
            <given-names>LA</given-names>
          </name>
        </person-group>
        <article-title>Loop extrusion: theory meets single-molecule experiments</article-title>
        <source>Curr. Opin. Cell Biol.</source>
        <year>2020</year>
        <volume>64</volume>
        <fpage>124</fpage>
        <lpage>138</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ceb.2020.04.011</pub-id>
        <?supplied-pmid 32534241?>
        <pub-id pub-id-type="pmid">32534241</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Brandão</surname>
            <given-names>HB</given-names>
          </name>
          <name>
            <surname>Le</surname>
            <given-names>TBK</given-names>
          </name>
          <name>
            <surname>Laub</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Rudner</surname>
            <given-names>DZ</given-names>
          </name>
        </person-group>
        <article-title><italic>Bacillus subtilis</italic> smc complexes juxtapose chromosome arms as they travel from origin to terminus.</article-title>
        <source>Science</source>
        <year>2017</year>
        <volume>355</volume>
        <fpage>524</fpage>
        <lpage>527</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aai8982</pub-id>
        <?supplied-pmid 28154080?>
        <pub-id pub-id-type="pmid">28154080</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brandão</surname>
            <given-names>HB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Rna polymerases as moving barriers to condensin loop extrusion</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2019</year>
        <volume>116</volume>
        <fpage>20489</fpage>
        <lpage>20499</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1907009116</pub-id>
        <?supplied-pmid 31548377?>
        <pub-id pub-id-type="pmid">31548377</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Forcato</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comparison of computational methods for hi-c data analysis</article-title>
        <source>Nat. Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>679</fpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4325</pub-id>
        <?supplied-pmid 28604721?>
        <pub-id pub-id-type="pmid">28604721</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Cao, Y. et al. Accurate loop calling for 3d genomic data with cloops. <italic>Bioinformatics</italic> 10.1093/bioinformatics/btz651 (2019).</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Durand</surname>
            <given-names>NC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Juicer provides a one-click system for analyzing loop-resolution hi-c experiments</article-title>
        <source>Cell Systems</source>
        <year>2016</year>
        <volume>3</volume>
        <fpage>95</fpage>
        <lpage>98</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2016.07.002</pub-id>
        <?supplied-pmid 27467249?>
        <pub-id pub-id-type="pmid">27467249</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ramírez</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>High-resolution tads reveal dna sequences underlying genome organization in flies</article-title>
        <source>Nat. Commun.</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>189</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-017-02525-w</pub-id>
        <?supplied-pmid 29335486?>
        <pub-id pub-id-type="pmid">29335486</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lun</surname>
            <given-names>ATL</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>diffhic: a bioconductor package to detect differential genomic interactions in hi-c data</article-title>
        <source>BMC Bioinform.</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>258</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-015-0683-0</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">Kaul, A., Bhattacharyya, S. &amp; Ay, F. Identifying statistically significant chromatin contacts from hi-c data with fithic2. <italic>Nat. Protoc</italic>. 10.1038/s41596-019-0273-0 (2020).</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heinz</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Simple combinations of lineage-determining transcription factors prime cis-regulatory elements required for macrophage and b cell identities</article-title>
        <source>Mol.Cell</source>
        <year>2010</year>
        <volume>38</volume>
        <fpage>576</fpage>
        <lpage>589</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2010.05.004</pub-id>
        <?supplied-pmid 20513432?>
        <pub-id pub-id-type="pmid">20513432</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dali</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Blanchette</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A critical assessment of topologically associating domain prediction tools</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2017</year>
        <volume>45</volume>
        <fpage>2994</fpage>
        <lpage>3005</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkx145</pub-id>
        <?supplied-pmid 28334773?>
        <pub-id pub-id-type="pmid">28334773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Le</surname>
            <given-names>TBK</given-names>
          </name>
          <name>
            <surname>Imakaev</surname>
            <given-names>MV</given-names>
          </name>
          <name>
            <surname>Mirny</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Laub</surname>
            <given-names>MT</given-names>
          </name>
        </person-group>
        <article-title>High-resolution mapping of the spatial organization of a bacterial chromosome</article-title>
        <source>Science</source>
        <year>2013</year>
        <volume>342</volume>
        <fpage>731</fpage>
        <lpage>734</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1242059</pub-id>
        <?supplied-pmid 24158908?>
        <pub-id pub-id-type="pmid">24158908</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">Lioy, V. S. et al. Multiscale structuring of the e. coli chromosome by nucleoid-associated and condensin proteins. <italic>Cell</italic>. <bold>172</bold>, 771–783 (2018).</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Imakaev</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Iterative correction of hi-c data reveals hallmarks of chromosome organization</article-title>
        <source>Nat. Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>999</fpage>
        <lpage>1003</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2148</pub-id>
        <?supplied-pmid 22941365?>
        <pub-id pub-id-type="pmid">22941365</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Haralick, R. M. &amp; Shapiro, L. G. <italic>Computer and Robot Vision</italic> 1st edn (Addison-Wesley Longman Publishing Co., Inc., USA, 1992).</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rao</surname>
            <given-names>SSP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A 3d map of the human genome at kilobase resolution reveals principles of chromatin looping</article-title>
        <source>Cell</source>
        <year>2014</year>
        <volume>159</volume>
        <fpage>1665</fpage>
        <lpage>1680</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2014.11.021</pub-id>
        <?supplied-pmid 25497547?>
        <pub-id pub-id-type="pmid">25497547</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Karolchik</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>The UCSC table browser data retrieval tool</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2004</year>
        <volume>32</volume>
        <fpage>493D</fpage>
        <lpage>496</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkh103</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Muller</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Characterizing meiotic chromosomes’ structure and pairing using a designer sequence optimized for hi-c</article-title>
        <source>Mol. Syst. Biol.</source>
        <year>2018</year>
        <volume>14</volume>
        <fpage>e8293</fpage>
        <pub-id pub-id-type="doi">10.15252/msb.20188293</pub-id>
        <?supplied-pmid 30012718?>
        <pub-id pub-id-type="pmid">30012718</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ghurye</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrating hi-c links with assembly graphs for chromosome-scale assembly</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2019</year>
        <volume>15</volume>
        <fpage>e1007273</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1007273</pub-id>
        <?supplied-pmid 31433799?>
        <pub-id pub-id-type="pmid">31433799</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dudchenko</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>De novo assembly of the <italic>Aedes aegypti</italic> genome using hi-c yields chromosome-length scaffolds</article-title>
        <source>Science</source>
        <year>2017</year>
        <volume>356</volume>
        <fpage>92</fpage>
        <lpage>95</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aal3327</pub-id>
        <?supplied-pmid 28336562?>
        <pub-id pub-id-type="pmid">28336562</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tang</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ctcf-mediated human 3d genome architecture reveals chromatin topology for transcription</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>163</volume>
        <fpage>1611</fpage>
        <lpage>27</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.11.024</pub-id>
        <?supplied-pmid 26686651?>
        <pub-id pub-id-type="pmid">26686651</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Küppers</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>B cells under influence: transformation of b cells by epstein-barr virus</article-title>
        <source>Nat. Rev. Immunol.</source>
        <year>2003</year>
        <volume>3</volume>
        <fpage>801</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1038/nri1201</pub-id>
        <?supplied-pmid 14523386?>
        <pub-id pub-id-type="pmid">14523386</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Arvey</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An atlas of the epstein-barr virus transcriptome and epigenome reveals host-virus regulatory interactions</article-title>
        <source>Cell Host Microbe</source>
        <year>2012</year>
        <volume>12</volume>
        <fpage>233</fpage>
        <lpage>45</lpage>
        <pub-id pub-id-type="doi">10.1016/j.chom.2012.06.008</pub-id>
        <?supplied-pmid 22901543?>
        <pub-id pub-id-type="pmid">22901543</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dekker</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The 4d nucleome project</article-title>
        <source>Nature</source>
        <year>2017</year>
        <volume>549</volume>
        <fpage>219</fpage>
        <lpage>226</lpage>
        <pub-id pub-id-type="doi">10.1038/nature23884</pub-id>
        <?supplied-pmid 28905911?>
        <pub-id pub-id-type="pmid">28905911</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Long-read chia-pet for base-pair-resolution mapping of haplotype-specific chromatin interactions</article-title>
        <source>Nat. Protoc.</source>
        <year>2017</year>
        <volume>12</volume>
        <fpage>899</fpage>
        <lpage>915</lpage>
        <pub-id pub-id-type="doi">10.1038/nprot.2017.012</pub-id>
        <?supplied-pmid 28358394?>
        <pub-id pub-id-type="pmid">28358394</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quinodoz</surname>
            <given-names>SA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Higher-order inter-chromosomal hubs shape 3d genome organization in the nucleus</article-title>
        <source>Cell</source>
        <year>2018</year>
        <volume>174</volume>
        <fpage>744</fpage>
        <lpage>757</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2018.05.024</pub-id>
        <?supplied-pmid 29887377?>
        <pub-id pub-id-type="pmid">29887377</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mumbach</surname>
            <given-names>MR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Hichip: efficient and sensitive analysis of protein-directed genome architecture</article-title>
        <source>Nat. Methods</source>
        <year>2016</year>
        <volume>13</volume>
        <fpage>919</fpage>
        <lpage>922</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3999</pub-id>
        <?supplied-pmid 27643841?>
        <pub-id pub-id-type="pmid">27643841</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krietenstein</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ultrastructural details of mammalian chromosome architecture</article-title>
        <source>Mol. Cell</source>
        <year>2020</year>
        <volume>78</volume>
        <fpage>554</fpage>
        <lpage>565</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2020.03.003</pub-id>
        <?supplied-pmid 32213324?>
        <pub-id pub-id-type="pmid">32213324</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abramo</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A chromosome folding intermediate at the condensin-to-cohesin transition during telophase</article-title>
        <source>Nat. Cell Biol.</source>
        <year>2019</year>
        <volume>21</volume>
        <fpage>1393</fpage>
        <lpage>1402</lpage>
        <pub-id pub-id-type="doi">10.1038/s41556-019-0406-2</pub-id>
        <?supplied-pmid 31685986?>
        <pub-id pub-id-type="pmid">31685986</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marie-Nelly</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Filling annotation gaps in yeast genomes using genome-wide contact maps</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>2105</fpage>
        <lpage>2113</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu162</pub-id>
        <?supplied-pmid 24711652?>
        <pub-id pub-id-type="pmid">24711652</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mizuguchi</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Barrowman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Grewal</surname>
            <given-names>SI</given-names>
          </name>
        </person-group>
        <article-title>Chromosome domain architecture and dynamic organization of the fission yeast genome</article-title>
        <source>FEBS Lett.</source>
        <year>2015</year>
        <volume>589</volume>
        <fpage>2975</fpage>
        <lpage>2986</lpage>
        <pub-id pub-id-type="doi">10.1016/j.febslet.2015.06.008</pub-id>
        <?supplied-pmid 26096785?>
        <pub-id pub-id-type="pmid">26096785</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Burrack</surname>
            <given-names>LS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Neocentromeres provide chromosome segregation accuracy and centromere clustering to multiple loci along a candida albicans chromosome</article-title>
        <source>PLOS Genet.</source>
        <year>2016</year>
        <volume>12</volume>
        <fpage>e1006317</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1006317</pub-id>
        <?supplied-pmid 27662467?>
        <pub-id pub-id-type="pmid">27662467</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Flot</surname>
            <given-names>J-F</given-names>
          </name>
          <name>
            <surname>Marie-Nelly</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Koszul</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Contact genomics: scaffolding and phasing (meta) genomes using chromosome 3d physical signatures</article-title>
        <source>FEBS Lett.</source>
        <year>2015</year>
        <volume>589</volume>
        <fpage>2966</fpage>
        <lpage>2974</lpage>
        <pub-id pub-id-type="doi">10.1016/j.febslet.2015.04.034</pub-id>
        <?supplied-pmid 25935414?>
        <pub-id pub-id-type="pmid">25935414</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <mixed-citation publication-type="other">Baudry, L. et al. instagraal: chromosome-level quality scaffolding of genomes using a proximity ligation-based scaffolder. <italic>Genom. Biol</italic>. 10.1186/s13059-020-02041-z (2020).</mixed-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lévy-Leduc</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Delattre</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mary-Huard</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Robin</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Two-dimensional segmentation for analyzing hi-c data</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>i386</fpage>
        <lpage>i392</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu443</pub-id>
        <?supplied-pmid 25161224?>
        <pub-id pub-id-type="pmid">25161224</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <mixed-citation publication-type="other">Abdennur, N. &amp; Mirny, L. A. Cooler: scalable storage for hi-c data and other genomically labeled arrays. <italic>Bioinformatics</italic> 10.1093/bioinformatics/btz540 (2019).</mixed-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <mixed-citation publication-type="other">Pearce, D. J. <italic>An Improved Algorithm for Finding the Strongly Connected Components of a Directed Graph</italic> (Victoria University, Wellington, 2005).</mixed-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cournac</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Marie-Nelly</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Marbouty</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Koszul</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Mozziconacci</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Normalization of a chromosomal contact map</article-title>
        <source>BMC Genom.</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>436</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-13-436</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <mixed-citation publication-type="other">Matthey-Doret, C. et al. hicstuff: Simple library/pipeline to generate and handle hi-c data. <italic>Zenodo</italic>, 10.5281/zenodo.4066351 (2020).</mixed-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <mixed-citation publication-type="other">Hu, B. et al. Biological chromodynamics: a general method for measuring protein occupancy across the genome by calibrating ChIP-seq. <italic>Nucleic Acids Res</italic>. 10.1093/nar/gkv670 (2015).</mixed-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gruber</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Errington</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Recruitment of condensin to replication origin regions by parb/spooj promotes chromosome segregation in <italic>B. subtilis</italic></article-title>
        <source>Cell</source>
        <year>2009</year>
        <volume>137</volume>
        <fpage>685</fpage>
        <lpage>696</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2009.02.035</pub-id>
        <?supplied-pmid 19450516?>
        <pub-id pub-id-type="pmid">19450516</pub-id>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marbouty</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Metagenomic chromosome conformation capture (meta3c) unveils the diversity of chromosome organization in microorganisms</article-title>
        <source>eLife</source>
        <year>2014</year>
        <volume>3</volume>
        <fpage>e03318</fpage>
        <pub-id pub-id-type="doi">10.7554/eLife.03318</pub-id>
        <?supplied-pmid 25517076?>
        <pub-id pub-id-type="pmid">25517076</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
