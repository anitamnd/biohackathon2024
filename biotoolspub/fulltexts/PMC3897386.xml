<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.0 20120330//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PeerJ</journal-id>
    <journal-id journal-id-type="iso-abbrev">PeerJ</journal-id>
    <journal-id journal-id-type="pmc">PeerJ</journal-id>
    <journal-id journal-id-type="publisher-id">PeerJ</journal-id>
    <journal-title-group>
      <journal-title>PeerJ</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2167-8359</issn>
    <publisher>
      <publisher-name>PeerJ Inc.</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3897386</article-id>
    <article-id pub-id-type="publisher-id">243</article-id>
    <article-id pub-id-type="doi">10.7717/peerj.243</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Bioinformatics</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Computational Biology</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Evolutionary Studies</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Genomics</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Microbiology</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PhyloSift: phylogenetic analysis of genomes and metagenomes</article-title>
    </title-group>
    <contrib-group>
      <contrib id="author-1" contrib-type="author" corresp="yes">
        <name>
          <surname>Darling</surname>
          <given-names>Aaron E.</given-names>
        </name>
        <xref ref-type="aff" rid="aff-1">1</xref>
        <xref ref-type="aff" rid="aff-2">2</xref>
        <email>aarondarling@ucdavis.edu</email>
      </contrib>
      <contrib id="author-2" contrib-type="author">
        <name>
          <surname>Jospin</surname>
          <given-names>Guillaume</given-names>
        </name>
        <xref ref-type="aff" rid="aff-2">2</xref>
      </contrib>
      <contrib id="author-3" contrib-type="author">
        <name>
          <surname>Lowe</surname>
          <given-names>Eric</given-names>
        </name>
        <xref ref-type="aff" rid="aff-2">2</xref>
      </contrib>
      <contrib id="author-4" contrib-type="author">
        <name>
          <surname>Matsen</surname>
          <given-names>Frederick A.</given-names>
          <suffix>IV</suffix>
        </name>
        <xref ref-type="aff" rid="aff-5">5</xref>
      </contrib>
      <contrib id="author-5" contrib-type="author">
        <name>
          <surname>Bik</surname>
          <given-names>Holly M.</given-names>
        </name>
        <xref ref-type="aff" rid="aff-2">2</xref>
      </contrib>
      <contrib id="author-6" contrib-type="author">
        <name>
          <surname>Eisen</surname>
          <given-names>Jonathan A.</given-names>
        </name>
        <xref ref-type="aff" rid="aff-3">3</xref>
        <xref ref-type="aff" rid="aff-4">4</xref>
      </contrib>
      <aff id="aff-1"><label>1</label><institution>ithree institute, University of Technology Sydney</institution>, <addr-line>Sydney</addr-line>, <country>Australia</country></aff>
      <aff id="aff-2"><label>2</label><institution>Genome Center, University of California</institution>, <addr-line>Davis, CA</addr-line>, <country>United States of America</country></aff>
      <aff id="aff-3"><label>3</label><institution>Department of Evolution and Ecology, University of California</institution>, <addr-line>Davis, CA</addr-line>, <country>United States of America</country></aff>
      <aff id="aff-4"><label>4</label><institution>Department of Medical Microbiology and Immunology, University of California</institution>, <addr-line>Davis, CA</addr-line>, <country>United States of America</country></aff>
      <aff id="aff-5"><label>5</label><institution>Fred Hutchinson Cancer Research Center</institution>, <addr-line>Seattle, WA</addr-line>, <country>United States of America</country></aff>
    </contrib-group>
    <contrib-group>
      <contrib id="editor-1" contrib-type="editor">
        <name>
          <surname>Moustafa</surname>
          <given-names>Ahmed</given-names>
        </name>
      </contrib>
    </contrib-group>
    <pub-date pub-type="epub" date-type="pub" iso-8601-date="2014-01-09">
      <day>9</day>
      <month>1</month>
      <year iso-8601-date="2014">2014</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2014</year>
    </pub-date>
    <volume>2</volume>
    <elocation-id>e243</elocation-id>
    <history>
      <date date-type="received" iso-8601-date="2013-03-21">
        <day>21</day>
        <month>3</month>
        <year iso-8601-date="2013">2013</year>
      </date>
      <date date-type="accepted" iso-8601-date="2013-12-19">
        <day>19</day>
        <month>12</month>
        <year iso-8601-date="2013">2013</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2014 Darling et al.</copyright-statement>
      <copyright-year>2014</copyright-year>
      <copyright-holder>Darling et al.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/3.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="https://peerj.com/articles/243"/>
    <abstract>
      <p>Like all organisms on the planet, environmental microbes are subject to the forces of molecular evolution. Metagenomic sequencing provides a means to access the DNA sequence of uncultured microbes. By combining DNA sequencing of microbial communities with evolutionary modeling and phylogenetic analysis we might obtain new insights into microbiology and also provide a basis for practical tools such as forensic pathogen detection.</p>
      <p>In this work we present an approach to leverage phylogenetic analysis of metagenomic sequence data to conduct several types of analysis. First, we present a method to conduct phylogeny-driven Bayesian hypothesis tests for the presence of an organism in a sample. Second, we present a means to compare community structure across a collection of many samples and develop direct associations between the abundance of certain organisms and sample metadata. Third, we apply new tools to analyze the phylogenetic diversity of microbial communities and again demonstrate how this can be associated to sample metadata.</p>
      <p>These analyses are implemented in an open source software pipeline called PhyloSift. As a pipeline, PhyloSift incorporates several other programs including LAST, HMMER, and pplacer to automate phylogenetic analysis of protein coding and RNA sequences in metagenomic datasets generated by modern sequencing platforms (e.g., Illumina, 454).</p>
    </abstract>
    <kwd-group kwd-group-type="author">
      <kwd>Metagenomics</kwd>
      <kwd>Phylogenetics</kwd>
      <kwd>Forensics</kwd>
      <kwd>Bayes factor</kwd>
      <kwd>Microbial diversity</kwd>
      <kwd>Community structure</kwd>
      <kwd>Microbial ecology</kwd>
      <kwd>Edge PCA</kwd>
      <kwd>Phylogenetic diversity</kwd>
      <kwd>Microbial evolution</kwd>
    </kwd-group>
    <funding-group>
      <award-group id="fund-1">
        <funding-source>US Department of Homeland Security</funding-source>
        <award-id>contract HSHQDC-11-C-00091</award-id>
      </award-group>
      <funding-statement>This work was performed under contract HSHQDC-11-C-00091 from the US Department of Homeland Security. The funder had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
  </article-meta>
</front>
<body>
  <sec>
    <title>Introduction</title>
    <p>Metagenomics – the sequencing of DNA isolated directly from the environment – has become a routinely used tool with wide applications (<xref ref-type="bibr" rid="ref-57">Thomas, Gilbert &amp; Meyer, 2012</xref>). Used primarily in the study of microorganisms, metagenome sequencing has now been carried out on a variety of environments where one finds microbes — from plants and animals to every kind of natural and man-made environment around the globe. Metagenomic sequencing has provided fundamental insight into the diversity of microbes and their function and roles in ecosystems. Initially, metagenomics was used largely as a way of simply obtaining some genomic information about organisms for which culturing technique was unknown (<xref ref-type="bibr" rid="ref-4">Béjà et al., 2000</xref>). However, due to decreases in the cost and the difficulty of sequencing, metagenomics has become a tool for studying any microbial community, regardless of cultivability.</p>
    <p>One strength of metagenomic approaches arises from the ability to sample the genomes of organisms in a particular environment approximately uniformly at random. This effect is achieved with the random “shotgun” sequencing methods originally applied for <italic>de novo</italic> genome sequencing of individual organisms (<xref ref-type="bibr" rid="ref-60">Venter et al., 2004</xref>; <xref ref-type="bibr" rid="ref-59">Tyson et al., 2004</xref>). From random shotgun sequence data of DNA isolated from environmental samples, one can make inferences about what organisms are present in a sample (i.e., who is there?) as well as their functional potential (i.e., what are they doing?). In addition, by comparing shotgun metagenomic data across samples one can study larger scale issues such as ecology and biogeography and also attempt to correlate particular organisms or functions with “metadata” about samples (e.g., health status, nutrient cycling rates, etc <xref ref-type="bibr" rid="ref-58">Tringe et al., 2005</xref>). Furthermore, by sampling a community directly one can avoid certain problems inherent in culturing such as contamination, population bottlenecking, and taxonomic bias (<xref ref-type="bibr" rid="ref-17">Eisen, 2007</xref>). In this sense metagenomics can be considered an extension of “culture-independent” ribosomal RNA gene surveys (<xref ref-type="bibr" rid="ref-24">Hugenholtz, Goebel &amp; Pace, 1998</xref>). The great potential for novel insight into microbial communities has led researchers in fields as diverse as medicine and agriculture, law enforcement, biodefense, ecology, evolution, and industry to apply metagenomic methods.</p>
    <p>Athough great potential exists for metagenomics to yield insight into the hidden world of microbes, many challenges remain before this potential can be realized. Perhaps the biggest challenges lie in analysis of the data (<xref ref-type="bibr" rid="ref-12">Chen &amp; Pachter, 2005</xref>). First, metagenomic samples reflect entire communities of organisms, unlike “traditional” genome sequencing of individual organisms or clones (i.e., from cultures of a single isolate where genetic diversity has undergone a bottleneck). The large number of microbial taxa in environmental samples can be a challenge for some types of analysis. Within-species genomic polymorphism presents an even greater challenge (<xref ref-type="bibr" rid="ref-29">Kunin et al., 2008</xref>). This challenge arises largely because shotgun metagenomic sequencing protocols destroy some of the most valuable information present in a sample: genetic linkage. Loss of linkage information occurs in two ways: during sample extraction and fragmentation of DNA for sequencing. In nearly all metagenomic sample processing methods, cells from the microbial community are lysed together to obtain a common pool of DNA. This practice causes DNA from many different cells to mix together, so that the cellular compartmentalization of individual genotypes is destroyed. Subsequently, long chromosome-scale DNA fragments are typically broken by mechanical or enzymatic means into fragments small enough for processing with current sequencing protocols. The resulting sequenced fragments are usually less than 1 kbp in length. Although it is possible to generate data for larger fragments via cloning (<xref ref-type="bibr" rid="ref-4">Béjà et al., 2000</xref>) or using Pacific Biosciences sequencing, most metagenomic data is currently being generated with short read/short insert sequencing chemistry such as that offered by Illumina. Though short read methods are quicker, easier, and lower cost per base and per read than large fragment approaches, there is a tradeoff in information quality. The shearing results in further loss of genetic linkage information, since we no longer have direct information on how short DNA fragments are arranged into chromosome-scale molecules.</p>
    <p>The lack of linkage information limits the ability to use metagenomic data for phylogenetic and population genetic analysis, since most current methods assume complete linkage information is available. In practice, improved sample processing methods could potentially retain the genetic linkage information of a microbial community throughout the sequencing process. High throughput single-cell genomics (e.g., applied to hundreds or thousands of cells) offers an alternative to the standard metagenomics workflow that preserves information about the compartmentalization of genetic material into cells (<xref ref-type="bibr" rid="ref-62">Woyke et al., 2010</xref>; <xref ref-type="bibr" rid="ref-32">Lasken, 2012</xref>; <xref ref-type="bibr" rid="ref-48">Rinke et al., 2013</xref>). However, single cell approaches are still limited in their utility by a number of technical issues including contamination, expensive and extensive equipment needs, missing data, and the creation of chimeras (<xref ref-type="bibr" rid="ref-6">Blainey, 2013</xref>); they will always be more limited in throughput than their standard metagenomics counterparts.</p>
    <p>Thus the research community is left with developing and using computational methods to sift through and make sense of short read, random shotgun metagenomic data. Though there are many important steps in analyzing metagenomic data, we believe that a critical component is phylogenetic analysis of the sequences. Among the uses of phylogenetic analysis in metagenomics are: improved classification of sequences using phylogenetic methods, functional prediction for genes, alternative metrics of alpha and beta diversity, improved identification of operational taxonomic units (OTUs), and sequence binning (<xref ref-type="bibr" rid="ref-41">Meyer et al., 2008</xref>; <xref ref-type="bibr" rid="ref-38">Matsen, Kodner &amp; Armbrust, 2010</xref>; <xref ref-type="bibr" rid="ref-19">Evans &amp; Matsen, 2012</xref>; <xref ref-type="bibr" rid="ref-27">Kembel et al., 2011</xref>; <xref ref-type="bibr" rid="ref-36">Matsen &amp; Evans, 2013</xref>; <xref ref-type="bibr" rid="ref-54">Stark et al., 2010</xref>; <xref ref-type="bibr" rid="ref-65">Wu &amp; Scott, 2012</xref>; <xref ref-type="bibr" rid="ref-8">Brady &amp; Salzberg, 2009</xref>; <xref ref-type="bibr" rid="ref-9">Brady &amp; Salzberg, 2011</xref>; <xref ref-type="bibr" rid="ref-52">Sharpton et al., 2011</xref>; <xref ref-type="bibr" rid="ref-26">Jolley et al., 2012</xref>; <xref ref-type="bibr" rid="ref-55">Sunagawa et al., 2013</xref>; <xref ref-type="bibr" rid="ref-18">Eisen, 2012</xref>).</p>
    <p>In the present manuscript, we introduce PhyloSift, a new method for phylogenetic analysis of metagenomic samples and for comparison of community structure among multiple related samples. The new method leverages phylogenetic models of molecular evolution to provide high resolution detection of organisms in a metagenome. Our approach is based on well known statistical phylogenetic models, is amenable to Bayesian hypothesis testing, and uses name-independent and OTU-free analyses to provide higher resolution about microbial community assemblages (versus methods that rely on taxonomy or OTUs). These methods can be applied to any single phylogeny at a time, and expand on our previous experience building AMPHORA (<xref ref-type="bibr" rid="ref-66">Wu &amp; Eisen, 2008</xref>). We additionally propose a set of 37 “elite” marker gene families that have largely congruent phylogenetic histories, thus improving the limit of detection for rare organisms in microbial communities. We contribute an open-source implementation of the method that has been engineered for ease-of-use on 64-bit Linux and Mac platforms. Finally, we compare the features of PhyloSift to some related methods to provide readers with insight into when use of our approach is and is not appropriate.</p>
    <sec>
      <title>Previous work</title>
      <sec>
        <title>Estimating community composition from amplicon data</title>
        <p>High throughput sequencing of marker gene amplicons (homologous loci such as 16S/18S rRNA) has emerged as a powerful and straightforward means to analyze microbial community structure. In contrast to shotgun metagenomics, amplicon approaches currently make the detection of rare taxa easier and require less starting genomic material than some metagenomic approaches, although transposon-catalyzed libraries have been generated from as little as 30 pg total material (<xref ref-type="bibr" rid="ref-2">Adey et al., 2010</xref>). By design rRNA surveys offer a “standardized” snapshot of microbial communities with reads from a single or small number of genes, considerably simplifying the tasks of alignment and analysis. Amplicon studies generally focus on characterizing and comparing microbial community structure without much analysis of functional gene repertoire.</p>
        <p>A variety of software pipelines can be used to process and analyze rRNA amplicon data (<xref ref-type="bibr" rid="ref-5">Bik et al., 2012</xref>). Inferring microbial assemblages typically relies on clustering of Operational Taxonomic Units (e.g., at a 97% sequence identity cutoff, using either <italic>de novo</italic> or reference-based clustering), where taxonomy is assigned to representative sequences using either BLAST searches or the RDP classifier (a Naive Bayesian Classifier <xref ref-type="bibr" rid="ref-61">Wang et al., 2007</xref>). Users can subsequently carry out a suite of downstream ecological and diversity analyses, including rarefaction (e.g., analyses for Chao1 estimation, OTU richness, or phylogenetic diversity as implemented in QIIME <xref ref-type="bibr" rid="ref-11">Caporaso et al., 2010</xref>), and Principal Component Analysis and Jackknife cluster analysis (e.g., using phylogeny-derived UniFrac distances <xref ref-type="bibr" rid="ref-35">Lozupone &amp; Knight, 2005</xref>).</p>
        <p>Amplicon approaches are now relatively cheap and easy to carry out. However some computational bottlenecks hinder fine-scale analysis of amplicon data. Analysis pipelines cannot readily distinguish rare members of a microbial community from noise in data caused by sequencing errors or chimeric reads (<xref ref-type="bibr" rid="ref-5">Bik et al., 2012</xref>). The RDP classifier (<xref ref-type="bibr" rid="ref-61">Wang et al., 2007</xref>) provides a statistical method for assessing confidence in taxonomic classifications. Any of these methods are limited relative to phylogenetic methods, in that they can only distinguish named groups of organisms and are limited to the resolution of the taxonomy.</p>
      </sec>
      <sec>
        <title>Community composition from metagenomes</title>
        <p>Methods have also been developed to estimate and analyze community composition from metagenomic data sets. These methods typically focus on a small subset of widely conserved marker genes mined from metagenomic sequence reads, usually representing 1% of any given shotgun dataset. Marker genes include well-characterized protein coding genes (e.g., ribosomal proteins or elongation factor genes) or conserved noncoding regions (e.g., rRNA). A variety of computational approaches are now available to investigate the community composition of metagenome datasets, including: AMPHORA (bacterial protein markers and tree insertion via parsimony) (<xref ref-type="bibr" rid="ref-66">Wu &amp; Eisen, 2008</xref>) and AMPHORA2 (bacterial/archael protein and DNA markers and tree insertion via likelihood or parsimony) (<xref ref-type="bibr" rid="ref-65">Wu &amp; Scott, 2012</xref>), MLTreeMap (reference gene families with taxonomic and functional information and tree insertion via maximum likelihood) (<xref ref-type="bibr" rid="ref-54">Stark et al., 2010</xref>), MetaPhyler (taxonomic classifiers for each of the reference marker genes published in the AMPHORA set) (<xref ref-type="bibr" rid="ref-33">Liu et al., 2010</xref>), EMIRGE (an expectation-maximization method to reconstruct rRNA genes from metagenome data and estimate taxon abundance) (<xref ref-type="bibr" rid="ref-42">Miller et al., 2011</xref>), and PhylOTU (phylogenetic methods to mine rRNA and define OTUs from metagenome data) (<xref ref-type="bibr" rid="ref-52">Sharpton et al., 2011</xref>).</p>
        <p>An interesting alternative approach is employed by the software MetaPHlan (<xref ref-type="bibr" rid="ref-51">Segata et al., 2012</xref>), which instead of using universally conserved genes, employs a database of clade-specific genes to estimate abundance of known taxonomic groups. This approach may work well in environments where the genomic diversity is very well characterized.</p>
        <p>Community composition analysis from metagenomes has some potential advantages over amplicon studies. For example, metagenome sequencing might avoid bias introduced by preferential binding of PCR primers to DNA from some organisms in amplicon studies and can also capture genomes from organisms which lack amplicon target genes, such as viruses. Whole-metagenome surveys also have the potential to provide insight into enzymatic and other functional processes in microbial communities, and so a single dataset can provide both community composition and functional information. One major limiting factor is that reference genome databases have narrow phylogenetic breadth relative to marker genes (e.g., rRNA) (<xref ref-type="bibr" rid="ref-63">Wu et al., 2009</xref>).</p>
      </sec>
      <sec>
        <title>Taxonomic classification of metagenome sequences</title>
        <p>Current methods for taxonomic classification of metagenomic sequences generally leverage one or two information sources: sequence composition and/or sequence identity to reference databases. Some existing composition classifiers include TACOA (supervised classification using <italic>k</italic>-nearest neighbors) (<xref ref-type="bibr" rid="ref-13">Diaz et al., 2009</xref>), PhyloPythia (<xref ref-type="bibr" rid="ref-40">McHardy et al., 2006</xref>) and PhyloPythiaS (multiclass support vector machine classifier using oligonucleotide frequencies) (<xref ref-type="bibr" rid="ref-46">Patil et al., 2011</xref>), NBC (Naive Bayesian Classifier) (<xref ref-type="bibr" rid="ref-49">Rosen, Reichenberger &amp; Rosenfeld, 2011</xref>), and Eu-Detect (oligonucleotide binning to separate eukaryote sequences in feature vector space) (<xref ref-type="bibr" rid="ref-43">Mohammed et al., 2011</xref>), although this is not an exhaustive list. Related methods such as Self-Organizing Maps (e.g., eSOMS (<xref ref-type="bibr" rid="ref-14">Dick et al., 2009</xref>)) can be applied to tetranucleotide frequencies in combination with other information sources such as contig coverage/abundance information to produce visual “maps” displaying different bins, although this does not result in taxonomic assignment.</p>
        <p>Identity-based classification methods compare metagenome sequences against reference databases to identify putative homologs. Examples of current identity-based classification tools include MEGAN (a Lowest Common Ancestor algorithm that summarizes BLAST outputs to assign taxonomy) (<xref ref-type="bibr" rid="ref-25">Huson et al., 2007</xref>), SORT-Items (reciprocal BLAST approach to detect significant orthology) (<xref ref-type="bibr" rid="ref-23">Haque et al., 2009</xref>), MTR (a variation on Lowest Common Ancestor approaches that uses multiple taxonomic ranks) (<xref ref-type="bibr" rid="ref-22">Gori et al., 2011</xref>), and ProViDE (analysis of alignment parameter thresholds, specifically customized for classifying viral sequences) (<xref ref-type="bibr" rid="ref-21">Ghosh et al., 2011</xref>). Some approaches are able to combine both sequence identity and composition when classifying (<xref ref-type="bibr" rid="ref-8">Brady &amp; Salzberg, 2009</xref>; <xref ref-type="bibr" rid="ref-9">Brady &amp; Salzberg, 2011</xref>). Again, this is not an exhaustive list.</p>
        <p>As the focus of our current work is on phylogenetic analysis rather than taxonomic classification, we do not discuss the relative merits of each approach to taxonomic classification in detail, nor do we provide benchmarks of taxonomic classification methods.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <p>PhyloSift implements a method for analyzing microbial community structure directly from metagenome sequence data. <xref ref-type="fig" rid="fig-1">Figure 1</xref> gives an overview of the analysis workflow as executed when analyzing a metagenomic sample. The analysis can be decomposed into four stages: 1. searching input sequences for identity to a database of known reference gene families; 2. adding input sequences to a multiple alignment with reference genes; 3. placement of input sequences onto a phylogeny of reference genes; and 4. generation of taxonomic summaries. We now describe the details of each step along with our design decisions and rationale.</p>
    <fig id="fig-1" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.7717/peerj.243/fig-1</object-id>
      <label>Figure 1</label>
      <caption>
        <title>PhyloSift client workflow.</title>
        <p>This workflow is applied to the user’s sequence data. DNA input sequences are processed via both the rRNA and protein parts of the workflow.</p>
      </caption>
      <graphic xlink:href="peerj-02-243-g001"/>
    </fig>
    <sec>
      <title>Reference gene families used by PhyloSift</title>
      <p>The standard PhyloSift database includes a set of 37 “elite” gene families previously identified as nearly universal and present in single-copy. These 37 gene families are a subset of the 40 previously reported (<xref ref-type="bibr" rid="ref-64">Wu, Jospin &amp; Eisen, 2013</xref>), with three families excluded because they frequently have partial length homologs in some lineages. These “elite” families represent about 1% of an average bacterial genome, as estimated from current genome databases. In other work we have demonstrated that phylogenetic trees reconstructed on individual genes in this set are generally congruent with each other (<xref ref-type="bibr" rid="ref-30">Lang, Darling &amp; Eisen, 2013</xref>; <xref ref-type="bibr" rid="ref-48">Rinke et al., 2013</xref>), suggesting that concatenating alignments of these families will yield a valid and more powerful estimate of their phylogenetic history. Other groups have also demonstrated that trees inferred from concatenate alignments demonstrate the least conflict with trees inferred separately from other microbial amino acid sequences (<xref ref-type="bibr" rid="ref-1">Abby et al., 2012</xref>). During the database update process (described below), these gene families are automatically extended to include putative homologs from eukarya and some viruses with large genomes such as the Mimivirus. Most small viral genomes lack homologs of these gene families.</p>
      <p>In addition to the elite 37 families, the PhyloSift database also includes four additional sets of gene families:</p>
      <list list-type="simple" id="list-1">
        <list-item>
          <label>•</label>
          <p>16S and 18S ribosomal RNA genes</p>
        </list-item>
        <list-item>
          <label>•</label>
          <p>mitochondrial gene families</p>
        </list-item>
        <list-item>
          <label>•</label>
          <p>Eukaryote-specific gene families</p>
        </list-item>
        <list-item>
          <label>•</label>
          <p>Viral gene families</p>
        </list-item>
      </list>
      <p>Combined, this yields a set of approximately 800 gene families in the standard PhyloSift database, most of which are viral.</p>
    </sec>
    <sec>
      <title>Detailed PhyloSift client workflow</title>
      <sec>
        <title>Sequence identity search</title>
        <p>This first step in a PhyloSift analysis aims to identify regions of the input sequences that may be homologous to gene families in the reference database. Input sequences to this step can be of any length ranging from short 30nt next-generation sequence reads to fully assembled genomes or metagenomes. Recognized input formats include FastA and FastQ (paired, unpaired, phred33, phred64, and/or interleaved pairing), and these can optionally be supplied as bzip2 or gzip compressed data files. Sequence input can be streamed via stdin or unix named pipes. Amino acid input sequences can also be processed.</p>
        <p>PhyloSift uses LAST (<xref ref-type="bibr" rid="ref-28">Kiełbasa et al., 2011</xref>) for sequence similarity search against the reference databases. We evaluated many possible search algorithms and implementations before finally selecting LAST. Other options we evaluated were BLAST (<xref ref-type="bibr" rid="ref-3">Altschul et al., 1997</xref>) v2.2.23, BLAST+ (<xref ref-type="bibr" rid="ref-10">Camacho et al., 2009</xref>) v2.2.28+, and RAPsearch2 (<xref ref-type="bibr" rid="ref-68">Zhao, Tang &amp; Ye, 2011</xref>) v2.04, and bowtie2 (<xref ref-type="bibr" rid="ref-31">Langmead et al., 2009</xref>) v2.0.0-beta5. Given the large volume of sequence data that must be processed, a key evaluation criterion was algorithm efficiency both in CPU time and memory requirements. A second criterion is the ability to perform six-frame translated searches of DNA sequence against an amino acid database with the possibility to tolerate frame-shift errors in the sequence. Among the evaluated methods, BLAST and BLAST+ were slowest (data not shown) and frameshift detection was non-functional in the version of BLAST+ we obtained from NCBI. We excluded these from further consideration. RAPsearch2 was much more computationally efficient than either BLAST or BLAST+, but the version we obtained could not process sequences &gt; 1 kbp and did not support frameshift detection. In our testing, LAST was able to process sequence data as quickly as RAPsearch2 (e.g., orders of magnitude more quickly than BLAST) and supports both frameshift detection and input sequences of arbitrary length. LAST also supports all three of the primary search types we require: DNA vs. DNA, DNA vs. AA, and AA vs. AA. We also evaluated bowtie2, a program typically used for mapping reads to a reference genome, for the purpose of screening reads against a database of noncoding RNA sequences (currently 16S and 18S). bowtie2 does not offer translated amino-acid searches. Relative to LAST, bowtie2 is able to identify similarity to the RNA database sequences more quickly. However, even though the speedup over LAST was substantial (data not shown), the compute time saved is small relative to the total time consumed in the complete PhyloSift client workflow. Therefore we decided to use only LAST since using only a single local alignment search tool simplifies the code. One shortcoming of LAST is that current versions do not support multithreaded parallelism. PhyloSift implements optional process-level parallelism by spawning multiple LAST searches against the protein database.</p>
        <p>One feature of reference gene family sequences being searched at this stage bears special mention. During database construction (described elsewhere) a representative subset of all available sequences are selected from each gene family to be searched in the search stage. These representatives are chosen to span the phylogenetic diversity of the gene family without including closely related sequences (see Section “PhyloSift database update workflow”). This is important because it reduces the volume of sequence to search and because part of LAST’s fast heuristic to identify candidate regions to align involves eliminating redundant and repetitive <italic>k</italic>-mers from the search space (<xref ref-type="bibr" rid="ref-28">Kiełbasa et al., 2011</xref>). Thus, a database constructed with all sequences (and not just divergent representatives) could in principle reduce sensitivity in aligning reads to those database sequences.</p>
        <p>The search stage identifies a set of candidate amino acid sequences from the input data that are similar to reference gene families. If DNA was provided as input the corresponding DNA sequences are also reported.</p>
      </sec>
      <sec>
        <title>Alignment to reference multiple alignment</title>
        <p>Prior to the alignment stage all input sequence regions with putative homology to reference gene families have been identified and extracted. In this stage, each candidate sequence is added to an amino acid or RNA multiple sequence alignment of the reference gene family. If the input sequences were DNA, a codon multiple sequence alignment congruent to the amino acid alignment is also generated.</p>
        <p>PhyloSift applies the <monospace>hmmalign</monospace> program from the HMMER 3.0 software package (<xref ref-type="bibr" rid="ref-15">Eddy, 2011</xref>) to add the candidate sequences to reference multiple sequence alignments. During construction of the PhyloSift reference database (described in section “Custom gene families”) a profile-HMM is generated from a multiple alignment of the gene family reference sequences. When processing candidate sequences, PhyloSift then uses the profile-HMM to map the input sequence to the reference multiple alignment. Application of a profile-HMM to align highly divergent sequences suffers some documented shortcomings, in particular that alignment accuracy decreases with divergence of source sequences used to construct the profile-HMM (<xref ref-type="bibr" rid="ref-34">Löytynoja, Vilella &amp; Goldman, 2012</xref>). This is one avenue for future improvement of PhyloSift and protein evolution models in general.</p>
        <p>Finally, PhyloSift concatenates the alignments of the 37 elite markers to a single multiple sequence alignment. When a single input sequence aligns to multiple genes, the aligned sequence becomes a single row in the concatenated alignment. All other sequences are represented in separate alignment rows.</p>
        <p>PhyloSift treats input sequences with similarity to non-coding RNAs differently than protein genes. Sequences longer than 600nt are aligned using Infernal’s <monospace>cmalign</monospace> program with the global alignment option. Short sequences are aligned with <monospace>hmmalign</monospace> to a profile-HMM of the non-coding RNA molecule. Although the profile-HMM does not capture secondary structure, the alignment computation is significantly faster with currently available versions of Infernal and HMMER. In our experience a banding threshold (a parameter that determines the size of the search space and hence amount of computational effort) of 1 × 10<sup>−20</sup> is required to obtain accurate local alignments with Infernal for short sequences, but this requires several minutes of CPU time per aligned sequence, which is not practical when aligning millions of amplicon sequences.</p>
      </sec>
      <sec>
        <title>Placement on a phylogenetic reference tree</title>
        <p>At this stage, aligned input sequences are placed onto a phylogenetic tree of the reference sequences. PhyloSift employs pplacer (<xref ref-type="bibr" rid="ref-38">Matsen, Kodner &amp; Armbrust, 2010</xref>) for this task. pplacer can be run in either maximum likelihood (ML, the default) or Bayesian mode. When run in ML mode, pplacer identifies and reports a set of most likely attachment points for each aligned sequence to the reference phylogeny, as well as a “likelihood weight ratio” representing the relative likelihood for the chosen attachment point over other possible attachment points.</p>
        <p>When run in Bayesian mode, pplacer calculates the posterior probability that the query sequence diverged from particular branches of the reference tree via direct integration. In contrast to ML placement which selects a single most likely attachment point, the branch posterior probability integrates over all possible attachment points for the query sequence on the branch. The posterior probability is used when calculating Bayes factors for lineage tests, described below.</p>
      </sec>
      <sec>
        <title>Taxonomic summary of read placements</title>
        <p>At this final stage of analysis, PhyloSift summarizes the phylogenetic placements in a human-friendly format. For each gene family, the PhyloSift database contains a gene-tree/taxonomy reconciliation encoding a pre-computed mapping of edges in the gene family phylogeny to edges in the NCBI taxonomy. The method used to calculate these reconciliations is described in the database update workflow section, below.</p>
        <p>Input to this stage of analysis is one or more “jplace” format (<xref ref-type="bibr" rid="ref-37">Matsen et al., 2012</xref>) files containing an edge-labeled reference tree for a gene family along with a collection of one or more sequence placements onto that tree. Information about each sequence’s placement consists of the log-likelihood of placement at several (usually up to 7, a configurable limit) of the highest likelihood edges on the reference tree, along with the probability mass that the sequence belongs at that position of the tree, and finally the weight of the sequence. When analyzing unassembled reads the sequence weights are typically always 1, when analyzing assembled contigs the weights may be set to a value based on estimated depth-of-coverage for that contig.</p>
        <p>PhyloSift parses each of the jplace files and uses the gene-tree/taxonomy reconciliation to convert probability mass over read placements into a probability mass over the taxonomy, summing these masses over all reads and gene families. Any particular edge in the gene tree may be mapped to many equally optimal locations in the taxonomy. PhyloSift distributes the placed sequence’s mass equally among all optimal locations.</p>
        <p>Finally, PhyloSift reports the summarized taxonomy probability mass distribution in a variety of formats.</p>
      </sec>
      <sec>
        <title>Visual presentation of taxonomic summary</title>
        <p>For easy visualization and exploratory data analysis, PhyloSift produces Krona plots (<xref ref-type="bibr" rid="ref-45">Ondov, Bergman &amp; Phillippy, 2011</xref>) showing taxonomic probability mass in the 37 elite gene families, and a separate Krona plot showing taxonomic probability mass distribution summed across the elite families and all other families.</p>
        <p><xref ref-type="fig" rid="fig-5">Figure 5</xref> provides an example of PhyloSift’s Krona reports.</p>
      </sec>
      <sec>
        <title>Parallelism and stream computing</title>
        <p>PhyloSift supports streaming input of sequences, this permits analysis to proceed as sequences arrive over a network connection, for example.</p>
      </sec>
      <sec>
        <title>Comparison among samples</title>
        <p>One of the unique aspects of PhyloSift relative to other methods for comparative metagenomics is that the phylogenetic approach we have implemented enables direct comparison of the phylogenetic structure and relative abundance of metagenome samples without resorting to taxonomic relative abundance estimates. Perhaps the most powerful exploratory data analysis tool for comparing community structures among samples is Edge Principal Component Analysis, or edge PCA (<xref ref-type="bibr" rid="ref-36">Matsen &amp; Evans, 2013</xref>). Edge PCA applies the standard dimensionality-reduction tool of PCA to a matrix where columns correspond to edges in the reference phylogeny, rows correspond to each sample, and each entry is the difference in placed sequence probability masses on either side of that edge. When applied in this manner, the eigenvalues of each eigenvector that results from PCA correspond to weights indicating how important each edge in the reference phylogeny is for explaining the variation among samples in that dimension. These eigenvectors can be naturally visualized as thickened branches along the reference phylogeny (<xref ref-type="bibr" rid="ref-36">Matsen &amp; Evans, 2013</xref>).</p>
        <p>PhyloSift includes the guppy program from pplacer, which in addition to edge PCA also provides means for hierarchical clustering of multiple samples using an algorithm specialized to the case of masses on a tree, calculation of Kantorovich-Rubenstein distances among samples (<xref ref-type="bibr" rid="ref-19">Evans &amp; Matsen, 2012</xref>), and other tools for calculating sample summary statistics such as weighted phylogenetic diversities.</p>
      </sec>
    </sec>
    <sec>
      <title>PhyloSift database update workflow</title>
      <p>An integral component of PhyloSift is an automated means to update the gene family database with newly sequenced genomes. Genome databases continue to grow quickly, with, on average, dozens of new genome sequences becoming available every week. The quality of these genomes can be highly variable, ranging from low-quality drafts to nearly finished sequence. PhyloSift’s database update mechanism incorporates some basic quality control measures.</p>
      <sec>
        <title>Acquiring new genome data</title>
        <p>The PhyloSift database update module maintains a local repository of all known and processed genomes. Upon initiating a new update, the database update module identifies any new genomes available in the NCBI finished, NCBI draft, NCBI WGS, and EBI viral, organelle, bacterial, archaeal, and eukaryal databases. Any new genomes are fetched and stored in the local repository.</p>
      </sec>
      <sec>
        <title>Gene family search and alignment workflow on each genome</title>
        <p>In this stage, the search and alignment stages of the previously described PhyloSift client workflow are run for each new genome. After this stage, the regions from each new genome that are highly similar to gene families in the database are identified, extracted, and aligned using the family’s profile-HMM. A complete multiple alignment for each family is then created by adding the aligned regions from each genome to a single multiple alignment file. Because each region has been aligned to the same profile-HMM (or covarion model for noncoding genes) and non-aligning sites in the query genome removed, generation of a new multiple alignment is a simple matter of concatenating the individual alignments.</p>
        <p>PhyloSift also generates codon alignments for each protein-coding gene family at this stage by replacing amino acids with their codons and replacing each gap with a gap triplet.</p>
        <p>We note that profile-HMMs are not recomputed during the database update, thereby avoiding problems with model drift.</p>
        <p>The PhyloSift reference database is available independently of the software at the following location: <uri xlink:href="http://edhar.genomecenter.ucdavis.edu/~koadman/phylosift_markers">http://edhar.genomecenter.ucdavis.edu/~koadman/phylosift_markers</uri>.</p>
      </sec>
      <sec>
        <title>Phylogenetic inference and pruning</title>
        <p>The next step of database update involves constructing a phylogenetic tree for each gene family. Currently PhyloSift employs FastTree 2.1 (<xref ref-type="bibr" rid="ref-47">Price, Dehal &amp; Arkin, 2010</xref>) to generate approximate maximum likelihood trees for this task. PhyloSift also infers separate trees for the codon and amino acid alignments of each gene family.</p>
        <p>Reference databases frequently contain genomes for a multitude of closely related strains. In many gene families, the gene sequences present in genomes of closely related strains may be identical to each another. Identical gene sequences would create uncertainty in the placement of reads in a strain group. In order to reduce compute time and memory requirements, closely related sequences are pruned from the PhyloSift reference database. Pruning is done with an algorithm that maximizes phylogenetic diversity of the sequence set without including any sequence pairs separated by fewer than <italic>X</italic> amino acid (or nucleotide) substitutions per site, where <italic>X</italic> is a configurable variable with default value 0.01.</p>
      </sec>
      <sec>
        <title>Selection of representatives for similarity search</title>
        <p>The PhyloSift client workflow uses LAST to search for similarity between input sequences and reference sequences. During the database update the set of reference sequences is updated to include representatives of any newly sequenced genomes. As above, we select a subset of sequences that maximize phylogenetic diversity while requiring sequence pairs to be separated by at least <italic>X</italic> amino acid substitutions per site. In this case, <italic>X</italic> defaults to 0.1.</p>
      </sec>
      <sec>
        <title>Taxonomic reconciliation</title>
        <p>Many of the data sources for new genomes provide a taxonomic identifier for the genome that places it in the NCBI taxonomy. Throughout the database update process, the associations between taxon ID and individual sequences are maintained. The tips of reconstructed phylogenies can therefore have some or all nodes annotated with the taxon ID associated with that tip. Given this information, PhyloSift generates a mapping of edges (e.g., the edge above each node) in the gene tree phylogeny to edges in the taxonomic tree. To do so, we first compute the split (bipartition) encoding of the gene tree and the taxonomic tree. A tree’s split encoding is simply the set of splits encoded by each edge in the tree, where the split for edge <italic>i</italic> is a binary vector <italic>S<sub>i</sub></italic> = {<italic>s</italic><sub><italic>i</italic>,1</sub>...<italic>s</italic><sub><italic>i</italic>,<italic>n</italic></sub>}, <italic>s</italic><sub><italic>i</italic>,<italic>j</italic></sub>∈{0, 1}. Here <italic>n</italic> is the number of leaf nodes shared by the two trees. For convenience, we denote the split encoding for the gene tree as <italic>S</italic><sup>(<italic>G</italic>)</sup> and use <italic>S</italic><sup>(<italic>T</italic>)</sup> for the taxonomic tree. Then for each edge <italic>i</italic> in the gene tree, we compute its mapping <italic>M<sub>i</sub></italic> to taxonomic tree edges as: <disp-formula id="eqn-1"><alternatives><graphic xlink:href="peerj-02-243-e001.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*} \displaystyle {M}_{i}=\mathop{\mathop { \mathrm{argmin}}}\limits _{{S}_{j}\in {S}^{(T)}}H({S}_{i}^{(G)},{S}_{j})&amp;&amp;\displaystyle \end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-1"><mml:mstyle displaystyle="true"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder class="msub"><mml:mrow><mml:mi mathvariant="normal">argmin</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mfenced separators="" open="(" close=")"><mml:mi>T</mml:mi></mml:mfenced></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:mi>H</mml:mi><mml:mfenced separators="" open="(" close=")"><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mfenced separators="" open="(" close=")"><mml:mi>G</mml:mi></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mstyle></mml:math></alternatives></disp-formula> where <italic>H</italic>(⋅, ⋅) is defined as the Hamming distance among equal-length binary vectors. We note that there may be many possible edges in <italic>S</italic><sup>(<italic>T</italic>)</sup> with equally minimal Hamming distance to an edge <italic>i</italic> in <italic>S</italic><sup>(<italic>G</italic>)</sup>. In this case <italic>M<sub>i</sub></italic> includes all of these edges, and so <italic>M<sub>i</sub></italic>⊆<italic>S</italic><sup>(<italic>T</italic>)</sup> and |<italic>M<sub>i</sub></italic>| ≥ 1. In the client workflow when assigning placement probability mass to names, the placement mass on edge <inline-formula><alternatives><inline-graphic xlink:href="peerj-02-243-i001.jpg"/><tex-math id="M2">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${S}_{i}^{(G)}$\end{document}</tex-math><mml:math id="mml-ieqn-24"><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mfenced separators="" open="(" close=")"><mml:mi>G</mml:mi></mml:mfenced></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is divided equally among the taxonomic groups associated with <italic>M<sub>i</sub></italic>. Finally, we discard highly ambiguous mappings where |<italic>M<sub>i</sub></italic>| &gt; <italic>y</italic>. Here <italic>y</italic> is an ad-hoc threshold with a default value of 30. These gene tree edges are labeled “Unclassifiable” due to their extreme topological discordance with the NCBI taxonomy.</p>
      </sec>
    </sec>
    <sec>
      <title>Custom gene families</title>
      <p>PhyloSift also supports the addition of custom gene families to its database. To add a gene family to the database, a multiple sequence alignment must be provided. Optionally, a table mapping each sequence identifier in the alignment and its NCBI taxon ID may also be provided. Given these inputs, PhyloSift will construct a phylogenetic tree, create a pruned set of representative sequences for similarity searching, construct a profile-HMM for alignment, and if taxon information was provided will also compute a reconciliation between the gene tree and taxonomy. The tree-building and reconciliation steps follow the approach outlined above in the PhyloSift database update workflow, with the exception that codon alignments are not generated. The resulting data is called a “package,” and is copied into the user’s PhyloSift database. The new package will be automatically included in any future runs of the PhyloSift client workflow.</p>
    </sec>
  </sec>
  <sec sec-type="results">
    <title>Results</title>
    <sec>
      <title>Bayesian hypothesis testing for the presence of phylogenetic lineages</title>
      <p>For various applications (e.g., microbial forensics) a practitioner might want to test for the presence of a particular lineage of interest in a metagenomic sample. Phylogenetic analysis of metagenomic reads has the potential to offer resolution beyond what would be available from taxonomic methods for metagenomics. Whereas taxonomic methods can provide resolution at specific levels in the taxonomic hierarchy, such as species, genus, etc., phylogenetic methods might be able to distinguish different subtypes of named species or novel lineages at higher taxonomic levels. Phylogenetic methods are limited only by the resolution of the reference genome phylogeny and not by the resolution of manually curated taxonomies. Phylogenetic inference has the further advantage that it is based on a statistical model of sequence change where the marginal likelihood of the data given the model <italic>P</italic>(<italic>D</italic>|<italic>M</italic>) is well defined, making it possible to conduct model-based hypothesis tests using phylogenies. Taxonomic analysis methods for metagenomics are frequently based on machine learning classification methods which do not always lend themselves to such hypothesis testing.</p>
      <p>PhyloSift provides a means to conduct Bayesian hypothesis testing for the presence of one or more query sequences belonging to organisms that have diverged along specific branches of the reference phylogeny. In order to describe the Bayesian hypothesis test we introduce the following notation: assume we are given a reference phylogenetic tree <italic>T</italic> consisting of <italic>n</italic> &gt; 1 branches {<italic>t</italic><sub>1</sub>…<italic>t<sub>n</sub></italic>}. Further assume we are given a collection <italic>S</italic> of sequences <italic>s</italic><sub>1</sub>…<italic>s<sub>m</sub></italic> which are homologous to and aligned to the sequences at the leaf nodes of the reference phylogeny. We denote the marginal likelihood that a particular sequence <italic>s<sub>j</sub></italic> diverged along branch <italic>t<sub>i</sub></italic> of the reference phylogeny as <italic>P</italic>(<italic>s<sub>j</sub></italic>∣<italic>t<sub>i</sub></italic>). Calculation of this marginal likelihood is implemented in the pplacer software and described elsewhere (<xref ref-type="bibr" rid="ref-38">Matsen, Kodner &amp; Armbrust, 2010</xref>).</p>
      <p>The null hypothesis we wish to test is that there are no sequences diverging from a set of one or more lineages of interest <italic>T<sub>x</sub></italic>⊆<italic>T</italic>. We can express the marginal likelihood of the null hypothesis <italic>M</italic><sub>0</sub> as: <disp-formula id="eqn-2"><label>(1)</label><alternatives><graphic xlink:href="peerj-02-243-e002.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M3">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*} P(D\vert {M}_{0})=\prod _{s_{j}\in S}\left[1-\sum _{t_{i}\in {T}_{x}}P({s}_{j}\vert {t}_{i})\right] \end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-2"><mml:mstyle displaystyle="true"><mml:mi>P</mml:mi><mml:mfenced separators="" open="(" close=")"><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mo>∈</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:munder><mml:mfenced separators="" open="[" close="]"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mi>P</mml:mi><mml:mfenced separators="" open="(" close=")"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mfenced></mml:mstyle></mml:math></alternatives></disp-formula> which can be interpreted as the product over all sequences of the probability that the sequence does not derive from a lineage of interest in <italic>T<sub>x</sub></italic>. The marginal likelihood of the alternative hypothesis, e.g., that one or more reads derive from a lineage in <italic>T<sub>x</sub></italic>, can simply be expressed as: <disp-formula id="eqn-3"><label>(2)</label><alternatives><graphic xlink:href="peerj-02-243-e003.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M4">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*} P(D\vert {M}_{1})=1-P(D\vert {M}_{0}) \end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-3"><mml:mstyle displaystyle="true"><mml:mi>P</mml:mi><mml:mfenced separators="" open="(" close=")"><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>P</mml:mi><mml:mfenced separators="" open="(" close=")"><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mfenced></mml:mstyle></mml:math></alternatives></disp-formula> Using these marginal likelihoods we can construct a Bayes factor: <disp-formula id="eqn-4"><label>(3)</label><alternatives><graphic xlink:href="peerj-02-243-e004.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/><tex-math id="M5">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*} K=\frac{P(D\vert {M}_{0})}{P(D\vert {M}_{1})} \end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-4"><mml:mstyle displaystyle="true"><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mfenced separators="" open="(" close=")"><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mfenced></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mfenced separators="" open="(" close=")"><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mfrac></mml:mstyle></mml:math></alternatives></disp-formula> The Bayes factor <italic>K</italic> can then be interpreted with respect to how strongly the null hypothesis is rejected by the data.</p>
      <p>The current version of PhyloSift supports application of Bayesian hypothesis tests to a concatenated alignment of the 37 elite gene families or any other single marker gene, and can be applied to phylogenies inferred either from amino acid or codon-aligned DNA sequences.</p>
    </sec>
    <sec>
      <title>Community structure comparison: application to human microbiome data</title>
      <p>In addition to hypothesis testing for lineages, PhyloSift also provides a platform to conduct comparative analysis of microbial community structure directly from metagenomic data. To understand how community structure analysis with PhyloSift compares to similar analysis based on 16S rRNA amplicon sequencing we study a recently published human microbiome dataset where samples were sequenced both by a 16S amplicon and a shotgun metagenome approach (<xref ref-type="bibr" rid="ref-67">Yatsunenko et al., 2012</xref>). In that study, fecal material was collected from infants and adults at diverse geographical locations and subjected to sequencing. Over 600 samples were sequenced using the 16S amplicon protocol. Of those 106 were also subjected to metagenomic shotgun sequencing using 454 pyrosequencing chemistry. Here we apply PhyloSift to the 106 metagenomic samples and conduct a community structure comparison among the samples, and replicate the Yatsunenko et al. QIIME analyses on this subset of data.</p>
      <p>All QIIME analyses were carried out using release 1.5.0 of the QIIME software toolkit, using the workflow and parameters reported by Yatsunenko et al. The Greengenes reference database (collapsed at 97% identity) was used to carry out a closed-reference OTU picking protocol at 97% sequence identity with uclust. All reads which matched database sequences at this level were retained for downstream processing, while non-matching sequences were excluded from further analyses. Parameters for the pick_otus.py script were as follows: –max_accepts 1 –max_rejects 8 –stepwords 8 –word_length 8. Taxonomic assignments for OTUs were given by the Greengenes database. Rarefaction and PCoA analyses were carried out using the alpha_diversity.py and beta_diversity_through_plots.py workflows. A full list of these QIIME commands and output files have been publicly deposited in figshare (<uri xlink:href="http://dx.doi.org/10.6084/m9.figshare.650869">http://dx.doi.org/10.6084/m9.figshare.650869</uri>).</p>
      <p>PhyloSift processed each of the 106 samples, requiring an average of 2.5 h per sample on a single 2.27 GHz Intel Xeon E5520 core (circa 2009 model). The majority of CPU time is spent in phylogenetic placement of reads. These samples have 154,485 non-human sequence reads on average, for an average of 52 Mbp of sequence data per sample.</p>
      <fig id="fig-2" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj.243/fig-2</object-id>
        <label>Figure 2</label>
        <caption>
          <title>Comparison of QIIME PCA and edge PCA analysis of human fecal samples.</title>
          <p>Samples from 106 individuals were analyzed by PCA to evaluate trends in community composition with respect to host age. 16S rDNA amplicon data and metagenomic data from the same samples was processed using QIIME and PhyloSift. QIIME analyzed the amplicon data (top left) and 16S rDNA reads extracted from the metagenomic data (top right) using a reference-based OTU picking strategy. PhyloSift analyzed the same metagenomic 16S rDNA reads (bottom left) and reads matching the 37 elite gene families (bottom right). Each PCA approach gives qualitatively similar results, differences as quantified by Procrustes analysis are given in <xref ref-type="table" rid="table-1">Table 1</xref>.</p>
        </caption>
        <graphic xlink:href="peerj-02-243-g002"/>
      </fig>
      <p>We then conducted Edge Principal Components Analysis (PCA) using the reads placed onto the phylogeny of elite gene families. Edge PCA identifies the combination of phylogenetic lineages that explain the greatest extent of variation in the microbial communities in each sample. The resulting PCA plot is shown in <xref ref-type="fig" rid="fig-2">Fig. 2</xref>, with each sample colored according to the age of the human host at the time of sampling. The PCA reveals a strong association between age and microbial community structure. This relationship was also identified by Yastunenko et al. using 16S rRNA analysis on a set of &gt;600 samples which included the 106 studied here. In order to quantify the degree of similarity between the PhyloSift Edge PCA and QIIME PCoA results, we calculated Procrustes distances among each pair of analyses, the results are given in <xref ref-type="table" rid="table-1">Table 1</xref>. In general we find that QIIME’s PCoA analysis of metagenomic 16S reads produces results that are very different to all other methods, whereas results produced by QIIME PCoA analysis of 16S amplicon data are more similar to results produced by PhyloSift on metagenomic data.</p>
      <fig id="fig-3" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj.243/fig-3</object-id>
        <label>Figure 3</label>
        <caption>
          <title>Lineages contributing variation in human fecal sample community structure.</title>
          <p>106 metagenomic samples were processed using PhyloSift and their community composition compared using Edge PCA (<xref ref-type="bibr" rid="ref-36">Matsen &amp; Evans, 2013</xref>). Lineages that decrease in abundance along the principal component axis are shown in turquoise color, those increasing in abundance are shown in red. Edge width is proportional to the change in abundance. Remaining lineages in the phylogeny of bacteria, archaea, eukarya, and some viruses are shown in light gray. PC1 shown at left, PC2 at right.</p>
        </caption>
        <graphic xlink:href="peerj-02-243-g003"/>
      </fig>
      <p>The nature of edge PCA lends itself to an intuitive inspection of the phylogenetic lineages explaining the difference in community structures. PhyloSift, by using pplacer’s guppy program and the Archaeopteryx tree viewer, can produce a visualization of the lineages most strongly associated with each principal component. <xref ref-type="fig" rid="fig-3">Figure 3</xref> shows this visualization for the edge PCA analysis of 106 fecal metagenome communities. In that figure, lineages are thickened proportionally to their contribution to the principal component, and are colored according to whether they increase (red) or decrease (turqoise) in abundance along the principal component axis. As we can see from <xref ref-type="fig" rid="fig-3">Fig. 3</xref> left, the first principal component is defined by an increase in Ruminococcacae, Clostridiales, and Bacteroides, with a decrease in Bifidobacteria. The association with age suggests that as communities develop in aging children, the Bifidobacteria become less abundant and members of those other lineages grow in abundance. The analysis of Yatsunenko et al. on 16S rRNA data also identified age-associated increases in Ruminococcacae and Bacteroides and a decrease in Bifidobacteria.</p>
      <table-wrap id="table-1" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj.243/table-1</object-id>
        <label>Table 1</label>
        <caption>
          <title>Procrustes distances between microbial community analysis methods.</title>
          <p>Analysis of 16S amplicon sequences with QIIME (QIIME 16S Amp) produces results more similar to PhyloSift analyzing either 16S or elite protein sequences from metagenomic data than to QIIME analysis of 16S sequences from metagenomic data. PhyloSift results for 16S and elite proteins are more similar to each other than to either QIIME method, possibly due to differences between Edge PCA and the QIIME-generated PCoA on UniFrac distances.</p>
        </caption>
        <alternatives>
          <graphic xlink:href="peerj-02-243-g007"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="left" span="1"/>
              <col align="left" span="1"/>
              <col align="left" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1"/>
                <th align="left" rowspan="1" colspan="1">QIIME 16S Meta</th>
                <th align="left" rowspan="1" colspan="1">PhyloSift 16S Meta</th>
                <th align="left" rowspan="1" colspan="1">PhyloSift Elite Meta</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">QIIME 16S Amp</td>
                <td align="left" rowspan="1" colspan="1">0.5134279</td>
                <td align="left" rowspan="1" colspan="1">0.3873677</td>
                <td align="left" rowspan="1" colspan="1">0.3762175</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">QIIME 16S Meta</td>
                <td align="left" rowspan="1" colspan="1">-</td>
                <td align="left" rowspan="1" colspan="1">0.5376786</td>
                <td align="left" rowspan="1" colspan="1">0.6351224</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">PhyloSift 16S Meta</td>
                <td align="left" rowspan="1" colspan="1">-</td>
                <td align="left" rowspan="1" colspan="1">-</td>
                <td align="left" rowspan="1" colspan="1">0.2450837</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>Whereas the first principal component agrees strongly with the analysis reported by Yastunenko et al., the second principal component appears to identify a previously unreported aspect of variation in these samples. Extreme samples on the 2nd principal component (PC2) are very young infants whose fecal microbiota appear to be dominated not by Bifidobacteria, but instead by members of the genus Enterobacter and family Lactobacillales (see <xref ref-type="fig" rid="fig-3">Fig. 3</xref>, right). One possible explanation for this observation may be an association with breast-feeding status of the infants. However, inspection of publicly available metadata did not reveal any clear association of PC2 with breastfeeding status or other recorded metadata. Another possible explanation is mode of birth, vaginal or caesarian, however no information on mode of birth is available for this dataset (J Gordon, pers. comm., 2013). We note that members of the Lactobacillales are abundant in the human vaginal tract, suggesting that newborns high on the 2nd principal component axis may be vaginally delivered if the two groups of newborns do indeed reflect differences in mode of delivery. Interestingly, the dimensions of community structure variation identified in the current set of 106 samples differ from those identified by Yatsunenko et al. in the larger set of 600 samples for which amplicon data are available. Geography and age were associated with most variation in their analysis of &gt;600 samples, and the 106 metagenome samples are primarily from infants and do not equally represent that variation. It seems that age-related variation in the microbiome dominates the 106 metagenome samples.</p>
      <p>We also investigated the diversity of microbes in the fecal samples. Classic measures of species diversity such as alpha and beta diversity have been applied to microbial communities by collapsing sequences to operational taxonomic units (OTUs). More recently, phylogenetic diversity (PD) (<xref ref-type="bibr" rid="ref-20">Faith, 1992</xref>) has been applied to metagenomic data, yielding a diversity metric that does not require defining OTUs (<xref ref-type="bibr" rid="ref-27">Kembel et al., 2011</xref>). In the present work we compute phylogenetic diversity on the placed reads, using the attachment points of reads to the reference tree as the basis for the diversity calculation. <xref ref-type="fig" rid="fig-4">Figure 4</xref> shows the phylogenetic diversity present in the fecal samples as a function of age. We observe a general trend where phylogenetic diversity grows quickly with age, presumably due to colonization of the infant gut, then continues to grow slowly throughout adult life. There is a significant log-linear relationship of phylogenetic diversity with age (Pearson’s product-moment correlation, <italic>p</italic> &lt; 10<sup>−15</sup>). We also plot a variant of the PD metric called balance-weighted phylogenetic diversity (<xref ref-type="bibr" rid="ref-39">McCoy, Matsen &amp; Frederick, 2013</xref>), where diversity contributed by each lineage is weighted by its relative abundance. Balance-weighted PD exhibits a similar growth in early life, but values for individual samples shift relative to population median values. Notably, balance-weighted PD declines in old age, suggesting that a smaller number of divergent lineages may come to dominate the adult human gut. The maximum balance-weighted PD value observed among any sample in the dataset was at the 7th month of life. When samples from before and after the 7th month of life are tested separately, balance-weighted PD exhibits significant age-associated growth before the 7th month (<italic>p</italic> = 0.009, Spearman’s rank correlation) and age-associated decline after the 7th month (<italic>p</italic> &lt; 10<sup>−5</sup>, Spearman’s rank correlation). It is not clear what drives the reduction in balance-weighted PD after the 7th month of life, though we note that solid food is commonly introduced to the infant’s diet around this time.</p>
      <fig id="fig-4" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj.243/fig-4</object-id>
        <label>Figure 4</label>
        <caption>
          <title>Relationship between fecal community phylogenetic diversity and host age.</title>
          <p>106 metagenomic samples were processed using PhyloSift and their phylogenetic diversity analyzed using two metrics. Unweighted phylogenetic diversity (PD) simply measures the total branch length of the reference tree covered by placed reads from a sample. Balance-weighted phylogenetic diversity adjusts these values by the abundance of each lineage in the sample. In unweighted PD, a log-linear relationship between host age and fecal community phylogenetic diversity can be observed. Balance weighted PD, on the other hand, shows rapid growth in early life followed by slow decline after the first year, consistent with a small number of divergent lineages becoming dominant in the fecal ecosystem.</p>
        </caption>
        <graphic xlink:href="peerj-02-243-g004"/>
      </fig>
      <p>PhyloSift provides a means to visualize the relative abundance of taxonomic groups present in a sample. <xref ref-type="fig" rid="fig-5">Figure 5</xref> shows two such plots for samples from a 1 month old breastfeeding infant and a 45 year old mother from the Yatsunenko et al. data (<xref ref-type="bibr" rid="ref-67">Yatsunenko et al., 2012</xref>).</p>
    </sec>
    <sec>
      <title>Computational efficiency</title>
      <p>When processing large metagenomic datasets, computational efficiency and resources can become a logistical challenge. For Illumina data, PhyloSift can process sequence reads on a single CPU core at least as quickly as they can be generated by current instruments. <xref ref-type="fig" rid="fig-6">Figure 6</xref> gives memory and running time requirements for some test Illumina datasets. The majority of PhyloSift’s running time is spent in phylogenetic read placement (data not shown). Most stages of the workflow implemented by PhyloSift are amenable to both fine and coarse-grain parallelism, thus parallel implementations of the workflow could be created should future data volumes demand it. Finally, the peak memory usage recorded during each run remains roughly constant at 6–9 GB across all data set sizes. As such, PhyloSift is memory-efficient enough to process metagenomic datasets on modern laptop hardware, wherein configurations with 8 GB RAM are readily available.</p>
      <fig id="fig-5" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj.243/fig-5</object-id>
        <label>Figure 5</label>
        <caption>
          <title>Taxonomic visualization of two human gut samples.</title>
          <p>Taxonomic plot at left shows an infant, plot at right shows a 45 year old mother. Data analyzed by PhyloSift, visualized by Krona.</p>
        </caption>
        <graphic xlink:href="peerj-02-243-g005"/>
      </fig>
      <fig id="fig-6" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj.243/fig-6</object-id>
        <label>Figure 6</label>
        <caption>
          <title>PhyloSift performance and scaling behavior.</title>
          <p>PhyloSift v1.0 was used to process Illumina sequence data from a human gut microbiome dataset subsampled to varying numbers of reads. The program was run single-threaded on an Intel Xeon E5520 CPU core (circa 2009 model).</p>
        </caption>
        <graphic xlink:href="peerj-02-243-g006"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <p>We have presented a new approach for phylogenetic analysis of genomes and uncultured microbial communities. The software implementation of our method, called PhyloSift, also provides a platform for comparison of community structure among many samples. Phylogenetic analysis (placement of short sequences onto reference phylogenies) offers a number of conceptual advantages over OTU-based or taxonomic analysis (interpreting sequence data on the basis of hierarchal classification information) for metagenomic data. Without applying phylogenetic analysis, taxonomic analysis can produce results that are difficult to interpret, particularly when an unknown environmental sequence contains many high scoring hits to reference database sequences as is common in BLAST-based approaches. Alternatively, taxonomic information can be misleading for sequences from species lacking close relatives in public sequence databases; these sequences may recover no match at all, or be assigned taxonomic annotations which do not accurately reflect phylogenetic relationships (e.g., the closest match is still a distant relative, as reflected by low BLAST scores) (<xref ref-type="bibr" rid="ref-16">Eisen, 1998</xref>). Phylogenetic analysis avoids both of these problems, relying instead on evolutionary models to accurately place unknown sequences within a known topology. In many cases, phylogenies will also offer a higher resolution representation of genetic ancestry than taxonomies. For these reasons, we focus on types of phylogenetic analysis enabled by PhyloSift and forgo a discussion of previous taxonomy-based metagenome analysis methods.</p>
    <p>Phylogenetic analysis of metagenome sequence data could in principle offer several advantages in the area of microbial forensics. First, by studying an uncultured community, some potential pitfalls of culture bias and sample contamination can be avoided entirely. Second, the environmental shotgun sequencing approach can avoid problems related to PCR primer bias, though issues related to DNA extraction bias remain a problem (<xref ref-type="bibr" rid="ref-44">Morgan, Darling &amp; Eisen, 2010</xref>) and might be especially relevant for sporulating organisms such as the Bacilli and their relatives. Third, the metagenomic approach can be applied without prior knowledge of which genes to target in the sample, and permits interrogation of both slow-evolving genes such as 16S rRNA and fast evolving genes that might offer greater resolution among closely related organisms. Finally, phylogenetics can be applied to any gene of interest regardless of whether its evolutionary history is concordant with a taxonomic hierarchy.</p>
    <p>Here we have introduced a means to statistically test for lineages of interest directly from an uncultured DNA sample. The test calculates a Bayes factor for the two competing hypotheses: zero sequences derive from the target lineage, versus one or more sequences in the sample derive from the target lineage. This method can be applied to any protein-coding or noncoding gene family of interest. Certain gene families will yield more sensitive tests than others, for example the 16S rRNA gene is slow-evolving and can not usually distinguish within-species relationships where some protein-coding genes might have greater resolution. We emphasize that the Bayes factor is not a test of homology – homology tests exist as e-value and related score statistics in aligners such as BLAST, LAST, and HMMER. Given sequences homologous to a gene family, the Bayes factor tests from which lineage they diverged. The limit of detection for this method will depend on how deeply a sample has been sequenced. This value will depend on several factors specific to the sequencing chemistry and currently must be calculated independently by the user.</p>
    <p>The 37 elite gene families were selected because they are universally present and almost always in single copy, but there are some exceptions. When partial homologs exist interpretation of the lineage test can become complicated by paralogs or ancient lateral gene transfer events. Thus one must exercise appropriate caution when interpreting the results of the lineage test. It is a test of whether the sample is void of DNA predicted to have derived from a particular lineage in the phylogeny. For applications like medical diagnostics a more elaborate Bayesian hypothesis test might be appropriate. Such a test might check for a collection of genes that are diagnostic of the organism rather than seeking a single gene, based on prior knowledge that most of the 37 genes are present in most lineages. Such an approach would be less sensitive to sporadic lateral gene transfer events in any single gene family and represents a direction for future work.</p>
    <p>Although we do not provide examples, it is possible to test the hypothesis that two microbial communities have equal composition using the phylogenetic Kantorovich-Rubenstein distance (<xref ref-type="bibr" rid="ref-19">Evans &amp; Matsen, 2012</xref>). In a bioforensics context this approach could be applied to test whether two uncultured communities of interest “match” each other. The implementation of the method employs an efficient approximation to calculate <italic>p</italic>-values for the null hypothesis of equal community composition and has been described elsewhere (<xref ref-type="bibr" rid="ref-19">Evans &amp; Matsen, 2012</xref>). This test can be applied directly to any individual gene family processed by PhyloSift or to the concatenated alignment of elite families at either the amino acid or DNA sequence level. One limitation of this test is that it does not currently provide a means to account for variability in apparent community structure introduced by normal sample handling procedures. Future work might develop tests that employ many technical replicates of samples to account for such variation in the hypothesis test.</p>
    <p>PhyloSift can also be applied to explore the variation in community structure present in a collection metagenomic samples. In recent years it has become standard practice to explore microbial community structure variation using amplicon sequencing of highly conserved genes such as 16S rRNA, 18S rRNA and ITS regions followed by analysis with a pipeline such as QIIME (<xref ref-type="bibr" rid="ref-11">Caporaso et al., 2010</xref>), VAMPS (<uri xlink:href="http://vamps.mbl.edu">http://vamps.mbl.edu</uri>), or mothur (<xref ref-type="bibr" rid="ref-50">Schloss et al., 2009</xref>). Analysis of community structure using metagenome sequence has some potential advantages, such as avoiding issues related to PCR primer bias and distinguishing between erroneous PCR chimeras and sequences representing the “rare biosphere” (<xref ref-type="bibr" rid="ref-5">Bik et al., 2012</xref>). However, there are also shortcomings, such as the relatively sparse phylogenetic diversity of available reference genomes relative to amplicon databases. The reference-based approach taken by PhyloSift will suffer this database resolution limitation when processing metagenomic data, although not when processing amplicon data. Efforts to increase the phylogenetic diversity of available genome sequences are ongoing (<xref ref-type="bibr" rid="ref-63">Wu et al., 2009</xref>; <xref ref-type="bibr" rid="ref-48">Rinke et al., 2013</xref>; <xref ref-type="bibr" rid="ref-53">Shih et al., 2013</xref>)</p>
    <p>Advances in the preparation of high throughput samples will make comparative metagenomics more tractable. The analysis we describe of human fecal microbial communities was possible with a median of only 50 Mbp sequence data per sample. Current Illumina HiSeq 2000 instruments generate up to 40 Gbp per lane, suggesting that up to 800 samples could be processed in a single Illumina lane and yield similar findings. Based on current Illumina sequencing service provider costs this suggests large-scale gut metagenome surveys could be conducted for as little as to $2.50 to $5 per sample in sequencing costs. Library preparation would dominate the overall cost of such studies, as current kits from Illumina require about $37 per sample.</p>
    <p>Although we focus on phylogenetic analysis in this work, PhyloSift also provides a basic mechanism to attach taxonomic labels to branches of the phylogenetic trees. Our approach for taxonomic labeling of the phylogeny does not enforce a strict 1:1 mapping between taxonomic labels and branches in the phylogeny. Rather, each branch in the phylogeny is labeled with the entire set of most topologically consistent taxonomic labels. In cases where gene trees may be discordant with the taxonomic tree, this approach allows PhyloSift to represent some of this ambiguity in its results. A systematic study investigating the relationship between rates and patterns of LGT and the effectiveness of our approach for taxonomic labeling remains as future work, as does extension of the taxonomic labeling method to gene families for which duplication and loss is prevalent.</p>
    <p>One major limitation of the current approach is that all phylogenetic analysis is conducted independently on each gene. However, genes do not evolve in isolation but rather co-evolve with each other in genomes. Recent studies have demonstrated that large parts of the phylogenetic history in different microbial genes are congruent even though they have undergone lateral gene transfer, duplication, and loss (<xref ref-type="bibr" rid="ref-56">Szãllåsi et al., 2012</xref>; <xref ref-type="bibr" rid="ref-7">Boussau et al., 2012</xref>). Large-scale statistical inference of phylogenetic networks (e.g., on &gt;1000 microbial genomes) that account for duplication, transfer, and loss histories have not yet been described in the literature, however if such a network could be constructed it might provide a means to co-analyze all genes and yield a corresponding increase in sensitivity and power for statistical tests.</p>
  </sec>
  <sec>
    <title>Availability</title>
    <p>Software for Linux and Mac OS X, along with source code is freely available from <uri xlink:href="http://github.com/gjospin/PhyloSift">http://github.com/gjospin/PhyloSift</uri>. Extensive user documentation is available at <uri xlink:href="http://phylosift.wordpress.com">http://phylosift.wordpress.com</uri>. The source code has been licensed under the GNU Public License (GPL) v3.0.</p>
  </sec>
</body>
<back>
  <sec sec-type="additional-information">
    <title>Additional Information and Declarations</title>
    <fn-group content-type="competing-interests">
      <title>Competing Interests</title>
      <fn id="conflict-1" fn-type="con">
        <p>Jonathan A. Eisen is an Academic Editor for PeerJ.</p>
      </fn>
    </fn-group>
    <fn-group content-type="author-contributions">
      <title>Author Contributions</title>
      <fn id="contribution-1" fn-type="con">
        <p><xref ref-type="contrib" rid="author-1">Aaron E. Darling</xref> conceived and designed the experiments, performed the experiments, analyzed the data, contributed reagents/materials/analysis tools, wrote the paper.</p>
      </fn>
      <fn id="contribution-2" fn-type="con">
        <p><xref ref-type="contrib" rid="author-2">Guillaume Jospin</xref> performed the experiments, analyzed the data, contributed reagents/materials/analysis tools.</p>
      </fn>
      <fn id="contribution-3" fn-type="con">
        <p><xref ref-type="contrib" rid="author-3">Eric Lowe</xref> helped with software testing.</p>
      </fn>
      <fn id="contribution-4" fn-type="con">
        <p><xref ref-type="contrib" rid="author-4">Frederick A. Matsen IV</xref> performed the experiments, contributed reagents/materials/analysis tools, wrote the paper.</p>
      </fn>
      <fn id="contribution-5" fn-type="con">
        <p><xref ref-type="contrib" rid="author-5">Holly M. Bik</xref> performed the experiments, analyzed the data, wrote the paper.</p>
      </fn>
      <fn id="contribution-6" fn-type="con">
        <p><xref ref-type="contrib" rid="author-6">Jonathan A. Eisen</xref> conceived and designed the experiments, wrote the paper.</p>
      </fn>
    </fn-group>
    <fn-group content-type="other">
      <title>Data Deposition</title>
      <fn id="addinfo-1" fn-type="other">
        <p>The following information was supplied regarding the deposition of related data:</p>
        <p>FigShare, <uri xlink:href="http://dx.doi.org/10.6084/m9.figshare.650869">http://dx.doi.org/10.6084/m9.figshare.650869</uri>.</p>
      </fn>
    </fn-group>
  </sec>
  <ref-list content-type="authoryear">
    <title>References</title>
    <ref id="ref-1">
      <label>Abby et al. (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abby</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Tannier</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Gouy</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Daubin</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Lateral gene transfer as a support for the tree of life</article-title>
        <source>Proceedings of the National Academy of Sciences of the United States of America</source>
        <year>2012</year>
        <pub-id pub-id-type="doi">10.1073/pnas.1116871109</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-2">
      <label>Adey et al. (2010)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Adey</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Morrison</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Asan</surname>
            <given-names>XX</given-names>
          </name>
          <name>
            <surname>Kitzman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Turner</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Stackhouse</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>MacKenzie</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Caruccio</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Shendure</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Rapid, low-input, low-bias construction of shotgun fragment libraries by high-density in vitro transposition</article-title>
        <source>Genome Biology</source>
        <issue>12</issue>
        <year>2010</year>
        <volume>11</volume>
        <fpage>R119</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2010-11-12-r119</pub-id>
        <pub-id pub-id-type="pmid">21143862</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-3">
      <label>Altschul et al. (1997)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Madden</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Schöffer</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Lipman</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs</article-title>
        <source>Nucleic Acids Research</source>
        <issue>17</issue>
        <year>1997</year>
        <volume>25</volume>
        <fpage>3389</fpage>
        <lpage>3402</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/25.17.3389</pub-id>
        <pub-id pub-id-type="pmid">9254694</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-4">
      <label>Béjà et al. (2000)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Béjà</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Aravind</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Koonin</surname>
            <given-names>EV</given-names>
          </name>
          <name>
            <surname>Suzuki</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Hadd</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>LP</given-names>
          </name>
          <name>
            <surname>Jovanovich</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Gates</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Feldman</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Spudich</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Spudich</surname>
            <given-names>EN</given-names>
          </name>
          <name>
            <surname>DeLong</surname>
            <given-names>EF</given-names>
          </name>
        </person-group>
        <article-title>Bacterial rhodopsin: evidence for a new type of phototrophy in the sea</article-title>
        <source>Science</source>
        <issue>5486</issue>
        <year>2000</year>
        <volume>289</volume>
        <fpage>1902</fpage>
        <lpage>1906</lpage>
        <pub-id pub-id-type="doi">10.1126/science.289.5486.1902</pub-id>
        <pub-id pub-id-type="pmid">10988064</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-5">
      <label>Bik et al. (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bik</surname>
            <given-names>HM</given-names>
          </name>
          <name>
            <surname>Porazinska</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Creer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Caporaso</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>WK</given-names>
          </name>
        </person-group>
        <article-title>Sequencing our way towards understanding global eukaryotic biodiversity</article-title>
        <source>Trends in Ecology &amp; Evolution</source>
        <issue>4</issue>
        <year>2012</year>
        <volume>27</volume>
        <fpage>233</fpage>
        <lpage>243</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tree.2011.11.010</pub-id>
        <pub-id pub-id-type="pmid">22244672</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-6">
      <label>Blainey (2013)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blainey</surname>
            <given-names>PC</given-names>
          </name>
        </person-group>
        <article-title>The future is now: single-cell genomics of bacteria and archaea</article-title>
        <source>FEMS Microbiology Reviews</source>
        <issue>3</issue>
        <year>2013</year>
        <volume>37</volume>
        <fpage>407</fpage>
        <lpage>427</lpage>
        <pub-id pub-id-type="doi">10.1111/1574-6976.12015</pub-id>
        <pub-id pub-id-type="pmid">23298390</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-7">
      <label>Boussau et al. (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boussau</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Szöllősi</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Duret</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Gouy</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tannier</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Daubin</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Genome-scale coestimation of species and gene trees</article-title>
        <source>Genome Research</source>
        <year>2012</year>
        <volume>23</volume>
        <fpage>323</fpage>
        <lpage>330</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.141978.112</pub-id>
        <pub-id pub-id-type="pmid">23132911</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-8">
      <label>Brady &amp; Salzberg (2009)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brady</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Phymm and phymmbl: metagenomic phylogenetic classification with interpolated markov models</article-title>
        <source>Nature Methods</source>
        <issue>9</issue>
        <year>2009</year>
        <volume>6</volume>
        <fpage>673</fpage>
        <lpage>676</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1358</pub-id>
        <pub-id pub-id-type="pmid">19648916</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-9">
      <label>Brady &amp; Salzberg (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brady</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Phymmbl expanded: confidence scores, custom databases, parallelization and more</article-title>
        <source>Nature Methods</source>
        <issue>5</issue>
        <year>2011</year>
        <volume>8</volume>
        <fpage>367</fpage>
        <pub-id pub-id-type="doi">10.1038/nmeth0511-367</pub-id>
        <pub-id pub-id-type="pmid">21527926</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-10">
      <label>Camacho et al. (2009)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Camacho</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Coulouris</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Avagyan</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Papadopoulos</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bealer</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Madden</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>BLAST+: architecture and applications</article-title>
        <source>BMC Bioinformatics</source>
        <issue>1</issue>
        <year>2009</year>
        <volume>10</volume>
        <fpage>421</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-10-421</pub-id>
        <pub-id pub-id-type="pmid">20003500</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-11">
      <label>Caporaso et al. (2010)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Caporaso</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Kuczynski</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Stombaugh</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bittinger</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bushman</surname>
            <given-names>FD</given-names>
          </name>
          <name>
            <surname>Costello</surname>
            <given-names>EK</given-names>
          </name>
          <name>
            <surname>Fierer</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Pena</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Goodrich</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Gordon</surname>
            <given-names>JI</given-names>
          </name>
          <name>
            <surname>Huttley</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Kelley</surname>
            <given-names>ST</given-names>
          </name>
          <name>
            <surname>Knights</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Koenig</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Ley</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Lozupone</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>McDonald</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Muegge</surname>
            <given-names>BD</given-names>
          </name>
          <name>
            <surname>Pirrung</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Reeder</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sevinsky</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Turnbaugh</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Walters</surname>
            <given-names>WA</given-names>
          </name>
          <name>
            <surname>Widmann</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yatsunenko</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Zaneveld</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>QIIME allows analysis of high-throughput community sequencing data</article-title>
        <source>Nature Methods</source>
        <issue>5</issue>
        <year>2010</year>
        <volume>7</volume>
        <fpage>335</fpage>
        <lpage>336</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.f.303</pub-id>
        <pub-id pub-id-type="pmid">20383131</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-12">
      <label>Chen &amp; Pachter (2005)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Bioinformatics for whole-genome shotgun sequencing of microbial communities</article-title>
        <source>PLoS Computational Biology</source>
        <issue>2</issue>
        <year>2005</year>
        <volume>1</volume>
        <elocation-id>e243</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.0010024</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-13">
      <label>Diaz et al. (2009)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Diaz</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Krause</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Goesmann</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Niehaus</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Nattkemper</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>TACOA - Taxonomic classification of environmental genomic fragments using a kernelized nearest neighbor approach</article-title>
        <source>BMC Bioinformatics</source>
        <issue>1</issue>
        <year>2009</year>
        <volume>10</volume>
        <fpage>56</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-10-56</pub-id>
        <pub-id pub-id-type="pmid">19210774</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-14">
      <label>Dick et al. (2009)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dick</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Andersson</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Baker</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Simmons</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>BC</given-names>
          </name>
          <name>
            <surname>Yelton</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Banfield</surname>
            <given-names>JF</given-names>
          </name>
        </person-group>
        <article-title>Community-wide analysis of microbial genome sequence signatures</article-title>
        <source>Genome Biology</source>
        <issue>8</issue>
        <year>2009</year>
        <volume>10</volume>
        <fpage>R85</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2009-10-8-r85</pub-id>
        <pub-id pub-id-type="pmid">19698104</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-15">
      <label>Eddy (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Accelerated Profile HMM Searches</article-title>
        <source>PLoS Computational Biology</source>
        <issue>10</issue>
        <year>2011</year>
        <volume>7</volume>
        <elocation-id>e243</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1002195</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-16">
      <label>Eisen (1998)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eisen</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Phylogenomics: improving functional predictions for uncharacterized genes by evolutionary analysis</article-title>
        <source>Genome Research</source>
        <issue>3</issue>
        <year>1998</year>
        <volume>8</volume>
        <fpage>163</fpage>
        <lpage>167</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.8.3.163</pub-id>
        <pub-id pub-id-type="pmid">9521918</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-17">
      <label>Eisen (2007)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eisen</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Environmental shotgun sequencing: its potential and challenges for studying the hidden world of microbes</article-title>
        <source>PLoS Biology</source>
        <issue>3</issue>
        <year>2007</year>
        <volume>5</volume>
        <elocation-id>e243</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pbio.0050082</pub-id>
        <pub-id pub-id-type="pmid">17850182</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-18">
      <label>Eisen (2012)</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Eisen</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Phylogenetic and phylogenomic approaches to analysis of microbial communities</article-title>
        <source>The social biology of microbial communities – a report from the national academy of sciences forum on microbial threats</source>
        <year>2012</year>
        <publisher-name>National Academy of Sciences</publisher-name>
        <fpage>180</fpage>
        <lpage>212</lpage>
        <pub-id pub-id-type="doi">10.6084/m9.figshare.841773</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-19">
      <label>Evans &amp; Matsen (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Evans</surname>
            <given-names>SN</given-names>
          </name>
          <name>
            <surname>Matsen</surname>
            <given-names>FA</given-names>
          </name>
        </person-group>
        <article-title>The phylogenetic Kantorovich-Rubinstein metric for environmental sequence samples</article-title>
        <source>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</source>
        <issue>3</issue>
        <year>2012</year>
        <volume>74</volume>
        <fpage>569</fpage>
        <lpage>592</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1467-9868.2011.01018.x</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-20">
      <label>Faith (1992)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Faith</surname>
            <given-names>DP</given-names>
          </name>
        </person-group>
        <article-title>Conservation evaluation and phylogenetic diversity</article-title>
        <source>Biological Conservation</source>
        <issue>1</issue>
        <year>1992</year>
        <volume>61</volume>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1016/0006-3207(92)91201-3</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-21">
      <label>Ghosh et al. (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ghosh</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Mohammed</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Komanduri</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Mande</surname>
            <given-names>SS</given-names>
          </name>
        </person-group>
        <article-title>Provide: a software tool for accurate estimation of viral diversity in metagenomic samples</article-title>
        <source>Bioinformation</source>
        <issue>2</issue>
        <year>2011</year>
        <volume>6</volume>
        <fpage>91</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="doi">10.6026/97320630006091</pub-id>
        <pub-id pub-id-type="pmid">21544173</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-22">
      <label>Gori et al. (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gori</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Folino</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Jetten</surname>
            <given-names>MSM</given-names>
          </name>
          <name>
            <surname>Marchiori</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>MTR: taxonomic annotation of short metagenomic reads using clustering at multiple taxonomic ranks</article-title>
        <source>Bioinformatics</source>
        <issue>2</issue>
        <year>2011</year>
        <volume>27</volume>
        <fpage>196</fpage>
        <lpage>203</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq649</pub-id>
        <pub-id pub-id-type="pmid">21127032</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-23">
      <label>Haque et al. (2009)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haque</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Ghosh</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Komanduri</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Mande</surname>
            <given-names>SS</given-names>
          </name>
        </person-group>
        <article-title>SOrt-ITEMS: sequence orthology based approach for improved taxonomic estimation of metagenomic sequences</article-title>
        <source>Bioinformatics</source>
        <issue>14</issue>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1722</fpage>
        <lpage>1730</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp317</pub-id>
        <pub-id pub-id-type="pmid">19439565</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-24">
      <label>Hugenholtz, Goebel &amp; Pace (1998)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hugenholtz</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Goebel</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>Pace</surname>
            <given-names>NR</given-names>
          </name>
        </person-group>
        <article-title>Impact of culture-independent studies on the emerging phylogenetic view of bacterial diversity</article-title>
        <source>Journal of Bacteriology</source>
        <issue>18</issue>
        <year>1998</year>
        <volume>180</volume>
        <fpage>4765</fpage>
        <lpage>4774</lpage>
        <pub-id pub-id-type="pmid">9733676</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-25">
      <label>Huson et al. (2007)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huson</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Auch</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Qi</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Schuster</surname>
            <given-names>SC</given-names>
          </name>
        </person-group>
        <article-title>MEGAN analysis of metagenomic data</article-title>
        <source>Genome Research</source>
        <issue>3</issue>
        <year>2007</year>
        <volume>17</volume>
        <fpage>377</fpage>
        <lpage>386</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.5969107</pub-id>
        <pub-id pub-id-type="pmid">17255551</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-26">
      <label>Jolley et al. (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jolley</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Bliss</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Bennett</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Bratcher</surname>
            <given-names>HB</given-names>
          </name>
          <name>
            <surname>Brehony</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Colles</surname>
            <given-names>FM</given-names>
          </name>
          <name>
            <surname>Wimalarathna</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Harrison</surname>
            <given-names>OB</given-names>
          </name>
          <name>
            <surname>Sheppard</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Cody</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Maiden</surname>
            <given-names>MCJ</given-names>
          </name>
        </person-group>
        <article-title>Ribosomal multilocus sequence typing: universal characterization of bacteria from domain to strain</article-title>
        <source>Microbiology</source>
        <issue>Pt 4</issue>
        <year>2012</year>
        <volume>158</volume>
        <fpage>1005</fpage>
        <lpage>1015</lpage>
        <pub-id pub-id-type="doi">10.1099/mic.0.055459-0</pub-id>
        <pub-id pub-id-type="pmid">22282518</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-27">
      <label>Kembel et al. (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kembel</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Eisen</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Pollard</surname>
            <given-names>KS</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>JL</given-names>
          </name>
        </person-group>
        <article-title>The phylogenetic diversity of metagenomes</article-title>
        <source>PLoS ONE</source>
        <issue>8</issue>
        <year>2011</year>
        <volume>6</volume>
        <elocation-id>e243</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0023214</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-28">
      <label>Kiełbasa et al. (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kiełbasa</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Wan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sato</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Horton</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Frith</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <article-title>Adaptive seeds tame genomic sequence comparison</article-title>
        <source>Genome Research</source>
        <year>2011</year>
        <volume>21</volume>
        <fpage>487</fpage>
        <lpage>493</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.113985.110</pub-id>
        <pub-id pub-id-type="pmid">21209072</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-29">
      <label>Kunin et al. (2008)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kunin</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Copeland</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lapidus</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mavromatis</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hugenholtz</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>A bioinformatician’s guide to metagenomics</article-title>
        <source>Microbiology and Molecular Biology Reviews</source>
        <issue>4</issue>
        <year>2008</year>
        <volume>72</volume>
        <fpage>557</fpage>
        <lpage>578</lpage>
        <pub-id pub-id-type="doi">10.1128/MMBR.00009-08</pub-id>
        <pub-id pub-id-type="pmid">19052320</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-30">
      <label>Lang, Darling &amp; Eisen (2013)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lang</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Darling</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Eisen</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Phylogeny of bacterial and archaeal genomes using conserved genes: supertrees and supermatrices</article-title>
        <source>PLoS ONE</source>
        <issue>4</issue>
        <year>2013</year>
        <volume>8</volume>
        <elocation-id>e243</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0062510</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-31">
      <label>Langmead et al. (2009)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pop</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title>
        <source>Genome Biology</source>
        <issue>3</issue>
        <year>2009</year>
        <volume>10</volume>
        <fpage>R25</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2009-10-3-r25</pub-id>
        <pub-id pub-id-type="pmid">19261174</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-32">
      <label>Lasken (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lasken</surname>
            <given-names>RS</given-names>
          </name>
        </person-group>
        <article-title>Genomic sequencing of uncultured microorganisms from single cells</article-title>
        <source>Nature Reviews Microbiology</source>
        <issue>9</issue>
        <year>2012</year>
        <volume>10</volume>
        <fpage>631</fpage>
        <lpage>640</lpage>
        <pub-id pub-id-type="doi">10.1038/nrmicro2857</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-33">
      <label>Liu et al. (2010)</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Gibbons</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ghodsi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pop</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Metaphyler: taxonomic profiling for metagenomic sequences</article-title>
        <source>2010 IEEE international conference on bioinformatics and biomedicine (BIBM)</source>
        <year>2010</year>
        <publisher-name>IEEE</publisher-name>
        <fpage>95</fpage>
        <lpage>100</lpage>
      </element-citation>
    </ref>
    <ref id="ref-34">
      <label>Löytynoja, Vilella &amp; Goldman (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Löytynoja</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vilella</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Goldman</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Accurate extension of multiple sequence alignments using a phylogeny-aware graph algorithm</article-title>
        <source>Bioinformatics</source>
        <issue>13</issue>
        <year>2012</year>
        <volume>28</volume>
        <fpage>1684</fpage>
        <lpage>1691</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts198</pub-id>
        <pub-id pub-id-type="pmid">22531217</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-35">
      <label>Lozupone &amp; Knight (2005)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lozupone</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Unifrac: a new phylogenetic method for comparing microbial communities</article-title>
        <source>Applied and Environmental Microbiology</source>
        <issue>12</issue>
        <year>2005</year>
        <volume>71</volume>
        <fpage>8228</fpage>
        <lpage>8235</lpage>
        <pub-id pub-id-type="doi">10.1128/AEM.71.12.8228-8235.2005</pub-id>
        <pub-id pub-id-type="pmid">16332807</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-36">
      <label>Matsen &amp; Evans (2013)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Matsen</surname>
            <given-names>FA</given-names>
            <suffix>IV</suffix>
          </name>
          <name>
            <surname>Evans</surname>
            <given-names>SN</given-names>
          </name>
        </person-group>
        <article-title>Edge principal components and squash clustering: using the special structure of phylogenetic placement data for sample comparison</article-title>
        <source>PLoS ONE</source>
        <year>2013</year>
        <volume>8</volume>
        <elocation-id>e243</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0056859</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-37">
      <label>Matsen et al. (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Matsen</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>NG</given-names>
          </name>
          <name>
            <surname>Gallagher</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Stamatakis</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>A format for phylogenetic placements</article-title>
        <source>PLoS ONE</source>
        <issue>2</issue>
        <year>2012</year>
        <volume>7</volume>
        <elocation-id>e243</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0031009</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-38">
      <label>Matsen, Kodner &amp; Armbrust (2010)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Matsen</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Kodner</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Armbrust</surname>
            <given-names>EV</given-names>
          </name>
        </person-group>
        <article-title>pplacer: linear time maximum-likelihood and Bayesian phylogenetic placement of sequences onto a fixed reference tree</article-title>
        <source>BMC Bioinformatics</source>
        <issue>1</issue>
        <year>2010</year>
        <volume>11</volume>
        <fpage>538</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-538</pub-id>
        <pub-id pub-id-type="pmid">21034504</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-39">
      <label>McCoy, Matsen &amp; Frederick (2013)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McCoy</surname>
            <given-names>CO</given-names>
          </name>
          <name>
            <surname>Matsen</surname>
            <given-names>FA</given-names>
            <suffix>IV</suffix>
          </name>
        </person-group>
        <article-title>Abundance-weighted phylogenetic diversity measures distinguish microbial community states and are robust to sampling depth</article-title>
        <source>PeerJ</source>
        <year>2013</year>
        <volume>1</volume>
        <elocation-id>e243</elocation-id>
        <pub-id pub-id-type="doi">10.7717/peerj.157</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-40">
      <label>McHardy et al. (2006)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McHardy</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Martín</surname>
            <given-names>HG</given-names>
          </name>
          <name>
            <surname>Tsirigos</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hugenholtz</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Rigoutsos</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Accurate phylogenetic classification of variable-length DNA fragments</article-title>
        <source>Nature Methods</source>
        <issue>1</issue>
        <year>2006</year>
        <volume>4</volume>
        <fpage>63</fpage>
        <lpage>72</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth976</pub-id>
        <pub-id pub-id-type="pmid">17179938</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-41">
      <label>Meyer et al. (2008)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meyer</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Paarmann</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>D’souza</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Olson</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Glass</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Kubal</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Paczian</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Rodriguez</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Stevens</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wilke</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wilkening</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Edwards</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>The metagenomics rast server–a public resource for the automatic phylogenetic and functional analysis of metagenomes</article-title>
        <source>BMC Bioinformatics</source>
        <issue>1</issue>
        <year>2008</year>
        <volume>9</volume>
        <fpage>386</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-386</pub-id>
        <pub-id pub-id-type="pmid">18803844</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-42">
      <label>Miller et al. (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miller</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Baker</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Singer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Banfield</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>EMIRGE: reconstruction of full-length ribosomal genes from microbial community short read sequencing data</article-title>
        <source>Genome Biology</source>
        <issue>5</issue>
        <year>2011</year>
        <volume>12</volume>
        <fpage>R44</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2011-12-5-r44</pub-id>
        <pub-id pub-id-type="pmid">21595876</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-43">
      <label>Mohammed et al. (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mohammed</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Chadaram</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Komanduri</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ghosh</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Mande</surname>
            <given-names>SS</given-names>
          </name>
        </person-group>
        <article-title>Eu-detect: an algorithm for detecting eukaryotic sequences in metagenomic data sets</article-title>
        <source>Journal of Biosciences</source>
        <issue>4</issue>
        <year>2011</year>
        <volume>36</volume>
        <fpage>709</fpage>
        <lpage>717</lpage>
        <pub-id pub-id-type="doi">10.1007/s12038-011-9105-2</pub-id>
        <pub-id pub-id-type="pmid">21857117</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-44">
      <label>Morgan, Darling &amp; Eisen (2010)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Morgan</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Darling</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Eisen</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Metagenomic sequencing of an <italic>in vitro</italic>-simulated microbial community</article-title>
        <source>PLoS ONE</source>
        <issue>4</issue>
        <year>2010</year>
        <volume>5</volume>
        <elocation-id>e243</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0010209</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-45">
      <label>Ondov, Bergman &amp; Phillippy (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ondov</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Bergman</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Interactive metagenomic visualization in a Web browser</article-title>
        <source>BMC Bioinformatics</source>
        <issue>1</issue>
        <year>2011</year>
        <volume>12</volume>
        <fpage>385</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-12-385</pub-id>
        <pub-id pub-id-type="pmid">21961884</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-46">
      <label>Patil et al. (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patil</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Haider</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Pope</surname>
            <given-names>PB</given-names>
          </name>
          <name>
            <surname>Turnbaugh</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Morrison</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Scheffer</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>McHardy</surname>
            <given-names>AC</given-names>
          </name>
        </person-group>
        <article-title>Taxonomic metagenome sequence assignment with structured output models</article-title>
        <source>Nature Methods</source>
        <year>2011</year>
        <volume>8</volume>
        <fpage>191</fpage>
        <lpage>192</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth0311-191</pub-id>
        <pub-id pub-id-type="pmid">21358620</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-47">
      <label>Price, Dehal &amp; Arkin (2010)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Price</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Dehal</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Arkin</surname>
            <given-names>AP</given-names>
          </name>
        </person-group>
        <article-title>FastTree 2 – approximately maximum-likelihood trees for large alignments</article-title>
        <source>PLoS ONE</source>
        <issue>3</issue>
        <year>2010</year>
        <volume>5</volume>
        <elocation-id>e243</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0009490</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-48">
      <label>Rinke et al. (2013)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rinke</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Schwientek</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Sczyrba</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ivanova</surname>
            <given-names>NN</given-names>
          </name>
          <name>
            <surname>Anderson</surname>
            <given-names>IJ</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>J-F</given-names>
          </name>
          <name>
            <surname>Darling</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Malfatti</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Swan</surname>
            <given-names>BK</given-names>
          </name>
          <name>
            <surname>Gies</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Dodsworth</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Hedlund</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Tsiamis</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sievert</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>W-T</given-names>
          </name>
          <name>
            <surname>Eisen</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Hallam</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Kyrpides</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Stepanauskas</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Rubin</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Hugenholtz</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Woyke</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Insights into the phylogeny and coding potential of microbial dark matter</article-title>
        <source>Nature</source>
        <year>2013</year>
        <volume>499</volume>
        <fpage>431</fpage>
        <lpage>437</lpage>
        <pub-id pub-id-type="doi">10.1038/nature12352</pub-id>
        <pub-id pub-id-type="pmid">23851394</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-49">
      <label>Rosen, Reichenberger &amp; Rosenfeld (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rosen</surname>
            <given-names>GL</given-names>
          </name>
          <name>
            <surname>Reichenberger</surname>
            <given-names>ER</given-names>
          </name>
          <name>
            <surname>Rosenfeld</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>NBC: the Nave Bayes Classification tool webserver for taxonomic classification of metagenomic reads</article-title>
        <source>Bioinformatics</source>
        <issue>1</issue>
        <year>2011</year>
        <volume>27</volume>
        <fpage>127</fpage>
        <lpage>129</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq619</pub-id>
        <pub-id pub-id-type="pmid">21062764</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-50">
      <label>Schloss et al. (2009)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schloss</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Westcott</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Ryabin</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Hartmann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hollister</surname>
            <given-names>EB</given-names>
          </name>
          <name>
            <surname>Lesniewski</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Oakley</surname>
            <given-names>BB</given-names>
          </name>
          <name>
            <surname>Parks</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Sahl</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Stres</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Thallinger</surname>
            <given-names>GG</given-names>
          </name>
          <name>
            <surname>Van Horn</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Weber</surname>
            <given-names>CF</given-names>
          </name>
        </person-group>
        <article-title>Introducing mothur: open-source, platform-independent, community-supported software for describing and comparing microbial communities</article-title>
        <source>Applied and Environmental Microbiology</source>
        <issue>23</issue>
        <year>2009</year>
        <volume>75</volume>
        <fpage>7537</fpage>
        <lpage>7541</lpage>
        <pub-id pub-id-type="doi">10.1128/AEM.01541-09</pub-id>
        <pub-id pub-id-type="pmid">19801464</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-51">
      <label>Segata et al. (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Segata</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Waldron</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ballarini</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Narasimhan</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Jousson</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Huttenhower</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Metagenomic microbial community profiling using unique clade-specific marker genes</article-title>
        <source>Nature Methods</source>
        <issue>8</issue>
        <year>2012</year>
        <volume>9</volume>
        <fpage>811</fpage>
        <lpage>814</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2066</pub-id>
        <pub-id pub-id-type="pmid">22688413</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-52">
      <label>Sharpton et al. (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sharpton</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Riesenfeld</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Kembel</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Ladau</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>O’Dwyer</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Eisen</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Pollard</surname>
            <given-names>KS</given-names>
          </name>
        </person-group>
        <article-title>Phylotu: a high-throughput procedure quantifies microbial community diversity and resolves novel taxa from metagenomic data</article-title>
        <source>PLoS Computational Biology</source>
        <issue>1</issue>
        <year>2011</year>
        <volume>7</volume>
        <elocation-id>e243</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1001061</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-53">
      <label>Shih et al. (2013)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shih</surname>
            <given-names>PM</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Latifi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Axen</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Fewer</surname>
            <given-names>DP</given-names>
          </name>
          <name>
            <surname>Talla</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Calteau</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>de Marsac</surname>
            <given-names>NT</given-names>
          </name>
          <name>
            <surname>Rippka</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Herdman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sivonen</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Coursin</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Laurent</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Goodwin</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Nolan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Davenport</surname>
            <given-names>KW</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>CS</given-names>
          </name>
          <name>
            <surname>Rubin</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Eisen</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Woyke</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Gugger</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kerfeld</surname>
            <given-names>CA</given-names>
          </name>
        </person-group>
        <article-title>Improving the coverage of the cyanobacterial phylum using diversity-driven genome sequencing</article-title>
        <source>Proceedings of the National Academy of Sciences of the United States of America</source>
        <issue>3</issue>
        <year>2013</year>
        <volume>110</volume>
        <fpage>1053</fpage>
        <lpage>1058</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1217107110</pub-id>
        <pub-id pub-id-type="pmid">23277585</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-54">
      <label>Stark et al. (2010)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stark</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Berger</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Stamatakis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>von Mering</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>MLTreeMap - accurate Maximum Likelihood placement of environmental DNA sequences into taxonomic and functional reference phylogenies</article-title>
        <source>BMC Genomics</source>
        <issue>1</issue>
        <year>2010</year>
        <volume>11</volume>
        <fpage>461</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-11-461</pub-id>
        <pub-id pub-id-type="pmid">20687950</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-55">
      <label>Sunagawa et al. (2013)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sunagawa</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mende</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Zeller</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Izquierdo-Carrasco</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Berger</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Kultima</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Coelho</surname>
            <given-names>LP</given-names>
          </name>
          <name>
            <surname>Arumugam</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tap</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Nielsen</surname>
            <given-names>HB</given-names>
          </name>
          <name>
            <surname>Rasmussen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Brunak</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pedersen</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Guarner</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>de Vos</surname>
            <given-names>WM</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Doré</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ehrlich</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Stamatakis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Metagenomic species profiling using universal phylogenetic marker genes</article-title>
        <source>Nature Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <fpage>1196</fpage>
        <lpage>1199</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2693</pub-id>
        <pub-id pub-id-type="pmid">24141494</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-56">
      <label>Szãllåsi et al. (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Szãllåsi</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Boussau</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Abby</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Tannier</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Daubin</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Phylogenetic modeling of lateral gene transfer reconstructs the pattern and relative timing of speciations</article-title>
        <source>Proceedings of the National Academy of Sciences of the United States of America</source>
        <issue>43</issue>
        <year>2012</year>
        <volume>109</volume>
        <fpage>17513</fpage>
        <lpage>17518</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1202997109</pub-id>
        <pub-id pub-id-type="pmid">23043116</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-57">
      <label>Thomas, Gilbert &amp; Meyer (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thomas</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Gilbert</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Metagenomics - a guide from sampling to data analysis</article-title>
        <source>Microbial Informatics and Experimentation</source>
        <year>2012</year>
        <volume>2</volume>
        <fpage>3</fpage>
        <pub-id pub-id-type="doi">10.1186/2042-5783-2-3</pub-id>
        <pub-id pub-id-type="pmid">22587947</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-58">
      <label>Tringe et al. (2005)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tringe</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Von Mering</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kobayashi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Salamov</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>HW</given-names>
          </name>
          <name>
            <surname>Podar</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Short</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Mathur</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Detter</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hugenholtz</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Rubin</surname>
            <given-names>EM</given-names>
          </name>
        </person-group>
        <article-title>Comparative metagenomics of microbial communities</article-title>
        <source>Science</source>
        <issue>5721</issue>
        <year>2005</year>
        <volume>308</volume>
        <fpage>554</fpage>
        <lpage>557</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1107851</pub-id>
        <pub-id pub-id-type="pmid">15845853</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-59">
      <label>Tyson et al. (2004)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tyson</surname>
            <given-names>GW</given-names>
          </name>
          <name>
            <surname>Chapman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hugenholtz</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Allen</surname>
            <given-names>EE</given-names>
          </name>
          <name>
            <surname>Ram</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>PM</given-names>
          </name>
          <name>
            <surname>Solovyev</surname>
            <given-names>VV</given-names>
          </name>
          <name>
            <surname>Rubin</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Rokhsar</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Banfield</surname>
            <given-names>JF</given-names>
          </name>
        </person-group>
        <article-title>Community structure and metabolism through reconstruction of microbial genomes from the environment</article-title>
        <source>Nature</source>
        <issue>6978</issue>
        <year>2004</year>
        <volume>428</volume>
        <fpage>37</fpage>
        <lpage>43</lpage>
        <pub-id pub-id-type="doi">10.1038/nature02340</pub-id>
        <pub-id pub-id-type="pmid">14961025</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-60">
      <label>Venter et al. (2004)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Venter</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Remington</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Heidelberg</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Halpern</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Rusch</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Eisen</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Paulsen</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Nelson</surname>
            <given-names>KE</given-names>
          </name>
          <name>
            <surname>Nelson</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Fouts</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Levy</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Knap</surname>
            <given-names>AH</given-names>
          </name>
          <name>
            <surname>Lomas</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Nealson</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Peterson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Parsons</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Baden-Tillson</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Pfannkoch</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Rogers</surname>
            <given-names>Y-H</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>HO</given-names>
          </name>
        </person-group>
        <article-title>Environmental genome shotgun sequencing of the Sargasso Sea</article-title>
        <source>Science</source>
        <issue>5667</issue>
        <year>2004</year>
        <volume>304</volume>
        <fpage>66</fpage>
        <lpage>74</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1093857</pub-id>
        <pub-id pub-id-type="pmid">15001713</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-61">
      <label>Wang et al. (2007)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Garrity</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Tiedje</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Cole</surname>
            <given-names>JR</given-names>
          </name>
        </person-group>
        <article-title>Naive bayesian classifier for rapid assignment of rrna sequences into the new bacterial taxonomy</article-title>
        <source>Applied and Environmental Microbiology</source>
        <issue>16</issue>
        <year>2007</year>
        <volume>73</volume>
        <fpage>5261</fpage>
        <lpage>5267</lpage>
        <pub-id pub-id-type="doi">10.1128/AEM.00062-07</pub-id>
        <pub-id pub-id-type="pmid">17586664</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-62">
      <label>Woyke et al. (2010)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Woyke</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tighe</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Mavromatis</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Clum</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Copeland</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schackwitz</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Lapidus</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>McCutcheon</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>McDonald</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Moran</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Bristow</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>J-F</given-names>
          </name>
        </person-group>
        <article-title>One bacterial cell, one complete genome</article-title>
        <source>PLoS ONE</source>
        <issue>4</issue>
        <year>2010</year>
        <volume>5</volume>
        <elocation-id>e243</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0010314</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-63">
      <label>Wu et al. (2009)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hugenholtz</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mavromatis</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Pukall</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Dalin</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Ivanova</surname>
            <given-names>NN</given-names>
          </name>
          <name>
            <surname>Kunin</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Goodwin</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tindall</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Hooper</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Pati</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lykidis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Spring</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Anderson</surname>
            <given-names>IJ</given-names>
          </name>
          <name>
            <surname>D’haeseleer</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Zemla</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Singer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lapidus</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Nolan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Copeland</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>J-F</given-names>
          </name>
          <name>
            <surname>Lucas</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kerfeld</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lang</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Gronow</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chain</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Bruce</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Rubin</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Kyrpides</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Klenk</surname>
            <given-names>H-P</given-names>
          </name>
          <name>
            <surname>Eisen</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>A phylogeny-driven genomic encyclopaedia of bacteria and archaea</article-title>
        <source>Nature</source>
        <issue>7276</issue>
        <year>2009</year>
        <volume>462</volume>
        <fpage>1056</fpage>
        <lpage>1060</lpage>
        <pub-id pub-id-type="doi">10.1038/nature08656</pub-id>
        <pub-id pub-id-type="pmid">20033048</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-64">
      <label>Wu, Jospin &amp; Eisen (2013)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Jospin</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Eisen</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Systematic identification of gene families for use as markers for phylogenetic and phylogeny-driven ecological studies of bacteria and archaea and their major subgroups</article-title>
        <source>PLoS ONE</source>
        <issue>10</issue>
        <year>2013</year>
        <volume>8</volume>
        <elocation-id>e243</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0077033</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-65">
      <label>Wu &amp; Scott (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Scott</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>Phylogenomic analysis of bacterial and archaeal sequences with amphora2</article-title>
        <source>Bioinformatics</source>
        <issue>7</issue>
        <year>2012</year>
        <volume>28</volume>
        <fpage>1033</fpage>
        <lpage>1034</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts079</pub-id>
        <pub-id pub-id-type="pmid">22332237</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-66">
      <label>Wu &amp; Eisen (2008)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Eisen</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A simple, fast, and accurate method of phylogenomic inference</article-title>
        <source>Genome Biology</source>
        <issue>10</issue>
        <year>2008</year>
        <volume>9</volume>
        <fpage>R151</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2008-9-10-r151</pub-id>
        <pub-id pub-id-type="pmid">18851752</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-67">
      <label>Yatsunenko et al. (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yatsunenko</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Rey</surname>
            <given-names>FE</given-names>
          </name>
          <name>
            <surname>Manary</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Trehan</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Dominguez-Bello</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>Contreras</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Magris</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hidalgo</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Baldassano</surname>
            <given-names>RN</given-names>
          </name>
          <name>
            <surname>Anokhin</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Heath</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Warner</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Reeder</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kuczynski</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Caporaso</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Lozupone</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Lauber</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Clemente</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Knights</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gordon</surname>
            <given-names>JI</given-names>
          </name>
        </person-group>
        <article-title>Human gut microbiome viewed across age and geography</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>486</volume>
        <fpage>222</fpage>
        <lpage>227</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11053</pub-id>
        <pub-id pub-id-type="pmid">22699611</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-68">
      <label>Zhao, Tang &amp; Ye (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ye</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>RAPSearch2: a fast and memory-efficient protein similarity search tool for next generation sequencing data</article-title>
        <source>Bioinformatics</source>
        <issue>1</issue>
        <year>2011</year>
        <volume>28</volume>
        <fpage>125</fpage>
        <lpage>126</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr595</pub-id>
        <pub-id pub-id-type="pmid">22039206</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
