<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Biol</journal-id>
    <journal-title-group>
      <journal-title>BMC Biology</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1741-7007</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9710168</article-id>
    <article-id pub-id-type="pmid">36447211</article-id>
    <article-id pub-id-type="publisher-id">1453</article-id>
    <article-id pub-id-type="doi">10.1186/s12915-022-01453-6</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Synthetic Micrographs of Bacteria (SyMBac) allows accurate segmentation of bacterial cells using deep neural networks</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Hardo</surname>
          <given-names>Georgeos</given-names>
        </name>
        <address>
          <email>gh464@cam.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Noka</surname>
          <given-names>Maximilian</given-names>
        </name>
        <address>
          <email>maxnoka@live.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Bakshi</surname>
          <given-names>Somenath</given-names>
        </name>
        <address>
          <email>sb2330@cam.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.5335.0</institution-id><institution-id institution-id-type="ISNI">0000000121885934</institution-id><institution>Department of Engineering, </institution><institution>University of Cambridge, </institution></institution-wrap>Trumpington Street, Cambridge, UK </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>30</day>
      <month>11</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>30</day>
      <month>11</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>263</elocation-id>
    <history>
      <date date-type="received">
        <day>6</day>
        <month>6</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>31</day>
        <month>10</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Deep-learning–based image segmentation models are required for accurate processing of high-throughput timelapse imaging data of bacterial cells. However, the performance of any such model strictly depends on the quality and quantity of training data, which is difficult to generate for bacterial cell images. Here, we present a novel method of bacterial image segmentation using machine learning models trained with Synthetic Micrographs of Bacteria (SyMBac).</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We have developed SyMBac, a tool that allows for rapid, automatic creation of arbitrary amounts of training data, combining detailed models of cell growth, physical interactions, and microscope optics to create synthetic images which closely resemble real micrographs, and is capable of training accurate image segmentation models. The major advantages of our approach are as follows: (1) synthetic training data can be generated virtually instantly and on demand; (2) these synthetic images are accompanied by perfect ground truth positions of cells, meaning no data curation is required; (3) different biological conditions, imaging platforms, and imaging modalities can be rapidly simulated, meaning any change in one’s experimental setup no longer requires the laborious process of manually generating new training data for each change. Deep-learning models trained with SyMBac data are capable of analysing data from various imaging platforms and are robust to drastic changes in cell size and morphology. Our benchmarking results demonstrate that models trained on SyMBac data generate more accurate cell identifications and precise cell masks than those trained on human-annotated data, because the model learns the true position of the cell irrespective of imaging artefacts. We illustrate the approach by analysing the growth and size regulation of bacterial cells during entry and exit from dormancy, which revealed novel insights about the physiological dynamics of cells under various growth conditions.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">The SyMBac approach will help to adapt and improve the performance of deep-learning–based image segmentation models for accurate processing of high-throughput timelapse image data.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12915-022-01453-6.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Image analysis</kwd>
      <kwd>High-throughput imaging</kwd>
      <kwd>Microfluidics</kwd>
      <kwd>Timelapse microscopy</kwd>
      <kwd>Bacterial cell imaging</kwd>
      <kwd>Deep-learning</kwd>
      <kwd>Synthetic images</kwd>
      <kwd>Cell segmentation</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000288</institution-id>
            <institution>Royal Society</institution>
          </institution-wrap>
        </funding-source>
        <award-id>G109931</award-id>
        <principal-award-recipient>
          <name>
            <surname>Hardo</surname>
            <given-names>Georgeos</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100010269</institution-id>
            <institution>Wellcome Trust</institution>
          </institution-wrap>
        </funding-source>
        <award-id>RG89305</award-id>
        <principal-award-recipient>
          <name>
            <surname>Noka</surname>
            <given-names>Maximilian</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000268</institution-id>
            <institution>Biotechnology and Biological Sciences Research Council</institution>
          </institution-wrap>
        </funding-source>
        <award-id>BB/M011194/1</award-id>
        <principal-award-recipient>
          <name>
            <surname>Bakshi</surname>
            <given-names>Somenath</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par10">High-throughput time-resolved imaging of bacterial cells has revolutionised the fields of systems and synthetic microbiology [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR7">7</xref>]. Deep-learning–based approaches are rapidly gaining popularity for automated processing of such high volumes of data [<xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR13">13</xref>]. The performance of such deep-learning algorithms is fundamentally dependent on the quality and quantity of the training data provided to it [<xref ref-type="bibr" rid="CR14">14</xref>]. However, the task of generating training data with accurate ground truth is not only slow and difficult but a near-impossible one for images of micron-sized bacterial cells. The comparable size of the point spread function (PSF) of the microscope corrupts the images of bacterial cells, blurring them to the extent that neither expert users nor traditional computational segmentation programs can accurately annotate the correct pixels. Additionally, geometric effects in the microscopic 2D projection of 3D objects in an image lead to inaccuracies in contrast-based segmentation by both humans and computational programs (Additional file <xref rid="MOESM1" ref-type="media">1</xref>, Section 1, [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>]). Inaccuracies in the ground truth of training data cause deep-learning models to misinterpret the relations between the object and its image, resulting in systematically artefactual mask predictions. This limits one’s ability to infer a cell’s true size and shape and confounds the analysis.</p>
    <p id="Par11">To address these limitations, we have developed a new approach of image segmentation of bacterial cells, where deep-learning networks are trained entirely on synthetic data. The main challenge here is to generate synthetic data that accurately reflects the object-to-image relations in a diverse range of imaging modalities and platforms. To tackle this, we have created SyMBac (<italic>Sy</italic>nthetic <italic>M</italic>icrographs of <italic>Bac</italic>teria), a tool to generate realistic synthetic images of bacteria in a wide range of experimental settings. SyMBac combines detailed models of cell growth and morphology, its position and interaction with the imaging platform, and the microscope’s optics to render synthetic images capable of training highly accurate segmentation networks without human-annotated data. A neural network trained on this synthetic data can precisely learn about the corruption modes introduced during image formation and, as a result, output accurate cell masks. This not only greatly speeds up the process of image segmentation (because no human annotation is necessary), but most importantly generates more accurate masks of cells, enabling precise analysis of size regulation and growth dynamics. Using our method, given any change in experimental settings, it becomes trivial to generate high volumes of new synthetic images and ground truths to retrain segmentation models and rapidly analyse new data. This also addresses the robustness and reproducibility problems of image processing using deep-learning because models can now be easily adapted and benchmarked, since synthetic data can be generated at any desired spatial and temporal resolution with known parameters.</p>
    <p id="Par12">In this paper, we show that SyMBac can be used to generate synthetic micrographs for linear or monolayer colonies of bacteria in microfluidic devices or agar pads. While SyMBac can be easily used with fluorescence images, we primarily focus on the more challenging task of tackling phase-contrast images of bacteria in these platforms. This is because phase-contrast imaging can be used ubiquitously for all microbes since it does not require any kind of labelling and also because it poses a more difficult challenge for segmentation algorithms, as the images contain the structures of the imaging platform, making it difficult to separate them from the cells. This problem is most severely felt in microfluidic linear colonies (mother machine [<xref ref-type="bibr" rid="CR17">17</xref>]) and single-cell chemostats [<xref ref-type="bibr" rid="CR18">18</xref>], where the microfluidic device’s features are comparable to the size and refractive index of the cells which they trap, giving them similar contrast. However, microfluidic linear colonies are also of major interest to quantitative microbiologists, as they are able to provide the highest throughput and most precise control of growth conditions [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR19">19</xref>]. This has recently revolutionised research in quantitative single-cell bacterial physiology [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR20">20</xref>–<xref ref-type="bibr" rid="CR23">23</xref>]. Accurate segmentation of individual cells in these platforms is sorely needed for further and deeper investigations into single-cell physiology. Our results show SyMBac can be used to rapidly generate realistic training data for these platforms, which is capable of training accurate segmentation models. Machine learning models trained with SyMBac data is highly accurate in cell identification and produce more precise masks of cells in these platforms compared to models trained on data generated or curated by humans. This enabled precise analysis of cell size and shape regulation along changing conditions in a growing bacterial cell culture, revealing novel insights about the physiological dynamics of individual bacterial cells during entry and exit from dormancy.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>SyMBac allows for generation of realistic synthetic data in a variety of experimental conditions</title>
      <p id="Par13">In Fig. <xref rid="Fig1" ref-type="fig">1</xref>b, we show the overall process of generating synthetic training data for bacterial cells growing in microfluidic linear colonies, which is SyMBac’s primary use in this paper. A rigid body physics simulation is combined with an agent-based model of bacterial cell growth to generate model scenes of cells growing in these devices (details of the model parameters and implementation are provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>, Section 2, [<xref ref-type="bibr" rid="CR24">24</xref>]). The output position and geometry of this combined model are then used to produce synthetic micrographs and the corresponding ground truths through the following steps. First, properties from the simulation are extracted and used to render an optical path length (OPL) image that signifies the relative phase shift in the image—observed as as a change in intensity—due to the local refractive index (Fig. S3.1 in Additional file <xref rid="MOESM1" ref-type="media">1</xref>). To generate micrographs, this OPL image is then convolved with the microscope’s point spread function (PSF) which can be generated using known parameters of the objective lens and phase ring/annulus (Additional file <xref rid="MOESM1" ref-type="media">1</xref>, Section 4 [<xref ref-type="bibr" rid="CR25">25</xref>–<xref ref-type="bibr" rid="CR27">27</xref>]). These properties are easy to find and thus any change in microscope optics can be readily simulated. SyMBac offers 2D approximations to microscope optics, but also has an option for 3D optical models, allowing the user to trade image accuracy for simulation speed. Next, users have an option to add a camera model (if the user knows the properties of their camera) to simulate the image capture process. Finally, the intensity distribution and noise spectrum of the resultant image are then further optimised in order to maximise its similarity to the real images (Additional file <xref rid="MOESM1" ref-type="media">1</xref>, Sections 7 and 8).<fig id="Fig1"><label>Fig. 1</label><caption><p>The synthetic image generation process: <bold>a</bold> Schematic of linear colonies of cells in a microfluidic device known colloquially as the mother machine. <bold>b</bold> Synthetic image generation pipeline: rigid body physics simulations are combined with agent-based modelling to simulate bacterial growth in the device. These simulations are convolved with the microscope’s point spread function, which is generated using known parameters of the objective lens. This output image is then further optimised to match real images. Scale bar = 1 μm. <bold>c</bold> Synthetic data can be adapted to different biological conditions, variations in microfluidic designs, and imaging modalities. With real data, many experiments would need to be conducted to generate training data with the same kind of coverage. Scale bar = 1 μm. <bold>d</bold> Typical timescales for individual steps in the generation of training data. <bold>e</bold> Humans annotating images had variable performances and consistently undersegmented cells, especially in small stationary phase cells. <bold>f</bold> SyMBac is approximately 10,000× faster than a human at generating training data (10,000 images in less than 10 min)</p></caption><graphic xlink:href="12915_2022_1453_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par14">Synthetic images generated by SyMBac can be tuned according to variations in biology (cell size, shape, etc.), the imaging platform (microfluidic device architecture, agar pad), optics (magnification, numerical aperture, and additional properties of the objective lens), and whether the experiment is phase contrast or fluorescence (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c). The physics back-end of SyMBac can be adapted to model alternative imaging platforms, to generate synthetic training data for imaging experiments of both 1D and 2D colonies (Additional file <xref rid="MOESM1" ref-type="media">1</xref>, Section 13). Put together, this enables us to produce realistic phase-contrast and fluorescence images of bacterial cells in microfluidic platforms and on agar pads (Figs. <xref rid="Fig1" ref-type="fig">1</xref>c, <xref rid="Fig2" ref-type="fig">2</xref>, and <xref rid="Fig6" ref-type="fig">6</xref>). In Fig. <xref rid="Fig2" ref-type="fig">2</xref>a, we demonstrate the use of SyMBac to generate synthetic phase-contrast images for the microfluidic turbidostat devices described in [<xref ref-type="bibr" rid="CR28">28</xref>]. Comparison of the close-ups from the synthetic image and the real image from such devices reveals the similarities in texture and contrast, which are crucial to ensure that the synthetic training data is realistic enough for models trained with it to perform well on real data (as shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref>). Similarly, it is possible to generate synthetic micrographs of timelapse experiments of the growth of monolayer colonies on agar pads. The close-ups of the synthetic images show that the model captures all the relevant details: background texture from agar imperfections, contrast shade-off effects near the centre of the monolayer colony, and background halo and darker cells near the edge of the colony (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b and Additional file <xref rid="MOESM1" ref-type="media">1</xref>, Section 13).<fig id="Fig2"><label>Fig. 2</label><caption><p>Different synthetic image modalities: <bold>a</bold> Synthetic data can be generated for microfluidic devices that produce monolayer colonies, in this case the microfluidic turbedostat described in [<xref ref-type="bibr" rid="CR28">28</xref>] (real image courtesy of Elf Lab, Uppsala University). Scale bar = 2 μm <bold>b</bold> SyMBac can also generate timelapse image data for the growth of monolayer colonies on agar pads. Scale bar = 2 μm</p></caption><graphic xlink:href="12915_2022_1453_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par15">SyMBac data also provides an excellent opportunity for benchmarking the performance, speed, and accuracy of human annotators and traditional thresholding-based computational segmentation approaches, as perfect ground truth is available for each image (Additional file <xref rid="MOESM1" ref-type="media">1</xref>, Section 1). Our benchmarking experiments show that human annotators are not only slow, but generated inaccurate training data (Fig. <xref rid="Fig1" ref-type="fig">1</xref>f, e), being unable to maintain consistency or accuracy in correctly identifying pixels at the cell boundary. Additionally, we found that annotation results were highly variable across growth regimes, with the error rate in annotating small cells from the stationary phase being higher (Additional file <xref rid="MOESM1" ref-type="media">1</xref>, Section 1). While better than human-annotated training data, we also find that the unsupervised approaches using Otsu, local thresholding, and membrane dye images still suffer from bias and lack of robustness towards size variation (Figs. S1.2, S1.3, and S1.4, in Additional file <xref rid="MOESM1" ref-type="media">1</xref>). This suggests that these traditional approaches are not suitable when accurate cell masks are desired and would not be suitable for generating training data required for training ML algorithms to accurately segment data. SyMBac addresses this critical issue, since the synthetic images from SyMBac are accompanied with perfect ground truth information of cell shape and position. Models trained on our data therefore ensure the neural network learns the true relation between object and its corresponding image.</p>
      <p id="Par16">SyMBac takes advantage of multiprocessing, and where possible offloads array operations onto the GPU, which allows it to be approximately 10,000× faster than a human at generating training data (and if deployed on computing clusters, this could be extended by a further order of magnitude). Typical timescales of generating synthetic images are shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>d. The entire process of generating synthetic data has been made simple through the creation of example Jupyter notebooks with interactive widgets, which guide the user through the entire process. The output format of the training data (synthetic images and ground truth) can be chosen as single frames or tiles, depending on the segmentation network of choice. We provide example notebooks of training deep-learning segmentation networks, such as DeLTA and Omnipose with SyMBac data, and notebooks for using one’s trained models for image segmentation. This information is kept up to date online through browsable documentation.</p>
    </sec>
    <sec id="Sec4">
      <title>SyMBac enables easy training of existing deep-learning segmentation models</title>
      <p id="Par17">Once synthetic images are generated, a segmentation network (e.g. U-net [<xref ref-type="bibr" rid="CR29">29</xref>]) is trained. This network learns the relation between the synthetic image and ground truth pair to infer image-to-object relationships in real experimental images (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). We evaluated the usefulness of synthetic data for this purpose by applying it two popular methods: (1) DeLTA, an implementation of U-net [<xref ref-type="bibr" rid="CR30">30</xref>] for analysing images of cells in linear colonies, and (2) OmniPose [<xref ref-type="bibr" rid="CR31">31</xref>], a deep neural network for morphologically robust segmentation of bacteria. For DeLTA, since the output from the U-net is only a probabilistic mask, a correct probability threshold must be determined to compute accurate binary masks. To calculate the optimal probabilistic threshold value, we developed a validation mechanism which utilises synthetic data to estimate the optimal mask pixel probability threshold by passing an independent set of synthetic validation data through the trained model and thresholding the output until the masks are maximally similar to the ground truth masks. Two metrics can be used to evaluate the optimal mask threshold, one is the Jaccard index, which is a pixelwise measure of the difference between the true masks and the target thresholded masks. The other measure involves maximising the cumulative intersection between the length and width distributions of cells in the true masks with those in the target thresholded masks. We show that, for these experiments, these independent metrics produce the same optimal mask threshold (Fig. S9.1a in Additional file <xref rid="MOESM1" ref-type="media">1</xref>). Omnipose, the second network we tested, does not require any thresholding of the masks by the user. Additionally, training data for Omnipose differs from training data for DeLTA in that cell masks are allowed to touch in the Omnipose model, whereas DeLTA requires the computation of weightmaps around the edges of cells. Omnipose is therefore easier to train, output masks require no thresholding, and masks are allowed to touch, as Omnipose returns an instance segmentation. While the published pretrained Omnipose model is already robust for most applications, it is unsuitable for use with microfluidic devices and produces artefacts (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b). We retrained Omnipose with SyMBac data and the resultant model produced morphologically accurate masks of cells in microfluidic devices and still maintained good performance in other imaging platforms.<fig id="Fig3"><label>Fig. 3</label><caption><p>Model training, evaluation, and timing benchmarks: <bold>a</bold> Schematic of the U-net model being trained using synthetic data and then segmenting real data to produce accurate masks. <bold>b</bold> SyMBac can retrain generalised models, such as Omnipose (a derivative of Cellpose, allowing for mask reconstruction from arbitrary morphologies). Because Omnipose was not trained on any microfluidic device images, it fails to properly segment the image, attaching masks to the mother machine trench geometry (though it admirably segments cells within the trench). Retraining Omnipose with SyMBac’s synthetic data results in near perfect segmentation, with no more trench artefacts. <bold>c</bold> A typical time to train the network, either Omnipose or DeLTA (on 2000 images) and segment approximately one million images (Nvidia GeForce 1080Ti)</p></caption><graphic xlink:href="12915_2022_1453_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par18">Since SyMBac uses synthetic data for training, validation data is not available in the traditional sense. Instead, the model is evaluated automatically epoch-by-epoch in terms of cell identification errors, and the model with the lowest error is kept (Fig. S9.1b in Additional file <xref rid="MOESM1" ref-type="media">1</xref>). Automatic identification error rate calculations are possible without validation data due to the predictable nature of bacterial growth in linear colonies (detailed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>, Section 9). In general, 100 epochs were enough to drive the identification error below <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.5\%$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mn>0.5</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12915_2022_1453_Article_IEq1.gif"/></alternatives></inline-formula> with DeLTA. Up to 400 epochs were necessary to achieve less than <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.2\%$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mn>0.2</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12915_2022_1453_Article_IEq2.gif"/></alternatives></inline-formula> error. The Omnipose model was trained for 4000 epochs and was able to achieve <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;0.1\%$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.1</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12915_2022_1453_Article_IEq3.gif"/></alternatives></inline-formula> error. Typical timescales for model training and segmentation are shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>c.</p>
    </sec>
    <sec id="Sec5">
      <title>Models trained on synthetic data show superior performance and precision compared to those trained on human-annotated data</title>
      <p id="Par19">SyMBac-trained models produce more consistent, less flawed, and visually more “natural” cell mask shapes compared to models trained with user-annotated data (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a, b). This is because masks from synthetic data are never corrupted by changes in the images from which they come and are accompanied with perfect ground truth. To perform a rigorous comparison between synthetic data and human-generated data, we generated a synthetic dataset based on reference images from the original DeLTA paper’s dataset using SyMBac. We then trained two models, one on SyMBac data and one on the training data provided in the DeLTA paper [<xref ref-type="bibr" rid="CR30">30</xref>]. In the DeLTA paper, a semi-automatic tool was used to generate training data, which involves subjectivity in the choice of thresholding parameters and morphological operators. This results in training data with oddly shaped masks, which are consequently learned and then reproduced by the network during training and prediction (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a, Additional file <xref rid="MOESM1" ref-type="media">1</xref>, Part 10). The networks trained with SyMBac produce far more realistic and consistent mask predictions compared with models trained with human-curated training data (dataset from Lugagne et al. [<xref ref-type="bibr" rid="CR30">30</xref>]) while maintaining almost the same accuracy (Table <xref rid="Tab1" ref-type="table">1</xref>). Furthermore, we observe that the DeLTA model trained with SyMBac shows much higher temporal coherence when compared to models trained on human-annotated data. Output masks from the DeLTA model trained with human-curated training data showed unrealistic fluctuations in cell width from frame to frame, while SyMBac-trained models did not (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b).<fig id="Fig4"><label>Fig. 4</label><caption><p>Model quality and segmentation precision: <bold>a</bold> The masks from SyMBac-trained models are truer to the geometry of the cells, displaying no aberration when compared to model outputs trained on human-annotated data. <bold>b</bold> The masks also maintain a narrow distribution of widths, while the masks from DeLTA trained with human-annotated data display a wide variation with the peak shifted to lower values and show 2.5× higher variation in cell width. <bold>c</bold> Examples of the type of data which can be segmented using a single SyMBac-trained model. In this case, we show the performance of a single DeLTA model trained on combination data across 3 different cell sizes. Scale bar = 2 μm <bold>d</bold> The SyMBac-trained model produces masks with precisions of 40 nm for length and 19 nm for width. This is calculated by fitting a line to the length and width trace of cells in the stationary phase</p></caption><graphic xlink:href="12915_2022_1453_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par20">
        <table-wrap id="Tab1">
          <label>Table 1</label>
          <caption>
            <p>Performance (cell identification error) benchmarking of DelTA trained with SyMBac. Models trained with SyMBac perform well for both oil and air objectives and outperform models trained with user-generated training data</p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <th align="left">Dataset</th>
                <th align="left">DeLTA (pretrained)</th>
                <th align="left">DeLTA (SyMBac trained)</th>
                <th align="left">Omnipose (SyMBac trained)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left">100×, oil, NA 1.45, [<xref ref-type="bibr" rid="CR30">30</xref>]</td>
                <td align="left">0.93%</td>
                <td align="left">1.1%</td>
                <td align="left">0.25%</td>
              </tr>
              <tr>
                <td align="left">100×, oil, NA 1.49 [<xref ref-type="bibr" rid="CR3">3</xref>]</td>
                <td align="left">1.8%</td>
                <td align="left">0.47%</td>
                <td align="left">0.12%</td>
              </tr>
              <tr>
                <td align="left">60×, air, NA 0.95 [<xref ref-type="bibr" rid="CR3">3</xref>]</td>
                <td align="left">N/A</td>
                <td align="left">0.35%</td>
                <td align="left">0.28%</td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
      </p>
      <p id="Par21">DeLTA models trained with SyMBac data were able to achieve comparable identification accuracy (table in Table <xref rid="Tab1" ref-type="table">1</xref> as the model trained on human-annotated and human-curated data, which is remarkable, since it shows that SyMBac is able to generate realistic training data from just the reference images. Notably, the true advantage of SyMBac is in its ability to generalise to experimental variations where pretrained models fail. When we tested against a data set collected with a 60× air objective, the pretrained DeLTA model could not produce any masks, and therefore, we could not quantify the error. Conversely, SyMBac can generate similar images and ground truth pairs, and DeLTA models trained with this data produced highly accurate segmentation with an identification error rate of <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.36\%$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mn>0.36</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12915_2022_1453_Article_IEq4.gif"/></alternatives></inline-formula> (Table <xref rid="Tab1" ref-type="table">1</xref>) and high-quality cell masks (examples in Fig. <xref rid="Fig4" ref-type="fig">4</xref>c and Additional file <xref rid="MOESM1" ref-type="media">1</xref>, Section 11). Precise segmentation of images from low NA air objective has been a major challenge, and this capability opens up possibilities of analysing high-throughput experiments conducted with such objectives, due to their large field of view and fast scan speed. DeLTA trained with SyMBac data also gave 18× better identification accuracy compared to pretrained DeLTA models for a separate 100× dataset (experiments detailed in Bakshi et al. [<xref ref-type="bibr" rid="CR3">3</xref>]). Interestingly, Omnipose models trained with SyMBac produced higher identification accuracies under all imaging conditions tested here. The possible explanations are Omnipose’s robustness to morphological variations and being able to segment very closely packed cells due to its mask reconstruction algorithm. Omnipose models trained on SyMBac data also yielded much more realistic cell masks compared to Omnipose models trained on human-annotated training data (dataset from Lugagne et al. [<xref ref-type="bibr" rid="CR30">30</xref>]).</p>
    </sec>
    <sec id="Sec6">
      <title>Models trained with synthetic data are robust to changes in experimental conditions</title>
      <p id="Par22">Segmentation algorithms (both ML and non-ML) face an even harder challenge when the data type itself changes during the experiment, for example, cells changing size, shape, and intensity along a growth-curve experiment as they transition from exponential to stationary phase and back (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a) [<xref ref-type="bibr" rid="CR3">3</xref>]. Since cells in the stationary phase are very small, the relative annotation error grows (as shown in our benchmarking results in Fig. S1.1 in Additional file <xref rid="MOESM1" ref-type="media">1</xref>) and compromises the performance of the ML algorithm. On the other hand, non-ML methods suffer from changes in object size, as algorithmic parameters need to be retuned when large changes are observed in the image (for example, morphological operators need to have their window size changed to account for differently sized cells). SyMBac can address this issue by generating high-quality training datasets for cells at any size (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c), producing accurate cell masks throughout the experiment (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c and Fig. S11.2 in Additional file <xref rid="MOESM1" ref-type="media">1</xref>). While models trained with small cell training data perform well in the stationary phase, this comes at the cost of reduced accuracy in the exponential phase, and the converse is also true (table in Table <xref rid="Tab2" ref-type="table">2</xref>); however, this effect is much less pronounced when training Omnipose models. Instead, a complete dataset, which combines synthetic images of both types, leads to an overall better performance in identification accuracy and highly precise masks for estimating cell length and width (Table <xref rid="Tab2" ref-type="table">2</xref>). The models trained on combination datasets are robust to large variations in cell size (Additional file <xref rid="MOESM1" ref-type="media">1</xref>, Section 11), while maintaining the ability to detect very small variations in size due to the segmentation precision. This opens up possibilities of deeper investigations into cell size and shape regulation, as cell width can now be accurately characterised.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Comparison of DeLTA and Omnipose trained on 3 types of synthetic training data: data containing large cells only, data containing small cells only, and the combination of these two cell types to produce a combined dataset. As expected, specialist models tend to perform better when segmenting their own data type, and worse when segmenting unseen data types. A model trained on a combination of the two datasets provides a good compromise, not needing to train multiple models, while retaining good performance across the entire dataset. Interestingly, the Omnipose model trained on combination data performed as well on exponentially growing cells as the same model trained only on large cell synthetic data, implying that the network has residual capacity to learn. This was also noted in the original Cellpose paper [<xref ref-type="bibr" rid="CR32">32</xref>]</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="3">Dataset</th><th align="left" colspan="3">Model: DeLTA</th><th align="left" colspan="3">Model: Omnipose</th></tr><tr><th align="left" colspan="3">Training data</th><th align="left" colspan="3">Training data</th></tr><tr><th align="left">Large</th><th align="left">Small</th><th align="left">Combined</th><th align="left">Large</th><th align="left">Small</th><th align="left">Combined</th></tr></thead><tbody><tr><td align="left">Exponential [<xref ref-type="bibr" rid="CR3">3</xref>]</td><td align="left">0.10%</td><td align="left">2.4%</td><td align="left">0.14%</td><td align="left">0.09%</td><td align="left">0.37%</td><td align="left">0.09%</td></tr><tr><td align="left">Stationary [<xref ref-type="bibr" rid="CR3">3</xref>]</td><td align="left">1.6%</td><td align="left">0.40%</td><td align="left">0.80%</td><td align="left">0.89%</td><td align="left">0.12%</td><td align="left">0.20%</td></tr><tr><td align="left">Full growth curve [<xref ref-type="bibr" rid="CR3">3</xref>]</td><td align="left">0.95%</td><td align="left">1.4%</td><td align="left">0.47%</td><td align="left">0.45%</td><td align="left">0.25%</td><td align="left">0.12%</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec7">
      <title>Precision of synthetic data trained models reveals novel width regulation in <italic>E. coli</italic> exiting stationary phase</title>
      <p id="Par23">As a proof-of-principle application, we have used SyMBac-trained models to analyse a timelapse experiment (1800 frames) of 4500 mother cells growing in linear colonies under changing growth conditions, whereby the cells undergo a feast famine cycle [<xref ref-type="bibr" rid="CR3">3</xref>]. The segmentation network maintained high identification accuracy and produced visually accurate masks of cells throughout the experiment (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c). To estimate the size and shape of individual cells from these accurate masks, we used colicoords, a python package for generating cell coordinates from segmentation outputs ([<xref ref-type="bibr" rid="CR16">16</xref>]).</p>
      <p id="Par24">The precise estimates of cell size from the segmentation outputs enabled us to compute single-cell growth rates during the exponential phase, along the entry and exit from the stationary phase along a growth curve (Fig. <xref rid="Fig5" ref-type="fig">5</xref>d), and at different points within the stationary phase (Fig. <xref rid="Fig5" ref-type="fig">5</xref>e–i). During exponential growth, cells elongate at a mean rate of 2.6 volume doublings per hour, which drops to 1.7 volume doublings per hour as cells begin to enter the stationary phase, and then asymptotically decreases as cells progress deeper into the stationary phase. Notably, a small residual, but detectable growth rate is maintained (0.029 volume doublings per hour), which is approximately 100 times slower than the exponential growth rate (Fig. <xref rid="Fig5" ref-type="fig">5</xref>f–h). When fresh media are introduced to the deep stationary phase cell culture, cells recover their growth rates as they re-enter exponential growth (Fig. <xref rid="Fig5" ref-type="fig">5</xref>i). Since the cells almost stop growing in the deep stationary phase, the fluctuations in the cell size estimates from the binary mask can be used to estimate the precision of segmentation (Fig. S9.5 in Additional file <xref rid="MOESM1" ref-type="media">1</xref>). We estimated the precision of the output from SyMBac models to be 40 nm along the length and 19 nm along the width (Fig. <xref rid="Fig4" ref-type="fig">4</xref>d).<fig id="Fig5"><label>Fig. 5</label><caption><p><bold>a</bold> Models trained with SyMBac were used to segment single-cell data throughout all growth curve regimes (colour-coded and used throughout the figure). <bold>b</bold> Example kympgraphs of 100× data showing cells in a variety of states (exponential growth, stationary phase, filamenting) with accompanying masks, highlighting the robustness of the model trained on mixed data to segment cells of multiple cell sizes and morphologies. <bold>c</bold> An example output showing the coordinate system applied to a cell mask, generated by Colicoords [<xref ref-type="bibr" rid="CR16">16</xref>], allowing for highly accurate length and width prediction. <bold>d</bold> Example time series of the size of a single cell going through an entire growth curve. The inset shows cell length changes during the stationary phase. <bold>e</bold>–<bold>i</bold> During the exponential phase, cells exponentially increase their size with a mean growth rate of 2.6 volume doublings per hour, which is equivalent to a population doubling time of 23 min, consistent with the bulk growth measurements of cells in this richly defined medium [<xref ref-type="bibr" rid="CR3">3</xref>]. The distribution of growth rates shifts to the left as cells enter the stationary phase (orange and green phase) and eventually stops 6 h into the stationary phase (pink). For all growth rates, corresponding standard deviations are also reported. <bold>j</bold> Cells show a wide distribution of lengths during the exponential phase which narrows greatly during entry to the stationary phase, as cells are “locked in” to their width. Interestingly, while the mean width decreases in the stationary phase, the variability in cell widths increases. <bold>k</bold> Example of a cell exiting stationary phase, showing the increase in length and width. <bold>l</bold> Comparison of initial length and the added length before the first division after exit from stationary phase shows that cells are noisy as sizers towards length regulation. <bold>m</bold> Comparison of the initial width and the added width before the division shows that <italic>E. coli</italic> is an almost perfect width-sizer, dividing only when individual cells reach a critical width</p></caption><graphic xlink:href="12915_2022_1453_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par25">The highly precise estimates of cell size and shape enable us to look at shape regulation at different stages of starvation and resuscitation. During the entry to the stationary phase, both the length and width of individual cells drop. The large variability of cell lengths during the exponential phase is a result of exponential growth between division events, but cell width is tightly regulated in this phase (Fig. <xref rid="Fig5" ref-type="fig">5</xref>j). During resuscitation, cells increase their width and length and divide once they have reached a critical size (Additional file <xref rid="MOESM1" ref-type="media">1</xref>, Section 12). Upon further investigation, we find that cells are sizers in both width and length during exit from the stationary phase. Interestingly, cells seem to more strictly regulate their width than their length during wake up and each cell divides upon reaching a critical width (Fig. <xref rid="Fig5" ref-type="fig">5</xref>l vs m). Tight regulation of width for size control makes intuitive sense, as the volume of a cell has a stronger dependence on width (radius) than length (<inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V = \pi r^2(l - \frac{2}{3}r)$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mi>π</mml:mi><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12915_2022_1453_Article_IEq5.gif"/></alternatives></inline-formula>). The large variability in cell width in the stationary phase coupled with the strict width requirement for initiating cell division leads to a strong correlation between the shape and size of individual cells and their resuscitation behaviour, with important implications for persistence towards antibiotics, and population fitness in general.</p>
    </sec>
    <sec id="Sec8">
      <title>SyMBac can be used to train accurate segmentation models for various imaging platforms and modalities</title>
      <p id="Par26">Finally, while we demonstrated that SyMBac is most powerful in its ability to train highly accurate models for image segmentation of cells growing in linear colonies, we also sought to extend SyMBac to produce synthetic micrographs of cells growing in monolayer colonies, such as the “biopixel” device [<xref ref-type="bibr" rid="CR33">33</xref>], 2D turbidostat [<xref ref-type="bibr" rid="CR28">28</xref>], and even colonies growing on agar pads. Models trained with this data (DeLTA models) produced accurate segmentation of test images (Fig. <xref rid="Fig6" ref-type="fig">6</xref>) (image data generously provided by the Elf Lab, Uppsala University). To extend the usability of SyMBac to timelapse images collected on agar pads, we have also simulated the growth of micro-colonies in both fluorescence and phase contrast and generated corresponding images (Fig. <xref rid="Fig6" ref-type="fig">6</xref>) which are very similar to real micrographs. Modifications to the simulation, the point spread function, and the segmentation pipeline are described in Additional file <xref rid="MOESM1" ref-type="media">1</xref>, Section 13. These synthetic images were used to train deep-learning networks to achieve good segmentation of experimental images from corresponding test images and produced masks of unprecedented qualities, in terms of the shape of individual cells and robustness towards the variation in size and contrast.<fig id="Fig6"><label>Fig. 6</label><caption><p>Extensions of SyMBac for cell segmentation in images of linear colonies of <italic>B. subtilis</italic> (very straight cells, unlike <italic>E. coli</italic> which have more curvature), monolayer colonies in a 2D microfluidic turbidostat chamber (data from [<xref ref-type="bibr" rid="CR28">28</xref>], kindly provided by the Elf Lab, Uppsala University), growing colonies on agar pad, and low-resolution fluorescence snapshots of dense cell clusters on agar pad. Scale bar = 2 μm</p></caption><graphic xlink:href="12915_2022_1453_Fig6_HTML" id="MO6"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Discussion</title>
    <p id="Par27">Here, we have demonstrated a new approach of cell segmentation using deep-learning models trained entirely on synthetic training data. Synthetic data has been used previously to aid in segmentation. MiSic [<xref ref-type="bibr" rid="CR34">34</xref>] is a tool for segmenting bacterial micrographs based on real training data, but supplements this data with “synthetic” data, which however does not accurately reflect the optics, physics, or biology of the experiment which is being analysed, and thus cannot segment images based purely on synthetic data. BCM3D [<xref ref-type="bibr" rid="CR35">35</xref>] is a tool used for fluorescence biofilm segmentation; however, (1) it is not compatible with linear and monolayer colonies in microfluidic devices that are typically used in high-throughput quantitative experiments, and (2) its synthetic data is only generated in fluorescence and not compatible with phase-contrast images, which are ubiquitous in the imaging of bacteria. SyMBac is the first tool which can generate realistic synthetic data by modelling the entire experimental setup, end-to-end, and is compatible with phase-contrast and fluorescence images from various imaging platforms, such as microfluidic devices and agar pads. This will provide breakthrough advantages for training segmentation models for accurate performance in various types of imaging experiments.</p>
    <p id="Par28">Training data generated in more traditional ways, using various thresholding algorithms, results in variable masks for cells of identical shape and size when the cell’s pixels have different brightness, illumination profiles, etc. (the same cell would be assigned a different training mask depending on the preprocessing algorithms and parameters used). This introduces uncertainties in the assignment of “true pixels” for each cell, which is passed on to the model from training data and is propagated to the output. On the other hand, while input training masks need preprocessing, so do the output masks [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR30">30</xref>]. Post-processing these outputs will deform the already artifactual cell masks even more and make cell morphology analysis highly susceptible to error (both systematic and random). Since SyMBac data is accompanied by perfect ground truth information, the resultant masks are highly precise and accurate and do not need any post-processing. This eliminates user subjectivity in data creation, curation, and final analysis, increasing reproducibility. The highly accurate masks from models trained with SyMBac have revealed novel insights into cellular growth and physiology under changing conditions and pave the way for systems-level analysis of the underlying factors using such high-throughput data.</p>
  </sec>
  <sec id="Sec10">
    <title>Conclusions</title>
    <p id="Par29">In conclusion, SyMBac provides a major technical advancement for the easy adoption and robust implementation of machine learning approaches for analysing microscopy data of microbes. Through the rapid and easy generation of high-quality synthetic data with large coverage of experimental setups and cellular morphologies, SyMBac addresses a critical obstacle in the application of machine learning tools for high-throughput single-cell image analysis from various platforms and organisms. Beyond the compatibility towards variations in cell morphology and imaging platform designs, the microscope model in the pipeline is compatible with objectives of various resolutions, including low-resolution air objectives. Therefore, SyMBac enables easy creation of training data for low-resolution microscopy images, which is near-impossible for human annotators or contrast-based computational programs. This enables high-accuracy segmentation from images collected with air objectives (Fig. S11.3 in Additional file <xref rid="MOESM1" ref-type="media">1</xref>), which will have important implications in analysing high-throughput image-based screening experiments ([<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR36">36</xref>–<xref ref-type="bibr" rid="CR38">38</xref>]), where low-resolution air objectives provide the necessary travel distance, speed, and large fields of view. As SyMBac enables the easy creation of synthetic training data at any spatiotemporal resolution, it also addresses the robustness and reproducibility problems with benchmarking machine learning (ML) and non-ML approaches for cell segmentation and tracking. Therefore, we believe SyMBac will play a critical role in improving the performance of the ML algorithms, while also enabling accurate assessments of their performance limits.</p>
  </sec>
  <sec id="Sec11">
    <title>Methods</title>
    <sec id="Sec12">
      <title>Synthetic image generation</title>
      <p id="Par30">
        <fig id="Fig7">
          <label>Fig. 7</label>
          <caption>
            <p>Block diagram of the image generation pipeline. The cell spherocylinder image is first morphed using the roll function and multiplied by <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_c$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mi>I</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12915_2022_1453_Article_IEq6.gif"/></alternatives></inline-formula>, the empirical cell intensity. To this image is added the trench OPL image, which is multiplied by <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_t$$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mi>I</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12915_2022_1453_Article_IEq7.gif"/></alternatives></inline-formula>, the empirical trench intensity. Finally, the media image is added with those pixels being multiplied by <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_m$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mi>I</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12915_2022_1453_Article_IEq8.gif"/></alternatives></inline-formula>, the empirical media intensity. These steps are described in detail in Additional file <xref rid="MOESM1" ref-type="media">1</xref>, Section 3. The PSF, which has been altered by Gaussian apodisation, and simulated defocus is then convolved over the image. The precise implementation of the PSF and its modifications are described in Additional file <xref rid="MOESM1" ref-type="media">1</xref>, Section 4. The camera-modelled shot noise and read noise are then added to the image (implementation details in Additional file <xref rid="MOESM1" ref-type="media">1</xref>, Section 6 [<xref ref-type="bibr" rid="CR39">39</xref>], with optional Fourier and intensity matching occurring after (Additional file <xref rid="MOESM1" ref-type="media">1</xref>, Section 7, [<xref ref-type="bibr" rid="CR40">40</xref>]). Combined, this produces a synthetic image realistic enough to train highly accurate models for image segmentation of real data</p>
          </caption>
          <graphic xlink:href="12915_2022_1453_Fig7_HTML" id="MO7"/>
        </fig>
      </p>
      <sec id="Sec13">
        <title>Simulation of growth and division of cells and their interactions with each other and the microfluidic device</title>
        <p id="Par31">We built an agent-based model (ABM) of cell growth and division, taking into account the three size regulation modes of bacteria (adder, sizer, timer), while also adding variability to the key parameters governing cell division. Cells are agents with properties such as length, width, position, and age, and can be customised to include new properties such as time-dependent fluorescence intensity. These cell agents exist as dynamic objects in a rigid body physics world called a “scene”, modelled using Python bindings of the popular physics engine Chipmunk (pymunk) [<xref ref-type="bibr" rid="CR24">24</xref>]. Static objects could be added to these scenes which are shaped into microfluidic device geometries, with configurable dimensions. A global event loop keeps track of cell growth, divisions, inter-cellular collisions, and cell-device collisions at each time step. A simple API was created to allow simulations to be run by entering the desired distributions of cell lengths and widths by defining the mean and variance of a cell’s maximum length and average width and then selecting the desired trench geometry (Additional file <xref rid="MOESM1" ref-type="media">1</xref>, Section 2). We also incorporate a cell’s probability to lyse at each timepoint, which can be used to simulate antibiotic or bacteriophage susceptibility experiments. The simulation can also be watched in real time to check that the chosen parameters are valid (Fig. S2.1 in Additional file <xref rid="MOESM1" ref-type="media">1</xref>).</p>
      </sec>
      <sec id="Sec14">
        <title>Extracting geometric information and rendering images of the bacteria and device in the scene</title>
        <p id="Par32">Once model scenes are generated from the simulations, geometric information about the cell and trench positions is extracted. This information is the position of each cell’s vertices in every timepoint. The cell’s 3D structure is a spherocylinder, which affects how light interacts with it, yet the simulation engine runs only in 2D. Therefore, to render 3D cells, the cell’s vertices are revolved along their major axis to generate each cell’s spherocylindrical hull. All of these 3D cells are then morphed to simulate cell bending and then re-rendered in a 3D scene (Fig. S3.2 in Additional file <xref rid="MOESM1" ref-type="media">1</xref>). A 2D projection of this 3D array is then taken, such that an orthographic projection image is generated where the intensity in each pixel is proportional to the optical path length (OPL) in that region (Fig. S3.1 in Additional file <xref rid="MOESM1" ref-type="media">1</xref>). The details of this calculation are provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>, Section 3. This simulated image corresponds to what would be seen if a microscope had no PSF, and thus induced no diffraction artefacts in an image. From the simulated images at this stage, we also save the ground truth images of the cell positions, which act as the masks in our training data.</p>
      </sec>
      <sec id="Sec15">
        <title>Microscope model for generating phase-contrast and fluorescence images</title>
        <p id="Par33">The microscope model generates images from the orthographic projections by convolving them with PSFs of relevant optics. First, the raw image is rendered at a high resolution (typically 3× the real pixel size) and then convolved with either a fluorescence of phase-contrast PSF, which is also rendered at a higher resolution. After PSF convolution, the image is sub-sampled back to the original resolution. Convolution at higher resolution is more accurate, because sub-resolution features of the PSF (such as the concentric rings) are maintained, and propagated to the image; otherwise, the PSF convolution results would be corrupted by low-resolution artefacts. The user can select an ideal fluorescence PSF or phase-contrast PSF which is modelled as an Airy disk and obscured Airy disk [<xref ref-type="bibr" rid="CR25">25</xref>] respectively (Additional file <xref rid="MOESM1" ref-type="media">1</xref>, Section 4). Additionally, a 3D fluorescence PSF can also be selected for full 3D convolution of the cell volumes. The 3D PSF is provided based on the model given by [<xref ref-type="bibr" rid="CR41">41</xref>]. A comparison between these two methods is given in Additional file <xref rid="MOESM1" ref-type="media">1</xref>, Section 5. The PSFs need to be parameterised by inputting the microscope objective’s numerical aperture, refractive index of the medium, emission wavelength, camera pixel size, and phase-contrast ring and annulus dimensions (details provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>, Section 4).</p>
      </sec>
      <sec id="Sec16">
        <title>Image optimisation</title>
        <p id="Par34">Next, further optimisation can be used to maximise the similarity between the synthetic image and an example real microscope image. Multiple image adjustments are possible, including intensity histogram matching, noise matching, rotational Fourier spectrum matching, camera noise simulation, and even manual intensity corrections. This is done using an interactive IPython Notebook interface, where the user is presented with a side-by-side comparison of a synthetic image and a real image from their experiment. Two plots showing the relative errors in intensity and variance between cells, the mother machine device, and the space between cells are given so that the user can optimise their image to minimise this error (Additional file <xref rid="MOESM1" ref-type="media">1</xref>, Section 7 and Fig. S7.1 in Additional file <xref rid="MOESM1" ref-type="media">1</xref>) (Note: While examples of black box optimisers for image similarity matching are included, we avoid their use for this step due to the very noisy error landscape between synthetic and real images. Moreover, we were unable to define a perfect objective function which guarantees perfect image similarity). Once the optimal parameters are identified, large volumes of synthetic images are then generated accordingly. These parameters can also be varied according to a uniform or Gaussian distribution during the image generation process to simulate minor fluctuations in image formation during the experiment. This also acts as a form of data augmentation, but occurs during the image generation process, which preserves the mapping between object and image. The full image generation process is summarised in block diagram form in Fig. <xref rid="Fig7" ref-type="fig">7</xref>, and other steps are summarised below, with all implementation details in the supplementary information.</p>
        <p id="Par35">After image optimisation, training samples are generated according to the optimised parameters. We however can simulate uncertainty in an optical system by sampling random deviations in these parameters, such as the level of defocus, the apodisation, and noise levels. This is not data augmentation as it is traditionally understood, as we are simulating mechanistic changes in the image formation process. For the training data generated in this paper, we uniformly sampled ±5% around the chosen parameters.</p>
      </sec>
      <sec id="Sec17">
        <title>Extension to 2D growth</title>
        <p id="Par36">We have extended the use of SyMBac beyond experiments with microfluidic linear colonies, to include growing monolayer colonies in microfluidic devices and agar pads. For this purpose, the cell simulator back-end was switched from our custom implementation (which is optimised for 1D growth in linear colonies) to CellModeller [<xref ref-type="bibr" rid="CR42">42</xref>], a more general cell simulator for 2D colonies. Scenes are redrawn in the same way as previously described, and either phase-contrast or fluorescence PSFs are convolved to generate respective image types. The main difference here is the addition of additional phase objects to simulate other microfluidic geometries (shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref>), and pseudorandom (Perlin [<xref ref-type="bibr" rid="CR43">43</xref>]) noise to simulate the textures seen in typical phase-contrast images of microcolonies on agar pads (Fig. S13.3 in Additional file <xref rid="MOESM1" ref-type="media">1</xref>). Additionally, the point spread function was adjusted by adding a very small constant offset to modulate the amount of shade-off and halo effects which are characteristic of phase-contrast images (Fig. S13.2 in Additional file <xref rid="MOESM1" ref-type="media">1</xref>). The details of this process are described in Additional file <xref rid="MOESM1" ref-type="media">1</xref>, Section 13. For 2D geometries, on average, 20 CellModeller simulations were run starting from a single cell, generating in total approximately 1000 unique cell images. This was further augmented by sampling a large variety of parameters, which ensures training samples have variable background noises, shade-off and halo amounts, and cell positions. This can be considered a form of data augmentation, but this step is performed before training the model, rather than during, and is based on the type of image one wants to segment. In total, each model is trained on 5000 unique synthetic images.</p>
      </sec>
    </sec>
    <sec id="Sec18">
      <title>Model training</title>
      <p id="Par37">We utilised two segmentation models in this work, DeLTA [<xref ref-type="bibr" rid="CR30">30</xref>] (which is a U-net implementation) and Omnipose [<xref ref-type="bibr" rid="CR31">31</xref>], an extension to Cellpose [<xref ref-type="bibr" rid="CR32">32</xref>] allowing for the reconstruction of masks of arbitrary morphology.</p>
      <p id="Par38">The training protocol for each model is different. DeLTA was trained using pairs of synthetic images and ground truth masks for single colonies, but also required the calculation of weightmaps. These weightmaps are images with regions of high intensity corresponding to areas where masks are close to touching. During training, U-net pays additional attention to these regions to better learn segmentation of nearby, nearly touching objects. Therefore, if training DeLTA, SyMBac always generates binary masks which are not touching. Additionally, images and their masks need to be resized in order to fit within DeLTA’s architecture for training. This produces a model which accepts images of a certain dimension only. DeLTA was always trained with 4000 images of single trenches, for 400 epochs. We provide interactive notebooks to preprocess, train, and segment data with DeLTA.</p>
      <p id="Par39">Omnipose is trained differently. Omnipose can accept images of any size, and so we generated tiled images of 40 trenches at a time. This increased efficiency of training and allowed more total cells to be seen by the network. Additionally, when training Omnipose, masks are labelled, producing an instance segmentation. This allows masks to touch, which is beneficial in the segmentation of dense or closely packed bacteria. It is also beneficial in the segmentation of small cells, because no empty border needs to be created around each touching mask, which would be a significant fraction of the area of a small cell. Omnipose was always trained on 100 images of 40 trenches, for 4000 epochs. We provide notebooks for training and segmenting Omnipose based on the examples given from the original paper.</p>
      <p id="Par40">In both models’ cases, we opted to disable data augmentation, as we already sample mechanistic changes in the image formation process. Data augmentation can corrupt the image-object relation with unrealistic transformations. The only augmentations we allow are rotations and flipping of the data.</p>
      <p id="Par41">For mother machine experiments, we tested SyMBac against 4 datasets, which have their details given in Table <xref rid="Tab3" ref-type="table">3</xref>. Three of the datasets are images of <italic>E. coli</italic> growing in a mother machine, taken with a 100× oil objective, and one dataset was imaged with a 40× air objective, using a 1.5× post-magnification lens, giving an effective magnification of 60×. Synthetic images for this dataset were still generated according to the optics of the 40× objective and then scaled to the appropriate pixel size.<table-wrap id="Tab3"><label>Table 3</label><caption><p>Datasets analysed using SyMBac</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Dataset</th><th align="left">Optics</th><th align="left">Biology</th><th align="left">Notable features</th></tr></thead><tbody><tr><td align="left">Lugagne et al. (exponential)</td><td align="left">100× oil</td><td align="left"><italic>E. coli</italic> in balanced growth</td><td align="left">Poor contrast data</td></tr><tr><td align="left">Bakshi et al. (exponential)</td><td align="left">100× oil (NA = 1.30)</td><td align="left"><italic>E. coli</italic> in balanced growth</td><td align="left">High contrast data</td></tr><tr><td align="left">Bakshi et al. (stationary)</td><td align="left">100× oil (NA = 1.30)</td><td align="left"><italic>E. coli</italic> in stationary phase</td><td align="left">Small stacked cells</td></tr><tr><td align="left">Bakshi et al. 60× (exponential)</td><td align="left">40× air + 1.5× post mag (NA = 0.95)</td><td align="left"><italic>E. coli</italic> in balanced growth</td><td align="left">Low resolution + non-uniform illumination</td></tr></tbody></table></table-wrap></p>
      <p id="Par42">Training data which contains a large variety of cell sizes can also be generated, with very small and very large cells being sampled. It is important to note that the model performance does not scale with the number of images of each cell type it sees, but rather by the raw cell count in each image. Therefore, if generating training data with a mixture of large and small cells, one should have fewer images of small cells, as they will contain more cells per image.</p>
    </sec>
    <sec id="Sec19">
      <title>Model evaluation</title>
      <p id="Par43">Because the training data is purely synthetic, validation data in the traditional sense does not exist. For this reason, during segmentation with either Omnipose or DeLTA, we saved the model after every epoch and evaluated performance through the analysis of growth data. Bacterial growth in the microfluidic linear colonies traces out a predictable sawtooth wave (Fig. S9.2 in Additional file <xref rid="MOESM1" ref-type="media">1</xref>). The first derivative of these sawtooth waves was analysed for spurious peaks, which are the signature of over- and under-segmentation errors (Fig. S9.3 in Additional file <xref rid="MOESM1" ref-type="media">1</xref>). The identification error rate is therefore the percentage of timepoints which contain a spurious peak. If a cell is mis-segmented between frames, it will appear as though a cell’s length sharply decreases then increases or sharply increases then decreases. These can be detected with a simple peak-finding algorithm, with a detailed discussion included in Additional file <xref rid="MOESM1" ref-type="media">1</xref>, Section 9.</p>
    </sec>
    <sec id="Sec20">
      <title>Segmentation analysis</title>
      <p id="Par44">The output from a U-net is a probabilistic threshold image. This image needs to be converted into a binary mask by thresholding pixel values between 0 and 1. Thresholds close to 0 will generate larger, connected masks, and thresholds close to 1 will generate smaller less connected masks. In order to identify the optimal threshold value which generates the most accurate masks, an independent set of synthetic data is segmented using the neural network, and the probability thresholds are adjusted to maximise the Jaccard index between the ground truth and the model output (Fig. S9.1b in Additional file <xref rid="MOESM1" ref-type="media">1</xref>). Depending on the type of dataset, this value can range between 0.6 and 0.99. If the thresholding value is low (around 0.6), then masks will be connected. To alleviate this, we use seeded watershed segmentation to cut masks appropriately. Seeds are generated by first thresholding masks at very high probabilities (<inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P&gt;0.999$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:mi>P</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0.999</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12915_2022_1453_Article_IEq9.gif"/></alternatives></inline-formula>) and performing the watershed on the optimal probability binary mask. The output from Omnipose is an instance segmentation and requires no thresholding. It must be noted that we do not perform any post-processing on the training data or the segmentation results which would affect the shape of the mask.</p>
      <p id="Par45">In order to analyse segmentation precision, we looked at cell width and length. A single cell’s width is not expected to change drastically during growth. We tracked single cell width variation of models trained on Lugagne et al.’s human-annotated dataset, and synthetic data and plotted width distributions and time series to assess the difference in precision between the two models. This also gave a qualitative intuition of the temporal coherence of the models, as high variability will result in high temporal decoherence (Fig. S10.1 in Additional file <xref rid="MOESM1" ref-type="media">1</xref>). The cell length is expected to remain constant during the deep stationary phase. Using the dataset from Bakshi et al., we plotted each cell’s length during the stationary phase, and fitted a quadratic, taking the standard deviation of the residuals as our precision (Fig. S9.5 in Additional file <xref rid="MOESM1" ref-type="media">1</xref>).</p>
      <p id="Par46">After generation of the masks, information on cell curvature, radius (width), and length are calculated using the Colicoords Python library [<xref ref-type="bibr" rid="CR16">16</xref>], with an example of the output coordinate system shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>c. While this analysis is slow (analysis of 1 million cells from the 100× Bakshi et al. dataset taking more than 48 h to complete on an AMD Ryzen 7 5800X with 16 CPU threads), the accuracy and performance of this type of analysis are unmatched when compared to the more commonly used functions for morphological analysis, such as fitting ellipses using regionprops from MATLAB or Scikit-image. The length and width of mothers can then be plotted over time from the output data.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec21">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12915_2022_1453_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1.</bold> PDF with additional information supplementing the main text, describing detailed implementation, usage, and analysis details: Section 1: Benchmarking Performance of Traditional Methods of Generating Cell Masks. Section 2: Details of Agent Based Model and Rigid Body Physics Simulation. Section 3: Details of OPL Calculation and Scene Drawing. Section 4: PSF Definitions, Convolution, and Image Simulation. Section 5: Comparison Between 3D and 2D PSF Models. Section 6: Implementation of the Camera Noise Model. Section 7: Image Optimisation. Section 8: Comparison of the Camera Noise Model with <italic>ad hoc</italic> Noise Matching. Section 9: Model Evaluations and Segmentation Precision. Section 10: Temporal Coherence of SyMBac Trained Models. Section 11: Segmentation Examples: Kymographs. Section 12: Size Regulation Analysis During Exit From Stationary Phase. Section 13: Extension to 2D Growth Regimes and Other Microfluidic Geometries.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>SyMBac</term>
        <def>
          <p id="Par4">Synthetic Micrographs of Bacteria</p>
        </def>
      </def-item>
      <def-item>
        <term>ML</term>
        <def>
          <p id="Par5">Machine learning</p>
        </def>
      </def-item>
      <def-item>
        <term>PSF</term>
        <def>
          <p id="Par6">Point spread function</p>
        </def>
      </def-item>
      <def-item>
        <term>OPL</term>
        <def>
          <p id="Par7">Optical path length</p>
        </def>
      </def-item>
      <def-item>
        <term>ABM</term>
        <def>
          <p id="Par8">Agent-based model</p>
        </def>
      </def-item>
      <def-item>
        <term>API</term>
        <def>
          <p id="Par9">Application Programming Interface</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank the Dunlop Lab for their permission to include DeLTA as the source code in SyMBac’s codebase. We thank the Paulsson Lab, Harvard University, for providing the agar pad and mother machine data, which was captured by S.B. We thank the Elf Lab, Uppsala University, for providing the microfluidic turbedostat data. We thank Hannah Earley and Kavi Shah for the very detailed feedback on the manuscript.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>G.H: conceptualisation, methodology, software, experiments, visualisation, analysis, and writing. M.N: conceptualisation, methodology, software, and pilot and feasibility study. S.B: conceptualisation, experiments, analysis, and writing. The authors read and approved the final manuscript.</p>
    <sec id="FPar1">
      <title>Authors’ information</title>
      <p id="Par47">Not applicable.</p>
    </sec>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This research in the S.B.’s laboratory was supported by the Wellcome Trust Award [grant number RG89305]; a University Startup Award for Lectureship in Synthetic Biology [grant number NKXY ISSF3/46]; Royal Society Research Grant Award (Award number G109931); and a Strategic Seed Fund from School of Technology, University of Cambridge, and the Ph.D. Studentship from BBSRC (to Georgeos Hardo, award number BB/M011194/1)].</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>SyMBac’s documentation and API reference is available at <ext-link ext-link-type="uri" xlink:href="https://symbac.readthedocs.io">https://symbac.readthedocs.io</ext-link> [<xref ref-type="bibr" rid="CR44">44</xref>]. Datasets analysed are taken from [<xref ref-type="bibr" rid="CR3">3</xref>] and [<xref ref-type="bibr" rid="CR30">30</xref>], detailed in Table <xref rid="Tab3" ref-type="table">3</xref>. Datasets are available at [<xref ref-type="bibr" rid="CR45">45</xref>, <xref ref-type="bibr" rid="CR46">46</xref>].</p>
    <p><inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet$$\end{document}</tex-math><mml:math id="M20"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="12915_2022_1453_Article_IEq10.gif"/></alternatives></inline-formula> Project name: SyMBac</p>
    <p><inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet$$\end{document}</tex-math><mml:math id="M22"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="12915_2022_1453_Article_IEq11.gif"/></alternatives></inline-formula> Project homepage: <ext-link ext-link-type="uri" xlink:href="https://github.com/georgeoshardo/SyMBac">https://github.com/georgeoshardo/SyMBac</ext-link> [<xref ref-type="bibr" rid="CR47">47</xref>]</p>
    <p><inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet$$\end{document}</tex-math><mml:math id="M24"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="12915_2022_1453_Article_IEq12.gif"/></alternatives></inline-formula> Project documentation and datasets: <ext-link ext-link-type="uri" xlink:href="https://symbac.readthedocs.io/en/latest/index.html">https://symbac.readthedocs.io/en/latest/index.html</ext-link> [<xref ref-type="bibr" rid="CR44">44</xref>]</p>
    <p><inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet$$\end{document}</tex-math><mml:math id="M26"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="12915_2022_1453_Article_IEq13.gif"/></alternatives></inline-formula> Operating systems(s): Platform independent</p>
    <p><inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet$$\end{document}</tex-math><mml:math id="M28"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="12915_2022_1453_Article_IEq14.gif"/></alternatives></inline-formula> Other requirements: Python 3.8 or higher</p>
    <p><inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bullet$$\end{document}</tex-math><mml:math id="M30"><mml:mo>∙</mml:mo></mml:math><inline-graphic xlink:href="12915_2022_1453_Article_IEq15.gif"/></alternatives></inline-formula> Licence: GPL-2.0</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar2">
      <title>Ethics approval and consent to participate</title>
      <p id="Par48">Not applicable.</p>
    </notes>
    <notes id="FPar3">
      <title>Consent for publication</title>
      <p id="Par49">Not applicable.</p>
    </notes>
    <notes id="FPar4" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par50">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robert</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ollion</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Robert</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Matic</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Elez</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Mutation dynamics and fitness effects followed in single cells</article-title>
        <source>Science.</source>
        <year>2018</year>
        <volume>359</volume>
        <issue>6381</issue>
        <fpage>1283</fpage>
        <lpage>1286</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aan0797</pub-id>
        <?supplied-pmid 29590079?>
        <pub-id pub-id-type="pmid">29590079</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lord</surname>
            <given-names>ND</given-names>
          </name>
          <name>
            <surname>Norman</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bakshi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Losick</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Paulsson</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Stochastic antagonism between two proteins governs a bacterial cell fate switch</article-title>
        <source>Science.</source>
        <year>2019</year>
        <volume>366</volume>
        <issue>6461</issue>
        <fpage>116</fpage>
        <lpage>120</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aaw4506</pub-id>
        <?supplied-pmid 31604312?>
        <pub-id pub-id-type="pmid">31604312</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bakshi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Leoncini</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Baker</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Cañas-Duarte</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Okumus</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Paulsson</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Tracking bacterial lineages in complex and dynamic environments with applications for growth control and persistence</article-title>
        <source>Nat Microbiol</source>
        <year>2021</year>
        <volume>6</volume>
        <issue>6</issue>
        <fpage>783</fpage>
        <lpage>791</lpage>
        <pub-id pub-id-type="doi">10.1038/s41564-021-00900-4</pub-id>
        <?supplied-pmid 34017106?>
        <pub-id pub-id-type="pmid">34017106</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Luro</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Potvin-Trottier</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Okumus</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Paulsson</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Isolating live cells after high-throughput, long-term, time-lapse microscopy</article-title>
        <source>Nat Methods</source>
        <year>2019</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>93</fpage>
        <lpage>100</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0620-7</pub-id>
        <?supplied-pmid 31768062?>
        <pub-id pub-id-type="pmid">31768062</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <mixed-citation publication-type="other">Niederholtmeyer H, Sun ZZ, Hori Y, Yeung E, Verpoorte A, Murray RM, et al. Rapid cell-free forward engineering of novel genetic ring oscillators. eLife. 2015;4.</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Potvin-Trottier</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Lord</surname>
            <given-names>ND</given-names>
          </name>
          <name>
            <surname>Vinnicombe</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Paulsson</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Synchronous long-term oscillations in a synthetic gene circuit</article-title>
        <source>Nature</source>
        <year>2016</year>
        <volume>538</volume>
        <issue>7626</issue>
        <fpage>514</fpage>
        <lpage>517</lpage>
        <pub-id pub-id-type="doi">10.1038/nature19841</pub-id>
        <?supplied-pmid 27732583?>
        <pub-id pub-id-type="pmid">27732583</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kaiser</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Jug</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Julou</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Deshpande</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pfohl</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Silander</surname>
            <given-names>OK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Monitoring single-cell gene regulation under dynamically controllable conditions with integrated microfluidics and software</article-title>
        <source>Nat Commun</source>
        <year>2018</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-017-02505-0</pub-id>
        <pub-id pub-id-type="pmid">29317637</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>von Chamier</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Laine</surname>
            <given-names>RF</given-names>
          </name>
          <name>
            <surname>Jukkala</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Spahn</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Krentzel</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Nehme</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Democratising deep learning for microscopy with ZeroCostDL4Mic</article-title>
        <source>Nat Commun</source>
        <year>2021</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="pmid">33397941</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pärnamaa</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Parts</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Accurate classification of protein subcellular localization from high-throughput microscopy images using deep learning</article-title>
        <source>G3 Genes Genomes Genet</source>
        <year>2017</year>
        <volume>7</volume>
        <issue>5</issue>
        <fpage>1385</fpage>
        <lpage>1392</lpage>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">Denniss AR, Gorochowski TE, Hauert S. An open platform for high-resolution light-based control of microscopic collectives. Authorea Prepr. 2022.</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <mixed-citation publication-type="other">Ollion J, Ollion C. DistNet: Deep Tracking by displacement regression: application to bacteria growing in the Mother Machine. In International Conference on Medical Image Computing and Computer-Assisted Intervention. Springer, Cham; 2020. (pp. 215-225).</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Sauls JT, Schroeder JW, Brown SD, Treut GL, Si F, Li D, et al. Mother machine image analysis with MM3. bioRxiv. 2019;810036.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Banerjee DS, Stephenson G, Das SG. Segmentation and analysis of mother machine data: SAM. bioRxiv. 2020.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">Jain A, Patel H, Nagalapatti L, Gupta N, Mehta S, Guttula S, et al. Overview and importance of data quality for machine learning tasks. In: Proceedings of the ACM SIGKDD International Conference on Knowledge Discovery and Data Mining. Association for Computing Machinery: New York; 2020. p. 3561–3562.</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Sofroniew N, Lambert T, Evans K, Nunez-Iglesias J, Winston P, Bokota G, et al. napari/napari: 0.4.10rc0. Zenodo; 2021.</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smit</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Warszawik</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Herrmann</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cordes</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Colicoords: A Python package for the analysis of bacterial fluorescence microscopy data</article-title>
        <source>PLoS ONE.</source>
        <year>2019</year>
        <volume>14</volume>
        <issue>6</issue>
        <fpage>e0217524</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0217524</pub-id>
        <?supplied-pmid 31216308?>
        <pub-id pub-id-type="pmid">31216308</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Robert</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Pelletier</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Dang</surname>
            <given-names>WL</given-names>
          </name>
          <name>
            <surname>Taddei</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Robust Growth of Escherichia coli</article-title>
        <source>Curr Biol.</source>
        <year>2010</year>
        <volume>20</volume>
        <issue>12</issue>
        <fpage>1099</fpage>
        <lpage>1103</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cub.2010.04.045</pub-id>
        <?supplied-pmid 20537537?>
        <pub-id pub-id-type="pmid">20537537</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moffitt</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Cluzel</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>The single-cell chemostat: an agarose-based, microfluidic device for high-throughput, single-cell studies of bacteria and bacterial communities</article-title>
        <source>Lab Chip.</source>
        <year>2012</year>
        <volume>12</volume>
        <issue>8</issue>
        <fpage>1487</fpage>
        <lpage>1494</lpage>
        <pub-id pub-id-type="doi">10.1039/c2lc00009a</pub-id>
        <?supplied-pmid 22395180?>
        <pub-id pub-id-type="pmid">22395180</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hardo</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Bakshi</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Challenges of analysing stochastic gene expression in bacteria using single-cell time-lapse experiments</article-title>
        <source>Essays Biochem.</source>
        <year>2021</year>
        <volume>65</volume>
        <issue>1</issue>
        <fpage>67</fpage>
        <lpage>79</lpage>
        <pub-id pub-id-type="doi">10.1042/EBC20200015</pub-id>
        <?supplied-pmid 33835126?>
        <pub-id pub-id-type="pmid">33835126</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Taheri-Araghi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bradde</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sauls</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>NS</given-names>
          </name>
          <name>
            <surname>Levin</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Paulsson</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cell-Size Control and Homeostasis in Bacteria</article-title>
        <source>Curr Biol.</source>
        <year>2015</year>
        <volume>25</volume>
        <issue>3</issue>
        <fpage>385</fpage>
        <lpage>391</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cub.2014.12.009</pub-id>
        <?supplied-pmid 25544609?>
        <pub-id pub-id-type="pmid">25544609</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Manuse</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Shan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Canas-Duarte</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Bakshi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>WS</given-names>
          </name>
          <name>
            <surname>Mori</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Bacterial persisters are a stochastically formed subpopulation of low-energy cells</article-title>
        <source>PLOS Biol.</source>
        <year>2021</year>
        <volume>19</volume>
        <issue>4</issue>
        <fpage>e3001194</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pbio.3001194</pub-id>
        <?supplied-pmid 33872303?>
        <pub-id pub-id-type="pmid">33872303</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Basan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Honda</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Christodoulou</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hörl</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>YF</given-names>
          </name>
          <name>
            <surname>Leoncini</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A universal trade-off between growth and lag in fluctuating environments</article-title>
        <source>Nature.</source>
        <year>2020</year>
        <volume>584</volume>
        <issue>7821</issue>
        <fpage>470</fpage>
        <lpage>474</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-020-2505-4</pub-id>
        <?supplied-pmid 32669712?>
        <pub-id pub-id-type="pmid">32669712</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Lapińska U, Glover G, Capilla-Lasheras P, Young AJ, Pagliara S. Bacterial ageing in the absence of external stressors. Phil Trans R Soc B. 2019;374(1786).</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Blomqvist V. Pymunk: a easy-to-use pythonic rigid body 2d physics library (version 6.0.0). 2007. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.pymunk.org/en/latest/">http://www.pymunk.org/en/latest/</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yin</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Kanade</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Understanding the phase contrast optics to restore artifact-free microscopy images for segmentation</article-title>
        <source>Med Image Anal.</source>
        <year>2012</year>
        <volume>16</volume>
        <issue>5</issue>
        <fpage>1047</fpage>
        <lpage>1062</lpage>
        <pub-id pub-id-type="doi">10.1016/j.media.2011.12.006</pub-id>
        <?supplied-pmid 22386070?>
        <pub-id pub-id-type="pmid">22386070</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Zerubia</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Olivo-Marin</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Gaussian approximations of fluorescence microscope point-spread function models</article-title>
        <source>Applied Optics.</source>
        <year>2007</year>
        <volume>46</volume>
        <issue>10</issue>
        <fpage>1819</fpage>
        <lpage>1829</lpage>
        <pub-id pub-id-type="doi">10.1364/AO.46.001819</pub-id>
        <?supplied-pmid 17356626?>
        <pub-id pub-id-type="pmid">17356626</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Mannan F, Langer MS. What is a good model for depth from defocus? In: Proceedings - 2016 13th Conference on Computer and Robot Vision, CRV 2016. Institute of Electrical and Electronics Engineers Inc.: 2016. p. 273–280.</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Ullman G, Wallden M, Marklund EG, Mahmutovic A, Razinkov I, Elf J. High-throughput gene expression analysis at the level of single proteins using a microfluidic turbidostat and automated cell tracking. Philos Trans R Soc B Biol Sci. 2013;368(1611).</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Falk</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Mai</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Bensch</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Çiçek</surname>
            <given-names>Ö</given-names>
          </name>
          <name>
            <surname>Abdulkadir</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Marrakchi</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>U-Net: deep learning for cell counting, detection, and morphometry</article-title>
        <source>Nat Methods.</source>
        <year>2019</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>67</fpage>
        <lpage>70</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-018-0261-2</pub-id>
        <?supplied-pmid 30559429?>
        <pub-id pub-id-type="pmid">30559429</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lugagne</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Dunlop</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Delta: Automated cell segmentation, tracking, and lineage reconstruction using deep learning</article-title>
        <source>PLoS Comput Biol.</source>
        <year>2020</year>
        <volume>16</volume>
        <issue>4</issue>
        <fpage>e1007673</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1007673</pub-id>
        <?supplied-pmid 32282792?>
        <pub-id pub-id-type="pmid">32282792</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Cutler KJ, Stringer C, Wiggins PA, Mougous JD. Omnipose: a high-precision morphology-independent solution for bacterial cell segmentation. bioRxiv. 2022.</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stringer</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Michaelos</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pachitariu</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Cellpose: a generalist algorithm for cellular segmentation</article-title>
        <source>Nat Methods</source>
        <year>2020</year>
        <volume>18</volume>
        <issue>1</issue>
        <fpage>100</fpage>
        <lpage>106</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-020-01018-x</pub-id>
        <?supplied-pmid 33318659?>
        <pub-id pub-id-type="pmid">33318659</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Prindle</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Samayoa</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Razinkov</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Danino</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tsimring</surname>
            <given-names>LS</given-names>
          </name>
          <name>
            <surname>Hasty</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A sensing array of radically coupled genetic ‘biopixels’</article-title>
        <source>Nature.</source>
        <year>2011</year>
        <volume>481</volume>
        <issue>7379</issue>
        <fpage>39</fpage>
        <lpage>44</lpage>
        <pub-id pub-id-type="doi">10.1038/nature10722</pub-id>
        <?supplied-pmid 22178928?>
        <pub-id pub-id-type="pmid">22178928</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <mixed-citation publication-type="other">Panigrahi S, Murat D, Gall AL, Martineau E, Goldlust K, Fiche JB, et al. Misic, a general deep learning-based method for the high-throughput cell segmentation of complex bacterial communities. eLife. 2021;10.</mixed-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Achimovich</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Acton</surname>
            <given-names>ST</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Non-invasive single-cell morphometry in living bacterial biofilms</article-title>
        <source>Nat Commun</source>
        <year>2020</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-19866-8</pub-id>
        <pub-id pub-id-type="pmid">31911652</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Okumus</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Landgraf</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Lai</surname>
            <given-names>GC</given-names>
          </name>
          <name>
            <surname>Bakhsi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Arias-Castro</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Yildiz</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mechanical slowing-down of cytoplasmic diffusion allows in vivo counting of proteins in individual cells</article-title>
        <source>Nat Commun.</source>
        <year>2016</year>
        <volume>7</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>11</lpage>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Emanuel</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Moffitt</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Zhuang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>High-throughput, image-based screening of pooled genetic-variant libraries</article-title>
        <source>Nat Methods.</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>12</issue>
        <fpage>1159</fpage>
        <lpage>1162</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4495</pub-id>
        <?supplied-pmid 29083401?>
        <pub-id pub-id-type="pmid">29083401</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zahir</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Camacho</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Vitale</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ruckebusch</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hofkens</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Fauvart</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>High-throughput time-resolved morphology screening in bacteria reveals phenotypic responses to antibiotics</article-title>
        <source>Commun Biol.</source>
        <year>2019</year>
        <volume>2</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1038/s42003-019-0480-9</pub-id>
        <pub-id pub-id-type="pmid">30740537</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van der Walt</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schönberger</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Nunez-Iglesias</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Boulogne</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Warner</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Yager</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>scikit-image: image processing in Python</article-title>
        <source>PeerJ.</source>
        <year>2014</year>
        <volume>2</volume>
        <fpage>e453</fpage>
        <pub-id pub-id-type="doi">10.7717/peerj.453</pub-id>
        <?supplied-pmid 25024921?>
        <pub-id pub-id-type="pmid">25024921</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Willenbockel</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Sadr</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Fiset</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Horne</surname>
            <given-names>GO</given-names>
          </name>
          <name>
            <surname>Gosselin</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Tanaka</surname>
            <given-names>JW</given-names>
          </name>
        </person-group>
        <article-title>Controlling low-level image properties: The SHINE toolbox</article-title>
        <source>Behav Res Methods.</source>
        <year>2010</year>
        <volume>42</volume>
        <issue>3</issue>
        <fpage>671</fpage>
        <lpage>684</lpage>
        <pub-id pub-id-type="doi">10.3758/BRM.42.3.671</pub-id>
        <?supplied-pmid 20805589?>
        <pub-id pub-id-type="pmid">20805589</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aguet</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Geissbühler</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Geissbühler</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Märki</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Lasser</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Unser</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Super-resolution orientation estimation and localization of fluorescent dipoles using 3-D steerable filters</article-title>
        <source>Opt Express.</source>
        <year>2009</year>
        <volume>17</volume>
        <issue>8</issue>
        <fpage>6829</fpage>
        <lpage>6848</lpage>
        <pub-id pub-id-type="doi">10.1364/OE.17.006829</pub-id>
        <?supplied-pmid 19365511?>
        <pub-id pub-id-type="pmid">19365511</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rudge</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Steiner</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Phillips</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Haseloff</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Computational Modeling of Synthetic Microbial Biofilms</article-title>
        <source>ACS Synth Biol.</source>
        <year>2012</year>
        <volume>1</volume>
        <issue>8</issue>
        <fpage>345</fpage>
        <lpage>352</lpage>
        <pub-id pub-id-type="doi">10.1021/sb300031n</pub-id>
        <?supplied-pmid 23651288?>
        <pub-id pub-id-type="pmid">23651288</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Perlin</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>An image synthesizer</article-title>
        <source>ACM SIGGRAPH Comput Graph.</source>
        <year>1985</year>
        <volume>19</volume>
        <issue>3</issue>
        <fpage>287</fpage>
        <lpage>296</lpage>
        <pub-id pub-id-type="doi">10.1145/325165.325247</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <mixed-citation publication-type="other">Hardo G. SyMBac documentation. 2022 [updated 2022 Oct 31; cited 2022 Oct 31]. Available from: <ext-link ext-link-type="uri" xlink:href="https://symbac.readthedocs.io/">https://symbac.readthedocs.io/</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hardo</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Dataset for: Synthetic Micrographs of Bacteria (SyMBac) Allows Accurate Segmentation of Bacterial Cells Using Deep Neural Networks</article-title>
        <source>Zenodo</source>
        <year>2022</year>
        <pub-id pub-id-type="doi">10.5281/zenodo.7265884</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hardo</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>2D Synthetic Training Data For SyMBac</article-title>
        <source>Zenodo.</source>
        <year>2022</year>
        <pub-id pub-id-type="doi">10.5281/zenodo.6567752</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <mixed-citation publication-type="other">Hardo G. SyMBac. 2022. [updated 2022 Oct 31; cited 2022 Oct 31]. Available from: <ext-link ext-link-type="uri" xlink:href="https://github.com/georgeoshardo/SyMBac">https://github.com/georgeoshardo/SyMBac</ext-link>.</mixed-citation>
    </ref>
  </ref-list>
</back>
