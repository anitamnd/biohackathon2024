<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10164590</article-id>
    <article-id pub-id-type="pmid">36809800</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkad074</article-id>
    <article-id pub-id-type="publisher-id">gkad074</article-id>
    <article-categories>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI00010</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>Narese/7</subject>
        <subject>Narese/24</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>NAR Breakthrough Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>HIBLUP: an integration of statistical models on the BLUP framework for efficient genetic evaluation using big genomic data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4413-7976</contrib-id>
        <name>
          <surname>Yin</surname>
          <given-names>Lilin</given-names>
        </name>
        <aff><institution>Key Laboratory of Agricultural Animal Genetics, Breeding and Reproduction, Ministry of Education &amp; College of Animal Science and Technology, Huazhong Agricultural University</institution>, <addr-line>Wuhan</addr-line> 430070, <country country="CN">PR China</country></aff>
        <aff><institution>Frontiers Science Center for Animal Breeding and Sustainable Production</institution>, <addr-line>Wuhan</addr-line> 430070, <country country="CN">PR China</country></aff>
        <xref rid="FN1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Haohao</given-names>
        </name>
        <aff><institution>School of Computer Science and Technology, Wuhan University of Technology</institution>, <addr-line>Wuhan</addr-line> 430070, <country country="CN">PR China</country></aff>
        <xref rid="FN1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tang</surname>
          <given-names>Zhenshuang</given-names>
        </name>
        <aff><institution>Key Laboratory of Agricultural Animal Genetics, Breeding and Reproduction, Ministry of Education &amp; College of Animal Science and Technology, Huazhong Agricultural University</institution>, <addr-line>Wuhan</addr-line> 430070, <country country="CN">PR China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yin</surname>
          <given-names>Dong</given-names>
        </name>
        <aff><institution>Key Laboratory of Agricultural Animal Genetics, Breeding and Reproduction, Ministry of Education &amp; College of Animal Science and Technology, Huazhong Agricultural University</institution>, <addr-line>Wuhan</addr-line> 430070, <country country="CN">PR China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fu</surname>
          <given-names>Yuhua</given-names>
        </name>
        <aff><institution>Key Laboratory of Agricultural Animal Genetics, Breeding and Reproduction, Ministry of Education &amp; College of Animal Science and Technology, Huazhong Agricultural University</institution>, <addr-line>Wuhan</addr-line> 430070, <country country="CN">PR China</country></aff>
        <aff><institution>Frontiers Science Center for Animal Breeding and Sustainable Production</institution>, <addr-line>Wuhan</addr-line> 430070, <country country="CN">PR China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yuan</surname>
          <given-names>Xiaohui</given-names>
        </name>
        <aff><institution>School of Computer Science and Technology, Wuhan University of Technology</institution>, <addr-line>Wuhan</addr-line> 430070, <country country="CN">PR China</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-7943-1713</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Xinyun</given-names>
        </name>
        <!--xyli@mail.hzau.edu.cn-->
        <aff><institution>Key Laboratory of Agricultural Animal Genetics, Breeding and Reproduction, Ministry of Education &amp; College of Animal Science and Technology, Huazhong Agricultural University</institution>, <addr-line>Wuhan</addr-line> 430070, <country country="CN">PR China</country></aff>
        <aff><institution>Frontiers Science Center for Animal Breeding and Sustainable Production</institution>, <addr-line>Wuhan</addr-line> 430070, <country country="CN">PR China</country></aff>
        <xref rid="COR3" ref-type="corresp"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-9954-1426</contrib-id>
        <name>
          <surname>Liu</surname>
          <given-names>Xiaolei</given-names>
        </name>
        <!--xiaoleiliu@mail.hzau.edu.cn-->
        <aff><institution>Key Laboratory of Agricultural Animal Genetics, Breeding and Reproduction, Ministry of Education &amp; College of Animal Science and Technology, Huazhong Agricultural University</institution>, <addr-line>Wuhan</addr-line> 430070, <country country="CN">PR China</country></aff>
        <aff><institution>Frontiers Science Center for Animal Breeding and Sustainable Production</institution>, <addr-line>Wuhan</addr-line> 430070, <country country="CN">PR China</country></aff>
        <aff><institution>Hubei Hongshan Laboratory</institution>, <addr-line>Wuhan</addr-line> 430070, <country country="CN">PR China</country></aff>
        <xref rid="COR2" ref-type="corresp"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-3997-2320</contrib-id>
        <name>
          <surname>Zhao</surname>
          <given-names>Shuhong</given-names>
        </name>
        <!--shzhao@mail.hzau.edu.cn-->
        <aff><institution>Key Laboratory of Agricultural Animal Genetics, Breeding and Reproduction, Ministry of Education &amp; College of Animal Science and Technology, Huazhong Agricultural University</institution>, <addr-line>Wuhan</addr-line> 430070, <country country="CN">PR China</country></aff>
        <aff><institution>Frontiers Science Center for Animal Breeding and Sustainable Production</institution>, <addr-line>Wuhan</addr-line> 430070, <country country="CN">PR China</country></aff>
        <aff><institution>Hubei Hongshan Laboratory</institution>, <addr-line>Wuhan</addr-line> 430070, <country country="CN">PR China</country></aff>
        <xref rid="COR1" ref-type="corresp"/>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="COR1">To whom correspondence should be addressed. Email: <email>shzhao@mail.hzau.edu.cn</email></corresp>
      <corresp id="COR2">Correspondence may also be addressed to Xiaolei Liu. Email: <email>xiaoleiliu@mail.hzau.edu.cn</email></corresp>
      <corresp id="COR3">Correspondence may also be addressed to Xinyun Li. Email: <email>xyli@mail.hzau.edu.cn</email></corresp>
      <fn id="FN1">
        <p>The authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <day>08</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-02-22">
      <day>22</day>
      <month>2</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>22</day>
      <month>2</month>
      <year>2023</year>
    </pub-date>
    <volume>51</volume>
    <issue>8</issue>
    <fpage>3501</fpage>
    <lpage>3512</lpage>
    <history>
      <date date-type="accepted">
        <day>14</day>
        <month>2</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>05</day>
        <month>1</month>
        <year>2023</year>
      </date>
      <date date-type="received">
        <day>16</day>
        <month>10</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press on behalf of Nucleic Acids Research.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="gkad074.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Human diseases and agricultural traits can be predicted by modeling a genetic random polygenic effect in linear mixed models. To estimate variance components and predict random effects of the model efficiently with limited computational resources has always been of primary concern, especially when it involves increasing the genotype data scale in the current genomic era. Here, we thoroughly reviewed the development history of statistical algorithms used in genetic evaluation and theoretically compared their computational complexity and applicability for different data scenarios. Most importantly, we presented a computationally efficient, functionally enriched, multi-platform and user-friendly software package named ‘HIBLUP’ to address the challenges that are faced currently using big genomic data. Powered by advanced algorithms, elaborate design and efficient programming, HIBLUP computed fastest while using the lowest memory in analyses, and the greater the number of individuals that are genotyped, the greater the computational benefits from HIBLUP. We also demonstrated that HIBLUP is the only tool which can accomplish the analyses for a UK Biobank-scale dataset within 1 h using the proposed efficient ‘HE + PCG’ strategy. It is foreseeable that HIBLUP will facilitate genetic research for human, plants and animals. The HIBLUP software and user manual can be accessed freely at <ext-link xlink:href="https://www.hiblup.com" ext-link-type="uri">https://www.hiblup.com</ext-link>.</p>
    </abstract>
    <abstract abstract-type="graphical">
      <title>Graphical Abstract</title>
      <p>
        <fig position="float" id="ga1">
          <label>Graphical Abstract</label>
          <caption>
            <p>Challenges in genetic evaluation and corresponding solutions in HIBLUP. In the genomic era, existing genetic evaluation algorithms require the inverse computing on increasingly dense matrices. HIBLUP, implementing the “HE+PCG” strategy, can avoid the inverse computing of any big matrices.</p>
          </caption>
          <graphic xlink:href="gkad074figgra1" position="float"/>
        </fig>
      </p>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Key Research and Development Program of China</institution>
            <institution-id institution-id-type="DOI">10.13039/501100012166</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>2021YFD1300800</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Natural Science Foundation of China</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001809</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>32072725</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>China Agriculture Research System of MOF and MARA</institution>
          </institution-wrap>
        </funding-source>
        <award-id>CARS-35</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="12"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>INTRODUCTION</title>
    <p>As the most direct and effective measure to improve the individual performance on agricultural traits and to maximize economic benefits for breeding, genetic evaluation has experienced several major revolutions during the last half-century. Before the theory of genetics was proposed, breeders simply selected outstanding candidates based on their empirical experience by observing phenotypes. However, the phenotypic records of traits were the results of the combined influence of genetic and environmental factors; therefore, genetic progress for breeding was extremely slow due to the unquantified environmental contributions to phenotypic observations. In the mid-20th century, the BLUP (best linear unbiased prediction) model (<xref rid="B1" ref-type="bibr">1</xref>), which estimated the breeding values of individuals using the information from phenotypic observations, environmental records and a genetic relationship matrix that was derived from pedigree, was proposed and adopted in plant and livestock breeding, and it has resulted in great achievements in genetic improvements for agricultural economic traits. The great success of traditional pedigree-based genetic evaluation was largely attributed to state-of-the-art algorithms and efficient software implementations that used sparse technologies to estimate variance components and to solve mixed model equations (MMEs) for very large models (<xref rid="B2" ref-type="bibr">2</xref>,<xref rid="B3" ref-type="bibr">3</xref>).</p>
    <p>With the development of sequencing technology, high-density genetic markers across the entire genome could be obtained, and genomic prediction, which was also known as genomic selection, was proposed subsequently (<xref rid="B4" ref-type="bibr">4</xref>). The utilization of genotypic information reduces Mendelian sampling error effectively, and more ideal models with flexible assumptions on the unknown genetic architecture of traits were developed (<xref rid="B5" ref-type="bibr">5–8</xref>). Therefore, the predictive accuracy of genomic prediction far outstripped traditional pedigree-based genetic evaluation, which led to genomic selection being promoted and widely applied in plant and livestock breeding (<xref rid="B9" ref-type="bibr">9</xref>). In the meantime, the number of genotyped individuals was increasing rapidly for some species. As an example, the number of genotyped Holstein cattle in the USA has been up to a scale of several millions (<ext-link xlink:href="https://queries.uscdcb.com/Genotype/cur_freq.html" ext-link-type="uri">https://queries.uscdcb.com/Genotype/cur_freq.html</ext-link>). Using these large-scale datasets becomes more problematic for genetic evaluation, especially when the objective is to estimate variance components. This is because the algorithm implemented in most software tools [e.g. DMU (<xref rid="B10" ref-type="bibr">10</xref>), BLUPF90 (<xref rid="B11" ref-type="bibr">11</xref>) and ASReml (<xref rid="B12" ref-type="bibr">12</xref>)] requires several rounds of inversion of an increasingly dense coefficient matrix of MMEs; the benefits from traditional sparse technologies are limited and have encountered a bottleneck. Nowadays, much effort has been placed on developing faster and computationally feasible strategies to improve the ability to handle a larger number of genotyped individuals for MME-based algorithms (<xref rid="B13" ref-type="bibr">13</xref>,<xref rid="B14" ref-type="bibr">14</xref>). However, the benefits from the proposed strategies are still limited for the estimation of variance components, and the fatal defect of computing the inverse of genetic relationship matrices cannot be avoided when constructing an MME. Therefore, the increasing availability of genomic data requires the development of new software integrated with advanced algorithms to improve the computational efficiency of genetic evaluation.</p>
    <p>The first purpose of this study was to review the development history of statistical algorithms used in genetic evaluation and to compare their computational complexity and applicability for different scenarios theoretically. The second purpose was to introduce a new computationally efficient and user-friendly software named ‘HIBLUP’, which has been enriched with almost all of the functionalities that are involved in genomic selection and genomic mating. Most notably, if the (co)variance components of traits are known, HIBLUP can obtain all the random effects quickly, which include breeding values, without the need to compute the inverse of any big matrices directly. Moreover, we compared it with other software tools or packages that are used widely regarding the computational efficiency and memory cost to demonstrate its huge application potential in genetic evaluation using big genomic data.</p>
  </sec>
  <sec sec-type="materials|methods" id="SEC2">
    <title>MATERIALS AND METHODS</title>
    <p>We consider the single trait linear mixed model</p>
    <disp-formula id="M1">
      <label>(1)</label>
      <tex-math id="M0001" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}y\; = \;Xb + Rr + \mathop \sum \limits_{i\; = \;1}^k {Z_i}{u_i} + e\end{equation*}$$\end{document}</tex-math>
    </disp-formula>
    <p>where <inline-formula><tex-math id="M0001a" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$y$\end{document}</tex-math></inline-formula> is the vector of <inline-formula><tex-math id="M0002" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$n$\end{document}</tex-math></inline-formula> phenotypic records of the trait of interest, <inline-formula><tex-math id="M0003" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$X$\end{document}</tex-math></inline-formula> is the <inline-formula><tex-math id="M0004" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$n$\end{document}</tex-math></inline-formula> by <inline-formula><tex-math id="M0005" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${n_b}$\end{document}</tex-math></inline-formula> design matrix for fixed effects and covariates, <inline-formula><tex-math id="M0006" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$b$\end{document}</tex-math></inline-formula> is the vector of corresponding effects, <inline-formula><tex-math id="M0007" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$R$\end{document}</tex-math></inline-formula> is the <inline-formula><tex-math id="M0008" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$n$\end{document}</tex-math></inline-formula> by <inline-formula><tex-math id="M0009" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${n_r}$\end{document}</tex-math></inline-formula> design matrix for environmental random effects, <inline-formula><tex-math id="M00010" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$r$\end{document}</tex-math></inline-formula> is the vector of estimated effects that are assumed to be normally distributed on <inline-formula><tex-math id="M00011" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$N( {0,I\sigma _r^2} )$\end{document}</tex-math></inline-formula>, <inline-formula><tex-math id="M00012" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$k$\end{document}</tex-math></inline-formula> is the total number of genetic random effects, <inline-formula><tex-math id="M00013" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${Z_i}$\end{document}</tex-math></inline-formula> is the <inline-formula><tex-math id="M00014" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$n$\end{document}</tex-math></inline-formula> by <inline-formula><tex-math id="M00015" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${n_i}$\end{document}</tex-math></inline-formula> design matrix for the <inline-formula><tex-math id="M00016" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${i_{th}}$\end{document}</tex-math></inline-formula> genetic random effect and <inline-formula><tex-math id="M00017" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${u_i}$\end{document}</tex-math></inline-formula> is the vector of its corresponding genetic effects with a length of <inline-formula><tex-math id="M00018" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${n_i}$\end{document}</tex-math></inline-formula>, which follows the multivariate normality of <inline-formula><tex-math id="M00019" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$N( {0,{K_i}\sigma _i^2} )$\end{document}</tex-math></inline-formula>, <inline-formula><tex-math id="M00020" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${K_i}$\end{document}</tex-math></inline-formula> can be the additive, dominant or other genetic relationship matrix that is derived from pedigree or genomic information, and the last term, <inline-formula><tex-math id="M00021" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$e$\end{document}</tex-math></inline-formula>, is the vector of model residuals with a zero mean and a variance of <inline-formula><tex-math id="M00022" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\sigma _e^2$\end{document}</tex-math></inline-formula>.</p>
    <p>The corresponding full rank MME for model (<xref rid="M1" ref-type="disp-formula">1</xref>) can be expressed as the following formula (<xref rid="B1" ref-type="bibr">1</xref>):</p>
    <disp-formula id="M2">
      <label>(2)</label>
      <tex-math id="M00023" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}\left[ {\begin{array}{@{}*{5}{c}@{}} {{X^T}X}&amp; \quad {{X^T}R}&amp; \quad {{X^T}{Z_1}}&amp; \quad \cdots &amp;\quad {{X^T}{Z_k}}\\ {{R^T}X}&amp;\quad {{R^T}R + \frac{{\sigma _e^2}}{{\sigma _r^2}}I}&amp;\quad {{R^T}{Z_1}}&amp; \quad \cdots &amp; \quad {{R^T}{Z_k}}\\ {Z_1^TX}&amp; \quad {Z_1^TR}&amp; \quad {Z_1^T{Z_1} + \frac{{\sigma _e^2}}{{\sigma _1^2}}K_1^{ - 1}}&amp; \quad \cdots &amp; \quad {Z_1^T{Z_k}}\\ \vdots &amp; \quad \vdots &amp; \quad \vdots &amp; \quad \ddots &amp; \quad \vdots \\ {Z_k^TX}&amp; \quad {Z_k^TR}&amp; \quad {Z_k^T{Z_1}}&amp; \quad \cdots &amp; \quad {Z_k^T{Z_k} + \frac{{\sigma _e^2}}{{\sigma _k^2}}K_k^{ - 1}} \end{array}} \right]\nonumber\\ \quad \left[ {\begin{array}{@{}*{1}{c}@{}} b\\ r\\ {{u_1}}\\ \vdots \\ {{u_k}} \end{array}} \right] = \left[ {\begin{array}{@{}*{1}{c}@{}} {{X^T}y}\\ {{R^T}y}\\ {Z_1^Ty}\\ \vdots \\ {Z_k^Ty} \end{array}} \right]\;\end{equation*}$$\end{document}</tex-math>
    </disp-formula>
    <p>This can be simplified to the form <inline-formula><tex-math id="M00024" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$C \cdot s\; = \;F$\end{document}</tex-math></inline-formula>, where <inline-formula><tex-math id="M00025" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$C$\end{document}</tex-math></inline-formula> is generally known as the coefficient matrix. As shown in the above equation, the fixed and random effects that are located at the second term of the left-hand side of the MME can be obtained by multiplying the inverse matrix of <inline-formula><tex-math id="M00026" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$C$\end{document}</tex-math></inline-formula> by the right-hand side of the MME.</p>
    <sec id="SEC2-1">
      <title>Estimation of variance components</title>
      <sec id="SEC2-1-1">
        <title>The MME-based indirect algorithm</title>
        <p>To obtain the solution for Equation (<xref rid="M2" ref-type="disp-formula">2</xref>), the first step is to estimate the unknown variance components for all random effects. The restricted maximum likelihood (REML) is the method of choice to estimate model parameters (<xref rid="B15" ref-type="bibr">15</xref>). The aim of REML estimation is to find the parameters that maximize the logarithm of the restricted likelihood in the following form (<xref rid="B16" ref-type="bibr">16</xref>):</p>
        <disp-formula id="M3">
          <label>(3)</label>
          <tex-math id="M00027" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{eqnarray*}{\bf{ln}}L &amp; = &amp; - \frac{1}{2}\left[ {{\bf{ln}}\left| C \right| + {n_r}{\bf{ln}}\sigma _r^2 + \mathop \sum \limits_{i\; = \;1}^k \left( {n{\bf{ln}}\sigma _i^2 + {\bf{ln}}\left| {{K_i}} \right|} \right) + \left( {n - {n_b}} \right){\bf{ln}}\sigma _e^2 + {y^T}Py} \right]\nonumber\\ \end{eqnarray*}$$\end{document}</tex-math>
        </disp-formula>
        <p>where <inline-formula><tex-math id="M00028" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\bf{ln}$\end{document}</tex-math></inline-formula> is a natural log, <inline-formula><tex-math id="M00029" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$P$\end{document}</tex-math></inline-formula> is the projection matrix, and | | refers to the determinant of the associated matrices. In the earlier stage, the derivative-free (DF) algorithm (<xref rid="B17" ref-type="bibr">17</xref>), which did not involve derivatives but used Gaussian elimination instead of computing <inline-formula><tex-math id="M00030" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${C^{ - 1}}$\end{document}</tex-math></inline-formula> to obtain the key elements (<inline-formula><tex-math id="M00031" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\bf{ln}}| C |$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M00032" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${y^T}Py$\end{document}</tex-math></inline-formula>) in Equation (<xref rid="M3" ref-type="disp-formula">3</xref>), was used widely in breeding evaluation due to its high computational efficiency. However, it was slow to converge, and it yielded unreliable results, especially for multiple traits or multiple random effects analyses (<xref rid="B18" ref-type="bibr">18</xref>). The expectation–maximization (EM) REML, which used the first-order derivatives of Equation (<xref rid="M3" ref-type="disp-formula">3</xref>), generated reliable results, but it took a long time to reach convergence. Nowadays, the average information (AI) REML, which requires first derivatives of the likelihood, but replaces second derivatives with the average of the observed and expected information, is a primary choice of methods to estimate variance components. As described by Johnson <italic toggle="yes">et al.</italic> (<xref rid="B3" ref-type="bibr">3</xref>), the equation for the iterative process of AIREML is</p>
        <disp-formula id="M4">
          <label>(4)</label>
          <tex-math id="M00033" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}{\theta ^{\left[ {t + 1} \right]}} = {\theta ^{\left[ t \right]}}\; - {(A{I^{\left[ t \right]}})^{ - 1}}\frac{{\partial L}}{{\partial \theta }}|{\theta ^{\left[ t \right]}}\end{equation*}$$\end{document}</tex-math>
        </disp-formula>
        <p>where <inline-formula><tex-math id="M00034" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\theta \; = {[ {\sigma _r^2,\sigma _i^2,\sigma _e^2} ]^T}\;$\end{document}</tex-math></inline-formula>, and <inline-formula><tex-math id="M00035" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\theta ^{[ {t + 1} ]}}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M00036" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\theta ^{[ t ]}}$\end{document}</tex-math></inline-formula> are the vectors of variance components for current updates and previous estimations, respectively. The <inline-formula><tex-math id="M00037" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$AI$\end{document}</tex-math></inline-formula> matrix can be constructed by the following equation:</p>
        <disp-formula id="M5">
          <label>(5)</label>
          <tex-math id="M00038" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}\;{\left( {AI} \right)_{ij}} = \frac{1}{2}\;\left[ {{{\left( {\frac{{{Z_i}{u_i}}}{{\sigma _i^2}}} \right)}^T}P\left( {\frac{{{Z_j}{u_j}}}{{\sigma _j^2}}} \right)} \right]\end{equation*}$$\end{document}</tex-math>
        </disp-formula>
        <p>where <inline-formula><tex-math id="M00039" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${u_i}$\end{document}</tex-math></inline-formula> is a vector of the <inline-formula><tex-math id="M00040" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${i_{th}}$\end{document}</tex-math></inline-formula> genetic random effect, which can be obtained by solving Equation (<xref rid="M2" ref-type="disp-formula">2</xref>) directly. Let <inline-formula><tex-math id="M00041" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${b_j} = {Z_j}{u_j}\;/\sigma _j^2$\end{document}</tex-math></inline-formula>, then <inline-formula><tex-math id="M00042" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$P{b_j}$\end{document}</tex-math></inline-formula> in Equation (<xref rid="M5" ref-type="disp-formula">5</xref>) can be considered as the residuals from repeatedly solving the MME pertaining to Equation (<xref rid="M2" ref-type="disp-formula">2</xref>) with <inline-formula><tex-math id="M00043" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$y$\end{document}</tex-math></inline-formula> replaced by <inline-formula><tex-math id="M00044" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${b_j}$\end{document}</tex-math></inline-formula>. The first derivatives of the log likelihood function (<inline-formula><tex-math id="M00045" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\frac{{\partial L}}{{\partial \theta }}$\end{document}</tex-math></inline-formula>) with respect to each variance component are as follows:</p>
        <disp-formula id="M6">
          <label>(6)</label>
          <tex-math id="M00046" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}\begin{array}{@{}l@{}} \frac{{\partial L}}{{\partial \sigma _r^2}} = \; - \frac{1}{2}\left[ {\frac{{{n_r}}}{{\sigma _r^2}} - \frac{{tr\left( {{C^{rr}}} \right)}}{{\sigma _r^4}} - {{\left( {\frac{e}{{\sigma _e^2}}} \right)}^T}\left( {\frac{{Rr}}{{\sigma _r^2}}} \right)} \right]\\ \frac{{\partial L}}{{\partial \sigma _i^2}} = \; - \frac{1}{2}\left[ {\frac{n}{{\sigma _i^2}} - \frac{{tr\left( {K_i^{ - 1}{C^{{u_i}{u_i}}}} \right)}}{{\sigma _i^4}} - {{\left( {\frac{e}{{\sigma _e^2}}} \right)}^T}\left( {\frac{{{Z_i}{u_i}}}{{\sigma _i^2}}} \right)} \right]\\ \frac{{\partial L}}{{\partial \sigma _e^2}} = \; - \frac{1}{2}\left\{ {\frac{{n - {n_b}}}{{\sigma _e^2}} - \frac{1}{{\sigma _e^2}}\left[ {{n_r} - \frac{{tr\left( {{C^{rr}}} \right)}}{{\sigma _r^2}}} \right] - \frac{1}{{\sigma _e^2}}\mathop \sum \limits_{i\; = \;1}^k \left[ {{n_i} - \frac{{tr\left( {K_i^{ - 1}{C^{{u_i}{u_i}}}} \right)}}{{\sigma _i^2}}} \right] - \frac{{{e^T}e}}{{\sigma _e^4}}} \right\} \end{array}\end{equation*}$$\end{document}</tex-math>
        </disp-formula>
        <p>where <inline-formula><tex-math id="M00047" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$tr$\end{document}</tex-math></inline-formula> is the trace of matrix, <inline-formula><tex-math id="M00048" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$e$\end{document}</tex-math></inline-formula> is the vector of calculated residuals of model (<xref rid="M1" ref-type="disp-formula">1</xref>) after obtaining the solution of Equation (<xref rid="M2" ref-type="disp-formula">2</xref>), and <inline-formula><tex-math id="M00049" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${C^{rr}}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M00050" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${C^{{u_i}{u_i}}}$\end{document}</tex-math></inline-formula> are the partitions of the inverse of the coefficient matrix that corresponds to environmental and the <inline-formula><tex-math id="M00051" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${i_{th}}$\end{document}</tex-math></inline-formula> genetic random effects, respectively.</p>
        <p>As shown above, the core steps of MME-based AIREML are the calculation of the inverse of the genetic relationship matrix to construct <inline-formula><tex-math id="M00052" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$C$\end{document}</tex-math></inline-formula> and the iterative computation of its inverse (<inline-formula><tex-math id="M00053" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${C^{ - 1}}$\end{document}</tex-math></inline-formula>), which consume most of the time in the whole estimation process. Before genomic breeding was proposed, traditional breeding utilized the tracked pedigree records for individual evaluation, and the inverse of the additive genetic relationship matrix (<inline-formula><tex-math id="M00054" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${A^{ - 1}}$\end{document}</tex-math></inline-formula>) required in constructing <inline-formula><tex-math id="M00055" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$C$\end{document}</tex-math></inline-formula> was derived from pedigree directly within seconds for tens of thousands of individuals using the algorithm described by Henderson (<xref rid="B19" ref-type="bibr">19</xref>). For calculating the matrix <inline-formula><tex-math id="M00056" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${C^{ - 1}}$\end{document}</tex-math></inline-formula>, although <inline-formula><tex-math id="M00057" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$C$\end{document}</tex-math></inline-formula> was very sparse for this case, its inverse had been regarded as expensive to calculate for large models. Misztal and Perez-Enciso proposed an efficient strategy which calculated only those elements of the inverse that belong to the sparse pattern of the original matrix (<xref rid="B20" ref-type="bibr">20</xref>), and then the fast sparse solver package FSPAK was developed and released to the public (<xref rid="B21" ref-type="bibr">21</xref>), making the traditional breeding evaluation superefficient. FSPAK has been implemented in various software packages, such as DMU (<xref rid="B10" ref-type="bibr">10</xref>) and BLUPF90 (<xref rid="B11" ref-type="bibr">11</xref>).</p>
        <p>With the development of sequencing technology, high-density markers across the entire genome can be obtained and used to construct the genomic relationship matrix (<inline-formula><tex-math id="M00058" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$G$\end{document}</tex-math></inline-formula>) by various algorithms (<xref rid="B22" ref-type="bibr">22–24</xref>), then genomic prediction came into the world in 2001 (<xref rid="B4" ref-type="bibr">4</xref>), and it has been promoted widely and applied in plant and livestock breeding in the past decade. SSGBLUP (single-step genomic BLUP) (<xref rid="B25" ref-type="bibr">25</xref>,<xref rid="B26" ref-type="bibr">26</xref>), which can integrate the pedigree and genotypic information simultaneously to predict both genotyped and non-genotyped individuals, has now become the preferred model in livestock breeding programs. Meanwhile, the <inline-formula><tex-math id="M00059" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${H^{ - 1}}$\end{document}</tex-math></inline-formula> used to construct MMEs in the SSGBLUP model has dense blocks at the lower right corner due to the utilization of genomic information (see Supplementary Notes). The sparsity of <inline-formula><tex-math id="M00060" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${H^{ - 1}}$\end{document}</tex-math></inline-formula> depends on the proportion of genotyped individuals in a pedigree; if all the individuals in a pedigree were genotyped, the <inline-formula><tex-math id="M00061" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${G^{ - 1}}$\end{document}</tex-math></inline-formula> required in <inline-formula><tex-math id="M00062" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${H^{ - 1}}$\end{document}</tex-math></inline-formula> had the same dimensions as <inline-formula><tex-math id="M00063" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${A^{ - 1}}$\end{document}</tex-math></inline-formula>, then SSGBLUP was equivalent to GBLUP and thus <inline-formula><tex-math id="M00064" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${H^{ - 1}}$\end{document}</tex-math></inline-formula> became the full dense matrix. The increasing density of <inline-formula><tex-math id="M00065" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${H^{ - 1}}$\end{document}</tex-math></inline-formula> limited the efficiency of sparse matrix operations in solving MMEs. To address this issue, a modified version of FSPAK with the new name of YAMS (Yet Another MME Solver) (<xref rid="B13" ref-type="bibr">13</xref>,<xref rid="B27" ref-type="bibr">27</xref>) was developed, which combined the supernodal factorization (<xref rid="B28" ref-type="bibr">28</xref>) and a supernodal version of the Takahashi algorithm to calculate the inverse of the coefficient matrix (<xref rid="B29" ref-type="bibr">29</xref>,<xref rid="B30" ref-type="bibr">30</xref>). YAMS has the ability to identify dense blocks and to compute them efficiently.</p>
        <p>However, calculating the inverse of the genomic relationship matrix to construct a coefficient matrix is becoming computationally challenging due to the increasing number of genotyped individuals. The cost of dense matrix operations with GRM using YAMS is quadratic for memory and cubic for operations, which limits the computations to ∼50 000 animals. Subsequently, the Algorithm for Proven and Young (APY) strategy was presented (<xref rid="B14" ref-type="bibr">14</xref>,<xref rid="B31" ref-type="bibr">31</xref>), which considers that the genotyped individuals could be divided arbitrarily into core (<inline-formula><tex-math id="M00066" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$c$\end{document}</tex-math></inline-formula>) and non-core (<inline-formula><tex-math id="M00067" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$n$\end{document}</tex-math></inline-formula>) groups; the inverse of GRM can be calculated only on the condition of the genotypic information of core animals (see Supplementary Notes). The APY does not require computing the inverse of full matrix <inline-formula><tex-math id="M00068" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$G$\end{document}</tex-math></inline-formula>, but instead it is required to invert the GRM of core animals (<inline-formula><tex-math id="M00069" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$G_{cc}^{ - 1}$\end{document}</tex-math></inline-formula>). Since the number of core animals is usually smaller than the number of all genotyped individuals, the APY strategy not only reduces the complexity of inverse computation significantly, but also helps to increase the sparsity of the coefficient matrix; thus, it should be beneficial for both computational efficiency and memory usage. Nevertheless, how to select the core animals and how large the number of core animals should be to obtain unbiased results are not that easy to determine for a non-expert or non-experienced beginner (<xref rid="B32" ref-type="bibr">32</xref>). On the other hand, recent research concluded that to ensure reliable estimation of variance components, it is required to consider a core size that corresponds to the number of the largest eigenvalues that explain ∼98% of the total variation in GRM. Therefore, the savings in computing time to estimate the variance components are far less than the expected performance that the APY strategy has shown in solving MMEs. This inefficiency is because the block implementation of APY is still not possible for estimating variance components (<xref rid="B33" ref-type="bibr">33</xref>).</p>
        <p>Although the optimizations of the MME-based algorithm have been in progress for several decades, the inverse computations of relationship matrices and of the coefficient matrix required to estimate variance components still face big challenges with the continuously growing size of genotyped individuals in plant and livestock breeding.</p>
      </sec>
      <sec id="SEC2-1-2">
        <title>The V-based direct algorithm</title>
        <p>In our developed software HIBLUP, we implemented another version of AIREML that could be more competent in breeding evaluation on big genomic data. By assuming multivariate normality of the phenotypic records <inline-formula><tex-math id="M00070" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$y\sim N( {Xb,\;V} )$\end{document}</tex-math></inline-formula>, the variance–covariance matrix <inline-formula><tex-math id="M00071" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$V$\end{document}</tex-math></inline-formula> can be expressed as the following equation for model (<xref rid="M1" ref-type="disp-formula">1</xref>):</p>
        <disp-formula id="M7">
          <label>(7)</label>
          <tex-math id="M00072" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}V\; = \;R{R^T}\sigma _r^2 + \mathop \sum \limits_{i\; = \;1}^k {Z_i}{K_i}Z_i^T\sigma _i^2 + I\sigma _e^2\end{equation*}$$\end{document}</tex-math>
        </disp-formula>
        <p>The corresponding logarithm of the restricted likelihood, which is different from Equation (<xref rid="M3" ref-type="disp-formula">3</xref>), can be obtained using the following equation (<xref rid="B34" ref-type="bibr">34</xref>):</p>
        <disp-formula id="M8">
          <label>(8)</label>
          <tex-math id="M00073" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}{\bf{ln}}L\; = \; - \frac{1}{2}\left( {{\bf{ln}}\left| V \right| + {\bf{ln}}\left| {{X^T}{V^{ - 1}}X} \right| + {y^T}Py} \right)\end{equation*}$$\end{document}</tex-math>
        </disp-formula>
        <p>where <inline-formula><tex-math id="M00074" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$P$\end{document}</tex-math></inline-formula> is the projection matrix, which is defined as</p>
        <disp-formula id="M9">
          <label>(9)</label>
          <tex-math id="M00075" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}P\; = {V^{ - 1}}\; - {V^{ - 1}}X{\left( {{X^T}{V^{ - 1}}X} \right)^{ - 1}}{X^T}{V^{ - 1}}\end{equation*}$$\end{document}</tex-math>
        </disp-formula>
        <p>The iterative process for V-based AIREML is the same as Equation (<xref rid="M4" ref-type="disp-formula">4</xref>), but the construction of the AI matrix and the first derivatives of the log likelihood function differ from MME-based algorithms. The AI matrix could be written as follows (<xref rid="B3" ref-type="bibr">3</xref>):</p>
        <disp-formula id="M10">
          <label>(10)</label>
          <tex-math id="M00076" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}{\left( {AI} \right)_{ij}} = \frac{1}{2}\;\left[ {{y^T}P\frac{{\partial V}}{{\partial \sigma _i^2}}P\frac{{\partial V}}{{\partial \sigma _j^2}}Py} \right]\end{equation*}$$\end{document}</tex-math>
        </disp-formula>
        <p>and the first derivatives of the log likelihood function with respect to each variance component are</p>
        <disp-formula id="M11">
          <label>(11)</label>
          <tex-math id="M00077" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}\frac{{\partial L}}{{\partial \sigma _i^2}} = \; - \frac{1}{2}\left[ {tr\left( {P\frac{{\partial V}}{{\partial \sigma _i^2}}} \right) - {y^T}P\frac{{\partial V}}{{\partial \sigma _i^2}}Py} \right]\end{equation*}$$\end{document}</tex-math>
        </disp-formula>
        <p>From the above descriptions, the most time-consuming part for V-based AIREML is to calculate the inverse of the <inline-formula><tex-math id="M00078" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$V$\end{document}</tex-math></inline-formula> matrix in Equation (<xref rid="M9" ref-type="disp-formula">9</xref>); the other matrix operations can be computed efficiently. To speed up the efficiency of the V-based algorithm, an integration of eigen decomposition technology (<xref rid="B35" ref-type="bibr">35</xref>), sparsification processing on GRM using an empirical threshold and a log likelihood scores-based grid search (<xref rid="B36" ref-type="bibr">36</xref>) could be applied to the model with one genetic random effect. <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1</xref> illustrates the differences on estimation of variance components between the MME-based and V-based strategies. Compared with MME-based AIREML, V-based AIREML has the following advantages. (i) The dimension of the <inline-formula><tex-math id="M00079" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$V$\end{document}</tex-math></inline-formula> matrix only depends on the number of phenotypic records; it remains unchanged with the increasing number of random effects, while the dimension of the MME appears to have linear growth with the number of random effects and the number of levels in each random effect (generally the number of individuals in the pedigree). (ii) Only the partition of the relationship matrix among phenotypic individuals and the partition between phenotypic and non-phenotypic individuals are required; the partition of the relationship matrix among non-phenotypic individuals is not involved in operations and, therefore, is not necessary to be loaded into memory for the V-based algorithm. However, for the MME-based algorithm, all the elements in the relationship matrix participate in computing the inverse matrix. (iii) The <inline-formula><tex-math id="M00080" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$V$\end{document}</tex-math></inline-formula> matrix is the summation of (co-) variance matrices of all components, which is guaranteed to be positive definite for computing the inverse; moreover, we achieved Cholesky, lower–upper (LU) decomposition, and singular value decomposition (SVD) in HIBLUP to obtain the inverse or generalized inverse of the <inline-formula><tex-math id="M00081" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$V$\end{document}</tex-math></inline-formula> matrix. (iv) The V-based AIREML only involves the inverse calculation of the <inline-formula><tex-math id="M00082" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$V$\end{document}</tex-math></inline-formula> matrix, thus there is no need to compute the inverse of any relationship matrix, but the MME-based algorithm needs to compute the inverse for the coefficient matrix and for all genetic relationship matrices. (v) A practical application benefit of the V-based algorithm is that both pedigree-based and genotype-based relationship matrices can be updated on the basis of the prior calculated one when additional individuals are included in a new breeding task, which avoids repeat computations of the elements in the relationship matrix for the same individuals; however, it is nearly impossible to implement on an inverse matrix for the MME-based algorithm. (vi) The computational complexity and memory usage of V-based AIREML is mainly dependent on the number of phenotypic records, but it is dependent on the number of genotyped individuals for the MME-based AIREML. The only disadvantage of the V-based algorithm is that sparse matrix operations may no longer be applicable, especially for a model with a number of random effects; however, this is not significant because the matrices involved in the computation of genomic breeding are dense for the majority of cases.</p>
      </sec>
      <sec id="SEC2-1-3">
        <title>The HE regression algorithm</title>
        <p>In addition to REML analysis, a simple and approximate algorithm named HE (Haseman–Elston) regression, which estimates heritability directly by regressing pairwise similarities of phenotypic observations on pairwise similarities of genotypes, is an alternative (<xref rid="B37" ref-type="bibr">37</xref>). We have incorporated HE regression in HIBLUP and extended it to accommodate single trait and multiple traits models with multiple environmental and genetic random effects. The mathematical formula for the HE regression for model (<xref rid="M1" ref-type="disp-formula">1</xref>) is as follows:</p>
        <disp-formula id="M12">
          <label>(12)</label>
          <tex-math id="M00083" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}\begin{array}{@{}*{1}{c}@{}} {\left( {{{\hat y}_i} \cdot {{\hat y}_j}} \right)}\\ {{\rm{or}}}\\ {{{\left( {{{\hat y}_i} - {{\hat y}_j}} \right)}^2}} \end{array} = \;\mu + \left[ {\begin{array}{*{20}{c}} {{{\left( {R{R^T}} \right)}_{i,j}}}&amp;{{{\left( {{K_1}} \right)}_{i,j}}}&amp; \cdots &amp;{{{\left( {{K_k}} \right)}_{i,j}}} \end{array}} \right]\left[ {\begin{array}{@{}*{1}{c}@{}} {h_r^2}\\ {h_1^2}\\ \vdots \\ {h_k^2} \end{array}} \right] + {e_{i,j}}\end{equation*}$$\end{document}</tex-math>
        </disp-formula>
        <p>where <inline-formula><tex-math id="M00084" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$i,j \in \{ {1, \cdots ,n} \}$\end{document}</tex-math></inline-formula>, <inline-formula><tex-math id="M00085" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat y$\end{document}</tex-math></inline-formula> is the adjusted phenotype of <inline-formula><tex-math id="M00086" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$y$\end{document}</tex-math></inline-formula> by fixed effects and covariates, and <inline-formula><tex-math id="M00087" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\hat y_i}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M00088" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\hat y_j}$\end{document}</tex-math></inline-formula> are the adjusted phenotypic values of individuals <inline-formula><tex-math id="M00089" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$i$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M00090" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$j$\end{document}</tex-math></inline-formula> for the trait of interest, respectively. <inline-formula><tex-math id="M00091" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mu$\end{document}</tex-math></inline-formula> is the regression intercept, <inline-formula><tex-math id="M00092" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${( K )_{i,j}}$\end{document}</tex-math></inline-formula> represents the element at row <inline-formula><tex-math id="M00093" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$i$\end{document}</tex-math></inline-formula> and column <inline-formula><tex-math id="M00094" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$j$\end{document}</tex-math></inline-formula> of the genetic relationship matrix <inline-formula><tex-math id="M00095" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$K$\end{document}</tex-math></inline-formula>, <inline-formula><tex-math id="M00096" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${h^2}$\end{document}</tex-math></inline-formula> is the estimated heritability of random effects and <inline-formula><tex-math id="M00097" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$e$\end{document}</tex-math></inline-formula> is a vector of residuals. The regression coefficients <inline-formula><tex-math id="M00098" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\beta \; = \;c(h_r^2,h_1^2, \cdots ,h_k^2)$\end{document}</tex-math></inline-formula> in Equation (<xref rid="M12" ref-type="disp-formula">12</xref>) can be obtained easily by ordinary least squares (OLS) regression, then the variances of all random effects can be computed by <inline-formula><tex-math id="M00099" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\sigma ^2} = \;var( {\hat y} ) \cdot \beta$\end{document}</tex-math></inline-formula>. For a two-trait model, replace the left-hand side of Equation (<xref rid="M12" ref-type="disp-formula">12</xref>) by <inline-formula><tex-math id="M000100" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$({\hat y_{1,i}} \cdot {\hat y_{2,j}})$\end{document}</tex-math></inline-formula> or <inline-formula><tex-math id="M000101" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${( {{{\hat y}_{1,i}} - {{\hat y}_{2,j}}} )^2}$\end{document}</tex-math></inline-formula>, and the covariance between two traits can be calculated by <inline-formula><tex-math id="M000102" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\sigma ^2} = \;cov( {{{\hat y}_1},{{\hat y}_2}} ) \cdot \beta$\end{document}</tex-math></inline-formula>, then the genetic correlation can be calculated using the estimated variances and covariances. HE regression can be accomplished on-the-fly as it significantly reduces the computational burden with fewer matrix operations, no iterative processes and no involvement of computing the inverse of any big matrices such as a relationship matrix. Moreover, the memory cost can be decreased by several orders of magnitude, which makes it possible to estimate variance components for large datasets with limited computational resources.</p>
        <p>It should be noted that previous studies indicated that the stability and power of HE regression varied with different genetic architectures of traits (<xref rid="B38" ref-type="bibr">38</xref>). In HIBLUP software, we provided an option named ‘HI’ for estimating variance components, which initializes the estimated outcomes of HE regression as the start values of AIREML. This can potentially help AIREML run in the correct iterative direction to overcome the ‘overshoot’ problem and help to converge in less time. To achieve reliable computing in estimation of variance components, a combination of different algorithms could be helpful (<xref rid="B39" ref-type="bibr">39</xref>). In HIBLUP, a series of algorithms that include AI, EM, AIEM, EMAI, HE and HI have been incorporated; users can switch easily to one of them and change the maximum iterative number for models with various complexities.</p>
      </sec>
    </sec>
    <sec id="SEC2-2">
      <title>Solving mixed-model equations</title>
      <p>In practical breeding evaluations, estimating variance components does not need to run frequently. Estimation is generally updated quarterly or annually, and the most common computation is to solve the MME to obtain the estimated breeding values (EBVs) for all individuals with prior calculated variance components. <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1</xref> illustrates the detailed computing processes of the MME-based and V-based strategies.</p>
      <p>For the MME-based algorithm, all random effects including EBVs can be obtained easily from Equation (<xref rid="M2" ref-type="disp-formula">2</xref>), and the simplified formula is</p>
      <disp-formula>
        <tex-math id="M000103" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}C \cdot s\; = \;F\end{equation*}$$\end{document}</tex-math>
      </disp-formula>
      <p>The matrix <inline-formula><tex-math id="M000104" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$C$\end{document}</tex-math></inline-formula> is most likely to be sparse if a large proportion of individuals in the pedigree are not genotyped, the iterative solvers [e.g. pre-conditioned conjugate gradient (PCG) and successive over-relaxation (SOR)] are preferred because there is no need to compute the direct inverse of the <inline-formula><tex-math id="M000105" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$C$\end{document}</tex-math></inline-formula> matrix. However, the operation of inverting the relationship matrix to construct the <inline-formula><tex-math id="M000106" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$C$\end{document}</tex-math></inline-formula> matrix in Equation (<xref rid="M2" ref-type="disp-formula">2</xref>) cannot be avoided.</p>
      <p>For the V-based algorithm, EBVs can be obtained by the following equation:</p>
      <disp-formula>
        <tex-math id="M000107" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}{\rm{\;}}{u_i} = {K_i}\;Z_i^TPy\sigma _i^2\end{equation*}$$\end{document}</tex-math>
      </disp-formula>
      <p>The component <inline-formula><tex-math id="M000108" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$Py$\end{document}</tex-math></inline-formula> is the only term that needs to compute, as shown in Equation (<xref rid="M9" ref-type="disp-formula">9</xref>), and it can be written as</p>
      <disp-formula>
        <tex-math id="M000109" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}Py\; = {V^{ - 1}}\;y - {V^{ - 1}}X{\left( {{X^T}{V^{ - 1}}X} \right)^{ - 1}}{X^T}{V^{ - 1}}y\end{equation*}$$\end{document}</tex-math>
      </disp-formula>
      <p>Computing <inline-formula><tex-math id="M000110" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${V^{ - 1}}$\end{document}</tex-math></inline-formula> directly is time expensive for a large matrix. Here in HIBLUP, we implemented a fast linear solver system to obtain the solution of <inline-formula><tex-math id="M000111" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${V^{ - 1}}y$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M000112" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${V^{ - 1}}X$\end{document}</tex-math></inline-formula> as follows:</p>
      <disp-formula>
        <tex-math id="M000113" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}V \cdot \;\left[ {\begin{array}{*{20}{c}} {{\phi _1}}&amp;{{\phi _2}} \end{array}} \right] = \left[ {\begin{array}{*{20}{c}} X&amp;y \end{array}} \right]\;\end{equation*}$$\end{document}</tex-math>
      </disp-formula>
      <p>The <inline-formula><tex-math id="M000114" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$V$\end{document}</tex-math></inline-formula> matrix is no longer sparse in the majority of cases for genomic breeding evaluation and the dimension of <inline-formula><tex-math id="M000115" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$X$\end{document}</tex-math></inline-formula> is far smaller than that of the <inline-formula><tex-math id="M000116" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$V$\end{document}</tex-math></inline-formula> matrix (<inline-formula><tex-math id="M000117" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${n_b} \ll n$\end{document}</tex-math></inline-formula>); we implemented Cholesky and LU factorization-based linear solver for fast computing, and PCG is also included in HIBLUP as an alternative for very large data. Now, <inline-formula><tex-math id="M000118" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$Py$\end{document}</tex-math></inline-formula> can be calculated efficiently by using the following equation:</p>
      <disp-formula>
        <tex-math id="M000119" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*}Py\; = {\phi _2}\; - {\phi _1}{\left( {{X^T}{\phi _1}} \right)^{ - 1}}{X^T}{\phi _2}\end{equation*}$$\end{document}</tex-math>
      </disp-formula>
      <p>Note that computing the inverse of <inline-formula><tex-math id="M000120" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${X^T}{\phi _1}$\end{document}</tex-math></inline-formula> could be accomplished on-the-fly. Compared with the MME-based algorithm, the V-based algorithm can successfully avoid computing the inverse of any large matrix directly, and the dimension of the <inline-formula><tex-math id="M000121" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$V$\end{document}</tex-math></inline-formula> matrix is generally smaller than the dimension of MME, especially for a model with a large number of random effects. The dimension of the <inline-formula><tex-math id="M000122" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$V$\end{document}</tex-math></inline-formula> matrix remains unchanged with the number of random effects, while the dimension of MME appears to have linear growth, which results in an unpredictable amount of time spent and memory cost for analysis. Moreover, with the increasing number of genotyped individuals, the matrices involved in genomic breeding evaluation tend to be more and more dense than traditional breeding. The V-based algorithm should be more beneficial computationally than the MME-based algorithm, which is considered to be competent in a sparse matrix operation.</p>
    </sec>
    <sec id="SEC2-3">
      <title>Software development and algorithm implementation</title>
      <sec id="SEC2-3-1">
        <title>Fast parallel computing</title>
        <p>HIBLUP was developed in C++, and dense and sparse matrix implementations are conducted by Armadillo (<xref rid="B40" ref-type="bibr">40</xref>,<xref rid="B41" ref-type="bibr">41</xref>). The operations for dense matrices and vectors, and matrix decomposition (e.g. Cholesky, LU and SVD) are performed by the Basic Linear Algebra Subprograms (BLAS) and the Linear Algebra Package (LAPACK). Various math libraries have been linked for different platforms to speed up the computing efficiency, such as the MKL (Math Kernel Library) on Intel x86, the Apple Accelerate on both Intel x86 and ARM-based ‘M’ series, the OpenBLAS on ARM and the KML (Kunpeng Math Library) on ARM-based Huawei Kunpeng (<inline-graphic xlink:href="gkad074figu1.jpg"/>). All the parallelizable loops (e.g. matrix filling) have been accelerated by OpenMP technology; some basic statistics, for example, genotype counting and allele frequency calculations, are accomplished by bit operation and a population count algorithm. We also designed and optimized the whole computational process to avoid repeat matrix operations across different functions. Here in HIBLUP, a look-up table (LUT) strategy was implemented for genotype numeric coding, and the accessed binary byte containing four individuals will be converted into an index to extract values from a prior designed array of 256 combinations (4^4, four possibilities for each of the four individuals). This strategy virtually digitalizes four individuals at a time by the trivial hash searching, rather than looping individuals one by one, and this improves efficiency significantly. We have developed a new function to compute a GRM in a very efficient manner with a very low cost of memory using block-wise operations.</p>
      </sec>
      <sec id="SEC2-3-2">
        <title>Efficient memory management</title>
        <p>In HIBLUP, we only store the lower triangle elements of a relationship matrix in a binary format file to save space in the local disk. To load the binary files of a relationship matrix and a Plink format genotype into memory efficiently, we use the memory-mapping technology with an integration of OpenMP, which can realize the fast access of any of the desired elements from a local disk rather than loading them all at one time with an expensive memory cost. We flexibly employ a mixture of float and double precision for matrix storage and operations in programming to reduce the memory usage for analysis.</p>
      </sec>
      <sec id="SEC2-3-3">
        <title>Integration of abundant functionalities</title>
        <p>In addition to implementing general genetic evaluation, including estimation of variance components, solving MMEs to obtain individual breeding values, HIBLUP has been enriched with many functionalities that are involved in genomic breeding. For example, these include statistical significance tests for fixed effects and covariates, fitting interactions among multiple effects (e.g. G × G, G × E and E × E), the construction of different relationship matrices, the derivation of inbreeding coefficients by using either or both pedigree and genotypic information, the calculation of genotype and allele frequency, the computation of single nucleotide polymorphism (SNP) effects, principal components analysis (PCA), genomic mating, and so on. We will continue to update HIBLUP with more features based on the users’ feedback, which should allow HIBLUP to always be fresh for general users and academic researchers.</p>
      </sec>
      <sec id="SEC2-3-4">
        <title>Friendly user experience</title>
        <p>HIBLUP is a command-line program that relies on text inputs to perform the analysis, and the names of parameters and options in HIBLUP are quite consistent with those widely used in software tools (e.g. Plink and GCTA) so as to satisfy the programming habits of users. Users can achieve simple linear models, linear mixed models, pedigree-based BLUPs, GBLUPs or SSGBLUPs, and specify fixed or environmental random effects with just a few commands. Moreover, we have released multiple versions of executable files for the platform of Linux, MacOS, Windows and particularly Kunpeng (<inline-graphic xlink:href="gkad074figu1.jpg"/>), which ensures that HIBLUP has wider application scenarios.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="results" id="SEC3">
    <title>RESULTS</title>
    <p>To evaluate the computational effectiveness of different versions of AIREML that are implemented in various software tools for estimating variance components in genomic breeding evaluation, we simulated the experimental population data using the R package Simer. A total of 1000 individuals that consisted of 500 males and 500 females with 100 000 SNPs were treated as the base population, that was the first generation. Nine generations of random mating without backcross were then simulated with considering a litter size of two (one male and one female). Finally, a historical population of 10 000 individuals with detailed pedigree and genotypic information was generated for the downstream evaluation. Although the simulation scheme was not fully consistent with practical breeding, the simulated data structure was sufficient to evaluate the computational efficiency of the algorithm implemented in different software tools. We only simulated 10 000 individuals because the publicly available version of BLUPF90 used for computational comparison has a limitation for non-commercial analysis. Since GCTA only supports two traits at a time for a multiple traits model, two correlated traits that were controlled by 600 randomly selected SNPs with effect size normally distributed at zero mean and a variance of one were simulated at a heritability of 0.1 and 0.3, respectively. The genetic correlation was set to 0.3. Additionally, two environmental random effects and two fixed effects were added to the final phenotypic records for each trait. The computational comparisons were tested on a Linux server, the detailed system information of which had been described in the notes of each table, and the time and memory costs were recorded by running the systematic function ‘<italic toggle="yes">/usr/bin/time -v</italic>’ with a tail of the prepared scripts of different software tools. We used the same convergent precision 1e-8 and set the maximum iteration number of 100 for all software tools, but we did not assign the start values, because how to automatically provide more appropriate start values to achieve faster iterative convergence for the traits with unknown genetic architecture is one of the key factors of computational efficiency of a software tool.</p>
    <p>We first compared the computational efficiency for estimation of variance components for the most widely used parallelizable software tools or packages in the domain of genomic breeding evaluation by running the GBLUP model, which only requires genotypic information for prediction and is considered to be the most computationally expensive model in genetic evaluation. The software tools of choice were BLUPF90 (<xref rid="B11" ref-type="bibr">11</xref>), ASReml (<xref rid="B12" ref-type="bibr">12</xref>), GCTA (<xref rid="B42" ref-type="bibr">42</xref>), MTG2 (<xref rid="B35" ref-type="bibr">35</xref>), LDAK (<xref rid="B43" ref-type="bibr">43</xref>) and Sommer (<xref rid="B44" ref-type="bibr">44</xref>). Here, we did not include DMU (<xref rid="B10" ref-type="bibr">10</xref>) because the released version of DMU had no availability of parallel computing. All the selected software tools above were run in parallel automatically by the aid of packaged Intel MKL, except for the Sommer package; we ran Sommer in Microsoft R Open (MRO) (<ext-link xlink:href="https://mran.microsoft.com/" ext-link-type="uri">https://mran.microsoft.com/</ext-link>) to achieve parallel computing. When evaluating all the software tools or packages, we first computed the relationship matrix or its inverse, then used it directly for the downstream estimation of variance components and derivation of breeding values. When fitting a single trait model, two fixed effects and two environmental random effects were added in the analysis. Because parts of software tools (e.g. GCTA and LDAK) have no corresponding options to process environmental random effects, we prepared the relationship files manually in the required format by using HIBLUP. For a multiple traits model, we did not add any fixed effects and environmental random effects in the analyses because GCTA had no corresponding function; only one additive genetic random effect was fitted in the model for estimating genetic correlations. For BLUPF90, since it has no relevant function for fitting the GBLUP model, we ran the SSGBLUP model instead; the option ‘<italic toggle="yes">use_yams</italic>’ for YAMS was opened for a fast computing block dense matrix, but the APY strategy was turned off to ensure the same results from different software tools. For ASReml, we ran ASREML-SA instead of ASReml-R for parallel computing, and its required inverse of the relationship matrix was constructed by the R package ASRgenomics on the platform of MRO.</p>
    <p>The running script and log information for different software tools have been provided in <xref rid="sup1" ref-type="supplementary-material">Supplementary File S1</xref>, and the compared results are shown in Figure <xref rid="F1" ref-type="fig">1</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>. The ‘<italic toggle="yes">G</italic><sup>−1</sup>’ in the table represents those software tools that were compiled into the MME-based strategy, and the others implemented the V-based strategy. For GRM construction, HIBLUP computed the fastest, and it was accomplished within 15 s by using 32 threads for a population at a scale of 10 000 individuals and 100 000 SNPs. Because HIBLUP can also output the inverse of GRM directly, we also demonstrated the efficiency of HIBLUP for calculating the inverse matrix, it was amazing that HIBLUP only spent 3 s to compute the inverse of a matrix with a dimension of 10 000 × 10 000 while the memory cost remained unchanged (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). GCTA performed similarly to HIBLUP when constructing the GRM matrix; the Sommer package required a massive amount of computing time and memory, which was attributed to the unavailability of single floating-point operations and the lagging memory management and collection mechanism in R language. Roughly speaking, the computational time spent and memory cost to construct GRM and to compute its inverse for the software tools that implemented the MME-based algorithm were nearly 10 times greater than for HIBLUP.</p>
    <fig position="float" id="F1">
      <label>Figure 1.</label>
      <caption>
        <p>Comparisons of computational cost on time and memory of variance components estimation for the GBLUP model. The relationship matrix was constructed for all 10 000 genotypic individuals, and the computational costs were recorded for the construction of the inverse of the relationship matrix for the MME-based strategy (BLUPF90 and ASReml). ‘NA’ means the corresponding function is unavailable. The number of phenotypic records is 10 000 for both single trait and multiple traits models. All results were computed on a Red Hat Enterprise Linux server with 2.20 GHz Intel(R) Xeon(R) 32 CPUs E7-8880 v4 and 125 GB memory.</p>
      </caption>
      <graphic xlink:href="gkad074fig1" position="float"/>
    </fig>
    <p>For estimation of variance components, all these software tools generated nearly the same results as shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>. BLUPF90 exhibited a negligible difference from the other tools—this was because BLUPF90 utilized the pedigree information in analysis—and HIBLUP had the smallest iterative number for either a single trait model or a multiple traits model. For a single trait model, both HIBLUP and LDAK finished within 30 s, but HIBLUP used the lowest memory for analysis, and BLUPF90 required the longest time. For the multiple traits model, the memory costs of MTG2 and HIBLUP were 2–7 times less than for other software tools, and HIBLUP was the most efficient computationally. We found that even though ASReml had a smaller iteration number (9) than BLUPF90 (15), ASReml still required a similar computational time to BLUPF90, which meant that ASReml needed much more time per iteration than BLUPF90. Because the GBLUP model only used genotypic information rather than pedigree records, there were no mathematical operations related to sparse matrices. Undoubtedly, from the results above, we concluded that the software which implemented the V-based algorithm was more computationally beneficial than that which relied on the MME-based indirect algorithm when the genetic evaluation merely involved genotypic information.</p>
    <p>In practice, SSGBLUP has become the first choice in livestock breeding owing to its flexible integration of pedigree and genotypic information. The computational complexity of the SSGBLUP model depends mainly on the number of phenotypic records and the number of genotyped individuals in the pedigree. To systematically investigate the computational efficiency and the applicability of HIBLUP in a realistic evaluation of breeding, we designed a series of combinations of different numbers of phenotypic records and genotyped individuals to reflect the various complexities of genomic breeding data structure. Then, we employed it to evaluate the computational efficiency of HIBLUP with the software BLUPF90, which is used commonly to fit the SSGBLUP model in livestock genomic breeding. The genotyped individuals were selected in order from the last generation to the first generation at 625, 1250, 2500, 5000 and 10 000 out of 10 000 individuals in the pedigree; the individuals with phenotypic records were selected randomly from the 10 000 phenotypic records at the same levels, and the individuals with phenotypic records in the current level fully contained all the individuals from the previous level.</p>
    <p>In the experiments, we did not fit any environmental random effects, but only included one genetic random effect in either single trait or multiple traits models with the consideration that too many random effects would cause convergent failure for limited phenotypic records (e.g. 625). Table <xref rid="tbl1" ref-type="table">1</xref> reports the compared results on estimation of variance components using various complexities of data structure. For relationship matrix construction, computing the H matrix by HIBLUP was always more efficient than deriving its inverse matrix by using BLUPF90, and the memory consumption of HIBLUP grew more slowly with an increasing number of genotyped individuals. For estimation of variance components, a quick view of Table <xref rid="tbl1" ref-type="table">1</xref> shows that HIBLUP was computationally faster than BLUPF90 for most scenarios, especially when the breeding data have few phenotypic records and a tremendous number of genotyped individuals that are needed to predict, which meets the early stage selection in practical breeding. If the number of phenotypic records was constant, the time spent and memory cost stayed nearly the same for HIBLUP when more individuals were genotyped, but increased with an increasing number of phenotypic records; it was just the opposite for BLUPF90. The performance for time and memory of HIBLUP was more stable across different structural datasets, which makes HIBLUP predictable with respect to the requirements of computational resources for any scale of data at hand. We also found that BLUPF90 tended to be more difficult to reach convergence with a decreased number of phenotypic individuals, especially for a multiple traits model. No matter how big or small the number of phenotypic records is, the MME-based strategy in BLUPF90 requires construction of an MME, the dimension of which is equal to the number of individuals in the pedigree. However, in the V-based strategy, the dimension of the <italic toggle="yes">V</italic> matrix is equal to the number of individuals with phenotypic records, which is far smaller than the number of individuals in a pedigree for the majority of cases. Due to the limited information provided by a smaller number of phenotypic records, a bigger matrix requires much more time for the iterative process to be converged for the AIREML or PCG algorithm, especially for an increasingly denser matrix. This is the reason why BLUPF90 has erratic performances across different numbers of phenotypic records and genotyped individuals.</p>
    <table-wrap position="float" id="tbl1">
      <label>Table 1.</label>
      <caption>
        <p>Comparisons of computational cost in time and memory of estimation of variance components for the SSGBLUP model</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <th rowspan="1" colspan="1"/>
            <th rowspan="1" colspan="1"/>
            <th rowspan="1" colspan="1"/>
            <th colspan="2" align="center" rowspan="1"/>
            <th colspan="10" align="center" rowspan="1">
              <bold>Number of phenotypic records</bold>
            </th>
          </tr>
          <tr>
            <th rowspan="1" colspan="1">
              <bold>Time (s)/memory (GB)</bold>
            </th>
            <th rowspan="1" colspan="1">
              <italic toggle="yes">
                <bold>N</bold>
              </italic>
            </th>
            <th rowspan="1" colspan="1">
              <bold>Software</bold>
            </th>
            <th colspan="2" align="center" rowspan="1">
              <bold>Relationship matrix</bold>
            </th>
            <th colspan="5" align="center" rowspan="1">
              <bold>Single trait model</bold>
            </th>
            <th colspan="5" align="center" rowspan="1">
              <bold>Multiple traits model</bold>
            </th>
          </tr>
          <tr>
            <th rowspan="1" colspan="1"/>
            <th rowspan="1" colspan="1"/>
            <th rowspan="1" colspan="1"/>
            <th colspan="2" rowspan="1"/>
            <th rowspan="1" colspan="1">625</th>
            <th rowspan="1" colspan="1">1250</th>
            <th rowspan="1" colspan="1">2500</th>
            <th rowspan="1" colspan="1">5000</th>
            <th rowspan="1" colspan="1">10 000</th>
            <th rowspan="1" colspan="1">625</th>
            <th rowspan="1" colspan="1">1250</th>
            <th rowspan="1" colspan="1">2500</th>
            <th rowspan="1" colspan="1">5000</th>
            <th rowspan="1" colspan="1">10 000</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">
              <bold>Number of genotyped individuals</bold>
            </td>
            <td rowspan="1" colspan="1">625</td>
            <td rowspan="1" colspan="1">BLUPF90</td>
            <td rowspan="1" colspan="1">
              <italic toggle="yes">H</italic>
              <sup>−1</sup>
            </td>
            <td rowspan="1" colspan="1">8/0.67</td>
            <td rowspan="1" colspan="1">38/0.13</td>
            <td rowspan="1" colspan="1">22/0.27</td>
            <td rowspan="1" colspan="1">109/0.21</td>
            <td rowspan="1" colspan="1">77/0.14</td>
            <td rowspan="1" colspan="1">43/0.12</td>
            <td rowspan="1" colspan="1">1358/0.36</td>
            <td rowspan="1" colspan="1">103/0.59</td>
            <td rowspan="1" colspan="1">94/0.65</td>
            <td rowspan="1" colspan="1">425/0.49</td>
            <td rowspan="1" colspan="1">101/0.65</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">1250</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">12/1.25</td>
            <td rowspan="1" colspan="1">53/0.39</td>
            <td rowspan="1" colspan="1">36/0.40</td>
            <td rowspan="1" colspan="1">131/0.46</td>
            <td rowspan="1" colspan="1">120/0.46</td>
            <td rowspan="1" colspan="1">72/0.40</td>
            <td rowspan="1" colspan="1">2226/0.91</td>
            <td rowspan="1" colspan="1">330/0.69</td>
            <td rowspan="1" colspan="1">206/0.58</td>
            <td rowspan="1" colspan="1">1318/0.59</td>
            <td rowspan="1" colspan="1">312/0.56</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">2500</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">25/2.42</td>
            <td rowspan="1" colspan="1">138/0.65</td>
            <td rowspan="1" colspan="1">102/0.55</td>
            <td rowspan="1" colspan="1">208/0.65</td>
            <td rowspan="1" colspan="1">197/0.60</td>
            <td rowspan="1" colspan="1">173/0.64</td>
            <td rowspan="1" colspan="1">4371/1.33</td>
            <td rowspan="1" colspan="1">233/1.61</td>
            <td rowspan="1" colspan="1">240/1.60</td>
            <td rowspan="1" colspan="1">1223/1.56</td>
            <td rowspan="1" colspan="1">421/1.67</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">5000</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">52/5.41</td>
            <td rowspan="1" colspan="1">360/1.64</td>
            <td rowspan="1" colspan="1">685/1.95</td>
            <td rowspan="1" colspan="1">453/1.97</td>
            <td rowspan="1" colspan="1">432/2.01</td>
            <td rowspan="1" colspan="1">217/1.98</td>
            <td rowspan="1" colspan="1">6512/4.24</td>
            <td rowspan="1" colspan="1">495/4.23</td>
            <td rowspan="1" colspan="1">494/4.28</td>
            <td rowspan="1" colspan="1">2126/4.51</td>
            <td rowspan="1" colspan="1">557/4.23</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">10 000</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">150/11.96</td>
            <td rowspan="1" colspan="1">787/6.10</td>
            <td rowspan="1" colspan="1">1533/6.11</td>
            <td rowspan="1" colspan="1">1468/6.14</td>
            <td rowspan="1" colspan="1">1268/6.28</td>
            <td rowspan="1" colspan="1">865/6.18</td>
            <td rowspan="1" colspan="1">25 445/15.12</td>
            <td rowspan="1" colspan="1">1939/15.14</td>
            <td rowspan="1" colspan="1">5633/15.28</td>
            <td rowspan="1" colspan="1">6088/15.11</td>
            <td rowspan="1" colspan="1">4190/15.09</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">625</td>
            <td rowspan="1" colspan="1">HIBLUP</td>
            <td rowspan="1" colspan="1">
              <italic toggle="yes">H</italic>
            </td>
            <td rowspan="1" colspan="1">6/1.09</td>
            <td rowspan="1" colspan="1">1/0.23</td>
            <td rowspan="1" colspan="1">1/0.27</td>
            <td rowspan="1" colspan="1">4/0.37</td>
            <td rowspan="1" colspan="1">13/0.88</td>
            <td rowspan="1" colspan="1">56/2.39</td>
            <td rowspan="1" colspan="1">1/0.23</td>
            <td rowspan="1" colspan="1">3/0.32</td>
            <td rowspan="1" colspan="1">9/0.81</td>
            <td rowspan="1" colspan="1">32/2.16</td>
            <td rowspan="1" colspan="1">204/7.04</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">1250</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">7/1.10</td>
            <td rowspan="1" colspan="1">1/0.23</td>
            <td rowspan="1" colspan="1">1/0.27</td>
            <td rowspan="1" colspan="1">4/0.37</td>
            <td rowspan="1" colspan="1">13/0.89</td>
            <td rowspan="1" colspan="1">47/2.38</td>
            <td rowspan="1" colspan="1">3/0.27</td>
            <td rowspan="1" colspan="1">5/0.33</td>
            <td rowspan="1" colspan="1">11/0.81</td>
            <td rowspan="1" colspan="1">35/2.18</td>
            <td rowspan="1" colspan="1">205/6.98</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">2500</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">10/1.13</td>
            <td rowspan="1" colspan="1">1/0.24</td>
            <td rowspan="1" colspan="1">1/0.26</td>
            <td rowspan="1" colspan="1">3/0.37</td>
            <td rowspan="1" colspan="1">11/0.92</td>
            <td rowspan="1" colspan="1">44/2.37</td>
            <td rowspan="1" colspan="1">2/0.26</td>
            <td rowspan="1" colspan="1">3/0.32</td>
            <td rowspan="1" colspan="1">10/0.84</td>
            <td rowspan="1" colspan="1">36/2.15</td>
            <td rowspan="1" colspan="1">193/7.17</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">5000</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">18/1.28</td>
            <td rowspan="1" colspan="1">1/0.24</td>
            <td rowspan="1" colspan="1">1/0.27</td>
            <td rowspan="1" colspan="1">3/0.37</td>
            <td rowspan="1" colspan="1">11/0.93</td>
            <td rowspan="1" colspan="1">40/2.38</td>
            <td rowspan="1" colspan="1">2/0.25</td>
            <td rowspan="1" colspan="1">3/0.32</td>
            <td rowspan="1" colspan="1">10/0.84</td>
            <td rowspan="1" colspan="1">36/2.19</td>
            <td rowspan="1" colspan="1">171/7.11</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">10 000</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">58/1.94</td>
            <td rowspan="1" colspan="1">1/0.24</td>
            <td rowspan="1" colspan="1">1/0.26</td>
            <td rowspan="1" colspan="1">3/0.38</td>
            <td rowspan="1" colspan="1">11/1.09</td>
            <td rowspan="1" colspan="1">49/2.51</td>
            <td rowspan="1" colspan="1">2/0.25</td>
            <td rowspan="1" colspan="1">3/0.32</td>
            <td rowspan="1" colspan="1">9/0.82</td>
            <td rowspan="1" colspan="1">45/2.29</td>
            <td rowspan="1" colspan="1">213/7.49</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <fn id="T1TFN1">
          <p>Values in each cell represent ‘time (s)/memory (GB)’, ‘<italic toggle="yes">H</italic>’ is the relationship matrix derived from the pedigree (<italic toggle="yes">n</italic>= 10 000) and genotypic information (<italic toggle="yes">N</italic>), and the genotyped individuals are randomly selected from pedigree, ‘<italic toggle="yes">H</italic><sup>−1</sup>’ is the inverse of ‘<italic toggle="yes">H</italic>’. The total number of predicted individuals is 10 000. All the experiments were computed on a Red Hat Enterprise Linux sever with 2.20 GHz Intel(R) Xeon(R) 32 CPUs E7-8880 v4 and 125 GB memory.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>Finally, we compared the efficiency of solving an MME to obtain EBVs using the prior estimated variance components. Note that the default method for a linear solver in BLUPF90 was PCG, but it was Cholesky or LU decomposition in HIBLUP. From Table <xref rid="tbl2" ref-type="table">2</xref> we can see, when the product of the number of phenotypic records and the number of traits was within 5000, HIBLUP output the EBVs in just 1 s, and no matter how many individuals we genotyped, the required memory remained unchanged if the number of phenotypic individuals remained constant. However, for BLUPF90, the time spent was several hundred times longer than for HIBLUP, the memory cost increased significantly with the increasing number of genotyped individuals and the PCG iteration in BLUPF90 required more time to converge when there were only a few phenotypic records for a large number of genotyped individuals. However, when there were a tremendous number of phenotypic individuals but only a small proportion of individuals in the pedigree were genotyped, BLUPF90 demonstrated superior performance due to its advanced sparse technology. We also compared the computational performances of decomposition and PCG algorithms implemented in HIBLUP (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref>). The results showed that the decomposition and PCG algorithms had similar performances on the scale of simulated datasets regarding the time spent, and only small differences were found when the number of phenotypic records reached 10 000, but the decomposition algorithm required higher memory than PCG, which was attributed to the newly generated matrix to store the decomposition results. Although PCG has far less complexity than decomposition, it is an iterative algorithm which cannot be paralleled theoretically. Instead, the computational efficiency of matrix decomposition could be greatly improved by parallel computing. Therefore, the parallel-accelerated decomposition has faster computational performance than PCG on a small or medium population size for most users. However, for a very large population, the PCG algorithm should be the first choice.</p>
    <table-wrap position="float" id="tbl2">
      <label>Table 2.</label>
      <caption>
        <p>Comparisons of computational cost in time and memory of solving a mixed model equation for the SSGBLUP model</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <th rowspan="1" colspan="1"/>
            <th rowspan="1" colspan="1"/>
            <th rowspan="1" colspan="1"/>
            <th colspan="10" align="center" rowspan="1">
              <bold>Number of phenotypic records</bold>
            </th>
          </tr>
          <tr>
            <th rowspan="1" colspan="1">
              <bold>Time (s)/memory (GB)</bold>
            </th>
            <th rowspan="1" colspan="1">
              <italic toggle="yes">
                <bold>N</bold>
              </italic>
            </th>
            <th rowspan="1" colspan="1">
              <bold>Software</bold>
            </th>
            <th colspan="5" align="center" rowspan="1">
              <bold>Single trait model</bold>
            </th>
            <th colspan="5" align="center" rowspan="1">
              <bold>Multiple traits model</bold>
            </th>
          </tr>
          <tr>
            <th rowspan="1" colspan="1"/>
            <th rowspan="1" colspan="1"/>
            <th rowspan="1" colspan="1"/>
            <th rowspan="1" colspan="1">625</th>
            <th rowspan="1" colspan="1">1250</th>
            <th rowspan="1" colspan="1">2500</th>
            <th rowspan="1" colspan="1">5000</th>
            <th rowspan="1" colspan="1">10 000</th>
            <th rowspan="1" colspan="1">625</th>
            <th rowspan="1" colspan="1">1250</th>
            <th rowspan="1" colspan="1">2500</th>
            <th rowspan="1" colspan="1">5000</th>
            <th rowspan="1" colspan="1">10 000</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">
              <bold>Number of genotyped individuals</bold>
            </td>
            <td rowspan="1" colspan="1">625</td>
            <td rowspan="1" colspan="1">BLUPF90</td>
            <td rowspan="1" colspan="1">1/0.04</td>
            <td rowspan="1" colspan="1">1/0.04</td>
            <td rowspan="1" colspan="1">1/0.03</td>
            <td rowspan="1" colspan="1">1/0.04</td>
            <td rowspan="1" colspan="1">1/0.04</td>
            <td rowspan="1" colspan="1">3/0.09</td>
            <td rowspan="1" colspan="1">3/0.09</td>
            <td rowspan="1" colspan="1">2/0.09</td>
            <td rowspan="1" colspan="1">2/0.09</td>
            <td rowspan="1" colspan="1">2/0.09</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">1250</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">2/0.06</td>
            <td rowspan="1" colspan="1">2/0.06</td>
            <td rowspan="1" colspan="1">1/0.06</td>
            <td rowspan="1" colspan="1">1/0.06</td>
            <td rowspan="1" colspan="1">2/0.1</td>
            <td rowspan="1" colspan="1">8/0.17</td>
            <td rowspan="1" colspan="1">8/0.17</td>
            <td rowspan="1" colspan="1">7/0.17</td>
            <td rowspan="1" colspan="1">7/0.17</td>
            <td rowspan="1" colspan="1">6/0.17</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">2500</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">9/0.20</td>
            <td rowspan="1" colspan="1">9/0.20</td>
            <td rowspan="1" colspan="1">7/0.20</td>
            <td rowspan="1" colspan="1">5/0.20</td>
            <td rowspan="1" colspan="1">5/0.20</td>
            <td rowspan="1" colspan="1">39/0.63</td>
            <td rowspan="1" colspan="1">32/0.63</td>
            <td rowspan="1" colspan="1">28/0.63</td>
            <td rowspan="1" colspan="1">23/0.62</td>
            <td rowspan="1" colspan="1">22/0.62</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">5000</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">21/0.76</td>
            <td rowspan="1" colspan="1">20/0.76</td>
            <td rowspan="1" colspan="1">22/0.76</td>
            <td rowspan="1" colspan="1">21/0.76</td>
            <td rowspan="1" colspan="1">18/0.76</td>
            <td rowspan="1" colspan="1">172/2.45</td>
            <td rowspan="1" colspan="1">144/2.45</td>
            <td rowspan="1" colspan="1">103/2.45</td>
            <td rowspan="1" colspan="1">106/2.45</td>
            <td rowspan="1" colspan="1">97/2.45</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">10 000</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">97/3.01</td>
            <td rowspan="1" colspan="1">111/3.01</td>
            <td rowspan="1" colspan="1">81/3.01</td>
            <td rowspan="1" colspan="1">63/3.01</td>
            <td rowspan="1" colspan="1">54/3.01</td>
            <td rowspan="1" colspan="1">724/9.76</td>
            <td rowspan="1" colspan="1">613/9.76</td>
            <td rowspan="1" colspan="1">483/9.76</td>
            <td rowspan="1" colspan="1">370/9.76</td>
            <td rowspan="1" colspan="1">327/9.76</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">625</td>
            <td rowspan="1" colspan="1">HIBLUP</td>
            <td rowspan="1" colspan="1">1/0.21</td>
            <td rowspan="1" colspan="1">1/0.24</td>
            <td rowspan="1" colspan="1">1/0.28</td>
            <td rowspan="1" colspan="1">1/0.63</td>
            <td rowspan="1" colspan="1">2/1.41</td>
            <td rowspan="1" colspan="1">1/0.21</td>
            <td rowspan="1" colspan="1">1/0.24</td>
            <td rowspan="1" colspan="1">1/0.54</td>
            <td rowspan="1" colspan="1">2/1.23</td>
            <td rowspan="1" colspan="1">9/3.68</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">1250</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">1/0.21</td>
            <td rowspan="1" colspan="1">1/0.24</td>
            <td rowspan="1" colspan="1">1/0.28</td>
            <td rowspan="1" colspan="1">1/0.63</td>
            <td rowspan="1" colspan="1">2/1.41</td>
            <td rowspan="1" colspan="1">1/0.21</td>
            <td rowspan="1" colspan="1">1/0.24</td>
            <td rowspan="1" colspan="1">1/0.54</td>
            <td rowspan="1" colspan="1">2/1.22</td>
            <td rowspan="1" colspan="1">9/3.67</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">2500</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">1/0.21</td>
            <td rowspan="1" colspan="1">1/0.24</td>
            <td rowspan="1" colspan="1">1/0.28</td>
            <td rowspan="1" colspan="1">1/0.63</td>
            <td rowspan="1" colspan="1">2/1.41</td>
            <td rowspan="1" colspan="1">1/0.21</td>
            <td rowspan="1" colspan="1">1/0.24</td>
            <td rowspan="1" colspan="1">1/0.54</td>
            <td rowspan="1" colspan="1">2/1.24</td>
            <td rowspan="1" colspan="1">9/3.67</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">5000</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">1/0.21</td>
            <td rowspan="1" colspan="1">1/0.24</td>
            <td rowspan="1" colspan="1">1/0.28</td>
            <td rowspan="1" colspan="1">1/0.63</td>
            <td rowspan="1" colspan="1">2/1.43</td>
            <td rowspan="1" colspan="1">1/0.21</td>
            <td rowspan="1" colspan="1">1/0.23</td>
            <td rowspan="1" colspan="1">1/0.54</td>
            <td rowspan="1" colspan="1">2/1.25</td>
            <td rowspan="1" colspan="1">9/3.66</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">10 000</td>
            <td rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">1/0.21</td>
            <td rowspan="1" colspan="1">1/0.24</td>
            <td rowspan="1" colspan="1">1/0.28</td>
            <td rowspan="1" colspan="1">1/0.71</td>
            <td rowspan="1" colspan="1">2/1.54</td>
            <td rowspan="1" colspan="1">1/0.21</td>
            <td rowspan="1" colspan="1">1/0.24</td>
            <td rowspan="1" colspan="1">1/0.54</td>
            <td rowspan="1" colspan="1">2/1.36</td>
            <td rowspan="1" colspan="1">11/3.83</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <fn id="T2TFN1">
          <p>Values in each cell represent ‘time (s)/memory (GB)’. The genotyped individuals are randomly selected from the pedigree, and the total number of predicted individuals is 10 000. All the experiments were computed on a Red Hat Enterprise Linux sever with 2.20 GHz Intel(R) Xeon(R) 32 CPUs E7-8880 v4 and 125 GB memory.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>Although the observed computational benefits from HIBLUP over other software tools had been outstanding for the one or two traits models with only 10 000 individuals, we further simulated a UK Biobank scale dataset consisting of 500 000 individuals and 1 million markers, then used it to evaluate the computational efficiency of HIBLUP and GCTA (which had the performance closest to that of HIBLUP in Figure <xref rid="F1" ref-type="fig">1</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). The compared results showed that HIBLUP can accomplish the GRM construction within 21 h at a memory cost of 1 TB using 128 threads, while GCTA took more than twice the computational time (56 h) and memory (2.3 TB) compared with HIBLUP at the same level of threads (see <xref rid="sup1" ref-type="supplementary-material">Supplementary File S2</xref>). Moreover, the GRM construction in HIBLUP can be speeded up by assigning a local file listing a subset of SNPs that are filtered at a user-specific condition, such as clumping, pruning, and so on, and we also have provided an option ‘–step’ to enable the users to balance the memory usage and time spent according to the size of computational resources. We then tried to estimate variance components and to derive the genomic breeding values on this large dataset; HIBLUP can finish all the analyses in 1 h at a memory cost of 1.8 TB owing to the implemented efficient ‘HE + PCG’ strategy (<xref rid="sup1" ref-type="supplementary-material">Supplementary File S2</xref>), where ‘HE’ and ‘PCG’ are the methods used in estimation of variance components and genomic breeding value derivation, respectively. As GCTA can fit the HE regression but has no direct functionality of solving MMEs, we first ran HE regression to estimate the variance components, then assigned it as the start values of AIREML with just one iteration to derive the breeding values, which we call the ‘HE + Solver’ strategy. The results showed that GCTA spent 3 h to finish the HE regression analysis, and required a memory cost of 5.5 TB when estimating the breeding values. However, the program was still in computing after running for 100 h; we had to stop it because of the uncertain runtime. This meant that the ‘HE + PCG’ strategy in HIBLUP was at least 100 times faster than the ‘HE + Solver’ strategy in GCTA. Based on the results of Figure <xref rid="F1" ref-type="fig">1</xref>, it is safe to say that the other software tools would require more days or even several weeks by using the available strategies (e.g. AIREML + PCG, AIREML + Solver and AIREML + FSPAK/YAMS). As we discussed, this big computational advantage of HIBLUP was largely attributed to the fact that the ‘HE + PCG’ strategy does not require computation of the inverse of any big matrix in either variance component estimation or breeding value derivation. We therefore believe that the advantages on computational efficiency of HIBLUP over other software tools would be even much larger with an increasing number of traits and an increasing number of genotyped individuals in the model using more computational resources in the analysis. This makes HIBLUP a very promising tool in genetic evaluation using big genomic data.</p>
  </sec>
  <sec sec-type="discussion" id="SEC4">
    <title>DISCUSSION</title>
    <p>In the above sections, we theoretically described and compared the computational complexity between the MME-based indirect algorithm and the V-based direct algorithm in genetic evaluation. We concluded that HIBLUP was much more competent in genomic breeding evaluation than existing tools that implemented an MME-based strategy because of the efficient implementations of the V-based algorithm. The high efficiency of V-based algorithms is attributed to the parallelizable decomposition on dense matrices in estimation of variance of components and the non-requirement for directly inverting any relationship matrices in derivation of breeding values. However, it should be mentioned that if the evaluation only involves the pedigree (i.e. traditional breeding) or there is a very large pedigree in which only a very small proportion of individuals are genotyped, the software that implements the MME-based algorithm should be the first choice to handle this kind of data because the inverse of the relationship matrix is pretty sparse, and it can be obtained extremely quickly. On the contrary, the relationship matrix required for the V-based algorithm is generally dense in this situation, and factorization and inversion of a dense matrix could be much more time and memory expensive than on a very sparse matrix. However, on the one hand, if the pedigree-based relationship between the predicted generation and their ancestors beyond 3–5 generations has become very weak, the prediction accuracy of the predicted generation would not be improved much when the depth of pedigree records exceeds five generations (<xref rid="B45" ref-type="bibr">45</xref>,<xref rid="B46" ref-type="bibr">46</xref>), and evidence showed that the convergence rate of the model can be undesirable for large pedigrees; a pedigree depth of three generations was optimal for convergence (<xref rid="B47" ref-type="bibr">47</xref>). Instead, the prediction accuracy may be decreased because the continuous artificial selection results in a big genetic gap between two remote generations and, therefore, the scale of pedigree used in genetic evaluation would not be very large; on the other hand, with the application of genomic selection in practical breeding year after year, all the individuals in performance testing would be genotyped and, therefore, all the phenotypic individuals would have genotypic information. The genetic relationship between generations can be measured by genotypic information directly; the model that can utilize the big genotype data and phenotypic records effectively should be the ‘The Chosen One’ in future genetic evaluation. All in all, the scale of data currently used in genetic evaluation, including phenotype, genotype and pedigree, would be generally within 3–5 generations, and the proportion of genotyped individuals in the pedigree is increasingly larger, which is very friendly to the V-based algorithm. However, for the MME-based algorithm, the effectiveness of computational efficiency for sparse technologies on a coefficient matrix will be limited, the process of locating sparse elements may lower the computation efficiency, and the memory cost will be several times larger than the V-based algorithm as the coefficient matrix of the MME and its inverse are no longer sparse for this case.</p>
    <p>Nowadays, general genetic evaluation only accounts for the additive genetic effect in a model because the additive genetic effect is the only one considered to be heritable across generations. However, non-additive genetic effects may have an important contribution to the total genetic variation of complex traits, especially for a hybrid or crossbred population. Published papers have indicated that the model that includes additive and non-additive genetic effects can be beneficial for both genomic prediction (<xref rid="B48" ref-type="bibr">48</xref>) and genomic mating (<xref rid="B49" ref-type="bibr">49</xref>). In addition, the high-density SNPs across the entire genome are the mainstream markers used to implement genomic prediction, because it is common sense that the causal mutations of a trait are most likely to be in linkage disequilibrium (LD) with at least one SNP. However, a single piece of information from SNPs cannot fully capture the genetic variation of a trait. Additionally integrating structure variants (SVs) of genomics, including deletions, insertions, duplications, inversions and translocations, into a model with multiple genetic random effects can improve the prediction accuracy (<xref rid="B50" ref-type="bibr">50</xref>,<xref rid="B51" ref-type="bibr">51</xref>). Moreover, because of the fast development of sequencing technology, the increasing size of other non-genomics data (e.g. transcriptomics, proteomics and metabolomics) can be accessed freely by the public, and these multi-omics data provide a bridge between organismal phenotypes and genomics, and could bring new insights to the understanding of genetic architecture of traits. Thus they can be utilized in fitting a model to potentially improve the prediction performance (<xref rid="B52" ref-type="bibr">52</xref>,<xref rid="B53" ref-type="bibr">53</xref>). Additionally, because different levels of data may provide shared genetic information, the covariance terms between these random effects can be substantial, so fitting interactions between genetic random effects in the model is necessary (<xref rid="B54" ref-type="bibr">54</xref>). In brief, multiple genetic effects, multiple types of variants, multiple omics data and multiple interactions within random effects will be considered in mixed models to improve prediction accuracy. None of these terms is sparse in computation; therefore, it would be a huge challenge, if not nearly impossible, to fit such a large number of genetic random effects in an MME-based algorithm, because the dimension of an MME appears to increase linearly with the number of environmental and genetic random effects, which results in unpredictable time and memory costs for analysis. However, for the V-based algorithm implemented in HIBLUP, the computational burden mainly depends on the dimension of the V matrix, which is equal to the number of phenotypic records; no matter how many random effects are fitted in the model, the dimension of the V matrix stays the same. Only a small fraction of time is required to reach an iterative convergence; thus, the computing efficiency for the model of multiple genetic random effects is quite consistent with that of a single genetic random effect, making HIBLUP more promising for genetic evaluation in the genomic era compared with existing software tools.</p>
    <p>We conclude that the V-based algorithm is more computationally advantageous compared with the MME-based algorithm for genomic breeding; the highly efficient ‘HE + PCG’ strategy implemented in HIBLUP can avoid computing the inverse of any matrix, and no doubt it should be the most appropriate solution for genetic evaluation using large genomic data. However, the real problem is that all these kinds of algorithms require the construction of a relationship matrix or its inverse matrix. However, with the rapidly increasing number of individuals that are genotyped, the size of the relationship matrix exhibits square growth. Leaving aside the time used in computing, the memory needed for storing such a large matrix may be up to several terabytes. To address this issue, we could make a dense matrix more sparse manually; however, this may generate biased estimation of variance components for an MME-based algorithm (<xref rid="B33" ref-type="bibr">33</xref>) or only work for a model with just one genetic random effect for a V-based algorithm (<xref rid="B36" ref-type="bibr">36</xref>). Another strategy that may be more applicable is to transform the determinant of computational burden into the number of markers from the number of individuals. Because most species just use a chip array (e.g. 50–80k for pigs) for genomic breeding rather than sequencing data, the number of individuals is far larger than the number of markers in this situation. Therefore, it is feasible to regress the phenotypic records directly on all markers simultaneously using a multiple regression model (MRM) to obtain the joint marker effects, the EBVs and variance components rapidly. Except for MRM, summary statistics can also be adaptable; it first fits a single marker regression model to get the marginal effects and standard error of all markers (i.e. summary-level data), then uses the LD score regression to estimate the variance components (<xref rid="B55" ref-type="bibr">55</xref>) and fit the SBLUP (summary-level BLUP) model (<xref rid="B56" ref-type="bibr">56</xref>) to obtain the joint marker effects. The strategies discussed above can successfully eliminate constructing a relationship matrix or its inverse matrix that is used in genetic evaluation, but this should be explored further and investigated by using real breeding data, which would be our next focus of work on HIBLUP in the future.</p>
    <p>In conclusion, to improve the efficiency of genetic evaluation in the genomic era, we presented a computationally efficient, functionally enriched and user-friendly software called ‘HIBLUP’. Powered by the new advanced algorithms, the elaborate computational design and the efficient software programming, HIBLUP computed the fastest, required the least memory for analysis and the computational benefits from HIBLUP over other software tend to be greater with an increasing number of genotyped individuals. Owing to the user-friendly software design, abundant functional modules, comprehensive logging information and clear reminder of events, HIBLUP is simple to start, easy to learn and flexible to use.</p>
  </sec>
  <sec sec-type="data-availability" id="SEC5">
    <title>DATA AVAILABILITY</title>
    <p>The HIBLUP software and user manual can be accessed freely at <ext-link xlink:href="https://www.hiblup.com" ext-link-type="uri">https://www.hiblup.com</ext-link>.</p>
    <p>The software packages and tools used were Simer, <ext-link xlink:href="https://CRAN.R-project.org/package=simer" ext-link-type="uri">https://CRAN.R-project.org/package=simer</ext-link>; ASRgenomics, <ext-link xlink:href="https://asreml.kb.vsni.co.uk/asrgenomics-download-success" ext-link-type="uri">https://asreml.kb.vsni.co.uk/asrgenomics-download-success</ext-link>; ASReml, <ext-link xlink:href="https://vsni.co.uk/software/asreml" ext-link-type="uri">https://vsni.co.uk/software/asreml</ext-link>; BLUPF90, <ext-link xlink:href="http://nce.ads.uga.edu/html/projects/programs/" ext-link-type="uri">http://nce.ads.uga.edu/html/projects/programs/</ext-link>; GCTA, <ext-link xlink:href="https://yanglab.westlake.edu.cn/software/gcta" ext-link-type="uri">https://yanglab.westlake.edu.cn/software/gcta</ext-link>; LDAK, <ext-link xlink:href="https://dougspeed.com/ldak/" ext-link-type="uri">https://dougspeed.com/ldak/</ext-link>; MTG2, <ext-link xlink:href="https://sites.google.com/site/honglee0707/mtg2" ext-link-type="uri">https://sites.google.com/site/honglee0707/mtg2</ext-link>; and Sommer, <ext-link xlink:href="https://CRAN.R-project.org/package=sommer" ext-link-type="uri">https://CRAN.R-project.org/package=sommer</ext-link>.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>gkad074_Supplemental_Files</label>
      <media xlink:href="gkad074_supplemental_files.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ACK1">
    <title>ACKNOWLEDGEMENTS</title>
    <p>We sincerely thank the many users who reported bugs or valuable ideas for new features, thus helping to continuously improve the development of HIBLUP. We would like to thank Jing Xu and Liangliang Fu for their efforts in the maintenance of the experimental instruments and computational platform to guarantee that our project ran smoothly. We also thank Thomas A. Gavin, Professor Emeritus, Cornell University, for help with editing this manuscript.</p>
  </ack>
  <sec id="SEC6">
    <title>SUPPLEMENTARY DATA</title>
    <p><ext-link xlink:href="https://academic.oup.com/nar/article-lookup/doi/10.1093/nar/gkad074#supplementary-data" ext-link-type="uri">Supplementary Data</ext-link> are available at NAR Online.</p>
  </sec>
  <sec id="SEC7">
    <title>FUNDING</title>
    <p>This work was supported by the National Key Research and Development Program of China [2021YFD1300800]; the National Natural Science Foundation of China [32072725]; and the China Agriculture Research System of MOF and MARA [CARS-35].</p>
    <p><italic toggle="yes">Conflict of interest statement</italic>. None declared.</p>
  </sec>
  <ref-list id="REF1">
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Henderson</surname><given-names>C.R.</given-names></string-name></person-group><article-title>Best linear unbiased estimation and prediction under a selection model</article-title>. <source>Biometrics</source>. <year>1975</year>; <volume>31</volume>:<fpage>423</fpage>–<lpage>447</lpage>.<pub-id pub-id-type="pmid">1174616</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Boldman</surname><given-names>K.</given-names></string-name>, <string-name><surname>Van Vleck</surname><given-names>L.D.</given-names></string-name></person-group><article-title>Derivative-free restricted maximum likelihood estimation in animal models with a sparse matrix solver</article-title>. <source>J. Dairy Sci.</source><year>1991</year>; <volume>74</volume>:<fpage>4337</fpage>–<lpage>4343</lpage>.<pub-id pub-id-type="pmid">1787202</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Johnson</surname><given-names>D.</given-names></string-name>, <string-name><surname>Thompson</surname><given-names>R.</given-names></string-name></person-group><article-title>Restricted maximum likelihood estimation of variance components for univariate animal models using sparse matrix techniques and average information</article-title>. <source>J. Dairy Sci.</source><year>1995</year>; <volume>78</volume>:<fpage>449</fpage>–<lpage>456</lpage>.</mixed-citation>
    </ref>
    <ref id="B4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Meuwissen</surname><given-names>T.H.</given-names></string-name>, <string-name><surname>Hayes</surname><given-names>B.J.</given-names></string-name>, <string-name><surname>Goddard</surname><given-names>M.</given-names></string-name></person-group><article-title>Prediction of total genetic value using genome-wide dense marker maps</article-title>. <source>Genetics</source>. <year>2001</year>; <volume>157</volume>:<fpage>1819</fpage>–<lpage>1829</lpage>.<pub-id pub-id-type="pmid">11290733</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yin</surname><given-names>L.L.</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>H.H.</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>X.</given-names></string-name>, <string-name><surname>Yuan</surname><given-names>X.H.</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>S.H.</given-names></string-name>, <string-name><surname>Li</surname><given-names>X.Y.</given-names></string-name>, <string-name><surname>Liu</surname><given-names>X.L.</given-names></string-name></person-group><article-title>KAML: improving genomic prediction accuracy of complex traits using machine learning determined parameters</article-title>. <source>Genome Biol.</source><year>2020</year>; <volume>21</volume>:<fpage>146</fpage>.<pub-id pub-id-type="pmid">32552725</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhou</surname><given-names>X.</given-names></string-name>, <string-name><surname>Carbonetto</surname><given-names>P.</given-names></string-name>, <string-name><surname>Stephens</surname><given-names>M.</given-names></string-name></person-group><article-title>Polygenic modeling with bayesian sparse linear mixed models</article-title>. <source>PLoS Genet.</source><year>2013</year>; <volume>9</volume>:<fpage>e1003264</fpage>.<pub-id pub-id-type="pmid">23408905</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moser</surname><given-names>G.</given-names></string-name>, <string-name><surname>Lee</surname><given-names>S.H.</given-names></string-name>, <string-name><surname>Hayes</surname><given-names>B.J.</given-names></string-name>, <string-name><surname>Goddard</surname><given-names>M.E.</given-names></string-name>, <string-name><surname>Wray</surname><given-names>N.R.</given-names></string-name>, <string-name><surname>Visscher</surname><given-names>P.M.</given-names></string-name></person-group><article-title>Simultaneous discovery, estimation and prediction analysis of complex traits using a bayesian mixture model</article-title>. <source>PLoS Genet.</source><year>2015</year>; <volume>11</volume>:<fpage>e1004969</fpage>.<pub-id pub-id-type="pmid">25849665</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zeng</surname><given-names>P.</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>X.</given-names></string-name></person-group><article-title>Non-parametric genetic prediction of complex traits with latent Dirichlet process regression models</article-title>. <source>Nat. Commun.</source><year>2017</year>; <volume>8</volume>:<fpage>456</fpage>.<pub-id pub-id-type="pmid">28878256</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Georges</surname><given-names>M.</given-names></string-name>, <string-name><surname>Charlier</surname><given-names>C.</given-names></string-name>, <string-name><surname>Hayes</surname><given-names>B.</given-names></string-name></person-group><article-title>Harnessing genomic information for livestock improvement</article-title>. <source>Nat. Rev. Genet.</source><year>2019</year>; <volume>20</volume>:<fpage>135</fpage>–<lpage>156</lpage>.<pub-id pub-id-type="pmid">30514919</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <label>10.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Madsen</surname><given-names>P.</given-names></string-name>, <string-name><surname>Sørensen</surname><given-names>P.</given-names></string-name>, <string-name><surname>Su</surname><given-names>G.</given-names></string-name>, <string-name><surname>Damgaard</surname><given-names>L.</given-names></string-name>, <string-name><surname>Thomsen</surname><given-names>H.</given-names></string-name>, <string-name><surname>Labouriau</surname><given-names>R.</given-names></string-name></person-group><article-title>DMU-a package for analyzing multivariate mixed models</article-title>. <source>8th World Congress on Genetics Applied to Livestock Production</source>. <year>2006</year>; <volume>247</volume>:<publisher-loc>Belo Horizonte</publisher-loc><fpage>11</fpage>–<lpage>27</lpage>.</mixed-citation>
    </ref>
    <ref id="B11">
      <label>11.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Misztal</surname><given-names>I.</given-names></string-name>, <string-name><surname>Tsuruta</surname><given-names>S.</given-names></string-name>, <string-name><surname>Strabel</surname><given-names>T.</given-names></string-name>, <string-name><surname>Auvray</surname><given-names>B.</given-names></string-name>, <string-name><surname>Druet</surname><given-names>T.</given-names></string-name>, <string-name><surname>Lee</surname><given-names>D</given-names></string-name></person-group><article-title>BLUPF90 and related programs (BGF90)</article-title>. <source>Proceedings of the 7th world congress on genetics applied to livestock production</source>. <year>2002</year>; <volume>28</volume>:<publisher-loc>Montpellier</publisher-loc><fpage>1</fpage>–<lpage>2</lpage>.</mixed-citation>
    </ref>
    <ref id="B12">
      <label>12.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Gilmour</surname><given-names>A.R.</given-names></string-name>, <string-name><surname>Gogel</surname><given-names>B.J.</given-names></string-name>, <string-name><surname>Cullis</surname><given-names>B.R.</given-names></string-name>, <string-name><surname>Welham</surname><given-names>S.</given-names></string-name>, <string-name><surname>Thompson</surname><given-names>R.</given-names></string-name></person-group><year>2002</year>; <comment>ASReml user guide release 1.0</comment><uri xlink:href="https://vsni.co.uk/software/asreml">https://vsni.co.uk/software/asreml</uri>.</mixed-citation>
    </ref>
    <ref id="B13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Masuda</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Baba</surname><given-names>T.</given-names></string-name>, <string-name><surname>Suzuki</surname><given-names>M.</given-names></string-name></person-group><article-title>Application of supernodal sparse factorization and inversion to the estimation of (co) variance components by residual maximum likelihood</article-title>. <source>J. Anim. Breed. Genet.</source><year>2014</year>; <volume>131</volume>:<fpage>227</fpage>–<lpage>236</lpage>.<pub-id pub-id-type="pmid">24906028</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Misztal</surname><given-names>I.</given-names></string-name></person-group><article-title>Inexpensive computation of the inverse of the genomic relationship matrix in populations with small effective population size</article-title>. <source>Genetics</source>. <year>2016</year>; <volume>202</volume>:<fpage>401</fpage>–<lpage>409</lpage>.<pub-id pub-id-type="pmid">26584903</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Patterson</surname><given-names>H.D.</given-names></string-name>, <string-name><surname>Thompson</surname><given-names>R.</given-names></string-name></person-group><article-title>Recovery of inter-block information when block sizes are unequal</article-title>. <source>Biometrika</source>. <year>1971</year>; <volume>58</volume>:<fpage>545</fpage>–<lpage>554</lpage>.</mixed-citation>
    </ref>
    <ref id="B16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Meyer</surname><given-names>K.</given-names></string-name></person-group><article-title>Restricted maximum likelihood to estimate variance components for animal models with several random effects using a derivative-free algorithm</article-title>. <source>Genet. Sel. Evol.</source><year>1989</year>; <volume>21</volume>:<fpage>317</fpage>–<lpage>340</lpage>.</mixed-citation>
    </ref>
    <ref id="B17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Graser</surname><given-names>H.-U.</given-names></string-name>, <string-name><surname>Smith</surname><given-names>S.</given-names></string-name>, <string-name><surname>Tier</surname><given-names>B.</given-names></string-name></person-group><article-title>A derivative-free approach for estimating variance components in animal models by restricted maximum likelihood</article-title>. <source>J. Anim. Sci.</source><year>1987</year>; <volume>64</volume>:<fpage>1362</fpage>–<lpage>1370</lpage>.</mixed-citation>
    </ref>
    <ref id="B18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Misztal</surname><given-names>I.</given-names></string-name></person-group><article-title>Comparison of computing properties of derivative and derivative-free algorithms in variance-component estimation by REML</article-title>. <source>J. Anim. Breed. Genet.</source><year>1994</year>; <volume>111</volume>:<fpage>346</fpage>–<lpage>355</lpage>.<pub-id pub-id-type="pmid">21395785</pub-id></mixed-citation>
    </ref>
    <ref id="B19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Henderson</surname><given-names>C.R.</given-names></string-name></person-group><article-title>A simple method for computing the inverse of a numerator relationship matrix used in prediction of breeding values</article-title>. <source>Biometrics</source>. <year>1976</year>; <volume>32</volume>:<fpage>69</fpage>–<lpage>83</lpage>.</mixed-citation>
    </ref>
    <ref id="B20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Misztal</surname><given-names>I.</given-names></string-name>, <string-name><surname>Perez-Enciso</surname><given-names>M.</given-names></string-name></person-group><article-title>Sparse matrix inversion for restricted maximum likelihood estimation of variance components by expectation-maximization</article-title>. <source>J. Dairy Sci.</source><year>1993</year>; <volume>76</volume>:<fpage>1479</fpage>–<lpage>1483</lpage>.</mixed-citation>
    </ref>
    <ref id="B21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Perez-Enciso</surname><given-names>M.</given-names></string-name></person-group><article-title>FSPAK: An interface for public domain sparse matrix subroutines</article-title>. <source>Proceedings of the 5th World Congress on Genetics Applied to Livestock Production, 1994</source>. <year>1994</year>; <volume>22</volume>:<fpage>87</fpage>–<lpage>88</lpage>.</mixed-citation>
    </ref>
    <ref id="B22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>VanRaden</surname><given-names>P.M.</given-names></string-name></person-group><article-title>Efficient methods to compute genomic predictions</article-title>. <source>J. Dairy Sci.</source><year>2008</year>; <volume>91</volume>:<fpage>4414</fpage>–<lpage>4423</lpage>.<pub-id pub-id-type="pmid">18946147</pub-id></mixed-citation>
    </ref>
    <ref id="B23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>J.</given-names></string-name>, <string-name><surname>Benyamin</surname><given-names>B.</given-names></string-name>, <string-name><surname>McEvoy</surname><given-names>B.P.</given-names></string-name>, <string-name><surname>Gordon</surname><given-names>S.</given-names></string-name>, <string-name><surname>Henders</surname><given-names>A.K.</given-names></string-name>, <string-name><surname>Nyholt</surname><given-names>D.R.</given-names></string-name>, <string-name><surname>Madden</surname><given-names>P.A.</given-names></string-name>, <string-name><surname>Heath</surname><given-names>A.C.</given-names></string-name>, <string-name><surname>Martin</surname><given-names>N.G.</given-names></string-name>, <string-name><surname>Montgomery</surname><given-names>G.W.</given-names></string-name></person-group><article-title>Common snps explain a large proportion of the heritability for human height</article-title>. <source>Nat. Genet.</source><year>2010</year>; <volume>42</volume>:<fpage>565</fpage>–<lpage>569</lpage>.<pub-id pub-id-type="pmid">20562875</pub-id></mixed-citation>
    </ref>
    <ref id="B24">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vitezica</surname><given-names>Z.G.</given-names></string-name>, <string-name><surname>Legarra</surname><given-names>A.</given-names></string-name>, <string-name><surname>Toro</surname><given-names>M.A.</given-names></string-name>, <string-name><surname>Varona</surname><given-names>L.</given-names></string-name></person-group><article-title>Orthogonal estimates of variances for additive, dominance, and epistatic effects in populations</article-title>. <source>Genetics</source>. <year>2017</year>; <volume>206</volume>:<fpage>1297</fpage>–<lpage>1307</lpage>.<pub-id pub-id-type="pmid">28522540</pub-id></mixed-citation>
    </ref>
    <ref id="B25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Christensen</surname><given-names>O.F.</given-names></string-name>, <string-name><surname>Lund</surname><given-names>M.S.</given-names></string-name></person-group><article-title>Genomic prediction when some animals are not genotyped</article-title>. <source>Genet. Sel. Evol.</source><year>2010</year>; <volume>42</volume>:<fpage>2</fpage>.<pub-id pub-id-type="pmid">20105297</pub-id></mixed-citation>
    </ref>
    <ref id="B26">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aguilar</surname><given-names>I.</given-names></string-name>, <string-name><surname>Misztal</surname><given-names>I.</given-names></string-name>, <string-name><surname>Johnson</surname><given-names>D.</given-names></string-name>, <string-name><surname>Legarra</surname><given-names>A.</given-names></string-name>, <string-name><surname>Tsuruta</surname><given-names>S.</given-names></string-name>, <string-name><surname>Lawlor</surname><given-names>T.</given-names></string-name></person-group><article-title>Hot topic: a unified approach to utilize phenotypic, full pedigree, and genomic information for genetic evaluation of Holstein final score</article-title>. <source>J. Dairy Sci.</source><year>2010</year>; <volume>93</volume>:<fpage>743</fpage>–<lpage>752</lpage>.<pub-id pub-id-type="pmid">20105546</pub-id></mixed-citation>
    </ref>
    <ref id="B27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Masuda</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Aguilar</surname><given-names>I.</given-names></string-name>, <string-name><surname>Tsuruta</surname><given-names>S.</given-names></string-name>, <string-name><surname>Misztal</surname><given-names>I.</given-names></string-name></person-group><article-title>Acceleration of sparse operations for average-information REML analyses with supernodal methods and sparse-storage refinements</article-title>. <source>J. Anim. Sci.</source><year>2015</year>; <volume>93</volume>:<fpage>4670</fpage>–<lpage>4674</lpage>.<pub-id pub-id-type="pmid">26523559</pub-id></mixed-citation>
    </ref>
    <ref id="B28">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ng</surname><given-names>E.</given-names></string-name>, <string-name><surname>Peyton</surname><given-names>B.W.</given-names></string-name></person-group><article-title>A supernodal Cholesky factorization algorithm for shared-memory multiprocessors</article-title>. <source>SIAM J. Sci. Comput.</source><year>1993</year>; <volume>14</volume>:<fpage>761</fpage>–<lpage>769</lpage>.</mixed-citation>
    </ref>
    <ref id="B29">
      <label>29.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Takahashi</surname><given-names>K.</given-names></string-name>, <string-name><surname>Fagan</surname><given-names>J.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>M.S.</given-names></string-name></person-group><article-title>Formation of sparse bus impedance matrix and its application to short circuit study</article-title>. <source>8th Power Industry Computer Application Conference Proceedings</source>. <year>1973</year>; <fpage>63</fpage>–<lpage>69</lpage>.<comment>IEEE Power Engineering Society</comment>.</mixed-citation>
    </ref>
    <ref id="B30">
      <label>30.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Campbell</surname><given-names>Y.E.</given-names></string-name></person-group><article-title>Multifrontal algorithms for sparse inverse subsets and incomplete LU factorization</article-title>. <source>Computer and Information Science and Engineering Department</source>. <year>1995</year>; <publisher-name>University of Florida</publisher-name><comment>Also CISE Technical Report TR-95-025</comment>.</mixed-citation>
    </ref>
    <ref id="B31">
      <label>31.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Misztal</surname><given-names>I.</given-names></string-name>, <string-name><surname>Legarra</surname><given-names>A.</given-names></string-name>, <string-name><surname>Aguilar</surname><given-names>I.</given-names></string-name></person-group><article-title>Using recursion to compute the inverse of the genomic relationship matrix</article-title>. <source>J. Dairy Sci.</source><year>2014</year>; <volume>97</volume>:<fpage>3943</fpage>–<lpage>3952</lpage>.<pub-id pub-id-type="pmid">24679933</pub-id></mixed-citation>
    </ref>
    <ref id="B32">
      <label>32.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Abdollahi-Arpanahi</surname><given-names>R.</given-names></string-name>, <string-name><surname>Lourenco</surname><given-names>D.</given-names></string-name>, <string-name><surname>Misztal</surname><given-names>I.</given-names></string-name></person-group><article-title>A comprehensive study on size and definition of the core group in the proven and young algorithm for single-step GBLUP</article-title>. <source>Genet. Sel. Evol.</source><year>2022</year>; <volume>54</volume>:<fpage>34</fpage>.<pub-id pub-id-type="pmid">35596130</pub-id></mixed-citation>
    </ref>
    <ref id="B33">
      <label>33.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Junqueira</surname><given-names>V.S.</given-names></string-name>, <string-name><surname>Lourenco</surname><given-names>D.</given-names></string-name>, <string-name><surname>Masuda</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Cardoso</surname><given-names>F.F.</given-names></string-name>, <string-name><surname>Lopes</surname><given-names>P.S.</given-names></string-name>, <string-name><surname>Silva</surname><given-names>F.F.</given-names></string-name>, <string-name><surname>Misztal</surname><given-names>I.</given-names></string-name></person-group><article-title>Is single-step genomic REML with the algorithm for proven and young more computationally efficient when less generations of data are present?</article-title>. <source>J. Anim. Sci.</source><year>2022</year>; <volume>100</volume>:<fpage>skac082</fpage>.<pub-id pub-id-type="pmid">35289906</pub-id></mixed-citation>
    </ref>
    <ref id="B34">
      <label>34.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Harville</surname><given-names>D.A.</given-names></string-name></person-group><article-title>Maximum likelihood approaches to variance component estimation and to related problems</article-title>. <source>J. Am. Stat. Assoc.</source><year>1977</year>; <volume>72</volume>:<fpage>320</fpage>–<lpage>338</lpage>.</mixed-citation>
    </ref>
    <ref id="B35">
      <label>35.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lee</surname><given-names>S.H.</given-names></string-name>, <string-name><surname>Van der Werf</surname><given-names>J.H.</given-names></string-name></person-group><article-title>MTG2: an efficient algorithm for multivariate linear mixed model analysis based on genomic information</article-title>. <source>Bioinformatics</source>. <year>2016</year>; <volume>32</volume>:<fpage>1420</fpage>–<lpage>1422</lpage>.<pub-id pub-id-type="pmid">26755623</pub-id></mixed-citation>
    </ref>
    <ref id="B36">
      <label>36.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jiang</surname><given-names>L.</given-names></string-name>, <string-name><surname>Zheng</surname><given-names>Z.</given-names></string-name>, <string-name><surname>Qi</surname><given-names>T.</given-names></string-name>, <string-name><surname>Kemper</surname><given-names>K.E.</given-names></string-name>, <string-name><surname>Wray</surname><given-names>N.R.</given-names></string-name>, <string-name><surname>Visscher</surname><given-names>P.M.</given-names></string-name>, <string-name><surname>Yang</surname><given-names>J.</given-names></string-name></person-group><article-title>A resource-efficient tool for mixed model association analysis of large-scale data</article-title>. <source>Nat. Genet.</source><year>2019</year>; <volume>51</volume>:<fpage>1749</fpage>–<lpage>1755</lpage>.<pub-id pub-id-type="pmid">31768069</pub-id></mixed-citation>
    </ref>
    <ref id="B37">
      <label>37.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Haseman</surname><given-names>J.</given-names></string-name>, <string-name><surname>Elston</surname><given-names>R.</given-names></string-name></person-group><article-title>The investigation of linkage between a quantitative trait and a marker locus</article-title>. <source>Behav. Genet.</source><year>1972</year>; <volume>2</volume>:<fpage>3</fpage>–<lpage>19</lpage>.<pub-id pub-id-type="pmid">4157472</pub-id></mixed-citation>
    </ref>
    <ref id="B38">
      <label>38.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>J.</given-names></string-name>, <string-name><surname>Zeng</surname><given-names>J.</given-names></string-name>, <string-name><surname>Goddard</surname><given-names>M.E.</given-names></string-name>, <string-name><surname>Wray</surname><given-names>N.R.</given-names></string-name>, <string-name><surname>Visscher</surname><given-names>P.M.</given-names></string-name></person-group><article-title>Concepts, estimation and interpretation of SNP-based heritability</article-title>. <source>Nat. Genet.</source><year>2017</year>; <volume>49</volume>:<fpage>1304</fpage>–<lpage>1310</lpage>.<pub-id pub-id-type="pmid">28854176</pub-id></mixed-citation>
    </ref>
    <ref id="B39">
      <label>39.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Misztal</surname><given-names>I.</given-names></string-name></person-group><article-title>Reliable computing in estimation of variance components</article-title>. <source>J. Anim. Breed. Genet.</source><year>2008</year>; <volume>125</volume>:<fpage>363</fpage>–<lpage>370</lpage>.<pub-id pub-id-type="pmid">19134071</pub-id></mixed-citation>
    </ref>
    <ref id="B40">
      <label>40.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sanderson</surname><given-names>C.</given-names></string-name>, <string-name><surname>Curtin</surname><given-names>R.</given-names></string-name></person-group><article-title>Armadillo: a template-based C++ library for linear algebra</article-title>. <source>J. Open Source Software</source>. <year>2016</year>; <volume>1</volume>:<fpage>26</fpage>.</mixed-citation>
    </ref>
    <ref id="B41">
      <label>41.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Sanderson</surname><given-names>C.</given-names></string-name>, <string-name><surname>Curtin</surname><given-names>R.</given-names></string-name></person-group><person-group person-group-type="editor"><string-name><surname>Davenport</surname><given-names>J.</given-names></string-name>, <string-name><surname>Kauers</surname><given-names>M.</given-names></string-name>, <string-name><surname>Labahn</surname><given-names>G.</given-names></string-name>, <string-name><surname>Urban</surname><given-names>J.</given-names></string-name></person-group><article-title>A user-friendly hybrid sparse matrix class in C++</article-title>. <source>Mathematical Software–ICMS 2018: 6th International Conference</source>. <year>2018</year>; <volume>10931</volume>:<publisher-loc>Cham</publisher-loc><publisher-name>Springer International Publishing</publisher-name><fpage>422</fpage>–<lpage>430</lpage>.</mixed-citation>
    </ref>
    <ref id="B42">
      <label>42.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>J.</given-names></string-name>, <string-name><surname>Lee</surname><given-names>S.H.</given-names></string-name>, <string-name><surname>Goddard</surname><given-names>M.E.</given-names></string-name>, <string-name><surname>Visscher</surname><given-names>P.M.</given-names></string-name></person-group><article-title>GCTA: a tool for genome-wide complex trait analysis</article-title>. <source>Am. J. Hum. Genet.</source><year>2011</year>; <volume>88</volume>:<fpage>76</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">21167468</pub-id></mixed-citation>
    </ref>
    <ref id="B43">
      <label>43.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Speed</surname><given-names>D.</given-names></string-name>, <string-name><surname>Hemani</surname><given-names>G.</given-names></string-name>, <string-name><surname>Johnson</surname><given-names>M.R.</given-names></string-name>, <string-name><surname>Balding</surname><given-names>D.J.</given-names></string-name></person-group><article-title>Improved heritability estimation from genome-wide SNPs</article-title>. <source>Am. J. Hum. Genet.</source><year>2012</year>; <volume>91</volume>:<fpage>1011</fpage>–<lpage>1021</lpage>.<pub-id pub-id-type="pmid">23217325</pub-id></mixed-citation>
    </ref>
    <ref id="B44">
      <label>44.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Covarrubias-Pazaran</surname><given-names>G.</given-names></string-name></person-group><article-title>Genome-assisted prediction of quantitative traits using the R package sommer</article-title>. <source>PLoS One</source>. <year>2016</year>; <volume>11</volume>:<fpage>e0156744</fpage>.<pub-id pub-id-type="pmid">27271781</pub-id></mixed-citation>
    </ref>
    <ref id="B45">
      <label>45.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>H.</given-names></string-name>, <string-name><surname>Su</surname><given-names>G.</given-names></string-name></person-group><article-title>Impact of phenotypic information of previous generations and depth of pedigree on estimates of genetic parameters and breeding values</article-title>. <source>Livestock Sci.</source><year>2016</year>; <volume>187</volume>:<fpage>61</fpage>–<lpage>67</lpage>.</mixed-citation>
    </ref>
    <ref id="B46">
      <label>46.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Atkin</surname><given-names>F.C.</given-names></string-name>, <string-name><surname>Dieters</surname><given-names>M.J.</given-names></string-name>, <string-name><surname>Stringer</surname><given-names>J.K.</given-names></string-name></person-group><article-title>Impact of depth of pedigree and inclusion of historical data on the estimation of additive variance and breeding values in a sugarcane breeding program</article-title>. <source>Theor. Appl. Genet.</source><year>2009</year>; <volume>119</volume>:<fpage>555</fpage>–<lpage>565</lpage>.<pub-id pub-id-type="pmid">19597798</pub-id></mixed-citation>
    </ref>
    <ref id="B47">
      <label>47.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pocrnic</surname><given-names>I.</given-names></string-name>, <string-name><surname>Lourenco</surname><given-names>D.</given-names></string-name>, <string-name><surname>Bradford</surname><given-names>H.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>C.</given-names></string-name>, <string-name><surname>Misztal</surname><given-names>I</given-names></string-name></person-group><article-title>Impact of pedigree depth on convergence of single-step genomic BLUP in a purebred swine population</article-title>. <source>J. Anim. Sci.</source><year>2017</year>; <volume>95</volume>:<fpage>3391</fpage>–<lpage>3395</lpage>.<pub-id pub-id-type="pmid">28805917</pub-id></mixed-citation>
    </ref>
    <ref id="B48">
      <label>48.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Su</surname><given-names>G.</given-names></string-name>, <string-name><surname>Christensen</surname><given-names>O.F.</given-names></string-name>, <string-name><surname>Ostersen</surname><given-names>T.</given-names></string-name>, <string-name><surname>Henryon</surname><given-names>M.</given-names></string-name>, <string-name><surname>Lund</surname><given-names>M.S.</given-names></string-name></person-group><article-title>Estimating additive and non-additive genetic variances and predicting genetic merits using genome-wide dense single nucleotide polymorphism markers</article-title>. <source>PLoS One</source>. <year>2012</year>; <volume>7</volume>:<fpage>e45293</fpage>.<pub-id pub-id-type="pmid">23028912</pub-id></mixed-citation>
    </ref>
    <ref id="B49">
      <label>49.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aliloo</surname><given-names>H.</given-names></string-name>, <string-name><surname>Pryce</surname><given-names>J.</given-names></string-name>, <string-name><surname>González-Recio</surname><given-names>O.</given-names></string-name>, <string-name><surname>Cocks</surname><given-names>B.</given-names></string-name>, <string-name><surname>Goddard</surname><given-names>M.</given-names></string-name>, <string-name><surname>Hayes</surname><given-names>B.</given-names></string-name></person-group><article-title>Including nonadditive genetic effects in mating programs to maximize dairy farm profitability</article-title>. <source>J. Dairy Sci.</source><year>2017</year>; <volume>100</volume>:<fpage>1203</fpage>–<lpage>1222</lpage>.<pub-id pub-id-type="pmid">27939540</pub-id></mixed-citation>
    </ref>
    <ref id="B50">
      <label>50.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hay</surname><given-names>E.H.A.</given-names></string-name>, <string-name><surname>Utsunomiya</surname><given-names>Y.T.</given-names></string-name>, <string-name><surname>Xu</surname><given-names>L.</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Neves</surname><given-names>H.H.</given-names></string-name>, <string-name><surname>Carvalheiro</surname><given-names>R.</given-names></string-name>, <string-name><surname>Bickhart</surname><given-names>D.M.</given-names></string-name>, <string-name><surname>Ma</surname><given-names>L.</given-names></string-name>, <string-name><surname>Garcia</surname><given-names>J.F.</given-names></string-name>, <string-name><surname>Liu</surname><given-names>G.E.</given-names></string-name></person-group><article-title>Genomic predictions combining SNP markers and copy number variations in Nellore cattle</article-title>. <source>BMC Genomics</source>. <year>2018</year>; <volume>19</volume>:<fpage>441</fpage>.<pub-id pub-id-type="pmid">29871610</pub-id></mixed-citation>
    </ref>
    <ref id="B51">
      <label>51.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>L.</given-names></string-name>, <string-name><surname>Pryce</surname><given-names>J.E.</given-names></string-name>, <string-name><surname>Hayes</surname><given-names>B.J.</given-names></string-name>, <string-name><surname>Daetwyler</surname><given-names>H.D.</given-names></string-name></person-group><article-title>Investigating the effect of imputed structural variants from whole-genome sequence on genome-wide association and genomic prediction in dairy cattle</article-title>. <source>Animals</source>. <year>2021</year>; <volume>11</volume>:<fpage>541</fpage>.<pub-id pub-id-type="pmid">33669735</pub-id></mixed-citation>
    </ref>
    <ref id="B52">
      <label>52.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Martini</surname><given-names>J.W.</given-names></string-name>, <string-name><surname>Gao</surname><given-names>N.</given-names></string-name>, <string-name><surname>Crossa</surname><given-names>J.</given-names></string-name></person-group><article-title>Incorporating omics data in genomic prediction</article-title>. <source>Methods Mol. Biol.</source><year>2022</year>; <volume>2467</volume>:<fpage>341</fpage>–<lpage>357</lpage>.<pub-id pub-id-type="pmid">35451782</pub-id></mixed-citation>
    </ref>
    <ref id="B53">
      <label>53.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ye</surname><given-names>S.</given-names></string-name>, <string-name><surname>Li</surname><given-names>J.</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>Z.</given-names></string-name></person-group><article-title>Multi-omics-data-assisted genomic feature markers preselection improves the accuracy of genomic prediction</article-title>. <source>J. Anim. Sci. Biotechnol.</source><year>2020</year>; <volume>11</volume>:<fpage>109</fpage>.<pub-id pub-id-type="pmid">33292577</pub-id></mixed-citation>
    </ref>
    <ref id="B54">
      <label>54.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhou</surname><given-names>X.</given-names></string-name>, <string-name><surname>Im</surname><given-names>H.K.</given-names></string-name>, <string-name><surname>Lee</surname><given-names>S.H.</given-names></string-name></person-group><article-title>CORE GREML for estimating covariance between random effects in linear mixed models for complex trait analyses</article-title>. <source>Nat. Commun.</source><year>2020</year>; <volume>11</volume>:<fpage>4208</fpage>.<pub-id pub-id-type="pmid">32826890</pub-id></mixed-citation>
    </ref>
    <ref id="B55">
      <label>55.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bulik-Sullivan</surname><given-names>B.K.</given-names></string-name>, <string-name><surname>Loh</surname><given-names>P.-R.</given-names></string-name>, <string-name><surname>Finucane</surname><given-names>H.K.</given-names></string-name>, <string-name><surname>Ripke</surname><given-names>S.</given-names></string-name>, <string-name><surname>Yang</surname><given-names>J.</given-names></string-name>, <string-name><surname>Patterson</surname><given-names>N.</given-names></string-name>, <string-name><surname>Daly</surname><given-names>M.J.</given-names></string-name>, <string-name><surname>Price</surname><given-names>A.L.</given-names></string-name>, <string-name><surname>Neale</surname><given-names>B.M.</given-names></string-name></person-group><article-title>LD score regression distinguishes confounding from polygenicity in genome-wide association studies</article-title>. <source>Nat. Genet.</source><year>2015</year>; <volume>47</volume>:<fpage>291</fpage>–<lpage>295</lpage>.<pub-id pub-id-type="pmid">25642630</pub-id></mixed-citation>
    </ref>
    <ref id="B56">
      <label>56.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Robinson</surname><given-names>M.R.</given-names></string-name>, <string-name><surname>Kleinman</surname><given-names>A.</given-names></string-name>, <string-name><surname>Graff</surname><given-names>M.</given-names></string-name>, <string-name><surname>Vinkhuyzen</surname><given-names>A.A.</given-names></string-name>, <string-name><surname>Couper</surname><given-names>D.</given-names></string-name>, <string-name><surname>Miller</surname><given-names>M.B.</given-names></string-name>, <string-name><surname>Peyrot</surname><given-names>W.J.</given-names></string-name>, <string-name><surname>Abdellaoui</surname><given-names>A.</given-names></string-name>, <string-name><surname>Zietsch</surname><given-names>B.P.</given-names></string-name>, <string-name><surname>Nolte</surname><given-names>I.M.</given-names></string-name></person-group><article-title>Genetic evidence of assortative mating in humans</article-title>. <source>Nat. Hum. Behav.</source><year>2017</year>; <volume>1</volume>:<fpage>0016</fpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
