<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5570176</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkx391</article-id>
    <article-id pub-id-type="publisher-id">gkx391</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Web Server Issue</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>GeSeq – versatile and accurate annotation of organelle genomes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Tillich</surname>
          <given-names>Michael</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lehwark</surname>
          <given-names>Pascal</given-names>
        </name>
        <xref ref-type="aff" rid="AFF2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pellizzer</surname>
          <given-names>Tommaso</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ulbricht-Jones</surname>
          <given-names>Elena S.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fischer</surname>
          <given-names>Axel</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-7502-6940</contrib-id>
        <name>
          <surname>Bock</surname>
          <given-names>Ralph</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Greiner</surname>
          <given-names>Stephan</given-names>
        </name>
        <!--<email>greiner@mpimp-golm.mpg.de</email>-->
        <xref ref-type="aff" rid="AFF1">1</xref>
        <xref ref-type="corresp" rid="COR1"/>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><label>1</label>Max-Planck-Institut für Molekulare Pflanzenphysiologie, Am Mühlenberg 1, D-14476 Potsdam-Golm, Germany</aff>
    <aff id="AFF2"><label>2</label>Glogauer Straße 31, D-10999 Berlin, Germany</aff>
    <author-notes>
      <corresp id="COR1"><label>*</label>To whom correspondence should be addressed. Tel: +49 331 567 8349; Fax: +49 331 567 8701; Email: <email>greiner@mpimp-golm.mpg.de</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>03</day>
      <month>7</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2017-05-09">
      <day>09</day>
      <month>5</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>09</day>
      <month>5</month>
      <year>2017</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>45</volume>
    <issue>Web Server issue</issue>
    <fpage>W6</fpage>
    <lpage>W11</lpage>
    <history>
      <date date-type="accepted">
        <day>27</day>
        <month>4</month>
        <year>2017</year>
      </date>
      <date date-type="rev-recd">
        <day>13</day>
        <month>4</month>
        <year>2017</year>
      </date>
      <date date-type="received">
        <day>03</day>
        <month>3</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2017. Published by Oxford University Press on behalf of Nucleic Acids Research.</copyright-statement>
      <copyright-year>2017</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<uri xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</uri>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact <email>journals.permissions@oup.com</email></license-p>
      </license>
    </permissions>
    <self-uri xlink:href="gkx391.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>We have developed the web application GeSeq (<ext-link ext-link-type="uri" xlink:href="https://chlorobox.mpimp-golm.mpg.de/geseq.html">https://chlorobox.mpimp-golm.mpg.de/geseq.html</ext-link>) for the rapid and accurate annotation of organellar genome sequences, in particular chloroplast genomes. In contrast to existing tools, GeSeq combines batch processing with a fully customizable reference sequence selection of organellar genome records from NCBI and/or references uploaded by the user. For the annotation of chloroplast genomes, the application additionally provides an integrated database of manually curated reference sequences. GeSeq identifies genes or other feature-encoding regions by BLAT-based homology searches and additionally, by profile HMM searches for protein and rRNA coding genes and two <italic>de novo</italic> predictors for tRNA genes. These unique features enable the user to conveniently compare the annotations of different state-of-the-art methods, thus supporting high-quality annotations. The main output of GeSeq is a GenBank file that usually requires only little curation and is instantly visualized by OGDRAW. GeSeq also offers a variety of optional additional outputs that facilitate downstream analyzes, for example comparative genomic or phylogenetic studies.</p>
    </abstract>
    <counts>
      <page-count count="6"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>INTRODUCTION</title>
    <p>Next-generation sequencing (NGS) technologies have led to a burst in the availability of organellar genome sequences (<xref rid="B1" ref-type="bibr">1</xref>). However, sequence annotation is still a major bottleneck. Four tools for (semi-)automated annotation of organellar genomes are currently available, but all of these programs suffer from limited customizability of reference sequences by the user. This does not only prevent annotation of a subset of organellar genomes or custom features, but also precludes the user from taking advantage of any proprietary high-quality references. Mitofy (<xref rid="B2" ref-type="bibr">2</xref>) was developed for the annotation of plant mitochondrial sequences only, whereas CpGAVAS (<xref rid="B3" ref-type="bibr">3</xref>) and Verdant (<xref rid="B4" ref-type="bibr">4</xref>) solely annotate chloroplast genomes. DOGMA (<xref rid="B5" ref-type="bibr">5</xref>) annotates chloroplast and animal mitochondrial sequences, but no plant mitochondrial genomes. In addition to restrictions in reference selection, none of these tools provide a manually curated reference sequences database, take RNA editing into account or allow the user to directly compare annotations based on different methods like BLAST/BLAT and HMMER and different <italic>de novo</italic> tRNA prediction algorithms.</p>
    <p>Here, we present GeSeq, a web-based annotation tool for the annotation of organellar sequences. The program was developed for plants. With an appropriate reference set, however, it also annotates mitochondria genomes from non-green species, such as mammals. Even entire plasmid collections can be annotated using GeSeq, although we have not tested the tool rigorously outside the plant lineage. GeSeq produces high-quality annotations in short runtime, is highly customizable and accepts batch submissions. GeSeq's functions are integrated in an easy-to-use GUI and with its high flexibility it will meet the demands of most annotation jobs. For high-quality annotation of chloroplast genomes, GeSeq is equipped with manually curated reference sequences and a corresponding profile hidden Markov model (profile HMM) database for chloroplast protein and rRNA-coding genes.</p>
    <p>Aside of the ‘classical’ annotation job, the annotation of a complete organellar genomes or genome segments, GeSeq can be easily adjusted to annotate multiple sequences derived from NGS contigs, generate codon-based alignments for specific genes or, when supplemented with additional references, used for any other (smaller) DNA sequence. This allows, for instance, quick annotations for verifying contigs of <italic>de novo</italic> assemblies and/or to map primer-binding sites for gap closure.</p>
  </sec>
  <sec id="SEC2">
    <title>RESULTS AND DISCUSSION</title>
    <sec id="SEC2-1">
      <title>Implementation</title>
      <p>GeSeq is written in Java and PHP. It features parallel (multi-threaded) job processing and user management. The front end is a user-friendly web interface implemented in Javascript (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S1A</xref>). It was tested with the current versions of Firefox, Chrome, Safari, Internet Explorer and Edge. GeSeq uses the third-party software tRNAscan-SE v1.3.1 (<xref rid="B6" ref-type="bibr">6</xref>), ARAGORN v1.2.36 (<xref rid="B7" ref-type="bibr">7</xref>), BLAT (Standalone BLAT v.35 × 1; <xref rid="B8" ref-type="bibr">8</xref>), OGDRAW v1.2 (<xref rid="B9" ref-type="bibr">9</xref>,<xref rid="B10" ref-type="bibr">10</xref>), TranslatorX v1.1 (<xref rid="B11" ref-type="bibr">11</xref>), MUSCLE v3.8.31 (<xref rid="B12" ref-type="bibr">12</xref>,<xref rid="B13" ref-type="bibr">13</xref>) and HMMER (<xref rid="B14" ref-type="bibr">14</xref>). The GeSeq application is part of the CHLOROBOX toolbox (<ext-link ext-link-type="uri" xlink:href="https://chlorobox.mpimp-golm.mpg.de/index.html">https://chlorobox.mpimp-golm.mpg.de/index.html</ext-link>) hosted at the Max Planck Institute of Molecular Plant Physiology (Potsdam-Golm, Germany). With ‘GenBank 2 Sequin’ (<ext-link ext-link-type="uri" xlink:href="https://chlorobox.mpimp-golm.mpg.de/GenBank2Sequin.html">https://chlorobox.mpimp-golm.mpg.de/GenBank2Sequin.html</ext-link>), the CHLOROBOX offers an accompanying program to convert revised GenBank files generated by GeSeq into the Sequin or BankIt format required for NCBI/EMBL/DDBJ database submission.</p>
    </sec>
    <sec id="SEC2-2">
      <title>Sequence submission</title>
      <p>Nucleic acid sequences for annotation must be provided in (multi-)FASTA format (<ext-link ext-link-type="uri" xlink:href="http://blast.ncbi.nlm.nih.gov/blastcgihelp.shtml">http://blast.ncbi.nlm.nih.gov/blastcgihelp.shtml</ext-link>). All sequence letters not complying with the IUPAC code (<xref rid="B15" ref-type="bibr">15</xref>), including gaps, will be removed and ‘U's of RNA sequences converted to ‘T's. Each input sequence for annotation is treated as independent job. Activation of ‘Circular sequence(s)’ enables annotation of genes or features that span the ends of the submitted linear sequence. GeSeq will simulate a circular sequence by appending a copy of up to the first 10 000 bp to the end of the submitted sequence.</p>
    </sec>
    <sec id="SEC2-3">
      <title>Reference selection</title>
      <p>GeSeq offers the user to freely select or upload the most appropriate reference sequences for each annotation project and provides a manually curated reference sequences set for chloroplast genomes.</p>
      <sec id="SEC2-3-1">
        <title>NCBI Reference Sequence (NCBI RefSeq)</title>
        <p>GeSeq is equipped with a local copy of the organelle genome records of the NCBI RefSeq project (<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/genome/organelle/">http://www.ncbi.nlm.nih.gov/genome/organelle/</ext-link>). The hosted NCBI RefSeq records are monthly updated and visualized as a phylogenetic tree, searchable by free text (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S1B</xref>). However, we strongly encourage the user to ascertain the annotation quality of the NCBI references before use (see below).</p>
      </sec>
      <sec id="SEC2-3-2">
        <title>MPI-MP chloroplast reference set</title>
        <p>During this work, we frequently encountered apparent annotation errors in NCBI RefSeq entries. These include unexpected truncations or extensions of genes or likely misannotated exon–intron borders. In order to provide GeSeq with a high-quality reference set of plastid sequences, we selected the complete plastid genomes of 34 plant species spanning the full taxonomic range from mosses to seed plants, with a focus on the latter (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref>). We then generated multiple alignments for each protein and rRNA-coding gene and manually curated these alignments (for examples, see Figure <xref ref-type="fig" rid="F1">1</xref>). Since for many of the 34 species, no experimental validation of gene or exon–intron annotation was available, manual curation was guided by data from organisms intensely studied with respect to chloroplast gene expression, like <italic>Arabidopsis thaliana, Nicotiana tabacum, Oenothera elata</italic> and <italic>Zea mays</italic>.</p>
        <fig id="F1" orientation="portrait" position="float">
          <label>Figure 1.</label>
          <caption>
            <p>Examples for a likely mis-annotated gene in some (provisional) NCBI Reference Sequence (NCBI RefSeq) entries encountered during this work. Exon–exon junction of the chloroplast <italic>rpl2</italic> gene as translated from NCBI RefSeq CDS entries (left) and comparison with the corresponding entries in the GeSeq internal reference sequences database (right; see <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref> for GeSeq names and GenBank IDs). Suspected annotation errors are labeled in black. Some NCBI RefSeq records lack annotation of given genes (‘no annotation’, cf. <italic>Brassica rapa</italic>) or introns resulting in no or truncated CDS (<italic>Oryza sativa</italic> ssp<italic>. indica</italic> and <italic>Saccharum</italic>), respectively. Inconsistent exon borders result in likely erroneous insertions or deletions of one or several codons (<italic>Ginkgo biloba, Medicago truncatula, Ricinus communis, Sorghum bicolor</italic> and <italic>Selaginella moellendorffii</italic>).</p>
          </caption>
          <graphic xlink:href="gkx391fig1"/>
        </fig>
        <p>Users are invited to donate references sets, for example for mammalian or fugal mitochondrial genomes, or algal chloroplasts.</p>
      </sec>
      <sec id="SEC2-3-3">
        <title>Custom references</title>
        <p>In addition to the above described server-hosted references, the user can upload (multi-)FASTA or (multi-)GenBank files containing custom reference sets. This does not only enable the user to take advantage of proprietary high-quality references, but also to add custom annotations like origins of replication or ‘foreign’ features like primer or protein-binding sites.</p>
      </sec>
    </sec>
    <sec id="SEC2-4">
      <title>Annotation pipeline</title>
      <p>The GeSeq core annotation pipeline is based on a BLAT-driven best-match approach. This is complemented by additional profile HMM searches for protein and rRNA-coding genes and <italic>de novo</italic> prediction of tRNA genes (Figure <xref ref-type="fig" rid="F2">2</xref>). We decided in favor of a best-match and against a (more sensitive) profile HMMs-based approach for the core annotation pipeline because we prioritized a free selection of reference sequences by the user. Generation of high-quality profile HMMs requires high-quality multiple alignments, ideally manually curated (<ext-link ext-link-type="uri" xlink:href="http://hmmer.org/documentation.html">http://hmmer.org/documentation.html</ext-link>), which is incompatible with a highly flexible and readily extendable reference selection system. In order to still take advantage of profile HMM searches, we built profile HMM databases for plastid protein and rRNA-coding genes (see above). Thus, the user can benefit from both free reference selection and profile HMMs searches. We selected BLAT as sequence similarity search tool, because it runs fast and provides an accurate annotation of exon–intron borders.</p>
      <fig id="F2" orientation="portrait" position="float">
        <label>Figure 2.</label>
        <caption>
          <p>GeSeq annotation pipeline. The user provides nucleic acid FASTA sequence(s) for annotation and selects or provides reference nucleic acid sequences in GenBank or FASTA format (‘User Input’). Based on the selected or uploaded reference sequences (‘References’), GeSeq builds a non-protein-coding (rRNA, tRNA and DNA) and a protein-coding (CDS) BLAT database, carries out standard (‘BLATn’) and translated BLAT (‘BLATx’) searches, respectively, and filters the hits (‘Hit Filter’). GeSeq annotates from the filtered hits the classes rRNA, tRNA, CDS and gene (‘gene entries’). ‘Gene entries’ result from tRNA, rRNA and CDS hits, and include introns (if present). DNA hits are annotated as ‘misc_features’ (as shown here) or, alternatively, as ‘primer_bind’ if invoked by the user (see text for details). In addition, the user can activate an nhmmer search by selecting profile HMMs of CDS and rRNA sequences (currently chloroplast only) as references. All profile HMM hits are annotated as misc_features to support manual curation. Optionally, the user can invoke ARAGORN or tRNAscan-SE for <italic>de novo</italic> annotation of tRNAs and a self-BLATn search for the detection of the inverted repeat (IR) pair typically found in chloroplast genomes. The minimum GeSeq output (all output files are labeled in gray) is a GenBank file that contains all annotations and its interpretation by OGDRAW for a quick evaluation. Additionally, the user can choose additional optional outputs, including separate multi-FASTA files (‘mFASTAs’) containing the annotated sequences belonging to the classes gene, CDS, rRNA and tRNA. If several sequences were uploaded for annotation in the same job, also combined mFASTAs for all annotated sequences of the four classes are offered for download and optionally, codon-based alignments can be produced for all annotated CDS sequences with or without the selected or uploaded GenBank references.</p>
        </caption>
        <graphic xlink:href="gkx391fig2"/>
      </fig>
      <sec id="SEC2-4-1">
        <title>BLAT reference sequence databases</title>
        <p>GeSeq generates two databases for each annotation job: a protein-coding (CDS) and a non-protein-coding (NA) database. The latter may contain rRNA, tRNA and other nucleic acid sequences. GeSeq does not accept protein sequences. The program parses all selected or uploaded GenBank files for CDS, tRNA and rRNA entries, extracts these features and adds them to the corresponding database. The identifiers of extracted sequences are generated by the concatenation of the GenBank qualifier ‘/gene’ with the source GenBank IDs or accession number separated by an underscore (e.g. ‘psaA_AJ271079’).</p>
        <p>Sequences of selected or uploaded CDS or NA FASTA files are added to the appropriate database. Uploaded NA FASTA sequences are flagged as tRNA, rRNA or primer sequences if the FASTA file name starts with ‘tRNA_’, ‘rRNA_’ or ‘primer_’ respectively, and hits will be annotated accordingly (otherwise, hits will be annotated as ‘misc_features’). The sequence identifiers are kept and we recommend the syntax: ‘&gt;gene/feature name_source’ (e.g. ‘&gt;psaA_Oelata’ for the <italic>psaA</italic> gene from <italic>Oenothera elata</italic>). This nomenclature is required for hit filtering and prevents redundant annotation of the same gene or feature by multiple references (see ‘BLAT hit filtering’ below).</p>
      </sec>
      <sec id="SEC2-4-2">
        <title>BLAT hit filtering</title>
        <p>Standard (‘BLATn’) and translated BLAT (‘BLATx’) searches are executed with default parameters (unless the user changes the BLAT minimum identity threshold in GeSeq's GUI) using the collected sequences of the NA and the CDS databases, respectively (Figure <xref ref-type="fig" rid="F2">2</xref>). Activation of the ‘find short matches’ option changes the parameters of the standard BLAT search to allow the detection of short (at least 12 bases) identical matches. This enables the detection of short regulatory elements, like promoters, origins of replication or primer-binding sites, if provided by the user in a custom FASTA file. Then, GeSeq applies a best-match hit filtering to the BLAT outputs in order to avoid multiple annotations of the same gene or feature by different references. For each gene or feature name, GeSeq retains only the hit(s) with the highest score for annotation. In addition, GeSeq retains the second-best, non-overlapping hit(s) for each gene or feature. Such secondary hits will be annotated as ‘gene-’ or ‘feature-fragment(s)’ and usually represent gene fragments resulting from recombination events at direct or inverted repeats (IRs) that are frequently found in plant organellar genomes (<xref rid="B1" ref-type="bibr">1</xref>,<xref rid="B16" ref-type="bibr">16</xref>). <italic>Trans</italic>-spliced genes (such as the chloroplast gene <italic>rps12</italic>) are also annotated that way.</p>
      </sec>
      <sec id="SEC2-4-3">
        <title>HMM search for protein and rRNA-coding genes</title>
        <p>In addition to the BLAT-based core annotation pipeline, a profile HMM search for chloroplast protein and rRNA-coding genes can be invoked. For this, we generated profile HMMs for the manually curated reference set of chloroplast CDS and rRNA sequences and GeSeq executes a standard nhmmer search (Figure <xref ref-type="fig" rid="F2">2</xref>). The resulting hits (envelope coordinates) will be shown as ‘misc_features’ in the output GenBank file. Thus, the user can easily compare the annotations by BLAT with profile HMM hits (Figure <xref ref-type="fig" rid="F3">3</xref>).</p>
        <fig id="F3" orientation="portrait" position="float">
          <label>Figure 3.</label>
          <caption>
            <p>Examples of protein-coding and tRNA gene annotations (green arrows) by GeSeq with high-quality settings visualized by SeqBuilder.v13.0.0 (DNASTAR, Madison, WI, USA). The coordinates of the chloroplast protein-coding genes <italic>psbZ</italic> and <italic>psbC</italic> (only 3΄ end shown) as annotated by BLATx exactly match to their corresponding profile HMM hits (orange arrows). The tRNA gene <italic>trnS</italic> which is annotated in-between the two protein-coding genes by BLATn is confirmed by both <italic>de novo</italic> tRNA predictors tRNAscan-SE and Aragorn (light and dark gray arrows, respectively). See <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S2B</xref> and (C) for the corresponding GenBank file excerpt.</p>
          </caption>
          <graphic xlink:href="gkx391fig3"/>
        </fig>
      </sec>
      <sec id="SEC2-4-4">
        <title>De novo prediction of tRNA genes</title>
        <p>tRNA genes can be additionally predicted <italic>de novo</italic> by the third-party tools tRNAscan-SE and ARAGORN (Figure <xref ref-type="fig" rid="F3">3</xref>). The default parameters are set for the discovery of tRNAs in seed plant chloroplast genomes. Since several tRNA species contain introns, tRNAscan-SE runs in COVE mode (<xref rid="B17" ref-type="bibr">17</xref>), allowing the detection of long introns. In general, search parameters of both tools can be flexibly adjusted to many purposes. Often, the genes for the initiator tRNA <italic>trnfM</italic>-CAU and tRNAs with modified anticodons [such as <italic>trnI</italic>-CAU in chloroplast genomes; (<xref rid="B18" ref-type="bibr">18</xref>)] remain unannotated or can be misannotated by one of the two tRNA discovery programs. The presence of these tRNAs can be verified by the implemented BLATn search for tRNAs in GeSeq.</p>
      </sec>
      <sec id="SEC2-4-5">
        <title>Identification of the chloroplast Inverted Repeat (IR) pair</title>
        <p>GeSeq can annotate the IR pair typically found in chloroplast genomes. If the option ‘Annotate plastid IR’ is activated, the longest, identical IR pair within a submitted sequence is identified from a self-BLATn search (Figure <xref ref-type="fig" rid="F2">2</xref>).</p>
      </sec>
      <sec id="SEC2-4-6">
        <title>Assembly of GenBank files</title>
        <p>The GenBank file generated by GeSeq lists all settings and references used for annotation in the header section (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S2A</xref>). Annotations of genes, rRNAs, tRNAs and CDS are written according to the filtered BLATn and BLATx outputs, including exon–intron positions. This works well for the vast majority of spliced genes. All annotations based on BLAT contain information about the annotated gene and the BLAT hit parameters in ‘/note’ entries (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S2B</xref>). CDS translations are predicted if (i) the length of the annotated CDS is dividable by three, (ii) the CDS starts with ATG, GTG, ACG or TTG, and (iii) the CDS ends with TAG, TGA, TAA, CAG, CGA or CAA. Note that ACG, CAG, CGA and CAA are included, because these triplets can potentially be converted into canonical translational start or stop codons by C-to-U RNA editing which occurs in plant organelles (<xref rid="B19" ref-type="bibr">19</xref>). If ARAGORN or tRNAscan-SE were invoked, predicted tRNAs are annotated accordingly (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S2C</xref>). If ‘Annotate plastid IR’ was enabled, the detected IRs are annotated as ‘repeat_regions’ (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S2D</xref>). Hits based on un-flagged uploaded FASTA files (see above under ‘BLAT reference sequences databases’) or profile HMM hits are annotated as ‘misc_features’.</p>
      </sec>
    </sec>
    <sec id="SEC2-5">
      <title>GeSeq output</title>
      <p>The minimal output of GeSeq consists of a GenBank file for review, manual inspection and editing by the user in a third-party genome browser and its visualization by OGDRAW. For downstream analyses or annotation verification, additional outputs can be provided: First, tRNAs identified by tRNAscan-SE and ARAGON are displayed in separate files. Second, GeSeq can optionally generate multi-FASTA files containing all genes, CDSs, rRNAs and tRNAs found in the sequence(s) submitted for annotation. Third, GeSeq can provide the user with codon-based alignments by TranslatorX and MUSCLE for each CDS identified by GeSeq, optionally including the selected reference sequences, for phylogenetic or other analyses.</p>
    </sec>
  </sec>
  <sec id="SEC3">
    <title>EVALUATION</title>
    <p>GeSeq is a web application for the annotation of organelle genomes. During its development, we have focused on achieving a high annotation quality while maintaining maximum flexibility.</p>
    <p>During extensive testing of GeSeq for the annotation of organelle genomes, we noticed that GeSeq fails to detect extremely short exons (i.e. &lt;8 bp long first exons of the chloroplast genes <italic>petB</italic> and <italic>petD</italic>) and occasionally produces an over-annotation of introns in rapidly evolving genes, like the chloroplast giant open reading frames <italic>ycf1</italic> and <italic>ycf2</italic> (<xref rid="B20" ref-type="bibr">20</xref>). The latter can be easily compensated by decreasing the BLAT protein search identity value. Extraordinarily short exons of few base pairs cannot be detected by a translated BLAT search. To accomplish this, a dedicated pipeline for the detection of such short exons would be required, which would need to include surrounding non-coding bases. However, we decided to stick to a general and uniform annotation approach that is exclusively based on translated searches which are less prone to errors caused by elevated variation occurring at (or biases acting on) non-coding positions or synonymous codon positions. Therefore, these few exceptional exons may require manual curation of the resulting GenBank file during review by the user and we suggest referring to the corresponding hit of the HMMER search for chloroplast genes or by additionally uploading a custom NA FASTA reference file containing the relevant complete gene sequences.</p>
    <p>The high flexibility and versatility of GeSeq facilitates various kinds of annotation jobs, some of which are outlined below:
<list list-type="roman-lower"><list-item><p>Quick annotation of chloroplast genome sequence: we strongly recommend using GeSeq's chloroplast reference set as default. If less genes are annotated than expected and/or if genes are fragmented, selecting or uploading one or several additional NCBI RefSeq files is appropriate. Ideally, these references should be of high annotation quality and represent the most closely related taxa. With a runtime of about 6 s per vascular chloroplast genome (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S2</xref>), GeSeq is currently the fastest tool available. This enables the user to comfortably select appropriate parameters and references by fast trial-and-error test annotations.</p></list-item><list-item><p>High-quality annotation of complete chloroplast genomes: for high-quality annotations, we suggest, in addition to (i), to enable HMMER profile search, tRNA-ScanSE and ARAGORN. This will result in a multi-annotation of protein and rRNA-coding genes by two (BLATx and HMMER) and of tRNA genes by three (BLATn, tRNAscan-SE and ARAGORN) different methods (Figure <xref ref-type="fig" rid="F3">3</xref>). In addition, we recommend to run a quick annotation and use it as template for manual curation.</p></list-item><list-item><p>Annotation of NGS-derived contigs: NGS-derived contigs from a single-sequencing project should be submitted as individual job. All settings for high-quality annotation should be selected and, in addition, the ‘Generate multi-FASTAs’ option invoked. GeSeq will provide ‘global’ multi-FASTA files for all recognized gene classes (see also <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S1</xref>). The complete set of result files can be conveniently downloaded as single zip file.</p></list-item><list-item><p>Extraction of specific gene sequences from many species: GeSeq can generate codon-based alignments for all submitted sequences by calling TranslatorX. If more than 50 sequences are submitted, we recommend adjusting the annotation parameters to the target gene(s) to minimize the runtime (e.g. if alignments of protein coding genes are to be generated, third-party tRNA annotators are not required).</p></list-item></list></p>
  </sec>
  <sec sec-type="conclusions" id="SEC4">
    <title>CONCLUSION</title>
    <p>GeSeq is a fast web application that generates high-quality annotations in a default mode using our curated reference gene set (typically &gt;97% of genes and coding regions are correctly annotated). Its power rests on its flexibility: GeSeq allows the user to provide custom reference sequences in GenBank or (multi-)FASTA format. This feature represents a particularly critical improvement over existing tools because it enables the user to upload proprietary, most up-to-date or novel feature-containing reference sets. Furthermore, during development of GeSeq, a strong emphasis was placed on annotation quality. GeSeq urges the user to curate gene annotations that failed or are particularly tricky (like tiny exons or rapidly evolving genes) and can show independent annotations by the best-matching reference sequences and its corresponding profile HMM hit or third party tRNA annotators. Although this may demand a final manual curation by the user (usually just for a few genes), we consider this an important step in order to achieve optimal annotation quality and provide high-quality sequence data files to the public databases.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="gkx391_Supp.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>We wish to thank the IT Service Team of the Max Planck Institute of Molecular Plant Physiology for excellent technical assistance.</p>
  </ack>
  <sec id="SEC5">
    <title>SUPPLEMENTARY DATA</title>
    <p><xref ref-type="supplementary-material" rid="sup1">Supplementary Data</xref> are available at NAR Online.</p>
  </sec>
  <sec id="SEC6">
    <title>FUNDING</title>
    <p>Deutsche Forschungsgemeinschaft (DFG) [GR 4193/1-1 to S.G., TI 605/5-1 to M.T.]; Human Frontier Science Program (HFSP) [RGP0005/2013 to R.B.]; Max Planck Society (MPG). Funding for open access charge: MPG.</p>
    <p><italic>Conflict of interest statement</italic>. None declared.</p>
  </sec>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Ruhlman</surname><given-names>T.A.</given-names></name>, <name name-style="western"><surname>Jansen</surname><given-names>R.K.</given-names></name></person-group><person-group person-group-type="editor"><name name-style="western"><surname>Maliga</surname><given-names>P</given-names></name></person-group><source>Chloroplast Biotechnology: Methods and Protocols, Methods in Molecular Biology</source>. <year>2014</year>; <volume>1132</volume>:<publisher-loc>NY</publisher-loc>: <publisher-name>Springer</publisher-name><fpage>3</fpage>–<lpage>38</lpage>.</mixed-citation>
    </ref>
    <ref id="B2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Alverson</surname><given-names>A.J.</given-names></name>, <name name-style="western"><surname>Wei</surname><given-names>X.</given-names></name>, <name name-style="western"><surname>Rice</surname><given-names>D.W.</given-names></name>, <name name-style="western"><surname>Stern</surname><given-names>D.B.</given-names></name>, <name name-style="western"><surname>Barry</surname><given-names>K.</given-names></name>, <name name-style="western"><surname>Palmer</surname><given-names>J.D.</given-names></name></person-group><article-title>Insights into the evolution of mitochondrial genome size from complete sequences of <italic>Citrullus lanatus</italic> and <italic>Cucurbita pepo</italic> (Cucurbitaceae)</article-title>. <source>Mol. Biol. Evol.</source><year>2010</year>; <volume>27</volume>:<fpage>1436</fpage>–<lpage>1448</lpage>.<pub-id pub-id-type="pmid">20118192</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Liu</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Shi</surname><given-names>L.</given-names></name>, <name name-style="western"><surname>Zhu</surname><given-names>Y.</given-names></name>, <name name-style="western"><surname>Chen</surname><given-names>H.</given-names></name>, <name name-style="western"><surname>Zhang</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Lin</surname><given-names>X.</given-names></name>, <name name-style="western"><surname>Guan</surname><given-names>X.</given-names></name></person-group><article-title>CpGAVAS, an integrated web server for the annotation, visualization, analysis, and GenBank submission of completely sequenced chloroplast genome sequences</article-title>. <source>BMC Genomics</source>. <year>2012</year>; <volume>13</volume>:<fpage>715</fpage>.<pub-id pub-id-type="pmid">23256920</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>McKain</surname><given-names>M.R.</given-names></name>, <name name-style="western"><surname>Hartsock</surname><given-names>R.H.</given-names></name>, <name name-style="western"><surname>Wohl</surname><given-names>M.M.</given-names></name>, <name name-style="western"><surname>Kellogg</surname><given-names>E.A.</given-names></name></person-group><article-title>Verdant: automated annotation, alignment, and phylogenetic analysis of whole chloroplast genomes</article-title>. <source>Bioinformatics</source>. <year>2017</year>; <volume>33</volume>:<fpage>130</fpage>–<lpage>132</lpage>.<pub-id pub-id-type="pmid">27634949</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wyman</surname><given-names>S.K.</given-names></name>, <name name-style="western"><surname>Jansen</surname><given-names>R.K.</given-names></name>, <name name-style="western"><surname>Boore</surname><given-names>J.L.</given-names></name></person-group><article-title>Automatic annotation of organellar genomes with DOGMA</article-title>. <source>Bioinformatics</source>. <year>2004</year>; <volume>20</volume>:<fpage>3252</fpage>–<lpage>3255</lpage>.<pub-id pub-id-type="pmid">15180927</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lowe</surname><given-names>T.M.</given-names></name>, <name name-style="western"><surname>Eddy</surname><given-names>S.R.</given-names></name></person-group><article-title>tRNAscan-SE: a program for improved detection of transfer RNA genes in genomic sequence</article-title>. <source>Nucleic Acids Res.</source><year>1997</year>; <volume>25</volume>:<fpage>955</fpage>–<lpage>964</lpage>.<pub-id pub-id-type="pmid">9023104</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Laslett</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Canback</surname><given-names>B.</given-names></name></person-group><article-title>ARAGORN, a program to detect tRNA genes and tmRNA genes in nucleotide sequences</article-title>. <source>Nucleic Acids Res.</source><year>2004</year>; <volume>32</volume>:<fpage>11</fpage>–<lpage>16</lpage>.<pub-id pub-id-type="pmid">14704338</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kent</surname><given-names>W.J.</given-names></name></person-group><article-title>BLAT - The BLAST-like alignment tool</article-title>. <source>Genome Res.</source><year>2002</year>; <volume>12</volume>:<fpage>656</fpage>–<lpage>664</lpage>.<pub-id pub-id-type="pmid">11932250</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lohse</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Drechsel</surname><given-names>O.</given-names></name>, <name name-style="western"><surname>Bock</surname><given-names>R.</given-names></name></person-group><article-title>OrganellarGenomeDRAW (OGDRAW): a tool for the easy generation of high-quality custom graphical maps of plastid and mitochondrial genomes</article-title>. <source>Curr. Genet.</source><year>2007</year>; <volume>52</volume>:<fpage>267</fpage>–<lpage>274</lpage>.<pub-id pub-id-type="pmid">17957369</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lohse</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Drechsel</surname><given-names>O.</given-names></name>, <name name-style="western"><surname>Kahlau</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Bock</surname><given-names>R.</given-names></name></person-group><article-title>OrganellarGenomeDRAW - a suite of tools for generating physical maps of plastid and mitochondrial genomes and visualizing expression data sets</article-title>. <source>Nucleic Acids Res.</source><year>2013</year>; <volume>41</volume>:<fpage>W575</fpage>–<lpage>W581</lpage>.<pub-id pub-id-type="pmid">23609545</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Abascal</surname><given-names>F.</given-names></name>, <name name-style="western"><surname>Zardoya</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Telford</surname><given-names>M.J.</given-names></name></person-group><article-title>TranslatorX: multiple alignment of nucleotide sequences guided by amino acid translations</article-title>. <source>Nucleic Acids Res.</source><year>2010</year>; <volume>38</volume>:<fpage>W7</fpage>–<lpage>W13</lpage>.<pub-id pub-id-type="pmid">20435676</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Edgar</surname><given-names>R.C.</given-names></name></person-group><article-title>MUSCLE: multiple sequence alignment with high accuracy and high throughput</article-title>. <source>Nucleic Acids Res.</source><year>2004</year>; <volume>32</volume>:<fpage>1792</fpage>–<lpage>1797</lpage>.<pub-id pub-id-type="pmid">15034147</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Edgar</surname><given-names>R.C.</given-names></name></person-group><article-title>MUSCLE: a multiple sequence alignment method with reduced time and space complexity</article-title>. <source>BMC Bioinformatics</source>. <year>2004</year>; <volume>5</volume>:<fpage>113</fpage>.<pub-id pub-id-type="pmid">15318951</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wheeler</surname><given-names>T.J.</given-names></name>, <name name-style="western"><surname>Eddy</surname><given-names>S.R.</given-names></name></person-group><article-title>nhmmer: DNA homology search with profile HMMs</article-title>. <source>Bioinformatics</source>. <year>2013</year>; <volume>29</volume>:<fpage>2487</fpage>–<lpage>2489</lpage>.<pub-id pub-id-type="pmid">23842809</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cornish-Bowden</surname><given-names>A.</given-names></name></person-group><article-title>Nomenclature for incompletely specified bases in nucleic acid sequences: recommendations 1984</article-title>. <source>Nucleic Acids Res.</source><year>1985</year>; <volume>13</volume>:<fpage>3021</fpage>–<lpage>3030</lpage>.<pub-id pub-id-type="pmid">2582368</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sloan</surname><given-names>D.B.</given-names></name></person-group><article-title>One ring to rule them all? Genome sequencing provides new insights into the ‘master circle’ model of plant mitochondrial DNA structure</article-title>. <source>New Phytol.</source><year>2013</year>; <volume>200</volume>:<fpage>978</fpage>–<lpage>985</lpage>.<pub-id pub-id-type="pmid">24712049</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Eddy</surname><given-names>S.R.</given-names></name>, <name name-style="western"><surname>Durbin</surname><given-names>R.</given-names></name></person-group><article-title>RNA sequence analysis using covariance models</article-title>. <source>Nucleic Acids Res.</source><year>1994</year>; <volume>22</volume>:<fpage>2079</fpage>–<lpage>2088</lpage>.<pub-id pub-id-type="pmid">8029015</pub-id></mixed-citation>
    </ref>
    <ref id="B18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Alkatib</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Fleischmann</surname><given-names>T.T.</given-names></name>, <name name-style="western"><surname>Scharff</surname><given-names>L.B.</given-names></name>, <name name-style="western"><surname>Bock</surname><given-names>R.</given-names></name></person-group><article-title>Evolutionary constraints on the plastid tRNA set decoding methionine and isoleucine</article-title>. <source>Nucleic Acids Res.</source><year>2012</year>; <volume>40</volume>:<fpage>6713</fpage>–<lpage>6724</lpage>.<pub-id pub-id-type="pmid">22553362</pub-id></mixed-citation>
    </ref>
    <ref id="B19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Takenaka</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Zehrmann</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Verbitskiy</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Härtel</surname><given-names>B.</given-names></name>, <name name-style="western"><surname>Brennicke</surname><given-names>A.</given-names></name></person-group><article-title>RNA editing in plants and its evolution</article-title>. <source>Annu. Rev. Genet.</source><year>2013</year>; <volume>47</volume>:<fpage>335</fpage>–<lpage>352</lpage>.<pub-id pub-id-type="pmid">24274753</pub-id></mixed-citation>
    </ref>
    <ref id="B20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Drescher</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Ruf</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Calsa</surname><given-names>T.</given-names><suffix>Jr</suffix></name>, <name name-style="western"><surname>Carrer</surname><given-names>H.</given-names></name>, <name name-style="western"><surname>Bock</surname><given-names>R.</given-names></name></person-group><article-title>The two largest chloroplast genome-encoded open reading frames of higher plants are essential genes</article-title>. <source>Plant J.</source><year>2000</year>; <volume>22</volume>:<fpage>97</fpage>–<lpage>104</lpage>.<pub-id pub-id-type="pmid">10792825</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
