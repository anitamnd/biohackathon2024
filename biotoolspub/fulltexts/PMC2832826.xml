<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2832826</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btq040</article-id>
    <article-id pub-id-type="publisher-id">btq040</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group>
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SNVMix: predicting single nucleotide variants from next-generation sequencing of tumors</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Goya</surname>
          <given-names>Rodrigo</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sun</surname>
          <given-names>Mark G.F.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Morin</surname>
          <given-names>Ryan D.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Leung</surname>
          <given-names>Gillian</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ha</surname>
          <given-names>Gavin</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wiegand</surname>
          <given-names>Kimberley C.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Senz</surname>
          <given-names>Janine</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Crisan</surname>
          <given-names>Anamaria</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Marra</surname>
          <given-names>Marco A.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hirst</surname>
          <given-names>Martin</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Huntsman</surname>
          <given-names>David</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Murphy</surname>
          <given-names>Kevin P.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Aparicio</surname>
          <given-names>Sam</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Shah</surname>
          <given-names>Sohrab P.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>4</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><sup>1</sup> Department of Molecular Oncology Breast Cancer Research Program, British Columbia Cancer Research Centre, <sup>2</sup> Genome Sciences Centre, British Columbia Cancer Agency, <sup>3</sup> Centre for Translational and Applied Genomics of British Columbia Cancer Agency, <sup>4</sup> Provincial Health Services Authority Laboratories and <sup>5</sup> Department of Computer Science, University of British Columbia, Vancouver, BC, Canada</aff>
    <author-notes>
      <corresp id="COR1">* To whom correspondence should be addressed.</corresp>
      <fn>
        <p>Associate Editor: Alex Bateman</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>3</month>
      <year>2010</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>3</day>
      <month>2</month>
      <year>2010</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>3</day>
      <month>2</month>
      <year>2010</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>26</volume>
    <issue>6</issue>
    <fpage>730</fpage>
    <lpage>736</lpage>
    <history>
      <date date-type="received">
        <day>6</day>
        <month>11</month>
        <year>2009</year>
      </date>
      <date date-type="rev-recd">
        <day>14</day>
        <month>1</month>
        <year>2010</year>
      </date>
      <date date-type="accepted">
        <day>26</day>
        <month>1</month>
        <year>2010</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2010. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2010</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.5">http://creativecommons.org/licenses/by-nc/2.5</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> Next-generation sequencing (NGS) has enabled whole genome and transcriptome single nucleotide variant (SNV) discovery in cancer. NGS produces millions of short sequence reads that, once aligned to a reference genome sequence, can be interpreted for the presence of SNVs. Although tools exist for SNV discovery from NGS data, none are specifically suited to work with data from tumors, where altered ploidy and tumor cellularity impact the statistical expectations of SNV discovery.</p>
      <p><bold>Results:</bold> We developed three implementations of a probabilistic Binomial mixture model, called SNVMix, designed to infer SNVs from NGS data from tumors to address this problem. The first models allelic counts as observations and infers SNVs and model parameters using an expectation maximization (EM) algorithm and is therefore capable of adjusting to deviation of allelic frequencies inherent in genomically unstable tumor genomes. The second models nucleotide and mapping qualities of the reads by probabilistically weighting the contribution of a read/nucleotide to the inference of a SNV based on the confidence we have in the base call and the read alignment. The third combines filtering out low-quality data in addition to probabilistic weighting of the qualities. We quantitatively evaluated these approaches on 16 ovarian cancer RNASeq datasets with matched genotyping arrays and a human breast cancer genome sequenced to &gt;40× (haploid) coverage with ground truth data and show systematically that the SNVMix models outperform competing approaches.</p>
      <p><bold>Availability:</bold> Software and data are available at <ext-link ext-link-type="uri" xlink:href="http://compbio.bccrc.ca">http://compbio.bccrc.ca</ext-link></p>
      <p>
        <bold>Contact:</bold>
        <email>sshah@bccrc.ca</email>
      </p>
      <p><bold>Supplemantary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btq040/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>1 INTRODUCTION</title>
    <sec id="SEC1.1">
      <title>1.1 Single nucleotide variants in cancer</title>
      <p>Cancer is a disease of genetic alterations. In particular, single nucleotide variants (SNVs) present as either germline or somatic point mutations are essential drivers of tumorigenesis and cellular proliferation in many human cancer types. The discovery of germline mutations established important gene functions in cancer; however, the contribution of single germline alleles to the population burden of cancer is relatively low. In contrast, determination of tumorigenic mechanisms has focused on somatic mutations. The somatic mutational landscape of cancer has to date largely been derived from small-scale or targeted approaches, leading to the discovery of genes affected by somatic mutations in many diverse cancer types. More comprehensive studies using Sanger-based exon resequencing suggest that the mutational landscape will be characterized by relative handfuls of frequently mutated genes and a long tail of infrequent somatic mutations in many genes (Jones <italic>et al.</italic>, <xref ref-type="bibr" rid="B1">2008</xref>; Stratton <italic>et al.</italic>, <xref ref-type="bibr" rid="B17">2009</xref>).</p>
      <p>Considering this, unbiased sequencing surveys of tumor transcriptomes or genomes are expected to reveal mutations in these commonly affected cancer genes as well as many novel mutations in genes with no previous implication in cancer. Next-generation sequencing (NGS) technology (Shendure and Ji, <xref ref-type="bibr" rid="B16">2008</xref>) has now emerged as a practical, high-throughput and low-cost sequencing method enabling the full and rapid interrogation of the genomes and transcriptomes of individual tumors for mutations. As such, NGS has presented an unprecedented opportunity for SNV discovery in cancer. Recent studies involving deeply sequencing the tumor genomes from acute myeloid leukemia patients (Ley <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">2008</xref>; Mardis <italic>et al.</italic>, <xref ref-type="bibr" rid="B9">2009</xref>) and a lobular breast cancer patient (Shah <italic>et al.</italic>, <xref ref-type="bibr" rid="B15">2009b</xref>) have revealed numerous novel somatic mutations in genes that had not been previously reported to harbor abnormalities. In addition, sequencing the transcriptomes of ovarian cancers with RNA-seq (Marioni <italic>et al.</italic>, <xref ref-type="bibr" rid="B10">2008</xref>; Morin <italic>et al.</italic>, <xref ref-type="bibr" rid="B11">2008</xref>; Mortazavi <italic>et al.</italic>, <xref ref-type="bibr" rid="B12">2008</xref>) led to the discovery of a defining mutation in the <italic>FOXL2</italic> gene (previously not implicated in cancer) in granulosa cell tumors of the ovary (Shah <italic>et al.</italic>, <xref ref-type="bibr" rid="B14">2009a</xref>).</p>
      <p>While these early studies have emerged as proof of principle that novel SNVs can indeed be discovered using NGS, the study of computational methods for their discovery in cancer is under-represented in the bioinformatics literature. The analysis of SNVs from cancer data, where altered ploidy and tumor cellularity impact the statistical expectations of SNV discovery; and transcriptome data, where the dynamic range of depth of sequencing is dependent on highly variable transcript expression present unique challenges. In this contribution, we describe a new statistical model for identifying SNVs in NGS data generated from cancer genomes and transcriptomes. We demonstrate how its novel features outperform other available methods. Additionally, we provide a ground truth dataset (with Sanger validated SNVs) and robust accuracy metrics that will permit future study of computational methods for SNV detection in cancer genomes.</p>
    </sec>
    <sec id="SEC1.2">
      <title>1.2 NGS data preprocessing for SNV detection</title>
      <p>The data produced by NGS consists of millions of short reads ranging in length from approximately 30–400 nt (although this is steadily increasing with ongoing technology development). Here, we focus explicitly on the problem of inferring SNVs once these reads have been aligned to the genome. Numerous methods have been developed for short read alignment including Maq (Li,H. <italic>et al.</italic>, <xref ref-type="bibr" rid="B4">2008</xref>), BowTie (Langmead <italic>et al.</italic>, <xref ref-type="bibr" rid="B2">2009</xref>), ELAND (Illumina), SHRiMP (Rumble <italic>et al.</italic>, <xref ref-type="bibr" rid="B13">2009</xref>), BWA (Li and Durbin, <xref ref-type="bibr" rid="B5">2009</xref>), SOAP (Li,R. <italic>et al.</italic>, <xref ref-type="bibr" rid="B7">2008</xref>) and Mosaik (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.bc.edu/marthlab/Mosaik">http://bioinformatics.bc.edu/marthlab/Mosaik</ext-link>). We begin the discussion by describing two ways of preprocessing aligned data for input to SNV detection algorithms. The first method is shown in <xref ref-type="fig" rid="F1">Figure 1</xref>A, where we show an example of aligned data where two SNVs are identified. The reads are positioned according to their alignment in the genome and the reference genome sequence is shown in blue. The first step involves transforming the aligned reads into allelic counts. This method assumes that the reads are correctly aligned and the nucleotide base calls are correct. Nucleotides that match the reference are shown in black, whereas nucleotides that do not match the reference are shown bolded in red. The figure illustrates how aligned data can be ‘collapsed’ into allelic counts. At each position <italic>i</italic> in the data, we can count the number of reads <italic>a</italic><sub><italic>i</italic></sub> that match the reference genome and the number of reads <italic>b</italic><sub><italic>i</italic></sub> that do not match the reference genome. In the case of rare third alleles, these reads are assumed to be errors. The total number of reads overlapping each position (called the depth) is given by <italic>N</italic><sub><italic>i</italic></sub>=<italic>a</italic><sub><italic>i</italic></sub>+<italic>b</italic><sub><italic>i</italic></sub>. In this context, given {<italic>a</italic><sub><italic>i</italic></sub>, <italic>b</italic><sub><italic>i</italic></sub>, <italic>N</italic><sub><italic>i</italic></sub>} for all <italic>i</italic>∈{1, 2,…, <italic>T</italic>} where <italic>T</italic> is the total number of positions in the genome, the task is to infer which positions exhibit an SNV.
<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>(<bold>A</bold>) Schematic diagram of input data to SNVMix1. We show how allelic counts (bottom) are derived from aligned reads (top). The reference sequence is shown indicated in blue. The arrows indicate positions representing SNVs. The non-reference bases are shown in red. (<bold>B</bold>) Input data for SNVMix2 that consists of the mapping and base qualities. The darker the background for a read represents a higher quality alignment. The brighter colored nucleotides represent higher quality base calls. Therefore, high contrast nucleotides are more trustworthy than lower contrast nucleotides. (<bold>C</bold>) SNVMix1 shown as a probabilistic graphical model. Circles represent random variables, and rounded squares represent fixed constants. Shaded notes indicate observed data [the allelic counts and the read depth from (A)]. Unshaded nodes indicate quantities that are inferred during EM. <italic>G</italic><sub><italic>i</italic></sub>∈{<italic>aa</italic>, <italic>ab</italic>, <italic>bb</italic>} represents the genotype, <italic>N</italic><sub><italic>i</italic></sub>∈{0, 1,…,} is the number of reads and <italic>a</italic><sub><italic>i</italic></sub>∈{0, 1,…, <italic>N</italic><sub><italic>i</italic></sub>} is the number of reference reads. π is the prior over genotypes and μ<sub><italic>k</italic></sub> is the genotype-specific Binomial parameter for genotype <italic>k</italic>. (<bold>D</bold>) SNVMix2 shown as a probabilistic graphical model. In comparison to SNVMix1, <italic>a</italic><sub><italic>i</italic></sub> is unobserved and we expand the input to consider read-specific information indexed by <italic>j</italic> where <italic>z</italic><sup><italic>i</italic></sup><sub><italic>j</italic></sub>=1 indicates that read <italic>j</italic> is correctly aligned, <italic>q</italic><sup><italic>i</italic></sup><sub><italic>j</italic></sub> is the base quality and <italic>r</italic><sup><italic>i</italic></sup><sub><italic>j</italic></sub> is the mapping quality.</p></caption><graphic xlink:href="btq040f1"/></fig></p>
      <p>The second method (<xref ref-type="fig" rid="F1">Fig. 1</xref>B) relaxes the assumption that the base calls and the alignments are correct and instead considers two types of uncertainty related to determining <italic>a</italic><sub><italic>i</italic></sub> and <italic>N</italic><sub><italic>i</italic></sub> , namely the uncertainty encoded in the base call <italic>q</italic><sup><italic>i</italic></sup><sub><italic>j</italic></sub>∈[0, 1] which represents the probability that the stated base is correct for read <italic>j</italic>∈(1, …, <italic>N</italic><sub><italic>i</italic></sub>) at position <italic>i</italic>; and <italic>r</italic><sup><italic>i</italic></sup><sub><italic>j</italic></sub>∈[0, 1] representing the probability that read <italic>j</italic> aligns to its stated position in the genome. Note that although mapping quality is derived in part from base qualities, considering these quantities as independent allows us to encode the fact that base qualities are position specific, while mapping qualities are constant for all bases in the read. The input data for this method can be visualized as shown in <xref ref-type="fig" rid="F1">Figure 1</xref>B: high mapping quality is shown as dark background and high base quality as bright foreground, high contrast positions indicate positions where the data are more trustworthy. We show in <xref ref-type="sec" rid="SEC2.4">Section 2.4</xref> how to explicitly model these uncertainties to perform soft probabilistic weighting of the data rather than thresholding the uncertainties to deterministically calculate the allelic counts. We will now describe how various authors have approached this problem given {<italic>a</italic><sub><italic>i</italic></sub>, <italic>b</italic><sub><italic>i</italic></sub>, <italic>N</italic><sub><italic>i</italic></sub>} and optionally, {<italic>q</italic><sup><italic>i</italic></sup><sub>1:<italic>N</italic><sub><italic>i</italic></sub></sub>, <italic>r</italic><sup><italic>i</italic></sup><sub>1:<italic>N</italic><sub><italic>i</italic></sub></sub>}.</p>
    </sec>
    <sec id="SEC1.3">
      <title>1.3 Related work</title>
      <p>A simple way to detect SNV locations would be to compute the fraction <inline-formula><inline-graphic xlink:href="btq040i1.jpg"/></inline-formula>, and then to call as SNVs those locations where <italic>f</italic><sub><italic>i</italic></sub> is below some threshold. In the example in <xref ref-type="fig" rid="F1">Figure 1</xref>A, applying threshold of <inline-formula><inline-graphic xlink:href="btq040i2.jpg"/></inline-formula> would successfully discard all columns (including the two columns which have singleton non-reference reads, which may be due to base-calling errors), except the two containing the SNVs. A critical flaw with this approach is that it ignores the confidence we have in our estimate of <italic>f</italic><sub><italic>i</italic></sub>. Intuitively, we can trust our estimate more at locations with greater depth (larger <italic>N</italic><sub><italic>i</italic></sub>). This idea has been applied by Morin <italic>et al.</italic> (<xref ref-type="bibr" rid="B11">2008</xref>), wherein read depth thresholds of <italic>N</italic><sub><italic>i</italic></sub> ≥ 6 and <italic>b</italic><sub><italic>i</italic></sub> ≥ 2 reads supporting the variant allele were applied, with an additional requirement that the non-reference allele must be represented by at least 33% of all reads at that site. This should eliminate SNVs with weak supporting evidence, but it categorizes the data into two discrete classes—SNV or not, without explicitly providing confidence estimates on the prediction. Moreover, in transcriptome data, the number of reads representing a given transcript expected to be highly variable across all genes and thus determining a minimum depth can be difficult. We demonstrate (<xref ref-type="sec" rid="SEC3">Section 3</xref>) that applying depth-based thresholds reduces sensitivity to finding real SNVs.</p>
      <p>To overcome these limitations, we propose a probabilistic approach based on a Binomial mixture model, called SNVMix1, which computes posterior probabilities, providing a measure of confidence on the SNV predictions. The model infers the underlying genotype at each location. We assume the genotype to be in one of three states: <italic>aa</italic> = homozygous for the reference allele, <italic>ab</italic> = heterozygous and <italic>bb</italic> = homozygous for the non-reference allele; the latter two genotypes constituting an SNV. In <xref ref-type="fig" rid="F2">Figure 2</xref>, we show how the posterior probability of each of these three states increases with more depth, which demonstrates the theoretical qualities of our approach. Two other approaches: Maq (Li,H. <italic>et al.</italic>, <xref ref-type="bibr" rid="B4">2008</xref>) and SOAPSNP (Li,R. <italic>et al.</italic>, <xref ref-type="bibr" rid="B7">2008</xref>) have proposed using Binomial distributions to model genotypes; however, these were developed in the context of sequencing normal genomes, not cancer genomes. Both set parameters for the model assuming expected distributions for normal allelic ratios, and apply post-processing heuristics to reduce false positives. In our application, we are interested in cancer genomes and transcriptomes, both of which may not follow expected distributions due to tumor-normal admixtures in the sample, within sample tumor heterogeneity, copy number changes and other factors. We use the expectation maximization (EM) algorithm to find a <italic>maximum a posteriori</italic> (MAP) estimate of the parameters given some training data, allowing the model to adapt to genomes and transcriptomes that may deviate from the assumed distributions for normal genomes and thus model the data more accurately.
<fig id="F2" position="float"><label>Fig. 2.</label><caption><p>(<bold>A</bold>) Theoretical behavior of SNVmix at depths of 2, 3, 5, 10, 15, 20, 35, 50 and 100. The plots show how the distribution of marginal probabilities changes with the number of reference alleles given the model parameters fit to a 10× breast cancer genome dataset. (<bold>B</bold>) ROC curves from fitting SNVMix2 to synthetic data with increasing levels of certainty in the base call.</p></caption><graphic xlink:href="btq040f2"/></fig></p>
      <p>Previous studies have employed stringent thresholding for removing poor quality bases and/or reads (Ley <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">2008</xref>; Morin <italic>et al.</italic>, <xref ref-type="bibr" rid="B11">2008</xref>). We propose that this may throw out informative data, and we extend SNVMix1 to explicitly encode base and mapping qualities by using them to probabilistically weight the contribution of each nucleotide to the posterior probability of a SNV call. In addition, we explore how to optimally combine thresholding and probabilistic weighting in order to obtain more accurate results. We show (<xref ref-type="sec" rid="SEC3">Section 3</xref>) how this extended model, which we call SNVMix2, confers an increased specificity in our predictions.</p>
      <p>The statistical models we propose in this contribution provide posterior probabilities on SNV predictions, removing the need for depth thresholds and use an EM learning algorithm to fit the model to data removing the need to set model parameters by hand. We also show how to explicitly model base and mapping qualities, and explore how quality thresholds can be used in combination with probabilistic weighting. We show that these attributes of the model result in increased accuracy compared with Maq's SNV caller and depth threshold-based methods. We evaluate the model based on real data derived from 16 ovarian cancer transcriptomes sequenced using NGS, and a lobular breast cancer genome sequenced to &gt;40x coverage (Shah <italic>et al.</italic>, <xref ref-type="bibr" rid="B15">2009b</xref>). For all cases, we obtained high-density genotyping array data for orthogonal comparisons. Finally, we demonstrate results on 497 positions from the breast cancer genome that were subjected to Sanger sequencing and thus constitute a ‘ground truth’ dataset for benchmarking.</p>
    </sec>
  </sec>
  <sec sec-type="methods" id="SEC2">
    <title>2 METHODS</title>
    <sec id="SEC2.1">
      <title>2.1 SNVMix model specification</title>
      <p>SNVMix1 is shown as a probabilistic graphical model in <xref ref-type="fig" rid="F1">Figure 1</xref>C. The conditional probability distributions for the model are given in <xref ref-type="fig" rid="F3">Figure 3</xref> and the description of all random variables is listed in <xref ref-type="table" rid="T1">Table 1</xref>. The input is composed of allelic counts from aligned data and the output of inference is the predicted genotypes. Consider <italic>G</italic><sub><italic>i</italic></sub>=<italic>k</italic>, <italic>k</italic>∈{<italic>aa</italic>, <italic>ab</italic>, <italic>bb</italic>}, to be a Multinomial random variable representing the genotype at nucleotide position <italic>i</italic>, where <italic>aa</italic> is homozygous for the reference allele, <italic>ab</italic> is heterozygous and <italic>bb</italic> is homozygous for the non-reference allele. At each position, we have an observed number of aligned reads <italic>N</italic><sub><italic>i</italic></sub>. We let <italic>a</italic><sup><italic>i</italic></sup><sub><italic>j</italic></sub>∈{0, 1} represent whether or not read <italic>j</italic>∈{1,…, <italic>N</italic><sub><italic>i</italic></sub>} matches the reference at position <italic>i</italic>. We let <italic>a</italic><sub><italic>i</italic></sub> (no <italic>j</italic> index) be the total number of reads that match the reference at <italic>i</italic>. We assume the following likelihood model for the data:
<disp-formula id="M1"><label>(1)</label><graphic xlink:href="btq040m1"/></disp-formula>
where μ<sub><italic>k</italic></sub> is the parameter of a Binomial distribution for genotype <italic>k</italic>. μ<sub><italic>k</italic></sub> models the expectation that for a given genotype <italic>k</italic>, a randomly sampled allele will be the reference allele. Intuitively, we should expect μ<sub><italic>aa</italic></sub> to be close to 1, μ<sub><italic>ab</italic></sub> to be close to 0.5 and μ<sub><italic>bb</italic></sub> to be close to 0. Thus, the key intuition is that for genotype <italic>k</italic>=<italic>aa</italic>, the Binomial distribution defined by μ<sub><italic>aa</italic></sub> should be highly skewed toward the reference allele. Similarly, μ<sub><italic>bb</italic></sub> would be skewed toward the non−reference allele. For μ<sub><italic>ab</italic></sub>, the distribution would be much more uniform. We impose a prior on the genotypes, <italic>G</italic><sub><italic>i</italic></sub>|π∼ Multinomial(<italic>G</italic><sub><italic>i</italic></sub>|π, 1) where π(<italic>k</italic>) is the prior probability of genotype <italic>k</italic>. Given knowledge of all the parameters, θ=(μ<sub>1:3</sub>, π), we can use Bayes' rule to infer the posterior over genotypes, γ<sub><italic>i</italic></sub>(<italic>k</italic>)=<italic>p</italic>(<italic>G</italic>=<italic>k</italic>|<italic>a</italic><sub><italic>i</italic></sub>, <italic>N</italic><sub><italic>i</italic></sub>, θ), where:
<disp-formula id="M2"><label>(2)</label><graphic xlink:href="btq040m2"/></disp-formula>
<fig id="F3" position="float"><label>Fig. 3.</label><caption><p>Conditional probability distributions of SNVMix model.</p></caption><graphic xlink:href="btq040f3"/></fig>
<table-wrap id="T1" position="float"><label>Table 1.</label><caption><p>Description of random variables in SNVMix1 and SNVMix2</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th align="left" rowspan="1" colspan="1">Parameter</th><th align="left" rowspan="1" colspan="1">Description</th><th align="left" rowspan="1" colspan="1">Value</th></tr></thead><tbody align="left"><tr><td align="left" rowspan="1" colspan="1">δ</td><td align="left" rowspan="1" colspan="1">Dirichlet prior on π</td><td align="left" rowspan="1" colspan="1">(1000,100,100)</td></tr><tr><td align="left" rowspan="1" colspan="1">π</td><td align="left" rowspan="1" colspan="1">Multinomial distribution over genotypes</td><td align="left" rowspan="1" colspan="1">Estimated by EM (M-step)</td></tr><tr><td align="left" rowspan="1" colspan="1"><italic>G</italic><sub><italic>i</italic></sub></td><td align="left" rowspan="1" colspan="1">Genotype at position <italic>i</italic></td><td align="left" rowspan="1" colspan="1">Estimated by EM (E-step)</td></tr><tr><td align="left" rowspan="1" colspan="1"><italic>a</italic><sup><italic>i</italic></sup><sub><italic>j</italic></sub></td><td align="left" rowspan="1" colspan="1">Indicates whether read <italic>j</italic> at position <italic>i</italic> matches the reference</td><td align="left" rowspan="1" colspan="1">Observed in SNVMix1, latent in SNVMix2</td></tr><tr><td align="left" rowspan="1" colspan="1"><italic>z</italic><sup><italic>i</italic></sup><sub><italic>j</italic></sub></td><td align="left" rowspan="1" colspan="1">Indicates whether read <italic>j</italic> aligns to its stated position</td><td align="left" rowspan="1" colspan="1">Latent</td></tr><tr><td align="left" rowspan="1" colspan="1"><italic>q</italic><sup><italic>i</italic></sup><sub><italic>j</italic></sub></td><td align="left" rowspan="1" colspan="1">Probability that base call is correct</td><td align="left" rowspan="1" colspan="1">Observed (SNVMix2 only)</td></tr><tr><td align="left" rowspan="1" colspan="1"><italic>r</italic><sup><italic>i</italic></sup><sub><italic>j</italic></sub></td><td align="left" rowspan="1" colspan="1">Probability that alignment is correct</td><td align="left" rowspan="1" colspan="1">Observed (SNVMix2 only)</td></tr><tr><td align="left" rowspan="1" colspan="1">μ<sub><italic>k</italic></sub></td><td align="left" rowspan="1" colspan="1">Parameter of the Binomial for genotype <italic>k</italic></td><td align="left" rowspan="1" colspan="1">Estimated by EM (M−step)</td></tr><tr><td align="left" rowspan="1" colspan="1">α</td><td align="left" rowspan="1" colspan="1">Shape parameter of Beta prior on μ</td><td align="left" rowspan="1" colspan="1">(1000,500,1)</td></tr><tr><td align="left" rowspan="1" colspan="1">β</td><td align="left" rowspan="1" colspan="1">Scale parameter of Beta prior on μ</td><td align="left" rowspan="1" colspan="1">(1,500,1000)</td></tr></tbody></table></table-wrap>
</p>
      <p>Our approach to inference involves learning the parameters θ by fitting the model to training data using MAP EM (see below). We demonstrate that this produces better results than Maq, which uses fixed parameters (<xref ref-type="sec" rid="SEC3">Section 3</xref>).</p>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 Prior distributions</title>
      <p>We assume that π is distributed according to a Dirichlet distribution parameterized by δ, the so−called pseudocounts. We set δ to be skewed toward π<sub><italic>aa</italic></sub> assuming that most positions will be homozygous for the reference allele. μ<sub><italic>k</italic></sub> is conjugately distributed according to a Beta distribution: μ<sub><italic>k</italic></sub>∼Beta(μ<sub><italic>k</italic></sub>|α<sub><italic>k</italic></sub>, β<sub><italic>k</italic></sub>). We set α<sub><italic>aa</italic></sub>=1000, β<sub><italic>aa</italic></sub>=1; α<sub><italic>ab</italic></sub>=500, β<sub><italic>ab</italic></sub>=500 and α<sub><italic>bb</italic></sub>=1, β<sub><italic>bb</italic></sub>=1000 assuming that μ<sub><italic>aa</italic></sub> should be skewed towards 1, μ<sub><italic>ab</italic></sub> should be close to 0.5 and μ<sub><italic>bb</italic></sub> should be close to 0.</p>
    </sec>
    <sec id="SEC2.3">
      <title>2.3 Model fitting and parameter estimation</title>
      <p>We fit the model using the EM algorithm. We initialize μ<sub><italic>k</italic></sub> and π(<italic>k</italic>) to their prior means. The EM algorithm iterates between the E-step where we assign the genotypes using Equation <xref ref-type="disp-formula" rid="M2">2</xref> and the M-step where we re-estimate the model parameters. At each iteration, we evaluate the complete data log-posterior and the algorithm terminates when this quantity no longer increases. The M-step equations are standard conjugate updating equations:
<disp-formula id="M3"><label>(3)</label><graphic xlink:href="btq040m3"/></disp-formula>
where <italic>I</italic>(<italic>G</italic><sub><italic>i</italic></sub>=<italic>k</italic>) is an indicator function to signal that <italic>G</italic><sub><italic>i</italic></sub> is assigned to state <italic>k</italic> at position <italic>i</italic>, and:
<disp-formula id="M4"><label>(4)</label><graphic xlink:href="btq040m4"/></disp-formula></p>
    </sec>
    <sec id="SEC2.4">
      <title>2.4 Modeling base and mapping qualities</title>
      <p>The model shown in <xref ref-type="fig" rid="F1">Figure 1</xref>C assumes that <italic>a</italic><sup><italic>i</italic></sup><sub><italic>j</italic></sub> is observed (it is a shaded node in the graph), and thus assumed correct. However, each nucleotide's contribution to the allelic counts has uncertainty associated with it in the form of base and mapping qualities. We propose a soft (or probabilistic) weighting scheme, which will down-weight the influence of low-quality base and mapping calls, but not discard them altogether. To model this, we change <italic>a</italic><sup><italic>i</italic></sup><sub><italic>j</italic></sub> to be an unobserved quantity as shown in <xref ref-type="fig" rid="F1">Figure 1</xref>D, and instead observe the soft evidence on them in the form of probabilities, which we represent by the observed base qualities <italic>q</italic><sup><italic>i</italic></sup><sub><italic>j</italic></sub>∈[0, 1]. Similarly, we introduce unobserved binary random variables <italic>z</italic><sup><italic>i</italic></sup><sub><italic>j</italic></sub>∈{0, 1} representing whether read <italic>j</italic> is correctly aligned, and soft evidence in the form of probabilities which we represent by the observed mapping qualities <italic>r</italic><sup><italic>i</italic></sup><sub><italic>j</italic></sub>∈[0, 1]. The conditional probability distributions for <italic>p</italic>(<italic>q</italic><sup><italic>i</italic></sup><sub><italic>j</italic></sub>|<italic>a</italic><sup><italic>i</italic></sup><sub><italic>j</italic></sub>, <italic>z</italic><sup><italic>i</italic></sup><sub><italic>j</italic></sub>) and <italic>p</italic>(<italic>r</italic><sup><italic>i</italic></sup><sub><italic>j</italic></sub>|<italic>z</italic><sup><italic>i</italic></sup><sub><italic>j</italic></sub>) are given in <xref ref-type="fig" rid="F3">Figure 3</xref>. Thus, the input data is now <italic>q</italic><sup>1:<italic>T</italic></sup>, <italic>r</italic><sup>1:<italic>T</italic></sup> and the corresponding likelihood for each location <italic>i</italic> can be obtained by marginalizing out <italic>a</italic>, <italic>z</italic> as follows:
<disp-formula id="M5"><label>(5)</label><graphic xlink:href="btq040m5"/></disp-formula>
<disp-formula id="M6"><label>(6)</label><graphic xlink:href="btq040m6"/></disp-formula>
<disp-formula id="M7"><label>(7)</label><graphic xlink:href="btq040m7"/></disp-formula></p>
      <p>As before, given the model parameters μ, π, we can infer the genotype at each position by modifying Equation (<xref ref-type="disp-formula" rid="M2">2</xref>) as follows:
<disp-formula id="M8"><label>(8)</label><graphic xlink:href="btq040m8"/></disp-formula>
The updating equations are unchanged in the M-step of EM. The model-fitting algorithm changes only in the E-step by using Equation (<xref ref-type="disp-formula" rid="M2">2</xref>) instead of Equation (<xref ref-type="disp-formula" rid="M2">2</xref>). We have specified how to encode base and mapping uncertainty into the model, obviating the need for thresholding these quantities. We call this version of the model SNVMix2.</p>
      <p>In <xref ref-type="fig" rid="F2">Figure 2</xref>, we show the theoretical behavior of this model using simulated data with varying base qualities. The model performs equally well for datasets where the mean certainty of the base calls is ∼80% and higher. This suggests that thresholding base calls at Phred Q20 [99% certainty (Morin <italic>et al.</italic>, <xref ref-type="bibr" rid="B11">2008</xref>)] or Q30 [99.9% certainty (Ley <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">2008</xref>)] may be overly stringent.</p>
    </sec>
    <sec id="SEC2.5">
      <title>2.5 Implementation and running time</title>
      <p>The model and inference algorithm is implemented in C and supports both SAMtools (Li <italic>et al.</italic>, <xref ref-type="bibr" rid="B6">2009</xref>) and Maq pileup format. Running EM (SNVMix2) on 14 649 positions for the 40× breast cancer genome took 36 s. Predicting genotypes for the whole 40× genome took 11 min and 38 s. (The Maq step cns2snp took 19 min and 9 s.) A script to choose optimal base and mapping quality thresholds, given ground truth [or orthogonal single nucleotide polymorphism (SNP) array] data, is provided in the software package.</p>
    </sec>
    <sec id="SEC2.6">
      <title>2.6 Datasets</title>
      <p>We used three datasets to evaluate our models. The first (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btq040/DC1">Supplementary Dataset 1A and B</ext-link>) consists of 16 ovarian cancer transcriptomes sequenced using the Illumina GA <italic>II</italic> platform, RNA-Seq paired end protocol. (Note that this data has been generated as part of an ongoing study to profile ovarian carcinoma subtypes, and the full datasets will be available as part of forthcoming manuscripts. However, all SNV data referenced in this manuscript is available as <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btq040/DC1">Supplementary Materials</ext-link>). For each of these cases, we obtained Affymetrix SNP 6.0 high-density genotyping arrays from the corresponding DNA. We examined coding positions in the transcriptome data for which there was a corresponding high-confidence (&gt;0.99) genotyping call from the array predicted using the CRLMM algorithm (Lin <italic>et al.</italic>, <xref ref-type="bibr" rid="B8">2008</xref>). This resulted in an average of approximately 9000 positions from each case and a total of 144 271 positions. These data were used in the cross-validation experiment, described below. The second dataset (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btq040/DC1">Supplementary Dataset 2A–D</ext-link>) consisted of 497 positions from a lobular breast tumor genome predicted as SNVs using SNVMix1 model from data generated using the Illumina GA <italic>II</italic> platform. These positions were predicted to be non-synonymous protein-coding changes and were subsequently sequenced using Sanger capillary-based technology. Of these, 305 were confirmed as SNVs and 192 were not confirmed. These 497 positions were considered as the ground truth dataset used for sensitivity and specificity calculations. In addition, we also generated Affymetrix SNP 6.0 array data for this case and considered 14 649 positions (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btq040/DC1">Supplementary Dataset 3A–D</ext-link>) that matched the coding positions and CRLMM prediction criteria outlined above. All NGS data were aligned to the human genome reference (NCBI build 36.1) using Maq's <monospace>map</monospace> tool (v0.6.8). Thus, for all comparisons between Maq and SNVMix, we used the same baseline set of aligned data.</p>
    </sec>
    <sec id="SEC2.7">
      <title>2.7 Accuracy metrics</title>
      <p>While comparing with the SNP array data, we defined a true positive (TP) SNV as an <italic>ab</italic> or <italic>bb</italic> CRLMM genotype. A true negative (TN) SNV was defined as an <italic>aa</italic> genotype from the SNP array. For the Sanger validated positions, a TP was an SNV that was confirmed by Sanger sequencing, whereas a TN was a position that was not confirmed. To evaluate our models against these data, we computed <italic>p</italic>(<italic>SNV</italic><sub><italic>i</italic></sub>)=γ<sub><italic>i</italic></sub>(<italic>ab</italic>)+γ<sub><italic>i</italic></sub>(<italic>bb</italic>) and standard receiver operator characteristic (ROC) curves. The area under the ROC curve (AUC) was computed as a single numeric metric of accuracy that effectively measures the trade-off between sensitivity and specificity. As an additional measure, we computed the <italic>F</italic>-statistic: <inline-formula><inline-graphic xlink:href="btq040i3.jpg"/></inline-formula>, where precision is measured as the proportion of predictions that were true and recall is the proportion of true SNVs that were predicted.</p>
    </sec>
    <sec id="SEC2.8">
      <title>2.8 Benchmarking experiments</title>
      <p>To evaluate the effect of estimating parameters, we designed a 4-fold cross-validation study. We permuted the 144 271 positions with matched array-based genotype data from the ovarian cancer data, and divided the positions into four equal parts. We fit the model to three parts (training data) using EM and used the converged parameters to calculate <italic>p</italic>(SNV<sub><italic>i</italic></sub>) for each of the remaining positions (test data). We repeated this 10 times and computed the AUC for each of the 16 cases. We also computed AUC from the results predicted by Maq v0.6.8 and compared the AUC distributions across the 16 cases to SNVMix1 and SNVMix2. These data also allowed us to determine the range of converged parameter estimates across the folds and 10 replicates. We also tested the effect of depth-based thresholding by running SNVMix1 on the 14 649 positions from the breast cancer genome. To simulate the thresholding, we set <italic>p</italic>(SNV<sub><italic>i</italic></sub>)=0 at locations where <italic>N</italic><sub><italic>i</italic></sub> was below some threshold, chosen from the set {0, 1,…, 7, 10}. We compared SNVMix1, SNVMix2 and Maq on this data as well. Finally, we evaluated the true positive rate (TPR) and false positive rate (FPR) on the 497 ground truth positions from this case for SNVMix1, SNVMix2 and Maq.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="SEC3">
    <title>3 RESULTS</title>
    <sec id="SEC3.1">
      <title>3.1 Depth heuristics reduce sensitivity</title>
      <p>We first determined the effect that depth thresholding had on 14 649 positions probed using an Affymetrix SNP 6.0 array from genome data from the lobular breast cancer by calculating ROC curves and corresponding AUC values (<xref ref-type="sec" rid="SEC2">Section 2</xref>) from the output of SNVMix1 at different cutoff values. The most accurate results were obtained when no depth thresholding was applied. At a threshold of 0, the AUC was 0.988 (the highest) and at a threshold of 10 reads, the AUC was 0.614 (the lowest). At a FPR of 0.01, the TPR decreased with increasing number of reads required for the threshold without exception, suggesting that depth-thresholding under the SNVMix1 model reduces overall sensitivity without increasing specificity, and should therefore be avoided. AUC for thresholds of 1, 3, 5 and 7 reads were 0.971, 0.893, 0.782 and 0.707, respectively.</p>
    </sec>
    <sec id="SEC3.2">
      <title>3.2 Estimating parameters in transcriptome data by model fitting confers better accuracy</title>
      <p><xref ref-type="fig" rid="F4">Figure 4</xref> shows the AUC distribution over 16 ovarian cancer transcriptomes (<xref ref-type="sec" rid="SEC2">Section 2</xref>) for the best and worst cross-validation runs of SNVMix2 and SNVMix1 as well as the results from the Maq SNV caller with the two recommended settings of the <italic>r</italic> parameter (0.001 and 0.02). Both runs of SNVMix1 were statistically significantly better than the Maq runs [analysis of variance (ANOVA) test, <italic>P</italic>&lt;0.0001], with mean AUC of 0.9557 ± 0.0100 and 0.9552 ± 0.0100, compared with 0.9290 ± 0.0120 and 0.9032 ± 0.0119 for the Maq runs. Furthermore, SNVMix2 without quality thresholds offers a slight performance improvement over SNVMix1. Although the improvement of SNVMix2 over SNVMix1 is not statistically significant, it is noteworthy that no thresholds of any kind were applied to the data and thus probabilistic weighting can eliminate the need for arbitrarily thresholding the data (see below).
<fig id="F4" position="float"><label>Fig. 4.</label><caption><p>Distribution of AUC over 16 ovarian cancer transcriptomes comparing accuracy of SNV detection for two Maq runs, the best and worst SNVMix1 runs in the cross-validation experiment (middle) and best and worst runs for SNVMix2 (mbQ0 = no quality thresholding, MbQ30 = keeping only reads with mapping qualities &gt; Q30). SNVMix1 and SNVMix2 runs were statistically more accurate than both Maq runs (ANOVA, <italic>P</italic> &lt; 0.0001). SNVMix2 runs were better than SNVMix1, but not statistically significantly.</p></caption><graphic xlink:href="btq040f4"/></fig></p>
    </sec>
    <sec id="SEC3.3">
      <title>3.3 Evaluation of models on a deeply sequenced breast cancer genome with ground truth SNVs</title>
      <p>We evaluated performance of the models on a lobular breast cancer sample sequenced to &gt;40× haploid coverage (Shah <italic>et al.</italic>, <xref ref-type="bibr" rid="B15">2009b</xref>). In addition, we compared results obtained from the same genome at 10× coverage. We first trained the model using 14 649 protein coding positions for which we generated matching Affymetrix SNP6.0 calls. We computed the AUC for SNVMix1, SNVMix2 and Maq. <xref ref-type="table" rid="T2">Table 2</xref> shows that the highest AUCs were obtained with SNVMix2 on the 40× genome, followed by SNVMix2 on 10× genome (AUCs of 0.9929 and 0.9905, respectively). Both of these were higher than results achieved for SNVMix1 (AUC of 0.9880) and Maq (0.9824 for 40× and 0.9115 for 10×—both for the <italic>r</italic>=0.001 parameter setting). After fitting the model to the 14 649 positions, we evaluated the performance using 497 candidate mutations originally detected using SNVMix1 at 10×, which were validated using Sanger amplicon sequencing (<xref ref-type="sec" rid="SEC2">Section 2</xref>). These consisted of 305 true SNVs (variants seen in the Sanger traces) and 192 that could not be confirmed in the Sanger traces. <xref ref-type="table" rid="T2">Table 2</xref> shows the sensitivity, precision and <italic>F</italic>-measure results of SNVMix2, SNVMix1 and SNVMix2 combined with base and mapping quality thresholding at both 10× and 40× coverage at a <italic>p</italic>(SNV) (<xref ref-type="sec" rid="SEC2">Section 2</xref>) threshold determined using a FPR ≤ 0.01. We did not include a comparison to Maq at these 497 positions since the results would be biased toward the SNVMix1 model that led us to identify them in the first place. SNVMix2 and SNVMix1 showed similar <italic>F</italic>-measure at both 10× and 40× reinforcing that the probabilistic weighting confers equal accuracy without having to select arbitrary quality thresholds. In addition, both SNVMix2 and SNVMix1 had higher accuracy at 40× and 10× (<xref ref-type="table" rid="T2">Table 2</xref>). Interestingly, all the models had increased false negative rates in the 40× genome in comparison with the 10× genome. Upon further review of the SNVMix2 positions predicted at 10×, but not at 40×, we examined that the majority (9 out of 13) were marginally below threshold and significant probability mass was indeed on the <italic>P</italic>(<italic>ab</italic>) state (&gt;0.99) and would have been predicted with even a slightly less stringent threshold. Three out of the remaining four appear to be the result of DNA copy number amplifications that are skewing the allelic ratios involved. We elaborate on this point in <xref ref-type="sec" rid="SEC4">Section 4</xref>.
<table-wrap id="T2" position="float"><label>Table 2.</label><caption><p>Comparison of accuracy of SNVMix1, SNVMix2 and SNVMix combined with base and mapping quality thresholding</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th align="left" rowspan="1" colspan="1">Model</th><th align="left" rowspan="1" colspan="1">Run</th><th align="left" rowspan="1" colspan="1">Train AUC</th><th align="left" rowspan="1" colspan="1">TP</th><th align="left" rowspan="1" colspan="1">FP</th><th align="left" rowspan="1" colspan="1">TN</th><th align="left" rowspan="1" colspan="1">FN</th><th align="left" rowspan="1" colspan="1">Sens</th><th align="left" rowspan="1" colspan="1">Prec</th><th align="left" rowspan="1" colspan="1"><italic>F</italic>-measure</th></tr></thead><tbody align="left"><tr><td rowspan="2" align="left" colspan="1">SNVMix1</td><td align="left" rowspan="1" colspan="1">10×</td><td align="left" rowspan="1" colspan="1">0.9880</td><td align="left" rowspan="1" colspan="1">305</td><td align="left" rowspan="1" colspan="1">192</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">1.0000</td><td align="left" rowspan="1" colspan="1">0.6137</td><td align="left" rowspan="1" colspan="1">0.7606</td></tr><tr><td align="left" rowspan="1" colspan="1">40×</td><td align="left" rowspan="1" colspan="1">0.9924</td><td align="left" rowspan="1" colspan="1">293</td><td align="left" rowspan="1" colspan="1">107</td><td align="left" rowspan="1" colspan="1">85</td><td align="left" rowspan="1" colspan="1">12</td><td align="left" rowspan="1" colspan="1">0.9607</td><td align="left" rowspan="1" colspan="1">0.7325</td><td align="left" rowspan="1" colspan="1">0.8312</td></tr><tr><td rowspan="2" align="left" colspan="1">SNVMix2</td><td align="left" rowspan="1" colspan="1">10×</td><td align="left" rowspan="1" colspan="1">0.9905</td><td align="left" rowspan="1" colspan="1">299</td><td align="left" rowspan="1" colspan="1">162</td><td align="left" rowspan="1" colspan="1">30</td><td align="left" rowspan="1" colspan="1">6</td><td align="left" rowspan="1" colspan="1">0.9803</td><td align="left" rowspan="1" colspan="1">0.6486</td><td align="left" rowspan="1" colspan="1">0.7807</td></tr><tr><td align="left" rowspan="1" colspan="1">40×</td><td align="left" rowspan="1" colspan="1">0.9929</td><td align="left" rowspan="1" colspan="1">290</td><td align="left" rowspan="1" colspan="1">107</td><td align="left" rowspan="1" colspan="1">85</td><td align="left" rowspan="1" colspan="1">15</td><td align="left" rowspan="1" colspan="1">0.9508</td><td align="left" rowspan="1" colspan="1">0.7305</td><td align="left" rowspan="1" colspan="1">0.8262</td></tr><tr><td rowspan="2" align="left" colspan="1">SNVMix2+thresholding</td><td align="left" rowspan="1" colspan="1">mQ50_bQ20 (10×)</td><td align="left" rowspan="1" colspan="1">0.9882</td><td align="left" rowspan="1" colspan="1">287</td><td align="left" rowspan="1" colspan="1">88</td><td align="left" rowspan="1" colspan="1">104</td><td align="left" rowspan="1" colspan="1">18</td><td align="left" rowspan="1" colspan="1">0.9410</td><td align="left" rowspan="1" colspan="1">0.7653</td><td align="left" rowspan="1" colspan="1">0.8441</td></tr><tr><td align="left" rowspan="1" colspan="1">mQ50_bQ15 (40×)</td><td align="left" rowspan="1" colspan="1">0.9928</td><td align="left" rowspan="1" colspan="1">287</td><td align="left" rowspan="1" colspan="1">71</td><td align="left" rowspan="1" colspan="1">121</td><td align="left" rowspan="1" colspan="1">18</td><td align="left" rowspan="1" colspan="1">0.9410</td><td align="left" rowspan="1" colspan="1">0.8017</td><td align="left" rowspan="1" colspan="1">0.8658</td></tr></tbody></table></table-wrap>
</p>
      <p>While the SNVMix2 model eliminates the need for thresholding through probabilistic weighting, we explored the effect of applying thresholds to the SNVMix2 input in order to identify a practical balance between pure weighting and thresholding. We compared the results of thresholding mapping qualities at (Q0, Q5, Q10, Q20, Q30, Q40 and Q50) and concomitantly thresholding base qualities at (Q0, Q5, Q10, Q15, Q20 and Q25) and running SNVMix2 on the resulting data from both 10× and 40× genomes. As shown in <xref ref-type="table" rid="T2">Table 2</xref>, thresholding the mapping qualities at Q50 and base qualities at Q20 (mQ50_bQ20) at 10× performed better than all other 10× runs (<italic>F</italic>−measure 0.8441). For the 40× data, thresholding the mapping qualities at Q50 and base qualities at Q15 (mQ50_bQ15) performed best over all runs (<italic>F</italic>-measure 0.8658). (See <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btq040/DC1">Supplementary Table S1</ext-link> for all results from runs in increments of Q1 base quality thresholds.) This suggests that previously reported base quality thresholds may be too stringent. Furthermore, when used with stringent mapping quality thresholds, the SNVMix2 model can effectively use the base qualities by probabilistic weighting to confer higher accuracy. These results indicate that treating mapping and base qualities separately as opposed to taking a minimum over the two (as in Maq) has advantages.</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="SEC4">
    <title>4 DISCUSSION</title>
    <p>We have described two statistical models based on Binomial mixture models to infer SNVs from aligned NGS data obtained from tumors. We demonstrated that a probabilistic approach to modeling allelic counts obviates the need for depth-based thresholding of the data, and how fitting the model to real data to estimate parameters is superior to Maq, which uses fixed parameter settings on the assumption that the data come from a normal human genome. In addition, we extended the basic Binomial mixture to model mapping and base qualities by using a probabilistic weighting technique. This eliminates the need to employ arbitrary thresholds on base and mapping qualities and instead lets the model determine the strength of contribution of each read to the inference of the genotype. Finally, we showed that even further gains in accuracy can be obtained by combining moderate thresholding and probabilistic weighting of the base and mapping qualities. Importantly, gains in accuracy by the SNVMix models were shown in both transcriptome and genome data.</p>
    <sec id="SEC4.1">
      <title>4.1 Dependence on alignments</title>
      <p>Our results will be highly dependent on the accuracy of alignments as well as the consistency and accuracy of mapping qualities reported by the aligner. Results in <xref ref-type="table" rid="T2">Table 2</xref> showed that the combined approach of stringent thresholding on mapping quality and modeling the uncertainty of the remaining reads gave the highest accuracy. Given that the most gain was obtained in precision, it suggests that false positive predictions may indeed be reduced with more accurate alignments. As read lengths increase with technology development and mapping algorithms improve, we expect that the input to SNVMix will be of higher quality, which should yield more accurate results. Moreover, alignment using Maq presents a drawback with regard to SNVMix2's model. When a short read can be aligned to more than one position in the genome with the same mapping quality, this read is dropped, being assigned a mapping quality of zero. SNVMix2's design would be able to leverage the read's quality amongst the distinct coordinates and still use the information it conveys to predict SNVs. The performance of this will be evaluated in future work.</p>
    </sec>
    <sec id="SEC4.2">
      <title>4.2 Limitations, extensions and future work</title>
      <p>As stated earlier, a major objective in cancer genome sequencing is to discover somatic mutations. If sequence data from tumor and normal DNA from the same patient is available, candidate somatic mutations can be identified as positions for which <italic>p</italic>(SNV) is high in the tumor and 1−<italic>p</italic>(SNV) is high in the normal data. If only tumour data is available, we recommend filtering against dbSNP and performing targeted validation on the remaining positions in both tumor and normal DNA as described previously (Shah <italic>et al.</italic>, <xref ref-type="bibr" rid="B15">2009b</xref>). Moreover, the models we have presented assume identically and independently distributed genotypes. As such, the common prior over genotypes π can be indexed by position (i.e. π<sub><italic>i</italic></sub>) and thus could encode information about what variants are known for each position <italic>i</italic> in the genome.</p>
      <p>We noticed that some positions missed by SNVMix1 at 40× were in what we believe are allele-specific copy number amplifications. Future work will involve incorporating copy number data directly into the model to consider such situations where the resultant allelic bias is expected to mask variants present in the unamplified allele. These results will be presented in a forthcoming manuscript. In a similar vein, due to regulatory mutations or epigenetic changes, transcriptomes can show preferential expression of one allele and thus our model will be insensitive to instances of extensively skewed allelic expression. Further extensions of the model to consider these factors will be explored.</p>
      <p>Finally, we recently demonstrated that intra-tumor heterogeneity can be seen using ultra-deep targeted sequencing (Shah <italic>et al.</italic>, <xref ref-type="bibr" rid="B15">2009b</xref>). The allelic frequencies of SNVs in rare clones in the tumor population will likely result in false negative predictions at conventional sequencing depths (i.e. between 20× and 40×), and confound the estimation of the false negative rates of prediction. Future investigation of all of these problems will be necessary if the goal of sequencing studies is to characterize all mutations present in the heterogeneous mixture of genomes that make up a tumor.</p>
      <p><italic>Funding</italic>: The project is supported by the Canadian Institutes for Health Research (CIHR). SPS is supported by the Michael Smith Foundation for Health Research (MSFHR) and the Canadian Breast Cancer Foundation. RG is supported by MSFHR and CIHR.</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>[Supplementary Data]</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="btq040_index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="btq040_1.pdf"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="x-zip-compressed" xlink:href="btq040_bioinf-2009-1740-File001.zip"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jones</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Core signaling pathways in human pancreatic cancers revealed by global genomic analyses</article-title>
        <source>Science</source>
        <year>2008</year>
        <volume>321</volume>
        <fpage>1801</fpage>
        <lpage>1806</lpage>
        <pub-id pub-id-type="pmid">18772397</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title>
        <source>Genome Biol.</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>R25</fpage>
        <pub-id pub-id-type="pmid">19261174</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ley</surname>
            <given-names>TJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DNA sequencing of a cytogenetically normal acute myeloid leukaemia genome</article-title>
        <source>Nature</source>
        <year>2008</year>
        <volume>456</volume>
        <fpage>66</fpage>
        <lpage>72</lpage>
        <pub-id pub-id-type="pmid">18987736</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mapping short DNA sequencing reads and calling variants using mapping quality scores</article-title>
        <source>Genome Res.</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>1851</fpage>
        <lpage>1858</lpage>
        <pub-id pub-id-type="pmid">18714091</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1754</fpage>
        <lpage>1760</lpage>
        <pub-id pub-id-type="pmid">19451168</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Sequence Alignment/Map format and SAMtools</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SOAP: short oligonucleotide alignment program</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>713</fpage>
        <lpage>714</lpage>
        <pub-id pub-id-type="pmid">18227114</pub-id>
      </element-citation>
    </ref>
    <ref id="B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Validation and extension of an empirical Bayes method for SNP calling on Affymetrix microarrays</article-title>
        <source>Genome Biol.</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>R63</fpage>
        <pub-id pub-id-type="pmid">18387188</pub-id>
      </element-citation>
    </ref>
    <ref id="B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mardis</surname>
            <given-names>ER</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Recurring mutations found by sequencing an acute myeloid leukemia genome</article-title>
        <source>N. Engl. J. Med.</source>
        <year>2009</year>
        <volume>361</volume>
        <fpage>1058</fpage>
        <lpage>1066</lpage>
        <pub-id pub-id-type="pmid">19657110</pub-id>
      </element-citation>
    </ref>
    <ref id="B10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA-seq: an assessment of technical reproducibility and comparison with gene expression arrays</article-title>
        <source>Genome Res.</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>1509</fpage>
        <lpage>1517</lpage>
        <pub-id pub-id-type="pmid">18550803</pub-id>
      </element-citation>
    </ref>
    <ref id="B11">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Morin</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Profiling the HeLa S3 transcriptome using randomly primed cDNA and massively parallel short-read sequencing</article-title>
        <source>BioTechniques</source>
        <year>2008</year>
        <volume>45</volume>
        <fpage>81</fpage>
        <lpage>94</lpage>
        <pub-id pub-id-type="pmid">18611170</pub-id>
      </element-citation>
    </ref>
    <ref id="B12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mortazavi</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mapping and quantifying mammalian transcriptomes by RNA-seq</article-title>
        <source>Nat. Methods</source>
        <year>2008</year>
        <volume>5</volume>
        <fpage>621</fpage>
        <lpage>628</lpage>
        <pub-id pub-id-type="pmid">18516045</pub-id>
      </element-citation>
    </ref>
    <ref id="B13">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rumble</surname>
            <given-names>SM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SHRiMP: accurate mapping of short color-space reads</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2009</year>
        <volume>5</volume>
        <fpage>e1000386</fpage>
        <pub-id pub-id-type="pmid">19461883</pub-id>
      </element-citation>
    </ref>
    <ref id="B14">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shah</surname>
            <given-names>SP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mutation of FOXL2 in granulosa-cell tumors of the ovary</article-title>
        <source>New Engl J. Med.</source>
        <year>2009a</year>
        <volume>360</volume>
        <fpage>2719</fpage>
        <lpage>2729</lpage>
        <pub-id pub-id-type="pmid">19516027</pub-id>
      </element-citation>
    </ref>
    <ref id="B15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shah</surname>
            <given-names>SP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mutational evolution in a lobular breast tumor profiled at single nucleotide resolution</article-title>
        <source>Nature</source>
        <year>2009b</year>
        <volume>461</volume>
        <fpage>809</fpage>
        <lpage>813</lpage>
        <pub-id pub-id-type="pmid">19812674</pub-id>
      </element-citation>
    </ref>
    <ref id="B16">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shendure</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ji</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Next-generation DNA sequencing</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2008</year>
        <volume>26</volume>
        <fpage>1135</fpage>
        <lpage>1145</lpage>
        <pub-id pub-id-type="pmid">18846087</pub-id>
      </element-citation>
    </ref>
    <ref id="B17">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stratton</surname>
            <given-names>MR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The cancer genome</article-title>
        <source>Nature</source>
        <year>2009</year>
        <volume>458</volume>
        <fpage>719</fpage>
        <lpage>724</lpage>
        <pub-id pub-id-type="pmid">19360079</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
