<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Methods</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Methods</journal-id>
    <journal-title-group>
      <journal-title>Nature Methods</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1548-7091</issn>
    <issn pub-type="epub">1548-7105</issn>
    <publisher>
      <publisher-name>Nature Publishing Group US</publisher-name>
      <publisher-loc>New York</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10250202</article-id>
    <article-id pub-id-type="pmid">37156842</article-id>
    <article-id pub-id-type="publisher-id">1873</article-id>
    <article-id pub-id-type="doi">10.1038/s41592-023-01873-4</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Resource</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>EmbryoNet: using deep learning to link embryonic phenotypes to signaling pathways</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5199-9940</contrib-id>
        <name>
          <surname>Čapek</surname>
          <given-names>Daniel</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Safroshkin</surname>
          <given-names>Matvey</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9578-2556</contrib-id>
        <name>
          <surname>Morales-Navarrete</surname>
          <given-names>Hernán</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3505-7325</contrib-id>
        <name>
          <surname>Toulany</surname>
          <given-names>Nikan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Arutyunov</surname>
          <given-names>Grigory</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kurzbach</surname>
          <given-names>Anica</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bihler</surname>
          <given-names>Johanna</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hagauer</surname>
          <given-names>Julia</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kick</surname>
          <given-names>Sebastian</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jones</surname>
          <given-names>Felicity</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jordan</surname>
          <given-names>Ben</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0702-6209</contrib-id>
        <name>
          <surname>Müller</surname>
          <given-names>Patrick</given-names>
        </name>
        <address>
          <email>patrick.mueller@uni-konstanz.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.9811.1</institution-id><institution-id institution-id-type="ISNI">0000 0001 0658 7699</institution-id><institution>Systems Biology of Development, </institution><institution>University of Konstanz, </institution></institution-wrap>Konstanz, Germany </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.418026.9</institution-id><institution-id institution-id-type="ISNI">0000 0004 0492 0357</institution-id><institution>Friedrich Miescher Laboratory of the Max Planck Society, </institution></institution-wrap>Tübingen, Germany </aff>
      <aff id="Aff3"><label>3</label>Computer Vision Studio, Tübingen, Germany </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.517314.5</institution-id><institution>Centre for the Advanced Study of Collective Behaviour, </institution></institution-wrap>Konstanz, Germany </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>8</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>8</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <year>2023</year>
    </pub-date>
    <volume>20</volume>
    <issue>6</issue>
    <fpage>815</fpage>
    <lpage>823</lpage>
    <history>
      <date date-type="received">
        <day>26</day>
        <month>9</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>5</day>
        <month>4</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Evolutionarily conserved signaling pathways are essential for early embryogenesis, and reducing or abolishing their activity leads to characteristic developmental defects. Classification of phenotypic defects can identify the underlying signaling mechanisms, but this requires expert knowledge and the classification schemes have not been standardized. Here we use a machine learning approach for automated phenotyping to train a deep convolutional neural network, EmbryoNet, to accurately identify zebrafish signaling mutants in an unbiased manner. Combined with a model of time-dependent developmental trajectories, this approach identifies and classifies with high precision phenotypic defects caused by loss of function of the seven major signaling pathways relevant for vertebrate development. Our classification algorithms have wide applications in developmental biology and robustly identify signaling defects in evolutionarily distant species. Furthermore, using automated phenotyping in high-throughput drug screens, we show that EmbryoNet can resolve the mechanism of action of pharmaceutical substances. As part of this work, we freely provide more than 2 million images that were used to train and test EmbryoNet.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">EmbryoNet is an automated approach to the phenotyping of developing embryos that surpasses experts in terms of speed, accuracy and sensitivity. A large annotated image dataset of zebrafish, medaka and stickleback development rounds out this resource.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Embryogenesis</kwd>
      <kwd>Machine learning</kwd>
      <kwd>Image processing</kwd>
      <kwd>High-throughput screening</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100010663</institution-id>
            <institution>EC | EU Framework Programme for Research and Innovation H2020 | H2020 Priority Excellent Science | H2020 European Research Council (H2020 Excellent Science - European Research Council)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>863952</award-id>
        <principal-award-recipient>
          <name>
            <surname>Müller</surname>
            <given-names>Patrick</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100001659</institution-id>
            <institution>Deutsche Forschungsgemeinschaft (German Research Foundation)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>EXC 2117 – 422037984</award-id>
        <principal-award-recipient>
          <name>
            <surname>Müller</surname>
            <given-names>Patrick</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100004189</institution-id>
            <institution>Max-Planck-Gesellschaft (Max Planck Society)</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>EMBO Young Investigator Programme</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100002428</institution-id>
            <institution>Austrian Science Fund (Fonds zur Förderung der Wissenschaftlichen Forschung)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>J-4507</award-id>
        <principal-award-recipient>
          <name>
            <surname>Čapek</surname>
            <given-names>Daniel</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>IZKF of the Medical Faculty of the University of Tübingen</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© Springer Nature America, Inc. 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Main</title>
    <p id="Par3">Early development is governed by a handful of signaling pathways that balance tissue growth, differentiation and morphogenesis<sup><xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref></sup>. Given their important roles in controlling cell identity and behavior, misregulation of signaling pathways in adult tissues can induce the formation of tumors with embryo-like properties, defective cell proliferation and migration<sup><xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR5">5</xref></sup>.</p>
    <p id="Par4">During zebrafish development, seven major signaling pathways orchestrate the formation of the body plan. Bone morphogenetic protein (BMP), retinoic acid (RA), Wnt, fibroblast growth factor (FGF) and Nodal pattern the germ layers and regulate the formation of the orthogonal anterior–posterior and dorsal–ventral axes; Sonic hedgehog (Shh) and planar cell polarity (PCP) signaling, in turn, control the elongation and morphogenesis of the body axis and later shape the formation of tissues<sup><xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR3">3</xref>,<xref ref-type="bibr" rid="CR6">6</xref>–<xref ref-type="bibr" rid="CR8">8</xref></sup>. The ligands activating these signaling pathways are dynamically expressed from specific source tissues in the embryo (Fig. <xref rid="Fig1" ref-type="fig">1a</xref> and Supplementary Note <xref rid="MOESM1" ref-type="media">1</xref>). Loss of activity in any of these pathways causes characteristic patterning defects, which, however, can be difficult to distinguish (Fig. <xref rid="Fig1" ref-type="fig">1b</xref> and Supplementary Videos <xref rid="MOESM5" ref-type="media">1</xref>–<xref rid="MOESM12" ref-type="media">8</xref>). For example, both Nodal and Shh mutants have cyclopic eyes (Fig. <xref rid="Fig1" ref-type="fig">1b</xref> and Supplementary Videos <xref rid="MOESM10" ref-type="media">6</xref> and <xref rid="MOESM11" ref-type="media">7</xref>), but the defect in Nodal mutants is caused by an early lack of mesoderm<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>, whereas cyclopia in Shh mutants is caused by a late defect in midline patterning<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. Furthermore, while misregulation of the BMP, Wnt, RA, FGF and PCP signaling pathways leads to specific defects, for example, an enlarged head in the case of Wnt mutants<sup><xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR12">12</xref></sup>, all of these mutants also have malformed shortened tails<sup><xref ref-type="bibr" rid="CR13">13</xref>–<xref ref-type="bibr" rid="CR17">17</xref></sup> (Fig. <xref rid="Fig1" ref-type="fig">1b</xref> and Supplementary Videos <xref rid="MOESM6" ref-type="media">2</xref>–<xref rid="MOESM9" ref-type="media">5</xref>, <xref rid="MOESM12" ref-type="media">8</xref>). Thus, the phenotypes caused by changes in the activity of different signaling pathways can be easily confused by even the most experienced developmental biologists. Automated and unbiased phenotyping based on a multitude of morphological features would overcome this challenge. Such an approach would rapidly link phenotypes arising from genetic defects, mutants identified in forward and reverse genetic screens, or treatment with small-molecule inhibitors to the relevant signaling pathway. Automated phenotyping of morphological defects would thus enhance both the speed and accuracy of biological and pharmaceutical discovery.<fig id="Fig1"><label>Fig. 1</label><caption><title>The CNN EmbryoNet robustly identifies molecular defects based on phenotype data.</title><p><bold>a</bold>, Simplified schematic of signaling domains during zebrafish development projected onto an early embryo. <bold>b</bold>, Schematic drawings of zebrafish embryo phenotypes. −BMP loss of function causes reduced and often curled tails, +RA gain-of-function embryos lack head structures and have shortened tails, −Wnt leads to enlarged heads and shortened tails, −FGF causes loss of mesoderm and tail tissue, −Nodal embryos lack mesoderm and have cyclopia, −Shh embryos frequently have mispatterned somites and cyclopia, and −PCP leads to a shortened and widened body axis, manifested, for example, by shorter somites. <bold>c</bold>,<bold>d</bold>, Treatment with the chemical Nodal inhibitor SB-505124 caused specific phenotypes that were not yet apparent at sphere stage (<bold>c (i)</bold>), but which were clearly visible at segmentation stages (<bold>c (ii)</bold>); <italic>n</italic> = 36. The inhibitor treatment (<bold>c (iii)</bold>) phenocopied the MZ<italic>oep</italic> (<bold>d</bold>) mutant, and both phenotypes were robustly identified by EmbryoNet; <italic>n</italic> = 58. <bold>e</bold>,<bold>f</bold>, Schematic overview of the neural network architecture with convolutional (Conv) layers shown in blue. Stack sizes after each image filter are illustrated in <bold>e</bold>, whereas <bold>f</bold> details the filters of the network. Relu, rectified linear unit. <bold>g</bold>–<bold>i</bold>, EmbryoNet correctly classified embryos in a mixed population. <bold>g</bold>, Experimental set-up. Embryos at the one-cell stage were injected with mRNA encoding the Nodal inhibitor Lefty1 and Alexa647-labeled dextran (magenta), mRNA encoding the BMP inhibitor Chordin and Alexa488-labeled dextran (green), or were left uninjected (wild type) and then imaged. Black bounding boxes indicate the class Unknown; green indicates −Nodal; red indicates −BMP; white indicates Normal and magenta indicates Dead. <bold>h</bold>, At the sphere stage, EmbryoNet labeled the phenotypes as Unknown. Dextran-labeling shows the applied treatment. <bold>i</bold>, During segmentation stages the Normal, −BMP and −Nodal samples were correctly identified by EmbryoNet. The classification is in accordance with the dextran colors; <italic>n</italic> = 85. Scale bar, 500 µm.</p></caption><graphic xlink:href="41592_2023_1873_Fig1_HTML" id="d32e522"/></fig></p>
    <p id="Par5">Advances in deep learning approaches<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> have brought unprecedented breakthroughs in numerous fields ranging from bioimage analysis and visual object recognition<sup><xref ref-type="bibr" rid="CR19">19</xref></sup> to protein structure prediction<sup><xref ref-type="bibr" rid="CR20">20</xref>–<xref ref-type="bibr" rid="CR23">23</xref></sup> and earth system science<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>. Deep learning approaches perform exceptionally well in decoding the content of images<sup><xref ref-type="bibr" rid="CR25">25</xref>,<xref ref-type="bibr" rid="CR26">26</xref></sup>, and convolutional neural networks (CNNs) in particular have been extensively used for bioimage restoration<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>, cell detection and classification<sup><xref ref-type="bibr" rid="CR28">28</xref></sup> and bioimage data segmentation<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>. Recent studies have also used machine learning approaches to examine embryonic phenotypes<sup><xref ref-type="bibr" rid="CR30">30</xref>–<xref ref-type="bibr" rid="CR36">36</xref></sup>, but these approaches were limited to staging, segmentation and classification of specific embryos and organs without being able to uncover the molecular basis of morphological alterations.</p>
    <p id="Par6">Here, we introduce a deep learning approach, EmbryoNet, that can detect specific defects linked to the seven major vertebrate signaling pathways by automated phenotyping. EmbryoNet was trained on more than 2 million images, comprising thousands of trajectories of normally developing and signaling-defective zebrafish embryos. We found that EmbryoNet identified phenotypes more precisely and often long before human evaluators could detect them. By using the accelerated phenotype classification of EmbryoNet in an automated drug screen, we identified novel teratogenic effects caused by Food and Drug Administration (FDA)-approved substances not previously associated with the regulation of developmental signaling pathways. Finally, we show that EmbryoNet can identify signaling defects in evolutionarily distant species, demonstrating the generalizability of our approach.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>Identification of signaling defects in zebrafish embryos</title>
      <p id="Par7">To test whether deep learning approaches can be used for the automatic classification of complex phenotypes caused by the loss of signaling pathways in zebrafish, we combined high-throughput imaging with specific drug-mediated loss-of-function approaches. We started with proof-of-concept experiments focused on Nodal signaling because both the signaling pathway constituents and their functions during the first day of zebrafish embryogenesis are well described<sup><xref ref-type="bibr" rid="CR37">37</xref></sup> (Supplementary Note <xref rid="MOESM1" ref-type="media">1</xref> and Fig. <xref rid="Fig1" ref-type="fig">1a</xref>). In addition, a specific small molecule targeting the ATP-binding pocket of the receptor kinase is available<sup><xref ref-type="bibr" rid="CR38">38</xref></sup> (Supplementary Note <xref rid="MOESM1" ref-type="media">2</xref>), facilitating the rapid acquisition of defined developmental phenotypes from a large number of embryos. Indeed, the inhibitor SB-505124 clearly recapitulated the known loss-of-function phenotypes of Nodal signaling pathway components<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>, that is, cyclopia and loss of all endoderm and head–trunk mesoderm (Fig. <xref rid="Fig1" ref-type="fig">1a–c</xref> and Supplementary Video <xref rid="MOESM10" ref-type="media">6</xref>). We then acquired bright-field movies of SB-505124-treated and untreated embryos in random orientations, comprising a total of 342,559 images between 2 and 26 hours post-fertilization (h.p.f.). A modified version of the ResNet18 CNN that includes a timestamp of the images (Fig. <xref rid="Fig1" ref-type="fig">1e,f</xref> and <xref rid="Sec9" ref-type="sec">Methods</xref>)<sup><xref ref-type="bibr" rid="CR40">40</xref></sup> trained with these datasets robustly and correctly identified normal and Nodal-defective embryos, independent of their orientation and whether small molecules (SB-505124) or mutants (maternal zygotic <italic>oep</italic> mutants, MZ<italic>oep</italic><sup><xref ref-type="bibr" rid="CR41">41</xref></sup>) were used to create Nodal loss-of-function phenotypes (Fig. <xref rid="Fig1" ref-type="fig">1c,d</xref> and Extended Data Fig. <xref rid="Fig5" ref-type="fig">1</xref>).</p>
      <p id="Par8">We next extended this approach to the seven major signaling pathways that control early development: BMP, RA, Wnt, FGF, Nodal, Shh and PCP (Fig. <xref rid="Fig1" ref-type="fig">1a,b</xref>). Using a chemical genetics approach with specific signaling pathway modulators<sup><xref ref-type="bibr" rid="CR38">38</xref>,<xref ref-type="bibr" rid="CR42">42</xref>–<xref ref-type="bibr" rid="CR45">45</xref></sup> (Supplementary Table <xref rid="MOESM4" ref-type="media">1</xref> and Supplementary Note <xref rid="MOESM1" ref-type="media">2</xref>), we created a dataset of more than 2 million images with loss-of-function (or gain-of-function in the case of RA) phenotypes (Supplementary Videos <xref rid="MOESM5" ref-type="media">1</xref>–<xref rid="MOESM12" ref-type="media">8</xref>). The dataset was manually annotated by curators who were informed about the treatment of each embryo. The curators assigned classes appropriate for each treatment (that is, <italic>−</italic>BMP, +RA, −Wnt, −FGF, −Nodal, −Shh and −PCP) at the developmental timepoint when the phenotype first became apparent for a given embryo. The class Unknown was assigned when an image did not contain sufficient information for classification, and the class Dead was assigned if an embryo disintegrated over the course of development. In addition, each image was assigned a timestamp for classification (Fig. <xref rid="Fig1" ref-type="fig">1f</xref>). This high-confidence dataset was then used to train a large-scale CNN with accelerated graphics processing unit computing (<xref rid="Sec9" ref-type="sec">Methods</xref> and Supplementary Tables <xref rid="MOESM4" ref-type="media">2</xref> and <xref rid="MOESM4" ref-type="media">3</xref>).</p>
      <p id="Par9">To correct for potential classification errors, we introduced a model transition logic based on our knowledge of developmental changes: in very early embryos, phenotypic differences are not yet apparent because signaling changes result in morphological changes only at later stages<sup><xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref></sup>. These early embryos, characterized by the phenotype class Unknown, can then transition to another phenotype class (−BMP, +RA, −Wnt, −FGF, −Nodal, −Shh and −PCP) and can also change to Dead at any point in time (Extended Data Fig. <xref rid="Fig5" ref-type="fig">1c</xref>). However, certain transitions, for example, from Dead to Normal, are not possible. We therefore assigned a cost to every state transition in an individual embryo track and scored the cost for different models. The transition sequence that achieved the lowest cost was selected for classification. This approach yielded a classification performance of 89%. The deep learning-based classification network, termed EmbryoNet, was able to robustly identify the loss-of-function phenotypes caused by orthogonal approaches such as the injection of messenger RNAs (mRNAs) encoding the Nodal and BMP pathway inhibitors Lefty1 and Chordin, respectively (Fig. <xref rid="Fig1" ref-type="fig">1g–i</xref>, Supplementary Note <xref rid="MOESM1" ref-type="media">2</xref> and Extended Data Fig. <xref rid="Fig5" ref-type="fig">1f,g</xref>). EmbryoNet’s algorithms for the detection, tracking, manual and automatic classification of embryos are available as easy-to-use, modular and open-source graphical user interface (GUI) software (Extended Data Fig. <xref rid="Fig5" ref-type="fig">1e</xref>; <ext-link ext-link-type="uri" xlink:href="http://github.com/mueller-lab/EmbryoNet">http://github.com/mueller-lab/EmbryoNet</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://embryonet.uni-konstanz.de">http://embryonet.uni-konstanz.de</ext-link>).</p>
    </sec>
    <sec id="Sec4">
      <title>EmbryoNet is proficient, fast and accurate</title>
      <p id="Par10">To evaluate EmbryoNet’s performance, we tested its classification speed and accuracy in competition with human assessors. We generated stacks of 98 embryo images, representing the full spectrum of our phenotype classes. These images had not been used previously for the training of EmbryoNet, and information about the specific treatment of each embryo was not disclosed to the assessors.</p>
      <p id="Par11">Random guessing resulted in an accuracy of 9% (F-score = 0.09; Fig. <xref rid="Fig2" ref-type="fig">2a</xref> and Supplementary Table <xref rid="MOESM4" ref-type="media">4</xref>). The images were then classified by non-experts. These 55 teams, each consisting of two assessors with a biology background, received 1 day of developmental biology training with a focus on developmental defects caused by modulated signaling in zebrafish (Supplementary Videos <xref rid="MOESM5" ref-type="media">1</xref>–<xref rid="MOESM12" ref-type="media">8</xref>, Fig. <xref rid="Fig2" ref-type="fig">2b</xref> and Extended Data Figs. <xref rid="Fig6" ref-type="fig">2</xref> and <xref rid="Fig7" ref-type="fig">3</xref>). We encouraged the assessors to discuss the phenotypes to make the best classification choice. On average, non-experts confidently identified the class Dead but identified signaling defects with an overall accuracy of only 53% (F-score = 0.52; Fig. <xref rid="Fig2" ref-type="fig">2b</xref>, Extended Data Fig. <xref rid="Fig6" ref-type="fig">2</xref> and Supplementary Tables <xref rid="MOESM4" ref-type="media">5</xref> and <xref rid="MOESM4" ref-type="media">6</xref>), even when temporal information about the developmental stage was provided (accuracy of 54%, F-score = 0.52; Fig. <xref rid="Fig2" ref-type="fig">2c</xref>, Extended Data Fig. <xref rid="Fig7" ref-type="fig">3</xref> and Supplementary Tables <xref rid="MOESM4" ref-type="media">5</xref> and <xref rid="MOESM4" ref-type="media">7</xref>). The images were next classified by an expert assessor, an experienced developmental biologist with several years of relevant background in early zebrafish embryogenesis. The expert confidently identified embryonic phenotypes across classes with an overall accuracy of 79% (F-score = 0.78; Fig. <xref rid="Fig2" ref-type="fig">2d</xref> and Supplementary Tables <xref rid="MOESM4" ref-type="media">5</xref> and <xref rid="MOESM4" ref-type="media">8</xref>). Strikingly, EmbryoNet outperformed both expert and non-expert human assessors on these images: it completed the task in a few seconds and with an overall accuracy of 91% (F-score = 0.90; Fig. <xref rid="Fig2" ref-type="fig">2e</xref> and Supplementary Tables <xref rid="MOESM4" ref-type="media">5</xref> and <xref rid="MOESM4" ref-type="media">9</xref>), comparable to the performance across the entire validation dataset (see above).<fig id="Fig2"><label>Fig. 2</label><caption><title>Classification of 98 single embryo images by non-expert teams, experienced researchers and EmbryoNet.</title><p><bold>a</bold>–<bold>e</bold>, Schematic set-ups and confusion matrices showing the classification of the respective labeler compared with the ground truth (human annotation, treatment known). Classification performance is shown as a heatmap and fractions of 1 for the classification of 98 single images by a pseudo-random number generator (<bold>a</bold>), by a non-expert team without (<bold>b</bold>) or with (<bold>c</bold>) additionally provided time information (average performance), by an experienced researcher (<bold>d</bold>) and by EmbryoNet (<bold>e</bold>). <bold>f</bold>, Schematic of embryo detection over time. To allow for earlier detection, we annotated the training data 4 h before (blue time frame) the timepoint at which they could be robustly annotated by a labeler aware of the treatment (pink time frame). The embryo sketches show the phenotype of Nodal-inhibited samples at the respective time. The resulting network with earlier detection was termed ‘EmbryoNet-Prime’. <bold>g</bold>, Characteristic times of detection for each class based on the assessment of human experts, EmbryoNet and EmbryoNet-Prime. <italic>n</italic><sub>Normal</sub> = 74, <italic>n</italic><sub>−BMP</sub> = 119, <italic>n</italic><sub>+RA</sub> = 66, <italic>n</italic><sub>−Wnt</sub> = 70, <italic>n</italic><sub>−FGF</sub> = 74, <italic>n</italic><sub>−Nodal</sub> = 110, <italic>n</italic><sub>−Shh</sub> = 63, <italic>n</italic><sub>−PCP</sub> = 57. <bold>h</bold>–<bold>j</bold>, Classification performance in the early detection of phenotypes. Confusion matrices show the classification of image series by the respective labeler compared with the ground truth (human annotation, treatment known; detection time shifted to 4 h earlier). The number of analyzed images is shown in Supplementary Tables <xref rid="MOESM4" ref-type="media">20</xref>–<xref rid="MOESM4" ref-type="media">22</xref>.</p></caption><graphic xlink:href="41592_2023_1873_Fig2_HTML" id="d32e878"/></fig></p>
      <p id="Par12">To test whether context-dependent information could improve human classification performance, we asked two human experts to classify additional time-series experiments. Information about the specific treatment for each embryo was not disclosed to the assessors, but they were aware that all embryos in one video received the same treatment. Human classification performance slightly increased to an overall accuracy of 83% (F-score = 0.84). EmbryoNet still outperformed the human experts with an accuracy of 90% (F-score = 0.90), especially for the classification of the most difficult and subtle phenotypes (−Shh and −PCP) with F-scores of 0.54 (−PCP) and 0.72 (−Shh) compared with the human F-scores of 0.04 and 0.36, respectively (Extended Data Fig. <xref rid="Fig8" ref-type="fig">4a–d</xref> and Supplementary Tables <xref rid="MOESM4" ref-type="media">10</xref>–<xref rid="MOESM4" ref-type="media">15</xref>). In addition, EmbryoNet accurately identified phenotypes that were not fully penetrant, such as weaker BMP<sup><xref ref-type="bibr" rid="CR14">14</xref></sup> and Nodal defects<sup><xref ref-type="bibr" rid="CR46">46</xref></sup> (Extended Data Fig. <xref rid="Fig9" ref-type="fig">5</xref> and Supplementary Tables <xref rid="MOESM4" ref-type="media">16</xref>–<xref rid="MOESM4" ref-type="media">19</xref>).</p>
      <p id="Par13">Given EmbryoNet’s performance in identifying subtle phenotypes, we hypothesized that we could leverage artificial intelligence to detect very early embryonic defects before they would be recognized by human experts. We therefore retrained EmbryoNet by moving the relevant developmental timepoint corresponding to each treatment class to 4 hours earlier, before the phenotype was obvious to a human annotator (Fig. <xref rid="Fig2" ref-type="fig">2f</xref>). Strikingly, the resulting network, EmbryoNet-Prime, was able to identify Nodal loss-of-function phenotypes at the beginning of gastrulation, several hours before human annotators could confidently recognize them (Extended Data Fig. <xref rid="Fig10" ref-type="fig">6</xref>), with an accuracy of 90% (F-score = 0.93; Fig. <xref rid="Fig2" ref-type="fig">2h–j</xref>, Extended Data Fig. <xref rid="Fig8" ref-type="fig">4e</xref> and Supplementary Tables <xref rid="MOESM4" ref-type="media">10</xref> and <xref rid="MOESM4" ref-type="media">20</xref>–<xref rid="MOESM4" ref-type="media">24</xref>). Similarly, the network detected the −BMP, +RA, −Wnt, −Shh and −PCP phenotypes on average 2–3 hours earlier (Fig. <xref rid="Fig2" ref-type="fig">2g</xref> and Extended Data Fig. <xref rid="Fig10" ref-type="fig">6</xref>), consistent with the known expression and activation profiles of the signaling molecules (Supplementary Note <xref rid="MOESM1" ref-type="media">1</xref>).</p>
    </sec>
    <sec id="Sec5">
      <title>EmbryoNet recognizes known and latent defect features</title>
      <p id="Par14">What could be the features that are detected by EmbryoNet-Prime, which facilitate earlier classification compared with human assessors? To address this question, we leveraged class activation map (CAM) visualization<sup><xref ref-type="bibr" rid="CR47">47</xref></sup>, which can be used to perform object localization without additional annotation by projecting the probability of the trained classes onto an input image. The resulting CAM should show the discriminative image regions used by the CNN to identify a class: positively activated domains should highlight image regions that support a particular class, whereas negative domains should show regions that oppose that class (Fig. <xref rid="Fig3" ref-type="fig">3</xref> and Supplementary Note <xref rid="MOESM1" ref-type="media">3</xref>).<fig id="Fig3"><label>Fig. 3</label><caption><title>Embryo features activating the neural network.</title><p>Class activation heatmaps based on the last convolutional layer of EmbryoNet-Prime showing the part of the image that activates the network at the given timepoint for normal (<bold>a</bold>) and signaling-defective embryos (<bold>b</bold>–<bold>h</bold>). Every signaling-defective embryo (−BMP (<bold>b</bold>), +RA (<bold>c</bold>), −Wnt (<bold>d</bold>), −FGF (<bold>e</bold>), −Nodal (<bold>f</bold>), −Shh (<bold>g</bold>), −PCP (<bold>h</bold>)) is displayed in all classification channels, but only the classification channels corresponding to the correct signaling manipulation show warm colors. The percentages represent the probability of detection. See Supplementary Note <xref rid="MOESM1" ref-type="media">3</xref> for sample sizes. Also see Supplementary Videos <xref rid="MOESM13" ref-type="media">9</xref>–<xref rid="MOESM28" ref-type="media">24</xref>. <bold>i</bold>–<bold>k</bold>, Selected embryos showing defects highlighted by the corresponding class activation heatmaps for −Wnt at 13.4 h.p.f. (<bold>i</bold>) and −Nodal at 10.6 h.p.f. (<bold>j</bold>) and 26 h.p.f. (<bold>k</bold>). Scale bars, 500 µm.</p></caption><graphic xlink:href="41592_2023_1873_Fig3_HTML" id="d32e1023"/></fig></p>
      <p id="Par15">To evaluate the utility of CAM visualization, we first examined steep and sudden switches in classification. For example, BMP-inhibited embryos frequently disintegrate (Supplementary Video <xref rid="MOESM6" ref-type="media">2</xref>), switching from −BMP to Dead in terms of classification. Indeed, this classification switch can be observed in EmbryoNet-Prime’s CAMs. Once −BMP embryos disintegrate, their CAMs in the −BMP channel immediately show negative activation accompanied by a positive activation in the CAMs for the Dead class (Supplementary Videos <xref rid="MOESM15" ref-type="media">11</xref> and <xref rid="MOESM16" ref-type="media">12</xref>). These results indicate that CAM visualization can provide insight into the logic of phenotype classification.</p>
      <p id="Par16">Using this approach, we found that EmbryoNet-Prime identified known defects caused by the disruption of signaling pathways, but also detected latent features at an earlier developmental stage compared with human assessors. For example, Wnt mutants are known to exhibit prominent tail bud and head defects at 24 h.p.f.<sup><xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR12">12</xref></sup>. EmbryoNet-Prime was indeed activated in these regions at late stages (Fig. <xref rid="Fig3" ref-type="fig">3i</xref>). Strikingly, during early segmentation the whole body-axis already showed activation (Supplementary Videos <xref rid="MOESM19" ref-type="media">15</xref> and <xref rid="MOESM20" ref-type="media">16</xref>), and the detection of head and tail defects also occurred as early as the bud stage (Fig. <xref rid="Fig3" ref-type="fig">3d</xref>, Extended Data Fig. <xref rid="Fig10" ref-type="fig">6</xref> and Supplementary Videos <xref rid="MOESM19" ref-type="media">15</xref> and <xref rid="MOESM20" ref-type="media">16</xref>). Thus, −Wnt embryos were detected earlier by EmbryoNet-Prime than by human assessors (Fig. <xref rid="Fig2" ref-type="fig">2g</xref> and Extended Data Fig. <xref rid="Fig10" ref-type="fig">6</xref>). Similarly, late-stage classification of −Nodal embryos by EmbryoNet-Prime relied on well-known defects in the ectodermal thickening (Fig. <xref rid="Fig3" ref-type="fig">3j</xref>), head, tail and trunk regions (Fig. <xref rid="Fig3" ref-type="fig">3k</xref>). Surprisingly, however, EmbryoNet-Prime was also able to classify early-stage −Nodal embryos (~6 h.p.f.; Supplementary Video <xref rid="MOESM23" ref-type="media">19</xref>) based on latent defects. The detection started with activation at the margin (Fig. <xref rid="Fig3" ref-type="fig">3f</xref> and Supplementary Videos <xref rid="MOESM23" ref-type="media">19</xref> and <xref rid="MOESM24" ref-type="media">20</xref>) and continued with activation spots at the border between yolk and blastoderm, directly adjacent to the embryo proper. Although this fits well with known regions of Nodal expression and activity<sup><xref ref-type="bibr" rid="CR37">37</xref>,<xref ref-type="bibr" rid="CR48">48</xref>,<xref ref-type="bibr" rid="CR49">49</xref></sup>, it will be interesting to determine how these molecular signatures manifest in latent cellular and morphological features.</p>
    </sec>
    <sec id="Sec6">
      <title>EmbryoNet can identify novel signaling modulators</title>
      <p id="Par17">High-content image-based drug screens can be used to identify novel compounds affecting cellular phenotypes. However, large-scale drug screens assessing whole phenomes with rich biological information<sup><xref ref-type="bibr" rid="CR50">50</xref></sup> are currently hampered by the need to visually assess a very large number of images, and are further complicated by the potential ambiguity of defects and variability between assessors. To determine whether EmbryoNet could be used to link chemical manipulations to signaling-based phenotypic defects, we performed a large-scale zebrafish screen using FDA-approved and bioactive compounds (Fig. <xref rid="Fig4" ref-type="fig">4a</xref>).<fig id="Fig4"><label>Fig. 4</label><caption><title>Applications of EmbryoNet in drug screening and other species.</title><p><bold>a</bold>,<bold>b</bold>, Automated phenotype-based drug screening. <bold>a</bold>, Schematic of the phenomic drug screen. Embryos were exposed to compounds in 96-well plates and imaged for 24 h. Phenotypes were classified automatically by EmbryoNet. <bold>b</bold>, Layout of BML-2843 library plate 2 with majority phenotype classification for each well. Simvastatin in well H-02 was classified as −FGF. <bold>c</bold>, Statins identified by EmbryoNet in the drug screen caused body axis defects similar to −FGF loss-of-function phenotypes. <bold>d</bold>, Representative immunofluorescence images of the FGF signaling transducer pErk in untreated and statin-treated embryos, respectively. The representative images have pErk profiles that are closest to the mean signaling profile of each group. Images are shown at the same contrast and brightness. The inserted lower panels show cell nuclei labeled with DRAQ7. <bold>e</bold>, Quantification of background-subtracted pErk fluorescence intensity gradients in wild-type (black), simvastatin-treated (blue), atorvastatin-treated (yellow) and lovastatin-treated (green) embryos along the marginal-to-animal pole axis. The error envelopes show s.e.m. <bold>f</bold>,<bold>g</bold>, Extension of EmbryoNet to other species. <bold>f</bold>, Images of wild-type (left) and Nodal-deficient (right) medaka embryos with the confusion matrix of classification performance. <bold>g</bold>, Images of wild-type (left) and Nodal-deficient (right) three-spined stickleback embryos with the confusion matrix of classification performance. Black arrows point to somites in healthy embryos, while red arrows point out missing somites. The red arrowhead shows a mispatterned central nervous system. Scale bars: 500 µm (<bold>c</bold>,<bold>f</bold>,<bold>g</bold>) and 200 µm (<bold>d</bold>).</p></caption><graphic xlink:href="41592_2023_1873_Fig4_HTML" id="d32e1169"/></fig></p>
      <p id="Par18">We screened approximately 1,000 compounds using 96-well plates containing four to five zebrafish embryos per well. The screen spanned 2–26 h.p.f. We first tested well-known viability modulators with characterized mechanisms of action such as aphidicolin, bafilomycin A1, blebbistatin, brefeldin A, cycloheximide, cytochalasin B, latrunculin B, staurosporin, trichostatin A, tunicamycin and vinblastine. EmbryoNet reliably classified embryos treated with these substances as Dead, while classifying mock-treated embryos as Normal (Supplementary Tables <xref rid="MOESM4" ref-type="media">25</xref>–<xref rid="MOESM4" ref-type="media">35</xref>, Extended Data Figs. <xref rid="Fig11" ref-type="fig">7</xref> and <xref rid="Fig12" ref-type="fig">8</xref> and Supplementary Videos <xref rid="MOESM29" ref-type="media">25</xref>–<xref rid="MOESM39" ref-type="media">35</xref>). EmbryoNet also correctly detected known modulators of signaling pathways, such as the RA agonists all-trans-retinoic acid and TTNPB (Extended Data Fig. <xref rid="Fig11" ref-type="fig">7</xref> and Supplementary Table <xref rid="MOESM4" ref-type="media">26</xref>).</p>
      <p id="Par19">Importantly, for some small molecules we identified previously unrecognized effects on signaling pathways in embryos. This group includes several hydroxymethylglutaryl-coenzyme A reductase inhibitors, a class of compounds also known as statins<sup><xref ref-type="bibr" rid="CR51">51</xref>–<xref ref-type="bibr" rid="CR54">54</xref></sup>. Interestingly, embryos treated with several statins, including simvastatin, atorvastatin and lovastatin, were classified as −FGF by EmbryoNet (Fig. <xref rid="Fig4" ref-type="fig">4b</xref>, Supplementary Videos <xref rid="MOESM40" ref-type="media">36</xref>–<xref rid="MOESM42" ref-type="media">38</xref> and Supplementary Tables <xref rid="MOESM4" ref-type="media">29</xref>, <xref rid="MOESM4" ref-type="media">32</xref> and <xref rid="MOESM4" ref-type="media">35</xref>). Consistent with the −FGF classification, embryos treated with these drugs showed defects in dorsal–ventral patterning<sup><xref ref-type="bibr" rid="CR51">51</xref>,<xref ref-type="bibr" rid="CR52">52</xref></sup> and had loss of posterior tissues typical of −FGF embryos<sup><xref ref-type="bibr" rid="CR13">13</xref>,<xref ref-type="bibr" rid="CR55">55</xref>–<xref ref-type="bibr" rid="CR57">57</xref></sup> (Fig. <xref rid="Fig4" ref-type="fig">4c</xref>). Strikingly, the activity of the FGF signal transducer pErk was also reduced in statin-treated compared with untreated embryos (Fig. <xref rid="Fig4" ref-type="fig">4d,e</xref>), possibly due to dampened isoprenylation of the upstream small GTPase Ras<sup><xref ref-type="bibr" rid="CR58">58</xref></sup>. According to patient information regarding side-effects and databases of potentially embryotoxic teratogenic therapeutics, the intake of selected hydroxymethylglutaryl-coenzyme A reductase inhibitors such as lovastatin is not recommended during pregnancy and lactation (Supplementary Note <xref rid="MOESM1" ref-type="media">4</xref>). Notably, simvastatin is recommended as a substitute, although EmbryoNet detected the same defects in response to this drug. However, the bioavailability in zebrafish compared with human cells is currently unclear.</p>
      <p id="Par20">In summary, our drug screen shows that EmbryoNet can be used to identify teratogenic effects caused by bioactive compounds and to associate them with signaling pathways.</p>
    </sec>
    <sec id="Sec7">
      <title>Generalization of EmbryoNet to other species</title>
      <p id="Par21">To test the generalizability of our approach, we next applied EmbryoNet to identify signaling defects in the evolutionarily distant species medaka (<italic>Oryzias latipes</italic>) and three-spined stickleback (<italic>Gasterosteus aculeatus</italic>). These fish diverged from zebrafish hundreds of millions of years ago<sup><xref ref-type="bibr" rid="CR59">59</xref>,<xref ref-type="bibr" rid="CR60">60</xref></sup>. We adjusted the imaging length of our recordings to match the slower developmental speed of both species<sup><xref ref-type="bibr" rid="CR61">61</xref>,<xref ref-type="bibr" rid="CR62">62</xref></sup> and modified species-specific parameters such as temperature, number of embryos per well and drug concentration as needed.</p>
      <p id="Par22">We found that in both medaka and stickleback, wild-type animals had well-formed somites (Fig. <xref rid="Fig4" ref-type="fig">4f,g</xref>, black arrows) and eyes (Supplementary Videos <xref rid="MOESM43" ref-type="media">39</xref> and <xref rid="MOESM45" ref-type="media">41</xref>), while Nodal-inhibited embryos showed a loss of somites (Fig. <xref rid="Fig4" ref-type="fig">4f,g</xref>, red arrows) concomitant with severe central nervous system defects and frequent cyclopia (Fig. <xref rid="Fig4" ref-type="fig">4f</xref>, red arrowhead; Supplementary Videos <xref rid="MOESM44" ref-type="media">40</xref> and <xref rid="MOESM46" ref-type="media">42</xref>). After training with these datasets, EmbryoNet robustly identified wild-type and Nodal-inhibited individuals in both species (Fig. <xref rid="Fig4" ref-type="fig">4f,g</xref>). These results support the broad applicability of EmbryoNet in identifying signaling-based complex phenotypic defects in different species.</p>
    </sec>
  </sec>
  <sec id="Sec8" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par23">Phenome refers to the entire set of phenotypes of an organism over time, and phenomics has emerged as a promising approach for connecting these phenotypes with the underlying genotypes and environmental influences<sup><xref ref-type="bibr" rid="CR50">50</xref></sup>. A quantitative understanding of how the phenome changes in response to genetic mutations and environmental stimuli would be highly informative, but phenomics requires the processing of large amounts of high-dimensional data<sup><xref ref-type="bibr" rid="CR36">36</xref>,<xref ref-type="bibr" rid="CR63">63</xref>–<xref ref-type="bibr" rid="CR66">66</xref></sup>. Computer vision and machine learning techniques are therefore promising approaches for advancing this field and indeed are increasingly being applied in plant and crop phenomics<sup><xref ref-type="bibr" rid="CR67">67</xref></sup>. Here, we present a machine learning-assisted method for the robust phenomic analysis of developmental defects during vertebrate embryogenesis.</p>
    <p id="Par24">The automated phenotyping tool that we developed, EmbryoNet, is based on CNNs. Strikingly, EmbryoNet outcompeted human assessors in terms of speed, accuracy and sensitivity. Assessing zebrafish embryos, EmbryoNet was able to quickly and accurately link phenotypes to major signaling pathways, including classifying incompletely penetrant phenotypes. We were also able to retrain EmbryoNet for assessing other fish species separated from zebrafish by hundreds of millions of years in evolution, enabling the analysis of high-dimensional phenomic data in different taxa. EmbryoNet may thus be able to accelerate the characterization of developmental mutants in multiple species. Finally, in a proof-of-concept drug screen with two drug libraries, we showed that EmbryoNet correctly associated compounds with signaling functions. We therefore believe that this approach can be used to understand the signaling effects of various compounds and medications, thus opening up the possibility of applying drugs to new therapeutic contexts and applications.</p>
    <p id="Par25">While EmbryoNet offers significant advantages in identifying phenotypes at earlier developmental stages, there are some caveats and weaknesses to consider. It remains uncertain whether EmbryoNet can outperform humans in detecting very mild phenotypes, such as those caused by low drug concentrations. Additionally, its reliance on a library of manual annotations limits its ability to classify novel phenotypes, particularly those arising from the combinatorial disruption of signaling pathways. The rapid development of deep learning technologies could be leveraged to enhance EmbryoNet’s capabilities and help address EmbryoNet’s current limitations. By building on these technological breakthroughs, it may become possible in the future to bridge the genotype–phenotype gap and tackle the long-standing question of how diverse body plans are genetically encoded<sup><xref ref-type="bibr" rid="CR68">68</xref></sup>.</p>
    <p id="Par26">We provide EmbryoNet as open-source software, with Python packages, a GitHub repository and GUIs for labeling data and phenotype classification (<ext-link ext-link-type="uri" xlink:href="http://github.com/mueller-lab/EmbryoNet">http://github.com/mueller-lab/EmbryoNet</ext-link>). We also provide the training, testing and the drug screen imaging data as a resource to the community (<ext-link ext-link-type="uri" xlink:href="http://embryonet.uni-konstanz.de">http://embryonet.uni-konstanz.de</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://github.com/mueller-lab/EmbryoNet">http://github.com/mueller-lab/EmbryoNet</ext-link>). Due to its modular open-source nature, EmbryoNet can be easily adapted to a variety of purposes, including embryos of other species and organoids, in which automated phenotyping will expedite biological and pharmaceutical discovery.</p>
  </sec>
  <sec id="Sec9">
    <title>Methods</title>
    <sec id="Sec10">
      <title>Embryo preparation</title>
      <p id="Par27">The experiments were performed exclusively with embryos and larvae that were not yet freely feeding. All procedures and zebrafish, medaka and stickleback husbandry were carried out in accordance with the guidelines of the European Union directive 2010/63/EU and the German Animal Welfare Act as approved by the local authorities represented by the Regierungspräsidium Tübingen and the Regierungspräsidium Freiburg (Baden-Württemberg, Germany).</p>
      <p id="Par28">Zebrafish embryos of the TE strain were collected from batch crosses within 1 h after fertilization. Fertilized embryos were manually selected using a glass Pasteur pipette. At this timepoint, zebrafish embryos were between the 2- and 8-cell stages. A total of 10–20 embryos were pipetted into each well of a 24- or 48-well plate in 1 ml zebrafish embryo medium<sup><xref ref-type="bibr" rid="CR48">48</xref></sup>. Small-molecule signaling pathway agonists and antagonists were added by pipetting them into the filled well with the final concentrations listed in Supplementary Table <xref rid="MOESM4" ref-type="media">1</xref>. To obtain PCP phenotypes, 1 ng <italic>vangl2</italic>-targeting morpholino<sup><xref ref-type="bibr" rid="CR69">69</xref></sup> was injected at the one-cell stage. Shh treatment was carried out either by cyclopamine incubation or <italic>gli3R-GFP</italic> mRNA injection. For overexpression of signaling antagonists, 10 pg <italic>lefty1</italic> mRNA<sup><xref ref-type="bibr" rid="CR48">48</xref></sup> together with 0.1 ng of 10 kDa Alexa647-coupled dextran (Invitrogen <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/nuccore/D22914">D22914</ext-link>) or 75 pg <italic>chordin</italic> mRNA<sup><xref ref-type="bibr" rid="CR70">70</xref></sup> together with 0.1 ng of 10 kDa Alexa488-coupled dextran (Invitrogen <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/nuccore/D22910">D22910</ext-link>) were injected into one-cell stage wild-type zebrafish embryos. To validate phenotypes, <italic>swirl</italic> homozygous mutants<sup><xref ref-type="bibr" rid="CR70">70</xref></sup> and maternal zygotic homozygous <italic>oep</italic> mutants<sup><xref ref-type="bibr" rid="CR41">41</xref></sup> were used. All zebrafish embryos were between 0 h.p.f. and 48 h.p.f.</p>
      <p id="Par29">Medaka eggs of the Cab strain were collected from standard crosses and separated with forceps. They were incubated at 28 °C in medaka embryo medium (17 mM NaCl, 0.4 mM KCl, 0.27 mM CaCl<sub>2</sub>, 0.65 mM MgSO<sub>4</sub>) and distributed into 24-well plates. Small-molecule signaling pathway antagonists were added at the early blastula stage to a concentration of 7.5 µM. Embryos were imaged from 8 h.p.f. until 45 h.p.f. with intervals of 5 min at 28 °C. Approximately 500 Medaka embryos between 0 h.p.f. and 48 h.p.f. were used for training and testing.</p>
      <p id="Par30">Stickleback embryos of wild-derived marine strains from Little Campbell River (Canada) and Tyne River (Scotland) were obtained by in vitro fertilization and incubated until 20 h.p.f. at 16 °C in stickleback embryo medium (3.5 g l<sup>−1</sup> instant ocean salt in reverse osmosis water). The eggs were separated using brushes and distributed into 48-well dishes. The small-molecule signaling pathway antagonists were applied at a concentration of 15 µM, and embryos were imaged for 120 h with intervals of 5 min at 15–18 °C. Approximately 200 stickleback embryos between 0 h.p.f. and 140 h.p.f. were used.</p>
    </sec>
    <sec id="Sec11">
      <title>Image acquisition</title>
      <p id="Par31">Images were acquired using an ACQUIFER Imaging Machine (DITABIS AG) with a white light-emitting diode (LED) for bright-field imaging and a scientific complementary metal oxide semiconductor 2,048 × 2,048 camera (Hamamatsu sCMOS 2k × 2k) in a single plane with a ×2 Plan UW numerical aperture 0.06 objective (Nikon) using the Imaging Machine software (v4.00.21). The integration time was fixed at a 110 ms exposure time and 100% relative LED intensity in the bright-field channel. Imaging was performed at 28 °C with 720 iterations at intervals of 120 s. Images were stored as 12-bit TIFF files at a size of 2,048 × 2,048 pixels and 0.31 pixels μm<sup>−1</sup> and converted to JPEG or PNG files for further phenotype analyses.</p>
      <p id="Par32">To generalize the method independently of the microscope, a Keyence BZ-X810 microscope equipped with a ×2 apochromat objective, a 3.7 W LED lightsource and the BZ-X800 viewer software (Keyence, v01.03.00.01) was also used to acquire embryo images (Supplementary Tables <xref rid="MOESM4" ref-type="media">2</xref>, <xref rid="MOESM4" ref-type="media">14</xref>, <xref rid="MOESM4" ref-type="media">15</xref>, <xref rid="MOESM4" ref-type="media">23</xref> and <xref rid="MOESM4" ref-type="media">24</xref> and Extended Data Fig. <xref rid="Fig8" ref-type="fig">4d,e</xref>). The exposure time was 0.1 ms with 50% relative intensity. The images were stored as 8-bit JPEG files at a size of 1,920 × 1,440 pixels.</p>
      <p id="Par33">Medaka and stickleback eggs contain large lipid droplets and, compared to zebrafish, have a larger yolk in relation to the embryo proper. Additionally, medaka eggs are surrounded by adhesive filaments. Given that these features are visually very prominent, the embryos were required to be imaged until the late segmentation stages to robustly detect morphological differences.</p>
    </sec>
    <sec id="Sec12">
      <title>Embryo detection</title>
      <p id="Par34">A dataset of manually annotated embryos was generated using the GUI FishLabeler (<ext-link ext-link-type="uri" xlink:href="http://github.com/mueller-lab/EmbryoNet">http://github.com/mueller-lab/EmbryoNet</ext-link>). The dataset was split into two subsets: 90% of the images were used for training and 10% for validation. Additionally, an independent manually annotated dataset was generated for testing.</p>
      <p id="Par35">Individual embryos were automatically detected at each image frame of the acquired movies using a standard object-detection algorithm based on the Hough transform<sup><xref ref-type="bibr" rid="CR71">71</xref></sup>. The location of individual embryos was computationally determined using bounding boxes. The range of embryo radii in pixels was provided according to the microscope acquisition parameters for each experiment independently. As output, a set of JSON files containing the information about the bounding boxes of individual embryos was generated. The Hough transform-based embryo detector can be replaced by other object recognition methods (such as watershed segmentation) to detect non-spherical species (for example, <italic>Drosophila melanogaster</italic>).</p>
    </sec>
    <sec id="Sec13">
      <title>Embryo tracking</title>
      <p id="Par36">To obtain information about the whole developmental path of each individual, the embryos identified at individual frames were grouped using an object-tracking approach. Detections of the same embryo in consecutive frames were confirmed using the DeepSort algorithm without re-identification<sup><xref ref-type="bibr" rid="CR72">72</xref></sup>.</p>
    </sec>
    <sec id="Sec14">
      <title>Manual labeling of training datasets</title>
      <p id="Par37">All embryos were initially set as class Unknown. Then, each embryo track was manually annotated with its specific phenotypic class (that is, Normal = Wild type, −BMP, +RA, −Wnt, −FGF, −Nodal, −Shh, −PCP) from the timepoint when the phenotype could be observed by an experienced annotator. Additionally, embryos that disintegrated were labeled as Dead. Embryos that were only partially in the image or that showed an unspecific phenotype were annotated as Cut and were excluded from the training, validation and test datasets. Additionally, the −BMP and −Nodal classes were subclassified into severity levels: weak, ~30% phenotype severity; intermediate, ~60% phenotype severity; and severe, ~100% phenotype severity. For Nodal phenotypes, the percentage bins were determined by the concentration of the inhibitor, with 100% corresponding to the minimum concentration that led to full penetrance. The drug concentration was then directly used as a binned fraction of the fully penetrant dose as ground truth for the severity bins, accepting a certain spread of phenotypes. Binning of BMP severity levels was done based on previous classification schemes<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>, with the class C3 corresponding to 30%, C4 to 60%, and C5 to 100% severity. Altogether 14 classes were obtained for the classification process. The annotator had previous knowledge about the treatment of the respective embryo, and the expertise to recognize all of the phenotypes.</p>
      <p id="Par38">To train EmbryoNet-Prime for an earlier detection, the original manual annotations were used to determine the timepoint when the majority of the embryos were classified correctly. The appropriate class was then assigned 120 frames (4 h) earlier, when the phenotype could not be identified by eye. Cut and Dead embryos were not changed.</p>
    </sec>
    <sec id="Sec15">
      <title>Model training and embryo classification</title>
      <p id="Par39">The use of embryo images as the only input could lead to misclassifications between embryo phenotypes, which have a similar appearance at different developmental stages. To increase classification performance, the developmental timepoint was added as a second input to the classification algorithm. In total, four channels were used as input for model training. The first three channels correspond to a standard RGB image, and the remaining one is a ‘timestamp’ channel representing the time that has passed from the beginning of the experiment. The size of the images was 224 × 224 pixels. The timestamp was linearly mapped from the real developmental time to the domain [0, 1], where 0 corresponds to ~2 h.p.f. and 1 to ~26 h.p.f. Given that the input classes were imbalanced (Supplementary Table <xref rid="MOESM4" ref-type="media">2</xref>), the overrepresented class Unknown was undersampled and the 13 remaining classes replicated<sup><xref ref-type="bibr" rid="CR73">73</xref></sup>.</p>
      <p id="Par40">For the classification task, a modified version of the widely used ResNet18<sup><xref ref-type="bibr" rid="CR40">40</xref></sup> architecture was selected. The network architecture was chosen due to its easy and fast convergence in image classification tasks. The ResNet18 model was modified by using a time channel as additional input and thus feeding four instead of three channels, and by replacing the last classification layer with the current classification layer. Time was also used as input to the last fully connected layer. The parameters of the neural network weights, unlike the neural network architecture (that is, the mathematical function structure describing an artificial neural network), were changed during the training procedure via a back-propagation algorithm.</p>
      <p id="Par41">The CNN model was trained using the supervised back-propagation training method<sup><xref ref-type="bibr" rid="CR74">74</xref></sup>, a common algorithm for training neural networks. The Adam optimizer was used, which is a back propagation-based optimization algorithm that determines the value change of neural network weights based on the loss function gradient. Softmax cross-entropy was used as the loss function (that is, the penalty for a poor prediction, indicating how bad the model’s prediction was on a single example):<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L = - 1/n{\sum} {ln\;p_i}$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>n</mml:mi><mml:mo mathsize="big">∑</mml:mo><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mspace width="0.16em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><graphic xlink:href="41592_2023_1873_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>where <italic>p</italic><sub><italic>i</italic></sub> is the index of the correct probability of the <italic>i</italic>-th image, and <italic>n</italic> is the number of images in the batch. In the case in which the model’s prediction is perfect, the loss would be zero; otherwise, the loss is greater. Cross-entropy loss is a common loss function used in machine learning and it measures the expected negative logarithm’s value for the correct classification probability.</p>
      <p id="Par42">The Albumentations library<sup><xref ref-type="bibr" rid="CR75">75</xref></sup> was used to increase the amount of training images by adding slightly modified copies of the existing images. Augmentations were applied during the training process, including random horizontal and vertical flips, rotations in the range of 1–90° with steps of 1°, crops and salt-and-pepper noise (Supplementary Table <xref rid="MOESM4" ref-type="media">3</xref>). During the training process a random augmentation from each group was picked and applied to the input image.</p>
      <p id="Par43">Given that the selected CNN model did not converge when all datasets and augmentations were used from the beginning of the training, a progressive training design involving different levels of difficulty was developed. In brief, the training was performed sequentially by dividing it into several steps with progressive addition of data and augmentations. At each step extra data were added as input and new augmentations applied at each epoch, that is, at each pass over the entire training dataset during the training procedure. The initial learning rate was set to 10<sup>−3</sup> and it decayed by a factor of 0.1 after each epoch. The learning rate, that is, the parameter by which the loss gradient value is multiplied during each iteration, was restored to the value of 10<sup>−3</sup> at the beginning of each iteration. The model was trained using eight steps with 10–20 epochs per step, resulting in a total of 152 epochs. For the whole training, a batch size (that is, the number of training examples used in one iteration) of <italic>n</italic> = 350 was used, and the training was performed on an NVIDIA RTX 3090 card in Ubuntu 20.04.4 LTS.</p>
      <p id="Par44">Rotation- and mirror-invariance of the embryo appearance was exploited to boost the classification performance by running the trained network for each detected embryo eight times: once with the original embryo image, once with the image flipped horizontally, then flipped vertically, then mirrored diagonally, and then with each of these samples rotated by 90°. Following this step, the classification probabilities were averaged. Each embryo was assigned to the class that had the maximum probability.</p>
    </sec>
    <sec id="Sec16">
      <title>Model transition logic</title>
      <p id="Par45">To further improve the results of the classification, the information from embryo tracking as well as previous knowledge about transitions between phenotypes was incorporated into the classification task. In brief, first the classification results of the CNN for each embryo track were collected and transitions between classes identified. The only biologically possible transitions in an embryo track were set as follows: from Unknown to a phenotype class, from a phenotype class to Dead, or from Unknown to Dead. Any other transition in an embryo track was penalized in the model prediction. The quality of the whole track model prediction was evaluated by computing the number of frames between transition points with the class expected by the model being analyzed. The transition sequence that achieved the least cost was considered to be the correct one. The outliers were then ignored in the track history. Nodal and BMP severity classifications were similarly corrected by selecting the severity class that was most frequently observed over the timecourse.</p>
      <p id="Par46">For medaka, a semi-supervised training method was used by assigning a classification transition point from which the phenotypes were easy to distinguish for a human and automatically applying this to all training data. Given that medaka embryos disintegrated if they were treated with Nodal inhibitor before the blastula stages, the medaka experiments did not start at cleavage but at blastula stages. This opportunity was used to set the transition point to timepoint 1, such that the Unknown class did not have to be used at all. This did not reduce the training or classification efficiency (Fig. <xref rid="Fig4" ref-type="fig">4f</xref>), showing that an Unknown state for early stages is not unconditionally required.</p>
    </sec>
    <sec id="Sec17">
      <title>Evaluation of classification efficiency</title>
      <p id="Par47">For the performance measure of classification, subset accuracy was computed. Subset accuracy is the fraction of images <italic>n</italic> that were classified correctly:<disp-formula id="Equb"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{\mathrm{Accuracy}}}} = \frac{1}{n}\mathop {\sum }\limits_{i = 1}^n I\left( {{\check{y}_i} = y_i} \right)$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi mathvariant="normal">Accuracy</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="41592_2023_1873_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par48">F-scores were calculated as<disp-formula id="Equc"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{\mathrm{F-score = 2}}}} \times \frac{{{{{\mathrm{Precision}}}} \times {{{\mathrm{Recall}}}}}}{{{{{\mathrm{Precision + Recall}}}}}}$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mi mathvariant="normal">F - score = 2</mml:mi><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Precision</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="normal">Recall</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Precision + Recall</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="41592_2023_1873_Article_Equc.gif" position="anchor"/></alternatives></disp-formula>with<disp-formula id="Equd"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{rcl}{\mathrm{precision}} &amp; = &amp; \frac{{{\mathrm{true}}\;{\mathrm{positives}}}}{{{\mathrm{true}}\;{\mathrm{positives}} + {\mathrm{false}}\;{\mathrm{positives}}}}\,{\mathrm{and}}\\ {\mathrm{recall}} &amp; = &amp; \frac{{{\mathrm{true}}\;{\mathrm{positives}}}}{{{\mathrm{true}}\;{\mathrm{positives + false}}\;{\mathrm{negatives}}}}\end{array}$$\end{document}</tex-math><mml:math id="M8"><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mi mathvariant="normal">precision</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">true</mml:mi><mml:mspace width="0.16em"/><mml:mi mathvariant="normal">positives</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">true</mml:mi><mml:mspace width="0.16em"/><mml:mi mathvariant="normal">positives</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">false</mml:mi><mml:mspace width="0.16em"/><mml:mi mathvariant="normal">positives</mml:mi></mml:mrow></mml:mfrac><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">and</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mi mathvariant="normal">recall</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">true</mml:mi><mml:mspace width="0.16em"/><mml:mi mathvariant="normal">positives</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">true</mml:mi><mml:mspace width="0.16em"/><mml:mi mathvariant="normal">positives+false</mml:mi><mml:mspace width="0.16em"/><mml:mi mathvariant="normal">negatives</mml:mi></mml:mrow></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41592_2023_1873_Article_Equd.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par49">In the confusion matrices, the class Unknown was not taken into account. The numerical data for the confusion matrices including the class Unknown are provided in Supplementary Tables <xref rid="MOESM4" ref-type="media">4</xref>, <xref rid="MOESM4" ref-type="media">9</xref>, <xref rid="MOESM4" ref-type="media">11</xref>–<xref rid="MOESM4" ref-type="media">15</xref> and <xref rid="MOESM4" ref-type="media">17</xref>–<xref rid="MOESM4" ref-type="media">24</xref>, and this class was also included in the overall metrics of accuracy and F-score.</p>
      <p id="Par50">The evaluation dataset for Fig. <xref rid="Fig2" ref-type="fig">2a–e</xref> was generated by compiling three stacks of 98 images each selected from the full test dataset (Fig. <xref rid="Fig2" ref-type="fig">2h–j</xref> and Extended Data Fig. <xref rid="Fig8" ref-type="fig">4</xref>). To evaluate the performance of random guessing, the function randi from MATLAB R2022a was used for the generation of a pseudo-random scalar integer between 1 and <italic>n</italic><sub><italic>c</italic></sub>, where <italic>n</italic><sub><italic>c</italic></sub> is the number of classes. The image stacks were then labeled with the classes corresponding to the pseudo-random numbers and evaluated for performance by calculating accuracy and F-score. The non-expert teams received one randomly selected image stack for their assessment task. The experienced developmental biologist assessed all three image stacks, and average performance is shown in Fig. <xref rid="Fig2" ref-type="fig">2d</xref>.</p>
    </sec>
    <sec id="Sec18">
      <title>CAMs</title>
      <p id="Par51">To visualize the regions of images that influenced the model to make classification decisions, CAMs were used. To visualize the CAMs generated by EmbryoNet, the weights of the final output layer in a fully connected layer were projected using global max pooling, as previously proposed<sup><xref ref-type="bibr" rid="CR47">47</xref></sup>. This approach enabled the visualization of regions positively or negatively activated for a particular class. CAMs were calculated for all classes, and their values were normalized so that the minimum and maximum values for all classes correspond to −1 and +1, respectively. To improve the visualization of areas with large positive or negative values (that is, relevant regions for the decision), the CAMs were remapped using the following function:<disp-formula id="Eque"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde V_{{\mathrm{CAM}}} = {{{\mathrm{sgn}}}}(V_{{\mathrm{CAM}}}) \times \sqrt {V_{{\mathrm{CAM}}}}$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>~</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">CAM</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">sgn</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">CAM</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">CAM</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:math><graphic xlink:href="41592_2023_1873_Article_Eque.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq1"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{{\mathrm{CAM}}}$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">CAM</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41592_2023_1873_Article_IEq1.gif"/></alternatives></inline-formula> are the normalized values of the CAMs, <inline-formula id="IEq2"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{\mathrm{sgn}}}}\left( \cdot \right)$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mi mathvariant="normal">sgn</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mo>⋅</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="41592_2023_1873_Article_IEq2.gif"/></alternatives></inline-formula> is the sign function and <inline-formula id="IEq3"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde V_{{\mathrm{CAM}}}$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>~</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">CAM</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41592_2023_1873_Article_IEq3.gif"/></alternatives></inline-formula> are the remapped CAM values. Finally, the values of the CAMs were mapped to 8-bit and visualized with the jet colormap.</p>
    </sec>
    <sec id="Sec19">
      <title>Drug screening</title>
      <p id="Par52">Plates of the Screen-Well ICCB Known Bioactives Library BML-2840-0100 and the FDA-approved drug library BML-2843 were defrosted at 22 °C for 1 h and centrifuged at 1,890 ×<italic>g</italic> for 2 min (Eppendorf 5810 R). Six 96-well microtiter plates were pre-filled with 96 μl cell culture-grade PBS (Gibco). From each library plate, 4 μl per well were transferred, resulting in a 1:25 dilution. Blank wells were filled with 4 μl cell culture-grade PBS. Zebrafish embryos were collected as described above, but selected embryos were washed three times with 200 ml embryo medium and transferred to a 96-well plate (Greiner Bio-One), three to five embryos per well. Each well was filled with embryo medium to a volume of 135 μl. Subsequently, 15 μl solution were transferred from the 1:25 intermediate dilution plates to each well containing embryos. Plates were covered with transparent foil, and a plastic lid was placed on the plate.</p>
      <p id="Par53">Screening plates were placed in the ACQUIFER Imaging Machine as described above with an imaging interval between 135 s and 192 s. Image files were converted to JPEG files for further phenotype analyses. The images from the 96-well screening plates were sorted into separate directories related to respective wells using a custom Python script (Drug screen script 1; <ext-link ext-link-type="uri" xlink:href="http://github.com/mueller-lab/EmbryoNet/tree/main/Train_Eval/tools/DrugScreen">http://github.com/mueller-lab/EmbryoNet/tree/main/Train_Eval/tools/DrugScreen</ext-link>). The data files were read into the custom FishClassifier software and evaluated for detected phenotypes. For each image file, phenotype detections were stored as a separate JSON file. The JSON files were read using a custom Python script (Drug screen script 2; <ext-link ext-link-type="uri" xlink:href="http://github.com/mueller-lab/EmbryoNet/tree/main/Train_Eval/tools/DrugScreen">http://github.com/mueller-lab/EmbryoNet/tree/main/Train_Eval/tools/DrugScreen</ext-link>). Evaluated phenotypes were linked with corresponding treatments and finally stored as Excel files, containing the number of images for each class in the time series. These files were used to generate charts for predicted phenotypes resulting from each treatment (Drug screen script 3; <ext-link ext-link-type="uri" xlink:href="http://github.com/mueller-lab/EmbryoNet/tree/main/Train_Eval/tools/DrugScreen">http://github.com/mueller-lab/EmbryoNet/tree/main/Train_Eval/tools/DrugScreen</ext-link>). The majority phenotype for each well was determined as the class to which the highest number of embryo images was assigned.</p>
    </sec>
    <sec id="Sec20">
      <title>Retest and characterization of statins in FGF signaling</title>
      <p id="Par54">Zebrafish embryos were treated with 20 µM simvastatin in embryo medium (Enzo Life Science BML-G244-0050, final concentration of DMSO solvent: 0.2%), 40 µM atorvastatin (Sigma PHR1422, final concentration of DMSO solvent: 0.4%) or 0.4 µM lovastatin (PHR1285, final concentration of DMSO solvent: 0.04%) starting at 1.5–2 h.p.f. or were left untreated and incubated at 28 °C.</p>
      <p id="Par55">Live embryos were imaged at 28 h.p.f. with a bright-field microscope (Leica M205 FCA). For close-up images, embryos were manually dechorionated using precision forceps and embedded in 2% methylcellulose in embryo medium.</p>
      <p id="Par56">For pErk immunostainings, untreated and statin-treated embryos were fixed at the shield stage with 4% formaldehyde in PBS overnight at 4 °C and then stepwise (25%, 50%, 75% methanol in PBST (PBS containing 0.1% Tween-20)) dehydrated. After an overnight incubation in 100% methanol at −20 °C, embryos were rehydrated in three steps (75%, 50%, 25% methanol in PBST). After permeabilization with ice-cold acetone for 20 min at −20 °C and additional washing steps with PBST, samples were blocked in 10% FBS in PBST for 2 h and incubated in 1:5,000 mouse anti-pERK antibody (Sigma, M8159) in 10% FBS in PBST overnight at 4 °C. Embryos were then washed at least 12 times with PBST, followed by another blocking step for 2 h with 10% FBS in PBST and overnight incubation with 1:5,000 donkey anti-mouse HRP-coupled secondary antibody (Jackson ImmunoResearch, 715-035-150) in 10% FBS in PBST at 4 °C. After washing at least 12 times with PBST and once with TSA 1x amplification buffer, embryos were incubated in 75 µl 1:75 Cy3-TSA in 1x amplification buffer for 45 min, protected from light. After washing for at least four times with PBST, embryos were incubated in 0.3 µM DRAQ7 (Invitrogen, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/nuccore/D15106">D15106</ext-link>) in PBST for 30 min and then washed at least three times with PBST. Before imaging, stained embryos were wrapped in aluminum foil and stored overnight at 4 °C.</p>
      <p id="Par57">Fixed and stained embryos were mounted in 1.5% low-melting point agarose (Lonza, 50080) using a glass capillary (50 µl, Brand 701908) and imaged with a ZEISS Lightsheet Z.1 microscope using ZEN 3.1 Black Edition acquisition software. The imaging chamber was filled with water, and filters and lightsheets were auto-aligned prior to imaging<sup><xref ref-type="bibr" rid="CR76">76</xref></sup>. Embryos were positioned with the brightest pErk signal pointing towards the imaging objective (presumptive dorsal view). For each embryo, z-slices with 5 μm between each slice were acquired. All images were acquired with dual lightsheet illumination using a W Plan-Apochromat ×10 objective at ×0.9 zoom, with laser powers of 2% and 6% for pErk and nuclei, respectively.</p>
      <p id="Par58">To measure spatial intensity profiles from the margin to the animal pole, maximum intensity projections of 75 z-slices were generated using Fiji<sup><xref ref-type="bibr" rid="CR77">77</xref></sup>, and pErk intensity profiles were calculated as follows. First, a rectangular region of interest with a width of 300 pixels was manually drawn from the margin of the blastoderm to the animal pole. Only images of embryos that were oriented with the dorsal side facing the camera were used for the analysis. The dorsal side could be identified after generating maximum intensity projections from image stacks. Embryos with tilted dorso-ventral axes were excluded. Then, the average intensity along the profile was calculated using the function Measure in Fiji. The background intensity of pErk was estimated as the median intensity value of the profiles of untreated embryos at the animal pole (between 250 µm and 280 µm from the margin) and subtracted from the intensity profiles using MATLAB 2022a (<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.48606/55">https://doi.org/10.48606/55</ext-link>).</p>
    </sec>
    <sec id="Sec21">
      <title>Reporting summary</title>
      <p id="Par59">Further information on research design is available in the <xref rid="MOESM2" ref-type="media">Nature Portfolio Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec id="Sec22" sec-type="materials|methods">
    <title>Online content</title>
    <p id="Par60">Any methods, additional references, Nature Portfolio reporting summaries, source data, extended data, supplementary information, acknowledgements, peer review information; details of author contributions and competing interests; and statements of data and code availability are available at 10.1038/s41592-023-01873-4.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <p>
      <supplementary-material content-type="local-data" id="MOESM1">
        <media xlink:href="41592_2023_1873_MOESM1_ESM.pdf">
          <label>Supplementary Information</label>
          <caption>
            <p>Supplementary Notes 1–4 and References.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM2">
        <media xlink:href="41592_2023_1873_MOESM2_ESM.pdf">
          <caption>
            <p>Reporting Summary</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM3">
        <media xlink:href="41592_2023_1873_MOESM3_ESM.pdf">
          <caption>
            <p>Peer Review File</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM4">
        <media xlink:href="41592_2023_1873_MOESM4_ESM.xlsx">
          <label>Supplementary Tables</label>
          <caption>
            <p>Supplementary Tables 1–35.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM5">
        <media xlink:href="41592_2023_1873_MOESM5_ESM.mp4">
          <label>Supplementary Video 1</label>
          <caption>
            <p>Representative timecourse of zebrafish Normal wild-type development. The movie spans 24 h with 2 min intervals.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM6">
        <media xlink:href="41592_2023_1873_MOESM6_ESM.mp4">
          <label>Supplementary Video 2</label>
          <caption>
            <p>Representative timecourse of zebrafish −BMP loss-of-function development. Embryos were treated with BMP inhibitor starting at the 4-cell stage. The movie spans 24 h with 2 min intervals.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM7">
        <media xlink:href="41592_2023_1873_MOESM7_ESM.mp4">
          <label>Supplementary Video 3</label>
          <caption>
            <p>Representative timecourse of zebrafish +RA gain-of-function development. Embryos were treated with retinoic acid starting at the 4-cell stage. The movie spans 24 h with 2 min intervals.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM8">
        <media xlink:href="41592_2023_1873_MOESM8_ESM.mp4">
          <label>Supplementary Video 4</label>
          <caption>
            <p>Representative timecourse of zebrafish −Wnt loss-of-function development. Embryos were treated with Wnt inhibitor starting at the 4-cell stage. The movie spans 24 h with 2 min intervals.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM9">
        <media xlink:href="41592_2023_1873_MOESM9_ESM.mp4">
          <label>Supplementary Video 5</label>
          <caption>
            <p>Representative timecourse of zebrafish −FGF loss-of-function development. Embryos were treated with FGF inhibitor starting at the 4-cell stage. The movie spans 24 h with 2 min intervals.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM10">
        <media xlink:href="41592_2023_1873_MOESM10_ESM.mp4">
          <label>Supplementary Video 6</label>
          <caption>
            <p>Representative timecourse of zebrafish −Nodal loss-of-function development. Embryos were treated with Nodal inhibitor starting at the 4-cell stage. The movie spans 24 h with 2 min intervals.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM11">
        <media xlink:href="41592_2023_1873_MOESM11_ESM.mp4">
          <label>Supplementary Video 7</label>
          <caption>
            <p>Representative timecourse of zebrafish −Shh loss-of-function development. Embryos were treated with Shh inhibitor (cyclopamine) starting at the 4-cell stage. The movie spans 24 h with 2 min intervals.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM12">
        <media xlink:href="41592_2023_1873_MOESM12_ESM.mp4">
          <label>Supplementary Video 8</label>
          <caption>
            <p>Representative timecourse of zebrafish −PCP loss-of-function development. Embryos were injected with a <italic>vangl2</italic>-targeting morpholino at the 1-cell stage. The movie spans 24 h with 2 min intervals.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM13">
        <media xlink:href="41592_2023_1873_MOESM13_ESM.mp4">
          <label>Supplementary Video 9</label>
          <caption>
            <p>Activation maps for different phenotype classes in wild-type zebrafish embryos. The movie spans 24 h with 2 min intervals. Activation maps for different phenotype classes (Unknown, Normal, −BMP, +RA, −Wnt, −FGF, −Nodal, −Shh, −PCP and Dead) are shown.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM14">
        <media xlink:href="41592_2023_1873_MOESM14_ESM.mp4">
          <label>Supplementary Video 10</label>
          <caption>
            <p>Activation maps for the phenotype class Normal in 10 wild-type zebrafish embryos. The movie spans 24 h with 2 min intervals.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM15">
        <media xlink:href="41592_2023_1873_MOESM15_ESM.mp4">
          <label>Supplementary Video 11</label>
          <caption>
            <p>Activation maps for different phenotype classes in zebrafish BMP loss-of-function development. Embryos were treated with BMP inhibitor starting at the 4-cell stage. The movie spans 24 h with 2 min intervals. Activation maps for different phenotype classes (Unknown, Normal, −BMP, +RA, −Wnt, −FGF, −Nodal, −Shh, −PCP and Dead) are shown.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM16">
        <media xlink:href="41592_2023_1873_MOESM16_ESM.mp4">
          <label>Supplementary Video 12</label>
          <caption>
            <p>Activation maps for the phenotype class −BMP in 10 BMP loss-of-function zebrafish embryos. The movie spans 24 h with 2 min intervals.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM17">
        <media xlink:href="41592_2023_1873_MOESM17_ESM.mp4">
          <label>Supplementary Video 13</label>
          <caption>
            <p>Activation maps for different phenotype classes in zebrafish RA gain-of-function development. Embryos were treated with retinoic acid starting at the 4-cell stage. The movie spans 24 h with 2 min intervals. Activation maps for different phenotype classes (Unknown, Normal, −BMP, +RA, −Wnt, −FGF, −Nodal, −Shh, −PCP and Dead) are shown.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM18">
        <media xlink:href="41592_2023_1873_MOESM18_ESM.mp4">
          <label>Supplementary Video 14</label>
          <caption>
            <p>Activation maps for the phenotype class +RA in 10 RA gain-of-function zebrafish embryos. The movie spans 24 h with 2 min intervals.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM19">
        <media xlink:href="41592_2023_1873_MOESM19_ESM.mp4">
          <label>Supplementary Video 15</label>
          <caption>
            <p>Activation maps for different phenotype classes in zebrafish Wnt loss-of-function development. Embryos were treated with Wnt inhibitor starting at the 4-cell stage. The movie spans 24 h with 2 min intervals. Activation maps for different phenotype classes (Unknown, Normal, −BMP, +RA, −Wnt, −FGF, −Nodal, −Shh, −PCP and Dead) are shown.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM20">
        <media xlink:href="41592_2023_1873_MOESM20_ESM.mp4">
          <label>Supplementary Video 16</label>
          <caption>
            <p>Activation maps for the phenotype class −Wnt in 10 Wnt loss-of-function zebrafish embryos. The movie spans 24 h with 2 min intervals.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM21">
        <media xlink:href="41592_2023_1873_MOESM21_ESM.mp4">
          <label>Supplementary Video 17</label>
          <caption>
            <p>Activation maps for different phenotype classes in zebrafish FGF loss-of-function development. Embryos were treated with FGF inhibitor starting at the 4-cell stage. The movie spans 24 h with 2 min intervals. Activation maps for different phenotypic classes (Unknown, Normal, −BMP, +RA, −Wnt, −FGF, −Nodal, −Shh, −PCP and Dead) are shown.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM22">
        <media xlink:href="41592_2023_1873_MOESM22_ESM.mp4">
          <label>Supplementary Video 18</label>
          <caption>
            <p>Activation maps for the phenotype class −FGF in 10 FGF loss-of-function zebrafish embryos. The movie spans 24 h with 2 min intervals.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM23">
        <media xlink:href="41592_2023_1873_MOESM23_ESM.mp4">
          <label>Supplementary Video 19</label>
          <caption>
            <p>Activation maps for different phenotype classes in zebrafish Nodal loss-of-function development. Embryos were treated with Nodal inhibitor starting at the 4-cell stage. The movie spans 24 h with 2 min intervals. Activation maps for different phenotype classes (Unknown, Normal, −BMP, +RA, −Wnt, −FGF, −Nodal, −Shh, −PCP and Dead) are shown.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM24">
        <media xlink:href="41592_2023_1873_MOESM24_ESM.mp4">
          <label>Supplementary Video 20</label>
          <caption>
            <p>Activation maps for the phenotype class −Nodal in 10 Nodal loss-of-function zebrafish embryos. The movie spans 24 h with 2 min intervals.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM25">
        <media xlink:href="41592_2023_1873_MOESM25_ESM.mp4">
          <label>Supplementary Video 21</label>
          <caption>
            <p>Activation maps for different phenotype classes in zebrafish Shh loss-of-function development. Embryos were treated with Shh inhibitor (cyclopamine) starting at the 4-cell stage. The movie spans 24 h with 2 min intervals. Activation maps for different phenotype classes (Unknown, Normal, −BMP, +RA, −Wnt, −FGF, −Nodal, −Shh, −PCP and Dead) are shown.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM26">
        <media xlink:href="41592_2023_1873_MOESM26_ESM.mp4">
          <label>Supplementary Video 22</label>
          <caption>
            <p>Activation maps for the phenotype class −Shh in 10 Shh loss-of-function zebrafish embryos. The movie spans 2 h with 2 min intervals.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM27">
        <media xlink:href="41592_2023_1873_MOESM27_ESM.mp4">
          <label>Supplementary Video 23</label>
          <caption>
            <p>Activation maps for different phenotype classes in zebrafish PCP loss-of-function development. Embryos were injected with a <italic>vangl2</italic>-targeting morpholino at the 1-cell stage. The movie spans 24 h with 2 min intervals. Activation maps for different phenotype classes (Unknown, Normal, −BMP, +RA, −Wnt, −FGF, −Nodal, −Shh, −PCP and Dead) are shown.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM28">
        <media xlink:href="41592_2023_1873_MOESM28_ESM.mp4">
          <label>Supplementary Video 24</label>
          <caption>
            <p>Activation maps for the phenotype class −PCP in 10 PCP loss-of-function zebrafish embryos. The movie spans 24 h with 2 min intervals.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM29">
        <media xlink:href="41592_2023_1873_MOESM29_ESM.mp4">
          <label>Supplementary Video 25</label>
          <caption>
            <p>Zebrafish drug screen with ScreenWell Library 2840, plate 1. The movie spans 26 h with 139 s intervals. The embryos were drug-treated according to Supplementary Table 25 starting at the 512-cell stage.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM30">
        <media xlink:href="41592_2023_1873_MOESM30_ESM.mp4">
          <label>Supplementary Video 26</label>
          <caption>
            <p>Zebrafish drug screen with ScreenWell Library 2840, plate 2. The movie spans 24 h with 139 s intervals. The embryos were drug-treated according to Supplementary Table 26 starting at the 128-cell stage.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM31">
        <media xlink:href="41592_2023_1873_MOESM31_ESM.mp4">
          <label>Supplementary Video 27</label>
          <caption>
            <p>Zebrafish drug screen with ScreenWell Library 2840, plate 3. The movie spans 28 h with 138 s intervals. The embryos were drug-treated according to Supplementary Table 27 starting at the 512-cell stage.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM32">
        <media xlink:href="41592_2023_1873_MOESM32_ESM.mp4">
          <label>Supplementary Video 28</label>
          <caption>
            <p>Zebrafish drug screen with ScreenWell Library 2840, plate 4. The movie spans 24 h with 138 s intervals. The embryos were drug-treated according to Supplementary Table 28 starting at the 256-cell stage.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM33">
        <media xlink:href="41592_2023_1873_MOESM33_ESM.mp4">
          <label>Supplementary Video 29</label>
          <caption>
            <p>Zebrafish drug screen with ScreenWell Library 2840, plate 5. The movie spans 26 h with 143 s intervals. The embryos were drug-treated according to Supplementary Table 29 starting at the 256-cell stage.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM34">
        <media xlink:href="41592_2023_1873_MOESM34_ESM.mp4">
          <label>Supplementary Video 30</label>
          <caption>
            <p>Zebrafish drug screen with ScreenWell Library 2840, plate 6. The movie spans 25 h with 144 s intervals. The embryos were drug-treated according to Supplementary Table 30 starting at the 512-cell stage.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM35">
        <media xlink:href="41592_2023_1873_MOESM35_ESM.mp4">
          <label>Supplementary Video 31</label>
          <caption>
            <p>Zebrafish drug screen with ScreenWell Library 2843, plate 1. The movie spans 27 h with 135 s intervals. The embryos were drug-treated according to Supplementary Table 31 starting at the 256-cell stage.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM36">
        <media xlink:href="41592_2023_1873_MOESM36_ESM.mp4">
          <label>Supplementary Video 32</label>
          <caption>
            <p>Zebrafish drug screen with ScreenWell Library 2843, plate 2. The movie spans 24 h with 137 s intervals. The embryos were drug-treated according to Supplementary Table 32 starting at the 32-cell stage.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM37">
        <media xlink:href="41592_2023_1873_MOESM37_ESM.mp4">
          <label>Supplementary Video 33</label>
          <caption>
            <p>Zebrafish drug screen with ScreenWell Library 2843, plate 3. The movie spans 24 h with 138 s intervals. The embryos were drug-treated according to Supplementary Table 33 starting at the 64-cell stage.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM38">
        <media xlink:href="41592_2023_1873_MOESM38_ESM.mp4">
          <label>Supplementary Video 34</label>
          <caption>
            <p>Zebrafish drug screen with ScreenWell Library 2843, plate 5. The movie spans 24 h with 192 s intervals. The embryos were drug-treated according to Supplementary Table 34 starting at the 512-cell stage.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM39">
        <media xlink:href="41592_2023_1873_MOESM39_ESM.mp4">
          <label>Supplementary Video 35</label>
          <caption>
            <p>Zebrafish drug screen with ScreenWell Library 2843, plate 6. The movie spans 24 h with 142 s intervals. The embryos were drug-treated according to Supplementary Table 35 starting at the 512-cell stage.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM40">
        <media xlink:href="41592_2023_1873_MOESM40_ESM.mp4">
          <label>Supplementary Video 36</label>
          <caption>
            <p>Zebrafish development upon exposure to simvastatin. The movie spans 24 h with 137 s intervals. The embryos were treated with 40 µM simvastatin starting at the 32-cell stage.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM41">
        <media xlink:href="41592_2023_1873_MOESM41_ESM.mp4">
          <label>Supplementary Video 37</label>
          <caption>
            <p>Zebrafish development upon exposure to atorvastatin. The movie spans 24 h with 142 s intervals. The embryos were treated with 40 µM atorvastatin starting at the 512-cell stage.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM42">
        <media xlink:href="41592_2023_1873_MOESM42_ESM.mp4">
          <label>Supplementary Video 38</label>
          <caption>
            <p>Zebrafish development upon exposure to lovastatin. The movie spans 24 h with 143 s intervals. The embryos were treated with 20 µg ml<sup>−1</sup> (that is, 50 µM) lovastatin starting at the 256-cell stage.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM43">
        <media xlink:href="41592_2023_1873_MOESM43_ESM.mp4">
          <label>Supplementary Video 39</label>
          <caption>
            <p>Medaka normal development. The movie spans 37.5 h with 5 min intervals, starting at stage 11.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM44">
        <media xlink:href="41592_2023_1873_MOESM44_ESM.mp4">
          <label>Supplementary Video 40</label>
          <caption>
            <p>Medaka development with Nodal loss of function. The movie spans 37.5 h with 5 min intervals. The embryos were treated with the chemical Nodal inhibitor SB-505124 at a concentration of 7.5 µM starting at stage 11.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM45">
        <media xlink:href="41592_2023_1873_MOESM45_ESM.mp4">
          <label>Supplementary Video 41</label>
          <caption>
            <p>Stickleback normal development. The movie spans 120 h with 5 min intervals, starting at stage 10.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM46">
        <media xlink:href="41592_2023_1873_MOESM46_ESM.mp4">
          <label>Supplementary Video 42</label>
          <caption>
            <p>Stickleback development with Nodal loss of function. The movie spans 120 h with 5 min intervals. The embryos were treated with the chemical Nodal inhibitor SB-505124 at a concentration of 15 µM, starting from stage 10.</p>
          </caption>
        </media>
      </supplementary-material>
    </p>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec23">
        <title>Extended data</title>
        <p id="Par65">
          <fig id="Fig5">
            <label>Extended Data Fig. 1</label>
            <caption>
              <title>Schematic of the training pipeline for EmbryoNet.</title>
              <p><bold>(a)</bold> Overview of a training iteration. Augmented embryos were collected into a training batch with known embryo age. After EmbryoNet processed a batch of input images with ages, network outputs were compared with ground truth values. Based on cross-entropy loss, EmbryoNet weights were updated to minimize the loss. <bold>(b)</bold> Examples of augmentations used. <bold>(c)</bold> In our model transition logic, embryos have a limited set of allowed class transitions. All start in the class Unknown and can transition to any other class, from where they can go only to Dead, but not to other classes. Other transitions were assigned a cost. The model with the least cost was selected. <bold>(d)</bold> Schematic of the classification pipeline. <bold>(e)</bold> Graphical user interface (GUI) of EmbryoNet. <bold>(f,g)</bold> Comparison of EmbryoNet’s performance to recognize phenotypes induced by signaling modulation using small-molecule inhibitors, overexpression of signaling antagonists or pathway mutants. Nodal phenotypes (f) induced by small-molecule inhibitor treatment (SB-505124, n=33), injection of a pathway antagonist (<italic>lefty1</italic> mRNA, n=27) or in a receptor mutant (<italic>MZoep</italic>, n=27) were all classified by EmbryoNet as –Nodal with similar accuracy. BMP phenotypes (g) induced by small-molecule inhibitor treatment (LDN-193189, n=45), pathway antagonist injection (<italic>chordin</italic> mRNA, n=26) or in a pathway ligand mutant (<italic>swirl</italic><sup><italic>-/-</italic></sup>, n=13) were all classified by EmbryoNet as –BMP with similar accuracy. Scale bars: 500 µm.</p>
            </caption>
            <graphic position="anchor" xlink:href="41592_2023_1873_Fig5_ESM" id="d32e2169"/>
          </fig>
        </p>
        <p id="Par66">
          <fig id="Fig6">
            <label>Extended Data Fig. 2</label>
            <caption>
              <title>Complete data of the non-expert teams to assess 98 embryo images without time information.</title>
              <p>Confusion matrices show the classification of the respective non-expert teams. The non-expert teams did not have extra information about the age of the displayed embryos.</p>
            </caption>
            <graphic position="anchor" xlink:href="41592_2023_1873_Fig6_ESM" id="d32e2183"/>
          </fig>
        </p>
        <p id="Par67">
          <fig id="Fig7">
            <label>Extended Data Fig. 3</label>
            <caption>
              <title>Complete data of the non-expert teams to assess 98 embryo images with time information.</title>
              <p>Confusion matrices show the classification of the respective teams. Embryo age was supplied with the images.</p>
            </caption>
            <graphic position="anchor" xlink:href="41592_2023_1873_Fig7_ESM" id="d32e2197"/>
          </fig>
        </p>
        <p id="Par68">
          <fig id="Fig8">
            <label>Extended Data Fig. 4</label>
            <caption>
              <title>Classification of time-lapse data by experts and EmbryoNet, and classification performance with different microscope data sets.</title>
              <p>(<bold>a-c)</bold> Schematics and confusion matrices show classification of image series of the respective assessors. Human experts (a,b) knew that all embryos within a movie received the same treatment. <bold>(d,e)</bold> Confusion matrices showing the performance of EmbryoNet (d) and EmbryoNet-Prime (e) if only test data from either microscope 1 (d’,e’, ACQUIFER Imaging Machine) or microscope 2 (d’’,e’’, Keyence BZ-X810) was used.</p>
            </caption>
            <graphic position="anchor" xlink:href="41592_2023_1873_Fig8_ESM" id="d32e2217"/>
          </fig>
        </p>
        <p id="Par69">
          <fig id="Fig9">
            <label>Extended Data Fig. 5</label>
            <caption>
              <title>Classification of mild Nodal and BMP phenotypes.</title>
              <p><bold>(a)</bold> Schematic of the experiment with lower inhibitor doses. Lower doses of the BMP inhibitor LDN-193189 lead to weaker phenotypes, detectable from late gastrulation onwards. While in the severe cases no clear structures are distinguishable, moderate embryos have a head and somites and display the characteristic BMP loss-of-function phenotype with curled-up tails (Kishimoto et al. 1997). Mild embryos have a largely intact body axis only missing the tail. <bold>(b-d)</bold> Confusion matrices showing the performance of classification of weaker phenotypes. EmbryoNet (b) had a lower performance on milder compared to severe phenotypes, especially for Nodal-inhibited samples. Human annotators were also less consequent as seen from the confusion matrix between the accepted ground truth and a second labeler (c). EmbryoNet-Prime had better success in detecting weak Nodal phenotypes compared to EmbryoNet, but was less performant on –BMP and on average (d).</p>
            </caption>
            <graphic position="anchor" xlink:href="41592_2023_1873_Fig9_ESM" id="d32e2236"/>
          </fig>
        </p>
        <p id="Par70">
          <fig id="Fig10">
            <label>Extended Data Fig. 6</label>
            <caption>
              <title>Detection time points of all classes by EmbryoNet-Prime.</title>
              <p>Plots of the number of detected phenotypes (dotted lines) for each class over time for EmbryoNet (pink diamonds), EmbryoNet-Prime (blue triangles) and human experts (green dots). The error envelopes show standard error of the mean. Solid lines show the fit of a sigmoid curve to the data. Gray boxes show major developmental periods. Different classes could be detected at different time points. –BMP, + RA, –Wnt, –Nodal and –Shh could be classified earlier by EmbryoNet-Prime than by humans. n[Normal]: 74, n[–BMP]: 119, n[+RA]: = 66, n[–Wnt]: 70, n[–FGF]: 74, n[–Nodal]: 110, n[–Shh]: 63, n[–PCP]: 57. Data also shown in Fig. <xref rid="Fig2" ref-type="fig">2g</xref>.</p>
            </caption>
            <graphic position="anchor" xlink:href="41592_2023_1873_Fig10_ESM" id="d32e2253"/>
          </fig>
        </p>
        <p id="Par71">
          <fig id="Fig11">
            <label>Extended Data Fig. 7</label>
            <caption>
              <title>Results of the Enzo ScreenWell 2840 library drug screen.</title>
              <p>(<bold>a</bold>–<bold>f</bold>) Layout of plates 1 (<bold>a</bold>), 2 (<bold>b</bold>), 3 (<bold>c</bold>), 4 (<bold>d</bold>), 5 (<bold>e</bold>) and 6 (<bold>f</bold>) from the BML-2840 library with classifications per well by majority phenotype. See Supplementary Tables 25–30 for details.</p>
            </caption>
            <graphic position="anchor" xlink:href="41592_2023_1873_Fig11_ESM" id="d32e2292"/>
          </fig>
        </p>
        <p id="Par72">
          <fig id="Fig12">
            <label>Extended Data Fig. 8</label>
            <caption>
              <title>Results of the Enzo ScreenWell 2843 library drug screen.</title>
              <p>(<bold>a</bold>–<bold>e</bold>) Layout of plates 1 (<bold>a</bold>), 2 (<bold>b</bold>), 3 (<bold>c</bold>), 5 (<bold>d</bold>) and 6 (<bold>e</bold>) from the BML-2843 library with classifications per well by majority phenotype. See Supplementary Tables 31–35 for details.</p>
            </caption>
            <graphic position="anchor" xlink:href="41592_2023_1873_Fig12_ESM" id="d32e2328"/>
          </fig>
        </p>
      </sec>
    </app>
  </app-group>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>These authors contributed equally: Daniel Čapek, Matvey Safroshkin, Hernán Morales-Navarrete.</p>
    </fn>
  </fn-group>
  <sec>
    <sec id="FPar1">
      <title>Extended data</title>
      <p id="Par61">are available for this paper at 10.1038/s41592-023-01873-4.</p>
    </sec>
    <sec id="FPar2" sec-type="supplementary-material">
      <title>Supplementary information</title>
      <p id="Par62">The online version contains supplementary material available at 10.1038/s41592-023-01873-4.</p>
    </sec>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>This project has received funding from the European Research Council (ERC) under the European Union’s Horizon 2020 research and innovation program (grant agreement No. 863952 (ACE-OF-SPACE) to P.M.). This work was also funded by the EMBO Young Investigator Programme (P.M.), Max Planck Society (P.M., F.J.), the FWF (Project J-4507, D.Č.), the IZKF of the Medical Faculty of the University of Tübingen (P.M., N.T.), and the Deutsche Forschungsgemeinschaft (DFG, German Research Foundation) under Germany’s Excellence Strategy—EXC 2117—422037984 (P.M.). We thank K.W. Rogers, A. Schauer, K. Sarieva, I. Carmi and M. Rössler for scientific input, consulting and illustration support. We also thank O. Aust for initial drug screenings and A. Baccini for technical assistance with compound retesting. For participating in the classification of single embryo images, we thank M. Akyüz, L. Amann, A. Balb, A. Bangnowski, S. Baumgärtner, A.-S. Becker, S. Berber, S. Bergemann, T. Berger, L. Betz-Jung, L. Beuten, M. Brückner, L. Budig, N. Bürgers, P. Buslaps, D. Casaburi, L. Dangel, J. Davia, T. Decker, A. Eiberle, J. Engler, C. Feldmann, M. Franz, E. Frese, A. Fronius, B. Goldschmidt, C. Gomes, D. Gaßebner, L. Haas, L. Haßfeld, L. Heger, L. Helten, S. Hillman, S. Hinte, L. Huber, J. Iffelsberger, I. Jorzik, J. Jung, L. Kammerer, J. Klein, E. Kleinke, H. Klenk, V. Kneipp, M. Kölle, M. Kröner, V. Kuhn, P. Kukofka, J. Küpfer, Y. Lan, K. Land, C. Lewin, M. Lohmer, J. Lüders, X. Lyu, H. Mahl, R. Manukjan, M. Martini, A. Maslonka, P. Matijas-Graf, N. Meier, T. Morell, F. Natale, M. Nyesö, F. Piehler, A. Pirker, S. Rampp, V. Raupp, K.M. Reagan, A. Reiß, G. Rösler, F. Roßmann, J. Roylands, L. Ruf, J. Schiele, R. Schmidt, A. Schneider, M. Schön, M. Schröter, A. Schupp, F. Stiller, S. Stöckl, L. Thellmann, M. Thomann, D. Torcuk, Z. Umbach, R. Unsöld, C. Vogl, H.C. von Vegesack, R. Wagner, G. Wallig, M.A. Wannemacher, L. Wanner, F. Welsch, C. Wolfer, V. Zickenberg and M. Ziefle. We also thank T. Thumberger and J. Wittbrodt for providing the medaka Cab strain, and P. Huang for providing the <italic>pCS2-zGli3R-EGFP</italic> plasmid.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>P.M. and B.J. conceived the study. P.M. supervised the project. D.Č., J.B., M.S., N.T. and H.M.-N. manually annotated images. M.S. and G.A. developed the software for EmbryoNet. M.S., G.A. and H.M.-N. developed software for downstream analysis. N.T. and D.Č. performed the drug screens. N.T. analyzed the drug screen. H.M.-N. analyzed the zebrafish data, M.S. analyzed the medaka data and N.T. analyzed the stickleback data. A.K. performed the retests of the statins, carried out immunostainings and lightsheet microscopy, and acquired time series on the Keyence BZ-X810 microscope. H.M.-N. contributed to lightsheet imaging and performed pErk quantification. D.Č. carried out all other experiments. J.H., S.K. and F.J. provided in vitro fertilized stickleback embryos. D.Č. and P.M. wrote the paper with input from all of the authors.</p>
  </notes>
  <notes notes-type="peer-review">
    <title>Peer review</title>
    <sec id="FPar3">
      <title>Peer review information</title>
      <p id="Par63"><italic>Nature Methods</italic> thanks Marc Muller and the other, anonymous, reviewer(s) for their contribution to the peer review of this work. <xref rid="MOESM3" ref-type="media">Peer reviewer reports</xref> are available. Primary Handling Editor: Rita Strack, in collaboration with the <italic>Nature Methods</italic> team.</p>
    </sec>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>Training and evaluation datasets for EmbryoNet are available from <ext-link ext-link-type="uri" xlink:href="http://embryonet.uni-konstanz.de">http://embryonet.uni-konstanz.de</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.48606/15">https://doi.org/10.48606/15</ext-link>. The drug screen data are available from <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.48606/37">https://doi.org/10.48606/37</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.48606/38">https://doi.org/10.48606/38</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.48606/41">https://doi.org/10.48606/41</ext-link>. Additional data that support the findings of this study are available from <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.48606/53">https://doi.org/10.48606/53</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.48606/55">https://doi.org/10.48606/55</ext-link>.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>The source code for EmbryoNet is available from <ext-link ext-link-type="uri" xlink:href="http://github.com/mueller-lab/EmbryoNet">http://github.com/mueller-lab/EmbryoNet</ext-link> (<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.7531593">https://doi.org/10.5281/zenodo.7531593</ext-link>). Additional custom scripts used for data analysis in this study are available from <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.48606/15">https://doi.org/10.48606/15</ext-link>.</p>
  </notes>
  <notes id="FPar4" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par64">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marlow</surname>
            <given-names>FL</given-names>
          </name>
        </person-group>
        <article-title>Setting up for gastrulation in zebrafish</article-title>
        <source>Curr. Top. Dev. Biol.</source>
        <year>2020</year>
        <volume>136</volume>
        <fpage>33</fpage>
        <lpage>83</lpage>
        <?supplied-pmid 31959294?>
        <pub-id pub-id-type="pmid">31959294</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schier</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Talbot</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>Molecular genetics of axis formation in zebrafish</article-title>
        <source>Annu. Rev. Genet.</source>
        <year>2005</year>
        <volume>39</volume>
        <fpage>561</fpage>
        <lpage>613</lpage>
        <?supplied-pmid 16285872?>
        <pub-id pub-id-type="pmid">16285872</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heisenberg</surname>
            <given-names>CP</given-names>
          </name>
          <name>
            <surname>Solnica-Krezel</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Back and forth between cell fate specification and movement during vertebrate gastrulation</article-title>
        <source>Curr. Opin. Genet. Dev.</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>311</fpage>
        <lpage>316</lpage>
        <?supplied-pmid 18721878?>
        <pub-id pub-id-type="pmid">18721878</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Manzo</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Similarities between embryo development and cancer process suggest new strategies for research and therapy of tumors: a new point of view</article-title>
        <source>Front. Cell Dev. Biol.</source>
        <year>2019</year>
        <volume>7</volume>
        <fpage>20</fpage>
        <?supplied-pmid 30899759?>
        <pub-id pub-id-type="pmid">30899759</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nusse</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Clevers</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Wnt/beta-catenin signaling, disease, and emerging therapeutic modalities</article-title>
        <source>Cell</source>
        <year>2017</year>
        <volume>169</volume>
        <fpage>985</fpage>
        <lpage>999</lpage>
        <?supplied-pmid 28575679?>
        <pub-id pub-id-type="pmid">28575679</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gray</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>Roszko</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Solnica-Krezel</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Planar cell polarity: coordinating morphogenetic cell behaviors with embryonic polarity</article-title>
        <source>Dev. Cell</source>
        <year>2011</year>
        <volume>21</volume>
        <fpage>120</fpage>
        <lpage>133</lpage>
        <?supplied-pmid 21763613?>
        <pub-id pub-id-type="pmid">21763613</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Schier</surname>
            <given-names>AF</given-names>
          </name>
        </person-group>
        <article-title>Dampened Hedgehog signaling but normal Wnt signaling in zebrafish without cilia</article-title>
        <source>Development</source>
        <year>2009</year>
        <volume>136</volume>
        <fpage>3089</fpage>
        <lpage>3098</lpage>
        <?supplied-pmid 19700616?>
        <pub-id pub-id-type="pmid">19700616</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Woods</surname>
            <given-names>IG</given-names>
          </name>
          <name>
            <surname>Talbot</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>The you gene encodes an EGF-CUB protein essential for Hedgehog signaling in zebrafish</article-title>
        <source>PLoS Biol.</source>
        <year>2005</year>
        <volume>3</volume>
        <fpage>e66</fpage>
        <?supplied-pmid 15660164?>
        <pub-id pub-id-type="pmid">15660164</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schier</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Talbot</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>Nodal signaling and the zebrafish organizer</article-title>
        <source>Int. J. Dev. Biol.</source>
        <year>2001</year>
        <volume>45</volume>
        <fpage>289</fpage>
        <lpage>297</lpage>
        <?supplied-pmid 11291859?>
        <pub-id pub-id-type="pmid">11291859</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nasevicius</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ekker</surname>
            <given-names>SC</given-names>
          </name>
        </person-group>
        <article-title>Effective targeted gene ‘knockdown’ in zebrafish</article-title>
        <source>Nat. Genet.</source>
        <year>2000</year>
        <volume>26</volume>
        <fpage>216</fpage>
        <lpage>220</lpage>
        <?supplied-pmid 11017081?>
        <pub-id pub-id-type="pmid">11017081</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hino</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Roles of maternal wnt8a transcripts in axis formation in zebrafish</article-title>
        <source>Dev. Biol.</source>
        <year>2018</year>
        <volume>434</volume>
        <fpage>96</fpage>
        <lpage>107</lpage>
        <?supplied-pmid 29208373?>
        <pub-id pub-id-type="pmid">29208373</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lekven</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Thorpe</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Waxman</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Moon</surname>
            <given-names>RT</given-names>
          </name>
        </person-group>
        <article-title>Zebrafish wnt8 encodes two wnt8 proteins on a bicistronic transcript and is required for mesoderm and neurectoderm patterning</article-title>
        <source>Dev. Cell</source>
        <year>2001</year>
        <volume>1</volume>
        <fpage>103</fpage>
        <lpage>114</lpage>
        <?supplied-pmid 11703928?>
        <pub-id pub-id-type="pmid">11703928</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rohner</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Duplication of fgfr1 permits Fgf signaling to serve as a target for selection during domestication</article-title>
        <source>Curr. Biol.</source>
        <year>2009</year>
        <volume>19</volume>
        <fpage>1642</fpage>
        <lpage>1647</lpage>
        <?supplied-pmid 19733072?>
        <pub-id pub-id-type="pmid">19733072</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kishimoto</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>KH</given-names>
          </name>
          <name>
            <surname>Zon</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hammerschmidt</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schulte-Merker</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>The molecular nature of zebrafish swirl: BMP2 function is essential during early dorsoventral patterning</article-title>
        <source>Development</source>
        <year>1997</year>
        <volume>124</volume>
        <fpage>4457</fpage>
        <lpage>4466</lpage>
        <?supplied-pmid 9409664?>
        <pub-id pub-id-type="pmid">9409664</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shinya</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Eschbach</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lehrach</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Furutani-Seiki</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Zebrafish Dkk1, induced by the pre-MBT Wnt signaling, is secreted from the prechordal plate and patterns the anterior neural plate</article-title>
        <source>Mech. Dev.</source>
        <year>2000</year>
        <volume>98</volume>
        <fpage>3</fpage>
        <lpage>17</lpage>
        <?supplied-pmid 11044603?>
        <pub-id pub-id-type="pmid">11044603</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Begemann</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Schilling</surname>
            <given-names>TF</given-names>
          </name>
          <name>
            <surname>Rauch</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Geisler</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ingham</surname>
            <given-names>PW</given-names>
          </name>
        </person-group>
        <article-title>The zebrafish neckless mutation reveals a requirement for raldh2 in mesodermal signals that pattern the hindbrain</article-title>
        <source>Development</source>
        <year>2001</year>
        <volume>128</volume>
        <fpage>3081</fpage>
        <lpage>3094</lpage>
        <?supplied-pmid 11688558?>
        <pub-id pub-id-type="pmid">11688558</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stainier</surname>
            <given-names>DY</given-names>
          </name>
          <name>
            <surname>Fishman</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <article-title>Patterning the zebrafish heart tube: acquisition of anteroposterior polarity</article-title>
        <source>Dev. Biol.</source>
        <year>1992</year>
        <volume>153</volume>
        <fpage>91</fpage>
        <lpage>101</lpage>
        <?supplied-pmid 1516755?>
        <pub-id pub-id-type="pmid">1516755</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>LeCun</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Bengio</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hinton</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Deep learning</article-title>
        <source>Nature</source>
        <year>2015</year>
        <volume>521</volume>
        <fpage>436</fpage>
        <lpage>444</lpage>
        <?supplied-pmid 26017442?>
        <pub-id pub-id-type="pmid">26017442</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Russakovsky</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ImageNet large scale visual recognition challenge</article-title>
        <source>Int. J. Comput. Vis.</source>
        <year>2015</year>
        <volume>115</volume>
        <fpage>211</fpage>
        <lpage>252</lpage>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jumper</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Highly accurate protein structure prediction with AlphaFold</article-title>
        <source>Nature</source>
        <year>2021</year>
        <volume>596</volume>
        <fpage>583</fpage>
        <lpage>589</lpage>
        <?supplied-pmid 34265844?>
        <pub-id pub-id-type="pmid">34265844</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jumper</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hassabis</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Protein structure predictions to atomic accuracy with AlphaFold</article-title>
        <source>Nat. Methods</source>
        <year>2022</year>
        <volume>19</volume>
        <fpage>11</fpage>
        <lpage>12</lpage>
        <?supplied-pmid 35017726?>
        <pub-id pub-id-type="pmid">35017726</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Senior</surname>
            <given-names>AW</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Improved protein structure prediction using potentials from deep learning</article-title>
        <source>Nature</source>
        <year>2020</year>
        <volume>577</volume>
        <fpage>706</fpage>
        <lpage>710</lpage>
        <?supplied-pmid 31942072?>
        <pub-id pub-id-type="pmid">31942072</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tunyasuvunakool</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Highly accurate protein structure prediction for the human proteome</article-title>
        <source>Nature</source>
        <year>2021</year>
        <volume>596</volume>
        <fpage>590</fpage>
        <lpage>596</lpage>
        <?supplied-pmid 34293799?>
        <pub-id pub-id-type="pmid">34293799</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reichstein</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Deep learning and process understanding for data-driven Earth system science</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>566</volume>
        <fpage>195</fpage>
        <lpage>204</lpage>
        <?supplied-pmid 30760912?>
        <pub-id pub-id-type="pmid">30760912</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hallou</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yevick</surname>
            <given-names>HG</given-names>
          </name>
          <name>
            <surname>Dumitrascu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Uhlmann</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Deep learning for bioimage analysis in developmental biology</article-title>
        <source>Development</source>
        <year>2021</year>
        <volume>148</volume>
        <fpage>dev199616</fpage>
        <?supplied-pmid 34490888?>
        <pub-id pub-id-type="pmid">34490888</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moen</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Deep learning for cellular image analysis</article-title>
        <source>Nat. Methods</source>
        <year>2019</year>
        <volume>16</volume>
        <fpage>1233</fpage>
        <lpage>1246</lpage>
        <?supplied-pmid 31133758?>
        <pub-id pub-id-type="pmid">31133758</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weigert</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Content-aware image restoration: pushing the limits of fluorescence microscopy</article-title>
        <source>Nat. Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>1090</fpage>
        <lpage>1097</lpage>
        <?supplied-pmid 30478326?>
        <pub-id pub-id-type="pmid">30478326</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McQuin</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CellProfiler 3.0: next-generation image processing for biology</article-title>
        <source>PLoS Biol.</source>
        <year>2018</year>
        <volume>16</volume>
        <fpage>e2005970</fpage>
        <?supplied-pmid 29969450?>
        <pub-id pub-id-type="pmid">29969450</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stringer</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Michaelos</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pachitariu</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Cellpose: a generalist algorithm for cellular segmentation</article-title>
        <source>Nat. Methods</source>
        <year>2021</year>
        <volume>18</volume>
        <fpage>100</fpage>
        <lpage>106</lpage>
        <?supplied-pmid 33318659?>
        <pub-id pub-id-type="pmid">33318659</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Naert</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Deep learning is widely applicable to phenotyping embryonic development and disease</article-title>
        <source>Development</source>
        <year>2021</year>
        <volume>148</volume>
        <fpage>dev199664</fpage>
        <?supplied-pmid 34739029?>
        <pub-id pub-id-type="pmid">34739029</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tyagi</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Patel</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Ishwar</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>A fine-tuned convolution neural network based approach for phenotype classification of zebrafish</article-title>
        <source>Procedia Computer Science</source>
        <year>2018</year>
        <volume>126</volume>
        <fpage>1138</fpage>
        <lpage>1144</lpage>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Jeanray, N. et al. Phenotype classification of zebrafish embryos by supervised learning. <italic>PLoS ONE</italic><bold>10</bold>, e0116989 (2015).</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <mixed-citation publication-type="other">Khosravi, P. et al. Deep learning enables robust assessment and selection of human blastocysts after in vitro fertilization. <italic>npj Digit. Med.</italic><bold>2</bold>, 21 (2019).</mixed-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baris Atakan</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Alkanat</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Cornaglia</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Trouillon</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gijs</surname>
            <given-names>MAM</given-names>
          </name>
        </person-group>
        <article-title>Automated phenotyping of <italic>Caenorhabditis elegans</italic> embryos with a high-throughput-screening microfluidic platform</article-title>
        <source>Microsyst. Nanoeng.</source>
        <year>2020</year>
        <volume>6</volume>
        <fpage>24</fpage>
        <?supplied-pmid 34567639?>
        <pub-id pub-id-type="pmid">34567639</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <mixed-citation publication-type="other">Suryanto, M. E. et al. Using DeepLabCut as a real-time and markerless tool for cardiac physiology assessment in zebrafish. <italic>Biology</italic><bold>11</bold>, 1243 (2022).</mixed-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tills</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A high-throughput and open-source platform for embryo phenomics</article-title>
        <source>PLoS Biol.</source>
        <year>2018</year>
        <volume>16</volume>
        <fpage>e3000074</fpage>
        <?supplied-pmid 30543636?>
        <pub-id pub-id-type="pmid">30543636</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shen</surname>
            <given-names>MM</given-names>
          </name>
        </person-group>
        <article-title>Nodal signaling: developmental roles and regulation</article-title>
        <source>Development</source>
        <year>2007</year>
        <volume>134</volume>
        <fpage>1023</fpage>
        <lpage>1034</lpage>
        <?supplied-pmid 17287255?>
        <pub-id pub-id-type="pmid">17287255</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DaCosta Byfield</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Major</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Laping</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Roberts</surname>
            <given-names>AB</given-names>
          </name>
        </person-group>
        <article-title>SB-505124 is a selective inhibitor of transforming growth factor-beta type I receptors ALK4, ALK5, and ALK7</article-title>
        <source>Mol. Pharmacol.</source>
        <year>2004</year>
        <volume>65</volume>
        <fpage>744</fpage>
        <lpage>752</lpage>
        <?supplied-pmid 14978253?>
        <pub-id pub-id-type="pmid">14978253</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hagos</surname>
            <given-names>EG</given-names>
          </name>
          <name>
            <surname>Dougan</surname>
            <given-names>ST</given-names>
          </name>
        </person-group>
        <article-title>Time-dependent patterning of the mesoderm and endoderm by Nodal signals in zebrafish</article-title>
        <source>BMC Dev. Biol.</source>
        <year>2007</year>
        <volume>7</volume>
        <fpage>22</fpage>
        <?supplied-pmid 17391517?>
        <pub-id pub-id-type="pmid">17391517</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <mixed-citation publication-type="other">He, K., Zhang, X., Ren, S. &amp; Sun, J. Deep residual learning for image recognition. In <italic>2016 IEEE Conference on Computer Vision and Pattern Recognition</italic> (<italic>CVPR</italic>) 770–778 (2016).</mixed-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <mixed-citation publication-type="other">Gritsman, K. et al. The EGF-CFC protein One-eyed pinhead is essential for Nodal signaling. <italic>Cell</italic><bold>97</bold>, 121–132 (1999).</mixed-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The development of highly potent inhibitors for porcupine</article-title>
        <source>J. Med. Chem.</source>
        <year>2013</year>
        <volume>56</volume>
        <fpage>2700</fpage>
        <lpage>2704</lpage>
        <?supplied-pmid 23477365?>
        <pub-id pub-id-type="pmid">23477365</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <mixed-citation publication-type="other">Sun, L. et al. Design, synthesis, and evaluations of substituted 3-[(3- or 4-carboxyethylpyrrol-2-yl)methylidenyl]indolin-2-ones as inhibitors of VEGF, FGF, and PDGF receptor tyrosine kinases. <italic>J. Med. Chem.</italic><bold>42</bold>, 5120–5130 (1999).</mixed-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cuny</surname>
            <given-names>GD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Structure-activity relationship study of bone morphogenetic protein (BMP) signaling inhibitors</article-title>
        <source>Bioorg. Med. Chem. Lett.</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>4388</fpage>
        <lpage>4392</lpage>
        <?supplied-pmid 18621530?>
        <pub-id pub-id-type="pmid">18621530</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Incardona</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Gaffield</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Kapur</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Roelink</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>The teratogenic Veratrum alkaloid cyclopamine inhibits sonic hedgehog signal transduction</article-title>
        <source>Development</source>
        <year>1998</year>
        <volume>125</volume>
        <fpage>3553</fpage>
        <lpage>3562</lpage>
        <?supplied-pmid 9716521?>
        <pub-id pub-id-type="pmid">9716521</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dougan</surname>
            <given-names>ST</given-names>
          </name>
          <name>
            <surname>Warga</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Kane</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Schier</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Talbot</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>The role of the zebrafish nodal-related genes squint and cyclops in patterning of mesendoderm</article-title>
        <source>Development</source>
        <year>2003</year>
        <volume>130</volume>
        <fpage>1837</fpage>
        <lpage>1851</lpage>
        <?supplied-pmid 12642489?>
        <pub-id pub-id-type="pmid">12642489</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <mixed-citation publication-type="other">Zhou, B., Khosla, A., Lapedriza, A., Oliva, A. &amp; Torralba, A. Learning deep features for discriminative localization. Preprint at <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1512.04150">https://arxiv.org/abs/1512.04150</ext-link> (2015).</mixed-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Müller</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Differential diffusivity of Nodal and Lefty underlies a reaction–diffusion patterning system</article-title>
        <source>Science</source>
        <year>2012</year>
        <volume>336</volume>
        <fpage>721</fpage>
        <lpage>724</lpage>
        <?supplied-pmid 22499809?>
        <pub-id pub-id-type="pmid">22499809</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van Boxtel</surname>
            <given-names>AL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A temporal window for signal activation dictates the dimensions of a Nodal signaling domain</article-title>
        <source>Dev. Cell</source>
        <year>2015</year>
        <volume>35</volume>
        <fpage>175</fpage>
        <lpage>185</lpage>
        <?supplied-pmid 26506307?>
        <pub-id pub-id-type="pmid">26506307</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bilder</surname>
            <given-names>RM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Phenomics: the systematic study of phenotypes on a genome-wide scale</article-title>
        <source>Neuroscience</source>
        <year>2009</year>
        <volume>164</volume>
        <fpage>30</fpage>
        <lpage>42</lpage>
        <?supplied-pmid 19344640?>
        <pub-id pub-id-type="pmid">19344640</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <mixed-citation publication-type="other">Campos, L. M. et al. Alterations in zebrafish development induced by simvastatin: comprehensive morphological and physiological study, focusing on muscle. <italic>Exp. Biol. Med.</italic><bold>241</bold>, 1950–1960 (2016).</mixed-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Campos</surname>
            <given-names>LM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Structural analysis of alterations in zebrafish muscle differentiation induced by simvastatin and their recovery with cholesterol</article-title>
        <source>J. Histochem. Cytochem.</source>
        <year>2015</year>
        <volume>63</volume>
        <fpage>427</fpage>
        <lpage>437</lpage>
        <?supplied-pmid 25786435?>
        <pub-id pub-id-type="pmid">25786435</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maerz</surname>
            <given-names>LD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Pharmacological cholesterol depletion disturbs ciliogenesis and ciliary function in developing zebrafish</article-title>
        <source>Commun. Biol.</source>
        <year>2019</year>
        <volume>2</volume>
        <fpage>31</fpage>
        <?supplied-pmid 30729178?>
        <pub-id pub-id-type="pmid">30729178</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thorpe</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Doitsidou</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ho</surname>
            <given-names>SY</given-names>
          </name>
          <name>
            <surname>Raz</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Farber</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>Germ cell migration in zebrafish is dependent on HMGCoA reductase activity and prenylation</article-title>
        <source>Dev. Cell</source>
        <year>2004</year>
        <volume>6</volume>
        <fpage>295</fpage>
        <lpage>302</lpage>
        <?supplied-pmid 14960282?>
        <pub-id pub-id-type="pmid">14960282</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leerberg</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Hopton</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Draper</surname>
            <given-names>BW</given-names>
          </name>
        </person-group>
        <article-title>Fibroblast growth factor receptors function redundantly during zebrafish embryonic development</article-title>
        <source>Genetics</source>
        <year>2019</year>
        <volume>212</volume>
        <fpage>1301</fpage>
        <lpage>1319</lpage>
        <?supplied-pmid 31175226?>
        <pub-id pub-id-type="pmid">31175226</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Draper</surname>
            <given-names>BW</given-names>
          </name>
          <name>
            <surname>Stock</surname>
            <given-names>DW</given-names>
          </name>
          <name>
            <surname>Kimmel</surname>
            <given-names>CB</given-names>
          </name>
        </person-group>
        <article-title>Zebrafish fgf24 functions with fgf8 to promote posterior mesodermal development</article-title>
        <source>Development</source>
        <year>2003</year>
        <volume>130</volume>
        <fpage>4639</fpage>
        <lpage>4654</lpage>
        <?supplied-pmid 12925590?>
        <pub-id pub-id-type="pmid">12925590</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Economou</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Guglielmi</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>East</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>CS</given-names>
          </name>
        </person-group>
        <article-title>Nodal signaling establishes a competency window for stochastic cell fate switching</article-title>
        <source>Dev. Cell</source>
        <year>2022</year>
        <volume>57</volume>
        <fpage>2604</fpage>
        <lpage>2622</lpage>
        <?supplied-pmid 36473458?>
        <pub-id pub-id-type="pmid">36473458</pub-id>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Piotrowski</surname>
            <given-names>PC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Statins inhibit growth of human endometrial stromal cells independently of cholesterol availability</article-title>
        <source>Biol. Reprod.</source>
        <year>2006</year>
        <volume>75</volume>
        <fpage>107</fpage>
        <lpage>111</lpage>
        <?supplied-pmid 16571871?>
        <pub-id pub-id-type="pmid">16571871</pub-id>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <mixed-citation publication-type="other">Pfister, P., Randall, J., Montoya-Burgos, J. I. &amp; Rodriguez, I. Divergent evolution among teleost V1r receptor genes. <italic>PLoS ONE</italic><bold>2</bold>, e379 (2007).</mixed-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wittbrodt</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Shima</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schartl</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Medaka: a model organism from the far East</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2002</year>
        <volume>3</volume>
        <fpage>53</fpage>
        <lpage>64</lpage>
        <?supplied-pmid 11823791?>
        <pub-id pub-id-type="pmid">11823791</pub-id>
      </element-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Iwamatsu</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Stages of normal development in the medaka <italic>Oryzias latipes</italic></article-title>
        <source>Mech. Dev.</source>
        <year>2004</year>
        <volume>121</volume>
        <fpage>605</fpage>
        <lpage>618</lpage>
        <?supplied-pmid 15210170?>
        <pub-id pub-id-type="pmid">15210170</pub-id>
      </element-citation>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Swarup</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Stages in the development of the stickleback <italic>Gasterosteus aculeatus</italic> (L.)</article-title>
        <source>J. Embryol. Exp. Morphol.</source>
        <year>1958</year>
        <volume>6</volume>
        <fpage>373</fpage>
        <lpage>383</lpage>
        <?supplied-pmid 13575650?>
        <pub-id pub-id-type="pmid">13575650</pub-id>
      </element-citation>
    </ref>
    <ref id="CR63">
      <label>63.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Houle</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Govindaraju</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Omholt</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Phenomics: the next challenge</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>855</fpage>
        <lpage>866</lpage>
        <?supplied-pmid 21085204?>
        <pub-id pub-id-type="pmid">21085204</pub-id>
      </element-citation>
    </ref>
    <ref id="CR64">
      <label>64.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brown</surname>
            <given-names>SDM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>High-throughput mouse phenomics for characterizing mammalian gene function</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>357</fpage>
        <lpage>370</lpage>
        <?supplied-pmid 29626206?>
        <pub-id pub-id-type="pmid">29626206</pub-id>
      </element-citation>
    </ref>
    <ref id="CR65">
      <label>65.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>D’Orazio</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Machine learning phenomics (MLP) combining deep learning with time-lapse-microscopy for monitoring colorectal adenocarcinoma cells gene expression and drug-response</article-title>
        <source>Sci. Rep.</source>
        <year>2022</year>
        <volume>12</volume>
        <fpage>8545</fpage>
        <?supplied-pmid 35595808?>
        <pub-id pub-id-type="pmid">35595808</pub-id>
      </element-citation>
    </ref>
    <ref id="CR66">
      <label>66.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Watson</surname>
            <given-names>CJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Phenomics-based quantification of CRISPR-induced mosaicism in zebrafish</article-title>
        <source>Cell Syst.</source>
        <year>2020</year>
        <volume>10</volume>
        <fpage>275</fpage>
        <lpage>286</lpage>
        <?supplied-pmid 32191876?>
        <pub-id pub-id-type="pmid">32191876</pub-id>
      </element-citation>
    </ref>
    <ref id="CR67">
      <label>67.</label>
      <mixed-citation publication-type="other">Nabwire, S., Suh, H. K., Kim, M. S., Baek, I. &amp; Cho, B. K. Review: application of artificial intelligence in phenomics. <italic>Sensors</italic><bold>21</bold>, 4363 (2021).</mixed-citation>
    </ref>
    <ref id="CR68">
      <label>68.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Čapek</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ünalan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Wie Tiere sich selbst konstruieren</article-title>
        <source>Biospektrum</source>
        <year>2021</year>
        <volume>27</volume>
        <fpage>473</fpage>
        <lpage>477</lpage>
      </element-citation>
    </ref>
    <ref id="CR69">
      <label>69.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Williams</surname>
            <given-names>BB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>VANGL2 regulates membrane trafficking of MMP14 to control cell polarity and migration</article-title>
        <source>J. Cell Sci.</source>
        <year>2012</year>
        <volume>125</volume>
        <fpage>2141</fpage>
        <lpage>2147</lpage>
        <?supplied-pmid 22357946?>
        <pub-id pub-id-type="pmid">22357946</pub-id>
      </element-citation>
    </ref>
    <ref id="CR70">
      <label>70.</label>
      <mixed-citation publication-type="other">Pomreinke, A. P. et al. Dynamics of BMP signaling and distribution during zebrafish dorsal–-ventral patterning. <italic>eLife</italic><bold>6</bold>, e25861 (2017).</mixed-citation>
    </ref>
    <ref id="CR71">
      <label>71.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Duda</surname>
            <given-names>RO</given-names>
          </name>
          <name>
            <surname>Hart</surname>
            <given-names>PE</given-names>
          </name>
        </person-group>
        <article-title>Use of the Hough transformation to detect lines and curves in pictures</article-title>
        <source>Communications of the ACM</source>
        <year>1972</year>
        <volume>15</volume>
        <fpage>11</fpage>
        <lpage>15</lpage>
      </element-citation>
    </ref>
    <ref id="CR72">
      <label>72.</label>
      <mixed-citation publication-type="other">Wojke, N., Bewley, A. &amp; Paulus, D. Simple online and realtime tracking with a deep association metric. In <italic>2017 IEEE International Conference on Image Processing</italic> (<italic>ICIP</italic>) 3645–3649 (2017).</mixed-citation>
    </ref>
    <ref id="CR73">
      <label>73.</label>
      <mixed-citation publication-type="other">Spelmen, V. S. &amp; Porkodi, R. A review on handling imbalanced data. In <italic>2018 International Conference on Current Trends towards Converging Technologies</italic> (<italic>ICCTCT</italic>) 1–11 (2018).</mixed-citation>
    </ref>
    <ref id="CR74">
      <label>74.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rumelhart</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Hinton</surname>
            <given-names>GE</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>RJ</given-names>
          </name>
        </person-group>
        <article-title>Learning representations by back-propagating errors</article-title>
        <source>Nature</source>
        <year>1986</year>
        <volume>323</volume>
        <fpage>533</fpage>
        <lpage>536</lpage>
      </element-citation>
    </ref>
    <ref id="CR75">
      <label>75.</label>
      <mixed-citation publication-type="other">Buslaev, A. et al. Albumentations: fast and flexible image augmentations. <italic>Information</italic><bold>11</bold>, 125 (2020).</mixed-citation>
    </ref>
    <ref id="CR76">
      <label>76.</label>
      <mixed-citation publication-type="other">Rogers, K. W., ElGamacy, M., Jordan, B. M. &amp; Müller, P. Optogenetic investigation of BMP target gene expression diversity. <italic>eLife</italic><bold>9</bold>, e58641 (2020).</mixed-citation>
    </ref>
    <ref id="CR77">
      <label>77.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schindelin</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fiji: an open-source platform for biological-image analysis</article-title>
        <source>Nat. Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>676</fpage>
        <lpage>682</lpage>
        <?supplied-pmid 22743772?>
        <pub-id pub-id-type="pmid">22743772</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Methods</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Methods</journal-id>
    <journal-title-group>
      <journal-title>Nature Methods</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1548-7091</issn>
    <issn pub-type="epub">1548-7105</issn>
    <publisher>
      <publisher-name>Nature Publishing Group US</publisher-name>
      <publisher-loc>New York</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10250202</article-id>
    <article-id pub-id-type="pmid">37156842</article-id>
    <article-id pub-id-type="publisher-id">1873</article-id>
    <article-id pub-id-type="doi">10.1038/s41592-023-01873-4</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Resource</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>EmbryoNet: using deep learning to link embryonic phenotypes to signaling pathways</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5199-9940</contrib-id>
        <name>
          <surname>Čapek</surname>
          <given-names>Daniel</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Safroshkin</surname>
          <given-names>Matvey</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9578-2556</contrib-id>
        <name>
          <surname>Morales-Navarrete</surname>
          <given-names>Hernán</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3505-7325</contrib-id>
        <name>
          <surname>Toulany</surname>
          <given-names>Nikan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Arutyunov</surname>
          <given-names>Grigory</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kurzbach</surname>
          <given-names>Anica</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bihler</surname>
          <given-names>Johanna</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hagauer</surname>
          <given-names>Julia</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kick</surname>
          <given-names>Sebastian</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jones</surname>
          <given-names>Felicity</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jordan</surname>
          <given-names>Ben</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0702-6209</contrib-id>
        <name>
          <surname>Müller</surname>
          <given-names>Patrick</given-names>
        </name>
        <address>
          <email>patrick.mueller@uni-konstanz.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.9811.1</institution-id><institution-id institution-id-type="ISNI">0000 0001 0658 7699</institution-id><institution>Systems Biology of Development, </institution><institution>University of Konstanz, </institution></institution-wrap>Konstanz, Germany </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.418026.9</institution-id><institution-id institution-id-type="ISNI">0000 0004 0492 0357</institution-id><institution>Friedrich Miescher Laboratory of the Max Planck Society, </institution></institution-wrap>Tübingen, Germany </aff>
      <aff id="Aff3"><label>3</label>Computer Vision Studio, Tübingen, Germany </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.517314.5</institution-id><institution>Centre for the Advanced Study of Collective Behaviour, </institution></institution-wrap>Konstanz, Germany </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>8</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>8</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <year>2023</year>
    </pub-date>
    <volume>20</volume>
    <issue>6</issue>
    <fpage>815</fpage>
    <lpage>823</lpage>
    <history>
      <date date-type="received">
        <day>26</day>
        <month>9</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>5</day>
        <month>4</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Evolutionarily conserved signaling pathways are essential for early embryogenesis, and reducing or abolishing their activity leads to characteristic developmental defects. Classification of phenotypic defects can identify the underlying signaling mechanisms, but this requires expert knowledge and the classification schemes have not been standardized. Here we use a machine learning approach for automated phenotyping to train a deep convolutional neural network, EmbryoNet, to accurately identify zebrafish signaling mutants in an unbiased manner. Combined with a model of time-dependent developmental trajectories, this approach identifies and classifies with high precision phenotypic defects caused by loss of function of the seven major signaling pathways relevant for vertebrate development. Our classification algorithms have wide applications in developmental biology and robustly identify signaling defects in evolutionarily distant species. Furthermore, using automated phenotyping in high-throughput drug screens, we show that EmbryoNet can resolve the mechanism of action of pharmaceutical substances. As part of this work, we freely provide more than 2 million images that were used to train and test EmbryoNet.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">EmbryoNet is an automated approach to the phenotyping of developing embryos that surpasses experts in terms of speed, accuracy and sensitivity. A large annotated image dataset of zebrafish, medaka and stickleback development rounds out this resource.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Embryogenesis</kwd>
      <kwd>Machine learning</kwd>
      <kwd>Image processing</kwd>
      <kwd>High-throughput screening</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100010663</institution-id>
            <institution>EC | EU Framework Programme for Research and Innovation H2020 | H2020 Priority Excellent Science | H2020 European Research Council (H2020 Excellent Science - European Research Council)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>863952</award-id>
        <principal-award-recipient>
          <name>
            <surname>Müller</surname>
            <given-names>Patrick</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100001659</institution-id>
            <institution>Deutsche Forschungsgemeinschaft (German Research Foundation)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>EXC 2117 – 422037984</award-id>
        <principal-award-recipient>
          <name>
            <surname>Müller</surname>
            <given-names>Patrick</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100004189</institution-id>
            <institution>Max-Planck-Gesellschaft (Max Planck Society)</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>EMBO Young Investigator Programme</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100002428</institution-id>
            <institution>Austrian Science Fund (Fonds zur Förderung der Wissenschaftlichen Forschung)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>J-4507</award-id>
        <principal-award-recipient>
          <name>
            <surname>Čapek</surname>
            <given-names>Daniel</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>IZKF of the Medical Faculty of the University of Tübingen</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© Springer Nature America, Inc. 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Main</title>
    <p id="Par3">Early development is governed by a handful of signaling pathways that balance tissue growth, differentiation and morphogenesis<sup><xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref></sup>. Given their important roles in controlling cell identity and behavior, misregulation of signaling pathways in adult tissues can induce the formation of tumors with embryo-like properties, defective cell proliferation and migration<sup><xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR5">5</xref></sup>.</p>
    <p id="Par4">During zebrafish development, seven major signaling pathways orchestrate the formation of the body plan. Bone morphogenetic protein (BMP), retinoic acid (RA), Wnt, fibroblast growth factor (FGF) and Nodal pattern the germ layers and regulate the formation of the orthogonal anterior–posterior and dorsal–ventral axes; Sonic hedgehog (Shh) and planar cell polarity (PCP) signaling, in turn, control the elongation and morphogenesis of the body axis and later shape the formation of tissues<sup><xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR3">3</xref>,<xref ref-type="bibr" rid="CR6">6</xref>–<xref ref-type="bibr" rid="CR8">8</xref></sup>. The ligands activating these signaling pathways are dynamically expressed from specific source tissues in the embryo (Fig. <xref rid="Fig1" ref-type="fig">1a</xref> and Supplementary Note <xref rid="MOESM1" ref-type="media">1</xref>). Loss of activity in any of these pathways causes characteristic patterning defects, which, however, can be difficult to distinguish (Fig. <xref rid="Fig1" ref-type="fig">1b</xref> and Supplementary Videos <xref rid="MOESM5" ref-type="media">1</xref>–<xref rid="MOESM12" ref-type="media">8</xref>). For example, both Nodal and Shh mutants have cyclopic eyes (Fig. <xref rid="Fig1" ref-type="fig">1b</xref> and Supplementary Videos <xref rid="MOESM10" ref-type="media">6</xref> and <xref rid="MOESM11" ref-type="media">7</xref>), but the defect in Nodal mutants is caused by an early lack of mesoderm<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>, whereas cyclopia in Shh mutants is caused by a late defect in midline patterning<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. Furthermore, while misregulation of the BMP, Wnt, RA, FGF and PCP signaling pathways leads to specific defects, for example, an enlarged head in the case of Wnt mutants<sup><xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR12">12</xref></sup>, all of these mutants also have malformed shortened tails<sup><xref ref-type="bibr" rid="CR13">13</xref>–<xref ref-type="bibr" rid="CR17">17</xref></sup> (Fig. <xref rid="Fig1" ref-type="fig">1b</xref> and Supplementary Videos <xref rid="MOESM6" ref-type="media">2</xref>–<xref rid="MOESM9" ref-type="media">5</xref>, <xref rid="MOESM12" ref-type="media">8</xref>). Thus, the phenotypes caused by changes in the activity of different signaling pathways can be easily confused by even the most experienced developmental biologists. Automated and unbiased phenotyping based on a multitude of morphological features would overcome this challenge. Such an approach would rapidly link phenotypes arising from genetic defects, mutants identified in forward and reverse genetic screens, or treatment with small-molecule inhibitors to the relevant signaling pathway. Automated phenotyping of morphological defects would thus enhance both the speed and accuracy of biological and pharmaceutical discovery.<fig id="Fig1"><label>Fig. 1</label><caption><title>The CNN EmbryoNet robustly identifies molecular defects based on phenotype data.</title><p><bold>a</bold>, Simplified schematic of signaling domains during zebrafish development projected onto an early embryo. <bold>b</bold>, Schematic drawings of zebrafish embryo phenotypes. −BMP loss of function causes reduced and often curled tails, +RA gain-of-function embryos lack head structures and have shortened tails, −Wnt leads to enlarged heads and shortened tails, −FGF causes loss of mesoderm and tail tissue, −Nodal embryos lack mesoderm and have cyclopia, −Shh embryos frequently have mispatterned somites and cyclopia, and −PCP leads to a shortened and widened body axis, manifested, for example, by shorter somites. <bold>c</bold>,<bold>d</bold>, Treatment with the chemical Nodal inhibitor SB-505124 caused specific phenotypes that were not yet apparent at sphere stage (<bold>c (i)</bold>), but which were clearly visible at segmentation stages (<bold>c (ii)</bold>); <italic>n</italic> = 36. The inhibitor treatment (<bold>c (iii)</bold>) phenocopied the MZ<italic>oep</italic> (<bold>d</bold>) mutant, and both phenotypes were robustly identified by EmbryoNet; <italic>n</italic> = 58. <bold>e</bold>,<bold>f</bold>, Schematic overview of the neural network architecture with convolutional (Conv) layers shown in blue. Stack sizes after each image filter are illustrated in <bold>e</bold>, whereas <bold>f</bold> details the filters of the network. Relu, rectified linear unit. <bold>g</bold>–<bold>i</bold>, EmbryoNet correctly classified embryos in a mixed population. <bold>g</bold>, Experimental set-up. Embryos at the one-cell stage were injected with mRNA encoding the Nodal inhibitor Lefty1 and Alexa647-labeled dextran (magenta), mRNA encoding the BMP inhibitor Chordin and Alexa488-labeled dextran (green), or were left uninjected (wild type) and then imaged. Black bounding boxes indicate the class Unknown; green indicates −Nodal; red indicates −BMP; white indicates Normal and magenta indicates Dead. <bold>h</bold>, At the sphere stage, EmbryoNet labeled the phenotypes as Unknown. Dextran-labeling shows the applied treatment. <bold>i</bold>, During segmentation stages the Normal, −BMP and −Nodal samples were correctly identified by EmbryoNet. The classification is in accordance with the dextran colors; <italic>n</italic> = 85. Scale bar, 500 µm.</p></caption><graphic xlink:href="41592_2023_1873_Fig1_HTML" id="d32e522"/></fig></p>
    <p id="Par5">Advances in deep learning approaches<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> have brought unprecedented breakthroughs in numerous fields ranging from bioimage analysis and visual object recognition<sup><xref ref-type="bibr" rid="CR19">19</xref></sup> to protein structure prediction<sup><xref ref-type="bibr" rid="CR20">20</xref>–<xref ref-type="bibr" rid="CR23">23</xref></sup> and earth system science<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>. Deep learning approaches perform exceptionally well in decoding the content of images<sup><xref ref-type="bibr" rid="CR25">25</xref>,<xref ref-type="bibr" rid="CR26">26</xref></sup>, and convolutional neural networks (CNNs) in particular have been extensively used for bioimage restoration<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>, cell detection and classification<sup><xref ref-type="bibr" rid="CR28">28</xref></sup> and bioimage data segmentation<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>. Recent studies have also used machine learning approaches to examine embryonic phenotypes<sup><xref ref-type="bibr" rid="CR30">30</xref>–<xref ref-type="bibr" rid="CR36">36</xref></sup>, but these approaches were limited to staging, segmentation and classification of specific embryos and organs without being able to uncover the molecular basis of morphological alterations.</p>
    <p id="Par6">Here, we introduce a deep learning approach, EmbryoNet, that can detect specific defects linked to the seven major vertebrate signaling pathways by automated phenotyping. EmbryoNet was trained on more than 2 million images, comprising thousands of trajectories of normally developing and signaling-defective zebrafish embryos. We found that EmbryoNet identified phenotypes more precisely and often long before human evaluators could detect them. By using the accelerated phenotype classification of EmbryoNet in an automated drug screen, we identified novel teratogenic effects caused by Food and Drug Administration (FDA)-approved substances not previously associated with the regulation of developmental signaling pathways. Finally, we show that EmbryoNet can identify signaling defects in evolutionarily distant species, demonstrating the generalizability of our approach.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>Identification of signaling defects in zebrafish embryos</title>
      <p id="Par7">To test whether deep learning approaches can be used for the automatic classification of complex phenotypes caused by the loss of signaling pathways in zebrafish, we combined high-throughput imaging with specific drug-mediated loss-of-function approaches. We started with proof-of-concept experiments focused on Nodal signaling because both the signaling pathway constituents and their functions during the first day of zebrafish embryogenesis are well described<sup><xref ref-type="bibr" rid="CR37">37</xref></sup> (Supplementary Note <xref rid="MOESM1" ref-type="media">1</xref> and Fig. <xref rid="Fig1" ref-type="fig">1a</xref>). In addition, a specific small molecule targeting the ATP-binding pocket of the receptor kinase is available<sup><xref ref-type="bibr" rid="CR38">38</xref></sup> (Supplementary Note <xref rid="MOESM1" ref-type="media">2</xref>), facilitating the rapid acquisition of defined developmental phenotypes from a large number of embryos. Indeed, the inhibitor SB-505124 clearly recapitulated the known loss-of-function phenotypes of Nodal signaling pathway components<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>, that is, cyclopia and loss of all endoderm and head–trunk mesoderm (Fig. <xref rid="Fig1" ref-type="fig">1a–c</xref> and Supplementary Video <xref rid="MOESM10" ref-type="media">6</xref>). We then acquired bright-field movies of SB-505124-treated and untreated embryos in random orientations, comprising a total of 342,559 images between 2 and 26 hours post-fertilization (h.p.f.). A modified version of the ResNet18 CNN that includes a timestamp of the images (Fig. <xref rid="Fig1" ref-type="fig">1e,f</xref> and <xref rid="Sec9" ref-type="sec">Methods</xref>)<sup><xref ref-type="bibr" rid="CR40">40</xref></sup> trained with these datasets robustly and correctly identified normal and Nodal-defective embryos, independent of their orientation and whether small molecules (SB-505124) or mutants (maternal zygotic <italic>oep</italic> mutants, MZ<italic>oep</italic><sup><xref ref-type="bibr" rid="CR41">41</xref></sup>) were used to create Nodal loss-of-function phenotypes (Fig. <xref rid="Fig1" ref-type="fig">1c,d</xref> and Extended Data Fig. <xref rid="Fig5" ref-type="fig">1</xref>).</p>
      <p id="Par8">We next extended this approach to the seven major signaling pathways that control early development: BMP, RA, Wnt, FGF, Nodal, Shh and PCP (Fig. <xref rid="Fig1" ref-type="fig">1a,b</xref>). Using a chemical genetics approach with specific signaling pathway modulators<sup><xref ref-type="bibr" rid="CR38">38</xref>,<xref ref-type="bibr" rid="CR42">42</xref>–<xref ref-type="bibr" rid="CR45">45</xref></sup> (Supplementary Table <xref rid="MOESM4" ref-type="media">1</xref> and Supplementary Note <xref rid="MOESM1" ref-type="media">2</xref>), we created a dataset of more than 2 million images with loss-of-function (or gain-of-function in the case of RA) phenotypes (Supplementary Videos <xref rid="MOESM5" ref-type="media">1</xref>–<xref rid="MOESM12" ref-type="media">8</xref>). The dataset was manually annotated by curators who were informed about the treatment of each embryo. The curators assigned classes appropriate for each treatment (that is, <italic>−</italic>BMP, +RA, −Wnt, −FGF, −Nodal, −Shh and −PCP) at the developmental timepoint when the phenotype first became apparent for a given embryo. The class Unknown was assigned when an image did not contain sufficient information for classification, and the class Dead was assigned if an embryo disintegrated over the course of development. In addition, each image was assigned a timestamp for classification (Fig. <xref rid="Fig1" ref-type="fig">1f</xref>). This high-confidence dataset was then used to train a large-scale CNN with accelerated graphics processing unit computing (<xref rid="Sec9" ref-type="sec">Methods</xref> and Supplementary Tables <xref rid="MOESM4" ref-type="media">2</xref> and <xref rid="MOESM4" ref-type="media">3</xref>).</p>
      <p id="Par9">To correct for potential classification errors, we introduced a model transition logic based on our knowledge of developmental changes: in very early embryos, phenotypic differences are not yet apparent because signaling changes result in morphological changes only at later stages<sup><xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref></sup>. These early embryos, characterized by the phenotype class Unknown, can then transition to another phenotype class (−BMP, +RA, −Wnt, −FGF, −Nodal, −Shh and −PCP) and can also change to Dead at any point in time (Extended Data Fig. <xref rid="Fig5" ref-type="fig">1c</xref>). However, certain transitions, for example, from Dead to Normal, are not possible. We therefore assigned a cost to every state transition in an individual embryo track and scored the cost for different models. The transition sequence that achieved the lowest cost was selected for classification. This approach yielded a classification performance of 89%. The deep learning-based classification network, termed EmbryoNet, was able to robustly identify the loss-of-function phenotypes caused by orthogonal approaches such as the injection of messenger RNAs (mRNAs) encoding the Nodal and BMP pathway inhibitors Lefty1 and Chordin, respectively (Fig. <xref rid="Fig1" ref-type="fig">1g–i</xref>, Supplementary Note <xref rid="MOESM1" ref-type="media">2</xref> and Extended Data Fig. <xref rid="Fig5" ref-type="fig">1f,g</xref>). EmbryoNet’s algorithms for the detection, tracking, manual and automatic classification of embryos are available as easy-to-use, modular and open-source graphical user interface (GUI) software (Extended Data Fig. <xref rid="Fig5" ref-type="fig">1e</xref>; <ext-link ext-link-type="uri" xlink:href="http://github.com/mueller-lab/EmbryoNet">http://github.com/mueller-lab/EmbryoNet</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://embryonet.uni-konstanz.de">http://embryonet.uni-konstanz.de</ext-link>).</p>
    </sec>
    <sec id="Sec4">
      <title>EmbryoNet is proficient, fast and accurate</title>
      <p id="Par10">To evaluate EmbryoNet’s performance, we tested its classification speed and accuracy in competition with human assessors. We generated stacks of 98 embryo images, representing the full spectrum of our phenotype classes. These images had not been used previously for the training of EmbryoNet, and information about the specific treatment of each embryo was not disclosed to the assessors.</p>
      <p id="Par11">Random guessing resulted in an accuracy of 9% (F-score = 0.09; Fig. <xref rid="Fig2" ref-type="fig">2a</xref> and Supplementary Table <xref rid="MOESM4" ref-type="media">4</xref>). The images were then classified by non-experts. These 55 teams, each consisting of two assessors with a biology background, received 1 day of developmental biology training with a focus on developmental defects caused by modulated signaling in zebrafish (Supplementary Videos <xref rid="MOESM5" ref-type="media">1</xref>–<xref rid="MOESM12" ref-type="media">8</xref>, Fig. <xref rid="Fig2" ref-type="fig">2b</xref> and Extended Data Figs. <xref rid="Fig6" ref-type="fig">2</xref> and <xref rid="Fig7" ref-type="fig">3</xref>). We encouraged the assessors to discuss the phenotypes to make the best classification choice. On average, non-experts confidently identified the class Dead but identified signaling defects with an overall accuracy of only 53% (F-score = 0.52; Fig. <xref rid="Fig2" ref-type="fig">2b</xref>, Extended Data Fig. <xref rid="Fig6" ref-type="fig">2</xref> and Supplementary Tables <xref rid="MOESM4" ref-type="media">5</xref> and <xref rid="MOESM4" ref-type="media">6</xref>), even when temporal information about the developmental stage was provided (accuracy of 54%, F-score = 0.52; Fig. <xref rid="Fig2" ref-type="fig">2c</xref>, Extended Data Fig. <xref rid="Fig7" ref-type="fig">3</xref> and Supplementary Tables <xref rid="MOESM4" ref-type="media">5</xref> and <xref rid="MOESM4" ref-type="media">7</xref>). The images were next classified by an expert assessor, an experienced developmental biologist with several years of relevant background in early zebrafish embryogenesis. The expert confidently identified embryonic phenotypes across classes with an overall accuracy of 79% (F-score = 0.78; Fig. <xref rid="Fig2" ref-type="fig">2d</xref> and Supplementary Tables <xref rid="MOESM4" ref-type="media">5</xref> and <xref rid="MOESM4" ref-type="media">8</xref>). Strikingly, EmbryoNet outperformed both expert and non-expert human assessors on these images: it completed the task in a few seconds and with an overall accuracy of 91% (F-score = 0.90; Fig. <xref rid="Fig2" ref-type="fig">2e</xref> and Supplementary Tables <xref rid="MOESM4" ref-type="media">5</xref> and <xref rid="MOESM4" ref-type="media">9</xref>), comparable to the performance across the entire validation dataset (see above).<fig id="Fig2"><label>Fig. 2</label><caption><title>Classification of 98 single embryo images by non-expert teams, experienced researchers and EmbryoNet.</title><p><bold>a</bold>–<bold>e</bold>, Schematic set-ups and confusion matrices showing the classification of the respective labeler compared with the ground truth (human annotation, treatment known). Classification performance is shown as a heatmap and fractions of 1 for the classification of 98 single images by a pseudo-random number generator (<bold>a</bold>), by a non-expert team without (<bold>b</bold>) or with (<bold>c</bold>) additionally provided time information (average performance), by an experienced researcher (<bold>d</bold>) and by EmbryoNet (<bold>e</bold>). <bold>f</bold>, Schematic of embryo detection over time. To allow for earlier detection, we annotated the training data 4 h before (blue time frame) the timepoint at which they could be robustly annotated by a labeler aware of the treatment (pink time frame). The embryo sketches show the phenotype of Nodal-inhibited samples at the respective time. The resulting network with earlier detection was termed ‘EmbryoNet-Prime’. <bold>g</bold>, Characteristic times of detection for each class based on the assessment of human experts, EmbryoNet and EmbryoNet-Prime. <italic>n</italic><sub>Normal</sub> = 74, <italic>n</italic><sub>−BMP</sub> = 119, <italic>n</italic><sub>+RA</sub> = 66, <italic>n</italic><sub>−Wnt</sub> = 70, <italic>n</italic><sub>−FGF</sub> = 74, <italic>n</italic><sub>−Nodal</sub> = 110, <italic>n</italic><sub>−Shh</sub> = 63, <italic>n</italic><sub>−PCP</sub> = 57. <bold>h</bold>–<bold>j</bold>, Classification performance in the early detection of phenotypes. Confusion matrices show the classification of image series by the respective labeler compared with the ground truth (human annotation, treatment known; detection time shifted to 4 h earlier). The number of analyzed images is shown in Supplementary Tables <xref rid="MOESM4" ref-type="media">20</xref>–<xref rid="MOESM4" ref-type="media">22</xref>.</p></caption><graphic xlink:href="41592_2023_1873_Fig2_HTML" id="d32e878"/></fig></p>
      <p id="Par12">To test whether context-dependent information could improve human classification performance, we asked two human experts to classify additional time-series experiments. Information about the specific treatment for each embryo was not disclosed to the assessors, but they were aware that all embryos in one video received the same treatment. Human classification performance slightly increased to an overall accuracy of 83% (F-score = 0.84). EmbryoNet still outperformed the human experts with an accuracy of 90% (F-score = 0.90), especially for the classification of the most difficult and subtle phenotypes (−Shh and −PCP) with F-scores of 0.54 (−PCP) and 0.72 (−Shh) compared with the human F-scores of 0.04 and 0.36, respectively (Extended Data Fig. <xref rid="Fig8" ref-type="fig">4a–d</xref> and Supplementary Tables <xref rid="MOESM4" ref-type="media">10</xref>–<xref rid="MOESM4" ref-type="media">15</xref>). In addition, EmbryoNet accurately identified phenotypes that were not fully penetrant, such as weaker BMP<sup><xref ref-type="bibr" rid="CR14">14</xref></sup> and Nodal defects<sup><xref ref-type="bibr" rid="CR46">46</xref></sup> (Extended Data Fig. <xref rid="Fig9" ref-type="fig">5</xref> and Supplementary Tables <xref rid="MOESM4" ref-type="media">16</xref>–<xref rid="MOESM4" ref-type="media">19</xref>).</p>
      <p id="Par13">Given EmbryoNet’s performance in identifying subtle phenotypes, we hypothesized that we could leverage artificial intelligence to detect very early embryonic defects before they would be recognized by human experts. We therefore retrained EmbryoNet by moving the relevant developmental timepoint corresponding to each treatment class to 4 hours earlier, before the phenotype was obvious to a human annotator (Fig. <xref rid="Fig2" ref-type="fig">2f</xref>). Strikingly, the resulting network, EmbryoNet-Prime, was able to identify Nodal loss-of-function phenotypes at the beginning of gastrulation, several hours before human annotators could confidently recognize them (Extended Data Fig. <xref rid="Fig10" ref-type="fig">6</xref>), with an accuracy of 90% (F-score = 0.93; Fig. <xref rid="Fig2" ref-type="fig">2h–j</xref>, Extended Data Fig. <xref rid="Fig8" ref-type="fig">4e</xref> and Supplementary Tables <xref rid="MOESM4" ref-type="media">10</xref> and <xref rid="MOESM4" ref-type="media">20</xref>–<xref rid="MOESM4" ref-type="media">24</xref>). Similarly, the network detected the −BMP, +RA, −Wnt, −Shh and −PCP phenotypes on average 2–3 hours earlier (Fig. <xref rid="Fig2" ref-type="fig">2g</xref> and Extended Data Fig. <xref rid="Fig10" ref-type="fig">6</xref>), consistent with the known expression and activation profiles of the signaling molecules (Supplementary Note <xref rid="MOESM1" ref-type="media">1</xref>).</p>
    </sec>
    <sec id="Sec5">
      <title>EmbryoNet recognizes known and latent defect features</title>
      <p id="Par14">What could be the features that are detected by EmbryoNet-Prime, which facilitate earlier classification compared with human assessors? To address this question, we leveraged class activation map (CAM) visualization<sup><xref ref-type="bibr" rid="CR47">47</xref></sup>, which can be used to perform object localization without additional annotation by projecting the probability of the trained classes onto an input image. The resulting CAM should show the discriminative image regions used by the CNN to identify a class: positively activated domains should highlight image regions that support a particular class, whereas negative domains should show regions that oppose that class (Fig. <xref rid="Fig3" ref-type="fig">3</xref> and Supplementary Note <xref rid="MOESM1" ref-type="media">3</xref>).<fig id="Fig3"><label>Fig. 3</label><caption><title>Embryo features activating the neural network.</title><p>Class activation heatmaps based on the last convolutional layer of EmbryoNet-Prime showing the part of the image that activates the network at the given timepoint for normal (<bold>a</bold>) and signaling-defective embryos (<bold>b</bold>–<bold>h</bold>). Every signaling-defective embryo (−BMP (<bold>b</bold>), +RA (<bold>c</bold>), −Wnt (<bold>d</bold>), −FGF (<bold>e</bold>), −Nodal (<bold>f</bold>), −Shh (<bold>g</bold>), −PCP (<bold>h</bold>)) is displayed in all classification channels, but only the classification channels corresponding to the correct signaling manipulation show warm colors. The percentages represent the probability of detection. See Supplementary Note <xref rid="MOESM1" ref-type="media">3</xref> for sample sizes. Also see Supplementary Videos <xref rid="MOESM13" ref-type="media">9</xref>–<xref rid="MOESM28" ref-type="media">24</xref>. <bold>i</bold>–<bold>k</bold>, Selected embryos showing defects highlighted by the corresponding class activation heatmaps for −Wnt at 13.4 h.p.f. (<bold>i</bold>) and −Nodal at 10.6 h.p.f. (<bold>j</bold>) and 26 h.p.f. (<bold>k</bold>). Scale bars, 500 µm.</p></caption><graphic xlink:href="41592_2023_1873_Fig3_HTML" id="d32e1023"/></fig></p>
      <p id="Par15">To evaluate the utility of CAM visualization, we first examined steep and sudden switches in classification. For example, BMP-inhibited embryos frequently disintegrate (Supplementary Video <xref rid="MOESM6" ref-type="media">2</xref>), switching from −BMP to Dead in terms of classification. Indeed, this classification switch can be observed in EmbryoNet-Prime’s CAMs. Once −BMP embryos disintegrate, their CAMs in the −BMP channel immediately show negative activation accompanied by a positive activation in the CAMs for the Dead class (Supplementary Videos <xref rid="MOESM15" ref-type="media">11</xref> and <xref rid="MOESM16" ref-type="media">12</xref>). These results indicate that CAM visualization can provide insight into the logic of phenotype classification.</p>
      <p id="Par16">Using this approach, we found that EmbryoNet-Prime identified known defects caused by the disruption of signaling pathways, but also detected latent features at an earlier developmental stage compared with human assessors. For example, Wnt mutants are known to exhibit prominent tail bud and head defects at 24 h.p.f.<sup><xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR12">12</xref></sup>. EmbryoNet-Prime was indeed activated in these regions at late stages (Fig. <xref rid="Fig3" ref-type="fig">3i</xref>). Strikingly, during early segmentation the whole body-axis already showed activation (Supplementary Videos <xref rid="MOESM19" ref-type="media">15</xref> and <xref rid="MOESM20" ref-type="media">16</xref>), and the detection of head and tail defects also occurred as early as the bud stage (Fig. <xref rid="Fig3" ref-type="fig">3d</xref>, Extended Data Fig. <xref rid="Fig10" ref-type="fig">6</xref> and Supplementary Videos <xref rid="MOESM19" ref-type="media">15</xref> and <xref rid="MOESM20" ref-type="media">16</xref>). Thus, −Wnt embryos were detected earlier by EmbryoNet-Prime than by human assessors (Fig. <xref rid="Fig2" ref-type="fig">2g</xref> and Extended Data Fig. <xref rid="Fig10" ref-type="fig">6</xref>). Similarly, late-stage classification of −Nodal embryos by EmbryoNet-Prime relied on well-known defects in the ectodermal thickening (Fig. <xref rid="Fig3" ref-type="fig">3j</xref>), head, tail and trunk regions (Fig. <xref rid="Fig3" ref-type="fig">3k</xref>). Surprisingly, however, EmbryoNet-Prime was also able to classify early-stage −Nodal embryos (~6 h.p.f.; Supplementary Video <xref rid="MOESM23" ref-type="media">19</xref>) based on latent defects. The detection started with activation at the margin (Fig. <xref rid="Fig3" ref-type="fig">3f</xref> and Supplementary Videos <xref rid="MOESM23" ref-type="media">19</xref> and <xref rid="MOESM24" ref-type="media">20</xref>) and continued with activation spots at the border between yolk and blastoderm, directly adjacent to the embryo proper. Although this fits well with known regions of Nodal expression and activity<sup><xref ref-type="bibr" rid="CR37">37</xref>,<xref ref-type="bibr" rid="CR48">48</xref>,<xref ref-type="bibr" rid="CR49">49</xref></sup>, it will be interesting to determine how these molecular signatures manifest in latent cellular and morphological features.</p>
    </sec>
    <sec id="Sec6">
      <title>EmbryoNet can identify novel signaling modulators</title>
      <p id="Par17">High-content image-based drug screens can be used to identify novel compounds affecting cellular phenotypes. However, large-scale drug screens assessing whole phenomes with rich biological information<sup><xref ref-type="bibr" rid="CR50">50</xref></sup> are currently hampered by the need to visually assess a very large number of images, and are further complicated by the potential ambiguity of defects and variability between assessors. To determine whether EmbryoNet could be used to link chemical manipulations to signaling-based phenotypic defects, we performed a large-scale zebrafish screen using FDA-approved and bioactive compounds (Fig. <xref rid="Fig4" ref-type="fig">4a</xref>).<fig id="Fig4"><label>Fig. 4</label><caption><title>Applications of EmbryoNet in drug screening and other species.</title><p><bold>a</bold>,<bold>b</bold>, Automated phenotype-based drug screening. <bold>a</bold>, Schematic of the phenomic drug screen. Embryos were exposed to compounds in 96-well plates and imaged for 24 h. Phenotypes were classified automatically by EmbryoNet. <bold>b</bold>, Layout of BML-2843 library plate 2 with majority phenotype classification for each well. Simvastatin in well H-02 was classified as −FGF. <bold>c</bold>, Statins identified by EmbryoNet in the drug screen caused body axis defects similar to −FGF loss-of-function phenotypes. <bold>d</bold>, Representative immunofluorescence images of the FGF signaling transducer pErk in untreated and statin-treated embryos, respectively. The representative images have pErk profiles that are closest to the mean signaling profile of each group. Images are shown at the same contrast and brightness. The inserted lower panels show cell nuclei labeled with DRAQ7. <bold>e</bold>, Quantification of background-subtracted pErk fluorescence intensity gradients in wild-type (black), simvastatin-treated (blue), atorvastatin-treated (yellow) and lovastatin-treated (green) embryos along the marginal-to-animal pole axis. The error envelopes show s.e.m. <bold>f</bold>,<bold>g</bold>, Extension of EmbryoNet to other species. <bold>f</bold>, Images of wild-type (left) and Nodal-deficient (right) medaka embryos with the confusion matrix of classification performance. <bold>g</bold>, Images of wild-type (left) and Nodal-deficient (right) three-spined stickleback embryos with the confusion matrix of classification performance. Black arrows point to somites in healthy embryos, while red arrows point out missing somites. The red arrowhead shows a mispatterned central nervous system. Scale bars: 500 µm (<bold>c</bold>,<bold>f</bold>,<bold>g</bold>) and 200 µm (<bold>d</bold>).</p></caption><graphic xlink:href="41592_2023_1873_Fig4_HTML" id="d32e1169"/></fig></p>
      <p id="Par18">We screened approximately 1,000 compounds using 96-well plates containing four to five zebrafish embryos per well. The screen spanned 2–26 h.p.f. We first tested well-known viability modulators with characterized mechanisms of action such as aphidicolin, bafilomycin A1, blebbistatin, brefeldin A, cycloheximide, cytochalasin B, latrunculin B, staurosporin, trichostatin A, tunicamycin and vinblastine. EmbryoNet reliably classified embryos treated with these substances as Dead, while classifying mock-treated embryos as Normal (Supplementary Tables <xref rid="MOESM4" ref-type="media">25</xref>–<xref rid="MOESM4" ref-type="media">35</xref>, Extended Data Figs. <xref rid="Fig11" ref-type="fig">7</xref> and <xref rid="Fig12" ref-type="fig">8</xref> and Supplementary Videos <xref rid="MOESM29" ref-type="media">25</xref>–<xref rid="MOESM39" ref-type="media">35</xref>). EmbryoNet also correctly detected known modulators of signaling pathways, such as the RA agonists all-trans-retinoic acid and TTNPB (Extended Data Fig. <xref rid="Fig11" ref-type="fig">7</xref> and Supplementary Table <xref rid="MOESM4" ref-type="media">26</xref>).</p>
      <p id="Par19">Importantly, for some small molecules we identified previously unrecognized effects on signaling pathways in embryos. This group includes several hydroxymethylglutaryl-coenzyme A reductase inhibitors, a class of compounds also known as statins<sup><xref ref-type="bibr" rid="CR51">51</xref>–<xref ref-type="bibr" rid="CR54">54</xref></sup>. Interestingly, embryos treated with several statins, including simvastatin, atorvastatin and lovastatin, were classified as −FGF by EmbryoNet (Fig. <xref rid="Fig4" ref-type="fig">4b</xref>, Supplementary Videos <xref rid="MOESM40" ref-type="media">36</xref>–<xref rid="MOESM42" ref-type="media">38</xref> and Supplementary Tables <xref rid="MOESM4" ref-type="media">29</xref>, <xref rid="MOESM4" ref-type="media">32</xref> and <xref rid="MOESM4" ref-type="media">35</xref>). Consistent with the −FGF classification, embryos treated with these drugs showed defects in dorsal–ventral patterning<sup><xref ref-type="bibr" rid="CR51">51</xref>,<xref ref-type="bibr" rid="CR52">52</xref></sup> and had loss of posterior tissues typical of −FGF embryos<sup><xref ref-type="bibr" rid="CR13">13</xref>,<xref ref-type="bibr" rid="CR55">55</xref>–<xref ref-type="bibr" rid="CR57">57</xref></sup> (Fig. <xref rid="Fig4" ref-type="fig">4c</xref>). Strikingly, the activity of the FGF signal transducer pErk was also reduced in statin-treated compared with untreated embryos (Fig. <xref rid="Fig4" ref-type="fig">4d,e</xref>), possibly due to dampened isoprenylation of the upstream small GTPase Ras<sup><xref ref-type="bibr" rid="CR58">58</xref></sup>. According to patient information regarding side-effects and databases of potentially embryotoxic teratogenic therapeutics, the intake of selected hydroxymethylglutaryl-coenzyme A reductase inhibitors such as lovastatin is not recommended during pregnancy and lactation (Supplementary Note <xref rid="MOESM1" ref-type="media">4</xref>). Notably, simvastatin is recommended as a substitute, although EmbryoNet detected the same defects in response to this drug. However, the bioavailability in zebrafish compared with human cells is currently unclear.</p>
      <p id="Par20">In summary, our drug screen shows that EmbryoNet can be used to identify teratogenic effects caused by bioactive compounds and to associate them with signaling pathways.</p>
    </sec>
    <sec id="Sec7">
      <title>Generalization of EmbryoNet to other species</title>
      <p id="Par21">To test the generalizability of our approach, we next applied EmbryoNet to identify signaling defects in the evolutionarily distant species medaka (<italic>Oryzias latipes</italic>) and three-spined stickleback (<italic>Gasterosteus aculeatus</italic>). These fish diverged from zebrafish hundreds of millions of years ago<sup><xref ref-type="bibr" rid="CR59">59</xref>,<xref ref-type="bibr" rid="CR60">60</xref></sup>. We adjusted the imaging length of our recordings to match the slower developmental speed of both species<sup><xref ref-type="bibr" rid="CR61">61</xref>,<xref ref-type="bibr" rid="CR62">62</xref></sup> and modified species-specific parameters such as temperature, number of embryos per well and drug concentration as needed.</p>
      <p id="Par22">We found that in both medaka and stickleback, wild-type animals had well-formed somites (Fig. <xref rid="Fig4" ref-type="fig">4f,g</xref>, black arrows) and eyes (Supplementary Videos <xref rid="MOESM43" ref-type="media">39</xref> and <xref rid="MOESM45" ref-type="media">41</xref>), while Nodal-inhibited embryos showed a loss of somites (Fig. <xref rid="Fig4" ref-type="fig">4f,g</xref>, red arrows) concomitant with severe central nervous system defects and frequent cyclopia (Fig. <xref rid="Fig4" ref-type="fig">4f</xref>, red arrowhead; Supplementary Videos <xref rid="MOESM44" ref-type="media">40</xref> and <xref rid="MOESM46" ref-type="media">42</xref>). After training with these datasets, EmbryoNet robustly identified wild-type and Nodal-inhibited individuals in both species (Fig. <xref rid="Fig4" ref-type="fig">4f,g</xref>). These results support the broad applicability of EmbryoNet in identifying signaling-based complex phenotypic defects in different species.</p>
    </sec>
  </sec>
  <sec id="Sec8" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par23">Phenome refers to the entire set of phenotypes of an organism over time, and phenomics has emerged as a promising approach for connecting these phenotypes with the underlying genotypes and environmental influences<sup><xref ref-type="bibr" rid="CR50">50</xref></sup>. A quantitative understanding of how the phenome changes in response to genetic mutations and environmental stimuli would be highly informative, but phenomics requires the processing of large amounts of high-dimensional data<sup><xref ref-type="bibr" rid="CR36">36</xref>,<xref ref-type="bibr" rid="CR63">63</xref>–<xref ref-type="bibr" rid="CR66">66</xref></sup>. Computer vision and machine learning techniques are therefore promising approaches for advancing this field and indeed are increasingly being applied in plant and crop phenomics<sup><xref ref-type="bibr" rid="CR67">67</xref></sup>. Here, we present a machine learning-assisted method for the robust phenomic analysis of developmental defects during vertebrate embryogenesis.</p>
    <p id="Par24">The automated phenotyping tool that we developed, EmbryoNet, is based on CNNs. Strikingly, EmbryoNet outcompeted human assessors in terms of speed, accuracy and sensitivity. Assessing zebrafish embryos, EmbryoNet was able to quickly and accurately link phenotypes to major signaling pathways, including classifying incompletely penetrant phenotypes. We were also able to retrain EmbryoNet for assessing other fish species separated from zebrafish by hundreds of millions of years in evolution, enabling the analysis of high-dimensional phenomic data in different taxa. EmbryoNet may thus be able to accelerate the characterization of developmental mutants in multiple species. Finally, in a proof-of-concept drug screen with two drug libraries, we showed that EmbryoNet correctly associated compounds with signaling functions. We therefore believe that this approach can be used to understand the signaling effects of various compounds and medications, thus opening up the possibility of applying drugs to new therapeutic contexts and applications.</p>
    <p id="Par25">While EmbryoNet offers significant advantages in identifying phenotypes at earlier developmental stages, there are some caveats and weaknesses to consider. It remains uncertain whether EmbryoNet can outperform humans in detecting very mild phenotypes, such as those caused by low drug concentrations. Additionally, its reliance on a library of manual annotations limits its ability to classify novel phenotypes, particularly those arising from the combinatorial disruption of signaling pathways. The rapid development of deep learning technologies could be leveraged to enhance EmbryoNet’s capabilities and help address EmbryoNet’s current limitations. By building on these technological breakthroughs, it may become possible in the future to bridge the genotype–phenotype gap and tackle the long-standing question of how diverse body plans are genetically encoded<sup><xref ref-type="bibr" rid="CR68">68</xref></sup>.</p>
    <p id="Par26">We provide EmbryoNet as open-source software, with Python packages, a GitHub repository and GUIs for labeling data and phenotype classification (<ext-link ext-link-type="uri" xlink:href="http://github.com/mueller-lab/EmbryoNet">http://github.com/mueller-lab/EmbryoNet</ext-link>). We also provide the training, testing and the drug screen imaging data as a resource to the community (<ext-link ext-link-type="uri" xlink:href="http://embryonet.uni-konstanz.de">http://embryonet.uni-konstanz.de</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://github.com/mueller-lab/EmbryoNet">http://github.com/mueller-lab/EmbryoNet</ext-link>). Due to its modular open-source nature, EmbryoNet can be easily adapted to a variety of purposes, including embryos of other species and organoids, in which automated phenotyping will expedite biological and pharmaceutical discovery.</p>
  </sec>
  <sec id="Sec9">
    <title>Methods</title>
    <sec id="Sec10">
      <title>Embryo preparation</title>
      <p id="Par27">The experiments were performed exclusively with embryos and larvae that were not yet freely feeding. All procedures and zebrafish, medaka and stickleback husbandry were carried out in accordance with the guidelines of the European Union directive 2010/63/EU and the German Animal Welfare Act as approved by the local authorities represented by the Regierungspräsidium Tübingen and the Regierungspräsidium Freiburg (Baden-Württemberg, Germany).</p>
      <p id="Par28">Zebrafish embryos of the TE strain were collected from batch crosses within 1 h after fertilization. Fertilized embryos were manually selected using a glass Pasteur pipette. At this timepoint, zebrafish embryos were between the 2- and 8-cell stages. A total of 10–20 embryos were pipetted into each well of a 24- or 48-well plate in 1 ml zebrafish embryo medium<sup><xref ref-type="bibr" rid="CR48">48</xref></sup>. Small-molecule signaling pathway agonists and antagonists were added by pipetting them into the filled well with the final concentrations listed in Supplementary Table <xref rid="MOESM4" ref-type="media">1</xref>. To obtain PCP phenotypes, 1 ng <italic>vangl2</italic>-targeting morpholino<sup><xref ref-type="bibr" rid="CR69">69</xref></sup> was injected at the one-cell stage. Shh treatment was carried out either by cyclopamine incubation or <italic>gli3R-GFP</italic> mRNA injection. For overexpression of signaling antagonists, 10 pg <italic>lefty1</italic> mRNA<sup><xref ref-type="bibr" rid="CR48">48</xref></sup> together with 0.1 ng of 10 kDa Alexa647-coupled dextran (Invitrogen <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/nuccore/D22914">D22914</ext-link>) or 75 pg <italic>chordin</italic> mRNA<sup><xref ref-type="bibr" rid="CR70">70</xref></sup> together with 0.1 ng of 10 kDa Alexa488-coupled dextran (Invitrogen <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/nuccore/D22910">D22910</ext-link>) were injected into one-cell stage wild-type zebrafish embryos. To validate phenotypes, <italic>swirl</italic> homozygous mutants<sup><xref ref-type="bibr" rid="CR70">70</xref></sup> and maternal zygotic homozygous <italic>oep</italic> mutants<sup><xref ref-type="bibr" rid="CR41">41</xref></sup> were used. All zebrafish embryos were between 0 h.p.f. and 48 h.p.f.</p>
      <p id="Par29">Medaka eggs of the Cab strain were collected from standard crosses and separated with forceps. They were incubated at 28 °C in medaka embryo medium (17 mM NaCl, 0.4 mM KCl, 0.27 mM CaCl<sub>2</sub>, 0.65 mM MgSO<sub>4</sub>) and distributed into 24-well plates. Small-molecule signaling pathway antagonists were added at the early blastula stage to a concentration of 7.5 µM. Embryos were imaged from 8 h.p.f. until 45 h.p.f. with intervals of 5 min at 28 °C. Approximately 500 Medaka embryos between 0 h.p.f. and 48 h.p.f. were used for training and testing.</p>
      <p id="Par30">Stickleback embryos of wild-derived marine strains from Little Campbell River (Canada) and Tyne River (Scotland) were obtained by in vitro fertilization and incubated until 20 h.p.f. at 16 °C in stickleback embryo medium (3.5 g l<sup>−1</sup> instant ocean salt in reverse osmosis water). The eggs were separated using brushes and distributed into 48-well dishes. The small-molecule signaling pathway antagonists were applied at a concentration of 15 µM, and embryos were imaged for 120 h with intervals of 5 min at 15–18 °C. Approximately 200 stickleback embryos between 0 h.p.f. and 140 h.p.f. were used.</p>
    </sec>
    <sec id="Sec11">
      <title>Image acquisition</title>
      <p id="Par31">Images were acquired using an ACQUIFER Imaging Machine (DITABIS AG) with a white light-emitting diode (LED) for bright-field imaging and a scientific complementary metal oxide semiconductor 2,048 × 2,048 camera (Hamamatsu sCMOS 2k × 2k) in a single plane with a ×2 Plan UW numerical aperture 0.06 objective (Nikon) using the Imaging Machine software (v4.00.21). The integration time was fixed at a 110 ms exposure time and 100% relative LED intensity in the bright-field channel. Imaging was performed at 28 °C with 720 iterations at intervals of 120 s. Images were stored as 12-bit TIFF files at a size of 2,048 × 2,048 pixels and 0.31 pixels μm<sup>−1</sup> and converted to JPEG or PNG files for further phenotype analyses.</p>
      <p id="Par32">To generalize the method independently of the microscope, a Keyence BZ-X810 microscope equipped with a ×2 apochromat objective, a 3.7 W LED lightsource and the BZ-X800 viewer software (Keyence, v01.03.00.01) was also used to acquire embryo images (Supplementary Tables <xref rid="MOESM4" ref-type="media">2</xref>, <xref rid="MOESM4" ref-type="media">14</xref>, <xref rid="MOESM4" ref-type="media">15</xref>, <xref rid="MOESM4" ref-type="media">23</xref> and <xref rid="MOESM4" ref-type="media">24</xref> and Extended Data Fig. <xref rid="Fig8" ref-type="fig">4d,e</xref>). The exposure time was 0.1 ms with 50% relative intensity. The images were stored as 8-bit JPEG files at a size of 1,920 × 1,440 pixels.</p>
      <p id="Par33">Medaka and stickleback eggs contain large lipid droplets and, compared to zebrafish, have a larger yolk in relation to the embryo proper. Additionally, medaka eggs are surrounded by adhesive filaments. Given that these features are visually very prominent, the embryos were required to be imaged until the late segmentation stages to robustly detect morphological differences.</p>
    </sec>
    <sec id="Sec12">
      <title>Embryo detection</title>
      <p id="Par34">A dataset of manually annotated embryos was generated using the GUI FishLabeler (<ext-link ext-link-type="uri" xlink:href="http://github.com/mueller-lab/EmbryoNet">http://github.com/mueller-lab/EmbryoNet</ext-link>). The dataset was split into two subsets: 90% of the images were used for training and 10% for validation. Additionally, an independent manually annotated dataset was generated for testing.</p>
      <p id="Par35">Individual embryos were automatically detected at each image frame of the acquired movies using a standard object-detection algorithm based on the Hough transform<sup><xref ref-type="bibr" rid="CR71">71</xref></sup>. The location of individual embryos was computationally determined using bounding boxes. The range of embryo radii in pixels was provided according to the microscope acquisition parameters for each experiment independently. As output, a set of JSON files containing the information about the bounding boxes of individual embryos was generated. The Hough transform-based embryo detector can be replaced by other object recognition methods (such as watershed segmentation) to detect non-spherical species (for example, <italic>Drosophila melanogaster</italic>).</p>
    </sec>
    <sec id="Sec13">
      <title>Embryo tracking</title>
      <p id="Par36">To obtain information about the whole developmental path of each individual, the embryos identified at individual frames were grouped using an object-tracking approach. Detections of the same embryo in consecutive frames were confirmed using the DeepSort algorithm without re-identification<sup><xref ref-type="bibr" rid="CR72">72</xref></sup>.</p>
    </sec>
    <sec id="Sec14">
      <title>Manual labeling of training datasets</title>
      <p id="Par37">All embryos were initially set as class Unknown. Then, each embryo track was manually annotated with its specific phenotypic class (that is, Normal = Wild type, −BMP, +RA, −Wnt, −FGF, −Nodal, −Shh, −PCP) from the timepoint when the phenotype could be observed by an experienced annotator. Additionally, embryos that disintegrated were labeled as Dead. Embryos that were only partially in the image or that showed an unspecific phenotype were annotated as Cut and were excluded from the training, validation and test datasets. Additionally, the −BMP and −Nodal classes were subclassified into severity levels: weak, ~30% phenotype severity; intermediate, ~60% phenotype severity; and severe, ~100% phenotype severity. For Nodal phenotypes, the percentage bins were determined by the concentration of the inhibitor, with 100% corresponding to the minimum concentration that led to full penetrance. The drug concentration was then directly used as a binned fraction of the fully penetrant dose as ground truth for the severity bins, accepting a certain spread of phenotypes. Binning of BMP severity levels was done based on previous classification schemes<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>, with the class C3 corresponding to 30%, C4 to 60%, and C5 to 100% severity. Altogether 14 classes were obtained for the classification process. The annotator had previous knowledge about the treatment of the respective embryo, and the expertise to recognize all of the phenotypes.</p>
      <p id="Par38">To train EmbryoNet-Prime for an earlier detection, the original manual annotations were used to determine the timepoint when the majority of the embryos were classified correctly. The appropriate class was then assigned 120 frames (4 h) earlier, when the phenotype could not be identified by eye. Cut and Dead embryos were not changed.</p>
    </sec>
    <sec id="Sec15">
      <title>Model training and embryo classification</title>
      <p id="Par39">The use of embryo images as the only input could lead to misclassifications between embryo phenotypes, which have a similar appearance at different developmental stages. To increase classification performance, the developmental timepoint was added as a second input to the classification algorithm. In total, four channels were used as input for model training. The first three channels correspond to a standard RGB image, and the remaining one is a ‘timestamp’ channel representing the time that has passed from the beginning of the experiment. The size of the images was 224 × 224 pixels. The timestamp was linearly mapped from the real developmental time to the domain [0, 1], where 0 corresponds to ~2 h.p.f. and 1 to ~26 h.p.f. Given that the input classes were imbalanced (Supplementary Table <xref rid="MOESM4" ref-type="media">2</xref>), the overrepresented class Unknown was undersampled and the 13 remaining classes replicated<sup><xref ref-type="bibr" rid="CR73">73</xref></sup>.</p>
      <p id="Par40">For the classification task, a modified version of the widely used ResNet18<sup><xref ref-type="bibr" rid="CR40">40</xref></sup> architecture was selected. The network architecture was chosen due to its easy and fast convergence in image classification tasks. The ResNet18 model was modified by using a time channel as additional input and thus feeding four instead of three channels, and by replacing the last classification layer with the current classification layer. Time was also used as input to the last fully connected layer. The parameters of the neural network weights, unlike the neural network architecture (that is, the mathematical function structure describing an artificial neural network), were changed during the training procedure via a back-propagation algorithm.</p>
      <p id="Par41">The CNN model was trained using the supervised back-propagation training method<sup><xref ref-type="bibr" rid="CR74">74</xref></sup>, a common algorithm for training neural networks. The Adam optimizer was used, which is a back propagation-based optimization algorithm that determines the value change of neural network weights based on the loss function gradient. Softmax cross-entropy was used as the loss function (that is, the penalty for a poor prediction, indicating how bad the model’s prediction was on a single example):<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L = - 1/n{\sum} {ln\;p_i}$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>n</mml:mi><mml:mo mathsize="big">∑</mml:mo><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mspace width="0.16em"/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><graphic xlink:href="41592_2023_1873_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>where <italic>p</italic><sub><italic>i</italic></sub> is the index of the correct probability of the <italic>i</italic>-th image, and <italic>n</italic> is the number of images in the batch. In the case in which the model’s prediction is perfect, the loss would be zero; otherwise, the loss is greater. Cross-entropy loss is a common loss function used in machine learning and it measures the expected negative logarithm’s value for the correct classification probability.</p>
      <p id="Par42">The Albumentations library<sup><xref ref-type="bibr" rid="CR75">75</xref></sup> was used to increase the amount of training images by adding slightly modified copies of the existing images. Augmentations were applied during the training process, including random horizontal and vertical flips, rotations in the range of 1–90° with steps of 1°, crops and salt-and-pepper noise (Supplementary Table <xref rid="MOESM4" ref-type="media">3</xref>). During the training process a random augmentation from each group was picked and applied to the input image.</p>
      <p id="Par43">Given that the selected CNN model did not converge when all datasets and augmentations were used from the beginning of the training, a progressive training design involving different levels of difficulty was developed. In brief, the training was performed sequentially by dividing it into several steps with progressive addition of data and augmentations. At each step extra data were added as input and new augmentations applied at each epoch, that is, at each pass over the entire training dataset during the training procedure. The initial learning rate was set to 10<sup>−3</sup> and it decayed by a factor of 0.1 after each epoch. The learning rate, that is, the parameter by which the loss gradient value is multiplied during each iteration, was restored to the value of 10<sup>−3</sup> at the beginning of each iteration. The model was trained using eight steps with 10–20 epochs per step, resulting in a total of 152 epochs. For the whole training, a batch size (that is, the number of training examples used in one iteration) of <italic>n</italic> = 350 was used, and the training was performed on an NVIDIA RTX 3090 card in Ubuntu 20.04.4 LTS.</p>
      <p id="Par44">Rotation- and mirror-invariance of the embryo appearance was exploited to boost the classification performance by running the trained network for each detected embryo eight times: once with the original embryo image, once with the image flipped horizontally, then flipped vertically, then mirrored diagonally, and then with each of these samples rotated by 90°. Following this step, the classification probabilities were averaged. Each embryo was assigned to the class that had the maximum probability.</p>
    </sec>
    <sec id="Sec16">
      <title>Model transition logic</title>
      <p id="Par45">To further improve the results of the classification, the information from embryo tracking as well as previous knowledge about transitions between phenotypes was incorporated into the classification task. In brief, first the classification results of the CNN for each embryo track were collected and transitions between classes identified. The only biologically possible transitions in an embryo track were set as follows: from Unknown to a phenotype class, from a phenotype class to Dead, or from Unknown to Dead. Any other transition in an embryo track was penalized in the model prediction. The quality of the whole track model prediction was evaluated by computing the number of frames between transition points with the class expected by the model being analyzed. The transition sequence that achieved the least cost was considered to be the correct one. The outliers were then ignored in the track history. Nodal and BMP severity classifications were similarly corrected by selecting the severity class that was most frequently observed over the timecourse.</p>
      <p id="Par46">For medaka, a semi-supervised training method was used by assigning a classification transition point from which the phenotypes were easy to distinguish for a human and automatically applying this to all training data. Given that medaka embryos disintegrated if they were treated with Nodal inhibitor before the blastula stages, the medaka experiments did not start at cleavage but at blastula stages. This opportunity was used to set the transition point to timepoint 1, such that the Unknown class did not have to be used at all. This did not reduce the training or classification efficiency (Fig. <xref rid="Fig4" ref-type="fig">4f</xref>), showing that an Unknown state for early stages is not unconditionally required.</p>
    </sec>
    <sec id="Sec17">
      <title>Evaluation of classification efficiency</title>
      <p id="Par47">For the performance measure of classification, subset accuracy was computed. Subset accuracy is the fraction of images <italic>n</italic> that were classified correctly:<disp-formula id="Equb"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{\mathrm{Accuracy}}}} = \frac{1}{n}\mathop {\sum }\limits_{i = 1}^n I\left( {{\check{y}_i} = y_i} \right)$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi mathvariant="normal">Accuracy</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mi>I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="41592_2023_1873_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par48">F-scores were calculated as<disp-formula id="Equc"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{\mathrm{F-score = 2}}}} \times \frac{{{{{\mathrm{Precision}}}} \times {{{\mathrm{Recall}}}}}}{{{{{\mathrm{Precision + Recall}}}}}}$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mi mathvariant="normal">F - score = 2</mml:mi><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Precision</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="normal">Recall</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Precision + Recall</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="41592_2023_1873_Article_Equc.gif" position="anchor"/></alternatives></disp-formula>with<disp-formula id="Equd"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{rcl}{\mathrm{precision}} &amp; = &amp; \frac{{{\mathrm{true}}\;{\mathrm{positives}}}}{{{\mathrm{true}}\;{\mathrm{positives}} + {\mathrm{false}}\;{\mathrm{positives}}}}\,{\mathrm{and}}\\ {\mathrm{recall}} &amp; = &amp; \frac{{{\mathrm{true}}\;{\mathrm{positives}}}}{{{\mathrm{true}}\;{\mathrm{positives + false}}\;{\mathrm{negatives}}}}\end{array}$$\end{document}</tex-math><mml:math id="M8"><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mi mathvariant="normal">precision</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">true</mml:mi><mml:mspace width="0.16em"/><mml:mi mathvariant="normal">positives</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">true</mml:mi><mml:mspace width="0.16em"/><mml:mi mathvariant="normal">positives</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">false</mml:mi><mml:mspace width="0.16em"/><mml:mi mathvariant="normal">positives</mml:mi></mml:mrow></mml:mfrac><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">and</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mi mathvariant="normal">recall</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">true</mml:mi><mml:mspace width="0.16em"/><mml:mi mathvariant="normal">positives</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">true</mml:mi><mml:mspace width="0.16em"/><mml:mi mathvariant="normal">positives+false</mml:mi><mml:mspace width="0.16em"/><mml:mi mathvariant="normal">negatives</mml:mi></mml:mrow></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41592_2023_1873_Article_Equd.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par49">In the confusion matrices, the class Unknown was not taken into account. The numerical data for the confusion matrices including the class Unknown are provided in Supplementary Tables <xref rid="MOESM4" ref-type="media">4</xref>, <xref rid="MOESM4" ref-type="media">9</xref>, <xref rid="MOESM4" ref-type="media">11</xref>–<xref rid="MOESM4" ref-type="media">15</xref> and <xref rid="MOESM4" ref-type="media">17</xref>–<xref rid="MOESM4" ref-type="media">24</xref>, and this class was also included in the overall metrics of accuracy and F-score.</p>
      <p id="Par50">The evaluation dataset for Fig. <xref rid="Fig2" ref-type="fig">2a–e</xref> was generated by compiling three stacks of 98 images each selected from the full test dataset (Fig. <xref rid="Fig2" ref-type="fig">2h–j</xref> and Extended Data Fig. <xref rid="Fig8" ref-type="fig">4</xref>). To evaluate the performance of random guessing, the function randi from MATLAB R2022a was used for the generation of a pseudo-random scalar integer between 1 and <italic>n</italic><sub><italic>c</italic></sub>, where <italic>n</italic><sub><italic>c</italic></sub> is the number of classes. The image stacks were then labeled with the classes corresponding to the pseudo-random numbers and evaluated for performance by calculating accuracy and F-score. The non-expert teams received one randomly selected image stack for their assessment task. The experienced developmental biologist assessed all three image stacks, and average performance is shown in Fig. <xref rid="Fig2" ref-type="fig">2d</xref>.</p>
    </sec>
    <sec id="Sec18">
      <title>CAMs</title>
      <p id="Par51">To visualize the regions of images that influenced the model to make classification decisions, CAMs were used. To visualize the CAMs generated by EmbryoNet, the weights of the final output layer in a fully connected layer were projected using global max pooling, as previously proposed<sup><xref ref-type="bibr" rid="CR47">47</xref></sup>. This approach enabled the visualization of regions positively or negatively activated for a particular class. CAMs were calculated for all classes, and their values were normalized so that the minimum and maximum values for all classes correspond to −1 and +1, respectively. To improve the visualization of areas with large positive or negative values (that is, relevant regions for the decision), the CAMs were remapped using the following function:<disp-formula id="Eque"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde V_{{\mathrm{CAM}}} = {{{\mathrm{sgn}}}}(V_{{\mathrm{CAM}}}) \times \sqrt {V_{{\mathrm{CAM}}}}$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>~</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">CAM</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">sgn</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">CAM</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">CAM</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:math><graphic xlink:href="41592_2023_1873_Article_Eque.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq1"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{{\mathrm{CAM}}}$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">CAM</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41592_2023_1873_Article_IEq1.gif"/></alternatives></inline-formula> are the normalized values of the CAMs, <inline-formula id="IEq2"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{\mathrm{sgn}}}}\left( \cdot \right)$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mi mathvariant="normal">sgn</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mo>⋅</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="41592_2023_1873_Article_IEq2.gif"/></alternatives></inline-formula> is the sign function and <inline-formula id="IEq3"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde V_{{\mathrm{CAM}}}$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mo>~</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">CAM</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41592_2023_1873_Article_IEq3.gif"/></alternatives></inline-formula> are the remapped CAM values. Finally, the values of the CAMs were mapped to 8-bit and visualized with the jet colormap.</p>
    </sec>
    <sec id="Sec19">
      <title>Drug screening</title>
      <p id="Par52">Plates of the Screen-Well ICCB Known Bioactives Library BML-2840-0100 and the FDA-approved drug library BML-2843 were defrosted at 22 °C for 1 h and centrifuged at 1,890 ×<italic>g</italic> for 2 min (Eppendorf 5810 R). Six 96-well microtiter plates were pre-filled with 96 μl cell culture-grade PBS (Gibco). From each library plate, 4 μl per well were transferred, resulting in a 1:25 dilution. Blank wells were filled with 4 μl cell culture-grade PBS. Zebrafish embryos were collected as described above, but selected embryos were washed three times with 200 ml embryo medium and transferred to a 96-well plate (Greiner Bio-One), three to five embryos per well. Each well was filled with embryo medium to a volume of 135 μl. Subsequently, 15 μl solution were transferred from the 1:25 intermediate dilution plates to each well containing embryos. Plates were covered with transparent foil, and a plastic lid was placed on the plate.</p>
      <p id="Par53">Screening plates were placed in the ACQUIFER Imaging Machine as described above with an imaging interval between 135 s and 192 s. Image files were converted to JPEG files for further phenotype analyses. The images from the 96-well screening plates were sorted into separate directories related to respective wells using a custom Python script (Drug screen script 1; <ext-link ext-link-type="uri" xlink:href="http://github.com/mueller-lab/EmbryoNet/tree/main/Train_Eval/tools/DrugScreen">http://github.com/mueller-lab/EmbryoNet/tree/main/Train_Eval/tools/DrugScreen</ext-link>). The data files were read into the custom FishClassifier software and evaluated for detected phenotypes. For each image file, phenotype detections were stored as a separate JSON file. The JSON files were read using a custom Python script (Drug screen script 2; <ext-link ext-link-type="uri" xlink:href="http://github.com/mueller-lab/EmbryoNet/tree/main/Train_Eval/tools/DrugScreen">http://github.com/mueller-lab/EmbryoNet/tree/main/Train_Eval/tools/DrugScreen</ext-link>). Evaluated phenotypes were linked with corresponding treatments and finally stored as Excel files, containing the number of images for each class in the time series. These files were used to generate charts for predicted phenotypes resulting from each treatment (Drug screen script 3; <ext-link ext-link-type="uri" xlink:href="http://github.com/mueller-lab/EmbryoNet/tree/main/Train_Eval/tools/DrugScreen">http://github.com/mueller-lab/EmbryoNet/tree/main/Train_Eval/tools/DrugScreen</ext-link>). The majority phenotype for each well was determined as the class to which the highest number of embryo images was assigned.</p>
    </sec>
    <sec id="Sec20">
      <title>Retest and characterization of statins in FGF signaling</title>
      <p id="Par54">Zebrafish embryos were treated with 20 µM simvastatin in embryo medium (Enzo Life Science BML-G244-0050, final concentration of DMSO solvent: 0.2%), 40 µM atorvastatin (Sigma PHR1422, final concentration of DMSO solvent: 0.4%) or 0.4 µM lovastatin (PHR1285, final concentration of DMSO solvent: 0.04%) starting at 1.5–2 h.p.f. or were left untreated and incubated at 28 °C.</p>
      <p id="Par55">Live embryos were imaged at 28 h.p.f. with a bright-field microscope (Leica M205 FCA). For close-up images, embryos were manually dechorionated using precision forceps and embedded in 2% methylcellulose in embryo medium.</p>
      <p id="Par56">For pErk immunostainings, untreated and statin-treated embryos were fixed at the shield stage with 4% formaldehyde in PBS overnight at 4 °C and then stepwise (25%, 50%, 75% methanol in PBST (PBS containing 0.1% Tween-20)) dehydrated. After an overnight incubation in 100% methanol at −20 °C, embryos were rehydrated in three steps (75%, 50%, 25% methanol in PBST). After permeabilization with ice-cold acetone for 20 min at −20 °C and additional washing steps with PBST, samples were blocked in 10% FBS in PBST for 2 h and incubated in 1:5,000 mouse anti-pERK antibody (Sigma, M8159) in 10% FBS in PBST overnight at 4 °C. Embryos were then washed at least 12 times with PBST, followed by another blocking step for 2 h with 10% FBS in PBST and overnight incubation with 1:5,000 donkey anti-mouse HRP-coupled secondary antibody (Jackson ImmunoResearch, 715-035-150) in 10% FBS in PBST at 4 °C. After washing at least 12 times with PBST and once with TSA 1x amplification buffer, embryos were incubated in 75 µl 1:75 Cy3-TSA in 1x amplification buffer for 45 min, protected from light. After washing for at least four times with PBST, embryos were incubated in 0.3 µM DRAQ7 (Invitrogen, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/nuccore/D15106">D15106</ext-link>) in PBST for 30 min and then washed at least three times with PBST. Before imaging, stained embryos were wrapped in aluminum foil and stored overnight at 4 °C.</p>
      <p id="Par57">Fixed and stained embryos were mounted in 1.5% low-melting point agarose (Lonza, 50080) using a glass capillary (50 µl, Brand 701908) and imaged with a ZEISS Lightsheet Z.1 microscope using ZEN 3.1 Black Edition acquisition software. The imaging chamber was filled with water, and filters and lightsheets were auto-aligned prior to imaging<sup><xref ref-type="bibr" rid="CR76">76</xref></sup>. Embryos were positioned with the brightest pErk signal pointing towards the imaging objective (presumptive dorsal view). For each embryo, z-slices with 5 μm between each slice were acquired. All images were acquired with dual lightsheet illumination using a W Plan-Apochromat ×10 objective at ×0.9 zoom, with laser powers of 2% and 6% for pErk and nuclei, respectively.</p>
      <p id="Par58">To measure spatial intensity profiles from the margin to the animal pole, maximum intensity projections of 75 z-slices were generated using Fiji<sup><xref ref-type="bibr" rid="CR77">77</xref></sup>, and pErk intensity profiles were calculated as follows. First, a rectangular region of interest with a width of 300 pixels was manually drawn from the margin of the blastoderm to the animal pole. Only images of embryos that were oriented with the dorsal side facing the camera were used for the analysis. The dorsal side could be identified after generating maximum intensity projections from image stacks. Embryos with tilted dorso-ventral axes were excluded. Then, the average intensity along the profile was calculated using the function Measure in Fiji. The background intensity of pErk was estimated as the median intensity value of the profiles of untreated embryos at the animal pole (between 250 µm and 280 µm from the margin) and subtracted from the intensity profiles using MATLAB 2022a (<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.48606/55">https://doi.org/10.48606/55</ext-link>).</p>
    </sec>
    <sec id="Sec21">
      <title>Reporting summary</title>
      <p id="Par59">Further information on research design is available in the <xref rid="MOESM2" ref-type="media">Nature Portfolio Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec id="Sec22" sec-type="materials|methods">
    <title>Online content</title>
    <p id="Par60">Any methods, additional references, Nature Portfolio reporting summaries, source data, extended data, supplementary information, acknowledgements, peer review information; details of author contributions and competing interests; and statements of data and code availability are available at 10.1038/s41592-023-01873-4.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <p>
      <supplementary-material content-type="local-data" id="MOESM1">
        <media xlink:href="41592_2023_1873_MOESM1_ESM.pdf">
          <label>Supplementary Information</label>
          <caption>
            <p>Supplementary Notes 1–4 and References.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM2">
        <media xlink:href="41592_2023_1873_MOESM2_ESM.pdf">
          <caption>
            <p>Reporting Summary</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM3">
        <media xlink:href="41592_2023_1873_MOESM3_ESM.pdf">
          <caption>
            <p>Peer Review File</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM4">
        <media xlink:href="41592_2023_1873_MOESM4_ESM.xlsx">
          <label>Supplementary Tables</label>
          <caption>
            <p>Supplementary Tables 1–35.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM5">
        <media xlink:href="41592_2023_1873_MOESM5_ESM.mp4">
          <label>Supplementary Video 1</label>
          <caption>
            <p>Representative timecourse of zebrafish Normal wild-type development. The movie spans 24 h with 2 min intervals.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM6">
        <media xlink:href="41592_2023_1873_MOESM6_ESM.mp4">
          <label>Supplementary Video 2</label>
          <caption>
            <p>Representative timecourse of zebrafish −BMP loss-of-function development. Embryos were treated with BMP inhibitor starting at the 4-cell stage. The movie spans 24 h with 2 min intervals.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM7">
        <media xlink:href="41592_2023_1873_MOESM7_ESM.mp4">
          <label>Supplementary Video 3</label>
          <caption>
            <p>Representative timecourse of zebrafish +RA gain-of-function development. Embryos were treated with retinoic acid starting at the 4-cell stage. The movie spans 24 h with 2 min intervals.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM8">
        <media xlink:href="41592_2023_1873_MOESM8_ESM.mp4">
          <label>Supplementary Video 4</label>
          <caption>
            <p>Representative timecourse of zebrafish −Wnt loss-of-function development. Embryos were treated with Wnt inhibitor starting at the 4-cell stage. The movie spans 24 h with 2 min intervals.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM9">
        <media xlink:href="41592_2023_1873_MOESM9_ESM.mp4">
          <label>Supplementary Video 5</label>
          <caption>
            <p>Representative timecourse of zebrafish −FGF loss-of-function development. Embryos were treated with FGF inhibitor starting at the 4-cell stage. The movie spans 24 h with 2 min intervals.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM10">
        <media xlink:href="41592_2023_1873_MOESM10_ESM.mp4">
          <label>Supplementary Video 6</label>
          <caption>
            <p>Representative timecourse of zebrafish −Nodal loss-of-function development. Embryos were treated with Nodal inhibitor starting at the 4-cell stage. The movie spans 24 h with 2 min intervals.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM11">
        <media xlink:href="41592_2023_1873_MOESM11_ESM.mp4">
          <label>Supplementary Video 7</label>
          <caption>
            <p>Representative timecourse of zebrafish −Shh loss-of-function development. Embryos were treated with Shh inhibitor (cyclopamine) starting at the 4-cell stage. The movie spans 24 h with 2 min intervals.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM12">
        <media xlink:href="41592_2023_1873_MOESM12_ESM.mp4">
          <label>Supplementary Video 8</label>
          <caption>
            <p>Representative timecourse of zebrafish −PCP loss-of-function development. Embryos were injected with a <italic>vangl2</italic>-targeting morpholino at the 1-cell stage. The movie spans 24 h with 2 min intervals.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM13">
        <media xlink:href="41592_2023_1873_MOESM13_ESM.mp4">
          <label>Supplementary Video 9</label>
          <caption>
            <p>Activation maps for different phenotype classes in wild-type zebrafish embryos. The movie spans 24 h with 2 min intervals. Activation maps for different phenotype classes (Unknown, Normal, −BMP, +RA, −Wnt, −FGF, −Nodal, −Shh, −PCP and Dead) are shown.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM14">
        <media xlink:href="41592_2023_1873_MOESM14_ESM.mp4">
          <label>Supplementary Video 10</label>
          <caption>
            <p>Activation maps for the phenotype class Normal in 10 wild-type zebrafish embryos. The movie spans 24 h with 2 min intervals.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM15">
        <media xlink:href="41592_2023_1873_MOESM15_ESM.mp4">
          <label>Supplementary Video 11</label>
          <caption>
            <p>Activation maps for different phenotype classes in zebrafish BMP loss-of-function development. Embryos were treated with BMP inhibitor starting at the 4-cell stage. The movie spans 24 h with 2 min intervals. Activation maps for different phenotype classes (Unknown, Normal, −BMP, +RA, −Wnt, −FGF, −Nodal, −Shh, −PCP and Dead) are shown.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM16">
        <media xlink:href="41592_2023_1873_MOESM16_ESM.mp4">
          <label>Supplementary Video 12</label>
          <caption>
            <p>Activation maps for the phenotype class −BMP in 10 BMP loss-of-function zebrafish embryos. The movie spans 24 h with 2 min intervals.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM17">
        <media xlink:href="41592_2023_1873_MOESM17_ESM.mp4">
          <label>Supplementary Video 13</label>
          <caption>
            <p>Activation maps for different phenotype classes in zebrafish RA gain-of-function development. Embryos were treated with retinoic acid starting at the 4-cell stage. The movie spans 24 h with 2 min intervals. Activation maps for different phenotype classes (Unknown, Normal, −BMP, +RA, −Wnt, −FGF, −Nodal, −Shh, −PCP and Dead) are shown.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM18">
        <media xlink:href="41592_2023_1873_MOESM18_ESM.mp4">
          <label>Supplementary Video 14</label>
          <caption>
            <p>Activation maps for the phenotype class +RA in 10 RA gain-of-function zebrafish embryos. The movie spans 24 h with 2 min intervals.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM19">
        <media xlink:href="41592_2023_1873_MOESM19_ESM.mp4">
          <label>Supplementary Video 15</label>
          <caption>
            <p>Activation maps for different phenotype classes in zebrafish Wnt loss-of-function development. Embryos were treated with Wnt inhibitor starting at the 4-cell stage. The movie spans 24 h with 2 min intervals. Activation maps for different phenotype classes (Unknown, Normal, −BMP, +RA, −Wnt, −FGF, −Nodal, −Shh, −PCP and Dead) are shown.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM20">
        <media xlink:href="41592_2023_1873_MOESM20_ESM.mp4">
          <label>Supplementary Video 16</label>
          <caption>
            <p>Activation maps for the phenotype class −Wnt in 10 Wnt loss-of-function zebrafish embryos. The movie spans 24 h with 2 min intervals.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM21">
        <media xlink:href="41592_2023_1873_MOESM21_ESM.mp4">
          <label>Supplementary Video 17</label>
          <caption>
            <p>Activation maps for different phenotype classes in zebrafish FGF loss-of-function development. Embryos were treated with FGF inhibitor starting at the 4-cell stage. The movie spans 24 h with 2 min intervals. Activation maps for different phenotypic classes (Unknown, Normal, −BMP, +RA, −Wnt, −FGF, −Nodal, −Shh, −PCP and Dead) are shown.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM22">
        <media xlink:href="41592_2023_1873_MOESM22_ESM.mp4">
          <label>Supplementary Video 18</label>
          <caption>
            <p>Activation maps for the phenotype class −FGF in 10 FGF loss-of-function zebrafish embryos. The movie spans 24 h with 2 min intervals.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM23">
        <media xlink:href="41592_2023_1873_MOESM23_ESM.mp4">
          <label>Supplementary Video 19</label>
          <caption>
            <p>Activation maps for different phenotype classes in zebrafish Nodal loss-of-function development. Embryos were treated with Nodal inhibitor starting at the 4-cell stage. The movie spans 24 h with 2 min intervals. Activation maps for different phenotype classes (Unknown, Normal, −BMP, +RA, −Wnt, −FGF, −Nodal, −Shh, −PCP and Dead) are shown.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM24">
        <media xlink:href="41592_2023_1873_MOESM24_ESM.mp4">
          <label>Supplementary Video 20</label>
          <caption>
            <p>Activation maps for the phenotype class −Nodal in 10 Nodal loss-of-function zebrafish embryos. The movie spans 24 h with 2 min intervals.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM25">
        <media xlink:href="41592_2023_1873_MOESM25_ESM.mp4">
          <label>Supplementary Video 21</label>
          <caption>
            <p>Activation maps for different phenotype classes in zebrafish Shh loss-of-function development. Embryos were treated with Shh inhibitor (cyclopamine) starting at the 4-cell stage. The movie spans 24 h with 2 min intervals. Activation maps for different phenotype classes (Unknown, Normal, −BMP, +RA, −Wnt, −FGF, −Nodal, −Shh, −PCP and Dead) are shown.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM26">
        <media xlink:href="41592_2023_1873_MOESM26_ESM.mp4">
          <label>Supplementary Video 22</label>
          <caption>
            <p>Activation maps for the phenotype class −Shh in 10 Shh loss-of-function zebrafish embryos. The movie spans 2 h with 2 min intervals.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM27">
        <media xlink:href="41592_2023_1873_MOESM27_ESM.mp4">
          <label>Supplementary Video 23</label>
          <caption>
            <p>Activation maps for different phenotype classes in zebrafish PCP loss-of-function development. Embryos were injected with a <italic>vangl2</italic>-targeting morpholino at the 1-cell stage. The movie spans 24 h with 2 min intervals. Activation maps for different phenotype classes (Unknown, Normal, −BMP, +RA, −Wnt, −FGF, −Nodal, −Shh, −PCP and Dead) are shown.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM28">
        <media xlink:href="41592_2023_1873_MOESM28_ESM.mp4">
          <label>Supplementary Video 24</label>
          <caption>
            <p>Activation maps for the phenotype class −PCP in 10 PCP loss-of-function zebrafish embryos. The movie spans 24 h with 2 min intervals.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM29">
        <media xlink:href="41592_2023_1873_MOESM29_ESM.mp4">
          <label>Supplementary Video 25</label>
          <caption>
            <p>Zebrafish drug screen with ScreenWell Library 2840, plate 1. The movie spans 26 h with 139 s intervals. The embryos were drug-treated according to Supplementary Table 25 starting at the 512-cell stage.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM30">
        <media xlink:href="41592_2023_1873_MOESM30_ESM.mp4">
          <label>Supplementary Video 26</label>
          <caption>
            <p>Zebrafish drug screen with ScreenWell Library 2840, plate 2. The movie spans 24 h with 139 s intervals. The embryos were drug-treated according to Supplementary Table 26 starting at the 128-cell stage.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM31">
        <media xlink:href="41592_2023_1873_MOESM31_ESM.mp4">
          <label>Supplementary Video 27</label>
          <caption>
            <p>Zebrafish drug screen with ScreenWell Library 2840, plate 3. The movie spans 28 h with 138 s intervals. The embryos were drug-treated according to Supplementary Table 27 starting at the 512-cell stage.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM32">
        <media xlink:href="41592_2023_1873_MOESM32_ESM.mp4">
          <label>Supplementary Video 28</label>
          <caption>
            <p>Zebrafish drug screen with ScreenWell Library 2840, plate 4. The movie spans 24 h with 138 s intervals. The embryos were drug-treated according to Supplementary Table 28 starting at the 256-cell stage.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM33">
        <media xlink:href="41592_2023_1873_MOESM33_ESM.mp4">
          <label>Supplementary Video 29</label>
          <caption>
            <p>Zebrafish drug screen with ScreenWell Library 2840, plate 5. The movie spans 26 h with 143 s intervals. The embryos were drug-treated according to Supplementary Table 29 starting at the 256-cell stage.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM34">
        <media xlink:href="41592_2023_1873_MOESM34_ESM.mp4">
          <label>Supplementary Video 30</label>
          <caption>
            <p>Zebrafish drug screen with ScreenWell Library 2840, plate 6. The movie spans 25 h with 144 s intervals. The embryos were drug-treated according to Supplementary Table 30 starting at the 512-cell stage.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM35">
        <media xlink:href="41592_2023_1873_MOESM35_ESM.mp4">
          <label>Supplementary Video 31</label>
          <caption>
            <p>Zebrafish drug screen with ScreenWell Library 2843, plate 1. The movie spans 27 h with 135 s intervals. The embryos were drug-treated according to Supplementary Table 31 starting at the 256-cell stage.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM36">
        <media xlink:href="41592_2023_1873_MOESM36_ESM.mp4">
          <label>Supplementary Video 32</label>
          <caption>
            <p>Zebrafish drug screen with ScreenWell Library 2843, plate 2. The movie spans 24 h with 137 s intervals. The embryos were drug-treated according to Supplementary Table 32 starting at the 32-cell stage.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM37">
        <media xlink:href="41592_2023_1873_MOESM37_ESM.mp4">
          <label>Supplementary Video 33</label>
          <caption>
            <p>Zebrafish drug screen with ScreenWell Library 2843, plate 3. The movie spans 24 h with 138 s intervals. The embryos were drug-treated according to Supplementary Table 33 starting at the 64-cell stage.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM38">
        <media xlink:href="41592_2023_1873_MOESM38_ESM.mp4">
          <label>Supplementary Video 34</label>
          <caption>
            <p>Zebrafish drug screen with ScreenWell Library 2843, plate 5. The movie spans 24 h with 192 s intervals. The embryos were drug-treated according to Supplementary Table 34 starting at the 512-cell stage.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM39">
        <media xlink:href="41592_2023_1873_MOESM39_ESM.mp4">
          <label>Supplementary Video 35</label>
          <caption>
            <p>Zebrafish drug screen with ScreenWell Library 2843, plate 6. The movie spans 24 h with 142 s intervals. The embryos were drug-treated according to Supplementary Table 35 starting at the 512-cell stage.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM40">
        <media xlink:href="41592_2023_1873_MOESM40_ESM.mp4">
          <label>Supplementary Video 36</label>
          <caption>
            <p>Zebrafish development upon exposure to simvastatin. The movie spans 24 h with 137 s intervals. The embryos were treated with 40 µM simvastatin starting at the 32-cell stage.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM41">
        <media xlink:href="41592_2023_1873_MOESM41_ESM.mp4">
          <label>Supplementary Video 37</label>
          <caption>
            <p>Zebrafish development upon exposure to atorvastatin. The movie spans 24 h with 142 s intervals. The embryos were treated with 40 µM atorvastatin starting at the 512-cell stage.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM42">
        <media xlink:href="41592_2023_1873_MOESM42_ESM.mp4">
          <label>Supplementary Video 38</label>
          <caption>
            <p>Zebrafish development upon exposure to lovastatin. The movie spans 24 h with 143 s intervals. The embryos were treated with 20 µg ml<sup>−1</sup> (that is, 50 µM) lovastatin starting at the 256-cell stage.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM43">
        <media xlink:href="41592_2023_1873_MOESM43_ESM.mp4">
          <label>Supplementary Video 39</label>
          <caption>
            <p>Medaka normal development. The movie spans 37.5 h with 5 min intervals, starting at stage 11.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM44">
        <media xlink:href="41592_2023_1873_MOESM44_ESM.mp4">
          <label>Supplementary Video 40</label>
          <caption>
            <p>Medaka development with Nodal loss of function. The movie spans 37.5 h with 5 min intervals. The embryos were treated with the chemical Nodal inhibitor SB-505124 at a concentration of 7.5 µM starting at stage 11.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM45">
        <media xlink:href="41592_2023_1873_MOESM45_ESM.mp4">
          <label>Supplementary Video 41</label>
          <caption>
            <p>Stickleback normal development. The movie spans 120 h with 5 min intervals, starting at stage 10.</p>
          </caption>
        </media>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="MOESM46">
        <media xlink:href="41592_2023_1873_MOESM46_ESM.mp4">
          <label>Supplementary Video 42</label>
          <caption>
            <p>Stickleback development with Nodal loss of function. The movie spans 120 h with 5 min intervals. The embryos were treated with the chemical Nodal inhibitor SB-505124 at a concentration of 15 µM, starting from stage 10.</p>
          </caption>
        </media>
      </supplementary-material>
    </p>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec23">
        <title>Extended data</title>
        <p id="Par65">
          <fig id="Fig5">
            <label>Extended Data Fig. 1</label>
            <caption>
              <title>Schematic of the training pipeline for EmbryoNet.</title>
              <p><bold>(a)</bold> Overview of a training iteration. Augmented embryos were collected into a training batch with known embryo age. After EmbryoNet processed a batch of input images with ages, network outputs were compared with ground truth values. Based on cross-entropy loss, EmbryoNet weights were updated to minimize the loss. <bold>(b)</bold> Examples of augmentations used. <bold>(c)</bold> In our model transition logic, embryos have a limited set of allowed class transitions. All start in the class Unknown and can transition to any other class, from where they can go only to Dead, but not to other classes. Other transitions were assigned a cost. The model with the least cost was selected. <bold>(d)</bold> Schematic of the classification pipeline. <bold>(e)</bold> Graphical user interface (GUI) of EmbryoNet. <bold>(f,g)</bold> Comparison of EmbryoNet’s performance to recognize phenotypes induced by signaling modulation using small-molecule inhibitors, overexpression of signaling antagonists or pathway mutants. Nodal phenotypes (f) induced by small-molecule inhibitor treatment (SB-505124, n=33), injection of a pathway antagonist (<italic>lefty1</italic> mRNA, n=27) or in a receptor mutant (<italic>MZoep</italic>, n=27) were all classified by EmbryoNet as –Nodal with similar accuracy. BMP phenotypes (g) induced by small-molecule inhibitor treatment (LDN-193189, n=45), pathway antagonist injection (<italic>chordin</italic> mRNA, n=26) or in a pathway ligand mutant (<italic>swirl</italic><sup><italic>-/-</italic></sup>, n=13) were all classified by EmbryoNet as –BMP with similar accuracy. Scale bars: 500 µm.</p>
            </caption>
            <graphic position="anchor" xlink:href="41592_2023_1873_Fig5_ESM" id="d32e2169"/>
          </fig>
        </p>
        <p id="Par66">
          <fig id="Fig6">
            <label>Extended Data Fig. 2</label>
            <caption>
              <title>Complete data of the non-expert teams to assess 98 embryo images without time information.</title>
              <p>Confusion matrices show the classification of the respective non-expert teams. The non-expert teams did not have extra information about the age of the displayed embryos.</p>
            </caption>
            <graphic position="anchor" xlink:href="41592_2023_1873_Fig6_ESM" id="d32e2183"/>
          </fig>
        </p>
        <p id="Par67">
          <fig id="Fig7">
            <label>Extended Data Fig. 3</label>
            <caption>
              <title>Complete data of the non-expert teams to assess 98 embryo images with time information.</title>
              <p>Confusion matrices show the classification of the respective teams. Embryo age was supplied with the images.</p>
            </caption>
            <graphic position="anchor" xlink:href="41592_2023_1873_Fig7_ESM" id="d32e2197"/>
          </fig>
        </p>
        <p id="Par68">
          <fig id="Fig8">
            <label>Extended Data Fig. 4</label>
            <caption>
              <title>Classification of time-lapse data by experts and EmbryoNet, and classification performance with different microscope data sets.</title>
              <p>(<bold>a-c)</bold> Schematics and confusion matrices show classification of image series of the respective assessors. Human experts (a,b) knew that all embryos within a movie received the same treatment. <bold>(d,e)</bold> Confusion matrices showing the performance of EmbryoNet (d) and EmbryoNet-Prime (e) if only test data from either microscope 1 (d’,e’, ACQUIFER Imaging Machine) or microscope 2 (d’’,e’’, Keyence BZ-X810) was used.</p>
            </caption>
            <graphic position="anchor" xlink:href="41592_2023_1873_Fig8_ESM" id="d32e2217"/>
          </fig>
        </p>
        <p id="Par69">
          <fig id="Fig9">
            <label>Extended Data Fig. 5</label>
            <caption>
              <title>Classification of mild Nodal and BMP phenotypes.</title>
              <p><bold>(a)</bold> Schematic of the experiment with lower inhibitor doses. Lower doses of the BMP inhibitor LDN-193189 lead to weaker phenotypes, detectable from late gastrulation onwards. While in the severe cases no clear structures are distinguishable, moderate embryos have a head and somites and display the characteristic BMP loss-of-function phenotype with curled-up tails (Kishimoto et al. 1997). Mild embryos have a largely intact body axis only missing the tail. <bold>(b-d)</bold> Confusion matrices showing the performance of classification of weaker phenotypes. EmbryoNet (b) had a lower performance on milder compared to severe phenotypes, especially for Nodal-inhibited samples. Human annotators were also less consequent as seen from the confusion matrix between the accepted ground truth and a second labeler (c). EmbryoNet-Prime had better success in detecting weak Nodal phenotypes compared to EmbryoNet, but was less performant on –BMP and on average (d).</p>
            </caption>
            <graphic position="anchor" xlink:href="41592_2023_1873_Fig9_ESM" id="d32e2236"/>
          </fig>
        </p>
        <p id="Par70">
          <fig id="Fig10">
            <label>Extended Data Fig. 6</label>
            <caption>
              <title>Detection time points of all classes by EmbryoNet-Prime.</title>
              <p>Plots of the number of detected phenotypes (dotted lines) for each class over time for EmbryoNet (pink diamonds), EmbryoNet-Prime (blue triangles) and human experts (green dots). The error envelopes show standard error of the mean. Solid lines show the fit of a sigmoid curve to the data. Gray boxes show major developmental periods. Different classes could be detected at different time points. –BMP, + RA, –Wnt, –Nodal and –Shh could be classified earlier by EmbryoNet-Prime than by humans. n[Normal]: 74, n[–BMP]: 119, n[+RA]: = 66, n[–Wnt]: 70, n[–FGF]: 74, n[–Nodal]: 110, n[–Shh]: 63, n[–PCP]: 57. Data also shown in Fig. <xref rid="Fig2" ref-type="fig">2g</xref>.</p>
            </caption>
            <graphic position="anchor" xlink:href="41592_2023_1873_Fig10_ESM" id="d32e2253"/>
          </fig>
        </p>
        <p id="Par71">
          <fig id="Fig11">
            <label>Extended Data Fig. 7</label>
            <caption>
              <title>Results of the Enzo ScreenWell 2840 library drug screen.</title>
              <p>(<bold>a</bold>–<bold>f</bold>) Layout of plates 1 (<bold>a</bold>), 2 (<bold>b</bold>), 3 (<bold>c</bold>), 4 (<bold>d</bold>), 5 (<bold>e</bold>) and 6 (<bold>f</bold>) from the BML-2840 library with classifications per well by majority phenotype. See Supplementary Tables 25–30 for details.</p>
            </caption>
            <graphic position="anchor" xlink:href="41592_2023_1873_Fig11_ESM" id="d32e2292"/>
          </fig>
        </p>
        <p id="Par72">
          <fig id="Fig12">
            <label>Extended Data Fig. 8</label>
            <caption>
              <title>Results of the Enzo ScreenWell 2843 library drug screen.</title>
              <p>(<bold>a</bold>–<bold>e</bold>) Layout of plates 1 (<bold>a</bold>), 2 (<bold>b</bold>), 3 (<bold>c</bold>), 5 (<bold>d</bold>) and 6 (<bold>e</bold>) from the BML-2843 library with classifications per well by majority phenotype. See Supplementary Tables 31–35 for details.</p>
            </caption>
            <graphic position="anchor" xlink:href="41592_2023_1873_Fig12_ESM" id="d32e2328"/>
          </fig>
        </p>
      </sec>
    </app>
  </app-group>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>These authors contributed equally: Daniel Čapek, Matvey Safroshkin, Hernán Morales-Navarrete.</p>
    </fn>
  </fn-group>
  <sec>
    <sec id="FPar1">
      <title>Extended data</title>
      <p id="Par61">are available for this paper at 10.1038/s41592-023-01873-4.</p>
    </sec>
    <sec id="FPar2" sec-type="supplementary-material">
      <title>Supplementary information</title>
      <p id="Par62">The online version contains supplementary material available at 10.1038/s41592-023-01873-4.</p>
    </sec>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>This project has received funding from the European Research Council (ERC) under the European Union’s Horizon 2020 research and innovation program (grant agreement No. 863952 (ACE-OF-SPACE) to P.M.). This work was also funded by the EMBO Young Investigator Programme (P.M.), Max Planck Society (P.M., F.J.), the FWF (Project J-4507, D.Č.), the IZKF of the Medical Faculty of the University of Tübingen (P.M., N.T.), and the Deutsche Forschungsgemeinschaft (DFG, German Research Foundation) under Germany’s Excellence Strategy—EXC 2117—422037984 (P.M.). We thank K.W. Rogers, A. Schauer, K. Sarieva, I. Carmi and M. Rössler for scientific input, consulting and illustration support. We also thank O. Aust for initial drug screenings and A. Baccini for technical assistance with compound retesting. For participating in the classification of single embryo images, we thank M. Akyüz, L. Amann, A. Balb, A. Bangnowski, S. Baumgärtner, A.-S. Becker, S. Berber, S. Bergemann, T. Berger, L. Betz-Jung, L. Beuten, M. Brückner, L. Budig, N. Bürgers, P. Buslaps, D. Casaburi, L. Dangel, J. Davia, T. Decker, A. Eiberle, J. Engler, C. Feldmann, M. Franz, E. Frese, A. Fronius, B. Goldschmidt, C. Gomes, D. Gaßebner, L. Haas, L. Haßfeld, L. Heger, L. Helten, S. Hillman, S. Hinte, L. Huber, J. Iffelsberger, I. Jorzik, J. Jung, L. Kammerer, J. Klein, E. Kleinke, H. Klenk, V. Kneipp, M. Kölle, M. Kröner, V. Kuhn, P. Kukofka, J. Küpfer, Y. Lan, K. Land, C. Lewin, M. Lohmer, J. Lüders, X. Lyu, H. Mahl, R. Manukjan, M. Martini, A. Maslonka, P. Matijas-Graf, N. Meier, T. Morell, F. Natale, M. Nyesö, F. Piehler, A. Pirker, S. Rampp, V. Raupp, K.M. Reagan, A. Reiß, G. Rösler, F. Roßmann, J. Roylands, L. Ruf, J. Schiele, R. Schmidt, A. Schneider, M. Schön, M. Schröter, A. Schupp, F. Stiller, S. Stöckl, L. Thellmann, M. Thomann, D. Torcuk, Z. Umbach, R. Unsöld, C. Vogl, H.C. von Vegesack, R. Wagner, G. Wallig, M.A. Wannemacher, L. Wanner, F. Welsch, C. Wolfer, V. Zickenberg and M. Ziefle. We also thank T. Thumberger and J. Wittbrodt for providing the medaka Cab strain, and P. Huang for providing the <italic>pCS2-zGli3R-EGFP</italic> plasmid.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>P.M. and B.J. conceived the study. P.M. supervised the project. D.Č., J.B., M.S., N.T. and H.M.-N. manually annotated images. M.S. and G.A. developed the software for EmbryoNet. M.S., G.A. and H.M.-N. developed software for downstream analysis. N.T. and D.Č. performed the drug screens. N.T. analyzed the drug screen. H.M.-N. analyzed the zebrafish data, M.S. analyzed the medaka data and N.T. analyzed the stickleback data. A.K. performed the retests of the statins, carried out immunostainings and lightsheet microscopy, and acquired time series on the Keyence BZ-X810 microscope. H.M.-N. contributed to lightsheet imaging and performed pErk quantification. D.Č. carried out all other experiments. J.H., S.K. and F.J. provided in vitro fertilized stickleback embryos. D.Č. and P.M. wrote the paper with input from all of the authors.</p>
  </notes>
  <notes notes-type="peer-review">
    <title>Peer review</title>
    <sec id="FPar3">
      <title>Peer review information</title>
      <p id="Par63"><italic>Nature Methods</italic> thanks Marc Muller and the other, anonymous, reviewer(s) for their contribution to the peer review of this work. <xref rid="MOESM3" ref-type="media">Peer reviewer reports</xref> are available. Primary Handling Editor: Rita Strack, in collaboration with the <italic>Nature Methods</italic> team.</p>
    </sec>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>Training and evaluation datasets for EmbryoNet are available from <ext-link ext-link-type="uri" xlink:href="http://embryonet.uni-konstanz.de">http://embryonet.uni-konstanz.de</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.48606/15">https://doi.org/10.48606/15</ext-link>. The drug screen data are available from <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.48606/37">https://doi.org/10.48606/37</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.48606/38">https://doi.org/10.48606/38</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.48606/41">https://doi.org/10.48606/41</ext-link>. Additional data that support the findings of this study are available from <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.48606/53">https://doi.org/10.48606/53</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.48606/55">https://doi.org/10.48606/55</ext-link>.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>The source code for EmbryoNet is available from <ext-link ext-link-type="uri" xlink:href="http://github.com/mueller-lab/EmbryoNet">http://github.com/mueller-lab/EmbryoNet</ext-link> (<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.7531593">https://doi.org/10.5281/zenodo.7531593</ext-link>). Additional custom scripts used for data analysis in this study are available from <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.48606/15">https://doi.org/10.48606/15</ext-link>.</p>
  </notes>
  <notes id="FPar4" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par64">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marlow</surname>
            <given-names>FL</given-names>
          </name>
        </person-group>
        <article-title>Setting up for gastrulation in zebrafish</article-title>
        <source>Curr. Top. Dev. Biol.</source>
        <year>2020</year>
        <volume>136</volume>
        <fpage>33</fpage>
        <lpage>83</lpage>
        <?supplied-pmid 31959294?>
        <pub-id pub-id-type="pmid">31959294</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schier</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Talbot</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>Molecular genetics of axis formation in zebrafish</article-title>
        <source>Annu. Rev. Genet.</source>
        <year>2005</year>
        <volume>39</volume>
        <fpage>561</fpage>
        <lpage>613</lpage>
        <?supplied-pmid 16285872?>
        <pub-id pub-id-type="pmid">16285872</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heisenberg</surname>
            <given-names>CP</given-names>
          </name>
          <name>
            <surname>Solnica-Krezel</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Back and forth between cell fate specification and movement during vertebrate gastrulation</article-title>
        <source>Curr. Opin. Genet. Dev.</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>311</fpage>
        <lpage>316</lpage>
        <?supplied-pmid 18721878?>
        <pub-id pub-id-type="pmid">18721878</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Manzo</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Similarities between embryo development and cancer process suggest new strategies for research and therapy of tumors: a new point of view</article-title>
        <source>Front. Cell Dev. Biol.</source>
        <year>2019</year>
        <volume>7</volume>
        <fpage>20</fpage>
        <?supplied-pmid 30899759?>
        <pub-id pub-id-type="pmid">30899759</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nusse</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Clevers</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Wnt/beta-catenin signaling, disease, and emerging therapeutic modalities</article-title>
        <source>Cell</source>
        <year>2017</year>
        <volume>169</volume>
        <fpage>985</fpage>
        <lpage>999</lpage>
        <?supplied-pmid 28575679?>
        <pub-id pub-id-type="pmid">28575679</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gray</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>Roszko</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Solnica-Krezel</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Planar cell polarity: coordinating morphogenetic cell behaviors with embryonic polarity</article-title>
        <source>Dev. Cell</source>
        <year>2011</year>
        <volume>21</volume>
        <fpage>120</fpage>
        <lpage>133</lpage>
        <?supplied-pmid 21763613?>
        <pub-id pub-id-type="pmid">21763613</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Schier</surname>
            <given-names>AF</given-names>
          </name>
        </person-group>
        <article-title>Dampened Hedgehog signaling but normal Wnt signaling in zebrafish without cilia</article-title>
        <source>Development</source>
        <year>2009</year>
        <volume>136</volume>
        <fpage>3089</fpage>
        <lpage>3098</lpage>
        <?supplied-pmid 19700616?>
        <pub-id pub-id-type="pmid">19700616</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Woods</surname>
            <given-names>IG</given-names>
          </name>
          <name>
            <surname>Talbot</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>The you gene encodes an EGF-CUB protein essential for Hedgehog signaling in zebrafish</article-title>
        <source>PLoS Biol.</source>
        <year>2005</year>
        <volume>3</volume>
        <fpage>e66</fpage>
        <?supplied-pmid 15660164?>
        <pub-id pub-id-type="pmid">15660164</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schier</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Talbot</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>Nodal signaling and the zebrafish organizer</article-title>
        <source>Int. J. Dev. Biol.</source>
        <year>2001</year>
        <volume>45</volume>
        <fpage>289</fpage>
        <lpage>297</lpage>
        <?supplied-pmid 11291859?>
        <pub-id pub-id-type="pmid">11291859</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nasevicius</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ekker</surname>
            <given-names>SC</given-names>
          </name>
        </person-group>
        <article-title>Effective targeted gene ‘knockdown’ in zebrafish</article-title>
        <source>Nat. Genet.</source>
        <year>2000</year>
        <volume>26</volume>
        <fpage>216</fpage>
        <lpage>220</lpage>
        <?supplied-pmid 11017081?>
        <pub-id pub-id-type="pmid">11017081</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hino</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Roles of maternal wnt8a transcripts in axis formation in zebrafish</article-title>
        <source>Dev. Biol.</source>
        <year>2018</year>
        <volume>434</volume>
        <fpage>96</fpage>
        <lpage>107</lpage>
        <?supplied-pmid 29208373?>
        <pub-id pub-id-type="pmid">29208373</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lekven</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Thorpe</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Waxman</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Moon</surname>
            <given-names>RT</given-names>
          </name>
        </person-group>
        <article-title>Zebrafish wnt8 encodes two wnt8 proteins on a bicistronic transcript and is required for mesoderm and neurectoderm patterning</article-title>
        <source>Dev. Cell</source>
        <year>2001</year>
        <volume>1</volume>
        <fpage>103</fpage>
        <lpage>114</lpage>
        <?supplied-pmid 11703928?>
        <pub-id pub-id-type="pmid">11703928</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rohner</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Duplication of fgfr1 permits Fgf signaling to serve as a target for selection during domestication</article-title>
        <source>Curr. Biol.</source>
        <year>2009</year>
        <volume>19</volume>
        <fpage>1642</fpage>
        <lpage>1647</lpage>
        <?supplied-pmid 19733072?>
        <pub-id pub-id-type="pmid">19733072</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kishimoto</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>KH</given-names>
          </name>
          <name>
            <surname>Zon</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hammerschmidt</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schulte-Merker</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>The molecular nature of zebrafish swirl: BMP2 function is essential during early dorsoventral patterning</article-title>
        <source>Development</source>
        <year>1997</year>
        <volume>124</volume>
        <fpage>4457</fpage>
        <lpage>4466</lpage>
        <?supplied-pmid 9409664?>
        <pub-id pub-id-type="pmid">9409664</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shinya</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Eschbach</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lehrach</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Furutani-Seiki</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Zebrafish Dkk1, induced by the pre-MBT Wnt signaling, is secreted from the prechordal plate and patterns the anterior neural plate</article-title>
        <source>Mech. Dev.</source>
        <year>2000</year>
        <volume>98</volume>
        <fpage>3</fpage>
        <lpage>17</lpage>
        <?supplied-pmid 11044603?>
        <pub-id pub-id-type="pmid">11044603</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Begemann</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Schilling</surname>
            <given-names>TF</given-names>
          </name>
          <name>
            <surname>Rauch</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Geisler</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ingham</surname>
            <given-names>PW</given-names>
          </name>
        </person-group>
        <article-title>The zebrafish neckless mutation reveals a requirement for raldh2 in mesodermal signals that pattern the hindbrain</article-title>
        <source>Development</source>
        <year>2001</year>
        <volume>128</volume>
        <fpage>3081</fpage>
        <lpage>3094</lpage>
        <?supplied-pmid 11688558?>
        <pub-id pub-id-type="pmid">11688558</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stainier</surname>
            <given-names>DY</given-names>
          </name>
          <name>
            <surname>Fishman</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <article-title>Patterning the zebrafish heart tube: acquisition of anteroposterior polarity</article-title>
        <source>Dev. Biol.</source>
        <year>1992</year>
        <volume>153</volume>
        <fpage>91</fpage>
        <lpage>101</lpage>
        <?supplied-pmid 1516755?>
        <pub-id pub-id-type="pmid">1516755</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>LeCun</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Bengio</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hinton</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Deep learning</article-title>
        <source>Nature</source>
        <year>2015</year>
        <volume>521</volume>
        <fpage>436</fpage>
        <lpage>444</lpage>
        <?supplied-pmid 26017442?>
        <pub-id pub-id-type="pmid">26017442</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Russakovsky</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ImageNet large scale visual recognition challenge</article-title>
        <source>Int. J. Comput. Vis.</source>
        <year>2015</year>
        <volume>115</volume>
        <fpage>211</fpage>
        <lpage>252</lpage>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jumper</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Highly accurate protein structure prediction with AlphaFold</article-title>
        <source>Nature</source>
        <year>2021</year>
        <volume>596</volume>
        <fpage>583</fpage>
        <lpage>589</lpage>
        <?supplied-pmid 34265844?>
        <pub-id pub-id-type="pmid">34265844</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jumper</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hassabis</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Protein structure predictions to atomic accuracy with AlphaFold</article-title>
        <source>Nat. Methods</source>
        <year>2022</year>
        <volume>19</volume>
        <fpage>11</fpage>
        <lpage>12</lpage>
        <?supplied-pmid 35017726?>
        <pub-id pub-id-type="pmid">35017726</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Senior</surname>
            <given-names>AW</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Improved protein structure prediction using potentials from deep learning</article-title>
        <source>Nature</source>
        <year>2020</year>
        <volume>577</volume>
        <fpage>706</fpage>
        <lpage>710</lpage>
        <?supplied-pmid 31942072?>
        <pub-id pub-id-type="pmid">31942072</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tunyasuvunakool</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Highly accurate protein structure prediction for the human proteome</article-title>
        <source>Nature</source>
        <year>2021</year>
        <volume>596</volume>
        <fpage>590</fpage>
        <lpage>596</lpage>
        <?supplied-pmid 34293799?>
        <pub-id pub-id-type="pmid">34293799</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reichstein</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Deep learning and process understanding for data-driven Earth system science</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>566</volume>
        <fpage>195</fpage>
        <lpage>204</lpage>
        <?supplied-pmid 30760912?>
        <pub-id pub-id-type="pmid">30760912</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hallou</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yevick</surname>
            <given-names>HG</given-names>
          </name>
          <name>
            <surname>Dumitrascu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Uhlmann</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Deep learning for bioimage analysis in developmental biology</article-title>
        <source>Development</source>
        <year>2021</year>
        <volume>148</volume>
        <fpage>dev199616</fpage>
        <?supplied-pmid 34490888?>
        <pub-id pub-id-type="pmid">34490888</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moen</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Deep learning for cellular image analysis</article-title>
        <source>Nat. Methods</source>
        <year>2019</year>
        <volume>16</volume>
        <fpage>1233</fpage>
        <lpage>1246</lpage>
        <?supplied-pmid 31133758?>
        <pub-id pub-id-type="pmid">31133758</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weigert</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Content-aware image restoration: pushing the limits of fluorescence microscopy</article-title>
        <source>Nat. Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>1090</fpage>
        <lpage>1097</lpage>
        <?supplied-pmid 30478326?>
        <pub-id pub-id-type="pmid">30478326</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McQuin</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CellProfiler 3.0: next-generation image processing for biology</article-title>
        <source>PLoS Biol.</source>
        <year>2018</year>
        <volume>16</volume>
        <fpage>e2005970</fpage>
        <?supplied-pmid 29969450?>
        <pub-id pub-id-type="pmid">29969450</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stringer</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Michaelos</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pachitariu</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Cellpose: a generalist algorithm for cellular segmentation</article-title>
        <source>Nat. Methods</source>
        <year>2021</year>
        <volume>18</volume>
        <fpage>100</fpage>
        <lpage>106</lpage>
        <?supplied-pmid 33318659?>
        <pub-id pub-id-type="pmid">33318659</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Naert</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Deep learning is widely applicable to phenotyping embryonic development and disease</article-title>
        <source>Development</source>
        <year>2021</year>
        <volume>148</volume>
        <fpage>dev199664</fpage>
        <?supplied-pmid 34739029?>
        <pub-id pub-id-type="pmid">34739029</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tyagi</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Patel</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Ishwar</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>A fine-tuned convolution neural network based approach for phenotype classification of zebrafish</article-title>
        <source>Procedia Computer Science</source>
        <year>2018</year>
        <volume>126</volume>
        <fpage>1138</fpage>
        <lpage>1144</lpage>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Jeanray, N. et al. Phenotype classification of zebrafish embryos by supervised learning. <italic>PLoS ONE</italic><bold>10</bold>, e0116989 (2015).</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <mixed-citation publication-type="other">Khosravi, P. et al. Deep learning enables robust assessment and selection of human blastocysts after in vitro fertilization. <italic>npj Digit. Med.</italic><bold>2</bold>, 21 (2019).</mixed-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baris Atakan</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Alkanat</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Cornaglia</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Trouillon</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gijs</surname>
            <given-names>MAM</given-names>
          </name>
        </person-group>
        <article-title>Automated phenotyping of <italic>Caenorhabditis elegans</italic> embryos with a high-throughput-screening microfluidic platform</article-title>
        <source>Microsyst. Nanoeng.</source>
        <year>2020</year>
        <volume>6</volume>
        <fpage>24</fpage>
        <?supplied-pmid 34567639?>
        <pub-id pub-id-type="pmid">34567639</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <mixed-citation publication-type="other">Suryanto, M. E. et al. Using DeepLabCut as a real-time and markerless tool for cardiac physiology assessment in zebrafish. <italic>Biology</italic><bold>11</bold>, 1243 (2022).</mixed-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tills</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A high-throughput and open-source platform for embryo phenomics</article-title>
        <source>PLoS Biol.</source>
        <year>2018</year>
        <volume>16</volume>
        <fpage>e3000074</fpage>
        <?supplied-pmid 30543636?>
        <pub-id pub-id-type="pmid">30543636</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shen</surname>
            <given-names>MM</given-names>
          </name>
        </person-group>
        <article-title>Nodal signaling: developmental roles and regulation</article-title>
        <source>Development</source>
        <year>2007</year>
        <volume>134</volume>
        <fpage>1023</fpage>
        <lpage>1034</lpage>
        <?supplied-pmid 17287255?>
        <pub-id pub-id-type="pmid">17287255</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DaCosta Byfield</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Major</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Laping</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Roberts</surname>
            <given-names>AB</given-names>
          </name>
        </person-group>
        <article-title>SB-505124 is a selective inhibitor of transforming growth factor-beta type I receptors ALK4, ALK5, and ALK7</article-title>
        <source>Mol. Pharmacol.</source>
        <year>2004</year>
        <volume>65</volume>
        <fpage>744</fpage>
        <lpage>752</lpage>
        <?supplied-pmid 14978253?>
        <pub-id pub-id-type="pmid">14978253</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hagos</surname>
            <given-names>EG</given-names>
          </name>
          <name>
            <surname>Dougan</surname>
            <given-names>ST</given-names>
          </name>
        </person-group>
        <article-title>Time-dependent patterning of the mesoderm and endoderm by Nodal signals in zebrafish</article-title>
        <source>BMC Dev. Biol.</source>
        <year>2007</year>
        <volume>7</volume>
        <fpage>22</fpage>
        <?supplied-pmid 17391517?>
        <pub-id pub-id-type="pmid">17391517</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <mixed-citation publication-type="other">He, K., Zhang, X., Ren, S. &amp; Sun, J. Deep residual learning for image recognition. In <italic>2016 IEEE Conference on Computer Vision and Pattern Recognition</italic> (<italic>CVPR</italic>) 770–778 (2016).</mixed-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <mixed-citation publication-type="other">Gritsman, K. et al. The EGF-CFC protein One-eyed pinhead is essential for Nodal signaling. <italic>Cell</italic><bold>97</bold>, 121–132 (1999).</mixed-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The development of highly potent inhibitors for porcupine</article-title>
        <source>J. Med. Chem.</source>
        <year>2013</year>
        <volume>56</volume>
        <fpage>2700</fpage>
        <lpage>2704</lpage>
        <?supplied-pmid 23477365?>
        <pub-id pub-id-type="pmid">23477365</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <mixed-citation publication-type="other">Sun, L. et al. Design, synthesis, and evaluations of substituted 3-[(3- or 4-carboxyethylpyrrol-2-yl)methylidenyl]indolin-2-ones as inhibitors of VEGF, FGF, and PDGF receptor tyrosine kinases. <italic>J. Med. Chem.</italic><bold>42</bold>, 5120–5130 (1999).</mixed-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cuny</surname>
            <given-names>GD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Structure-activity relationship study of bone morphogenetic protein (BMP) signaling inhibitors</article-title>
        <source>Bioorg. Med. Chem. Lett.</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>4388</fpage>
        <lpage>4392</lpage>
        <?supplied-pmid 18621530?>
        <pub-id pub-id-type="pmid">18621530</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Incardona</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Gaffield</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Kapur</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Roelink</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>The teratogenic Veratrum alkaloid cyclopamine inhibits sonic hedgehog signal transduction</article-title>
        <source>Development</source>
        <year>1998</year>
        <volume>125</volume>
        <fpage>3553</fpage>
        <lpage>3562</lpage>
        <?supplied-pmid 9716521?>
        <pub-id pub-id-type="pmid">9716521</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dougan</surname>
            <given-names>ST</given-names>
          </name>
          <name>
            <surname>Warga</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Kane</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Schier</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Talbot</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>The role of the zebrafish nodal-related genes squint and cyclops in patterning of mesendoderm</article-title>
        <source>Development</source>
        <year>2003</year>
        <volume>130</volume>
        <fpage>1837</fpage>
        <lpage>1851</lpage>
        <?supplied-pmid 12642489?>
        <pub-id pub-id-type="pmid">12642489</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <mixed-citation publication-type="other">Zhou, B., Khosla, A., Lapedriza, A., Oliva, A. &amp; Torralba, A. Learning deep features for discriminative localization. Preprint at <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1512.04150">https://arxiv.org/abs/1512.04150</ext-link> (2015).</mixed-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Müller</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Differential diffusivity of Nodal and Lefty underlies a reaction–diffusion patterning system</article-title>
        <source>Science</source>
        <year>2012</year>
        <volume>336</volume>
        <fpage>721</fpage>
        <lpage>724</lpage>
        <?supplied-pmid 22499809?>
        <pub-id pub-id-type="pmid">22499809</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van Boxtel</surname>
            <given-names>AL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A temporal window for signal activation dictates the dimensions of a Nodal signaling domain</article-title>
        <source>Dev. Cell</source>
        <year>2015</year>
        <volume>35</volume>
        <fpage>175</fpage>
        <lpage>185</lpage>
        <?supplied-pmid 26506307?>
        <pub-id pub-id-type="pmid">26506307</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bilder</surname>
            <given-names>RM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Phenomics: the systematic study of phenotypes on a genome-wide scale</article-title>
        <source>Neuroscience</source>
        <year>2009</year>
        <volume>164</volume>
        <fpage>30</fpage>
        <lpage>42</lpage>
        <?supplied-pmid 19344640?>
        <pub-id pub-id-type="pmid">19344640</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <mixed-citation publication-type="other">Campos, L. M. et al. Alterations in zebrafish development induced by simvastatin: comprehensive morphological and physiological study, focusing on muscle. <italic>Exp. Biol. Med.</italic><bold>241</bold>, 1950–1960 (2016).</mixed-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Campos</surname>
            <given-names>LM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Structural analysis of alterations in zebrafish muscle differentiation induced by simvastatin and their recovery with cholesterol</article-title>
        <source>J. Histochem. Cytochem.</source>
        <year>2015</year>
        <volume>63</volume>
        <fpage>427</fpage>
        <lpage>437</lpage>
        <?supplied-pmid 25786435?>
        <pub-id pub-id-type="pmid">25786435</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maerz</surname>
            <given-names>LD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Pharmacological cholesterol depletion disturbs ciliogenesis and ciliary function in developing zebrafish</article-title>
        <source>Commun. Biol.</source>
        <year>2019</year>
        <volume>2</volume>
        <fpage>31</fpage>
        <?supplied-pmid 30729178?>
        <pub-id pub-id-type="pmid">30729178</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thorpe</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Doitsidou</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ho</surname>
            <given-names>SY</given-names>
          </name>
          <name>
            <surname>Raz</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Farber</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>Germ cell migration in zebrafish is dependent on HMGCoA reductase activity and prenylation</article-title>
        <source>Dev. Cell</source>
        <year>2004</year>
        <volume>6</volume>
        <fpage>295</fpage>
        <lpage>302</lpage>
        <?supplied-pmid 14960282?>
        <pub-id pub-id-type="pmid">14960282</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leerberg</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Hopton</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Draper</surname>
            <given-names>BW</given-names>
          </name>
        </person-group>
        <article-title>Fibroblast growth factor receptors function redundantly during zebrafish embryonic development</article-title>
        <source>Genetics</source>
        <year>2019</year>
        <volume>212</volume>
        <fpage>1301</fpage>
        <lpage>1319</lpage>
        <?supplied-pmid 31175226?>
        <pub-id pub-id-type="pmid">31175226</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Draper</surname>
            <given-names>BW</given-names>
          </name>
          <name>
            <surname>Stock</surname>
            <given-names>DW</given-names>
          </name>
          <name>
            <surname>Kimmel</surname>
            <given-names>CB</given-names>
          </name>
        </person-group>
        <article-title>Zebrafish fgf24 functions with fgf8 to promote posterior mesodermal development</article-title>
        <source>Development</source>
        <year>2003</year>
        <volume>130</volume>
        <fpage>4639</fpage>
        <lpage>4654</lpage>
        <?supplied-pmid 12925590?>
        <pub-id pub-id-type="pmid">12925590</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Economou</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Guglielmi</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>East</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>CS</given-names>
          </name>
        </person-group>
        <article-title>Nodal signaling establishes a competency window for stochastic cell fate switching</article-title>
        <source>Dev. Cell</source>
        <year>2022</year>
        <volume>57</volume>
        <fpage>2604</fpage>
        <lpage>2622</lpage>
        <?supplied-pmid 36473458?>
        <pub-id pub-id-type="pmid">36473458</pub-id>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Piotrowski</surname>
            <given-names>PC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Statins inhibit growth of human endometrial stromal cells independently of cholesterol availability</article-title>
        <source>Biol. Reprod.</source>
        <year>2006</year>
        <volume>75</volume>
        <fpage>107</fpage>
        <lpage>111</lpage>
        <?supplied-pmid 16571871?>
        <pub-id pub-id-type="pmid">16571871</pub-id>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <mixed-citation publication-type="other">Pfister, P., Randall, J., Montoya-Burgos, J. I. &amp; Rodriguez, I. Divergent evolution among teleost V1r receptor genes. <italic>PLoS ONE</italic><bold>2</bold>, e379 (2007).</mixed-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wittbrodt</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Shima</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schartl</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Medaka: a model organism from the far East</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2002</year>
        <volume>3</volume>
        <fpage>53</fpage>
        <lpage>64</lpage>
        <?supplied-pmid 11823791?>
        <pub-id pub-id-type="pmid">11823791</pub-id>
      </element-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Iwamatsu</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Stages of normal development in the medaka <italic>Oryzias latipes</italic></article-title>
        <source>Mech. Dev.</source>
        <year>2004</year>
        <volume>121</volume>
        <fpage>605</fpage>
        <lpage>618</lpage>
        <?supplied-pmid 15210170?>
        <pub-id pub-id-type="pmid">15210170</pub-id>
      </element-citation>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Swarup</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Stages in the development of the stickleback <italic>Gasterosteus aculeatus</italic> (L.)</article-title>
        <source>J. Embryol. Exp. Morphol.</source>
        <year>1958</year>
        <volume>6</volume>
        <fpage>373</fpage>
        <lpage>383</lpage>
        <?supplied-pmid 13575650?>
        <pub-id pub-id-type="pmid">13575650</pub-id>
      </element-citation>
    </ref>
    <ref id="CR63">
      <label>63.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Houle</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Govindaraju</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Omholt</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Phenomics: the next challenge</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>855</fpage>
        <lpage>866</lpage>
        <?supplied-pmid 21085204?>
        <pub-id pub-id-type="pmid">21085204</pub-id>
      </element-citation>
    </ref>
    <ref id="CR64">
      <label>64.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brown</surname>
            <given-names>SDM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>High-throughput mouse phenomics for characterizing mammalian gene function</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>357</fpage>
        <lpage>370</lpage>
        <?supplied-pmid 29626206?>
        <pub-id pub-id-type="pmid">29626206</pub-id>
      </element-citation>
    </ref>
    <ref id="CR65">
      <label>65.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>D’Orazio</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Machine learning phenomics (MLP) combining deep learning with time-lapse-microscopy for monitoring colorectal adenocarcinoma cells gene expression and drug-response</article-title>
        <source>Sci. Rep.</source>
        <year>2022</year>
        <volume>12</volume>
        <fpage>8545</fpage>
        <?supplied-pmid 35595808?>
        <pub-id pub-id-type="pmid">35595808</pub-id>
      </element-citation>
    </ref>
    <ref id="CR66">
      <label>66.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Watson</surname>
            <given-names>CJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Phenomics-based quantification of CRISPR-induced mosaicism in zebrafish</article-title>
        <source>Cell Syst.</source>
        <year>2020</year>
        <volume>10</volume>
        <fpage>275</fpage>
        <lpage>286</lpage>
        <?supplied-pmid 32191876?>
        <pub-id pub-id-type="pmid">32191876</pub-id>
      </element-citation>
    </ref>
    <ref id="CR67">
      <label>67.</label>
      <mixed-citation publication-type="other">Nabwire, S., Suh, H. K., Kim, M. S., Baek, I. &amp; Cho, B. K. Review: application of artificial intelligence in phenomics. <italic>Sensors</italic><bold>21</bold>, 4363 (2021).</mixed-citation>
    </ref>
    <ref id="CR68">
      <label>68.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Čapek</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ünalan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Wie Tiere sich selbst konstruieren</article-title>
        <source>Biospektrum</source>
        <year>2021</year>
        <volume>27</volume>
        <fpage>473</fpage>
        <lpage>477</lpage>
      </element-citation>
    </ref>
    <ref id="CR69">
      <label>69.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Williams</surname>
            <given-names>BB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>VANGL2 regulates membrane trafficking of MMP14 to control cell polarity and migration</article-title>
        <source>J. Cell Sci.</source>
        <year>2012</year>
        <volume>125</volume>
        <fpage>2141</fpage>
        <lpage>2147</lpage>
        <?supplied-pmid 22357946?>
        <pub-id pub-id-type="pmid">22357946</pub-id>
      </element-citation>
    </ref>
    <ref id="CR70">
      <label>70.</label>
      <mixed-citation publication-type="other">Pomreinke, A. P. et al. Dynamics of BMP signaling and distribution during zebrafish dorsal–-ventral patterning. <italic>eLife</italic><bold>6</bold>, e25861 (2017).</mixed-citation>
    </ref>
    <ref id="CR71">
      <label>71.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Duda</surname>
            <given-names>RO</given-names>
          </name>
          <name>
            <surname>Hart</surname>
            <given-names>PE</given-names>
          </name>
        </person-group>
        <article-title>Use of the Hough transformation to detect lines and curves in pictures</article-title>
        <source>Communications of the ACM</source>
        <year>1972</year>
        <volume>15</volume>
        <fpage>11</fpage>
        <lpage>15</lpage>
      </element-citation>
    </ref>
    <ref id="CR72">
      <label>72.</label>
      <mixed-citation publication-type="other">Wojke, N., Bewley, A. &amp; Paulus, D. Simple online and realtime tracking with a deep association metric. In <italic>2017 IEEE International Conference on Image Processing</italic> (<italic>ICIP</italic>) 3645–3649 (2017).</mixed-citation>
    </ref>
    <ref id="CR73">
      <label>73.</label>
      <mixed-citation publication-type="other">Spelmen, V. S. &amp; Porkodi, R. A review on handling imbalanced data. In <italic>2018 International Conference on Current Trends towards Converging Technologies</italic> (<italic>ICCTCT</italic>) 1–11 (2018).</mixed-citation>
    </ref>
    <ref id="CR74">
      <label>74.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rumelhart</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Hinton</surname>
            <given-names>GE</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>RJ</given-names>
          </name>
        </person-group>
        <article-title>Learning representations by back-propagating errors</article-title>
        <source>Nature</source>
        <year>1986</year>
        <volume>323</volume>
        <fpage>533</fpage>
        <lpage>536</lpage>
      </element-citation>
    </ref>
    <ref id="CR75">
      <label>75.</label>
      <mixed-citation publication-type="other">Buslaev, A. et al. Albumentations: fast and flexible image augmentations. <italic>Information</italic><bold>11</bold>, 125 (2020).</mixed-citation>
    </ref>
    <ref id="CR76">
      <label>76.</label>
      <mixed-citation publication-type="other">Rogers, K. W., ElGamacy, M., Jordan, B. M. &amp; Müller, P. Optogenetic investigation of BMP target gene expression diversity. <italic>eLife</italic><bold>9</bold>, e58641 (2020).</mixed-citation>
    </ref>
    <ref id="CR77">
      <label>77.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schindelin</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fiji: an open-source platform for biological-image analysis</article-title>
        <source>Nat. Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>676</fpage>
        <lpage>682</lpage>
        <?supplied-pmid 22743772?>
        <pub-id pub-id-type="pmid">22743772</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
