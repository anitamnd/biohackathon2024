<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Mol Biol Evol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Mol Biol Evol</journal-id>
    <journal-id journal-id-type="publisher-id">molbev</journal-id>
    <journal-title-group>
      <journal-title>Molecular Biology and Evolution</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0737-4038</issn>
    <issn pub-type="epub">1537-1719</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
      <publisher-loc>US</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10655845</article-id>
    <article-id pub-id-type="pmid">37879113</article-id>
    <article-id pub-id-type="doi">10.1093/molbev/msad234</article-id>
    <article-id pub-id-type="publisher-id">msad234</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methods</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01130</subject>
        <subject>AcademicSubjects/SCI01180</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PhylteR: Efficient Identification of Outlier Sequences in Phylogenomic Datasets</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Comte</surname>
          <given-names>Aurore</given-names>
        </name>
        <aff><institution>French Institute of Bioinformatics (IFB)—South Green Bioinformatics Platform, Bioversity, CIRAD, INRAE, IRD</institution>, <addr-line>Montpellier</addr-line>, <country country="FR">France</country></aff>
        <aff><institution>IRD, CIRAD, INRAE, Institut Agro, PHIM Plant Health Institute, Montpellier University</institution>, <addr-line>Montpellier</addr-line>, <country country="FR">France</country></aff>
        <xref rid="msad234-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tricou</surname>
          <given-names>Théo</given-names>
        </name>
        <aff><institution>Université de Lyon, Université Lyon 1, UMR CNRS 5558 Laboratoire de Biométrie et Biologie Évolutive</institution>, <addr-line>Villeurbanne</addr-line>, <country country="FR">France</country></aff>
        <xref rid="msad234-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tannier</surname>
          <given-names>Eric</given-names>
        </name>
        <aff><institution>Université de Lyon, Université Lyon 1, UMR CNRS 5558 Laboratoire de Biométrie et Biologie Évolutive</institution>, <addr-line>Villeurbanne</addr-line>, <country country="FR">France</country></aff>
        <aff><institution>Centre de Recherches Inria de Lyon</institution>, <addr-line>Villeurbanne</addr-line>, <country country="FR">France</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Joseph</surname>
          <given-names>Julien</given-names>
        </name>
        <aff><institution>Université de Lyon, Université Lyon 1, UMR CNRS 5558 Laboratoire de Biométrie et Biologie Évolutive</institution>, <addr-line>Villeurbanne</addr-line>, <country country="FR">France</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Siberchicot</surname>
          <given-names>Aurélie</given-names>
        </name>
        <aff><institution>Université de Lyon, Université Lyon 1, UMR CNRS 5558 Laboratoire de Biométrie et Biologie Évolutive</institution>, <addr-line>Villeurbanne</addr-line>, <country country="FR">France</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-1550-5477</contrib-id>
        <name>
          <surname>Penel</surname>
          <given-names>Simon</given-names>
        </name>
        <aff><institution>Université de Lyon, Université Lyon 1, UMR CNRS 5558 Laboratoire de Biométrie et Biologie Évolutive</institution>, <addr-line>Villeurbanne</addr-line>, <country country="FR">France</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-3885-5410</contrib-id>
        <name>
          <surname>Allio</surname>
          <given-names>Rémi</given-names>
        </name>
        <aff><institution>CBGP, INRAE, CIRAD, IRD, Montpellier SupAgro, Univ. Montpellier</institution>, <addr-line>Montpellier</addr-line>, <country country="FR">France</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6501-6287</contrib-id>
        <name>
          <surname>Delsuc</surname>
          <given-names>Frédéric</given-names>
        </name>
        <aff><institution>ISEM, Univ. Montpellier, CNRS, IRD</institution>, <addr-line>Montpellier</addr-line>, <country country="FR">France</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dray</surname>
          <given-names>Stéphane</given-names>
        </name>
        <aff><institution>Université de Lyon, Université Lyon 1, UMR CNRS 5558 Laboratoire de Biométrie et Biologie Évolutive</institution>, <addr-line>Villeurbanne</addr-line>, <country country="FR">France</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-9532-5251</contrib-id>
        <name>
          <surname>de Vienne</surname>
          <given-names>Damien M</given-names>
        </name>
        <aff><institution>Université de Lyon, Université Lyon 1, UMR CNRS 5558 Laboratoire de Biométrie et Biologie Évolutive</institution>, <addr-line>Villeurbanne</addr-line>, <country country="FR">France</country></aff>
        <xref rid="msad234-cor1" ref-type="corresp"/>
        <!--damien.de-vienne@univ-lyon1.fr-->
        <xref rid="msad234-FM2" ref-type="author-notes"/>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Tamura</surname>
          <given-names>Koichiro</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <fn id="msad234-FM1">
        <p>Aurore Comte and Théo Tricou equal contribution.</p>
      </fn>
      <fn id="msad234-FM2" fn-type="COI-statement">
        <p><italic toggle="yes">Conflict of interest statement.</italic> None declared.</p>
      </fn>
      <corresp id="msad234-cor1"><bold>Corresponding author</bold>: E-mail: <email>damien.de-vienne@univ-lyon1.fr</email>.</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-10-25">
      <day>25</day>
      <month>10</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>25</day>
      <month>10</month>
      <year>2023</year>
    </pub-date>
    <volume>40</volume>
    <issue>11</issue>
    <elocation-id>msad234</elocation-id>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>2</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>29</day>
        <month>9</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>10</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press on behalf of Society for Molecular Biology and Evolution.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution-NonCommercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">https://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="msad234.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>In phylogenomics, incongruences between gene trees, resulting from both artifactual and biological reasons, can decrease the signal-to-noise ratio and complicate species tree inference. The amount of data handled today in classical phylogenomic analyses precludes manual error detection and removal. However, a simple and efficient way to automate the identification of outliers from a collection of gene trees is still missing. Here, we present PhylteR, a method that allows rapid and accurate detection of outlier sequences in phylogenomic datasets, i.e. species from individual gene trees that do not follow the general trend. PhylteR relies on DISTATIS, an extension of multidimensional scaling to 3 dimensions to compare multiple distance matrices at once. In PhylteR, these distance matrices extracted from individual gene phylogenies represent evolutionary distances between species according to each gene. On simulated datasets, we show that PhylteR identifies outliers with more sensitivity and precision than a comparable existing method. We also show that PhylteR is not sensitive to ILS-induced incongruences, which is a desirable feature. On a biological dataset of 14,463 genes for 53 species previously assembled for Carnivora phylogenomics, we show (i) that PhylteR identifies as outliers sequences that can be considered as such by other means, and (ii) that the removal of these sequences improves the concordance between the gene trees and the species tree. Thanks to the generation of numerous graphical outputs, PhylteR also allows for the rapid and easy visual characterization of the dataset at hand, thus aiding in the precise identification of errors. PhylteR is distributed as an R package on CRAN and as containerized versions (docker and singularity).</p>
    </abstract>
    <kwd-group>
      <kwd>phylogenomics</kwd>
      <kwd>outliers</kwd>
      <kwd>gene tree</kwd>
      <kwd>species tree</kwd>
      <kwd>HGT</kwd>
      <kwd>ILS</kwd>
      <kwd>duplication</kwd>
      <kwd>supermatrix</kwd>
      <kwd>supertree</kwd>
    </kwd-group>
    <counts>
      <page-count count="16"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="msad234-s0">
    <title>Introduction</title>
    <p>Supermatrix, supertree, and coalescent-based approaches are commonly used in phylogenomics to obtain a species tree from a collection of genes. These methods are similar in their first steps: for a list of taxa of interest, a large collection of single-copy orthologous gene sequences is retrieved and a multiple sequence alignment (MSA) is computed for each cluster of orthologous genes (see <xref rid="msad234-B48" ref-type="bibr">von Haeseler 2012</xref> for a comparison of these approaches). The methods then differ by the strategy employed. In the supermatrix approach, MSAs are concatenated into a supermatrix that is used to build a phylogeny, generally with Maximum Likelihood (ML) or Bayesian methods (such as IQ-TREE, <xref rid="msad234-B30" ref-type="bibr">Minh, Schmidt, et al. 2020</xref>; or Phylobayes, <xref rid="msad234-B23" ref-type="bibr">Lartillot et al. 2013</xref>). In the supertree and coalescent-based approaches, individual gene trees are built from individual MSAs, and a species tree is obtained by combining them all, e.g. with MRP (<xref rid="msad234-B7" ref-type="bibr">Baum 1992</xref>; <xref rid="msad234-B34" ref-type="bibr">Ragan 1992</xref>; <xref rid="msad234-B40" ref-type="bibr">Ronquist 1996</xref>), MP-EST (<xref rid="msad234-B25" ref-type="bibr">Liu et al. 2010</xref>), or ASTRAL (<xref rid="msad234-B51" ref-type="bibr">Zhang et al. 2018</xref>) to only cite a few.</p>
    <p>Regardless of the method employed, errors in the individual gene MSAs and errors in the individual gene trees (leading to incongruences with the species tree) can negatively impact the quality (accuracy) of the reconstructed species tree (<xref rid="msad234-B33" ref-type="bibr">Philippe et al. 2017</xref>).</p>
    <p>For MSAs, various filtering methods have been developed, categorized into two groups: methods that entirely remove sites (columns) or sequences (rows) from the alignment (trimAl, <xref rid="msad234-B10" ref-type="bibr">Capella-Gutiérrez et al. 2009</xref>; BMGE, <xref rid="msad234-B12" ref-type="bibr">Criscuolo and Gribaldo 2010</xref>), and methods that are more <italic toggle="yes">picky</italic> and allow identifying and filtering (or masking) small segments in the alignments (Divvier, <xref rid="msad234-B4" ref-type="bibr">Ali et al. 2019</xref>; HmmCleaner <xref rid="msad234-B16" ref-type="bibr">Di Franco et al. 2019</xref>; TAPER, <xref rid="msad234-B52" ref-type="bibr">Zhang et al. 2021</xref>). The latter group of methods was shown to be a better choice for alignment filtering, leading to better gene tree topologies (closer to the species tree) and more consistent terminal branch lengths in gene trees (<xref rid="msad234-B35" ref-type="bibr">Ranwez and Chantret 2020</xref>).</p>
    <p>For a collection of gene trees, filtering methods also exist, and the categorization into two groups of strategies still holds. In the first group are methods that prune rogue taxa, i.e. taxa that are unstable among gene trees (RogueNaRok, <xref rid="msad234-B3" ref-type="bibr">Aberer et al. 2013</xref>), and methods that eliminate orthologous gene families whose history is uncorrelated with the others. In the second group are more <italic toggle="yes">picky</italic> methods that identify and filter out only some species in some genes trees (i.e. Phylo-MCOA, <xref rid="msad234-B15" ref-type="bibr">de Vienne et al. 2012</xref>; or TreeShrink, <xref rid="msad234-B27" ref-type="bibr">Mai and Mirarab 2018</xref>). Just like for the alignment filtering methods seen above, <italic toggle="yes">picky</italic> approaches are thought to provide the best compromise between removing sequences with conflicting phylogenetic signals and keeping the maximum information content.</p>
    <p>Filtering (sometimes called trimming) MSAs is now done routinely in phylogenomic pipelines, with methods that can be applied automatically to large datasets (see above). But just because we apply a filter at the MSA level doesn’t mean we shouldn’t filter gene trees also. Some of the reasons that lead to incongruences between gene trees and the species tree (and among gene trees), i.e. gene tree-building errors, undetected paralogy, horizontal gene transfer (HGT), and Incomplete Lineage Sorting (ILS), may not be detectable at the MSA stage. For filtering individual gene trees, reference methods do not exist yet (<xref rid="msad234-B33" ref-type="bibr">Philippe et al. 2017</xref>). Indeed, identifying species in gene trees whose position is not concordant with their position in the other gene trees (referred to as outliers in <xref rid="msad234-B15" ref-type="bibr">de Vienne et al. 2012</xref> and hereafter) is still commonly done by eye (when it is done), which is highly questionable in terms of efficacy, objectivity, and reproducibility.</p>
    <p>Here we present PhylteR, a new phylogenomics filtering method that can accurately and rapidly identify outliers in a collection of gene trees. Unlike Phylo-MCOA (<xref rid="msad234-B15" ref-type="bibr">de Vienne et al. 2012</xref>), from which it is largely inspired, it is an iterative process where obvious outliers are removed first, leaving space for better identification of more subtle ones, and leading <italic toggle="yes">in fine</italic> to a finer identification of outliers. Unlike TreeShrink (<xref rid="msad234-B27" ref-type="bibr">Mai and Mirarab 2018</xref>), it is not based solely on the diameter of unrooted gene trees and is thus more accurate when outliers are not associated with long branches (e.g. topological incongruences). Also, PhylteR relies on the multivariate analysis method DISTATIS (<xref rid="msad234-B1" ref-type="bibr">Abdi et al. 2005</xref>, <xref rid="msad234-B2" ref-type="bibr">2012</xref>), which is specifically designed to compare distance matrices, unlike Multiple Co-inertia Analysis (MCOA, <xref rid="msad234-B11" ref-type="bibr">Chessel and Hanafi 1996</xref>) used in Phylo-MCOA (<xref rid="msad234-B15" ref-type="bibr">de Vienne et al. 2012</xref>), and is thus more appropriate for the problem at hand.</p>
    <p>We tested PhylteR on two types of datasets: simulated datasets where outliers were known, and a biological dataset comprising 14,463 genes for up to 53 species previously used for Carnivora phylogenomics (<xref rid="msad234-B5" ref-type="bibr">Allio et al. 2021</xref>). For the simulated datasets, horizontal gene transfers (HGTs) were simulated and recorded, and sequences affected by these HGTs were considered as outliers. The simulations also included various degrees of ILS, a phenomenon where within-species polymorphism lasts longer than the time between two successive speciations (<xref rid="msad234-B44" ref-type="bibr">Scornavacca and Galtier 2016</xref>), leading to incongruences between gene and species trees and among gene trees. The importance of this phenomenon as a source of incongruence in phylogenomic datasets is not clear, but because recent coalescence-based methods are able to handle ILS-induced signals explicitly (e.g. ASTRAL, <xref rid="msad234-B51" ref-type="bibr">Zhang et al. 2018</xref>), it seemed pertinent to evaluate whether PhylteR was (or not) sensitive to it. In the empirical dataset, outliers were of course unknown but “properties” associated with gene sequences could be gathered (see <xref rid="msad234-B45" ref-type="bibr">Shen et al. 2016</xref> for a list of such properties), so that enrichment of sequences having some of these properties in the list of outliers could be quantified. Finally, we looked at the effect of PhylteR on the overall concordance between the gene trees and the species tree after filtering. We compared the results with those obtained with TreeShrink (<xref rid="msad234-B27" ref-type="bibr">Mai and Mirarab 2018</xref>), the only other tool to our knowledge with a similar objective that could reasonably be applied to such a large dataset.</p>
    <p>We show that PhylteR correctly identifies species in gene trees whose phylogenetic placement is not in accordance with its placement in other gene trees, and that this holds even in the presence of incongruence among gene trees due to ILS. We also provide strong evidence that the automatic removal of outliers with PhylteR improves the concordance between gene trees and the species tree in greater proportions than TreeShrink (<xref rid="msad234-B27" ref-type="bibr">Mai and Mirarab 2018</xref>).</p>
    <p>We hope that PhylteR could become the standard that was lacking (<xref rid="msad234-B33" ref-type="bibr">Philippe et al. 2017</xref>) for cleaning datasets before species tree reconstruction in phylogenomic pipelines.</p>
  </sec>
  <sec sec-type="materials|methods" id="msad234-s1">
    <title>Materials and Methods</title>
    <sec id="msad234-s1.1">
      <title>Description of the PhylteR Method</title>
      <p>The PhylteR method, in its entirety, is depicted in <xref rid="msad234-F1" ref-type="fig">Fig. 1</xref>. It starts with <italic toggle="yes">K</italic> distance matrices obtained from <italic toggle="yes">K</italic> genes by computing pairwise distances (sum of branch lengths) between species in each gene tree. All the matrices are given the same dimensionality by filling missing data (if any) with the mean value across matrices and are then normalized by dividing each matrix by either its median or its mean value (default is median). The normalization by median prevents genes from fast- and slow-evolving orthologous genes to be erroneously considered as outliers, and appears as a better choice than a normalization by the mean as it is less affected by outlier values.</p>
      <fig position="float" id="msad234-F1" fig-type="figure">
        <label>Fig. 1.</label>
        <caption>
          <p>Principle of the PhylteR method for identifying outliers in phylogenomic datasets. The method relies on DISTATIS (gray block), an extension of multidimensional scaling to three dimensions. See text for the detail of the different steps.</p>
        </caption>
        <graphic xlink:href="msad234f1" position="float"/>
      </fig>
      <p>From the <italic toggle="yes">K</italic> matrices obtained, an incremental process starts consisting of three main steps detailed in the next sections: (i) comparison of the matrices with the DISTATIS method (<xref rid="msad234-B1" ref-type="bibr">Abdi et al. 2005</xref>, <xref rid="msad234-B2" ref-type="bibr">2012</xref>), (ii) detection of outliers sequences, and (iii) evaluation of the impact of removing these outliers on the overall concordance between the matrices. Note that we refer to <italic toggle="yes">outlier sequence</italic> as a single gene for a single species (one sequence in one alignment, or one tip in one gene tree) that does not follow the general trend (i.e. other alignments or gene trees), while <italic toggle="yes">outlier gene</italic> refers to a complete alignment (or a complete gene tree) that does not agree with the other alignments (or gene trees).</p>
      <p>These steps are repeated until no more outlier sequences are detected, or until the removal of the identified outlier sequences does not increase the concordance between the matrices more than a certain amount specified by the user. Before finishing the optimization, PhylteR performs a last action consisting of checking whether some outlier genes still exist despite the removal of outlier sequences already performed. These outlier genes correspond to single-copy orthologous genes for which the lack of correlation with others is not due to a few outlier sequences but are globally not following the trend. If outlier genes are discarded there, the optimization restarts as it may have unblocked the detection of other outliers.</p>
      <sec id="msad234-s1.1.1">
        <title>Comparison of Individual Gene Matrices With DISTATIS</title>
        <p>DISTATIS is a multivariate method designed to evaluate the concordance between <italic toggle="yes">K</italic> distance matrices (<italic toggle="yes">K</italic> orthologous genes) measured on the same <italic toggle="yes">N</italic> species. The principle of DISTATIS is depicted in <xref rid="msad234-F1" ref-type="fig">Fig. 1</xref> (gray box). The first step of DISTATIS consists of computing a matrix of RV coefficients (<xref rid="msad234-B39" ref-type="bibr">Robert and Escoufier 1976</xref>) that measures the similarities between the species pairwise distances present in each matrix. This can be seen as an extension of the correlation matrix (used in principal component analysis) that, instead of measuring the links between a set of variables, evaluates the relationships between a set of tables (gene distance matrices here). In the second step, a compromise distance matrix is built as the average of the <italic toggle="yes">K</italic> distance matrices weighted by the first eigenvector of the matrix of RV coefficients. The compromise represents the best consensus between the <italic toggle="yes">K</italic> distance matrices, as the weights used in the averaging procedure take into account the similarities between them (i.e. more similar distance matrices would have more weights in the definition of the compromise). In the third step, the compromise matrix is submitted to an eigen decomposition procedure so that species can be represented in a low-dimensional multivariate space. In this compromise space, species are positioned so that their distances (computed in few dimensions, see after) represent the best approximations of the original distances contained in the compromise matrix. We used a broken stick model (<xref rid="msad234-B6" ref-type="bibr">Barton and David 1956</xref>) to estimate the number of dimensions (axes) of the compromise space, as this simple method was shown to give a good approximation of the correct dimensionality of the data with another multivariate approach (<xref rid="msad234-B20" ref-type="bibr">Jackson 1993</xref>). Then, each individual pairwise distance matrix is projected on the compromise space. This allows us to obtain a representation of species associated with each gene family. In other words, the compromise identifies the dissimilarities between species that are common for all genes whereas the projections of individual distance matrices allow depiction of the peculiarities of each sequence. Finally, we compute the distances, in the compromise space, between the position of a species given by all genes (the compromise) and its position associated with a particular gene family (using the projection procedure) and filled a gene x species 2-Way Reference matrix (2WR matrix, see <xref rid="msad234-F1" ref-type="fig">Fig. 1</xref>) with these values.</p>
      </sec>
      <sec id="msad234-s1.1.2">
        <title>Detection of Outlier Sequences From DISTATIS Results</title>
        <p>From the 2WR matrix (see <xref rid="msad234-F1" ref-type="fig">Fig. 1</xref>), we apply the method of <xref rid="msad234-B18" ref-type="bibr">Hubert and Vandervieren (2008)</xref> to detect all values that are outliers, at the right of the univariate distribution of values. This method is an adjustment of the Tukey method (the classical boxplot) adapted to skewed distribution. In brief all values above</p>
        <disp-formula id="M0001">
          <label>(1)</label>
          <mml:math id="M1" display="block" overflow="scroll">
            <mml:mi>Q</mml:mi>
            <mml:mn>3</mml:mn>
            <mml:mo>+</mml:mo>
            <mml:mi>k</mml:mi>
            <mml:msup>
              <mml:mi>e</mml:mi>
              <mml:mrow>
                <mml:mn>3</mml:mn>
                <mml:mi>M</mml:mi>
                <mml:mi>C</mml:mi>
              </mml:mrow>
            </mml:msup>
            <mml:mrow>
              <mml:mi mathvariant="normal">IQR</mml:mi>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>are considered outliers. <italic toggle="yes">Q3</italic> is the 3rd quartile of the distribution, <italic toggle="yes">IQR</italic> is its interquartile range and <italic toggle="yes">MC</italic> is the medcouple of the distribution (<xref rid="msad234-B9" ref-type="bibr">Brys et al. 2004</xref>), a measure of skewness bounded between −1 (left skewed) and +1 (right skewed). The <italic toggle="yes">k</italic> value is chosen by the user (default is 3) and controls how stringent the detection of gene outliers is. Small values of <italic toggle="yes">k</italic> lead to more gene outliers being detected. The detection of gene outliers is performed after normalization of the 2WR matrix, achieved by dividing each row (the default) or each column by its median. This normalization leads to an exaggeration of outlier values, easing their identification.</p>
      </sec>
      <sec id="msad234-s1.1.3">
        <title>Detection of Outlier Genes</title>
        <p>When no more outlier sequences are found in the 2WR matrix, PhylteR checks whether some genes are still uncorrelated to others. These outlier genes are detected by finding outlier values in the weight array (<italic toggle="yes">α<sub>1</sub>, α<sub>2</sub>, …, α<sub>K</sub></italic>, see <xref rid="msad234-F1" ref-type="fig">Fig. 1</xref>). The outlier detection method used is the same as for the outlier sequences of the 2WR matrix (<xref rid="M0001" ref-type="disp-formula">Equation 1</xref>) but its stringency can be tuned independently (with parameter <italic toggle="yes">k2</italic> in place of parameter <italic toggle="yes">k</italic> in <xref rid="M0001" ref-type="disp-formula">Equation 1</xref>, defaulting to <italic toggle="yes">k2</italic> = <italic toggle="yes">k</italic> = 3).</p>
      </sec>
      <sec id="msad234-s1.1.4">
        <title>Exit Criteria of the PhylteR Iterative Process</title>
        <p>PhylteR is an iterative process (see <xref rid="msad234-F1" ref-type="fig">Fig. 1</xref>) with two exit points. The first one is straightforward: if no more outlier sequences are detected in the 2WR matrix, and if no more outlier genes exist (see above), then the process stops. The second one is based on the gain (Δ<italic toggle="yes"><sub>q</sub></italic>) achieved by removing outlier sequences (i.e. the change in <italic toggle="yes">q</italic>, the quality of the compromise). If this gain is below a certain threshold (10<sup>−5</sup> by default), and if no more outlier genes exist, then the process stops.</p>
      </sec>
    </sec>
    <sec id="msad234-s1.2">
      <title>Evaluation of the PhylteR Method</title>
      <sec id="msad234-s1.2.1">
        <title>Datasets</title>
        <p>We used three types of datasets to evaluate PhylteR and compare it with TreeShrink: a simple dataset used for illustrative purpose only, a collection of simulated examples obtained with the program SimPhy (<xref rid="msad234-B28" ref-type="bibr">Mallo et al. 2016</xref>), and a large Carnivora phylogenomic dataset with 53 species (<xref rid="msad234-B5" ref-type="bibr">Allio et al. 2021</xref>). These datasets are described below.</p>
        <sec id="msad234-s1.2.1.1">
          <title>Simulated Dataset for Illustrative Purpose</title>
          <p>We generated a small collection of gene trees in order to illustrate the different steps of the PhylteR process. A single phylogenetic tree with 20 species was randomly generated with function rtree() from package <italic toggle="yes">ape</italic> v5.6.2 (<xref rid="msad234-B31" ref-type="bibr">Paradis and Schliep 2019</xref>). This tree was duplicated 25 times to mimic 25 orthologous gene families. To add variance to branch lengths, a value sampled in a normal distribution with mean 0 and standard deviation <italic toggle="yes">0.15</italic> was added to each branch length of each tree (if the resulting branch length was negative its absolute value was taken). Ten outliers were then generated by randomly sampling 10 times a species in a gene tree and moving it to another random location.</p>
        </sec>
        <sec id="msad234-s1.2.1.2">
          <title>Simulated Datasets</title>
          <p>W<italic toggle="yes">e</italic> simulated collections of gene trees with known outliers in order to evaluate PhylteR and compare it with TreeSkrink. We used SimPhy (<xref rid="msad234-B28" ref-type="bibr">Mallo et al. 2016</xref>), a program that can simulate the evolution of gene families (and thus gene trees) given a species tree under various evolutionary processes including HGT but also ILS. We used, as a species tree, the 53-taxa Carnivora tree of <xref rid="msad234-B5" ref-type="bibr">Allio et al. (2021)</xref>, the same as for the biological dataset (next point). To be usable in SimPhy, we transformed the tree to ultrametric with function <italic toggle="yes">chronos</italic> in ape (<xref rid="msad234-B31" ref-type="bibr">Paradis and Schliep 2019</xref>) and we rescaled the branch lengths so that the root-to-tip distance reflected (roughly) the number of generations, i.e. 8,899,579 generations in this case. This value was obtained by dividing the age of the root of the tree (74 millions years old, [<xref rid="msad234-B22" ref-type="bibr">Kumar and Subramanian 2002</xref>]) with a rough estimate of the generation time in Carnivora (8.315 yr if taking the median of the generation times of the species studied in <xref rid="msad234-B47" ref-type="bibr">van de Kerk et al. 2013</xref>).</p>
          <p>For each replicate (100 each time), collections of 500 gene trees were simulated by setting the rate of HGT to 1e-8, the tree-wide substitution rate to 2.2e-9, and varying the level of ILS by changing the population size: 10 (NO-ILS), 100,000 (LOW-ILS), 200,000 (MODERATE-ILS), 500,000 (HIGH-ILS; the detailed commands used for Simphy are given as <xref rid="sup1" ref-type="supplementary-material">supplementary method, Supplementary Material</xref> online). Then, from the 500 trees obtained, only 100 were retained, randomly sampled among those where at most one HGT occurred (to allow unequivocal identification of outliers), and for which the transfer (if any) changed the topology of the gene tree. The whole process was repeated three times, varying the maximum number of outliers allowed per gene, between 1, 10, and 53 (theoretical max). This allowed exploring the impact of the number of outliers per gene (linked here to the age of the HGT) on the capacity to correctly identify outliers, i.e. the species that were changing position relative to the species tree because of HGT. For ILS, it was not possible to identify precisely what species should be considered outliers or not. We could only look at the impact of ILS on the mean topological distance between the collection of gene trees and the species tree (mean RF distance between 3 for NO-ILS and more than 20 for HIGH-ILS, see <xref rid="sup1" ref-type="supplementary-material">supplementary fig. S1, Supplementary Material</xref> online) and evaluate whether this had an impact or not on the precision and sensibility of our method.</p>
        </sec>
        <sec id="msad234-s1.2.1.3">
          <title>Carnivora Dataset (CD)</title>
          <p>We used the raw sequence files (before alignment and filtering) from a previously assembled phylogenomic dataset comprising 14,463 genes for 53 species aimed at resolving the phylogeny of the order Carnivora (<xref rid="msad234-B5" ref-type="bibr">Allio et al. 2021</xref>). This dataset was obtained by extracting single-copy protein-coding orthologous genes from the genomes of 52 carnivore species, plus the Malayan pangolin (<italic toggle="yes">Manis javanica</italic>) used as outgroup, following the orthology delineation strategy of the OrthoMaM database (<xref rid="msad234-B43" ref-type="bibr">Scornavacca et al. 2019</xref>). These raw sequence files were aligned and filtered using the OMM_MACSE pipeline (<xref rid="msad234-B36" ref-type="bibr">Ranwez et al. 2021</xref>), which combines (i) translated nucleotide sequence alignment at the amino acid level with MAFFT (<xref rid="msad234-B21" ref-type="bibr">Katoh and Standley 2013</xref>), (ii) nucleotide alignment refinement (based on amino acid alignment) with MACSE v2 (<xref rid="msad234-B37" ref-type="bibr">Ranwez et al. 2018</xref>) to handle frameshifts and nonhomologous sequences (<xref rid="msad234-B37" ref-type="bibr">Ranwez et al. 2018</xref>), and (iii) masking of ambiguously aligned and dubious parts of sequences with HMMcleaner (<xref rid="msad234-B16" ref-type="bibr">Di Franco et al. 2019</xref>). In the original study (<xref rid="msad234-B5" ref-type="bibr">Allio et al. 2021</xref>), this Carnivora dataset was successfully filtered using an early version of PhylteR allowing the removal of outlier sequences and genes generating abnormally long branches. Therefore, it was a good candidate dataset to test the completely redesigned and improved version of PhylteR presented here.</p>
        </sec>
      </sec>
      <sec id="msad234-s1.2.2">
        <title>Evaluation of the Accuracy of PhylteR Outlier Detection and Comparison With TreeShrink</title>
        <p>We evaluated PhylteR's ability to detect outliers that are either correct (when it is possible to test it, with simulated datasets) or meaningful according to the biological information we can gather from the dataset at hand.</p>
        <p>We used the first simulated dataset for illustration purposes only. For the other simulated datasets, i.e. for each level of ILS, for different maximum numbers of outlier species per gene (1, 10, and 53), and for each one of the 100 replicates, we ran PhylteR with default parameters and we counted the number of True Positives (TP, outliers that were simulated and that are retrieved), False Positives (FP, outliers that were not simulated but are identified) and False Negative (FN, outliers that were simulated but are not retrieved). From those, we computed the mean precision (TP/[TP + FP]) and recall (or sensitivity, TP/[TP + FN]) of the outlier identification of PhylteR. An estimate of the expected precision and recall when the same numbers of outliers were randomly sampled was also computed. To evaluate the impact of ILS-induced incongruences between gene trees on the ability of PhylteR to correctly identify outliers, precision, and recall were computed and compared between the four levels of ILS simulated (NO-ILS, LOW-ILS, MODERATE-ILS, and HIGH-ILS). Finally, for comparison purposes we performed the same analyses using TreeShrink v1.3.9 (<xref rid="msad234-B27" ref-type="bibr">Mai and Mirarab 2018</xref>) in place of PhylteR with default parameters for detecting outliers.</p>
        <p>For the Carnivora dataset, we have no access to the <italic toggle="yes">true</italic> outliers. It is thus impossible to compute precision and recall on this empirical dataset as done on the simulated ones. Instead, we can compute “features” associated with each gene sequence for each species (<italic toggle="yes">sequence</italic> hereafter), that are, a priori, associated with errors or with a lack of signal in phylogenomic datasets. We can then evaluate whether the outliers detected by PhylteR are enriched in extreme values for these features, as compared with randomly selected sequences or with outliers identified with TreeShrink. The list of features and the reason for their choice is listed below.</p>
        <sec id="msad234-s1.2.2.1">
          <title>Sequence Length</title>
          <p>Long sequences were shown to carry more phylogenetic signal than shorter ones (<xref rid="msad234-B41" ref-type="bibr">Salichos and Rokas 2013</xref>; <xref rid="msad234-B45" ref-type="bibr">Shen et al. 2016</xref>). To explore the possible enrichment of outliers in short sequences, we computed the length (in bp) of each sequence in each gene MSA, and explored its distribution in outliers.</p>
        </sec>
        <sec id="msad234-s1.2.2.2">
          <title>Duplication Score</title>
          <p>When a sequence in a gene tree is not orthologous to the others but is a paralog, its localization in the gene tree is likely to be incorrect. To have an insight into the level of “paralogousness” of each sequence in the Carnivora dataset, we compared the Carnivora species tree published by <xref rid="msad234-B5" ref-type="bibr">Allio et al. (2021)</xref> with each one of the 14,463 gene trees using the reconciliation program <italic toggle="yes">ALEml_undated</italic> (<xref rid="msad234-B46" ref-type="bibr">Szöllősi et al. 2015</xref>). This tool allows inferring the duplications, losses, and transfers experienced by a gene by comparing its history (the gene tree) with that of the species (the species tree). Here we inferred only duplications and losses (transfer rate was forced to be 0), we forced the origination of each gene at the root of the species tree (parameter O_R = 10,000) and we used default values for all other parameters. We then computed the number of duplications inferred from the root to each tip of each gene tree and normalized this value by the number of nodes encountered. This value represents the normalized number of duplications experienced by each sequence, whose distribution in outliers could be evaluated.</p>
        </sec>
        <sec id="msad234-s1.2.2.3">
          <title>Hidden Paralogy, the KRAB Zinc Finger Protein Family Case</title>
          <p>The KRAB Zinc Finger (KZNF) super-family is actively duplicating in vertebrates with hundreds of paralogs per genome (<xref rid="msad234-B19" ref-type="bibr">Huntley et al. 2006</xref>; <xref rid="msad234-B24" ref-type="bibr">Liu et al. 2014</xref>). Thus, the orthologous relationships between these proteins are expected to be hard to retrieve and the reconstructed orthologous gene families are likely to contain hidden-paralogs. If an outlier detection method is indeed able to remove hidden paralogs, we should see an enrichment of KZNF genes in the list of outliers.</p>
        </sec>
        <sec id="msad234-s1.2.2.4">
          <title>Synteny</title>
          <p>Synteny (in our sense) is the link between two genes occurring consecutively on a genome, i.e. without any other gene (in the dataset) located between them. One gene then has 2 synteny linkages. A synteny <italic toggle="yes">break</italic> occurs when 2 genes are consecutive in one species but their orthologs in another species are not. The direction of transcription (coding strand) is considered, i.e. if it has changed it is considered as a break even if the genes appear in the same order. One gene, compared to its ortholog in another species, may then be associated with 0, 1, or 2 breaks. We call genes associated with 2 breaks <italic toggle="yes">syntenic outliers</italic>. We test if outliers found by PhylteR are more often syntenic outliers than randomly sampled genes. Our rationale behind this question is that synteny breaks are due to genomic rearrangements (inversions, duplications, translocations, …), but can occur in the data, and in much larger proportion, for many artifactual reasons: annotation errors, assembly errors, or orthology assessment errors. These different sources of errors are expected to lead to phylogenetic placement errors for the species carrying the affected genes. We thus formulate the hypothesis that outlier genes may be more often associated with synteny breaks than randomly sampled genes. To evaluate this, we focused on 14 Carnivora genomes (<xref rid="sup1" ref-type="supplementary-material">supplementary table S1, Supplementary Material</xref> online) that we compared in a pairwise manner. For each pair, we compared the list of syntenic outliers with the list of outliers retrieved by each outlier method tested, and we computed the <italic toggle="yes">P</italic>-value associated with the observed size of the intersection under the hypothesis that the two sets of outliers are independent.</p>
          <p>In order to compare the distributions of values for the different features listed above between outlier detection methods, we needed lists of outliers of comparable size. The number of outliers retrieved with default parameters being very different with the two methods using default parameters (7,183 with PhylteR vs. 19,643 with TreeShrink, see <xref rid="msad234-T1" ref-type="table">Table 1</xref>), we created two collections of outliers, a <bold>small</bold> and a <bold>large</bold> one (<xref rid="msad234-T1" ref-type="table">Table 1</xref>). For the <bold>small</bold> collection, we selected a value for the parameter <italic toggle="yes">q</italic> in TreeShrink in order to get a number of outliers as close as possible to the number of outliers obtained with PhylteR default parameters. This was achieved for <italic toggle="yes">q</italic> = 0.012, leading to 7,032 outliers. For the <bold>large</bold> collection, we selected a value of the <italic toggle="yes">k</italic> (and <italic toggle="yes">k</italic> = <italic toggle="yes">k2</italic>) parameter in PhylteR leading to a number of outliers as close as possible to the number of outliers detected with TreeShrink default parameters. This was achieved for <italic toggle="yes">k</italic> = 1.55, leading to 20,157 outliers. Parameters used and number of outliers in each collection and with each outlier detection method are presented in <xref rid="msad234-T1" ref-type="table">Table 1</xref>.</p>
          <table-wrap position="float" id="msad234-T1">
            <label>Table 1</label>
            <caption>
              <p>Collections of outliers used to evaluate PhylteR and compare it to TreeShrink</p>
            </caption>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col align="left" valign="top" span="1"/>
                <col align="left" valign="top" span="1"/>
                <col align="left" valign="top" span="1"/>
                <col align="left" valign="top" span="1"/>
                <col align="left" valign="top" span="1"/>
                <col align="left" valign="top" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <th align="left" rowspan="2" colspan="1">Collections</th>
                  <th align="center" colspan="2" rowspan="1">PhylteR</th>
                  <th align="center" colspan="2" rowspan="1">TreeShrink</th>
                  <th align="center" rowspan="1" colspan="1">Random</th>
                </tr>
                <tr>
                  <th align="left" rowspan="1" colspan="1">Parameters</th>
                  <th align="center" rowspan="1" colspan="1"># outliers</th>
                  <th align="center" rowspan="1" colspan="1">Parameters</th>
                  <th align="center" rowspan="1" colspan="1"># outliers</th>
                  <th align="center" rowspan="1" colspan="1"># outliers</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td rowspan="1" colspan="1">
                    <bold>Small</bold>
                  </td>
                  <td rowspan="1" colspan="1">
                    <italic toggle="yes">default</italic>
                  </td>
                  <td rowspan="1" colspan="1">7,183</td>
                  <td rowspan="1" colspan="1"><italic toggle="yes">q</italic> = 0.012</td>
                  <td rowspan="1" colspan="1">7,032</td>
                  <td rowspan="1" colspan="1">7,183</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <bold>Large</bold>
                  </td>
                  <td rowspan="1" colspan="1"><italic toggle="yes">k</italic> = <italic toggle="yes">k</italic>2 = 1.55</td>
                  <td rowspan="1" colspan="1">20,157</td>
                  <td rowspan="1" colspan="1">
                    <italic toggle="yes">default</italic>
                  </td>
                  <td rowspan="1" colspan="1">19,643</td>
                  <td rowspan="1" colspan="1">20,157</td>
                </tr>
              </tbody>
            </table>
            <table-wrap-foot>
              <fn id="tblfn1">
                <p>The <bold>small</bold> collection is obtained by tuning the TreeShrink parameters in order to obtain roughly the same number of outliers as with the default parameters of PhylteR. The <bold>large</bold> collection is obtained in the opposite way.</p>
              </fn>
            </table-wrap-foot>
          </table-wrap>
        </sec>
      </sec>
      <sec id="msad234-s1.2.3">
        <title>Evaluation of the Impact of Outlier Sequences Removal on Species Tree Support</title>
        <p>It is expected that a tool that accurately removes outliers in phylogenomic datasets should increase the concordance between the gene trees and the species tree. To evaluate this and compare PhylteR with randomly sampled sequences and with TreeShrink-identified outliers, we computed the gene concordance factor (gCF, <xref rid="msad234-B29" ref-type="bibr">Minh, Hahn, et al. 2020</xref>) as implemented in IQ-TREE version 2.1.3 (<xref rid="msad234-B30" ref-type="bibr">Minh, Schmidt, et al. 2020</xref>) for every branch in the Carnivora species tree (obtained from <xref rid="msad234-B5" ref-type="bibr">Allio et al. 2021</xref>). For each branch of the species tree, this factor indicates the percentage of gene trees in which this branch is found (among gene trees where this can be computed, or “decisive” trees, see <xref rid="msad234-B29" ref-type="bibr">Minh, Hahn, et al. 2020</xref>). gCF was computed according to either the original gene trees (gCF<sub>init</sub>), or to a list of gene trees obtained after pruning outliers (4 sets of gene trees corresponding to the four list of outliers in <xref rid="msad234-T1" ref-type="table">Table 1</xref>).</p>
        <p>In order to see the effect of outliers removal on the concordance factor, we computed the difference (ΔgCF) between gCF<sub>init</sub> and every other gCF, separating the small and the large collections of outliers. Positive values of ΔgCF indicate that a branch is more supported after filtering than before. Comparing ΔgCF between PhylteR and TreeShrink gives an indication of whether, for the same total number of outliers removed, PhylteR performs better than TreeShrink at identifying sequences with conflicting phylogenetic signals and increasing the concordance between the species tree and the gene trees.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="results" id="msad234-s2">
    <title>Results</title>
    <sec id="msad234-s2.1">
      <title>Illustration of the General Principle of PhylteR</title>
      <p>The different steps of the PhylteR process (<xref rid="msad234-F1" ref-type="fig">Fig. 1</xref>) are illustrated on a simple example dataset comprising 25 genes for 20 species, with 10 outliers. The main steps are as follows. Individual gene trees are transformed into individual gene matrices that are then combined into a unique <italic toggle="yes">compromise</italic> matrix obtained after weighting each matrix by its concordance with the others: matrices that are poorly correlated with the others have less weight in the creation of the compromise (<xref rid="sup1" ref-type="supplementary-material">supplementary fig. S3A-E, Supplementary Material</xref> online). This matrix is then projected onto a space on which individual matrices are projected as well (<xref rid="msad234-F2" ref-type="fig">Fig. 2A</xref> and <xref rid="sup1" ref-type="supplementary-material">supplementary fig. S3F, Supplementary Material</xref> online). By computing the distance of each species in each orthologous gene to its reference position in this projection, the 2WR is obtained (<xref rid="msad234-F2" ref-type="fig">Fig. 2B</xref> and <xref rid="sup1" ref-type="supplementary-material">supplementary fig. S3G, Supplementary Material</xref> online). It is from this matrix that outlier sequences can be identified and removed.</p>
      <fig position="float" id="msad234-F2" fig-type="figure">
        <label>Fig. 2.</label>
        <caption>
          <p>Two objects of the PhylteR process. a) The compromise matrix is projected into a multidimensional space (the 2 first axes only are represented here). This gives the reference position of each species relative to each other (blue badges with species names on them). Individual gene matrices are projected on the same space (small dots) and the distance between each gene in each species to its reference position is represented by a line. The red line and the red arrow identify species t3 in gene 5. This projection is transformed into a 2D matrix <bold>b)</bold> by computing the distance between each species in each gene to its reference position (i.e. the length of each line in a). The gene × species matrix obtained, which we refer to as the2WR is used to detect outliers like the one indicated by thered arrow, corresponding to the red arrow in a.</p>
        </caption>
        <graphic xlink:href="msad234f2" position="float"/>
      </fig>
    </sec>
    <sec id="msad234-s2.2">
      <title>PhylteR Performs Well on Simulated Examples and is Robust to ILS-induced Incongruences</title>
      <p>To evaluate the precision and sensitivity of PhylteR, we used it on four simulated datasets with increasing levels of ILS (NO-ILS, LOW-ILS, MODERATE-ILS, and HIGH-ILS). We also computed precision and recall on the same datasets using another method, TreeShrink (<xref rid="msad234-B27" ref-type="bibr">Mai and Mirarab 2018</xref>). Finally, we computed the expected precision and sensitivity if the same number of sequences identified as outliers by PhylteR and TreeShrink were randomly selected from all sequences.</p>
      <p>The outliers that we considered were single species whose position was moved to a new location in some gene trees because of HGTs. For this type of outliers, we observe that PhylteR performs well, with precision and recall being close to their maximum value 1 (<xref rid="msad234-F3" ref-type="fig">Fig. 3</xref>). On the other hand, TreeShrink performs badly, identifying few correct outliers (leading to a mean precision close to 0), but still detecting a large collection of FP (leading to a low sensitivity). When increasing the maximum number of outlier species in each gene tree to 10 (<xref rid="sup1" ref-type="supplementary-material">supplementary fig. S2A, Supplementary Material</xref> online) or to 53 (<xref rid="sup1" ref-type="supplementary-material">supplementary fig. S2B, Supplementary Material</xref> online), we observe that both the precision and sensitivity of PhylteR slightly decrease while the ones of TreeShrink increase, but the difference between both remains in the clear advantage of PhylteR (in this specific setting).</p>
      <fig position="float" id="msad234-F3" fig-type="figure">
        <label>Fig. 3.</label>
        <caption>
          <p>Comparison of the precision and recall (or sensitivity) of the PhylteR and the TreeShrink outlier detection methods for four conditions of ILS.</p>
        </caption>
        <graphic xlink:href="msad234f3" position="float"/>
      </fig>
      <p>Of note, the level of ILS has almost no effect on the precision and sensitivity of the PhylteR (and TreeShrink, even though a negative effect would be hard to see when starting from such low precision and sensitivity values), except when reaching very high ILS (bottom-right panels in <xref rid="msad234-F3" ref-type="fig">Fig. 3</xref> and <xref rid="sup1" ref-type="supplementary-material">supplementary fig. S2A and S2B, Supplementary Material</xref> online). In other words, even when the mean topological distance between the gene trees and the species tree is multiplied by more than 5, as is the case between the NO-ILS and the MODERATE-ILS conditions (<xref rid="sup1" ref-type="supplementary-material">supplementary fig. S1, Supplementary Material</xref> online), the precision and sensitivity of PhylteR for detecting the outliers simulated by HGTs do not decrease. This suggests that PhylteR does not consider species that have changed position in some gene trees due to ILS as outliers. This apparent robustness of PhylteR to ILS can be seen as a desirable feature, e.g. when using species tree reconstruction tools that explicitly handle ILS such as ASTRAL (<xref rid="msad234-B51" ref-type="bibr">Zhang et al. 2018</xref>).</p>
    </sec>
    <sec id="msad234-s2.3">
      <title>Characterization of Outliers Detected With PhylteR on the Carnivora Dataset</title>
      <p>Outliers in phylogenomic datasets can be of different nature: fast or slow evolving genes in some species, leading to respectively long or short branches in gene trees, or species being placed in aberrant position in some genes because of HGT, hidden paralogy, saturated signal, compositional bias, long-branch attraction, or other artifactual reasons (<xref rid="msad234-B42" ref-type="bibr">Schrempf and Szöllősi 2020</xref>).</p>
      <p>In the set of 14,463 gene trees analysed by PhylteR, two sets of outliers (7,183 and 20,157 sequences) were identified with PhylteR (with default or tuned parameters, respectively) and 7,032 and 19,643 with TreeShrink (with tuned and default parameters respectively, see <xref rid="msad234-T1" ref-type="table">Table 1</xref>). A simple comparison of the list of outliers of similar sizes revealed that the overlap between the two lists of outliers was quite small (around 20%, <xref rid="msad234-F4" ref-type="fig">Fig. 4</xref>). This corresponds to about 70% of the outliers detected by PhylteR being absent from the list of outliers detected by TreeShrink, and vice versa. This reveals fundamental differences between the 2 approaches.</p>
      <fig position="float" id="msad234-F4" fig-type="figure">
        <label>Fig. 4.</label>
        <caption>
          <p>Comparison of the sets of outliers detected by PhylteR (left column) and TreeShrink (write column) on the Carnivora dataset. The two collections of outliers (small and large) correspond to different stringency for the detection of outliers (see <xref rid="msad234-T1" ref-type="table">Table 1</xref>).</p>
        </caption>
        <graphic xlink:href="msad234f4" position="float"/>
      </fig>
      <p>To better understand what differs between the outliers detected by PhylteR and those detected by TreeShrink, we compared the distribution values of different features describing these outlier sequences.</p>
      <p>First, we observed a significant decrease in sequence length in outlier sequences for both PhylteR and TreeShrink as compared to randomly sampled sequences (<italic toggle="yes">P</italic> &lt; 2.2e-16 in both cases and for both collections of outliers, <xref rid="msad234-F5" ref-type="fig">Fig. 5A</xref>). Sequence lengths were higher in PhylteR outliers than in TreeShrink outliers for the small collection of outliers (<italic toggle="yes">P</italic> &lt; 2.2e-16) but the opposite was observed for the large collection of outliers (<italic toggle="yes">P</italic> &lt; 3.17e-14). The fact that outliers are enriched in short sequences is thought to be due to the expected correlation between the size of a sequence and the phylogenetic signal it carries. Shorter sequences are more prone to misplacement in phylogenetic trees.</p>
      <fig position="float" id="msad234-F5" fig-type="figure">
        <label>Fig. 5.</label>
        <caption>
          <p>Comparison of distribution values between outliers detected by PhylteR, by TreeShrink, or randomly sampled, for three features associated with outlierness in phylogenomic datasets. a) Distribution of the length (in bp) of the sequence outliers identified by each method. A log scale is used for the y-axis. b) Distribution of duplication scores (normalized number of duplications experienced by each sequence) for the outliers identified by each method. c) Proportion of outliers being members of the KRAB-ZNF protein family for the outliers identified by each method. The two collections of outliers (small and large) are compared in each case (left and right on each panel).</p>
        </caption>
        <graphic xlink:href="msad234f5" position="float"/>
      </fig>
      <p>Second, we compared the distribution of duplication scores in the list of outliers produced by PhylteR and TreeShrink (<xref rid="msad234-F5" ref-type="fig">Fig. 5B</xref>). We observed a clear difference, for both the small and the large collections of outliers between PhylteR outliers and random outliers, but also between PhylteR outliers and TreeShrink outliers: outliers identified by PhylteR are significantly enriched in sequences that display a higher number of duplications as compared to random or TreeShrink outliers (<italic toggle="yes">P</italic> &lt; 2.2e-16 for all comparisons).</p>
      <p>This result is in accordance with the results obtained on simulated datasets: PhylteR is good (and much better than TreeShrink) at identifying misplaced species in some gene trees, which is indirectly what the duplication score captures.</p>
      <p>One illustration of the difference between PhylteR and TreeShrink in their ability to capture duplicated sequences (and thus probably hidden paralogues) can be given by the study of peculiar proteins, such as the Zinc-finger family (ZNF). This large family of paralogs first duplicated from the gene PRDM9 or PRDM7 in the ancestor of vertebrates (<xref rid="msad234-B17" ref-type="bibr">Emerson and Thomas 2009</xref>). These genes are involved in the repression of transposable elements and are still actively duplicating. The high number of duplications renders the resolution of the orthology relationship in this gene super-family very challenging. In the Carnivora dataset, the ZNF super-family has been splitted in 168 orthologous gene families (<xref rid="msad234-B5" ref-type="bibr">Allio et al. 2021</xref>). As expected in case of hidden paralogy, we see an overrepresentation of the genes belonging to these families in the list of outliers, especially in the outliers identified by PhylteR (<xref rid="msad234-F5" ref-type="fig">Fig. 5C</xref>). Between 3.79% (for the large set) and 7.4% (for the small set) of PhylteR outliers belong to the ZNF family, while these values drop to 1.78% and 1.12%, respectively for TreeShrink outliers, and less than 1% for randomly selected sequences (<xref rid="msad234-F5" ref-type="fig">Fig. 5C</xref>).</p>
      <p>Third, we compared two by two 14 Carnivora species and identified syntenic outliers (see material and methods). In almost all pairwise comparisons, we found that these syntenic outliers significantly overlap the outlier sequences detected by PhylteR. For example, in the comparison between <italic toggle="yes">Zalophus californianus</italic> and <italic toggle="yes">Suricata suricatta</italic> (illustrated in <xref rid="msad234-F6" ref-type="fig">Fig. 6</xref>), out of the 5,123 genes common to both species in the dataset, 131 (2.56%) are syntenic outliers (i.e. surrounded by 2 breaks). In comparison, out of the 47 outlier sequences identified by PhylteR (small list) in either <italic toggle="yes">Zalophus californianus</italic> or <italic toggle="yes">Suricata suricatta</italic>, 38 are syntenic outliers (80.8%), which is significantly more than expected by chance (<italic toggle="yes">P</italic>-value = 1.5e-43). With TreeShrink (small list) for the same pair of species, only 18.1% (17 out of 94) outlier sequences are syntenic outliers, which is much less than with PhylteR but is still significantly different from what is expected by chance (<italic toggle="yes">P</italic>-value = 1.36e-10). Similar results were obtained for most of the other pairs of species compared (<xref rid="sup1" ref-type="supplementary-material">supplementary fig. S4, Supplementary Material</xref> online and <xref rid="sup1" ref-type="supplementary-material">supplementary tables S2 and S3, Supplementary Material</xref> online).</p>
      <fig position="float" id="msad234-F6" fig-type="figure">
        <label>Fig. 6.</label>
        <caption>
          <p>Illustration of the nonsyntenic nature of many outliers identified by PhylteR. We represent the comparison of <italic toggle="yes">Zalophus californianus</italic> with <italic toggle="yes">Suricata suricatta</italic> genomes, with <italic toggle="yes">Zalophus</italic> as a reference (arbitrarily, most other pairs of species give similar results). On each circle, a reference <italic toggle="yes">Zalophus</italic> scaffold is represented in dark blue, and all scaffolds for which at least one gene has an ortholog in this scaffold are in light gray. Lines between these scaffolds represent couples of genes annotated as orthologous. Red lines highlight gene outliers detected in <italic toggle="yes">Suricata suricatta</italic>. We observe that they are very often “isolated” genes, i.e. syntenic outliers. These genes are thus probably erroneously annotated, erroneously assembled, and their orthology is likely erroneous.</p>
        </caption>
        <graphic xlink:href="msad234f6" position="float"/>
      </fig>
    </sec>
    <sec id="msad234-s2.4">
      <title>Impact of Filtering Outliers on Species Tree Support</title>
      <p>The gCF is a measure, for a species tree, of how much each one of its branches is supported according to a collection of individual gene trees. A value of 100% means that 100% of the gene trees for which the comparison could be done (“decisive” gene trees in <xref rid="msad234-B29" ref-type="bibr">Minh, Hahn, et al. 2020</xref>) contain this branch.</p>
      <p>Nonrandom outlier removal processes are expected to increase gCF scores by discarding sequences representing species in gene trees whose position is not in accordance with their placement in the other gene trees. We looked at the difference in gCF score before and after pruning outliers (ΔgCF) for each branch of the Carnivora species tree. For both PhylteR and TreeShrink, an increase in gene concordance was observed. It was higher with PhylteR than with TreeShrink, indicating a better identification of misplaced species in gene trees for PhylteR. The effect was larger when more outliers were removed (<xref rid="msad234-F7" ref-type="fig">Fig. 7</xref>, right), the gain in gCF reaching more than 6% for some branches with PhylteR outliers removal (max 5% for TreeShrink). We observed that the gain in concordance was higher for branches that initially had a high gCF, and smaller for poorly supported nodes (plain dots vs. circles in <xref rid="msad234-F7" ref-type="fig">Fig. 7</xref>). This may be due to an easier identification of outliers on a “clean” background (many gene trees supporting the same node, leading to high gCF) than on a more noisy one.</p>
      <fig position="float" id="msad234-F7" fig-type="figure">
        <label>Fig. 7.</label>
        <caption>
          <p>Effect of filtering outliers in gene trees on the gCF of each branch of the Carnivora species tree. The gain in concordance (ΔgCF, y-axis) is plotted for each branch of the species tree (dots), separating PhylteR (pink) and TreeShrink (blue). Branches are ordered by increasing ΔgCF for the PhylteR outliers. The results for the two collections of outliers (small and large) are displayed side by side.</p>
        </caption>
        <graphic xlink:href="msad234f7" position="float"/>
      </fig>
      <p>Note that gCF, which captures topological differences between the gene trees and the species tree, exhibits a notable increase but does not attain its maximum value. This observation might be indicative of some of the incongruences between gene and species trees within the Carnivora dataset to be attributed to ILS. These potential ILS-related incongruences appear not to be identified as outliers by PhylteR, as suggested by the results of our simulations (see above).</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="msad234-s3">
    <title>Discussion</title>
    <p>In phylogenomics, incongruence between gene trees, resulting from a myriad of possible technical and analytical issues, or from biological processes, is known to lead to errors in species tree inference (<xref rid="msad234-B33" ref-type="bibr">Philippe et al. 2017</xref>). A common practice in phylogenomics thus consists of scanning individual gene trees by eye, trying to spot species or group of species weirdly placed in gene trees, suspicious long branches, apparent groups of paralogues, etc., and discarding them before the concatenation of the genes (supermatrix approach) or to the assembly of the gene trees into a species tree (supertree and coalescent-based approaches). This hard work is not only time-consuming and laborious, it is also questionable: what is the objectivity in this practice? Is the eye (and the brain) capable of looking at tens of thousands of gene trees at the same time? How reproducible is such a practice? etc.</p>
    <p>Here, with PhylteR, we propose a way of analyzing large collections of gene trees by using an automatic method that can simultaneously analyse a large collection of distance matrices (retrieved from gene trees), identify the common signal between these matrices, and identify elements (outliers) in some of these matrices that are responsible for a decrease in concordance. By using a process where these outliers are automatically and iteratively removed, we propose a new way of efficiently identifying them.</p>
    <p>Evaluating a method for its capacity to accurately identify errors in phylogenomics datasets is a difficult task. As for any inference method, we use simulations. However, simulating the processes that result in errors (in our case, outliers in phylogenomics data) has no standard solution: sources of errors are numerous, and they combine with each other through all phylogenomic pipelines, sometimes with unpredictable results. So we restricted ourselves to simulating a feature intrinsically detectable by PhylteR, that is, changes in the phylogenetic placements of some species in some gene trees. Further evaluation would involve an independent simulation pipeline, not informed by the hypothesis behind the inference method (<xref rid="msad234-B8" ref-type="bibr">Biller et al. 2016</xref>), which is by definition outside the scope of the description of the inference method. The simple simulations we performed revealed that outliers corresponding to misplacement of species in a few gene trees were easy to detect with PhylteR but not with TreeShrink. However, this is not surprising <italic toggle="yes">a posteriori</italic>: TreeShrink (<xref rid="msad234-B27" ref-type="bibr">Mai and Mirarab 2018</xref>) is designed to detect abnormally long branches in collection of gene trees, while we considered here as outliers species that changed position in some gene trees because of HGTs; these outliers are not necessarily associated with longer branches.</p>
    <p>A better way to examine the advantages of a method over another is to explore biological data. To this end, we evaluated PhylteR and compared it with TreeShrink by looking at some properties associated with gene sequences and testing possible enrichment of these properties in the list of detected outliers. We observed an enrichment of short sequences, which was anticipated (short sequences carry less phylogenetic signal) and confirmed previous results (<xref rid="msad234-B45" ref-type="bibr">Shen et al. 2016</xref>).</p>
    <p>A notable difference that we observed between PhylteR and TreeShrink, confirming the results obtained on the simple simulated examples, is the duplication score computed here: outliers identified with PhylteR seemed to be highly enriched in gene sequences having experienced more duplications, according to the reconciliation analysis performed. Note, however, that we need to be cautious with this measure: being based solely on a topological comparison between gene and species trees, it cannot distinguish between true paralogy, and other processes (biological or artefactual) leading to a species in a gene tree to have a position that is not concordant with its position in the other gene trees. HGT for instance, may lead to high duplication scores according to our approach when none occurred (even though HGT is thought to be anecdotal in the Carnivora dataset). Similarly, artefactual reasons such as long branch attraction, annotation error or alignment error can lead to misplacements of species in some gene trees.</p>
    <p>A more direct way of testing the ability of PhylteR to detect hidden paralogous sequences was to focus on a specific gene family known to be extremely diverse because of multiple duplication events, the KZNF family (<xref rid="msad234-B19" ref-type="bibr">Huntley et al. 2006</xref>; <xref rid="msad234-B24" ref-type="bibr">Liu et al. 2014</xref>). We observed a clear enrichment of sequences belonging to this peculiar family in the list of outlier sequences identified by PhylteR, as compared to those identified by TreeShrink or randomly sampled. This capacity of PhylteR to identify putative paralogs is an important feature, as it was shown earlier that nonorthologous sequences in phylogenomic datasets could have a drastic impact on results (<xref rid="msad234-B33" ref-type="bibr">Philippe et al. 2017</xref>), leading for instance to erroneous branching with high support in the reconstructed species tree in some cases (<xref rid="msad234-B32" ref-type="bibr">Philippe et al. 2011</xref>).</p>
    <p>A final test that we used to validate PhylteR consisted of exploring the syntenic nature (and lack thereof) of the sequences identified as outliers when comparing the species in a pairwise manner. We observed that outlier sequences were often (much more than expected by chance) syntenic-outliers, i.e. sequences associated with a loss of synteny when comparing the two genomes. This provides two kinds of information: on one side, that the “syntenic outliers” and the “phylogenetic outliers” largely overlap, which proves with an argument orthogonal to all the previous ones, that PhylteR (and TreeShrink to a lesser extent) captures an information about erroneous annotations; on the other side, it suggests that many “syntenic outliers” are due to errors and not to biological processes. “Syntenic outliers” are often filtered out before performing rearrangement analyses, because their position is believed to be artefactual (<xref rid="msad234-B26" ref-type="bibr">Lucas and Crollius 2017</xref>). However, sometimes this outlier position is modeled as the result of a biological process (<xref rid="msad234-B13" ref-type="bibr">Dalevi and Eriksen 2008</xref>). Our analysis supports this artifactual origin in Carnivora, though some syntenic outliers might originate from retrotranscription or translocations.</p>
    <p>ILS is a known source of incongruence among gene trees and between gene trees and the species tree. This biological process, where ancestral polymorphism is maintained across various speciation events, leads to different portions of the genomes having different evolutionary histories. With simulations we could vary the level of ILS in the datasets and evaluate the impact it had on the ability of PhyleR (and TreeShrink) to correctly identify outliers. For both methods, we saw no effect of increasing the level of ILS on the precision and sensitivity values. For TreeShrink, it is hard to conclude anything, because the initial values were very low (close to 0) so any negative effect would have been undetectable. For PhylteR however, where precision and sensitivity were high, this absence of effect reveals that PhylteR does not detect sequences that have experienced ILS as outliers. Whether this is positive or negative can be discussed. On the one hand, it was shown earlier that ILS-related incongruences among gene trees could have a detrimental effect on species tree reconstruction with supermatrix approaches (<xref rid="msad234-B14" ref-type="bibr">Degnan and Rosenberg 2006</xref>). On the other hand, ILS-induced incongruence is a true biological signal that many species tree inference methods, namely the coalescence-based ones, can now handle (<xref rid="msad234-B25" ref-type="bibr">Liu et al. 2010</xref>; <xref rid="msad234-B51" ref-type="bibr">Zhang et al. 2018</xref>). In this context, getting rid of these incongruences may be seen as detrimental, because it removes a meaningful signal that can be accommodated by these methods. However, the real contribution of ILS to gene tree incongruences is something that is rarely measured, but in mammals, for instance, it was shown to be rare (<xref rid="msad234-B44" ref-type="bibr">Scornavacca and Galtier 2016</xref>). We can advance two reasons why PhylteR is not sensitive to ILS. First, ILS preferentially affects short branches of the species tree, i.e. speciation events separated by a short amount of time, which leads to a limited effect in the pairwise distance matrices manipulated by PhylteR. Second, when ILS changes the branching pattern of three clades (or species), it is expected that around 50% of each alternative topology to the true one is observed across all gene trees. When the “compromise” matrix is built in the PhylteR pipeline, this signal will thus likely be averaged out.</p>
    <p>Here we focused on the identification of outliers in collection of gene trees in order to remove them before phylogenetic inference with supermatrix, supertree, or coalescent-based methods. But other usage of the tool we present here can be anticipated. First, because the PhylteR method consists of comparing matrices (in this case phylogenetic distance matrices), it is easy to imagine applying the method without computing gene trees, directly on matrices extracted from multiple sequence alignments (MSA), one matrix per gene. In this sense, comparing PhylteR with MSA-based filtering tools could be a worthwhile follow-up of this work. Second, correctly identifying and removing outliers from phylogenomic datasets could be of interest beyond species tree reconstruction. For instance, it appears to be crucial when using statistical methods based on the ratio of nonsynonymous over synonymous substitution rates (<italic toggle="yes">d<sub>N</sub>/d<sub>S</sub></italic> ratio) to detect adaptive molecular evolution (see <xref rid="msad234-B49" ref-type="bibr">Yang and Bielawski 2000</xref> for a review), or for correctly inferring ancestral sequences (<xref rid="msad234-B50" ref-type="bibr">Yang et al. 1995</xref>) from sequences of extant species. Finally, using a tool like PhylteR is not only useful for cleaning the data. The in-depth exploration of the outliers detected and the study of the reasons why they were detected as such can give important insights into the evolutionary history of these sequences, for instance allowing for the identification of horizontally transferred or duplicated genes.</p>
  </sec>
  <sec id="msad234-s4">
    <title>Conclusion</title>
    <p>We created PhylteR, a tool to explore phylogenomics dataset and detect outlier gene sequences. Instead of fully removing rogue taxa or full outlier gene family, PhylteR precisely identifies what sequences in what gene family should be removed to increase concordance between genes. In doing so it accurately spots gene sequences with low phylogenetic signal, genes with saturated signal leading to long branches, paralogous genes, genes associated with synteny breaks, and other sequences that are dubious in gene phylogenies for any possible reason.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>msad234_Supplementary_Data</label>
      <media xlink:href="msad234_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgments</title>
    <p>Work was funded by ANR Grant 18-CE02-0007 (Sthoriz) to DMDV, ANR Grant 19-CE45-0010 (Evoluthon) to ET, and European Research Council grant ERC-2015-CoG-683257 (ConvergeAnt project) to FD. This is contribution ISEM 2023-255 of the Institut des Sciences de l’Evolution de Montpellier. We thank Mélodie Bastian for help with the simulations and two anonymous reviewers for helpful comments.</p>
  </ack>
  <sec id="msad234-s5">
    <title>Supplementary Material</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary material</xref> is available at <italic toggle="yes">Molecular Biology and Evolution</italic> online.</p>
  </sec>
  <sec sec-type="data-availability" id="msad234-s6">
    <title>Data Availability</title>
    <p>The documented code of PhylteR is available at <ext-link xlink:href="https://github.com/damiendevienne/phylter" ext-link-type="uri">https://github.com/damiendevienne/phylter</ext-link> along with thorough documentation. All data and scripts used in this study are available on the dedicated GitHub repository available at <ext-link xlink:href="https://github.com/damiendevienne/phylter-data/" ext-link-type="uri">https://github.com/damiendevienne/phylter-data/</ext-link>.</p>
    <sec id="msad234-s6.1">
      <title>Software Availability</title>
      <p>PhylteR is a package written in R language (<xref rid="msad234-B38" ref-type="bibr">R Core Team 2023</xref>) available on CRAN (<ext-link xlink:href="https://cran.r-project.org/web/packages/phylter/index.html" ext-link-type="uri">https://cran.r-project.org/web/packages/phylter/index.html</ext-link>) for the latest stable version and on GitHub (<ext-link xlink:href="https://github.com/damiendevienne/phylter" ext-link-type="uri">https://github.com/damiendevienne/phylter</ext-link>) for the latest development version. The latest version of PhylteR is also distributed as a Singularity container (<ext-link xlink:href="https://cloud.sylabs.io/library/theo.treecou/tool/phylter_singularity" ext-link-type="uri">https://cloud.sylabs.io/library/theo.treecou/tool/phylter_singularity</ext-link>) and a docker container (<ext-link xlink:href="https://hub.docker.com/r/treecoutheo/phylter_docker" ext-link-type="uri">https://hub.docker.com/r/treecoutheo/phylter_docker</ext-link>). Extensive documentation can be found at <ext-link xlink:href="https://damiendevienne.github.io/phylter/index.html" ext-link-type="uri">https://damiendevienne.github.io/phylter/index.html</ext-link>.</p>
    </sec>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="msad234-B1">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Abdi</surname>  <given-names>H</given-names></string-name>, <string-name><surname>O’Toole</surname>  <given-names>AJ</given-names></string-name>, <string-name><surname>Valentin</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Edelman</surname>  <given-names>B</given-names></string-name></person-group>. <year>2005</year>. <comment>DISTATIS: The analysis of multiple distance matrices. In: 2005 IEEE Computer Society Conference on Computer Vision and Pattern Recognition (CVPR’05)-Workshops. IEEE. p. 42–42</comment>.</mixed-citation>
    </ref>
    <ref id="msad234-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Abdi</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Williams</surname>  <given-names>LJ</given-names></string-name>, <string-name><surname>Valentin</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Bennani-Dosse</surname>  <given-names>M</given-names></string-name></person-group>. <article-title>STATIS And DISTATIS: optimum multitable principal component analysis and three way metric multidimensional scaling</article-title>. <source>Wiley Interdiscip Rev Comput Stat</source>. <year>2012</year>:<volume>4</volume>(<issue>2</issue>):<fpage>124</fpage>–<lpage>167</lpage>. <pub-id pub-id-type="doi">10.1002/wics.198</pub-id>.</mixed-citation>
    </ref>
    <ref id="msad234-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aberer</surname>  <given-names>AJ</given-names></string-name>, <string-name><surname>Krompass</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Stamatakis</surname>  <given-names>A</given-names></string-name></person-group>. <article-title>Pruning rogue taxa improves phylogenetic accuracy: an efficient algorithm and webservice</article-title>. <source>Syst Biol</source>. <year>2013</year>:<volume>62</volume>(<issue>1</issue>):<fpage>162</fpage>–<lpage>166</lpage>. <pub-id pub-id-type="doi">10.1093/sysbio/sys078</pub-id>.<pub-id pub-id-type="pmid">22962004</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ali</surname>  <given-names>RH</given-names></string-name>, <string-name><surname>Bogusz</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Whelan</surname>  <given-names>S</given-names></string-name></person-group>. <article-title>Identifying clusters of high confidence homologies in multiple sequence alignments</article-title>. <source>Mol Biol Evol</source>. <year>2019</year>:<volume>36</volume>(<issue>10</issue>):<fpage>2340</fpage>–<lpage>2351</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/msz142</pub-id>.<pub-id pub-id-type="pmid">31209473</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Allio</surname>  <given-names>R</given-names></string-name>, <string-name><surname>Tilak</surname>  <given-names>M-K</given-names></string-name>, <string-name><surname>Scornavacca</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Avenant</surname>  <given-names>NL</given-names></string-name>, <string-name><surname>Kitchener</surname>  <given-names>AC</given-names></string-name>, <string-name><surname>Corre</surname>  <given-names>E</given-names></string-name>, <string-name><surname>Nabholz</surname>  <given-names>B</given-names></string-name>, <string-name><surname>Delsuc</surname>  <given-names>F</given-names></string-name></person-group>. <article-title>High-quality carnivoran genomes from roadkill samples enable comparative species delineation in aardwolf and bat-eared fox</article-title>. <source>eLife</source>. <year>2021</year>:<volume>10</volume>:<fpage>e63167</fpage>. <pub-id pub-id-type="doi">10.7554/eLife.63167</pub-id>.<pub-id pub-id-type="pmid">33599612</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Barton</surname>  <given-names>D</given-names></string-name>, <string-name><surname>David</surname>  <given-names>F</given-names></string-name></person-group>. <article-title>Some notes on ordered random intervals</article-title>. <source>J R Stat Soc Ser B Methodol</source>. <year>1956</year>:<volume>18</volume>:<fpage>79</fpage>–<lpage>94</lpage>. <pub-id pub-id-type="doi">10.1111/j.2517-6161.1956.tb00213.x</pub-id>.</mixed-citation>
    </ref>
    <ref id="msad234-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baum</surname>  <given-names>BR</given-names></string-name></person-group>. <article-title>Combining trees as a way of combining data sets for phylogenetic inference, and the desirability of combining gene trees</article-title>. <source>TAXON</source>. <year>1992</year>:<volume>41</volume>(<issue>1</issue>):<fpage>3</fpage>–<lpage>10</lpage>. <pub-id pub-id-type="doi">10.2307/1222480</pub-id>.</mixed-citation>
    </ref>
    <ref id="msad234-B8">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Biller</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Knibbe</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Beslon</surname>  <given-names>G</given-names></string-name>, <string-name><surname>Tannier</surname>  <given-names>E</given-names></string-name></person-group>. <year>2016</year>. <comment>Comparative genomics on artificial life. In: Conference on Computability in Europe. Springer. p. 35–44</comment>.</mixed-citation>
    </ref>
    <ref id="msad234-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brys</surname>  <given-names>G</given-names></string-name>, <string-name><surname>Hubert</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Struyf</surname>  <given-names>A</given-names></string-name></person-group>. <article-title>A robust measure of skewness</article-title>. <source>J Comput Graph Stat</source>. <year>2004</year>:<volume>13</volume>(<issue>4</issue>):<fpage>996</fpage>–<lpage>1017</lpage>. <pub-id pub-id-type="doi">10.1198/106186004X12632</pub-id>.</mixed-citation>
    </ref>
    <ref id="msad234-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Capella-Gutiérrez</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Silla-Martínez</surname>  <given-names>JM</given-names></string-name>, <string-name><surname>Gabaldón</surname>  <given-names>T</given-names></string-name></person-group>. <article-title>Trimal: a tool for automated alignment trimming in large-scale phylogenetic analyses</article-title>. <source>Bioinformatics</source>. <year>2009</year>:<volume>25</volume>(<issue>15</issue>):<fpage>1972</fpage>–<lpage>1973</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btp348</pub-id>.<pub-id pub-id-type="pmid">19505945</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chessel</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Hanafi</surname>  <given-names>M</given-names></string-name></person-group>. <article-title>Analyses de la co-inertie de $ K $ nuages de points</article-title>. <source>Rev Stat Appl</source>. <year>1996</year>:<volume>44</volume>:<fpage>35</fpage>–<lpage>60</lpage>. <ext-link xlink:href="http://www.numdam.org/item/RSA_1996__44_2_35_0/" ext-link-type="uri">http://www.numdam.org/item/RSA_1996__44_2_35_0/</ext-link>.</mixed-citation>
    </ref>
    <ref id="msad234-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Criscuolo</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Gribaldo</surname>  <given-names>S</given-names></string-name></person-group>. <article-title>BMGE (Block mapping and gathering with entropy): a new software for selection of phylogenetic informative regions from multiple sequence alignments</article-title>. <source>BMC Evol Biol</source>. <year>2010</year>:<volume>10</volume>(<issue>1</issue>):<fpage>210</fpage>. <pub-id pub-id-type="doi">10.1186/1471-2148-10-210</pub-id>.<pub-id pub-id-type="pmid">20626897</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dalevi</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Eriksen</surname>  <given-names>N</given-names></string-name></person-group>. <article-title>Expected gene-order distances and model selection in bacteria</article-title>. <source>Bioinformatics</source>. <year>2008</year>:<volume>24</volume>(<issue>11</issue>):<fpage>1332</fpage>–<lpage>1338</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btn111</pub-id>.<pub-id pub-id-type="pmid">18381402</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Degnan</surname>  <given-names>JH</given-names></string-name>, <string-name><surname>Rosenberg</surname>  <given-names>NA</given-names></string-name></person-group>. <article-title>Discordance of Species trees with their most likely gene trees</article-title>. <source>PLoS Genet</source>. <year>2006</year>:<volume>2</volume>(<issue>5</issue>):<fpage>e68</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pgen.0020068</pub-id>.<pub-id pub-id-type="pmid">16733550</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>de Vienne</surname>  <given-names>DM</given-names></string-name>, <string-name><surname>Ollier</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Aguileta</surname>  <given-names>G</given-names></string-name></person-group>. <article-title>Phylo-MCOA: a fast and efficient method to detect outlier genes and Species in phylogenomics using multiple co-inertia analysis</article-title>. <source>Mol Biol Evol</source>. <year>2012</year>:<volume>29</volume>(<issue>6</issue>):<fpage>1587</fpage>–<lpage>1598</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/msr317</pub-id>.<pub-id pub-id-type="pmid">22319162</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Di Franco</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Poujol</surname>  <given-names>R</given-names></string-name>, <string-name><surname>Baurain</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Philippe</surname>  <given-names>H</given-names></string-name></person-group>. <article-title>Evaluating the usefulness of alignment filtering methods to reduce the impact of errors on evolutionary inferences</article-title>. <source>BMC Evol Biol</source>. <year>2019</year>:<volume>19</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>17</lpage>. <pub-id pub-id-type="doi">10.1186/s12862-019-1350-2</pub-id>.<pub-id pub-id-type="pmid">30606099</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Emerson</surname>  <given-names>RO</given-names></string-name>, <string-name><surname>Thomas</surname>  <given-names>JH</given-names></string-name></person-group>. <article-title>Adaptive evolution in zinc finger transcription factors</article-title>. <source>PLoS Genet</source>. <year>2009</year>:<volume>5</volume>(<issue>1</issue>):<fpage>e1000325</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pgen.1000325</pub-id>.<pub-id pub-id-type="pmid">19119423</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hubert</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Vandervieren</surname>  <given-names>E</given-names></string-name></person-group>. <article-title>An adjusted boxplot for skewed distributions</article-title>. <source>Comput StatData Anal</source>. <year>2008</year>:<volume>52</volume>(<issue>12</issue>):<fpage>5186</fpage>–<lpage>5201</lpage>. <pub-id pub-id-type="doi">10.1016/j.csda.2007.11.008</pub-id>.</mixed-citation>
    </ref>
    <ref id="msad234-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huntley</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Baggott</surname>  <given-names>DM</given-names></string-name>, <string-name><surname>Hamilton</surname>  <given-names>AT</given-names></string-name>, <string-name><surname>Tran-Gyamfi</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Yang</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Kim</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Gordon</surname>  <given-names>L</given-names></string-name>, <string-name><surname>Branscomb</surname>  <given-names>E</given-names></string-name>, <string-name><surname>Stubbs</surname>  <given-names>L</given-names></string-name></person-group>. <article-title>A comprehensive catalog of human KRAB-associated zinc finger genes: insights into the evolutionary history of a large family of transcriptional repressors</article-title>. <source>Genome Res</source>. <year>2006</year>:<volume>16</volume>(<issue>5</issue>):<fpage>669</fpage>–<lpage>677</lpage>. <pub-id pub-id-type="doi">10.1101/gr.4842106</pub-id>.<pub-id pub-id-type="pmid">16606702</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jackson</surname>  <given-names>DA</given-names></string-name></person-group>. <article-title>Stopping rules in principal components analysis: a comparison of heuristical and statistical approaches</article-title>. <source>Ecology</source>. <year>1993</year>:<volume>74</volume>(<issue>8</issue>):<fpage>2204</fpage>–<lpage>2214</lpage>. <pub-id pub-id-type="doi">10.2307/1939574</pub-id>.</mixed-citation>
    </ref>
    <ref id="msad234-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Katoh</surname>  <given-names>K</given-names></string-name>, <string-name><surname>Standley</surname>  <given-names>DM</given-names></string-name></person-group>. <article-title>MAFFT Multiple sequence alignment software version 7: improvements in performance and usability</article-title>. <source>Mol Biol Evol</source>. <year>2013</year>:<volume>30</volume>(<issue>4</issue>):<fpage>772</fpage>–<lpage>780</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/mst010</pub-id>.<pub-id pub-id-type="pmid">23329690</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kumar</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Subramanian</surname>  <given-names>S</given-names></string-name></person-group>. <article-title>Mutation rates in mammalian genomes</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2002</year>:<volume>99</volume>(<issue>2</issue>):<fpage>803</fpage>–<lpage>808</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.022629899</pub-id>.<pub-id pub-id-type="pmid">11792858</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lartillot</surname>  <given-names>N</given-names></string-name>, <string-name><surname>Rodrigue</surname>  <given-names>N</given-names></string-name>, <string-name><surname>Stubbs</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Richer</surname>  <given-names>J</given-names></string-name></person-group>. <article-title>Phylobayes MPI: phylogenetic reconstruction with infinite mixtures of profiles in a parallel environment</article-title>. <source>Syst Biol</source>. <year>2013</year>:<volume>62</volume>(<issue>4</issue>):<fpage>611</fpage>–<lpage>615</lpage>. <pub-id pub-id-type="doi">10.1093/sysbio/syt022</pub-id>.<pub-id pub-id-type="pmid">23564032</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Chang</surname>  <given-names>L-H</given-names></string-name>, <string-name><surname>Sun</surname>  <given-names>Y</given-names></string-name>, <string-name><surname>Lu</surname>  <given-names>X</given-names></string-name>, <string-name><surname>Stubbs</surname>  <given-names>L</given-names></string-name></person-group>. <article-title>Deep vertebrate roots for mammalian zinc finger transcription factor subfamilies</article-title>. <source>Genome Biol Evol</source>. <year>2014</year>:<volume>6</volume>(<issue>3</issue>):<fpage>510</fpage>–<lpage>525</lpage>. <pub-id pub-id-type="doi">10.1093/gbe/evu030</pub-id>.<pub-id pub-id-type="pmid">24534434</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname>  <given-names>L</given-names></string-name>, <string-name><surname>Yu</surname>  <given-names>L</given-names></string-name>, <string-name><surname>Edwards</surname>  <given-names>SV</given-names></string-name></person-group>. <article-title>A maximum pseudo-likelihood approach for estimating species trees under the coalescent model</article-title>. <source>BMC Evol Biol</source>. <year>2010</year>:<volume>10</volume>(<issue>1</issue>):<fpage>302</fpage>. <pub-id pub-id-type="doi">10.1186/1471-2148-10-302</pub-id>.<pub-id pub-id-type="pmid">20937096</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lucas</surname>  <given-names>JM</given-names></string-name>, <string-name><surname>Crollius</surname>  <given-names>HR</given-names></string-name></person-group>. <article-title>High precision detection of conserved segments from synteny blocks</article-title>. <source>PLOS ONE</source>. <year>2017</year>:<volume>12</volume>(<issue>7</issue>):<fpage>e0180198</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pone.0180198</pub-id>.<pub-id pub-id-type="pmid">28671949</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mai</surname>  <given-names>U</given-names></string-name>, <string-name><surname>Mirarab</surname>  <given-names>S</given-names></string-name></person-group>. <article-title>Treeshrink: fast and accurate detection of outlier long branches in collections of phylogenetic trees</article-title>. <source>BMC Genomics</source>. <year>2018</year>:<volume>19</volume>(<issue>S5</issue>):<fpage>272</fpage>–<lpage>272</lpage>. <pub-id pub-id-type="doi">10.1186/s12864-018-4620-2</pub-id>.<pub-id pub-id-type="pmid">29745847</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mallo</surname>  <given-names>D</given-names></string-name>, <string-name><surname>De Oliveira Martins</surname>  <given-names>L</given-names></string-name>, <string-name><surname>Posada</surname>  <given-names>D</given-names></string-name></person-group>. <article-title><italic toggle="yes">Simphy</italic>: phylogenomic simulation of gene, locus, and Species trees</article-title>. <source>Syst Biol</source>. <year>2016</year>:<volume>65</volume>(<issue>2</issue>):<fpage>334</fpage>–<lpage>344</lpage>. <pub-id pub-id-type="doi">10.1093/sysbio/syv082</pub-id>.<pub-id pub-id-type="pmid">26526427</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Minh</surname>  <given-names>BQ</given-names></string-name>, <string-name><surname>Hahn</surname>  <given-names>MW</given-names></string-name>, <string-name><surname>Lanfear</surname>  <given-names>R</given-names></string-name></person-group>. <article-title>New methods to calculate concordance factors for phylogenomic datasets</article-title>. <source>Mol Biol Evol</source>. <year>2020</year>:<volume>37</volume>(<issue>9</issue>):<fpage>2727</fpage>–<lpage>2733</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/msaa106</pub-id>.<pub-id pub-id-type="pmid">32365179</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Minh</surname>  <given-names>BQ</given-names></string-name>, <string-name><surname>Schmidt</surname>  <given-names>HA</given-names></string-name>, <string-name><surname>Chernomor</surname>  <given-names>O</given-names></string-name>, <string-name><surname>Schrempf</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Woodhams</surname>  <given-names>MD</given-names></string-name>, <string-name><surname>von Haeseler</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Lanfear</surname>  <given-names>R</given-names></string-name></person-group>. <article-title>IQ-TREE 2: new models and efficient methods for phylogenetic inference in the genomic era</article-title>. <source>Mol Biol Evol</source>. <year>2020</year>:<volume>37</volume>(<issue>5</issue>):<fpage>1530</fpage>–<lpage>1534</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/msaa015</pub-id>.<pub-id pub-id-type="pmid">32011700</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Paradis</surname>  <given-names>E</given-names></string-name>, <string-name><surname>Schliep</surname>  <given-names>K</given-names></string-name></person-group>. <article-title>Ape 5.0: an environment for modern phylogenetics and evolutionary analyses in R</article-title>. <source>Bioinformatics</source>. <year>2019</year>:<volume>35</volume>(<issue>3</issue>):<fpage>526</fpage>–<lpage>528</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bty633</pub-id>.<pub-id pub-id-type="pmid">30016406</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Philippe</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Brinkmann</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Lavrov</surname>  <given-names>DV</given-names></string-name>, <string-name><surname>Littlewood</surname>  <given-names>DTJ</given-names></string-name>, <string-name><surname>Manuel</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Wörheide</surname>  <given-names>G</given-names></string-name>, <string-name><surname>Baurain</surname>  <given-names>D</given-names></string-name></person-group>. <article-title>Resolving difficult phylogenetic questions: why more sequences are not enough</article-title>. <source>PLoS Biol</source>. <year>2011</year>:<volume>9</volume>(<issue>3</issue>):<fpage>e1000602</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pbio.1000602</pub-id>.<pub-id pub-id-type="pmid">21423652</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Philippe</surname>  <given-names>H</given-names></string-name>, <string-name><surname>de Vienne</surname>  <given-names>DM</given-names></string-name>, <string-name><surname>Ranwez</surname>  <given-names>V</given-names></string-name>, <string-name><surname>Roure</surname>  <given-names>B</given-names></string-name>, <string-name><surname>Baurain</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Delsuc</surname>  <given-names>F</given-names></string-name></person-group>. <article-title>Pitfalls in supermatrix phylogenomics</article-title>. <source>Eur J Taxon</source>. <year>2017</year>:<volume>283</volume>:<fpage>1</fpage>–<lpage>25</lpage>. <pub-id pub-id-type="doi">10.5852/ejt.2017.283</pub-id>.</mixed-citation>
    </ref>
    <ref id="msad234-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ragan</surname>  <given-names>MA</given-names></string-name></person-group>. <article-title>Matrix representation in reconstructing phylogenetic relationships among the eukaryotes</article-title>. <source>Biosystems</source>. <year>1992</year>:<volume>28</volume>(<issue>1-3</issue>):<fpage>47</fpage>–<lpage>55</lpage>. <pub-id pub-id-type="doi">10.1016/0303-2647(92)90007-L</pub-id>.<pub-id pub-id-type="pmid">1292666</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B35">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Ranwez</surname>  <given-names>V</given-names></string-name>, <string-name><surname>Chantret</surname>  <given-names>NN</given-names></string-name></person-group>. <year>2020</year>. <comment>Strengths and limits of multiple sequence alignment and filtering methods</comment>.</mixed-citation>
    </ref>
    <ref id="msad234-B36">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Ranwez</surname>  <given-names>V</given-names></string-name>, <string-name><surname>Chantret</surname>  <given-names>N</given-names></string-name>, <string-name><surname>Delsuc</surname>  <given-names>F</given-names></string-name></person-group>. <part-title>Aligning protein-coding nucleotide sequences with MACSE</part-title>. <source>Multiple sequence alignment</source>. <publisher-name>Springer</publisher-name>; <year>2021</year>. p. <fpage>51</fpage>–<lpage>70</lpage>.</mixed-citation>
    </ref>
    <ref id="msad234-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ranwez</surname>  <given-names>V</given-names></string-name>, <string-name><surname>Douzery</surname>  <given-names>EJ</given-names></string-name>, <string-name><surname>Cambon</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Chantret</surname>  <given-names>N</given-names></string-name>, <string-name><surname>Delsuc</surname>  <given-names>F</given-names></string-name></person-group>. <article-title>MACSE V2: toolkit for the alignment of coding sequences accounting for frameshifts and stop codons</article-title>. <source>Mol Biol Evol</source>. <year>2018</year>:<volume>35</volume>(<issue>10</issue>):<fpage>2582</fpage>–<lpage>2584</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/msy159</pub-id>.<pub-id pub-id-type="pmid">30165589</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B38">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><collab>R Core Team</collab></person-group>. <source>R: A language and environment for statistical computing</source>. <publisher-loc>Vienna</publisher-loc>, <publisher-loc>Austria</publisher-loc>: <publisher-name>R Foundation for Statistical Computing</publisher-name>; <year>2023</year>.</mixed-citation>
    </ref>
    <ref id="msad234-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Robert</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Escoufier</surname>  <given-names>Y</given-names></string-name></person-group>. <article-title>A unifying tool for linear multivariate statistical methods: the RV- coefficient</article-title>. <source>J R Stat Soc Ser C Appl Stat</source>. <year>1976</year>:<volume>25</volume>:<fpage>257</fpage>–<lpage>265</lpage>. <pub-id pub-id-type="doi">10.2307/2347233</pub-id>.</mixed-citation>
    </ref>
    <ref id="msad234-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ronquist</surname>  <given-names>F</given-names></string-name></person-group>. <article-title>Matrix representation of trees, redundancy, and weighting</article-title>. <source>Syst Biol</source>. <year>1996</year>:<volume>45</volume>(<issue>2</issue>):<fpage>247</fpage>–<lpage>253</lpage>. <pub-id pub-id-type="doi">10.1093/sysbio/45.2.247</pub-id>.</mixed-citation>
    </ref>
    <ref id="msad234-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Salichos</surname>  <given-names>L</given-names></string-name>, <string-name><surname>Rokas</surname>  <given-names>A</given-names></string-name></person-group>. <article-title>Inferring ancient divergences requires genes with strong phylogenetic signals</article-title>. <source>Nature</source>. <year>2013</year>:<volume>497</volume>(<issue>7449</issue>):<fpage>327</fpage>–<lpage>331</lpage>. <pub-id pub-id-type="doi">10.1038/nature12130</pub-id>.<pub-id pub-id-type="pmid">23657258</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B42">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Schrempf</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Szöllősi</surname>  <given-names>G</given-names></string-name></person-group>. <year>2020</year>. <comment>The sources of phylogenetic conflicts. <italic toggle="yes">Phylogenetics Genomic Era</italic> 3–1</comment>.</mixed-citation>
    </ref>
    <ref id="msad234-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Scornavacca</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Belkhir</surname>  <given-names>K</given-names></string-name>, <string-name><surname>Lopez</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Dernat</surname>  <given-names>R</given-names></string-name>, <string-name><surname>Delsuc</surname>  <given-names>F</given-names></string-name>, <string-name><surname>Douzery</surname>  <given-names>EJP</given-names></string-name>, <string-name><surname>Ranwez</surname>  <given-names>V</given-names></string-name></person-group>. <article-title>Orthomam v10: scaling-up orthologous coding sequence and exon alignments with more than one hundred mammalian genomes</article-title>. <source>Mol Biol Evol</source>. <year>2019</year>:<volume>36</volume>(<issue>4</issue>):<fpage>861</fpage>–<lpage>862</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/msz015</pub-id>.<pub-id pub-id-type="pmid">30698751</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Scornavacca</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Galtier</surname>  <given-names>N</given-names></string-name></person-group>. <article-title>Incomplete lineage sorting in mammalian phylogenomics</article-title>. <source>Syst Biol</source>. <year>2016</year>:<volume>66</volume>(<issue>1</issue>):<fpage>syw082</fpage>. <pub-id pub-id-type="doi">10.1093/sysbio/syw082</pub-id>.</mixed-citation>
    </ref>
    <ref id="msad234-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shen</surname>  <given-names>X-X</given-names></string-name>, <string-name><surname>Salichos</surname>  <given-names>L</given-names></string-name>, <string-name><surname>Rokas</surname>  <given-names>A</given-names></string-name></person-group>. <article-title>A genome-scale investigation of how sequence, function, and tree-based gene properties influence phylogenetic inference</article-title>. <source>Genome Biol Evol</source>. <year>2016</year>:<volume>8</volume>(<issue>8</issue>):<fpage>2565</fpage>–<lpage>2580</lpage>. <pub-id pub-id-type="doi">10.1093/gbe/evw179</pub-id>.<pub-id pub-id-type="pmid">27492233</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Szöllősi</surname>  <given-names>GJ</given-names></string-name>, <string-name><surname>Davín</surname>  <given-names>AA</given-names></string-name>, <string-name><surname>Tannier</surname>  <given-names>E</given-names></string-name>, <string-name><surname>Daubin</surname>  <given-names>V</given-names></string-name>, <string-name><surname>Boussau</surname>  <given-names>B</given-names></string-name></person-group>. <article-title>Genome-scale phylogenetic analysis finds extensive gene transfer among fungi</article-title>. <source>Philos Trans R Soc B Biol Sci</source>. <year>2015</year>:<volume>370</volume>(<issue>1678</issue>):<fpage>20140335</fpage>. <pub-id pub-id-type="doi">10.1098/rstb.2014.0335</pub-id>.</mixed-citation>
    </ref>
    <ref id="msad234-B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>van de Kerk</surname>  <given-names>M</given-names></string-name>, <string-name><surname>de Kroon</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Conde</surname>  <given-names>DA</given-names></string-name>, <string-name><surname>Jongejans</surname>  <given-names>E</given-names></string-name></person-group>. <article-title>Carnivora population dynamics are as slow and as fast as those of other mammals: implications for their conservation</article-title>. <source>PLOS ONE</source>. <year>2013</year>:<volume>8</volume>(<issue>8</issue>):<fpage>e70354</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pone.0070354</pub-id>.<pub-id pub-id-type="pmid">23950922</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>von Haeseler</surname>  <given-names>A</given-names></string-name></person-group>. <article-title>Do we still need supertrees?</article-title>  <source>BMC Biol</source>. <year>2012</year>:<volume>10</volume>(<issue>1</issue>):<fpage>13</fpage>. <pub-id pub-id-type="doi">10.1186/1741-7007-10-13</pub-id>.<pub-id pub-id-type="pmid">22369571</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B49">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname>  <given-names>Z</given-names></string-name>, <string-name><surname>Bielawski</surname>  <given-names>JP</given-names></string-name></person-group>. <article-title>Statistical methods for detecting molecular adaptation</article-title>. <source>Trends Ecol Evol</source>. <year>2000</year>:<volume>15</volume>(<issue>12</issue>):<fpage>496</fpage>–<lpage>503</lpage>. <pub-id pub-id-type="doi">10.1016/S0169-5347(00)01994-7</pub-id>.<pub-id pub-id-type="pmid">11114436</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B50">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname>  <given-names>Z</given-names></string-name>, <string-name><surname>Kumar</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Nei</surname>  <given-names>M</given-names></string-name></person-group>. <article-title>A new method of inference of ancestral nucleotide and amino acid sequences</article-title>. <source>Genetics</source>. <year>1995</year>:<volume>141</volume>(<issue>4</issue>):<fpage>1641</fpage>–<lpage>1650</lpage>. <pub-id pub-id-type="doi">10.1093/genetics/141.4.1641</pub-id>.<pub-id pub-id-type="pmid">8601501</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B51">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Rabiee</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Sayyari</surname>  <given-names>E</given-names></string-name>, <string-name><surname>Mirarab</surname>  <given-names>S</given-names></string-name></person-group>. <article-title>ASTRAL-III: polynomial time species tree reconstruction from partially resolved gene trees</article-title>. <source>BMC Bioinformatics</source>. <year>2018</year>:<volume>19</volume>(<issue>S6</issue>):<fpage>153</fpage>. <pub-id pub-id-type="doi">10.1186/s12859-018-2129-y</pub-id>.<pub-id pub-id-type="pmid">29745866</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B52">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Zhao</surname>  <given-names>Y</given-names></string-name>, <string-name><surname>Braun</surname>  <given-names>EL</given-names></string-name>, <string-name><surname>Mirarab</surname>  <given-names>S</given-names></string-name></person-group>. <article-title>TAPER: pinpointing errors in multiple sequence alignments despite varying rates of evolution</article-title>. <source>Methods Ecol Evol</source>. <year>2021</year>:<volume>12</volume>(<issue>11</issue>):<fpage>2145</fpage>–<lpage>2158</lpage>. <pub-id pub-id-type="doi">10.1111/2041-210X.13696</pub-id>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Mol Biol Evol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Mol Biol Evol</journal-id>
    <journal-id journal-id-type="publisher-id">molbev</journal-id>
    <journal-title-group>
      <journal-title>Molecular Biology and Evolution</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0737-4038</issn>
    <issn pub-type="epub">1537-1719</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
      <publisher-loc>US</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10655845</article-id>
    <article-id pub-id-type="pmid">37879113</article-id>
    <article-id pub-id-type="doi">10.1093/molbev/msad234</article-id>
    <article-id pub-id-type="publisher-id">msad234</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methods</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01130</subject>
        <subject>AcademicSubjects/SCI01180</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PhylteR: Efficient Identification of Outlier Sequences in Phylogenomic Datasets</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Comte</surname>
          <given-names>Aurore</given-names>
        </name>
        <aff><institution>French Institute of Bioinformatics (IFB)—South Green Bioinformatics Platform, Bioversity, CIRAD, INRAE, IRD</institution>, <addr-line>Montpellier</addr-line>, <country country="FR">France</country></aff>
        <aff><institution>IRD, CIRAD, INRAE, Institut Agro, PHIM Plant Health Institute, Montpellier University</institution>, <addr-line>Montpellier</addr-line>, <country country="FR">France</country></aff>
        <xref rid="msad234-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tricou</surname>
          <given-names>Théo</given-names>
        </name>
        <aff><institution>Université de Lyon, Université Lyon 1, UMR CNRS 5558 Laboratoire de Biométrie et Biologie Évolutive</institution>, <addr-line>Villeurbanne</addr-line>, <country country="FR">France</country></aff>
        <xref rid="msad234-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tannier</surname>
          <given-names>Eric</given-names>
        </name>
        <aff><institution>Université de Lyon, Université Lyon 1, UMR CNRS 5558 Laboratoire de Biométrie et Biologie Évolutive</institution>, <addr-line>Villeurbanne</addr-line>, <country country="FR">France</country></aff>
        <aff><institution>Centre de Recherches Inria de Lyon</institution>, <addr-line>Villeurbanne</addr-line>, <country country="FR">France</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Joseph</surname>
          <given-names>Julien</given-names>
        </name>
        <aff><institution>Université de Lyon, Université Lyon 1, UMR CNRS 5558 Laboratoire de Biométrie et Biologie Évolutive</institution>, <addr-line>Villeurbanne</addr-line>, <country country="FR">France</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Siberchicot</surname>
          <given-names>Aurélie</given-names>
        </name>
        <aff><institution>Université de Lyon, Université Lyon 1, UMR CNRS 5558 Laboratoire de Biométrie et Biologie Évolutive</institution>, <addr-line>Villeurbanne</addr-line>, <country country="FR">France</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-1550-5477</contrib-id>
        <name>
          <surname>Penel</surname>
          <given-names>Simon</given-names>
        </name>
        <aff><institution>Université de Lyon, Université Lyon 1, UMR CNRS 5558 Laboratoire de Biométrie et Biologie Évolutive</institution>, <addr-line>Villeurbanne</addr-line>, <country country="FR">France</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-3885-5410</contrib-id>
        <name>
          <surname>Allio</surname>
          <given-names>Rémi</given-names>
        </name>
        <aff><institution>CBGP, INRAE, CIRAD, IRD, Montpellier SupAgro, Univ. Montpellier</institution>, <addr-line>Montpellier</addr-line>, <country country="FR">France</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6501-6287</contrib-id>
        <name>
          <surname>Delsuc</surname>
          <given-names>Frédéric</given-names>
        </name>
        <aff><institution>ISEM, Univ. Montpellier, CNRS, IRD</institution>, <addr-line>Montpellier</addr-line>, <country country="FR">France</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dray</surname>
          <given-names>Stéphane</given-names>
        </name>
        <aff><institution>Université de Lyon, Université Lyon 1, UMR CNRS 5558 Laboratoire de Biométrie et Biologie Évolutive</institution>, <addr-line>Villeurbanne</addr-line>, <country country="FR">France</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-9532-5251</contrib-id>
        <name>
          <surname>de Vienne</surname>
          <given-names>Damien M</given-names>
        </name>
        <aff><institution>Université de Lyon, Université Lyon 1, UMR CNRS 5558 Laboratoire de Biométrie et Biologie Évolutive</institution>, <addr-line>Villeurbanne</addr-line>, <country country="FR">France</country></aff>
        <xref rid="msad234-cor1" ref-type="corresp"/>
        <!--damien.de-vienne@univ-lyon1.fr-->
        <xref rid="msad234-FM2" ref-type="author-notes"/>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Tamura</surname>
          <given-names>Koichiro</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <fn id="msad234-FM1">
        <p>Aurore Comte and Théo Tricou equal contribution.</p>
      </fn>
      <fn id="msad234-FM2" fn-type="COI-statement">
        <p><italic toggle="yes">Conflict of interest statement.</italic> None declared.</p>
      </fn>
      <corresp id="msad234-cor1"><bold>Corresponding author</bold>: E-mail: <email>damien.de-vienne@univ-lyon1.fr</email>.</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-10-25">
      <day>25</day>
      <month>10</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>25</day>
      <month>10</month>
      <year>2023</year>
    </pub-date>
    <volume>40</volume>
    <issue>11</issue>
    <elocation-id>msad234</elocation-id>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>2</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>29</day>
        <month>9</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>10</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press on behalf of Society for Molecular Biology and Evolution.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution-NonCommercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">https://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="msad234.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>In phylogenomics, incongruences between gene trees, resulting from both artifactual and biological reasons, can decrease the signal-to-noise ratio and complicate species tree inference. The amount of data handled today in classical phylogenomic analyses precludes manual error detection and removal. However, a simple and efficient way to automate the identification of outliers from a collection of gene trees is still missing. Here, we present PhylteR, a method that allows rapid and accurate detection of outlier sequences in phylogenomic datasets, i.e. species from individual gene trees that do not follow the general trend. PhylteR relies on DISTATIS, an extension of multidimensional scaling to 3 dimensions to compare multiple distance matrices at once. In PhylteR, these distance matrices extracted from individual gene phylogenies represent evolutionary distances between species according to each gene. On simulated datasets, we show that PhylteR identifies outliers with more sensitivity and precision than a comparable existing method. We also show that PhylteR is not sensitive to ILS-induced incongruences, which is a desirable feature. On a biological dataset of 14,463 genes for 53 species previously assembled for Carnivora phylogenomics, we show (i) that PhylteR identifies as outliers sequences that can be considered as such by other means, and (ii) that the removal of these sequences improves the concordance between the gene trees and the species tree. Thanks to the generation of numerous graphical outputs, PhylteR also allows for the rapid and easy visual characterization of the dataset at hand, thus aiding in the precise identification of errors. PhylteR is distributed as an R package on CRAN and as containerized versions (docker and singularity).</p>
    </abstract>
    <kwd-group>
      <kwd>phylogenomics</kwd>
      <kwd>outliers</kwd>
      <kwd>gene tree</kwd>
      <kwd>species tree</kwd>
      <kwd>HGT</kwd>
      <kwd>ILS</kwd>
      <kwd>duplication</kwd>
      <kwd>supermatrix</kwd>
      <kwd>supertree</kwd>
    </kwd-group>
    <counts>
      <page-count count="16"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="msad234-s0">
    <title>Introduction</title>
    <p>Supermatrix, supertree, and coalescent-based approaches are commonly used in phylogenomics to obtain a species tree from a collection of genes. These methods are similar in their first steps: for a list of taxa of interest, a large collection of single-copy orthologous gene sequences is retrieved and a multiple sequence alignment (MSA) is computed for each cluster of orthologous genes (see <xref rid="msad234-B48" ref-type="bibr">von Haeseler 2012</xref> for a comparison of these approaches). The methods then differ by the strategy employed. In the supermatrix approach, MSAs are concatenated into a supermatrix that is used to build a phylogeny, generally with Maximum Likelihood (ML) or Bayesian methods (such as IQ-TREE, <xref rid="msad234-B30" ref-type="bibr">Minh, Schmidt, et al. 2020</xref>; or Phylobayes, <xref rid="msad234-B23" ref-type="bibr">Lartillot et al. 2013</xref>). In the supertree and coalescent-based approaches, individual gene trees are built from individual MSAs, and a species tree is obtained by combining them all, e.g. with MRP (<xref rid="msad234-B7" ref-type="bibr">Baum 1992</xref>; <xref rid="msad234-B34" ref-type="bibr">Ragan 1992</xref>; <xref rid="msad234-B40" ref-type="bibr">Ronquist 1996</xref>), MP-EST (<xref rid="msad234-B25" ref-type="bibr">Liu et al. 2010</xref>), or ASTRAL (<xref rid="msad234-B51" ref-type="bibr">Zhang et al. 2018</xref>) to only cite a few.</p>
    <p>Regardless of the method employed, errors in the individual gene MSAs and errors in the individual gene trees (leading to incongruences with the species tree) can negatively impact the quality (accuracy) of the reconstructed species tree (<xref rid="msad234-B33" ref-type="bibr">Philippe et al. 2017</xref>).</p>
    <p>For MSAs, various filtering methods have been developed, categorized into two groups: methods that entirely remove sites (columns) or sequences (rows) from the alignment (trimAl, <xref rid="msad234-B10" ref-type="bibr">Capella-Gutiérrez et al. 2009</xref>; BMGE, <xref rid="msad234-B12" ref-type="bibr">Criscuolo and Gribaldo 2010</xref>), and methods that are more <italic toggle="yes">picky</italic> and allow identifying and filtering (or masking) small segments in the alignments (Divvier, <xref rid="msad234-B4" ref-type="bibr">Ali et al. 2019</xref>; HmmCleaner <xref rid="msad234-B16" ref-type="bibr">Di Franco et al. 2019</xref>; TAPER, <xref rid="msad234-B52" ref-type="bibr">Zhang et al. 2021</xref>). The latter group of methods was shown to be a better choice for alignment filtering, leading to better gene tree topologies (closer to the species tree) and more consistent terminal branch lengths in gene trees (<xref rid="msad234-B35" ref-type="bibr">Ranwez and Chantret 2020</xref>).</p>
    <p>For a collection of gene trees, filtering methods also exist, and the categorization into two groups of strategies still holds. In the first group are methods that prune rogue taxa, i.e. taxa that are unstable among gene trees (RogueNaRok, <xref rid="msad234-B3" ref-type="bibr">Aberer et al. 2013</xref>), and methods that eliminate orthologous gene families whose history is uncorrelated with the others. In the second group are more <italic toggle="yes">picky</italic> methods that identify and filter out only some species in some genes trees (i.e. Phylo-MCOA, <xref rid="msad234-B15" ref-type="bibr">de Vienne et al. 2012</xref>; or TreeShrink, <xref rid="msad234-B27" ref-type="bibr">Mai and Mirarab 2018</xref>). Just like for the alignment filtering methods seen above, <italic toggle="yes">picky</italic> approaches are thought to provide the best compromise between removing sequences with conflicting phylogenetic signals and keeping the maximum information content.</p>
    <p>Filtering (sometimes called trimming) MSAs is now done routinely in phylogenomic pipelines, with methods that can be applied automatically to large datasets (see above). But just because we apply a filter at the MSA level doesn’t mean we shouldn’t filter gene trees also. Some of the reasons that lead to incongruences between gene trees and the species tree (and among gene trees), i.e. gene tree-building errors, undetected paralogy, horizontal gene transfer (HGT), and Incomplete Lineage Sorting (ILS), may not be detectable at the MSA stage. For filtering individual gene trees, reference methods do not exist yet (<xref rid="msad234-B33" ref-type="bibr">Philippe et al. 2017</xref>). Indeed, identifying species in gene trees whose position is not concordant with their position in the other gene trees (referred to as outliers in <xref rid="msad234-B15" ref-type="bibr">de Vienne et al. 2012</xref> and hereafter) is still commonly done by eye (when it is done), which is highly questionable in terms of efficacy, objectivity, and reproducibility.</p>
    <p>Here we present PhylteR, a new phylogenomics filtering method that can accurately and rapidly identify outliers in a collection of gene trees. Unlike Phylo-MCOA (<xref rid="msad234-B15" ref-type="bibr">de Vienne et al. 2012</xref>), from which it is largely inspired, it is an iterative process where obvious outliers are removed first, leaving space for better identification of more subtle ones, and leading <italic toggle="yes">in fine</italic> to a finer identification of outliers. Unlike TreeShrink (<xref rid="msad234-B27" ref-type="bibr">Mai and Mirarab 2018</xref>), it is not based solely on the diameter of unrooted gene trees and is thus more accurate when outliers are not associated with long branches (e.g. topological incongruences). Also, PhylteR relies on the multivariate analysis method DISTATIS (<xref rid="msad234-B1" ref-type="bibr">Abdi et al. 2005</xref>, <xref rid="msad234-B2" ref-type="bibr">2012</xref>), which is specifically designed to compare distance matrices, unlike Multiple Co-inertia Analysis (MCOA, <xref rid="msad234-B11" ref-type="bibr">Chessel and Hanafi 1996</xref>) used in Phylo-MCOA (<xref rid="msad234-B15" ref-type="bibr">de Vienne et al. 2012</xref>), and is thus more appropriate for the problem at hand.</p>
    <p>We tested PhylteR on two types of datasets: simulated datasets where outliers were known, and a biological dataset comprising 14,463 genes for up to 53 species previously used for Carnivora phylogenomics (<xref rid="msad234-B5" ref-type="bibr">Allio et al. 2021</xref>). For the simulated datasets, horizontal gene transfers (HGTs) were simulated and recorded, and sequences affected by these HGTs were considered as outliers. The simulations also included various degrees of ILS, a phenomenon where within-species polymorphism lasts longer than the time between two successive speciations (<xref rid="msad234-B44" ref-type="bibr">Scornavacca and Galtier 2016</xref>), leading to incongruences between gene and species trees and among gene trees. The importance of this phenomenon as a source of incongruence in phylogenomic datasets is not clear, but because recent coalescence-based methods are able to handle ILS-induced signals explicitly (e.g. ASTRAL, <xref rid="msad234-B51" ref-type="bibr">Zhang et al. 2018</xref>), it seemed pertinent to evaluate whether PhylteR was (or not) sensitive to it. In the empirical dataset, outliers were of course unknown but “properties” associated with gene sequences could be gathered (see <xref rid="msad234-B45" ref-type="bibr">Shen et al. 2016</xref> for a list of such properties), so that enrichment of sequences having some of these properties in the list of outliers could be quantified. Finally, we looked at the effect of PhylteR on the overall concordance between the gene trees and the species tree after filtering. We compared the results with those obtained with TreeShrink (<xref rid="msad234-B27" ref-type="bibr">Mai and Mirarab 2018</xref>), the only other tool to our knowledge with a similar objective that could reasonably be applied to such a large dataset.</p>
    <p>We show that PhylteR correctly identifies species in gene trees whose phylogenetic placement is not in accordance with its placement in other gene trees, and that this holds even in the presence of incongruence among gene trees due to ILS. We also provide strong evidence that the automatic removal of outliers with PhylteR improves the concordance between gene trees and the species tree in greater proportions than TreeShrink (<xref rid="msad234-B27" ref-type="bibr">Mai and Mirarab 2018</xref>).</p>
    <p>We hope that PhylteR could become the standard that was lacking (<xref rid="msad234-B33" ref-type="bibr">Philippe et al. 2017</xref>) for cleaning datasets before species tree reconstruction in phylogenomic pipelines.</p>
  </sec>
  <sec sec-type="materials|methods" id="msad234-s1">
    <title>Materials and Methods</title>
    <sec id="msad234-s1.1">
      <title>Description of the PhylteR Method</title>
      <p>The PhylteR method, in its entirety, is depicted in <xref rid="msad234-F1" ref-type="fig">Fig. 1</xref>. It starts with <italic toggle="yes">K</italic> distance matrices obtained from <italic toggle="yes">K</italic> genes by computing pairwise distances (sum of branch lengths) between species in each gene tree. All the matrices are given the same dimensionality by filling missing data (if any) with the mean value across matrices and are then normalized by dividing each matrix by either its median or its mean value (default is median). The normalization by median prevents genes from fast- and slow-evolving orthologous genes to be erroneously considered as outliers, and appears as a better choice than a normalization by the mean as it is less affected by outlier values.</p>
      <fig position="float" id="msad234-F1" fig-type="figure">
        <label>Fig. 1.</label>
        <caption>
          <p>Principle of the PhylteR method for identifying outliers in phylogenomic datasets. The method relies on DISTATIS (gray block), an extension of multidimensional scaling to three dimensions. See text for the detail of the different steps.</p>
        </caption>
        <graphic xlink:href="msad234f1" position="float"/>
      </fig>
      <p>From the <italic toggle="yes">K</italic> matrices obtained, an incremental process starts consisting of three main steps detailed in the next sections: (i) comparison of the matrices with the DISTATIS method (<xref rid="msad234-B1" ref-type="bibr">Abdi et al. 2005</xref>, <xref rid="msad234-B2" ref-type="bibr">2012</xref>), (ii) detection of outliers sequences, and (iii) evaluation of the impact of removing these outliers on the overall concordance between the matrices. Note that we refer to <italic toggle="yes">outlier sequence</italic> as a single gene for a single species (one sequence in one alignment, or one tip in one gene tree) that does not follow the general trend (i.e. other alignments or gene trees), while <italic toggle="yes">outlier gene</italic> refers to a complete alignment (or a complete gene tree) that does not agree with the other alignments (or gene trees).</p>
      <p>These steps are repeated until no more outlier sequences are detected, or until the removal of the identified outlier sequences does not increase the concordance between the matrices more than a certain amount specified by the user. Before finishing the optimization, PhylteR performs a last action consisting of checking whether some outlier genes still exist despite the removal of outlier sequences already performed. These outlier genes correspond to single-copy orthologous genes for which the lack of correlation with others is not due to a few outlier sequences but are globally not following the trend. If outlier genes are discarded there, the optimization restarts as it may have unblocked the detection of other outliers.</p>
      <sec id="msad234-s1.1.1">
        <title>Comparison of Individual Gene Matrices With DISTATIS</title>
        <p>DISTATIS is a multivariate method designed to evaluate the concordance between <italic toggle="yes">K</italic> distance matrices (<italic toggle="yes">K</italic> orthologous genes) measured on the same <italic toggle="yes">N</italic> species. The principle of DISTATIS is depicted in <xref rid="msad234-F1" ref-type="fig">Fig. 1</xref> (gray box). The first step of DISTATIS consists of computing a matrix of RV coefficients (<xref rid="msad234-B39" ref-type="bibr">Robert and Escoufier 1976</xref>) that measures the similarities between the species pairwise distances present in each matrix. This can be seen as an extension of the correlation matrix (used in principal component analysis) that, instead of measuring the links between a set of variables, evaluates the relationships between a set of tables (gene distance matrices here). In the second step, a compromise distance matrix is built as the average of the <italic toggle="yes">K</italic> distance matrices weighted by the first eigenvector of the matrix of RV coefficients. The compromise represents the best consensus between the <italic toggle="yes">K</italic> distance matrices, as the weights used in the averaging procedure take into account the similarities between them (i.e. more similar distance matrices would have more weights in the definition of the compromise). In the third step, the compromise matrix is submitted to an eigen decomposition procedure so that species can be represented in a low-dimensional multivariate space. In this compromise space, species are positioned so that their distances (computed in few dimensions, see after) represent the best approximations of the original distances contained in the compromise matrix. We used a broken stick model (<xref rid="msad234-B6" ref-type="bibr">Barton and David 1956</xref>) to estimate the number of dimensions (axes) of the compromise space, as this simple method was shown to give a good approximation of the correct dimensionality of the data with another multivariate approach (<xref rid="msad234-B20" ref-type="bibr">Jackson 1993</xref>). Then, each individual pairwise distance matrix is projected on the compromise space. This allows us to obtain a representation of species associated with each gene family. In other words, the compromise identifies the dissimilarities between species that are common for all genes whereas the projections of individual distance matrices allow depiction of the peculiarities of each sequence. Finally, we compute the distances, in the compromise space, between the position of a species given by all genes (the compromise) and its position associated with a particular gene family (using the projection procedure) and filled a gene x species 2-Way Reference matrix (2WR matrix, see <xref rid="msad234-F1" ref-type="fig">Fig. 1</xref>) with these values.</p>
      </sec>
      <sec id="msad234-s1.1.2">
        <title>Detection of Outlier Sequences From DISTATIS Results</title>
        <p>From the 2WR matrix (see <xref rid="msad234-F1" ref-type="fig">Fig. 1</xref>), we apply the method of <xref rid="msad234-B18" ref-type="bibr">Hubert and Vandervieren (2008)</xref> to detect all values that are outliers, at the right of the univariate distribution of values. This method is an adjustment of the Tukey method (the classical boxplot) adapted to skewed distribution. In brief all values above</p>
        <disp-formula id="M0001">
          <label>(1)</label>
          <mml:math id="M1" display="block" overflow="scroll">
            <mml:mi>Q</mml:mi>
            <mml:mn>3</mml:mn>
            <mml:mo>+</mml:mo>
            <mml:mi>k</mml:mi>
            <mml:msup>
              <mml:mi>e</mml:mi>
              <mml:mrow>
                <mml:mn>3</mml:mn>
                <mml:mi>M</mml:mi>
                <mml:mi>C</mml:mi>
              </mml:mrow>
            </mml:msup>
            <mml:mrow>
              <mml:mi mathvariant="normal">IQR</mml:mi>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>are considered outliers. <italic toggle="yes">Q3</italic> is the 3rd quartile of the distribution, <italic toggle="yes">IQR</italic> is its interquartile range and <italic toggle="yes">MC</italic> is the medcouple of the distribution (<xref rid="msad234-B9" ref-type="bibr">Brys et al. 2004</xref>), a measure of skewness bounded between −1 (left skewed) and +1 (right skewed). The <italic toggle="yes">k</italic> value is chosen by the user (default is 3) and controls how stringent the detection of gene outliers is. Small values of <italic toggle="yes">k</italic> lead to more gene outliers being detected. The detection of gene outliers is performed after normalization of the 2WR matrix, achieved by dividing each row (the default) or each column by its median. This normalization leads to an exaggeration of outlier values, easing their identification.</p>
      </sec>
      <sec id="msad234-s1.1.3">
        <title>Detection of Outlier Genes</title>
        <p>When no more outlier sequences are found in the 2WR matrix, PhylteR checks whether some genes are still uncorrelated to others. These outlier genes are detected by finding outlier values in the weight array (<italic toggle="yes">α<sub>1</sub>, α<sub>2</sub>, …, α<sub>K</sub></italic>, see <xref rid="msad234-F1" ref-type="fig">Fig. 1</xref>). The outlier detection method used is the same as for the outlier sequences of the 2WR matrix (<xref rid="M0001" ref-type="disp-formula">Equation 1</xref>) but its stringency can be tuned independently (with parameter <italic toggle="yes">k2</italic> in place of parameter <italic toggle="yes">k</italic> in <xref rid="M0001" ref-type="disp-formula">Equation 1</xref>, defaulting to <italic toggle="yes">k2</italic> = <italic toggle="yes">k</italic> = 3).</p>
      </sec>
      <sec id="msad234-s1.1.4">
        <title>Exit Criteria of the PhylteR Iterative Process</title>
        <p>PhylteR is an iterative process (see <xref rid="msad234-F1" ref-type="fig">Fig. 1</xref>) with two exit points. The first one is straightforward: if no more outlier sequences are detected in the 2WR matrix, and if no more outlier genes exist (see above), then the process stops. The second one is based on the gain (Δ<italic toggle="yes"><sub>q</sub></italic>) achieved by removing outlier sequences (i.e. the change in <italic toggle="yes">q</italic>, the quality of the compromise). If this gain is below a certain threshold (10<sup>−5</sup> by default), and if no more outlier genes exist, then the process stops.</p>
      </sec>
    </sec>
    <sec id="msad234-s1.2">
      <title>Evaluation of the PhylteR Method</title>
      <sec id="msad234-s1.2.1">
        <title>Datasets</title>
        <p>We used three types of datasets to evaluate PhylteR and compare it with TreeShrink: a simple dataset used for illustrative purpose only, a collection of simulated examples obtained with the program SimPhy (<xref rid="msad234-B28" ref-type="bibr">Mallo et al. 2016</xref>), and a large Carnivora phylogenomic dataset with 53 species (<xref rid="msad234-B5" ref-type="bibr">Allio et al. 2021</xref>). These datasets are described below.</p>
        <sec id="msad234-s1.2.1.1">
          <title>Simulated Dataset for Illustrative Purpose</title>
          <p>We generated a small collection of gene trees in order to illustrate the different steps of the PhylteR process. A single phylogenetic tree with 20 species was randomly generated with function rtree() from package <italic toggle="yes">ape</italic> v5.6.2 (<xref rid="msad234-B31" ref-type="bibr">Paradis and Schliep 2019</xref>). This tree was duplicated 25 times to mimic 25 orthologous gene families. To add variance to branch lengths, a value sampled in a normal distribution with mean 0 and standard deviation <italic toggle="yes">0.15</italic> was added to each branch length of each tree (if the resulting branch length was negative its absolute value was taken). Ten outliers were then generated by randomly sampling 10 times a species in a gene tree and moving it to another random location.</p>
        </sec>
        <sec id="msad234-s1.2.1.2">
          <title>Simulated Datasets</title>
          <p>W<italic toggle="yes">e</italic> simulated collections of gene trees with known outliers in order to evaluate PhylteR and compare it with TreeSkrink. We used SimPhy (<xref rid="msad234-B28" ref-type="bibr">Mallo et al. 2016</xref>), a program that can simulate the evolution of gene families (and thus gene trees) given a species tree under various evolutionary processes including HGT but also ILS. We used, as a species tree, the 53-taxa Carnivora tree of <xref rid="msad234-B5" ref-type="bibr">Allio et al. (2021)</xref>, the same as for the biological dataset (next point). To be usable in SimPhy, we transformed the tree to ultrametric with function <italic toggle="yes">chronos</italic> in ape (<xref rid="msad234-B31" ref-type="bibr">Paradis and Schliep 2019</xref>) and we rescaled the branch lengths so that the root-to-tip distance reflected (roughly) the number of generations, i.e. 8,899,579 generations in this case. This value was obtained by dividing the age of the root of the tree (74 millions years old, [<xref rid="msad234-B22" ref-type="bibr">Kumar and Subramanian 2002</xref>]) with a rough estimate of the generation time in Carnivora (8.315 yr if taking the median of the generation times of the species studied in <xref rid="msad234-B47" ref-type="bibr">van de Kerk et al. 2013</xref>).</p>
          <p>For each replicate (100 each time), collections of 500 gene trees were simulated by setting the rate of HGT to 1e-8, the tree-wide substitution rate to 2.2e-9, and varying the level of ILS by changing the population size: 10 (NO-ILS), 100,000 (LOW-ILS), 200,000 (MODERATE-ILS), 500,000 (HIGH-ILS; the detailed commands used for Simphy are given as <xref rid="sup1" ref-type="supplementary-material">supplementary method, Supplementary Material</xref> online). Then, from the 500 trees obtained, only 100 were retained, randomly sampled among those where at most one HGT occurred (to allow unequivocal identification of outliers), and for which the transfer (if any) changed the topology of the gene tree. The whole process was repeated three times, varying the maximum number of outliers allowed per gene, between 1, 10, and 53 (theoretical max). This allowed exploring the impact of the number of outliers per gene (linked here to the age of the HGT) on the capacity to correctly identify outliers, i.e. the species that were changing position relative to the species tree because of HGT. For ILS, it was not possible to identify precisely what species should be considered outliers or not. We could only look at the impact of ILS on the mean topological distance between the collection of gene trees and the species tree (mean RF distance between 3 for NO-ILS and more than 20 for HIGH-ILS, see <xref rid="sup1" ref-type="supplementary-material">supplementary fig. S1, Supplementary Material</xref> online) and evaluate whether this had an impact or not on the precision and sensibility of our method.</p>
        </sec>
        <sec id="msad234-s1.2.1.3">
          <title>Carnivora Dataset (CD)</title>
          <p>We used the raw sequence files (before alignment and filtering) from a previously assembled phylogenomic dataset comprising 14,463 genes for 53 species aimed at resolving the phylogeny of the order Carnivora (<xref rid="msad234-B5" ref-type="bibr">Allio et al. 2021</xref>). This dataset was obtained by extracting single-copy protein-coding orthologous genes from the genomes of 52 carnivore species, plus the Malayan pangolin (<italic toggle="yes">Manis javanica</italic>) used as outgroup, following the orthology delineation strategy of the OrthoMaM database (<xref rid="msad234-B43" ref-type="bibr">Scornavacca et al. 2019</xref>). These raw sequence files were aligned and filtered using the OMM_MACSE pipeline (<xref rid="msad234-B36" ref-type="bibr">Ranwez et al. 2021</xref>), which combines (i) translated nucleotide sequence alignment at the amino acid level with MAFFT (<xref rid="msad234-B21" ref-type="bibr">Katoh and Standley 2013</xref>), (ii) nucleotide alignment refinement (based on amino acid alignment) with MACSE v2 (<xref rid="msad234-B37" ref-type="bibr">Ranwez et al. 2018</xref>) to handle frameshifts and nonhomologous sequences (<xref rid="msad234-B37" ref-type="bibr">Ranwez et al. 2018</xref>), and (iii) masking of ambiguously aligned and dubious parts of sequences with HMMcleaner (<xref rid="msad234-B16" ref-type="bibr">Di Franco et al. 2019</xref>). In the original study (<xref rid="msad234-B5" ref-type="bibr">Allio et al. 2021</xref>), this Carnivora dataset was successfully filtered using an early version of PhylteR allowing the removal of outlier sequences and genes generating abnormally long branches. Therefore, it was a good candidate dataset to test the completely redesigned and improved version of PhylteR presented here.</p>
        </sec>
      </sec>
      <sec id="msad234-s1.2.2">
        <title>Evaluation of the Accuracy of PhylteR Outlier Detection and Comparison With TreeShrink</title>
        <p>We evaluated PhylteR's ability to detect outliers that are either correct (when it is possible to test it, with simulated datasets) or meaningful according to the biological information we can gather from the dataset at hand.</p>
        <p>We used the first simulated dataset for illustration purposes only. For the other simulated datasets, i.e. for each level of ILS, for different maximum numbers of outlier species per gene (1, 10, and 53), and for each one of the 100 replicates, we ran PhylteR with default parameters and we counted the number of True Positives (TP, outliers that were simulated and that are retrieved), False Positives (FP, outliers that were not simulated but are identified) and False Negative (FN, outliers that were simulated but are not retrieved). From those, we computed the mean precision (TP/[TP + FP]) and recall (or sensitivity, TP/[TP + FN]) of the outlier identification of PhylteR. An estimate of the expected precision and recall when the same numbers of outliers were randomly sampled was also computed. To evaluate the impact of ILS-induced incongruences between gene trees on the ability of PhylteR to correctly identify outliers, precision, and recall were computed and compared between the four levels of ILS simulated (NO-ILS, LOW-ILS, MODERATE-ILS, and HIGH-ILS). Finally, for comparison purposes we performed the same analyses using TreeShrink v1.3.9 (<xref rid="msad234-B27" ref-type="bibr">Mai and Mirarab 2018</xref>) in place of PhylteR with default parameters for detecting outliers.</p>
        <p>For the Carnivora dataset, we have no access to the <italic toggle="yes">true</italic> outliers. It is thus impossible to compute precision and recall on this empirical dataset as done on the simulated ones. Instead, we can compute “features” associated with each gene sequence for each species (<italic toggle="yes">sequence</italic> hereafter), that are, a priori, associated with errors or with a lack of signal in phylogenomic datasets. We can then evaluate whether the outliers detected by PhylteR are enriched in extreme values for these features, as compared with randomly selected sequences or with outliers identified with TreeShrink. The list of features and the reason for their choice is listed below.</p>
        <sec id="msad234-s1.2.2.1">
          <title>Sequence Length</title>
          <p>Long sequences were shown to carry more phylogenetic signal than shorter ones (<xref rid="msad234-B41" ref-type="bibr">Salichos and Rokas 2013</xref>; <xref rid="msad234-B45" ref-type="bibr">Shen et al. 2016</xref>). To explore the possible enrichment of outliers in short sequences, we computed the length (in bp) of each sequence in each gene MSA, and explored its distribution in outliers.</p>
        </sec>
        <sec id="msad234-s1.2.2.2">
          <title>Duplication Score</title>
          <p>When a sequence in a gene tree is not orthologous to the others but is a paralog, its localization in the gene tree is likely to be incorrect. To have an insight into the level of “paralogousness” of each sequence in the Carnivora dataset, we compared the Carnivora species tree published by <xref rid="msad234-B5" ref-type="bibr">Allio et al. (2021)</xref> with each one of the 14,463 gene trees using the reconciliation program <italic toggle="yes">ALEml_undated</italic> (<xref rid="msad234-B46" ref-type="bibr">Szöllősi et al. 2015</xref>). This tool allows inferring the duplications, losses, and transfers experienced by a gene by comparing its history (the gene tree) with that of the species (the species tree). Here we inferred only duplications and losses (transfer rate was forced to be 0), we forced the origination of each gene at the root of the species tree (parameter O_R = 10,000) and we used default values for all other parameters. We then computed the number of duplications inferred from the root to each tip of each gene tree and normalized this value by the number of nodes encountered. This value represents the normalized number of duplications experienced by each sequence, whose distribution in outliers could be evaluated.</p>
        </sec>
        <sec id="msad234-s1.2.2.3">
          <title>Hidden Paralogy, the KRAB Zinc Finger Protein Family Case</title>
          <p>The KRAB Zinc Finger (KZNF) super-family is actively duplicating in vertebrates with hundreds of paralogs per genome (<xref rid="msad234-B19" ref-type="bibr">Huntley et al. 2006</xref>; <xref rid="msad234-B24" ref-type="bibr">Liu et al. 2014</xref>). Thus, the orthologous relationships between these proteins are expected to be hard to retrieve and the reconstructed orthologous gene families are likely to contain hidden-paralogs. If an outlier detection method is indeed able to remove hidden paralogs, we should see an enrichment of KZNF genes in the list of outliers.</p>
        </sec>
        <sec id="msad234-s1.2.2.4">
          <title>Synteny</title>
          <p>Synteny (in our sense) is the link between two genes occurring consecutively on a genome, i.e. without any other gene (in the dataset) located between them. One gene then has 2 synteny linkages. A synteny <italic toggle="yes">break</italic> occurs when 2 genes are consecutive in one species but their orthologs in another species are not. The direction of transcription (coding strand) is considered, i.e. if it has changed it is considered as a break even if the genes appear in the same order. One gene, compared to its ortholog in another species, may then be associated with 0, 1, or 2 breaks. We call genes associated with 2 breaks <italic toggle="yes">syntenic outliers</italic>. We test if outliers found by PhylteR are more often syntenic outliers than randomly sampled genes. Our rationale behind this question is that synteny breaks are due to genomic rearrangements (inversions, duplications, translocations, …), but can occur in the data, and in much larger proportion, for many artifactual reasons: annotation errors, assembly errors, or orthology assessment errors. These different sources of errors are expected to lead to phylogenetic placement errors for the species carrying the affected genes. We thus formulate the hypothesis that outlier genes may be more often associated with synteny breaks than randomly sampled genes. To evaluate this, we focused on 14 Carnivora genomes (<xref rid="sup1" ref-type="supplementary-material">supplementary table S1, Supplementary Material</xref> online) that we compared in a pairwise manner. For each pair, we compared the list of syntenic outliers with the list of outliers retrieved by each outlier method tested, and we computed the <italic toggle="yes">P</italic>-value associated with the observed size of the intersection under the hypothesis that the two sets of outliers are independent.</p>
          <p>In order to compare the distributions of values for the different features listed above between outlier detection methods, we needed lists of outliers of comparable size. The number of outliers retrieved with default parameters being very different with the two methods using default parameters (7,183 with PhylteR vs. 19,643 with TreeShrink, see <xref rid="msad234-T1" ref-type="table">Table 1</xref>), we created two collections of outliers, a <bold>small</bold> and a <bold>large</bold> one (<xref rid="msad234-T1" ref-type="table">Table 1</xref>). For the <bold>small</bold> collection, we selected a value for the parameter <italic toggle="yes">q</italic> in TreeShrink in order to get a number of outliers as close as possible to the number of outliers obtained with PhylteR default parameters. This was achieved for <italic toggle="yes">q</italic> = 0.012, leading to 7,032 outliers. For the <bold>large</bold> collection, we selected a value of the <italic toggle="yes">k</italic> (and <italic toggle="yes">k</italic> = <italic toggle="yes">k2</italic>) parameter in PhylteR leading to a number of outliers as close as possible to the number of outliers detected with TreeShrink default parameters. This was achieved for <italic toggle="yes">k</italic> = 1.55, leading to 20,157 outliers. Parameters used and number of outliers in each collection and with each outlier detection method are presented in <xref rid="msad234-T1" ref-type="table">Table 1</xref>.</p>
          <table-wrap position="float" id="msad234-T1">
            <label>Table 1</label>
            <caption>
              <p>Collections of outliers used to evaluate PhylteR and compare it to TreeShrink</p>
            </caption>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col align="left" valign="top" span="1"/>
                <col align="left" valign="top" span="1"/>
                <col align="left" valign="top" span="1"/>
                <col align="left" valign="top" span="1"/>
                <col align="left" valign="top" span="1"/>
                <col align="left" valign="top" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <th align="left" rowspan="2" colspan="1">Collections</th>
                  <th align="center" colspan="2" rowspan="1">PhylteR</th>
                  <th align="center" colspan="2" rowspan="1">TreeShrink</th>
                  <th align="center" rowspan="1" colspan="1">Random</th>
                </tr>
                <tr>
                  <th align="left" rowspan="1" colspan="1">Parameters</th>
                  <th align="center" rowspan="1" colspan="1"># outliers</th>
                  <th align="center" rowspan="1" colspan="1">Parameters</th>
                  <th align="center" rowspan="1" colspan="1"># outliers</th>
                  <th align="center" rowspan="1" colspan="1"># outliers</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td rowspan="1" colspan="1">
                    <bold>Small</bold>
                  </td>
                  <td rowspan="1" colspan="1">
                    <italic toggle="yes">default</italic>
                  </td>
                  <td rowspan="1" colspan="1">7,183</td>
                  <td rowspan="1" colspan="1"><italic toggle="yes">q</italic> = 0.012</td>
                  <td rowspan="1" colspan="1">7,032</td>
                  <td rowspan="1" colspan="1">7,183</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">
                    <bold>Large</bold>
                  </td>
                  <td rowspan="1" colspan="1"><italic toggle="yes">k</italic> = <italic toggle="yes">k</italic>2 = 1.55</td>
                  <td rowspan="1" colspan="1">20,157</td>
                  <td rowspan="1" colspan="1">
                    <italic toggle="yes">default</italic>
                  </td>
                  <td rowspan="1" colspan="1">19,643</td>
                  <td rowspan="1" colspan="1">20,157</td>
                </tr>
              </tbody>
            </table>
            <table-wrap-foot>
              <fn id="tblfn1">
                <p>The <bold>small</bold> collection is obtained by tuning the TreeShrink parameters in order to obtain roughly the same number of outliers as with the default parameters of PhylteR. The <bold>large</bold> collection is obtained in the opposite way.</p>
              </fn>
            </table-wrap-foot>
          </table-wrap>
        </sec>
      </sec>
      <sec id="msad234-s1.2.3">
        <title>Evaluation of the Impact of Outlier Sequences Removal on Species Tree Support</title>
        <p>It is expected that a tool that accurately removes outliers in phylogenomic datasets should increase the concordance between the gene trees and the species tree. To evaluate this and compare PhylteR with randomly sampled sequences and with TreeShrink-identified outliers, we computed the gene concordance factor (gCF, <xref rid="msad234-B29" ref-type="bibr">Minh, Hahn, et al. 2020</xref>) as implemented in IQ-TREE version 2.1.3 (<xref rid="msad234-B30" ref-type="bibr">Minh, Schmidt, et al. 2020</xref>) for every branch in the Carnivora species tree (obtained from <xref rid="msad234-B5" ref-type="bibr">Allio et al. 2021</xref>). For each branch of the species tree, this factor indicates the percentage of gene trees in which this branch is found (among gene trees where this can be computed, or “decisive” trees, see <xref rid="msad234-B29" ref-type="bibr">Minh, Hahn, et al. 2020</xref>). gCF was computed according to either the original gene trees (gCF<sub>init</sub>), or to a list of gene trees obtained after pruning outliers (4 sets of gene trees corresponding to the four list of outliers in <xref rid="msad234-T1" ref-type="table">Table 1</xref>).</p>
        <p>In order to see the effect of outliers removal on the concordance factor, we computed the difference (ΔgCF) between gCF<sub>init</sub> and every other gCF, separating the small and the large collections of outliers. Positive values of ΔgCF indicate that a branch is more supported after filtering than before. Comparing ΔgCF between PhylteR and TreeShrink gives an indication of whether, for the same total number of outliers removed, PhylteR performs better than TreeShrink at identifying sequences with conflicting phylogenetic signals and increasing the concordance between the species tree and the gene trees.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="results" id="msad234-s2">
    <title>Results</title>
    <sec id="msad234-s2.1">
      <title>Illustration of the General Principle of PhylteR</title>
      <p>The different steps of the PhylteR process (<xref rid="msad234-F1" ref-type="fig">Fig. 1</xref>) are illustrated on a simple example dataset comprising 25 genes for 20 species, with 10 outliers. The main steps are as follows. Individual gene trees are transformed into individual gene matrices that are then combined into a unique <italic toggle="yes">compromise</italic> matrix obtained after weighting each matrix by its concordance with the others: matrices that are poorly correlated with the others have less weight in the creation of the compromise (<xref rid="sup1" ref-type="supplementary-material">supplementary fig. S3A-E, Supplementary Material</xref> online). This matrix is then projected onto a space on which individual matrices are projected as well (<xref rid="msad234-F2" ref-type="fig">Fig. 2A</xref> and <xref rid="sup1" ref-type="supplementary-material">supplementary fig. S3F, Supplementary Material</xref> online). By computing the distance of each species in each orthologous gene to its reference position in this projection, the 2WR is obtained (<xref rid="msad234-F2" ref-type="fig">Fig. 2B</xref> and <xref rid="sup1" ref-type="supplementary-material">supplementary fig. S3G, Supplementary Material</xref> online). It is from this matrix that outlier sequences can be identified and removed.</p>
      <fig position="float" id="msad234-F2" fig-type="figure">
        <label>Fig. 2.</label>
        <caption>
          <p>Two objects of the PhylteR process. a) The compromise matrix is projected into a multidimensional space (the 2 first axes only are represented here). This gives the reference position of each species relative to each other (blue badges with species names on them). Individual gene matrices are projected on the same space (small dots) and the distance between each gene in each species to its reference position is represented by a line. The red line and the red arrow identify species t3 in gene 5. This projection is transformed into a 2D matrix <bold>b)</bold> by computing the distance between each species in each gene to its reference position (i.e. the length of each line in a). The gene × species matrix obtained, which we refer to as the2WR is used to detect outliers like the one indicated by thered arrow, corresponding to the red arrow in a.</p>
        </caption>
        <graphic xlink:href="msad234f2" position="float"/>
      </fig>
    </sec>
    <sec id="msad234-s2.2">
      <title>PhylteR Performs Well on Simulated Examples and is Robust to ILS-induced Incongruences</title>
      <p>To evaluate the precision and sensitivity of PhylteR, we used it on four simulated datasets with increasing levels of ILS (NO-ILS, LOW-ILS, MODERATE-ILS, and HIGH-ILS). We also computed precision and recall on the same datasets using another method, TreeShrink (<xref rid="msad234-B27" ref-type="bibr">Mai and Mirarab 2018</xref>). Finally, we computed the expected precision and sensitivity if the same number of sequences identified as outliers by PhylteR and TreeShrink were randomly selected from all sequences.</p>
      <p>The outliers that we considered were single species whose position was moved to a new location in some gene trees because of HGTs. For this type of outliers, we observe that PhylteR performs well, with precision and recall being close to their maximum value 1 (<xref rid="msad234-F3" ref-type="fig">Fig. 3</xref>). On the other hand, TreeShrink performs badly, identifying few correct outliers (leading to a mean precision close to 0), but still detecting a large collection of FP (leading to a low sensitivity). When increasing the maximum number of outlier species in each gene tree to 10 (<xref rid="sup1" ref-type="supplementary-material">supplementary fig. S2A, Supplementary Material</xref> online) or to 53 (<xref rid="sup1" ref-type="supplementary-material">supplementary fig. S2B, Supplementary Material</xref> online), we observe that both the precision and sensitivity of PhylteR slightly decrease while the ones of TreeShrink increase, but the difference between both remains in the clear advantage of PhylteR (in this specific setting).</p>
      <fig position="float" id="msad234-F3" fig-type="figure">
        <label>Fig. 3.</label>
        <caption>
          <p>Comparison of the precision and recall (or sensitivity) of the PhylteR and the TreeShrink outlier detection methods for four conditions of ILS.</p>
        </caption>
        <graphic xlink:href="msad234f3" position="float"/>
      </fig>
      <p>Of note, the level of ILS has almost no effect on the precision and sensitivity of the PhylteR (and TreeShrink, even though a negative effect would be hard to see when starting from such low precision and sensitivity values), except when reaching very high ILS (bottom-right panels in <xref rid="msad234-F3" ref-type="fig">Fig. 3</xref> and <xref rid="sup1" ref-type="supplementary-material">supplementary fig. S2A and S2B, Supplementary Material</xref> online). In other words, even when the mean topological distance between the gene trees and the species tree is multiplied by more than 5, as is the case between the NO-ILS and the MODERATE-ILS conditions (<xref rid="sup1" ref-type="supplementary-material">supplementary fig. S1, Supplementary Material</xref> online), the precision and sensitivity of PhylteR for detecting the outliers simulated by HGTs do not decrease. This suggests that PhylteR does not consider species that have changed position in some gene trees due to ILS as outliers. This apparent robustness of PhylteR to ILS can be seen as a desirable feature, e.g. when using species tree reconstruction tools that explicitly handle ILS such as ASTRAL (<xref rid="msad234-B51" ref-type="bibr">Zhang et al. 2018</xref>).</p>
    </sec>
    <sec id="msad234-s2.3">
      <title>Characterization of Outliers Detected With PhylteR on the Carnivora Dataset</title>
      <p>Outliers in phylogenomic datasets can be of different nature: fast or slow evolving genes in some species, leading to respectively long or short branches in gene trees, or species being placed in aberrant position in some genes because of HGT, hidden paralogy, saturated signal, compositional bias, long-branch attraction, or other artifactual reasons (<xref rid="msad234-B42" ref-type="bibr">Schrempf and Szöllősi 2020</xref>).</p>
      <p>In the set of 14,463 gene trees analysed by PhylteR, two sets of outliers (7,183 and 20,157 sequences) were identified with PhylteR (with default or tuned parameters, respectively) and 7,032 and 19,643 with TreeShrink (with tuned and default parameters respectively, see <xref rid="msad234-T1" ref-type="table">Table 1</xref>). A simple comparison of the list of outliers of similar sizes revealed that the overlap between the two lists of outliers was quite small (around 20%, <xref rid="msad234-F4" ref-type="fig">Fig. 4</xref>). This corresponds to about 70% of the outliers detected by PhylteR being absent from the list of outliers detected by TreeShrink, and vice versa. This reveals fundamental differences between the 2 approaches.</p>
      <fig position="float" id="msad234-F4" fig-type="figure">
        <label>Fig. 4.</label>
        <caption>
          <p>Comparison of the sets of outliers detected by PhylteR (left column) and TreeShrink (write column) on the Carnivora dataset. The two collections of outliers (small and large) correspond to different stringency for the detection of outliers (see <xref rid="msad234-T1" ref-type="table">Table 1</xref>).</p>
        </caption>
        <graphic xlink:href="msad234f4" position="float"/>
      </fig>
      <p>To better understand what differs between the outliers detected by PhylteR and those detected by TreeShrink, we compared the distribution values of different features describing these outlier sequences.</p>
      <p>First, we observed a significant decrease in sequence length in outlier sequences for both PhylteR and TreeShrink as compared to randomly sampled sequences (<italic toggle="yes">P</italic> &lt; 2.2e-16 in both cases and for both collections of outliers, <xref rid="msad234-F5" ref-type="fig">Fig. 5A</xref>). Sequence lengths were higher in PhylteR outliers than in TreeShrink outliers for the small collection of outliers (<italic toggle="yes">P</italic> &lt; 2.2e-16) but the opposite was observed for the large collection of outliers (<italic toggle="yes">P</italic> &lt; 3.17e-14). The fact that outliers are enriched in short sequences is thought to be due to the expected correlation between the size of a sequence and the phylogenetic signal it carries. Shorter sequences are more prone to misplacement in phylogenetic trees.</p>
      <fig position="float" id="msad234-F5" fig-type="figure">
        <label>Fig. 5.</label>
        <caption>
          <p>Comparison of distribution values between outliers detected by PhylteR, by TreeShrink, or randomly sampled, for three features associated with outlierness in phylogenomic datasets. a) Distribution of the length (in bp) of the sequence outliers identified by each method. A log scale is used for the y-axis. b) Distribution of duplication scores (normalized number of duplications experienced by each sequence) for the outliers identified by each method. c) Proportion of outliers being members of the KRAB-ZNF protein family for the outliers identified by each method. The two collections of outliers (small and large) are compared in each case (left and right on each panel).</p>
        </caption>
        <graphic xlink:href="msad234f5" position="float"/>
      </fig>
      <p>Second, we compared the distribution of duplication scores in the list of outliers produced by PhylteR and TreeShrink (<xref rid="msad234-F5" ref-type="fig">Fig. 5B</xref>). We observed a clear difference, for both the small and the large collections of outliers between PhylteR outliers and random outliers, but also between PhylteR outliers and TreeShrink outliers: outliers identified by PhylteR are significantly enriched in sequences that display a higher number of duplications as compared to random or TreeShrink outliers (<italic toggle="yes">P</italic> &lt; 2.2e-16 for all comparisons).</p>
      <p>This result is in accordance with the results obtained on simulated datasets: PhylteR is good (and much better than TreeShrink) at identifying misplaced species in some gene trees, which is indirectly what the duplication score captures.</p>
      <p>One illustration of the difference between PhylteR and TreeShrink in their ability to capture duplicated sequences (and thus probably hidden paralogues) can be given by the study of peculiar proteins, such as the Zinc-finger family (ZNF). This large family of paralogs first duplicated from the gene PRDM9 or PRDM7 in the ancestor of vertebrates (<xref rid="msad234-B17" ref-type="bibr">Emerson and Thomas 2009</xref>). These genes are involved in the repression of transposable elements and are still actively duplicating. The high number of duplications renders the resolution of the orthology relationship in this gene super-family very challenging. In the Carnivora dataset, the ZNF super-family has been splitted in 168 orthologous gene families (<xref rid="msad234-B5" ref-type="bibr">Allio et al. 2021</xref>). As expected in case of hidden paralogy, we see an overrepresentation of the genes belonging to these families in the list of outliers, especially in the outliers identified by PhylteR (<xref rid="msad234-F5" ref-type="fig">Fig. 5C</xref>). Between 3.79% (for the large set) and 7.4% (for the small set) of PhylteR outliers belong to the ZNF family, while these values drop to 1.78% and 1.12%, respectively for TreeShrink outliers, and less than 1% for randomly selected sequences (<xref rid="msad234-F5" ref-type="fig">Fig. 5C</xref>).</p>
      <p>Third, we compared two by two 14 Carnivora species and identified syntenic outliers (see material and methods). In almost all pairwise comparisons, we found that these syntenic outliers significantly overlap the outlier sequences detected by PhylteR. For example, in the comparison between <italic toggle="yes">Zalophus californianus</italic> and <italic toggle="yes">Suricata suricatta</italic> (illustrated in <xref rid="msad234-F6" ref-type="fig">Fig. 6</xref>), out of the 5,123 genes common to both species in the dataset, 131 (2.56%) are syntenic outliers (i.e. surrounded by 2 breaks). In comparison, out of the 47 outlier sequences identified by PhylteR (small list) in either <italic toggle="yes">Zalophus californianus</italic> or <italic toggle="yes">Suricata suricatta</italic>, 38 are syntenic outliers (80.8%), which is significantly more than expected by chance (<italic toggle="yes">P</italic>-value = 1.5e-43). With TreeShrink (small list) for the same pair of species, only 18.1% (17 out of 94) outlier sequences are syntenic outliers, which is much less than with PhylteR but is still significantly different from what is expected by chance (<italic toggle="yes">P</italic>-value = 1.36e-10). Similar results were obtained for most of the other pairs of species compared (<xref rid="sup1" ref-type="supplementary-material">supplementary fig. S4, Supplementary Material</xref> online and <xref rid="sup1" ref-type="supplementary-material">supplementary tables S2 and S3, Supplementary Material</xref> online).</p>
      <fig position="float" id="msad234-F6" fig-type="figure">
        <label>Fig. 6.</label>
        <caption>
          <p>Illustration of the nonsyntenic nature of many outliers identified by PhylteR. We represent the comparison of <italic toggle="yes">Zalophus californianus</italic> with <italic toggle="yes">Suricata suricatta</italic> genomes, with <italic toggle="yes">Zalophus</italic> as a reference (arbitrarily, most other pairs of species give similar results). On each circle, a reference <italic toggle="yes">Zalophus</italic> scaffold is represented in dark blue, and all scaffolds for which at least one gene has an ortholog in this scaffold are in light gray. Lines between these scaffolds represent couples of genes annotated as orthologous. Red lines highlight gene outliers detected in <italic toggle="yes">Suricata suricatta</italic>. We observe that they are very often “isolated” genes, i.e. syntenic outliers. These genes are thus probably erroneously annotated, erroneously assembled, and their orthology is likely erroneous.</p>
        </caption>
        <graphic xlink:href="msad234f6" position="float"/>
      </fig>
    </sec>
    <sec id="msad234-s2.4">
      <title>Impact of Filtering Outliers on Species Tree Support</title>
      <p>The gCF is a measure, for a species tree, of how much each one of its branches is supported according to a collection of individual gene trees. A value of 100% means that 100% of the gene trees for which the comparison could be done (“decisive” gene trees in <xref rid="msad234-B29" ref-type="bibr">Minh, Hahn, et al. 2020</xref>) contain this branch.</p>
      <p>Nonrandom outlier removal processes are expected to increase gCF scores by discarding sequences representing species in gene trees whose position is not in accordance with their placement in the other gene trees. We looked at the difference in gCF score before and after pruning outliers (ΔgCF) for each branch of the Carnivora species tree. For both PhylteR and TreeShrink, an increase in gene concordance was observed. It was higher with PhylteR than with TreeShrink, indicating a better identification of misplaced species in gene trees for PhylteR. The effect was larger when more outliers were removed (<xref rid="msad234-F7" ref-type="fig">Fig. 7</xref>, right), the gain in gCF reaching more than 6% for some branches with PhylteR outliers removal (max 5% for TreeShrink). We observed that the gain in concordance was higher for branches that initially had a high gCF, and smaller for poorly supported nodes (plain dots vs. circles in <xref rid="msad234-F7" ref-type="fig">Fig. 7</xref>). This may be due to an easier identification of outliers on a “clean” background (many gene trees supporting the same node, leading to high gCF) than on a more noisy one.</p>
      <fig position="float" id="msad234-F7" fig-type="figure">
        <label>Fig. 7.</label>
        <caption>
          <p>Effect of filtering outliers in gene trees on the gCF of each branch of the Carnivora species tree. The gain in concordance (ΔgCF, y-axis) is plotted for each branch of the species tree (dots), separating PhylteR (pink) and TreeShrink (blue). Branches are ordered by increasing ΔgCF for the PhylteR outliers. The results for the two collections of outliers (small and large) are displayed side by side.</p>
        </caption>
        <graphic xlink:href="msad234f7" position="float"/>
      </fig>
      <p>Note that gCF, which captures topological differences between the gene trees and the species tree, exhibits a notable increase but does not attain its maximum value. This observation might be indicative of some of the incongruences between gene and species trees within the Carnivora dataset to be attributed to ILS. These potential ILS-related incongruences appear not to be identified as outliers by PhylteR, as suggested by the results of our simulations (see above).</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="msad234-s3">
    <title>Discussion</title>
    <p>In phylogenomics, incongruence between gene trees, resulting from a myriad of possible technical and analytical issues, or from biological processes, is known to lead to errors in species tree inference (<xref rid="msad234-B33" ref-type="bibr">Philippe et al. 2017</xref>). A common practice in phylogenomics thus consists of scanning individual gene trees by eye, trying to spot species or group of species weirdly placed in gene trees, suspicious long branches, apparent groups of paralogues, etc., and discarding them before the concatenation of the genes (supermatrix approach) or to the assembly of the gene trees into a species tree (supertree and coalescent-based approaches). This hard work is not only time-consuming and laborious, it is also questionable: what is the objectivity in this practice? Is the eye (and the brain) capable of looking at tens of thousands of gene trees at the same time? How reproducible is such a practice? etc.</p>
    <p>Here, with PhylteR, we propose a way of analyzing large collections of gene trees by using an automatic method that can simultaneously analyse a large collection of distance matrices (retrieved from gene trees), identify the common signal between these matrices, and identify elements (outliers) in some of these matrices that are responsible for a decrease in concordance. By using a process where these outliers are automatically and iteratively removed, we propose a new way of efficiently identifying them.</p>
    <p>Evaluating a method for its capacity to accurately identify errors in phylogenomics datasets is a difficult task. As for any inference method, we use simulations. However, simulating the processes that result in errors (in our case, outliers in phylogenomics data) has no standard solution: sources of errors are numerous, and they combine with each other through all phylogenomic pipelines, sometimes with unpredictable results. So we restricted ourselves to simulating a feature intrinsically detectable by PhylteR, that is, changes in the phylogenetic placements of some species in some gene trees. Further evaluation would involve an independent simulation pipeline, not informed by the hypothesis behind the inference method (<xref rid="msad234-B8" ref-type="bibr">Biller et al. 2016</xref>), which is by definition outside the scope of the description of the inference method. The simple simulations we performed revealed that outliers corresponding to misplacement of species in a few gene trees were easy to detect with PhylteR but not with TreeShrink. However, this is not surprising <italic toggle="yes">a posteriori</italic>: TreeShrink (<xref rid="msad234-B27" ref-type="bibr">Mai and Mirarab 2018</xref>) is designed to detect abnormally long branches in collection of gene trees, while we considered here as outliers species that changed position in some gene trees because of HGTs; these outliers are not necessarily associated with longer branches.</p>
    <p>A better way to examine the advantages of a method over another is to explore biological data. To this end, we evaluated PhylteR and compared it with TreeShrink by looking at some properties associated with gene sequences and testing possible enrichment of these properties in the list of detected outliers. We observed an enrichment of short sequences, which was anticipated (short sequences carry less phylogenetic signal) and confirmed previous results (<xref rid="msad234-B45" ref-type="bibr">Shen et al. 2016</xref>).</p>
    <p>A notable difference that we observed between PhylteR and TreeShrink, confirming the results obtained on the simple simulated examples, is the duplication score computed here: outliers identified with PhylteR seemed to be highly enriched in gene sequences having experienced more duplications, according to the reconciliation analysis performed. Note, however, that we need to be cautious with this measure: being based solely on a topological comparison between gene and species trees, it cannot distinguish between true paralogy, and other processes (biological or artefactual) leading to a species in a gene tree to have a position that is not concordant with its position in the other gene trees. HGT for instance, may lead to high duplication scores according to our approach when none occurred (even though HGT is thought to be anecdotal in the Carnivora dataset). Similarly, artefactual reasons such as long branch attraction, annotation error or alignment error can lead to misplacements of species in some gene trees.</p>
    <p>A more direct way of testing the ability of PhylteR to detect hidden paralogous sequences was to focus on a specific gene family known to be extremely diverse because of multiple duplication events, the KZNF family (<xref rid="msad234-B19" ref-type="bibr">Huntley et al. 2006</xref>; <xref rid="msad234-B24" ref-type="bibr">Liu et al. 2014</xref>). We observed a clear enrichment of sequences belonging to this peculiar family in the list of outlier sequences identified by PhylteR, as compared to those identified by TreeShrink or randomly sampled. This capacity of PhylteR to identify putative paralogs is an important feature, as it was shown earlier that nonorthologous sequences in phylogenomic datasets could have a drastic impact on results (<xref rid="msad234-B33" ref-type="bibr">Philippe et al. 2017</xref>), leading for instance to erroneous branching with high support in the reconstructed species tree in some cases (<xref rid="msad234-B32" ref-type="bibr">Philippe et al. 2011</xref>).</p>
    <p>A final test that we used to validate PhylteR consisted of exploring the syntenic nature (and lack thereof) of the sequences identified as outliers when comparing the species in a pairwise manner. We observed that outlier sequences were often (much more than expected by chance) syntenic-outliers, i.e. sequences associated with a loss of synteny when comparing the two genomes. This provides two kinds of information: on one side, that the “syntenic outliers” and the “phylogenetic outliers” largely overlap, which proves with an argument orthogonal to all the previous ones, that PhylteR (and TreeShrink to a lesser extent) captures an information about erroneous annotations; on the other side, it suggests that many “syntenic outliers” are due to errors and not to biological processes. “Syntenic outliers” are often filtered out before performing rearrangement analyses, because their position is believed to be artefactual (<xref rid="msad234-B26" ref-type="bibr">Lucas and Crollius 2017</xref>). However, sometimes this outlier position is modeled as the result of a biological process (<xref rid="msad234-B13" ref-type="bibr">Dalevi and Eriksen 2008</xref>). Our analysis supports this artifactual origin in Carnivora, though some syntenic outliers might originate from retrotranscription or translocations.</p>
    <p>ILS is a known source of incongruence among gene trees and between gene trees and the species tree. This biological process, where ancestral polymorphism is maintained across various speciation events, leads to different portions of the genomes having different evolutionary histories. With simulations we could vary the level of ILS in the datasets and evaluate the impact it had on the ability of PhyleR (and TreeShrink) to correctly identify outliers. For both methods, we saw no effect of increasing the level of ILS on the precision and sensitivity values. For TreeShrink, it is hard to conclude anything, because the initial values were very low (close to 0) so any negative effect would have been undetectable. For PhylteR however, where precision and sensitivity were high, this absence of effect reveals that PhylteR does not detect sequences that have experienced ILS as outliers. Whether this is positive or negative can be discussed. On the one hand, it was shown earlier that ILS-related incongruences among gene trees could have a detrimental effect on species tree reconstruction with supermatrix approaches (<xref rid="msad234-B14" ref-type="bibr">Degnan and Rosenberg 2006</xref>). On the other hand, ILS-induced incongruence is a true biological signal that many species tree inference methods, namely the coalescence-based ones, can now handle (<xref rid="msad234-B25" ref-type="bibr">Liu et al. 2010</xref>; <xref rid="msad234-B51" ref-type="bibr">Zhang et al. 2018</xref>). In this context, getting rid of these incongruences may be seen as detrimental, because it removes a meaningful signal that can be accommodated by these methods. However, the real contribution of ILS to gene tree incongruences is something that is rarely measured, but in mammals, for instance, it was shown to be rare (<xref rid="msad234-B44" ref-type="bibr">Scornavacca and Galtier 2016</xref>). We can advance two reasons why PhylteR is not sensitive to ILS. First, ILS preferentially affects short branches of the species tree, i.e. speciation events separated by a short amount of time, which leads to a limited effect in the pairwise distance matrices manipulated by PhylteR. Second, when ILS changes the branching pattern of three clades (or species), it is expected that around 50% of each alternative topology to the true one is observed across all gene trees. When the “compromise” matrix is built in the PhylteR pipeline, this signal will thus likely be averaged out.</p>
    <p>Here we focused on the identification of outliers in collection of gene trees in order to remove them before phylogenetic inference with supermatrix, supertree, or coalescent-based methods. But other usage of the tool we present here can be anticipated. First, because the PhylteR method consists of comparing matrices (in this case phylogenetic distance matrices), it is easy to imagine applying the method without computing gene trees, directly on matrices extracted from multiple sequence alignments (MSA), one matrix per gene. In this sense, comparing PhylteR with MSA-based filtering tools could be a worthwhile follow-up of this work. Second, correctly identifying and removing outliers from phylogenomic datasets could be of interest beyond species tree reconstruction. For instance, it appears to be crucial when using statistical methods based on the ratio of nonsynonymous over synonymous substitution rates (<italic toggle="yes">d<sub>N</sub>/d<sub>S</sub></italic> ratio) to detect adaptive molecular evolution (see <xref rid="msad234-B49" ref-type="bibr">Yang and Bielawski 2000</xref> for a review), or for correctly inferring ancestral sequences (<xref rid="msad234-B50" ref-type="bibr">Yang et al. 1995</xref>) from sequences of extant species. Finally, using a tool like PhylteR is not only useful for cleaning the data. The in-depth exploration of the outliers detected and the study of the reasons why they were detected as such can give important insights into the evolutionary history of these sequences, for instance allowing for the identification of horizontally transferred or duplicated genes.</p>
  </sec>
  <sec id="msad234-s4">
    <title>Conclusion</title>
    <p>We created PhylteR, a tool to explore phylogenomics dataset and detect outlier gene sequences. Instead of fully removing rogue taxa or full outlier gene family, PhylteR precisely identifies what sequences in what gene family should be removed to increase concordance between genes. In doing so it accurately spots gene sequences with low phylogenetic signal, genes with saturated signal leading to long branches, paralogous genes, genes associated with synteny breaks, and other sequences that are dubious in gene phylogenies for any possible reason.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>msad234_Supplementary_Data</label>
      <media xlink:href="msad234_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgments</title>
    <p>Work was funded by ANR Grant 18-CE02-0007 (Sthoriz) to DMDV, ANR Grant 19-CE45-0010 (Evoluthon) to ET, and European Research Council grant ERC-2015-CoG-683257 (ConvergeAnt project) to FD. This is contribution ISEM 2023-255 of the Institut des Sciences de l’Evolution de Montpellier. We thank Mélodie Bastian for help with the simulations and two anonymous reviewers for helpful comments.</p>
  </ack>
  <sec id="msad234-s5">
    <title>Supplementary Material</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary material</xref> is available at <italic toggle="yes">Molecular Biology and Evolution</italic> online.</p>
  </sec>
  <sec sec-type="data-availability" id="msad234-s6">
    <title>Data Availability</title>
    <p>The documented code of PhylteR is available at <ext-link xlink:href="https://github.com/damiendevienne/phylter" ext-link-type="uri">https://github.com/damiendevienne/phylter</ext-link> along with thorough documentation. All data and scripts used in this study are available on the dedicated GitHub repository available at <ext-link xlink:href="https://github.com/damiendevienne/phylter-data/" ext-link-type="uri">https://github.com/damiendevienne/phylter-data/</ext-link>.</p>
    <sec id="msad234-s6.1">
      <title>Software Availability</title>
      <p>PhylteR is a package written in R language (<xref rid="msad234-B38" ref-type="bibr">R Core Team 2023</xref>) available on CRAN (<ext-link xlink:href="https://cran.r-project.org/web/packages/phylter/index.html" ext-link-type="uri">https://cran.r-project.org/web/packages/phylter/index.html</ext-link>) for the latest stable version and on GitHub (<ext-link xlink:href="https://github.com/damiendevienne/phylter" ext-link-type="uri">https://github.com/damiendevienne/phylter</ext-link>) for the latest development version. The latest version of PhylteR is also distributed as a Singularity container (<ext-link xlink:href="https://cloud.sylabs.io/library/theo.treecou/tool/phylter_singularity" ext-link-type="uri">https://cloud.sylabs.io/library/theo.treecou/tool/phylter_singularity</ext-link>) and a docker container (<ext-link xlink:href="https://hub.docker.com/r/treecoutheo/phylter_docker" ext-link-type="uri">https://hub.docker.com/r/treecoutheo/phylter_docker</ext-link>). Extensive documentation can be found at <ext-link xlink:href="https://damiendevienne.github.io/phylter/index.html" ext-link-type="uri">https://damiendevienne.github.io/phylter/index.html</ext-link>.</p>
    </sec>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="msad234-B1">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Abdi</surname>  <given-names>H</given-names></string-name>, <string-name><surname>O’Toole</surname>  <given-names>AJ</given-names></string-name>, <string-name><surname>Valentin</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Edelman</surname>  <given-names>B</given-names></string-name></person-group>. <year>2005</year>. <comment>DISTATIS: The analysis of multiple distance matrices. In: 2005 IEEE Computer Society Conference on Computer Vision and Pattern Recognition (CVPR’05)-Workshops. IEEE. p. 42–42</comment>.</mixed-citation>
    </ref>
    <ref id="msad234-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Abdi</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Williams</surname>  <given-names>LJ</given-names></string-name>, <string-name><surname>Valentin</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Bennani-Dosse</surname>  <given-names>M</given-names></string-name></person-group>. <article-title>STATIS And DISTATIS: optimum multitable principal component analysis and three way metric multidimensional scaling</article-title>. <source>Wiley Interdiscip Rev Comput Stat</source>. <year>2012</year>:<volume>4</volume>(<issue>2</issue>):<fpage>124</fpage>–<lpage>167</lpage>. <pub-id pub-id-type="doi">10.1002/wics.198</pub-id>.</mixed-citation>
    </ref>
    <ref id="msad234-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aberer</surname>  <given-names>AJ</given-names></string-name>, <string-name><surname>Krompass</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Stamatakis</surname>  <given-names>A</given-names></string-name></person-group>. <article-title>Pruning rogue taxa improves phylogenetic accuracy: an efficient algorithm and webservice</article-title>. <source>Syst Biol</source>. <year>2013</year>:<volume>62</volume>(<issue>1</issue>):<fpage>162</fpage>–<lpage>166</lpage>. <pub-id pub-id-type="doi">10.1093/sysbio/sys078</pub-id>.<pub-id pub-id-type="pmid">22962004</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ali</surname>  <given-names>RH</given-names></string-name>, <string-name><surname>Bogusz</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Whelan</surname>  <given-names>S</given-names></string-name></person-group>. <article-title>Identifying clusters of high confidence homologies in multiple sequence alignments</article-title>. <source>Mol Biol Evol</source>. <year>2019</year>:<volume>36</volume>(<issue>10</issue>):<fpage>2340</fpage>–<lpage>2351</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/msz142</pub-id>.<pub-id pub-id-type="pmid">31209473</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Allio</surname>  <given-names>R</given-names></string-name>, <string-name><surname>Tilak</surname>  <given-names>M-K</given-names></string-name>, <string-name><surname>Scornavacca</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Avenant</surname>  <given-names>NL</given-names></string-name>, <string-name><surname>Kitchener</surname>  <given-names>AC</given-names></string-name>, <string-name><surname>Corre</surname>  <given-names>E</given-names></string-name>, <string-name><surname>Nabholz</surname>  <given-names>B</given-names></string-name>, <string-name><surname>Delsuc</surname>  <given-names>F</given-names></string-name></person-group>. <article-title>High-quality carnivoran genomes from roadkill samples enable comparative species delineation in aardwolf and bat-eared fox</article-title>. <source>eLife</source>. <year>2021</year>:<volume>10</volume>:<fpage>e63167</fpage>. <pub-id pub-id-type="doi">10.7554/eLife.63167</pub-id>.<pub-id pub-id-type="pmid">33599612</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Barton</surname>  <given-names>D</given-names></string-name>, <string-name><surname>David</surname>  <given-names>F</given-names></string-name></person-group>. <article-title>Some notes on ordered random intervals</article-title>. <source>J R Stat Soc Ser B Methodol</source>. <year>1956</year>:<volume>18</volume>:<fpage>79</fpage>–<lpage>94</lpage>. <pub-id pub-id-type="doi">10.1111/j.2517-6161.1956.tb00213.x</pub-id>.</mixed-citation>
    </ref>
    <ref id="msad234-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baum</surname>  <given-names>BR</given-names></string-name></person-group>. <article-title>Combining trees as a way of combining data sets for phylogenetic inference, and the desirability of combining gene trees</article-title>. <source>TAXON</source>. <year>1992</year>:<volume>41</volume>(<issue>1</issue>):<fpage>3</fpage>–<lpage>10</lpage>. <pub-id pub-id-type="doi">10.2307/1222480</pub-id>.</mixed-citation>
    </ref>
    <ref id="msad234-B8">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Biller</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Knibbe</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Beslon</surname>  <given-names>G</given-names></string-name>, <string-name><surname>Tannier</surname>  <given-names>E</given-names></string-name></person-group>. <year>2016</year>. <comment>Comparative genomics on artificial life. In: Conference on Computability in Europe. Springer. p. 35–44</comment>.</mixed-citation>
    </ref>
    <ref id="msad234-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brys</surname>  <given-names>G</given-names></string-name>, <string-name><surname>Hubert</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Struyf</surname>  <given-names>A</given-names></string-name></person-group>. <article-title>A robust measure of skewness</article-title>. <source>J Comput Graph Stat</source>. <year>2004</year>:<volume>13</volume>(<issue>4</issue>):<fpage>996</fpage>–<lpage>1017</lpage>. <pub-id pub-id-type="doi">10.1198/106186004X12632</pub-id>.</mixed-citation>
    </ref>
    <ref id="msad234-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Capella-Gutiérrez</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Silla-Martínez</surname>  <given-names>JM</given-names></string-name>, <string-name><surname>Gabaldón</surname>  <given-names>T</given-names></string-name></person-group>. <article-title>Trimal: a tool for automated alignment trimming in large-scale phylogenetic analyses</article-title>. <source>Bioinformatics</source>. <year>2009</year>:<volume>25</volume>(<issue>15</issue>):<fpage>1972</fpage>–<lpage>1973</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btp348</pub-id>.<pub-id pub-id-type="pmid">19505945</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chessel</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Hanafi</surname>  <given-names>M</given-names></string-name></person-group>. <article-title>Analyses de la co-inertie de $ K $ nuages de points</article-title>. <source>Rev Stat Appl</source>. <year>1996</year>:<volume>44</volume>:<fpage>35</fpage>–<lpage>60</lpage>. <ext-link xlink:href="http://www.numdam.org/item/RSA_1996__44_2_35_0/" ext-link-type="uri">http://www.numdam.org/item/RSA_1996__44_2_35_0/</ext-link>.</mixed-citation>
    </ref>
    <ref id="msad234-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Criscuolo</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Gribaldo</surname>  <given-names>S</given-names></string-name></person-group>. <article-title>BMGE (Block mapping and gathering with entropy): a new software for selection of phylogenetic informative regions from multiple sequence alignments</article-title>. <source>BMC Evol Biol</source>. <year>2010</year>:<volume>10</volume>(<issue>1</issue>):<fpage>210</fpage>. <pub-id pub-id-type="doi">10.1186/1471-2148-10-210</pub-id>.<pub-id pub-id-type="pmid">20626897</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dalevi</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Eriksen</surname>  <given-names>N</given-names></string-name></person-group>. <article-title>Expected gene-order distances and model selection in bacteria</article-title>. <source>Bioinformatics</source>. <year>2008</year>:<volume>24</volume>(<issue>11</issue>):<fpage>1332</fpage>–<lpage>1338</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btn111</pub-id>.<pub-id pub-id-type="pmid">18381402</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Degnan</surname>  <given-names>JH</given-names></string-name>, <string-name><surname>Rosenberg</surname>  <given-names>NA</given-names></string-name></person-group>. <article-title>Discordance of Species trees with their most likely gene trees</article-title>. <source>PLoS Genet</source>. <year>2006</year>:<volume>2</volume>(<issue>5</issue>):<fpage>e68</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pgen.0020068</pub-id>.<pub-id pub-id-type="pmid">16733550</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>de Vienne</surname>  <given-names>DM</given-names></string-name>, <string-name><surname>Ollier</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Aguileta</surname>  <given-names>G</given-names></string-name></person-group>. <article-title>Phylo-MCOA: a fast and efficient method to detect outlier genes and Species in phylogenomics using multiple co-inertia analysis</article-title>. <source>Mol Biol Evol</source>. <year>2012</year>:<volume>29</volume>(<issue>6</issue>):<fpage>1587</fpage>–<lpage>1598</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/msr317</pub-id>.<pub-id pub-id-type="pmid">22319162</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Di Franco</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Poujol</surname>  <given-names>R</given-names></string-name>, <string-name><surname>Baurain</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Philippe</surname>  <given-names>H</given-names></string-name></person-group>. <article-title>Evaluating the usefulness of alignment filtering methods to reduce the impact of errors on evolutionary inferences</article-title>. <source>BMC Evol Biol</source>. <year>2019</year>:<volume>19</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>17</lpage>. <pub-id pub-id-type="doi">10.1186/s12862-019-1350-2</pub-id>.<pub-id pub-id-type="pmid">30606099</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Emerson</surname>  <given-names>RO</given-names></string-name>, <string-name><surname>Thomas</surname>  <given-names>JH</given-names></string-name></person-group>. <article-title>Adaptive evolution in zinc finger transcription factors</article-title>. <source>PLoS Genet</source>. <year>2009</year>:<volume>5</volume>(<issue>1</issue>):<fpage>e1000325</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pgen.1000325</pub-id>.<pub-id pub-id-type="pmid">19119423</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hubert</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Vandervieren</surname>  <given-names>E</given-names></string-name></person-group>. <article-title>An adjusted boxplot for skewed distributions</article-title>. <source>Comput StatData Anal</source>. <year>2008</year>:<volume>52</volume>(<issue>12</issue>):<fpage>5186</fpage>–<lpage>5201</lpage>. <pub-id pub-id-type="doi">10.1016/j.csda.2007.11.008</pub-id>.</mixed-citation>
    </ref>
    <ref id="msad234-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huntley</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Baggott</surname>  <given-names>DM</given-names></string-name>, <string-name><surname>Hamilton</surname>  <given-names>AT</given-names></string-name>, <string-name><surname>Tran-Gyamfi</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Yang</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Kim</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Gordon</surname>  <given-names>L</given-names></string-name>, <string-name><surname>Branscomb</surname>  <given-names>E</given-names></string-name>, <string-name><surname>Stubbs</surname>  <given-names>L</given-names></string-name></person-group>. <article-title>A comprehensive catalog of human KRAB-associated zinc finger genes: insights into the evolutionary history of a large family of transcriptional repressors</article-title>. <source>Genome Res</source>. <year>2006</year>:<volume>16</volume>(<issue>5</issue>):<fpage>669</fpage>–<lpage>677</lpage>. <pub-id pub-id-type="doi">10.1101/gr.4842106</pub-id>.<pub-id pub-id-type="pmid">16606702</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jackson</surname>  <given-names>DA</given-names></string-name></person-group>. <article-title>Stopping rules in principal components analysis: a comparison of heuristical and statistical approaches</article-title>. <source>Ecology</source>. <year>1993</year>:<volume>74</volume>(<issue>8</issue>):<fpage>2204</fpage>–<lpage>2214</lpage>. <pub-id pub-id-type="doi">10.2307/1939574</pub-id>.</mixed-citation>
    </ref>
    <ref id="msad234-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Katoh</surname>  <given-names>K</given-names></string-name>, <string-name><surname>Standley</surname>  <given-names>DM</given-names></string-name></person-group>. <article-title>MAFFT Multiple sequence alignment software version 7: improvements in performance and usability</article-title>. <source>Mol Biol Evol</source>. <year>2013</year>:<volume>30</volume>(<issue>4</issue>):<fpage>772</fpage>–<lpage>780</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/mst010</pub-id>.<pub-id pub-id-type="pmid">23329690</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kumar</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Subramanian</surname>  <given-names>S</given-names></string-name></person-group>. <article-title>Mutation rates in mammalian genomes</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2002</year>:<volume>99</volume>(<issue>2</issue>):<fpage>803</fpage>–<lpage>808</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.022629899</pub-id>.<pub-id pub-id-type="pmid">11792858</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lartillot</surname>  <given-names>N</given-names></string-name>, <string-name><surname>Rodrigue</surname>  <given-names>N</given-names></string-name>, <string-name><surname>Stubbs</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Richer</surname>  <given-names>J</given-names></string-name></person-group>. <article-title>Phylobayes MPI: phylogenetic reconstruction with infinite mixtures of profiles in a parallel environment</article-title>. <source>Syst Biol</source>. <year>2013</year>:<volume>62</volume>(<issue>4</issue>):<fpage>611</fpage>–<lpage>615</lpage>. <pub-id pub-id-type="doi">10.1093/sysbio/syt022</pub-id>.<pub-id pub-id-type="pmid">23564032</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Chang</surname>  <given-names>L-H</given-names></string-name>, <string-name><surname>Sun</surname>  <given-names>Y</given-names></string-name>, <string-name><surname>Lu</surname>  <given-names>X</given-names></string-name>, <string-name><surname>Stubbs</surname>  <given-names>L</given-names></string-name></person-group>. <article-title>Deep vertebrate roots for mammalian zinc finger transcription factor subfamilies</article-title>. <source>Genome Biol Evol</source>. <year>2014</year>:<volume>6</volume>(<issue>3</issue>):<fpage>510</fpage>–<lpage>525</lpage>. <pub-id pub-id-type="doi">10.1093/gbe/evu030</pub-id>.<pub-id pub-id-type="pmid">24534434</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname>  <given-names>L</given-names></string-name>, <string-name><surname>Yu</surname>  <given-names>L</given-names></string-name>, <string-name><surname>Edwards</surname>  <given-names>SV</given-names></string-name></person-group>. <article-title>A maximum pseudo-likelihood approach for estimating species trees under the coalescent model</article-title>. <source>BMC Evol Biol</source>. <year>2010</year>:<volume>10</volume>(<issue>1</issue>):<fpage>302</fpage>. <pub-id pub-id-type="doi">10.1186/1471-2148-10-302</pub-id>.<pub-id pub-id-type="pmid">20937096</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lucas</surname>  <given-names>JM</given-names></string-name>, <string-name><surname>Crollius</surname>  <given-names>HR</given-names></string-name></person-group>. <article-title>High precision detection of conserved segments from synteny blocks</article-title>. <source>PLOS ONE</source>. <year>2017</year>:<volume>12</volume>(<issue>7</issue>):<fpage>e0180198</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pone.0180198</pub-id>.<pub-id pub-id-type="pmid">28671949</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mai</surname>  <given-names>U</given-names></string-name>, <string-name><surname>Mirarab</surname>  <given-names>S</given-names></string-name></person-group>. <article-title>Treeshrink: fast and accurate detection of outlier long branches in collections of phylogenetic trees</article-title>. <source>BMC Genomics</source>. <year>2018</year>:<volume>19</volume>(<issue>S5</issue>):<fpage>272</fpage>–<lpage>272</lpage>. <pub-id pub-id-type="doi">10.1186/s12864-018-4620-2</pub-id>.<pub-id pub-id-type="pmid">29745847</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mallo</surname>  <given-names>D</given-names></string-name>, <string-name><surname>De Oliveira Martins</surname>  <given-names>L</given-names></string-name>, <string-name><surname>Posada</surname>  <given-names>D</given-names></string-name></person-group>. <article-title><italic toggle="yes">Simphy</italic>: phylogenomic simulation of gene, locus, and Species trees</article-title>. <source>Syst Biol</source>. <year>2016</year>:<volume>65</volume>(<issue>2</issue>):<fpage>334</fpage>–<lpage>344</lpage>. <pub-id pub-id-type="doi">10.1093/sysbio/syv082</pub-id>.<pub-id pub-id-type="pmid">26526427</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Minh</surname>  <given-names>BQ</given-names></string-name>, <string-name><surname>Hahn</surname>  <given-names>MW</given-names></string-name>, <string-name><surname>Lanfear</surname>  <given-names>R</given-names></string-name></person-group>. <article-title>New methods to calculate concordance factors for phylogenomic datasets</article-title>. <source>Mol Biol Evol</source>. <year>2020</year>:<volume>37</volume>(<issue>9</issue>):<fpage>2727</fpage>–<lpage>2733</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/msaa106</pub-id>.<pub-id pub-id-type="pmid">32365179</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Minh</surname>  <given-names>BQ</given-names></string-name>, <string-name><surname>Schmidt</surname>  <given-names>HA</given-names></string-name>, <string-name><surname>Chernomor</surname>  <given-names>O</given-names></string-name>, <string-name><surname>Schrempf</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Woodhams</surname>  <given-names>MD</given-names></string-name>, <string-name><surname>von Haeseler</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Lanfear</surname>  <given-names>R</given-names></string-name></person-group>. <article-title>IQ-TREE 2: new models and efficient methods for phylogenetic inference in the genomic era</article-title>. <source>Mol Biol Evol</source>. <year>2020</year>:<volume>37</volume>(<issue>5</issue>):<fpage>1530</fpage>–<lpage>1534</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/msaa015</pub-id>.<pub-id pub-id-type="pmid">32011700</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Paradis</surname>  <given-names>E</given-names></string-name>, <string-name><surname>Schliep</surname>  <given-names>K</given-names></string-name></person-group>. <article-title>Ape 5.0: an environment for modern phylogenetics and evolutionary analyses in R</article-title>. <source>Bioinformatics</source>. <year>2019</year>:<volume>35</volume>(<issue>3</issue>):<fpage>526</fpage>–<lpage>528</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bty633</pub-id>.<pub-id pub-id-type="pmid">30016406</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Philippe</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Brinkmann</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Lavrov</surname>  <given-names>DV</given-names></string-name>, <string-name><surname>Littlewood</surname>  <given-names>DTJ</given-names></string-name>, <string-name><surname>Manuel</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Wörheide</surname>  <given-names>G</given-names></string-name>, <string-name><surname>Baurain</surname>  <given-names>D</given-names></string-name></person-group>. <article-title>Resolving difficult phylogenetic questions: why more sequences are not enough</article-title>. <source>PLoS Biol</source>. <year>2011</year>:<volume>9</volume>(<issue>3</issue>):<fpage>e1000602</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pbio.1000602</pub-id>.<pub-id pub-id-type="pmid">21423652</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Philippe</surname>  <given-names>H</given-names></string-name>, <string-name><surname>de Vienne</surname>  <given-names>DM</given-names></string-name>, <string-name><surname>Ranwez</surname>  <given-names>V</given-names></string-name>, <string-name><surname>Roure</surname>  <given-names>B</given-names></string-name>, <string-name><surname>Baurain</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Delsuc</surname>  <given-names>F</given-names></string-name></person-group>. <article-title>Pitfalls in supermatrix phylogenomics</article-title>. <source>Eur J Taxon</source>. <year>2017</year>:<volume>283</volume>:<fpage>1</fpage>–<lpage>25</lpage>. <pub-id pub-id-type="doi">10.5852/ejt.2017.283</pub-id>.</mixed-citation>
    </ref>
    <ref id="msad234-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ragan</surname>  <given-names>MA</given-names></string-name></person-group>. <article-title>Matrix representation in reconstructing phylogenetic relationships among the eukaryotes</article-title>. <source>Biosystems</source>. <year>1992</year>:<volume>28</volume>(<issue>1-3</issue>):<fpage>47</fpage>–<lpage>55</lpage>. <pub-id pub-id-type="doi">10.1016/0303-2647(92)90007-L</pub-id>.<pub-id pub-id-type="pmid">1292666</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B35">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Ranwez</surname>  <given-names>V</given-names></string-name>, <string-name><surname>Chantret</surname>  <given-names>NN</given-names></string-name></person-group>. <year>2020</year>. <comment>Strengths and limits of multiple sequence alignment and filtering methods</comment>.</mixed-citation>
    </ref>
    <ref id="msad234-B36">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Ranwez</surname>  <given-names>V</given-names></string-name>, <string-name><surname>Chantret</surname>  <given-names>N</given-names></string-name>, <string-name><surname>Delsuc</surname>  <given-names>F</given-names></string-name></person-group>. <part-title>Aligning protein-coding nucleotide sequences with MACSE</part-title>. <source>Multiple sequence alignment</source>. <publisher-name>Springer</publisher-name>; <year>2021</year>. p. <fpage>51</fpage>–<lpage>70</lpage>.</mixed-citation>
    </ref>
    <ref id="msad234-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ranwez</surname>  <given-names>V</given-names></string-name>, <string-name><surname>Douzery</surname>  <given-names>EJ</given-names></string-name>, <string-name><surname>Cambon</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Chantret</surname>  <given-names>N</given-names></string-name>, <string-name><surname>Delsuc</surname>  <given-names>F</given-names></string-name></person-group>. <article-title>MACSE V2: toolkit for the alignment of coding sequences accounting for frameshifts and stop codons</article-title>. <source>Mol Biol Evol</source>. <year>2018</year>:<volume>35</volume>(<issue>10</issue>):<fpage>2582</fpage>–<lpage>2584</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/msy159</pub-id>.<pub-id pub-id-type="pmid">30165589</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B38">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><collab>R Core Team</collab></person-group>. <source>R: A language and environment for statistical computing</source>. <publisher-loc>Vienna</publisher-loc>, <publisher-loc>Austria</publisher-loc>: <publisher-name>R Foundation for Statistical Computing</publisher-name>; <year>2023</year>.</mixed-citation>
    </ref>
    <ref id="msad234-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Robert</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Escoufier</surname>  <given-names>Y</given-names></string-name></person-group>. <article-title>A unifying tool for linear multivariate statistical methods: the RV- coefficient</article-title>. <source>J R Stat Soc Ser C Appl Stat</source>. <year>1976</year>:<volume>25</volume>:<fpage>257</fpage>–<lpage>265</lpage>. <pub-id pub-id-type="doi">10.2307/2347233</pub-id>.</mixed-citation>
    </ref>
    <ref id="msad234-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ronquist</surname>  <given-names>F</given-names></string-name></person-group>. <article-title>Matrix representation of trees, redundancy, and weighting</article-title>. <source>Syst Biol</source>. <year>1996</year>:<volume>45</volume>(<issue>2</issue>):<fpage>247</fpage>–<lpage>253</lpage>. <pub-id pub-id-type="doi">10.1093/sysbio/45.2.247</pub-id>.</mixed-citation>
    </ref>
    <ref id="msad234-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Salichos</surname>  <given-names>L</given-names></string-name>, <string-name><surname>Rokas</surname>  <given-names>A</given-names></string-name></person-group>. <article-title>Inferring ancient divergences requires genes with strong phylogenetic signals</article-title>. <source>Nature</source>. <year>2013</year>:<volume>497</volume>(<issue>7449</issue>):<fpage>327</fpage>–<lpage>331</lpage>. <pub-id pub-id-type="doi">10.1038/nature12130</pub-id>.<pub-id pub-id-type="pmid">23657258</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B42">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Schrempf</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Szöllősi</surname>  <given-names>G</given-names></string-name></person-group>. <year>2020</year>. <comment>The sources of phylogenetic conflicts. <italic toggle="yes">Phylogenetics Genomic Era</italic> 3–1</comment>.</mixed-citation>
    </ref>
    <ref id="msad234-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Scornavacca</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Belkhir</surname>  <given-names>K</given-names></string-name>, <string-name><surname>Lopez</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Dernat</surname>  <given-names>R</given-names></string-name>, <string-name><surname>Delsuc</surname>  <given-names>F</given-names></string-name>, <string-name><surname>Douzery</surname>  <given-names>EJP</given-names></string-name>, <string-name><surname>Ranwez</surname>  <given-names>V</given-names></string-name></person-group>. <article-title>Orthomam v10: scaling-up orthologous coding sequence and exon alignments with more than one hundred mammalian genomes</article-title>. <source>Mol Biol Evol</source>. <year>2019</year>:<volume>36</volume>(<issue>4</issue>):<fpage>861</fpage>–<lpage>862</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/msz015</pub-id>.<pub-id pub-id-type="pmid">30698751</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Scornavacca</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Galtier</surname>  <given-names>N</given-names></string-name></person-group>. <article-title>Incomplete lineage sorting in mammalian phylogenomics</article-title>. <source>Syst Biol</source>. <year>2016</year>:<volume>66</volume>(<issue>1</issue>):<fpage>syw082</fpage>. <pub-id pub-id-type="doi">10.1093/sysbio/syw082</pub-id>.</mixed-citation>
    </ref>
    <ref id="msad234-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shen</surname>  <given-names>X-X</given-names></string-name>, <string-name><surname>Salichos</surname>  <given-names>L</given-names></string-name>, <string-name><surname>Rokas</surname>  <given-names>A</given-names></string-name></person-group>. <article-title>A genome-scale investigation of how sequence, function, and tree-based gene properties influence phylogenetic inference</article-title>. <source>Genome Biol Evol</source>. <year>2016</year>:<volume>8</volume>(<issue>8</issue>):<fpage>2565</fpage>–<lpage>2580</lpage>. <pub-id pub-id-type="doi">10.1093/gbe/evw179</pub-id>.<pub-id pub-id-type="pmid">27492233</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Szöllősi</surname>  <given-names>GJ</given-names></string-name>, <string-name><surname>Davín</surname>  <given-names>AA</given-names></string-name>, <string-name><surname>Tannier</surname>  <given-names>E</given-names></string-name>, <string-name><surname>Daubin</surname>  <given-names>V</given-names></string-name>, <string-name><surname>Boussau</surname>  <given-names>B</given-names></string-name></person-group>. <article-title>Genome-scale phylogenetic analysis finds extensive gene transfer among fungi</article-title>. <source>Philos Trans R Soc B Biol Sci</source>. <year>2015</year>:<volume>370</volume>(<issue>1678</issue>):<fpage>20140335</fpage>. <pub-id pub-id-type="doi">10.1098/rstb.2014.0335</pub-id>.</mixed-citation>
    </ref>
    <ref id="msad234-B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>van de Kerk</surname>  <given-names>M</given-names></string-name>, <string-name><surname>de Kroon</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Conde</surname>  <given-names>DA</given-names></string-name>, <string-name><surname>Jongejans</surname>  <given-names>E</given-names></string-name></person-group>. <article-title>Carnivora population dynamics are as slow and as fast as those of other mammals: implications for their conservation</article-title>. <source>PLOS ONE</source>. <year>2013</year>:<volume>8</volume>(<issue>8</issue>):<fpage>e70354</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pone.0070354</pub-id>.<pub-id pub-id-type="pmid">23950922</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>von Haeseler</surname>  <given-names>A</given-names></string-name></person-group>. <article-title>Do we still need supertrees?</article-title>  <source>BMC Biol</source>. <year>2012</year>:<volume>10</volume>(<issue>1</issue>):<fpage>13</fpage>. <pub-id pub-id-type="doi">10.1186/1741-7007-10-13</pub-id>.<pub-id pub-id-type="pmid">22369571</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B49">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname>  <given-names>Z</given-names></string-name>, <string-name><surname>Bielawski</surname>  <given-names>JP</given-names></string-name></person-group>. <article-title>Statistical methods for detecting molecular adaptation</article-title>. <source>Trends Ecol Evol</source>. <year>2000</year>:<volume>15</volume>(<issue>12</issue>):<fpage>496</fpage>–<lpage>503</lpage>. <pub-id pub-id-type="doi">10.1016/S0169-5347(00)01994-7</pub-id>.<pub-id pub-id-type="pmid">11114436</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B50">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname>  <given-names>Z</given-names></string-name>, <string-name><surname>Kumar</surname>  <given-names>S</given-names></string-name>, <string-name><surname>Nei</surname>  <given-names>M</given-names></string-name></person-group>. <article-title>A new method of inference of ancestral nucleotide and amino acid sequences</article-title>. <source>Genetics</source>. <year>1995</year>:<volume>141</volume>(<issue>4</issue>):<fpage>1641</fpage>–<lpage>1650</lpage>. <pub-id pub-id-type="doi">10.1093/genetics/141.4.1641</pub-id>.<pub-id pub-id-type="pmid">8601501</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B51">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Rabiee</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Sayyari</surname>  <given-names>E</given-names></string-name>, <string-name><surname>Mirarab</surname>  <given-names>S</given-names></string-name></person-group>. <article-title>ASTRAL-III: polynomial time species tree reconstruction from partially resolved gene trees</article-title>. <source>BMC Bioinformatics</source>. <year>2018</year>:<volume>19</volume>(<issue>S6</issue>):<fpage>153</fpage>. <pub-id pub-id-type="doi">10.1186/s12859-018-2129-y</pub-id>.<pub-id pub-id-type="pmid">29745866</pub-id></mixed-citation>
    </ref>
    <ref id="msad234-B52">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname>  <given-names>C</given-names></string-name>, <string-name><surname>Zhao</surname>  <given-names>Y</given-names></string-name>, <string-name><surname>Braun</surname>  <given-names>EL</given-names></string-name>, <string-name><surname>Mirarab</surname>  <given-names>S</given-names></string-name></person-group>. <article-title>TAPER: pinpointing errors in multiple sequence alignments despite varying rates of evolution</article-title>. <source>Methods Ecol Evol</source>. <year>2021</year>:<volume>12</volume>(<issue>11</issue>):<fpage>2145</fpage>–<lpage>2158</lpage>. <pub-id pub-id-type="doi">10.1111/2041-210X.13696</pub-id>.</mixed-citation>
    </ref>
  </ref-list>
</back>
