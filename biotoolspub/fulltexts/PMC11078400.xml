<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLOS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">11078400</article-id>
    <article-id pub-id-type="pmid">38656999</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-23-01890</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011995</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Evolutionary Biology</subject>
          <subj-group>
            <subject>Evolutionary Processes</subject>
            <subj-group>
              <subject>Evolutionary Rate</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleotides</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genetic Loci</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Evolutionary Biology</subject>
          <subj-group>
            <subject>Evolutionary Systematics</subject>
            <subj-group>
              <subject>Phylogenetics</subject>
              <subj-group>
                <subject>Animal Phylogenetics</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Taxonomy</subject>
          <subj-group>
            <subject>Evolutionary Systematics</subject>
            <subj-group>
              <subject>Phylogenetics</subject>
              <subj-group>
                <subject>Animal Phylogenetics</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Taxonomy</subject>
            <subj-group>
              <subject>Evolutionary Systematics</subject>
              <subj-group>
                <subject>Phylogenetics</subject>
                <subj-group>
                  <subject>Animal Phylogenetics</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Zoology</subject>
          <subj-group>
            <subject>Animal Phylogenetics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Evolutionary Biology</subject>
          <subj-group>
            <subject>Molecular Evolution</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Evolutionary Biology</subject>
          <subj-group>
            <subject>Evolutionary Genetics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Evolutionary Biology</subject>
          <subj-group>
            <subject>Evolutionary Systematics</subject>
            <subj-group>
              <subject>Phylogenetics</subject>
              <subj-group>
                <subject>Phylogenetic Analysis</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Taxonomy</subject>
          <subj-group>
            <subject>Evolutionary Systematics</subject>
            <subj-group>
              <subject>Phylogenetics</subject>
              <subj-group>
                <subject>Phylogenetic Analysis</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Taxonomy</subject>
            <subj-group>
              <subject>Evolutionary Systematics</subject>
              <subj-group>
                <subject>Phylogenetics</subject>
                <subj-group>
                  <subject>Phylogenetic Analysis</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Conservation Biology</subject>
          <subj-group>
            <subject>Conservation Genetics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Ecology and Environmental Sciences</subject>
        <subj-group>
          <subject>Conservation Science</subject>
          <subj-group>
            <subject>Conservation Biology</subject>
            <subj-group>
              <subject>Conservation Genetics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Conservation Genetics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>A phylogenetic method linking nucleotide substitution rates to rates of continuous trait evolution</article-title>
      <alt-title alt-title-type="running-head">Phylogenetic modelling of DNA substitution rates and continuous trait evolution</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Gemmell</surname>
          <given-names>Patrick</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-1673-9216</contrib-id>
        <name>
          <surname>Sackton</surname>
          <given-names>Timothy B.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/resources/">Resources</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Edwards</surname>
          <given-names>Scott V.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/resources/">Resources</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-4450-7239</contrib-id>
        <name>
          <surname>Liu</surname>
          <given-names>Jun S.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/resources/">Resources</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Department of Organismic and Evolutionary Biology, Harvard University, Cambridge, Massachusetts, United States of America</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Department of Statistics, Harvard University, Cambridge, Massachusetts, United States of America</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>FAS Informatics Group, Harvard University, Cambridge, Massachusetts, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Rzhetsky</surname>
          <given-names>Andrey</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of Chicago, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>jliu@stat.harvard.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>24</day>
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <volume>20</volume>
    <issue>4</issue>
    <elocation-id>e1011995</elocation-id>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>3</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2024 Gemmell et al</copyright-statement>
      <copyright-year>2024</copyright-year>
      <copyright-holder>Gemmell et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1011995.pdf"/>
    <abstract>
      <p>Genomes contain conserved non-coding sequences that perform important biological functions, such as gene regulation. We present a phylogenetic method, PhyloAcc-C, that associates nucleotide substitution rates with changes in a continuous trait of interest. The method takes as input a multiple sequence alignment of conserved elements, continuous trait data observed in extant species, and a background phylogeny and substitution process. Gibbs sampling is used to assign rate categories (background, conserved, accelerated) to lineages and explore whether the assigned rate categories are associated with increases or decreases in the rate of trait evolution. We test our method using simulations and then illustrate its application using mammalian body size and lifespan data previously analyzed with respect to protein coding genes. Like other studies, we find processes such as tumor suppression, telomere maintenance, and p53 regulation to be related to changes in longevity and body size. In addition, we also find that skeletal genes, and developmental processes, such as sprouting angiogenesis, are relevant.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>Biologists hope to use data from diverse species to identify the genetic basis of continuous traits such as lifespan or beak shape. To do so, they need methodologies that relate genotypic and phenotypic evolution, while taking account of the relationship between species. The practice of integrating data from many species in this systematic way is relatively new, and existing approaches to the problem are often ad hoc, focus on protein coding genes, or involve discretizing continuous measurements. We avoid these limitations and develop a statistical model and software package that can be used to rapidly analyze alignments with respect to a continuous trait. Our method is illustrated by describing 136,859 conserved non-coding elements from 61 mammalian species with respect to the trait ‘long-lived and large-bodied’. We report on the loci highlighted by our model and describe how our results compare to recent studies taking other methodological approaches. We suggest approaches like ours are an important step towards realizing the potential of data collected from across the animal kingdom, whether the aim is to increase our understanding of natural history or to better understand human biology.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000051</institution-id>
            <institution>National Human Genome Research Institute</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01HG011485</award-id>
        <principal-award-recipient>
          <name>
            <surname>Edwards</surname>
            <given-names>Scott V.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000057</institution-id>
            <institution>National Institute of General Medical Sciences</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01GM152814</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-4450-7239</contrib-id>
          <name>
            <surname>Liu</surname>
            <given-names>Jun S.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This work was supported in part by NIH grant #R01HG011485 from the National Human Genome Research Institute (to TBS, SVE and JSL) and #R01GM152814 from the National Institute of General Medicine (to JSL). PG’s salary was paid from the first grant. We acknowledge support for covering the costs of publishing this article from the Wetmore Colles Fund of the Museum of Comparative Zoology at Harvard. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="3"/>
      <table-count count="2"/>
      <page-count count="18"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2024-05-08</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All data and codes will be freely available to academic researchers upon acceptance of the paper.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All data and codes will be freely available to academic researchers upon acceptance of the paper.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>In recent years there have been numerous advances in mapping genes underlying phenotypic traits. Many of these advances have built on the successes and refinements of traditional genetic mapping methods yet, as is articulated by Smith et al. [<xref rid="pcbi.1011995.ref001" ref-type="bibr">1</xref>], such approaches are often limited to the small number of model organisms amenable to crosses or other genetic manipulations. Recently, alternative phylogenetic approaches driven by comparative genomics have emerged as a useful tool for mapping genes in species not amenable to traditional approaches. Several methodologies have been proposed to associate evolution of genes or genomic regions with changes in phenotypic traits including those of [<xref rid="pcbi.1011995.ref002" ref-type="bibr">2</xref>–<xref rid="pcbi.1011995.ref007" ref-type="bibr">7</xref>]. These studies use a variety of genomic signatures as evidence of association with phenotypic evolution, including increases in evolutionary rate, loss of function such as pseudogenization, or wholesale deletion of genes or non-coding regions from the genome. Comparative approaches of this kind (hereafter ‘PhyloG2P’) have proved to be surprisingly powerful at identifying associations between genomic and phenotypic variation in the context of convergent evolution of the phenotypic trait.</p>
    <p>With the PhyloG2P research programme in mind, this paper aims to make three contributions. First, we highlight the idea of relating phenotypic and genotypic evolution by linking substitution rate multipliers (for nucleotide changes) to variance multipliers (for changes in a continuous trait). Second, we introduce a specific piece of software, PhyloAcc-C, that applies this approach in the context of conserved non-coding elements (CNEs). Third, we illustrate the PhyloAcc-C software using real data, running it with a set of mammalian CNEs and a lifespan related trait as input, thereby providing an opportunity to discuss its output in the context of other recent PhyloG2P-style studies.</p>
    <p>The overarching biological motivation for our study is our interest in evolutionary innovation, and here we are particularly concerned with methods attempting to answer the question ‘which CNEs are related to changes in a continuous trait I care about?’ This is an important question because it has been recognized for decades that there are many highly conserved stretches of non-coding DNA that participate in gene regulation across diverse species [<xref rid="pcbi.1011995.ref008" ref-type="bibr">8</xref>]. Indeed, such sequences are routinely annotated [<xref rid="pcbi.1011995.ref009" ref-type="bibr">9</xref>] in the UCSC Genome Browser [<xref rid="pcbi.1011995.ref010" ref-type="bibr">10</xref>] and may then be related to the evolution of phenotypic traits. To give one example, Booker et al. [<xref rid="pcbi.1011995.ref011" ref-type="bibr">11</xref>] identified conserved sequences that were accelerated specifically in bats, and showed that a subset acted as limb enhancers in transgenic mice. Their conclusion was that some identified enhancers were potentially instrumental to the evolution of bat wings. This conclusion was reached without modelling the co-variation of the rate of enhancer evolution and key measurements from bat wings. However, it is possible that incorporating measurements such as limb length could highlight additional relevant loci that had experienced more subtle evolutionary trajectories than bat specific acceleration.</p>
    <p>More generally, as reviewed by Smith et al. [<xref rid="pcbi.1011995.ref001" ref-type="bibr">1</xref>], there is widespread interest in relating phenotypic and molecular evolution. This interest is evidenced by the substantial effort put into producing a variety of software packages and studies that quantify the relationship between traits and substitution rates. Examples include Forward Genomics [<xref rid="pcbi.1011995.ref004" ref-type="bibr">4</xref>] and reverse genomics [<xref rid="pcbi.1011995.ref003" ref-type="bibr">3</xref>], both of which relate sequence similarity (via correlation, generalized least-squares, or heuristics) to traits (with ancestral values inferred using parsimony algorithms). A methodology with a similar goal is that of Treaster et al. [<xref rid="pcbi.1011995.ref007" ref-type="bibr">7</xref>], which uses tree topology to model the intuitive notion that comparisons between more closely related species should be less confounded by genetic background than comparisons between more distantly related ones. A recent contribution to this diverse collection of approaches is PhyloAcc [<xref rid="pcbi.1011995.ref012" ref-type="bibr">12</xref>], a Bayesian phylogenetic approach centred on latent conservation states, which is modified here in this paper. A key feature of the above four approaches is that they deal with discrete traits, and in the case of PhyloAcc, do not explicitly model the trait, instead relying on a priori reconstruction, often under the assumption of convergent gain or loss of a character state.</p>
    <p>Methods for studying the relationship between continuous traits and molecular evolution are fewer. Coevol [<xref rid="pcbi.1011995.ref013" ref-type="bibr">13</xref>] models the co-evolution of continuous traits and rates using a multivariate diffusion process, and does not require user supplied branch lengths, although calibrations can be supplied if desired. One imagines that constraining branching times will sometimes be helpful, especially when the sequences being considered are short and highly conserved, and therefore contain few distinguishing differences, as is the case with mammalian CNEs. Two more empirically focused recent studies are that of Yusuf et al. [<xref rid="pcbi.1011995.ref014" ref-type="bibr">14</xref>], who study the co-evolution of bill shape and both protein coding and non-coding DNA, and that of Kowalczyk et al. [<xref rid="pcbi.1011995.ref015" ref-type="bibr">15</xref>], who study the lifespan and body size of mammals. The former study used k-means binning to group branches of a tree based on the rate of trait evolution, and then used a likelihood ratio test to compare nucleotide substitution rates under a global clock model versus a local clock model, with one rate per bin. The latter study used the RERConverge method [<xref rid="pcbi.1011995.ref006" ref-type="bibr">6</xref>], which correlates relative rates of protein evolution and ancestral state reconstructions of a continuous trait, each estimated separately using maximum likelihood.</p>
    <p>Here we describe the PhyloAcc-C model, which connects the evolution of continuous traits and non-coding DNA using a statistically integrated approach. We then illustrate the use of our model by applying it to a mammalian trait previously analyzed using RERConverge, but this time considering CNEs rather than protein coding genes, thereby providing analyses that complement the existing literature.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Methods</title>
    <p>The PhyloAcc-C method follows the general Bayesian approach taken by Hu et al. [<xref rid="pcbi.1011995.ref012" ref-type="bibr">12</xref>] and modifies it so as to model continuous phenotypic change. In this section, we describe the method in enough detail that it may be recreated, and so that one may understand or modify our open source R/C++ implementation.</p>
    <sec id="sec003">
      <title>Input</title>
      <p>The method relies on four inputs: (1) a rooted phylogeny <bold>T</bold> having <italic toggle="yes">L</italic> leaves, <italic toggle="yes">N</italic> = 2<italic toggle="yes">L</italic> − 1 nodes, and <italic toggle="yes">E</italic> = <italic toggle="yes">N</italic> − 1 edges, and that encapsulates the relationships between species from which trait data is drawn; (2) a multiple sequence alignment of homologous CNE sequences from <italic toggle="yes">L</italic> species (rows) at <italic toggle="yes">S</italic> sites (columns) and which makes up the top <italic toggle="yes">L</italic> rows of matrix <bold>X</bold><sub><italic toggle="yes">N</italic>×<italic toggle="yes">S</italic></sub>, which will also model ancestral nucleotides; (3) a vector of continuous trait measurements observed in the corresponding <italic toggle="yes">L</italic> species and which makes up the first <italic toggle="yes">L</italic> elements of vector <bold>y</bold> = (<italic toggle="yes">y</italic><sub>1</sub>, …, <italic toggle="yes">y</italic><sub><italic toggle="yes">N</italic></sub>), which will also model ancestral trait values; (4) a rate matrix <bold>Q</bold><sub>4×4</sub> and stationary distribution <bold>π</bold> that models the background nucleotide substitution process at putatively neutral sites. The alignment may contain gaps which will be treated as missing data. Both the alignment and the nucleotide substitution parameters can be obtained using standard methods as detailed by Hu et al. [<xref rid="pcbi.1011995.ref012" ref-type="bibr">12</xref>]. In particular, the rate matrix <bold>Q</bold> is often estimated using methods like PhyloP [<xref rid="pcbi.1011995.ref016" ref-type="bibr">16</xref>] from an alignment of putatively neutral and easily alignable sites, such as fourfold degenerate sites of protein coding loci.</p>
    </sec>
    <sec id="sec004">
      <title>Model</title>
      <p>Each branch is assigned a conservation state <italic toggle="yes">z</italic><sub><italic toggle="yes">i</italic></sub> that takes on three values: background (<italic toggle="yes">z</italic><sub><italic toggle="yes">i</italic></sub> = 1), conserved (<italic toggle="yes">z</italic><sub><italic toggle="yes">i</italic></sub> = 2), or accelerated (<italic toggle="yes">z</italic><sub><italic toggle="yes">i</italic></sub> = 3). This categorization of branches into three states follows that of Hu et al. [<xref rid="pcbi.1011995.ref012" ref-type="bibr">12</xref>], which in turn was based on the approach taken by Pollard et al. [<xref rid="pcbi.1011995.ref016" ref-type="bibr">16</xref>], who apply a conserved and an accelerated state to branches of a tree in the PhyloP software. Conservation states are not assigned freely but follow a Markov process (see e.g. textbook [<xref rid="pcbi.1011995.ref017" ref-type="bibr">17</xref>]) from root to tips so that the probability of a transition on a branch from parent <italic toggle="yes">i</italic> to child <italic toggle="yes">j</italic> is <inline-formula id="pcbi.1011995.e001"><alternatives><graphic xlink:href="pcbi.1011995.e001.jpg" id="pcbi.1011995.e001g" position="anchor"/><mml:math id="M1" display="inline" overflow="scroll"><mml:mrow><mml:mtext>Pr</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">Φ</mml:mi><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, the (<italic toggle="yes">z</italic><sub><italic toggle="yes">i</italic></sub>, <italic toggle="yes">z</italic><sub><italic toggle="yes">j</italic></sub>)th element of matrix
<disp-formula id="pcbi.1011995.e002"><alternatives><graphic xlink:href="pcbi.1011995.e002.jpg" id="pcbi.1011995.e002g" position="anchor"/><mml:math id="M2" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi><mml:mo>=</mml:mo><mml:mo>[</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mi>c</mml:mi></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mi>a</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mi>b</mml:mi></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula>
with (<italic toggle="yes">a</italic>, <italic toggle="yes">b</italic>, <italic toggle="yes">c</italic>) ∈ (0, 1)<sup>3</sup>.</p>
      <p>The structure of this matrix allows CNEs to become conserved and later accelerated. Because a transition from accelerated back to conserved is also possible (i.e., <italic toggle="yes">b</italic> &gt; 0), bursts of acceleration can occur on internal branches. In principle, other matrices can be used to either constrain or relax the transition between rate categories across the tree.</p>
      <p>The conservation state of a branch affects both the nucleotide substitution process and the rate at which a trait evolves. Conservation states modulate nucleotide substitution rates via substitution rate multipliers <bold>r</bold> = (<italic toggle="yes">r</italic><sub>1</sub> = 1, <italic toggle="yes">r</italic><sub>2</sub>, <italic toggle="yes">r</italic><sub>3</sub>) so that the probability of transition from nucleotide <italic toggle="yes">a</italic> to <italic toggle="yes">b</italic> on branch <italic toggle="yes">i</italic> of length <italic toggle="yes">t</italic><sub><italic toggle="yes">i</italic></sub> is <inline-formula id="pcbi.1011995.e003"><alternatives><graphic xlink:href="pcbi.1011995.e003.jpg" id="pcbi.1011995.e003g" position="anchor"/><mml:math id="M3" display="inline" overflow="scroll"><mml:mrow><mml:mtext mathvariant="normal">expm</mml:mtext><mml:mo stretchy="false">{</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>Q</mml:mi></mml:mstyle><mml:mo>⋅</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mo stretchy="false">}</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. Similarly, conservation states on branches modulate the magnitude of trait changes along branches via variance multipliers <bold>v</bold> = (<italic toggle="yes">σ</italic><sup>2</sup>, <italic toggle="yes">β</italic><sub>2</sub><italic toggle="yes">σ</italic><sup>2</sup>, <italic toggle="yes">β</italic><sub>3</sub><italic toggle="yes">σ</italic><sup>2</sup>). Under the model, traits evolve according to normally distributed displacements along the branches of <bold>T</bold> such that cumulative displacements are observed in <italic toggle="yes">y</italic><sub>1</sub>, …, <italic toggle="yes">y</italic><sub><italic toggle="yes">L</italic></sub>. Displacements have mean 0 and a variance that is proportional to both the branch length <italic toggle="yes">t</italic><sub><italic toggle="yes">j</italic></sub> and the appropriate variance multiplier so that <inline-formula id="pcbi.1011995.e004"><alternatives><graphic xlink:href="pcbi.1011995.e004.jpg" id="pcbi.1011995.e004g" position="anchor"/><mml:math id="M4" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mspace width="0.222em"/><mml:mo stretchy="false">|</mml:mo><mml:mspace width="0.222em"/><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mtext mathvariant="normal">Normal</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>v</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and
<disp-formula id="pcbi.1011995.e005"><alternatives><graphic xlink:href="pcbi.1011995.e005.jpg" id="pcbi.1011995.e005g" position="anchor"/><mml:math id="M5" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="4pt"/><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">i</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="normal">e</mml:mi><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mspace width="2pt"/><mml:mtext>background</mml:mtext><mml:mo>;</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="4pt"/><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">i</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="normal">e</mml:mi><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mspace width="2pt"/><mml:mtext>conserved</mml:mtext><mml:mo>;</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="4pt"/><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">i</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="normal">e</mml:mi><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mspace width="2pt"/><mml:mtext>accelerated</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula></p>
    </sec>
    <sec id="sec005">
      <title>Joint distribution</title>
      <p>Letting <italic toggle="yes">pa</italic>(<italic toggle="yes">i</italic>) denote the parent of node <italic toggle="yes">i</italic>, and assuming that <italic toggle="yes">pa</italic>(<italic toggle="yes">j</italic>) = <italic toggle="yes">pa</italic>(<italic toggle="yes">k</italic>) = <italic toggle="yes">i</italic>, we can write the joint distribution of all quantities under our model as:
<disp-formula id="pcbi.1011995.e006"><alternatives><graphic xlink:href="pcbi.1011995.e006.jpg" id="pcbi.1011995.e006g" position="anchor"/><mml:math id="M6" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">Φ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:munderover><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>E</mml:mi></mml:munderover><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>E</mml:mi></mml:munderover><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>E</mml:mi></mml:munderover><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold">Φ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>·</mml:mo><mml:mo>[</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:munderover><mml:msub><mml:mi>π</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:msub><mml:mo>]</mml:mo><mml:mspace width="0.166667em"/><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">v</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">Φ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(3)</label></disp-formula></p>
      <p>The last line of the above product indicates that at the root node <italic toggle="yes">R</italic> the prior probability of observing a nucleotide is given by the (input) stationary distribution <italic toggle="yes">π</italic>, whereas the trait and conservation state are specified directly using a prior, as described below.</p>
    </sec>
    <sec id="sec006">
      <title>Specification of priors</title>
      <p>At the root node, we use Pr(<italic toggle="yes">z</italic><sub><italic toggle="yes">R</italic></sub> = 1) = Pr(<italic toggle="yes">z</italic><sub><italic toggle="yes">R</italic></sub> = 2) = 0.5. We follow Hu et al. [<xref rid="pcbi.1011995.ref012" ref-type="bibr">12</xref>] in this choice because we analyze the same CNE sequences, which were originally identified because they appeared widely conserved under a model (phastCons [<xref rid="pcbi.1011995.ref009" ref-type="bibr">9</xref>]) with two rate categories, conserved and neutral. We use <italic toggle="yes">y</italic><sub><italic toggle="yes">R</italic></sub> ∼ Normal(0, 1), although users can make their own choices freely. Priors on <italic toggle="yes">a</italic>, <italic toggle="yes">b</italic>, <italic toggle="yes">c</italic> in matrix <bold>Φ</bold> are uniform distributions (i.e., Beta(1,1)). Because we use the same nucleotide data, <italic toggle="yes">r</italic><sub>2</sub> ∼ Gamma(5, 0.04) and <italic toggle="yes">r</italic><sub>3</sub> ∼ Gamma(10, 0.2) follow the values in Hu et al. [<xref rid="pcbi.1011995.ref012" ref-type="bibr">12</xref>]. Priors on log <italic toggle="yes">β</italic><sub>2</sub> and log <italic toggle="yes">β</italic><sub>3</sub> are Normal(0, 1) which is mathematically equivalent to setting a Normal(0, 2) on log(<italic toggle="yes">β</italic><sub>3</sub>/<italic toggle="yes">β</italic><sub>2</sub>), the logarithm of their ratio. We also assume that log <italic toggle="yes">σ</italic><sup>2</sup> ∼ Normal(0, 2) <italic toggle="yes">a priori</italic>.</p>
    </sec>
    <sec id="sec007">
      <title>Bayesian inference procedure</title>
      <p>Inference is performed using a Markov chain Monte Carlo procedure, which is a combination of collapsed Gibbs sampling with some Metropolis within Gibbs steps [<xref rid="pcbi.1011995.ref018" ref-type="bibr">18</xref>, <xref rid="pcbi.1011995.ref019" ref-type="bibr">19</xref>]. The procedure is a minor modification of that introduced in pages 5–8 of the SI of Hu et al. [<xref rid="pcbi.1011995.ref012" ref-type="bibr">12</xref>], with the addition of an extra Metropolis step (Step 1), and the introduction of emission probabilities for <bold>y</bold> when sampling <bold>z</bold> (Step 3). The following steps are repeated:</p>
      <sec id="sec008">
        <title>Step 1: Sample ancestral trait values y and trait variance multipliers v</title>
        <p>Perform Metropolis steps (default is 500) to propose and update <italic toggle="yes">σ</italic><sup>2</sup>, <italic toggle="yes">β</italic><sub>2</sub>, <italic toggle="yes">β</italic><sub>3</sub>, and latent <bold>y</bold>. On 60% of iterations proposals to modify <italic toggle="yes">σ</italic><sup>2</sup>, <italic toggle="yes">β</italic><sub>2</sub>, and <italic toggle="yes">β</italic><sub>3</sub> are made; on the remaining occasions proposals to perturb latent <italic toggle="yes">y</italic><sub><italic toggle="yes">L</italic>+1</sub>, …, <italic toggle="yes">y</italic><sub><italic toggle="yes">N</italic></sub> are made.</p>
      </sec>
      <sec id="sec009">
        <title>Step 2: Sample ancestral nucleotides X</title>
        <p>First use the familiar pruning algorithm [<xref rid="pcbi.1011995.ref020" ref-type="bibr">20</xref>] to calculate the likelihood of subalignment {<bold>X</bold><sub><italic toggle="yes">i</italic>,<italic toggle="yes">s</italic></sub>} rooted at node <italic toggle="yes">i</italic> for all sites <italic toggle="yes">s</italic> = 1…<italic toggle="yes">S</italic> using the recurrence:
<disp-formula id="pcbi.1011995.e007"><alternatives><graphic xlink:href="pcbi.1011995.e007.jpg" id="pcbi.1011995.e007g" position="anchor"/><mml:math id="M7" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>∣</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:munder><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mo>·</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:munder><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(4)</label></disp-formula></p>
        <p>Next, forward sample ancestral nucleotides <bold>X</bold><sub><italic toggle="yes">L</italic>+1…<italic toggle="yes">N</italic>,1…<italic toggle="yes">S</italic></sub>. For sites at the root node we have <italic toggle="yes">P</italic>(<italic toggle="yes">X</italic><sub><italic toggle="yes">R</italic>,<italic toggle="yes">s</italic></sub>|{<bold>X</bold><sub><italic toggle="yes">R</italic>,<italic toggle="yes">s</italic></sub>}, <bold>z</bold>, <bold>r</bold>) ∝ <italic toggle="yes">P</italic>({<bold>X</bold><sub><italic toggle="yes">R</italic>,<italic toggle="yes">s</italic></sub>}|<italic toggle="yes">X</italic><sub><italic toggle="yes">R</italic>,<italic toggle="yes">s</italic></sub>, <bold>z</bold>, <bold>r</bold>)<italic toggle="yes">P</italic>(<italic toggle="yes">X</italic><sub><italic toggle="yes">R</italic>,<italic toggle="yes">s</italic></sub>) and <inline-formula id="pcbi.1011995.e008"><alternatives><graphic xlink:href="pcbi.1011995.e008.jpg" id="pcbi.1011995.e008g" position="anchor"/><mml:math id="M8" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> by assumption. For the remaining internal nodes we work from root to tips on a per-site basis using:
<disp-formula id="pcbi.1011995.e009"><alternatives><graphic xlink:href="pcbi.1011995.e009.jpg" id="pcbi.1011995.e009g" position="anchor"/><mml:math id="M9" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(5)</label></disp-formula></p>
      </sec>
      <sec id="sec010">
        <title>Step 3: Sample per-branch latent conservation states z</title>
        <p>First, from tips to root, calculate the joint likelihood of trait values and nucleotide emissions {<bold>XY</bold><sub><italic toggle="yes">i</italic></sub>} occurring on the subtree rooted at node <italic toggle="yes">i</italic> using the recurrence:
<disp-formula id="pcbi.1011995.e010"><alternatives><graphic xlink:href="pcbi.1011995.e010.jpg" id="pcbi.1011995.e010g" position="anchor"/><mml:math id="M10" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">Φ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:munderover><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>·</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>·</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:munder><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold">Φ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">Φ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>·</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:munder><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold">Φ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">Φ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(6)</label></disp-formula></p>
        <p>Next, sample <bold>z</bold> from root to tips. At the root our (domain specific) prior is <italic toggle="yes">P</italic>(<italic toggle="yes">z</italic><sub><italic toggle="yes">R</italic></sub>) = (0.5, 0.5, 0.0). For descendant nodes the appropriate probabilities are:
<disp-formula id="pcbi.1011995.e011"><alternatives><graphic xlink:href="pcbi.1011995.e011.jpg" id="pcbi.1011995.e011g" position="anchor"/><mml:math id="M11" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">Φ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">Φ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold">Φ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(7)</label></disp-formula></p>
      </sec>
      <sec id="sec011">
        <title>Step 4: Sample per-category nucleotide substitution rate multipliers r</title>
        <p>Perform Metropolis step to propose/update substitution rate multipliers <italic toggle="yes">r</italic><sub>2</sub> and <italic toggle="yes">r</italic><sub>3</sub>.</p>
      </sec>
      <sec id="sec012">
        <title>Step 5: Sample latent rate category transition probabilities Φ</title>
        <p>The beta prior on entries <italic toggle="yes">a</italic>, <italic toggle="yes">b</italic> and <italic toggle="yes">c</italic> of <bold>Φ</bold> leads to a beta posterior. For example, the posterior of <italic toggle="yes">c</italic> is directly sampled based on <bold>z</bold> transitions from 1 → 2 as follows:
<disp-formula id="pcbi.1011995.e012"><alternatives><graphic xlink:href="pcbi.1011995.e012.jpg" id="pcbi.1011995.e012g" position="anchor"/><mml:math id="M12" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>c</mml:mi><mml:mo>∼</mml:mo><mml:mtext>Beta</mml:mtext><mml:mspace width="2pt"/><mml:mo>(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mi>j</mml:mi><mml:mi>E</mml:mi></mml:munderover><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>β</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mi>j</mml:mi><mml:mi>E</mml:mi></mml:munderover><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(8)</label></disp-formula></p>
        <p>The posteriors of <italic toggle="yes">a</italic> and <italic toggle="yes">b</italic> are calculated similarly using the count of transitions 2 → 3 and 3 → 2 respectively.</p>
      </sec>
    </sec>
    <sec id="sec013">
      <title>Model selection and ranking of associated loci</title>
      <p>A collection of candidate elements can be ranked for association with a trait of interest using the Bayes factor (BF) [<xref rid="pcbi.1011995.ref021" ref-type="bibr">21</xref>] in favour of the ‘full model’ described above. In the full model, <italic toggle="yes">σ</italic><sup>2</sup>, <italic toggle="yes">β</italic><sub>2</sub>, and <italic toggle="yes">β</italic><sub>3</sub> are free to vary whereas in the more restricted null model this is not the case, and <italic toggle="yes">β</italic><sub>2</sub> = <italic toggle="yes">β</italic><sub>3</sub> = 1 so that no systematic relationship between the rate of trait evolution and relative substitution rates is specified. As the null model is nested and the priors on <italic toggle="yes">β</italic><sub>2</sub> and <italic toggle="yes">β</italic><sub>3</sub> are common to all candidate elements, the BF is estimated using the posterior density of (log <italic toggle="yes">β</italic><sub>2</sub>, log <italic toggle="yes">β</italic><sub>3</sub>) at (0, 0). This is an application of the Savage–Dickey method, which is explained in the tutorial of Wagenmakers et al. [<xref rid="pcbi.1011995.ref022" ref-type="bibr">22</xref>].</p>
    </sec>
    <sec id="sec014">
      <title>Molecular data</title>
      <p>We obtained mammalian CNE alignments directly from the first author of [<xref rid="pcbi.1011995.ref012" ref-type="bibr">12</xref>], who had in turn originally obtained them from the UCSC 100-way vertebrate alignment [<xref rid="pcbi.1011995.ref023" ref-type="bibr">23</xref>] available at: <ext-link xlink:href="http://hgdownload.soe.ucsc.edu/goldenPath/hg38/multiz100way" ext-link-type="uri">http://hgdownload.soe.ucsc.edu/goldenPath/hg38/multiz100way</ext-link>. We obtained the rate matrix and mammal phylogeny (see <xref rid="pcbi.1011995.s001" ref-type="supplementary-material">S1 Text</xref>) used to model the background relationship between species from the PhyloAcc GitHub repository, prepared by Hu et al. [<xref rid="pcbi.1011995.ref012" ref-type="bibr">12</xref>], and available at: <ext-link xlink:href="https://github.com/phyloacc/Hu-etal-2019-data/" ext-link-type="uri">https://github.com/phyloacc/Hu-etal-2019-data/</ext-link>. The mammal phylogeny was originally prepared by Murphy et al. [<xref rid="pcbi.1011995.ref024" ref-type="bibr">24</xref>].</p>
    </sec>
    <sec id="sec015">
      <title>Software implementation</title>
      <p>The PhyloAcc-C software is implemented as an R package [<xref rid="pcbi.1011995.ref025" ref-type="bibr">25</xref>] that makes use of C++ functions [<xref rid="pcbi.1011995.ref026" ref-type="bibr">26</xref>, <xref rid="pcbi.1011995.ref027" ref-type="bibr">27</xref>] to perform MCMC sampling. To use the package one must load an alignment (e.g. a FASTA file) and a tree (e.g. a New Hampshire file) by using the package ape [<xref rid="pcbi.1011995.ref028" ref-type="bibr">28</xref>] or similar. Trait data should be loaded into an R data frame and labelled so that it can be matched to the species names in the tree.</p>
      <p>The PhyloAcc-C package includes helper functions (sim_X, sim_y, and sim_z) enabling one to simulate alignments, traits, and conservation states under the PhyloAcc-C model. We used these functions to assess model performance in this paper, and a user may do the same given their own phylogeny and rate matrix.</p>
      <p>The software, installation instructions, and a tutorial covering simulation and inference are all available at <ext-link xlink:href="https://github.com/phyloacc/PhyloAcc-C" ext-link-type="uri">https://github.com/phyloacc/PhyloAcc-C</ext-link>.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec016">
    <title>Results</title>
    <p>To demonstrate that it is possible in principle to relate the rate of trait evolution to the rate of nucleotide evolution using PhyloAcc-C, we performed a simulation study under ideal circumstances. Then, to illustrate the method using real data, we downloaded principal component data representing the trait ‘long-lived large-bodied’ (LLL) previously studied with respect to protein evolution by Kowalczyk et al. [<xref rid="pcbi.1011995.ref015" ref-type="bibr">15</xref>]. This trait was analyzed in relation to CNEs previously studied by Hu et al. [<xref rid="pcbi.1011995.ref012" ref-type="bibr">12</xref>].</p>
    <p>In both simulations and our illustrative example, we focused on the quantity log(<italic toggle="yes">β</italic><sub>3</sub>/<italic toggle="yes">β</italic><sub>2</sub>). This quantity contrasts variation of a trait on branches undergoing accelerated sequence evolution against variation on branches undergoing conserved sequence evolution; a positive quantity associates faster nucleotide evolution with faster trait change whereas a negative quantity associates faster nucleotide evolution with slower trait evolution. Values close to zero suggest no strong systematic relationship under the PhyloAcc-C model.</p>
    <p>Note that the state of a trait on roughly half of all nodes of a tree is unobserved, so it is difficult to make inferences about <italic toggle="yes">β</italic><sub>2</sub> or <italic toggle="yes">β</italic><sub>3</sub> separately. This is because, in general, a path through a tree can involve sequential switching between periods of hidden evolution under either the <italic toggle="yes">β</italic><sub>2</sub> or the <italic toggle="yes">β</italic><sub>3</sub> regime. For this reason, we focus on the ratio of the two parameters, for which we can do inference. The logarithm of the ratio is reported because we are interested in the multiplicative effects of the parameter pair, e.g., variance multiplier pair (0.2/0.4) should be thought of in the same way as pair (0.6/1.2) as in both cases the second multiplier is double the first.</p>
    <sec id="sec017">
      <title>Simulations on full binary trees</title>
      <p>Using a fully bifurcating ultrametric tree with 128 tips, we simulated 100 times from our prior distribution, generating latent conservation states, and corresponding DNA sequence alignments and phenotypic trait values. The length of the simulated elements was 80 bp, reflecting the median length of mammalian CNEs in our data set. Branch lengths were all set at 0.1, so that root to tip distances were similar to the longer of the root to tip distances on our mammalian tree.</p>
      <p>We were able to recover log(<italic toggle="yes">β</italic><sub>3</sub>/<italic toggle="yes">β</italic><sub>2</sub>) reasonably well, with an MSE (mean squared error) of 0.36 (<xref rid="pcbi.1011995.g001" ref-type="fig">Fig 1A</xref>). The estimates appeared reasonably calibrated: the 80% credible interval (the 10<sup>th</sup> to 90<sup>th</sup> percentiles) covered the simulated parameters 72% of the time. FPRs (false positive rates) were characterized by fixing <italic toggle="yes">β</italic><sub>2</sub> = <italic toggle="yes">β</italic><sub>3</sub> = 1 (no link between trait variation and molecular evolution) and simulating 200 times under two scenarios. In the first scenario (<xref rid="pcbi.1011995.t001" ref-type="table">Table 1</xref>, col. 2) elements were generated under an exclusively neutral process, in the second scenario (<xref rid="pcbi.1011995.t001" ref-type="table">Table 1</xref>, col. 5) completely conserved elements were generated. In the latter conserved scenario <italic toggle="yes">r</italic> = 0.2 was used, the expected value of <italic toggle="yes">r</italic><sub>2</sub> under our prior. The FPR dropped below 1% in the neutral scenario when a BF of 2 or more was used as a cut-off; under the conserved scenario the corresponding cut-off was also BF ≥ 2.</p>
      <fig position="float" id="pcbi.1011995.g001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011995.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Simulated versus recovered (median) log(<italic toggle="yes">β</italic><sub>3</sub>/<italic toggle="yes">β</italic><sub>2</sub>) under model using 80 bp alignments.</title>
          <p><italic toggle="yes">A</italic>. fully bifurcating ultrametric tree with 128 tips and all branch lengths set to 0.1; <italic toggle="yes">B</italic>. branch lengths are doubled to 0.2; <italic toggle="yes">C</italic>. tip count is doubled with respect to <italic toggle="yes">A</italic>, but branch lengths are reduced to 0.09 to keep root to tip distance similar; <italic toggle="yes">D</italic>. branch lengths and topology as per mammalian tree (see <xref rid="pcbi.1011995.s001" ref-type="supplementary-material">S1 Text</xref>).</p>
        </caption>
        <graphic xlink:href="pcbi.1011995.g001" position="float"/>
      </fig>
      <table-wrap position="float" id="pcbi.1011995.t001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011995.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>FPR when choosing the full model using the BF in favour as a cut-off.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="pcbi.1011995.t001" id="pcbi.1011995.t001g" position="float"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="1" colspan="1">BF cut-off</th>
                <th align="center" rowspan="1" colspan="1">neutral 128 tips</th>
                <th align="center" rowspan="1" colspan="1">neutral 128 tips long branch</th>
                <th align="center" rowspan="1" colspan="1">neutral 256 tips</th>
                <th align="center" rowspan="1" colspan="1">conserved 128 tips</th>
                <th align="center" rowspan="1" colspan="1">conserved 128 tips long branch</th>
                <th align="center" rowspan="1" colspan="1">conserved 256 tips</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1">1</td>
                <td align="char" char="." rowspan="1" colspan="1">100.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">99.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">100.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">100.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">97.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">98.5%</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">2</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">1.0%</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">3</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="t001fn001">
            <p>FPRs were estimated using 200 simulations for each of six scenarios. The tree variants were: 128 tips, branch length 0.1; 128 tips, branch length 0.2; 256 tips, branch length 0.09. The alignment variants used rate multiplier 1 (neutral) and 0.2 (conserved).</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>We doubled the branch lengths on the bifurcating tree described above to 0.2 and then performed simulations analogous to those described above. We found we were no better able to recover log(<italic toggle="yes">β</italic><sub>3</sub>/<italic toggle="yes">β</italic><sub>2</sub>), now seeing an MSE of 0.38 (<xref rid="pcbi.1011995.g001" ref-type="fig">Fig 1B</xref>). The model remained reasonably calibrated as the 80% credible interval (the 10th to 90th percentiles) covered the simulated parameters 74% of the time. FPRs dropped to less than 1% by using BF cut-offs ≥2 in both scenarios (<xref rid="pcbi.1011995.t001" ref-type="table">Table 1</xref>, cols. 3 and 6).</p>
      <p>In the last of our idealized scenarios we doubled the number of tips on the tree to 256 while reducing the branch lengths to 0.09. In this scenario, the recovery of log(<italic toggle="yes">β</italic><sub>3</sub>/<italic toggle="yes">β</italic><sub>2</sub>) improved, having an MSE of 0.21 (<xref rid="pcbi.1011995.g001" ref-type="fig">Fig 1C</xref>). The 80% credible interval covered the simulated parameters 85% of the time and BF cut-offs of 3 or more were sufficient to reduce the FPR to less than 1% (<xref rid="pcbi.1011995.t001" ref-type="table">Table 1</xref>, cols. 4 and 7).</p>
    </sec>
    <sec id="sec018">
      <title>Simulations on a mammalian tree</title>
      <p>Ultimately only performance on real phylogenies with real traits matters. In a manner similar to the above simulations, we took our mammalian tree, having 61 tips, a variety of branch lengths, and an unbalanced topology, and simulated from our prior distributions as before. Recovery of log(<italic toggle="yes">β</italic><sub>3</sub>/<italic toggle="yes">β</italic><sub>2</sub>) worked less well, with an MSE of 0.45 (<xref rid="pcbi.1011995.g001" ref-type="fig">Fig 1D</xref>), though the model characterized its uncertainty appropriately as the 80% credible interval (10th to 90th percentiles) covered the simulated parameters 79% of the time.</p>
      <p>When testing FPR, we considered scenarios relevant to our size and lifespan results (below). Therefore, we fixed the values of the trait to the real LLL trait values of Kowalczyk et al. [<xref rid="pcbi.1011995.ref015" ref-type="bibr">15</xref>] i.e. we simulated only conservation states and alignments. Three scenarios were devised: one in which all elements evolved neutrally, one in which elements were conserved at the expected level of <italic toggle="yes">r</italic> = 0.2, and one in which the elements were conserved at <italic toggle="yes">r</italic> = 0.5, which put them above the 99th percentile according to our prior. When simulating short elements (50 bp) against the LLL trait we needed BF cut-offs of 7 (neutral), 3 (conserved), and 8 (barely conserved) in order to reduce the FPR below 1% (<xref rid="pcbi.1011995.t002" ref-type="table">Table 2</xref>, cols. 2–4); when considering longer elements (180 bp) the relevant BF thresholds were 4, 4, and 7 (<xref rid="pcbi.1011995.t002" ref-type="table">Table 2</xref>, cols. 4–7). We remark that the barely conserved scenario (<italic toggle="yes">r</italic> = 0.5) presents a challenging set of parameters for the model, which does not mix well when <italic toggle="yes">r</italic><sub>2</sub> and <italic toggle="yes">r</italic><sub>3</sub> are conflated.</p>
      <table-wrap position="float" id="pcbi.1011995.t002">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011995.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>FPR on the mammalian tree (see <xref rid="pcbi.1011995.s001" ref-type="supplementary-material">S1 Text</xref>) when choosing the full model using the BF in favour as a cut-off.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="pcbi.1011995.t002" id="pcbi.1011995.t002g" position="float"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="1" colspan="1">BF cut-off</th>
                <th align="center" rowspan="1" colspan="1">neutral 50 bp</th>
                <th align="center" rowspan="1" colspan="1">conserved 50 bp</th>
                <th align="center" rowspan="1" colspan="1">barely conserved 50 bp</th>
                <th align="center" rowspan="1" colspan="1">neutral 180 bp</th>
                <th align="center" rowspan="1" colspan="1">conserved 180 bp</th>
                <th align="center" rowspan="1" colspan="1">barely conserved 180 bp</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1">1</td>
                <td align="char" char="." rowspan="1" colspan="1">100.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">100.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">100.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">100.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">100.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">100.0%</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">2</td>
                <td align="char" char="." rowspan="1" colspan="1">19.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">1.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">65.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">1.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">2.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">37.5%</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">3</td>
                <td align="char" char="." rowspan="1" colspan="1">2.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">10.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">1.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">5.5%</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">4</td>
                <td align="char" char="." rowspan="1" colspan="1">1.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">2.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">2.0%</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">5</td>
                <td align="char" char="." rowspan="1" colspan="1">1.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">1.0%</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">6</td>
                <td align="char" char="." rowspan="1" colspan="1">0.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.5%</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">7</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">8</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="t002fn001">
            <p>FPRs were estimated using 200 simulations for each of six scenarios. The rate multiplier variants used to generate the alignments were: 1 (neutral); 0.2 (conserved); 0.5 (barely conserved). The alignment length variants were 50 bp and 180 bp. The trait was not simulated but fixed to the LLL values (see <xref rid="pcbi.1011995.g002" ref-type="fig">Fig 2</xref> or <xref rid="pcbi.1011995.s002" ref-type="supplementary-material">S1 Data</xref>).</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec id="sec019">
      <title>Size and lifespan of mammals</title>
      <p>Rather than pre-filtering CNE alignments based on heuristics, we instead ran PhyloAcc-C on all alignments with the LLL trait as input and then considered those where the model fit well in a reasonable 10,000 iterations, as assessed via a Gelman and Rubin [<xref rid="pcbi.1011995.ref029" ref-type="bibr">29</xref>] convergence diagnostic of &lt; 1.01 across 3 chains. This resulted in summaries for 136,859 elements. We ranked the elements by the BF (Bayes factor) in favour of the full model, where the rate of trait evolution is allowed to co-vary with the rate of molecular evolution, versus the null model, where the rate of trait evolution is constant across the phylogeny. We found 30 elements (0.02% of total) where the full model was ‘overwhelmingly’ supported (BF ≥ 100) with respect to the LLL trait and 1,109 (0.81% of total) where the full model was ‘very strongly’ supported (BF ≥30). We note that a BF ≥ 30 generally corresponded to effect sizes of magnitude 2 or more on the log scale i.e. to a ratio of about 7× or more.</p>
      <p>The result of running PhyloAcc-C on the element with the highest BF is shown in <xref rid="pcbi.1011995.g002" ref-type="fig">Fig 2</xref>. The ancestral reconstruction of the LLL trait with respect to this element is shown in Fig A in <xref rid="pcbi.1011995.s001" ref-type="supplementary-material">S1 Text</xref>. To determine if there were biologically interesting patterns that could be systematically detected based on CNE location, we submitted the 1,109 loci of interest as genomic foreground to a GREAT analysis [<xref rid="pcbi.1011995.ref030" ref-type="bibr">30</xref>]; the GREAT tool annotates regions of non-coding DNA with biologically meaningful terms using nearby genes, but includes statistical corrections that make it a more principled alternative to an analysis based solely on the gene closest to a given CNE. The full set of 136,859 CNEs (not the whole genome) were used as genomic background for the analysis.</p>
      <fig position="float" id="pcbi.1011995.g002">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011995.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>PhyloAcc-C fit to the LLL loci with the highest BF in favour of the full model (VCE277691).</title>
          <p><italic toggle="yes">A</italic>. the mammalian phylogeny (input data, see <xref rid="pcbi.1011995.s001" ref-type="supplementary-material">S1 Text</xref>) is scaled according to the posterior distribution of rate multipliers <bold>r</bold> and coloured by the posterior distribution of conservation state <bold>z</bold> (black = neutral, blue = conserved, red = accelerated). Next to the tree the LLL trait and CNE alignment (both are also input data) are shown. The corresponding posterior distribution of the trait (i.e. an ancestral reconstruction) is shown in Fig A in <xref rid="pcbi.1011995.s001" ref-type="supplementary-material">S1 Text</xref>. <italic toggle="yes">B</italic>. the prior (dashed) and posterior (solid) distribution of the rate multipliers <italic toggle="yes">r</italic><sub>2</sub> (blue, conserved) and <italic toggle="yes">r</italic><sub>3</sub> (red, accelerated). <italic toggle="yes">C</italic>. the prior (dashed) and posterior (solid) distribution of log(<italic toggle="yes">β</italic><sub>3</sub>/<italic toggle="yes">β</italic><sub>2</sub>). In this case the posterior distribution suggests a positive value so that faster nucleotide evolution is associated with faster trait evolution, but see <xref rid="pcbi.1011995.s001" ref-type="supplementary-material">S1 Text</xref> for VCE351367 where the opposite is true. <italic toggle="yes">D</italic>. posterior distribution of trait change from tip to immediate ancestor, normalized by branch length and coloured by posterior conservation state. Again note that an accelerated conservation state (red) is associated with bigger trait moves and a conserved conservation state (blue) is associated with smaller ones.</p>
        </caption>
        <graphic xlink:href="pcbi.1011995.g002" position="float"/>
      </fig>
      <p>The GREAT analysis suggested no genes were associated with the 1,109 LLL loci of interest, although several GO (gene ontology) biological processes were. These can be summarized as: blood vessel endothelial cell proliferation involved in sprouting angiogenesis; positive regulation of branching involved in lung morphogenesis; regulation of muscle tissue development, differentiation, and proliferation, esp. in the heart; regulation of alkaline phosphatase activity; astrocyte development; organ induction; endocrine pancreas development; trachea formation.</p>
      <p>In addition to performing an analysis using GREAT, we also examined the 1 Mbp regions surrounding the top 25 loci associated (via PhyloAcc-C) with the LLL trait using the UCSC [<xref rid="pcbi.1011995.ref010" ref-type="bibr">10</xref>] and ENSEMBL [<xref rid="pcbi.1011995.ref031" ref-type="bibr">31</xref>] genome browsers, noting known functions or other annotations of nearby genes. Unlike the GREAT analysis, this was not a statistical analysis, but a set of observations made using the GeneCards tool [<xref rid="pcbi.1011995.ref032" ref-type="bibr">32</xref>], and linked databases, such as the GWAS Catalog [<xref rid="pcbi.1011995.ref033" ref-type="bibr">33</xref>]. We found that 12 loci were near genes associated with height, weight, or limb length in some way, mainly via GWAS. Seven loci were associated with cancer genes, seven with the brain or nervous system, six with the skeleton, four with sperm, and one with longevity. Three regions had little to no annotation available whereas four loci were associated with p53, cell fate, or telomere length.</p>
      <p>Overall, LLL loci with BF ≥ 30 exhibited effects in both directions, with log(<italic toggle="yes">β</italic><sub>3</sub>/<italic toggle="yes">β</italic><sub>2</sub>) being both positive and negative (<xref rid="pcbi.1011995.g003" ref-type="fig">Fig 3</xref>). The results of our note taking approach, and summaries of the PhyloAcc-C runs on the 136,859 LLL loci are recorded in <xref rid="pcbi.1011995.s002" ref-type="supplementary-material">S1 Data</xref>. Full output of the GREAT analysis is reported in <xref rid="pcbi.1011995.s003" ref-type="supplementary-material">S2 Data</xref>.</p>
      <fig position="float" id="pcbi.1011995.g003">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011995.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>BF versus estimated (median) log(<italic toggle="yes">β</italic><sub>3</sub>/<italic toggle="yes">β</italic><sub>2</sub>) for 136,859 mammalian LLL loci.</title>
          <p>Orange loci are those having BF ≥ 30 and that were submitted as GREAT foreground during analysis. The two loci with the highest BF in favour of the full model are labelled. Note VCE277691 (see <xref rid="pcbi.1011995.g002" ref-type="fig">Fig 2</xref>) and VCE351367 (see <xref rid="pcbi.1011995.s001" ref-type="supplementary-material">S1 Text</xref>) have effects with opposite signs.</p>
        </caption>
        <graphic xlink:href="pcbi.1011995.g003" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec020">
    <title>Discussion</title>
    <p>We present a statistical method, PhyloAcc-C, for relating the rate of nucleotide evolution to the rate of evolution of a continuous trait. The model is phylogenetically framed and operates under the common assumption that nucleotide evolution follows a site-independent, continuous-time discrete-state Markov process, and that continuous traits evolve under Brownian motion, although in our case with potentially different rates on different parts of the tree. Latent rate categories are also assigned to each branch using a Markov process, which all together allows the rates of molecular and phenotypic evolution to vary in an automatic way across branches.</p>
    <p>A notable feature of the model is its ability to associate the evolution of continuous traits and non-coding DNA using a more statistically integrated approach than that taken by Yusuf et al. [<xref rid="pcbi.1011995.ref014" ref-type="bibr">14</xref>] or Kowalczyk et al. [<xref rid="pcbi.1011995.ref015" ref-type="bibr">15</xref>]. Indeed, the general idea of linking genotypic rate multipliers (i.e. evolution relative to a known background tree) and phenotypic rate multipliers (i.e. variance parameters) seems natural, and could be used in other frameworks. For example, the PhyloAcc family of models (<ext-link xlink:href="https://phyloacc.github.io/" ext-link-type="uri">https://phyloacc.github.io/</ext-link>) allocates rates with efficient processing of CNEs in mind, yet genotypic and phenotypic rates of evolution can also be linked under more complex models, such as relaxed clocks [<xref rid="pcbi.1011995.ref034" ref-type="bibr">34</xref>, <xref rid="pcbi.1011995.ref035" ref-type="bibr">35</xref>] or local clocks [<xref rid="pcbi.1011995.ref036" ref-type="bibr">36</xref>], via linear or logistic functions. The efficiency versus accuracy tradeoffs of different rate assignment strategies will not be clear without further research, e.g., allowing substitution rates to change within a branch might be more computationally demanding, but is biologically more realistic and might lead to better model fit, especially because PhyloAcc-C does not take any account of branch length when considering the probability of transition between rate categories.</p>
    <p>PhyloAcc-C focuses on linking the rate of genotypic evolution with the rate of phenotypic evolution. This is distinct from: (i) relating the state of a sequence to the state of a trait; (ii) relating rapid sequence change to the state of a trait; (iii) relating the state of a sequence to rapid trait change. Many methods perform analyses related to approach (i), and have been well summarized [<xref rid="pcbi.1011995.ref001" ref-type="bibr">1</xref>]. Approach (ii) is the domain of Coevol [<xref rid="pcbi.1011995.ref013" ref-type="bibr">13</xref>] (where fast evolution across 410 mammalian cytochrome b sequences was associated with lower mass and longevity), as well as some more heuristic approaches [<xref rid="pcbi.1011995.ref014" ref-type="bibr">14</xref>, <xref rid="pcbi.1011995.ref015" ref-type="bibr">15</xref>]. In some sense approach (iii) is taken by e.g. reverse genomics [<xref rid="pcbi.1011995.ref003" ref-type="bibr">3</xref>] and PhyloAcc [<xref rid="pcbi.1011995.ref012" ref-type="bibr">12</xref>], which both treat sequences in an alignment that are sufficiently different (a threshold) as lost. If one squints hard enough, the coincident loss of a trait can then be considered a rapid change in a trait. However, the aforementioned approaches do not actually model the rate of change of a trait on the lineages where it is lost, so approach (iii) is certainly a potential area for future work.</p>
    <p>Simulations show that the model can perform acceptably on both ideal trees and a mammalian tree related to a large set of CNE alignments. This is encouraging, but we suggest users of the method check model performance using their tree, and the sequence lengths and rate multipliers they expect to see. The R software package and instructions accompanying this paper make the simulation process relatively straightforward. In addition, we emphasize that whereas larger trees might provide more data points, there is a judgment call to be made over how large a tree can be plausibly described by three rate categories.</p>
    <p>As an illustrative example, we applied PhyloAcc-C to CNEs and longevity data from mammals. From a biomedical perspective, longevity is an important trait, with a long history of study in a diversity of organisms, from worms [<xref rid="pcbi.1011995.ref037" ref-type="bibr">37</xref>] to humans [<xref rid="pcbi.1011995.ref038" ref-type="bibr">38</xref>], and therefore there is at least some possibility of assessing the plausibility of candidate loci using published evidence and annotations. Furthermore, lifespan and body-size are also relevant to longstanding conundrums and current ecological debates, including theories of life-history tradeoffs [<xref rid="pcbi.1011995.ref039" ref-type="bibr">39</xref>, <xref rid="pcbi.1011995.ref040" ref-type="bibr">40</xref>], and Peto’s paradox [<xref rid="pcbi.1011995.ref041" ref-type="bibr">41</xref>], which asks how large and long-lived animals mitigate cancer risk in the face of the many cell divisions that occur during their lifetime. This means the trait is also familiar and of interest to a broad readership. For these reasons, we describe three recent papers studying lifespan that also use broad genomic data, and help put our analysis and methodology into context.</p>
    <p>Kowalczyk et al. [<xref rid="pcbi.1011995.ref015" ref-type="bibr">15</xref>] studied the LLL trait (as previously mentioned, we reuse their trait data) but in the context of protein evolution, with an explicit focus on genes that were interpreted as being under increased purifying selection in long-lived large-bodied species, where LLL was treated as the derived state. Kowalczyk et al. [<xref rid="pcbi.1011995.ref015" ref-type="bibr">15</xref>] highlighted processes related to the cell cycle, DNA repair, cell death, immunity, and IGF1 expression pathways. Each of these processes were then plausibly linked to lifespan via their analysis. The authors also discuss telomere maintenance and p53, also plausibly linked to aging and cancer control. There is notable overlap between our LLL results and those of [<xref rid="pcbi.1011995.ref015" ref-type="bibr">15</xref>]: both analyses found associations to p53, telomere maintenance, and cell fate within 1 Mbp of our top 25 loci of interest. Our top 25 loci also have links to cancer and height or body size, though these prevalent diseases and biomarkers are of course heavily studied and consequently commonly annotated, and so we cannot know whether their appearance is simply due to their frequency.</p>
    <p>Tejada-Martinez et al. [<xref rid="pcbi.1011995.ref042" ref-type="bibr">42</xref>] also focused on protein evolution in their study of lifespan and body mass in primates, although they then linked their findings to enhancer evolution. They performed phylogenetic regressions, relating dN/dS to maximum lifespan and body mass for around 10,000 genes. In contrast to Kowalczyk et al. [<xref rid="pcbi.1011995.ref015" ref-type="bibr">15</xref>], Tejada-Martinez et al. [<xref rid="pcbi.1011995.ref042" ref-type="bibr">42</xref>] focus on positive (directional) selection on protein-coding genes rather than conservation. The authors identified 276 candidate genes whose rate of adaptive evolution positively correlated with maximum life span in a phylogenetic context. The authors focused their discussion on the enrichment of diverse processes including immunity, inflammation, cellular aging, organismal development (height, BMI), neurodevelopment, and brain function. These processes are all represented in our results in one form or another. None of the genes mentioned in the body of their manuscript occur in our notes on our top 25 loci of interest except for p53, the well known tumour suppressor, which is downregulated by HDAC3, a gene close to the CNE ranked as most-interesting overall in our LLL analysis (<xref rid="pcbi.1011995.g002" ref-type="fig">Fig 2</xref>).</p>
    <p>A third study by Treaster et al. [<xref rid="pcbi.1011995.ref043" ref-type="bibr">43</xref>] takes yet a different approach to understanding longevity. By focusing on 23 species of rockfish that are both closely related and feature a wide range of lifespans (11 to more than 200 years), the authors aimed to identify longevity related protein coding genes while minimizing false positives due to (other) convergent evolution. A key part of the analysis pipeline was the detection of rate shifts using the TRACCER tool [<xref rid="pcbi.1011995.ref007" ref-type="bibr">7</xref>]. Unlike Kolora et al. [<xref rid="pcbi.1011995.ref044" ref-type="bibr">44</xref>], and the other studies we mention, Treaster et al. [<xref rid="pcbi.1011995.ref043" ref-type="bibr">43</xref>] treated longevity as a binary trait and argued against the need to correct for body size. The authors found the ancestral rockfish state to be long-lived, and linked positive selection to glycogen biosynthesis and flavonoid metabolism via GO analysis. The top genes identified in their study do not feature in our notes on our top 25 LLL loci though, as all of us do, the authors find a relationship between their loci of interest and p53, in this case via PLA2R1. We note Treaster et al. [<xref rid="pcbi.1011995.ref043" ref-type="bibr">43</xref>] and Kowalczyk et al. [<xref rid="pcbi.1011995.ref015" ref-type="bibr">15</xref>] emphasize insulin signalling pathways, though apparently the particular pathways are under increased constraint in mammals (gene IGF1) but accelerated in Rockfish (gene INSR).</p>
    <p>The above studies either focus exclusively on protein coding genes [<xref rid="pcbi.1011995.ref015" ref-type="bibr">15</xref>, <xref rid="pcbi.1011995.ref043" ref-type="bibr">43</xref>] or examine non-coding sequences only insofar as they are identified as byproduct of an analysis with genes as the starting point and main consideration [<xref rid="pcbi.1011995.ref042" ref-type="bibr">42</xref>]. One distinguishing factor of PhyloAcc-C when compared to these approaches is that its focus is on identifying relevant non-coding sequences. It is possible then that PhyloAcc-C will sometimes identify processes that would otherwise be missed. Indeed, Treaster et al. [<xref rid="pcbi.1011995.ref043" ref-type="bibr">43</xref>] specifically mention that an attempt was made to analyze the CNE data captured as part of their study, but that their approach was underpowered when working with short conserved sequences. This suggests PhyloAcc-C might be used in a complementary manner to existing methodologies, potentially extracting further insight from a given sequencing data set. Bearing this in mind, it is interesting that our analysis appeared to highlight alternative biological themes that are not present in the results of the above studies, but that do seem plausibly related to longevity and body size. These themes are a prevalence of associations with skeletal genes and genes relating to exploratory process.</p>
    <p>When examining our top 25 LLL loci we noticed several genes related to bone strength or bone development including Fibrillin 2 (FBN2). We note that FBN2 is specifically associated with congenital contractural arachnodactyly, i.e., a particularly tall long-limbed phenotype, with long slender fingers and toes. Such non-lethal but body size-related phenotypic differences do seem to be the kind of effects that one would <italic toggle="yes">a priori</italic> imagine to be associated with true LLL loci. In the case of exploratory processes, we note that our GO analysis identified the processes ‘blood vessel endothelial cell proliferation involved in sprouting angiogenesis’ and ‘positive regulation of branching involved in lung morphogenesis’. These sort of developmental processes are exactly those thought to enhance evolvability [<xref rid="pcbi.1011995.ref045" ref-type="bibr">45</xref>, <xref rid="pcbi.1011995.ref046" ref-type="bibr">46</xref>]. The basic reasoning is that whereas core functions are conserved across metazoa, the evolutionary flexibility of anatomical traits, such as limb shape or size, is derived from the fact that many of their constituent components are decoupled from a few fixed genetically coded features. For example, the limb is a co-ordinated collection of bone, muscle, nerves, and vasculature, but the genetic orchestration of limb development is largely achieved through cartilaginous condensations, which then select feasible arrangements of the aforementioned components. However, what works for the body during development can work against it in the case of cancer, and the importance of blood supply to tumour growth and metastasis means that as of 2018 at least 14 endothelial angiogenesis inhibitors were being used to treat cancer in the USA [<xref rid="pcbi.1011995.ref047" ref-type="bibr">47</xref>].</p>
    <p>In conclusion, we have introduced a method that can be used to study the co-evolution of continuous traits and non-coding DNA. The method is available as an R package and users are free to modify it as they wish under the GPL. Applying the method highlighted interesting candidate LLL loci, including those related to exploratory processes, skeletal development, as well as more ‘typical’ lifespan related themes that have also been identified in other recent bioinformatics studies.</p>
    <p>We have given some thought to future work. Longevity and size are clearly complex traits that are correlated with each other, and also with other traits, e.g., sociality [<xref rid="pcbi.1011995.ref048" ref-type="bibr">48</xref>]. Moreover, it is not unreasonable to think that thousands of enhancers and (at least) hundreds of genes are systematically involved in the evolution of these correlated related traits. PhyloAcc-C currently cannot tease apart the relative contribution of different loci to different traits of interest. One future direction would be to focus on methods for finding clusters of loci that collectively, but not always simultaneously, contribute to the variation of a trait. Another area for future work is the incorporation of more flexible null models. One way this should be attempted is by using a more realistic method to assign nucleotide rate multipliers to branches, such as relaxed, correlated, or random local clocks, or their more recent derivatives [<xref rid="pcbi.1011995.ref049" ref-type="bibr">49</xref>]. A second improvement would be to make use of alternative models of trait evolution such as those used by Uyeda and Harmon [<xref rid="pcbi.1011995.ref050" ref-type="bibr">50</xref>]. A combination of more flexible rate assignment and alternative models of trait evolution would lead to a more plausible null model overall, giving a greater confidence that a high BF indicates an interesting locus.</p>
    <p>We see PhyloAcc-C and the other PhyloG2P methods we have discussed as first steps towards powerful tools to advance the PhyloG2P programme. Such methods will ultimately increase both our understanding of natural history and also allow us to use data from diverse species to shine a spotlight on parts of our own genome that are important for biodiversity and human health. Smith et al. [<xref rid="pcbi.1011995.ref001" ref-type="bibr">1</xref>] put it well: ‘Phylogenetics is the new genetics’.</p>
  </sec>
  <sec id="sec021" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pcbi.1011995.s001" position="float" content-type="local-data">
      <label>S1 Text</label>
      <caption>
        <title>Additional text and figures in PDF format.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1011995.s001.pdf"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011995.s002" position="float" content-type="local-data">
      <label>S1 Data</label>
      <caption>
        <title>Tables in Excel spreadsheet format.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011995.s002.xlsx"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011995.s003" position="float" content-type="local-data">
      <label>S2 Data</label>
      <caption>
        <title>Output of GREAT analysis on LLL candidate loci in PDF format.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1011995.s003.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We thank members of the Edwards, Liu, and Sackton groups for helpful discussions during the course of this research. The computations in this paper were run on the FASRC Cannon cluster supported by the FAS Division of Science Research Computing Group at Harvard University.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1011995.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Smith</surname><given-names>SD</given-names></name>, <name><surname>Pennell</surname><given-names>MW</given-names></name>, <name><surname>Dunn</surname><given-names>CW</given-names></name>, <name><surname>Edwards</surname><given-names>SV</given-names></name>. <article-title>Phylogenetics is the new genetics (for most of biodiversity)</article-title>. <source>Trends in Ecology &amp; Evolution</source>. <year>2020</year>;<volume>35</volume>(<issue>5</issue>):<fpage>415</fpage>–<lpage>425</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.tree.2020.01.005</pub-id><pub-id pub-id-type="pmid">32294423</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Hiller</surname><given-names>M</given-names></name>, <name><surname>Schaar</surname><given-names>BT</given-names></name>, <name><surname>Indjeian</surname><given-names>VB</given-names></name>, <name><surname>Kingsley</surname><given-names>DM</given-names></name>, <name><surname>Hagey</surname><given-names>LR</given-names></name>, <name><surname>Bejerano</surname><given-names>G</given-names></name>. <article-title>A “forward genomics” approach links genotype to phenotype using independent phenotypic losses among related species</article-title>. <source>Cell Reports</source>. <year>2012</year>;<volume>2</volume>(<issue>4</issue>):<fpage>817</fpage>–<lpage>823</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.celrep.2012.08.032</pub-id><?supplied-pmid 23022484?><pub-id pub-id-type="pmid">23022484</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Marcovitz</surname><given-names>A</given-names></name>, <name><surname>Jia</surname><given-names>R</given-names></name>, <name><surname>Bejerano</surname><given-names>G</given-names></name>. <article-title>“Reverse genomics” predicts function of human conserved noncoding elements</article-title>. <source>Molecular Biology and Evolution</source>. <year>2016</year>;<volume>33</volume>(<issue>5</issue>):<fpage>1358</fpage>–<lpage>1369</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msw001</pub-id><?supplied-pmid 26744417?><pub-id pub-id-type="pmid">26744417</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Prudent</surname><given-names>X</given-names></name>, <name><surname>Parra</surname><given-names>G</given-names></name>, <name><surname>Schwede</surname><given-names>P</given-names></name>, <name><surname>Roscito</surname><given-names>JG</given-names></name>, <name><surname>Hiller</surname><given-names>M</given-names></name>. <article-title>Controlling for phylogenetic relatedness and evolutionary rates improves the discovery of associations between species’ phenotypic and genomic differences</article-title>. <source>Molecular Biology and Evolution</source>. <year>2016</year>;<volume>33</volume>(<issue>8</issue>):<fpage>2135</fpage>–<lpage>2150</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msw098</pub-id><?supplied-pmid 27222536?><pub-id pub-id-type="pmid">27222536</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Langer</surname><given-names>BE</given-names></name>, <name><surname>Roscito</surname><given-names>JG</given-names></name>, <name><surname>Hiller</surname><given-names>M</given-names></name>. <article-title>REforge associates transcription factor binding site divergence in regulatory elements with phenotypic differences between species</article-title>. <source>Molecular Biology and Evolution</source>. <year>2018</year>;<volume>35</volume>(<issue>12</issue>):<fpage>3027</fpage>–<lpage>3040</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msy187</pub-id><?supplied-pmid 30256993?><pub-id pub-id-type="pmid">30256993</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Partha</surname><given-names>R</given-names></name>, <name><surname>Kowalczyk</surname><given-names>A</given-names></name>, <name><surname>Clark</surname><given-names>NL</given-names></name>, <name><surname>Chikina</surname><given-names>M</given-names></name>. <article-title>Robust method for detecting convergent shifts in evolutionary rates</article-title>. <source>Molecular Biology and Evolution</source>. <year>2019</year>;<volume>36</volume>(<issue>8</issue>):<fpage>1817</fpage>–<lpage>1830</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msz107</pub-id><?supplied-pmid 31077321?><pub-id pub-id-type="pmid">31077321</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Treaster</surname><given-names>S</given-names></name>, <name><surname>Daane</surname><given-names>JM</given-names></name>, <name><surname>Harris</surname><given-names>MP</given-names></name>. <article-title>Refining convergent rate analysis with topology in mammalian longevity and marine transitions</article-title>. <source>Molecular Biology and Evolution</source>. <year>2021</year>;<volume>38</volume>(<issue>11</issue>):<fpage>5190</fpage>–<lpage>5203</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msab226</pub-id><?supplied-pmid 34324001?><pub-id pub-id-type="pmid">34324001</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Hardison</surname><given-names>RC</given-names></name>. <article-title>Conserved noncoding sequences are reliable guides to regulatory elements</article-title>. <source>Trends in Genetics</source>. <year>2000</year>;<volume>16</volume>(<issue>9</issue>):<fpage>369</fpage>–<lpage>372</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/S0168-9525(00)02081-3</pub-id><?supplied-pmid 10973062?><pub-id pub-id-type="pmid">10973062</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref009">
      <label>9</label>
      <mixed-citation publication-type="other">Siepel A, Pollard KS, Haussler D. New methods for detecting lineage-specific selection. In: Annual International Conference on Research in Computational Molecular Biology 2006. Berlin: Springer Berlin Heidelberg; 2006 pp. 190–205.</mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Rosenbloom</surname><given-names>KR</given-names></name>, <name><surname>Armstrong</surname><given-names>J</given-names></name>, <name><surname>Barber</surname><given-names>GP</given-names></name>, <name><surname>Casper</surname><given-names>J</given-names></name>, <name><surname>Clawson</surname><given-names>H</given-names></name>, <name><surname>Diekhans</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>The UCSC genome browser database: 2015 update</article-title>. <source>Nucleic Acids Research</source>. <year>2015</year>;<volume>43</volume>(<issue>D1</issue>):<fpage>D670</fpage>–<lpage>D681</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gku1177</pub-id><?supplied-pmid 25428374?><pub-id pub-id-type="pmid">25428374</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Booker</surname><given-names>BM</given-names></name>, <name><surname>Friedrich</surname><given-names>T</given-names></name>, <name><surname>Mason</surname><given-names>MK</given-names></name>, <name><surname>VanderMeer</surname><given-names>JE</given-names></name>, <name><surname>Zhao</surname><given-names>J</given-names></name>, <name><surname>Eckalbar</surname><given-names>WL</given-names></name>, <etal>et al</etal>. <article-title>Bat accelerated regions identify a bat forelimb specific enhancer in the HoxD locus</article-title>. <source>PLoS Genetics</source>. <year>2016</year>;<volume>12</volume>(<issue>3</issue>):<fpage>e1005738</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pgen.1005738</pub-id><?supplied-pmid 27019019?><pub-id pub-id-type="pmid">27019019</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Hu</surname><given-names>Z</given-names></name>, <name><surname>Sackton</surname><given-names>TB</given-names></name>, <name><surname>Edwards</surname><given-names>SV</given-names></name>, <name><surname>Liu</surname><given-names>JS</given-names></name>. <article-title>Bayesian detection of convergent rate changes of conserved noncoding elements on phylogenetic trees</article-title>. <source>Molecular Biology and Evolution</source>. <year>2019</year>;<volume>36</volume>(<issue>5</issue>):<fpage>1086</fpage>–<lpage>1100</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msz049</pub-id><?supplied-pmid 30851112?><pub-id pub-id-type="pmid">30851112</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Lartillot</surname><given-names>N</given-names></name>, <name><surname>Poujol</surname><given-names>R</given-names></name>. <article-title>A phylogenetic model for investigating correlated evolution of substitution rates and continuous phenotypic characters</article-title>. <source>Molecular Biology and Evolution</source>. <year>2011</year>;<volume>28</volume>(<issue>1</issue>):<fpage>729</fpage>–<lpage>744</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msq244</pub-id><?supplied-pmid 20926596?><pub-id pub-id-type="pmid">20926596</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Yusuf</surname><given-names>L</given-names></name>, <name><surname>Heatley</surname><given-names>MC</given-names></name>, <name><surname>Palmer</surname><given-names>JP</given-names></name>, <name><surname>Barton</surname><given-names>HJ</given-names></name>, <name><surname>Cooney</surname><given-names>CR</given-names></name>, <name><surname>Gossmann</surname><given-names>TI</given-names></name>. <article-title>Noncoding regions underpin avian bill shape diversification at macroevolutionary scales</article-title>. <source>Genome Research</source>. <year>2020</year>;<volume>30</volume>(<issue>4</issue>):<fpage>553</fpage>–<lpage>565</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1101/gr.255752.119</pub-id><?supplied-pmid 32269134?><pub-id pub-id-type="pmid">32269134</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Kowalczyk</surname><given-names>A</given-names></name>, <name><surname>Partha</surname><given-names>R</given-names></name>, <name><surname>Clark</surname><given-names>NL</given-names></name>, <name><surname>Chikina</surname><given-names>M</given-names></name>. <article-title>Pan-mammalian analysis of molecular constraints underlying extended lifespan</article-title>. <source>Elife</source>. <year>2020</year>;<volume>9</volume>:<fpage>e51089</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.7554/eLife.51089</pub-id><?supplied-pmid 32043462?><pub-id pub-id-type="pmid">32043462</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Pollard</surname><given-names>KS</given-names></name>, <name><surname>Hubisz</surname><given-names>MJ</given-names></name>, <name><surname>Rosenbloom</surname><given-names>KR</given-names></name>, <name><surname>Siepel</surname><given-names>A</given-names></name>. <article-title>Detection of nonneutral substitution rates on mammalian phylogenies</article-title>. <source>Genome Research</source>. <year>2010</year>;<volume>20</volume>(<issue>1</issue>):<fpage>110</fpage>–<lpage>121</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1101/gr.097857.109</pub-id><?supplied-pmid 19858363?><pub-id pub-id-type="pmid">19858363</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref017">
      <label>17</label>
      <mixed-citation publication-type="book"><name><surname>Cox</surname><given-names>DR</given-names></name>, <name><surname>Miller</surname><given-names>HD</given-names></name>. <source>The theory of stochastic processes</source>. vol. <volume>134</volume>. <publisher-name>CRC press</publisher-name>; <year>1977</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>JS</given-names></name>. <article-title>The collapsed Gibbs sampler in Bayesian computations with applications to a gene regulation problem</article-title>. <source>Journal of the American Statistical Association</source>. <year>1994</year>;<volume>89</volume>(<issue>427</issue>):<fpage>958</fpage>–<lpage>966</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1080/01621459.1994.10476829</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref019">
      <label>19</label>
      <mixed-citation publication-type="book"><name><surname>Liu</surname><given-names>J</given-names></name>. <source>Monte Carlo strategies in scientific computing</source>. <publisher-loc>New York</publisher-loc>: <publisher-name>Springer-Verlag</publisher-name>; <year>2001</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Felsenstein</surname><given-names>J</given-names></name>. <article-title>Evolutionary trees from DNA sequences: a maximum likelihood approach</article-title>. <source>Journal of Molecular Evolution</source>. <year>1981</year>;<volume>17</volume>:<fpage>368</fpage>–<lpage>376</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/BF01734359</pub-id><?supplied-pmid 7288891?><pub-id pub-id-type="pmid">7288891</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Kass</surname><given-names>RE</given-names></name>, <name><surname>Raftery</surname><given-names>AE</given-names></name>. <article-title>Bayes factors</article-title>. <source>Journal of the American Statistical Association</source>. <year>1995</year>;<volume>90</volume>(<issue>430</issue>):<fpage>773</fpage>–<lpage>795</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1080/01621459.1995.10476572</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Wagenmakers</surname><given-names>EJ</given-names></name>, <name><surname>Lodewyckx</surname><given-names>T</given-names></name>, <name><surname>Kuriyal</surname><given-names>H</given-names></name>, <name><surname>Grasman</surname><given-names>R</given-names></name>. <article-title>Bayesian hypothesis testing for psychologists: A tutorial on the Savage–Dickey method</article-title>. <source>Cognitive Psychology</source>. <year>2010</year>;<volume>60</volume>(<issue>3</issue>):<fpage>158</fpage>–<lpage>189</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cogpsych.2009.12.001</pub-id><?supplied-pmid 20064637?><pub-id pub-id-type="pmid">20064637</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Blanchette</surname><given-names>M</given-names></name>, <name><surname>Kent</surname><given-names>WJ</given-names></name>, <name><surname>Riemer</surname><given-names>C</given-names></name>, <name><surname>Elnitski</surname><given-names>L</given-names></name>, <name><surname>Smit</surname><given-names>AF</given-names></name>, <name><surname>Roskin</surname><given-names>KM</given-names></name>, <etal>et al</etal>. <article-title>Aligning multiple genomic sequences with the threaded blockset aligner</article-title>. <source>Genome Research</source>. <year>2004</year>;<volume>14</volume>(<issue>4</issue>):<fpage>708</fpage>–<lpage>715</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1101/gr.1933104</pub-id><?supplied-pmid 15060014?><pub-id pub-id-type="pmid">15060014</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Murphy</surname><given-names>WJ</given-names></name>, <name><surname>Pevzner</surname><given-names>PA</given-names></name>, <name><surname>O’Brien</surname><given-names>SJ</given-names></name>. <article-title>Mammalian phylogenomics comes of age</article-title>. <source>Trends in Genetics</source>. <year>2004</year>;<volume>20</volume>(<issue>12</issue>):<fpage>631</fpage>–<lpage>639</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.tig.2004.09.005</pub-id><?supplied-pmid 15522459?><pub-id pub-id-type="pmid">15522459</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref025">
      <label>25</label>
      <mixed-citation publication-type="other">R Core Team. R: A Language and Environment for Statistical Computing; 2021. Available from: <ext-link xlink:href="https://www.R-project.org/" ext-link-type="uri">https://www.R-project.org/</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Eddelbuettel</surname><given-names>D</given-names></name>, <name><surname>François</surname><given-names>R</given-names></name>. <article-title>Rcpp: Seamless R and C++ integration</article-title>. <source>Journal of Statistical Software</source>. <year>2011</year>;<volume>40</volume>:<fpage>1</fpage>–<lpage>18</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.18637/jss.v040.i08</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Eddelbuettel</surname><given-names>D</given-names></name>, <name><surname>Sanderson</surname><given-names>C</given-names></name>. <article-title>RcppArmadillo: Accelerating R with high-performance C++ linear algebra</article-title>. <source>Computational Statistics &amp; Data Analysis</source>. <year>2014</year>;<volume>71</volume>:<fpage>1054</fpage>–<lpage>1063</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.csda.2013.02.005</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Paradis</surname><given-names>E</given-names></name>, <name><surname>Claude</surname><given-names>J</given-names></name>, <name><surname>Strimmer</surname><given-names>K</given-names></name>. <article-title>APE: analyses of phylogenetics and evolution in R language</article-title>. <source>Bioinformatics</source>. <year>2004</year>;<volume>20</volume>(<issue>2</issue>):<fpage>289</fpage>–<lpage>290</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btg412</pub-id><?supplied-pmid 14734327?><pub-id pub-id-type="pmid">14734327</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Gelman</surname><given-names>A</given-names></name>, <name><surname>Rubin</surname><given-names>DB</given-names></name>. <article-title>Inference from iterative simulation using multiple sequences</article-title>. <source>Statistical Science</source>. <year>1992</year>;<volume>7</volume>(<issue>4</issue>):<fpage>457</fpage>–<lpage>472</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1214/ss/1177011136</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>McLean</surname><given-names>CY</given-names></name>, <name><surname>Bristor</surname><given-names>D</given-names></name>, <name><surname>Hiller</surname><given-names>M</given-names></name>, <name><surname>Clarke</surname><given-names>SL</given-names></name>, <name><surname>Schaar</surname><given-names>BT</given-names></name>, <name><surname>Lowe</surname><given-names>CB</given-names></name>, <etal>et al</etal>. <article-title>GREAT improves functional interpretation of cis-regulatory regions</article-title>. <source>Nature Biotechnology</source>. <year>2010</year>;<volume>28</volume>(<issue>5</issue>):<fpage>495</fpage>–<lpage>501</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nbt.1630</pub-id><?supplied-pmid 20436461?><pub-id pub-id-type="pmid">20436461</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Flicek</surname><given-names>P</given-names></name>, <name><surname>Amode</surname><given-names>MR</given-names></name>, <name><surname>Barrell</surname><given-names>D</given-names></name>, <name><surname>Beal</surname><given-names>K</given-names></name>, <name><surname>Brent</surname><given-names>S</given-names></name>, <name><surname>Carvalho-Silva</surname><given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Ensembl 2012</article-title>. <source>Nucleic Acids Research</source>. <year>2012</year>;<volume>40</volume>(<issue>D1</issue>):<fpage>D84</fpage>–<lpage>D90</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkr991</pub-id><?supplied-pmid 22086963?><pub-id pub-id-type="pmid">22086963</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Stelzer</surname><given-names>G</given-names></name>, <name><surname>Rosen</surname><given-names>N</given-names></name>, <name><surname>Plaschkes</surname><given-names>I</given-names></name>, <name><surname>Zimmerman</surname><given-names>S</given-names></name>, <name><surname>Twik</surname><given-names>M</given-names></name>, <name><surname>Fishilevich</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>The GeneCards suite: from gene data mining to disease genome sequence analyses</article-title>. <source>Current Protocols in Bioinformatics</source>. <year>2016</year>;<volume>54</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>30</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1002/cpbi.5</pub-id><?supplied-pmid 27322403?><pub-id pub-id-type="pmid">27322403</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Sollis</surname><given-names>E</given-names></name>, <name><surname>Mosaku</surname><given-names>A</given-names></name>, <name><surname>Abid</surname><given-names>A</given-names></name>, <name><surname>Buniello</surname><given-names>A</given-names></name>, <name><surname>Cerezo</surname><given-names>M</given-names></name>, <name><surname>Gil</surname><given-names>L</given-names></name>, <etal>et al</etal>. <article-title>The NHGRI-EBI GWAS Catalog: knowledgebase and deposition resource</article-title>. <source>Nucleic Acids Research</source>. <year>2023</year>;<volume>51</volume>(<issue>D1</issue>):<fpage>D977</fpage>–<lpage>D985</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkac1010</pub-id><?supplied-pmid 36350656?><pub-id pub-id-type="pmid">36350656</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Thorne</surname><given-names>JL</given-names></name>, <name><surname>Kishino</surname><given-names>H</given-names></name>, <name><surname>Painter</surname><given-names>IS</given-names></name>. <article-title>Estimating the rate of evolution of the rate of molecular evolution</article-title>. <source>Molecular Biology and Evolution</source>. <year>1998</year>;<volume>15</volume>(<issue>12</issue>):<fpage>1647</fpage>–<lpage>1657</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/oxfordjournals.molbev.a025892</pub-id><?supplied-pmid 9866200?><pub-id pub-id-type="pmid">9866200</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Drummond</surname><given-names>AJ</given-names></name>, <name><surname>Ho</surname><given-names>SYW</given-names></name>, <name><surname>Phillips</surname><given-names>MJ</given-names></name>, <name><surname>Rambaut</surname><given-names>A</given-names></name>. <article-title>Relaxed phylogenetics and dating with confidence</article-title>. <source>PLoS Biology</source>. <year>2006</year>;<volume>4</volume>(<issue>5</issue>):<fpage>e88</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pbio.0040088</pub-id><?supplied-pmid 16683862?><pub-id pub-id-type="pmid">16683862</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Drummond</surname><given-names>AJ</given-names></name>, <name><surname>Suchard</surname><given-names>MA</given-names></name>. <article-title>Bayesian random local clocks, or one rate to rule them all</article-title>. <source>BMC Biology</source>. <year>2010</year>;<volume>8</volume>(<issue>114</issue>):<fpage>1</fpage>–<lpage>12</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1741-7007-8-114</pub-id><?supplied-pmid 20807414?><pub-id pub-id-type="pmid">20051105</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Dorman</surname><given-names>JB</given-names></name>, <name><surname>Albinder</surname><given-names>B</given-names></name>, <name><surname>Shroyer</surname><given-names>T</given-names></name>, <name><surname>Kenyon</surname><given-names>C</given-names></name>. <article-title>The age-1 and daf-2 genes function in a common pathway to control the lifespan of Caenorhabditis elegans</article-title>. <source>Genetics</source>. <year>1995</year>;<volume>141</volume>(<issue>4</issue>):<fpage>1399</fpage>–<lpage>1406</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/genetics/141.4.1399</pub-id><?supplied-pmid 8601482?><pub-id pub-id-type="pmid">8601482</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Deelen</surname><given-names>J</given-names></name>, <name><surname>Evans</surname><given-names>DS</given-names></name>, <name><surname>Arking</surname><given-names>DE</given-names></name>, <name><surname>Tesi</surname><given-names>N</given-names></name>, <name><surname>Nygaard</surname><given-names>M</given-names></name>, <name><surname>Liu</surname><given-names>X</given-names></name>, <etal>et al</etal>. <article-title>A meta-analysis of genome-wide association studies identifies multiple longevity genes</article-title>. <source>Nature Communications</source>. <year>2019</year>;<volume>10</volume>(<issue>1</issue>):<fpage>3669</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41467-019-11558-2</pub-id><?supplied-pmid 31413261?><pub-id pub-id-type="pmid">31413261</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Maklakov</surname><given-names>AA</given-names></name>, <name><surname>Immler</surname><given-names>S</given-names></name>. <article-title>The expensive germline and the evolution of ageing</article-title>. <source>Current Biology</source>. <year>2016</year>;<volume>26</volume>(<issue>13</issue>):<fpage>R577</fpage>–<lpage>R586</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cub.2016.04.012</pub-id><?supplied-pmid 27404253?><pub-id pub-id-type="pmid">27404253</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Muntané</surname><given-names>G</given-names></name>, <name><surname>Farré</surname><given-names>X</given-names></name>, <name><surname>Rodríguez</surname><given-names>JA</given-names></name>, <name><surname>Pegueroles</surname><given-names>C</given-names></name>, <name><surname>Hughes</surname><given-names>DA</given-names></name>, <name><surname>de Magalhaes</surname><given-names>JP</given-names></name>, <etal>et al</etal>. <article-title>Biological processes modulating longevity across primates: a phylogenetic genome-phenome analysis</article-title>. <source>Molecular Biology and Evolution</source>. <year>2018</year>;<volume>35</volume>(<issue>8</issue>):<fpage>1990</fpage>–<lpage>2004</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msy105</pub-id><?supplied-pmid 29788292?><pub-id pub-id-type="pmid">29788292</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Tollis</surname><given-names>M</given-names></name>, <name><surname>Boddy</surname><given-names>AM</given-names></name>, <name><surname>Maley</surname><given-names>CC</given-names></name>. <article-title>Peto’s Paradox: how has evolution solved the problem of cancer prevention?</article-title><source>BMC Biology</source>. <year>2017</year>;<volume>15</volume>(<issue>60</issue>):<fpage>1</fpage>–<lpage>5</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s12915-017-0401-7</pub-id><?supplied-pmid 28705195?><pub-id pub-id-type="pmid">28100223</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Tejada-Martinez</surname><given-names>D</given-names></name>, <name><surname>Avelar</surname><given-names>RA</given-names></name>, <name><surname>Lopes</surname><given-names>I</given-names></name>, <name><surname>Zhang</surname><given-names>B</given-names></name>, <name><surname>Novoa</surname><given-names>G</given-names></name>, <name><surname>De Magalhães</surname><given-names>JP</given-names></name>, <etal>et al</etal>. <article-title>Positive selection and enhancer evolution shaped lifespan and body mass in great apes</article-title>. <source>Molecular Biology and Evolution</source>. <year>2022</year>;<volume>39</volume>(<issue>2</issue>):<fpage>msab369</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msab369</pub-id><?supplied-pmid 34971383?><pub-id pub-id-type="pmid">34971383</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Treaster</surname><given-names>S</given-names></name>, <name><surname>Deelen</surname><given-names>J</given-names></name>, <name><surname>Daane</surname><given-names>JM</given-names></name>, <name><surname>Murabito</surname><given-names>J</given-names></name>, <name><surname>Karasik</surname><given-names>D</given-names></name>, <name><surname>Harris</surname><given-names>MP</given-names></name>. <article-title>Convergent genomics of longevity in rockfishes highlights the genetics of human life span variation</article-title>. <source>Science Advances</source>. <year>2023</year>;<volume>9</volume>(<issue>2</issue>):<fpage>eadd2743</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1126/sciadv.add2743</pub-id><?supplied-pmid 36630509?><pub-id pub-id-type="pmid">36630509</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Kolora</surname><given-names>SRR</given-names></name>, <name><surname>Owens</surname><given-names>GL</given-names></name>, <name><surname>Vazquez</surname><given-names>JM</given-names></name>, <name><surname>Stubbs</surname><given-names>A</given-names></name>, <name><surname>Chatla</surname><given-names>K</given-names></name>, <name><surname>Jainese</surname><given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Origins and evolution of extreme life span in Pacific Ocean rockfishes</article-title>. <source>Science</source>. <year>2021</year>;<volume>374</volume>(<issue>6569</issue>):<fpage>842</fpage>–<lpage>847</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1126/science.abg5332</pub-id><?supplied-pmid 34762458?><pub-id pub-id-type="pmid">34762458</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref045">
      <label>45</label>
      <mixed-citation publication-type="journal"><name><surname>Kirschner</surname><given-names>M</given-names></name>, <name><surname>Gerhart</surname><given-names>J</given-names></name>. <article-title>Evolvability</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>1998</year>;<volume>95</volume>(<issue>15</issue>):<fpage>8420</fpage>–<lpage>8427</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.95.15.8420</pub-id><?supplied-pmid 9671692?><pub-id pub-id-type="pmid">9671692</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref046">
      <label>46</label>
      <mixed-citation publication-type="book"><name><surname>Kirschner</surname><given-names>MW</given-names></name>, <name><surname>Gerhart</surname><given-names>JC</given-names></name>. <source>The plausibility of life: Resolving Darwin’s dilemma</source>. <publisher-name>Yale University Press</publisher-name>; <year>2005</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref047">
      <label>47</label>
      <mixed-citation publication-type="other">NIH National Cancer Institute. Angiogenesis Inhibitors; 2018. <ext-link xlink:href="https://www.cancer.gov/about-cancer/treatment/types/immunotherapy/angiogenesis-inhibitors-fact-sheet" ext-link-type="uri">https://www.cancer.gov/about-cancer/treatment/types/immunotherapy/angiogenesis-inhibitors-fact-sheet</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref048">
      <label>48</label>
      <mixed-citation publication-type="journal"><name><surname>Zhu</surname><given-names>P</given-names></name>, <name><surname>Liu</surname><given-names>W</given-names></name>, <name><surname>Zhang</surname><given-names>X</given-names></name>, <name><surname>Li</surname><given-names>M</given-names></name>, <name><surname>Liu</surname><given-names>G</given-names></name>, <name><surname>Yu</surname><given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>Correlated evolution of social organization and lifespan in mammals</article-title>. <source>Nature Communications</source>. <year>2023</year>;<volume>14</volume>(<issue>1</issue>):<fpage>372</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41467-023-35869-7</pub-id><?supplied-pmid 36720880?><pub-id pub-id-type="pmid">36720880</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref049">
      <label>49</label>
      <mixed-citation publication-type="journal"><name><surname>Fisher</surname><given-names>AA</given-names></name>, <name><surname>Ji</surname><given-names>X</given-names></name>, <name><surname>Nishimura</surname><given-names>A</given-names></name>, <name><surname>Lemey</surname><given-names>P</given-names></name>, <name><surname>Baele</surname><given-names>G</given-names></name>, <name><surname>Suchard</surname><given-names>MA</given-names></name>. <article-title>Shrinkage-based random local clocks with scalable inference</article-title>. <source>Molecular Biology and Evolution</source>. <year>2023</year>;<volume>40</volume>(<issue>11</issue>). <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msad242</pub-id><?supplied-pmid 37950885?><pub-id pub-id-type="pmid">37950885</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref050">
      <label>50</label>
      <mixed-citation publication-type="journal"><name><surname>Uyeda</surname><given-names>JC</given-names></name>, <name><surname>Harmon</surname><given-names>LJ</given-names></name>. <article-title>A novel Bayesian method for inferring and interpreting the dynamics of adaptive landscapes from phylogenetic comparative data</article-title>. <source>Systematic Biology</source>. <year>2014</year>;<volume>63</volume>(<issue>6</issue>):<fpage>902</fpage>–<lpage>918</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/sysbio/syu057</pub-id><?supplied-pmid 25077513?><pub-id pub-id-type="pmid">25077513</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLOS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">11078400</article-id>
    <article-id pub-id-type="pmid">38656999</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-23-01890</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011995</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Evolutionary Biology</subject>
          <subj-group>
            <subject>Evolutionary Processes</subject>
            <subj-group>
              <subject>Evolutionary Rate</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleotides</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genetic Loci</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Evolutionary Biology</subject>
          <subj-group>
            <subject>Evolutionary Systematics</subject>
            <subj-group>
              <subject>Phylogenetics</subject>
              <subj-group>
                <subject>Animal Phylogenetics</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Taxonomy</subject>
          <subj-group>
            <subject>Evolutionary Systematics</subject>
            <subj-group>
              <subject>Phylogenetics</subject>
              <subj-group>
                <subject>Animal Phylogenetics</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Taxonomy</subject>
            <subj-group>
              <subject>Evolutionary Systematics</subject>
              <subj-group>
                <subject>Phylogenetics</subject>
                <subj-group>
                  <subject>Animal Phylogenetics</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Zoology</subject>
          <subj-group>
            <subject>Animal Phylogenetics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Evolutionary Biology</subject>
          <subj-group>
            <subject>Molecular Evolution</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Evolutionary Biology</subject>
          <subj-group>
            <subject>Evolutionary Genetics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Evolutionary Biology</subject>
          <subj-group>
            <subject>Evolutionary Systematics</subject>
            <subj-group>
              <subject>Phylogenetics</subject>
              <subj-group>
                <subject>Phylogenetic Analysis</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Taxonomy</subject>
          <subj-group>
            <subject>Evolutionary Systematics</subject>
            <subj-group>
              <subject>Phylogenetics</subject>
              <subj-group>
                <subject>Phylogenetic Analysis</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Taxonomy</subject>
            <subj-group>
              <subject>Evolutionary Systematics</subject>
              <subj-group>
                <subject>Phylogenetics</subject>
                <subj-group>
                  <subject>Phylogenetic Analysis</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Conservation Biology</subject>
          <subj-group>
            <subject>Conservation Genetics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Ecology and Environmental Sciences</subject>
        <subj-group>
          <subject>Conservation Science</subject>
          <subj-group>
            <subject>Conservation Biology</subject>
            <subj-group>
              <subject>Conservation Genetics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Conservation Genetics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>A phylogenetic method linking nucleotide substitution rates to rates of continuous trait evolution</article-title>
      <alt-title alt-title-type="running-head">Phylogenetic modelling of DNA substitution rates and continuous trait evolution</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Gemmell</surname>
          <given-names>Patrick</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-1673-9216</contrib-id>
        <name>
          <surname>Sackton</surname>
          <given-names>Timothy B.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/resources/">Resources</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Edwards</surname>
          <given-names>Scott V.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/resources/">Resources</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-4450-7239</contrib-id>
        <name>
          <surname>Liu</surname>
          <given-names>Jun S.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/resources/">Resources</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Department of Organismic and Evolutionary Biology, Harvard University, Cambridge, Massachusetts, United States of America</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Department of Statistics, Harvard University, Cambridge, Massachusetts, United States of America</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>FAS Informatics Group, Harvard University, Cambridge, Massachusetts, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Rzhetsky</surname>
          <given-names>Andrey</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of Chicago, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>jliu@stat.harvard.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>24</day>
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <volume>20</volume>
    <issue>4</issue>
    <elocation-id>e1011995</elocation-id>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>3</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2024 Gemmell et al</copyright-statement>
      <copyright-year>2024</copyright-year>
      <copyright-holder>Gemmell et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1011995.pdf"/>
    <abstract>
      <p>Genomes contain conserved non-coding sequences that perform important biological functions, such as gene regulation. We present a phylogenetic method, PhyloAcc-C, that associates nucleotide substitution rates with changes in a continuous trait of interest. The method takes as input a multiple sequence alignment of conserved elements, continuous trait data observed in extant species, and a background phylogeny and substitution process. Gibbs sampling is used to assign rate categories (background, conserved, accelerated) to lineages and explore whether the assigned rate categories are associated with increases or decreases in the rate of trait evolution. We test our method using simulations and then illustrate its application using mammalian body size and lifespan data previously analyzed with respect to protein coding genes. Like other studies, we find processes such as tumor suppression, telomere maintenance, and p53 regulation to be related to changes in longevity and body size. In addition, we also find that skeletal genes, and developmental processes, such as sprouting angiogenesis, are relevant.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>Biologists hope to use data from diverse species to identify the genetic basis of continuous traits such as lifespan or beak shape. To do so, they need methodologies that relate genotypic and phenotypic evolution, while taking account of the relationship between species. The practice of integrating data from many species in this systematic way is relatively new, and existing approaches to the problem are often ad hoc, focus on protein coding genes, or involve discretizing continuous measurements. We avoid these limitations and develop a statistical model and software package that can be used to rapidly analyze alignments with respect to a continuous trait. Our method is illustrated by describing 136,859 conserved non-coding elements from 61 mammalian species with respect to the trait ‘long-lived and large-bodied’. We report on the loci highlighted by our model and describe how our results compare to recent studies taking other methodological approaches. We suggest approaches like ours are an important step towards realizing the potential of data collected from across the animal kingdom, whether the aim is to increase our understanding of natural history or to better understand human biology.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000051</institution-id>
            <institution>National Human Genome Research Institute</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01HG011485</award-id>
        <principal-award-recipient>
          <name>
            <surname>Edwards</surname>
            <given-names>Scott V.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000057</institution-id>
            <institution>National Institute of General Medical Sciences</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01GM152814</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-4450-7239</contrib-id>
          <name>
            <surname>Liu</surname>
            <given-names>Jun S.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This work was supported in part by NIH grant #R01HG011485 from the National Human Genome Research Institute (to TBS, SVE and JSL) and #R01GM152814 from the National Institute of General Medicine (to JSL). PG’s salary was paid from the first grant. We acknowledge support for covering the costs of publishing this article from the Wetmore Colles Fund of the Museum of Comparative Zoology at Harvard. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="3"/>
      <table-count count="2"/>
      <page-count count="18"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2024-05-08</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All data and codes will be freely available to academic researchers upon acceptance of the paper.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All data and codes will be freely available to academic researchers upon acceptance of the paper.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>In recent years there have been numerous advances in mapping genes underlying phenotypic traits. Many of these advances have built on the successes and refinements of traditional genetic mapping methods yet, as is articulated by Smith et al. [<xref rid="pcbi.1011995.ref001" ref-type="bibr">1</xref>], such approaches are often limited to the small number of model organisms amenable to crosses or other genetic manipulations. Recently, alternative phylogenetic approaches driven by comparative genomics have emerged as a useful tool for mapping genes in species not amenable to traditional approaches. Several methodologies have been proposed to associate evolution of genes or genomic regions with changes in phenotypic traits including those of [<xref rid="pcbi.1011995.ref002" ref-type="bibr">2</xref>–<xref rid="pcbi.1011995.ref007" ref-type="bibr">7</xref>]. These studies use a variety of genomic signatures as evidence of association with phenotypic evolution, including increases in evolutionary rate, loss of function such as pseudogenization, or wholesale deletion of genes or non-coding regions from the genome. Comparative approaches of this kind (hereafter ‘PhyloG2P’) have proved to be surprisingly powerful at identifying associations between genomic and phenotypic variation in the context of convergent evolution of the phenotypic trait.</p>
    <p>With the PhyloG2P research programme in mind, this paper aims to make three contributions. First, we highlight the idea of relating phenotypic and genotypic evolution by linking substitution rate multipliers (for nucleotide changes) to variance multipliers (for changes in a continuous trait). Second, we introduce a specific piece of software, PhyloAcc-C, that applies this approach in the context of conserved non-coding elements (CNEs). Third, we illustrate the PhyloAcc-C software using real data, running it with a set of mammalian CNEs and a lifespan related trait as input, thereby providing an opportunity to discuss its output in the context of other recent PhyloG2P-style studies.</p>
    <p>The overarching biological motivation for our study is our interest in evolutionary innovation, and here we are particularly concerned with methods attempting to answer the question ‘which CNEs are related to changes in a continuous trait I care about?’ This is an important question because it has been recognized for decades that there are many highly conserved stretches of non-coding DNA that participate in gene regulation across diverse species [<xref rid="pcbi.1011995.ref008" ref-type="bibr">8</xref>]. Indeed, such sequences are routinely annotated [<xref rid="pcbi.1011995.ref009" ref-type="bibr">9</xref>] in the UCSC Genome Browser [<xref rid="pcbi.1011995.ref010" ref-type="bibr">10</xref>] and may then be related to the evolution of phenotypic traits. To give one example, Booker et al. [<xref rid="pcbi.1011995.ref011" ref-type="bibr">11</xref>] identified conserved sequences that were accelerated specifically in bats, and showed that a subset acted as limb enhancers in transgenic mice. Their conclusion was that some identified enhancers were potentially instrumental to the evolution of bat wings. This conclusion was reached without modelling the co-variation of the rate of enhancer evolution and key measurements from bat wings. However, it is possible that incorporating measurements such as limb length could highlight additional relevant loci that had experienced more subtle evolutionary trajectories than bat specific acceleration.</p>
    <p>More generally, as reviewed by Smith et al. [<xref rid="pcbi.1011995.ref001" ref-type="bibr">1</xref>], there is widespread interest in relating phenotypic and molecular evolution. This interest is evidenced by the substantial effort put into producing a variety of software packages and studies that quantify the relationship between traits and substitution rates. Examples include Forward Genomics [<xref rid="pcbi.1011995.ref004" ref-type="bibr">4</xref>] and reverse genomics [<xref rid="pcbi.1011995.ref003" ref-type="bibr">3</xref>], both of which relate sequence similarity (via correlation, generalized least-squares, or heuristics) to traits (with ancestral values inferred using parsimony algorithms). A methodology with a similar goal is that of Treaster et al. [<xref rid="pcbi.1011995.ref007" ref-type="bibr">7</xref>], which uses tree topology to model the intuitive notion that comparisons between more closely related species should be less confounded by genetic background than comparisons between more distantly related ones. A recent contribution to this diverse collection of approaches is PhyloAcc [<xref rid="pcbi.1011995.ref012" ref-type="bibr">12</xref>], a Bayesian phylogenetic approach centred on latent conservation states, which is modified here in this paper. A key feature of the above four approaches is that they deal with discrete traits, and in the case of PhyloAcc, do not explicitly model the trait, instead relying on a priori reconstruction, often under the assumption of convergent gain or loss of a character state.</p>
    <p>Methods for studying the relationship between continuous traits and molecular evolution are fewer. Coevol [<xref rid="pcbi.1011995.ref013" ref-type="bibr">13</xref>] models the co-evolution of continuous traits and rates using a multivariate diffusion process, and does not require user supplied branch lengths, although calibrations can be supplied if desired. One imagines that constraining branching times will sometimes be helpful, especially when the sequences being considered are short and highly conserved, and therefore contain few distinguishing differences, as is the case with mammalian CNEs. Two more empirically focused recent studies are that of Yusuf et al. [<xref rid="pcbi.1011995.ref014" ref-type="bibr">14</xref>], who study the co-evolution of bill shape and both protein coding and non-coding DNA, and that of Kowalczyk et al. [<xref rid="pcbi.1011995.ref015" ref-type="bibr">15</xref>], who study the lifespan and body size of mammals. The former study used k-means binning to group branches of a tree based on the rate of trait evolution, and then used a likelihood ratio test to compare nucleotide substitution rates under a global clock model versus a local clock model, with one rate per bin. The latter study used the RERConverge method [<xref rid="pcbi.1011995.ref006" ref-type="bibr">6</xref>], which correlates relative rates of protein evolution and ancestral state reconstructions of a continuous trait, each estimated separately using maximum likelihood.</p>
    <p>Here we describe the PhyloAcc-C model, which connects the evolution of continuous traits and non-coding DNA using a statistically integrated approach. We then illustrate the use of our model by applying it to a mammalian trait previously analyzed using RERConverge, but this time considering CNEs rather than protein coding genes, thereby providing analyses that complement the existing literature.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Methods</title>
    <p>The PhyloAcc-C method follows the general Bayesian approach taken by Hu et al. [<xref rid="pcbi.1011995.ref012" ref-type="bibr">12</xref>] and modifies it so as to model continuous phenotypic change. In this section, we describe the method in enough detail that it may be recreated, and so that one may understand or modify our open source R/C++ implementation.</p>
    <sec id="sec003">
      <title>Input</title>
      <p>The method relies on four inputs: (1) a rooted phylogeny <bold>T</bold> having <italic toggle="yes">L</italic> leaves, <italic toggle="yes">N</italic> = 2<italic toggle="yes">L</italic> − 1 nodes, and <italic toggle="yes">E</italic> = <italic toggle="yes">N</italic> − 1 edges, and that encapsulates the relationships between species from which trait data is drawn; (2) a multiple sequence alignment of homologous CNE sequences from <italic toggle="yes">L</italic> species (rows) at <italic toggle="yes">S</italic> sites (columns) and which makes up the top <italic toggle="yes">L</italic> rows of matrix <bold>X</bold><sub><italic toggle="yes">N</italic>×<italic toggle="yes">S</italic></sub>, which will also model ancestral nucleotides; (3) a vector of continuous trait measurements observed in the corresponding <italic toggle="yes">L</italic> species and which makes up the first <italic toggle="yes">L</italic> elements of vector <bold>y</bold> = (<italic toggle="yes">y</italic><sub>1</sub>, …, <italic toggle="yes">y</italic><sub><italic toggle="yes">N</italic></sub>), which will also model ancestral trait values; (4) a rate matrix <bold>Q</bold><sub>4×4</sub> and stationary distribution <bold>π</bold> that models the background nucleotide substitution process at putatively neutral sites. The alignment may contain gaps which will be treated as missing data. Both the alignment and the nucleotide substitution parameters can be obtained using standard methods as detailed by Hu et al. [<xref rid="pcbi.1011995.ref012" ref-type="bibr">12</xref>]. In particular, the rate matrix <bold>Q</bold> is often estimated using methods like PhyloP [<xref rid="pcbi.1011995.ref016" ref-type="bibr">16</xref>] from an alignment of putatively neutral and easily alignable sites, such as fourfold degenerate sites of protein coding loci.</p>
    </sec>
    <sec id="sec004">
      <title>Model</title>
      <p>Each branch is assigned a conservation state <italic toggle="yes">z</italic><sub><italic toggle="yes">i</italic></sub> that takes on three values: background (<italic toggle="yes">z</italic><sub><italic toggle="yes">i</italic></sub> = 1), conserved (<italic toggle="yes">z</italic><sub><italic toggle="yes">i</italic></sub> = 2), or accelerated (<italic toggle="yes">z</italic><sub><italic toggle="yes">i</italic></sub> = 3). This categorization of branches into three states follows that of Hu et al. [<xref rid="pcbi.1011995.ref012" ref-type="bibr">12</xref>], which in turn was based on the approach taken by Pollard et al. [<xref rid="pcbi.1011995.ref016" ref-type="bibr">16</xref>], who apply a conserved and an accelerated state to branches of a tree in the PhyloP software. Conservation states are not assigned freely but follow a Markov process (see e.g. textbook [<xref rid="pcbi.1011995.ref017" ref-type="bibr">17</xref>]) from root to tips so that the probability of a transition on a branch from parent <italic toggle="yes">i</italic> to child <italic toggle="yes">j</italic> is <inline-formula id="pcbi.1011995.e001"><alternatives><graphic xlink:href="pcbi.1011995.e001.jpg" id="pcbi.1011995.e001g" position="anchor"/><mml:math id="M1" display="inline" overflow="scroll"><mml:mrow><mml:mtext>Pr</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">Φ</mml:mi><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, the (<italic toggle="yes">z</italic><sub><italic toggle="yes">i</italic></sub>, <italic toggle="yes">z</italic><sub><italic toggle="yes">j</italic></sub>)th element of matrix
<disp-formula id="pcbi.1011995.e002"><alternatives><graphic xlink:href="pcbi.1011995.e002.jpg" id="pcbi.1011995.e002g" position="anchor"/><mml:math id="M2" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi><mml:mo>=</mml:mo><mml:mo>[</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mi>c</mml:mi></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mi>a</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mi>b</mml:mi></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula>
with (<italic toggle="yes">a</italic>, <italic toggle="yes">b</italic>, <italic toggle="yes">c</italic>) ∈ (0, 1)<sup>3</sup>.</p>
      <p>The structure of this matrix allows CNEs to become conserved and later accelerated. Because a transition from accelerated back to conserved is also possible (i.e., <italic toggle="yes">b</italic> &gt; 0), bursts of acceleration can occur on internal branches. In principle, other matrices can be used to either constrain or relax the transition between rate categories across the tree.</p>
      <p>The conservation state of a branch affects both the nucleotide substitution process and the rate at which a trait evolves. Conservation states modulate nucleotide substitution rates via substitution rate multipliers <bold>r</bold> = (<italic toggle="yes">r</italic><sub>1</sub> = 1, <italic toggle="yes">r</italic><sub>2</sub>, <italic toggle="yes">r</italic><sub>3</sub>) so that the probability of transition from nucleotide <italic toggle="yes">a</italic> to <italic toggle="yes">b</italic> on branch <italic toggle="yes">i</italic> of length <italic toggle="yes">t</italic><sub><italic toggle="yes">i</italic></sub> is <inline-formula id="pcbi.1011995.e003"><alternatives><graphic xlink:href="pcbi.1011995.e003.jpg" id="pcbi.1011995.e003g" position="anchor"/><mml:math id="M3" display="inline" overflow="scroll"><mml:mrow><mml:mtext mathvariant="normal">expm</mml:mtext><mml:mo stretchy="false">{</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>Q</mml:mi></mml:mstyle><mml:mo>⋅</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mo stretchy="false">}</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. Similarly, conservation states on branches modulate the magnitude of trait changes along branches via variance multipliers <bold>v</bold> = (<italic toggle="yes">σ</italic><sup>2</sup>, <italic toggle="yes">β</italic><sub>2</sub><italic toggle="yes">σ</italic><sup>2</sup>, <italic toggle="yes">β</italic><sub>3</sub><italic toggle="yes">σ</italic><sup>2</sup>). Under the model, traits evolve according to normally distributed displacements along the branches of <bold>T</bold> such that cumulative displacements are observed in <italic toggle="yes">y</italic><sub>1</sub>, …, <italic toggle="yes">y</italic><sub><italic toggle="yes">L</italic></sub>. Displacements have mean 0 and a variance that is proportional to both the branch length <italic toggle="yes">t</italic><sub><italic toggle="yes">j</italic></sub> and the appropriate variance multiplier so that <inline-formula id="pcbi.1011995.e004"><alternatives><graphic xlink:href="pcbi.1011995.e004.jpg" id="pcbi.1011995.e004g" position="anchor"/><mml:math id="M4" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mspace width="0.222em"/><mml:mo stretchy="false">|</mml:mo><mml:mspace width="0.222em"/><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mtext mathvariant="normal">Normal</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>v</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and
<disp-formula id="pcbi.1011995.e005"><alternatives><graphic xlink:href="pcbi.1011995.e005.jpg" id="pcbi.1011995.e005g" position="anchor"/><mml:math id="M5" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="4pt"/><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">i</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="normal">e</mml:mi><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mspace width="2pt"/><mml:mtext>background</mml:mtext><mml:mo>;</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="4pt"/><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">i</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="normal">e</mml:mi><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mspace width="2pt"/><mml:mtext>conserved</mml:mtext><mml:mo>;</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="4pt"/><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">i</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="normal">e</mml:mi><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mspace width="2pt"/><mml:mtext>accelerated</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula></p>
    </sec>
    <sec id="sec005">
      <title>Joint distribution</title>
      <p>Letting <italic toggle="yes">pa</italic>(<italic toggle="yes">i</italic>) denote the parent of node <italic toggle="yes">i</italic>, and assuming that <italic toggle="yes">pa</italic>(<italic toggle="yes">j</italic>) = <italic toggle="yes">pa</italic>(<italic toggle="yes">k</italic>) = <italic toggle="yes">i</italic>, we can write the joint distribution of all quantities under our model as:
<disp-formula id="pcbi.1011995.e006"><alternatives><graphic xlink:href="pcbi.1011995.e006.jpg" id="pcbi.1011995.e006g" position="anchor"/><mml:math id="M6" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">Φ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:munderover><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>E</mml:mi></mml:munderover><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>E</mml:mi></mml:munderover><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>E</mml:mi></mml:munderover><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold">Φ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>·</mml:mo><mml:mo>[</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:munderover><mml:msub><mml:mi>π</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:msub><mml:mo>]</mml:mo><mml:mspace width="0.166667em"/><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">v</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">Φ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(3)</label></disp-formula></p>
      <p>The last line of the above product indicates that at the root node <italic toggle="yes">R</italic> the prior probability of observing a nucleotide is given by the (input) stationary distribution <italic toggle="yes">π</italic>, whereas the trait and conservation state are specified directly using a prior, as described below.</p>
    </sec>
    <sec id="sec006">
      <title>Specification of priors</title>
      <p>At the root node, we use Pr(<italic toggle="yes">z</italic><sub><italic toggle="yes">R</italic></sub> = 1) = Pr(<italic toggle="yes">z</italic><sub><italic toggle="yes">R</italic></sub> = 2) = 0.5. We follow Hu et al. [<xref rid="pcbi.1011995.ref012" ref-type="bibr">12</xref>] in this choice because we analyze the same CNE sequences, which were originally identified because they appeared widely conserved under a model (phastCons [<xref rid="pcbi.1011995.ref009" ref-type="bibr">9</xref>]) with two rate categories, conserved and neutral. We use <italic toggle="yes">y</italic><sub><italic toggle="yes">R</italic></sub> ∼ Normal(0, 1), although users can make their own choices freely. Priors on <italic toggle="yes">a</italic>, <italic toggle="yes">b</italic>, <italic toggle="yes">c</italic> in matrix <bold>Φ</bold> are uniform distributions (i.e., Beta(1,1)). Because we use the same nucleotide data, <italic toggle="yes">r</italic><sub>2</sub> ∼ Gamma(5, 0.04) and <italic toggle="yes">r</italic><sub>3</sub> ∼ Gamma(10, 0.2) follow the values in Hu et al. [<xref rid="pcbi.1011995.ref012" ref-type="bibr">12</xref>]. Priors on log <italic toggle="yes">β</italic><sub>2</sub> and log <italic toggle="yes">β</italic><sub>3</sub> are Normal(0, 1) which is mathematically equivalent to setting a Normal(0, 2) on log(<italic toggle="yes">β</italic><sub>3</sub>/<italic toggle="yes">β</italic><sub>2</sub>), the logarithm of their ratio. We also assume that log <italic toggle="yes">σ</italic><sup>2</sup> ∼ Normal(0, 2) <italic toggle="yes">a priori</italic>.</p>
    </sec>
    <sec id="sec007">
      <title>Bayesian inference procedure</title>
      <p>Inference is performed using a Markov chain Monte Carlo procedure, which is a combination of collapsed Gibbs sampling with some Metropolis within Gibbs steps [<xref rid="pcbi.1011995.ref018" ref-type="bibr">18</xref>, <xref rid="pcbi.1011995.ref019" ref-type="bibr">19</xref>]. The procedure is a minor modification of that introduced in pages 5–8 of the SI of Hu et al. [<xref rid="pcbi.1011995.ref012" ref-type="bibr">12</xref>], with the addition of an extra Metropolis step (Step 1), and the introduction of emission probabilities for <bold>y</bold> when sampling <bold>z</bold> (Step 3). The following steps are repeated:</p>
      <sec id="sec008">
        <title>Step 1: Sample ancestral trait values y and trait variance multipliers v</title>
        <p>Perform Metropolis steps (default is 500) to propose and update <italic toggle="yes">σ</italic><sup>2</sup>, <italic toggle="yes">β</italic><sub>2</sub>, <italic toggle="yes">β</italic><sub>3</sub>, and latent <bold>y</bold>. On 60% of iterations proposals to modify <italic toggle="yes">σ</italic><sup>2</sup>, <italic toggle="yes">β</italic><sub>2</sub>, and <italic toggle="yes">β</italic><sub>3</sub> are made; on the remaining occasions proposals to perturb latent <italic toggle="yes">y</italic><sub><italic toggle="yes">L</italic>+1</sub>, …, <italic toggle="yes">y</italic><sub><italic toggle="yes">N</italic></sub> are made.</p>
      </sec>
      <sec id="sec009">
        <title>Step 2: Sample ancestral nucleotides X</title>
        <p>First use the familiar pruning algorithm [<xref rid="pcbi.1011995.ref020" ref-type="bibr">20</xref>] to calculate the likelihood of subalignment {<bold>X</bold><sub><italic toggle="yes">i</italic>,<italic toggle="yes">s</italic></sub>} rooted at node <italic toggle="yes">i</italic> for all sites <italic toggle="yes">s</italic> = 1…<italic toggle="yes">S</italic> using the recurrence:
<disp-formula id="pcbi.1011995.e007"><alternatives><graphic xlink:href="pcbi.1011995.e007.jpg" id="pcbi.1011995.e007g" position="anchor"/><mml:math id="M7" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>∣</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:munder><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mo>·</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:munder><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(4)</label></disp-formula></p>
        <p>Next, forward sample ancestral nucleotides <bold>X</bold><sub><italic toggle="yes">L</italic>+1…<italic toggle="yes">N</italic>,1…<italic toggle="yes">S</italic></sub>. For sites at the root node we have <italic toggle="yes">P</italic>(<italic toggle="yes">X</italic><sub><italic toggle="yes">R</italic>,<italic toggle="yes">s</italic></sub>|{<bold>X</bold><sub><italic toggle="yes">R</italic>,<italic toggle="yes">s</italic></sub>}, <bold>z</bold>, <bold>r</bold>) ∝ <italic toggle="yes">P</italic>({<bold>X</bold><sub><italic toggle="yes">R</italic>,<italic toggle="yes">s</italic></sub>}|<italic toggle="yes">X</italic><sub><italic toggle="yes">R</italic>,<italic toggle="yes">s</italic></sub>, <bold>z</bold>, <bold>r</bold>)<italic toggle="yes">P</italic>(<italic toggle="yes">X</italic><sub><italic toggle="yes">R</italic>,<italic toggle="yes">s</italic></sub>) and <inline-formula id="pcbi.1011995.e008"><alternatives><graphic xlink:href="pcbi.1011995.e008.jpg" id="pcbi.1011995.e008g" position="anchor"/><mml:math id="M8" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> by assumption. For the remaining internal nodes we work from root to tips on a per-site basis using:
<disp-formula id="pcbi.1011995.e009"><alternatives><graphic xlink:href="pcbi.1011995.e009.jpg" id="pcbi.1011995.e009g" position="anchor"/><mml:math id="M9" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(5)</label></disp-formula></p>
      </sec>
      <sec id="sec010">
        <title>Step 3: Sample per-branch latent conservation states z</title>
        <p>First, from tips to root, calculate the joint likelihood of trait values and nucleotide emissions {<bold>XY</bold><sub><italic toggle="yes">i</italic></sub>} occurring on the subtree rooted at node <italic toggle="yes">i</italic> using the recurrence:
<disp-formula id="pcbi.1011995.e010"><alternatives><graphic xlink:href="pcbi.1011995.e010.jpg" id="pcbi.1011995.e010g" position="anchor"/><mml:math id="M10" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">Φ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:munderover><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>·</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>·</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:munder><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold">Φ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">Φ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>·</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:munder><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold">Φ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">Φ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(6)</label></disp-formula></p>
        <p>Next, sample <bold>z</bold> from root to tips. At the root our (domain specific) prior is <italic toggle="yes">P</italic>(<italic toggle="yes">z</italic><sub><italic toggle="yes">R</italic></sub>) = (0.5, 0.5, 0.0). For descendant nodes the appropriate probabilities are:
<disp-formula id="pcbi.1011995.e011"><alternatives><graphic xlink:href="pcbi.1011995.e011.jpg" id="pcbi.1011995.e011g" position="anchor"/><mml:math id="M11" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">Φ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">Φ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold">Φ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(7)</label></disp-formula></p>
      </sec>
      <sec id="sec011">
        <title>Step 4: Sample per-category nucleotide substitution rate multipliers r</title>
        <p>Perform Metropolis step to propose/update substitution rate multipliers <italic toggle="yes">r</italic><sub>2</sub> and <italic toggle="yes">r</italic><sub>3</sub>.</p>
      </sec>
      <sec id="sec012">
        <title>Step 5: Sample latent rate category transition probabilities Φ</title>
        <p>The beta prior on entries <italic toggle="yes">a</italic>, <italic toggle="yes">b</italic> and <italic toggle="yes">c</italic> of <bold>Φ</bold> leads to a beta posterior. For example, the posterior of <italic toggle="yes">c</italic> is directly sampled based on <bold>z</bold> transitions from 1 → 2 as follows:
<disp-formula id="pcbi.1011995.e012"><alternatives><graphic xlink:href="pcbi.1011995.e012.jpg" id="pcbi.1011995.e012g" position="anchor"/><mml:math id="M12" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>c</mml:mi><mml:mo>∼</mml:mo><mml:mtext>Beta</mml:mtext><mml:mspace width="2pt"/><mml:mo>(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mi>j</mml:mi><mml:mi>E</mml:mi></mml:munderover><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>β</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mi>j</mml:mi><mml:mi>E</mml:mi></mml:munderover><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(8)</label></disp-formula></p>
        <p>The posteriors of <italic toggle="yes">a</italic> and <italic toggle="yes">b</italic> are calculated similarly using the count of transitions 2 → 3 and 3 → 2 respectively.</p>
      </sec>
    </sec>
    <sec id="sec013">
      <title>Model selection and ranking of associated loci</title>
      <p>A collection of candidate elements can be ranked for association with a trait of interest using the Bayes factor (BF) [<xref rid="pcbi.1011995.ref021" ref-type="bibr">21</xref>] in favour of the ‘full model’ described above. In the full model, <italic toggle="yes">σ</italic><sup>2</sup>, <italic toggle="yes">β</italic><sub>2</sub>, and <italic toggle="yes">β</italic><sub>3</sub> are free to vary whereas in the more restricted null model this is not the case, and <italic toggle="yes">β</italic><sub>2</sub> = <italic toggle="yes">β</italic><sub>3</sub> = 1 so that no systematic relationship between the rate of trait evolution and relative substitution rates is specified. As the null model is nested and the priors on <italic toggle="yes">β</italic><sub>2</sub> and <italic toggle="yes">β</italic><sub>3</sub> are common to all candidate elements, the BF is estimated using the posterior density of (log <italic toggle="yes">β</italic><sub>2</sub>, log <italic toggle="yes">β</italic><sub>3</sub>) at (0, 0). This is an application of the Savage–Dickey method, which is explained in the tutorial of Wagenmakers et al. [<xref rid="pcbi.1011995.ref022" ref-type="bibr">22</xref>].</p>
    </sec>
    <sec id="sec014">
      <title>Molecular data</title>
      <p>We obtained mammalian CNE alignments directly from the first author of [<xref rid="pcbi.1011995.ref012" ref-type="bibr">12</xref>], who had in turn originally obtained them from the UCSC 100-way vertebrate alignment [<xref rid="pcbi.1011995.ref023" ref-type="bibr">23</xref>] available at: <ext-link xlink:href="http://hgdownload.soe.ucsc.edu/goldenPath/hg38/multiz100way" ext-link-type="uri">http://hgdownload.soe.ucsc.edu/goldenPath/hg38/multiz100way</ext-link>. We obtained the rate matrix and mammal phylogeny (see <xref rid="pcbi.1011995.s001" ref-type="supplementary-material">S1 Text</xref>) used to model the background relationship between species from the PhyloAcc GitHub repository, prepared by Hu et al. [<xref rid="pcbi.1011995.ref012" ref-type="bibr">12</xref>], and available at: <ext-link xlink:href="https://github.com/phyloacc/Hu-etal-2019-data/" ext-link-type="uri">https://github.com/phyloacc/Hu-etal-2019-data/</ext-link>. The mammal phylogeny was originally prepared by Murphy et al. [<xref rid="pcbi.1011995.ref024" ref-type="bibr">24</xref>].</p>
    </sec>
    <sec id="sec015">
      <title>Software implementation</title>
      <p>The PhyloAcc-C software is implemented as an R package [<xref rid="pcbi.1011995.ref025" ref-type="bibr">25</xref>] that makes use of C++ functions [<xref rid="pcbi.1011995.ref026" ref-type="bibr">26</xref>, <xref rid="pcbi.1011995.ref027" ref-type="bibr">27</xref>] to perform MCMC sampling. To use the package one must load an alignment (e.g. a FASTA file) and a tree (e.g. a New Hampshire file) by using the package ape [<xref rid="pcbi.1011995.ref028" ref-type="bibr">28</xref>] or similar. Trait data should be loaded into an R data frame and labelled so that it can be matched to the species names in the tree.</p>
      <p>The PhyloAcc-C package includes helper functions (sim_X, sim_y, and sim_z) enabling one to simulate alignments, traits, and conservation states under the PhyloAcc-C model. We used these functions to assess model performance in this paper, and a user may do the same given their own phylogeny and rate matrix.</p>
      <p>The software, installation instructions, and a tutorial covering simulation and inference are all available at <ext-link xlink:href="https://github.com/phyloacc/PhyloAcc-C" ext-link-type="uri">https://github.com/phyloacc/PhyloAcc-C</ext-link>.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec016">
    <title>Results</title>
    <p>To demonstrate that it is possible in principle to relate the rate of trait evolution to the rate of nucleotide evolution using PhyloAcc-C, we performed a simulation study under ideal circumstances. Then, to illustrate the method using real data, we downloaded principal component data representing the trait ‘long-lived large-bodied’ (LLL) previously studied with respect to protein evolution by Kowalczyk et al. [<xref rid="pcbi.1011995.ref015" ref-type="bibr">15</xref>]. This trait was analyzed in relation to CNEs previously studied by Hu et al. [<xref rid="pcbi.1011995.ref012" ref-type="bibr">12</xref>].</p>
    <p>In both simulations and our illustrative example, we focused on the quantity log(<italic toggle="yes">β</italic><sub>3</sub>/<italic toggle="yes">β</italic><sub>2</sub>). This quantity contrasts variation of a trait on branches undergoing accelerated sequence evolution against variation on branches undergoing conserved sequence evolution; a positive quantity associates faster nucleotide evolution with faster trait change whereas a negative quantity associates faster nucleotide evolution with slower trait evolution. Values close to zero suggest no strong systematic relationship under the PhyloAcc-C model.</p>
    <p>Note that the state of a trait on roughly half of all nodes of a tree is unobserved, so it is difficult to make inferences about <italic toggle="yes">β</italic><sub>2</sub> or <italic toggle="yes">β</italic><sub>3</sub> separately. This is because, in general, a path through a tree can involve sequential switching between periods of hidden evolution under either the <italic toggle="yes">β</italic><sub>2</sub> or the <italic toggle="yes">β</italic><sub>3</sub> regime. For this reason, we focus on the ratio of the two parameters, for which we can do inference. The logarithm of the ratio is reported because we are interested in the multiplicative effects of the parameter pair, e.g., variance multiplier pair (0.2/0.4) should be thought of in the same way as pair (0.6/1.2) as in both cases the second multiplier is double the first.</p>
    <sec id="sec017">
      <title>Simulations on full binary trees</title>
      <p>Using a fully bifurcating ultrametric tree with 128 tips, we simulated 100 times from our prior distribution, generating latent conservation states, and corresponding DNA sequence alignments and phenotypic trait values. The length of the simulated elements was 80 bp, reflecting the median length of mammalian CNEs in our data set. Branch lengths were all set at 0.1, so that root to tip distances were similar to the longer of the root to tip distances on our mammalian tree.</p>
      <p>We were able to recover log(<italic toggle="yes">β</italic><sub>3</sub>/<italic toggle="yes">β</italic><sub>2</sub>) reasonably well, with an MSE (mean squared error) of 0.36 (<xref rid="pcbi.1011995.g001" ref-type="fig">Fig 1A</xref>). The estimates appeared reasonably calibrated: the 80% credible interval (the 10<sup>th</sup> to 90<sup>th</sup> percentiles) covered the simulated parameters 72% of the time. FPRs (false positive rates) were characterized by fixing <italic toggle="yes">β</italic><sub>2</sub> = <italic toggle="yes">β</italic><sub>3</sub> = 1 (no link between trait variation and molecular evolution) and simulating 200 times under two scenarios. In the first scenario (<xref rid="pcbi.1011995.t001" ref-type="table">Table 1</xref>, col. 2) elements were generated under an exclusively neutral process, in the second scenario (<xref rid="pcbi.1011995.t001" ref-type="table">Table 1</xref>, col. 5) completely conserved elements were generated. In the latter conserved scenario <italic toggle="yes">r</italic> = 0.2 was used, the expected value of <italic toggle="yes">r</italic><sub>2</sub> under our prior. The FPR dropped below 1% in the neutral scenario when a BF of 2 or more was used as a cut-off; under the conserved scenario the corresponding cut-off was also BF ≥ 2.</p>
      <fig position="float" id="pcbi.1011995.g001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011995.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Simulated versus recovered (median) log(<italic toggle="yes">β</italic><sub>3</sub>/<italic toggle="yes">β</italic><sub>2</sub>) under model using 80 bp alignments.</title>
          <p><italic toggle="yes">A</italic>. fully bifurcating ultrametric tree with 128 tips and all branch lengths set to 0.1; <italic toggle="yes">B</italic>. branch lengths are doubled to 0.2; <italic toggle="yes">C</italic>. tip count is doubled with respect to <italic toggle="yes">A</italic>, but branch lengths are reduced to 0.09 to keep root to tip distance similar; <italic toggle="yes">D</italic>. branch lengths and topology as per mammalian tree (see <xref rid="pcbi.1011995.s001" ref-type="supplementary-material">S1 Text</xref>).</p>
        </caption>
        <graphic xlink:href="pcbi.1011995.g001" position="float"/>
      </fig>
      <table-wrap position="float" id="pcbi.1011995.t001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011995.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>FPR when choosing the full model using the BF in favour as a cut-off.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="pcbi.1011995.t001" id="pcbi.1011995.t001g" position="float"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="1" colspan="1">BF cut-off</th>
                <th align="center" rowspan="1" colspan="1">neutral 128 tips</th>
                <th align="center" rowspan="1" colspan="1">neutral 128 tips long branch</th>
                <th align="center" rowspan="1" colspan="1">neutral 256 tips</th>
                <th align="center" rowspan="1" colspan="1">conserved 128 tips</th>
                <th align="center" rowspan="1" colspan="1">conserved 128 tips long branch</th>
                <th align="center" rowspan="1" colspan="1">conserved 256 tips</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1">1</td>
                <td align="char" char="." rowspan="1" colspan="1">100.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">99.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">100.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">100.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">97.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">98.5%</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">2</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">1.0%</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">3</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="t001fn001">
            <p>FPRs were estimated using 200 simulations for each of six scenarios. The tree variants were: 128 tips, branch length 0.1; 128 tips, branch length 0.2; 256 tips, branch length 0.09. The alignment variants used rate multiplier 1 (neutral) and 0.2 (conserved).</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>We doubled the branch lengths on the bifurcating tree described above to 0.2 and then performed simulations analogous to those described above. We found we were no better able to recover log(<italic toggle="yes">β</italic><sub>3</sub>/<italic toggle="yes">β</italic><sub>2</sub>), now seeing an MSE of 0.38 (<xref rid="pcbi.1011995.g001" ref-type="fig">Fig 1B</xref>). The model remained reasonably calibrated as the 80% credible interval (the 10th to 90th percentiles) covered the simulated parameters 74% of the time. FPRs dropped to less than 1% by using BF cut-offs ≥2 in both scenarios (<xref rid="pcbi.1011995.t001" ref-type="table">Table 1</xref>, cols. 3 and 6).</p>
      <p>In the last of our idealized scenarios we doubled the number of tips on the tree to 256 while reducing the branch lengths to 0.09. In this scenario, the recovery of log(<italic toggle="yes">β</italic><sub>3</sub>/<italic toggle="yes">β</italic><sub>2</sub>) improved, having an MSE of 0.21 (<xref rid="pcbi.1011995.g001" ref-type="fig">Fig 1C</xref>). The 80% credible interval covered the simulated parameters 85% of the time and BF cut-offs of 3 or more were sufficient to reduce the FPR to less than 1% (<xref rid="pcbi.1011995.t001" ref-type="table">Table 1</xref>, cols. 4 and 7).</p>
    </sec>
    <sec id="sec018">
      <title>Simulations on a mammalian tree</title>
      <p>Ultimately only performance on real phylogenies with real traits matters. In a manner similar to the above simulations, we took our mammalian tree, having 61 tips, a variety of branch lengths, and an unbalanced topology, and simulated from our prior distributions as before. Recovery of log(<italic toggle="yes">β</italic><sub>3</sub>/<italic toggle="yes">β</italic><sub>2</sub>) worked less well, with an MSE of 0.45 (<xref rid="pcbi.1011995.g001" ref-type="fig">Fig 1D</xref>), though the model characterized its uncertainty appropriately as the 80% credible interval (10th to 90th percentiles) covered the simulated parameters 79% of the time.</p>
      <p>When testing FPR, we considered scenarios relevant to our size and lifespan results (below). Therefore, we fixed the values of the trait to the real LLL trait values of Kowalczyk et al. [<xref rid="pcbi.1011995.ref015" ref-type="bibr">15</xref>] i.e. we simulated only conservation states and alignments. Three scenarios were devised: one in which all elements evolved neutrally, one in which elements were conserved at the expected level of <italic toggle="yes">r</italic> = 0.2, and one in which the elements were conserved at <italic toggle="yes">r</italic> = 0.5, which put them above the 99th percentile according to our prior. When simulating short elements (50 bp) against the LLL trait we needed BF cut-offs of 7 (neutral), 3 (conserved), and 8 (barely conserved) in order to reduce the FPR below 1% (<xref rid="pcbi.1011995.t002" ref-type="table">Table 2</xref>, cols. 2–4); when considering longer elements (180 bp) the relevant BF thresholds were 4, 4, and 7 (<xref rid="pcbi.1011995.t002" ref-type="table">Table 2</xref>, cols. 4–7). We remark that the barely conserved scenario (<italic toggle="yes">r</italic> = 0.5) presents a challenging set of parameters for the model, which does not mix well when <italic toggle="yes">r</italic><sub>2</sub> and <italic toggle="yes">r</italic><sub>3</sub> are conflated.</p>
      <table-wrap position="float" id="pcbi.1011995.t002">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011995.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>FPR on the mammalian tree (see <xref rid="pcbi.1011995.s001" ref-type="supplementary-material">S1 Text</xref>) when choosing the full model using the BF in favour as a cut-off.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="pcbi.1011995.t002" id="pcbi.1011995.t002g" position="float"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="1" colspan="1">BF cut-off</th>
                <th align="center" rowspan="1" colspan="1">neutral 50 bp</th>
                <th align="center" rowspan="1" colspan="1">conserved 50 bp</th>
                <th align="center" rowspan="1" colspan="1">barely conserved 50 bp</th>
                <th align="center" rowspan="1" colspan="1">neutral 180 bp</th>
                <th align="center" rowspan="1" colspan="1">conserved 180 bp</th>
                <th align="center" rowspan="1" colspan="1">barely conserved 180 bp</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1">1</td>
                <td align="char" char="." rowspan="1" colspan="1">100.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">100.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">100.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">100.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">100.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">100.0%</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">2</td>
                <td align="char" char="." rowspan="1" colspan="1">19.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">1.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">65.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">1.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">2.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">37.5%</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">3</td>
                <td align="char" char="." rowspan="1" colspan="1">2.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">10.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">1.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">5.5%</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">4</td>
                <td align="char" char="." rowspan="1" colspan="1">1.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">2.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">2.0%</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">5</td>
                <td align="char" char="." rowspan="1" colspan="1">1.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">1.0%</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">6</td>
                <td align="char" char="." rowspan="1" colspan="1">0.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.5%</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">7</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">8</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="t002fn001">
            <p>FPRs were estimated using 200 simulations for each of six scenarios. The rate multiplier variants used to generate the alignments were: 1 (neutral); 0.2 (conserved); 0.5 (barely conserved). The alignment length variants were 50 bp and 180 bp. The trait was not simulated but fixed to the LLL values (see <xref rid="pcbi.1011995.g002" ref-type="fig">Fig 2</xref> or <xref rid="pcbi.1011995.s002" ref-type="supplementary-material">S1 Data</xref>).</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec id="sec019">
      <title>Size and lifespan of mammals</title>
      <p>Rather than pre-filtering CNE alignments based on heuristics, we instead ran PhyloAcc-C on all alignments with the LLL trait as input and then considered those where the model fit well in a reasonable 10,000 iterations, as assessed via a Gelman and Rubin [<xref rid="pcbi.1011995.ref029" ref-type="bibr">29</xref>] convergence diagnostic of &lt; 1.01 across 3 chains. This resulted in summaries for 136,859 elements. We ranked the elements by the BF (Bayes factor) in favour of the full model, where the rate of trait evolution is allowed to co-vary with the rate of molecular evolution, versus the null model, where the rate of trait evolution is constant across the phylogeny. We found 30 elements (0.02% of total) where the full model was ‘overwhelmingly’ supported (BF ≥ 100) with respect to the LLL trait and 1,109 (0.81% of total) where the full model was ‘very strongly’ supported (BF ≥30). We note that a BF ≥ 30 generally corresponded to effect sizes of magnitude 2 or more on the log scale i.e. to a ratio of about 7× or more.</p>
      <p>The result of running PhyloAcc-C on the element with the highest BF is shown in <xref rid="pcbi.1011995.g002" ref-type="fig">Fig 2</xref>. The ancestral reconstruction of the LLL trait with respect to this element is shown in Fig A in <xref rid="pcbi.1011995.s001" ref-type="supplementary-material">S1 Text</xref>. To determine if there were biologically interesting patterns that could be systematically detected based on CNE location, we submitted the 1,109 loci of interest as genomic foreground to a GREAT analysis [<xref rid="pcbi.1011995.ref030" ref-type="bibr">30</xref>]; the GREAT tool annotates regions of non-coding DNA with biologically meaningful terms using nearby genes, but includes statistical corrections that make it a more principled alternative to an analysis based solely on the gene closest to a given CNE. The full set of 136,859 CNEs (not the whole genome) were used as genomic background for the analysis.</p>
      <fig position="float" id="pcbi.1011995.g002">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011995.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>PhyloAcc-C fit to the LLL loci with the highest BF in favour of the full model (VCE277691).</title>
          <p><italic toggle="yes">A</italic>. the mammalian phylogeny (input data, see <xref rid="pcbi.1011995.s001" ref-type="supplementary-material">S1 Text</xref>) is scaled according to the posterior distribution of rate multipliers <bold>r</bold> and coloured by the posterior distribution of conservation state <bold>z</bold> (black = neutral, blue = conserved, red = accelerated). Next to the tree the LLL trait and CNE alignment (both are also input data) are shown. The corresponding posterior distribution of the trait (i.e. an ancestral reconstruction) is shown in Fig A in <xref rid="pcbi.1011995.s001" ref-type="supplementary-material">S1 Text</xref>. <italic toggle="yes">B</italic>. the prior (dashed) and posterior (solid) distribution of the rate multipliers <italic toggle="yes">r</italic><sub>2</sub> (blue, conserved) and <italic toggle="yes">r</italic><sub>3</sub> (red, accelerated). <italic toggle="yes">C</italic>. the prior (dashed) and posterior (solid) distribution of log(<italic toggle="yes">β</italic><sub>3</sub>/<italic toggle="yes">β</italic><sub>2</sub>). In this case the posterior distribution suggests a positive value so that faster nucleotide evolution is associated with faster trait evolution, but see <xref rid="pcbi.1011995.s001" ref-type="supplementary-material">S1 Text</xref> for VCE351367 where the opposite is true. <italic toggle="yes">D</italic>. posterior distribution of trait change from tip to immediate ancestor, normalized by branch length and coloured by posterior conservation state. Again note that an accelerated conservation state (red) is associated with bigger trait moves and a conserved conservation state (blue) is associated with smaller ones.</p>
        </caption>
        <graphic xlink:href="pcbi.1011995.g002" position="float"/>
      </fig>
      <p>The GREAT analysis suggested no genes were associated with the 1,109 LLL loci of interest, although several GO (gene ontology) biological processes were. These can be summarized as: blood vessel endothelial cell proliferation involved in sprouting angiogenesis; positive regulation of branching involved in lung morphogenesis; regulation of muscle tissue development, differentiation, and proliferation, esp. in the heart; regulation of alkaline phosphatase activity; astrocyte development; organ induction; endocrine pancreas development; trachea formation.</p>
      <p>In addition to performing an analysis using GREAT, we also examined the 1 Mbp regions surrounding the top 25 loci associated (via PhyloAcc-C) with the LLL trait using the UCSC [<xref rid="pcbi.1011995.ref010" ref-type="bibr">10</xref>] and ENSEMBL [<xref rid="pcbi.1011995.ref031" ref-type="bibr">31</xref>] genome browsers, noting known functions or other annotations of nearby genes. Unlike the GREAT analysis, this was not a statistical analysis, but a set of observations made using the GeneCards tool [<xref rid="pcbi.1011995.ref032" ref-type="bibr">32</xref>], and linked databases, such as the GWAS Catalog [<xref rid="pcbi.1011995.ref033" ref-type="bibr">33</xref>]. We found that 12 loci were near genes associated with height, weight, or limb length in some way, mainly via GWAS. Seven loci were associated with cancer genes, seven with the brain or nervous system, six with the skeleton, four with sperm, and one with longevity. Three regions had little to no annotation available whereas four loci were associated with p53, cell fate, or telomere length.</p>
      <p>Overall, LLL loci with BF ≥ 30 exhibited effects in both directions, with log(<italic toggle="yes">β</italic><sub>3</sub>/<italic toggle="yes">β</italic><sub>2</sub>) being both positive and negative (<xref rid="pcbi.1011995.g003" ref-type="fig">Fig 3</xref>). The results of our note taking approach, and summaries of the PhyloAcc-C runs on the 136,859 LLL loci are recorded in <xref rid="pcbi.1011995.s002" ref-type="supplementary-material">S1 Data</xref>. Full output of the GREAT analysis is reported in <xref rid="pcbi.1011995.s003" ref-type="supplementary-material">S2 Data</xref>.</p>
      <fig position="float" id="pcbi.1011995.g003">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011995.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>BF versus estimated (median) log(<italic toggle="yes">β</italic><sub>3</sub>/<italic toggle="yes">β</italic><sub>2</sub>) for 136,859 mammalian LLL loci.</title>
          <p>Orange loci are those having BF ≥ 30 and that were submitted as GREAT foreground during analysis. The two loci with the highest BF in favour of the full model are labelled. Note VCE277691 (see <xref rid="pcbi.1011995.g002" ref-type="fig">Fig 2</xref>) and VCE351367 (see <xref rid="pcbi.1011995.s001" ref-type="supplementary-material">S1 Text</xref>) have effects with opposite signs.</p>
        </caption>
        <graphic xlink:href="pcbi.1011995.g003" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec020">
    <title>Discussion</title>
    <p>We present a statistical method, PhyloAcc-C, for relating the rate of nucleotide evolution to the rate of evolution of a continuous trait. The model is phylogenetically framed and operates under the common assumption that nucleotide evolution follows a site-independent, continuous-time discrete-state Markov process, and that continuous traits evolve under Brownian motion, although in our case with potentially different rates on different parts of the tree. Latent rate categories are also assigned to each branch using a Markov process, which all together allows the rates of molecular and phenotypic evolution to vary in an automatic way across branches.</p>
    <p>A notable feature of the model is its ability to associate the evolution of continuous traits and non-coding DNA using a more statistically integrated approach than that taken by Yusuf et al. [<xref rid="pcbi.1011995.ref014" ref-type="bibr">14</xref>] or Kowalczyk et al. [<xref rid="pcbi.1011995.ref015" ref-type="bibr">15</xref>]. Indeed, the general idea of linking genotypic rate multipliers (i.e. evolution relative to a known background tree) and phenotypic rate multipliers (i.e. variance parameters) seems natural, and could be used in other frameworks. For example, the PhyloAcc family of models (<ext-link xlink:href="https://phyloacc.github.io/" ext-link-type="uri">https://phyloacc.github.io/</ext-link>) allocates rates with efficient processing of CNEs in mind, yet genotypic and phenotypic rates of evolution can also be linked under more complex models, such as relaxed clocks [<xref rid="pcbi.1011995.ref034" ref-type="bibr">34</xref>, <xref rid="pcbi.1011995.ref035" ref-type="bibr">35</xref>] or local clocks [<xref rid="pcbi.1011995.ref036" ref-type="bibr">36</xref>], via linear or logistic functions. The efficiency versus accuracy tradeoffs of different rate assignment strategies will not be clear without further research, e.g., allowing substitution rates to change within a branch might be more computationally demanding, but is biologically more realistic and might lead to better model fit, especially because PhyloAcc-C does not take any account of branch length when considering the probability of transition between rate categories.</p>
    <p>PhyloAcc-C focuses on linking the rate of genotypic evolution with the rate of phenotypic evolution. This is distinct from: (i) relating the state of a sequence to the state of a trait; (ii) relating rapid sequence change to the state of a trait; (iii) relating the state of a sequence to rapid trait change. Many methods perform analyses related to approach (i), and have been well summarized [<xref rid="pcbi.1011995.ref001" ref-type="bibr">1</xref>]. Approach (ii) is the domain of Coevol [<xref rid="pcbi.1011995.ref013" ref-type="bibr">13</xref>] (where fast evolution across 410 mammalian cytochrome b sequences was associated with lower mass and longevity), as well as some more heuristic approaches [<xref rid="pcbi.1011995.ref014" ref-type="bibr">14</xref>, <xref rid="pcbi.1011995.ref015" ref-type="bibr">15</xref>]. In some sense approach (iii) is taken by e.g. reverse genomics [<xref rid="pcbi.1011995.ref003" ref-type="bibr">3</xref>] and PhyloAcc [<xref rid="pcbi.1011995.ref012" ref-type="bibr">12</xref>], which both treat sequences in an alignment that are sufficiently different (a threshold) as lost. If one squints hard enough, the coincident loss of a trait can then be considered a rapid change in a trait. However, the aforementioned approaches do not actually model the rate of change of a trait on the lineages where it is lost, so approach (iii) is certainly a potential area for future work.</p>
    <p>Simulations show that the model can perform acceptably on both ideal trees and a mammalian tree related to a large set of CNE alignments. This is encouraging, but we suggest users of the method check model performance using their tree, and the sequence lengths and rate multipliers they expect to see. The R software package and instructions accompanying this paper make the simulation process relatively straightforward. In addition, we emphasize that whereas larger trees might provide more data points, there is a judgment call to be made over how large a tree can be plausibly described by three rate categories.</p>
    <p>As an illustrative example, we applied PhyloAcc-C to CNEs and longevity data from mammals. From a biomedical perspective, longevity is an important trait, with a long history of study in a diversity of organisms, from worms [<xref rid="pcbi.1011995.ref037" ref-type="bibr">37</xref>] to humans [<xref rid="pcbi.1011995.ref038" ref-type="bibr">38</xref>], and therefore there is at least some possibility of assessing the plausibility of candidate loci using published evidence and annotations. Furthermore, lifespan and body-size are also relevant to longstanding conundrums and current ecological debates, including theories of life-history tradeoffs [<xref rid="pcbi.1011995.ref039" ref-type="bibr">39</xref>, <xref rid="pcbi.1011995.ref040" ref-type="bibr">40</xref>], and Peto’s paradox [<xref rid="pcbi.1011995.ref041" ref-type="bibr">41</xref>], which asks how large and long-lived animals mitigate cancer risk in the face of the many cell divisions that occur during their lifetime. This means the trait is also familiar and of interest to a broad readership. For these reasons, we describe three recent papers studying lifespan that also use broad genomic data, and help put our analysis and methodology into context.</p>
    <p>Kowalczyk et al. [<xref rid="pcbi.1011995.ref015" ref-type="bibr">15</xref>] studied the LLL trait (as previously mentioned, we reuse their trait data) but in the context of protein evolution, with an explicit focus on genes that were interpreted as being under increased purifying selection in long-lived large-bodied species, where LLL was treated as the derived state. Kowalczyk et al. [<xref rid="pcbi.1011995.ref015" ref-type="bibr">15</xref>] highlighted processes related to the cell cycle, DNA repair, cell death, immunity, and IGF1 expression pathways. Each of these processes were then plausibly linked to lifespan via their analysis. The authors also discuss telomere maintenance and p53, also plausibly linked to aging and cancer control. There is notable overlap between our LLL results and those of [<xref rid="pcbi.1011995.ref015" ref-type="bibr">15</xref>]: both analyses found associations to p53, telomere maintenance, and cell fate within 1 Mbp of our top 25 loci of interest. Our top 25 loci also have links to cancer and height or body size, though these prevalent diseases and biomarkers are of course heavily studied and consequently commonly annotated, and so we cannot know whether their appearance is simply due to their frequency.</p>
    <p>Tejada-Martinez et al. [<xref rid="pcbi.1011995.ref042" ref-type="bibr">42</xref>] also focused on protein evolution in their study of lifespan and body mass in primates, although they then linked their findings to enhancer evolution. They performed phylogenetic regressions, relating dN/dS to maximum lifespan and body mass for around 10,000 genes. In contrast to Kowalczyk et al. [<xref rid="pcbi.1011995.ref015" ref-type="bibr">15</xref>], Tejada-Martinez et al. [<xref rid="pcbi.1011995.ref042" ref-type="bibr">42</xref>] focus on positive (directional) selection on protein-coding genes rather than conservation. The authors identified 276 candidate genes whose rate of adaptive evolution positively correlated with maximum life span in a phylogenetic context. The authors focused their discussion on the enrichment of diverse processes including immunity, inflammation, cellular aging, organismal development (height, BMI), neurodevelopment, and brain function. These processes are all represented in our results in one form or another. None of the genes mentioned in the body of their manuscript occur in our notes on our top 25 loci of interest except for p53, the well known tumour suppressor, which is downregulated by HDAC3, a gene close to the CNE ranked as most-interesting overall in our LLL analysis (<xref rid="pcbi.1011995.g002" ref-type="fig">Fig 2</xref>).</p>
    <p>A third study by Treaster et al. [<xref rid="pcbi.1011995.ref043" ref-type="bibr">43</xref>] takes yet a different approach to understanding longevity. By focusing on 23 species of rockfish that are both closely related and feature a wide range of lifespans (11 to more than 200 years), the authors aimed to identify longevity related protein coding genes while minimizing false positives due to (other) convergent evolution. A key part of the analysis pipeline was the detection of rate shifts using the TRACCER tool [<xref rid="pcbi.1011995.ref007" ref-type="bibr">7</xref>]. Unlike Kolora et al. [<xref rid="pcbi.1011995.ref044" ref-type="bibr">44</xref>], and the other studies we mention, Treaster et al. [<xref rid="pcbi.1011995.ref043" ref-type="bibr">43</xref>] treated longevity as a binary trait and argued against the need to correct for body size. The authors found the ancestral rockfish state to be long-lived, and linked positive selection to glycogen biosynthesis and flavonoid metabolism via GO analysis. The top genes identified in their study do not feature in our notes on our top 25 LLL loci though, as all of us do, the authors find a relationship between their loci of interest and p53, in this case via PLA2R1. We note Treaster et al. [<xref rid="pcbi.1011995.ref043" ref-type="bibr">43</xref>] and Kowalczyk et al. [<xref rid="pcbi.1011995.ref015" ref-type="bibr">15</xref>] emphasize insulin signalling pathways, though apparently the particular pathways are under increased constraint in mammals (gene IGF1) but accelerated in Rockfish (gene INSR).</p>
    <p>The above studies either focus exclusively on protein coding genes [<xref rid="pcbi.1011995.ref015" ref-type="bibr">15</xref>, <xref rid="pcbi.1011995.ref043" ref-type="bibr">43</xref>] or examine non-coding sequences only insofar as they are identified as byproduct of an analysis with genes as the starting point and main consideration [<xref rid="pcbi.1011995.ref042" ref-type="bibr">42</xref>]. One distinguishing factor of PhyloAcc-C when compared to these approaches is that its focus is on identifying relevant non-coding sequences. It is possible then that PhyloAcc-C will sometimes identify processes that would otherwise be missed. Indeed, Treaster et al. [<xref rid="pcbi.1011995.ref043" ref-type="bibr">43</xref>] specifically mention that an attempt was made to analyze the CNE data captured as part of their study, but that their approach was underpowered when working with short conserved sequences. This suggests PhyloAcc-C might be used in a complementary manner to existing methodologies, potentially extracting further insight from a given sequencing data set. Bearing this in mind, it is interesting that our analysis appeared to highlight alternative biological themes that are not present in the results of the above studies, but that do seem plausibly related to longevity and body size. These themes are a prevalence of associations with skeletal genes and genes relating to exploratory process.</p>
    <p>When examining our top 25 LLL loci we noticed several genes related to bone strength or bone development including Fibrillin 2 (FBN2). We note that FBN2 is specifically associated with congenital contractural arachnodactyly, i.e., a particularly tall long-limbed phenotype, with long slender fingers and toes. Such non-lethal but body size-related phenotypic differences do seem to be the kind of effects that one would <italic toggle="yes">a priori</italic> imagine to be associated with true LLL loci. In the case of exploratory processes, we note that our GO analysis identified the processes ‘blood vessel endothelial cell proliferation involved in sprouting angiogenesis’ and ‘positive regulation of branching involved in lung morphogenesis’. These sort of developmental processes are exactly those thought to enhance evolvability [<xref rid="pcbi.1011995.ref045" ref-type="bibr">45</xref>, <xref rid="pcbi.1011995.ref046" ref-type="bibr">46</xref>]. The basic reasoning is that whereas core functions are conserved across metazoa, the evolutionary flexibility of anatomical traits, such as limb shape or size, is derived from the fact that many of their constituent components are decoupled from a few fixed genetically coded features. For example, the limb is a co-ordinated collection of bone, muscle, nerves, and vasculature, but the genetic orchestration of limb development is largely achieved through cartilaginous condensations, which then select feasible arrangements of the aforementioned components. However, what works for the body during development can work against it in the case of cancer, and the importance of blood supply to tumour growth and metastasis means that as of 2018 at least 14 endothelial angiogenesis inhibitors were being used to treat cancer in the USA [<xref rid="pcbi.1011995.ref047" ref-type="bibr">47</xref>].</p>
    <p>In conclusion, we have introduced a method that can be used to study the co-evolution of continuous traits and non-coding DNA. The method is available as an R package and users are free to modify it as they wish under the GPL. Applying the method highlighted interesting candidate LLL loci, including those related to exploratory processes, skeletal development, as well as more ‘typical’ lifespan related themes that have also been identified in other recent bioinformatics studies.</p>
    <p>We have given some thought to future work. Longevity and size are clearly complex traits that are correlated with each other, and also with other traits, e.g., sociality [<xref rid="pcbi.1011995.ref048" ref-type="bibr">48</xref>]. Moreover, it is not unreasonable to think that thousands of enhancers and (at least) hundreds of genes are systematically involved in the evolution of these correlated related traits. PhyloAcc-C currently cannot tease apart the relative contribution of different loci to different traits of interest. One future direction would be to focus on methods for finding clusters of loci that collectively, but not always simultaneously, contribute to the variation of a trait. Another area for future work is the incorporation of more flexible null models. One way this should be attempted is by using a more realistic method to assign nucleotide rate multipliers to branches, such as relaxed, correlated, or random local clocks, or their more recent derivatives [<xref rid="pcbi.1011995.ref049" ref-type="bibr">49</xref>]. A second improvement would be to make use of alternative models of trait evolution such as those used by Uyeda and Harmon [<xref rid="pcbi.1011995.ref050" ref-type="bibr">50</xref>]. A combination of more flexible rate assignment and alternative models of trait evolution would lead to a more plausible null model overall, giving a greater confidence that a high BF indicates an interesting locus.</p>
    <p>We see PhyloAcc-C and the other PhyloG2P methods we have discussed as first steps towards powerful tools to advance the PhyloG2P programme. Such methods will ultimately increase both our understanding of natural history and also allow us to use data from diverse species to shine a spotlight on parts of our own genome that are important for biodiversity and human health. Smith et al. [<xref rid="pcbi.1011995.ref001" ref-type="bibr">1</xref>] put it well: ‘Phylogenetics is the new genetics’.</p>
  </sec>
  <sec id="sec021" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pcbi.1011995.s001" position="float" content-type="local-data">
      <label>S1 Text</label>
      <caption>
        <title>Additional text and figures in PDF format.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1011995.s001.pdf"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011995.s002" position="float" content-type="local-data">
      <label>S1 Data</label>
      <caption>
        <title>Tables in Excel spreadsheet format.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011995.s002.xlsx"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011995.s003" position="float" content-type="local-data">
      <label>S2 Data</label>
      <caption>
        <title>Output of GREAT analysis on LLL candidate loci in PDF format.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1011995.s003.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We thank members of the Edwards, Liu, and Sackton groups for helpful discussions during the course of this research. The computations in this paper were run on the FASRC Cannon cluster supported by the FAS Division of Science Research Computing Group at Harvard University.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1011995.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Smith</surname><given-names>SD</given-names></name>, <name><surname>Pennell</surname><given-names>MW</given-names></name>, <name><surname>Dunn</surname><given-names>CW</given-names></name>, <name><surname>Edwards</surname><given-names>SV</given-names></name>. <article-title>Phylogenetics is the new genetics (for most of biodiversity)</article-title>. <source>Trends in Ecology &amp; Evolution</source>. <year>2020</year>;<volume>35</volume>(<issue>5</issue>):<fpage>415</fpage>–<lpage>425</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.tree.2020.01.005</pub-id><pub-id pub-id-type="pmid">32294423</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Hiller</surname><given-names>M</given-names></name>, <name><surname>Schaar</surname><given-names>BT</given-names></name>, <name><surname>Indjeian</surname><given-names>VB</given-names></name>, <name><surname>Kingsley</surname><given-names>DM</given-names></name>, <name><surname>Hagey</surname><given-names>LR</given-names></name>, <name><surname>Bejerano</surname><given-names>G</given-names></name>. <article-title>A “forward genomics” approach links genotype to phenotype using independent phenotypic losses among related species</article-title>. <source>Cell Reports</source>. <year>2012</year>;<volume>2</volume>(<issue>4</issue>):<fpage>817</fpage>–<lpage>823</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.celrep.2012.08.032</pub-id><?supplied-pmid 23022484?><pub-id pub-id-type="pmid">23022484</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Marcovitz</surname><given-names>A</given-names></name>, <name><surname>Jia</surname><given-names>R</given-names></name>, <name><surname>Bejerano</surname><given-names>G</given-names></name>. <article-title>“Reverse genomics” predicts function of human conserved noncoding elements</article-title>. <source>Molecular Biology and Evolution</source>. <year>2016</year>;<volume>33</volume>(<issue>5</issue>):<fpage>1358</fpage>–<lpage>1369</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msw001</pub-id><?supplied-pmid 26744417?><pub-id pub-id-type="pmid">26744417</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Prudent</surname><given-names>X</given-names></name>, <name><surname>Parra</surname><given-names>G</given-names></name>, <name><surname>Schwede</surname><given-names>P</given-names></name>, <name><surname>Roscito</surname><given-names>JG</given-names></name>, <name><surname>Hiller</surname><given-names>M</given-names></name>. <article-title>Controlling for phylogenetic relatedness and evolutionary rates improves the discovery of associations between species’ phenotypic and genomic differences</article-title>. <source>Molecular Biology and Evolution</source>. <year>2016</year>;<volume>33</volume>(<issue>8</issue>):<fpage>2135</fpage>–<lpage>2150</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msw098</pub-id><?supplied-pmid 27222536?><pub-id pub-id-type="pmid">27222536</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Langer</surname><given-names>BE</given-names></name>, <name><surname>Roscito</surname><given-names>JG</given-names></name>, <name><surname>Hiller</surname><given-names>M</given-names></name>. <article-title>REforge associates transcription factor binding site divergence in regulatory elements with phenotypic differences between species</article-title>. <source>Molecular Biology and Evolution</source>. <year>2018</year>;<volume>35</volume>(<issue>12</issue>):<fpage>3027</fpage>–<lpage>3040</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msy187</pub-id><?supplied-pmid 30256993?><pub-id pub-id-type="pmid">30256993</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Partha</surname><given-names>R</given-names></name>, <name><surname>Kowalczyk</surname><given-names>A</given-names></name>, <name><surname>Clark</surname><given-names>NL</given-names></name>, <name><surname>Chikina</surname><given-names>M</given-names></name>. <article-title>Robust method for detecting convergent shifts in evolutionary rates</article-title>. <source>Molecular Biology and Evolution</source>. <year>2019</year>;<volume>36</volume>(<issue>8</issue>):<fpage>1817</fpage>–<lpage>1830</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msz107</pub-id><?supplied-pmid 31077321?><pub-id pub-id-type="pmid">31077321</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Treaster</surname><given-names>S</given-names></name>, <name><surname>Daane</surname><given-names>JM</given-names></name>, <name><surname>Harris</surname><given-names>MP</given-names></name>. <article-title>Refining convergent rate analysis with topology in mammalian longevity and marine transitions</article-title>. <source>Molecular Biology and Evolution</source>. <year>2021</year>;<volume>38</volume>(<issue>11</issue>):<fpage>5190</fpage>–<lpage>5203</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msab226</pub-id><?supplied-pmid 34324001?><pub-id pub-id-type="pmid">34324001</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Hardison</surname><given-names>RC</given-names></name>. <article-title>Conserved noncoding sequences are reliable guides to regulatory elements</article-title>. <source>Trends in Genetics</source>. <year>2000</year>;<volume>16</volume>(<issue>9</issue>):<fpage>369</fpage>–<lpage>372</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/S0168-9525(00)02081-3</pub-id><?supplied-pmid 10973062?><pub-id pub-id-type="pmid">10973062</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref009">
      <label>9</label>
      <mixed-citation publication-type="other">Siepel A, Pollard KS, Haussler D. New methods for detecting lineage-specific selection. In: Annual International Conference on Research in Computational Molecular Biology 2006. Berlin: Springer Berlin Heidelberg; 2006 pp. 190–205.</mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Rosenbloom</surname><given-names>KR</given-names></name>, <name><surname>Armstrong</surname><given-names>J</given-names></name>, <name><surname>Barber</surname><given-names>GP</given-names></name>, <name><surname>Casper</surname><given-names>J</given-names></name>, <name><surname>Clawson</surname><given-names>H</given-names></name>, <name><surname>Diekhans</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>The UCSC genome browser database: 2015 update</article-title>. <source>Nucleic Acids Research</source>. <year>2015</year>;<volume>43</volume>(<issue>D1</issue>):<fpage>D670</fpage>–<lpage>D681</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gku1177</pub-id><?supplied-pmid 25428374?><pub-id pub-id-type="pmid">25428374</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Booker</surname><given-names>BM</given-names></name>, <name><surname>Friedrich</surname><given-names>T</given-names></name>, <name><surname>Mason</surname><given-names>MK</given-names></name>, <name><surname>VanderMeer</surname><given-names>JE</given-names></name>, <name><surname>Zhao</surname><given-names>J</given-names></name>, <name><surname>Eckalbar</surname><given-names>WL</given-names></name>, <etal>et al</etal>. <article-title>Bat accelerated regions identify a bat forelimb specific enhancer in the HoxD locus</article-title>. <source>PLoS Genetics</source>. <year>2016</year>;<volume>12</volume>(<issue>3</issue>):<fpage>e1005738</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pgen.1005738</pub-id><?supplied-pmid 27019019?><pub-id pub-id-type="pmid">27019019</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Hu</surname><given-names>Z</given-names></name>, <name><surname>Sackton</surname><given-names>TB</given-names></name>, <name><surname>Edwards</surname><given-names>SV</given-names></name>, <name><surname>Liu</surname><given-names>JS</given-names></name>. <article-title>Bayesian detection of convergent rate changes of conserved noncoding elements on phylogenetic trees</article-title>. <source>Molecular Biology and Evolution</source>. <year>2019</year>;<volume>36</volume>(<issue>5</issue>):<fpage>1086</fpage>–<lpage>1100</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msz049</pub-id><?supplied-pmid 30851112?><pub-id pub-id-type="pmid">30851112</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Lartillot</surname><given-names>N</given-names></name>, <name><surname>Poujol</surname><given-names>R</given-names></name>. <article-title>A phylogenetic model for investigating correlated evolution of substitution rates and continuous phenotypic characters</article-title>. <source>Molecular Biology and Evolution</source>. <year>2011</year>;<volume>28</volume>(<issue>1</issue>):<fpage>729</fpage>–<lpage>744</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msq244</pub-id><?supplied-pmid 20926596?><pub-id pub-id-type="pmid">20926596</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Yusuf</surname><given-names>L</given-names></name>, <name><surname>Heatley</surname><given-names>MC</given-names></name>, <name><surname>Palmer</surname><given-names>JP</given-names></name>, <name><surname>Barton</surname><given-names>HJ</given-names></name>, <name><surname>Cooney</surname><given-names>CR</given-names></name>, <name><surname>Gossmann</surname><given-names>TI</given-names></name>. <article-title>Noncoding regions underpin avian bill shape diversification at macroevolutionary scales</article-title>. <source>Genome Research</source>. <year>2020</year>;<volume>30</volume>(<issue>4</issue>):<fpage>553</fpage>–<lpage>565</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1101/gr.255752.119</pub-id><?supplied-pmid 32269134?><pub-id pub-id-type="pmid">32269134</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Kowalczyk</surname><given-names>A</given-names></name>, <name><surname>Partha</surname><given-names>R</given-names></name>, <name><surname>Clark</surname><given-names>NL</given-names></name>, <name><surname>Chikina</surname><given-names>M</given-names></name>. <article-title>Pan-mammalian analysis of molecular constraints underlying extended lifespan</article-title>. <source>Elife</source>. <year>2020</year>;<volume>9</volume>:<fpage>e51089</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.7554/eLife.51089</pub-id><?supplied-pmid 32043462?><pub-id pub-id-type="pmid">32043462</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Pollard</surname><given-names>KS</given-names></name>, <name><surname>Hubisz</surname><given-names>MJ</given-names></name>, <name><surname>Rosenbloom</surname><given-names>KR</given-names></name>, <name><surname>Siepel</surname><given-names>A</given-names></name>. <article-title>Detection of nonneutral substitution rates on mammalian phylogenies</article-title>. <source>Genome Research</source>. <year>2010</year>;<volume>20</volume>(<issue>1</issue>):<fpage>110</fpage>–<lpage>121</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1101/gr.097857.109</pub-id><?supplied-pmid 19858363?><pub-id pub-id-type="pmid">19858363</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref017">
      <label>17</label>
      <mixed-citation publication-type="book"><name><surname>Cox</surname><given-names>DR</given-names></name>, <name><surname>Miller</surname><given-names>HD</given-names></name>. <source>The theory of stochastic processes</source>. vol. <volume>134</volume>. <publisher-name>CRC press</publisher-name>; <year>1977</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>JS</given-names></name>. <article-title>The collapsed Gibbs sampler in Bayesian computations with applications to a gene regulation problem</article-title>. <source>Journal of the American Statistical Association</source>. <year>1994</year>;<volume>89</volume>(<issue>427</issue>):<fpage>958</fpage>–<lpage>966</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1080/01621459.1994.10476829</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref019">
      <label>19</label>
      <mixed-citation publication-type="book"><name><surname>Liu</surname><given-names>J</given-names></name>. <source>Monte Carlo strategies in scientific computing</source>. <publisher-loc>New York</publisher-loc>: <publisher-name>Springer-Verlag</publisher-name>; <year>2001</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Felsenstein</surname><given-names>J</given-names></name>. <article-title>Evolutionary trees from DNA sequences: a maximum likelihood approach</article-title>. <source>Journal of Molecular Evolution</source>. <year>1981</year>;<volume>17</volume>:<fpage>368</fpage>–<lpage>376</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/BF01734359</pub-id><?supplied-pmid 7288891?><pub-id pub-id-type="pmid">7288891</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Kass</surname><given-names>RE</given-names></name>, <name><surname>Raftery</surname><given-names>AE</given-names></name>. <article-title>Bayes factors</article-title>. <source>Journal of the American Statistical Association</source>. <year>1995</year>;<volume>90</volume>(<issue>430</issue>):<fpage>773</fpage>–<lpage>795</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1080/01621459.1995.10476572</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Wagenmakers</surname><given-names>EJ</given-names></name>, <name><surname>Lodewyckx</surname><given-names>T</given-names></name>, <name><surname>Kuriyal</surname><given-names>H</given-names></name>, <name><surname>Grasman</surname><given-names>R</given-names></name>. <article-title>Bayesian hypothesis testing for psychologists: A tutorial on the Savage–Dickey method</article-title>. <source>Cognitive Psychology</source>. <year>2010</year>;<volume>60</volume>(<issue>3</issue>):<fpage>158</fpage>–<lpage>189</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cogpsych.2009.12.001</pub-id><?supplied-pmid 20064637?><pub-id pub-id-type="pmid">20064637</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Blanchette</surname><given-names>M</given-names></name>, <name><surname>Kent</surname><given-names>WJ</given-names></name>, <name><surname>Riemer</surname><given-names>C</given-names></name>, <name><surname>Elnitski</surname><given-names>L</given-names></name>, <name><surname>Smit</surname><given-names>AF</given-names></name>, <name><surname>Roskin</surname><given-names>KM</given-names></name>, <etal>et al</etal>. <article-title>Aligning multiple genomic sequences with the threaded blockset aligner</article-title>. <source>Genome Research</source>. <year>2004</year>;<volume>14</volume>(<issue>4</issue>):<fpage>708</fpage>–<lpage>715</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1101/gr.1933104</pub-id><?supplied-pmid 15060014?><pub-id pub-id-type="pmid">15060014</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Murphy</surname><given-names>WJ</given-names></name>, <name><surname>Pevzner</surname><given-names>PA</given-names></name>, <name><surname>O’Brien</surname><given-names>SJ</given-names></name>. <article-title>Mammalian phylogenomics comes of age</article-title>. <source>Trends in Genetics</source>. <year>2004</year>;<volume>20</volume>(<issue>12</issue>):<fpage>631</fpage>–<lpage>639</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.tig.2004.09.005</pub-id><?supplied-pmid 15522459?><pub-id pub-id-type="pmid">15522459</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref025">
      <label>25</label>
      <mixed-citation publication-type="other">R Core Team. R: A Language and Environment for Statistical Computing; 2021. Available from: <ext-link xlink:href="https://www.R-project.org/" ext-link-type="uri">https://www.R-project.org/</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Eddelbuettel</surname><given-names>D</given-names></name>, <name><surname>François</surname><given-names>R</given-names></name>. <article-title>Rcpp: Seamless R and C++ integration</article-title>. <source>Journal of Statistical Software</source>. <year>2011</year>;<volume>40</volume>:<fpage>1</fpage>–<lpage>18</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.18637/jss.v040.i08</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Eddelbuettel</surname><given-names>D</given-names></name>, <name><surname>Sanderson</surname><given-names>C</given-names></name>. <article-title>RcppArmadillo: Accelerating R with high-performance C++ linear algebra</article-title>. <source>Computational Statistics &amp; Data Analysis</source>. <year>2014</year>;<volume>71</volume>:<fpage>1054</fpage>–<lpage>1063</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.csda.2013.02.005</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Paradis</surname><given-names>E</given-names></name>, <name><surname>Claude</surname><given-names>J</given-names></name>, <name><surname>Strimmer</surname><given-names>K</given-names></name>. <article-title>APE: analyses of phylogenetics and evolution in R language</article-title>. <source>Bioinformatics</source>. <year>2004</year>;<volume>20</volume>(<issue>2</issue>):<fpage>289</fpage>–<lpage>290</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btg412</pub-id><?supplied-pmid 14734327?><pub-id pub-id-type="pmid">14734327</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Gelman</surname><given-names>A</given-names></name>, <name><surname>Rubin</surname><given-names>DB</given-names></name>. <article-title>Inference from iterative simulation using multiple sequences</article-title>. <source>Statistical Science</source>. <year>1992</year>;<volume>7</volume>(<issue>4</issue>):<fpage>457</fpage>–<lpage>472</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1214/ss/1177011136</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>McLean</surname><given-names>CY</given-names></name>, <name><surname>Bristor</surname><given-names>D</given-names></name>, <name><surname>Hiller</surname><given-names>M</given-names></name>, <name><surname>Clarke</surname><given-names>SL</given-names></name>, <name><surname>Schaar</surname><given-names>BT</given-names></name>, <name><surname>Lowe</surname><given-names>CB</given-names></name>, <etal>et al</etal>. <article-title>GREAT improves functional interpretation of cis-regulatory regions</article-title>. <source>Nature Biotechnology</source>. <year>2010</year>;<volume>28</volume>(<issue>5</issue>):<fpage>495</fpage>–<lpage>501</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nbt.1630</pub-id><?supplied-pmid 20436461?><pub-id pub-id-type="pmid">20436461</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Flicek</surname><given-names>P</given-names></name>, <name><surname>Amode</surname><given-names>MR</given-names></name>, <name><surname>Barrell</surname><given-names>D</given-names></name>, <name><surname>Beal</surname><given-names>K</given-names></name>, <name><surname>Brent</surname><given-names>S</given-names></name>, <name><surname>Carvalho-Silva</surname><given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Ensembl 2012</article-title>. <source>Nucleic Acids Research</source>. <year>2012</year>;<volume>40</volume>(<issue>D1</issue>):<fpage>D84</fpage>–<lpage>D90</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkr991</pub-id><?supplied-pmid 22086963?><pub-id pub-id-type="pmid">22086963</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Stelzer</surname><given-names>G</given-names></name>, <name><surname>Rosen</surname><given-names>N</given-names></name>, <name><surname>Plaschkes</surname><given-names>I</given-names></name>, <name><surname>Zimmerman</surname><given-names>S</given-names></name>, <name><surname>Twik</surname><given-names>M</given-names></name>, <name><surname>Fishilevich</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>The GeneCards suite: from gene data mining to disease genome sequence analyses</article-title>. <source>Current Protocols in Bioinformatics</source>. <year>2016</year>;<volume>54</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>30</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1002/cpbi.5</pub-id><?supplied-pmid 27322403?><pub-id pub-id-type="pmid">27322403</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Sollis</surname><given-names>E</given-names></name>, <name><surname>Mosaku</surname><given-names>A</given-names></name>, <name><surname>Abid</surname><given-names>A</given-names></name>, <name><surname>Buniello</surname><given-names>A</given-names></name>, <name><surname>Cerezo</surname><given-names>M</given-names></name>, <name><surname>Gil</surname><given-names>L</given-names></name>, <etal>et al</etal>. <article-title>The NHGRI-EBI GWAS Catalog: knowledgebase and deposition resource</article-title>. <source>Nucleic Acids Research</source>. <year>2023</year>;<volume>51</volume>(<issue>D1</issue>):<fpage>D977</fpage>–<lpage>D985</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkac1010</pub-id><?supplied-pmid 36350656?><pub-id pub-id-type="pmid">36350656</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Thorne</surname><given-names>JL</given-names></name>, <name><surname>Kishino</surname><given-names>H</given-names></name>, <name><surname>Painter</surname><given-names>IS</given-names></name>. <article-title>Estimating the rate of evolution of the rate of molecular evolution</article-title>. <source>Molecular Biology and Evolution</source>. <year>1998</year>;<volume>15</volume>(<issue>12</issue>):<fpage>1647</fpage>–<lpage>1657</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/oxfordjournals.molbev.a025892</pub-id><?supplied-pmid 9866200?><pub-id pub-id-type="pmid">9866200</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Drummond</surname><given-names>AJ</given-names></name>, <name><surname>Ho</surname><given-names>SYW</given-names></name>, <name><surname>Phillips</surname><given-names>MJ</given-names></name>, <name><surname>Rambaut</surname><given-names>A</given-names></name>. <article-title>Relaxed phylogenetics and dating with confidence</article-title>. <source>PLoS Biology</source>. <year>2006</year>;<volume>4</volume>(<issue>5</issue>):<fpage>e88</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pbio.0040088</pub-id><?supplied-pmid 16683862?><pub-id pub-id-type="pmid">16683862</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Drummond</surname><given-names>AJ</given-names></name>, <name><surname>Suchard</surname><given-names>MA</given-names></name>. <article-title>Bayesian random local clocks, or one rate to rule them all</article-title>. <source>BMC Biology</source>. <year>2010</year>;<volume>8</volume>(<issue>114</issue>):<fpage>1</fpage>–<lpage>12</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1741-7007-8-114</pub-id><?supplied-pmid 20807414?><pub-id pub-id-type="pmid">20051105</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Dorman</surname><given-names>JB</given-names></name>, <name><surname>Albinder</surname><given-names>B</given-names></name>, <name><surname>Shroyer</surname><given-names>T</given-names></name>, <name><surname>Kenyon</surname><given-names>C</given-names></name>. <article-title>The age-1 and daf-2 genes function in a common pathway to control the lifespan of Caenorhabditis elegans</article-title>. <source>Genetics</source>. <year>1995</year>;<volume>141</volume>(<issue>4</issue>):<fpage>1399</fpage>–<lpage>1406</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/genetics/141.4.1399</pub-id><?supplied-pmid 8601482?><pub-id pub-id-type="pmid">8601482</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Deelen</surname><given-names>J</given-names></name>, <name><surname>Evans</surname><given-names>DS</given-names></name>, <name><surname>Arking</surname><given-names>DE</given-names></name>, <name><surname>Tesi</surname><given-names>N</given-names></name>, <name><surname>Nygaard</surname><given-names>M</given-names></name>, <name><surname>Liu</surname><given-names>X</given-names></name>, <etal>et al</etal>. <article-title>A meta-analysis of genome-wide association studies identifies multiple longevity genes</article-title>. <source>Nature Communications</source>. <year>2019</year>;<volume>10</volume>(<issue>1</issue>):<fpage>3669</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41467-019-11558-2</pub-id><?supplied-pmid 31413261?><pub-id pub-id-type="pmid">31413261</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Maklakov</surname><given-names>AA</given-names></name>, <name><surname>Immler</surname><given-names>S</given-names></name>. <article-title>The expensive germline and the evolution of ageing</article-title>. <source>Current Biology</source>. <year>2016</year>;<volume>26</volume>(<issue>13</issue>):<fpage>R577</fpage>–<lpage>R586</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cub.2016.04.012</pub-id><?supplied-pmid 27404253?><pub-id pub-id-type="pmid">27404253</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Muntané</surname><given-names>G</given-names></name>, <name><surname>Farré</surname><given-names>X</given-names></name>, <name><surname>Rodríguez</surname><given-names>JA</given-names></name>, <name><surname>Pegueroles</surname><given-names>C</given-names></name>, <name><surname>Hughes</surname><given-names>DA</given-names></name>, <name><surname>de Magalhaes</surname><given-names>JP</given-names></name>, <etal>et al</etal>. <article-title>Biological processes modulating longevity across primates: a phylogenetic genome-phenome analysis</article-title>. <source>Molecular Biology and Evolution</source>. <year>2018</year>;<volume>35</volume>(<issue>8</issue>):<fpage>1990</fpage>–<lpage>2004</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msy105</pub-id><?supplied-pmid 29788292?><pub-id pub-id-type="pmid">29788292</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Tollis</surname><given-names>M</given-names></name>, <name><surname>Boddy</surname><given-names>AM</given-names></name>, <name><surname>Maley</surname><given-names>CC</given-names></name>. <article-title>Peto’s Paradox: how has evolution solved the problem of cancer prevention?</article-title><source>BMC Biology</source>. <year>2017</year>;<volume>15</volume>(<issue>60</issue>):<fpage>1</fpage>–<lpage>5</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s12915-017-0401-7</pub-id><?supplied-pmid 28705195?><pub-id pub-id-type="pmid">28100223</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Tejada-Martinez</surname><given-names>D</given-names></name>, <name><surname>Avelar</surname><given-names>RA</given-names></name>, <name><surname>Lopes</surname><given-names>I</given-names></name>, <name><surname>Zhang</surname><given-names>B</given-names></name>, <name><surname>Novoa</surname><given-names>G</given-names></name>, <name><surname>De Magalhães</surname><given-names>JP</given-names></name>, <etal>et al</etal>. <article-title>Positive selection and enhancer evolution shaped lifespan and body mass in great apes</article-title>. <source>Molecular Biology and Evolution</source>. <year>2022</year>;<volume>39</volume>(<issue>2</issue>):<fpage>msab369</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msab369</pub-id><?supplied-pmid 34971383?><pub-id pub-id-type="pmid">34971383</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Treaster</surname><given-names>S</given-names></name>, <name><surname>Deelen</surname><given-names>J</given-names></name>, <name><surname>Daane</surname><given-names>JM</given-names></name>, <name><surname>Murabito</surname><given-names>J</given-names></name>, <name><surname>Karasik</surname><given-names>D</given-names></name>, <name><surname>Harris</surname><given-names>MP</given-names></name>. <article-title>Convergent genomics of longevity in rockfishes highlights the genetics of human life span variation</article-title>. <source>Science Advances</source>. <year>2023</year>;<volume>9</volume>(<issue>2</issue>):<fpage>eadd2743</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1126/sciadv.add2743</pub-id><?supplied-pmid 36630509?><pub-id pub-id-type="pmid">36630509</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Kolora</surname><given-names>SRR</given-names></name>, <name><surname>Owens</surname><given-names>GL</given-names></name>, <name><surname>Vazquez</surname><given-names>JM</given-names></name>, <name><surname>Stubbs</surname><given-names>A</given-names></name>, <name><surname>Chatla</surname><given-names>K</given-names></name>, <name><surname>Jainese</surname><given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Origins and evolution of extreme life span in Pacific Ocean rockfishes</article-title>. <source>Science</source>. <year>2021</year>;<volume>374</volume>(<issue>6569</issue>):<fpage>842</fpage>–<lpage>847</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1126/science.abg5332</pub-id><?supplied-pmid 34762458?><pub-id pub-id-type="pmid">34762458</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref045">
      <label>45</label>
      <mixed-citation publication-type="journal"><name><surname>Kirschner</surname><given-names>M</given-names></name>, <name><surname>Gerhart</surname><given-names>J</given-names></name>. <article-title>Evolvability</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>1998</year>;<volume>95</volume>(<issue>15</issue>):<fpage>8420</fpage>–<lpage>8427</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.95.15.8420</pub-id><?supplied-pmid 9671692?><pub-id pub-id-type="pmid">9671692</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref046">
      <label>46</label>
      <mixed-citation publication-type="book"><name><surname>Kirschner</surname><given-names>MW</given-names></name>, <name><surname>Gerhart</surname><given-names>JC</given-names></name>. <source>The plausibility of life: Resolving Darwin’s dilemma</source>. <publisher-name>Yale University Press</publisher-name>; <year>2005</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref047">
      <label>47</label>
      <mixed-citation publication-type="other">NIH National Cancer Institute. Angiogenesis Inhibitors; 2018. <ext-link xlink:href="https://www.cancer.gov/about-cancer/treatment/types/immunotherapy/angiogenesis-inhibitors-fact-sheet" ext-link-type="uri">https://www.cancer.gov/about-cancer/treatment/types/immunotherapy/angiogenesis-inhibitors-fact-sheet</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref048">
      <label>48</label>
      <mixed-citation publication-type="journal"><name><surname>Zhu</surname><given-names>P</given-names></name>, <name><surname>Liu</surname><given-names>W</given-names></name>, <name><surname>Zhang</surname><given-names>X</given-names></name>, <name><surname>Li</surname><given-names>M</given-names></name>, <name><surname>Liu</surname><given-names>G</given-names></name>, <name><surname>Yu</surname><given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>Correlated evolution of social organization and lifespan in mammals</article-title>. <source>Nature Communications</source>. <year>2023</year>;<volume>14</volume>(<issue>1</issue>):<fpage>372</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41467-023-35869-7</pub-id><?supplied-pmid 36720880?><pub-id pub-id-type="pmid">36720880</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref049">
      <label>49</label>
      <mixed-citation publication-type="journal"><name><surname>Fisher</surname><given-names>AA</given-names></name>, <name><surname>Ji</surname><given-names>X</given-names></name>, <name><surname>Nishimura</surname><given-names>A</given-names></name>, <name><surname>Lemey</surname><given-names>P</given-names></name>, <name><surname>Baele</surname><given-names>G</given-names></name>, <name><surname>Suchard</surname><given-names>MA</given-names></name>. <article-title>Shrinkage-based random local clocks with scalable inference</article-title>. <source>Molecular Biology and Evolution</source>. <year>2023</year>;<volume>40</volume>(<issue>11</issue>). <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msad242</pub-id><?supplied-pmid 37950885?><pub-id pub-id-type="pmid">37950885</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref050">
      <label>50</label>
      <mixed-citation publication-type="journal"><name><surname>Uyeda</surname><given-names>JC</given-names></name>, <name><surname>Harmon</surname><given-names>LJ</given-names></name>. <article-title>A novel Bayesian method for inferring and interpreting the dynamics of adaptive landscapes from phylogenetic comparative data</article-title>. <source>Systematic Biology</source>. <year>2014</year>;<volume>63</volume>(<issue>6</issue>):<fpage>902</fpage>–<lpage>918</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/sysbio/syu057</pub-id><?supplied-pmid 25077513?><pub-id pub-id-type="pmid">25077513</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLOS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">11078400</article-id>
    <article-id pub-id-type="pmid">38656999</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-23-01890</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1011995</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Evolutionary Biology</subject>
          <subj-group>
            <subject>Evolutionary Processes</subject>
            <subj-group>
              <subject>Evolutionary Rate</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleotides</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genetic Loci</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Evolutionary Biology</subject>
          <subj-group>
            <subject>Evolutionary Systematics</subject>
            <subj-group>
              <subject>Phylogenetics</subject>
              <subj-group>
                <subject>Animal Phylogenetics</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Taxonomy</subject>
          <subj-group>
            <subject>Evolutionary Systematics</subject>
            <subj-group>
              <subject>Phylogenetics</subject>
              <subj-group>
                <subject>Animal Phylogenetics</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Taxonomy</subject>
            <subj-group>
              <subject>Evolutionary Systematics</subject>
              <subj-group>
                <subject>Phylogenetics</subject>
                <subj-group>
                  <subject>Animal Phylogenetics</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Zoology</subject>
          <subj-group>
            <subject>Animal Phylogenetics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Evolutionary Biology</subject>
          <subj-group>
            <subject>Molecular Evolution</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Evolutionary Biology</subject>
          <subj-group>
            <subject>Evolutionary Genetics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Evolutionary Biology</subject>
          <subj-group>
            <subject>Evolutionary Systematics</subject>
            <subj-group>
              <subject>Phylogenetics</subject>
              <subj-group>
                <subject>Phylogenetic Analysis</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Taxonomy</subject>
          <subj-group>
            <subject>Evolutionary Systematics</subject>
            <subj-group>
              <subject>Phylogenetics</subject>
              <subj-group>
                <subject>Phylogenetic Analysis</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Management</subject>
          <subj-group>
            <subject>Taxonomy</subject>
            <subj-group>
              <subject>Evolutionary Systematics</subject>
              <subj-group>
                <subject>Phylogenetics</subject>
                <subj-group>
                  <subject>Phylogenetic Analysis</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Conservation Biology</subject>
          <subj-group>
            <subject>Conservation Genetics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Ecology and Environmental Sciences</subject>
        <subj-group>
          <subject>Conservation Science</subject>
          <subj-group>
            <subject>Conservation Biology</subject>
            <subj-group>
              <subject>Conservation Genetics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Conservation Genetics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>A phylogenetic method linking nucleotide substitution rates to rates of continuous trait evolution</article-title>
      <alt-title alt-title-type="running-head">Phylogenetic modelling of DNA substitution rates and continuous trait evolution</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Gemmell</surname>
          <given-names>Patrick</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-1673-9216</contrib-id>
        <name>
          <surname>Sackton</surname>
          <given-names>Timothy B.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/resources/">Resources</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Edwards</surname>
          <given-names>Scott V.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/resources/">Resources</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-4450-7239</contrib-id>
        <name>
          <surname>Liu</surname>
          <given-names>Jun S.</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role>
        <role content-type="http://credit.niso.org/contributor-roles/resources/">Resources</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Department of Organismic and Evolutionary Biology, Harvard University, Cambridge, Massachusetts, United States of America</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Department of Statistics, Harvard University, Cambridge, Massachusetts, United States of America</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>FAS Informatics Group, Harvard University, Cambridge, Massachusetts, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Rzhetsky</surname>
          <given-names>Andrey</given-names>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of Chicago, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>jliu@stat.harvard.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>24</day>
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <volume>20</volume>
    <issue>4</issue>
    <elocation-id>e1011995</elocation-id>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>3</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2024 Gemmell et al</copyright-statement>
      <copyright-year>2024</copyright-year>
      <copyright-holder>Gemmell et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1011995.pdf"/>
    <abstract>
      <p>Genomes contain conserved non-coding sequences that perform important biological functions, such as gene regulation. We present a phylogenetic method, PhyloAcc-C, that associates nucleotide substitution rates with changes in a continuous trait of interest. The method takes as input a multiple sequence alignment of conserved elements, continuous trait data observed in extant species, and a background phylogeny and substitution process. Gibbs sampling is used to assign rate categories (background, conserved, accelerated) to lineages and explore whether the assigned rate categories are associated with increases or decreases in the rate of trait evolution. We test our method using simulations and then illustrate its application using mammalian body size and lifespan data previously analyzed with respect to protein coding genes. Like other studies, we find processes such as tumor suppression, telomere maintenance, and p53 regulation to be related to changes in longevity and body size. In addition, we also find that skeletal genes, and developmental processes, such as sprouting angiogenesis, are relevant.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>Biologists hope to use data from diverse species to identify the genetic basis of continuous traits such as lifespan or beak shape. To do so, they need methodologies that relate genotypic and phenotypic evolution, while taking account of the relationship between species. The practice of integrating data from many species in this systematic way is relatively new, and existing approaches to the problem are often ad hoc, focus on protein coding genes, or involve discretizing continuous measurements. We avoid these limitations and develop a statistical model and software package that can be used to rapidly analyze alignments with respect to a continuous trait. Our method is illustrated by describing 136,859 conserved non-coding elements from 61 mammalian species with respect to the trait ‘long-lived and large-bodied’. We report on the loci highlighted by our model and describe how our results compare to recent studies taking other methodological approaches. We suggest approaches like ours are an important step towards realizing the potential of data collected from across the animal kingdom, whether the aim is to increase our understanding of natural history or to better understand human biology.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000051</institution-id>
            <institution>National Human Genome Research Institute</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01HG011485</award-id>
        <principal-award-recipient>
          <name>
            <surname>Edwards</surname>
            <given-names>Scott V.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000057</institution-id>
            <institution>National Institute of General Medical Sciences</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01GM152814</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-4450-7239</contrib-id>
          <name>
            <surname>Liu</surname>
            <given-names>Jun S.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This work was supported in part by NIH grant #R01HG011485 from the National Human Genome Research Institute (to TBS, SVE and JSL) and #R01GM152814 from the National Institute of General Medicine (to JSL). PG’s salary was paid from the first grant. We acknowledge support for covering the costs of publishing this article from the Wetmore Colles Fund of the Museum of Comparative Zoology at Harvard. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="3"/>
      <table-count count="2"/>
      <page-count count="18"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2024-05-08</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All data and codes will be freely available to academic researchers upon acceptance of the paper.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All data and codes will be freely available to academic researchers upon acceptance of the paper.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>In recent years there have been numerous advances in mapping genes underlying phenotypic traits. Many of these advances have built on the successes and refinements of traditional genetic mapping methods yet, as is articulated by Smith et al. [<xref rid="pcbi.1011995.ref001" ref-type="bibr">1</xref>], such approaches are often limited to the small number of model organisms amenable to crosses or other genetic manipulations. Recently, alternative phylogenetic approaches driven by comparative genomics have emerged as a useful tool for mapping genes in species not amenable to traditional approaches. Several methodologies have been proposed to associate evolution of genes or genomic regions with changes in phenotypic traits including those of [<xref rid="pcbi.1011995.ref002" ref-type="bibr">2</xref>–<xref rid="pcbi.1011995.ref007" ref-type="bibr">7</xref>]. These studies use a variety of genomic signatures as evidence of association with phenotypic evolution, including increases in evolutionary rate, loss of function such as pseudogenization, or wholesale deletion of genes or non-coding regions from the genome. Comparative approaches of this kind (hereafter ‘PhyloG2P’) have proved to be surprisingly powerful at identifying associations between genomic and phenotypic variation in the context of convergent evolution of the phenotypic trait.</p>
    <p>With the PhyloG2P research programme in mind, this paper aims to make three contributions. First, we highlight the idea of relating phenotypic and genotypic evolution by linking substitution rate multipliers (for nucleotide changes) to variance multipliers (for changes in a continuous trait). Second, we introduce a specific piece of software, PhyloAcc-C, that applies this approach in the context of conserved non-coding elements (CNEs). Third, we illustrate the PhyloAcc-C software using real data, running it with a set of mammalian CNEs and a lifespan related trait as input, thereby providing an opportunity to discuss its output in the context of other recent PhyloG2P-style studies.</p>
    <p>The overarching biological motivation for our study is our interest in evolutionary innovation, and here we are particularly concerned with methods attempting to answer the question ‘which CNEs are related to changes in a continuous trait I care about?’ This is an important question because it has been recognized for decades that there are many highly conserved stretches of non-coding DNA that participate in gene regulation across diverse species [<xref rid="pcbi.1011995.ref008" ref-type="bibr">8</xref>]. Indeed, such sequences are routinely annotated [<xref rid="pcbi.1011995.ref009" ref-type="bibr">9</xref>] in the UCSC Genome Browser [<xref rid="pcbi.1011995.ref010" ref-type="bibr">10</xref>] and may then be related to the evolution of phenotypic traits. To give one example, Booker et al. [<xref rid="pcbi.1011995.ref011" ref-type="bibr">11</xref>] identified conserved sequences that were accelerated specifically in bats, and showed that a subset acted as limb enhancers in transgenic mice. Their conclusion was that some identified enhancers were potentially instrumental to the evolution of bat wings. This conclusion was reached without modelling the co-variation of the rate of enhancer evolution and key measurements from bat wings. However, it is possible that incorporating measurements such as limb length could highlight additional relevant loci that had experienced more subtle evolutionary trajectories than bat specific acceleration.</p>
    <p>More generally, as reviewed by Smith et al. [<xref rid="pcbi.1011995.ref001" ref-type="bibr">1</xref>], there is widespread interest in relating phenotypic and molecular evolution. This interest is evidenced by the substantial effort put into producing a variety of software packages and studies that quantify the relationship between traits and substitution rates. Examples include Forward Genomics [<xref rid="pcbi.1011995.ref004" ref-type="bibr">4</xref>] and reverse genomics [<xref rid="pcbi.1011995.ref003" ref-type="bibr">3</xref>], both of which relate sequence similarity (via correlation, generalized least-squares, or heuristics) to traits (with ancestral values inferred using parsimony algorithms). A methodology with a similar goal is that of Treaster et al. [<xref rid="pcbi.1011995.ref007" ref-type="bibr">7</xref>], which uses tree topology to model the intuitive notion that comparisons between more closely related species should be less confounded by genetic background than comparisons between more distantly related ones. A recent contribution to this diverse collection of approaches is PhyloAcc [<xref rid="pcbi.1011995.ref012" ref-type="bibr">12</xref>], a Bayesian phylogenetic approach centred on latent conservation states, which is modified here in this paper. A key feature of the above four approaches is that they deal with discrete traits, and in the case of PhyloAcc, do not explicitly model the trait, instead relying on a priori reconstruction, often under the assumption of convergent gain or loss of a character state.</p>
    <p>Methods for studying the relationship between continuous traits and molecular evolution are fewer. Coevol [<xref rid="pcbi.1011995.ref013" ref-type="bibr">13</xref>] models the co-evolution of continuous traits and rates using a multivariate diffusion process, and does not require user supplied branch lengths, although calibrations can be supplied if desired. One imagines that constraining branching times will sometimes be helpful, especially when the sequences being considered are short and highly conserved, and therefore contain few distinguishing differences, as is the case with mammalian CNEs. Two more empirically focused recent studies are that of Yusuf et al. [<xref rid="pcbi.1011995.ref014" ref-type="bibr">14</xref>], who study the co-evolution of bill shape and both protein coding and non-coding DNA, and that of Kowalczyk et al. [<xref rid="pcbi.1011995.ref015" ref-type="bibr">15</xref>], who study the lifespan and body size of mammals. The former study used k-means binning to group branches of a tree based on the rate of trait evolution, and then used a likelihood ratio test to compare nucleotide substitution rates under a global clock model versus a local clock model, with one rate per bin. The latter study used the RERConverge method [<xref rid="pcbi.1011995.ref006" ref-type="bibr">6</xref>], which correlates relative rates of protein evolution and ancestral state reconstructions of a continuous trait, each estimated separately using maximum likelihood.</p>
    <p>Here we describe the PhyloAcc-C model, which connects the evolution of continuous traits and non-coding DNA using a statistically integrated approach. We then illustrate the use of our model by applying it to a mammalian trait previously analyzed using RERConverge, but this time considering CNEs rather than protein coding genes, thereby providing analyses that complement the existing literature.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Methods</title>
    <p>The PhyloAcc-C method follows the general Bayesian approach taken by Hu et al. [<xref rid="pcbi.1011995.ref012" ref-type="bibr">12</xref>] and modifies it so as to model continuous phenotypic change. In this section, we describe the method in enough detail that it may be recreated, and so that one may understand or modify our open source R/C++ implementation.</p>
    <sec id="sec003">
      <title>Input</title>
      <p>The method relies on four inputs: (1) a rooted phylogeny <bold>T</bold> having <italic toggle="yes">L</italic> leaves, <italic toggle="yes">N</italic> = 2<italic toggle="yes">L</italic> − 1 nodes, and <italic toggle="yes">E</italic> = <italic toggle="yes">N</italic> − 1 edges, and that encapsulates the relationships between species from which trait data is drawn; (2) a multiple sequence alignment of homologous CNE sequences from <italic toggle="yes">L</italic> species (rows) at <italic toggle="yes">S</italic> sites (columns) and which makes up the top <italic toggle="yes">L</italic> rows of matrix <bold>X</bold><sub><italic toggle="yes">N</italic>×<italic toggle="yes">S</italic></sub>, which will also model ancestral nucleotides; (3) a vector of continuous trait measurements observed in the corresponding <italic toggle="yes">L</italic> species and which makes up the first <italic toggle="yes">L</italic> elements of vector <bold>y</bold> = (<italic toggle="yes">y</italic><sub>1</sub>, …, <italic toggle="yes">y</italic><sub><italic toggle="yes">N</italic></sub>), which will also model ancestral trait values; (4) a rate matrix <bold>Q</bold><sub>4×4</sub> and stationary distribution <bold>π</bold> that models the background nucleotide substitution process at putatively neutral sites. The alignment may contain gaps which will be treated as missing data. Both the alignment and the nucleotide substitution parameters can be obtained using standard methods as detailed by Hu et al. [<xref rid="pcbi.1011995.ref012" ref-type="bibr">12</xref>]. In particular, the rate matrix <bold>Q</bold> is often estimated using methods like PhyloP [<xref rid="pcbi.1011995.ref016" ref-type="bibr">16</xref>] from an alignment of putatively neutral and easily alignable sites, such as fourfold degenerate sites of protein coding loci.</p>
    </sec>
    <sec id="sec004">
      <title>Model</title>
      <p>Each branch is assigned a conservation state <italic toggle="yes">z</italic><sub><italic toggle="yes">i</italic></sub> that takes on three values: background (<italic toggle="yes">z</italic><sub><italic toggle="yes">i</italic></sub> = 1), conserved (<italic toggle="yes">z</italic><sub><italic toggle="yes">i</italic></sub> = 2), or accelerated (<italic toggle="yes">z</italic><sub><italic toggle="yes">i</italic></sub> = 3). This categorization of branches into three states follows that of Hu et al. [<xref rid="pcbi.1011995.ref012" ref-type="bibr">12</xref>], which in turn was based on the approach taken by Pollard et al. [<xref rid="pcbi.1011995.ref016" ref-type="bibr">16</xref>], who apply a conserved and an accelerated state to branches of a tree in the PhyloP software. Conservation states are not assigned freely but follow a Markov process (see e.g. textbook [<xref rid="pcbi.1011995.ref017" ref-type="bibr">17</xref>]) from root to tips so that the probability of a transition on a branch from parent <italic toggle="yes">i</italic> to child <italic toggle="yes">j</italic> is <inline-formula id="pcbi.1011995.e001"><alternatives><graphic xlink:href="pcbi.1011995.e001.jpg" id="pcbi.1011995.e001g" position="anchor"/><mml:math id="M1" display="inline" overflow="scroll"><mml:mrow><mml:mtext>Pr</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">Φ</mml:mi><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, the (<italic toggle="yes">z</italic><sub><italic toggle="yes">i</italic></sub>, <italic toggle="yes">z</italic><sub><italic toggle="yes">j</italic></sub>)th element of matrix
<disp-formula id="pcbi.1011995.e002"><alternatives><graphic xlink:href="pcbi.1011995.e002.jpg" id="pcbi.1011995.e002g" position="anchor"/><mml:math id="M2" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi><mml:mo>=</mml:mo><mml:mo>[</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mi>c</mml:mi></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mi>a</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mi>b</mml:mi></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula>
with (<italic toggle="yes">a</italic>, <italic toggle="yes">b</italic>, <italic toggle="yes">c</italic>) ∈ (0, 1)<sup>3</sup>.</p>
      <p>The structure of this matrix allows CNEs to become conserved and later accelerated. Because a transition from accelerated back to conserved is also possible (i.e., <italic toggle="yes">b</italic> &gt; 0), bursts of acceleration can occur on internal branches. In principle, other matrices can be used to either constrain or relax the transition between rate categories across the tree.</p>
      <p>The conservation state of a branch affects both the nucleotide substitution process and the rate at which a trait evolves. Conservation states modulate nucleotide substitution rates via substitution rate multipliers <bold>r</bold> = (<italic toggle="yes">r</italic><sub>1</sub> = 1, <italic toggle="yes">r</italic><sub>2</sub>, <italic toggle="yes">r</italic><sub>3</sub>) so that the probability of transition from nucleotide <italic toggle="yes">a</italic> to <italic toggle="yes">b</italic> on branch <italic toggle="yes">i</italic> of length <italic toggle="yes">t</italic><sub><italic toggle="yes">i</italic></sub> is <inline-formula id="pcbi.1011995.e003"><alternatives><graphic xlink:href="pcbi.1011995.e003.jpg" id="pcbi.1011995.e003g" position="anchor"/><mml:math id="M3" display="inline" overflow="scroll"><mml:mrow><mml:mtext mathvariant="normal">expm</mml:mtext><mml:mo stretchy="false">{</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>Q</mml:mi></mml:mstyle><mml:mo>⋅</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mo stretchy="false">}</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. Similarly, conservation states on branches modulate the magnitude of trait changes along branches via variance multipliers <bold>v</bold> = (<italic toggle="yes">σ</italic><sup>2</sup>, <italic toggle="yes">β</italic><sub>2</sub><italic toggle="yes">σ</italic><sup>2</sup>, <italic toggle="yes">β</italic><sub>3</sub><italic toggle="yes">σ</italic><sup>2</sup>). Under the model, traits evolve according to normally distributed displacements along the branches of <bold>T</bold> such that cumulative displacements are observed in <italic toggle="yes">y</italic><sub>1</sub>, …, <italic toggle="yes">y</italic><sub><italic toggle="yes">L</italic></sub>. Displacements have mean 0 and a variance that is proportional to both the branch length <italic toggle="yes">t</italic><sub><italic toggle="yes">j</italic></sub> and the appropriate variance multiplier so that <inline-formula id="pcbi.1011995.e004"><alternatives><graphic xlink:href="pcbi.1011995.e004.jpg" id="pcbi.1011995.e004g" position="anchor"/><mml:math id="M4" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mspace width="0.222em"/><mml:mo stretchy="false">|</mml:mo><mml:mspace width="0.222em"/><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mtext mathvariant="normal">Normal</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>v</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and
<disp-formula id="pcbi.1011995.e005"><alternatives><graphic xlink:href="pcbi.1011995.e005.jpg" id="pcbi.1011995.e005g" position="anchor"/><mml:math id="M5" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="4pt"/><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">i</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="normal">e</mml:mi><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mspace width="2pt"/><mml:mtext>background</mml:mtext><mml:mo>;</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="4pt"/><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">i</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="normal">e</mml:mi><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mspace width="2pt"/><mml:mtext>conserved</mml:mtext><mml:mo>;</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="4pt"/><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">i</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="normal">e</mml:mi><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mspace width="2pt"/><mml:mtext>accelerated</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula></p>
    </sec>
    <sec id="sec005">
      <title>Joint distribution</title>
      <p>Letting <italic toggle="yes">pa</italic>(<italic toggle="yes">i</italic>) denote the parent of node <italic toggle="yes">i</italic>, and assuming that <italic toggle="yes">pa</italic>(<italic toggle="yes">j</italic>) = <italic toggle="yes">pa</italic>(<italic toggle="yes">k</italic>) = <italic toggle="yes">i</italic>, we can write the joint distribution of all quantities under our model as:
<disp-formula id="pcbi.1011995.e006"><alternatives><graphic xlink:href="pcbi.1011995.e006.jpg" id="pcbi.1011995.e006g" position="anchor"/><mml:math id="M6" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">Φ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:munderover><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>E</mml:mi></mml:munderover><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>E</mml:mi></mml:munderover><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>E</mml:mi></mml:munderover><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold">Φ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>·</mml:mo><mml:mo>[</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:munderover><mml:msub><mml:mi>π</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:msub><mml:mo>]</mml:mo><mml:mspace width="0.166667em"/><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">v</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">Φ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(3)</label></disp-formula></p>
      <p>The last line of the above product indicates that at the root node <italic toggle="yes">R</italic> the prior probability of observing a nucleotide is given by the (input) stationary distribution <italic toggle="yes">π</italic>, whereas the trait and conservation state are specified directly using a prior, as described below.</p>
    </sec>
    <sec id="sec006">
      <title>Specification of priors</title>
      <p>At the root node, we use Pr(<italic toggle="yes">z</italic><sub><italic toggle="yes">R</italic></sub> = 1) = Pr(<italic toggle="yes">z</italic><sub><italic toggle="yes">R</italic></sub> = 2) = 0.5. We follow Hu et al. [<xref rid="pcbi.1011995.ref012" ref-type="bibr">12</xref>] in this choice because we analyze the same CNE sequences, which were originally identified because they appeared widely conserved under a model (phastCons [<xref rid="pcbi.1011995.ref009" ref-type="bibr">9</xref>]) with two rate categories, conserved and neutral. We use <italic toggle="yes">y</italic><sub><italic toggle="yes">R</italic></sub> ∼ Normal(0, 1), although users can make their own choices freely. Priors on <italic toggle="yes">a</italic>, <italic toggle="yes">b</italic>, <italic toggle="yes">c</italic> in matrix <bold>Φ</bold> are uniform distributions (i.e., Beta(1,1)). Because we use the same nucleotide data, <italic toggle="yes">r</italic><sub>2</sub> ∼ Gamma(5, 0.04) and <italic toggle="yes">r</italic><sub>3</sub> ∼ Gamma(10, 0.2) follow the values in Hu et al. [<xref rid="pcbi.1011995.ref012" ref-type="bibr">12</xref>]. Priors on log <italic toggle="yes">β</italic><sub>2</sub> and log <italic toggle="yes">β</italic><sub>3</sub> are Normal(0, 1) which is mathematically equivalent to setting a Normal(0, 2) on log(<italic toggle="yes">β</italic><sub>3</sub>/<italic toggle="yes">β</italic><sub>2</sub>), the logarithm of their ratio. We also assume that log <italic toggle="yes">σ</italic><sup>2</sup> ∼ Normal(0, 2) <italic toggle="yes">a priori</italic>.</p>
    </sec>
    <sec id="sec007">
      <title>Bayesian inference procedure</title>
      <p>Inference is performed using a Markov chain Monte Carlo procedure, which is a combination of collapsed Gibbs sampling with some Metropolis within Gibbs steps [<xref rid="pcbi.1011995.ref018" ref-type="bibr">18</xref>, <xref rid="pcbi.1011995.ref019" ref-type="bibr">19</xref>]. The procedure is a minor modification of that introduced in pages 5–8 of the SI of Hu et al. [<xref rid="pcbi.1011995.ref012" ref-type="bibr">12</xref>], with the addition of an extra Metropolis step (Step 1), and the introduction of emission probabilities for <bold>y</bold> when sampling <bold>z</bold> (Step 3). The following steps are repeated:</p>
      <sec id="sec008">
        <title>Step 1: Sample ancestral trait values y and trait variance multipliers v</title>
        <p>Perform Metropolis steps (default is 500) to propose and update <italic toggle="yes">σ</italic><sup>2</sup>, <italic toggle="yes">β</italic><sub>2</sub>, <italic toggle="yes">β</italic><sub>3</sub>, and latent <bold>y</bold>. On 60% of iterations proposals to modify <italic toggle="yes">σ</italic><sup>2</sup>, <italic toggle="yes">β</italic><sub>2</sub>, and <italic toggle="yes">β</italic><sub>3</sub> are made; on the remaining occasions proposals to perturb latent <italic toggle="yes">y</italic><sub><italic toggle="yes">L</italic>+1</sub>, …, <italic toggle="yes">y</italic><sub><italic toggle="yes">N</italic></sub> are made.</p>
      </sec>
      <sec id="sec009">
        <title>Step 2: Sample ancestral nucleotides X</title>
        <p>First use the familiar pruning algorithm [<xref rid="pcbi.1011995.ref020" ref-type="bibr">20</xref>] to calculate the likelihood of subalignment {<bold>X</bold><sub><italic toggle="yes">i</italic>,<italic toggle="yes">s</italic></sub>} rooted at node <italic toggle="yes">i</italic> for all sites <italic toggle="yes">s</italic> = 1…<italic toggle="yes">S</italic> using the recurrence:
<disp-formula id="pcbi.1011995.e007"><alternatives><graphic xlink:href="pcbi.1011995.e007.jpg" id="pcbi.1011995.e007g" position="anchor"/><mml:math id="M7" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>∣</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:munder><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mo>·</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:munder><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(4)</label></disp-formula></p>
        <p>Next, forward sample ancestral nucleotides <bold>X</bold><sub><italic toggle="yes">L</italic>+1…<italic toggle="yes">N</italic>,1…<italic toggle="yes">S</italic></sub>. For sites at the root node we have <italic toggle="yes">P</italic>(<italic toggle="yes">X</italic><sub><italic toggle="yes">R</italic>,<italic toggle="yes">s</italic></sub>|{<bold>X</bold><sub><italic toggle="yes">R</italic>,<italic toggle="yes">s</italic></sub>}, <bold>z</bold>, <bold>r</bold>) ∝ <italic toggle="yes">P</italic>({<bold>X</bold><sub><italic toggle="yes">R</italic>,<italic toggle="yes">s</italic></sub>}|<italic toggle="yes">X</italic><sub><italic toggle="yes">R</italic>,<italic toggle="yes">s</italic></sub>, <bold>z</bold>, <bold>r</bold>)<italic toggle="yes">P</italic>(<italic toggle="yes">X</italic><sub><italic toggle="yes">R</italic>,<italic toggle="yes">s</italic></sub>) and <inline-formula id="pcbi.1011995.e008"><alternatives><graphic xlink:href="pcbi.1011995.e008.jpg" id="pcbi.1011995.e008g" position="anchor"/><mml:math id="M8" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> by assumption. For the remaining internal nodes we work from root to tips on a per-site basis using:
<disp-formula id="pcbi.1011995.e009"><alternatives><graphic xlink:href="pcbi.1011995.e009.jpg" id="pcbi.1011995.e009g" position="anchor"/><mml:math id="M9" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(5)</label></disp-formula></p>
      </sec>
      <sec id="sec010">
        <title>Step 3: Sample per-branch latent conservation states z</title>
        <p>First, from tips to root, calculate the joint likelihood of trait values and nucleotide emissions {<bold>XY</bold><sub><italic toggle="yes">i</italic></sub>} occurring on the subtree rooted at node <italic toggle="yes">i</italic> using the recurrence:
<disp-formula id="pcbi.1011995.e010"><alternatives><graphic xlink:href="pcbi.1011995.e010.jpg" id="pcbi.1011995.e010g" position="anchor"/><mml:math id="M10" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">Φ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:munderover><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>·</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>·</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:munder><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold">Φ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">Φ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>·</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:munder><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold">Φ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">Φ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(6)</label></disp-formula></p>
        <p>Next, sample <bold>z</bold> from root to tips. At the root our (domain specific) prior is <italic toggle="yes">P</italic>(<italic toggle="yes">z</italic><sub><italic toggle="yes">R</italic></sub>) = (0.5, 0.5, 0.0). For descendant nodes the appropriate probabilities are:
<disp-formula id="pcbi.1011995.e011"><alternatives><graphic xlink:href="pcbi.1011995.e011.jpg" id="pcbi.1011995.e011g" position="anchor"/><mml:math id="M11" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">Φ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">Φ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold">Φ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(7)</label></disp-formula></p>
      </sec>
      <sec id="sec011">
        <title>Step 4: Sample per-category nucleotide substitution rate multipliers r</title>
        <p>Perform Metropolis step to propose/update substitution rate multipliers <italic toggle="yes">r</italic><sub>2</sub> and <italic toggle="yes">r</italic><sub>3</sub>.</p>
      </sec>
      <sec id="sec012">
        <title>Step 5: Sample latent rate category transition probabilities Φ</title>
        <p>The beta prior on entries <italic toggle="yes">a</italic>, <italic toggle="yes">b</italic> and <italic toggle="yes">c</italic> of <bold>Φ</bold> leads to a beta posterior. For example, the posterior of <italic toggle="yes">c</italic> is directly sampled based on <bold>z</bold> transitions from 1 → 2 as follows:
<disp-formula id="pcbi.1011995.e012"><alternatives><graphic xlink:href="pcbi.1011995.e012.jpg" id="pcbi.1011995.e012g" position="anchor"/><mml:math id="M12" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>c</mml:mi><mml:mo>∼</mml:mo><mml:mtext>Beta</mml:mtext><mml:mspace width="2pt"/><mml:mo>(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mi>j</mml:mi><mml:mi>E</mml:mi></mml:munderover><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>β</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mi>j</mml:mi><mml:mi>E</mml:mi></mml:munderover><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(8)</label></disp-formula></p>
        <p>The posteriors of <italic toggle="yes">a</italic> and <italic toggle="yes">b</italic> are calculated similarly using the count of transitions 2 → 3 and 3 → 2 respectively.</p>
      </sec>
    </sec>
    <sec id="sec013">
      <title>Model selection and ranking of associated loci</title>
      <p>A collection of candidate elements can be ranked for association with a trait of interest using the Bayes factor (BF) [<xref rid="pcbi.1011995.ref021" ref-type="bibr">21</xref>] in favour of the ‘full model’ described above. In the full model, <italic toggle="yes">σ</italic><sup>2</sup>, <italic toggle="yes">β</italic><sub>2</sub>, and <italic toggle="yes">β</italic><sub>3</sub> are free to vary whereas in the more restricted null model this is not the case, and <italic toggle="yes">β</italic><sub>2</sub> = <italic toggle="yes">β</italic><sub>3</sub> = 1 so that no systematic relationship between the rate of trait evolution and relative substitution rates is specified. As the null model is nested and the priors on <italic toggle="yes">β</italic><sub>2</sub> and <italic toggle="yes">β</italic><sub>3</sub> are common to all candidate elements, the BF is estimated using the posterior density of (log <italic toggle="yes">β</italic><sub>2</sub>, log <italic toggle="yes">β</italic><sub>3</sub>) at (0, 0). This is an application of the Savage–Dickey method, which is explained in the tutorial of Wagenmakers et al. [<xref rid="pcbi.1011995.ref022" ref-type="bibr">22</xref>].</p>
    </sec>
    <sec id="sec014">
      <title>Molecular data</title>
      <p>We obtained mammalian CNE alignments directly from the first author of [<xref rid="pcbi.1011995.ref012" ref-type="bibr">12</xref>], who had in turn originally obtained them from the UCSC 100-way vertebrate alignment [<xref rid="pcbi.1011995.ref023" ref-type="bibr">23</xref>] available at: <ext-link xlink:href="http://hgdownload.soe.ucsc.edu/goldenPath/hg38/multiz100way" ext-link-type="uri">http://hgdownload.soe.ucsc.edu/goldenPath/hg38/multiz100way</ext-link>. We obtained the rate matrix and mammal phylogeny (see <xref rid="pcbi.1011995.s001" ref-type="supplementary-material">S1 Text</xref>) used to model the background relationship between species from the PhyloAcc GitHub repository, prepared by Hu et al. [<xref rid="pcbi.1011995.ref012" ref-type="bibr">12</xref>], and available at: <ext-link xlink:href="https://github.com/phyloacc/Hu-etal-2019-data/" ext-link-type="uri">https://github.com/phyloacc/Hu-etal-2019-data/</ext-link>. The mammal phylogeny was originally prepared by Murphy et al. [<xref rid="pcbi.1011995.ref024" ref-type="bibr">24</xref>].</p>
    </sec>
    <sec id="sec015">
      <title>Software implementation</title>
      <p>The PhyloAcc-C software is implemented as an R package [<xref rid="pcbi.1011995.ref025" ref-type="bibr">25</xref>] that makes use of C++ functions [<xref rid="pcbi.1011995.ref026" ref-type="bibr">26</xref>, <xref rid="pcbi.1011995.ref027" ref-type="bibr">27</xref>] to perform MCMC sampling. To use the package one must load an alignment (e.g. a FASTA file) and a tree (e.g. a New Hampshire file) by using the package ape [<xref rid="pcbi.1011995.ref028" ref-type="bibr">28</xref>] or similar. Trait data should be loaded into an R data frame and labelled so that it can be matched to the species names in the tree.</p>
      <p>The PhyloAcc-C package includes helper functions (sim_X, sim_y, and sim_z) enabling one to simulate alignments, traits, and conservation states under the PhyloAcc-C model. We used these functions to assess model performance in this paper, and a user may do the same given their own phylogeny and rate matrix.</p>
      <p>The software, installation instructions, and a tutorial covering simulation and inference are all available at <ext-link xlink:href="https://github.com/phyloacc/PhyloAcc-C" ext-link-type="uri">https://github.com/phyloacc/PhyloAcc-C</ext-link>.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec016">
    <title>Results</title>
    <p>To demonstrate that it is possible in principle to relate the rate of trait evolution to the rate of nucleotide evolution using PhyloAcc-C, we performed a simulation study under ideal circumstances. Then, to illustrate the method using real data, we downloaded principal component data representing the trait ‘long-lived large-bodied’ (LLL) previously studied with respect to protein evolution by Kowalczyk et al. [<xref rid="pcbi.1011995.ref015" ref-type="bibr">15</xref>]. This trait was analyzed in relation to CNEs previously studied by Hu et al. [<xref rid="pcbi.1011995.ref012" ref-type="bibr">12</xref>].</p>
    <p>In both simulations and our illustrative example, we focused on the quantity log(<italic toggle="yes">β</italic><sub>3</sub>/<italic toggle="yes">β</italic><sub>2</sub>). This quantity contrasts variation of a trait on branches undergoing accelerated sequence evolution against variation on branches undergoing conserved sequence evolution; a positive quantity associates faster nucleotide evolution with faster trait change whereas a negative quantity associates faster nucleotide evolution with slower trait evolution. Values close to zero suggest no strong systematic relationship under the PhyloAcc-C model.</p>
    <p>Note that the state of a trait on roughly half of all nodes of a tree is unobserved, so it is difficult to make inferences about <italic toggle="yes">β</italic><sub>2</sub> or <italic toggle="yes">β</italic><sub>3</sub> separately. This is because, in general, a path through a tree can involve sequential switching between periods of hidden evolution under either the <italic toggle="yes">β</italic><sub>2</sub> or the <italic toggle="yes">β</italic><sub>3</sub> regime. For this reason, we focus on the ratio of the two parameters, for which we can do inference. The logarithm of the ratio is reported because we are interested in the multiplicative effects of the parameter pair, e.g., variance multiplier pair (0.2/0.4) should be thought of in the same way as pair (0.6/1.2) as in both cases the second multiplier is double the first.</p>
    <sec id="sec017">
      <title>Simulations on full binary trees</title>
      <p>Using a fully bifurcating ultrametric tree with 128 tips, we simulated 100 times from our prior distribution, generating latent conservation states, and corresponding DNA sequence alignments and phenotypic trait values. The length of the simulated elements was 80 bp, reflecting the median length of mammalian CNEs in our data set. Branch lengths were all set at 0.1, so that root to tip distances were similar to the longer of the root to tip distances on our mammalian tree.</p>
      <p>We were able to recover log(<italic toggle="yes">β</italic><sub>3</sub>/<italic toggle="yes">β</italic><sub>2</sub>) reasonably well, with an MSE (mean squared error) of 0.36 (<xref rid="pcbi.1011995.g001" ref-type="fig">Fig 1A</xref>). The estimates appeared reasonably calibrated: the 80% credible interval (the 10<sup>th</sup> to 90<sup>th</sup> percentiles) covered the simulated parameters 72% of the time. FPRs (false positive rates) were characterized by fixing <italic toggle="yes">β</italic><sub>2</sub> = <italic toggle="yes">β</italic><sub>3</sub> = 1 (no link between trait variation and molecular evolution) and simulating 200 times under two scenarios. In the first scenario (<xref rid="pcbi.1011995.t001" ref-type="table">Table 1</xref>, col. 2) elements were generated under an exclusively neutral process, in the second scenario (<xref rid="pcbi.1011995.t001" ref-type="table">Table 1</xref>, col. 5) completely conserved elements were generated. In the latter conserved scenario <italic toggle="yes">r</italic> = 0.2 was used, the expected value of <italic toggle="yes">r</italic><sub>2</sub> under our prior. The FPR dropped below 1% in the neutral scenario when a BF of 2 or more was used as a cut-off; under the conserved scenario the corresponding cut-off was also BF ≥ 2.</p>
      <fig position="float" id="pcbi.1011995.g001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011995.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Simulated versus recovered (median) log(<italic toggle="yes">β</italic><sub>3</sub>/<italic toggle="yes">β</italic><sub>2</sub>) under model using 80 bp alignments.</title>
          <p><italic toggle="yes">A</italic>. fully bifurcating ultrametric tree with 128 tips and all branch lengths set to 0.1; <italic toggle="yes">B</italic>. branch lengths are doubled to 0.2; <italic toggle="yes">C</italic>. tip count is doubled with respect to <italic toggle="yes">A</italic>, but branch lengths are reduced to 0.09 to keep root to tip distance similar; <italic toggle="yes">D</italic>. branch lengths and topology as per mammalian tree (see <xref rid="pcbi.1011995.s001" ref-type="supplementary-material">S1 Text</xref>).</p>
        </caption>
        <graphic xlink:href="pcbi.1011995.g001" position="float"/>
      </fig>
      <table-wrap position="float" id="pcbi.1011995.t001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011995.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>FPR when choosing the full model using the BF in favour as a cut-off.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="pcbi.1011995.t001" id="pcbi.1011995.t001g" position="float"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="1" colspan="1">BF cut-off</th>
                <th align="center" rowspan="1" colspan="1">neutral 128 tips</th>
                <th align="center" rowspan="1" colspan="1">neutral 128 tips long branch</th>
                <th align="center" rowspan="1" colspan="1">neutral 256 tips</th>
                <th align="center" rowspan="1" colspan="1">conserved 128 tips</th>
                <th align="center" rowspan="1" colspan="1">conserved 128 tips long branch</th>
                <th align="center" rowspan="1" colspan="1">conserved 256 tips</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1">1</td>
                <td align="char" char="." rowspan="1" colspan="1">100.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">99.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">100.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">100.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">97.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">98.5%</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">2</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">1.0%</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">3</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="t001fn001">
            <p>FPRs were estimated using 200 simulations for each of six scenarios. The tree variants were: 128 tips, branch length 0.1; 128 tips, branch length 0.2; 256 tips, branch length 0.09. The alignment variants used rate multiplier 1 (neutral) and 0.2 (conserved).</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>We doubled the branch lengths on the bifurcating tree described above to 0.2 and then performed simulations analogous to those described above. We found we were no better able to recover log(<italic toggle="yes">β</italic><sub>3</sub>/<italic toggle="yes">β</italic><sub>2</sub>), now seeing an MSE of 0.38 (<xref rid="pcbi.1011995.g001" ref-type="fig">Fig 1B</xref>). The model remained reasonably calibrated as the 80% credible interval (the 10th to 90th percentiles) covered the simulated parameters 74% of the time. FPRs dropped to less than 1% by using BF cut-offs ≥2 in both scenarios (<xref rid="pcbi.1011995.t001" ref-type="table">Table 1</xref>, cols. 3 and 6).</p>
      <p>In the last of our idealized scenarios we doubled the number of tips on the tree to 256 while reducing the branch lengths to 0.09. In this scenario, the recovery of log(<italic toggle="yes">β</italic><sub>3</sub>/<italic toggle="yes">β</italic><sub>2</sub>) improved, having an MSE of 0.21 (<xref rid="pcbi.1011995.g001" ref-type="fig">Fig 1C</xref>). The 80% credible interval covered the simulated parameters 85% of the time and BF cut-offs of 3 or more were sufficient to reduce the FPR to less than 1% (<xref rid="pcbi.1011995.t001" ref-type="table">Table 1</xref>, cols. 4 and 7).</p>
    </sec>
    <sec id="sec018">
      <title>Simulations on a mammalian tree</title>
      <p>Ultimately only performance on real phylogenies with real traits matters. In a manner similar to the above simulations, we took our mammalian tree, having 61 tips, a variety of branch lengths, and an unbalanced topology, and simulated from our prior distributions as before. Recovery of log(<italic toggle="yes">β</italic><sub>3</sub>/<italic toggle="yes">β</italic><sub>2</sub>) worked less well, with an MSE of 0.45 (<xref rid="pcbi.1011995.g001" ref-type="fig">Fig 1D</xref>), though the model characterized its uncertainty appropriately as the 80% credible interval (10th to 90th percentiles) covered the simulated parameters 79% of the time.</p>
      <p>When testing FPR, we considered scenarios relevant to our size and lifespan results (below). Therefore, we fixed the values of the trait to the real LLL trait values of Kowalczyk et al. [<xref rid="pcbi.1011995.ref015" ref-type="bibr">15</xref>] i.e. we simulated only conservation states and alignments. Three scenarios were devised: one in which all elements evolved neutrally, one in which elements were conserved at the expected level of <italic toggle="yes">r</italic> = 0.2, and one in which the elements were conserved at <italic toggle="yes">r</italic> = 0.5, which put them above the 99th percentile according to our prior. When simulating short elements (50 bp) against the LLL trait we needed BF cut-offs of 7 (neutral), 3 (conserved), and 8 (barely conserved) in order to reduce the FPR below 1% (<xref rid="pcbi.1011995.t002" ref-type="table">Table 2</xref>, cols. 2–4); when considering longer elements (180 bp) the relevant BF thresholds were 4, 4, and 7 (<xref rid="pcbi.1011995.t002" ref-type="table">Table 2</xref>, cols. 4–7). We remark that the barely conserved scenario (<italic toggle="yes">r</italic> = 0.5) presents a challenging set of parameters for the model, which does not mix well when <italic toggle="yes">r</italic><sub>2</sub> and <italic toggle="yes">r</italic><sub>3</sub> are conflated.</p>
      <table-wrap position="float" id="pcbi.1011995.t002">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011995.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>FPR on the mammalian tree (see <xref rid="pcbi.1011995.s001" ref-type="supplementary-material">S1 Text</xref>) when choosing the full model using the BF in favour as a cut-off.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="pcbi.1011995.t002" id="pcbi.1011995.t002g" position="float"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="1" colspan="1">BF cut-off</th>
                <th align="center" rowspan="1" colspan="1">neutral 50 bp</th>
                <th align="center" rowspan="1" colspan="1">conserved 50 bp</th>
                <th align="center" rowspan="1" colspan="1">barely conserved 50 bp</th>
                <th align="center" rowspan="1" colspan="1">neutral 180 bp</th>
                <th align="center" rowspan="1" colspan="1">conserved 180 bp</th>
                <th align="center" rowspan="1" colspan="1">barely conserved 180 bp</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1">1</td>
                <td align="char" char="." rowspan="1" colspan="1">100.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">100.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">100.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">100.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">100.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">100.0%</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">2</td>
                <td align="char" char="." rowspan="1" colspan="1">19.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">1.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">65.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">1.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">2.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">37.5%</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">3</td>
                <td align="char" char="." rowspan="1" colspan="1">2.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">10.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">1.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">5.5%</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">4</td>
                <td align="char" char="." rowspan="1" colspan="1">1.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">2.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">2.0%</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">5</td>
                <td align="char" char="." rowspan="1" colspan="1">1.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">1.0%</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">6</td>
                <td align="char" char="." rowspan="1" colspan="1">0.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.5%</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">7</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.5%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">8</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
                <td align="char" char="." rowspan="1" colspan="1">0.0%</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="t002fn001">
            <p>FPRs were estimated using 200 simulations for each of six scenarios. The rate multiplier variants used to generate the alignments were: 1 (neutral); 0.2 (conserved); 0.5 (barely conserved). The alignment length variants were 50 bp and 180 bp. The trait was not simulated but fixed to the LLL values (see <xref rid="pcbi.1011995.g002" ref-type="fig">Fig 2</xref> or <xref rid="pcbi.1011995.s002" ref-type="supplementary-material">S1 Data</xref>).</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec id="sec019">
      <title>Size and lifespan of mammals</title>
      <p>Rather than pre-filtering CNE alignments based on heuristics, we instead ran PhyloAcc-C on all alignments with the LLL trait as input and then considered those where the model fit well in a reasonable 10,000 iterations, as assessed via a Gelman and Rubin [<xref rid="pcbi.1011995.ref029" ref-type="bibr">29</xref>] convergence diagnostic of &lt; 1.01 across 3 chains. This resulted in summaries for 136,859 elements. We ranked the elements by the BF (Bayes factor) in favour of the full model, where the rate of trait evolution is allowed to co-vary with the rate of molecular evolution, versus the null model, where the rate of trait evolution is constant across the phylogeny. We found 30 elements (0.02% of total) where the full model was ‘overwhelmingly’ supported (BF ≥ 100) with respect to the LLL trait and 1,109 (0.81% of total) where the full model was ‘very strongly’ supported (BF ≥30). We note that a BF ≥ 30 generally corresponded to effect sizes of magnitude 2 or more on the log scale i.e. to a ratio of about 7× or more.</p>
      <p>The result of running PhyloAcc-C on the element with the highest BF is shown in <xref rid="pcbi.1011995.g002" ref-type="fig">Fig 2</xref>. The ancestral reconstruction of the LLL trait with respect to this element is shown in Fig A in <xref rid="pcbi.1011995.s001" ref-type="supplementary-material">S1 Text</xref>. To determine if there were biologically interesting patterns that could be systematically detected based on CNE location, we submitted the 1,109 loci of interest as genomic foreground to a GREAT analysis [<xref rid="pcbi.1011995.ref030" ref-type="bibr">30</xref>]; the GREAT tool annotates regions of non-coding DNA with biologically meaningful terms using nearby genes, but includes statistical corrections that make it a more principled alternative to an analysis based solely on the gene closest to a given CNE. The full set of 136,859 CNEs (not the whole genome) were used as genomic background for the analysis.</p>
      <fig position="float" id="pcbi.1011995.g002">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011995.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>PhyloAcc-C fit to the LLL loci with the highest BF in favour of the full model (VCE277691).</title>
          <p><italic toggle="yes">A</italic>. the mammalian phylogeny (input data, see <xref rid="pcbi.1011995.s001" ref-type="supplementary-material">S1 Text</xref>) is scaled according to the posterior distribution of rate multipliers <bold>r</bold> and coloured by the posterior distribution of conservation state <bold>z</bold> (black = neutral, blue = conserved, red = accelerated). Next to the tree the LLL trait and CNE alignment (both are also input data) are shown. The corresponding posterior distribution of the trait (i.e. an ancestral reconstruction) is shown in Fig A in <xref rid="pcbi.1011995.s001" ref-type="supplementary-material">S1 Text</xref>. <italic toggle="yes">B</italic>. the prior (dashed) and posterior (solid) distribution of the rate multipliers <italic toggle="yes">r</italic><sub>2</sub> (blue, conserved) and <italic toggle="yes">r</italic><sub>3</sub> (red, accelerated). <italic toggle="yes">C</italic>. the prior (dashed) and posterior (solid) distribution of log(<italic toggle="yes">β</italic><sub>3</sub>/<italic toggle="yes">β</italic><sub>2</sub>). In this case the posterior distribution suggests a positive value so that faster nucleotide evolution is associated with faster trait evolution, but see <xref rid="pcbi.1011995.s001" ref-type="supplementary-material">S1 Text</xref> for VCE351367 where the opposite is true. <italic toggle="yes">D</italic>. posterior distribution of trait change from tip to immediate ancestor, normalized by branch length and coloured by posterior conservation state. Again note that an accelerated conservation state (red) is associated with bigger trait moves and a conserved conservation state (blue) is associated with smaller ones.</p>
        </caption>
        <graphic xlink:href="pcbi.1011995.g002" position="float"/>
      </fig>
      <p>The GREAT analysis suggested no genes were associated with the 1,109 LLL loci of interest, although several GO (gene ontology) biological processes were. These can be summarized as: blood vessel endothelial cell proliferation involved in sprouting angiogenesis; positive regulation of branching involved in lung morphogenesis; regulation of muscle tissue development, differentiation, and proliferation, esp. in the heart; regulation of alkaline phosphatase activity; astrocyte development; organ induction; endocrine pancreas development; trachea formation.</p>
      <p>In addition to performing an analysis using GREAT, we also examined the 1 Mbp regions surrounding the top 25 loci associated (via PhyloAcc-C) with the LLL trait using the UCSC [<xref rid="pcbi.1011995.ref010" ref-type="bibr">10</xref>] and ENSEMBL [<xref rid="pcbi.1011995.ref031" ref-type="bibr">31</xref>] genome browsers, noting known functions or other annotations of nearby genes. Unlike the GREAT analysis, this was not a statistical analysis, but a set of observations made using the GeneCards tool [<xref rid="pcbi.1011995.ref032" ref-type="bibr">32</xref>], and linked databases, such as the GWAS Catalog [<xref rid="pcbi.1011995.ref033" ref-type="bibr">33</xref>]. We found that 12 loci were near genes associated with height, weight, or limb length in some way, mainly via GWAS. Seven loci were associated with cancer genes, seven with the brain or nervous system, six with the skeleton, four with sperm, and one with longevity. Three regions had little to no annotation available whereas four loci were associated with p53, cell fate, or telomere length.</p>
      <p>Overall, LLL loci with BF ≥ 30 exhibited effects in both directions, with log(<italic toggle="yes">β</italic><sub>3</sub>/<italic toggle="yes">β</italic><sub>2</sub>) being both positive and negative (<xref rid="pcbi.1011995.g003" ref-type="fig">Fig 3</xref>). The results of our note taking approach, and summaries of the PhyloAcc-C runs on the 136,859 LLL loci are recorded in <xref rid="pcbi.1011995.s002" ref-type="supplementary-material">S1 Data</xref>. Full output of the GREAT analysis is reported in <xref rid="pcbi.1011995.s003" ref-type="supplementary-material">S2 Data</xref>.</p>
      <fig position="float" id="pcbi.1011995.g003">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1011995.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>BF versus estimated (median) log(<italic toggle="yes">β</italic><sub>3</sub>/<italic toggle="yes">β</italic><sub>2</sub>) for 136,859 mammalian LLL loci.</title>
          <p>Orange loci are those having BF ≥ 30 and that were submitted as GREAT foreground during analysis. The two loci with the highest BF in favour of the full model are labelled. Note VCE277691 (see <xref rid="pcbi.1011995.g002" ref-type="fig">Fig 2</xref>) and VCE351367 (see <xref rid="pcbi.1011995.s001" ref-type="supplementary-material">S1 Text</xref>) have effects with opposite signs.</p>
        </caption>
        <graphic xlink:href="pcbi.1011995.g003" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec020">
    <title>Discussion</title>
    <p>We present a statistical method, PhyloAcc-C, for relating the rate of nucleotide evolution to the rate of evolution of a continuous trait. The model is phylogenetically framed and operates under the common assumption that nucleotide evolution follows a site-independent, continuous-time discrete-state Markov process, and that continuous traits evolve under Brownian motion, although in our case with potentially different rates on different parts of the tree. Latent rate categories are also assigned to each branch using a Markov process, which all together allows the rates of molecular and phenotypic evolution to vary in an automatic way across branches.</p>
    <p>A notable feature of the model is its ability to associate the evolution of continuous traits and non-coding DNA using a more statistically integrated approach than that taken by Yusuf et al. [<xref rid="pcbi.1011995.ref014" ref-type="bibr">14</xref>] or Kowalczyk et al. [<xref rid="pcbi.1011995.ref015" ref-type="bibr">15</xref>]. Indeed, the general idea of linking genotypic rate multipliers (i.e. evolution relative to a known background tree) and phenotypic rate multipliers (i.e. variance parameters) seems natural, and could be used in other frameworks. For example, the PhyloAcc family of models (<ext-link xlink:href="https://phyloacc.github.io/" ext-link-type="uri">https://phyloacc.github.io/</ext-link>) allocates rates with efficient processing of CNEs in mind, yet genotypic and phenotypic rates of evolution can also be linked under more complex models, such as relaxed clocks [<xref rid="pcbi.1011995.ref034" ref-type="bibr">34</xref>, <xref rid="pcbi.1011995.ref035" ref-type="bibr">35</xref>] or local clocks [<xref rid="pcbi.1011995.ref036" ref-type="bibr">36</xref>], via linear or logistic functions. The efficiency versus accuracy tradeoffs of different rate assignment strategies will not be clear without further research, e.g., allowing substitution rates to change within a branch might be more computationally demanding, but is biologically more realistic and might lead to better model fit, especially because PhyloAcc-C does not take any account of branch length when considering the probability of transition between rate categories.</p>
    <p>PhyloAcc-C focuses on linking the rate of genotypic evolution with the rate of phenotypic evolution. This is distinct from: (i) relating the state of a sequence to the state of a trait; (ii) relating rapid sequence change to the state of a trait; (iii) relating the state of a sequence to rapid trait change. Many methods perform analyses related to approach (i), and have been well summarized [<xref rid="pcbi.1011995.ref001" ref-type="bibr">1</xref>]. Approach (ii) is the domain of Coevol [<xref rid="pcbi.1011995.ref013" ref-type="bibr">13</xref>] (where fast evolution across 410 mammalian cytochrome b sequences was associated with lower mass and longevity), as well as some more heuristic approaches [<xref rid="pcbi.1011995.ref014" ref-type="bibr">14</xref>, <xref rid="pcbi.1011995.ref015" ref-type="bibr">15</xref>]. In some sense approach (iii) is taken by e.g. reverse genomics [<xref rid="pcbi.1011995.ref003" ref-type="bibr">3</xref>] and PhyloAcc [<xref rid="pcbi.1011995.ref012" ref-type="bibr">12</xref>], which both treat sequences in an alignment that are sufficiently different (a threshold) as lost. If one squints hard enough, the coincident loss of a trait can then be considered a rapid change in a trait. However, the aforementioned approaches do not actually model the rate of change of a trait on the lineages where it is lost, so approach (iii) is certainly a potential area for future work.</p>
    <p>Simulations show that the model can perform acceptably on both ideal trees and a mammalian tree related to a large set of CNE alignments. This is encouraging, but we suggest users of the method check model performance using their tree, and the sequence lengths and rate multipliers they expect to see. The R software package and instructions accompanying this paper make the simulation process relatively straightforward. In addition, we emphasize that whereas larger trees might provide more data points, there is a judgment call to be made over how large a tree can be plausibly described by three rate categories.</p>
    <p>As an illustrative example, we applied PhyloAcc-C to CNEs and longevity data from mammals. From a biomedical perspective, longevity is an important trait, with a long history of study in a diversity of organisms, from worms [<xref rid="pcbi.1011995.ref037" ref-type="bibr">37</xref>] to humans [<xref rid="pcbi.1011995.ref038" ref-type="bibr">38</xref>], and therefore there is at least some possibility of assessing the plausibility of candidate loci using published evidence and annotations. Furthermore, lifespan and body-size are also relevant to longstanding conundrums and current ecological debates, including theories of life-history tradeoffs [<xref rid="pcbi.1011995.ref039" ref-type="bibr">39</xref>, <xref rid="pcbi.1011995.ref040" ref-type="bibr">40</xref>], and Peto’s paradox [<xref rid="pcbi.1011995.ref041" ref-type="bibr">41</xref>], which asks how large and long-lived animals mitigate cancer risk in the face of the many cell divisions that occur during their lifetime. This means the trait is also familiar and of interest to a broad readership. For these reasons, we describe three recent papers studying lifespan that also use broad genomic data, and help put our analysis and methodology into context.</p>
    <p>Kowalczyk et al. [<xref rid="pcbi.1011995.ref015" ref-type="bibr">15</xref>] studied the LLL trait (as previously mentioned, we reuse their trait data) but in the context of protein evolution, with an explicit focus on genes that were interpreted as being under increased purifying selection in long-lived large-bodied species, where LLL was treated as the derived state. Kowalczyk et al. [<xref rid="pcbi.1011995.ref015" ref-type="bibr">15</xref>] highlighted processes related to the cell cycle, DNA repair, cell death, immunity, and IGF1 expression pathways. Each of these processes were then plausibly linked to lifespan via their analysis. The authors also discuss telomere maintenance and p53, also plausibly linked to aging and cancer control. There is notable overlap between our LLL results and those of [<xref rid="pcbi.1011995.ref015" ref-type="bibr">15</xref>]: both analyses found associations to p53, telomere maintenance, and cell fate within 1 Mbp of our top 25 loci of interest. Our top 25 loci also have links to cancer and height or body size, though these prevalent diseases and biomarkers are of course heavily studied and consequently commonly annotated, and so we cannot know whether their appearance is simply due to their frequency.</p>
    <p>Tejada-Martinez et al. [<xref rid="pcbi.1011995.ref042" ref-type="bibr">42</xref>] also focused on protein evolution in their study of lifespan and body mass in primates, although they then linked their findings to enhancer evolution. They performed phylogenetic regressions, relating dN/dS to maximum lifespan and body mass for around 10,000 genes. In contrast to Kowalczyk et al. [<xref rid="pcbi.1011995.ref015" ref-type="bibr">15</xref>], Tejada-Martinez et al. [<xref rid="pcbi.1011995.ref042" ref-type="bibr">42</xref>] focus on positive (directional) selection on protein-coding genes rather than conservation. The authors identified 276 candidate genes whose rate of adaptive evolution positively correlated with maximum life span in a phylogenetic context. The authors focused their discussion on the enrichment of diverse processes including immunity, inflammation, cellular aging, organismal development (height, BMI), neurodevelopment, and brain function. These processes are all represented in our results in one form or another. None of the genes mentioned in the body of their manuscript occur in our notes on our top 25 loci of interest except for p53, the well known tumour suppressor, which is downregulated by HDAC3, a gene close to the CNE ranked as most-interesting overall in our LLL analysis (<xref rid="pcbi.1011995.g002" ref-type="fig">Fig 2</xref>).</p>
    <p>A third study by Treaster et al. [<xref rid="pcbi.1011995.ref043" ref-type="bibr">43</xref>] takes yet a different approach to understanding longevity. By focusing on 23 species of rockfish that are both closely related and feature a wide range of lifespans (11 to more than 200 years), the authors aimed to identify longevity related protein coding genes while minimizing false positives due to (other) convergent evolution. A key part of the analysis pipeline was the detection of rate shifts using the TRACCER tool [<xref rid="pcbi.1011995.ref007" ref-type="bibr">7</xref>]. Unlike Kolora et al. [<xref rid="pcbi.1011995.ref044" ref-type="bibr">44</xref>], and the other studies we mention, Treaster et al. [<xref rid="pcbi.1011995.ref043" ref-type="bibr">43</xref>] treated longevity as a binary trait and argued against the need to correct for body size. The authors found the ancestral rockfish state to be long-lived, and linked positive selection to glycogen biosynthesis and flavonoid metabolism via GO analysis. The top genes identified in their study do not feature in our notes on our top 25 LLL loci though, as all of us do, the authors find a relationship between their loci of interest and p53, in this case via PLA2R1. We note Treaster et al. [<xref rid="pcbi.1011995.ref043" ref-type="bibr">43</xref>] and Kowalczyk et al. [<xref rid="pcbi.1011995.ref015" ref-type="bibr">15</xref>] emphasize insulin signalling pathways, though apparently the particular pathways are under increased constraint in mammals (gene IGF1) but accelerated in Rockfish (gene INSR).</p>
    <p>The above studies either focus exclusively on protein coding genes [<xref rid="pcbi.1011995.ref015" ref-type="bibr">15</xref>, <xref rid="pcbi.1011995.ref043" ref-type="bibr">43</xref>] or examine non-coding sequences only insofar as they are identified as byproduct of an analysis with genes as the starting point and main consideration [<xref rid="pcbi.1011995.ref042" ref-type="bibr">42</xref>]. One distinguishing factor of PhyloAcc-C when compared to these approaches is that its focus is on identifying relevant non-coding sequences. It is possible then that PhyloAcc-C will sometimes identify processes that would otherwise be missed. Indeed, Treaster et al. [<xref rid="pcbi.1011995.ref043" ref-type="bibr">43</xref>] specifically mention that an attempt was made to analyze the CNE data captured as part of their study, but that their approach was underpowered when working with short conserved sequences. This suggests PhyloAcc-C might be used in a complementary manner to existing methodologies, potentially extracting further insight from a given sequencing data set. Bearing this in mind, it is interesting that our analysis appeared to highlight alternative biological themes that are not present in the results of the above studies, but that do seem plausibly related to longevity and body size. These themes are a prevalence of associations with skeletal genes and genes relating to exploratory process.</p>
    <p>When examining our top 25 LLL loci we noticed several genes related to bone strength or bone development including Fibrillin 2 (FBN2). We note that FBN2 is specifically associated with congenital contractural arachnodactyly, i.e., a particularly tall long-limbed phenotype, with long slender fingers and toes. Such non-lethal but body size-related phenotypic differences do seem to be the kind of effects that one would <italic toggle="yes">a priori</italic> imagine to be associated with true LLL loci. In the case of exploratory processes, we note that our GO analysis identified the processes ‘blood vessel endothelial cell proliferation involved in sprouting angiogenesis’ and ‘positive regulation of branching involved in lung morphogenesis’. These sort of developmental processes are exactly those thought to enhance evolvability [<xref rid="pcbi.1011995.ref045" ref-type="bibr">45</xref>, <xref rid="pcbi.1011995.ref046" ref-type="bibr">46</xref>]. The basic reasoning is that whereas core functions are conserved across metazoa, the evolutionary flexibility of anatomical traits, such as limb shape or size, is derived from the fact that many of their constituent components are decoupled from a few fixed genetically coded features. For example, the limb is a co-ordinated collection of bone, muscle, nerves, and vasculature, but the genetic orchestration of limb development is largely achieved through cartilaginous condensations, which then select feasible arrangements of the aforementioned components. However, what works for the body during development can work against it in the case of cancer, and the importance of blood supply to tumour growth and metastasis means that as of 2018 at least 14 endothelial angiogenesis inhibitors were being used to treat cancer in the USA [<xref rid="pcbi.1011995.ref047" ref-type="bibr">47</xref>].</p>
    <p>In conclusion, we have introduced a method that can be used to study the co-evolution of continuous traits and non-coding DNA. The method is available as an R package and users are free to modify it as they wish under the GPL. Applying the method highlighted interesting candidate LLL loci, including those related to exploratory processes, skeletal development, as well as more ‘typical’ lifespan related themes that have also been identified in other recent bioinformatics studies.</p>
    <p>We have given some thought to future work. Longevity and size are clearly complex traits that are correlated with each other, and also with other traits, e.g., sociality [<xref rid="pcbi.1011995.ref048" ref-type="bibr">48</xref>]. Moreover, it is not unreasonable to think that thousands of enhancers and (at least) hundreds of genes are systematically involved in the evolution of these correlated related traits. PhyloAcc-C currently cannot tease apart the relative contribution of different loci to different traits of interest. One future direction would be to focus on methods for finding clusters of loci that collectively, but not always simultaneously, contribute to the variation of a trait. Another area for future work is the incorporation of more flexible null models. One way this should be attempted is by using a more realistic method to assign nucleotide rate multipliers to branches, such as relaxed, correlated, or random local clocks, or their more recent derivatives [<xref rid="pcbi.1011995.ref049" ref-type="bibr">49</xref>]. A second improvement would be to make use of alternative models of trait evolution such as those used by Uyeda and Harmon [<xref rid="pcbi.1011995.ref050" ref-type="bibr">50</xref>]. A combination of more flexible rate assignment and alternative models of trait evolution would lead to a more plausible null model overall, giving a greater confidence that a high BF indicates an interesting locus.</p>
    <p>We see PhyloAcc-C and the other PhyloG2P methods we have discussed as first steps towards powerful tools to advance the PhyloG2P programme. Such methods will ultimately increase both our understanding of natural history and also allow us to use data from diverse species to shine a spotlight on parts of our own genome that are important for biodiversity and human health. Smith et al. [<xref rid="pcbi.1011995.ref001" ref-type="bibr">1</xref>] put it well: ‘Phylogenetics is the new genetics’.</p>
  </sec>
  <sec id="sec021" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pcbi.1011995.s001" position="float" content-type="local-data">
      <label>S1 Text</label>
      <caption>
        <title>Additional text and figures in PDF format.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1011995.s001.pdf"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011995.s002" position="float" content-type="local-data">
      <label>S1 Data</label>
      <caption>
        <title>Tables in Excel spreadsheet format.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1011995.s002.xlsx"/>
    </supplementary-material>
    <supplementary-material id="pcbi.1011995.s003" position="float" content-type="local-data">
      <label>S2 Data</label>
      <caption>
        <title>Output of GREAT analysis on LLL candidate loci in PDF format.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1011995.s003.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We thank members of the Edwards, Liu, and Sackton groups for helpful discussions during the course of this research. The computations in this paper were run on the FASRC Cannon cluster supported by the FAS Division of Science Research Computing Group at Harvard University.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1011995.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Smith</surname><given-names>SD</given-names></name>, <name><surname>Pennell</surname><given-names>MW</given-names></name>, <name><surname>Dunn</surname><given-names>CW</given-names></name>, <name><surname>Edwards</surname><given-names>SV</given-names></name>. <article-title>Phylogenetics is the new genetics (for most of biodiversity)</article-title>. <source>Trends in Ecology &amp; Evolution</source>. <year>2020</year>;<volume>35</volume>(<issue>5</issue>):<fpage>415</fpage>–<lpage>425</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.tree.2020.01.005</pub-id><pub-id pub-id-type="pmid">32294423</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Hiller</surname><given-names>M</given-names></name>, <name><surname>Schaar</surname><given-names>BT</given-names></name>, <name><surname>Indjeian</surname><given-names>VB</given-names></name>, <name><surname>Kingsley</surname><given-names>DM</given-names></name>, <name><surname>Hagey</surname><given-names>LR</given-names></name>, <name><surname>Bejerano</surname><given-names>G</given-names></name>. <article-title>A “forward genomics” approach links genotype to phenotype using independent phenotypic losses among related species</article-title>. <source>Cell Reports</source>. <year>2012</year>;<volume>2</volume>(<issue>4</issue>):<fpage>817</fpage>–<lpage>823</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.celrep.2012.08.032</pub-id><?supplied-pmid 23022484?><pub-id pub-id-type="pmid">23022484</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Marcovitz</surname><given-names>A</given-names></name>, <name><surname>Jia</surname><given-names>R</given-names></name>, <name><surname>Bejerano</surname><given-names>G</given-names></name>. <article-title>“Reverse genomics” predicts function of human conserved noncoding elements</article-title>. <source>Molecular Biology and Evolution</source>. <year>2016</year>;<volume>33</volume>(<issue>5</issue>):<fpage>1358</fpage>–<lpage>1369</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msw001</pub-id><?supplied-pmid 26744417?><pub-id pub-id-type="pmid">26744417</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Prudent</surname><given-names>X</given-names></name>, <name><surname>Parra</surname><given-names>G</given-names></name>, <name><surname>Schwede</surname><given-names>P</given-names></name>, <name><surname>Roscito</surname><given-names>JG</given-names></name>, <name><surname>Hiller</surname><given-names>M</given-names></name>. <article-title>Controlling for phylogenetic relatedness and evolutionary rates improves the discovery of associations between species’ phenotypic and genomic differences</article-title>. <source>Molecular Biology and Evolution</source>. <year>2016</year>;<volume>33</volume>(<issue>8</issue>):<fpage>2135</fpage>–<lpage>2150</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msw098</pub-id><?supplied-pmid 27222536?><pub-id pub-id-type="pmid">27222536</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Langer</surname><given-names>BE</given-names></name>, <name><surname>Roscito</surname><given-names>JG</given-names></name>, <name><surname>Hiller</surname><given-names>M</given-names></name>. <article-title>REforge associates transcription factor binding site divergence in regulatory elements with phenotypic differences between species</article-title>. <source>Molecular Biology and Evolution</source>. <year>2018</year>;<volume>35</volume>(<issue>12</issue>):<fpage>3027</fpage>–<lpage>3040</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msy187</pub-id><?supplied-pmid 30256993?><pub-id pub-id-type="pmid">30256993</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Partha</surname><given-names>R</given-names></name>, <name><surname>Kowalczyk</surname><given-names>A</given-names></name>, <name><surname>Clark</surname><given-names>NL</given-names></name>, <name><surname>Chikina</surname><given-names>M</given-names></name>. <article-title>Robust method for detecting convergent shifts in evolutionary rates</article-title>. <source>Molecular Biology and Evolution</source>. <year>2019</year>;<volume>36</volume>(<issue>8</issue>):<fpage>1817</fpage>–<lpage>1830</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msz107</pub-id><?supplied-pmid 31077321?><pub-id pub-id-type="pmid">31077321</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Treaster</surname><given-names>S</given-names></name>, <name><surname>Daane</surname><given-names>JM</given-names></name>, <name><surname>Harris</surname><given-names>MP</given-names></name>. <article-title>Refining convergent rate analysis with topology in mammalian longevity and marine transitions</article-title>. <source>Molecular Biology and Evolution</source>. <year>2021</year>;<volume>38</volume>(<issue>11</issue>):<fpage>5190</fpage>–<lpage>5203</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msab226</pub-id><?supplied-pmid 34324001?><pub-id pub-id-type="pmid">34324001</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Hardison</surname><given-names>RC</given-names></name>. <article-title>Conserved noncoding sequences are reliable guides to regulatory elements</article-title>. <source>Trends in Genetics</source>. <year>2000</year>;<volume>16</volume>(<issue>9</issue>):<fpage>369</fpage>–<lpage>372</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/S0168-9525(00)02081-3</pub-id><?supplied-pmid 10973062?><pub-id pub-id-type="pmid">10973062</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref009">
      <label>9</label>
      <mixed-citation publication-type="other">Siepel A, Pollard KS, Haussler D. New methods for detecting lineage-specific selection. In: Annual International Conference on Research in Computational Molecular Biology 2006. Berlin: Springer Berlin Heidelberg; 2006 pp. 190–205.</mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Rosenbloom</surname><given-names>KR</given-names></name>, <name><surname>Armstrong</surname><given-names>J</given-names></name>, <name><surname>Barber</surname><given-names>GP</given-names></name>, <name><surname>Casper</surname><given-names>J</given-names></name>, <name><surname>Clawson</surname><given-names>H</given-names></name>, <name><surname>Diekhans</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>The UCSC genome browser database: 2015 update</article-title>. <source>Nucleic Acids Research</source>. <year>2015</year>;<volume>43</volume>(<issue>D1</issue>):<fpage>D670</fpage>–<lpage>D681</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gku1177</pub-id><?supplied-pmid 25428374?><pub-id pub-id-type="pmid">25428374</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Booker</surname><given-names>BM</given-names></name>, <name><surname>Friedrich</surname><given-names>T</given-names></name>, <name><surname>Mason</surname><given-names>MK</given-names></name>, <name><surname>VanderMeer</surname><given-names>JE</given-names></name>, <name><surname>Zhao</surname><given-names>J</given-names></name>, <name><surname>Eckalbar</surname><given-names>WL</given-names></name>, <etal>et al</etal>. <article-title>Bat accelerated regions identify a bat forelimb specific enhancer in the HoxD locus</article-title>. <source>PLoS Genetics</source>. <year>2016</year>;<volume>12</volume>(<issue>3</issue>):<fpage>e1005738</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pgen.1005738</pub-id><?supplied-pmid 27019019?><pub-id pub-id-type="pmid">27019019</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Hu</surname><given-names>Z</given-names></name>, <name><surname>Sackton</surname><given-names>TB</given-names></name>, <name><surname>Edwards</surname><given-names>SV</given-names></name>, <name><surname>Liu</surname><given-names>JS</given-names></name>. <article-title>Bayesian detection of convergent rate changes of conserved noncoding elements on phylogenetic trees</article-title>. <source>Molecular Biology and Evolution</source>. <year>2019</year>;<volume>36</volume>(<issue>5</issue>):<fpage>1086</fpage>–<lpage>1100</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msz049</pub-id><?supplied-pmid 30851112?><pub-id pub-id-type="pmid">30851112</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Lartillot</surname><given-names>N</given-names></name>, <name><surname>Poujol</surname><given-names>R</given-names></name>. <article-title>A phylogenetic model for investigating correlated evolution of substitution rates and continuous phenotypic characters</article-title>. <source>Molecular Biology and Evolution</source>. <year>2011</year>;<volume>28</volume>(<issue>1</issue>):<fpage>729</fpage>–<lpage>744</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msq244</pub-id><?supplied-pmid 20926596?><pub-id pub-id-type="pmid">20926596</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Yusuf</surname><given-names>L</given-names></name>, <name><surname>Heatley</surname><given-names>MC</given-names></name>, <name><surname>Palmer</surname><given-names>JP</given-names></name>, <name><surname>Barton</surname><given-names>HJ</given-names></name>, <name><surname>Cooney</surname><given-names>CR</given-names></name>, <name><surname>Gossmann</surname><given-names>TI</given-names></name>. <article-title>Noncoding regions underpin avian bill shape diversification at macroevolutionary scales</article-title>. <source>Genome Research</source>. <year>2020</year>;<volume>30</volume>(<issue>4</issue>):<fpage>553</fpage>–<lpage>565</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1101/gr.255752.119</pub-id><?supplied-pmid 32269134?><pub-id pub-id-type="pmid">32269134</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Kowalczyk</surname><given-names>A</given-names></name>, <name><surname>Partha</surname><given-names>R</given-names></name>, <name><surname>Clark</surname><given-names>NL</given-names></name>, <name><surname>Chikina</surname><given-names>M</given-names></name>. <article-title>Pan-mammalian analysis of molecular constraints underlying extended lifespan</article-title>. <source>Elife</source>. <year>2020</year>;<volume>9</volume>:<fpage>e51089</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.7554/eLife.51089</pub-id><?supplied-pmid 32043462?><pub-id pub-id-type="pmid">32043462</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Pollard</surname><given-names>KS</given-names></name>, <name><surname>Hubisz</surname><given-names>MJ</given-names></name>, <name><surname>Rosenbloom</surname><given-names>KR</given-names></name>, <name><surname>Siepel</surname><given-names>A</given-names></name>. <article-title>Detection of nonneutral substitution rates on mammalian phylogenies</article-title>. <source>Genome Research</source>. <year>2010</year>;<volume>20</volume>(<issue>1</issue>):<fpage>110</fpage>–<lpage>121</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1101/gr.097857.109</pub-id><?supplied-pmid 19858363?><pub-id pub-id-type="pmid">19858363</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref017">
      <label>17</label>
      <mixed-citation publication-type="book"><name><surname>Cox</surname><given-names>DR</given-names></name>, <name><surname>Miller</surname><given-names>HD</given-names></name>. <source>The theory of stochastic processes</source>. vol. <volume>134</volume>. <publisher-name>CRC press</publisher-name>; <year>1977</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>JS</given-names></name>. <article-title>The collapsed Gibbs sampler in Bayesian computations with applications to a gene regulation problem</article-title>. <source>Journal of the American Statistical Association</source>. <year>1994</year>;<volume>89</volume>(<issue>427</issue>):<fpage>958</fpage>–<lpage>966</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1080/01621459.1994.10476829</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref019">
      <label>19</label>
      <mixed-citation publication-type="book"><name><surname>Liu</surname><given-names>J</given-names></name>. <source>Monte Carlo strategies in scientific computing</source>. <publisher-loc>New York</publisher-loc>: <publisher-name>Springer-Verlag</publisher-name>; <year>2001</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Felsenstein</surname><given-names>J</given-names></name>. <article-title>Evolutionary trees from DNA sequences: a maximum likelihood approach</article-title>. <source>Journal of Molecular Evolution</source>. <year>1981</year>;<volume>17</volume>:<fpage>368</fpage>–<lpage>376</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/BF01734359</pub-id><?supplied-pmid 7288891?><pub-id pub-id-type="pmid">7288891</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Kass</surname><given-names>RE</given-names></name>, <name><surname>Raftery</surname><given-names>AE</given-names></name>. <article-title>Bayes factors</article-title>. <source>Journal of the American Statistical Association</source>. <year>1995</year>;<volume>90</volume>(<issue>430</issue>):<fpage>773</fpage>–<lpage>795</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1080/01621459.1995.10476572</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Wagenmakers</surname><given-names>EJ</given-names></name>, <name><surname>Lodewyckx</surname><given-names>T</given-names></name>, <name><surname>Kuriyal</surname><given-names>H</given-names></name>, <name><surname>Grasman</surname><given-names>R</given-names></name>. <article-title>Bayesian hypothesis testing for psychologists: A tutorial on the Savage–Dickey method</article-title>. <source>Cognitive Psychology</source>. <year>2010</year>;<volume>60</volume>(<issue>3</issue>):<fpage>158</fpage>–<lpage>189</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cogpsych.2009.12.001</pub-id><?supplied-pmid 20064637?><pub-id pub-id-type="pmid">20064637</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Blanchette</surname><given-names>M</given-names></name>, <name><surname>Kent</surname><given-names>WJ</given-names></name>, <name><surname>Riemer</surname><given-names>C</given-names></name>, <name><surname>Elnitski</surname><given-names>L</given-names></name>, <name><surname>Smit</surname><given-names>AF</given-names></name>, <name><surname>Roskin</surname><given-names>KM</given-names></name>, <etal>et al</etal>. <article-title>Aligning multiple genomic sequences with the threaded blockset aligner</article-title>. <source>Genome Research</source>. <year>2004</year>;<volume>14</volume>(<issue>4</issue>):<fpage>708</fpage>–<lpage>715</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1101/gr.1933104</pub-id><?supplied-pmid 15060014?><pub-id pub-id-type="pmid">15060014</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Murphy</surname><given-names>WJ</given-names></name>, <name><surname>Pevzner</surname><given-names>PA</given-names></name>, <name><surname>O’Brien</surname><given-names>SJ</given-names></name>. <article-title>Mammalian phylogenomics comes of age</article-title>. <source>Trends in Genetics</source>. <year>2004</year>;<volume>20</volume>(<issue>12</issue>):<fpage>631</fpage>–<lpage>639</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.tig.2004.09.005</pub-id><?supplied-pmid 15522459?><pub-id pub-id-type="pmid">15522459</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref025">
      <label>25</label>
      <mixed-citation publication-type="other">R Core Team. R: A Language and Environment for Statistical Computing; 2021. Available from: <ext-link xlink:href="https://www.R-project.org/" ext-link-type="uri">https://www.R-project.org/</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Eddelbuettel</surname><given-names>D</given-names></name>, <name><surname>François</surname><given-names>R</given-names></name>. <article-title>Rcpp: Seamless R and C++ integration</article-title>. <source>Journal of Statistical Software</source>. <year>2011</year>;<volume>40</volume>:<fpage>1</fpage>–<lpage>18</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.18637/jss.v040.i08</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Eddelbuettel</surname><given-names>D</given-names></name>, <name><surname>Sanderson</surname><given-names>C</given-names></name>. <article-title>RcppArmadillo: Accelerating R with high-performance C++ linear algebra</article-title>. <source>Computational Statistics &amp; Data Analysis</source>. <year>2014</year>;<volume>71</volume>:<fpage>1054</fpage>–<lpage>1063</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.csda.2013.02.005</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Paradis</surname><given-names>E</given-names></name>, <name><surname>Claude</surname><given-names>J</given-names></name>, <name><surname>Strimmer</surname><given-names>K</given-names></name>. <article-title>APE: analyses of phylogenetics and evolution in R language</article-title>. <source>Bioinformatics</source>. <year>2004</year>;<volume>20</volume>(<issue>2</issue>):<fpage>289</fpage>–<lpage>290</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btg412</pub-id><?supplied-pmid 14734327?><pub-id pub-id-type="pmid">14734327</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Gelman</surname><given-names>A</given-names></name>, <name><surname>Rubin</surname><given-names>DB</given-names></name>. <article-title>Inference from iterative simulation using multiple sequences</article-title>. <source>Statistical Science</source>. <year>1992</year>;<volume>7</volume>(<issue>4</issue>):<fpage>457</fpage>–<lpage>472</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1214/ss/1177011136</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>McLean</surname><given-names>CY</given-names></name>, <name><surname>Bristor</surname><given-names>D</given-names></name>, <name><surname>Hiller</surname><given-names>M</given-names></name>, <name><surname>Clarke</surname><given-names>SL</given-names></name>, <name><surname>Schaar</surname><given-names>BT</given-names></name>, <name><surname>Lowe</surname><given-names>CB</given-names></name>, <etal>et al</etal>. <article-title>GREAT improves functional interpretation of cis-regulatory regions</article-title>. <source>Nature Biotechnology</source>. <year>2010</year>;<volume>28</volume>(<issue>5</issue>):<fpage>495</fpage>–<lpage>501</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nbt.1630</pub-id><?supplied-pmid 20436461?><pub-id pub-id-type="pmid">20436461</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Flicek</surname><given-names>P</given-names></name>, <name><surname>Amode</surname><given-names>MR</given-names></name>, <name><surname>Barrell</surname><given-names>D</given-names></name>, <name><surname>Beal</surname><given-names>K</given-names></name>, <name><surname>Brent</surname><given-names>S</given-names></name>, <name><surname>Carvalho-Silva</surname><given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Ensembl 2012</article-title>. <source>Nucleic Acids Research</source>. <year>2012</year>;<volume>40</volume>(<issue>D1</issue>):<fpage>D84</fpage>–<lpage>D90</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkr991</pub-id><?supplied-pmid 22086963?><pub-id pub-id-type="pmid">22086963</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Stelzer</surname><given-names>G</given-names></name>, <name><surname>Rosen</surname><given-names>N</given-names></name>, <name><surname>Plaschkes</surname><given-names>I</given-names></name>, <name><surname>Zimmerman</surname><given-names>S</given-names></name>, <name><surname>Twik</surname><given-names>M</given-names></name>, <name><surname>Fishilevich</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>The GeneCards suite: from gene data mining to disease genome sequence analyses</article-title>. <source>Current Protocols in Bioinformatics</source>. <year>2016</year>;<volume>54</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>30</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1002/cpbi.5</pub-id><?supplied-pmid 27322403?><pub-id pub-id-type="pmid">27322403</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Sollis</surname><given-names>E</given-names></name>, <name><surname>Mosaku</surname><given-names>A</given-names></name>, <name><surname>Abid</surname><given-names>A</given-names></name>, <name><surname>Buniello</surname><given-names>A</given-names></name>, <name><surname>Cerezo</surname><given-names>M</given-names></name>, <name><surname>Gil</surname><given-names>L</given-names></name>, <etal>et al</etal>. <article-title>The NHGRI-EBI GWAS Catalog: knowledgebase and deposition resource</article-title>. <source>Nucleic Acids Research</source>. <year>2023</year>;<volume>51</volume>(<issue>D1</issue>):<fpage>D977</fpage>–<lpage>D985</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkac1010</pub-id><?supplied-pmid 36350656?><pub-id pub-id-type="pmid">36350656</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Thorne</surname><given-names>JL</given-names></name>, <name><surname>Kishino</surname><given-names>H</given-names></name>, <name><surname>Painter</surname><given-names>IS</given-names></name>. <article-title>Estimating the rate of evolution of the rate of molecular evolution</article-title>. <source>Molecular Biology and Evolution</source>. <year>1998</year>;<volume>15</volume>(<issue>12</issue>):<fpage>1647</fpage>–<lpage>1657</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/oxfordjournals.molbev.a025892</pub-id><?supplied-pmid 9866200?><pub-id pub-id-type="pmid">9866200</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Drummond</surname><given-names>AJ</given-names></name>, <name><surname>Ho</surname><given-names>SYW</given-names></name>, <name><surname>Phillips</surname><given-names>MJ</given-names></name>, <name><surname>Rambaut</surname><given-names>A</given-names></name>. <article-title>Relaxed phylogenetics and dating with confidence</article-title>. <source>PLoS Biology</source>. <year>2006</year>;<volume>4</volume>(<issue>5</issue>):<fpage>e88</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pbio.0040088</pub-id><?supplied-pmid 16683862?><pub-id pub-id-type="pmid">16683862</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Drummond</surname><given-names>AJ</given-names></name>, <name><surname>Suchard</surname><given-names>MA</given-names></name>. <article-title>Bayesian random local clocks, or one rate to rule them all</article-title>. <source>BMC Biology</source>. <year>2010</year>;<volume>8</volume>(<issue>114</issue>):<fpage>1</fpage>–<lpage>12</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1741-7007-8-114</pub-id><?supplied-pmid 20807414?><pub-id pub-id-type="pmid">20051105</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Dorman</surname><given-names>JB</given-names></name>, <name><surname>Albinder</surname><given-names>B</given-names></name>, <name><surname>Shroyer</surname><given-names>T</given-names></name>, <name><surname>Kenyon</surname><given-names>C</given-names></name>. <article-title>The age-1 and daf-2 genes function in a common pathway to control the lifespan of Caenorhabditis elegans</article-title>. <source>Genetics</source>. <year>1995</year>;<volume>141</volume>(<issue>4</issue>):<fpage>1399</fpage>–<lpage>1406</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/genetics/141.4.1399</pub-id><?supplied-pmid 8601482?><pub-id pub-id-type="pmid">8601482</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Deelen</surname><given-names>J</given-names></name>, <name><surname>Evans</surname><given-names>DS</given-names></name>, <name><surname>Arking</surname><given-names>DE</given-names></name>, <name><surname>Tesi</surname><given-names>N</given-names></name>, <name><surname>Nygaard</surname><given-names>M</given-names></name>, <name><surname>Liu</surname><given-names>X</given-names></name>, <etal>et al</etal>. <article-title>A meta-analysis of genome-wide association studies identifies multiple longevity genes</article-title>. <source>Nature Communications</source>. <year>2019</year>;<volume>10</volume>(<issue>1</issue>):<fpage>3669</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41467-019-11558-2</pub-id><?supplied-pmid 31413261?><pub-id pub-id-type="pmid">31413261</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Maklakov</surname><given-names>AA</given-names></name>, <name><surname>Immler</surname><given-names>S</given-names></name>. <article-title>The expensive germline and the evolution of ageing</article-title>. <source>Current Biology</source>. <year>2016</year>;<volume>26</volume>(<issue>13</issue>):<fpage>R577</fpage>–<lpage>R586</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.cub.2016.04.012</pub-id><?supplied-pmid 27404253?><pub-id pub-id-type="pmid">27404253</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Muntané</surname><given-names>G</given-names></name>, <name><surname>Farré</surname><given-names>X</given-names></name>, <name><surname>Rodríguez</surname><given-names>JA</given-names></name>, <name><surname>Pegueroles</surname><given-names>C</given-names></name>, <name><surname>Hughes</surname><given-names>DA</given-names></name>, <name><surname>de Magalhaes</surname><given-names>JP</given-names></name>, <etal>et al</etal>. <article-title>Biological processes modulating longevity across primates: a phylogenetic genome-phenome analysis</article-title>. <source>Molecular Biology and Evolution</source>. <year>2018</year>;<volume>35</volume>(<issue>8</issue>):<fpage>1990</fpage>–<lpage>2004</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msy105</pub-id><?supplied-pmid 29788292?><pub-id pub-id-type="pmid">29788292</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Tollis</surname><given-names>M</given-names></name>, <name><surname>Boddy</surname><given-names>AM</given-names></name>, <name><surname>Maley</surname><given-names>CC</given-names></name>. <article-title>Peto’s Paradox: how has evolution solved the problem of cancer prevention?</article-title><source>BMC Biology</source>. <year>2017</year>;<volume>15</volume>(<issue>60</issue>):<fpage>1</fpage>–<lpage>5</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s12915-017-0401-7</pub-id><?supplied-pmid 28705195?><pub-id pub-id-type="pmid">28100223</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Tejada-Martinez</surname><given-names>D</given-names></name>, <name><surname>Avelar</surname><given-names>RA</given-names></name>, <name><surname>Lopes</surname><given-names>I</given-names></name>, <name><surname>Zhang</surname><given-names>B</given-names></name>, <name><surname>Novoa</surname><given-names>G</given-names></name>, <name><surname>De Magalhães</surname><given-names>JP</given-names></name>, <etal>et al</etal>. <article-title>Positive selection and enhancer evolution shaped lifespan and body mass in great apes</article-title>. <source>Molecular Biology and Evolution</source>. <year>2022</year>;<volume>39</volume>(<issue>2</issue>):<fpage>msab369</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msab369</pub-id><?supplied-pmid 34971383?><pub-id pub-id-type="pmid">34971383</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Treaster</surname><given-names>S</given-names></name>, <name><surname>Deelen</surname><given-names>J</given-names></name>, <name><surname>Daane</surname><given-names>JM</given-names></name>, <name><surname>Murabito</surname><given-names>J</given-names></name>, <name><surname>Karasik</surname><given-names>D</given-names></name>, <name><surname>Harris</surname><given-names>MP</given-names></name>. <article-title>Convergent genomics of longevity in rockfishes highlights the genetics of human life span variation</article-title>. <source>Science Advances</source>. <year>2023</year>;<volume>9</volume>(<issue>2</issue>):<fpage>eadd2743</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1126/sciadv.add2743</pub-id><?supplied-pmid 36630509?><pub-id pub-id-type="pmid">36630509</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Kolora</surname><given-names>SRR</given-names></name>, <name><surname>Owens</surname><given-names>GL</given-names></name>, <name><surname>Vazquez</surname><given-names>JM</given-names></name>, <name><surname>Stubbs</surname><given-names>A</given-names></name>, <name><surname>Chatla</surname><given-names>K</given-names></name>, <name><surname>Jainese</surname><given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Origins and evolution of extreme life span in Pacific Ocean rockfishes</article-title>. <source>Science</source>. <year>2021</year>;<volume>374</volume>(<issue>6569</issue>):<fpage>842</fpage>–<lpage>847</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1126/science.abg5332</pub-id><?supplied-pmid 34762458?><pub-id pub-id-type="pmid">34762458</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref045">
      <label>45</label>
      <mixed-citation publication-type="journal"><name><surname>Kirschner</surname><given-names>M</given-names></name>, <name><surname>Gerhart</surname><given-names>J</given-names></name>. <article-title>Evolvability</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>1998</year>;<volume>95</volume>(<issue>15</issue>):<fpage>8420</fpage>–<lpage>8427</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.95.15.8420</pub-id><?supplied-pmid 9671692?><pub-id pub-id-type="pmid">9671692</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref046">
      <label>46</label>
      <mixed-citation publication-type="book"><name><surname>Kirschner</surname><given-names>MW</given-names></name>, <name><surname>Gerhart</surname><given-names>JC</given-names></name>. <source>The plausibility of life: Resolving Darwin’s dilemma</source>. <publisher-name>Yale University Press</publisher-name>; <year>2005</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref047">
      <label>47</label>
      <mixed-citation publication-type="other">NIH National Cancer Institute. Angiogenesis Inhibitors; 2018. <ext-link xlink:href="https://www.cancer.gov/about-cancer/treatment/types/immunotherapy/angiogenesis-inhibitors-fact-sheet" ext-link-type="uri">https://www.cancer.gov/about-cancer/treatment/types/immunotherapy/angiogenesis-inhibitors-fact-sheet</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref048">
      <label>48</label>
      <mixed-citation publication-type="journal"><name><surname>Zhu</surname><given-names>P</given-names></name>, <name><surname>Liu</surname><given-names>W</given-names></name>, <name><surname>Zhang</surname><given-names>X</given-names></name>, <name><surname>Li</surname><given-names>M</given-names></name>, <name><surname>Liu</surname><given-names>G</given-names></name>, <name><surname>Yu</surname><given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>Correlated evolution of social organization and lifespan in mammals</article-title>. <source>Nature Communications</source>. <year>2023</year>;<volume>14</volume>(<issue>1</issue>):<fpage>372</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41467-023-35869-7</pub-id><?supplied-pmid 36720880?><pub-id pub-id-type="pmid">36720880</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref049">
      <label>49</label>
      <mixed-citation publication-type="journal"><name><surname>Fisher</surname><given-names>AA</given-names></name>, <name><surname>Ji</surname><given-names>X</given-names></name>, <name><surname>Nishimura</surname><given-names>A</given-names></name>, <name><surname>Lemey</surname><given-names>P</given-names></name>, <name><surname>Baele</surname><given-names>G</given-names></name>, <name><surname>Suchard</surname><given-names>MA</given-names></name>. <article-title>Shrinkage-based random local clocks with scalable inference</article-title>. <source>Molecular Biology and Evolution</source>. <year>2023</year>;<volume>40</volume>(<issue>11</issue>). <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msad242</pub-id><?supplied-pmid 37950885?><pub-id pub-id-type="pmid">37950885</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1011995.ref050">
      <label>50</label>
      <mixed-citation publication-type="journal"><name><surname>Uyeda</surname><given-names>JC</given-names></name>, <name><surname>Harmon</surname><given-names>LJ</given-names></name>. <article-title>A novel Bayesian method for inferring and interpreting the dynamics of adaptive landscapes from phylogenetic comparative data</article-title>. <source>Systematic Biology</source>. <year>2014</year>;<volume>63</volume>(<issue>6</issue>):<fpage>902</fpage>–<lpage>918</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/sysbio/syu057</pub-id><?supplied-pmid 25077513?><pub-id pub-id-type="pmid">25077513</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
