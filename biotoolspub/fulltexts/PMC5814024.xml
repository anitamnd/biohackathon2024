<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5814024</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0192891</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-17-23856</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Network Analysis</subject>
          <subj-group>
            <subject>Metabolic Networks</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Applied Mathematics</subject>
            <subj-group>
              <subject>Algorithms</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
          <subj-group>
            <subject>Algorithms</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Chemistry</subject>
          <subj-group>
            <subject>Chemical Elements</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Metabolism</subject>
            <subj-group>
              <subject>Metabolic Pathways</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Metabolism</subject>
            <subj-group>
              <subject>Metabolites</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Metabolism</subject>
            <subj-group>
              <subject>Metabolic Processes</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Chemistry</subject>
          <subj-group>
            <subject>Chemical Reactions</subject>
            <subj-group>
              <subject>Reactants</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Metabolism</subject>
            <subj-group>
              <subject>Metabolic Processes</subject>
              <subj-group>
                <subject>Citric Acid Cycle</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>FindPrimaryPairs: An efficient algorithm for predicting element-transferring reactant/product pairs in metabolic networks</article-title>
      <alt-title alt-title-type="running-head">Predicting element-transferring reactant/product pairs in metabolic networks</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Steffensen</surname>
          <given-names>Jon Lund</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <xref ref-type="aff" rid="aff001"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dufault-Thompson</surname>
          <given-names>Keith</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <xref ref-type="aff" rid="aff001"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-8759-0194</contrib-id>
        <name>
          <surname>Zhang</surname>
          <given-names>Ying</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Project administration</role>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="corresp" rid="cor001">*</xref>
        <xref ref-type="aff" rid="aff001"/>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <addr-line>Department of Cell and Molecular Biology, College of the Environment and Life Sciences, University of Rhode Island, Kingston, Rhode Island, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Lespinet</surname>
          <given-names>Olivier</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Universite Paris-Sud, FRANCE</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>yingzhang@uri.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>15</day>
      <month>2</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2018</year>
    </pub-date>
    <volume>13</volume>
    <issue>2</issue>
    <elocation-id>e0192891</elocation-id>
    <history>
      <date date-type="received">
        <day>22</day>
        <month>6</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>1</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2018 Steffensen et al</copyright-statement>
      <copyright-year>2018</copyright-year>
      <copyright-holder>Steffensen et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pone.0192891.pdf"/>
    <abstract>
      <p>The metabolism of individual organisms and biological communities can be viewed as a network of metabolites connected to each other through chemical reactions. In metabolic networks, chemical reactions transform reactants into products, thereby transferring elements between these metabolites. Knowledge of how elements are transferred through reactant/product pairs allows for the identification of primary compound connections through a metabolic network. However, such information is not readily available and is often challenging to obtain for large reaction databases or genome-scale metabolic models. In this study, a new algorithm was developed for automatically predicting the element-transferring reactant/product pairs using the limited information available in the standard representation of metabolic networks. The algorithm demonstrated high efficiency in analyzing large datasets and provided accurate predictions when benchmarked with manually curated data. Applying the algorithm to the visualization of metabolic networks highlighted pathways of primary reactant/product connections and provided an organized view of element-transferring biochemical transformations. The algorithm was implemented as a new function in the open source software package PSAMM in the release v0.30 (<ext-link ext-link-type="uri" xlink:href="https://zhanglab.github.io/psamm/">https://zhanglab.github.io/psamm/</ext-link>).</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000076</institution-id>
            <institution>Directorate for Biological Sciences</institution>
          </institution-wrap>
        </funding-source>
        <award-id>1553211</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-8759-0194</contrib-id>
          <name>
            <surname>Zhang</surname>
            <given-names>Ying</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100005825</institution-id>
            <institution>National Institute of Food and Agriculture</institution>
          </institution-wrap>
        </funding-source>
        <award-id>RI0015-H002, Accession No. 1007170</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-8759-0194</contrib-id>
          <name>
            <surname>Zhang</surname>
            <given-names>Ying</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This research was supported by the National Science Foundation under grant #1553211 and the USDA National Institute of Food and Agriculture, Hatch fund, RI0015-H002, accession #1007170. KDT was supported in part by the National Science Foundation EPSCoR Cooperative Agreement 1655221. Any opinions, findings, and conclusions or recommendations expressed in this material are those of the authors and do not necessarily reflect the views of the funding agency.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="4"/>
      <table-count count="2"/>
      <page-count count="17"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All relevant data and references are within the paper and its Supporting Information files. The software implementation applied in this study is available at the PSAMM open access Git repository, release v0.30: <ext-link ext-link-type="uri" xlink:href="https://zhanglab.github.io/psamm/">https://zhanglab.github.io/psamm/</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All relevant data and references are within the paper and its Supporting Information files. The software implementation applied in this study is available at the PSAMM open access Git repository, release v0.30: <ext-link ext-link-type="uri" xlink:href="https://zhanglab.github.io/psamm/">https://zhanglab.github.io/psamm/</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Metabolism forms the basis for understanding cellular processes in all living organisms. It comprises transformations of metabolites through biochemical reactions and can be viewed as a network graph, where metabolites are represented as individual vertices and reactions are represented as edges connecting the vertices. The reconstruction of metabolic networks can be applied to targeted pathways, species specific genome-scale models (GEMs) [<xref rid="pone.0192891.ref001" ref-type="bibr">1</xref>,<xref rid="pone.0192891.ref002" ref-type="bibr">2</xref>], or to represent an ensemble of metabolic potentials from all organisms [<xref rid="pone.0192891.ref003" ref-type="bibr">3</xref>]. In any case, metabolic reconstructions can quickly result in complex network topologies even for representing individual pathways in the central metabolism. This is due to the presence of multiple reactants and products in typical metabolic reactions, and the existence of hub metabolites (e.g. ATP/ADP, NAD/NADH, quinones, <italic>etc</italic>.) that are involved in a large number of metabolic processes. Deriving biological meaning from these networks, either through visual inspection or by analysis with algorithms, becomes difficult due to these complexities.</p>
    <p>To facilitate the identification of biologically meaningful pathways, algorithms have been developed for reducing the complexity of metabolic network topology [<xref rid="pone.0192891.ref004" ref-type="bibr">4</xref>–<xref rid="pone.0192891.ref009" ref-type="bibr">9</xref>]. For example, the MetDraw algorithm [<xref rid="pone.0192891.ref004" ref-type="bibr">4</xref>] uses a heuristic approach where hub metabolites are identified as vertices having a vertex degree above a user-specified threshold. These hub metabolites usually represent common metabolites, such as energy currency compounds (e.g. ATP/ADP), cofactors, coenzymes, and small molecules (e.g. H<sub>2</sub>O), and they contribute to network complexity by creating links between different metabolic processes. In the MetDraw graph representation, the identified hub metabolites are shown as replicated vertices that associate with different reactions, hence eliminating the cross connections between different metabolic processes. This approach can be useful for providing an approximation of the traditional pathway diagrams, where the primary reactant/product pairs are used for tracing out individual metabolic processes. However, the MetDraw algorithm relies on the arbitrary determination of a degree threshold and is not feasible for visualizing the biosynthesis pathways of hub metabolites. A different approach is taken by other software that visualizes the reactant/product transformations as diagrams based on manual or semi-manual curations (e.g. Escher [<xref rid="pone.0192891.ref010" ref-type="bibr">10</xref>]; Arcadia [<xref rid="pone.0192891.ref011" ref-type="bibr">11</xref>]; Cytoscape [<xref rid="pone.0192891.ref012" ref-type="bibr">12</xref>]; CySBML [<xref rid="pone.0192891.ref013" ref-type="bibr">13</xref>]; ReconMap [<xref rid="pone.0192891.ref014" ref-type="bibr">14</xref>]; OptFlux visualization plugin [<xref rid="pone.0192891.ref015" ref-type="bibr">15</xref>]). These approaches are useful for making customized annotation of reactant/product pairs, but the requirement of extensive manual curations suggests that fully automated approaches are better suited for large-scale networks.</p>
    <p>Examples of extensive manual curations of metabolic pathways are found in the KEGG [<xref rid="pone.0192891.ref003" ref-type="bibr">3</xref>] and the MetaCyc [<xref rid="pone.0192891.ref016" ref-type="bibr">16</xref>] databases, where the pathway diagrams present a simplified view of the pathways by leaving out some of the complexity of the network. The KEGG pathway maps are composed of static images manually constructed by expert curators according to the biochemical understandings of metabolite transformations. These diagrams often highlight the main chemical conversions that are relevant to the conventional understanding of biochemical pathways. However, they overlook the importance of additional metabolites (e.g. the above-mentioned currency compounds) in mediating the flux and directionality of metabolic reactions. In contrast, the pathway diagrams in MetaCyc provide a more detailed view of metabolic reactions that illustrate all participating metabolites. However, these pathway diagrams contain a focused view of individual processes and their global connections to the overall metabolism is frequently missing.</p>
    <p>Identification of element-transferring reactant/product pairs for individual reactions remains as one of the fundamental challenges in detecting biologically meaningful network connections. A number of approaches have been developed for the mapping of reactant/product pairs based on the chemical structures of the metabolites [<xref rid="pone.0192891.ref017" ref-type="bibr">17</xref>–<xref rid="pone.0192891.ref020" ref-type="bibr">20</xref>]. The KEGG RPAIR database identifies element-transferring reactant/product pairs based on the automatic recognition of common metabolite structures and the expert-guided curation of chemical transformation patterns in individual reactions [<xref rid="pone.0192891.ref018" ref-type="bibr">18</xref>,<xref rid="pone.0192891.ref021" ref-type="bibr">21</xref>]. It provides extensive annotations of the reactions in the KEGG database and is by far one of the most extensive reference data set available. The MetaCyc database contains atom-mapping data for many reactions based on analyses of metabolite chemical structures [<xref rid="pone.0192891.ref016" ref-type="bibr">16</xref>,<xref rid="pone.0192891.ref017" ref-type="bibr">17</xref>]. This provides another extensive reference set of element-transferring reactant/product pairs. However, both the KEGG RPAIR and the MetaCyc atom-mapping annotations are restricted to metabolic reactions within their corresponding reaction databases. The application of these existing annotations to new metabolic reconstructions could be challenging as it requires the mapping of new reactions and metabolites, e.g. from expert curated GEMs or from other metabolic databases like ModelSEED [<xref rid="pone.0192891.ref022" ref-type="bibr">22</xref>], to the KEGG and MetaCyc databases, respectively. Such mappings are not always available and are often time consuming to construct.</p>
    <p>So far only a limited number of studies have aimed at addressing the problem of mapping element-transferring reactant/product pairs given only chemical formula information for large reaction sets. The MapMaker algorithm proposed by Tervo and Reed [<xref rid="pone.0192891.ref023" ref-type="bibr">23</xref>] uses a <italic>mixed integer linear programming</italic> (MILP) approach to predict element transfers between reactants and products of individual metabolic reactions. Unlike the KEGG RPAIR and the MetaCyc atom-mapping annotations, MapMaker does not rely on information of metabolite structures but instead only requires the metabolite formulas. While the algorithm can potentially be applied for identifying reactant/product pairs that transfer any elements, the authors mainly focus on the application of the algorithm for predicting carbon-transferring pairs. The authors also created a manually curated set of carbon-transferring reactant/product pairs in the <italic>Escherichia coli</italic> GEM, iJO1366 [<xref rid="pone.0192891.ref001" ref-type="bibr">1</xref>]. This data set serves as an additional reference for evaluating new approaches, with a specific focus on predicting the carbon-transferring reactant/product connections. The MapMaker algorithm is applicable for analyzing any metabolic network with the simple inputs of reaction equations and metabolite formulas. However, it is time consuming to run for large-scale networks or reaction data sets, such as the reaction collection in the KEGG [<xref rid="pone.0192891.ref003" ref-type="bibr">3</xref>] and the MetaCyc [<xref rid="pone.0192891.ref016" ref-type="bibr">16</xref>] databases.</p>
    <p>To solve the problems with existing approaches, this study presents a new algorithm, named <italic>FindPrimaryPairs</italic>, for predicting element-transferring reactant/product pairs with high efficiency and accuracy. This algorithm accounts for the identification of both carbon-transferring and non-carbon transferring metabolite connections, and it was validated with the KEGG RPAIR database [<xref rid="pone.0192891.ref021" ref-type="bibr">21</xref>], the MetaCyc atom-mapping database [<xref rid="pone.0192891.ref016" ref-type="bibr">16</xref>,<xref rid="pone.0192891.ref017" ref-type="bibr">17</xref>], and with manual annotations by Tervo and Reed [<xref rid="pone.0192891.ref023" ref-type="bibr">23</xref>]. For simplification, the term “<italic>primary pairs”</italic> was used in this study to indicate reactant/product pairs that carry elements from the reactant to the product. The algorithm was implemented as a new function in the open source software package PSAMM [<xref rid="pone.0192891.ref024" ref-type="bibr">24</xref>], which was applied to demonstrate primary reactant/product connections in the visualization of central metabolic processes.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Materials and methods</title>
    <sec id="sec003">
      <title><italic>FindPrimaryPairs</italic>: An algorithm for the prediction of primary pairs</title>
      <p>The <italic>FindPrimaryPairs</italic> algorithm was designed to identify primary pairs from any given set of metabolic reactions (e.g. all reactions in a GEM or in any metabolic pathway database). It involves an iterative process of two major steps: (1) the identification of primary pairs for individual reactions based on a scoring function, and (2) the global refinement of a probability distribution estimate that contributes to the formulation of the scoring function. A detailed description of the <italic>FindPrimaryPairs</italic> algorithm is provided below and is illustrated with an example in <xref ref-type="fig" rid="pone.0192891.g001">Fig 1</xref> (See the <xref ref-type="sec" rid="sec009">Results</xref> section for more details).</p>
      <fig id="pone.0192891.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0192891.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Diagram showing an application of the <italic>FindPrimaryPairs</italic> algorithm to a metabolic model.</title>
        </caption>
        <graphic xlink:href="pone.0192891.g001"/>
      </fig>
      <sec id="sec004">
        <title>Step 1: Identify primary pairs for individual reactions</title>
        <p>Given a reaction <italic>R</italic><sub><italic>i</italic></sub>, a primary pair is a pair of interconverting compounds defined based on the procedure below:</p>
        <list list-type="order">
          <list-item>
            <p>Identify (<italic>l</italic><sub>1</sub>, <italic>l</italic><sub>2</sub>, ⋯, <italic>l</italic><sub><italic>s</italic></sub>) and (<italic>r</italic><sub>1</sub>, <italic>r</italic><sub>2</sub>,⋯, <italic>r</italic><sub><italic>t</italic></sub>) as lists of compound instances occurring respectively as reactants and products of reaction <italic>R</italic><sub><italic>i</italic></sub>. These instances were expanded from sets of unique reactants and products based on the stoichiometric value. Let <italic>c</italic>(<italic>x</italic>) of instance <italic>x</italic> be the type of compound it was expanded from. The variables <italic>s</italic> and <italic>t</italic> indicate the number of compound instances on the two sides of the reaction equation.</p>
          </list-item>
          <list-item>
            <p>For every compound pair, (<italic>l</italic><sub><italic>i</italic></sub>, <italic>r</italic><sub><italic>j</italic></sub>) with <italic>i</italic> ∈ (1, 2, ⋯, <italic>s</italic>) and <italic>j</italic> ∈ (1, 2, ⋯, <italic>t</italic>), calculate the weighted Jaccard similarity based on the compound formulas using Eq (<xref ref-type="disp-formula" rid="pone.0192891.e001">1</xref>):
<disp-formula id="pone.0192891.e001"><alternatives><graphic xlink:href="pone.0192891.e001.jpg" id="pone.0192891.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mrow><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mo>∈</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>∙</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mo>∈</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>∙</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>1,2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>1,2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>#</mml:mo></mml:mrow></mml:math></alternatives><label>(1)</label></disp-formula>
where <italic>E</italic> is the set of all elements in <italic>l</italic><sub><italic>i</italic></sub> and <italic>r</italic><sub><italic>j</italic></sub>, <italic>x</italic><sup>(<italic>e</italic>)</sup> is the count of element <italic>e</italic> in compound instance <italic>x</italic> (<italic>x</italic> being either <italic>l</italic><sub><italic>i</italic></sub> or <italic>r</italic><sub><italic>j</italic></sub>), and <italic>W</italic><sub><italic>e</italic></sub> is a weight assigned to each element.</p>
          </list-item>
          <list-item>
            <p>Perform a correction of the Jaccard similarity based on a value, <inline-formula id="pone.0192891.e002"><alternatives><graphic xlink:href="pone.0192891.e002.jpg" id="pone.0192891.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>, which is a point estimate of the distribution <italic>θ</italic><sub><italic>X</italic>,<italic>Y</italic></sub> that models the probability of a compound pair (<italic>X</italic>, <italic>Y</italic>) being a primary pair in any reaction. The corrected score is defined in Eq (<xref ref-type="disp-formula" rid="pone.0192891.e003">2</xref>), where <italic>X</italic> = <italic>c</italic>(<italic>l</italic><sub><italic>i</italic></sub>) and <italic>Y</italic> = <italic>c</italic>(<italic>r</italic><sub><italic>j</italic></sub>):
<disp-formula id="pone.0192891.e003"><alternatives><graphic xlink:href="pone.0192891.e003.jpg" id="pone.0192891.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>∙</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mspace width="0.25em"/><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mspace width="0.25em"/><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>#</mml:mo></mml:mrow></mml:math></alternatives><label>(2)</label></disp-formula></p>
          </list-item>
          <list-item>
            <p>Pick a pair (<italic>l</italic><sub>*</sub>, <italic>r</italic><sub>*</sub>) with the highest <inline-formula id="pone.0192891.e004"><alternatives><graphic xlink:href="pone.0192891.e004.jpg" id="pone.0192891.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> among all pairs, and assign (<italic>X</italic>, <italic>Y</italic>) as a primary pair where <italic>X</italic> = <italic>c</italic>(<italic>l</italic><sub><italic>*</italic></sub>) and <italic>Y</italic> = <italic>c</italic>(<italic>r</italic><sub><italic>*</italic></sub>). The transfer of elements between <italic>X</italic> and <italic>Y</italic> is defined as the count of all elements that are shared between <italic>l</italic><sub>*</sub> and <italic>r</italic><sub>*</sub>.</p>
          </list-item>
          <list-item>
            <p>Update the count of elements in formulas of <italic>l</italic><sub>*</sub> and <italic>r</italic><sub>*</sub> by removing the transferred elements as defined in step 4 from each formula. Repeat steps 2 to 5 with the updated formulas until the transfer of all elements between two sides of the reaction <italic>R</italic><sub><italic>i</italic></sub> has been accounted for in the list of assigned primary pairs.</p>
          </list-item>
        </list>
        <p>The result of the above procedure is a list of predicted primary pairs for the reaction <italic>R</italic><sub><italic>i</italic></sub>. In addition, each primary pair is associated with a formula indicating the predicted counts of elements transferred between the pair. The predicted primary pairs are used to obtain <inline-formula id="pone.0192891.e005"><alternatives><graphic xlink:href="pone.0192891.e005.jpg" id="pone.0192891.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>, which is a point estimate of <italic>θ</italic><sub><italic>X</italic>,<italic>Y</italic></sub>, as defined in the next section.</p>
      </sec>
      <sec id="sec005">
        <title>Step 2: Iterative refinement of <inline-formula id="pone.0192891.e006"><alternatives><graphic xlink:href="pone.0192891.e006.jpg" id="pone.0192891.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula></title>
        <p>Given two compounds, <italic>X</italic> and <italic>Y</italic>, from the two sides of a metabolic reaction, <italic>R</italic><sub><italic>i</italic></sub>, define:
<disp-formula id="pone.0192891.e007"><alternatives><graphic xlink:href="pone.0192891.e007.jpg" id="pone.0192891.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">if</mml:mi><mml:mspace width="0.25em"/><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">is</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">a</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">primary</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">pair</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">in</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">reaction</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">otherwise</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>#</mml:mo></mml:mrow></mml:math></alternatives><label>(3)</label></disp-formula></p>
        <p>Therefore, <inline-formula id="pone.0192891.e008"><alternatives><graphic xlink:href="pone.0192891.e008.jpg" id="pone.0192891.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:msubsup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is an incidence of <italic>M</italic><sub><italic>X</italic>,<italic>Y</italic></sub> observed in the reaction, <italic>R</italic><sub><italic>i</italic></sub>.</p>
        <p>Next, define
<disp-formula id="pone.0192891.e009"><alternatives><graphic xlink:href="pone.0192891.e009.jpg" id="pone.0192891.e009g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M9"><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>#</mml:mo></mml:mrow></mml:math></alternatives><label>(4)</label></disp-formula></p>
        <p>Hence, <italic>θ</italic><sub><italic>X</italic>,<italic>Y</italic></sub> is the probability of <italic>X</italic> and <italic>Y</italic> being primary pairs in any reactions. A beta distribution is used to model <italic>θ</italic><sub><italic>X</italic>,<italic>Y</italic></sub>:
<disp-formula id="pone.0192891.e010"><alternatives><graphic xlink:href="pone.0192891.e010.jpg" id="pone.0192891.e010g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M10"><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>B</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives><label>(5)</label></disp-formula>
where <inline-formula id="pone.0192891.e011"><alternatives><graphic xlink:href="pone.0192891.e011.jpg" id="pone.0192891.e011g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M11"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is estimated with the mode of the beta distribution:
<disp-formula id="pone.0192891.e012"><alternatives><graphic xlink:href="pone.0192891.e012.jpg" id="pone.0192891.e012g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M12"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>#</mml:mo></mml:mrow></mml:math></alternatives><label>(6)</label></disp-formula></p>
        <p>Given a prior distribution, <inline-formula id="pone.0192891.e013"><alternatives><graphic xlink:href="pone.0192891.e013.jpg" id="pone.0192891.e013g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M13"><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, and a prediction of primary pairs, <inline-formula id="pone.0192891.e014"><alternatives><graphic xlink:href="pone.0192891.e014.jpg" id="pone.0192891.e014g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M14"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>⃑</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>, in a set of reactions:
<disp-formula id="pone.0192891.e015"><alternatives><graphic xlink:href="pone.0192891.e015.jpg" id="pone.0192891.e015g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M15"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>∼</mml:mo><mml:mi>B</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="pone.0192891.e016"><alternatives><graphic xlink:href="pone.0192891.e016.jpg" id="pone.0192891.e016g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M16"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>⃑</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></p>
        <p>In the above representation, <italic>N</italic><sub><italic>X</italic>,<italic>Y</italic></sub> is the set of reaction indices that reference reactions with compound <italic>X</italic> on one side and <italic>Y</italic> on the other. Let <italic>n</italic><sub><italic>X</italic>,<italic>Y</italic></sub> be the total number of reactions in <italic>N</italic><sub><italic>X</italic>,<italic>Y</italic></sub>, and let <italic>y</italic><sub><italic>X</italic>,<italic>Y</italic></sub> be the number of instances where <inline-formula id="pone.0192891.e017"><alternatives><graphic xlink:href="pone.0192891.e017.jpg" id="pone.0192891.e017g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M17"><mml:msubsup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>. The value of <italic>y</italic><sub><italic>X</italic>,<italic>Y</italic></sub> can be represented by Eq (<xref ref-type="disp-formula" rid="pone.0192891.e018">7</xref>):
<disp-formula id="pone.0192891.e018"><alternatives><graphic xlink:href="pone.0192891.e018.jpg" id="pone.0192891.e018g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M18"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mstyle><mml:mrow><mml:msubsup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:mo>#</mml:mo></mml:mrow></mml:math></alternatives><label>(7)</label></disp-formula></p>
        <p>The posterior distribution of <italic>θ</italic><sub><italic>X</italic>,<italic>Y</italic></sub> is estimated using the <inline-formula id="pone.0192891.e019"><alternatives><graphic xlink:href="pone.0192891.e019.jpg" id="pone.0192891.e019g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M19"><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0192891.e020"><alternatives><graphic xlink:href="pone.0192891.e020.jpg" id="pone.0192891.e020g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M20"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>⃑</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> based on a binomial distribution model for <italic>y</italic><sub><italic>X</italic>,<italic>Y</italic></sub>:
<disp-formula id="pone.0192891.e021"><alternatives><graphic xlink:href="pone.0192891.e021.jpg" id="pone.0192891.e021g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M21"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>∼</mml:mo><mml:mi>B</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
        <p>Then, a point estimate <inline-formula id="pone.0192891.e022"><alternatives><graphic xlink:href="pone.0192891.e022.jpg" id="pone.0192891.e022g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M22"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is obtained using the mode of <inline-formula id="pone.0192891.e023"><alternatives><graphic xlink:href="pone.0192891.e023.jpg" id="pone.0192891.e023g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M23"><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> following Eq (<xref ref-type="disp-formula" rid="pone.0192891.e012">6</xref>), which corresponds to the <italic>maximum a posteriori</italic> (MAP) estimation.</p>
        <p>The <italic>FindPrimaryPairs</italic> algorithm was applied to reaction sets by iteratively identifying primary pairs in individual reactions followed by a global refinement of the <inline-formula id="pone.0192891.e024"><alternatives><graphic xlink:href="pone.0192891.e024.jpg" id="pone.0192891.e024g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M24"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> parameter according to primary pair predictions on all reactions (<xref ref-type="fig" rid="pone.0192891.g001">Fig 1</xref>). In each iteration, <italic>t</italic>, a MAP estimate of <inline-formula id="pone.0192891.e025"><alternatives><graphic xlink:href="pone.0192891.e025.jpg" id="pone.0192891.e025g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M25"><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> was obtained as described above, an updated assignment of <inline-formula id="pone.0192891.e026"><alternatives><graphic xlink:href="pone.0192891.e026.jpg" id="pone.0192891.e026g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M26"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>⃑</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> was then identified using <inline-formula id="pone.0192891.e027"><alternatives><graphic xlink:href="pone.0192891.e027.jpg" id="pone.0192891.e027g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M27"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> following the analysis of individual reactions, and a new estimate, <inline-formula id="pone.0192891.e028"><alternatives><graphic xlink:href="pone.0192891.e028.jpg" id="pone.0192891.e028g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M28"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, was obtained based on <inline-formula id="pone.0192891.e029"><alternatives><graphic xlink:href="pone.0192891.e029.jpg" id="pone.0192891.e029g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M29"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>⃑</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0192891.e030"><alternatives><graphic xlink:href="pone.0192891.e030.jpg" id="pone.0192891.e030g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M30"><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>. This iterative procedure continued until the point estimate, <inline-formula id="pone.0192891.e031"><alternatives><graphic xlink:href="pone.0192891.e031.jpg" id="pone.0192891.e031g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M31"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>, was stabilized for all compound pairs, as indicated in the following:
<disp-formula id="pone.0192891.e032"><alternatives><graphic xlink:href="pone.0192891.e032.jpg" id="pone.0192891.e032g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M32"><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>|</mml:mo><mml:mo>&lt;</mml:mo><mml:mi>ϵ</mml:mi><mml:mo>#</mml:mo></mml:mrow></mml:math></alternatives><label>(8)</label></disp-formula>
where <inline-formula id="pone.0192891.e033"><alternatives><graphic xlink:href="pone.0192891.e033.jpg" id="pone.0192891.e033g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M33"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0192891.e034"><alternatives><graphic xlink:href="pone.0192891.e034.jpg" id="pone.0192891.e034g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M34"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> were point estimates of the posterior distributions from two successive iterations, and <italic>ϵ</italic> was a number close to zero (e.g. <italic>ϵ</italic> = 10<sup>−5</sup>). For the first iteration, the value of <inline-formula id="pone.0192891.e035"><alternatives><graphic xlink:href="pone.0192891.e035.jpg" id="pone.0192891.e035g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M35"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> was set to 1. An example of applying the <italic>FindPrimaryPairs</italic> algorithm is illustrated in <xref ref-type="fig" rid="pone.0192891.g001">Fig 1</xref> and described in the Results section.</p>
      </sec>
    </sec>
    <sec id="sec006">
      <title>Parameter optimization</title>
      <p>Optimized parameters of the <italic>FindPrimaryPairs</italic> procedure, including the weights of individual elements (<italic>W</italic><sub><italic>e</italic></sub>) and the prior parameters of the beta distribution (<italic>α</italic><sup>(<italic>prior</italic>)</sup> and <italic>β</italic><sup>(<italic>prior</italic>)</sup>), were identified based on analyzing the reactions in the KEGG database (Release 70.1). The RPAIR annotation for each reaction of the KEGG database was used to evaluate the prediction of both carbon-transferring and non-carbon transferring primary pairs. A confusion matrix was established for evaluating the predictions. The Matthews Correlation Coefficient (MCC) was used to measure the accuracy of predictions and was calculated as shown in Eq (<xref ref-type="disp-formula" rid="pone.0192891.e036">9</xref>), where the number of true positive (TP), false positive (FP), true negative (TN), and false negative (FN) pairs were obtained from the confusion matrix.</p>
      <disp-formula id="pone.0192891.e036">
        <alternatives>
          <graphic xlink:href="pone.0192891.e036.jpg" id="pone.0192891.e036g" mimetype="image" position="anchor" orientation="portrait"/>
          <mml:math id="M36">
            <mml:mrow>
              <mml:mi>M</mml:mi>
              <mml:mi>C</mml:mi>
              <mml:mi>C</mml:mi>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mi>T</mml:mi>
                  <mml:mi>P</mml:mi>
                  <mml:mo>∙</mml:mo>
                  <mml:mi>T</mml:mi>
                  <mml:mi>N</mml:mi>
                  <mml:mo>−</mml:mo>
                  <mml:mi>F</mml:mi>
                  <mml:mi>P</mml:mi>
                  <mml:mo>∙</mml:mo>
                  <mml:mi>F</mml:mi>
                  <mml:mi>N</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:msqrt>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mi>T</mml:mi>
                      <mml:mi>P</mml:mi>
                      <mml:mo>+</mml:mo>
                      <mml:mi>F</mml:mi>
                      <mml:mi>P</mml:mi>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mi>T</mml:mi>
                      <mml:mi>P</mml:mi>
                      <mml:mo>+</mml:mo>
                      <mml:mi>F</mml:mi>
                      <mml:mi>N</mml:mi>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mi>T</mml:mi>
                      <mml:mi>N</mml:mi>
                      <mml:mo>+</mml:mo>
                      <mml:mi>F</mml:mi>
                      <mml:mi>P</mml:mi>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mi>T</mml:mi>
                      <mml:mi>N</mml:mi>
                      <mml:mo>+</mml:mo>
                      <mml:mi>F</mml:mi>
                      <mml:mi>N</mml:mi>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:msqrt>
                </mml:mrow>
              </mml:mfrac>
              <mml:mo>#</mml:mo>
            </mml:mrow>
          </mml:math>
        </alternatives>
        <label>(9)</label>
      </disp-formula>
      <p>The weights of individual elements (<italic>W</italic><sub><italic>e</italic></sub>) were assigned with the consideration that carbon elements form the backbone of organic molecules and hence a similar number of carbon elements would indicate that two molecules are likely to be structurally similar. The hydrogen elements, in contrast, are peripheral to the molecule structure and are therefore less likely to predict structural similarity. Given this rationale, each carbon element was assigned a weight of 1, each hydrogen element was assigned a weight of 0, and all other elements (such as nitrogen, oxygen, phosphorus, etc.) were assigned a weight (<italic>W</italic><sub><italic>other</italic></sub>) between these two extremes. A grid search was performed using the RPAIR annotations of the KEGG database as a reference dataset to identify the optimal values of parameters <italic>α</italic><sup>(<italic>prior</italic>)</sup>, <italic>β</italic><sup>(<italic>prior</italic>)</sup>, and <italic>W</italic><sub><italic>other</italic></sub>. The range of <italic>W</italic><sub><italic>other</italic></sub> was assigned to decimal numbers between 0 and 1, with 51 steps of constant increments of 0.02, and the ranges of <italic>α</italic><sup>(<italic>prior</italic>)</sup> and <italic>β</italic><sup>(<italic>prior</italic>)</sup> were assigned to integers between 1 and 50. For each grid point, a confusion matrix was mapped based on the reference dataset and the parameters that resulted in the maximum MCC value were selected.</p>
      <p>The primary pair prediction was applied to analyze metabolic reactions in the MetaCyc database and in a complete GEM, iJO1366, of the organism <italic>E</italic>. <italic>coli</italic>. The prediction was evaluated through the calculation of MCC values as defined in Eq (<xref ref-type="disp-formula" rid="pone.0192891.e036">9</xref>), where the confusion matrix was constructed by comparing the primary pair predictions to the reference reactant/product pairs in the reference datasets [<xref rid="pone.0192891.ref016" ref-type="bibr">16</xref>,<xref rid="pone.0192891.ref023" ref-type="bibr">23</xref>]. Synthetic reactions like the biomass reactions were not considered in the evaluation because they represent artificial formulations of cellular processes. Since the iJO1366 reference data set included only pairs that transfer carbon, only primary pairs that were predicted to transfer at least one carbon element were compared to this dataset. In contrast, the comparison to the MetaCyc atom-mapping data considered all primary pairs.</p>
    </sec>
    <sec id="sec007">
      <title>Software implementation</title>
      <p>The <italic>FindPrimaryPairs</italic> algorithm was implemented as a function in the open source PSAMM software [<xref rid="pone.0192891.ref024" ref-type="bibr">24</xref>] and can be applied for analyzing GEMs or any given set of biochemical reactions. This function can be accessed with the “primarypairs” procedure of the “psamm-model” command by specifying the option “—method = fpp”. The new “primarypairs” procedure were made available from release v0.30 of PSAMM at <ext-link ext-link-type="uri" xlink:href="https://zhanglab.github.io/psamm/">https://zhanglab.github.io/psamm/</ext-link>.</p>
      <p>As a comparison, an implementation of the <italic>MapMaker</italic> algorithm [<xref rid="pone.0192891.ref023" ref-type="bibr">23</xref>] was also included in the “primarypairs” procedure and can be accessed using the option “—method = mapmaker”. The <italic>MapMaker</italic> method relies on solving an MILP problem implemented on the linear programming solver framework of PSAMM. Multiple solvers, including the IBM ILOG CPLEX Optimizer, the Gurobi Optimizer, and the GNU Linear Programming Kit (GLPK), are compatible with this procedure. Specifically, in this study the <italic>MapMaker</italic> operations were performed using the CPLEX solver version 12.6.3.</p>
    </sec>
    <sec id="sec008">
      <title>Visualization of a subnetwork of a genome-scale model</title>
      <p>Metabolic networks analyzed in this study were visualized using a representation of bipartite graphs, where two sets of vertices were used to represent the compounds and reactions, respectively, and directed edges between the compound vertices and the reaction vertices were used to indicate the interconversion of compounds through reactions. Only carbon-containing compounds were included in the network visualization, and two different strategies were applied in the formulation of the network graphs. In a first strategy, each reaction vertex was represented only once in the graph and was associated with all carbon-containing reactants and products of the reaction. In a second strategy, reaction vertices were replicated to represent the connections within subsets of carbon-transferring reactant/product pairs identified based on the primary pair predictions. The visualization of pathway graphs was created in Cytoscape version 3.4.0 [<xref rid="pone.0192891.ref012" ref-type="bibr">12</xref>]. The compounds and reactions in conventional representation of the TCA cycle were laid out in a circular view and were presented with the same positioning of compound vertices. The remaining vertices in the graph were laid out using the spring-embedded approach in Cytoscape [<xref rid="pone.0192891.ref012" ref-type="bibr">12</xref>].</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec009">
    <title>Results</title>
    <sec id="sec010">
      <title>Application of the <italic>FindPrimaryPairs</italic> algorithm</title>
      <p><xref ref-type="fig" rid="pone.0192891.g001">Fig 1</xref> illustrates the application of the <italic>FindPrimaryPairs</italic> algorithm to the <italic>E</italic>. <italic>coli</italic> GEM, iJO1366 [<xref rid="pone.0192891.ref001" ref-type="bibr">1</xref>]. The algorithm follows an iterative process with the correction coefficient <inline-formula id="pone.0192891.e037"><alternatives><graphic xlink:href="pone.0192891.e037.jpg" id="pone.0192891.e037g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M37"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> updated in every iteration until convergence (Materials and Methods). The two main steps of the iterative procedure are represented in the two gray boxes in <xref ref-type="fig" rid="pone.0192891.g001">Fig 1</xref>. The upper box demonstrates the identification of primary pairs from individual reactions, showing an example of the glucose kinase reaction, HEX1. The bottom box demonstrates the estimation of <inline-formula id="pone.0192891.e038"><alternatives><graphic xlink:href="pone.0192891.e038.jpg" id="pone.0192891.e038g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M38"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> from <inline-formula id="pone.0192891.e039"><alternatives><graphic xlink:href="pone.0192891.e039.jpg" id="pone.0192891.e039g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M39"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and the formulation of a beta distribution, using an example of the reactant/product pair, ATP and ADP, and their primary pair assignments among all reactions of iJO1366.</p>
      <p>The initial coefficient, <inline-formula id="pone.0192891.e040"><alternatives><graphic xlink:href="pone.0192891.e040.jpg" id="pone.0192891.e040g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M40"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, was set to a fixed value of 1 in the implementation of the <italic>FindPrimaryPairs</italic> algorithm. This value was used for predicting the initial primary pair assignments, <inline-formula id="pone.0192891.e041"><alternatives><graphic xlink:href="pone.0192891.e041.jpg" id="pone.0192891.e041g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M41"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>⃑</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, in all reactions, and the <inline-formula id="pone.0192891.e042"><alternatives><graphic xlink:href="pone.0192891.e042.jpg" id="pone.0192891.e042g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M42"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>⃑</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> in turn determined the estimate, <inline-formula id="pone.0192891.e043"><alternatives><graphic xlink:href="pone.0192891.e043.jpg" id="pone.0192891.e043g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M43"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, for the next iteration (Materials and Methods). Values in the upper gray box of <xref ref-type="fig" rid="pone.0192891.g001">Fig 1</xref> show an example of the calculations made with <inline-formula id="pone.0192891.e044"><alternatives><graphic xlink:href="pone.0192891.e044.jpg" id="pone.0192891.e044g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M44"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, for identifying primary pairs in the reaction, HEX1, and the lower gray box shows an example of obtaining an updated estimate, <inline-formula id="pone.0192891.e045"><alternatives><graphic xlink:href="pone.0192891.e045.jpg" id="pone.0192891.e045g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M45"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, based on the ATP–ADP pairing in all reactions of the iJO1366 model. Primary pairs in the reaction HEX1 were identified based on a five-step procedure described in Materials and Methods, which resulted in the assignment of four primary pairs that accounted for all element transfers from reactants to productions of the reaction (<xref ref-type="fig" rid="pone.0192891.g001">Fig 1</xref>, blue boxes). The same procedure was applied to each individual reaction in the iJO1366 model, and then the collection of all primary pairs from all reactions was used for determining <inline-formula id="pone.0192891.e046"><alternatives><graphic xlink:href="pone.0192891.e046.jpg" id="pone.0192891.e046g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M46"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> for every compound pair that was present in the model (<xref ref-type="fig" rid="pone.0192891.g001">Fig 1</xref>, purple box). The iterative procedure continued until the value <inline-formula id="pone.0192891.e047"><alternatives><graphic xlink:href="pone.0192891.e047.jpg" id="pone.0192891.e047g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M47"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> converged for every compound pair in the model (Materials and Methods).</p>
    </sec>
    <sec id="sec011">
      <title>Grid search and selection of optimal parameters</title>
      <p>A grid search was performed for assigning the three parameters used in the <italic>FindPrimaryPairs</italic> procedure, including the weight of non-carbon, non-hydrogen elements (<italic>W</italic><sub><italic>other</italic></sub>), and the values of prior parameters, <italic>α</italic><sup>(<italic>prior</italic>)</sup> and <italic>β</italic><sup>(<italic>prior</italic>)</sup> (Materials and Methods). <xref ref-type="fig" rid="pone.0192891.g002">Fig 2</xref> provides snapshots of the grid search results, where each panel presents grids of two parameters at the optimal setup of a third parameter. The MCC values were used in grid search for identifying optimal parameters, and the KEGG RPAIR database [<xref rid="pone.0192891.ref018" ref-type="bibr">18</xref>,<xref rid="pone.0192891.ref021" ref-type="bibr">21</xref>] was used as a reference for evaluating the primary pair predictions (Materials and Methods).</p>
      <fig id="pone.0192891.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0192891.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Heatmaps demonstrating pairwise relationships of the parameters, <italic>W</italic><sub>other</sub>, <italic>α</italic><sup>(<italic>prior</italic>)</sup>, and <italic>β</italic><sup>(<italic>prior</italic>)</sup>, from a grid search of optimal values based on the RPAIR annotations of the KEGG database.</title>
          <p>The MCC values are shown with color coding at each step of the varying parameters (see the color legend on the upper right panel). The maximum MCC is marked with a black outline in each heatmap panel and labeled with its numeric value. In each heatmap, a selected parameter was fixed at its optimum (indicated in the title of each panel) and the remaining two parameters were varied within a given range of the grid search (x-axis and y-axis).</p>
        </caption>
        <graphic xlink:href="pone.0192891.g002"/>
      </fig>
      <p>The reference annotations used in the grid search analysis included 7569 biochemical reactions and 21174 reactant/product pairs that account for the chemical transformation of metabolites in the reactions. This reference dataset was created from the KEGG reaction database by eliminating unspecified reaction entries: First, 1380 reactions were skipped from the parsing of compound formulas because they involve compounds (549 out of 7827 compounds in the KEGG database) that could not be processed due to the lack of formula annotation, a variable number of elements in the formula, or a dot notation in the formula indicating complex chemical compositions. Second, 479 reactions were not considered because they have unbalanced non-hydrogen elements on the two sides of the reaction equations. Finally, 242 reactions were removed either because they are missing from the RPAIR annotation (55 reactions) or they involve at least one carbon-containing compound for which a pair is not identified in the RPAIR annotations (187 reactions).</p>
      <p>According to the grid search, the MCC values were close to or higher than 0.9 within the tested range of all parameters (Materials and Methods). This indicated consistency of the <italic>FindPrimaryPairs</italic> procedure in predicting primary pairs even with varying parameter values. In other words, the choice of parameter values within the range had no significant influence on the final predictions. In searching for the optimal parameters, the MCC values appeared to decline slightly when the weight of non-carbon, non-hydrogen elements (<italic>W</italic><sub>other</sub>) was above 0.88 or below 0.18, suggesting that an intermediate weight was favored for these elements. The optimal MCC was reached when <italic>α</italic><sup>(<italic>prior</italic>)</sup> approached 1. However, when both <italic>α</italic><sup>(<italic>prior</italic>)</sup> and <italic>β</italic><sup>(<italic>prior</italic>)</sup> were set to 1 so that the beta distribution model of <italic>θ</italic><sub><italic>X</italic>,<italic>Y</italic></sub> became a uniform distribution, the MCC value was lowest regardless of the setting of <italic>W</italic><sub><italic>other</italic></sub> (<xref ref-type="fig" rid="pone.0192891.g002">Fig 2</xref>, lower right panel). As a result, the grid search identified an optimal MCC value of 0.929 when the parameters <italic>α</italic><sup>(<italic>prior</italic>)</sup>, <italic>β</italic><sup>(<italic>prior</italic>)</sup>, and <italic>W</italic><sub><italic>other</italic></sub>, respectively, approached 1, 43, and 0.82 (<xref ref-type="table" rid="pone.0192891.t001">Table 1</xref>). These optimal parameters were applied in the implementation of the <italic>FindPrimaryPairs</italic> procedure and were used as the default parameters for our studies in the following sections.</p>
      <table-wrap id="pone.0192891.t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0192891.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Parameter values applied in the default implementation of <italic>FindPrimaryPairs</italic>.</title>
          <p>The weight assignments of carbon (<italic>W</italic><sub><italic>C</italic></sub>) and hydrogen (<italic>W</italic><sub><italic>H</italic></sub>) elements were determined based on the design of the algorithm. The weight assignment of other elements <italic>W</italic><sub><italic>other</italic></sub>, and the prior parameters <italic>α</italic><sup>(<italic>prior</italic>)</sup> and <italic>β</italic><sup>(<italic>prior</italic>)</sup> were determined based on a grid search of optimal parameters using the KEGG RPAIR annotations as reference data.</p>
        </caption>
        <alternatives>
          <graphic id="pone.0192891.t001g" xlink:href="pone.0192891.t001"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" rowspan="1" colspan="1">Parameter</th>
                <th align="center" rowspan="1" colspan="1">Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1">
                  <italic>W</italic>
                  <sub>
                    <italic>C</italic>
                  </sub>
                </td>
                <td align="center" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">
                  <italic>W</italic>
                  <sub>
                    <italic>H</italic>
                  </sub>
                </td>
                <td align="center" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">
                  <italic>W</italic>
                  <sub>
                    <italic>other</italic>
                  </sub>
                </td>
                <td align="center" rowspan="1" colspan="1">0.82</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">
                  <italic>α</italic>
                  <sup>(<italic>prior</italic>)</sup>
                </td>
                <td align="center" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">
                  <italic>β</italic>
                  <sup>(<italic>prior</italic>)</sup>
                </td>
                <td align="center" rowspan="1" colspan="1">43</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
    </sec>
    <sec id="sec012">
      <title>Comparing <italic>FindPrimaryPairs</italic> with <italic>MapMaker</italic> algorithms</title>
      <p>The <italic>FindPrimaryPairs</italic> algorithm was further evaluated through a comparison with the <italic>MapMaker</italic> algorithm [<xref rid="pone.0192891.ref023" ref-type="bibr">23</xref>]. To achieve this, an implementation of both algorithms was constructed and applied to three reference datasets for evaluating the accuracy and efficiency of primary pair predictions (Materials and Methods). The first dataset included manually curated carbon-transferring reactant/product pairs of 2150 reactions in a complete GEM, iJO1366 [<xref rid="pone.0192891.ref023" ref-type="bibr">23</xref>]. The second dataset included both carbon-transferring and non-carbon transferring reactant/product pairs of the 7569 KEGG reactions annotated in the KEGG RPAIR database [<xref rid="pone.0192891.ref018" ref-type="bibr">18</xref>,<xref rid="pone.0192891.ref021" ref-type="bibr">21</xref>]. The third data set contained both carbon-transferring and non-carbon transferring reactant/product pairs of the 8452 MetaCyc reactions that had available atom mappings [<xref rid="pone.0192891.ref016" ref-type="bibr">16</xref>,<xref rid="pone.0192891.ref017" ref-type="bibr">17</xref>].</p>
      <p>While both algorithms produced highly accurate predictions, <italic>FindPrimaryPairs</italic> achieved higher MCC values than the <italic>MapMaker</italic> algorithm when predicting primary pairs in all three reference datasets (<xref ref-type="table" rid="pone.0192891.t002">Table 2</xref>). Of the 3688 carbon-transferring reactant/product pairs annotated in iJO1366, over 98% (3626 pairs) were successfully identified by the <italic>FindPrimaryPairs</italic> algorithm, while a slightly smaller fraction (3591 pairs; 97%) were correctly identified by the <italic>MapMaker</italic> algorithm. Of the 21174 reactant/product pairs in the KEGG RPAIR annotation, over 97% (20591 pairs) were correctly predicted by <italic>FindPrimaryPairs</italic>, while less than 95% (20113 pairs) were correctly predicted by <italic>MapMaker</italic>. Of the 23345 reactant/product pairs in the MetaCyc dataset, around 96% (22400 pairs) were correctly predicted by <italic>FindPrimaryPairs</italic>, while approximately 94% (21977 pairs) were correctly predicted by <italic>MapMaker</italic>. The numbers of false positive and false negative predictions generated by <italic>FindPrimaryPairs</italic> were also reduced as compared to the predictions generated by the <italic>MapMaker</italic> algorithm (<xref ref-type="table" rid="pone.0192891.t002">Table 2</xref>). Hence, a combination of higher true positives and lower false predictions contributed to the improved accuracy of the <italic>FindPrimaryPairs</italic> algorithm.</p>
      <table-wrap id="pone.0192891.t002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0192891.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>Comparing the accuracy and efficiency of <italic>FindPrimaryPairs</italic> and <italic>MapMaker</italic> algorithms using annotations in the iJO1366, the KEGG RPAIR database, and the MetaCyc atom-mapping data.</title>
          <p>The MCC values were calculated according to descriptions in Materials and Methods, and the running time (seconds) was calculated based on the average time cost in seven independent runs of each algorithm on each reference set. TP–true positive; FP–false positive; FN–false negative; TN–true negative.</p>
        </caption>
        <alternatives>
          <graphic id="pone.0192891.t002g" xlink:href="pone.0192891.t002"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Dataset</th>
                <th align="left" rowspan="1" colspan="1">Method</th>
                <th align="left" rowspan="1" colspan="1">TP</th>
                <th align="left" rowspan="1" colspan="1">FP</th>
                <th align="left" rowspan="1" colspan="1">FN</th>
                <th align="left" rowspan="1" colspan="1">TN</th>
                <th align="left" rowspan="1" colspan="1">MCC</th>
                <th align="center" rowspan="1" colspan="1">Time (seconds)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="2" colspan="1">
                  <bold>iJO1366</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>
                    <italic>FindPrimaryPairs</italic>
                  </bold>
                </td>
                <td align="right" rowspan="1" colspan="1">3626</td>
                <td align="right" rowspan="1" colspan="1">60</td>
                <td align="right" rowspan="1" colspan="1">62</td>
                <td align="right" rowspan="1" colspan="1">1577</td>
                <td align="right" rowspan="1" colspan="1">0.946</td>
                <td align="right" rowspan="1" colspan="1">13.9</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>
                    <italic>MapMaker</italic>
                  </bold>
                </td>
                <td align="right" rowspan="1" colspan="1">3591</td>
                <td align="right" rowspan="1" colspan="1">90</td>
                <td align="right" rowspan="1" colspan="1">97</td>
                <td align="right" rowspan="1" colspan="1">1547</td>
                <td align="right" rowspan="1" colspan="1">0.918</td>
                <td align="right" rowspan="1" colspan="1">70.9</td>
              </tr>
              <tr>
                <td align="left" rowspan="2" colspan="1">
                  <bold>KEGG</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>
                    <italic>FindPrimaryPairs</italic>
                  </bold>
                </td>
                <td align="right" rowspan="1" colspan="1">20591</td>
                <td align="right" rowspan="1" colspan="1">804</td>
                <td align="right" rowspan="1" colspan="1">583</td>
                <td align="right" rowspan="1" colspan="1">17214</td>
                <td align="right" rowspan="1" colspan="1">0.929</td>
                <td align="right" rowspan="1" colspan="1">52.4</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>
                    <italic>MapMaker</italic>
                  </bold>
                </td>
                <td align="right" rowspan="1" colspan="1">20113</td>
                <td align="right" rowspan="1" colspan="1">1286</td>
                <td align="right" rowspan="1" colspan="1">1061</td>
                <td align="right" rowspan="1" colspan="1">16732</td>
                <td align="right" rowspan="1" colspan="1">0.879</td>
                <td align="right" rowspan="1" colspan="1">264.6</td>
              </tr>
              <tr>
                <td align="left" rowspan="2" colspan="1">
                  <bold>MetaCyc</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>
                    <italic>FindPrimaryPairs</italic>
                  </bold>
                </td>
                <td align="right" rowspan="1" colspan="1">22400</td>
                <td align="right" rowspan="1" colspan="1">1544</td>
                <td align="right" rowspan="1" colspan="1">945</td>
                <td align="right" rowspan="1" colspan="1">24248</td>
                <td align="right" rowspan="1" colspan="1">0.899</td>
                <td align="right" rowspan="1" colspan="1">76.1</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>
                    <italic>MapMaker</italic>
                  </bold>
                </td>
                <td align="right" rowspan="1" colspan="1">21977</td>
                <td align="right" rowspan="1" colspan="1">1970</td>
                <td align="right" rowspan="1" colspan="1">1368</td>
                <td align="right" rowspan="1" colspan="1">23822</td>
                <td align="right" rowspan="1" colspan="1">0.864</td>
                <td align="right" rowspan="1" colspan="1">316.3</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>The <italic>FindPrimaryPairs</italic> approach also demonstrated significant improvement of running efficiency (<xref ref-type="table" rid="pone.0192891.t002">Table 2</xref>), with an average running time of 13.9 seconds for processing the 2150 reactions in the iJO1366 GEM, 52.4 seconds for processing the 7569 reactions in the KEGG database, and 76.1 seconds for processing the 8452 reactions in the MetaCyc database. In contrast, it took the <italic>MapMaker</italic> approach at least four times longer to process the reactions in all three datasets.</p>
    </sec>
    <sec id="sec013">
      <title>Using <italic>FindPrimaryPairs</italic> predictions for visualizing metabolic subnetworks</title>
      <p>The <italic>FindPrimaryPairs</italic> algorithm was applied to reduce the complexity of network graphs. In <xref ref-type="fig" rid="pone.0192891.g003">Fig 3</xref>, a prediction of carbon-transferring compound pairs was applied for visualizing a subnetwork that represents the citric acid cycle (TCA cycle) and its metabolic contexts in a GEM, iJO1366 [<xref rid="pone.0192891.ref001" ref-type="bibr">1</xref>]. The subnetwork was constructed by first selecting nine main compounds that participate in the conventional representation of the TCA cycle (<xref ref-type="supplementary-material" rid="pone.0192891.s001">S1 Table</xref>) and then including additional reactions (<xref ref-type="supplementary-material" rid="pone.0192891.s002">S2 Table</xref>) and compounds (<xref ref-type="supplementary-material" rid="pone.0192891.s001">S1 Table</xref>) that are directly associated with these initial compounds. Visualization of the subnetwork was achieved with bipartite graph representations using two different strategies (Materials and Methods), which was demonstrated with an example of a single reaction (<xref ref-type="fig" rid="pone.0192891.g003">Fig 3A and 3B</xref>) as well as the entire subnetwork (<xref ref-type="fig" rid="pone.0192891.g003">Fig 3C and 3D</xref>).</p>
      <fig id="pone.0192891.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0192891.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <p>Bipartite graph representation of AKGDH (panels a and b) and a subnetwork (panels c and d) of the GEM, iJO1366. The panels a) and c) were represented using a conventional bipartite graph, where each reaction was shown as a single vertex connected with all compounds involved in the reaction. The panels b) and d) were similarly represented as bipartite graphs but converted reaction nodes to multiple vertices to highlight different primary pairs that carried out independent element transfers, e.g. as indicated with green dotted lines in panel b, where labels represent the predicted (no parentheses) or the annotated (in parentheses) element transfers. Unless specified, in all panels reaction nodes were shown as blue rectangles, compound nodes were shown as orange ovals, and the edge directions were assigned based on the annotation of reaction directions in the model. The edges with higher width indicated connections in the conventional representation of the TCA cycle, and the edges in red (panel c) represented independent primary pairs that would be isolated from the main element flow in the primary pair graph. The bordered compound nodes in red (panel d) highlighted network features visible in the primary pairs graph. Reaction abbreviations: AKGDH–2-Oxogluterate dehydrogenase; PPCK–Phosphoenolpyruvate carboxykinase; SUCOAS–Succinyl-CoA synthetase; FE3DCITabcpp–Iron transport from ferric-dicitrate via ABC system; ICL–Isocitrate lyase; MALS–Malate synthase. Compound abbreviations: akg–2-oxoglutarate; coa–coenzyme A; succoa–Succinyl-CoA; co2–Carbon dioxide; nad–Nicotinamide adenine dinucleotide; nadh–Reduced nicotinamide adenine dinucleotide; adp–Adenosine 5'-diphosphate; atp–Adenosine 5'-triphosphate; icit–Isocitrate; glx–Glyoxylate; mal-L–L-Malate; succ–Succinate; accoa–Acetyl-CoA. The suffix [c] indicated compounds located in the cytosol, and the suffix [p] indicated compounds located in the periplasm.</p>
        </caption>
        <graphic xlink:href="pone.0192891.g003"/>
      </fig>
      <p>A case study of the 2-Oxogluterate dehydrogenase reaction, AKGDH, was used to demonstrate differences in conventional bipartite graph representation (<xref ref-type="fig" rid="pone.0192891.g003">Fig 3A</xref>) as compared to the representation guided by primary pairs (<xref ref-type="fig" rid="pone.0192891.g003">Fig 3B</xref>). In the conventional bipartite graph, all participating compounds of a reaction were connected to the reaction vertex with directed edges. In contrast, subsets of compounds were identified in the primary pairs graph, and each subset was associated with an independent instance of the reaction vertex. In the AKGDH reaction, four primary pairs were identified using the <italic>FindPrimaryPairs</italic> algorithm (indicated with green dotted edges in <xref ref-type="fig" rid="pone.0192891.g003">Fig 3B</xref>), and each pair represented specific element transfers through the reaction (green labels in <xref ref-type="fig" rid="pone.0192891.g003">Fig 3B</xref>). The formulation of primary pair graph for AKGDH identified that the connection within one primary pair, NAD–NADH, was independent from other primary pairs, and hence it was associated with another instance of the reaction vertex. Therefore, the primary pairs graph effectively separated the representation of currency compounds (NAD and NADH) from the representation of element transfers among the substrates and products of a biochemical reaction.</p>
      <p>The representation of a subnetwork associated with the TCA cycle was also constructed to demonstrate the application of primary pairs in visualizing complex connections from the central metabolism to other metabolic processes. In the conventional bipartite graph (<xref ref-type="fig" rid="pone.0192891.g003">Fig 3C</xref>), a large number of edges were directed across the center of the TCA cycle, reflecting the complex connections among different components of the subnetwork. This complexity was significantly reduced in the primary pairs graph (<xref ref-type="fig" rid="pone.0192891.g003">Fig 3D</xref>), where the connections between primary pathway compounds were isolated from the connections between currency compounds, such as ATP and ADP (<xref ref-type="fig" rid="pone.0192891.g003">Fig 3D</xref>, inset). Several additional features emerge from the primary pairs graph. For example, the compound 2-oxoglutarate (akg) was identified as an important hub to the downstream metabolic processes via connections to L-Glutamate (glu-L), which is a precursor of many biosynthesis pathways. The glyoxylate shunt was also more visible in the primary pair graph (<xref ref-type="fig" rid="pone.0192891.g003">Fig 3D</xref>). Hence, the visualization of primary pairs enhanced the biological interpretation of complex metabolic networks.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec014">
    <title>Discussion</title>
    <p>The complexity of metabolic networks prevents the identification of biologically meaningful features in the graph representation of metabolic transformations. Among various challenges the lack of accurate and efficient approach for detecting element-transferring reactant/product pairs is hindering the simplification of complex network topology. In this research, the new algorithm <italic>FindPrimaryPairs</italic> has been developed to perform automated prediction of primary pairs that carry out chemical transformation and element transfers in biochemical reactions. An implementation of the algorithm has been evaluated with the curated classifications of carbon-transferring pairs in a GEM, iJO1366 [<xref rid="pone.0192891.ref001" ref-type="bibr">1</xref>], and with the KEGG RPAIR and MetaCyc atom-mapping annotations that provide a global mapping of all element-transferring reactant/product pairs in biochemical reactions [<xref rid="pone.0192891.ref016" ref-type="bibr">16</xref>–<xref rid="pone.0192891.ref018" ref-type="bibr">18</xref>,<xref rid="pone.0192891.ref021" ref-type="bibr">21</xref>] Results from the evaluations have shown that <italic>FindPrimaryPairs</italic> achieved slightly better predictions than an existing algorithm, <italic>MapMaker</italic>, as indicated by their MCC values in mapping to reference datasets (<xref ref-type="table" rid="pone.0192891.t002">Table 2</xref>). It is worth mentioning that the higher mapping accuracy is attributed not only to an increase in the number of true positive mappings but also to a reduction of false predictions by the <italic>FindPrimaryPairs</italic> algorithm. On all three reference datasets, the running time of <italic>FindPrimaryPairs</italic> has been reduced by at least four folds as compared to <italic>MapMaker</italic>. Additionally, the efficiency of the <italic>FindPrimaryPairs</italic> implementation could be further optimized by allowing parallel processing of independent reaction entries within each iteration of the global optimization (<xref ref-type="fig" rid="pone.0192891.g001">Fig 1</xref>).</p>
    <p>While <italic>FindPrimaryPairs</italic> demonstrated enhanced accuracy and efficiency, it has some limitations similar to the <italic>MapMaker</italic> algorithm. First, both approaches rely on examining the similarity of metabolite formulas and would fail when reactant/product pairs of the highest formula similarity do not correspond to the biochemical mechanism of a reaction. For example, the Transaldolase reaction in iJO1366, TALA, transfers a dihydroxyacetone moiety from sedoheptulose 7-phosphate (s7p) to glyceraldehyde 3-phosphate (g3p), forming the products erythrose 4-phosphate (e4p) and fructose 6-phosphate (f6p). From the comparison of metabolite formulas, it appears that s7p should be paired with f6p and g3p be paired with e4p, but from analyzing the biochemical mechanism, a correct mapping of the reactant/product pairs should couple s7p with e4p, and g3p with f6p. Hence, the formula-based approach fails when a chemical transfer occurs between two substrates of similar element compositions, e.g. in the case of TALA, both substrates s7p and g3p are phosphorylated carbohydrates. However, these special case studies are not a major part of metabolic reaction databases. Since metabolite formulas are more readily available in metabolic databases than the interpretation of biochemical mechanisms, the formula-based approach represented by <italic>FindPrimaryPairs</italic> and <italic>MapMaker</italic> still provides significant advantage in analyzing large-scale metabolic networks.</p>
    <p>Another problem that <italic>FindPrimaryPairs</italic> and <italic>MapMaker</italic> have in common comes from the possibility of having multiple optimal predictions of the primary pairs in a reaction. In the <italic>MapMaker</italic> algorithm, prediction of primary pairs is dependent on finding the solution of an MILP problem, which can result in multiple optimal solutions that lead to different pairings of the reactants and products. Only one solution can match the true mechanism of element transfer in a reaction, but the algorithmic design is not guaranteed to provide the correct solution in the presence of multiple solutions. Similarly, in the <italic>FindPrimaryPairs</italic> algorithm, multiple reactant/product pairs may have the same scores in comparing similarities of their formulas. Which pair is selected from the tie of scores may ultimately determine which one of the distinct predictions is reported. By default, ties of the highest similarity scores were broken in the PSAMM <italic>FindPrimaryPairs</italic> implementation by sorting the highest scoring pairs by metabolite names and selecting the first pair in the sorted list. This provides a way to consistently arrive at the same result when the <italic>FindPrimaryPairs</italic> algorithm is applied, but resolving the underlying issue of multiple equivalent solutions still requires manual curations.</p>
    <p>To evaluate the extent by which <italic>FindPrimaryPairs</italic> and <italic>MapMaker</italic> are influenced by these uncertainties in their algorithmic design, extensive sampling was performed on the implementation of both algorithms to count the number of reactions for which an arbitrary decision could have been made (<xref ref-type="fig" rid="pone.0192891.g004">Fig 4</xref>). The results revealed both algorithms produce ambiguous primary pair predictions for a small subset of reactions in all three reference databases, iJO1366 [<xref rid="pone.0192891.ref001" ref-type="bibr">1</xref>], KEGG [<xref rid="pone.0192891.ref018" ref-type="bibr">18</xref>,<xref rid="pone.0192891.ref021" ref-type="bibr">21</xref>] and MetaCyc [<xref rid="pone.0192891.ref016" ref-type="bibr">16</xref>,<xref rid="pone.0192891.ref017" ref-type="bibr">17</xref>], which contain 2150, 7569, and 8452 reactions, respectively. Compared to the <italic>MapMaker</italic> algorithm, <italic>FindPrimaryPairs</italic> demonstrated reduced level of ambiguity (<xref ref-type="fig" rid="pone.0192891.g004">Fig 4</xref>). This was largely due to the iterative refinement of reactant/product similarity scores based on the global assignment of primary pairs. It is worth mentioning that the measurements of uncertainty in <xref ref-type="fig" rid="pone.0192891.g004">Fig 4</xref> reflected an upper bound of prediction ambiguity for the <italic>FindPrimaryPairs</italic> algorithm, because all reactions that had ties in top scores of metabolites similarly were counted as ambiguous, while not all ties would result in different prediction of primary pairs. For example, if a reaction has two reactants, A and B, and two products, C and D, a tie could occur in the top scores of two potential pairs: A–C and B–D. However, because these pairs do not represent a different mapping of reactants and products, the tie has no influence on the primary pair prediction. In contrast, in <xref ref-type="fig" rid="pone.0192891.g004">Fig 4</xref> the number of ambiguous cases counted for the <italic>MapMaker</italic> algorithm reflected a true evaluation of reactions that had different primary pair predictions in the sampling. Hence, the <italic>FindPrimaryPairs</italic> algorithm provides a more stable approach that produces consistent predictions for a higher fraction of reactions in the reference databases than the <italic>MapMaker</italic> algorithm.</p>
    <fig id="pone.0192891.g004" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0192891.g004</object-id>
      <label>Fig 4</label>
      <caption>
        <title>Bar chart showing the number of ambiguous reactions in the MetaCyc, KEGG, and iJO1366 reference datasets, where the two algorithms, <italic>FindPrimaryPairs</italic> and <italic>MapMaker</italic>, would potentially make arbitrary predictions of primary pairs.</title>
        <p>For <italic>FindPrimaryPairs</italic>, the reactions were counted for which the algorithm encountered ties on the top scoring reactant/product pairs in the last iteration of the primary pair assignment. For <italic>MapMaker</italic>, the reactions were counted for which the MILP solver would provide more than one optimal solutions that result in different primary pair predictions.</p>
      </caption>
      <graphic xlink:href="pone.0192891.g004"/>
    </fig>
    <p>The identification of primary pairs is useful for visualizing metabolic subnetworks of complete GEMs (<xref ref-type="fig" rid="pone.0192891.g003">Fig 3</xref>). Compared to a conventional bipartite graph representation, the primary pairs graph has advantages in revealing primary substrate/product connections and identifying biologically meaningful network features. While previous studies rely on either the arbitrary identification of hub metabolites using compound vertices degrees [<xref rid="pone.0192891.ref004" ref-type="bibr">4</xref>] or the manual curation of individual metabolic pathways [<xref rid="pone.0192891.ref010" ref-type="bibr">10</xref>–<xref rid="pone.0192891.ref015" ref-type="bibr">15</xref>], The <italic>FindPrimaryPairs</italic> approach is both fully automated and avoids the drawback of making arbitrary decisions on the cutoff of vertices degrees in identifying hub metabolites. Further, it also permits the visualization of chemical transformations across different metabolic processes in the global metabolism. The primary pairs graph can be used on its own or combined with other graph layout algorithms, such as the grid layouts proposed by [<xref rid="pone.0192891.ref025" ref-type="bibr">25</xref>] and [<xref rid="pone.0192891.ref026" ref-type="bibr">26</xref>], to further reduce visual clutters in complex metabolic networks. Since the predictions provided by <italic>FindPrimaryPairs</italic> also include transfers of elements other than carbon, it can be applied to visually explore the flow of any other biologically important elements, such as nitrogen, phosphorus or sulfur, in the global metabolic processes.</p>
  </sec>
  <sec sec-type="supplementary-material" id="sec015">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pone.0192891.s001">
      <label>S1 Table</label>
      <caption>
        <title>List of compounds included in the graph representation of a subnetwork in iJO1366.</title>
        <p>The column "TCA_cycle" indicates the nine main compounds that participate in the conventional representation of the citric acid cycle (labeled with "Yes").</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0192891.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0192891.s002">
      <label>S2 Table</label>
      <caption>
        <title>List of reactions included in the graph representation of a subnetwork in iJO1366.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0192891.s002.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We thank Zachary Pimentel for comments and suggestions for the paper.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0192891.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Orth</surname><given-names>JD</given-names></name>, <name><surname>Conrad</surname><given-names>TM</given-names></name>, <name><surname>Na</surname><given-names>J</given-names></name>, <name><surname>Lerman</surname><given-names>JA</given-names></name>, <name><surname>Nam</surname><given-names>H</given-names></name>, <name><surname>Feist</surname><given-names>AM</given-names></name>, <etal>et al</etal><article-title>A comprehensive genome-scale reconstruction of Escherichia coli metabolism—2011</article-title>. <source>Mol Syst Biol</source>. <year>2011</year>;<volume>7</volume>: <fpage>535</fpage><comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/msb.2011.65">10.1038/msb.2011.65</ext-link></comment><?supplied-pmid 21988831?><pub-id pub-id-type="pmid">21988831</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0192891.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Dufault-Thompson</surname><given-names>K</given-names></name>, <name><surname>Jian</surname><given-names>H</given-names></name>, <name><surname>Cheng</surname><given-names>R</given-names></name>, <name><surname>Li</surname><given-names>J</given-names></name>, <name><surname>Wang</surname><given-names>F</given-names></name>, <name><surname>Zhang</surname><given-names>Y</given-names></name>. <article-title>A Genome-Scale Model of Shewanella piezotolerans Simulates Mechanisms of Metabolic Diversity and Energy Conservation</article-title>. <source>mSystems</source>. <year>2017</year>;<volume>2</volume>: <fpage>1</fpage>–<lpage>17</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1128/mSystems.00165-16">10.1128/mSystems.00165-16</ext-link></comment><?supplied-pmid 28382331?><pub-id pub-id-type="pmid">28382331</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0192891.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Kanehisa</surname><given-names>M</given-names></name>, <name><surname>Goto</surname><given-names>S</given-names></name>. <article-title>KEGG: kyoto encyclopedia of genes and genomes</article-title>. <source>Nucleic Acids Res</source>. <year>2000</year>;<volume>28</volume>: <fpage>27</fpage>–<lpage>30</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/28.1.27">10.1093/nar/28.1.27</ext-link></comment><?supplied-pmid 10592173?><pub-id pub-id-type="pmid">10592173</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0192891.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Jensen</surname><given-names>PA</given-names></name>, <name><surname>Papin</surname><given-names>JA</given-names></name>. <article-title>MetDraw: automated visualization of genome-scale metabolic network reconstructions and high-throughput data</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>: <fpage>1327</fpage>–<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btt758">10.1093/bioinformatics/btt758</ext-link></comment><?supplied-pmid 24413519?><pub-id pub-id-type="pmid">24413519</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0192891.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Bourqui</surname><given-names>R</given-names></name>, <name><surname>Cottret</surname><given-names>L</given-names></name>, <name><surname>Lacroix</surname><given-names>V</given-names></name>, <name><surname>Auber</surname><given-names>D</given-names></name>, <name><surname>Mary</surname><given-names>P</given-names></name>, <name><surname>Sagot</surname><given-names>M-F</given-names></name>, <etal>et al</etal><article-title>Metabolic network visualization eliminating node redundance and preserving metabolic pathways</article-title>. <source>BMC Syst Biol</source>. <year>2007</year>;<volume>1</volume>: <fpage>29</fpage><comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1752-0509-1-29">10.1186/1752-0509-1-29</ext-link></comment><?supplied-pmid 17608928?><pub-id pub-id-type="pmid">17608928</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0192891.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Planes</surname><given-names>FJ</given-names></name>, <name><surname>Beasley</surname><given-names>JE</given-names></name>. <article-title>Path finding approaches and metabolic pathways</article-title>. <source>Discret Appl Math</source>. <year>2009</year>;<volume>157</volume>: <fpage>2244</fpage>–<lpage>2256</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.dam.2008.06.035">10.1016/j.dam.2008.06.035</ext-link></comment></mixed-citation>
    </ref>
    <ref id="pone.0192891.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Pey</surname><given-names>J</given-names></name>, <name><surname>Planes</surname><given-names>FJ</given-names></name>, <name><surname>Beasley</surname><given-names>JE</given-names></name>. <article-title>Refining carbon flux paths using atomic trace data</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>: <fpage>975</fpage>–<lpage>980</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btt653">10.1093/bioinformatics/btt653</ext-link></comment><?supplied-pmid 24273244?><pub-id pub-id-type="pmid">24273244</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0192891.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Croes</surname><given-names>D</given-names></name>, <name><surname>Couche</surname><given-names>F</given-names></name>, <name><surname>Wodak</surname><given-names>SJ</given-names></name>, <name><surname>van Helden</surname><given-names>J</given-names></name>. <article-title>Inferring meaningful pathways in weighted metabolic networks</article-title>. <source>J Mol Biol</source>. <year>2006</year>;<volume>356</volume>: <fpage>222</fpage>–<lpage>36</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jmb.2005.09.079">10.1016/j.jmb.2005.09.079</ext-link></comment><?supplied-pmid 16337962?><pub-id pub-id-type="pmid">16337962</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0192891.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>McShan</surname><given-names>DC</given-names></name>, <name><surname>Rao</surname><given-names>S</given-names></name>, <name><surname>Shah</surname><given-names>I</given-names></name>. <article-title>PathMiner: predicting metabolic pathways by heuristic search</article-title>. <source>Bioinformatics</source>. <year>2003</year>;<volume>19</volume>: <fpage>1692</fpage>–<lpage>1698</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btg217">10.1093/bioinformatics/btg217</ext-link></comment><?supplied-pmid 12967966?><pub-id pub-id-type="pmid">12967966</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0192891.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>King</surname><given-names>ZA</given-names></name>, <name><surname>Dräger</surname><given-names>A</given-names></name>, <name><surname>Ebrahim</surname><given-names>A</given-names></name>, <name><surname>Sonnenschein</surname><given-names>N</given-names></name>, <name><surname>Lewis</surname><given-names>NE</given-names></name>, <name><surname>Palsson</surname><given-names>BO</given-names></name>. <article-title>Escher: A Web Application for Building, Sharing, and Embedding Data-Rich Visualizations of Biological Pathways</article-title>. <source>PLoS Comput Biol</source>. <year>2015</year>;<volume>11</volume>: <fpage>e1004321</fpage><comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1004321">10.1371/journal.pcbi.1004321</ext-link></comment><?supplied-pmid 26313928?><pub-id pub-id-type="pmid">26313928</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0192891.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Villéger</surname><given-names>AC</given-names></name>, <name><surname>Pettifer</surname><given-names>SR</given-names></name>, <name><surname>Kell</surname><given-names>DB</given-names></name>. <article-title>Arcadia: a visualization tool for metabolic pathways</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>: <fpage>1470</fpage>–<lpage>1471</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btq154">10.1093/bioinformatics/btq154</ext-link></comment><?supplied-pmid 20453003?><pub-id pub-id-type="pmid">20453003</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0192891.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Shannon</surname><given-names>P</given-names></name>, <name><surname>Markiel</surname><given-names>A</given-names></name>, <name><surname>Ozier</surname><given-names>O</given-names></name>, <name><surname>Baliga</surname><given-names>NS</given-names></name>, <name><surname>Wang</surname><given-names>JT</given-names></name>, <name><surname>Ramage</surname><given-names>D</given-names></name>, <etal>et al</etal><article-title>Cytoscape: a software environment for integrated models of biomolecular interaction networks</article-title>. <source>Genome Res</source>. <year>2003</year>;<volume>13</volume>: <fpage>2498</fpage>–<lpage>504</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/gr.1239303">10.1101/gr.1239303</ext-link></comment><?supplied-pmid 14597658?><pub-id pub-id-type="pmid">14597658</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0192891.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>König</surname><given-names>M</given-names></name>, <name><surname>Dräger</surname><given-names>A</given-names></name>, <name><surname>Holzhütter</surname><given-names>HG</given-names></name>. <article-title>CySBML: A cytoscape plugin for SBML</article-title>. <source>Bioinformatics</source>. <year>2012</year>;<volume>28</volume>: <fpage>2402</fpage>–<lpage>2403</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/bts432">10.1093/bioinformatics/bts432</ext-link></comment><?supplied-pmid 22772946?><pub-id pub-id-type="pmid">22772946</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0192891.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Noronha</surname><given-names>A</given-names></name>, <name><surname>Danielsdóttir</surname><given-names>AD</given-names></name>, <name><surname>Jóhannsson</surname><given-names>F</given-names></name>, <name><surname>Jónsdóttir</surname><given-names>S</given-names></name>, <name><surname>Jarlsson</surname><given-names>S</given-names></name>, <name><surname>Gunnarsson</surname><given-names>JP</given-names></name>, <etal>et al</etal><article-title>ReconMap: An interactive visualisation of human metabolism</article-title>. <source>Bioinformatics</source>. <year>2017</year>;<volume>33</volume>: <fpage>605</fpage>–<lpage>607</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btw667">10.1093/bioinformatics/btw667</ext-link></comment><?supplied-pmid 27993782?><pub-id pub-id-type="pmid">27993782</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0192891.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Noronha</surname><given-names>A</given-names></name>, <name><surname>Vilaça</surname><given-names>P</given-names></name>, <name><surname>Rocha</surname><given-names>M</given-names></name>. <article-title>An integrated network visualization framework towards metabolic engineering applications</article-title>. <source>BMC Bioinformatics</source>. <year>2014</year>;<volume>15</volume>: <fpage>420</fpage><comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/s12859-014-0420-0">10.1186/s12859-014-0420-0</ext-link></comment><?supplied-pmid 25547011?><pub-id pub-id-type="pmid">25547011</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0192891.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Caspi</surname><given-names>R</given-names></name>, <name><surname>Billington</surname><given-names>R</given-names></name>, <name><surname>Ferrer</surname><given-names>L</given-names></name>, <name><surname>Foerster</surname><given-names>H</given-names></name>, <name><surname>Fulcher</surname><given-names>CA</given-names></name>, <name><surname>Keseler</surname><given-names>IM</given-names></name>, <etal>et al</etal><article-title>The MetaCyc database of metabolic pathways and enzymes and the BioCyc collection of pathway/genome databases</article-title>. <source>Nucleic Acids Res</source>. <year>2016</year>;<volume>44</volume>: <fpage>D471</fpage>—<lpage>D480</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkv1164">10.1093/nar/gkv1164</ext-link></comment><?supplied-pmid 26527732?><pub-id pub-id-type="pmid">26527732</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0192891.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Latendresse</surname><given-names>M</given-names></name>, <name><surname>Malerich</surname><given-names>JP</given-names></name>, <name><surname>Travers</surname><given-names>M</given-names></name>, <name><surname>Karp</surname><given-names>PD</given-names></name>. <article-title>Accurate atom-mapping computation for biochemical reactions</article-title>. <source>J Chem Inf Model</source>. <year>2012</year>;<volume>52</volume>: <fpage>2970</fpage>–<lpage>2982</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1021/ci3002217">10.1021/ci3002217</ext-link></comment><?supplied-pmid 22963657?><pub-id pub-id-type="pmid">22963657</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0192891.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Yamada</surname><given-names>T</given-names></name>, <name><surname>Hattori</surname><given-names>M</given-names></name>, <name><surname>Oh</surname><given-names>MA</given-names></name>, <name><surname>Goto</surname><given-names>S</given-names></name>, <name><surname>Kanehisa</surname><given-names>M</given-names></name>. <article-title>RPAIR: A Database of Chemical Transformation Patterns in Enzymatic Reactions</article-title>. <source>Genome Informatics</source>. <year>2005</year>; Available: <ext-link ext-link-type="uri" xlink:href="http://www.jsbi.org/pdfs/journal1/GIW05/GIW05P021.pdf">http://www.jsbi.org/pdfs/journal1/GIW05/GIW05P021.pdf</ext-link></mixed-citation>
    </ref>
    <ref id="pone.0192891.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Fooshee</surname><given-names>D</given-names></name>, <name><surname>Andronico</surname><given-names>A</given-names></name>, <name><surname>Baldi</surname><given-names>P</given-names></name>. <article-title>ReactionMap: An efficient atom-mapping algorithm for chemical reactions</article-title>. <source>J Chem Inf Model</source>. <year>2013</year>;<volume>53</volume>: <fpage>2812</fpage>–<lpage>2819</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1021/ci400326p">10.1021/ci400326p</ext-link></comment><?supplied-pmid 24160861?><pub-id pub-id-type="pmid">24160861</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0192891.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Heinonen</surname><given-names>M</given-names></name>, <name><surname>Lappalainen</surname><given-names>S</given-names></name>, <name><surname>Mielikäinen</surname><given-names>T</given-names></name>, <name><surname>Rousu</surname><given-names>J</given-names></name>. <article-title>Computing Atom Mappings for Biochemical Reactions without Subgraph Isomorphism</article-title>. <source>J Comput Biol</source>. <year>2011</year>;<volume>18</volume>: <fpage>43</fpage>–<lpage>58</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1089/cmb.2009.0216">10.1089/cmb.2009.0216</ext-link></comment><?supplied-pmid 21210731?><pub-id pub-id-type="pmid">21210731</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0192891.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Kanehisa</surname><given-names>M</given-names></name>, <name><surname>Goto</surname><given-names>S</given-names></name>, <name><surname>Hattori</surname><given-names>M</given-names></name>, <name><surname>Aoki-Kinoshita</surname><given-names>K</given-names></name>, <name><surname>Itoh</surname><given-names>M</given-names></name>, <name><surname>Kawashima</surname><given-names>S</given-names></name>, <etal>et al</etal><article-title>From genomics to chemical genomics: new developments in KEGG</article-title>. <source>Nucleic Acids Res</source>. <year>2006</year>;<volume>34</volume>: <fpage>D354</fpage>–<lpage>D357</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkj102">10.1093/nar/gkj102</ext-link></comment><?supplied-pmid 16381885?><pub-id pub-id-type="pmid">16381885</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0192891.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Henry</surname><given-names>CS</given-names></name>, <name><surname>DeJongh</surname><given-names>M</given-names></name>, <name><surname>Best</surname><given-names>A a</given-names></name>, <name><surname>Frybarger</surname><given-names>PM</given-names></name>, <name><surname>Linsay</surname><given-names>B</given-names></name>, <name><surname>Stevens</surname><given-names>RL</given-names></name>. <article-title>High-throughput generation, optimization and analysis of genome-scale metabolic models</article-title>. <source>Nat Biotechnol</source>. <year>2010</year>;<volume>28</volume>: <fpage>977</fpage>–<lpage>82</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nbt.1672">10.1038/nbt.1672</ext-link></comment><?supplied-pmid 20802497?><pub-id pub-id-type="pmid">20802497</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0192891.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Tervo</surname><given-names>CJ</given-names></name>, <name><surname>Reed</surname><given-names>JL</given-names></name>. <article-title>MapMaker and PathTracer for tracking carbon in genome-scale metabolic models</article-title>. <source>Biotechnol J</source>. <year>2016</year>; <fpage>1</fpage>–<lpage>23</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0192891.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Steffensen</surname><given-names>JL</given-names></name>, <name><surname>Dufault-Thompson</surname><given-names>K</given-names></name>, <name><surname>Zhang</surname><given-names>Y</given-names></name>. <article-title>PSAMM: A Portable System for the Analysis of Metabolic Models</article-title>. <source>PLOS Comput Biol</source>. <year>2016</year>;<volume>12</volume>: <fpage>e1004732</fpage><comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1004732">10.1371/journal.pcbi.1004732</ext-link></comment><?supplied-pmid 26828591?><pub-id pub-id-type="pmid">26828591</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0192891.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>W</given-names></name>, <name><surname>Kurata</surname><given-names>H</given-names></name>. <article-title>A grid layout algorithm for automatic drawing of biochemical networks</article-title>. <source>Bioinformatics</source>. <year>2005</year>;<volume>21</volume>: <fpage>2036</fpage>–<lpage>2042</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/bti290">10.1093/bioinformatics/bti290</ext-link></comment><?supplied-pmid 15677705?><pub-id pub-id-type="pmid">15677705</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0192891.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>He</surname><given-names>S</given-names></name>, <name><surname>Mei</surname><given-names>J</given-names></name>, <name><surname>Shi</surname><given-names>G</given-names></name>, <name><surname>Wang</surname><given-names>Z</given-names></name>, <name><surname>Li</surname><given-names>W</given-names></name>. <article-title>LucidDraw: efficiently visualizing complex biochemical networks within MATLAB</article-title>. <source>BMC Bioinformatics</source>. <year>2010</year>;<volume>11</volume>: <fpage>31</fpage><comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1471-2105-11-31">10.1186/1471-2105-11-31</ext-link></comment><?supplied-pmid 20074382?><pub-id pub-id-type="pmid">20074382</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
