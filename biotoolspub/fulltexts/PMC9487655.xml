<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Brief Bioinform</journal-id>
    <journal-id journal-id-type="iso-abbrev">Brief Bioinform</journal-id>
    <journal-id journal-id-type="publisher-id">bib</journal-id>
    <journal-title-group>
      <journal-title>Briefings in Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1467-5463</issn>
    <issn pub-type="epub">1477-4054</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9487655</article-id>
    <article-id pub-id-type="pmid">35998893</article-id>
    <article-id pub-id-type="doi">10.1093/bib/bbac324</article-id>
    <article-id pub-id-type="publisher-id">bbac324</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Problem Solving Protocol</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CellDrift: inferring perturbation responses in temporally sampled single-cell data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-5638-040X</contrib-id>
        <name>
          <surname>Jin</surname>
          <given-names>Kang</given-names>
        </name>
        <!--Kang.Jin@cchmc.org-->
        <aff><institution>Division of Biomedical Informatics, Cincinnati Children’s Hospital Medical Center</institution>, Cincinnati, OH 45229, <country country="US">USA</country></aff>
        <aff><institution>Department of Biomedical Informatics, University of Cincinnati</institution>, Cincinnati, OH 45229, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Schnell</surname>
          <given-names>Daniel</given-names>
        </name>
        <!--Daniel.Schnell@cchmc.org-->
        <aff><institution>Division of Biomedical Informatics, Cincinnati Children’s Hospital Medical Center</institution>, Cincinnati, OH 45229, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-0628-2454</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Guangyuan</given-names>
        </name>
        <!--li2g2@mail.uc.edu-->
        <aff><institution>Division of Biomedical Informatics, Cincinnati Children’s Hospital Medical Center</institution>, Cincinnati, OH 45229, <country country="US">USA</country></aff>
        <aff><institution>Department of Biomedical Informatics, University of Cincinnati</institution>, Cincinnati, OH 45229, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-9689-2469</contrib-id>
        <name>
          <surname>Salomonis</surname>
          <given-names>Nathan</given-names>
        </name>
        <!--Nathan.Salomonis@cchmc.org-->
        <aff><institution>Division of Biomedical Informatics, Cincinnati Children’s Hospital Medical Center</institution>, Cincinnati, OH 45229, <country country="US">USA</country></aff>
        <aff><institution>Department of Biomedical Informatics, University of Cincinnati</institution>, Cincinnati, OH 45229, <country country="US">USA</country></aff>
        <aff><institution>Department of Pediatrics, University of Cincinnati School of Medicine</institution>, Cincinnati, OH 45256, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Prasath</surname>
          <given-names>V B Surya</given-names>
        </name>
        <!--surya.prasath@cchmc.org-->
        <aff><institution>Division of Biomedical Informatics, Cincinnati Children’s Hospital Medical Center</institution>, Cincinnati, OH 45229, <country country="US">USA</country></aff>
        <aff><institution>Department of Biomedical Informatics, University of Cincinnati</institution>, Cincinnati, OH 45229, <country country="US">USA</country></aff>
        <aff><institution>Department of Electrical Engineering and Computer Science, University of Cincinnati</institution>, OH 45256, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Szczesniak</surname>
          <given-names>Rhonda</given-names>
        </name>
        <!--Rhonda.Szczesniak@cchmc.org-->
        <aff><institution>Division of Biostatistics and Epidemiology, Cincinnati Children’s Hospital Medical Center</institution>, OH 45229, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-5109-6514</contrib-id>
        <name>
          <surname>Aronow</surname>
          <given-names>Bruce J</given-names>
        </name>
        <!--bruce.aronow@cchmc.org-->
        <aff><institution>Division of Biomedical Informatics, Cincinnati Children’s Hospital Medical Center</institution>, Cincinnati, OH 45229, <country country="US">USA</country></aff>
        <aff><institution>Department of Biomedical Informatics, University of Cincinnati</institution>, Cincinnati, OH 45229, <country country="US">USA</country></aff>
        <aff><institution>Department of Pediatrics, University of Cincinnati School of Medicine</institution>, Cincinnati, OH 45256, <country country="US">USA</country></aff>
        <aff><institution>Department of Electrical Engineering and Computer Science, University of Cincinnati</institution>, OH 45256, <country country="US">USA</country></aff>
        <xref rid="cor1" ref-type="corresp"/>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="cor1">Corresponding author. Bruce J. Aronow, Division of Biomedical Informatics, Cincinnati Children's Hospital Medical Center, Cincinnati, OH 45229, USA. Tel.: 513-636-4865; E-mail: <email>bruce.aronow@cchmc.org</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>9</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-08-23">
      <day>23</day>
      <month>8</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>23</day>
      <month>8</month>
      <year>2022</year>
    </pub-date>
    <volume>23</volume>
    <issue>5</issue>
    <elocation-id>bbac324</elocation-id>
    <history>
      <date date-type="received">
        <day>19</day>
        <month>4</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>27</day>
        <month>6</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>7</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">https://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="bbac324.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Cells and tissues respond to perturbations in multiple ways that can be sensitively reflected in the alterations of gene expression. Current approaches to finding and quantifying the effects of perturbations on cell-level responses over time disregard the temporal consistency of identifiable gene programs. To leverage the occurrence of these patterns for perturbation analyses, we developed CellDrift (<ext-link xlink:href="https://github.com/KANG-BIOINFO/CellDrift" ext-link-type="uri">https://github.com/KANG-BIOINFO/CellDrift</ext-link>), a generalized linear model-based functional data analysis method that is capable of identifying covarying temporal patterns of various cell types in response to perturbations. As compared to several other approaches, CellDrift demonstrated superior performance in the identification of temporally varied perturbation patterns and the ability to impute missing time points. We applied CellDrift to multiple longitudinal datasets, including COVID-19 disease progression and gastrointestinal tract development, and demonstrated its ability to identify specific gene programs associated with sequential biological processes, trajectories and outcomes.</p>
    </abstract>
    <kwd-group>
      <kwd>single-cell RNA sequencing</kwd>
      <kwd>perturbation effects</kwd>
      <kwd>temporal patterns</kwd>
      <kwd>functional data analysis</kwd>
      <kwd>generalized linear model</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>HL148865</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Digestive Health Center</institution>
          </institution-wrap>
        </funding-source>
        <award-id>DK078392</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Cooperative Reprogrammed Cell Research Program</institution>
          </institution-wrap>
        </funding-source>
        <award-id>MH104172</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Center of Excellence in Molecular Hematology</institution>
          </institution-wrap>
        </funding-source>
        <award-id>DK126108</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="11"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="sec3">
    <title>Introduction</title>
    <p>Single-cell transcriptomics sequencing has revolutionized discoveries in complex biological systems by identifying a wide variety of cell populations in high resolution [<xref rid="ref1" ref-type="bibr">1–3</xref>]. Researchers have applied the technology in experiments with perturbation settings, such as diseases [<xref rid="ref4" ref-type="bibr">4</xref>, <xref rid="ref5" ref-type="bibr">5</xref>], treatments [<xref rid="ref6" ref-type="bibr">6</xref>, <xref rid="ref7" ref-type="bibr">7</xref>], genetic mutations [<xref rid="ref7" ref-type="bibr">7</xref>, <xref rid="ref8" ref-type="bibr">8</xref>] and organ differentiation [<xref rid="ref9" ref-type="bibr">9</xref>, <xref rid="ref10" ref-type="bibr">10</xref>], to explore transcriptional profiles across various biochemical states.</p>
    <p>However, the response to perturbation can vary over time, which is overlooked in many single-cell studies. Nowadays, researchers are increasingly considering the impact of time when designing experiments. For example, the genetic effects of autism risk genes have been studied during the development of the nervous system using brain organoids [<xref rid="ref11" ref-type="bibr">11</xref>, <xref rid="ref12" ref-type="bibr">12</xref>]. Additionally, influenza vaccination effects have been evaluated by monitoring immune responses over multiple follow-up periods [<xref rid="ref13" ref-type="bibr">13</xref>]. Moreover, the impact of infections, such as human immunodeficiency virus (HIV), has been studied in patients at varying stages of their illness [<xref rid="ref14" ref-type="bibr">14</xref>, <xref rid="ref15" ref-type="bibr">15</xref>]. By having access to single-cell profiles over time, researchers can accurately report perturbation effects during treatment procedures, disease progression and organ development.</p>
    <p>There have been various approaches introduced to quantify transcriptional changes in single-cell ribonucleic acid (RNA)-seq (scRNA-seq) data from perturbation experiments [<xref rid="ref16" ref-type="bibr">16</xref>] (<xref rid="TB1" ref-type="table">Table 1</xref>). Although traditional methods, such as the Wilcoxon test or <italic toggle="yes">t</italic>-test, are commonly used in single-cell differential expression analysis, they are not sufficient to resolve batch effect and data sparsity issues [<xref rid="ref17" ref-type="bibr">17</xref>]. More advanced algorithms, such as MAST [<xref rid="ref18" ref-type="bibr">18</xref>] and muscat [<xref rid="ref19" ref-type="bibr">19</xref>], have been developed. However, their flexibility in measuring perturbation effects is still limited, such as the decomposition of common and cell-type-specific perturbed genes. Meanwhile, machine learning approaches have been developed for the analysis of complex perturbation data. For example, scGen applied autoencoder models to learn perturbation responses in a latent space and to predict unseen scenarios [<xref rid="ref20" ref-type="bibr">20</xref>]. Although it is powerful in analyzing high-dimensional data, interpretability in latent spaces remains a significant challenge. In addition, these methods were not originally designed to measure perturbation effects in a temporal context.</p>
    <table-wrap position="float" id="TB1">
      <label>Table 1</label>
      <caption>
        <p>Comparisons of perturbation or temporal evaluation methods in single-cell analysis</p>
      </caption>
      <table frame="hsides" rules="groups">
        <colgroup span="1">
          <col align="left" span="1"/>
          <col align="left" span="1"/>
          <col align="left" span="1"/>
          <col align="left" span="1"/>
          <col align="left" span="1"/>
          <col align="left" span="1"/>
          <col align="left" span="1"/>
        </colgroup>
        <thead>
          <tr>
            <th align="left" rowspan="1" colspan="1">Method</th>
            <th align="left" rowspan="1" colspan="1">Algorithm</th>
            <th align="left" rowspan="1" colspan="1">Feature space</th>
            <th align="left" rowspan="1" colspan="1">Temporal evaluation</th>
            <th align="left" rowspan="1" colspan="1">Perturbation evaluation</th>
            <th align="left" rowspan="1" colspan="1">Limitation</th>
            <th align="left" rowspan="1" colspan="1">Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left" rowspan="1" colspan="1">MAST</td>
            <td align="left" rowspan="1" colspan="1">GLM</td>
            <td align="left" rowspan="1" colspan="1">Genes</td>
            <td align="left" rowspan="1" colspan="1">Manual comparison</td>
            <td align="left" rowspan="1" colspan="1">Yes</td>
            <td align="left" rowspan="1" colspan="1">Algorithm was not designed for temporal analysis</td>
            <td align="left" rowspan="1" colspan="1">[<xref rid="ref18" ref-type="bibr">18</xref>]</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">scGen</td>
            <td align="left" rowspan="1" colspan="1">Autoencoder</td>
            <td align="left" rowspan="1" colspan="1">Neural network latent space</td>
            <td align="left" rowspan="1" colspan="1">Not available</td>
            <td align="left" rowspan="1" colspan="1">Yes</td>
            <td align="left" rowspan="1" colspan="1">No implementation of the time covariate; lack of interpretability of the latent space features</td>
            <td align="left" rowspan="1" colspan="1">[<xref rid="ref20" ref-type="bibr">20</xref>]</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">CellBox</td>
            <td align="left" rowspan="1" colspan="1">Ordinary differential equation (ODE)</td>
            <td align="left" rowspan="1" colspan="1">Protein and phenotypes</td>
            <td align="left" rowspan="1" colspan="1">ODE</td>
            <td align="left" rowspan="1" colspan="1">Yes</td>
            <td align="left" rowspan="1" colspan="1">Algorithm was not optimally designed for single-cell analysis</td>
            <td align="left" rowspan="1" colspan="1">[<xref rid="ref23" ref-type="bibr">23</xref>]</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">MEFISTO</td>
            <td align="left" rowspan="1" colspan="1">Factor analysis</td>
            <td align="left" rowspan="1" colspan="1">Factors</td>
            <td align="left" rowspan="1" colspan="1">GP</td>
            <td align="left" rowspan="1" colspan="1">No</td>
            <td align="left" rowspan="1" colspan="1">Lack of understanding of perturbation responses</td>
            <td align="left" rowspan="1" colspan="1">[<xref rid="ref21" ref-type="bibr">21</xref>]</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">CPA</td>
            <td align="left" rowspan="1" colspan="1">Autoencoder + adversial network</td>
            <td align="left" rowspan="1" colspan="1">Neural network latent space</td>
            <td align="left" rowspan="1" colspan="1">Adversarial network</td>
            <td align="left" rowspan="1" colspan="1">Yes</td>
            <td align="left" rowspan="1" colspan="1">Lack of interpretability in the latent space features</td>
            <td align="left" rowspan="1" colspan="1">[<xref rid="ref22" ref-type="bibr">22</xref>]</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">CellDrift</td>
            <td align="left" rowspan="1" colspan="1">GLM</td>
            <td align="left" rowspan="1" colspan="1">Genes</td>
            <td align="left" rowspan="1" colspan="1">FDA</td>
            <td align="left" rowspan="1" colspan="1">Yes</td>
            <td align="left" rowspan="1" colspan="1">Time covariate was not incorporated in GLM</td>
            <td align="left" rowspan="1" colspan="1">This paper</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <p>Other methods took time as a covariate in the model [<xref rid="ref21" ref-type="bibr">21</xref>]. For example, compositional perturbation autoencoder (CPA) utilized the combination of linear models and deep-learning approaches to interpret temporal impacts, but the interpretation of gene-level impacts is not straightforward [<xref rid="ref22" ref-type="bibr">22</xref>]. Furthermore, CellBox analyzes the perturbation effects over time using ordinary differential equations [<xref rid="ref23" ref-type="bibr">23</xref>]. However, the performance of the method is limited by the sparsity and stochasticity issues in single-cell data.</p>
    <p>Generalized linear models (GLM) have been widely used in modeling single-cell transcriptomics data, outperforming linear regression by more accurately and efficiently capturing non-linear relations in count data through non-Gaussian distribution families [<xref rid="ref24" ref-type="bibr">24</xref>]. For example, sctransform successfully removed technical effects by introducing cellular sequencing depth as a covariate [<xref rid="ref25" ref-type="bibr">25</xref>].</p>
    <p>Functional data analysis (FDA) has been widely used in longitudinal data analysis [<xref rid="ref26" ref-type="bibr">26</xref>, <xref rid="ref27" ref-type="bibr">27</xref>]. A general form of FDA is the analysis of multiple curves varying over time, where each curve is a sample tracing with a series of time points, which can be characterized as a function. Such data are called functional data. One of the most popular tools in FDA is functional principal component analysis (FPCA), which identifies the dominant modes of variation of functional data [<xref rid="ref28" ref-type="bibr">28</xref>]. It has been widely used in disease progression profiling and predictions. For example, FPCA has been used in the monitoring of glucose levels in hyperglycemic patients [<xref rid="ref29" ref-type="bibr">29</xref>]. We utilized the flexibility of the FDA to identify temporal perturbation patterns.</p>
    <p>To address the aforementioned issues, we developed CellDrift, a GLM-based FDA model, to disentangle temporal patterns in perturbation responses in scRNA-seq data. CellDrift first captures cell-type specific perturbation effects by adding an interaction term in the GLM and then utilizes predicted coefficients to calculate contrast coefficients, which represent perturbation effects in our study. Concatenated contrast coefficients over time are defined as functions, and Fuzzy C-mean clustering is used to identify temporal patterns, which is accompanied by FPCA to find the major components that account for the most temporal variance. We benchmarked CellDrift with multiple functional clustering methods with statistical results from differential expression approaches, such as Wilcoxon and <italic toggle="yes">t</italic>-test, and CellDrift achieved superior performance in the identification of temporal patterns and imputation of perturbation effects. We applied CellDrift in COVID-19 single-cell data and a gut development atlas and identified temporal patterns and functional principal components associated with varying immune responses and gut organ morphogenesis.</p>
  </sec>
  <sec id="sec4">
    <title>Methods</title>
    <p>CellDrift takes the input of multiple scRNA-seq UMI count matrices across diverse captures (batches, <inline-formula><tex-math notation="LaTeX" id="ineq01">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$b$\end{document}</tex-math></inline-formula>), conditions (perturbations,<inline-formula><tex-math notation="LaTeX" id="ineq02">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$p$\end{document}</tex-math></inline-formula>) and time points (<inline-formula><tex-math notation="LaTeX" id="ineq03">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t$\end{document}</tex-math></inline-formula>). The main goal of the algorithm is to disentangle the major effects of different cell types (<inline-formula><tex-math notation="LaTeX" id="ineq04">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$c$\end{document}</tex-math></inline-formula>) and perturbations (<inline-formula><tex-math notation="LaTeX" id="ineq05">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$p$\end{document}</tex-math></inline-formula>). The derived contrast coefficients associated with each gene, cell type and condition after implementing the GLM model across time points are used for FDA to identify the temporal patterns of perturbation responses (<xref rid="f1" ref-type="fig">Figure 1</xref>).</p>
    <fig position="float" id="f1">
      <label>Figure 1</label>
      <caption>
        <p>Workflow of CellDrift. (<bold>A</bold>) An example of a perturbational single-cell experiment with multiple time points. (<bold>B</bold>) Real scenarios of single-cell experiments with varying perturbation effects over time. (<bold>C</bold>) GLM with the interaction of cell-type-perturbation applied separately at each time point, and contrast coefficients are derived as the representation of perturbation responses. The complete model can be found in the Methods. (<bold>D</bold>) Contrast coefficients are used as input for various applications in FDA.</p>
      </caption>
      <graphic xlink:href="bbac324f1" position="float"/>
    </fig>
    <sec id="sec5">
      <title>Perturbation coefficient model</title>
      <p>To begin, we introduce a model and notation for a single time point. We model the raw count of single-cell data <inline-formula><tex-math notation="LaTeX" id="DmEquation1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\gamma}_{ng}$\end{document}</tex-math></inline-formula> for cell <inline-formula><tex-math notation="LaTeX" id="DmEquation2">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$ n$\end{document}</tex-math></inline-formula> and gene <inline-formula><tex-math notation="LaTeX" id="DmEquation3">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$ g $\end{document}</tex-math></inline-formula> using a GLM with a negative binomial (NB) distribution. <inline-formula><tex-math notation="LaTeX" id="DmEquation4">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${z}_n$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="DmEquation5">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${x}_n$\end{document}</tex-math></inline-formula> represent the cell type and perturbation group of cell <inline-formula><tex-math notation="LaTeX" id="DmEquation6">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$n$\end{document}</tex-math></inline-formula>, which are <inline-formula><tex-math notation="LaTeX" id="DmEquation7">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$c$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="DmEquation8">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$p$\end{document}</tex-math></inline-formula> here: <disp-formula id="deqn02"><label>(1)</label><tex-math notation="LaTeX" id="DmEquation9">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} {\gamma}_{ng} \mid \left({z}_n=c,{x}_n=p\right)\sim \mathrm{NB}\left({\mu}_{ng cp},{\phi}_{ng cp}\right)\kern-1pt, \end{equation*}\end{document}</tex-math></disp-formula>where <inline-formula><tex-math notation="LaTeX" id="ineq07">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\mu}_{ngcp}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ineq08">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\phi}_{ngcp}$\end{document}</tex-math></inline-formula> represent the mean and inverse dispersion of the NB distribution for cell <inline-formula><tex-math notation="LaTeX" id="ineq09">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$n$\end{document}</tex-math></inline-formula> and gene <inline-formula><tex-math notation="LaTeX" id="ineq10">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$g$\end{document}</tex-math></inline-formula>. For example, <inline-formula><tex-math notation="LaTeX" id="ineq11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${z}_n$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ineq12">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${x}_n$\end{document}</tex-math></inline-formula> could be the user-defined cell type and perturbation group for cell <inline-formula><tex-math notation="LaTeX" id="ineq13">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$n$\end{document}</tex-math></inline-formula>, such as CD4+ T cell and Drug A treatment.</p>
      <p>We use a log link function <inline-formula><tex-math notation="LaTeX" id="ineq14">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$(\ln)$\end{document}</tex-math></inline-formula> for <inline-formula><tex-math notation="LaTeX" id="ineq15">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\mu}_{ngcp}$\end{document}</tex-math></inline-formula> and disentangle <inline-formula><tex-math notation="LaTeX" id="ineq16">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\eta}_{ngcp}$\end{document}</tex-math></inline-formula> with a linear model with cell-type coefficients <inline-formula><tex-math notation="LaTeX" id="ineq17">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\beta}_{gc}$\end{document}</tex-math></inline-formula> and perturbation coefficient <inline-formula><tex-math notation="LaTeX" id="ineq18">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\beta}_{gp}$\end{document}</tex-math></inline-formula> for each gene <inline-formula><tex-math notation="LaTeX" id="ineq19">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$g$\end{document}</tex-math></inline-formula>:<disp-formula id="deqn03"><label>(2)</label><tex-math notation="LaTeX" id="DmEquation10">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} \log{\mu}_{ngcp}={\eta}_{ngcp}, \end{equation*}\end{document}</tex-math></disp-formula><disp-formula id="deqn04"><label>(3)</label><tex-math notation="LaTeX" id="DmEquation11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} {\eta}_{ngcp}=\mathit{\log}{s}_n+{\beta}_{g0}+{\beta}_{gc}{\rho}_{nc}+{\beta}_{gp}{\rho}_{np}+{\sum}_{b=1}^B{\beta}_{gb}{\rho}_{nb}, \end{equation*}\end{document}</tex-math></disp-formula>where <inline-formula><tex-math notation="LaTeX" id="ineq22">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\rho}_{nc}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ineq23">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\rho}_{np}$\end{document}</tex-math></inline-formula> indicate whether cell <inline-formula><tex-math notation="LaTeX" id="ineq24">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$n$\end{document}</tex-math></inline-formula> belongs to cell-type <inline-formula><tex-math notation="LaTeX" id="ineq25">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$c$\end{document}</tex-math></inline-formula> and perturbation group <inline-formula><tex-math notation="LaTeX" id="ineq26">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$p$\end{document}</tex-math></inline-formula>, as represented by one-hot matrices. The intercept <inline-formula><tex-math notation="LaTeX" id="ineq27">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\beta}_{g0}$\end{document}</tex-math></inline-formula> represents the base expression level of gene <inline-formula><tex-math notation="LaTeX" id="ineq28">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$g$\end{document}</tex-math></inline-formula>. In addition, we account for the library size <inline-formula><tex-math notation="LaTeX" id="ineq29">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${s}_n$\end{document}</tex-math></inline-formula> and batch effects <inline-formula><tex-math notation="LaTeX" id="ineq30">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\beta}_{gb}$\end{document}</tex-math></inline-formula> in the model, and <inline-formula><tex-math notation="LaTeX" id="ineq31">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\rho}_{nb}$\end{document}</tex-math></inline-formula> is the one-hot matrix for cell <inline-formula><tex-math notation="LaTeX" id="ineq32">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$n$\end{document}</tex-math></inline-formula> and batch <inline-formula><tex-math notation="LaTeX" id="ineq33">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$b$\end{document}</tex-math></inline-formula> (e.g. donor, sequencing platform). <inline-formula><tex-math notation="LaTeX" id="ineq34">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$B$\end{document}</tex-math></inline-formula> is the total number of batch types, commonly &gt;1 in complicated datasets. Batch types are incorporated into the model as fixed effects. For simplicity, we omit the <inline-formula><tex-math notation="LaTeX" id="ineq35">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$b$\end{document}</tex-math></inline-formula> (batch) subscript in the mean count (<inline-formula><tex-math notation="LaTeX" id="ineq36">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\mu}_{ngcp}$\end{document}</tex-math></inline-formula>) and linear predictor symbols (<inline-formula><tex-math notation="LaTeX" id="ineq37">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\eta}_{ngcp}$\end{document}</tex-math></inline-formula>).</p>
      <p>In Equation (3), cell-type effect and perturbation effect are independent covariates. In real cases, however, different cell types usually have distinct responses toward the same perturbation. Thus, we add an interaction term <inline-formula><tex-math notation="LaTeX" id="ineq38">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\beta}_{gcp}$\end{document}</tex-math></inline-formula> for the cell-type and perturbation covariates, representing cell-type-specific perturbation effects. In contrast, <inline-formula><tex-math notation="LaTeX" id="ineq39">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\beta}_{gp}$\end{document}</tex-math></inline-formula> represents common perturbation effects across cell types:<disp-formula id="deqn05"><label>(4)</label><tex-math notation="LaTeX" id="DmEquation12">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} {\eta}_{ngcp}=\log\, {s}_n+{\beta}_{g0}+{\beta}_{gc}{\rho}_{nc}+{\beta}_{gp}{\rho}_{np}+{\beta}_{gc p}{\rho}_{nc p}+{\sum}_{b=1}^B{\beta}_{gb}{\rho}_{nb}, \end{equation*}\end{document}</tex-math></disp-formula>where <inline-formula><tex-math notation="LaTeX" id="ineq41">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\rho}_{ncp}$\end{document}</tex-math></inline-formula> is a one-hot matrix of the cell type and perturbation group, indicating whether cell <inline-formula><tex-math notation="LaTeX" id="ineq42">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$n$\end{document}</tex-math></inline-formula> belongs to cell-type <inline-formula><tex-math notation="LaTeX" id="ineq43">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$c$\end{document}</tex-math></inline-formula> and perturbation group <inline-formula><tex-math notation="LaTeX" id="ineq44">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$p$\end{document}</tex-math></inline-formula> at the same time. Likelihood ratio test is used to do the model selection (<xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>, <xref rid="sup1" ref-type="supplementary-material">Figure S1</xref> available online at <ext-link xlink:href="https://academic.oup.com/bib" ext-link-type="uri">https://academic.oup.com/bib</ext-link>).</p>
    </sec>
    <sec id="sec6">
      <title>Contrast coefficients</title>
      <p>Both main effects (<inline-formula><tex-math notation="LaTeX" id="ineq45">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\beta}_{gc}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ineq46">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\beta}_{gp}$\end{document}</tex-math></inline-formula>) and interaction coefficients (<inline-formula><tex-math notation="LaTeX" id="ineq47">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\beta}_{gcp}$\end{document}</tex-math></inline-formula>) are estimated using GLM after fitting the single-cell data. Then, we retrieve pairwise contrast coefficients <inline-formula><tex-math notation="LaTeX" id="ineq48">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\Delta{\beta}_{gcp}$\end{document}</tex-math></inline-formula> based on estimated <inline-formula><tex-math notation="LaTeX" id="ineq49">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\beta}_{gp}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ineq50">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\beta}_{gcp}$\end{document}</tex-math></inline-formula>, which are used to quantify the difference between the perturbed state and baseline in specific cell types (<xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>). Briefly, they represent the perturbation effects of cell-type <inline-formula><tex-math notation="LaTeX" id="ineq51">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$c$\end{document}</tex-math></inline-formula> in perturbation group <inline-formula><tex-math notation="LaTeX" id="ineq52">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$p$\end{document}</tex-math></inline-formula>. Contrast coefficients are the basic representation of perturbation effects in this study. They are also the input data for FDA (<xref rid="f1" ref-type="fig">Figure 1</xref>).</p>
    </sec>
    <sec id="sec7">
      <title>Representation of functional data using contrast coefficients</title>
      <p>In the general form of FDA, each curve is a sample with a series of time points, which is commonly referred to as a function. In our study, in addition to cell types and perturbation groups in single-cell perturbation data, we added another dimension of complexity, time covariate <inline-formula><tex-math notation="LaTeX" id="ineq53">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t$\end{document}</tex-math></inline-formula>, into our model, which is continuous and usually a sparse covariate in single-cell experiments. Real-life examples of time covariates include the elapsed time since disease onset, drug treatment (pre-post) and patient age.</p>
      <p>In CellDrift, we estimate contrast coefficients <inline-formula><tex-math notation="LaTeX" id="ineq54">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\Delta{\beta}_{gcp}$\end{document}</tex-math></inline-formula> for genes across cell types and perturbation groups at each time point <inline-formula><tex-math notation="LaTeX" id="ineq55">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$t$\end{document}</tex-math></inline-formula> from the time series <inline-formula><tex-math notation="LaTeX" id="ineq56">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\{1,2,\dots, T\}$\end{document}</tex-math></inline-formula>. Then, for each combination of cell-type <inline-formula><tex-math notation="LaTeX" id="ineq57">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$c$\end{document}</tex-math></inline-formula> and perturbation group <inline-formula><tex-math notation="LaTeX" id="ineq58">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$p$\end{document}</tex-math></inline-formula>, we get a series of <inline-formula><tex-math notation="LaTeX" id="ineq59">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\Delta{\beta}_{gcp}$\end{document}</tex-math></inline-formula> across available time points, represented as <inline-formula><tex-math notation="LaTeX" id="ineq60">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\{\Delta{\beta}_{gcpt}\}}_{t\in [0,1,\dots, T]}$\end{document}</tex-math></inline-formula>. Each series <inline-formula><tex-math notation="LaTeX" id="ineq61">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\{\Delta{\beta}_{gcpt}\}}_{t\in [0,1,\dots, T]}$\end{document}</tex-math></inline-formula>denotes perturbation coefficients of gene <inline-formula><tex-math notation="LaTeX" id="ineq62">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$g$\end{document}</tex-math></inline-formula> across time points for the selected cell type and perturbation group, which is the representation of a function or a sample in the following FDA framework.</p>
    </sec>
    <sec id="sec8">
      <title>Temporal pattern identification</title>
      <p>There are two general input formats for FDA in our context:</p>
      <p>(i) Functional data of various genes in a fixed cell type and perturbation group:<disp-formula id="deqn06"><tex-math notation="LaTeX" id="DmEquation13">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{array}{l} {F}_G=\left\{{\{\Delta{\beta}_{g_0 cpt}\}}_{t\in [0,1,\dots, T]},{\{\Delta{\beta}_{g_1 cpt}\}}_{t\in [0,1,\dots, T]},\right.\\ \left.{\{\Delta{\beta}_{g_2 cpt}\}}_{t\in [0,1,\dots, T]},{\{\Delta{\beta}_{g_3 cpt}\}}_{t\in [0,1,\dots, T]},\dots \right\}\kern-1.3pt. \end{array}$$\end{document}</tex-math></disp-formula></p>
      <p>(ii) Functional data of combinations of various cell types and perturbations for a specific gene:<disp-formula id="deqn07"><tex-math notation="LaTeX" id="DmEquation14">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{array}{l} {F}_{CP}=\left\{{\{\Delta{\beta}_{g{c}_0{p}_0t}\}}_{t\in [0,1,\dots, T]},{\{\Delta{\beta}_{g{c}_0{p}_1t}\}}_{t\in [0,1,\dots, T]},\dots,\right.\\ \left.{\{\Delta{\beta}_{gc_1{p}_0t}\}}_{t\in [0,1,\dots, T]},{\{\Delta{\beta}_{g{c}_1{p}_1t}\}}_{t\in [0,1,\dots, T]},\dots \right\}\kern-1.5pt, \end{array}$$\end{document}</tex-math></disp-formula>
where functional data are denoted as a set of functions.</p>
      <p>Our goal is to identify genes (or cell type-perturbation combinations) that show similar dynamic changes in perturbation responses over time, which we refer to as temporal patterns. To find such patterns, we investigated functional clustering algorithms such as KMeans, Fuzzy C-means and EMCluster [<xref rid="ref30" ref-type="bibr">30</xref>, <xref rid="ref31" ref-type="bibr">31</xref>]. Based on the benchmark results, we chose the Fuzzy C-means functional clustering algorithm to identify the temporal patterns of perturbation effects [<xref rid="ref32" ref-type="bibr">32</xref>] (<xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>). For example, when clustering on <inline-formula><tex-math notation="LaTeX" id="ineq63">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${F}_G$\end{document}</tex-math></inline-formula>, the resultant cluster can be interpreted as a group of genes with a similar pattern of perturbation response over time.</p>
      <p>Additional algorithm, evaluation, simulation and FDA details are provided in Supplemental Methods.</p>
    </sec>
  </sec>
  <sec id="sec9">
    <title>Results</title>
    <sec id="sec10">
      <title>CellDrift GLM improves perturbed gene detection</title>
      <p>We first demonstrated the performance of CellDrift using simulated datasets (<xref rid="sup1" ref-type="supplementary-material">Figures S2</xref> and <xref rid="sup1" ref-type="supplementary-material">S3</xref> available online at <ext-link xlink:href="https://academic.oup.com/bib" ext-link-type="uri">https://academic.oup.com/bib</ext-link>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>). True positive rates (TPR or sensitivity) and false discovery rates (FDR) were derived by comparing the ground truth and estimated results (<xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>). Compared with other commonly used differential expression methods, including <italic toggle="yes">t</italic>-test, Wilcoxon test and MAST, CellDrift achieved improved sensitivity in the diverse levels of batch effect sizes and differential expression sizes (<xref rid="f2" ref-type="fig">Figure 2<bold>A</bold></xref> and <bold>B</bold>), which indicates a stronger detection power for perturbed genes using CellDrift.</p>
      <fig position="float" id="f2">
        <label>Figure 2</label>
        <caption>
          <p>Performance of CellDrift in the identification of perturbed genes and temporal perturbation patterns. (<bold>A</bold>, <bold>B</bold>) Benchmark results of the GLM of CellDrift and other commonly used differential expression approaches in the simulated data. Simulated data with multiple batch effect sizes (<bold>A</bold>) and differential expression sizes (<bold>B</bold>) were used for benchmarking. TPR and FDR were used as metrics. The mean and SD derived from 10 replicates for each test are shown in the figure. (<bold>C</bold>) Benchmark results of temporal pattern recovery for CellDrift strategy (GLM + Fuzzy C-mean) and other approaches. Temporal pattern recovery was evaluated with ARI and measured across varying parameters, including numbers of time points, ratios of missing time points and noise levels. (<bold>D</bold>) Benchmark results of imputation performance using Pearson correlations between imputed contrast coefficients from FPCA and real simulated perturbation coefficients. The same parameters were used as (<bold>C</bold>).</p>
        </caption>
        <graphic xlink:href="bbac324f2" position="float"/>
      </fig>
      <p>We observed that CellDrift has a higher FDR in experiments with small batch effects (&lt;0.1). However, it has a stable and controlled FDR at larger batch effect sizes (0.4 and 0.7), where higher FDR was observed in other methods, such as <italic toggle="yes">t</italic>-test and Wilcoxon (<xref rid="f2" ref-type="fig">Figure 2<bold>A</bold></xref>). Similarly, MAST has a stable and small FDR of &lt;0.05 across different batch effects, showing the best performance of controlling FDR among all methods, which may be due to the removal of technical covariates, such as batch effects, by the hurdle model [<xref rid="ref18" ref-type="bibr">18</xref>]. However, its TPR is much lower than CellDrift.</p>
      <p>CellDrift outperformed other methods with significantly higher TPR across various differential expression sizes (<xref rid="f2" ref-type="fig">Figure 2<bold>B</bold></xref>). Meanwhile, we observed a high FDR of CellDrift in experiments with small differential expression sizes (0.05 and 0.2), indicating a relatively inferior performance in controlling false discoveries. MAST had similar results. We argue, however, that it is more important to identify as many DE genes as possible than to avoid false discoveries in datasets with few perturbed genes (<xref rid="f2" ref-type="fig">Figure 2<bold>B</bold></xref>). FDR of CellDrift decreased with increasing differential expression sizes and achieved a low level (&lt;0.15) in large DE sizes (0.5, 0.8).</p>
      <p>Additionally, the CellDrift GLM model also achieved good performances in single-cell pseudo-time data (<xref rid="sup1" ref-type="supplementary-material">Figure S4</xref> available online at <ext-link xlink:href="https://academic.oup.com/bib" ext-link-type="uri">https://academic.oup.com/bib</ext-link>). More details can be found in the <xref rid="sup5" ref-type="supplementary-material">Supplementary Note</xref>.</p>
    </sec>
    <sec id="sec11">
      <title>Fuzzy C-means clustering and CellDrift contrast coefficients improve temporal pattern identification and imputation performance</title>
      <p>We simulated both linear and nonlinear time patterns of gene perturbation effects (<xref rid="sup1" ref-type="supplementary-material">Figure S5</xref> available online at <ext-link xlink:href="https://academic.oup.com/bib" ext-link-type="uri">https://academic.oup.com/bib</ext-link>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>). The temporal pattern recovery performance of three functional clustering algorithms (KMeans, Fuzzy C-means and FPCA-based EMCluster) [<xref rid="ref33" ref-type="bibr">33</xref>] were examined with CellDrift GLM contrast coefficients as the input (<xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>). We used adjusted Rand index (ARI) as the metric to measure the accuracy of prediction for simulated temporal patterns (<xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>). The influence of different parameters, including the number of time points, the ratio of missing time points and noise levels, were evaluated (<xref rid="f2" ref-type="fig">Figure 2<bold>C</bold></xref> and <bold>D</bold>, Figure <xref rid="sup1" ref-type="supplementary-material">S6</xref> available online at <ext-link xlink:href="https://academic.oup.com/bib" ext-link-type="uri">https://academic.oup.com/bib</ext-link>).</p>
      <p>From the performance of clustering algorithms that used GLM-based contrast coefficients as the input, we observed that FPCA-based EMCluster achieved higher accuracy for a certain number of time points. However, Fuzzy C-means achieved a stable and better performance than most other methods at varying numbers of time points, with ARI reaching 0.9. Additionally, the ARI of Fuzzy C-means exceeded 0.8 at ratios of missing time points &lt;0.5. ARI decreased at greater ratios of missing time points but remained at the 0.7 level and outperformed most other clustering algorithms, such as FPCA-based EMCluster. Note that the ARI of Fuzzy C-mean remained stable at high noise levels with relatively higher accuracy than normal KMeans and other methods (<xref rid="f2" ref-type="fig">Figure 2<bold>C</bold></xref>). Furthermore, Fuzzy C-mean has shown an improved performance for a variety of non-linear time patterns, pattern coefficient gaps and sequencing depth (<xref rid="sup1" ref-type="supplementary-material">Figure S6<bold>A</bold></xref> available online at <ext-link xlink:href="https://academic.oup.com/bib" ext-link-type="uri">https://academic.oup.com/bib</ext-link>). In summary, our findings suggest that Fuzzy C-mean has the most stable and relatively better temporal pattern recognition performance.</p>
      <p>We also compared GLM-based contrast coefficients with other statistical scores, such as scores from <italic toggle="yes">t</italic>-test and Wilcoxon test, as the input for FDA (<xref rid="f2" ref-type="fig">Figure 2<bold>C</bold></xref>). The <italic toggle="yes">t</italic>-test scores had an inferior performance in most parameter settings. The performance of Wilcoxon score at various time points is comparable with GLM-based functional clustering. However, its performance in large fractions of missing time points is inferior to GLM-based clustering (<xref rid="f2" ref-type="fig">Figure 2<bold>C</bold></xref>).</p>
      <p>Additionally, we investigated the imputation performance for missing time points, which is a commonly seen situation in real temporal single-cell data. Incorporated in our pipeline, FPCA provides smoothing and interpolation functions. We compared GLM-based input with statistical scores from <italic toggle="yes">t</italic>-test and Wilcoxon test, where we observed significant improvement in the imputation performance using GLM-based input (<xref rid="f2" ref-type="fig">Figure 2<bold>D</bold></xref> and Figure <xref rid="sup1" ref-type="supplementary-material">S6<bold>B</bold></xref> available online at <ext-link xlink:href="https://academic.oup.com/bib" ext-link-type="uri">https://academic.oup.com/bib</ext-link>).</p>
      <p>Furthermore, we demonstrated that CellDrift can identify temporal patterns in complex datasets with a variety of cell types that display distinctive perturbation responses (<xref rid="sup1" ref-type="supplementary-material">Figure S7</xref> available online at <ext-link xlink:href="https://academic.oup.com/bib" ext-link-type="uri">https://academic.oup.com/bib</ext-link>). Moreover, CellDrift achieves a reasonable performance of temporal pattern identification in datasets with a small number of cells or time points (<xref rid="sup1" ref-type="supplementary-material">Figure S8</xref> available online at <ext-link xlink:href="https://academic.oup.com/bib" ext-link-type="uri">https://academic.oup.com/bib</ext-link>, <xref rid="sup5" ref-type="supplementary-material">Supplementary Notes</xref>).</p>
    </sec>
    <sec id="sec12">
      <title>CellDrift identified temporal patterns of COVID-19 immune responses</title>
      <p>We next demonstrated CellDrift by identifying the temporal patterns of immune responses in a large-scale COVID-19 PBMC single-cell dataset [<xref rid="ref1" ref-type="bibr">1</xref>]. Samples were derived from COVID-19 patients with different conditions as well as from severe influenza and sepsis patients. The six most common cell types were extracted for our analysis. Disease progression time ranged from 0 to 25 days from disease onset (<xref rid="f3" ref-type="fig">Figure 3<bold>A</bold></xref>).</p>
      <fig position="float" id="f3">
        <label>Figure 3</label>
        <caption>
          <p>Temporal perturbation effects in COVID-19 atlas. (<bold>A</bold>) Overview of the number of cells in each cell group of the dataset, which contains multiple disease conditions, cell types and time points from days 1 to 25 since the disease onset. The size of dots represents the number of cells. HCW_MILD: healthcare workers with mild COVID-19; MILD, SEV, CRIT: mild, severe and critical COVID-19; CD4, CD8: CD4 T cell, CD8 T cell; cMono, ncMono: classical and non-classical monocyte. (<bold>B</bold>) Three distinct temporal patterns of contrast coefficients from classical monocytes of severe COVID-19 patients. The top row shows curves of genes with similar contrast coefficients in each cluster over time, and the bottom row shows the gene set enrichment analysis of genes in each temporal cluster. The black line represents the average time curve for all genes, which is the same across three plots. Gene enrichment scores are defined as <inline-formula><tex-math notation="LaTeX" id="ineq64">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$-{\log}_{10}\mathrm{FDR}$\end{document}</tex-math></inline-formula>-adjusted <italic toggle="yes">P</italic>-values of enrichment significance. (<bold>C</bold>) Five genes from cluster 17 were prioritized by the functional ANOVA test, which have significantly higher temporal curves in severe conditions than mild symptoms. Contrast coefficients for classical monocytes across disease conditions are shown on smoothed curves computed by FPCA, and time curves were aligned using dynamic time warping. (<bold>D</bold>) Validation of genes from (<bold>C</bold>) with another large-scale COVID-19 PBMC data [<xref rid="ref1" ref-type="bibr">1</xref>]. FPCA smoothed curves for genes in three replicates of mild and severe patients are shown, which display similar temporal patterns as (<bold>C</bold>).</p>
        </caption>
        <graphic xlink:href="bbac324f3" position="float"/>
      </fig>
      <p>Compared with recent neural network-based autoencoder methods, such as scGen and CPA, we are able to investigate the gene-level perturbation effects across the time covariate. We first focused on the classical monocytes in severe COVID-19 patients and applied CellDrift for all genes after the feature selection (<xref rid="sup2" ref-type="supplementary-material">Supplementary Table S1</xref> available online at <ext-link xlink:href="https://academic.oup.com/bib" ext-link-type="uri">https://academic.oup.com/bib</ext-link>). Genes with similar temporal patterns of perturbation responses clustered together, indicating that multiple gene patterns of dynamic changes were occurring upon virus infection during disease progression. The genes responding to perturbations in clusters 11, 13 and 17 showed three distinct temporal patterns, where the contrast coefficients of clusters 11 and 17 showed a positive and negative correlation with time, while cluster 13 showed an insensitive pattern to time (<xref rid="f3" ref-type="fig">Figure 3<bold>B</bold></xref>). Based on gene enrichment results, cluster 11 is highly associated with catabolic and biosynthesis processes, while cluster 17 appears to be involved in immune responses, indicating a rapid activation of immune response activities and a suppression of house-keeping activities in the early disease stage (d1~d15), with a reduced level of such changes in later stages (after d15). Additionally, the functional PCA also showcased distinct patterns of perturbation responses during disease progression (<xref rid="sup1" ref-type="supplementary-material">Figures S9</xref>–<xref rid="sup1" ref-type="supplementary-material">S11</xref> available online at <ext-link xlink:href="https://academic.oup.com/bib" ext-link-type="uri">https://academic.oup.com/bib</ext-link>, <xref rid="sup5" ref-type="supplementary-material">Supplementary Notes</xref>).</p>
      <p>As a further test, we applied CellDrift to multiple cell types in the COVID-19 dataset to investigate the cell-type-dependent perturbation responses (<xref rid="sup1" ref-type="supplementary-material">Figure S12<bold>A</bold></xref> available online at <ext-link xlink:href="https://academic.oup.com/bib" ext-link-type="uri">https://academic.oup.com/bib</ext-link>). Notably, distinct biological activities were highlighted in the temporal perturbation patterns across cell types (<xref rid="sup1" ref-type="supplementary-material">Figure S12<bold>B</bold></xref> available online at <ext-link xlink:href="https://academic.oup.com/bib" ext-link-type="uri">https://academic.oup.com/bib</ext-link>). For example, lymphocytes, including CD4+ T cells, CD8+ T cells and NK cells, showcased the up-regulated patterns of cell cycle and division. Myeloid cells, including classical monocytes and non-classical monocytes, presented the up-regulation of vesicle and membrane fusion, indicating the synthesis of proteins against the virus infection. These activities have been reported in the literature [<xref rid="ref34" ref-type="bibr">34</xref>, <xref rid="ref35" ref-type="bibr">35</xref>]. In addition to the cell-type resolution used above, we also applied CellDrift on CD4+ T cell subpopulations and identified the subpopulation with the strongest temporal perturbation responses (<xref rid="sup1" ref-type="supplementary-material">Figure S13</xref> available online at <ext-link xlink:href="https://academic.oup.com/bib" ext-link-type="uri">https://academic.oup.com/bib</ext-link>, <xref rid="sup5" ref-type="supplementary-material">Supplementary Notes</xref>).</p>
      <p>After we obtained temporal patterns in severe COVID-19 patients, we further examined whether the patterns vary across multiple perturbation groups, such as mild and severe COVID-19 patients. To achieve it, we applied functional analysis in classical monocytes of multiple disease conditions, where dynamic time warping was used to align multiple time series into a comparable time scale (<xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>). Next, we applied a one-way functional analysis of variance (ANOVA) test and calculated the ANOVA scores for each gene, representing the consistency of perturbation responses between disease conditions over time (<xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>). Based on ANOVA results, a number of genes from cluster 17 were identified as severe-prominent genes, including S100A8, S100A9, CTSD and others (<xref rid="f3" ref-type="fig">Figure 3<bold>C</bold></xref>). In agreement with our findings, elevated levels of calprotectin (S100A8/S100A9) have been found in severe COVID-19 patients with poor clinical outcomes [<xref rid="ref35" ref-type="bibr">35</xref>, <xref rid="ref36" ref-type="bibr">36</xref>]. Apart from severe-prominent genes, we also prioritized mild-prominent genes and condition-irrelevant genes, representing distinct gene programs of temporal perturbation responses across disease conditions (<xref rid="sup1" ref-type="supplementary-material">Figure S14</xref> available online at <ext-link xlink:href="https://academic.oup.com/bib" ext-link-type="uri">https://academic.oup.com/bib</ext-link>).</p>
      <p>To validate our discoveries, we also applied CellDrift to the data from another large-scale COVID-19 single-cell experiment [<xref rid="ref1" ref-type="bibr">1</xref>]. We observed similar temporal patterns between the mild and severe COVID-19 patients as shown in <xref rid="f3" ref-type="fig">Figure 3<bold>D</bold></xref>, which shows the reproducibility of CellDrift approach. Moreover, we retrieved the control and critical COVID-19 gene modules from the literature as the external knowledge [<xref rid="ref37" ref-type="bibr">37</xref>] and evaluated their associations with CellDrift-derived temporal patterns. Notably, temporally up-regulated patterns are strongly associated with critical gene modules, while temporally down-regulated patterns are strongly related to control modules (<xref rid="sup1" ref-type="supplementary-material">Figure S15</xref> available online at <ext-link xlink:href="https://academic.oup.com/bib" ext-link-type="uri">https://academic.oup.com/bib</ext-link>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>).</p>
      <p>Similarly, CellDrift also identified temporal immune response patterns in an HIV post-infection study (<xref rid="sup1" ref-type="supplementary-material">Figure S16</xref> available online at <ext-link xlink:href="https://academic.oup.com/bib" ext-link-type="uri">https://academic.oup.com/bib</ext-link>) [<xref rid="ref14" ref-type="bibr">14</xref>]. More information can be accessed in the <xref rid="sup5" ref-type="supplementary-material">Supplementary Notes</xref>.</p>
    </sec>
    <sec id="sec13">
      <title>CellDrift discovered differential temporal gene patterns during fetal gut development</title>
      <p>We further applied CellDrift to a single-cell fetal gut cell atlas to identify differential gene programs during organ development [<xref rid="ref38" ref-type="bibr">38</xref>]. Researchers examined gut development in three compartments, including duo-jejunum, ileum and colon, at nine time points during development from the embryonic stage (week 6) to the fetal stage (week 11) (<xref rid="f4" ref-type="fig">Figure 4<bold>A</bold></xref>). We selected the epithelial and mesenchymal cells from all three compartments and used duo-jejunum as a reference compartment in the GLM model. Differential gene programs during development between the colon (or ileum) and duo-jejunum were identified by the GLM across time points (<xref rid="sup3" ref-type="supplementary-material">Supplementary Table S2</xref> available online at <ext-link xlink:href="https://academic.oup.com/bib" ext-link-type="uri">https://academic.oup.com/bib</ext-link>).</p>
      <fig position="float" id="f4">
        <label>Figure 4</label>
        <caption>
          <p>Differential temporal trajectories of gut development. (<bold>A</bold>) Overview of fetal gut cell atlas. The study contains single-cell sequencing data for three compartments in gut development, including duo-jejunum, ileum and colon, whose transcriptomics profiles were retrieved from weeks 6 to 11. (<bold>B</bold>) The top 2 FPCA eigenfunctions and their scores over time for functional data of comparisons of colon and duo-jejunum in mesenchymal cells. First eigenfunction <inline-formula><tex-math notation="LaTeX" id="ineq65">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\phi}_1$\end{document}</tex-math></inline-formula> presents a strong temporal pattern as is highlighted. (<bold>C</bold>) Functional principal component 1 (FPC1) scores were computed for genes in each cluster, displayed in decreasing order. High positive scores indicate genes in the cluster may have similar temporal patterns as <inline-formula><tex-math notation="LaTeX" id="ineq66">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\phi}_1$\end{document}</tex-math></inline-formula>, while large negative scores indicate opposite temporal patterns as <inline-formula><tex-math notation="LaTeX" id="ineq67">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\phi}_1$\end{document}</tex-math></inline-formula>. Clusters 11 and 16 are highlighted for the following analysis. (<bold>D</bold>, <bold>E</bold>) FPCA smoothed curves for genes in cluster 11 (<bold>D</bold>) and 16 (<bold>E</bold>) and their gene enrichment results. (<bold>F</bold>) The top three FPCA eigenfunctions and their scores over time for functional data of comparisons of colon and duo-jejunum in epithelium cells. The second eigenfunction <inline-formula><tex-math notation="LaTeX" id="ineq68">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\phi}_2$\end{document}</tex-math></inline-formula> presents a strong temporal pattern as is highlighted. (<bold>G</bold>) Functional principal component 2 (FPC2) scores were computed for genes in each cluster, which was ranked in a decreasing order. Clusters 4 and 9 are highlighted for the following analysis. (<bold>H</bold>, <bold>I</bold>) FPCA smoothed curves for genes in clusters 9 (<bold>H</bold>) and 4 (<bold>I</bold>) and their gene enrichment results.</p>
        </caption>
        <graphic xlink:href="bbac324f4" position="float"/>
      </fig>
      <p>The top two eigenfunctions from the subsequent FPCA step explain &gt;99% of the temporal variance of mesenchymal cells between the colon and duo-jejunum, where the first eigenfunction (<inline-formula><tex-math notation="LaTeX" id="ineq69">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\phi}_1$\end{document}</tex-math></inline-formula>) shows reverse temporal patterns during the development (<xref rid="f4" ref-type="fig">Figure 4<bold>B</bold>, Figure </xref><xref rid="sup1" ref-type="supplementary-material">S17</xref> available online at <ext-link xlink:href="https://academic.oup.com/bib" ext-link-type="uri">https://academic.oup.com/bib</ext-link>). CellDrift identified 20 temporal clusters (<xref rid="sup1" ref-type="supplementary-material">Figure S18</xref> available online at <ext-link xlink:href="https://academic.oup.com/bib" ext-link-type="uri">https://academic.oup.com/bib</ext-link>) and ranked them by FPC1 scores, in which clusters 11 and 16 had high positive and negative correlations with FPC1 scores (<xref rid="f4" ref-type="fig">Figure 4<bold>C</bold></xref>). Follow-up gene enrichment analyses indicate that extracellular matrix organization genes are more active in early stages (weeks 7–8) in the duo-jejunum and then in later stages (weeks 9–10) in the colon, whereas morphogenesis genes are more prominent in the distal tissues (colon) at the beginning and proximal (duo-jejunum) later on.</p>
      <p>Similarly, such time-dependent differentiation gene programs were also identified in the epithelium cells by comparing the colon and duo-jejunum (<xref rid="f4" ref-type="fig">Figure 4<bold>F</bold></xref>–<bold>I</bold>, Figures <xref rid="sup1" ref-type="supplementary-material">S17</xref> and <xref rid="sup1" ref-type="supplementary-material">S18</xref> available online at <ext-link xlink:href="https://academic.oup.com/bib" ext-link-type="uri">https://academic.oup.com/bib</ext-link>), revealing temporal patterns that appear like waves from the proximal to distal compartments throughout the gut development.</p>
      <p>Additionally, we investigated genetic effects on the neuron development trajectory using the pseudo-time as the time covariate of CellDrift. We identified temporal patterns that indicated the immaturity of projection neurons caused by the mutation of an autism-risk gene (<xref rid="sup1" ref-type="supplementary-material">Figures S19</xref> available online at <ext-link xlink:href="https://academic.oup.com/bib" ext-link-type="uri">https://academic.oup.com/bib</ext-link>, <xref rid="sup5" ref-type="supplementary-material">Supplementary Notes</xref>).</p>
    </sec>
    <sec id="sec14">
      <title>Computational performance of CellDrift</title>
      <p>We evaluated the speed and memory usage of CellDrift in single-cell datasets with different sizes (<xref rid="f5" ref-type="fig">Figure 5</xref>). Tests were conducted on the 8 GB MacBook Pro (2.3 GHz Intel Core i5) using eight cores of CPU. The running time and memory usage were positively correlated with the number of cells and genes. With datasets of 50000 cells and 3000 features, CellDrift completed the task within 15 minutes (<xref rid="f5" ref-type="fig">Figure 5<bold>A</bold></xref>). The memory usage of CellDrift depends on the number of cells and features. For large-scale datasets, it took &lt;3 GB of memory (<xref rid="f5" ref-type="fig">Figure 5<bold>B</bold></xref>).</p>
      <fig position="float" id="f5">
        <label>Figure 5</label>
        <caption>
          <p>Computational performance of CellDrift. (<bold>A</bold>, <bold>B</bold>) Total amount of running time (<bold>A</bold>) and memory usage (<bold>B</bold>) of the CellDrift application in single-cell datasets with various numbers of cells and genes. The mean and standard error values were calculated for three runs in each condition.</p>
        </caption>
        <graphic xlink:href="bbac324f5" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec id="sec15">
    <title>Discussion</title>
    <p>In this study, we presented a framework to identify the temporal patterns of perturbation responses. As far as we know, CellDrift is the first method to use FDA in the evaluation of longitudinal perturbation effects in single-cell data, with the advantages of investigating gene-level temporal perturbation effects. Using GLMs, we modeled perturbational single-cell data and introduced the new concept of cell type-perturbation interaction, which improves the sensitivity of detecting both common and cell-type-specific perturbation effects in real-life single-cell experiments. As a result of allowing for batch covariates, we address a significant barrier to finding real perturbed genes. Unlike currently available single-cell methods, which either focus on temporal analysis or perturbation investigation, we utilized the flexibility of GLM and FDA to combine these two areas together and gained insights into complicated longitudinal perturbation responses.</p>
    <p>In our study, we successfully improved TPR in multiple settings of batch effects and perturbation effect size compared with the popular methods in differential expression analysis, enabling the capture of more perturbed features. The FDR is insensitive to varying batch sizes, indicating the successful repression of batch effects by CellDrift. Notably, although the performance of a GLM with the Fuzzy C-mean was not uniformly superior in identifying temporal patterns, it was the most stable approach and performed well in the majority of benchmark experiments. Gaussian process (GP) has been found to be effective in inferring temporal patterns from single-cell data [<xref rid="ref21" ref-type="bibr">21</xref>]. FDA was selected over the option of GPs in this study because of its flexibility and versatile functions, including smoothing curves, FPCA, one-way ANOVA tests and newly implemented deep learning methods [<xref rid="ref39" ref-type="bibr">39</xref>, <xref rid="ref40" ref-type="bibr">40</xref>]. Nevertheless, we are interested in exploring the application of GP in the analysis of temporal perturbational data in the future. Compared with the autoencoder network approach in CPA, CellDrift is able to investigate the gene-level perturbation effects across the temporal covariate. Despite the dramatically reduced dimensions in the latent space of autoencoder models, it can be difficult or impossible to understand the shift in the latent space in perturbation settings. Instead, we utilized the power of FPCA to reduce the complexity of temporal patterns of perturbation responses and to interpret the contribution of genes in the reduced dimensions.</p>
    <p>The cost of sample collection and single-cell sequencing technology is still one of the major obstacles to collecting more longitudinal single-cell data. Yet, we are beginning to see more large-scale longitudinal single-cell experiments due to the popularity of single-cell sequencing technology and the progress of organoid research [<xref rid="ref11" ref-type="bibr">11</xref>]. We have demonstrated the effective performance of CellDrift in the identification of temporal patterns of gene perturbation effects. These temporal changes could be used in conjunction with the clinical events of patients and to facilitate the application of machine learning methods, such as <italic toggle="yes">k</italic>-nearest neighbors, to predict the possibility of certain clinical events of patients before they happen. Notably, other applications of FDA, such as extrapolation and kernel regression, can greatly enhance our ability to evaluate temporal perturbation effects.</p>
    <p>There are several important areas that CellDrift and this evaluation do not address. First, we did not establish the effectiveness of CellDrift in studies with complicated temporal patterns. More sophisticated longitudinal data should be incorporated from real-life experiments and simulations in the future. Additionally, we did not include time as a covariate in the GLM. Instead, the contrast coefficient information was combined from GLM runs of separate time points, which might result in lower statistical power or in increased probability of a type 1 error as well as making the CellDrift procedure cumbersome. This may be an area for future improvement. Additionally, we did not introduce covariance between genes, which would reduce the power of detecting gene correlations of perturbation effects.</p>
  </sec>
  <sec id="sec16">
    <title>Authors’ contributions</title>
    <p>Conceptualization was by K.J, N.S. and B.J.A.; methodology was taken care of by K.J., R.S., D.S. and V.B.S.P.; investigation was done by K.J., G.L. and D.S.; writing was the responsibility of K.J., D.S., G.L., R.S. and B.J.A.; editing was done by D.S., G.L., R.S. and B.J.A.; funding acquisition was done by B.J.A.; resources and data curation were the responsibility of K.J. and R.S.; visualization was by K.J.; and supervision was done by B.J.A.</p>
    <boxed-text id="box01" position="float">
      <sec id="sec18y">
        <title>Key Points</title>
        <list list-type="bullet">
          <list-item>
            <p>GLM with the interaction term enabled the investigation of cell-type-specific perturbation effects.</p>
          </list-item>
          <list-item>
            <p>FDA vastly enhanced the flexibility of temporal analysis of perturbation effects.</p>
          </list-item>
          <list-item>
            <p>GLM-based Fuzzy C-means clustering in CellDrift outperforms other methods in temporal pattern identification of perturbation effects.</p>
          </list-item>
          <list-item>
            <p>Predicted temporal patterns of immune cell responses toward COVID-19 represented time-dependent gene programs.</p>
          </list-item>
        </list>
      </sec>
    </boxed-text>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>Supplementary_figures_bbac324</label>
      <media xlink:href="supplementary_figures_bbac324.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup2" position="float" content-type="local-data">
      <label>Supplementary_Table1_bbac324</label>
      <media xlink:href="supplementary_table1_bbac324.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup3" position="float" content-type="local-data">
      <label>Supplementary_Table2_bbac324</label>
      <media xlink:href="supplementary_table2_bbac324.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup4" position="float" content-type="local-data">
      <label>Supplementary_Table3_bbac324</label>
      <media xlink:href="supplementary_table3_bbac324.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup5" position="float" content-type="local-data">
      <label>supplementary_note_methods_bbac324</label>
      <media xlink:href="supplementary_note_methods_bbac324.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="bbac324-ack">
    <title>Acknowledgements</title>
    <p>We express our appreciation to Dr Kieran R. Campbell and Dr Catherine Blish for their valuable suggestions on the method design. We appreciate suggestions from Dr Emrah Gecili for the manuscript revision. Some figures in <xref rid="f1" ref-type="fig">Figure 1</xref> were generated from BioRender.</p>
  </ack>
  <sec id="sec20">
    <title>Funding</title>
    <p>National Institutes of Health LungMap (HL148865); Digestive Health Center (DK078392); National Cooperative Reprogrammed Cell Research Program (MH104172); Center of Excellence in Molecular Hematology (DK126108).</p>
  </sec>
  <sec sec-type="data-availability" id="sec17">
    <title>Data availability</title>
    <p>The source code and Python package are freely available at <ext-link xlink:href="https://github.com/KANG-BIOINFO/CellDrift" ext-link-type="uri">https://github.com/KANG-BIOINFO/CellDrift</ext-link>. The analysis performed in this paper can be found at <ext-link xlink:href="https://github.com/KANG-BIOINFO/CellDrift_analysis" ext-link-type="uri">https://github.com/KANG-BIOINFO/CellDrift_analysis</ext-link>. The source data can be found in Supplementary <xref rid="sup4" ref-type="supplementary-material">Table S3</xref>.</p>
  </sec>
  <notes id="bio3">
    <title>Author Biographies</title>
    <p><bold>Kang Jin</bold> is a PhD student at the University of Cincinnati. His research interests include developing computational methods in single-cell analysis.</p>
    <sec sec-type="author-bio" id="sec22a">
      <p><bold>Daniel Schnell</bold> is a biostatistician at the Cincinnati Children’s Hospital Medical Center. His research interests include statistical modeling in bioinformatics.</p>
    </sec>
    <sec sec-type="author-bio" id="sec23a">
      <p><bold>Guangyuan Li</bold> is a PhD student at the University of Cincinnati. His research interests include developing computational tools in cancer immunotherapy.</p>
    </sec>
    <sec sec-type="author-bio" id="sec24a">
      <p><bold>Nathan Salomonis</bold> is an associate professor at the Cincinnati Children’s Hospital Medical Center. His research interests are computational genomics and cancer informatics.</p>
    </sec>
    <sec sec-type="author-bio" id="sec25a">
      <p><bold>V. B. Surya Prasath</bold> is an assistant professor in biomedical informatics at the Cincinnati Children’s Hospital Medical Center. His research interests are machine learning and biomedical imaging informatics.</p>
    </sec>
    <sec sec-type="author-bio" id="sec26a">
      <p><bold>Rhonda Szczesniak</bold> is an associate professor in biostatistics at the Cincinnati Children’s Hospital Medical Center. Her research interests are predictive modeling and medical monitoring.</p>
    </sec>
    <sec sec-type="author-bio" id="sec27a">
      <p><bold>Bruce J. Aronow</bold> is a professor at the Cincinnati Children’s Hospital Medical Center. His research interests are bioinformatics and system biology.</p>
    </sec>
  </notes>
  <ref-list id="bib1">
    <title>References</title>
    <ref id="ref1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ren</surname><given-names>X</given-names></string-name>, <string-name><surname>Wen</surname><given-names>W</given-names></string-name>, <string-name><surname>Fan</surname><given-names>X</given-names></string-name>, <etal>et al.</etal></person-group><article-title>COVID-19 immune features revealed by a large-scale single-cell transcriptome atlas</article-title>. <source>Cell</source><year>2021</year>;<volume>184</volume>(<issue>23</issue>):<fpage>5838</fpage>.<pub-id pub-id-type="pmid">34767776</pub-id></mixed-citation>
    </ref>
    <ref id="ref2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tucker</surname><given-names>NR</given-names></string-name>, <string-name><surname>Chaffin</surname><given-names>M</given-names></string-name>, <string-name><surname>Fleming</surname><given-names>SJ</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Transcriptional and cellular diversity of the human heart</article-title>. <source>Circulation</source><year>2020</year>;<volume>142</volume>(<issue>5</issue>):<fpage>466</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">32403949</pub-id></mixed-citation>
    </ref>
    <ref id="ref3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Habermann</surname><given-names>AC</given-names></string-name>, <string-name><surname>Gutierrez</surname><given-names>AJ</given-names></string-name>, <string-name><surname>Bui</surname><given-names>LT</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Single-cell RNA sequencing reveals profibrotic roles of distinct epithelial and mesenchymal lineages in pulmonary fibrosis</article-title>. <source>Sci Adv</source><year>2020</year>;<volume>6</volume>:<fpage>eaba1972</fpage>.<pub-id pub-id-type="pmid">32832598</pub-id></mixed-citation>
    </ref>
    <ref id="ref4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Reyfman</surname><given-names>PA</given-names></string-name>, <string-name><surname>Walter</surname><given-names>JM</given-names></string-name>, <string-name><surname>Joshi</surname><given-names>N</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Single-cell transcriptomic analysis of human lung provides insights into the pathobiology of pulmonary fibrosis</article-title>. <source>Am J Respir Crit Care Med</source><year>2019</year>;<volume>199</volume>(<issue>12</issue>):<fpage>1517</fpage>–<lpage>36</lpage>.<pub-id pub-id-type="pmid">30554520</pub-id></mixed-citation>
    </ref>
    <ref id="ref5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Reyes</surname><given-names>M</given-names></string-name>, <string-name><surname>Filbin</surname><given-names>MR</given-names></string-name>, <string-name><surname>Bhattacharyya</surname><given-names>RP</given-names></string-name>, <etal>et al.</etal></person-group><article-title>An immune-cell signature of bacterial sepsis</article-title>. <source>Nat Med</source><year>2020</year>;<volume>26</volume>(<issue>3</issue>):<fpage>333</fpage>–<lpage>40</lpage>.<pub-id pub-id-type="pmid">32066974</pub-id></mixed-citation>
    </ref>
    <ref id="ref6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Guo</surname><given-names>C</given-names></string-name>, <string-name><surname>Li</surname><given-names>B</given-names></string-name>, <string-name><surname>Ma</surname><given-names>H</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Single-cell analysis of two severe COVID-19 patients reveals a monocyte-associated and tocilizumab-responding cytokine storm</article-title>. <source>Nat Commun</source><year>2020</year>;<volume>11</volume>(<issue>1</issue>):<fpage>3924</fpage>.<pub-id pub-id-type="pmid">32764665</pub-id></mixed-citation>
    </ref>
    <ref id="ref7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bassez</surname><given-names>A</given-names></string-name>, <string-name><surname>Vos</surname><given-names>H</given-names></string-name>, <string-name><surname>Van Dyck</surname><given-names>L</given-names></string-name>, <etal>et al.</etal></person-group><article-title>A single-cell map of intratumoral changes during anti-PD1 treatment of patients with breast cancer</article-title>. <source>Nat Med</source><year>2021</year>;<volume>27</volume>:<fpage>820</fpage>–<lpage>32</lpage>.<pub-id pub-id-type="pmid">33958794</pub-id></mixed-citation>
    </ref>
    <ref id="ref8">
      <label>8.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Paulsen</surname><given-names>B</given-names></string-name>, <string-name><surname>Velasco</surname><given-names>S</given-names></string-name>, <string-name><surname>Kedaigle</surname><given-names>AJ</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Human brain organoids reveal accelerated development of cortical neuron classes as a shared feature of autism risk genes</article-title>. <comment><italic toggle="yes">bioRxiv</italic></comment><year>2020</year>. <pub-id pub-id-type="doi">10.1101/2020.11.10.376509</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Angelidis</surname><given-names>I</given-names></string-name>, <string-name><surname>Simon</surname><given-names>LM</given-names></string-name>, <string-name><surname>Fernandez</surname><given-names>IE</given-names></string-name>, <etal>et al.</etal></person-group><article-title>An atlas of the aging lung mapped by single cell transcriptomics and deep tissue proteomics</article-title>. <source>Nat Commun</source><year>2019</year>;<volume>10</volume>(<issue>1</issue>):<fpage>963</fpage>.<pub-id pub-id-type="pmid">30814501</pub-id></mixed-citation>
    </ref>
    <ref id="ref10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>Y</given-names></string-name>, <string-name><surname>Liu</surname><given-names>X</given-names></string-name>, <string-name><surname>Le</surname><given-names>W</given-names></string-name>, <etal>et al.</etal></person-group><article-title>A human circulating immune cell landscape in aging and COVID-19</article-title>. <source>Protein Cell</source><year>2020</year>;<volume>11</volume>:<fpage>740</fpage>–<lpage>70</lpage>.<pub-id pub-id-type="pmid">32780218</pub-id></mixed-citation>
    </ref>
    <ref id="ref11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ungricht</surname><given-names>R</given-names></string-name>, <string-name><surname>Guibbal</surname><given-names>L</given-names></string-name>, <string-name><surname>Lasbennes</surname><given-names>M-C</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Genome-wide screening in human kidney organoids identifies developmental and disease-related aspects of nephrogenesis</article-title>. <source>Cell Stem Cell</source><year>2022</year>;<volume>29</volume>(<issue>1</issue>):<fpage>160</fpage>–<lpage>75.e7</lpage>.<pub-id pub-id-type="pmid">34847364</pub-id></mixed-citation>
    </ref>
    <ref id="ref12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Paulsen</surname><given-names>B</given-names></string-name>, <string-name><surname>Velasco</surname><given-names>S</given-names></string-name>, <string-name><surname>Kedaigle</surname><given-names>AJ</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Autism genes converge on asynchronous development of shared neuron classes</article-title>. <source>Nature</source><year>2022</year>;<volume>602</volume>(<issue>7896</issue>):<fpage>268</fpage>–<lpage>73</lpage>.<pub-id pub-id-type="pmid">35110736</pub-id></mixed-citation>
    </ref>
    <ref id="ref13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wimmers</surname><given-names>F</given-names></string-name>, <string-name><surname>Donato</surname><given-names>M</given-names></string-name>, <string-name><surname>Kuo</surname><given-names>A</given-names></string-name>, <etal>et al.</etal></person-group><article-title>The single-cell epigenomic and transcriptional landscape of immunity to influenza vaccination</article-title>. <source>Cell</source><year>2021</year>;<volume>184</volume>(<issue>15</issue>):<fpage>3915</fpage>–<lpage>35.e21</lpage>.<pub-id pub-id-type="pmid">34174187</pub-id></mixed-citation>
    </ref>
    <ref id="ref14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kazer</surname><given-names>SW</given-names></string-name>, <string-name><surname>Aicher</surname><given-names>TP</given-names></string-name>, <string-name><surname>Muema</surname><given-names>DM</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Integrated single-cell analysis of multicellular immune dynamics during hyperacute HIV-1 infection</article-title>. <source>Nat Med</source><year>2020</year>;<volume>26</volume>(<issue>4</issue>):<fpage>511</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">32251406</pub-id></mixed-citation>
    </ref>
    <ref id="ref15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>C</given-names></string-name>, <string-name><surname>Martins</surname><given-names>AJ</given-names></string-name>, <string-name><surname>Lau</surname><given-names>WW</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Time-resolved systems immunology reveals a late juncture linked to fatal COVID-19</article-title>. <source>Cell</source><year>2021</year>;<volume>184</volume>(<issue>7</issue>):<fpage>1836</fpage>–<lpage>57.e22</lpage>.<pub-id pub-id-type="pmid">33713619</pub-id></mixed-citation>
    </ref>
    <ref id="ref16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ji</surname><given-names>Y</given-names></string-name>, <string-name><surname>Lotfollahi</surname><given-names>M</given-names></string-name>, <string-name><surname>Wolf</surname><given-names>FA</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Machine learning for perturbational single-cell omics</article-title>. <source>Cell Syst</source><year>2021</year>;<volume>12</volume>(<issue>6</issue>):<fpage>522</fpage>–<lpage>37</lpage>.<pub-id pub-id-type="pmid">34139164</pub-id></mixed-citation>
    </ref>
    <ref id="ref17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Squair</surname><given-names>JW</given-names></string-name>, <string-name><surname>Gautier</surname><given-names>M</given-names></string-name>, <string-name><surname>Kathe</surname><given-names>C</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Confronting false discoveries in single-cell differential expression</article-title>. <source>Nat Commun</source><year>2021</year>;<volume>12</volume>(<issue>1</issue>):<fpage>5692</fpage>.<pub-id pub-id-type="pmid">34584091</pub-id></mixed-citation>
    </ref>
    <ref id="ref18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Finak</surname><given-names>G</given-names></string-name>, <string-name><surname>McDavid</surname><given-names>A</given-names></string-name>, <string-name><surname>Yajima</surname><given-names>M</given-names></string-name>, <etal>et al.</etal></person-group><article-title>MAST: a flexible statistical framework for assessing transcriptional changes and characterizing heterogeneity in single-cell RNA sequencing data</article-title>. <source>Genome Biol</source><year>2015</year>;<volume>16</volume>(<issue>1</issue>):<fpage>278</fpage>.<pub-id pub-id-type="pmid">26653891</pub-id></mixed-citation>
    </ref>
    <ref id="ref19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Crowell</surname><given-names>HL</given-names></string-name>, <string-name><surname>Soneson</surname><given-names>C</given-names></string-name>, <string-name><surname>Germain</surname><given-names>P-L</given-names></string-name>, <etal>et al.</etal></person-group><article-title>muscat detects subpopulation-specific state transitions from multi-sample multi-condition single-cell transcriptomics data</article-title>. <source>Nat Commun</source><year>2020</year>;<volume>11</volume>(<issue>1</issue>):<fpage>6077</fpage>.<pub-id pub-id-type="pmid">33257685</pub-id></mixed-citation>
    </ref>
    <ref id="ref20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lotfollahi</surname><given-names>M</given-names></string-name>, <string-name><surname>Wolf</surname><given-names>FA</given-names></string-name>, <string-name><surname>Theis</surname><given-names>FJ</given-names></string-name></person-group>. <article-title>scGen predicts single-cell perturbation responses</article-title>. <source>Nat Methods</source><year>2019</year>;<volume>16</volume>(<issue>8</issue>):<fpage>715</fpage>–<lpage>21</lpage>.<pub-id pub-id-type="pmid">31363220</pub-id></mixed-citation>
    </ref>
    <ref id="ref21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Velten</surname><given-names>B</given-names></string-name>, <string-name><surname>Braunger</surname><given-names>JM</given-names></string-name>, <string-name><surname>Argelaguet</surname><given-names>R</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Identifying temporal and spatial patterns of variation from multimodal data using MEFISTO</article-title>. <source>Nat Methods</source><year>2022</year>;<volume>19</volume>(<issue>2</issue>):<fpage>179</fpage>–<lpage>86</lpage>.<pub-id pub-id-type="pmid">35027765</pub-id></mixed-citation>
    </ref>
    <ref id="ref22">
      <label>22.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Lotfollahi</surname><given-names>M</given-names></string-name>, <string-name><surname>Susmelj</surname><given-names>AK</given-names></string-name>, <string-name><surname>De Donno</surname><given-names>C</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Learning interpretable cellular responses to complex perturbations in high-throughput screens</article-title>. <comment><italic toggle="yes">bioRxiv</italic></comment><year>2021</year>. <pub-id pub-id-type="doi">10.1101/2021.04.14.439903</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yuan</surname><given-names>B</given-names></string-name>, <string-name><surname>Shen</surname><given-names>C</given-names></string-name>, <string-name><surname>Luna</surname><given-names>A</given-names></string-name>, <etal>et al.</etal></person-group><article-title>CellBox: interpretable machine learning for perturbation biology with application to the design of cancer combination therapy</article-title>. <source>Cell Syst</source><year>2021</year>;<volume>12</volume>(<issue>2</issue>):<fpage>128</fpage>–<lpage>140.e4</lpage>.<pub-id pub-id-type="pmid">33373583</pub-id></mixed-citation>
    </ref>
    <ref id="ref24">
      <label>24.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name name-style="given-only"><given-names>Agresti</given-names></string-name></person-group>. <article-title>Categorical data analysis</article-title>. John Wiley &amp; Sons, <year>2003</year>.</mixed-citation>
    </ref>
    <ref id="ref25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hafemeister</surname><given-names>C</given-names></string-name>, <string-name><surname>Satija</surname><given-names>R</given-names></string-name></person-group>. <article-title>Normalization and variance stabilization of single-cell RNA-seq data using regularized negative binomial regression</article-title>. <source>Genome Biol</source><year>2019</year>;<volume>20</volume>(<issue>1</issue>):<fpage>296</fpage>.<pub-id pub-id-type="pmid">31870423</pub-id></mixed-citation>
    </ref>
    <ref id="ref26">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>J-L</given-names></string-name>, <string-name><surname>Chiou</surname><given-names>J-M</given-names></string-name>, <string-name><surname>Müller</surname><given-names>H-G</given-names></string-name></person-group>. <article-title>Functional data analysis</article-title>. <source>Annu Rev Stat Appl</source><year>2016</year>;<volume>3</volume>(<issue>1</issue>):<fpage>257</fpage>–<lpage>95</lpage>.</mixed-citation>
    </ref>
    <ref id="ref27">
      <label>27.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Kokoszka</surname><given-names>P</given-names></string-name>, <string-name><surname>Reimherr</surname><given-names>M</given-names></string-name></person-group>. <source>Introduction to Functional Data Analysis</source>. Chapman and Hall/CRC. <year>2017</year>.</mixed-citation>
    </ref>
    <ref id="ref28">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>James</surname><given-names>GM</given-names></string-name>, <string-name><surname>Hastie</surname><given-names>TJ</given-names></string-name>, <string-name><surname>Sugar</surname><given-names>CA</given-names></string-name></person-group>. <article-title>Principal component models for sparse functional data</article-title>. <source>Biometrika</source><year>2000</year>;<volume>87</volume>:<fpage>587</fpage>–<lpage>602</lpage>.</mixed-citation>
    </ref>
    <ref id="ref29">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gecili</surname><given-names>E</given-names></string-name>, <string-name><surname>Huang</surname><given-names>R</given-names></string-name>, <string-name><surname>Khoury</surname><given-names>JC</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Functional data analysis and prediction tools for continuous glucose-monitoring studies</article-title>. <source>J Clin Transl Sci</source><year>2020</year>;<volume>5</volume>:<fpage>e51</fpage>.<pub-id pub-id-type="pmid">33948272</pub-id></mixed-citation>
    </ref>
    <ref id="ref30">
      <label>30.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tokushige</surname><given-names>S</given-names></string-name>, <string-name><surname>Yadohisa</surname><given-names>H</given-names></string-name>, <string-name><surname>Inada</surname><given-names>K</given-names></string-name></person-group>. <article-title>Crisp and fuzzy k-means clustering algorithms for multivariate functional data</article-title>. <source>Comput Stat</source><year>2007</year>;<volume>22</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>16</lpage>.</mixed-citation>
    </ref>
    <ref id="ref31">
      <label>31.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Luz López García</surname><given-names>M</given-names></string-name>, <string-name><surname>García-Ródenas</surname><given-names>R</given-names></string-name>, <string-name><surname>González</surname><given-names>GA</given-names></string-name></person-group>. <article-title>K-means algorithms for functional data</article-title>. <source>Neurocomputing</source><year>2015</year>;<volume>151</volume>:<fpage>231</fpage>–<lpage>45</lpage>.</mixed-citation>
    </ref>
    <ref id="ref32">
      <label>32.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ramos-Carreño</surname><given-names>C</given-names></string-name>, <string-name><surname>Torrecilla</surname><given-names>JL</given-names></string-name>, <string-name><surname>Suárez</surname><given-names>A</given-names></string-name></person-group>. <article-title>scikit-fda: a Python package for functional data analysis. Different varimax rotation approaches of functional PCA for the evolution of COVID-19 pandemic in Spain</article-title>. <year>2019</year>;<volume>55</volume>(<issue>1</issue>).</mixed-citation>
    </ref>
    <ref id="ref33">
      <label>33.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>WC</given-names></string-name>, <string-name><surname>Maitra</surname><given-names>R</given-names></string-name>, <string-name><surname>Melnykov</surname><given-names>V</given-names></string-name></person-group>. <article-title>EMCluster: EM algorithm for model-based clustering of finite mixture gaussian distribution</article-title>. <comment>R Package</comment>, <comment>URL <ext-link xlink:href="http://cran" ext-link-type="uri">http://cran</ext-link>. r-project. org/package= EMCluster 2012</comment>.</mixed-citation>
    </ref>
    <ref id="ref34">
      <label>34.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cao</surname><given-names>X</given-names></string-name></person-group>. <article-title>COVID-19: immunopathology and its implications for therapy</article-title>. <source>Nat Rev Immunol</source><year>2020</year>;<volume>20</volume>(<issue>5</issue>):<fpage>269</fpage>–<lpage>70</lpage>.<pub-id pub-id-type="pmid">32273594</pub-id></mixed-citation>
    </ref>
    <ref id="ref35">
      <label>35.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Silvin</surname><given-names>A</given-names></string-name>, <string-name><surname>Chapuis</surname><given-names>N</given-names></string-name>, <string-name><surname>Dunsmore</surname><given-names>G</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Elevated calprotectin and abnormal myeloid cell subsets discriminate severe from mild COVID-19</article-title>. <source>Cell</source><year>2020</year>;<volume>182</volume>(<issue>6</issue>):<fpage>1401</fpage>–<lpage>18.e18</lpage>.<pub-id pub-id-type="pmid">32810439</pub-id></mixed-citation>
    </ref>
    <ref id="ref36">
      <label>36.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>L</given-names></string-name>, <string-name><surname>Long</surname><given-names>X</given-names></string-name>, <string-name><surname>Xu</surname><given-names>Q</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Elevated serum levels of S100A8/A9 and HMGB1 at hospital admission are correlated with inferior clinical outcomes in COVID-19 patients</article-title>. <source>Cell Mol Immunol</source><year>2020</year>;<volume>17</volume>(<issue>9</issue>):<fpage>992</fpage>–<lpage>4</lpage>.<pub-id pub-id-type="pmid">32620787</pub-id></mixed-citation>
    </ref>
    <ref id="ref37">
      <label>37.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bernardes</surname><given-names>JP</given-names></string-name>, <string-name><surname>Mishra</surname><given-names>N</given-names></string-name>, <string-name><surname>Tran</surname><given-names>F</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Longitudinal multi-omics analyses identify responses of megakaryocytes, erythroid cells, and plasmablasts as hallmarks of severe COVID-19</article-title>. <source>Immunity</source><year>2020</year>;<volume>53</volume>(<issue>6</issue>):<fpage>1296</fpage>–<lpage>314.e9</lpage>.<pub-id pub-id-type="pmid">33296687</pub-id></mixed-citation>
    </ref>
    <ref id="ref38">
      <label>38.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Elmentaite</surname><given-names>R</given-names></string-name>, <string-name><surname>Ross</surname><given-names>A</given-names></string-name>, <string-name><surname>James</surname><given-names>KR</given-names></string-name>, <etal>et al</etal></person-group>. <article-title>Single-cell sequencing of developing human gut reveals transcriptional links to childhood Crohn’s disease</article-title>. Dev. Cell 2020; <volume>55</volume>:771–783.e5.</mixed-citation>
    </ref>
    <ref id="ref39">
      <label>39.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>K</given-names></string-name>, <string-name><surname>Daniels</surname><given-names>J</given-names></string-name>, <string-name><surname>Liu</surname><given-names>C</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Convolutional recurrent neural networks for glucose prediction</article-title>. <source>IEEE J Biomed Health Inform</source><year>2020</year>;<volume>24</volume>(<issue>2</issue>):<fpage>603</fpage>–<lpage>13</lpage>.<pub-id pub-id-type="pmid">30946685</pub-id></mixed-citation>
    </ref>
    <ref id="ref40">
      <label>40.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pérez-Gandía</surname><given-names>C</given-names></string-name>, <string-name><surname>Facchinetti</surname><given-names>A</given-names></string-name>, <string-name><surname>Sparacino</surname><given-names>G</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Artificial neural network algorithm for online glucose prediction from continuous glucose monitoring</article-title>. <source>Diabetes Technol Ther</source><year>2010</year>;<volume>12</volume>(<issue>1</issue>):<fpage>81</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">20082589</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
