<?properties open_access?>
<?subarticle report47470?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v3.0 20080202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing3.dtd?>
<?SourceDTD.Version 3.0?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">F1000Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">F1000Res</journal-id>
    <journal-id journal-id-type="pmc">F1000Research</journal-id>
    <journal-title-group>
      <journal-title>F1000Research</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2046-1402</issn>
    <publisher>
      <publisher-name>F1000 Research Limited</publisher-name>
      <publisher-loc>London, UK</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6480952</article-id>
    <article-id pub-id-type="doi">10.12688/f1000research.18458.2</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software Tool Article</subject>
      </subj-group>
      <subj-group>
        <subject>Articles</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>3D based on 2D: Calculating helix angles and stacking patterns using
<italic>forgi 2.0</italic>, an RNA Python library centered on secondary structure elements.</article-title>
      <fn-group content-type="pub-status">
        <fn>
          <p>[version 2; peer review: 2 approved]</p>
        </fn>
      </fn-group>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Thiel</surname>
          <given-names>Bernhard C.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Data Curation</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Writing – Original Draft Preparation</role>
        <role content-type="http://credit.casrai.org/">Writing – Review &amp; Editing</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-7858-5075</contrib-id>
        <xref ref-type="aff" rid="a1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Beckmann</surname>
          <given-names>Irene K.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Data Curation</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Writing – Original Draft Preparation</role>
        <role content-type="http://credit.casrai.org/">Writing – Review &amp; Editing</role>
        <xref ref-type="aff" rid="a1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kerpedjiev</surname>
          <given-names>Peter</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Writing – Review &amp; Editing</role>
        <xref ref-type="aff" rid="a2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hofacker</surname>
          <given-names>Ivo L.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Funding Acquisition</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – Review &amp; Editing</role>
        <xref ref-type="corresp" rid="c1">a</xref>
        <xref ref-type="aff" rid="a1">1</xref>
        <xref ref-type="aff" rid="a3">3</xref>
      </contrib>
      <aff id="a1"><label>1</label>Department of Theoretical Chemistry, Faculty of Chemistry, University of Vienna, Vienna, 1090, Austria</aff>
      <aff id="a2"><label>2</label>Department of Biomedical Informatics, Harvard Medical School, Boston, Massachusetts, 02115, USA</aff>
      <aff id="a3"><label>3</label>Research Group Bioinformatics and Computational Biology, Faculty of Computer Science, University of Vienna, Vienna, 1090, Austria</aff>
    </contrib-group>
    <author-notes>
      <corresp id="c1">
        <label>a</label>
        <email xlink:href="mailto:ivo@tbi.univie.ac.at">ivo@tbi.univie.ac.at</email>
      </corresp>
      <fn fn-type="COI-statement">
        <p>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>23</day>
      <month>4</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>8</volume>
    <elocation-id>ISCB Comm J-287</elocation-id>
    <history>
      <date date-type="accepted">
        <day>4</day>
        <month>4</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright: © 2019 Thiel BC et al.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:type="simple" xlink:href="f1000research-8-20631.pdf"/>
    <abstract>
      <p>We present
<italic>forgi</italic>, a Python library to analyze the tertiary structure of RNA secondary structure elements. Our representation of an RNA molecule is centered on secondary structure elements (stems, bulges and loops). By fitting a cylinder to the helix axis, these elements are carried over into a coarse-grained 3D structure representation. Integration with Biopython allows for handling of all-atom 3D information.
<italic>forgi</italic> can deal with a variety of file formats including dotbracket strings, PDB and MMCIF files. We can handle modified residues, missing residues, cofold and multifold structures as well as nucleotide numbers starting at arbitrary positions. We apply this library to the study of stacking helices in junctions and pseudoknots and investigate how far stacking helices in solved experimental structures can divert from coaxial geometries.</p>
    </abstract>
    <kwd-group kwd-group-type="author">
      <kwd>RNA</kwd>
      <kwd>Python</kwd>
      <kwd>RNA tertiary structure</kwd>
      <kwd>RNA secondary structure</kwd>
      <kwd>coaxial stacking</kwd>
      <kwd>pseudo knots</kwd>
    </kwd-group>
    <funding-group>
      <award-group id="fund-1" xlink:href="http://dx.doi.org/10.13039/501100002428">
        <funding-source>Austrian Science Fund</funding-source>
        <award-id>W1207</award-id>
        <award-id>I2874</award-id>
        <award-id>F43</award-id>
      </award-group>
      <funding-statement>This work was partly funded by the Austrian science fund (FWF) projects F 43 “RNA regulation of the transcriptome” and I 2874 “Prediction of RNA-RNA interactions” and Doctoral College W 1207 “RNA Biology”.</funding-statement>
      <funding-statement>
        <italic>The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</italic>
      </funding-statement>
    </funding-group>
  </article-meta>
  <notes notes-type="version-changes">
    <sec sec-type="version-changes">
      <label>Revised</label>
      <title>Amendments from Version 1</title>
      <p>As requested by reviewer 1 we include the exact formulas and complete code used to compute angles between helices.</p>
    </sec>
  </notes>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>In RNA 3D structure prediction, knowledge-based potentials are commonly used, especially for coarse-grained approaches that are suitable for larger RNA molecules
<sup><xref rid="ref-1" ref-type="bibr">1</xref></sup>. The creation of such potentials requires knowledge extraction from solved RNA structures, usually taken from the Protein Data Bank (PDB)
<sup><xref rid="ref-2" ref-type="bibr">2</xref></sup>. PDB files and their newer replacement, MMCIF files, contain atomic coordinates and additional information in the header fields, but do not contain any base-pairing annotations. To extract information about base pairs and their types
<sup><xref rid="ref-3" ref-type="bibr">3</xref></sup>, dedicated software like MC-Annotate
<sup><xref rid="ref-4" ref-type="bibr">4</xref></sup>, RNAView
<sup><xref rid="ref-5" ref-type="bibr">5</xref></sup>, FR3D
<sup><xref rid="ref-6" ref-type="bibr">6</xref></sup>, DSSR
<sup><xref rid="ref-7" ref-type="bibr">7</xref></sup> or the RNApdbee web server
<sup><xref rid="ref-8" ref-type="bibr">8</xref></sup> is required. Due to the hierarchical organization of the RNA energy landscape
<sup><xref rid="ref-9" ref-type="bibr">9</xref></sup>, it is often most convenient to treat secondary and tertiary structure of RNA molecules separately and predict tertiary structures given a secondary structure
<sup><xref rid="ref-10" ref-type="bibr">10</xref></sup>.</p>
    <p>For knowledge extraction from RNA-containing PDB files, it is highly desirable to have a software library at hand, which understands the semantics of RNA secondary structures and makes tasks like iterating over loops of a certain type straightforward. Ideally, such a library should be written in an easily accessible scripting language, be well documented and tested and should be available under an open-source license.</p>
    <p>Libraries other than the
<monospace>forgi</monospace> library presented here only partly fill these needs. The Vienna RNA package
<sup><xref rid="ref-11" ref-type="bibr">11</xref></sup> can be used to predict secondary structures from sequence, including advanced features like G-Quadruplex prediction and incorporation of SHAPE data. It provides Python and Perl bindings, but deals exclusively with secondary structure. Biopython
<sup><xref rid="ref-12" ref-type="bibr">12</xref>,
<xref rid="ref-13" ref-type="bibr">13</xref></sup> is useful for dealing with RNA sequence data and can be used to load RNA 3D structures, but has no dedicated support for RNA secondary structure. PyCogent
<sup><xref rid="ref-14" ref-type="bibr">14</xref></sup>, a library for genomic biology, has extensive support for nucleic acid sequences, but contains only a lightweight class for RNA secondary structures and code for pseudoknot removal
<sup><xref rid="ref-15" ref-type="bibr">15</xref></sup>. A stand-alone version of the latter was included into the
<monospace>forgi</monospace> library under the terms of the GNU General Public License 3.0. More specialized libraries include
<monospace>modeRNA</monospace>
<sup><xref rid="ref-16" ref-type="bibr">16</xref></sup> (homology modeling, Python) and the FR3D suite
<sup><xref rid="ref-6" ref-type="bibr">6</xref></sup> (RNA motif search, Matlab). Here, we present the
<monospace>forgi</monospace> library
<sup><xref rid="ref-17" ref-type="bibr">17</xref></sup>, which is centered on RNA secondary structure elements (such as stems, bulges and loops) and makes them usable for 3D structure analysis.
<monospace>forgi</monospace> aims at providing a high level API for many common operations, but can be easily extended with new functionality. The flexibility of providing an open source library in a scripting language is a clear benefit over other programs that are only distributed as binaries. While not restricted to work with PDB or MMCIF files,
<monospace>forgi</monospace> shines especially where 3D information is analyzed in the context of its secondary structure environment.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>Implementation</title>
      <p>The
<monospace>forgi</monospace> library
<sup><xref rid="ref-17" ref-type="bibr">17</xref></sup> is strongly object-oriented, but takes advantage of module-level Python functions where appropriate. The core object representing the secondary structure is the
<monospace>BulgeGraph</monospace> object, which holds a
<monospace>Sequence</monospace> instance for the primary sequence. To include secondary structure based 3D coordinates, the
<monospace>BulgeGraph</monospace>’s subclass,
<monospace>CoarseGrainRNA</monospace> is available. For all-atom 3D analysis, the
<monospace>forgi</monospace> library has a built-in integration with Biopython.</p>
      <p>We will briefly describe the three main data structures that hold the sequence, secondary structure and the tertiary structure representation of an RNA.</p>
      <p><bold><italic>Primary structure: The
<monospace>Sequence</monospace> class.</italic></bold> Each
<monospace>BulgeGraph</monospace> holds a
<monospace>Sequence</monospace> object. Since
<monospace>forgi</monospace> supports loading of data from PDB files (see below), this
<monospace>Sequence</monospace> object has to account for many special cases arising from experimental considerations, which will be detailed in the following paragraphs. There are two numbering schemes commonly used for sequences: 1-based indexing and indexing based on an external reference. In particular, many sequences in structural experiments use “1” to dedicate the first residue of a biological macro-molecule, whereas the first residue actually used in the experiment can be upstream of the functional RNA (leading to negative indices) or after the start of the biological unit (leading to an index above 1). The latter is especially common if fragments of larger RNA molecules like the ribosome are studied. Finally, experimenters might decide to insert nucleotides in the middle of a molecule. In order not to affect the numbering of subsequent residues, these inserted residues get the same number as the previous one, followed by a letter (called insertion code).</p>
      <p>To handle both kinds of indexing, the
<monospace>Sequence</monospace> class distinguishes indices by type. Integer indices always refer to 1-based indexing, while tuples compatible to the indices used in Biopython’s PDB module are interpreted as the second kind of indices.</p>
      <p>For many applications, it is necessary to restrict the RNA alphabet to 4 letters (i.e. 4 residue types), “G”, “C”, “A” and “U”. However, in the cell many RNA molecules are post-transcriptionally modified at certain positions. Many modifications, including the methylation of OH or NH
<sub>2</sub> groups and A to I editing, have been implicated with a variety of biological functions
<sup><xref rid="ref-18" ref-type="bibr">18</xref></sup>. During parsing of PDB files, we automatically convert such modified residues to the unmodified parent, but in addition store the modification as an annotation in the
<monospace>Sequence</monospace> object. The corresponding unmodified parents for 3-letter codes of common modified residues were obtained from PDBeChem
<sup><xref rid="ref-19" ref-type="bibr">19</xref></sup> (
<ext-link ext-link-type="uri" xlink:href="http://www.ebi.ac.uk/pdbe-srv/pdbechem/">http://www.ebi.ac.uk/pdbe-srv/pdbechem/</ext-link>) and the
<monospace>forgi</monospace> library has the ability to query this database on the fly if it encounters a new 3-letter code.</p>
      <p>Finally, many experimental 3D structures do not contain coordinates for all residues present in the experiment. The
<monospace>forgi</monospace>
<monospace>Sequence</monospace> class can store two version of the sequence, with and without missing residues, and the file parser can extract this information from PDB and MMCIF files.</p>
      <p>The secondary structure of an RNA is internally represented as a graph, the Bulge Graph, where secondary structure elements (stems, single-stranded regions, interior loops and hairpin loops) form the nodes. Whenever these elements are adjacent along the backbone, they are connected by an edge in this graph. During the Bulge Graph creation, each node gets a unique name such as “s0” for the first stem or “h0” for the first hairpin. The concept of the Bulge Graph, illustrated in
<xref ref-type="fig" rid="f1">Figure 1</xref>, has been described previously in more detail
<sup><xref rid="ref-20" ref-type="bibr">20</xref></sup> and is related to the independently developed RAG (RNA as Graph) approach
<sup><xref rid="ref-21" ref-type="bibr">21</xref></sup>.</p>
      <fig fig-type="figure" id="f1" orientation="portrait" position="float">
        <label>Figure 1. </label>
        <caption>
          <title>Illustration of the Bulge Graph representation underlying the
<monospace>forgi</monospace> library.</title>
          <p>Secondary structure elements (stems, bulges and single-stranded regions) are nodes connected by edges. The sequence is shown around the Bulge Graph.</p>
        </caption>
        <graphic xlink:href="f1000research-8-20631-g0000"/>
      </fig>
      <p><monospace>forgi</monospace> supports element-based transformations of the Bulge Graph, such as condensing the secondary structure to an representation similar to RNAshapes
<sup><xref rid="ref-22" ref-type="bibr">22</xref></sup>, which we use to classify pseudoknots, for example (see below).</p>
      <p>The
<monospace>BulgeGraph</monospace> object allows for easy identification, selection and classification of structural domains, such as multi loops, helices consisting of multiple stems and bulges (termed “rods” in
<monospace>forgi</monospace>), and pseudoknots.</p>
      <p><bold><italic>The
<monospace>CoarseGrainRNA</monospace> class holds 3D structures.</italic></bold> 3D structures are loaded from PDB or MMCIF files using Biopython’s PDB module
<sup><xref rid="ref-13" ref-type="bibr">13</xref></sup>. In order to assign a secondary structure to the RNA,
<monospace>forgi</monospace> can call either MC-Annotate
<sup><xref rid="ref-4" ref-type="bibr">4</xref></sup> (Linux only, no MMCIF-support, binary available at
<ext-link ext-link-type="uri" xlink:href="http://major.iric.ca/MajorLabEn/MC-Tools.html">http://major.iric.ca/MajorLabEn/MC-Tools.html</ext-link>) or DSSR
<sup><xref rid="ref-7" ref-type="bibr">7</xref></sup> (binary available after free registration at
<ext-link ext-link-type="uri" xlink:href="http://forum.x3dna.org">http://forum.x3dna.org</ext-link>). As an alternative,
<monospace>forgi</monospace> has a built-in heuristic for the detection of canonical base pairs and GU wobble pairs. This heuristic is based on distances along the hydrogen bonds and the coplanarity of the bases, and is not intended to compete with the power of more specialized tools since it will fail in some edge cases, e.g. involving modified residues or residues with missing atoms. This heuristic is a useful fallback, if the above mentioned programs are not available.</p>
      <p>During loading of the RNA, a helix axis is assigned to stems as described previously
<sup><xref rid="ref-20" ref-type="bibr">20</xref></sup>. For each stem, we store start and end coordinates of the helix axis as well as two twist vectors that point towards the minor groove at the beginning and the end of the stem. Similarly, start and end coordinates for bulges, loops and single-stranded regions are stored and can be accessed using the element’s name.</p>
      <p><monospace>forgi</monospace> 2.0 now fully supports co- and multi-fold structures and can load multiple chains that are connected by base pairs into a single
<monospace>CoarseGrainRNA</monospace> object, while chains not connected by any base pair are loaded into separate objects.</p>
      <p>Using Biopython’s KD-Tree implementation (
<monospace>Bio.PDB.NeighborSearch</monospace>), a list of residues within 6 angstrom from a non-RNA C or N atom is obtained. These residues are considered protein-/ligand interacting. Knowledge of interacting residues is particularly useful to avoid biases in statistics about structural features of bare RNA.</p>
      <p>A cleaned version of the PDB - with modified residues converted to their canonical parent and non-RNA molecules removed is stored as Biopython chains in the
<monospace>CoarseGrainRNA</monospace>’s
<monospace>chains</monospace> attribute.</p>
    </sec>
    <sec>
      <title>Operation</title>
      <p><monospace>forgi</monospace><sup><xref rid="ref-17" ref-type="bibr">17</xref></sup> is compatible with Python 2.7, 3.5 and 3.6, should run on all operating systems where its dependencies are available and has been tested on Linux, Mac and Windows. It makes heavy use of the NumPy
<sup><xref rid="ref-23" ref-type="bibr">23</xref></sup> library to speed-up array-based calculations and also depends on SciPy
<sup><xref rid="ref-24" ref-type="bibr">24</xref></sup>, NetworkX
<sup><xref rid="ref-25" ref-type="bibr">25</xref></sup>, Biopython
<sup><xref rid="ref-12" ref-type="bibr">12</xref>,
<xref rid="ref-13" ref-type="bibr">13</xref></sup>, pandas
<sup><xref rid="ref-26" ref-type="bibr">26</xref>,
<xref rid="ref-27" ref-type="bibr">27</xref></sup> and
<monospace>appdirs</monospace>, all available via the Python Package Index (PyPi) or Anaconda.</p>
      <p><bold><italic>Helpful utility scripts.</italic></bold><monospace>forgi</monospace> comes with the two very useful scripts:
<monospace>rnaConvert.py</monospace> can be used to convert between many common file formats for RNA structures, including the Vienna format and fasta variants, the bpseq format, the connectivity table (ct) format, MMCIF format and PDB files.
<monospace>visualize_rna.py</monospace> can be used to display a coarse-grained representation of an RNA’s secondary structure in
<ext-link ext-link-type="uri" xlink:href="https://www.pymol.org">PyMol</ext-link> alongside the all atom structure from PDB files, producing visualizations like those in
<xref ref-type="fig" rid="f3">Figure 3</xref> and
<xref ref-type="fig" rid="f5">Figure 5</xref>.</p>
      <p><bold><italic>Analysis of stacking geometries.</italic></bold> To illustrate how the
<monospace>forgi</monospace> library makes secondary structure elements usable for 3D structure analysis, we used it to analyze the stacking of adjacent helices in multi loops and pseudoknots in a representative set of RNA 3D structures
<sup><xref rid="ref-28" ref-type="bibr">28</xref></sup> (version 3.36, available at
<ext-link ext-link-type="uri" xlink:href="http://rna.bgsu.edu/rna3dhub/nrlist/">http://rna.bgsu.edu/rna3dhub/nrlist/</ext-link>).</p>
      <p>While loading these 3D structures into
<monospace>forgi</monospace>, DSSR
<sup><xref rid="ref-7" ref-type="bibr">7</xref></sup> (Version v1.7.1-2017nov01) was called to obtain the secondary structure and nucleotide level reference stacking annotations. We count a pair of connected helices as stacking, if at least one nucleotide of the first helix’s closing/opening base pair is in a continuous stack with at least one nucleotide of the second helix’s opening/closing base pair. This allows for any number of stacking nucleotides between the stems (not necessarily connected via the backbone) and for bulged out nucleotides which do not contribute to the stack. Our definition of stacking is more relaxed than stricter criteria used elsewhere
<sup><xref rid="ref-29" ref-type="bibr">29</xref></sup>.</p>
      <p>For each pair of adjacent stems within a junction, we used
<monospace>forgi</monospace> to calculate a number of properties, such as the angle between the stem vectors, the separation vector between the stems’ ends and an offset value between the stems.</p>
      <p>These properties are based on the axes that were fitted to the helices (see above) and the multi loop segment that connects the two stems. We define the stem vectors
<bold><italic>v</italic></bold>
<italic><sub>h</sub></italic> as pointing away from the multi loop segment along the helix axis, where
<bold><italic>s</italic></bold>
<italic><sub>h</sub></italic> and
<bold><italic>e</italic></bold>
<italic><sub>h</sub></italic> are the helix’s start and end coordinates.</p>
      <p>
        <disp-formula>
          <mml:math id="math1">
            <mml:mrow>
              <mml:msub>
                <mml:mi mathvariant="bold-italic">v</mml:mi>
                <mml:mi>h</mml:mi>
              </mml:msub>
              <mml:mspace width="0.2em"/>
              <mml:mo>=</mml:mo>
              <mml:mspace width="0.2em"/>
              <mml:mspace width="0.2em"/>
              <mml:mrow>
                <mml:mo>{</mml:mo>
                <mml:mtable columnalign="left">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:msub>
                        <mml:mi mathvariant="bold-italic">e</mml:mi>
                        <mml:mi>h</mml:mi>
                      </mml:msub>
                      <mml:mspace width="0.2em"/>
                      <mml:mo>–</mml:mo>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:msub>
                        <mml:mi mathvariant="bold-italic">s</mml:mi>
                        <mml:mi>h</mml:mi>
                      </mml:msub>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:mtext>if</mml:mtext>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:msub>
                        <mml:mi mathvariant="bold-italic">s</mml:mi>
                        <mml:mi>h</mml:mi>
                      </mml:msub>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:mtext>is</mml:mtext>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:mtext>at</mml:mtext>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:mtext>the</mml:mtext>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:mtext>side</mml:mtext>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:mtext>of</mml:mtext>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:mtext>the</mml:mtext>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:mtext>multiloop</mml:mtext>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:msub>
                        <mml:mi mathvariant="bold-italic">s</mml:mi>
                        <mml:mi>h</mml:mi>
                      </mml:msub>
                      <mml:mspace width="0.2em"/>
                      <mml:mo>–</mml:mo>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:msub>
                        <mml:mi mathvariant="bold-italic">e</mml:mi>
                        <mml:mi>h</mml:mi>
                      </mml:msub>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:mtext>if</mml:mtext>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:msub>
                        <mml:mi mathvariant="bold-italic">e</mml:mi>
                        <mml:mi>h</mml:mi>
                      </mml:msub>
                      <mml:mspace width="0.2em"/>
                      <mml:mtext>is</mml:mtext>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:mtext>at</mml:mtext>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:mtext>the</mml:mtext>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:mtext>side</mml:mtext>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:mtext>of</mml:mtext>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:mtext>the</mml:mtext>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:mtext>multiloop</mml:mtext>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>The angle between the adjacent stems
<italic>i</italic> and
<italic>h</italic> is then defined as the angle between their stem vectors
<bold><italic>v</italic></bold>
<italic><sub>i</sub></italic> and
<bold><italic>v</italic></bold>
<italic><sub>h</sub></italic>:</p>
      <p>
        <disp-formula id="M">
          <mml:math id="M1">
            <mml:mrow>
              <mml:mtext>cos</mml:mtext>
              <mml:mi>
</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>α</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mspace width="0.2em"/>
              <mml:mo>=</mml:mo>
              <mml:mspace width="0.2em"/>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi mathvariant="bold-italic">v</mml:mi>
                    <mml:mi>h</mml:mi>
                  </mml:msub>
                  <mml:mo>⋅</mml:mo>
                  <mml:msub>
                    <mml:mi mathvariant="bold-italic">v</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:msub>
                </mml:mrow>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mo>‖</mml:mo>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi mathvariant="bold-italic">v</mml:mi>
                        <mml:mi>h</mml:mi>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mo>‖</mml:mo>
                  </mml:mrow>
                  <mml:mo>⋅</mml:mo>
                  <mml:mrow>
                    <mml:mo>‖</mml:mo>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi mathvariant="bold-italic">v</mml:mi>
                        <mml:mi>i</mml:mi>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mo>‖</mml:mo>
                  </mml:mrow>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>The offset between stems is calculated as distance between two rays
<italic>R
<sub>h</sub></italic> that start at the helix’s end closer to the multi loop segment,
<bold><italic>c</italic></bold>
<italic><sub>h</sub></italic>, and extend the helix axis:</p>
      <p>
        <disp-formula>
          <mml:math id="math5">
            <mml:mrow>
              <mml:msub>
                <mml:mi mathvariant="bold-italic">c</mml:mi>
                <mml:mi>h</mml:mi>
              </mml:msub>
              <mml:mspace width="0.2em"/>
              <mml:mo>=</mml:mo>
              <mml:mspace width="0.2em"/>
              <mml:mspace width="0.2em"/>
              <mml:mrow>
                <mml:mo>{</mml:mo>
                <mml:mtable columnalign="left">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:msub>
                        <mml:mi mathvariant="bold-italic">s</mml:mi>
                        <mml:mi>h</mml:mi>
                      </mml:msub>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:mtext>if</mml:mtext>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:msub>
                        <mml:mi mathvariant="bold-italic">s</mml:mi>
                        <mml:mi>h</mml:mi>
                      </mml:msub>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:mtext>is</mml:mtext>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:mtext>at</mml:mtext>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:mtext>the</mml:mtext>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:mtext>side</mml:mtext>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:mtext>of</mml:mtext>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:mtext>the</mml:mtext>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:mtext>multiloop</mml:mtext>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:msub>
                        <mml:mi mathvariant="bold-italic">e</mml:mi>
                        <mml:mi>h</mml:mi>
                      </mml:msub>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:mtext>if</mml:mtext>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:msub>
                        <mml:mi mathvariant="bold-italic">e</mml:mi>
                        <mml:mi>h</mml:mi>
                      </mml:msub>
                      <mml:mspace width="0.2em"/>
                      <mml:mtext>is</mml:mtext>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:mtext>at</mml:mtext>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:mtext>the</mml:mtext>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:mtext>side</mml:mtext>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:mtext>of</mml:mtext>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:mtext>the</mml:mtext>
                      <mml:mspace width="0.2em"/>
                      <mml:mspace width="0.2em"/>
                      <mml:mtext>multiloop</mml:mtext>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula>
          <mml:math id="math3">
            <mml:mrow>
              <mml:msub>
                <mml:mi>R</mml:mi>
                <mml:mi>h</mml:mi>
              </mml:msub>
              <mml:mspace width="0.2em"/>
              <mml:mo>=</mml:mo>
              <mml:mspace width="0.2em"/>
              <mml:mrow>
                <mml:mo>{</mml:mo>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">X</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mi mathvariant="bold-italic">X</mml:mi>
                  <mml:mspace width="0.2em"/>
                  <mml:mo>=</mml:mo>
                  <mml:mspace width="0.2em"/>
                  <mml:msub>
                    <mml:mi mathvariant="bold-italic">c</mml:mi>
                    <mml:mi>h</mml:mi>
                  </mml:msub>
                  <mml:mspace width="0.2em"/>
                  <mml:mo>+</mml:mo>
                  <mml:mspace width="0.2em"/>
                  <mml:mi>λ</mml:mi>
                  <mml:msub>
                    <mml:mi mathvariant="bold-italic">v</mml:mi>
                    <mml:mi>h</mml:mi>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:mspace width="0.2em"/>
                  <mml:mi>λ</mml:mi>
                  <mml:mspace width="0.2em"/>
                  <mml:mspace width="0.2em"/>
                  <mml:mo>≥</mml:mo>
                  <mml:mspace width="0.2em"/>
                  <mml:mn>0</mml:mn>
                </mml:mrow>
                <mml:mo>}</mml:mo>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>Depending on the helix orientation, the distance between these rays is either the distance between two lines or the distance between two points or between one point and one line, all of which can be calculated with standard formulas.</p>
      <p>The following code shows how
<monospace>forgi</monospace> was used to calculate these properties for multi loops:</p>
      <p>
        <preformat><styled-content style="font-size:15px;color:#000000; font-weight:bold;">from</styled-content> forgi <styled-content style="font-size:15px;color:#000000; font-weight:bold;">import</styled-content> load_rna
<styled-content style="font-size:15px;color:#000000; font-weight:bold;">from</styled-content> forgi.threedee.utilities.vector <styled-content style="font-size:15px;color:#000000; font-weight:bold;">import</styled-content> vec_angle, vec_distance
<styled-content style="font-size:15px;color:#000000; font-weight:bold;">from</styled-content> forgi.threedee.utilities.vector <styled-content style="font-size:15px;color:#000000; font-weight:bold;">import</styled-content> line_segment_distance

<styled-content style="font-size:15px;color:#000000; font-weight:bold;">def</styled-content> main():
    <styled-content style="font-size:15px;color:#000000; font-style:italic"># Load the PDB into CoarseGrainRNA instances</styled-content>
    <styled-content style="font-size:15px;color:#000000; font-style:italic"># rnas is a list, because a PDB can contain multiple connected components</styled-content> 
    <styled-content style="font-size:15px;color:#000000; font-style:italic"># This also loads the DSSR json annotations.</styled-content>
    rnas = load_rna(<styled-content style="font-size:15px;color:#009900;">"path/to/file.cif"</styled-content>, pdb_remove_pk=False,
                    pdb_annotation_tool=<styled-content style="font-size:15px;color:#009900;">"DSSR"</styled-content>)
    <styled-content style="font-size:15px;color:#000000; font-weight:bold;">for</styled-content> rna <styled-content style="font-size:15px;color:#000000; font-weight:bold;">in</styled-content> rnas:
        <styled-content style="font-size:15px;color:#000000; font-weight:bold;">for</styled-content> junction <styled-content style="font-size:15px;color:#000000; font-weight:bold;">in</styled-content> rna.junctions:
             print_junction_parameters(rna, junction)
          
<styled-content style="font-size:15px;color:#000000; font-weight:bold;">
def</styled-content> print_junction_parameters(rna, junction):
    <styled-content style="font-size:15px;color:#009900;">"""</styled-content>
    <styled-content style="font-size:15px;color:#009900;">Prints the angles and offsets of a junction.</styled-content>
    <styled-content style="font-size:15px;color:#009900;">:param rna: A BulgeGraph Object</styled-content>
    <styled-content style="font-size:15px;color:#009900;">:param junction: A list of element names (strings)</styled-content>
    <styled-content style="font-size:15px;color:#009900;">"""</styled-content>
    <styled-content style="font-size:15px;color:#000000; font-weight:bold;">for</styled-content> ml <styled-content style="font-size:15px;color:#000000; font-weight:bold;">in</styled-content> junction:
        <styled-content style="font-size:15px;color:#000000; font-style:italic"># rna.edges holds adjacent nodes in the BulgeGraph</styled-content>
        stem1, stem2 = rna.edges[ml]
        <styled-content style="font-size:15px;color:#000000; font-style:italic"># rna.coords holds the 3D coordinates of structure elements</styled-content>
        <styled-content style="font-size:15px;color:#000000; font-style:italic"># rna.coords["s0"] returns a tuple start-, end-coordinates of stem "s0"</styled-content>
        <styled-content style="font-size:15px;color:#000000; font-style:italic"># Furthermore rna.coords has the get_direction function to give the</styled-content>
        <styled-content style="font-size:15px;color:#000000; font-style:italic"># vector pointing from the start to the end coordinate.</styled-content>
        direction1 = rna.coords.get_direction(stem1)
        direction2 = rna.coords.get_direction(stem2)
        <styled-content style="font-size:15px;color:#000000; font-style:italic"># Get the indices into rna.coords for the stem sides closer to</styled-content>
        <styled-content style="font-size:15px;color:#000000; font-style:italic"># and further away from the multiloop segment ml</styled-content>
        c1, f1 = rna.get_sides(stem1, ml)
        c2, f2 = rna.get_sides(stem2, ml)
        <styled-content style="font-size:15px;color:#000000; font-style:italic"># Make sure the stem vector points away from the multiloop</styled-content>
        <styled-content style="font-size:15px;color:#000000; font-weight:bold;">if</styled-content> c1 == 1:
            direction1 = - direction1
        <styled-content style="font-size:15px;color:#000000; font-weight:bold;">if</styled-content> c2 == 1:
            direction2 = - direction2
        angle = vec_angle(direction1, direction2) <styled-content style="font-size:15px;color:#000000; font-style:italic"># imported above</styled-content>
        is_stacking_dssr = (ml <styled-content style="font-size:15px;color:#000000; font-weight:bold;">in</styled-content> rna.dssr.stacking_loops())
        closer1 = rna.coords[stem1][c1]
        closer2 = rna.coords[stem2][c2]
        <styled-content style="font-size:15px;color:#000000; font-style:italic"># Calculate the offset as distance between rays.</styled-content>
        offset = vec_distance(*line_segment_distance(
                                  closer1, closer1+100000*direction1,
                                  closer2, closer2+100000*direction2))
        print(<styled-content style="font-size:15px;color:#009900;">"{}\t{}\t{}"</styled-content>.format(angle, is_stacking_dssr, offset))</preformat>
      </p>
      <p>We then used pandas
<sup><xref rid="ref-26" ref-type="bibr">26</xref>,
<xref rid="ref-27" ref-type="bibr">27</xref></sup>, Matplotlib
<sup><xref rid="ref-30" ref-type="bibr">30</xref></sup> and a custom library (
<ext-link ext-link-type="uri" xlink:href="https://github.com/Bernhard10/filterAndView">https://github.com/Bernhard10/filterAndView</ext-link>) to analyze and visualize the collected data. The results were collected for different classes of RNA independently. This was necessary, because the representative sets of RNA structures contain, by design, homologs of the same molecule in multiple species.</p>
      <p>For the classification of pseudoknots, Reidys’ concept
<sup><xref rid="ref-31" ref-type="bibr">31</xref></sup> based on the definition of the mathematical genus is used. Classes of pseudoknots are defined based on their shadow representations, which contain only crossing base pairs and only one base pair each. On the level of these shadows, only four distinct classes exhibit genus 1, two of which are well known: the H-type pseudoknot and the kissing hairpin. pseudoknots with higher genus contain, among others, the case where a genus 1 pseudoknot is nested within another pseudoknot.</p>
      <p>In combination with the
<monospace>forgi</monospace> library, we wrote a tool that is able to convert structures to their shadow representation, identify and classify the pseudoknots within the structure and describe their helix arrangement in the 3D structure. This tool, called
<monospace>pseudoknot_analyzer.py</monospace>, is distributed with the
<monospace>forgi</monospace> library in the folder “examples”. We used it to gather statistics about simple H-type and kissing hairpin pseudoknots.
<xref ref-type="fig" rid="f4">Figure 4a, b</xref> illustrates how we measured the angle between stems in pseudoknots via vector directions. In kissing hairpins the angles
<italic>α</italic> and
<italic>β</italic> restrict the possible values of the angle
<italic>γ</italic>. We also include the representative structure of an intermolecular kissing hairpin interaction (lacking the green connection in
<xref ref-type="fig" rid="f4">Figure 4b</xref>) in our analysis. In this special case
<italic>α</italic> and
<italic>β</italic> are indistinguishable and were assigned arbitrarily.</p>
    </sec>
    <sec sec-type="results">
      <title>Results</title>
      <p>We used the helix-centered representation of the 3D structure to analyze the geometry of coaxially stacking helices. The relative geometry of two cylinders in 3D space can be described by five parameters: A separation vector (three parameters) and two angles for the relative orientation in 3D space. In
<xref ref-type="fig" rid="f2">Figure 2</xref> and
<xref ref-type="fig" rid="f4">Figure 4</xref>, we show the single angle calculated between the vectors along the helix axes, as a proxy for these parameters.</p>
      <fig fig-type="figure" id="f2" orientation="portrait" position="float">
        <label>Figure 2. </label>
        <caption>
          <title>Distribution of angles between adjacent stems in multi loops.</title>
          <p>(
<bold>a</bold>) Angles close to 0° mean parallel stems whereas angles close to 180° correspond to potentially stacking stems. Angle distributions in (
<bold>b</bold>) tRNAs and (
<bold>c</bold>) ribosomal RNA are shown as a histogram mapped onto a circular plot illustrating the angles. The (inner) blue bars are instances where DSSR detects stacking on the atom-level scale. The orange bars start at the top of the blue bars and indicate geometries where DSSR does not detect stacking.</p>
        </caption>
        <graphic xlink:href="f1000research-8-20631-g0001"/>
      </fig>
      <fig fig-type="figure" id="f3" orientation="portrait" position="float">
        <label>Figure 3. </label>
        <caption>
          <title>Example of a tRNA where stacking between two non-collinear stems occurs (PDB id 4WJ4
<sup><xref rid="ref-32" ref-type="bibr">32</xref></sup>).</title>
          <p>Green cylinders were fitted to stems, blue cylinders represent hairpins and the pink cylinder the unpaired nucleotides at the 3’ end. Red cylinders connect stems and indicate single-stranded connections between these stems (multi loop segments). Left: The stems of the anticodon arm (top) and the D-arm stack (according to DSSR) despite being at an angle of 143°. Right: View along the axis of the anticodon arm’s stem. The red nucleotide is the unpaired multi loop segment which mediates stacking to the stem of the D-arm. This illustration was generated using PyMol
<sup><xref rid="ref-33" ref-type="bibr">33</xref></sup> via the
<monospace>visualize_rna.py</monospace> wrapper in
<monospace>forgi</monospace>.</p>
        </caption>
        <graphic xlink:href="f1000research-8-20631-g0002"/>
      </fig>
      <fig fig-type="figure" id="f4" orientation="portrait" position="float">
        <label>Figure 4. </label>
        <caption>
          <title>Angles between the stems in pseudoknots.</title>
          <p>(
<bold>a</bold>) and (
<bold>b</bold>) show the vector directions used for the angle measurement. The distributions of the angles between adjacent stems building
<bold>c</bold>) an H-type pseudoknot or (
<bold>d</bold>) a kissing hairpin are shown as histograms mapped to a circle. Furthermore, the distribution of angles between the regular stems of kissing hairpin pseudoknots is shown in the second panel of (
<bold>d</bold>). Like mentioned in
<xref ref-type="fig" rid="f2">Figure 2</xref>, the angles in
<bold>c</bold>) measured between stacking stems (detected via DSSR) are colored in blue. Geometries without stacking are colored in orange. The color scheme in (
<bold>d</bold>) (shades of orange, blue and green) refer to the respective vectors/measured angles (α, β, γ) in the same color scheme as in (
<bold>b</bold>). Blue bars stand for stacking between the two related stems, whereas orange ones for non-stacking stems. Dark green bars in the second kissing hairpin associated histogram show angles measured between a intramolecular interaction (kissing hairpin pseudoknot), whereas light green bars stand for angles measured between two RNA chains (kissing hairpin interaction).</p>
        </caption>
        <graphic xlink:href="f1000research-8-20631-g0003"/>
      </fig>
      <fig fig-type="figure" id="f5" orientation="portrait" position="float">
        <label>Figure 5. </label>
        <caption>
          <p>Examples of coaxial stacking within (
<bold>a</bold>) an H-type pseudoknot (PDB id 2XD0) and (
<bold>b</bold>-
<bold>d</bold>) the three major structural families of kissing hairpins (PDB ids 5KPY, 4FRN and 1ZCI, from left to right). In all four representations the green cylinders were fitted to stems, the turquoise and pink cylinder represent the unpaired nucleotides at the 5’ and 3’ end respectively. Red cylinders connect stems and indicate single-stranded connections between these stems (pseudoknot or multi loop segments). The light-colored stems in (
<bold>b</bold>–
<bold>d</bold>) represent the regular stems of kissing hairpins, whereas the kissing stem is colored yellow. Note that panel (
<bold>d</bold>) (PDB id 1ZCI) shows a kissing hairpin interaction between two RNA chains. Below the 3-dimensional representation of the kissing hairpins, we show a schematic sketch of the structural family’s helix arrangement. These illustrations were generated using PyMol
<sup><xref rid="ref-33" ref-type="bibr">33</xref></sup> via the
<monospace>visualize_rna.py</monospace> wrapper in
<monospace>forgi</monospace>.</p>
        </caption>
        <graphic xlink:href="f1000research-8-20631-g0004"/>
      </fig>
      <p>The distribution of angles between adjacent stems in tRNAs multi loops (see
<xref ref-type="fig" rid="f2">Figure 2a</xref>) shows the expected bimodal distribution with one mode slightly below 90° and another mode between 160° and 170°, which fits to the known helix arrangement in the L-shaped tRNA. As confirmed by comparison to annotations with DSSR, the second peak is almost exclusively due to stacking helices, even at angles as small as 140°. In
<xref ref-type="fig" rid="f3">Figure 3</xref> we show an example of such a coaxial stack that has been strongly bent (possibly by the tRNA synthetase) without completely breaking the stack or affecting the canonical tRNA secondary structure.</p>
      <p>The second family of RNA molecules with lots of data available is ribosomal RNA. Here we find that the angle of adjacent stems in multi loops is almost uniformly distributed above 20° until a peak from 135° to 170°, where DSSR annotates roughly half of the geometries as stacking (see
<xref ref-type="fig" rid="f2">Figure 2c</xref>). 7% of the stacking geometries and 67% of the non-stacking geometries with an angle above 140° also have an offset above 10Å between the extended stem axes.</p>
      <p>Additionally we analyzed the angle distribution between the stems forming simple H-type pseudoknots or kissing hairpins. Most angles measured within an H-type pseudoknot are between 120° and 180° (see
<xref ref-type="fig" rid="f4">Figure 4c</xref>). In this range, 35 out of 67 instances correspond to stacking. One example within this range is shown in
<xref ref-type="fig" rid="f5">Figure 5a</xref>, which represents a processed non-coding RNA, which regulates a bacterial antiviral system (PDB id 2XD0
<sup><xref rid="ref-34" ref-type="bibr">34</xref></sup>).</p>
      <p>The distribution illustrated in
<xref ref-type="fig" rid="f4">Figure 4d</xref> shows mainly values between 130° and 180° for the angles
<italic>β</italic> and especially
<italic>α</italic>. One additional angle measurement between the two regular stems (see
<xref ref-type="fig" rid="f4">Figure 4d</xref>, angle
<italic>γ</italic>) shows one peak at about 20° and one at about 65°. Within the class of kissing hairpins we often find coaxial stacking, but most of the time only one of the two regular stems stacks with the kissing stem in the middle. With the help of the coarse grained representation we were able to divide the class of kissing hairpins into three different structural families (see
<xref ref-type="fig" rid="f5">Figure 5b-d</xref>).</p>
      <p>The first family is especially common among (A-)riboswitches. Here the two regular stems are oriented almost parallel (
<italic>γ</italic> below to 32°) with the second one (counting from the 5’ end) stacking onto the kissing stem. The angles
<italic>α</italic> and
<italic>β</italic> are above 130°. One example is the structure with PDB id 5KPY
<sup><xref rid="ref-35" ref-type="bibr">35</xref></sup> shown in
<xref ref-type="fig" rid="f5">Figure 5b</xref>. Here, the link from the first regular stem stacks onto it and interacts with the kissing stem via base multiplets and A-Minor interactions. This way, the roughly parallel orientation of all 3 stems is stabilized by stacking and base-pairing interactions. Interestingly, the kissing stem is more parallel to the first stem than to the second stem, onto which it stacks directly (
<italic>α &gt; β</italic>).</p>
      <p>The second structural family is shown in
<xref ref-type="fig" rid="f5">Figure 5c</xref>. Here the two regular stems are close to 90°, whereas the kissing stem is along the arc between them. This conformation is found in several groups of non coding RNA including some 23S ribosomal RNA and the cobalamin riboswitch regulatory element (PDB id 4FRN
<sup><xref rid="ref-36" ref-type="bibr">36</xref></sup>) shown in
<xref ref-type="fig" rid="f5">Figure 5c</xref>.</p>
      <p>The two families as well as some conformations in between are observable within intramolecular pseudoknots. As mentioned,
<monospace>forgi</monospace> is also able to model multiple RNA chains that interact with each other forming an intermolecular complex. One example is the dimerization initiation site of the HIV type 1 (PDB id 1ZCI
<sup><xref rid="ref-37" ref-type="bibr">37</xref></sup>), illustrated in
<xref ref-type="fig" rid="f5">Figure 5d</xref> and being the only example of the third family of kissing hairpin pseudoknots. Here the kissing hairpin interaction shows a nearly perfect coaxial stacking between all three involved stems. In this case
<italic>β</italic> is close to 0°, because stacking takes place at the other side of the kissing stem and thus the complementary angle is close to 180°.</p>
    </sec>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <p>Using the
<monospace>forgi</monospace> library
<sup><xref rid="ref-17" ref-type="bibr">17</xref></sup> we have analyzed the relative orientation of helices in junctions and pseudoknots. While stacking between adjacent helices is common, we found that their orientation often deviates significantly from co-linearity, suggesting that junctions introduce flexibility into the RNA structure while still maintaining the benefit of stacking interactions. Previous studies that assign coaxial geometries based on manual inspection
<sup><xref rid="ref-38" ref-type="bibr">38</xref></sup> miss this deviation from coaxiality that becomes apparent once you actually calculate the helix axis. Our approach allowed us to perform this analysis on the scale of stems, as opposed to the smaller all-atom scale used by the program DSSR and in previous surveys
<sup><xref rid="ref-39" ref-type="bibr">39</xref></sup> or the level of networks of (noncanonical) base pairs
<sup><xref rid="ref-38" ref-type="bibr">38</xref></sup>.</p>
    <p>Conversely, we found that out of 1257 pairs of adjacent stems in ribosomal RNA structures with an angle above 140°, only roughly half (608) are annotated as stacking by DSSR. This becomes clear if we consider that the angle between stems is only a proxy for a 5-dimensional orientation parameter. In particular, a large offset means that stem axes with an angle close to 180° can be parallel without being coaxially stacked. Indeed, it is not uncommon that all three stems in a 3-way junction are roughly parallel, with two stems forming a coaxial stack and the third having a higher offset
<sup><xref rid="ref-40" ref-type="bibr">40</xref></sup>.</p>
    <p>There is growing interest in predicting pseudoknots in RNA structures as they are involved in a variety of biological functions
<sup><xref rid="ref-41" ref-type="bibr">41</xref></sup>. The
<monospace>forgi</monospace> library allows us to easily identify pseudoknots in RNA 3D structures and gather statistics on the frequency of pseudoknot types, sizes, and composition. Kissing hairpins formed between two RNA molecules are known to often form continuous stacks between all three helices, such as the pseudoknot in
<xref ref-type="fig" rid="f5">Figure 5d</xref>. In contrast to these intermolecular kissing hairpins, we find that stacking between all three helices is seldom possible in intramolecular pseudoknots. Instead we find that the limited length of all loop segments makes it nearly impossible to form coaxial stacking of all three stems in one line in a single RNA chain. Thus, in the main families of kissing hairpin conformations, the regular (outer) stems are oriented parallelly or almost perpendicular with the kissing helix stacking onto at most one of the two regular stems. These structures are often further stabilized by base triplets like those found in
<xref ref-type="fig" rid="f5">Figure 5b</xref>.</p>
    <p>Similar to stacking conformations in multi loops, many stacking helices in pseudoknots form angles below 180°. A deviation of the coaxiality between stems can have multiple reasons such as a higher flexibility of short helices within a pseudoknot as well as strain from short stem connections. But there are also structures that show more classical coaxial stacking like PDB id 2XD0, see
<xref ref-type="fig" rid="f5">Figure 5a</xref>.</p>
    <p>Results and challenges of the application of
<monospace>forgi</monospace> to the analysis of pseudoknots are described in more detail in the thesis by Beckmann
<sup><xref rid="ref-42" ref-type="bibr">42</xref></sup>.</p>
    <p>Varying additional parameters like the minimal number of base pairs required to count an interaction as a helix allow for a better understanding about the principles of the formation of three-dimensional RNA structures. The insight in the world of pseudoknots and multi loops presented here can support the improvement of the prediction of RNA structures and help identify unrealistic multi-loop conformations predicted by current RNA structures prediction tools. We are now in the process of implementing additional features for the RNA 3D structure prediction program Ernwin
<sup><xref rid="ref-20" ref-type="bibr">20</xref></sup> based on our findings about stacking and pseudoknots.</p>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusions</title>
    <p><monospace>forgi</monospace><sup><xref rid="ref-17" ref-type="bibr">17</xref></sup> is a multi-purpose Python library for dealing with RNA on the levels of sequence, secondary structure and tertiary structure. By providing our code as a Python library, we give users of our tool more flexibility than a single executable program could provide. Furthermore, our code is fully open source, giving researchers the possibility to comprehend and where needed extend the inner workings of the code.</p>
    <p><monospace>forgi</monospace> is well documented, with a tutorial available at
<ext-link ext-link-type="uri" xlink:href="https://ViennaRNA.github.io/forgi/">https://ViennaRNA.github.io/forgi/</ext-link> and a complete API documentation following the Python standard of docstrings parsable by Sphinx. It contains an extensive automatic test suite (unit and integration tests) and has been optimized for speed, maintainability and usefulness.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <sec>
      <title>Underlying data</title>
      <p>The PDB ids analyzed were taken from version 3.36 of the representative sets of RNA 3D structures
<sup><xref rid="ref-28" ref-type="bibr">28</xref></sup> at a cutoff of 4 Å,
<ext-link ext-link-type="uri" xlink:href="http://rna.bgsu.edu/rna3dhub/nrlist/release/3.36/4.0A">http://rna.bgsu.edu/rna3dhub/nrlist/release/3.36/4.0A</ext-link>.</p>
    </sec>
    <sec>
      <title>Extended data</title>
      <p>Open Science Framework: 3D based on 2D:
<monospace>forgi</monospace> 2.0 Extended Data.
<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.17605/OSF.IO/HDJRU">https://doi.org/10.17605/OSF.IO/HDJRU</ext-link>
<sup><xref rid="ref-43" ref-type="bibr">43</xref></sup>. This project contains the following extended data files:
<list list-type="bullet"><list-item><p><bold>assignment_of_classes_to_pdbids.csv</bold>: Assignment of PDB ids to RNA type. These annotations were generated in a semi-manual way.</p></list-item><list-item><p><bold>multiloop_angles.csv</bold>: Angles and offsets measured in PDB structures for multi loops, generated with the script
<monospace>describe_rna.py</monospace>, which is available in the examples folder of
<monospace>forgi</monospace>.</p></list-item><list-item><p><bold>pseudoknot_angles.tsv</bold>: Angles measured in pseudoknots, generated with
<monospace>pseudoknot_analyzer.py</monospace>, which is available in the examples folder of
<monospace>forgi</monospace>.</p></list-item></list>
</p>
      <p>Extended data are available under the terms of the Creative Commons Zero "No rights reserved" data waiver (CC0 1.0 Public domain dedication).</p>
    </sec>
  </sec>
  <sec>
    <title>Software availability</title>
    <p><bold>Software available from:</bold><ext-link ext-link-type="uri" xlink:href="https://pypi.org/project/forgi/">https://pypi.org/project/forgi/</ext-link> (
<monospace>pip install forgi</monospace>) and
<ext-link ext-link-type="uri" xlink:href="https://anaconda.org/bioconda/forgi">Bioconda</ext-link>.</p>
    <p><bold>Archived source code at time of publication:</bold><ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.2582870">https://doi.org/10.5281/zenodo.2582870</ext-link><sup><xref rid="ref-17" ref-type="bibr">17</xref></sup>.</p>
    <p><bold>License:</bold><ext-link ext-link-type="uri" xlink:href="https://github.com/ViennaRNA/forgi/blob/master/LICENSE">GNU General Public License 3.0</ext-link>.</p>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>We thank all contributors, who submitted a pull-request or filed an issue in the
<monospace>forgi</monospace> repository on github. We thank Roman Ochsenreiter for proofreading, Gregor Entzian for useful inputs about many quirks in the PDB format and for proofreading and Lorena Pantano for creating the first version of a Bioconda recipe for
<monospace>forgi</monospace>.</p>
  </ack>
  <ref-list>
    <ref id="ref-1">
      <label>1</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dawson</surname><given-names>WK</given-names></name><name><surname>Maciejczyk</surname><given-names>M</given-names></name><name><surname>Jankowska</surname><given-names>EJ</given-names></name><etal/></person-group>:
<article-title>Coarse-grained modeling of RNA 3D structure.</article-title><source><italic>Methods.</italic></source><year>2016</year>;<volume>103</volume>:<fpage>138</fpage>–<lpage>156</lpage>.
<pub-id pub-id-type="doi">10.1016/j.ymeth.2016.04.026</pub-id><?supplied-pmid 27125734?><pub-id pub-id-type="pmid">27125734</pub-id></mixed-citation>
    </ref>
    <ref id="ref-2">
      <label>2</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berman</surname><given-names>H</given-names></name><name><surname>Henrick</surname><given-names>K</given-names></name><name><surname>Nakamura</surname><given-names>H</given-names></name><etal/></person-group>:
<article-title>The worldwide Protein Data Bank (wwPDB): ensuring a single, uniform archive of PDB data.</article-title><source><italic>Nucleic Acids Res.</italic></source><year>2007</year>;<volume>35</volume>(<issue>Database issue</issue>):<fpage>D301</fpage>–<lpage>D303</lpage>.
<pub-id pub-id-type="doi">10.1093/nar/gkl971</pub-id><!--<pub-id pub-id-type="pmcid">1669775</pub-id>--><?supplied-pmid 17142228?><pub-id pub-id-type="pmid">17142228</pub-id></mixed-citation>
    </ref>
    <ref id="ref-3">
      <label>3</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leontis</surname><given-names>NB</given-names></name><name><surname>Westhof</surname><given-names>E</given-names></name></person-group>:
<article-title>Geometric nomenclature and classification of RNA base pairs.</article-title><source><italic>RNA.</italic></source><year>2001</year>;<volume>7</volume>(<issue>4</issue>):<fpage>499</fpage>–<lpage>512</lpage>.
<pub-id pub-id-type="doi">10.1017/S1355838201002515</pub-id><!--<pub-id pub-id-type="pmcid">1370104</pub-id>--><?supplied-pmid 11345429?><pub-id pub-id-type="pmid">11345429</pub-id></mixed-citation>
    </ref>
    <ref id="ref-4">
      <label>4</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gendron</surname><given-names>P</given-names></name><name><surname>Lemieux</surname><given-names>S</given-names></name><name><surname>Major</surname><given-names>F</given-names></name></person-group>:
<article-title>Quantitative analysis of nucleic acid three-dimensional structures.</article-title><source><italic>J Mol Biol.</italic></source><year>2001</year>;<volume>308</volume>(<issue>5</issue>):<fpage>919</fpage>–<lpage>936</lpage>.
<pub-id pub-id-type="doi">10.1006/jmbi.2001.4626</pub-id><?supplied-pmid 11352582?><pub-id pub-id-type="pmid">11352582</pub-id></mixed-citation>
    </ref>
    <ref id="ref-5">
      <label>5</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>H</given-names></name><name><surname>Jossinet</surname><given-names>F</given-names></name><name><surname>Leontis</surname><given-names>N</given-names></name><etal/></person-group>:
<article-title>Tools for the automatic identification and classification of RNA base pairs.</article-title><source><italic>Nucleic Acids Res.</italic></source><year>2003</year>;<volume>31</volume>(<issue>13</issue>):<fpage>3450</fpage>–<lpage>3460</lpage>.
<pub-id pub-id-type="doi">10.1093/nar/gkg529</pub-id><!--<pub-id pub-id-type="pmcid">168936</pub-id>--><?supplied-pmid 12824344?><pub-id pub-id-type="pmid">12824344</pub-id></mixed-citation>
    </ref>
    <ref id="ref-6">
      <label>6</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sarver</surname><given-names>M</given-names></name><name><surname>Zirbel</surname><given-names>CL</given-names></name><name><surname>Stombaugh</surname><given-names>J</given-names></name><etal/></person-group>:
<article-title>FR3D: finding local and composite recurrent structural motifs in RNA 3D structures.</article-title><source><italic>J Math Biol.</italic></source><year>2008</year>;<volume>56</volume>(<issue>1–2</issue>):<fpage>215</fpage>–<lpage>252</lpage>.
<pub-id pub-id-type="doi">10.1007/s00285-007-0110-x</pub-id><!--<pub-id pub-id-type="pmcid">2837920</pub-id>--><?supplied-pmid 17694311?><pub-id pub-id-type="pmid">17694311</pub-id></mixed-citation>
    </ref>
    <ref id="ref-7">
      <label>7</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lu</surname><given-names>XJ</given-names></name><name><surname>Bussemake</surname><given-names>HJ</given-names></name><name><surname>Olson</surname><given-names>WK</given-names></name></person-group>:
<article-title>DSSR: an integrated software tool for dissecting the spatial structure of RNA.</article-title><source><italic>Nucleic Acids Res.</italic></source><year>2015</year>;<volume>43</volume>(<issue>21</issue>):<fpage>e142</fpage>.
<pub-id pub-id-type="doi">10.1093/nar/gkv716</pub-id><!--<pub-id pub-id-type="pmcid">4666379</pub-id>--><?supplied-pmid 26184874?><pub-id pub-id-type="pmid">26184874</pub-id></mixed-citation>
    </ref>
    <ref id="ref-8">
      <label>8</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zok</surname><given-names>T</given-names></name><name><surname>Antczak</surname><given-names>M</given-names></name><name><surname>Zurkowski</surname><given-names>M</given-names></name><etal/></person-group>:
<article-title>RNApdbee 2.0: multifunctional tool for RNA structure annotation.</article-title><source><italic>Nucleic Acids Res.</italic></source><year>2018</year>;<volume>46</volume>(<issue>W1</issue>):<fpage>W30</fpage>–<lpage>W35</lpage>.
<pub-id pub-id-type="doi">10.1093/nar/gky314</pub-id><!--<pub-id pub-id-type="pmcid">6031003</pub-id>--><?supplied-pmid 29718468?><pub-id pub-id-type="pmid">29718468</pub-id></mixed-citation>
    </ref>
    <ref id="ref-9">
      <label>9</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mustoe</surname><given-names>AM</given-names></name><name><surname>Brooks</surname><given-names>CL</given-names></name><name><surname>Al-Hashimi</surname><given-names>HM</given-names></name></person-group>:
<article-title>Hierarchy of RNA functional dynamics.</article-title><source><italic>Annu Rev Biochem.</italic></source><year>2014</year>;<volume>83</volume>(<issue>1</issue>):<fpage>441</fpage>–<lpage>466</lpage>.
<pub-id pub-id-type="doi">10.1146/annurev-biochem-060713-035524</pub-id><!--<pub-id pub-id-type="pmcid">4048628</pub-id>--><?supplied-pmid 24606137?><pub-id pub-id-type="pmid">24606137</pub-id></mixed-citation>
    </ref>
    <ref id="ref-10">
      <label>10</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thiel</surname><given-names>BC</given-names></name><name><surname>Flamm</surname><given-names>C</given-names></name><name><surname>Hofacker</surname><given-names>IL</given-names></name></person-group>:
<article-title>RNA structure prediction: from 2D to 3D.</article-title><source><italic>Emerg Top Life Sci.</italic></source><year>2017</year>;<volume>1</volume>(<issue>3</issue>):<fpage>275</fpage>–<lpage>285</lpage>.
<pub-id pub-id-type="doi">10.1042/etls20160027</pub-id></mixed-citation>
    </ref>
    <ref id="ref-11">
      <label>11</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lorenz</surname><given-names>R</given-names></name><name><surname>Bernhart</surname><given-names>SH</given-names></name><name><surname>Höner Zu Siederdissen</surname><given-names>C</given-names></name><etal/></person-group>:
<article-title>ViennaRNA Package 2.0.</article-title><source><italic>Algorithms Mol Biol.</italic></source><year>2011</year>;<volume>6</volume>(<issue>1</issue>):<fpage>26</fpage>.
<pub-id pub-id-type="doi">10.1186/1748-7188-6-26</pub-id><!--<pub-id pub-id-type="pmcid">3319429</pub-id>--><?supplied-pmid 22115189?><pub-id pub-id-type="pmid">22115189</pub-id></mixed-citation>
    </ref>
    <ref id="ref-12">
      <label>12</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cock</surname><given-names>PJ</given-names></name><name><surname>Antao</surname><given-names>T</given-names></name><name><surname>Chang</surname><given-names>JT</given-names></name><etal/></person-group>:
<article-title>Biopython: freely available Python tools for computational molecular biology and bioinformatics.</article-title><source><italic>Bioinformatics.</italic></source><year>2009</year>;<volume>25</volume>(<issue>11</issue>):<fpage>1422</fpage>–<lpage>1423</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btp163</pub-id><!--<pub-id pub-id-type="pmcid">2682512</pub-id>--><?supplied-pmid 19304878?><pub-id pub-id-type="pmid">19304878</pub-id></mixed-citation>
    </ref>
    <ref id="ref-13">
      <label>13</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hamelryck</surname><given-names>T</given-names></name><name><surname>Manderick</surname><given-names>B</given-names></name></person-group>:
<article-title>PDB file parser and structure class implemented in Python.</article-title><source><italic>Bioinformatics.</italic></source><year>2003</year>;<volume>19</volume>(<issue>17</issue>):<fpage>2308</fpage>–<lpage>2310</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btg299</pub-id><?supplied-pmid 14630660?><pub-id pub-id-type="pmid">14630660</pub-id></mixed-citation>
    </ref>
    <ref id="ref-14">
      <label>14</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Knight</surname><given-names>R</given-names></name><name><surname>Maxwell</surname><given-names>P</given-names></name><name><surname>Birmingham</surname><given-names>A</given-names></name><etal/></person-group>:
<article-title>PyCogent: a toolkit for making sense from sequence.</article-title><source><italic>Genome Biol.</italic></source><year>2007</year>;<volume>8</volume>(<issue>8</issue>):<fpage>R171</fpage>.
<pub-id pub-id-type="doi">10.1186/gb-2007-8-8-r171</pub-id><!--<pub-id pub-id-type="pmcid">2375001</pub-id>--><?supplied-pmid 17708774?><pub-id pub-id-type="pmid">17708774</pub-id></mixed-citation>
    </ref>
    <ref id="ref-15">
      <label>15</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smit</surname><given-names>S</given-names></name><name><surname>Rother</surname><given-names>K</given-names></name><name><surname>Heringa</surname><given-names>J</given-names></name><etal/></person-group>:
<article-title>From knotted to nested RNA structures: a variety of computational methods for pseudoknot removal.</article-title><source><italic>RNA.</italic></source><year>2008</year>;<volume>14</volume>(<issue>3</issue>):<fpage>410</fpage>–<lpage>416</lpage>.
<pub-id pub-id-type="doi">10.1261/rna.881308</pub-id><!--<pub-id pub-id-type="pmcid">2248259</pub-id>--><?supplied-pmid 18230758?><pub-id pub-id-type="pmid">18230758</pub-id></mixed-citation>
    </ref>
    <ref id="ref-16">
      <label>16</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rother</surname><given-names>M</given-names></name><name><surname>Rother</surname><given-names>K</given-names></name><name><surname>Puton</surname><given-names>T</given-names></name><etal/></person-group>:
<article-title>ModeRNA: a tool for comparative modeling of RNA 3D structure.</article-title><source><italic>Nucleic Acids Res.</italic></source><year>2011</year>;<volume>39</volume>(<issue>10</issue>):<fpage>4007</fpage>–<lpage>4022</lpage>.
<pub-id pub-id-type="doi">10.1093/nar/gkq1320</pub-id><!--<pub-id pub-id-type="pmcid">3105415</pub-id>--><?supplied-pmid 21300639?><pub-id pub-id-type="pmid">21300639</pub-id></mixed-citation>
    </ref>
    <ref id="ref-17">
      <label>17</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thiel</surname><given-names>B</given-names></name><name><surname>Kerpedjiev</surname><given-names>P</given-names></name><name><surname>tcarlile</surname></name><etal/></person-group>:
<article-title>Viennarna/forgi: Forgi version 2.0</article-title>.<year>2019</year><pub-id pub-id-type="doi">10.5281/zenodo.2582870</pub-id></mixed-citation>
    </ref>
    <ref id="ref-18">
      <label>18</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Licht</surname><given-names>K</given-names></name><name><surname>Jantsch</surname><given-names>MF</given-names></name></person-group>:
<article-title>Rapid and dynamic transcriptome regulation by RNA editing and RNA modifications.</article-title><source><italic>J Cell Biol.</italic></source><year>2016</year>;<volume>213</volume>(<issue>1</issue>):<fpage>15</fpage>–<lpage>22</lpage>.
<pub-id pub-id-type="doi">10.1083/jcb.201511041</pub-id><!--<pub-id pub-id-type="pmcid">4828693</pub-id>--><?supplied-pmid 27044895?><pub-id pub-id-type="pmid">27044895</pub-id></mixed-citation>
    </ref>
    <ref id="ref-19">
      <label>19</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dimitropoulos</surname><given-names>D</given-names></name><name><surname>Ionides</surname><given-names>J</given-names></name><name><surname>Henrick</surname><given-names>K</given-names></name></person-group>:
<article-title>Using MSDchem to search the PDB ligand dictionary.</article-title><source><italic>Curr Protoc Bioinformatics.</italic></source><year>2006</year>; Chapter 14: Unit14.3.
<pub-id pub-id-type="doi">10.1002/0471250953.bi1403s15</pub-id><?supplied-pmid 18428761?><pub-id pub-id-type="pmid">18428761</pub-id></mixed-citation>
    </ref>
    <ref id="ref-20">
      <label>20</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kerpedjiev</surname><given-names>P</given-names></name><name><surname>Höner Zu Siederdissen</surname><given-names>C</given-names></name><name><surname>Hofacker</surname><given-names>IL</given-names></name></person-group>:
<article-title>Predicting RNA 3D structure using a coarse-grain helix-centered model.</article-title><source><italic>RNA.</italic></source><year>2015</year>;<volume>21</volume>(<issue>6</issue>):<fpage>1110</fpage>–<lpage>1121</lpage>.
<pub-id pub-id-type="doi">10.1261/rna.047522.114</pub-id><!--<pub-id pub-id-type="pmcid">4436664</pub-id>--><?supplied-pmid 25904133?><pub-id pub-id-type="pmid">25904133</pub-id></mixed-citation>
    </ref>
    <ref id="ref-21">
      <label>21</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schlick</surname><given-names>T</given-names></name></person-group>:
<article-title>Adventures with RNA graphs.</article-title><source><italic>Methods.</italic></source><year>2018</year>;<volume>143</volume>:<fpage>16</fpage>–<lpage>33</lpage>.
<pub-id pub-id-type="doi">10.1016/j.ymeth.2018.03.009</pub-id><!--<pub-id pub-id-type="pmcid">6051918</pub-id>--><?supplied-pmid 29621619?><pub-id pub-id-type="pmid">29621619</pub-id></mixed-citation>
    </ref>
    <ref id="ref-22">
      <label>22</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Steffen</surname><given-names>P</given-names></name><name><surname>Voss</surname><given-names>B</given-names></name><name><surname>Rehmsmeier</surname><given-names>M</given-names></name><etal/></person-group>:
<article-title>RNAshapes: an integrated RNA analysis package based on abstract shapes.</article-title><source><italic>Bioinformatics.</italic></source><year>2006</year>;<volume>22</volume>(<issue>4</issue>):<fpage>500</fpage>–<lpage>503</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btk010</pub-id><?supplied-pmid 16357029?><pub-id pub-id-type="pmid">16357029</pub-id></mixed-citation>
    </ref>
    <ref id="ref-23">
      <label>23</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Oliphant</surname><given-names>TE</given-names></name></person-group>:
<article-title>Guide to NumPy</article-title>. 2nd Edition. CreateSpace Independent Publishing Platform,<year>2015</year><ext-link ext-link-type="uri" xlink:href="https://dl.acm.org/citation.cfm?id=2886196">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-24">
      <label>24</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jones</surname><given-names>E</given-names></name><name><surname>Oliphant</surname><given-names>T</given-names></name><name><surname>Peterson</surname><given-names>T</given-names></name><etal/></person-group>:
<article-title>SciPy: Open source scientific tools for Python, since 2001</article-title>. [online, accessed 8 Oct 2018].
<ext-link ext-link-type="uri" xlink:href="http://www.scipy.org/">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-25">
      <label>25</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hagberg</surname><given-names>AA</given-names></name><name><surname>Schult</surname><given-names>DA</given-names></name><name><surname>Swart</surname><given-names>PJ</given-names></name></person-group>:
<article-title>Exploring network structure, dynamics, and function using networkx</article-title>. In Gaël Varoquaux, Travis Vaught, and Jarrod Millman, editors,
<italic>Proceedings of the 7th Python in Science Conference</italic> Pasadena, CA USA.<year>2008</year>;<fpage>11</fpage>–<lpage>15</lpage>.
<ext-link ext-link-type="uri" xlink:href="https://conference.scipy.org/proceedings/scipy2008/paper_2/full_text.pdf">Reference Source</ext-link>
</mixed-citation>
    </ref>
    <ref id="ref-26">
      <label>26</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McKinney</surname><given-names>W</given-names></name></person-group>:
<article-title>Data structures for statistical computing in python</article-title>. In Stéfan van der Walt and Jarrod Millman, editors,
<italic>Proceedings of the 9th Python in Science Conference</italic><year>2010</year>;<fpage>51</fpage>–<lpage>56</lpage>.
<ext-link ext-link-type="uri" xlink:href="https://conference.scipy.org/proceedings/scipy2010/pdfs/mckinney.pdf">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-27">
      <label>27</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McKinney</surname><given-names>W</given-names></name></person-group>:
<article-title>pandas: a foundational python library for data analysis and statistics</article-title>.
<italic>Python for High Performance and Scientific Computing</italic><year>2011</year>;<fpage>1</fpage>–<lpage>9</lpage>.
<ext-link ext-link-type="uri" xlink:href="https://www.dlr.de/sc/Portaldata/15/Resources/dokumente/pyhpc2011/submissions/pyhpc2011_submission_9.pdf">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-28">
      <label>28</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Leontis</surname><given-names>NB</given-names></name><name><surname>Zirbel</surname><given-names>CL</given-names></name></person-group>:
<article-title>Nonredundant 3D structure datasets for RNA knowledge extraction and benchmarking</article-title>. In
<italic>Nucleic Acids and Molecular Biology</italic> Springer Berlin Heidelberg.<year>2012</year>;<fpage>281</fpage>–<lpage>298</lpage>.
<pub-id pub-id-type="doi">10.1007/978-3-642-25740-7_13</pub-id>
</mixed-citation>
    </ref>
    <ref id="ref-29">
      <label>29</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tyagi</surname><given-names>R</given-names></name><name><surname>Mathews</surname><given-names>DH</given-names></name></person-group>:
<article-title>Predicting helical coaxial stacking in RNA multibranch loops.</article-title><source><italic>RNA.</italic></source><year>2007</year>;<volume>13</volume>(<issue>7</issue>):<fpage>939</fpage>–<lpage>951</lpage>.
<pub-id pub-id-type="doi">10.1261/rna.305307</pub-id><!--<pub-id pub-id-type="pmcid">1894924</pub-id>--><?supplied-pmid 17507661?><pub-id pub-id-type="pmid">17507661</pub-id></mixed-citation>
    </ref>
    <ref id="ref-30">
      <label>30</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hunter</surname><given-names>JD</given-names></name></person-group>:
<article-title>Matplotlib: A 2D graphics environment.</article-title><source><italic>Comput Sci Eng.</italic></source><year>2007</year>;<volume>9</volume>(<issue>3</issue>):<fpage>90</fpage>–<lpage>95</lpage>.
<pub-id pub-id-type="doi">10.1109/mcse.2007.55</pub-id></mixed-citation>
    </ref>
    <ref id="ref-31">
      <label>31</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reidys</surname><given-names>CM</given-names></name><name><surname>Huang</surname><given-names>FW</given-names></name><name><surname>Andersen</surname><given-names>JE</given-names></name><etal/></person-group>:
<article-title>Topology and prediction of RNA pseudoknots.</article-title><source><italic>Bioinformatics.</italic></source><year>2011</year>;<volume>27</volume>(<issue>8</issue>):<fpage>1076</fpage>–<lpage>1085</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btr090</pub-id><?supplied-pmid 21335320?><pub-id pub-id-type="pmid">21335320</pub-id></mixed-citation>
    </ref>
    <ref id="ref-32">
      <label>32</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Suzuki</surname><given-names>T</given-names></name><name><surname>Nakamura</surname><given-names>A</given-names></name><name><surname>Kato</surname><given-names>K</given-names></name><etal/></person-group>:
<article-title>Structure of the
<italic>Pseudomonas aeruginosa</italic> transamidosome reveals unique aspects of bacterial tRNA-dependent asparagine biosynthesis.</article-title><source><italic>Proc Natl Acad Sci U S A.</italic></source><year>2015</year>;<volume>112</volume>(<issue>2</issue>):<fpage>382</fpage>–<lpage>387</lpage>.
<pub-id pub-id-type="doi">10.1073/pnas.1423314112</pub-id><!--<pub-id pub-id-type="pmcid">4299244</pub-id>--><?supplied-pmid 25548166?><pub-id pub-id-type="pmid">25548166</pub-id></mixed-citation>
    </ref>
    <ref id="ref-33">
      <label>33</label>
      <mixed-citation publication-type="journal"><collab>Schrödinger, LLC</collab>:
<article-title>The PyMOL molecular graphics system.</article-title>version 1.8.<year>2015</year>.</mixed-citation>
    </ref>
    <ref id="ref-34">
      <label>34</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blower</surname><given-names>TR</given-names></name><name><surname>Pei</surname><given-names>XY</given-names></name><name><surname>Short</surname><given-names>FL</given-names></name><etal/></person-group>:
<article-title>A processed noncoding RNA regulates an altruistic bacterial antiviral system.</article-title><source><italic>Nat Struct Mol Biol.</italic></source><year>2011</year>;<volume>18</volume>(<issue>2</issue>):<fpage>185</fpage>–<lpage>191</lpage>.
<pub-id pub-id-type="doi">10.1038/nsmb.1981</pub-id><!--<pub-id pub-id-type="pmcid">4612426</pub-id>--><?supplied-pmid 21240270?><pub-id pub-id-type="pmid">21240270</pub-id></mixed-citation>
    </ref>
    <ref id="ref-35">
      <label>35</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Porter</surname><given-names>EB</given-names></name><name><surname>Polaski</surname><given-names>JT</given-names></name><name><surname>Morck</surname><given-names>MM</given-names></name><etal/></person-group>:
<article-title>Recurrent RNA motifs as scaffolds for genetically encodable small-molecule biosensors.</article-title><source><italic>Nat Chem Biol.</italic></source><year>2017</year>;<volume>13</volume>(<issue>3</issue>):<fpage>295</fpage>–<lpage>301</lpage>.
<pub-id pub-id-type="doi">10.1038/nchembio.2278</pub-id><!--<pub-id pub-id-type="pmcid">5310984</pub-id>--><?supplied-pmid 28092358?><pub-id pub-id-type="pmid">28092358</pub-id></mixed-citation>
    </ref>
    <ref id="ref-36">
      <label>36</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Johnson</surname><given-names>JE</given-names><suffix>Jr</suffix></name><name><surname>Reyes</surname><given-names>FE</given-names></name><name><surname>Polaski</surname><given-names>JT</given-names></name><etal/></person-group>:
<article-title>B
<sub>12</sub> cofactors directly stabilize an mRNA regulatory switch</article-title><source><italic>Nature.</italic></source><year>2012</year>;<volume>492</volume>(<issue>7427</issue>):<fpage>133</fpage>–<lpage>137</lpage>.
<pub-id pub-id-type="doi">10.1038/nature11607</pub-id><!--<pub-id pub-id-type="pmcid">3518761</pub-id>--><?supplied-pmid 23064232?><pub-id pub-id-type="pmid">23064232</pub-id></mixed-citation>
    </ref>
    <ref id="ref-37">
      <label>37</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ennifar</surname><given-names>E</given-names></name><name><surname>Dumas</surname><given-names>P</given-names></name></person-group>:
<article-title>Polymorphism of bulged-out residues in HIV-1 RNA DIS kissing complex and structure comparison with solution studies.</article-title><source><italic>J Mol Biol.</italic></source><year>2006</year>;<volume>356</volume>(<issue>3</issue>):<fpage>771</fpage>–<lpage>782</lpage>.
<pub-id pub-id-type="doi">10.1016/j.jmb.2005.12.022</pub-id><?supplied-pmid 16403527?><pub-id pub-id-type="pmid">16403527</pub-id></mixed-citation>
    </ref>
    <ref id="ref-38">
      <label>38</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Laing</surname><given-names>C</given-names></name><name><surname>Schlick</surname><given-names>T</given-names></name></person-group>:
<article-title>Analysis of four-way junctions in RNA structures.</article-title><source><italic>J Mol Biol.</italic></source><year>2009</year>;<volume>390</volume>(<issue>3</issue>):<fpage>547</fpage>–<lpage>559</lpage>.
<pub-id pub-id-type="doi">10.1016/j.jmb.2009.04.084</pub-id><!--<pub-id pub-id-type="pmcid">2777522</pub-id>--><?supplied-pmid 19445952?><pub-id pub-id-type="pmid">19445952</pub-id></mixed-citation>
    </ref>
    <ref id="ref-39">
      <label>39</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Holbrook</surname><given-names>SR</given-names></name></person-group>:
<article-title>Structural principles from large RNAs.</article-title><source><italic>Annu Rev Biophys.</italic></source><year>2008</year>;<volume>37</volume>(<issue>1</issue>):<fpage>445</fpage>–<lpage>464</lpage>.
<pub-id pub-id-type="doi">10.1146/annurev.biophys.36.040306.132755</pub-id><?supplied-pmid 18573090?><pub-id pub-id-type="pmid">18573090</pub-id></mixed-citation>
    </ref>
    <ref id="ref-40">
      <label>40</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lescoute</surname><given-names>A</given-names></name><name><surname>Westhof</surname><given-names>E</given-names></name></person-group>:
<article-title>Topology of three-way junctions in folded RNAs.</article-title><source><italic>RNA.</italic></source><year>2006</year>;<volume>12</volume>(<issue>1</issue>):<fpage>83</fpage>–<lpage>93</lpage>.
<pub-id pub-id-type="doi">10.1261/rna.2208106</pub-id><!--<pub-id pub-id-type="pmcid">1370888</pub-id>--><?supplied-pmid 16373494?><pub-id pub-id-type="pmid">16373494</pub-id></mixed-citation>
    </ref>
    <ref id="ref-41">
      <label>41</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Staple</surname><given-names>DW</given-names></name><name><surname>Butcher</surname><given-names>SE</given-names></name></person-group>:
<article-title>Pseudoknots: RNA structures with diverse functions.</article-title><source><italic>PLoS Biol.</italic></source><year>2005</year>;<volume>3</volume>(<issue>6</issue>):<fpage>e213</fpage>.
<pub-id pub-id-type="doi">10.1371/journal.pbio.0030213</pub-id><!--<pub-id pub-id-type="pmcid">1149493</pub-id>--><?supplied-pmid 15941360?><pub-id pub-id-type="pmid">15941360</pub-id></mixed-citation>
    </ref>
    <ref id="ref-42">
      <label>42</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beckmann</surname><given-names>IK</given-names></name></person-group>:
<article-title>Identification and Classification of Pseudoknots and their Impact on RNA 3D Structure Prediction</article-title>. Master’s thesis, University of Vienna,<year>2018</year><ext-link ext-link-type="uri" xlink:href="https://usearch.univie.ac.at/primo_library/libweb/action/dlDisplay.do?vid=UWI&amp;docId=UWI_alma21390711870003332&amp;fn=permalink">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-43">
      <label>43</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thiel</surname><given-names>BC</given-names></name><name><surname>Beckmann</surname><given-names>IK</given-names></name><name><surname>Kerpedjiev</surname><given-names>P</given-names></name><etal/></person-group>:
<article-title>3D based on 2D: Forgi 2.0 Extended Data</article-title>.<year>2019</year><pub-id pub-id-type="doi">10.17605/OSF.IO/HDJRU</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article id="report47470" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.20631.r47470</article-id>
    <title-group>
      <article-title>Reviewer response for version 2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Szachniuk</surname>
          <given-names>Marta</given-names>
        </name>
        <xref ref-type="aff" rid="r47470a1">1</xref>
        <role>Referee</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-8724-7908</contrib-id>
      </contrib>
      <aff id="r47470a1"><label>1</label>Institute of Computing Science &amp; European Centre for Bioinformatics and Genomics,  Poznan University of Technology, Poznań, Poland</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>23</day>
      <month>4</month>
      <year>2019</year>
    </pub-date>
    <related-article related-article-type="peer-reviewed-article" id="d35e3665" ext-link-type="doi" xlink:href="10.12688/f1000research.18458.2">Version 2</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>I'm satisfied with all modifications the authors made.</p>
    <p>I have read this submission. I believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard.</p>
  </body>
</sub-article>
<sub-article id="report45731" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.20195.r45731</article-id>
    <title-group>
      <article-title>Reviewer response for version 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Waldispühl</surname>
          <given-names>Jerome</given-names>
        </name>
        <xref ref-type="aff" rid="r45731a1">1</xref>
        <role>Referee</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-2561-7117</contrib-id>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sarrazin-Gendron</surname>
          <given-names>Roman</given-names>
        </name>
        <xref ref-type="aff" rid="r45731a1">1</xref>
        <role>Co-referee</role>
      </contrib>
      <aff id="r45731a1"><label>1</label>School of Computer Science, McGill University, Montreal, QC, Canada</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>27</day>
      <month>3</month>
      <year>2019</year>
    </pub-date>
    <related-article related-article-type="peer-reviewed-article" id="d35e3726" ext-link-type="doi" xlink:href="10.12688/f1000research.18458.1">Version 1</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>The authors present a new version of the forgi software, a python library to analyze the tertiary structure of secondary structure elements in RNA. It takes as input almost any format of 2D or 3D information.</p>
    <p> This manuscript describes a new method for easily obtaining the angles and stacking patterns in a multi-branched loop and a pseudoknot/kissing hairpin. The authors validate their results by testing the software on known pseudo-knots and junctions, and obtain results that are consistent with the state-of-the-art knowledge of RNA local structure organization.</p>
    <p> The authors highlight significant improvements compared to previously published packages and specifically all-atom based methods. For instance, a deviation from coaxiality is very common but can be easily missed if a manual inspection is performed without doing computations.</p>
    <p> The software is clearly presented, well-validated, freely available and open source. The results presented are significant and the tool will be very useful to the RNA bioinformatics community.</p>
    <p> Although, this manuscript does not discuss extensively the analysis of the results, the latter is included in the first author’s thesis, and freely accessible as further reading.</p>
    <p> `</p>
    <p>
      <bold>Minor remarks</bold>
      <list list-type="bullet">
        <list-item>
          <p>Page 4: ‘’with and without missing residues’’, it is easy to imagine how the graph without the missing residue is, but how are the ‘’missing residues’’ added? (i.e. are you inferring which residues are missing, and if yes, how?)</p>
        </list-item>
        <list-item>
          <p>Page 5: The authors mention a ‘’cleaned version’’ of the PDB. Is the only ‘’cleaning’’ performed is the conversion of the residue names?</p>
        </list-item>
        <list-item>
          <p>Page 5: It would be helpful to clarify what is a ‘’simplified example’’ of the code? What sort of simplification was applied to it? Is the real code significantly more complicated to use than the example? If it is not, the authors might want to consider rewording this as it appears to undermine the real simplicity of use of forgi (which is very user friendly).</p>
        </list-item>
      </list>
    </p>
    <p>We have read this submission. We believe that we have an appropriate level of expertise to confirm that it is of an acceptable scientific standard.</p>
  </body>
  <sub-article id="comment4530" article-type="response">
    <front-stub>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Thiel</surname>
            <given-names>Bernhard</given-names>
          </name>
          <aff>University of Vienna, Austria</aff>
        </contrib>
      </contrib-group>
      <author-notes>
        <fn fn-type="COI-statement">
          <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
        </fn>
      </author-notes>
      <pub-date pub-type="epub">
        <day>1</day>
        <month>4</month>
        <year>2019</year>
      </pub-date>
    </front-stub>
    <body>
      <p>Thank you for the constructive comments.</p>
      <p>Our PDB and CIF parsers extract the information about missing residues from the files. For this purpose we have patched the biopython PDB parsing routine; this has already been merged into the biopython source. Following your input, we have revised the text to reflect this.</p>
      <p>Yes, the cleaned version only has modified residues renamed and non-rna molecules removed. We hope this is now clear from the revised text.</p>
      <p>We have expanded the sample code to compute the proper direction of helices, thus it is now fully functional and no longer "simplified".</p>
      <p>We have also added the code used to calculate the offset.</p>
    </body>
  </sub-article>
</sub-article>
<sub-article id="report45753" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.20195.r45753</article-id>
    <title-group>
      <article-title>Reviewer response for version 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Szachniuk</surname>
          <given-names>Marta</given-names>
        </name>
        <xref ref-type="aff" rid="r45753a1">1</xref>
        <role>Referee</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-8724-7908</contrib-id>
      </contrib>
      <aff id="r45753a1"><label>1</label>Institute of Computing Science &amp; European Centre for Bioinformatics and Genomics,  Poznan University of Technology, Poznań, Poland</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>27</day>
      <month>3</month>
      <year>2019</year>
    </pub-date>
    <related-article related-article-type="peer-reviewed-article" id="d35e3848" ext-link-type="doi" xlink:href="10.12688/f1000research.18458.1">Version 1</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve-with-reservations</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>The article is written in a clear and concise way. Illustrations perfectly complement the content. I have only 3 comments to the authors and I would like them to be taken into account in the revision:
<list list-type="order"><list-item><p>For unknown reasons, the authors introduced a new spelling of the name pseudoknot. Throughout the whole article, they use spelling with space: "pseudo knots". I haven't met such a form before. The authors of the article also used the term "pseudoknot" and not "pseudo knot" in their previous works. So, the spelling should be corrected.</p></list-item><list-item><p>On page 3, the authors write about FR3D suite, but they do not cite the paper about the tool. Please, include the appropriate citation here.</p></list-item><list-item><p>As the paper subject is calculating helix angles and stacking parameters, I would expect to see the formulas used to calculate these data (or - at least - the pseudocode showing how they are calculated). The lack of such details is serious negligence.</p></list-item></list>
</p>
    <p>I have read this submission. I believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard, however I have significant reservations, as outlined above.</p>
  </body>
  <sub-article id="comment4529" article-type="response">
    <front-stub>
      <contrib-group>
        <contrib contrib-type="author">
          <name>
            <surname>Thiel</surname>
            <given-names>Bernhard</given-names>
          </name>
          <aff>University of Vienna, Austria</aff>
        </contrib>
      </contrib-group>
      <author-notes>
        <fn fn-type="COI-statement">
          <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
        </fn>
      </author-notes>
      <pub-date pub-type="epub">
        <day>1</day>
        <month>4</month>
        <year>2019</year>
      </pub-date>
    </front-stub>
    <body>
      <p>Thank you for the constructive comments.</p>
      <p>We have now included the exact formulas for the helix angles as requested. In particular this makes clear what sign we use for the helix vectors.</p>
      <p>The FR3D reference was present in our LaTeX source and the resulting HTML version, but got lost in the pdf conversion. This has been fixed in the revised version.</p>
    </body>
  </sub-article>
</sub-article>
