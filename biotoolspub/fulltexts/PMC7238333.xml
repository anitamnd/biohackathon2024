<?all-math-mml yes?>
<?use-mml?>
<?properties open_access?>
<?properties manuscript?>
<?origin nihpa?>
<?iso-abbr Nat. Methods?>
<?submitter-system nihms?>
<?submitter-userid 8068858?>
<?submitter-authority myNCBI?>
<?submitter-login nature-structure?>
<?submitter-name Nature Publishing Group?>
<?domain nihpa?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-journal-id">101215604</journal-id>
    <journal-id journal-id-type="pubmed-jr-id">32338</journal-id>
    <journal-id journal-id-type="nlm-ta">Nat Methods</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat. Methods</journal-id>
    <journal-title-group>
      <journal-title>Nature methods</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1548-7091</issn>
    <issn pub-type="epub">1548-7105</issn>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7238333</article-id>
    <article-id pub-id-type="pmid">31501548</article-id>
    <article-id pub-id-type="doi">10.1038/s41592-019-0539-z</article-id>
    <article-id pub-id-type="manuscript">nihpa1535603</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Robust and automated detection of subcellular morphological motifs in 3D microscopy images</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Driscoll</surname>
          <given-names>Meghan K.</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref ref-type="aff" rid="A2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Welf</surname>
          <given-names>Erik S.</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref ref-type="aff" rid="A2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jamieson</surname>
          <given-names>Andrew R.</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref ref-type="aff" rid="A2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dean</surname>
          <given-names>Kevin M.</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref ref-type="aff" rid="A2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Isogai</surname>
          <given-names>Tadamoto</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref ref-type="aff" rid="A2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fiolka</surname>
          <given-names>Reto</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref ref-type="aff" rid="A2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Danuser</surname>
          <given-names>Gaudenz</given-names>
        </name>
        <xref ref-type="aff" rid="A1">1</xref>
        <xref ref-type="aff" rid="A2">2</xref>
        <xref rid="CR1" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="A1"><label>1</label>Lyda Hill Department of Bioinformatics, University of Texas Southwestern Medical Center, Dallas, TX, USA</aff>
    <aff id="A2"><label>2</label>Department of Cell Biology, University of Texas Southwestern Medical Center, Dallas, TX, USA</aff>
    <author-notes>
      <fn fn-type="con" id="FN1">
        <p id="P1">Author Contributions</p>
        <p id="P2">M.K.D. and G.D. conceived and designed the study; M.K.D. wrote most of the software; A.R.J. developed the software’s graphical user interface; E.S.W. and M.K.D. performed most of the imaging experiments; K.M.D. and T.I. performed the U2OS experiments; K.M.D. and R.F. provided imaging resources; M.K.D. and G.D. wrote the manuscript; and all authors read and approved the final manuscript.</p>
      </fn>
      <corresp id="CR1">
        <label>*</label>
        <email>Gaudenz.Danuser@UTSouthwestern.edu</email>
      </corresp>
    </author-notes>
    <pub-date pub-type="nihms-submitted">
      <day>25</day>
      <month>7</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>09</day>
      <month>9</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <month>10</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>20</day>
      <month>5</month>
      <year>2020</year>
    </pub-date>
    <volume>16</volume>
    <issue>10</issue>
    <fpage>1037</fpage>
    <lpage>1044</lpage>
    <!--elocation-id from pubmed: 10.1038/s41592-019-0539-z-->
    <permissions>
      <license>
        <license-p>Users may view, print, copy, and download text and data-mine the content in such documents, for the purposes of academic research, subject always to the full Conditions of use:<uri xlink:href="http://www.nature.com/authors/editorial_policies/license.html#terms">http://www.nature.com/authors/editorial_policies/license.html#terms</uri></license-p>
      </license>
    </permissions>
    <abstract id="ABS1">
      <p id="P3">Rapid developments in live-cell 3D microscopy enable imaging of cell morphology and signaling with unprecedented detail. However, tools to systematically measure and visualize the intricate relationships between intracellular signaling, cytoskeletal organization, and downstream cell morphological outputs do not exist. Here we introduce u-shape3D, a computer graphics and machine-learning pipeline to probe molecular mechanisms underlying 3D cell morphogenesis and to test the intriguing possibility that morphogenesis itself affects intracellular signaling. We demonstrate a generic morphological motif detector that automatically finds lamellipodia, filopodia, blebs, and other motifs. Combining motif detection with molecular localization, we measure the differential association of PIP<sub>2</sub> and Kras<sup>V12</sup> with blebs. Both signals associate with bleb edges, as expected for membrane-localized proteins, but only PIP<sub>2</sub> is enhanced on blebs. This indicates that sub-cellular signaling processes are differentially modulated by local morphological motifs. Overall, our computational workflow enables the objective, 3D analysis of the coupling of cell shape and signaling.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec id="S1">
    <title>Introduction</title>
    <p id="P4">Cell morphogenesis is driven by cytoskeleton-generated forces that are regulated by biochemical signals.<sup><xref rid="R1" ref-type="bibr">1</xref></sup> The cascade from signaling to cytoskeleton to shape control is well established for numerous morphological motifs, including lamellipodia, blebs, and filopodia (<xref rid="F1" ref-type="fig">Fig. 1a</xref>–<xref rid="F1" ref-type="fig">c</xref>, <xref rid="SD6" ref-type="supplementary-material">Video 1</xref>, and <xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 1</xref>), which depend on well-characterized assemblies of actin filaments (<xref rid="F1" ref-type="fig">Fig. 1d</xref>–<xref rid="F1" ref-type="fig">f</xref>).<sup><xref rid="R2" ref-type="bibr">2</xref></sup> How morphology, in turn, may govern signaling is less investigated. Morphology may participate in signal transduction via mechanisms such as preferential protein interaction with membranes of particular curvature,<sup><xref rid="R3" ref-type="bibr">3</xref></sup> or modulation of the concentration and diffusion of signaling components.<sup><xref rid="R4" ref-type="bibr">4</xref>,<xref rid="R5" ref-type="bibr">5</xref></sup></p>
    <p id="P5">The integrated study of signaling and morphology at subcellular length scales has become possible with the recent advent of high-resolution 3D light-sheet microscopy.<sup><xref rid="R6" ref-type="bibr">6</xref>–<xref rid="R11" ref-type="bibr">11</xref></sup> Using microenvironmental selective plane illumination microscopy (meSPIM)<sup><xref rid="R10" ref-type="bibr">10</xref></sup> of PIP<sub>2</sub>, a membrane-bound phosphoinositide implicated in diverse signaling pathways<sup><xref rid="R12" ref-type="bibr">12</xref></sup>, we found an unexpected formation of PIP<sub>2</sub> clusters in both branched (<xref rid="F1" ref-type="fig">Fig. 1g</xref>,<xref rid="F1" ref-type="fig">h</xref>) and blebbed cells (<xref rid="F1" ref-type="fig">Fig. 1i</xref>,<xref rid="F1" ref-type="fig">j</xref>). Three-dimensional renderings of the local concentration of PIP<sub>2</sub> suggest that these clusters tend to colocalize with filopodial tufts (<xref rid="F1" ref-type="fig">Fig. 1h</xref>) and blebs (<xref rid="F1" ref-type="fig">Fig. 1j</xref>). Kras<sup>V12</sup>, which is a constitutively active GTPase with broad oncogenic functionality,<sup><xref rid="R13" ref-type="bibr">13</xref></sup> also appears to colocalize with certain morphological structures (<xref rid="F1" ref-type="fig">Fig. 1k</xref>,<xref rid="F1" ref-type="fig">l</xref> and <xref rid="SD4" ref-type="supplementary-material">Videos 2</xref>,<xref rid="SD5" ref-type="supplementary-material">3</xref>). These observations pose the question of whether rugged surface geometries generally associate with elevated signaling, and whether there are differences in how PIP<sub>2</sub> and Kras associate with cell morphologies.</p>
    <p id="P6">Answering such questions with statistical robustness requires the interpretation of 3D images. Not only is the inspection and quantification of such images exceedingly laborious, the difficulty of representing 3D images in meaningful 2D perspectives renders the manual annotation of subcellular geometries extremely difficult. Automation by computer vision is essential. However the tools for subcellular 3D morphometry do not exist.<sup><xref rid="R14" ref-type="bibr">14</xref></sup> Here, we introduce u-shape3D, a pipeline that combines computer graphics and machine learning approaches to unravel the coupling between cell surface morphology and subcellular signaling. At its core is the segmentation of any morphological motif a user can provide systematic examples for. We show the robustness of a once-learned motif classifier to changes in microscopy and cell type. We then apply the method to analyze the differential association of PIP<sub>2</sub> and Kras<sup>V12</sup> with surface blebs. Moving forward, u-shape3D will be instrumental to furthering our understanding of the feedback interactions between signaling, the cytoskeleton, and morphological dynamics in 3D.</p>
  </sec>
  <sec id="S2">
    <title>Results</title>
    <sec id="S3">
      <title>Detecting cellular morphological motifs</title>
      <p id="P7">In designing u-shape3D, we decided to first represent the cell surface as a triangle mesh, and then segment the surface into motifs using machine learning (<xref rid="F2" ref-type="fig">Fig. 2a</xref>–<xref rid="F2" ref-type="fig">e</xref>). An alternative approach would be to segment the motifs directly from the raw image data on a voxel-by-voxel basis, and then generate a surface representation with classified motifs. This would simplify the application of deep learning algorithms, but would require the acquisition of training data in the raw image volume, where manual outlining of interesting motifs can become exceedingly cumbersome. In contrast, the proposed machine-learning pipeline depends on training data that is defined on a surface representation with pre-segmented patches, where a few easy-to-identify examples of the motif of interest are sufficient to constrain a robust classifier. This provides a versatile and efficient approach to quantifying diverse cellular morphologies.</p>
      <p id="P8">To generate the cell surface, for most cells we automatically extract the mesh as an isosurface of the deconvolved image (<xref rid="F2" ref-type="fig">Fig. 2f</xref>–<xref rid="F2" ref-type="fig">h</xref> and <xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 2</xref>). However some datasets require that surface extraction parameters be tailored to the cell type and fluorescence label (see User’s Guide to the software package). For example, we extract the surfaces of actin-labeled dendritic cells as an isosurface of an image that combines the deconvolved image, an image with enhanced planar features, and an image with an enhanced cell interior (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 3</xref>).</p>
      <p id="P9">After cell surface extraction, we decompose the surface into convex patches. People tend to partition 3D surfaces into convex regions,<sup><xref rid="R15" ref-type="bibr">15</xref></sup> suggesting that canonical protrusions are likely convex or composed of multiple convex regions. Convex decomposition is in general an NP-complete problem,<sup><xref rid="R16" ref-type="bibr">16</xref></sup> and thus is computationally intractable for large meshes, even with extensive computing resources. We therefore combine several techniques to segment the surface into approximately convex patches. First, we calculate the mean curvature<sup><xref rid="R17" ref-type="bibr">17</xref></sup> at every face on the mesh, and then break the surface into small patches via a watershed-based segmentation of mean curvature (<xref rid="F2" ref-type="fig">Fig. 2i</xref>–<xref rid="F2" ref-type="fig">k</xref>).<sup><xref rid="R18" ref-type="bibr">18</xref></sup> These small patches are computationally manipulated more easily than individual faces and are analogous to superpixels in image segmentation.</p>
      <p id="P10">Next, we iteratively merge patches using two criteria (<xref rid="F2" ref-type="fig">Fig. 2l</xref>,<xref rid="F2" ref-type="fig">m</xref> and <xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 4</xref>). The line-of-sight (LOS)<sup><xref rid="R19" ref-type="bibr">19</xref></sup> criterion merges patches if the percentage of rays that connect the two patches without exiting the cell is above a certain threshold. Hence, fulfilling this criterion requires only approximate convexity between the patches. The triangle criterion<sup><xref rid="R10" ref-type="bibr">10</xref></sup> merges adjacent patches whose joint closure surface area, defined as the additional surface area needed to close the mesh composing the patch, is small compared to the sum of their individual closure surface areas. This criterion embodies the short-cut rule<sup><xref rid="R20" ref-type="bibr">20</xref></sup> that the preferred convex shape decomposition has the shortest cuts between segments.</p>
      <p id="P11">Approximate convex patches are then classified by morphological motif type using a Support Vector Machine (SVM). For each patch, 23 geometric features are calculated (<xref rid="SD2" ref-type="supplementary-material">Supplementary Table 1</xref>). Features are automatically selected for each set of training data by successively removing randomly chosen features until prediction quality is hampered. Following SVM training (<xref rid="F2" ref-type="fig">Fig. 2n</xref>), the trained motif model is used to classify each patch by motif type (<xref rid="F2" ref-type="fig">Fig. 2o</xref>,<xref rid="F2" ref-type="fig">p</xref>).</p>
      <p id="P12">The outcomes of machine learning approaches are critically dependent on training data quality. To generate training data, we built an interface where users can rotate 3D surfaces, zoom in and out, and click on patches to identify them as motifs. Presented with the same four randomly chosen cells, three users chose 46±6% of the patches when asked to click on blebs and 25±4% of the patches when asked to click not on blebs. This discrepancy carried over into SVM models, where for the two training sets 45±7% and 77±6% of the patches were identified as blebs. Asking users to click only on patches that are certainly blebs and then only on patches that are certainly not blebs resulted in models that classified an intermediate percentage of patches, 52±6%, as blebs. To avoid bias, we therefore train models with data where users only choose patches they can confidently classify.</p>
      <p id="P13">Although many morphological motifs, including blebs and filopodia, are described by a single convex surface patch, some motifs, such as lamellipodia, are composites of multiple convex patches. To detect these motifs, we merge convex patches prior to patch classification using a machine-learning framework (<xref rid="F2" ref-type="fig">Fig. 2q</xref>–<xref rid="F2" ref-type="fig">s</xref>). Thirty-six geometric features are calculated for each pair of patches (<xref rid="SD2" ref-type="supplementary-material">Supplementary Table 2</xref>), and training data is generated by asking users to click on adjacent patches that should certainly or certainly not be merged. Following sequential feature selection, an SVM is used to merge patches (<xref rid="F2" ref-type="fig">Fig. 2t</xref>,<xref rid="F2" ref-type="fig">u</xref>).</p>
      <p id="P14">We trained models to detect blebs, filopodia, and lamellipodia (<xref rid="F3" ref-type="fig">Fig. 3</xref>, <xref rid="SD7" ref-type="supplementary-material">Video 4</xref>, and <xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 5</xref>). Most cells in our diverse data set showed predominately one protrusion type. However, as a proof-of-concept, we also built a multiclass detector using a collection of melanoma cells that exhibited extensive blebs and small numbers of filopodia (<xref rid="F4" ref-type="fig">Fig. 4a</xref>). To do so, we generated multiple SVM models in a one-vs-one framework in which separate models were used to distinguish each pair of morphological motifs.</p>
    </sec>
    <sec id="S4">
      <title>Validation and robustness of motif detection</title>
      <p id="P15">To validate the protrusion classification, we calculated the F<sub>1</sub> score using patches selected by the trainer as certainly or certainly not a protrusion. For four randomly chosen blebby melanoma cells, the F<sub>1</sub> score calculated via leave-one-out-cross-validation over cells and averaged across three trainers was 0.986±0.006, corresponding to 1.3±0.6% incorrectly classified patches. This score is high, in part, because only patches users were certain about were included. Calculating F<sub>1</sub> scores for the models where users clicked on all the blebs or all the non-blebs yielded 0.77±0.03 and 0.76±0.04 respectively. However, as discussed above, these training data are biased toward selecting too few and too many blebs, respectively. Indeed, using these training data to validate our model, we find a 16±1% false positive rate (5±1% false negative rate) when users are asked to click on all the blebs and a 30±6% false negative rate (2±1% false positive rate) when users are asked to click on all the non-blebs. Validating over a larger number of cells with a single user, we measured an F<sub>1</sub> score of 0.99 for 19 MV3 cells with blebs, 0.94 for 13 HBECs with filopodia, and 0.88 for 13 dendritic cells with lamellipodia (<xref rid="F4" ref-type="fig">Fig. 4b</xref> and <xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 6a</xref>,<xref rid="SD1" ref-type="supplementary-material">b</xref>).</p>
      <p id="P16">We also tested other machine learning algorithms. We anticipated that the classifier performance would be primarily feature driven, rather than algorithm driven. Indeed, using random forests, linear SVMs, and radial SVMs to detect filopodia and varying the number of rounds of feature selection, we calculated F<sub>1</sub> scores of between 0.934 and 0.944 for almost all algorithms (<xref rid="SD2" ref-type="supplementary-material">Supplementary Table 4</xref>). This suggests that in our workflow linear SVMs perform as well as a broad class of machine learning algorithms.</p>
      <p id="P17">Conversely, a carefully chosen feature set might be able to distinguish motifs from non-motifs using even an unsupervised algorithm that does not require training. We hierarchically clustered all convex surface patches on a set of seven blebby cells into two clusters using such an algorithm (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 7</xref>). Although one of the clusters substantially overlaps with the bleb detection, the supervised algorithm clearly performs better.</p>
      <p id="P18">Because of the selective power of the geometric feature set, our workflow requires relatively little training data. One user training on just one cell in a dataset of 19 blebby cells, yields an F<sub>1</sub> score of 0.94±0.04 (mean ± standard deviation) on the remaining cells (<xref rid="F4" ref-type="fig">Fig. 4c</xref> and <xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 6c</xref>). Additional training data improves the model accuracy marginally, suggesting that models generated by a single user on different data sets would be similar. Indeed, models trained by a single user on distinct sets of four MV3 cells show 95.9±0.7% overlap, as measured by the Sorrenson-Dice index.<sup><xref rid="R21" ref-type="bibr">21</xref></sup> This compares to an 88±3% overlap between models generated by different users (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 6d</xref>). To maximize reproducibility, our classifiers therefore incorporate training data from multiple users via majority voting.</p>
      <p id="P19">Motif models from one cell type can be extended to dissimilar cell types, enabling objective comparisons across biological systems. Applying a bleb model generated from 19 cells originating from a melanoma cell line to 24 cells originating from a human melanoma xenografted into mice yields an F<sub>1</sub> score of 0.97 (<xref rid="F4" ref-type="fig">Fig. 4d</xref>). Likewise, applying a filopodia model generated from 9 melanoma cells to 13 transformed HBEC cells yields an F<sub>1</sub> score of 0.90 (<xref rid="F4" ref-type="fig">Fig. 4e</xref>).</p>
      <p id="P20">The classifier can also be used to compare perturbed and non-perturbed cell populations. To test whether greatly different cell morphologies confound the detection of particular motifs, we used identical analysis parameters to measure the fraction of the cell surface that is blebby in wildtype U2OS cells and cells where the actin regulatory proteins cofilin-1 and Wave2 were knocked out with CRISPR (<xref rid="F4" ref-type="fig">Fig. 4f</xref>,<xref rid="F4" ref-type="fig">g</xref>). Compared to wildtype cells, <italic>CFL1</italic> knockout (cofilinKO) cells exhibit greater cell-to-cell heterogeneity in their bleb surface fraction as well as a larger mean bleb fraction. <italic>WASF2</italic> knockout (WaveKO) cells exhibit even greater heterogeneity and a yet larger mean fraction.</p>
      <p id="P21">So far, we have presented data acquired via meSPIM, a high-resolution light-sheet microscope with nearly isotropic resolution.<sup><xref rid="R10" ref-type="bibr">10</xref></sup> On microscopes with anisotropic resolution, the motif structure varies with orientation relative to the microscope. To test if resolution anisotropy impedes motif detection, we analyzed blebby cells imaged via a laser scanning confocal microscope (<xref rid="F5" ref-type="fig">Fig. 5a</xref>,<xref rid="F5" ref-type="fig">b</xref>). Blebs appeared stretched in the axial (z) direction (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 8</xref>), however the workflow still achieved an F<sub>1</sub> score of 0.94 (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 9</xref>). Standard light-sheet microscopy also has reduced axial resolution compared to meSPIM. Analyzing microglial cells imaged <italic>in vivo</italic> within a zebrafish via a lower resolution commercial light-sheet microscope, we successfully detected extensions (<xref rid="F5" ref-type="fig">Fig. 5c</xref>,<xref rid="F5" ref-type="fig">d</xref>). These findings demonstrate that our pipeline can analyze data from conventional microscopes with anisotropic resolution.</p>
      <p id="P22">To determine whether motif models were transferable among similar microscopes, we directly applied meSPIM motif models to cells imaged by other high-resolution light-sheet microscopes. Detecting blebs on cytosolically labeled cells imaged by axially swept light sheet microscopy (ASLM),<sup><xref rid="R9" ref-type="bibr">9</xref></sup> we measured an F<sub>1</sub> score of 0.96 for both meSPIM and ASLM derived models (<xref rid="F5" ref-type="fig">Fig. 5e</xref>,<xref rid="F5" ref-type="fig">f</xref>). Analyzing previously published movies, we used a meSPIM derived model to detect lamellipodia on a T cell imaged by lattice light-sheet microscopy<sup><xref rid="R8" ref-type="bibr">8</xref></sup> (<xref rid="F5" ref-type="fig">Fig. 5g</xref>,<xref rid="F5" ref-type="fig">h</xref>), and trained a new model to detect extensions on a human breast cancer cell moving through the vasculature of a zebrafish embryo imaged by adaptive-optics lattice light-sheet microscopy<sup><xref rid="R22" ref-type="bibr">22</xref></sup> (<xref rid="F5" ref-type="fig">Fig. 5i</xref> and <xref rid="SD3" ref-type="supplementary-material">Video 5</xref>). Together, these test cases show the broad applicability of u-shape3D, allowing objective comparisons between large numbers of diverse datasets.</p>
    </sec>
    <sec id="S5">
      <title>Kras and PIP<sub>2</sub> signals associate differently with blebs</title>
      <p id="P23">Equipped with a computational framework to analyze 3D cell morphology, we set out to identify relationships between morphological motifs and signaling events. We focused on blebs as the predominant morphological feature of melanoma cells in soft 3D environments<sup><xref rid="R10" ref-type="bibr">10</xref></sup> and sought to measure how PIP<sub>2</sub> and constitutively active Kras<sup>V<xref rid="R12" ref-type="bibr">12</xref></sup>, may associate with this motif. Both Kras<sup>V12</sup> (<xref rid="F1" ref-type="fig">Fig. 1l</xref>) and PIP<sub>2</sub> (<xref rid="F1" ref-type="fig">Fig 1j</xref>) appear to polarize and associate with blebs. To test these hypotheses, we measured the localization of Kras<sup>V12</sup> within 2 μm of the cell surface for 13 MV3 melanoma cells (<xref rid="F6" ref-type="fig">Fig. 6a</xref>,<xref rid="F6" ref-type="fig">b</xref>). We computed at every mesh face the average fluorescence intensity in a sphere around that face, including only pixels within the cell and correcting for surface curvature-dependent artifacts by depth-normalization.<sup><xref rid="R23" ref-type="bibr">23</xref></sup> In addition to blebs, cells expressing GFP-Kras<sup>V12</sup> exhibited retraction fibers and uropods, which could lead to bias. To exclude these structures from the analysis, we built a retraction fiber/uropod detector and subtracted those patches from the set of detected blebs (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 10</xref>). Next, using spherical statistics we found that the Kras<sup>V12</sup> distribution on the cell surface was polarized (<xref rid="F6" ref-type="fig">Fig. 6c</xref>). Likewise, blebs and Kras<sup>V12</sup> surface intensity were directionally correlated (<xref rid="F6" ref-type="fig">Fig 6d</xref>). However, randomizing the location of blebs on the surface, the directional correlation of Kras<sup>V12</sup> with blebs was not significantly different than random. This suggests that Kras<sup>V12</sup> and bleb polarization are correlated partially through their joint coupling to global cell shape. Measuring the mean Kras<sup>V12</sup> localization on and off detected blebs, we found no statistically significant difference (<xref rid="F6" ref-type="fig">Fig. 6e</xref>). However, Kras<sup>V12</sup> does localize to bleb edges (<xref rid="F6" ref-type="fig">Fig. 6f</xref>). In contrast, cytosolic GFP showed no localization to bleb edges (<xref rid="F6" ref-type="fig">Fig. 6f</xref>). This confirms that the modulation of Kras<sup>V12</sup> across the cell surface is related to the distribution of blebs. To further examine the mechanism of this association we measured bleb density locally over a scale less than that of a single bleb by simulating the diffusion on the mesh of the motif classification label (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 11a</xref>,<xref rid="SD1" ref-type="supplementary-material">b</xref>). In this representation, high density values localize to the bleb center, low values to areas away from any bleb, and intermediate values colocalize with bleb edges. In agreement with our previous conclusion, high Kras<sup>V12</sup> signal associated with intermediate local bleb densities (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 11c</xref>). Thus, these analyses suggest that Kras<sup>V12</sup> may be organized to bleb edges. This may at first seem surprising: Kras<sup>V12</sup> is a constitutively activated GTPase without spatially organized interactions with GEFs, GAPs and GDIs. Accordingly, the Kras<sup>V12</sup> distribution is expected to be dominated by diffusion within the plasma membrane with an overall uniform steady state. Simulations of uniformly labeled surface distributions in synthetic cells demonstrate an intensity co-modulation with bleb edges for a variety of surface thicknesses, but not for cytosolically labeled cells (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 11e</xref>). This shows that the Kras<sup>V12</sup> localization at bleb edges is consistent with a uniform surface distribution. This discovery also shows how, in 3D, cell morphological motifs alone offer a mechanism for the spatial organization of molecular signals at the subcellular scale.</p>
      <p id="P24">We next analyzed MV3 cells expressing PLCΔ-PH-GFP (<xref rid="F6" ref-type="fig">Fig 6h</xref>,<xref rid="F6" ref-type="fig">i</xref>), a PIP<sub>2</sub> translocation biosensor that reports the activation of PIP<sub>2</sub>. Like Kras<sup>V12</sup>, the surface localization of PIP<sub>2</sub> is polarized (<xref rid="F6" ref-type="fig">Fig 6j</xref>), and blebs and PIP<sub>2</sub> are directionally correlated (<xref rid="F6" ref-type="fig">Fig. 6k</xref>). However unlike Kras<sup>V12</sup>, the directional correlation of PIP<sub>2</sub> with blebs was significantly different than that of PIP<sub>2</sub> with randomized bleb distributions. Hence, PIP<sub>2</sub> polarization is directly correlated with bleb polarization rather than coupled via the overall cell shape. Indeed, PIP<sub>2</sub> localizes to blebs, with each cell exhibiting a higher mean PIP<sub>2</sub>-intensity on blebs than off (<xref rid="F6" ref-type="fig">Fig. 6l</xref>). Consistent with a surface fluorescence distribution, PIP<sub>2</sub> like Kras<sup>V12</sup> also associates with bleb edges (<xref rid="F6" ref-type="fig">Fig. 6m</xref>). However, whereas Kras<sup>V12</sup> localization falls off with increasing distance from a bleb edge both on and off blebs, PIP<sub>2</sub> localization falls off with increasing distance from a bleb edge only in regions that are not identified as blebs. Similarly, high PIP<sub>2</sub> activity associates with intermediate local bleb densities (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 11d</xref>), whereas low PIP<sub>2</sub> activity associates with small but not with high local bleb densities. This shows a specific recruitment of active PIP<sub>2</sub> to the entire bleb surface. The mechanism underlying this process remains elusive.</p>
      <p id="P25">Our workflow supports many other types of analyses relating cell morphology and molecular distributions. For example, underlying the extraction of morphological motifs are geometric properties that can be analyzed. Measuring bleb volume, we found that small and large blebs show similar association with Kras<sup>V12</sup> (<xref rid="F6" ref-type="fig">Fig. 6g</xref>), whereas large blebs show greater association with PIP<sub>2</sub> than small blebs (<xref rid="F6" ref-type="fig">Fig. 6n</xref>). Cytosolically labeled cells show no association of intensity with bleb volume (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 11f</xref>).</p>
      <p id="P26">Since the study of many signaling pathways benefits from measuring not just morphology, but also morphodynamics, we developed a measure of boundary motion at each mesh face. <xref rid="F6" ref-type="fig">Fig. 6o</xref> shows the PIP<sub>2</sub> activation of an MV3 cell, and <xref rid="F6" ref-type="fig">Fig. 6p</xref> shows that cell’s boundary motion. Measuring the motion difference over ~30 sec, which is on the order of the bleb lifetime,<sup><xref rid="R24" ref-type="bibr">24</xref></sup> we found that blebs preferentially associate with regions of protrusive motion (<xref rid="F6" ref-type="fig">Fig. 6q</xref>). We also observed that regions of high PIP<sub>2</sub> tend to be more retractive than regions of low PIP<sub>2</sub> (<xref rid="F6" ref-type="fig">Fig. 6r</xref>), which is consistent with increased PIP<sub>2</sub> localization on blebs because blebs form and retract cyclically. These and other evidence of relations between local surface geometry and PIP<sub>2</sub> activation will be essential to uncovering the mechanism of a bleb-formation and bleb-size dependent organization of PIP<sub>2</sub> signals.</p>
    </sec>
  </sec>
  <sec id="S6">
    <title>Discussion</title>
    <p id="P27">High-resolution 3D light-sheet microscopy,<sup><xref rid="R6" ref-type="bibr">6</xref>–<xref rid="R11" ref-type="bibr">11</xref></sup> has enabled the direct observation of subcellular molecular processes. However, incorporating these observations into a framework for unbiased data exploration, hypothesis testing, and ultimately the development of new biological theories remains a challenge.</p>
    <p id="P28">The majority of publications describing innovations in 3D microscopy end with the appealing rendering of a few images on a 2D screen. Even this mere visualization task imposes a particular perspective and thus introduces bias.<sup><xref rid="R14" ref-type="bibr">14</xref></sup> Moreover, compared to 1D and 2D features, such as length and area, human observers exhibit decreased ability to assess 3D features, such as shape and volume.<sup><xref rid="R25" ref-type="bibr">25</xref></sup> Thus, to turn innovation in 3D imaging into biological insight, computing infrastructures are required that minimize the need for human visual interpretation when comparing datasets.</p>
    <p id="P29">Here, we focused on algorithms that enable the analysis of biological surfaces at the scale of single cells. We developed an algorithm to detect diverse morphological motifs on the cell surface using machine learning. As a demonstration, we trained classifiers for blebs, filopodia, lamellipodia, among other motifs. To detect a new type of morphological motif, users need only click on examples of surface regions that are and are not that motif. This detector is one of the first image analysis tools for cell biology that incorporates techniques from computer graphics. With the rapid rise of 3D microscopy, computer graphics methods will become an important factor in biological discovery.</p>
    <p id="P30">In addition to a morphological motif detector, we developed an integrated suite of tools for investigating the coupling between morphology, morphology change, and intracellular signaling. Since signaling networks are usually highly nonlinear, the spatial distribution of signaling molecules can greatly affect downstream signaling. Cells take advantage of this effect to control signaling via spatial localization in myriad ways including compartmentalization, phase separation, and active transport. Cell morphology may also govern signaling. For example, we found that on blebby melanoma cells both Kras<sup>V12</sup> and PIP<sub>2</sub> polarize with blebs. PIP<sub>2</sub> is enriched on blebs, whereas Kras<sup>V12</sup> is not. Investigating further, we discovered that Kras<sup>V12</sup> localizes to bleb edges and that its distribution is consistent with that of a membrane label. Together, these data suggest the possibility that membrane wrinkling alone or enrichment on blebs could modulate nonlinear signaling networks by concentrating membrane-bound proteins. These two examples also illustrate how u-shape3D supports i) the acquisition of maps and statistics of the spatial modulation of protein concentrations that would be inaccessible by visual inspection; and ii) the numerical treatment of complex geometric arrangements that are at the root of non-intuitive cell behaviors. In future, these features of u-shape3D will enable projects ranging from cell behavioral screens and FRET measurements linking signaling to morphology to molecularly specific investigations of 3D signaling <italic>in vivo</italic>.</p>
  </sec>
  <sec id="S7">
    <title>Online Methods</title>
    <sec id="S8">
      <title>Cell culture and genetic engineering</title>
      <p id="P31">Cells were cultured at 5% CO<sub>2</sub> and 21% O<sub>2</sub>. MV3 melanoma cells (a gift from Peter Friedl at MD Anderson Cancer Center) were cultured using DMEM (Gibco) supplemented with 10% fetal bovine serum. Primary melanoma cells (a gift from Sean Morrison at UT Southwestern Medical Center) were cultured using the Primary Melanocyte Growth Kit (ATCC). Human bronchial epithelial cells (HBEC; a gift from John Minna at UT Southwestern Medical Center), immortalized with Cdk4 and hTERT expression and transformed with p53 knockdown, Kras<sup>V12</sup>, and cMyc expression,<sup><xref rid="R26" ref-type="bibr">26</xref></sup> were cultured in keratinocyte serum-free medium (Gibco) supplemented with 50 mg/ml of bovine pituitary extract (Gibco), 5 ng/ml of EGF (Gibco), and 1% Anti-Anti (Gibco). U2OS osteosarcoma cells (a gift from Dick McIntosh at the University of Colorado, Boulder) were cultured using high-glucose DMEM (Gibco) supplemented with pyruvate, stable glutamine, and 10% fetal bovine serum. Conditionally immortalized hematopoietic precursors to dendritic cells<sup><xref rid="R27" ref-type="bibr">27</xref></sup> that express Lifeact-GFP<sup><xref rid="R28" ref-type="bibr">28</xref></sup> (a gift from Michael Sixt, IST Austria) were cultured and differentiated as previously described.<sup><xref rid="R29" ref-type="bibr">29</xref></sup></p>
      <p id="P32">Unless stated otherwise, fluorescent constructs were introduced into cells using the pLVX lentiviral system (Clontech) and selected using antibiotic resistance to either puromycin or geniticin. The GFP-tractin construct contains residues 9–52 of the enzyme IPTKA<sup><xref rid="R30" ref-type="bibr">30</xref></sup> fused to GFP.<sup><xref rid="R31" ref-type="bibr">31</xref></sup> The CyOFP-tractin peptide contains the tractin peptide fused to the CyOFP protein. CyOFP is a cyan-excitable orange fluorescent protein with peak excitation at 505 nm and peak emission at 588 nm.<sup><xref rid="R32" ref-type="bibr">32</xref></sup> The GFP-Kras<sup>V12</sup> plasmid was constructed by cloning a Kras<sup>V12</sup> fragment from the pLenti-Kras<sup>V12</sup> construct<sup><xref rid="R26" ref-type="bibr">26</xref></sup> into the pLVX-GFP vector. The biosensor for PIP<sub>2</sub>, PLCΔ-PH-GFP, encodes a PI(4,5)P2 lipid selective PH domain that can be used as a fluorescent translocation biosensor to monitor changes in the concentration of plasma membrane PI(4,5)P2 lipids.<sup><xref rid="R33" ref-type="bibr">33</xref></sup> Some MV3 cells expressing GFP in the cytosol and imaged via meSPIM, appeared in a previous publication, and were analyzed here as a control population.<sup><xref rid="R10" ref-type="bibr">10</xref></sup></p>
      <p id="P33">For the CRISPR knockouts, U2OS cells were transiently transfected with pX458 including gene-specific guide RNAs together with a self-cleaving donor vector to deliver a blasticidin S resistant cassette into the genomic cut site. Cells were selected with 5 μg/ml blasticidin S and surviving colonies were isolated using 6 mm Pyrex cloning cylinders (Sigma-Aldrich). The pSpCas9(BB)-2A-GFP (pX458) was a gift from Dr. Feng Zhang (Addgene plasmid # 48138). The self-cleaving donor vector pMA-tial1 was a kind gift from Dr. Tilmann Buerckstuemmer (Horizon Genomics, Vienna, Austria). Guide RNA sequences were cloned into pX458 by Golden Gate cloning utilizing the BbsI cut site. Guide RNA sequences targeting Wave2 (<italic>WASF2</italic>; exon 3) and cofilin-1 (<italic>CFL1</italic>; exon 2) were 5’- TGAGAGGGTCGACCGACTAC −3’, and 5’- CGTAGGGGTCGTCGACAGTC −3’, respectively. Gene knockout was verified by western blotting using rabbit anti-cofilin-1 (Cell Signaling; D3F9 XP # 5175) and rabbit anti-Wave2 (Cell Signaling; D2C8 XP #3659) antibodies (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 12</xref>).</p>
    </sec>
    <sec id="S9">
      <title>Imaging</title>
      <p id="P34">Unless stated otherwise, imaging was performed via microenvironmental selective plane illumination microscopy,<sup><xref rid="R10" ref-type="bibr">10</xref></sup> a type of two-photon Bessel beam light sheet microscopy that confers near-isotropic resolution (300 nm lateral, 340 nm axial) and permits recording of cell behavior several millimeters from mechanically perturbing hard surfaces. Images were acquired at 37 °C in a non-descanned image capture mode with an axial step size of 160 or 200 nm and an excitation wavelength of 900 nm. Melanoma cells were imaged in cell culture medium supplemented with HEPES buffer to maintain pH during imaging.</p>
      <p id="P35">Confocal imaging was performed using a Zeiss LSM 780 with a 40x (1.4 NA) objective. Microglia were imaged within zebrafish using a Zeiss Lightsheet Z.1 with 20x detection (1.0 NA) and 5x illumination (0.1 NA) objectives. The zebrafish line was P2Y12::P2Y12-GFP and was 3.5 dpf. Axially swept light-sheet microscopy (ASLM) imaging was performed using a custom-built microscope as previously described.<sup><xref rid="R9" ref-type="bibr">9</xref></sup></p>
      <p id="P36">U2OS cells were allowed to spread overnight in pH-neutralized rat-tail collagen (3 mg/ml) prior to imaging. All other cells, except for those imaged by the Peri and Betzig laboratories, were imaged in collagen gels created by mixing bovine collagen I (Advanced Biomatrix) with concentrated PBS and water to a collagen density of 2.0 mg/ml. This collagen solution was then neutralized with 1 M NaOH and mixed with cells just prior to incubation at 37 °C to induce collagen polymerization. U2OS cells and MV3 cells imaged via confocal microscopy were fixed in 4% paraformaldehyde prior to imaging.</p>
    </sec>
    <sec id="S10">
      <title>Image deconvolution</title>
      <p id="P37">All microscopy images shown are raw, non-deconvolved images. However, as a first analysis step, we deconvolved each 3D image. Most images acquired via meSPIM were Wiener deconvolved as previously described.<sup><xref rid="R10" ref-type="bibr">10</xref></sup> The microscope’s point spread function (PSF) was measured using fluorescent beads. The Wiener parameter, which is the inverse of the signal-to-noise ratio, was usually set to 0.018. However, to better detect the dim ends of filopodia, it was set to 0.015. For cytosolically labeled cells, we automatically estimated the Wiener parameter in each frame by defining the signal as the average fluorescence intensity within the cell and the noise as the standard deviation of the fluorescence intensity outside the cell. <xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 2</xref> shows the effect of varying the Wiener and other deconvolution parameters, and <xref rid="SD2" ref-type="supplementary-material">Supplementary Table 5</xref> shows the deconvolution and surface extraction parameters for all datasets presented in this paper. Since Wiener deconvolution is sensitive to PSF quality, for images acquired via microscopy modalities other than meSPIM, we used the Richardson-Lucy deconvolution algorithm built-in to Matlab. The movie of the MDA-MB-231 human breast cancer cell was deconvolved as previously described.<sup><xref rid="R22" ref-type="bibr">22</xref></sup></p>
      <p id="P38">Following deconvolution, an apodization filter was applied to the optical transfer function (OTF) of the image in the spatial frequency domain. This filter had a value of 1 at the origin and decayed linearly to 0 at the edge of the filter support, which is set by the user as a percentage of the maximum OTF value. This threshold value, here termed the apodization height, was usually adjusted according to the homogeneity of the fluorescence label and the fineness of the morphological motif being detected. Higher apodization heights smooth the image more and allow for more robust detection of large objects, whereas lower apodization heights allow for the detection of finer structures but also admit more noise.</p>
    </sec>
    <sec id="S11">
      <title>Cell surface extraction</title>
      <p id="P39">The deconvolved images were further processed prior to cell surface extraction. For the majority of data sets, an Otsu threshold was first calculated from the 3D image,<sup><xref rid="R34" ref-type="bibr">34</xref></sup> holes were filled using a 3D grayscale flood-fill operation, and objects disconnected from the main cell were removed. We also optionally smoothed the image with a 3D Gaussian kernel and applied a gamma correction. Matlab’s <italic>isosurface</italic> function was then used to create a triangle mesh at the intensity value specified by the Otsu threshold. Finally, the triangle mesh was smoothed using curvature flow smoothing.<sup><xref rid="R35" ref-type="bibr">35</xref></sup></p>
      <p id="P40">For some datasets, this procedure does not segment the nucleus along with the cytoplasm. In these cases, we therefore combined the output image of the procedure described above with an “inside” image that segmented the cell interior. To create the “inside” image from the gamma corrected image, we applied an additional gamma correction, smoothed the image with a 3D Gaussian kernel of standard deviation 2 pixels, Otsu thresholded the image, morphologically dilated the image, filled holes in each xy-slice, morphologically eroded the image by a radius greater than the morphological dilation, and finally smoothed the binary image with a 3D Gaussian kernel of width 1 pixel. Since this process shrinks the cell, if the parameters are chosen correctly the edges of the morphological motifs should mostly lay outside the “inside” image. To combine the “inside” image with the image outputted by the procedure above, we normalized this image by its Otsu threshold value, took the pixel-by-pixel maximum of this image and the “inside” image, and extracted a triangle mesh as an isosurface at an intensity level of 1.</p>
      <p id="P41">The ends of the long, thin lamellipodia of dendritic cells fail to segment using the techniques described above. To better segment lamellipodia, we combined the “inside” and normalized deconvolved images described above for PIP<sub>2</sub> labeled cells with a “surface filtered” image that enhances planar features, such as lamellipodia (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 3</xref>). The surface filter, which was developed by Elliott <italic>et al.</italic>,<sup><xref rid="R23" ref-type="bibr">23</xref></sup> uses multiscale Gaussian second order partial-derivative kernels of the form
<disp-formula id="FD1"><label>(1)</label><mml:math display="block" id="M1"><mml:msub><mml:mrow><mml:mi>s</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>ω</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>ω</mml:mi></mml:mrow></mml:msub><mml:msqrt><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:msqrt></mml:mrow></mml:mfrac><mml:mrow><mml:msubsup><mml:mo mathsize="small">∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mi mathvariant="normal">′</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mi mathvariant="normal">′</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo>∂</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mi mathvariant="normal">′</mml:mi></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>ω</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mi>I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
where <italic>I</italic>(<italic>x</italic>) is the image intensity, <italic>σ</italic><sub><italic>i,ω</italic></sub> is the half width of the Gaussian in dimension <italic>i</italic> at scale <italic>ω</italic>, Ω<sub><italic>k</italic></sub> is the filter kernel support, and <italic>s</italic>(<italic>x</italic>)<sub><italic>ω</italic></sub> is the filter response at scale <italic>ω</italic>. The total filter response, <italic>S</italic>(<italic>x</italic>), is merged across scales via
<disp-formula id="FD2"><label>(2, 3)</label><mml:math display="block" id="M9"><mml:mi>S</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>ω</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>ω</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>ω</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="1.5em"/><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>ω</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>ω</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p id="P42">We used filter scales 1.5, 2, and 4 pixels to segment lamellipodia of various thicknesses. To combine the response of the surface filter with the “inside” and normalized deconvolved images, we normalized the response by subtracting both the mean image intensity and twice the standard deviation of the image intensity prior to dividing by the standard deviation of the image intensity.</p>
      <p id="P43">Although not used in this paper, our software also includes the option to segment cells by combining a normalized deconvolved image with a steerable filtered image. Steerable filters are computationally efficient edge detectors that, depending upon the parameters chosen, enhance linear or planar structures at specified scales.<sup><xref rid="R36" ref-type="bibr">36</xref>,<xref rid="R37" ref-type="bibr">37</xref></sup></p>
      <p id="P44">Segmentations were spot checked by thresholding the 3D image at the isosurface intensity value immediately prior to mesh extraction and examining the overlaid raw and thresholded images as 3D image stacks in ImageJ<sup><xref rid="R38" ref-type="bibr">38</xref></sup> (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 13</xref>). For analyses where internal mesh cavities could alter results, meshes were also exported to ChimeraX<sup><xref rid="R39" ref-type="bibr">39</xref></sup> for further examination. Segmentations that were found to be inaccurate or had cavities were excluded from further analysis.</p>
    </sec>
    <sec id="S12">
      <title>Decomposition of the cell surface into convex patches</title>
      <p id="P45">Although the image deconvolution and cell surface extraction parameters require customization for different cell types, the remainder of the workflow does not, and its parameters were kept constant throughout the paper.</p>
      <p id="P46">To decompose the cell surface into convex patches, we first performed a watershed segmentation of surface mean curvature, as previously described.<sup><xref rid="R10" ref-type="bibr">10</xref></sup> This oversegments the cell surface into small patches, which are analogous to superpixels in image analysis, which we later merge to create convex patches. First, we calculated the mean and Gaussian curvature at every triangle face.<sup><xref rid="R17" ref-type="bibr">17</xref>,<xref rid="R23" ref-type="bibr">23</xref></sup> Next, we constructed an adjacency graph of faces where each face is a node that is connected to exactly three other spatially adjacent faces. Matlab’s <italic>isosurface</italic> function does not always produce triangle meshes with sufficient topological consistency to create such a graph. Our software fixes common topological inconsistencies, such as triangular edges that are only connected to one face. Rarely, however, a face graph cannot be constructed. In these situations, very slightly changing the image deconvolution parameters usually solves the problem, although we did not need to do so here. Since curvature can be noisy, we next smoothed mean curvature in two different ways. First, we used a kd-tree to median filter curvature in 3D space over 2 pixels. The meSPIM is Nyquist sampled, and so 2 pixels, which is 320 nm, is approximately the microscope’s spatial resolution. Second, to reduce spurious curvature fluctuations, we diffused mean curvature on the mesh using a diffusion kernel<sup><xref rid="R40" ref-type="bibr">40</xref>,<xref rid="R41" ref-type="bibr">41</xref></sup> according to the equation
<disp-formula id="FD3"><label>(4)</label><mml:math display="block" id="M10"><mml:mi mathvariant="bold-italic">S</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mi mathvariant="bold-italic">R</mml:mi></mml:math></disp-formula>
for 20 iterations, where <bold><italic>R</italic></bold> is the curvature, <inline-formula><mml:math display="inline" id="M11"><mml:mover accent="true"><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula> is a normalized, weighted adjacency matrix of the faces graph, <italic>k</italic> is the number of iterations, and <bold><italic>S</italic></bold> is the smoothed curvature. We defined <italic>A</italic> as
<disp-formula id="FD4"><label>(5)</label><mml:math display="block" id="M13"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">if</mml:mi><mml:mspace width="0.25em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">if</mml:mi><mml:mspace width="0.25em"/><mml:mi>i</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">is</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">adjacent</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">to</mml:mi><mml:mspace width="0.25em"/><mml:mi>j</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">otherwise</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>
where <italic>d<sub>ij</sub></italic> is the distance between faces <italic>i</italic> and <italic>j</italic>. To normalize <italic>A</italic>, we multiplied it by a diagonal matrix, where each diagonal element was the inverse of the sum of that row. Next, we performed a watershed segmentation of the smoothed curvature over the cell surface.<sup><xref rid="R18" ref-type="bibr">18</xref></sup> Watershed segmentations are often performed on 2D images, where each pixel is adjacent to exactly four other pixels. Here, we similarly performed a watershed segmentation over the adjacency graph of faces, where each face is adjacent to exactly three faces.</p>
      <p id="P47">We next merged adjacent patches using a spill depth criterion.<sup><xref rid="R18" ref-type="bibr">18</xref></sup> Here, the spill depth between two adjacent patches was defined as the maximum curvature of the two patches minus the maximum curvature at the patch-patch interface. This is analogous to the depth of water that the patch can hold before spilling into the neighboring patch. Starting with the smallest spill depth, we merged patches until no spill depth was below a cutoff of 0.6 times the Otsu threshold of mean curvature for the cell. <xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 4</xref> shows the effect of altering the spill-depth cutoff and other patch merging parameters.</p>
      <p id="P48">Finally, we decomposed the surface into approximately convex patches by iteratively applying the triangle and line-of-sight (LOS) criteria. To apply the triangle criterion,<sup><xref rid="R10" ref-type="bibr">10</xref></sup> we first calculated the closure surface area for each patch and pair of adjacent patches. We defined the closure surface area as the minimum additional surface area needed to create a closed polyhedron from a surface patch. We then merged adjacent patches if they meet the criterion
<disp-formula id="FD5"><label>(6)</label><mml:math display="block" id="M18"><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">AB</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msqrt><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>&gt;</mml:mo><mml:mi>ρ</mml:mi><mml:mo>,</mml:mo></mml:math></disp-formula>
where <italic>σ<sub>A</sub></italic> and <italic>σ<sub>B</sub></italic> are the closure surface areas of the two patches, <italic>σ<sub>AB</sub></italic> is the closure surface area of the merged patch, and <italic>ρ</italic> is the triangle cutoff parameter, which we here set to 0.7. The triangle criterion can be thought of as similar to the law of cosines and intuitively seeks to merge patches that meet at small angles. Starting with the largest <italic>ρ</italic>, we merged all pairs of patches that met the triangle criterion before applying the LOS criterion.</p>
      <p id="P49">The LOS criterion merges adjacent patches with high mutual visibility.<sup><xref rid="R19" ref-type="bibr">19</xref>,<xref rid="R42" ref-type="bibr">42</xref></sup> We defined the mutual visibility of patches <italic>A</italic> and <italic>B</italic> as the percentage of line segments that connect a face in <italic>A</italic> with a face in <italic>B</italic> that are lines of sight, where a line of sight is a line segment that falls entirely within the mesh. We calculated mutual visibility by randomly selecting a face on each patch, and using a triangle-ray intersection<sup><xref rid="R43" ref-type="bibr">43</xref></sup> algorithm to determine whether a line segment connecting the two faces exited and reentered the mesh. A small patch and an adjacent very large patch may have a large mutual visibility because of lines of sight that extend across the width of the cell, even if these two patches should not be merged. When merging two patches, we therefore discarded line segments that were longer than twice the smaller patch size. <xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 14a</xref> shows the convergence of mutual visibility as a function of the number of line segments tested. We calculated mutual visibility from 20 line segments per pair of patches. In an exact convex decomposition, any two points within any patch could be connected by a line of sight. However, because of biological variation and image noise, requiring a mutual visibility of 1 is too strict a requirement for cell images. We instead merge patches if their mutual visibility is greater than 0.7. Starting with the largest mutual visibility between patch pairs, we merged all patch pairs meeting the LOS criterion, before again applying the triangle criterion.</p>
      <p id="P50">Having three patch merging criteria for convex surface decomposition allows us to balance accuracy, speed, and robustness to noise. The spill-depth criterion is fast but potentially inaccurate, whereas the LOS criterion is relatively slow, but exact. The triangle criterion implements the short-cut rule,<sup><xref rid="R20" ref-type="bibr">20</xref></sup> which biases merging towards certain types of convex decompositions. By adjusting the three merging parameters, users can control which criteria dominate in their analysis.</p>
    </sec>
    <sec id="S13">
      <title>Classification of morphological motifs</title>
      <p id="P51">To classify each patch by morphological motif, we first performed feature selection on the geometric patch features listed in <xref rid="SD2" ref-type="supplementary-material">Supplementary Table 1</xref>. Implemented by the Matlab built-in function <italic>sequentialfs()</italic>, our sequential feature selection randomly successively removed features as long as doing so reduced the misclassification rate. The misclassification rate was measured using 10-fold cross validation. The geometric features selected can vary considerably from dataset to dataset even for similar training sets, presumably because of correlations between features, randomness, and dataset differences. For example, <xref rid="SD2" ref-type="supplementary-material">Supplementary Table 6</xref> shows the features selected for bleb detection models generated by three different users training on the same four cells. In this example, no feature was selected by all three models, and no two models shared more than two selected features. Once features were selected, features were normalized to have the same mean and standard deviation, and a linear support vector machine (SVM)<sup><xref rid="R44" ref-type="bibr">44</xref></sup> was used to classify patches. Since SVM models vary from user to user, to analyze actin, Kras, and PIP<sub>2</sub> localization, we had models created by three different users vote on the classification of each bleb.</p>
      <p id="P52">We also validated our workflow with the linear SVM replaced with a radial SVM or a random forest.<sup><xref rid="R45" ref-type="bibr">45</xref></sup>
<xref rid="SD2" ref-type="supplementary-material">Supplementary Table 6</xref> shows the precision, recall, and F<sub>1</sub> score of these algorithms for various iterations of feature selection. For the radial SVM, we used the Gaussian kernel,
<disp-formula id="FD6"><label>(7)</label><mml:math display="block" id="M28"><mml:mi>K</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>−</mml:mo><mml:mo>‖</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p id="P53">To implement the random forest, we used the <italic>treeBagger</italic>() function in Matlab. Measuring the out-of-bag classification error as a function of the number of trees grown, we observed that the error plateaued at approximately 10 trees, which is well below the 30 and 200 tree forests that we tested.</p>
      <p id="P54">To compare our workflow, which employs a supervised machine-learning algorithm, to an unsupervised algorithm, we performed an agglomerative hierarchical clustering on all the patches and the patches classified by the supervised algorithm as motifs of interest (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 7</xref>), respectively. We used the correlation as a distance metric and measured the distance between a pair of clusters as the average distance between any two pairs of patches in these clusters. To avoiding biasing the algorithm, we only clustered on statistics defined at the patch scale, and did not include cell scale statistics, such as cell volume.</p>
    </sec>
    <sec id="S14">
      <title>Characterization of patches</title>
      <p id="P55">To classify patches by morphological motif, we calculated geometric descriptions of each patch. The full list of 23 features used by the SVM classifier is provided in <xref rid="SD2" ref-type="supplementary-material">Supplementary Table 1</xref>. In calculating these features, mean curvature was smoothed as described above, but Gaussian curvature was not. We defined the average patch position as the mean location of the faces in the patch, and we similarly defined the weighted average patch position as the mean location of the faces weighted by curvature. The feature ‘variation from a sphere’ was defined by the standard deviation of the distances from a patch’s faces to the average patch position divided by the mean distance of those faces to the average patch position. We defined the closure surface area as described above. The closure center was also defined as the mean position of the mesh vertices at the patch edge. We defined the patch radius as the mean distance of the patch’s faces from the closure center.</p>
      <p id="P56">The volume, <italic>V</italic>, was calculated using the equation
<disp-formula id="FD7"><label>(8)</label><mml:math display="block" id="M30"><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:mfrac><mml:mrow><mml:msubsup><mml:mo mathsize="small">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>
where <italic>N</italic> is the number of faces, and <bold><italic>v</italic></bold><sub><bold>1,<italic>i</italic></bold></sub>, <bold><italic>v</italic></bold><sub><bold>2,<italic>i</italic></bold></sub>, and <bold><italic>v</italic></bold><sub><bold>3,<italic>i</italic></bold></sub> are the vertices of face <italic>i</italic>. The vertices must be ordered such that the face normal extends outwards from the cell. To derive this equation, the mesh can be thought of as decomposed into tetrahedrons where the vertices of each tetrahedron are those of a face combined with the origin.<sup><xref rid="R46" ref-type="bibr">46</xref></sup> The signed volumes of the tetrahedrons sum to the volume of the mesh. Patches were closed prior to calculating their volumes.</p>
      <p id="P57">We calculated the shape diameter function similarly to Shapira <italic>et al.</italic><sup><xref rid="R47" ref-type="bibr">47</xref></sup> For each patch, we randomly picked 20 mesh faces on the patch and extended a ray inwards from the mesh face at a randomly chosen angle within <italic>π</italic>/3 of the direction opposite to the face’s normal. We calculated the distance each ray traveled before intersecting the opposite side of the mesh. The shape diameter function of the patch was then defined as the mean travel distance within one standard deviation of the median distance.</p>
    </sec>
    <sec id="S15">
      <title>Features selected for patch classification</title>
      <p id="P58">The feature selection algorithm selected different geometric features to detect the three morphologies. To determine which geometric features best distinguished morphologies, starting from no features, we successively added the most discriminative feature to the model (<xref rid="SD2" ref-type="supplementary-material">Supplementary Table 3</xref>). The features that best distinguished blebs from non-blebs were volume / (closure surface area)<sup>3/2</sup> and mean curvature on the protrusion edge. Closure surface area is the minimum amount of additional surface area needed to create a closed polygon from the mesh of the patch. The features that best distinguished filopodia from non-filopodia were the distance from the center of the closure surface area to the mean face position, a measure of morphological feature length, and patch surface area. This same measure of morphological feature length as well as patch volume were the best features for distinguishing lamellipodia from non-lamellipodia.</p>
    </sec>
    <sec id="S16">
      <title>Optional merging of convex patches</title>
      <p id="P59">Some morphological motifs, such as lamellipodia and flagella, are not convex but are composed of multiple convex regions. To detect such motifs, we optionally merge convex patches into patch composites. Since adjacent patches that compose a larger structure often have smooth curvature at their interface, we first merge patches using a modified line of sight criterion with line segment length capped at 10 pixels and a mutual visibility cutoff of 0.7. The line of sight criterion is described above. This step is not required for convex patch merging and can be disabled by the user. We next employed a more versatile machine learning based framework to merge adjacent patches. Using the geometric features for pairs of adjacent patches listed in <xref rid="SD2" ref-type="supplementary-material">Supplementary Table 2</xref>, as well as user provided training data, we trained an SVM to automatically merge patches. We used the same feature selection procedure and SVM parameters as for patch classification.</p>
    </sec>
    <sec id="S17">
      <title>Characterization of adjacent patches</title>
      <p id="P60">To merge adjacent patches into patch composites using an SVM, we calculated geometric characterizations of each pair of adjacent patches. The full list of 36 features used by the SVM is provided in <xref rid="SD2" ref-type="supplementary-material">Supplementary Table 2</xref>. Some measures of patch pairs incorporate individual patch measures, which are described above. Unless otherwise specified, mean curvature was smoothed as described above, but Gaussian curvature was not.</p>
      <p id="P61">To better describe the surface geometry at patch-patch interfaces, we calculated the two principal curvatures, <italic>κ</italic><sub>1</sub> and <italic>κ</italic><sub>2</sub>, everywhere on the cell surface,
<disp-formula id="FD8"><label>(9, 10)</label><mml:math display="block" id="M38"><mml:msub><mml:mrow><mml:mi>κ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>H</mml:mi><mml:mo>+</mml:mo><mml:msqrt><mml:msup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mi>K</mml:mi></mml:msqrt><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>κ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>H</mml:mi><mml:mo>−</mml:mo><mml:msqrt><mml:msup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mi>K</mml:mi></mml:msqrt><mml:mo>,</mml:mo></mml:math></disp-formula>
where <italic>H</italic> is the unsmoothed mean curvature and <italic>K</italic> is the unsmoothed Gaussian curvature. For various geometries defined by principal curvature values, we then calculated the fraction of the interface that had that geometry. As a noise threshold, we used the standard deviation of the smoothed mean curvature. Principal curvatures above this threshold or below the negative of this threshold were defined as large, and those more than four times above or below it as very large. We defined a ridged geometry as a large positive <italic>κ</italic><sub>1</sub> and a small <italic>κ</italic><sub>2</sub>, a very ridged geometry as a very large positive <italic>κ</italic><sub>1</sub> and a small <italic>κ</italic><sub>2</sub>, a valley-like geometry as a small <italic>κ</italic><sub>1</sub> and a large negative <italic>κ</italic><sub>2</sub>, a very valley-like geometry as a small <italic>κ</italic><sub>1</sub> and a very large negative <italic>κ</italic><sub>2</sub>, a domed geometry as a large positive <italic>κ</italic><sub>1</sub> and a large positive <italic>κ</italic><sub>2</sub>, a cratered geometry as a large negative <italic>κ</italic><sub>1</sub> and a large negative <italic>κ</italic><sub>2</sub>, a flat geometry as a small <italic>κ</italic><sub>1</sub> and a small <italic>κ</italic><sub>2</sub>, and a saddle-like geometry as a large positive <italic>κ</italic><sub>1</sub> and a large negative <italic>κ</italic><sub>2</sub>.</p>
    </sec>
    <sec id="S18">
      <title>Generation of training data</title>
      <p id="P62">We designed a graphical user interface to enable the collection of training data necessary for motif classification. Users are shown a surface rendering of a cell with surface patches outlined and can interact with the cell by rotating and moving it, and zooming in and out on regions of interest. To generate data for patch classification, we asked users to click on patches that are certainly the morphological motif of interest and then subsequently asked them to click on patches that are certainly not that motif. Similarly, to generate data for the optional step of convex patch merging, we asked users to click on pairs of patches that should certainly be merged and then asked them to click on pairs of patches that should certainly not be merged. Pairs of patches that were not adjacent were automatically excluded from the training set. We have successfully tested this interface in Matlab versions R2017b and R2013b. However, since in Matlab user interface functionality can vary from version to version, it may not work in some versions of Matlab.</p>
    </sec>
    <sec id="S19">
      <title>Validation</title>
      <p id="P63">To validate the protrusion classification, we calculated the F<sub>1</sub> score, which is the harmonic mean of precision and recall. Here, precision is defined as the ratio of patches correctly classified as protrusions to the total number of patches classified as protrusions, whereas recall is defined as the ratio of patches correctly classified as protrusions to the total number of patches that are protrusions. Unless otherwise specified, in calculating the F<sub>1</sub> score, we only used patches selected by the trainer as certainly a protrusion or certainly not a protrusion.</p>
    </sec>
    <sec id="S20">
      <title>Generation and analysis of synthetic images</title>
      <p id="P64">For algorithm validation, we created synthetic spherical cells of radius 48 pixels. The cell size was chosen to mimic the pixel spacing on the meSPIM of 0.16 μm per pixel for a cell 7.6 μm in radius. Placed randomly on the cells’ surfaces were spherical blebs that ranged in radius from 2 to 32 pixels and in number from 4 to 256 per cell. (See <xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 15</xref> for example synthetic cells). Since pixelation at the cell edge could hamper the cell surface extraction and subsequent analysis, edge pixels were subdivided into a finer 3D grid to calculate the percentage of the pixel occupied by the synthetic cell. The final synthetic images were saved with 32 grayscale intensity values. Synthetic cells were not deconvolved, but the remainder of the analysis workflow was identical to that used for microscopic data. The same surface extraction parameters were used as for bleb detection on tractin and cytosolically labeled cells.</p>
      <p id="P65">An F<sub>1</sub> score does not measure whether or not the workflow preferentially detects certain subtypes of protrusions. Since patch-merging algorithms could be sensitive to protrusion size, we used synthetic data to test the algorithm’s sensitivity to bleb size (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 15</xref>). On synthetic cells of radius 7.6 μm (48 pixels) we simulated blebs ranging in radius from 0.32 μm (2 pixels) and 0.64 μm (4 pixels) to 5.1 μm (32 pixels). Although only 70% of the smallest 0.32 μm radii blebs were decomposed as convex surface patches, almost all of the larger blebs were decomposed. A bleb detector trained on synthetic data correctly classified all blebs that were decomposed as convex surfaces.</p>
    </sec>
    <sec id="S21">
      <title>Mapping fluorescence intensity to the cell surface</title>
      <p id="P66">To measure the fluorescence intensity local to each mesh face, we used the raw, non-deconvolved, fluorescence image. At each mesh face, we used a kd-tree to measure the average pixel intensity within the cell and within a sampling radius of the mesh face. To correct for surface curvature dependent artifacts, we depth normalized<sup><xref rid="R23" ref-type="bibr">23</xref></sup> the image prior to measuring intensity localization by normalizing each pixel by the average pixel intensity at that distance interior to the cell surface. Prior to analysis, we also normalized each cell’s surface intensity localization to a mean of one.</p>
    </sec>
    <sec id="S22">
      <title>Calculation of distance from a bleb edge</title>
      <p id="P67">On the adjacency graph of faces, we calculated the distance from each face to the nearest bleb edge measured in number of faces traversed. To convert this distance to micrometers, we multiplied by the average distance between faces for each cell in each frame. Since the distance in micrometers between adjacent faces varies, our calculation of distance is an estimate rather than exact.</p>
    </sec>
    <sec id="S23">
      <title>Calculation of local bleb density</title>
      <p id="P68">To calculate bleb density, we first assigned the value one to each mesh face on a bleb and the value zero to each mesh face not on a bleb (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 11a</xref>). We then diffused these values on the mesh surface using <xref rid="FD3" ref-type="disp-formula">Eq. 4</xref> over 600 iterations (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 11b</xref>). We choose the number of iterations such that the bleb density would be calculated over a short distance on the order of a bleb length. <xref rid="FD3" ref-type="disp-formula">Eq. 4</xref> does not allow an exact measurement of bleb density and may be unstable over distances on the order of many bleb lengths.</p>
    </sec>
    <sec id="S24">
      <title>Spherical statistics</title>
      <p id="P69">The von Mises-Fisher distribution is defined on an <inline-formula><mml:math display="inline" id="M57"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> sphere within <inline-formula><mml:math display="inline" id="M58"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> space.<sup><xref rid="R48" ref-type="bibr">48</xref></sup> For <italic>d</italic> = 2 dimensions it approximates a wrapped normal distribution on a circle, and, similar to the normal distribution, for any <italic>d</italic> is parameterized by a mean and an inverse spread. For <italic>d</italic> = 3 dimensions, the von-Mises Fisher distribution is
<disp-formula id="FD9"><label>(11)</label><mml:math display="block" id="M62"><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:mi>κ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>κ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>κ</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>κ</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>κ</mml:mi><mml:msup><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mi mathvariant="bold">′</mml:mi></mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:math></disp-formula>
where <bold><italic>μ</italic></bold> is the mean direction parameter and <italic>κ</italic> is the concentration parameter, which is inversely related to the data spread. The maximum likelihood estimate of the mean direction is simply
<disp-formula id="FD10"><label>(12)</label><mml:math display="block" id="M65"><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msubsup><mml:mo mathsize="small">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mo mathsize="small">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p id="P70">A Newton’s Method approximation for <italic>κ</italic>, <italic>κ</italic><sub>2</sub>, in three dimensions is
<disp-formula id="FD11"><label>(13, 14)</label><mml:math display="block" id="M67"><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mo mathsize="small">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="1.5em"/><mml:mi>A</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>κ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>κ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>κ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math></disp-formula>
<disp-formula id="FD12"><label>(15)</label><mml:math display="block" id="M68"><mml:mover accent="true"><mml:mrow><mml:mi>κ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mn>3</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math></disp-formula>
<disp-formula id="FD13"><label>(16)</label><mml:math display="block" id="M69"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>κ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>κ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>A</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>κ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>A</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>κ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>κ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mfrac><mml:mi>A</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>κ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math></disp-formula>
<disp-formula id="FD14"><label>(17)</label><mml:math display="block" id="M70"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>κ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>κ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>A</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>κ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>A</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>κ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>κ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mi>A</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>κ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math></disp-formula>
where <italic>N</italic> is the number of data vectors and <italic>I</italic> are Bessel functions of the first kind.<sup><xref rid="R48" ref-type="bibr">48</xref></sup></p>
      <p id="P71">In <xref rid="F6" ref-type="fig">Fig. 6c</xref> and <xref rid="F6" ref-type="fig">j</xref>, we measured the magnitude of PIP<sub>2</sub> and Kras<sup>V12</sup> polarization by mapping the intensity values defined on each surface mesh onto a unit sphere and then using spherical statistics to calculate <italic>κ</italic>. To map the intensities onto the unit sphere, we calculated a set of unit vectors, <bold><italic>x<sub>intensity</sub></italic></bold> that extended in the direction from the cell center to every mesh face. The cell center was defined as the location within the cell farthest from the cell edge,. Since we measured intensity at every mesh face over a radius of 2 μm, to avoid spatially oversampling, we used only every 1000<sup>th</sup> mesh face. We defined <bold><italic>w<sub>intensity</sub></italic></bold> as the measured intensity value associated with each unit vector and then discretized the range of intensity values into 32 bins. Finally, we replaced every vector <bold><italic>x<sub>intensity</sub></italic></bold> with <bold><italic>w</italic></bold> copies of that vector and calculated <italic>κ</italic> from this set of unit vectors. As a control, we also measured <italic>κ</italic> from a set of <bold><italic>x<sub>intensity</sub></italic></bold> with randomized directions.</p>
      <p id="P72">In <xref rid="F6" ref-type="fig">Fig. 6d</xref> and <xref rid="F6" ref-type="fig">k</xref> we computed the directional correlation of morphological motifs, here blebs, with intensity localization. In each frame, we defined the directional correlation as <bold><italic>μ<sub>blebs</sub></italic></bold> · <bold><italic>μ<sub>intensity</sub></italic></bold>. To measure <bold><italic>μ<sub>blebs</sub></italic></bold>, we calculated a set of unit vectors, <bold><italic>x<sub>blebs</sub></italic></bold>, that extended in the direction from the cell center to each mesh face on a bleb. To measure <bold><italic>μ<sub>intensity</sub></italic></bold>, we calculated <bold><italic>x<sub>intensity</sub></italic></bold> and in <xref rid="FD10" ref-type="disp-formula">Eq. 12</xref> we weighted <bold><italic>x</italic></bold><sub><bold><italic>i</italic></bold></sub> by the intensity localization. Since the cell is not a sphere and most cells have polarized shapes, the surface itself is expected to have a nonrandom <bold><italic>μ</italic></bold> and a small <italic>κ</italic>. To account for this, we created a control distribution of directional correlations <bold><italic>μ<sub>blebsRand</sub></italic></bold> · <bold><italic>μ<sub>intensity</sub></italic></bold>, where <bold><italic>μ<sub>blebsRand</sub></italic></bold> was calculated from a set of vectors where the patch classification was randomly permuted. In each frame, we created 200 such permutations by randomly assigning patches to be a bleb or not a bleb.</p>
    </sec>
    <sec id="S25">
      <title>Measurement of boundary motion</title>
      <p id="P73">To measure boundary motion, for each face we found the closest face in the previous frame using a kd-tree. We then defined the boundary motion as
<disp-formula id="FD15"><label>(18)</label><mml:math display="block" id="M91"><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">d</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">d</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mo>,</mml:mo></mml:math></disp-formula>
where <italic>m<sub>i</sub></italic> is the boundary motion at face <italic>i</italic>, <bold><italic>d</italic></bold><sub><bold><italic>i</italic></bold></sub> is the vector from face <italic>i</italic> to the closest point in the previous frame, and <bold><italic>n<sub>i</sub></italic></bold> is the normal to the surface at face <italic>i</italic>.</p>
      <p id="P74">This is not an ideal measure of boundary motion since the mapping vectors <bold><italic>d<sub>i</sub></italic></bold> may cluster on select faces of the previous frame’s surface, or even alter the topology among faces, in a physically unrealistic manner (see Machacek <italic>et al.</italic><sup><xref rid="R49" ref-type="bibr">49</xref></sup> for an illustration of these problems with 2D boundaries). As a control, we also calculated the boundary motion for each face by finding the closest point in the next frame. <xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 14b</xref> shows the protrusive and retractive motion of six cells using both definitions of boundary motion. Here, backwards motion is the mapping of points from each frame to the previous frame and is the definition used elsewhere, and forwards motion is the mapping of points from each frame to the subsequent frame. Even though the backwards and forwards motions of the cells are different, in both cases blebs are more protrusive than non-blebs. This measure is also not a subpixel measure of motion, and should not be used to measure subpixel motions. Because we map each face to the closest face rather than the closest surface point in the previous frame, motions that are less than the average distance between faces will be undersampled in the motion distribution.</p>
    </sec>
    <sec id="S26">
      <title>Statistical hypothesis testing</title>
      <p id="P75">For each Kras and PIP<sub>2</sub> labeled cell, we measured the mean intensity localization of faces on and off blebs and then performed a one-sided t-test on the differences of the means after testing for normality using a Kolmogorov-Smirnov test. The Cohen’s d effect size was measured.</p>
      <p id="P76">Unless otherwise indicated, all errors and error bars show the standard error of the mean.</p>
    </sec>
    <sec id="S27">
      <title>Surface rendering</title>
      <p id="P77">The majority of triangle meshes were rendered in ChimeraX.<sup><xref rid="R39" ref-type="bibr">39</xref></sup> Colored triangle meshes were exported from Matlab as Collada .dae files using custom-written code and were rendered using full lighting mode. Lighting intensity and ambient intensity were adjusted. Colormaps were modified from colorBrewer.<sup><xref rid="R50" ref-type="bibr">50</xref></sup> The surfaces in <xref rid="SD1" ref-type="supplementary-material">Supplementary Figures 11</xref>, and <xref rid="SD1" ref-type="supplementary-material">15</xref> were rendered within Matlab. Our software is capable of rendering all meshes shown in the paper within Matlab, as well as creating Collada files for export to ChimeraX.</p>
    </sec>
    <sec sec-type="data-availability" id="S28">
      <title>Data availability</title>
      <p id="P78">Data are available from the corresponding author upon reasonable request.</p>
    </sec>
    <sec id="S29">
      <title>Code availability</title>
      <p id="P79">The latest version of the software described here, as well as a user’s guide, is available from <ext-link ext-link-type="uri" xlink:href="https://github.com/DanuserLab/Motif3D">https://github.com/DanuserLab/Motif3D</ext-link>.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="SM1">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="SD1">
      <label>1535603_Supp_Fig1-15</label>
      <media xlink:href="NIHMS1535603-supplement-1535603_Supp_Fig1-15.doc" orientation="portrait" id="d37e3018" position="anchor"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD2">
      <label>1535603_Supp_Tab1-6</label>
      <media xlink:href="NIHMS1535603-supplement-1535603_Supp_Tab1-6.pdf" orientation="portrait" id="d37e3022" position="anchor"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD3">
      <label>1535603_vid5</label>
      <media xlink:href="NIHMS1535603-supplement-1535603_vid5.mov" orientation="portrait" id="d37e3026" position="anchor" mimetype="video"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD4">
      <label>1535603_vid2</label>
      <media xlink:href="NIHMS1535603-supplement-1535603_vid2.mov" orientation="portrait" id="d37e3030" position="anchor" mimetype="video"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD5">
      <label>1535603_vid3</label>
      <media xlink:href="NIHMS1535603-supplement-1535603_vid3.mov" orientation="portrait" id="d37e3034" position="anchor" mimetype="video"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD6">
      <label>1535603_vid1</label>
      <media xlink:href="NIHMS1535603-supplement-1535603_vid1.mov" orientation="portrait" id="d37e3038" position="anchor" mimetype="video"/>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SD7">
      <label>1535603_vid4</label>
      <media xlink:href="NIHMS1535603-supplement-1535603_vid4.mov" orientation="portrait" id="d37e3042" position="anchor" mimetype="video"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="S30">
    <title>Acknowledgements</title>
    <p id="P80">This research was funded by grants from the Cancer Prevention Research Institute of Texas (RR160057 to R.F. and R1225 to G.D.) and the National Institutes of Health (F32GM116370 and K99GM123221 to M.K.D., K25CA204526 to E.S.W., F32GM117793 to K.M.D., R33CA235254 to R.F., and R01GM067230 to G.D.). Confocal imaging was performed at the UT Southwestern Live Cell Imaging Facility. Most surface renderings were performed using UCSF ChimeraX, which was developed by the Resource for Biocomputing, Visualization, and Informatics at the University of California, San Francisco (supported by P41GM103311). We thank T. Goddard for assistance with ChimeraX, as well as I. de Vries, J. Renkawitz, and M. Sixt for assistance differentiating dendritic cells. We would also like to thank F. Peri (University of Zurich) and members of her lab, especially M. Albert, for the unpublished images of microglia cells. We also thank P. Friedl (MD Anderson Cancer Center) for the MV3 melanoma cells, Sean Morrison (UT Southwestern) for the primary melanoma cells, Michael Sixt (IST Austria) for the dendritic cell precursors, John Minna and Jerry Shay (UT Southwestern) for the transformed HBEC cells, and Dick McIntosh (University of Colorado, Boulder) for the U2OS osteosarcoma cells.</p>
  </ack>
  <fn-group>
    <fn fn-type="COI-statement" id="FN2">
      <p id="P81">Competing Interests</p>
      <p id="P82">The authors declare no competing interests.</p>
    </fn>
    <fn id="FN3">
      <p id="P83">Editor’s Summary</p>
      <p id="P84">A computational workflow combining image segmentation, computer graphics, and supervised machine learning enables automated and robust 3D analysis of the coupling of cell shape and signaling.</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>References</title>
    <ref id="R1">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Munjal</surname><given-names>A</given-names></name> &amp; <name><surname>Lecuit</surname><given-names>T</given-names></name>
<article-title>Actomyosin networks and tissue morphogenesis</article-title>. <source>Development</source>
<volume>141</volume>, <fpage>1789</fpage>–<lpage>1793</lpage>, (<year>2014</year>).<pub-id pub-id-type="pmid">24757001</pub-id></mixed-citation>
    </ref>
    <ref id="R2">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Rottner</surname><given-names>K</given-names></name>, <name><surname>Faix</surname><given-names>J</given-names></name>, <name><surname>Bogdan</surname><given-names>S</given-names></name>, <name><surname>Linder</surname><given-names>S</given-names></name> &amp; <name><surname>Kerkhoff</surname><given-names>E</given-names></name>
<article-title>Actin assembly mechanisms at a glance</article-title>. <source>J. Cell Sci</source>. <volume>130</volume>, <fpage>3427</fpage>–<lpage>3435</lpage>, (<year>2017</year>).<pub-id pub-id-type="pmid">29032357</pub-id></mixed-citation>
    </ref>
    <ref id="R3">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Simunovic</surname><given-names>M</given-names></name>, <name><surname>Voth</surname><given-names>GA</given-names></name>, <name><surname>Callan-Jones</surname><given-names>A</given-names></name> &amp; <name><surname>Bassereau</surname><given-names>P</given-names></name>
<article-title>When Physics Takes Over: BAR Proteins and Membrane Curvature</article-title>. <source>Trends Cell Biol</source>. <volume>25</volume>, <fpage>780</fpage>–<lpage>792</lpage>, (<year>2015</year>).<pub-id pub-id-type="pmid">26519988</pub-id></mixed-citation>
    </ref>
    <ref id="R4">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Rangamani</surname><given-names>P</given-names></name><etal/><article-title>Decoding information in cell shape</article-title>. <source>Cell</source><volume>154</volume>, <fpage>1356</fpage>–<lpage>1369</lpage>, (<year>2013</year>).<pub-id pub-id-type="pmid">24034255</pub-id></mixed-citation>
    </ref>
    <ref id="R5">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Schmick</surname><given-names>M</given-names></name> &amp; <name><surname>Bastiaens</surname><given-names>PI</given-names></name>
<article-title>The interdependence of membrane shape and cellular signal processing</article-title>. <source>Cell</source>
<volume>156</volume>, <fpage>1132</fpage>–<lpage>1138</lpage>, (<year>2014</year>).<pub-id pub-id-type="pmid">24630717</pub-id></mixed-citation>
    </ref>
    <ref id="R6">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Planchon</surname><given-names>TA</given-names></name><etal/><article-title>Rapid three-dimensional isotropic imaging of living cells using Bessel beam plane illumination</article-title>. <source>Nat. Methods</source><volume>8</volume>, <fpage>417</fpage>–<lpage>U468</lpage>, (<year>2011</year>).<pub-id pub-id-type="pmid">21378978</pub-id></mixed-citation>
    </ref>
    <ref id="R7">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Wu</surname><given-names>Y</given-names></name><etal/><article-title>Spatially isotropic four-dimensional imaging with dual-view plane illumination microscopy</article-title>. <source>Nat. Biotechnol</source>. <volume>31</volume>, <fpage>1032</fpage>–<lpage>1038</lpage>, (<year>2013</year>).<pub-id pub-id-type="pmid">24108093</pub-id></mixed-citation>
    </ref>
    <ref id="R8">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>BC</given-names></name><etal/><article-title>Lattice light-sheet microscopy: imaging molecules to embryos at high spatiotemporal resolution</article-title>. <source>Science</source><volume>346</volume>, <fpage>1257998</fpage>, (<year>2014</year>).<pub-id pub-id-type="pmid">25342811</pub-id></mixed-citation>
    </ref>
    <ref id="R9">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Dean</surname><given-names>KM</given-names></name>, <name><surname>Roudot</surname><given-names>P</given-names></name>, <name><surname>Welf</surname><given-names>ES</given-names></name>, <name><surname>Danuser</surname><given-names>G</given-names></name> &amp; <name><surname>Fiolka</surname><given-names>R</given-names></name>
<article-title>Deconvolution-free Subcellular Imaging with Axially Swept Light Sheet Microscopy</article-title>. <source>Biophys. J</source>. <volume>108</volume>, <fpage>2807</fpage>–<lpage>2815</lpage>, (<year>2015</year>).<pub-id pub-id-type="pmid">26083920</pub-id></mixed-citation>
    </ref>
    <ref id="R10">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Welf</surname><given-names>ES</given-names></name><etal/><article-title>Quantitative Multiscale Cell Imaging in Controlled 3D Microenvironments</article-title>. <source>Dev. Cell</source><volume>36</volume>, <fpage>462</fpage>–<lpage>475</lpage>, (<year>2016</year>).<pub-id pub-id-type="pmid">26906741</pub-id></mixed-citation>
    </ref>
    <ref id="R11">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Fu</surname><given-names>Q</given-names></name>, <name><surname>Martin</surname><given-names>BL</given-names></name>, <name><surname>Matus</surname><given-names>DQ</given-names></name> &amp; <name><surname>Gao</surname><given-names>L</given-names></name>
<article-title>Imaging multicellular specimens with real-time optimized tiling light-sheet selective plane illumination microscopy</article-title>. <source>Nat. Commun</source>. <volume>7</volume>, <fpage>11088</fpage>, (<year>2016</year>).<pub-id pub-id-type="pmid">27004937</pub-id></mixed-citation>
    </ref>
    <ref id="R12">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Schink</surname><given-names>KO</given-names></name>, <name><surname>Tan</surname><given-names>KW</given-names></name> &amp; <name><surname>Stenmark</surname><given-names>H</given-names></name>
<article-title>Phosphoinositides in Control of Membrane Dynamics</article-title>. <source>Annu. Rev. Cell Dev. Biol</source>. <volume>32</volume>, <fpage>143</fpage>–<lpage>171</lpage>, (<year>2016</year>).<pub-id pub-id-type="pmid">27576122</pub-id></mixed-citation>
    </ref>
    <ref id="R13">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Simanshu</surname><given-names>DK</given-names></name>, <name><surname>Nissley</surname><given-names>DV</given-names></name> &amp; <name><surname>McCormick</surname><given-names>F</given-names></name>
<article-title>RAS Proteins and Their Regulators in Human Disease</article-title>. <source>Cell</source>
<volume>170</volume>, <fpage>17</fpage>–<lpage>33</lpage>, (<year>2017</year>).<pub-id pub-id-type="pmid">28666118</pub-id></mixed-citation>
    </ref>
    <ref id="R14">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Driscoll</surname><given-names>MK</given-names></name> &amp; <name><surname>Danuser</surname><given-names>G</given-names></name>
<article-title>Quantifying Modes of 3D Cell Migration</article-title>. <source>Trends Cell Biol</source>. <volume>25</volume>, <fpage>749</fpage>–<lpage>759</lpage>, (<year>2015</year>).<pub-id pub-id-type="pmid">26603943</pub-id></mixed-citation>
    </ref>
    <ref id="R15">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Braunstein</surname><given-names>ML</given-names></name>, <name><surname>Hoffman</surname><given-names>DD</given-names></name> &amp; <name><surname>Saidpour</surname><given-names>A</given-names></name>
<article-title>Parts of Visual Objects - an Experimental Test of the Minima Rule</article-title>. <source>Perception</source>
<volume>18</volume>, <fpage>817</fpage>–<lpage>826</lpage>, (<year>1989</year>).<pub-id pub-id-type="pmid">2628932</pub-id></mixed-citation>
    </ref>
    <ref id="R16">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Chazelle</surname><given-names>B</given-names></name>, <name><surname>Dobkin</surname><given-names>DP</given-names></name>, <name><surname>Shouraboura</surname><given-names>N</given-names></name> &amp; <name><surname>Tal</surname><given-names>A</given-names></name>
<article-title>Strategies for polyhedral surface decomposition: An experimental study</article-title>. <source>Comp. Geom.-Theor. and App</source>. <volume>7</volume>, <fpage>327</fpage>–<lpage>342</lpage>, (<year>1997</year>).</mixed-citation>
    </ref>
    <ref id="R17">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Theisel</surname><given-names>H</given-names></name>, <name><surname>Rossi</surname><given-names>C</given-names></name>, <name><surname>Zayer</surname><given-names>R</given-names></name> &amp; <name><surname>Seidel</surname><given-names>HP</given-names></name>
<article-title>Normal based estimation of the curvature tensor for triangular meshes</article-title>. <source>Pac. Conf. Comput. Graph. Appl</source>., <fpage>288</fpage>–<lpage>297</lpage>, (<year>2004</year>).</mixed-citation>
    </ref>
    <ref id="R18">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Mangan</surname><given-names>AP</given-names></name> &amp; <name><surname>Whitaker</surname><given-names>RT</given-names></name>
<article-title>Partitioning 3D Surface Meshes Using Watershed Segmentation</article-title>. <source>IEEE Trans. Vis. Comp. Graph</source>. <volume>5</volume>, <fpage>308</fpage>–<lpage>321</lpage>, (<year>1999</year>).</mixed-citation>
    </ref>
    <ref id="R19">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Kaick</surname><given-names>OV</given-names></name>, <name><surname>Fish</surname><given-names>N</given-names></name>, <name><surname>Kleiman</surname><given-names>Y</given-names></name>, <name><surname>Asafi</surname><given-names>S</given-names></name> &amp; <name><surname>Cohen-Or</surname><given-names>D</given-names></name>
<article-title>Shape segmentation by approximate convexity analysis</article-title>. <source>ACM Trans. Graph</source>. <volume>34</volume>, (<year>2014</year>).</mixed-citation>
    </ref>
    <ref id="R20">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Singh</surname><given-names>M</given-names></name>, <name><surname>Seyranian</surname><given-names>GD</given-names></name> &amp; <name><surname>Hoffman</surname><given-names>DD</given-names></name>
<article-title>Parsing silhouettes: The short-cut rule</article-title>. <source>Percept. Psychophys</source>. <volume>61</volume>, <fpage>636</fpage>–<lpage>660</lpage>, (<year>1999</year>).<pub-id pub-id-type="pmid">10370334</pub-id></mixed-citation>
    </ref>
    <ref id="R21">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Dice</surname><given-names>LR</given-names></name><article-title>Measures of the Amount of Ecologic Association Between Species</article-title>. <source>Ecology</source><volume>26</volume>, <fpage>297</fpage>–<lpage>302</lpage>, (<year>1945</year>).</mixed-citation>
    </ref>
    <ref id="R22">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>TL</given-names></name><etal/><article-title>Observing the cell in its native state: Imaging subcellular dynamics in multicellular organisms</article-title>. <source>Science</source><volume>360</volume>, (<year>2018</year>).</mixed-citation>
    </ref>
    <ref id="R23">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Elliott</surname><given-names>H</given-names></name><etal/><article-title>Myosin II controls cellular branching morphogenesis and migration in three dimensions by minimizing cell-surface curvature</article-title>. <source>Nat. Cell Biol</source>. <volume>17</volume>, <fpage>137</fpage>–<lpage>147</lpage>, (<year>2015</year>).<pub-id pub-id-type="pmid">25621949</pub-id></mixed-citation>
    </ref>
    <ref id="R24">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Zatulovskiy</surname><given-names>E</given-names></name>, <name><surname>Tyson</surname><given-names>R</given-names></name>, <name><surname>Bretschneider</surname><given-names>T</given-names></name> &amp; <name><surname>Kay</surname><given-names>RR</given-names></name>
<article-title>Bleb-driven chemotaxis of Dictyostelium cells</article-title>. <source>J. Cell Biol</source>. <volume>204</volume>, <fpage>1027</fpage>–<lpage>1044</lpage>, (<year>2014</year>).<pub-id pub-id-type="pmid">24616222</pub-id></mixed-citation>
    </ref>
    <ref id="R25">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Cleveland</surname><given-names>WS</given-names></name> &amp; <name><surname>Mcgill</surname><given-names>R</given-names></name>
<article-title>Graphical perception and graphical methods for analyzing scientific data</article-title>. <source>Science</source>
<volume>229</volume>, <fpage>828</fpage>–<lpage>833</lpage>, (<year>1985</year>).<pub-id pub-id-type="pmid">17777913</pub-id></mixed-citation>
    </ref>
  </ref-list>
  <ref-list>
    <title>Online Methods References</title>
    <ref id="R26">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Sato</surname><given-names>M</given-names></name><etal/><article-title>Human lung epithelial cells progressed to malignancy through specific oncogenic manipulations</article-title>. <source>Mol. Cancer Res</source>. <volume>11</volume>, <fpage>638</fpage>–<lpage>650</lpage>, (<year>2013</year>).<pub-id pub-id-type="pmid">23449933</pub-id></mixed-citation>
    </ref>
    <ref id="R27">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Redecke</surname><given-names>V</given-names></name><etal/><article-title>Hematopoietic progenitor cell lines with myeloid and lymphoid potential</article-title>. <source>Nat. Methods</source><volume>10</volume>, <fpage>795</fpage>–<lpage>803</lpage>, (<year>2013</year>).<pub-id pub-id-type="pmid">23749299</pub-id></mixed-citation>
    </ref>
    <ref id="R28">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Riedl</surname><given-names>J</given-names></name><etal/><article-title>Lifeact: A Versatile Marker to Visualize F-actin</article-title>. <source>Nat. Methods</source><volume>5</volume>, <fpage>605</fpage>–<lpage>607</lpage>, (<year>2008</year>).<pub-id pub-id-type="pmid">18536722</pub-id></mixed-citation>
    </ref>
    <ref id="R29">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Leithner</surname><given-names>A</given-names></name><etal/><article-title>Diversified actin protrusions promote environmental exploration but are dispensable for locomotion of leukocytes</article-title>. <source>Nat. Cell Biol</source>. <volume>18</volume>, <fpage>1253</fpage>–<lpage>1259</lpage>, (<year>2016</year>).<pub-id pub-id-type="pmid">27775702</pub-id></mixed-citation>
    </ref>
    <ref id="R30">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Johnson</surname><given-names>HW</given-names></name> &amp; <name><surname>Schell</surname><given-names>MJ</given-names></name>
<article-title>Neuronal IP3 3-kinase is an F-actin-bundling protein: role in dendritic targeting and regulation of spine morphology</article-title>. <source>Mol. Biol. Cell</source>. <volume>20</volume>, <fpage>5166</fpage>–<lpage>5180</lpage>, (<year>2009</year>).<pub-id pub-id-type="pmid">19846664</pub-id></mixed-citation>
    </ref>
    <ref id="R31">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Yi</surname><given-names>J</given-names></name>, <name><surname>Wu</surname><given-names>XS</given-names></name>, <name><surname>Crites</surname><given-names>T</given-names></name> &amp; <name><surname>Hammer</surname><given-names>JA</given-names><suffix>3rd</suffix></name>. <article-title>Actin retrograde flow and actomyosin II arc contraction drive receptor cluster dynamics at the immunological synapse in Jurkat T cells</article-title>. <source>Mol. Biol. Cell</source>
<volume>23</volume>, <fpage>834</fpage>–<lpage>852</lpage>, (<year>2012</year>).<pub-id pub-id-type="pmid">22219382</pub-id></mixed-citation>
    </ref>
    <ref id="R32">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Chu</surname><given-names>J</given-names></name><etal/><article-title>A bright cyan-excitable orange fluorescent protein facilitates dual-emission microscopy and enhances bioluminescence imaging in vivo</article-title>. <source>Nat. Biotechnol</source>. <volume>34</volume>, <fpage>760</fpage>–<lpage>767</lpage>, (<year>2016</year>).<pub-id pub-id-type="pmid">27240196</pub-id></mixed-citation>
    </ref>
    <ref id="R33">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Stauffer</surname><given-names>TP</given-names></name>, <name><surname>Ahn</surname><given-names>S</given-names></name> &amp; <name><surname>Meyer</surname><given-names>T</given-names></name>
<article-title>Receptor-induced transient reduction in plasma membrane PtdIns(4,5)P2 concentration monitored in living cells</article-title>. <source>Curr. Biol</source>. <volume>8</volume>, <fpage>343</fpage>–<lpage>346</lpage>, (<year>1998</year>).<pub-id pub-id-type="pmid">9512420</pub-id></mixed-citation>
    </ref>
    <ref id="R34">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Otsu</surname><given-names>N</given-names></name><article-title>A threshold selection method from gray-level histograms</article-title>. <source>IEEE Trans. Syst. Man, Cybern</source>. <volume>9</volume>, <fpage>62</fpage>–<lpage>66</lpage>, (<year>1979</year>).</mixed-citation>
    </ref>
    <ref id="R35">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Desbrun</surname><given-names>M</given-names></name>, <name><surname>Meyer</surname><given-names>M</given-names></name>, <name><surname>Schroder</surname><given-names>P</given-names></name> &amp; <name><surname>Barr</surname><given-names>AH</given-names></name>
<article-title>Implicit fairing of irregular meshes using diffusion and curvature flow</article-title>. <source>Comp. Grap. Inter. Tech</source>, <fpage>317</fpage>–<lpage>324</lpage>, (<year>1999</year>).</mixed-citation>
    </ref>
    <ref id="R36">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Aguet</surname><given-names>F</given-names></name>, <name><surname>Jacob</surname><given-names>M</given-names></name> &amp; <name><surname>Unser</surname><given-names>M</given-names></name>
<article-title>Three-dimensional feature detection using optimal steerable filters.</article-title>
<source>IEEE Image. Proc</source>. <volume>2</volume>, <fpage>1158</fpage>–<lpage>1161</lpage>, (<year>2005</year>).</mixed-citation>
    </ref>
    <ref id="R37">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Jacob</surname><given-names>M</given-names></name> &amp; <name><surname>Unser</surname><given-names>M</given-names></name>
<article-title>Design of steerable filters for feature detection using Canny-like criteria</article-title>. <source>IEEE T. Pattern Anal</source>. <volume>26</volume>, <fpage>1007</fpage>–<lpage>1019</lpage>, (<year>2004</year>).</mixed-citation>
    </ref>
    <ref id="R38">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Schneider</surname><given-names>CA</given-names></name>, <name><surname>Rasband</surname><given-names>WS</given-names></name> &amp; <name><surname>Eliceiri</surname><given-names>KW</given-names></name>
<article-title>NIH Image to ImageJ: 25 years of image analysis</article-title>. <source>Nat. Methods</source>
<volume>9</volume>, <fpage>671</fpage>–<lpage>675</lpage>, (<year>2012</year>).<pub-id pub-id-type="pmid">22930834</pub-id></mixed-citation>
    </ref>
    <ref id="R39">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Goddard</surname><given-names>TD</given-names></name><etal/><article-title>UCSF ChimeraX: Meeting modern challenges in visualization and analysis</article-title>. <source>Protein Sci</source>. <volume>27</volume>, <fpage>14</fpage>–<lpage>25</lpage>, (<year>2018</year>).<pub-id pub-id-type="pmid">28710774</pub-id></mixed-citation>
    </ref>
    <ref id="R40">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Kondor</surname><given-names>RI</given-names></name> &amp; <name><surname>Lafferty</surname><given-names>JD</given-names></name>
<article-title>Diffusion Kernels on Graphs and Other Discrete Input Spaces</article-title>. <source>Proc. Inter. Conf. Mach. Learn</source>, <fpage>315</fpage>–<lpage>322</lpage>, (<year>2002</year>).</mixed-citation>
    </ref>
    <ref id="R41">
      <label>41</label>
      <mixed-citation publication-type="book"><name><surname>Kondor</surname><given-names>R</given-names></name> &amp; <name><surname>Vert</surname><given-names>JP</given-names></name>
<source>Diffusion kernels in Kernel methods in computational biology</source> (eds <name><surname>Schölkopf</surname><given-names>B</given-names></name>, <name><surname>Tsuda</surname><given-names>K</given-names></name>, &amp; <name><surname>Vert</surname><given-names>JP</given-names></name>) <fpage>171</fpage>–<lpage>192</lpage> (<publisher-name>MIT Press</publisher-name>, <year>2004</year>).</mixed-citation>
    </ref>
    <ref id="R42">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Asafi</surname><given-names>S</given-names></name>, <name><surname>Goren</surname><given-names>A</given-names></name> &amp; <name><surname>Cohen-Or</surname><given-names>D</given-names></name>
<article-title>Weak Convex Decomposition by Lines-of-sight</article-title>. <source>Symp. Geom</source>. <volume>32</volume>, <fpage>23</fpage>–<lpage>31</lpage>, (<year>2013</year>).</mixed-citation>
    </ref>
    <ref id="R43">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Möller</surname><given-names>T</given-names></name> &amp; <name><surname>Trumbore</surname><given-names>B</given-names></name>
<article-title>Fast, minimum storage ray-triangle intersection</article-title>. <source>J. Graph. Tools</source>
<volume>2</volume>, <fpage>21</fpage>–<lpage>28</lpage>, (<year>1997</year>).</mixed-citation>
    </ref>
    <ref id="R44">
      <label>44</label>
      <mixed-citation publication-type="book"><name><surname>Christianini</surname><given-names>N</given-names></name> &amp; <name><surname>Shawe-Taylor</surname><given-names>J</given-names></name>
<source>An introduction to support vector machines and other kernel-based learning methods</source>. (<publisher-name>Cambridge university press</publisher-name>, <year>2000</year>).</mixed-citation>
    </ref>
    <ref id="R45">
      <label>45</label>
      <mixed-citation publication-type="journal"><name><surname>Breiman</surname><given-names>L</given-names></name><article-title>Random forests</article-title>. <source>Machine Learning</source><volume>45</volume>, <fpage>5</fpage>–<lpage>32</lpage>, (<year>2001</year>).</mixed-citation>
    </ref>
    <ref id="R46">
      <label>46</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>C</given-names></name> &amp; <name><surname>Chen</surname><given-names>T</given-names></name>
<article-title>Efficient Feature Extraction for 2D/3D Objects in Mesh Representation</article-title>. <source>IEEE Conf. Image Proc</source>, <fpage>935</fpage>–<lpage>938</lpage>, (<year>2001</year>).</mixed-citation>
    </ref>
    <ref id="R47">
      <label>47</label>
      <mixed-citation publication-type="journal"><name><surname>Shapira</surname><given-names>L</given-names></name>, <name><surname>Shamir</surname><given-names>A</given-names></name> &amp; <name><surname>Cohen-Or</surname><given-names>D</given-names></name>
<article-title>Consistent mesh partitioning and skeletonisation using the shape diameter function</article-title>. <source>Visual Comput</source>
<volume>24</volume>, <fpage>249</fpage>–<lpage>259</lpage>, (<year>2008</year>).</mixed-citation>
    </ref>
    <ref id="R48">
      <label>48</label>
      <mixed-citation publication-type="journal"><name><surname>Suvrit</surname><given-names>S</given-names></name><article-title>A short note on parameter approximation for von Mises-Fisher distributions: and a fast implementation of I s (x)</article-title>. <source>Comput. Stat</source>. <volume>27</volume>, <fpage>177</fpage>–<lpage>190</lpage>, (<year>2012</year>).</mixed-citation>
    </ref>
    <ref id="R49">
      <label>49</label>
      <mixed-citation publication-type="journal"><name><surname>Machacek</surname><given-names>M</given-names></name> &amp; <name><surname>Danuser</surname><given-names>G</given-names></name>
<article-title>Morphodynamic profiling of protrusion phenotypes</article-title>. <source>Biophysical journal</source>
<volume>90</volume>, <fpage>1439</fpage>–<lpage>1452</lpage>, (<year>2006</year>).<pub-id pub-id-type="pmid">16326902</pub-id></mixed-citation>
    </ref>
    <ref id="R50">
      <label>50</label>
      <mixed-citation publication-type="journal"><name><surname>Harrower</surname><given-names>M</given-names></name> &amp; <name><surname>Brewer</surname><given-names>CA</given-names></name>
<article-title><ext-link ext-link-type="uri" xlink:href="http://ColorBrewer.org">ColorBrewer.org</ext-link>: an online tool for selecting colour schemes for maps</article-title>. <source>Cartogr. J</source>. <volume>40</volume>, <fpage>27</fpage>–<lpage>37</lpage>, (<year>2003</year>).</mixed-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="F1" orientation="portrait" position="float">
    <label>Figure 1.</label>
    <caption>
      <title>Cell morphology and signaling are coupled.</title>
      <p id="P85">Surface renderings of (a) a dendritic cell expressing Lifeact-GFP, (b) an MV3 melanoma cell expressing tractin-GFP, and (c) a human bronchial epithelial cell (HBEC) expressing tractin-GFP. (d-f) Maximum intensity projections (MIPs) of the cells shown in a-c, using an inverse look up table. Panels a-f are shown at the same scale. Additional views of these cells are shown in <xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 1</xref>. (g) A MIP of a branched MV3 cells expressing PLCΔ-PH-GFP, a PIP<sub>2</sub> translocation biosensor. (h) A surface rendering of the same cell. Surface regions with relatively high PIP<sub>2</sub> localization are shown in red, whereas regions of relatively low localization are shown in blue. (i) A MIP and (j) a surface rendering of a blebbing MV3 cell expressing PLCΔ-PH-GFP. The PLCΔ-PH-GFP images are representative of 23 cells from 3 experiments. (k) A MIP of an MV3 cell expressing GFP-Kras<sup>V12</sup>. (l) A surface rendering of k. Surface regions of relatively high Kras localization are shown in red, whereas regions of relatively low localization are shown in blue. The GFP-Kras<sup>V12</sup> images are representative of 31 cells from 7 experiments. Scale bars, 10 μm.</p>
    </caption>
    <graphic xlink:href="nihms-1535603-f0001"/>
  </fig>
  <fig id="F2" orientation="portrait" position="float">
    <label>Figure 2.</label>
    <caption>
      <title>Morphological motif detection framework and example workflow.</title>
      <p id="P86">To detect morphological motifs, (<bold>a</bold>) following image acquisition, (<bold>b</bold>) we extract the cell surface, (<bold>c</bold>) decompose that surface into convex patches, (<bold>d</bold>) optionally merge those patches, (<bold>e</bold>) and then finally classify the patches by morphological motif. Panels <bold>f</bold>-<bold>p</bold> show our detection framework applied to a blebbed cell. (<bold>f</bold>) MIP of a 3D image of an MV3 melanoma cell expressing tractin-GFP. (<bold>g</bold>) MIP of the deconvolved image of the same cell. (<bold>h</bold>) The surface of the cell extracted from the deconvolved image as a triangle mesh. (<bold>i</bold>) The mean surface curvature of the cell. Regions of large positive curvature are shown red, flat regions are shown white, and regions of large negative curvature are shown blue. (<bold>j</bold>) A watershed segmentation of mean surface curvature. Segmented patches are shown in different colors. (<bold>k</bold>) A spill-depth based merging of the segmented patches. (<bold>l</bold>) A triangle-rule based merging of the patches. (<bold>m</bold>) A line-of-sight (LOS) based merging of the patches. The triangle and LOS rules are applied iteratively. (<bold>n</bold>) User generated training data for two different cells. Patches identified as “certainly a bleb” are shown green, whereas patches identified as “certainly not a bleb” are shown purple. (<bold>o</bold>) A support vector machine (SVM) classifier trained on user data applied to the cell. Patches shown in green have high SVM scores and a high inferred likelihood of being a bleb, whereas patches shown in purple have low SVM scores and a low inferred likelihood. (<bold>p</bold>) Detected blebs are shown randomly colored and non-blebs are shown gray. To detect non-convex motifs, such as lamellipodia, convex patches are merged as shown in <bold>q</bold>-<bold>u</bold>. (<bold>q</bold>) The mean surface curvature of a lamellipodial dendritic cell expressing Lifeact-GFP. (<bold>r</bold>) Convex surface patches for the same cell. (<bold>s</bold>) A local-LOS based merging of these patches. (<bold>t</bold>) An SVM based merging of the patches. The SVM was trained on user-supplied examples of adjacent patches that should certainly be merged and adjacent patches that should certainly not be merged. (<bold>u</bold>) Detected lamellipodia are shown randomly colored and non-lamellipodia are shown gray.</p>
    </caption>
    <graphic xlink:href="nihms-1535603-f0002"/>
  </fig>
  <fig id="F3" orientation="portrait" position="float">
    <label>Figure 3.</label>
    <caption>
      <title>Detected blebs, filopodia, and lamellipodia.</title>
      <p id="P87">(a) Blebs detected on an MV3 melanoma cell (representative of 19 cells), (b) filopodia detected on an HBEC cell (representative of 13 cells), and (c) lamellipodia detected on a dendritic cell (representative of 13 cells). Additional example detections are shown in <xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 5</xref>.</p>
    </caption>
    <graphic xlink:href="nihms-1535603-f0003"/>
  </fig>
  <fig id="F4" orientation="portrait" position="float">
    <label>Figure 4.</label>
    <caption>
      <title>Validation and robustness of morphological motif detection.</title>
      <p id="P88">(a) A multiclass detector applied to cells derived from a human melanoma xenograft cultured in mice (representative of 9 cells). Filopodia are shown blue, blebs are shown red, and areas with neither filopodia nor blebs are shown gray. (b) Validation measures for a bleb detector (left) trained on 19 MV3 melanoma cells, a filopodia detector (center) trained on 13 HBEC cells, and a lamellipodia detector (right) trained on 13 dendritic cells. TP, TN, FP, and FN are abbreviations for true positive, true negative, false positive, and false negative respectively. (c) The F<sub>1</sub> score as a function of the number of cells trained on. The red line indicates the mean F<sub>1</sub> score averaged over a maximum of 100 sets of cells, whereas the gray dots show individual sets of cells. (d) A bleb detector trained on the MV3 melanoma cell line applied to cells derived from a human melanoma xenograft cultured in mice (representative of 24 cells). (e) A filopodia detector trained on xenograft-derived melanoma cells applied to HBEC cells (representative of 13 cells). A filopodia detector trained on HBECs applied to the cell on the left is shown in <xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 5</xref> and applied to the cell on the right is shown in <xref rid="F3" ref-type="fig">Fig. 3</xref>. (f) Blebs detected on wildtype, cofilin-1 knock out, and Wave2 knockout U2OS cells in 3D collagen. (g) For these three cell types, the percentage of the surface that is blebby. We analyzed 19 wildtype, 15 cofilin-1 knockout, and 14 Wave2 knockout cells.</p>
    </caption>
    <graphic xlink:href="nihms-1535603-f0004"/>
  </fig>
  <fig id="F5" orientation="portrait" position="float">
    <label>Figure 5.</label>
    <caption>
      <title>Motif detection on images acquired via diverse microscopic techniques.</title>
      <p id="P89">(a) A MIP, taken over the xz direction, of an MV3 cell expressing tractin-GFP imaged via laser scanning confocal microscopy (representative of 8 cells). (b) Blebs detected on the same cell using a model derived from 8 MV3 cells imaged with this microscope. (c) An xz-MIP of a microglia inside a zebrafish embryo imaged using a commercial light-sheet microscope (representative of 8 cells). (d) Extensions detected on the same cell using a model derived from 8 microglia imaged with this microscope. (e) An xz-MIP of an MV3 cell expressing cytosolic GFP imaged using ASLM, a high-resolution light-sheet microscopy modality (representative of 8 cells). (f) Blebs detected on the same cell using a model derived from 19 MV3 cells imaged via meSPIM. (g) An xz-MIP of a T cell expressing Lifeact-mEmerald imaged using lattice light-sheet microscopy.<sup><xref rid="R8" ref-type="bibr">8</xref></sup> (h) Lamellipodia detected on the same cell using a model derived from 13 dendritic cells imaged via meSPIM. (i) Extensions detected on an MDA-MB-231 human breast cancer cell moving through the vasculature of a zebrafish embryo imaged via adaptive-optics lattice light-sheet microscopy.<sup><xref rid="R22" ref-type="bibr">22</xref></sup> The cell is shown as a surface rendering, whereas the vasculature is shown in gray as a MIP of the deconvolved image. Scale bars, 10 μm.</p>
    </caption>
    <graphic xlink:href="nihms-1535603-f0005"/>
  </fig>
  <fig id="F6" orientation="portrait" position="float">
    <label>Figure 6.</label>
    <caption>
      <title>Kras and PIP<sub>2</sub> associate with blebs differently.</title>
      <p id="P90">(a) An MV3 cell expressing GFP-Kras<sup>V12</sup> shown as a MIP (left) and an xy-slice (right) (representative of 31 cells). (b) Kras localization, measured over 2 μm, near the surface of an MV3 cell expressing GFP-Kras<sup>V12</sup>. (c) For 13 cells, the cumulative polarization distribution of Kras intensity (solid line) compared to random (dashed line). (d) The directional correlation of blebs with Kras localization. The cumulative correlation distribution is shown solid, the control distribution is shown dashed, and the zero correlation distribution is shown dotted. The correlation and control populations are not statistically different (p-value: 0.3, ks-statistic: 0.3). (e) The differences between the mean Kras intensity on and off blebs (p-value: 0.5, effect size: −0.006, t-statistic: −0.017). The error bar indicates the standard error of the mean. (f) Fluorescence localization vs. distance from a bleb edge for 13 GFP-Kras<sup>V12</sup> labeled cells and 35 GFP cytosolically labeled cells. (g) Distributions of Kras intensity for mesh faces on blebs of greater than average volume and on blebs of less than average volume (p-value: 0.6, effect size: 0.05, ks-statistic: 0.05, num. blebs: 1425). (h) An MV3 cell expressing PLCΔ-PH-GFP shown as a MIP (left) and an xy-slice (right) (representative of 23 cells). (i) PIP<sub>2</sub> localization, measured over 2 μm, near the surface of an MV3 cells expressing PLCΔ-PH-GFP. (j) For 6 movies of distinct cells, the cumulative polarization distribution of PIP<sub>2</sub> intensity (solid line) compared to random (dashed line). (k) The directional correlation of blebs with PIP<sub>2</sub> localization. The correlation and control populations are statistically different (p-value: 42*10^−29, ks-statistic: 0.6). (l) The differences between the mean PIP<sub>2</sub> intensity on and off blebs for 6 movies of cells (p-value: 0.0005, effect size: 1.7, t-statistic: 6.9). The error bar indicates the standard error of the mean. (m) PIP<sub>2</sub> and Kras localization, both on and off blebs, vs. distance from a bleb edge. (n) Distributions of PIP<sub>2</sub> intensity for mesh faces on blebs of greater than average volume and on blebs of less than average volume (p-value: 2*10^−77, effect size: 0.5, ks-statistic: 0.24, num. blebs: 10625). (o) Surface renderings of PIP<sub>2</sub> localization, measured over 2 μm, near the surface of an MV3 cell expressing PLCΔ-PH-GFP. Cells were imaged every 37 sec. (p) Surface renderings of the boundary motion of this same cell. Purple indicates regions of high protrusive motion, whereas green indicates regions of high retractive motion. (q) For 6 cells, the frequency of protrusive motion minus the frequency of retractive motion on and off blebs as a function of surface speed. (r) The same measure shown in f for mesh faces in the top and bottom deciles of PIP<sub>2</sub> localization. Scale bars, 10 μm.</p>
    </caption>
    <graphic xlink:href="nihms-1535603-f0006"/>
  </fig>
</floats-group>
