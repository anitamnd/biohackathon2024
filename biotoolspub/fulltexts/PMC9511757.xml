<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9511757</article-id>
    <article-id pub-id-type="publisher-id">4952</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-022-04952-z</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>AMPDeep: hemolytic activity prediction of antimicrobial peptides using transfer learning</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <name>
          <surname>Salem</surname>
          <given-names>Milad</given-names>
        </name>
        <address>
          <email>miladsalem@knights.ucf.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Keshavarzi Arshadi</surname>
          <given-names>Arash</given-names>
        </name>
        <address>
          <email>arashka@knights.ucf.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yuan</surname>
          <given-names>Jiann Shiun</given-names>
        </name>
        <address>
          <email>Jiann-Shiun.Yuan@ucf.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.170430.1</institution-id><institution-id institution-id-type="ISNI">0000 0001 2159 2859</institution-id><institution>Electrical and Computer Engineering Department, </institution><institution>University of Central Florida, </institution></institution-wrap>Orlando, FL USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.170430.1</institution-id><institution-id institution-id-type="ISNI">0000 0001 2159 2859</institution-id><institution>Burnett School of Biomedical Sciences, </institution><institution>University of Central Florida, </institution></institution-wrap>Orlando, FL USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>26</day>
      <month>9</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>26</day>
      <month>9</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>23</volume>
    <elocation-id>389</elocation-id>
    <history>
      <date date-type="received">
        <day>2</day>
        <month>5</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>9</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Deep learning’s automatic feature extraction has proven to give superior performance in many sequence classification tasks. However, deep learning models generally require a massive amount of data to train, which in the case of Hemolytic Activity Prediction of Antimicrobial Peptides creates a challenge due to the small amount of available data.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">Three different datasets for hemolysis activity prediction of therapeutic and antimicrobial peptides are gathered and the AMPDeep pipeline is implemented for each. The result demonstrate that AMPDeep outperforms the previous works on all three datasets, including works that use physicochemical features to represent the peptides or those who solely rely on the sequence and use deep learning to learn representation for the peptides. Moreover, a combined dataset is introduced for hemolytic activity prediction to address the problem of sequence similarity in this domain. AMPDeep fine-tunes a large transformer based model on a small amount of peptides and successfully leverages the patterns learned from other protein and peptide databases to assist hemolysis activity prediction modeling.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">In this work transfer learning is leveraged to overcome the challenge of small data and a deep learning based model is successfully adopted for hemolysis activity classification of antimicrobial peptides. This model is first initialized as a protein language model which is pre-trained on masked amino acid prediction on many unlabeled protein sequences in a self-supervised manner. Having done so, the model is fine-tuned on an aggregated dataset of labeled peptides in a supervised manner to predict secretion. Through transfer learning, hyper-parameter optimization and selective fine-tuning, AMPDeep is able to achieve state-of-the-art performance on three hemolysis datasets using only the sequence of the peptides. This work assists the adoption of large sequence-based models for peptide classification and modeling tasks in a practical manner.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Antimicrobial peptide</kwd>
      <kwd>Deep learning</kwd>
      <kwd>Drug discovery</kwd>
      <kwd>Hemolysis</kwd>
      <kwd>Transformers</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par4">Historically, natural products have been of the most important candidate drug sources in the pharmaceutical industry. Due to millions of years of evolution and constant updates, they have been optimized in defending the host microorganism against pathogens. One source of natural products is the innate immune system of animals, plants, and fungi [<xref ref-type="bibr" rid="CR1">1</xref>], where peptides have been discovered to have antimicrobial and antibacterial properties. These natural products have inspired the discovery and design of Antimicrobial peptides (AMPs), a group of short peptides known for their potency against viruses, bacteria, fungi, and transformed cancer cells. High specificity and selectivity, low toxicity, and high diversity are their privileges over other classes of drugs in spite of their short lifetime and low bio-availability [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>]. These peptides largely work as immunomodulators, apoptosis stimulators, and proliferation inhibitors [<xref ref-type="bibr" rid="CR1">1</xref>]. Disrupting the structure of cells or mitochondria membrane and inhibiting DNA or Protein synthesis and their interactions are mechanisms that have been observed for the effectiveness of AMPs [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>]. There are several examples of these peptides including Magainin, Pleurocidin, Buforins as membrane disturbers and BR2, NGR, Tat-KLA, K6L9, and HNP as intracellular effectors [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>]. One advantage of AMPs is their potency among different types of cancers based on their membrane features [<xref ref-type="bibr" rid="CR3">3</xref>].</p>
    <p id="Par5">However, one main challenge that hinders the adoption of AMPs as therapeutics is that AMPs are prone to be hemolytic. Hemolysis happens when the peptide ruptures red blood cells, ending the life-time of these cells prematurely. This is an unintended side-effect and due to its severity, a hemolytic peptide cannot be an applicable drug candidate. As an estimate, it is predicted that 70% of all known AMPs have a high or moderate hemolytic activity [<xref ref-type="bibr" rid="CR4">4</xref>]. Therefore, investigation of hemolysis and prediction of hemolytic activity in therapeutic peptides is necessary for the development of AMPs as hit candidates.</p>
    <p id="Par6">Fortunately in recent years, multiple efforts have been made to collect databases of AMPs, as well as to classify their hemolytic activity through computational methods. The dominant approach for classification of AMPs includes extracting physicochemical features from the peptide, effectively turning peptides into a feature vector, and classifying them with a machine learning model [<xref ref-type="bibr" rid="CR5">5</xref>]. The features used and discovered in these classification systems include composition, physicochemical properties and structural characteristics of amino acids, length of the peptide, net charge, hydrophobic percentage, tertiary structure, atom composition, diatom composition, chemical descriptors, fingerprints, and binary profiles [<xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR8">8</xref>]. The methodology of extracting features from the input and then classifying the feature vectors is akin to the traditional Machine Learning approach in many domains such as Electrocardiogram arrhythmia detection [<xref ref-type="bibr" rid="CR9">9</xref>], image classification [<xref ref-type="bibr" rid="CR10">10</xref>], and even antimicrobial peptide identification [<xref ref-type="bibr" rid="CR11">11</xref>]. In all of these domains, deep learning has shown supremacy in its modeling power via learning features during training from the raw data. This combination of feature extraction and modeling is enabled via deep learning’s automatic feature extraction capability, where useful features are learned for the current training dataset. Deep Learning modeling can identify unknown features in data and discover abstract and hidden patterns within the input data that are important for the classification task at hand.</p>
    <p id="Par7">To this end, there are two works in the literature which aim to tackle the problem of hemolysis activity prediction using deep learning-based models, both of which fail to outperform their feature-based counterparts. First a Recurrent Neural Network (RNN) model has been used to learn from raw peptide sequences alone [<xref ref-type="bibr" rid="CR12">12</xref>] as part of a peptide generation pipeline, and then tasked to filter the generated peptides that are predicted to be hemolytic. Moreover, ELMO [<xref ref-type="bibr" rid="CR13">13</xref>], which is a deep learning-based bidirectional language model, has been used in another related work [<xref ref-type="bibr" rid="CR14">14</xref>] to predict cytotoxicity and hemolysis activity of peptides given a sequence. However, both of these sequence-based and deep learning-based methods were not able to outperform the traditional feature-based approaches in certain benchmarks [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR14">14</xref>]. The main reason contributing to this shortcoming in performance is the small amount of available training data [<xref ref-type="bibr" rid="CR14">14</xref>], which is intuitive due to the data-hungry nature of the deep learning-based models and the high cost of automatic feature extraction.</p>
    <p id="Par8">Given the main challenge of small data, in this work we propose the use of transfer learning to alleviate this problem. Transfer learning allows the model to be trained at a source task, then transferred to a target task in the form of initialization which holds the patterns learned from the source task. With this technique, the cost of automatic feature extraction is partially paid in the source domains and the challenge of low data within the target domain is reduced. To this end, AMPDeep thoroughly investigates the effects of initializing a transformer-based model from a pre-trained protein language model, i.e. Prot-BERT-BFD [<xref ref-type="bibr" rid="CR15">15</xref>], which has been trained on masked amino acid prediction in a self-supervised manner. Having done so, AMPDeep also studies “secretion” as another source for transferring knowledge from, since secretion is a common and biologically important feature of antimicrobial peptides and hemolytic peptides, and a large number of secretory peptides are available as training data. Therefore, transfer learning is leveraged to fine-tune the model on secretory peptide classification, to make the training of the model on the hemolytic prediction tasks more stable. The training pipeline is tested using three different datasets taken as is from external works, as well as a combined datasets compiled from combining the three datasets and cleaning redundant sequences. Due to the large size of the model, selective fine-tuning is introduced, which lowers the number of parameters available for training. The main contributions of this work are as follows:</p>
    <p id="Par9"> Use of a large transformer-based model to learn from peptides in a sequence-wise manner.<list list-type="bullet"><list-item><p id="Par10">Use of a pre-trained language model trained on 2 billion protein fragments as initialization.</p></list-item><list-item><p id="Par11">Use of transfer learning to transfer learned knowledge from secretion classification task to hemolytic activity classification.</p></list-item><list-item><p id="Par12">Introduction of a novel algorithm, i.e. selective fine-tuning, where in 8 scenarios certain parameters of the model are kept frozen during fine-tuning, to facilitate training of a large model on a small amount of data.</p></list-item><list-item><p id="Par13">Addressing the problem of redundant sequences in related works via compiling a new hemolytic activity-based dataset.</p></list-item><list-item><p id="Par14">Outperforming the state-of-the-art deep learning and feature-based models in hemolytic activity classification</p></list-item></list></p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>AMPDeep pipeline overview</title>
      <p id="Par15">AMPDeep offers a practical pipeline for hemolytic activity classification of AMPs through transfer learning. To do so, the data is first gathered and cleaned for hemolytic activity classification as well as secretory peptide classification. Next, a massive pre-trained model (Prot-BERT-BFD) [<xref ref-type="bibr" rid="CR15">15</xref>] is used as initialization for the training. Having done so, hyper-parameter optimization and freezing is performed, which makes the model ready for classification stages. During classification, first, the model is trained on predicting whether a peptide is secretory or not. Then this fine-tuned model is transferred and used as initialization for training whether a given peptide is hemolytic or not. After the model is trained, three external datasets are used to evaluate the performance of the model and enable comparison to related works. This training process is implemented for three hemolysis datasets and a combined dataset. The overview of this work is shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>.<fig id="Fig1"><label>Fig. 1</label><caption><p>Overview of AMPDeep’s Classification System. Data is gathered for two tasks, i.e. hemolysis and secretion. A pre-trained protein language model is first fine-tuned on secretion detection, then fine-tuned to predict hemolysis activity of a given peptide. The model is evaluated on independent test sets</p></caption><graphic xlink:href="12859_2022_4952_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Data summary</title>
      <p id="Par16">The five datasets used in this work are shown in Table <xref rid="Tab1" ref-type="table">1</xref>. The first three datasets are datasets taken as is from related works focusing on hemolysis activity prediction with a wide range of modeling approaches applied to them, from feature-based approaches to deep learning-based approaches. This selection of diverse datasets allows AMPDeep’s performance to be compared to both the traditional methods of classification as well as the new sequence-based methods. This work also compiles a dataset from combining all three external datasets and properly splitting the train and test splits, to address the problem of similar sequences and bias in these datasets. The last dataset was gathered in this work using SwissProt [<xref ref-type="bibr" rid="CR16">16</xref>], from peptides that have secretory keyword, as well as those within the cytoplasm that do not have this keyword for non-secretory peptides.</p>
      <p id="Par17">The amount of available training data for hemolytic activity prediction ranges from 800 data points to 2000 data points. While the amount of available training data for secretion prediction is nearly 30,000 data points. The relatively large amount of data that is available for secretory peptides is one of the reasons secretion prediction is chosen as the task to transfer from during transfer learning.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Summary of all datasets used for training AMPDeep</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Dataset</th><th align="left">Origin</th><th align="left">Train positive</th><th align="left">Train negative</th><th align="left">Test positive</th><th align="left">Test negative</th></tr></thead><tbody><tr><td align="left">HLPpred-Fuse</td><td align="left">Taken as is from [<xref ref-type="bibr" rid="CR5">5</xref>]</td><td align="left">433</td><td align="left">423</td><td align="left">663</td><td align="left">1999</td></tr><tr><td align="left">XGBC-Hem</td><td align="left">Taken as is from [<xref ref-type="bibr" rid="CR4">4</xref>]</td><td align="left">442</td><td align="left">442</td><td align="left">110</td><td align="left">110</td></tr><tr><td align="left">RNN-Hem</td><td align="left">Taken as is from [<xref ref-type="bibr" rid="CR12">12</xref>]</td><td align="left">1030</td><td align="left">908</td><td align="left">329</td><td align="left">290</td></tr><tr><td align="left">Combined</td><td align="left">Compiled from [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]</td><td align="left">901</td><td align="left">901</td><td align="left">50</td><td align="left">50</td></tr><tr><td align="left">Secretion</td><td align="left">Aggregated from [<xref ref-type="bibr" rid="CR16">16</xref>]</td><td align="left">13950</td><td align="left">14038</td><td align="left">186</td><td align="left">183</td></tr></tbody></table></table-wrap></p>
      <sec id="Sec5">
        <title>Keyword analysis results</title>
        <p id="Par18">Analyzing the keywords acquired from UniProt’s reviewed peptides allows us to view the most prevalent properties of antimicrobial peptides as well as hemolytic peptides. To do so, all peptides within the SwissProt database that have are antimicrobial or hemolytic are acquired, creating two smaller datasets of antimicrobial peptides and hemolytic peptides respectively. The keywords associated with the peptides for each dataset are then counted, to find the most prevalent properties of these peptides. The code for extracting the keywords as well as analyzing them are included in the “keyword_analysis” script within the GitHub repository. The results are shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. Further information regarding keywords of interest can be found in Additional File <xref rid="MOESM1" ref-type="media">1</xref>.<fig id="Fig2"><label>Fig. 2</label><caption><p>Top 10 keywords associated with: antimicrobial peptides (<bold>a</bold>), and hemolytic peptides (<bold>b</bold>) within the SwissProt Database</p></caption><graphic xlink:href="12859_2022_4952_Fig2_HTML" id="MO2"/></fig></p>
        <p id="Par19">As it can be seen from Fig. <xref rid="Fig2" ref-type="fig">2</xref>, the most prevalent keyword associated with AMPs is “Secreted”. This co-occurrence also happens for hemolytic peptides, where a majority of the peptides are also secretory. This closeness in relationship was the main motivation for choosing secretory classification as a source task for transfer learning, justifying training on secretion detection data and then transferring the learned knowledge to the hemolysis activity prediction task.</p>
      </sec>
      <sec id="Sec6">
        <title>The problem of sequence similarity</title>
        <p id="Par20">Analyzing the three acquired external datasets from [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR12">12</xref>] reveals that many similar sequences exist between their respective training sets and independent test sets. Existence of similar sequences in both train and test splits results in overestimating the performance of the model and creating impractical benchmarks. If a protein sequence has 40% or more similarity with another protein sequence with known function, then there is a high probability, that both proteins perform the same function [<xref ref-type="bibr" rid="CR17">17</xref>]. The main source of this problem is the random splitting performed in these datasets to allocate sequences for the training and test splits. The degree of this redundancy in each dataset is shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref> calculated via CD-HIT.<fig id="Fig3"><label>Fig. 3</label><caption><p>The composition of each dataset regarding representative and redundant sequences as calculated via CD-HIT with a threshold of 0.4</p></caption><graphic xlink:href="12859_2022_4952_Fig3_HTML" id="MO3"/></fig></p>
        <p id="Par21">As it can be seen from Fig. <xref rid="Fig3" ref-type="fig">3</xref>, all three external datasets suffer from a high degree of redundancy, which in turn with random splitting results in biased benchmarks for hemolytic activity prediction. To address this problem, this works compiles a dataset from combining all datasets, then using CD-HIT to remove the redundant sequences and removing any similar sequences that overlap between the test and train splits.</p>
      </sec>
    </sec>
    <sec id="Sec7">
      <title>Secretion prediction results</title>
      <p id="Par22">To start the training pipeline, transfer learning from a source model is needed. In this work, secretion detection is used as the source model. The model is first initialized on Prot-BERT-BFD [<xref ref-type="bibr" rid="CR15">15</xref>], a protein language model trained on nearly 2 billion protein fragments, tasked with predicting amino acids that have been masked within the protein sequences. This model is then fine-tuned on secretory data using selective fine-tuning. As part of the hyper-parameter optimization, the pooling layer of the model is changed from the default BERT pooling to simple “Mean” pooling or “First Token” pooling. The results for these models are shown in Table <xref rid="Tab2" ref-type="table">2</xref>.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Results of training on the secretory dataset using different pooling mechanisms, validated on the secretory test set</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Pooler</th><th align="left">Hidden layer size</th><th align="left">Accuracy</th><th align="left">Recall</th><th align="left">Precision</th><th align="left">ROC-AUC</th><th align="left">MCC</th></tr></thead><tbody><tr><td align="left">BERT Pooler</td><td align="left">None</td><td align="left">0.9431</td><td align="left">0.9624</td><td align="left">0.9275</td><td align="left">0.9795</td><td align="left">0.8868</td></tr><tr><td align="left">Mean Pooling</td><td align="left">32</td><td align="left">0.9458</td><td align="left">0.9731</td><td align="left">0.9235</td><td align="left">0.9827</td><td align="left">0.8929</td></tr><tr><td align="left">First Token Pooling</td><td align="left">128</td><td align="left">0.9566</td><td align="left">0.957</td><td align="left">0.957</td><td align="left">0.9779</td><td align="left">0.9133</td></tr></tbody></table></table-wrap></p>
      <p id="Par23">As it can be seen from Table <xref rid="Tab2" ref-type="table">2</xref>, the secretion prediction model is robust in regard to different hyper-parameters, with all pooling mechanisms resulting in similar performance. Having trained different secretory models, multiple transfer models are now available to be used as initializations for the next task of hemolytic activity prediction.</p>
    </sec>
    <sec id="Sec8">
      <title>Hemolysis prediction and transfer learning results</title>
      <p id="Par24">Different secretory models and architectures are used as initialization for training hemolysis prediction models using selective fine-tuning. Three datasets have been chosen to enable comparison of the results to previous works. For each dataset, the model is initialized on the secretion prediction model, then trained on 90% of the training dataset. Early stopping with patience of 10 is performed where the Mathews Correlation Coefficient (MCC) of the model on the remaining 10% of the training set is monitored, and the epoch with the highest MCC on this validation set is chosen as the best training epoch. The results are shown in Table <xref rid="Tab3" ref-type="table">3</xref> for XGBC-Hem dataset, in Table <xref rid="Tab4" ref-type="table">4</xref> for HLPpred-Fuse dataset, and in Table <xref rid="Tab5" ref-type="table">5</xref> for RNN-Hem dataset. All external results (non AMPDeep) in these comparisons are taken as reported in their respective works [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR19">19</xref>]. Following related works MCC is used as the main metric of evaluation.<table-wrap id="Tab3"><label>Table 3</label><caption><p>Hemolytic activity classification results for the model trained on XGBC-Hem [<xref ref-type="bibr" rid="CR4">4</xref>] dataset’s train set and validated on its test set</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Model</th><th align="left">Accuracy</th><th align="left">Recall</th><th align="left">Precision</th><th align="left">ROC-AUC</th><th align="left">MCC</th></tr></thead><tbody><tr><td align="left">GBC [<xref ref-type="bibr" rid="CR4">4</xref>]</td><td align="left">0.904</td><td align="left">–</td><td align="left">0.865</td><td align="left">0.905</td><td align="left">0.809</td></tr><tr><td align="left">LDA [<xref ref-type="bibr" rid="CR4">4</xref>]</td><td align="left">0.905</td><td align="left">–</td><td align="left">0.871</td><td align="left">0.905</td><td align="left">0.809</td></tr><tr><td align="left">XGBC + Feature Selection [<xref ref-type="bibr" rid="CR4">4</xref>]</td><td align="left">0.923</td><td align="left">–</td><td align="left">0.885</td><td align="left">0.923</td><td align="left">0.846</td></tr><tr><td align="left">AMPDeep</td><td align="left">0.9863</td><td align="left">0.9727</td><td align="left">1</td><td align="left">0.9995</td><td align="left"><bold>0.9731</bold></td></tr></tbody></table><table-wrap-foot><p>Bold values are for the best performing model</p><p>First three rows are reported as it was published in [<xref ref-type="bibr" rid="CR4">4</xref>]</p></table-wrap-foot></table-wrap><table-wrap id="Tab4"><label>Table 4</label><caption><p>Hemolytic activity classification results for the model trained on HLPpred-Fuse [<xref ref-type="bibr" rid="CR5">5</xref>] dataset’s train set and validated on its test set. First three rows are reported as it was published in [<xref ref-type="bibr" rid="CR5">5</xref>]</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Model</th><th align="left">Accuracy</th><th align="left">Recall</th><th align="left">Precision</th><th align="left">ROC-AUC</th><th align="left">MCC</th></tr></thead><tbody><tr><td align="left">HLPpred-Fuse [<xref ref-type="bibr" rid="CR5">5</xref>]</td><td align="left">–</td><td align="left">0.845</td><td align="left">–</td><td align="left">0.967</td><td align="left">0.823</td></tr><tr><td align="left">HemoPI [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR19">19</xref>]</td><td align="left">–</td><td align="left">0.804</td><td align="left">–</td><td align="left">0.952</td><td align="left">0.754</td></tr><tr><td align="left">HemoPred [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR18">18</xref>]</td><td align="left">–</td><td align="left">0.652</td><td align="left">–</td><td align="left">–</td><td align="left">0.34</td></tr><tr><td align="left">AMPDeep</td><td align="left">0.9369</td><td align="left">0.8824</td><td align="left">0.8667</td><td align="left">0.9716</td><td align="left"><bold>0.8324</bold></td></tr></tbody></table><table-wrap-foot><p>Bold values are for the best performing model</p></table-wrap-foot></table-wrap><table-wrap id="Tab5"><label>Table 5</label><caption><p>Hemolytic activity classification results for the model trained on RNN-Hem [<xref ref-type="bibr" rid="CR12">12</xref>] dataset’s train set and validated on its test set</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Model</th><th align="left">Accuracy</th><th align="left">Recall</th><th align="left">Precision</th><th align="left">ROC-AUC</th><th align="left">MCC</th></tr></thead><tbody><tr><td align="left">SVM-Hem [<xref ref-type="bibr" rid="CR12">12</xref>]</td><td align="left">0.73</td><td align="left">0.58</td><td align="left">0.72</td><td align="left">0.69</td><td align="left">0.44</td></tr><tr><td align="left">RF-Hem [<xref ref-type="bibr" rid="CR12">12</xref>]</td><td align="left">0.77</td><td align="left">0.6</td><td align="left">0.81</td><td align="left">0.8</td><td align="left">0.53</td></tr><tr><td align="left">RNN-Hem [<xref ref-type="bibr" rid="CR12">12</xref>]</td><td align="left">0.76</td><td align="left">0.76</td><td align="left">0.7</td><td align="left">0.87</td><td align="left">0.52</td></tr><tr><td align="left">AMPDeep</td><td align="left">0.7997</td><td align="left">0.8328</td><td align="left">0.7988</td><td align="left">0.8723</td><td align="left"><bold>0.5972</bold></td></tr></tbody></table><table-wrap-foot><p>Bold values are for the best performing model</p><p>First three rows are reported as it was published in [<xref ref-type="bibr" rid="CR12">12</xref>]</p></table-wrap-foot></table-wrap></p>
      <p id="Par25">As can be seen from Tables <xref rid="Tab3" ref-type="table">3</xref> and <xref rid="Tab4" ref-type="table">4</xref>, using a large pre-trained transformer and training it on secretory and hemolytic sequences is superior to the state-of-the-art [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>], which extract physicochemical features from the input and classify it using traditional machine learning models. Table <xref rid="Tab5" ref-type="table">5</xref> further shows that AMPDeep can outperform a deep learning and sequence-based model, demonstrating the capabilities of this pipeline in learning from raw sequences. The hyper-parameters for all final models can be found in Additional File <xref rid="MOESM1" ref-type="media">1</xref>.<table-wrap id="Tab6"><label>Table 6</label><caption><p>Hemolytic activity classification results for the model trained on the combined dataset and validated on its independent test set</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Model</th><th align="left">Accuracy</th><th align="left">Recall</th><th align="left">Precision</th><th align="left">ROC-AUC</th><th align="left">MCC</th></tr></thead><tbody><tr><td align="left">AMPDeep</td><td align="left">0.86</td><td align="left">0.8</td><td align="left">0.9091</td><td align="left">0.8964</td><td align="left"><bold>0.7252</bold></td></tr></tbody></table><table-wrap-foot><p>Bold values are for the best performing model</p></table-wrap-foot></table-wrap></p>
      <p id="Par26">Table <xref rid="Tab6" ref-type="table">6</xref> also report the performance of the model on the combined dataset. Unfortunately, this performance cannot be compared to related works, since this dataset was created from the combination of the external datasets and the test sequences overlap with external training sequences. However, the results on this dataset are reported, since to the best of authors’ knowledge this is the only hemolytic activity dataset where similar sequences between the train and test splits are removed.</p>
    </sec>
    <sec id="Sec9">
      <title>Selective fine-tuning results</title>
      <p id="Par27">Due to the small size of the training datasets (3K data points) compared to the large size of the model (400M parameters), restricting the number of parameters that are trainable can be beneficial to increase the stability of the training. To this end, this work introduces selective fine-tuning, where 8 different scenarios for freezing different parts of the model are considered for each experiment. The scenarios are shown in Table <xref rid="Tab7" ref-type="table">7</xref>.<table-wrap id="Tab7"><label>Table 7</label><caption><p>Eight scenarios for selective fine-tuning</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Scenario</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left">1</td><td align="left">Full fine-tuning</td></tr><tr><td align="left">2</td><td align="left">Feature extraction</td></tr><tr><td align="left">3</td><td align="left">Pooler fine-tuning</td></tr><tr><td align="left">4</td><td align="left">Pooler replacement</td></tr><tr><td align="left">5</td><td align="left">Input embedding fine-tuning</td></tr><tr><td align="left">6</td><td align="left">Positional embedding fine-tuning</td></tr><tr><td align="left">7</td><td align="left">Input embedding + layer norm fine-tuning</td></tr><tr><td align="left">8</td><td align="left">Positional embedding + layer norm fine-tuning</td></tr></tbody></table></table-wrap></p>
      <p id="Par28">Each of the scenarios defined in Table <xref rid="Tab7" ref-type="table">7</xref> was implemented for each of the four hemolytic datasets with hyper-parameter search for each model. The results for each dataset as well as an average of all results are demonstrated in Fig. <xref rid="Fig4" ref-type="fig">4</xref>.<fig id="Fig4"><label>Fig. 4</label><caption><p>Model performance on 4 hemolytic datasets for 8 different scenarios of selective fine-tuning, and average performance on all 4. Scenario 8 has the highest performance on average for selective fine-tuning</p></caption><graphic xlink:href="12859_2022_4952_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par29">As it can be seen from <xref rid="Fig4" ref-type="fig">4</xref>, scenario 8 is the highest performing scenario on average. Therefore, the selective fine-tuning process determined that the best set of parameters to leave as unfrozen are the positional embedding parameters, the layer norm parameters, the pooler, and the classifier, while freezing the rest of the parameters i.e. the self-attention and the feed forward layers within the attention heads, and the non-positional embedding. These results are in line with findings from [<xref ref-type="bibr" rid="CR20">20</xref>], where layer norm are left unfrozen during fine-tuning for natural language processing tasks. However, we found that freezing the non-positional embedding and swapping the pooling layer with mean pooling helps the final performance of the model. An overview of the frozen parameters are shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>.<fig id="Fig5"><label>Fig. 5</label><caption><p>Overview of frozen (red and striped) and unfrozen (green and solid) parameters from selective fine-tuning for the final models</p></caption><graphic xlink:href="12859_2022_4952_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
    <sec id="Sec10">
      <title>Ablation study–effect of transfer learning and selective fine-tuning</title>
      <p id="Par30">AMPDeep consists of multiple steps that assist in fine-tuning a large pre-trained model on a small number of peptide sequences. These steps include initialization on a pre-trained protein language model, modifying the pooling layer, selective fine-tuning, and transfer learning from secretion prediction. To assess the impact of each step on the final performance of the model, an ablation study is performed. During this study, the model initialization is compared between BERT [<xref ref-type="bibr" rid="CR21">21</xref>] (a smaller transformer-based model pre-trained for masked token prediction on English text) and Prot-BERT-BFD [<xref ref-type="bibr" rid="CR15">15</xref>]. Moreover, the pooling layer is compared between mean pooling and the default non-linear pooling that BERT offers. Furthermore, the fine-tuning procedure is compared between traditional fine-tuning and selective fine-tuning as proposed in this work. Finally, the effect of transfer learning from secretion prediction is studied. All models are trained on the XGBC-Hem benchmark with no hidden layer added before the classification layer. The results are shown in Table <xref rid="Tab8" ref-type="table">8</xref>.<table-wrap id="Tab8"><label>Table 8</label><caption><p>Ablation results for different steps of the AMPDeep pipeline on the XGBC-Hem dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Approach</th><th align="left">MCC</th></tr></thead><tbody><tr><td align="left">Baseline</td><td align="left">0.846</td></tr><tr><td align="left">BERT Init. (Natural Language) + Classification Layer Fine-Tuning</td><td align="left">0.6639</td></tr><tr><td align="left">BERT Init. (Natural Language) + Mean Pooling + Classification Layer Fine-Tuning</td><td align="left">0.8091</td></tr><tr><td align="left">Prot-BERT Init. + Mean Pooling + Classification Layer Fine-Tuning</td><td align="left">0.8472</td></tr><tr><td align="left">Prot-BERT Init. + Mean Pooling + Selective Fine-Tuning</td><td align="left">0.9367</td></tr><tr><td align="left">Prot-BERT + Mean Pool. + Secretion Transfer Learning + Selective Fine-Tun. (AMPDeep)</td><td align="left">0.9731</td></tr></tbody></table></table-wrap></p>
      <p id="Par31">As seen in Table <xref rid="Tab8" ref-type="table">8</xref> changing the pooling layer to be a simple mean pooling greatly increases the performance of the model. Moreover, changing the initialization to be from a pre-trained protein language model results in a performance similar to the baseline and adding selective fine-tuning, results in a large boost in this performance. Lastly, transfer learning from secretion prediction results in another large jump in MCC and the model achieving its final performance.</p>
    </sec>
  </sec>
  <sec id="Sec11">
    <title>Discussion</title>
    <p id="Par32">The main findings of AMPDeep are three-fold. Firstly, the techniques offered by AMPDeep for fine-tuning a protein language model on a small number of peptides are practical and result in superior empirical performance. These techniques include initialization from masked amino acid prediction, mean pooling, and selective-fine tuning. Secondly, bias was detected in three of the main datasets for hemolytic activity prediction and to that end, a new dataset was generated with proper data splitting regarding sequence similarity. Lastly, AMPDeep finds that transfer learning from secretion prediction of peptides is helpful to the task of hemolysis prediction. The similarities between the two data distributions of secretory peptides and hemolytic antimicrobial peptides, as seen in the keyword analysis section, might be one of the main reasons that transfer learning is effective. Overall, AMPDeep allows the knowledge learned from 2 billion protein fragments from Prot-BERT-BFD and learned from 30 thousand secretory peptides to be included in the training on hemolytic peptides. This knowledge is transferred in the form of initializations and arguably the patterns learned from masked amino acid prediction or secretory peptide prediction, are useful during training on hemolytic peptides and increase the stability of training, resulting in better performance. In the context of existing research, AMPDeep is the first deep learning-based model to out-perform the previous feature-based methods and this performance is owed mostly to the techniques applied during training and the transfer of pre-trained knowledge.</p>
    <p id="Par33">One of the possible limitations of this work is the use of keywords to find a secondary distribution to fine-tune the model on, i.e. secretory peptides. While this is intuitive, intuition does not necessitate positive transfer learning and the problem of negative transfer learning may occur if this method is applied to another task, e.g. peptide function prediction. This problem is still an active area of research and improvements can be done to move away from intuition and use empirical approaches to select initialization for transfer learning [<xref ref-type="bibr" rid="CR22">22</xref>]. The second possible limitation of this study is its plethora of steps in order to fine-tune a large model. The number of sequential steps taken in AMPDeep to fine-tune the Prot-BERT-BFD model may be discouraging to others who wish to follow this work. We have included the scripts that were used for training within the Github repository and added simple control panels for them to facilitate the adoption of AMPDeep.</p>
  </sec>
  <sec id="Sec12">
    <title>Conclusions</title>
    <p id="Par34">In this work a hemolytic activity classification pipeline was implemented which leverages transfer learning from protein language modeling as well as secretory peptide prediction. Due to the prevalent secretory properties of AMPs, the model was first trained on secretory peptides then fine-tuned to predict hemolysis activity. The results show improved performance compared to the state-of-the-art on three different datasets ranging from feature-based models to deep learning-based models. Moreover, it is shown that unsupervised language modeling coupled with transfer learning and selective fine-tuning enable a large transformer model to be trained on a small amount of data and improve the performance on hemolysis prediction. Therefore, AMPDeep enables the adoption of large pre-trained protein language models for peptide classification, specifically hemolysis activity prediction, unlocking the use of many unlabeled data for supervised classification of a small number of peptide sequences. The methodology delineated in this work can enable fine-tuning large transformer models on small amount of amino acid-based sequence, which can impact other proteomic domains and facilitate adoption of large protein language models for these domains.</p>
  </sec>
  <sec id="Sec13">
    <title>Methods</title>
    <sec id="Sec14">
      <title>Data aggregation</title>
      <p id="Par35">In this work, three external hemolysis datasets are taken as is from the related literature to enable hemolysis prediction as well as comparison to the related works. These datasets are chosen from a variety of literature that include therapeutic peptides and antimicrobial peptides, and literature that use feature-based and deep learning-based methods for classification of hemolytic activity. This diversity in selection of datasets has been enforced to generate a fair comparison of AMPDeep’s performance to all types of existing approaches. Aside from the hemolysis data, one dataset is gathered for peptide secretion classification. This relatively larger dataset is used for training a source model for transfer learning. Overall, the categories of the datasets used in this work are as follows:<list list-type="bullet"><list-item><p id="Par36"><italic>XGBC-Hem</italic> dataset from [<xref ref-type="bibr" rid="CR4">4</xref>], which in this work is referred to as XGBC-Hem, uses hemolysis prediction as part of a peptide generation pipeline. This work uses physicochemical properties to extract features from the data. Moreover, XGBC-Hem performs feature selection to improve the performance of the model. This dataset uses HemoPI-1 [<xref ref-type="bibr" rid="CR19">19</xref>] which is created from experimentally validated peptides taken from the Hemolytik database [<xref ref-type="bibr" rid="CR23">23</xref>], Swiss Prot (non-hemolytic peptides) [<xref ref-type="bibr" rid="CR16">16</xref>], and Database of Antimicrobial Activity and Structure peptides (DBAASP v.2)[<xref ref-type="bibr" rid="CR24">24</xref>]. The dataset was randomly divided into 80 and 20 percent for training and validation splits respectively.</p></list-item><list-item><p id="Par37"><italic>HLPpred-Fuse</italic> HLPpred-Fuse [<xref ref-type="bibr" rid="CR5">5</xref>] is the current state-of-the-art model in hemolytic activity prediction and extracts biological features from the sequence and uses traditional machine learning models to classify the feature vectors. Similar to XGBC-Hem, this dataset uses HemoPI-1 as the training dataset. However, for evaluating the algorithm HLPpred-Fuse uses independent positive samples collected from the Hemolytik database and independent negative samples collected from PEPred-SUITE (randomly generated sequences) [<xref ref-type="bibr" rid="CR25">25</xref>].</p></list-item><list-item><p id="Par38"><italic>RNN-Hem</italic> the dataset from [<xref ref-type="bibr" rid="CR12">12</xref>], referred to in this work as RNN-Hem, is selected as the third dataset, since this work uses a sequence-based deep learning model to predict the hemolytic activity of peptides. This dataset uses the DBAASP database for annotations in regard to the activity of the peptide and their hemolytic properties. The data was further augmented with negative sequences collected from Swiss Prot, randomly generated sequences, and sequences created via shuffling the order of amino acids in positive sequences. For evaluation, RNN-Hem randomly splits the data into 75 and 25 percent splits for training and validation respectively.</p></list-item><list-item><p id="Par39"><italic>Combined</italic> the three datasets gathered for hemolytic activity prediction are combined to create a diverse dataset as well as to control the degree of sequence similarity between the training split and the test split, alleviating the problem of bias that exists in the external datasets.</p></list-item><list-item><p id="Par40"><italic>Secretory data</italic> the secretory peptides were gathered from UniProt’s reviewed proteins [<xref ref-type="bibr" rid="CR16">16</xref>] with lengths of 200 and shorter, using the “Secreted” keyword. To acquire non-secretory peptides, the reviewed peptides were first narrowed based on their location to be in Cytoplasm, then secretory peptides were removed. The remaining peptides were randomly sampled to be nearly as many as secretory peptides. This data is split into 80%, 10%, and 10% splits for training, validation, and test sets. The test set is further refined using CD-HIT to remove all similar sequences to the training set and to create a fair test set for the secretory task. This problem of similarity is further studied in the following subsection.</p></list-item></list></p>
      <sec id="Sec15">
        <title>Data preprocessing and sequence similarity detection</title>
        <p id="Par41">After each peptide sequence is acquired, the duplicate sequences are removed. Moreover, all of the peptides sequences that exist in both the hemolysis datasets and the secretory dataset, are removed from the secretory dataset to avoid leakage of hemolysis task into the transfer task. The peptide sequences are then edited to have one space between each amino acid, since this is the input scheme required by the model in later stages. The pre-processing used for all hemolytic benchmarks and the secretory data are included in the “preprocessing_hemolysis” and “preprocessing_secretion” scripts within the GitHub repository, respectively.</p>
        <p id="Par42">A high degree of similarity exists between the sequences in the training set and the test set of the hemolytic datasets. To assess this redundancy, first CD-HIT is used to find the representative sequences of each dataset and the redundant sequences. To alleviate this problem, in this work a combined dataset is compiled which does not share similar sequences between the train and the test splits. First, all hemolytic datasets are combined, and CD-HIT is used to remove all redundant sequences. Afterwards, from the remaining non-redundant sequences a test set is formed via taking 50 positive samples and 50 negative samples ( 10% of the data). The training set is then constructed from all sequences that are now similar to the sequences in the test set. The training set is then balanced via randomly removing negative data points. The process of removing similar data points is performed on the test set of the secretory data as well. Throughout this work CD-HIT was used with a threshold of 0.4 and number of words of 2.</p>
      </sec>
    </sec>
    <sec id="Sec16">
      <title>Model initialization</title>
      <sec id="Sec17">
        <title>Language modeling and pre-training</title>
        <p id="Par43">The Prot-BERT-BFD [<xref ref-type="bibr" rid="CR15">15</xref>] model is a transformer-based model with more than 400 million parameters, trained on 2 billion protein fragments. This model is inspired by BERT’s architecture [<xref ref-type="bibr" rid="CR21">21</xref>], a popular transformer-based model in the natural language processing domain which uses the attention mechanism to create inner representations from an input sequence. BERT works through masked language modeling, which involves masking the a percentage of words in each sequence and predicting what the masked words should be. This pre-training strategy only requires sequences and does not require labels, and hence is self-supervised. Prot-BERT-BFD follows the same training strategy as BERT, however it does so on 2 Billion protein sequences and predicts masked amino acids. This unsupervised pre-training gives the model useful knowledge regarding protein sequences, which can in turn be useful for peptide classification. In this work, this large model with knowledge gained through pre-training on many protein sequences is adopted as initialization for the later stages. Prot-BERT-BFD was chosen as the initialization for two main reasons, firstly the size of the pre-training data, which is the largest available for all public models of such nature. Secondly, this model is easily available in the HuggingFace [<xref ref-type="bibr" rid="CR26">26</xref>] repository and can be fine-tuned with ease. Aside from HuggingFace, the training scripts in this work utilize Python, Scikit-Learn, and PyTorch.</p>
        <p id="Par44">Prot-BERT-BFD is pre-trained as a language model, therefore masked language modeling heads are located at the last layer of the model. These heads are not suitable for outputting binary classification labels that are needed for hemolysis activity prediction, therefore the last layer of this model is removed and replaced with a fully connected neural network to act as the classifier.</p>
      </sec>
      <sec id="Sec18">
        <title>Transfer learning from secretion prediction</title>
        <p id="Par45">Transfer learning has become a staple technique in deep learning model development, where one model is trained on a source dataset, then transferred to the target domain and fine-tuned on the target dataset. The source dataset is often larger than the target dataset, allowing the model to learn feature extraction before the transfer, then fine-tuning the learned feature space at the target domain after the transfer. Therefore, transfer learning can be viewed as an approach to pay the high data cost of deep learning’s automatic feature extraction at the source domain and stabilizing the training at the target domain.</p>
        <p id="Par46">In this work, transfer learning is applied from a model trained on peptide secretion prediction to a model prediction peptide hemolysis. The hope is that due to the similarity between secretory peptides distribution and hemolytic peptide distribution, transfer learning would transfer useful patterns learned from secretory peptides to the hemolysis classification model. Aside from the data distribution similarity which we study in the form of keyword analysis, the data size for the available secretory peptides are much larger than hemolytic peptides, making secretory peptide prediction a suitable source domain for transfer learning.</p>
      </sec>
    </sec>
    <sec id="Sec19">
      <title>Model training</title>
      <sec id="Sec20">
        <title>Hyper-parameter optimization</title>
        <p id="Par47">To optimize the performance of the model and try different architectures, two layers are modified within the model. Firstly, the pooling layer is toggled between default BERT-based pooling layer, mean-pooling layer, and first token pooling layer. Secondly, the fully connected network at the end of the model tasked with classification is assessed in term of the size of the hidden layer and its number of neurons. To do so, after the model is chosen and initialized, a fully connected layer is attached to the last layer of the model to prepare it for sequence classification. The size of the fully connected layer, the type of the pooling layer, as well as the learning rate for training are determined using a grid search hyper-parameter optimization. This optimization can be performed through the control panel provided in the script “training” in the GitHub repository. The model architecture and the possible variations of it are shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref>.<fig id="Fig6"><label>Fig. 6</label><caption><p>Overview of model architecture and its variations. The pooling layer can be swapped between three possible pooling mechanism. The classification layer can also be modified to insert a hidden layer</p></caption><graphic xlink:href="12859_2022_4952_Fig6_HTML" id="MO6"/></fig></p>
        <p id="Par48">To determine the optimum length of training, early-stopping with patience of 10 epochs is used. To create a fair monitoring metric, 10% of the training set for each benchmark is isolated as the validation set. The model is first trained on the secretory task, with early stopping monitoring the secretory validation set’s MCC. After the model is trained, the weights are transferred to a new model for training on hemolysis classification task. As the weights are transferred, the model is trained similar to last stage, with early stopping monitoring the validation set performance. The range of hyper-parameters explored during hyper-parameter optimization can be found in Additional File <xref rid="MOESM1" ref-type="media">1</xref>.</p>
      </sec>
      <sec id="Sec21">
        <title>Selective fine-tuning and parameter freezing</title>
        <p id="Par49">Since Prot-BERT-BFD is a rather large model with more than 400 million parameters, fine-tuning it with datasets as small as 800 data points proved to be challenging. As seen in previous related deep learning-based works [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR14">14</xref>], when a small number of hemolytic peptides are used for training a large deep learning-based model, the automatic feature extraction may fail to fully learn useful representation that can outperform biological or physicochemical features. In this work, to alleviate this problem two techniques are implemented; transferring learned features, and making the effective number of parameters in the model smaller. Firstly transfer learning is used to initialize the model with favorable weights and features. Secondly, a novel approach for fine-tuning the model is introduced, called selective fine-tuning, where many parameters of the model are frozen during training and are not changed via the stochastic gradient descent. Through freezing the parameters, the number of trainable parameters fall, resulting in less number of data points needed during training.</p>
        <p id="Par50">AMPDeep first sections the parameters of the model into the following categories: positional embedding, non-positional embedding, attention heads, layer norms, pooler, and classifier parameters. Each category of the model can either be frozen during training, or left unfrozen to be changed. This decision (to freeze or not) is treated as a hyper-parameter and is toggled for each category of parameters during hyper-parameter optimization, allowing “selective fine-tuning” to take place. To this end, 8 scenarios are defined and investigated as selective fine-tuning:<list list-type="bullet"><list-item><p id="Par51"><italic>Scenario 1</italic> Full fine-tuning: the standard method of fine-tuning where all parameters of the model are unfrozen and trainable.</p></list-item><list-item><p id="Par52"><italic>Scenario 2</italic> Feature extraction: the typical method of fine-tuning when small amount of data is available, where only the classification layers are trainable.</p></list-item><list-item><p id="Par53"><italic>Scenario 3</italic> Pooler fine-tuning: Pooler plays an important role passing on the extracted features to the classifier layer. In this scenario pooler is also fine-tuned.</p></list-item><list-item><p id="Par54"><italic>Scenario 4</italic> Pooler replacement: In our experiments through trial and error the pooling layer was found to be highly impactful on the performance of the model. Therefore, in this work the effect of pooling layer is investigated via swapping the layer with simple mean or first token pooling mechanisms. From this scenario onward, pooler is always replaced with either mean or first token pooling.</p></list-item><list-item><p id="Par55"><italic>Scenario 5</italic> Input embedding fine-tuning: The input embedding is how the sequence is embedded in terms of its context and its order to be passed on to the model. In this scenario, all of the embedding vectors are unfrozen and can be fine-tune, allowing the model to adapt to the different inputs domain of the data. Mean pooler is used and classification layer is also unfrozen.</p></list-item><list-item><p id="Par56"><italic>Scenario 6</italic> Positional embedding fine-tuning: This embedding is in charge of representing the order of the sequence. In this scenario it is left unfrozen. Mean pooler is used and classification layer is also unfrozen.</p></list-item><list-item><p id="Par57"><italic>Scenario 7</italic> Input embedding + layer norm fine-tuning: In this scenario all of the embedding vectors as well as the layer norms are fine-tuned. Mean pooler is used and classification layer is also unfrozen.</p></list-item><list-item><p id="Par58"><italic>Scenario 8</italic> Positional embedding + layer norm fine-tuning: In this scenario the positional embedding vector as well as the layer norms are fine-tuned. Mean pooler is used and classification layer is also unfrozen.</p></list-item></list>This type of fine-tuning enables a greater control over the parameters of the model when compared to traditional fine-tuning. This process is inspired by the fine-tuning process described in [<xref ref-type="bibr" rid="CR20">20</xref>], where positional embedding layer and the layer norms are unfrozen, while the rest of the parameters are frozen. We further add to this strategy via exploring more freezing scenarios and adding more control over the type of the pooler. The different scenarios and their parameters are available on GitHub through the script “plot_results”.</p>
      </sec>
    </sec>
    <sec id="Sec22">
      <title>Evaluation metric</title>
      <p id="Par59">Following the related works, in this work the Mathews Correlation Coefficient is used for evaluating the performance of the models. This metric is a used to measure the association between the binary vector of labels and the binary vector of predictions and is defined as shown in Eq. (<xref rid="Equ1" ref-type="">1</xref>) where <italic>TP</italic>, <italic>TN</italic>, <italic>FP</italic>, and <italic>FN</italic> denote True Positive, True Negative, False Positive, and False Negative respectively. Higher MCC demonstrates higher degree of agreement between the ground truth and the predicted labels, therefore, the model with highest MCC on the validation set is chosen for inference on the test set and final evaluation.<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$MCC = \frac{{TP \times TN - FP \times FN}}{{\sqrt {\left( {TP + FP} \right)\left( {TP + FN} \right)\left( {TN + FP} \right)\left( {TN + FN} \right)} }}$$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mrow><mml:mi>M</mml:mi><mml:mi>C</mml:mi><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>×</mml:mo><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi><mml:mo>×</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:msqrt><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:mfenced><mml:mfenced close=")" open="("><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:mfenced><mml:mfenced close=")" open="("><mml:mrow><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:mfenced><mml:mfenced close=")" open="("><mml:mrow><mml:mi>T</mml:mi><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msqrt></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="12859_2022_4952_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec23">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2022_4952_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1.</bold> A Word document containing the additional methodology and results.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Milad Salem and Arash Keshavarzi Arshadi have contributed equally</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary Information</title>
    <p>The online version contains supplementary material available at 10.1186/s12859-022-04952-z.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>MS conceived the idea, processed the data, implemented the code, and wrote the technical sections of the manuscript. AKA gathered the data, performed biological analysis of the data, and wrote the biological sections of the manuscript. JSY advised the scope and the implementation of the project. All authors read and approved the final manuscript</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This research received no specific grant from any funding agency in the public, commercial, or not-for-profit sectors.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The data and the scripts for this work are available through GitHub at <ext-link ext-link-type="uri" xlink:href="https://github.com/milad73s/AMPDeep">https://github.com/milad73s/AMPDeep</ext-link>, and archived at Zenodo at <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/6992526">https://zenodo.org/record/6992526</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar3">
      <title>Ethics approval and consent to participate</title>
      <p id="Par60">Not applicable</p>
    </notes>
    <notes id="FPar5">
      <title>Consent for publication</title>
      <p id="Par61">Not applicable</p>
    </notes>
    <notes id="FPar4" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par62">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rayan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Raiyn</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Falah</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Nature is the best source of anticancer drugs: indexing natural products for their anticancer bioactivity</article-title>
        <source>PloS One</source>
        <year>2017</year>
        <volume>12</volume>
        <issue>11</issue>
        <fpage>0187925</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0187925</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marqus</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pirogova</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Piva</surname>
            <given-names>TJ</given-names>
          </name>
        </person-group>
        <article-title>Evaluation of the use of therapeutic peptides for cancer treatment</article-title>
        <source>J Biomed Sci</source>
        <year>2017</year>
        <volume>24</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="doi">10.1186/s12929-017-0328-x</pub-id>
        <pub-id pub-id-type="pmid">28056970</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Deslouches</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Di</surname>
            <given-names>YP</given-names>
          </name>
        </person-group>
        <article-title>Antimicrobial peptides with selective antitumor mechanisms: prospect for anticancer applications</article-title>
        <source>Oncotarget</source>
        <year>2017</year>
        <volume>8</volume>
        <issue>28</issue>
        <fpage>46635</fpage>
        <pub-id pub-id-type="doi">10.18632/oncotarget.16743</pub-id>
        <pub-id pub-id-type="pmid">28422728</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Plisson</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Ramírez-Sánchez</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Martínez-Hernández</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Machine learning-guided discovery and design of non-hemolytic peptides</article-title>
        <source>Sci Rep</source>
        <year>2020</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>19</lpage>
        <pub-id pub-id-type="doi">10.1038/s41598-020-73644-6</pub-id>
        <pub-id pub-id-type="pmid">31913322</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hasan</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Schaduangrat</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Basith</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Shoombuatong</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Manavalan</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Hlppred-fuse: improved and robust prediction of hemolytic peptide and its activity by fusing multiple feature representation</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <issue>11</issue>
        <fpage>3350</fpage>
        <lpage>3356</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa160</pub-id>
        <pub-id pub-id-type="pmid">32145017</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kumar</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Agrawal</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Patiyal</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Raghava</surname>
            <given-names>GP</given-names>
          </name>
        </person-group>
        <article-title>A method for predicting hemolytic potency of chemically modified peptides from its structure</article-title>
        <source>Front Pharm</source>
        <year>2020</year>
        <volume>11</volume>
        <fpage>54</fpage>
        <pub-id pub-id-type="doi">10.3389/fphar.2020.00054</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Timmons</surname>
            <given-names>PB</given-names>
          </name>
          <name>
            <surname>Hewage</surname>
            <given-names>CM</given-names>
          </name>
        </person-group>
        <article-title>Happenn is a novel tool for hemolytic activity prediction for therapeutic peptides which employs neural networks</article-title>
        <source>Sci Rep</source>
        <year>2020</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="doi">10.1038/s41598-020-67701-3</pub-id>
        <pub-id pub-id-type="pmid">31913322</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Khabbaz</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Karimi-Jafari</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Saboury</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>BabaAli</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Prediction of antimicrobial peptides toxicity based on their physico-chemical properties using machine learning techniques</article-title>
        <source>BMC Bioinform</source>
        <year>2021</year>
        <volume>22</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="doi">10.1186/s12859-021-04468-y</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mar</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Zaunseder</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Martínez</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Llamedo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Poll</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Optimization of ecg classification by means of feature selection</article-title>
        <source>IEEE Trans Biomed Eng</source>
        <year>2011</year>
        <volume>58</volume>
        <issue>8</issue>
        <fpage>2168</fpage>
        <lpage>2177</lpage>
        <pub-id pub-id-type="doi">10.1109/TBME.2011.2113395</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">Dollar P, Tu Z, Tao H, BelongieS. Feature mining for image classification. In: 2007 IEEE Conference on Computer Vision and Pattern Recognition; 2007, pp. 1–8. 10.1109/CVPR.2007.383046</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <mixed-citation publication-type="other">Wang, G.: Improved methods for classification, prediction, and design of antimicrobial peptides. In: Computational Peptidology, Springer ; 2015, , pp. 43–66.</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Capecchi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Personne</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Köhler</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>van Delden</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Reymond</surname>
            <given-names>J-L</given-names>
          </name>
        </person-group>
        <article-title>Machine learning designs non-hemolytic antimicrobial peptides</article-title>
        <source>Chem Sci</source>
        <year>2021</year>
        <volume>12</volume>
        <issue>26</issue>
        <fpage>9221</fpage>
        <lpage>9232</lpage>
        <pub-id pub-id-type="doi">10.1039/D1SC01713F</pub-id>
        <pub-id pub-id-type="pmid">34349895</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Peters ME, Neumann M, Iyyer M, Gardner M, Clark C, Lee K, Zettlemoyer L. Deep contextualized word representations; 2018. arXiv (2018). 10.48550/ARXIV.1802.05365. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1802.05365">arXiv:1802.05365</ext-link></mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">Taho F. Antimicrobial peptide host toxicity prediction with transfer learning for proteins. In: PhD thesis, University of British Columbia; 2020.</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Elnaggar A, Heinzinger M, Dallago C, Rehawi G, Wang Y, Jones L, Gibbs T, Feher T, Angerer C, Steinegger M, Bhowmik D, Rost B. Prottrans: Towards cracking the language of life’s code through self-supervised learning. bioRxiv ; 2021. 10.1101/2020.07.12.199554. <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/early/2021/05/04/2020.07.12.199554.full.pdf">https://www.biorxiv.org/content/early/2021/05/04/2020.07.12.199554.full.pdf</ext-link></mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Consortium T.U. Uniprot: the universal protein knowledgebase in 2021. Nucleic acids research. 2021;49(D1):480–9.</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Petsko GA, Ringe D. Protein Structure and Function. New Science Press (2004)</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Win</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Malik</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Prachayasittikul</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Wikberg</surname>
            <given-names>SJE</given-names>
          </name>
          <name>
            <surname>Nantasenamat</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Shoombuatong</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Hemopred: a web server for predicting the hemolytic activity of peptides</article-title>
        <source>Future Med Chem.</source>
        <year>2017</year>
        <volume>9</volume>
        <issue>3</issue>
        <fpage>275</fpage>
        <lpage>91</lpage>
        <pub-id pub-id-type="doi">10.4155/fmc-2016-0188</pub-id>
        <pub-id pub-id-type="pmid">28211294</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chaudhary</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Singh</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tuknait</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gautam</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mathur</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Anand</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Varshney</surname>
            <given-names>GC</given-names>
          </name>
          <name>
            <surname>Raghava</surname>
            <given-names>GP</given-names>
          </name>
        </person-group>
        <article-title>A web server and mobile app for computing hemolytic potency of peptides</article-title>
        <source>Sci Rep</source>
        <year>2016</year>
        <volume>6</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1038/srep22843</pub-id>
        <pub-id pub-id-type="pmid">28442746</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <mixed-citation publication-type="other">Lu K, Grover A, Abbeel P, Mordatch I. Pretrained transformers as universal computation engines. CoRR abs/2103.05247; 2021. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/2103.05247">arXiv:2103.05247</ext-link></mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <mixed-citation publication-type="other">Devlin J, Chang M-W, Lee K, Toutanova K. BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding. arXiv ; 2018. 10.48550/ARXIV.1810.04805. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1810.04805">arXiv:1810.04805</ext-link></mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Wang Z, Dai Z, Poczos B, Carbonell J. Characterizing and avoiding negative transfer. In: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR); 2019</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gautam</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Chaudhary</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Singh</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Joshi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Anand</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Tuknait</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mathur</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Varshney</surname>
            <given-names>GC</given-names>
          </name>
          <name>
            <surname>Raghava</surname>
            <given-names>GP</given-names>
          </name>
        </person-group>
        <article-title>Hemolytik: a database of experimentally determined hemolytic and non-hemolytic peptides</article-title>
        <source>Nucleic Acids Res</source>
        <year>2014</year>
        <volume>42</volume>
        <issue>D1</issue>
        <fpage>444</fpage>
        <lpage>449</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkt1008</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gogoladze</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Grigolava</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Vishnepolsky</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Chubinidze</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Duroux</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Lefranc</surname>
            <given-names>M-P</given-names>
          </name>
          <name>
            <surname>Pirtskhalava</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Dbaasp: database of antimicrobial activity and structure of peptides</article-title>
        <source>FEMS Microbiol Lett</source>
        <year>2014</year>
        <volume>357</volume>
        <issue>1</issue>
        <fpage>63</fpage>
        <lpage>68</lpage>
        <pub-id pub-id-type="doi">10.1111/1574-6968.12489</pub-id>
        <pub-id pub-id-type="pmid">24888447</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wei</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Zou</surname>
            <given-names>Q</given-names>
          </name>
        </person-group>
        <article-title>Pepred-suite: improved and robust prediction of therapeutic peptides using adaptive feature representation learning</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <issue>21</issue>
        <fpage>4272</fpage>
        <lpage>4280</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btz246</pub-id>
        <pub-id pub-id-type="pmid">30994882</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">huggingface: Rostlab Prot Bert Bfd. <ext-link ext-link-type="uri" xlink:href="https://huggingface.co/Rostlab">https://huggingface.co/Rostlab</ext-link> Accessed 2022-04-25</mixed-citation>
    </ref>
  </ref-list>
</back>
