<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Mol Biol Evol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Mol Biol Evol</journal-id>
    <journal-id journal-id-type="publisher-id">molbev</journal-id>
    <journal-title-group>
      <journal-title>Molecular Biology and Evolution</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0737-4038</issn>
    <issn pub-type="epub">1537-1719</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8233496</article-id>
    <article-id pub-id-type="pmid">33892491</article-id>
    <article-id pub-id-type="doi">10.1093/molbev/msab120</article-id>
    <article-id pub-id-type="publisher-id">msab120</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Resources</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01130</subject>
        <subject>AcademicSubjects/SCI01180</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MEGA11: Molecular Evolutionary Genetics Analysis Version 11</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Tamura</surname>
          <given-names>Koichiro</given-names>
        </name>
        <xref rid="msab120-aff1" ref-type="aff">1</xref>
        <xref rid="msab120-aff2" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Stecher</surname>
          <given-names>Glen</given-names>
        </name>
        <xref rid="msab120-aff3" ref-type="aff">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-9918-8212</contrib-id>
        <name>
          <surname>Kumar</surname>
          <given-names>Sudhir</given-names>
        </name>
        <xref rid="msab120-cor1" ref-type="corresp"/>
        <!--s.kumar@temple.edu-->
        <xref rid="msab120-aff3" ref-type="aff">3</xref>
        <xref rid="msab120-aff4" ref-type="aff">4</xref>
        <xref rid="msab120-aff5" ref-type="aff">5</xref>
      </contrib>
    </contrib-group>
    <aff id="msab120-aff1"><label>1</label><institution>Department of Biological Sciences, Tokyo Metropolitan University</institution>, Tokyo, <country country="JP">Japan</country></aff>
    <aff id="msab120-aff2"><label>2</label><institution>Research Center for Genomics and Bioinformatics, Tokyo Metropolitan University</institution>, Tokyo, <country country="JP">Japan</country></aff>
    <aff id="msab120-aff3"><label>3</label><institution>Institute for Genomics and Evolutionary Medicine, Temple University</institution>, Philadelphia, PA, <country country="US">USA</country></aff>
    <aff id="msab120-aff4"><label>4</label><institution>Department of Biology, Temple University</institution>, Philadelphia, PA, <country country="US">USA</country></aff>
    <aff id="msab120-aff5"><label>5</label><institution>Center for Excellence in Genome Medicine and Research, King Abdulaziz University</institution>, Jeddah, <country country="SA">Saudi Arabia</country></aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Battistuzzi</surname>
          <given-names>Fabia Ursula</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="msab120-cor1"><bold>Corresponding author:</bold> E-mail: <email>s.kumar@temple.edu</email>.</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-04-23">
      <day>23</day>
      <month>4</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>23</day>
      <month>4</month>
      <year>2021</year>
    </pub-date>
    <volume>38</volume>
    <issue>7</issue>
    <fpage>3022</fpage>
    <lpage>3027</lpage>
    <history>
      <date date-type="received">
        <day>03</day>
        <month>3</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>4</month>
        <year>2021</year>
      </date>
      <date date-type="editorial-decision">
        <day>14</day>
        <month>4</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press on behalf of the Society for Molecular Biology and Evolution.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="msab120.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>The Molecular Evolutionary Genetics Analysis (MEGA) software has matured to contain a large collection of methods and tools of computational molecular evolution. Here, we describe new additions that make MEGA a more comprehensive tool for building timetrees of species, pathogens, and gene families using rapid relaxed-clock methods. Methods for estimating divergence times and confidence intervals are implemented to use probability densities for calibration constraints for node-dating and sequence sampling dates for tip-dating analyses. They are supported by new options for tagging sequences with spatiotemporal sampling information, an expanded interactive <italic toggle="yes">Node Calibrations Editor</italic>, and an extended <italic toggle="yes">Tree Explorer</italic> to display timetrees. Also added is a Bayesian method for estimating neutral evolutionary probabilities of alleles in a species using multispecies sequence alignments and a machine learning method to test for the autocorrelation of evolutionary rates in phylogenies. The computer memory requirements for the maximum likelihood analysis are reduced significantly through reprogramming, and the graphical user interface has been made more responsive and interactive for very big data sets. These enhancements will improve the user experience, quality of results, and the pace of biological discovery. Natively compiled graphical user interface and command-line versions of MEGA11 are available for Microsoft Windows, Linux, and macOS from <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://www.megasoftware.net" ext-link-type="uri">www.megasoftware.net</ext-link>.</p>
    </abstract>
    <kwd-group>
      <kwd>software</kwd>
      <kwd>phylogenetics</kwd>
      <kwd>timetrees</kwd>
      <kwd>tip dating</kwd>
      <kwd>neutrality</kwd>
    </kwd-group>
    <counts>
      <page-count count="6"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>The Molecular Evolutionary Genetics Analysis (MEGA) software has continuously grown to meet the need for sophisticated evolutionary analysis to discover organismal and genome evolutionary patterns and processes. It was first released in 1993 to offer the statistical methods of molecular evolution through an interactive interface on the Microsoft Disk Operating System (MS-DOS) (<xref rid="msab120-B10" ref-type="bibr">Kumar et al. 1993</xref>). For more than 25 years, MEGA’s scope and usefulness have grown through the addition of new methods, tools, and interfaces, resulting in modern integrated software for comparative sequence analysis (<xref rid="msab120-B2" ref-type="bibr">Caspermeyer 2018</xref>). Initially, MEGA contained distance-based and maximum parsimony methods for molecular phylogenetic analysis (<xref rid="msab120-B11" ref-type="bibr">Kumar et al. 1994</xref>). The data acquisition and integration of major approaches for aligning sequences were introduced to expand MEGA's scope (<xref rid="msab120-B12" ref-type="bibr">Kumar et al. 2004</xref>). Afterward, the maximum likelihood (ML) methods and Bayesian methods were added for molecular evolutionary analyses (<xref rid="msab120-B21" ref-type="bibr">Tamura et al. 2011</xref>). MEGA now contains methods for selecting the best-fit substitution model(s), estimating evolutionary distances and divergence times, reconstructing phylogenies, predicting ancestral sequences, testing for selection, and diagnosing disease mutations (<xref rid="msab120-B2" ref-type="bibr">Caspermeyer 2018</xref>).</p>
    <p>With every new version, MEGA has evolved to harness technological innovations and personal desktops' computational power. MEGA’s interface evolved from its initial MS-DOS character-based format (<xref rid="msab120-B10" ref-type="bibr">Kumar et al. 1993</xref>) to a rich graphical user interface (GUI) for Microsoft Windows operating system (<xref rid="msab120-B9" ref-type="bibr">Kumar et al. 2001</xref>). It was then redesigned to become activity-driven (<xref rid="msab120-B21" ref-type="bibr">Tamura et al. 2011</xref>), followed by the incorporation of web technologies to ensure a consistent use-and-feel across Microsoft Windows and Linux operating systems (<xref rid="msab120-B6" ref-type="bibr">Kumar et al. 2018</xref>) and macOS (<xref rid="msab120-B18" ref-type="bibr">Stecher et al. 2020</xref>). MEGA GUI is now fully cross-platform running natively on Windows, Linux, and macOS.</p>
    <p>MEGA’s computational core (MEGA-CC) has undergone extensive refactoring, hardening, and expansion over time. It advanced from 16-bit to 32-bit (<xref rid="msab120-B9" ref-type="bibr">Kumar et al. 2001</xref>), became multithreaded and incorporated multicore parallelization for various calculations (<xref rid="msab120-B22" ref-type="bibr">Tamura et al. 2013</xref>), and stepped up to 64-bit architecture (<xref rid="msab120-B8" ref-type="bibr">Kumar et al. 2016</xref>, <xref rid="msab120-B6" ref-type="bibr">2018</xref>). MEGA-CC was released for use as a command-line program to address the growing need for batch processing of many data sets and integration into analysis workflows (<xref rid="msab120-B7" ref-type="bibr">Kumar et al. 2012</xref>; <xref rid="msab120-B18" ref-type="bibr">Stecher et al. 2020</xref>). With both 32- and 64-bit versions of MEGA currently available for use on the command-line and GUI, MEGA is now a suite of applications that responds to the variety of computing environments currently used by researchers in molecular evolution and phylogenetics. Here, we present key methodological additions and technical improvements in MEGA that comprise version 11.</p>
  </sec>
  <sec>
    <title>Methodological Additions</title>
    <sec>
      <title>Expansion of Relaxed-Clock Dating Facilities</title>
      <p>Rapid relaxed-clock methods for estimating divergence times are becoming popular because they are feasible and efficient for large contemporary sequence alignments (<xref rid="msab120-B24" ref-type="bibr">Tao, Tamura, Kumar, et al. 2020</xref>). MEGA6 first added methods and tools for constructing evolutionary timetrees by implementing the RelTime method, which does not assume a molecular clock (<xref rid="msab120-B19" ref-type="bibr">Tamura et al. 2012</xref>, <xref rid="msab120-B22" ref-type="bibr">2013</xref>). RelTime is known to perform well and has been used to build timetrees in hundreds of research articles (<xref rid="msab120-B24" ref-type="bibr">Tao, Tamura, Kumar, et al. 2020</xref>). MEGA11 expands on RelTime dating options by advancing the current implementation and adding new facilities for node-dating and tip-dating needed to build timetrees of pathogens, species, and gene families.</p>
      <sec>
        <title>Calibrating the Clock Using Probability Densities on Node-Constraints</title>
        <p>Bayesian relaxed-clock methods have long allowed the use of statistical probability distributions that capture prior knowledge (or belief) about the true divergence times in clock calibration constraints on one or more nodes in the phylogeny. Judicious use of these probability densities can make divergence times more accurate and precise (<xref rid="msab120-B25" ref-type="bibr">Tao, Tamura, Mello, et al. 2020</xref>). Researchers can now use such probability densities for node calibrations in RelTime estimation of divergence times and confidence intervals (CIs). MEGA implements the <xref rid="msab120-B25" ref-type="bibr">Tao, Tamura, Mello, et al. (2020</xref>) approach that estimates CIs by simultaneously accounting for variance introduced by the heterogeneity of evolutionary rate among lineages, estimation of sequence divergence using substitution models, and probability densities for node-calibration constraints. This method produces CIs that contain correct times with a high probability, making them much more suitable for biological hypothesis testing than other rapid methods (<xref rid="msab120-B24" ref-type="bibr">Tao, Tamura, Kumar, et al. 2020</xref>; <xref rid="msab120-B25" ref-type="bibr">Tao, Tamura, Mello, et al. 2020</xref>). </p>
        <p>For RelTime analyses in MEGA11, ML and distance-based approaches can be used to build a timetree for a given phylogeny and multiple sequence alignment. One may also use only a phylogeny with branch lengths, which extends the usefulness of relaxed-clock methods for phylogenies inferred from nonmolecular data or statistical methodologies not available in MEGA. When a phylogeny with branch lengths is used, the CIs will be narrower because the variance associated with branch length estimation cannot be generated without the original data set used to produce the phylogeny and branch lengths. Nevertheless, these CIs will incorporate variance introduced due to rate variation among lineages and clock calibrations’ uncertainty.</p>
        <p>A calibration density selector has been added to the <italic toggle="yes">Node Calibration Editor</italic> that provides an option to select normal, lognormal, uniform, or exponential density (<xref rid="msab120-F1" ref-type="fig">fig. 1</xref>). The user can also specify a minimum or a maximum time bound on a node. The calibration text file format has been extended to specify density information and use calibration densities in MEGA-CC. The <italic toggle="yes">Node Calibration Editor</italic> also includes new functionality to specify a fixed evolutionary rate or a known node time to calibrate the molecular clock. Such assumptions are often used by investigators when independent calibration information is unknown (<xref rid="msab120-B4" ref-type="bibr">Hipsley and Müller 2014</xref>; <xref rid="msab120-B24" ref-type="bibr">Tao, Tamura, Kumar, et al. 2020</xref>).</p>
        <fig position="float" id="msab120-F1">
          <label>Fig. 1.</label>
          <caption>
            <p>Calibration points for MEGA<sc>’s</sc> RelTime method are chosen in the <italic toggle="yes">Node Calibration Editor</italic> window (<italic toggle="yes">A</italic>), accessed via the <italic toggle="yes">Timetree Wizard</italic> system (see <xref rid="msab120-F2" ref-type="fig">fig. 2<italic toggle="yes">A</italic></xref>). The <italic toggle="yes">Node Calibration Editor</italic> displays the phylogeny where individual node calibrations and probability densities can be chosen by clicking the calibration button on the top toolbar for the selected node. A dropdown menu (<italic toggle="yes">B</italic>) with several calibration density types is displayed. The <italic toggle="yes">Node Calibration Editor</italic> then prompts the user for required distribution parameters, depending on the distribution selected: normal distribution (mean and standard deviation), lognormal (offset, mean and standard deviation), exponential (offset and decay parameter), uniform (min and max) (<italic toggle="yes">C</italic>).</p>
          </caption>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="msab120f1" position="float"/>
        </fig>
      </sec>
      <sec>
        <title>Tip-Dating for Sequences with Sampling Times</title>
        <p>MEGA now implements a method to estimate timetrees using sampling dates for molecular sequences. They are often used to infer the origin and diversification of pathogens that generally evolve fast enough to track the evolutionary change over months and years (<xref rid="msab120-B24" ref-type="bibr">Tao, Tamura, Kumar, et al. 2020</xref>). Tip-dating methods are also useful for analyzing ancient molecular sequences. MEGA implements a rapid tip-dating method, RelTime with Dated Tips (RTDT), that produces divergence times and CIs (<xref rid="msab120-B15" ref-type="bibr">Miura et al. 2018</xref>). One may use ML or distance-based approaches for a given phylogeny and multiple sequence alignment for tip-dating, or a phylogeny with branch lengths and tip dates can be given as the input.</p>
        <p>An enhanced <italic toggle="yes">Timetree Wizard</italic> system (<xref rid="msab120-F2" ref-type="fig">fig. 2</xref>) walks the user through many steps needed to configure tip-dating analyses, such as loading sequence and tree files, specifying the outgroups, adding sequence sample times, and selecting the analysis options. Sequence sampling times can be specified in multiple ways. MEGA will automatically extract them on-demand when they are included in the sequence name. Spatiotemporal information can also be presented in the input alignment files as meta tags (see description below) or loaded using specially formatted calibration text files. Once computed, the timetree is displayed in the <italic toggle="yes">Tree Explorer</italic> that has been extensively revamped and updated (<xref rid="msab120-F3" ref-type="fig">fig. 3</xref>). It now has many more formatting tools, including exporting the timetree, individual divergence times, and CI estimates in a tabular format.</p>
        <fig position="float" id="msab120-F2">
          <label>Fig. 2.</label>
          <caption>
            <p>The <italic toggle="yes">Tip Dating Wizard</italic> (<italic toggle="yes">A</italic>) guides the user through the steps required to set up the RTDT analysis. Once a sequence alignment and/or a tree is provided, the user is prompted to specify the outgroup by selecting a node in the <italic toggle="yes">Tree Explorer</italic> or specifying outgroup taxa by name (not shown). Next, sample times are specified using the <italic toggle="yes">Tip Dates Editor</italic> (<italic toggle="yes">B</italic>) with facilities for parsing tip dates (<italic toggle="yes">C</italic>) encoded in taxa names, importing tip dates from a text file, and manually entering the dates. In the next step, the <italic toggle="yes">Analysis Preferences</italic> dialog (not shown) is displayed, allowing the user to set analysis options to estimate branch lengths used by RTDT. The estimated timetree is displayed in the <italic toggle="yes">Tree Explorer</italic> (see <xref rid="msab120-F3" ref-type="fig">fig. 3</xref>).</p>
          </caption>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="msab120f2" position="float"/>
        </fig>
        <fig position="float" id="msab120-F3">
          <label>Fig. 3.</label>
          <caption>
            <p>MEGA’s <italic toggle="yes">Tree Explorer</italic> (<italic toggle="yes">A</italic>) is a feature-rich, versatile viewer of phylogenies that provides many interactive exploration and customization facilities. In MEGA11, the new side toolbar of <italic toggle="yes">Tree Explorer</italic> makes formatting, rearrangement, and tree exploration tools more accessible and intuitive. Instead of a thin toolbar with nameless buttons, we have opted for a wide toolbar with text labels identifying each tool. The toolbar can be moved to either side of the window, and it can be toggled in and out of view. To organize related tools by groups and accommodate limited vertical space, collapsible panels are used. With the new toolbar, formatting tools previously displayed in external dialogs are readily accessible, and formats are applied instantly instead of after the user closes the external dialog. In addition to the updated toolbar, there are now options for auto-collapsing of nodes containing clusters of taxa belonging to the same group, user-specified cluster size, or by the branch length difference. For very large trees with many similar sequences, this feature can greatly facilitate the visualization of evolutionary events at a glance. An option has been added to export pairwise patristic distances between taxa to a text file for phylogenies and timetrees. For maximum likelihood and maximum parsimony trees where ancestral sequences are present, an option has been added to navigate through sites where a change in the estimated ancestral state differs between the parent and child on the currently selected branch. The tree information box (<italic toggle="yes">B</italic>) has been updated for timetrees to show branch- and node-specific information, such as earliest and latest sample times in the currently selected subtree, days elapsed between the divergence time for a selected node and the latest sample time, the nearest and furthest tip from a selected node, clade size and clade taxa, and spatiotemporal information if available.</p>
          </caption>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="msab120f3" position="float"/>
        </fig>
      </sec>
    </sec>
    <sec>
      <title>Detecting Autocorrelation of Evolutionary Rates</title>
      <p>MEGA now contains a facility for detecting autocorrelation of evolutionary rates among branches, which is important for understanding molecular evolution patterns and useful as a clock rate prior in Bayesian relaxed-clock analyses. MEGA implements the CorrTest method developed using machine learning, which is accurate and computationally efficient (<xref rid="msab120-B23" ref-type="bibr">Tao et al. 2019</xref>). The CorrTest implementation in MEGA requires a phylogeny with sequence alignment (or branch lengths) and is accessed through an easy-to-use wizard. This test's final output is a CorrScore between 0 and 1 and a <italic toggle="yes">P</italic>-value, where a high CorrScore and low <italic toggle="yes">P</italic>-value indicates that branch rates among lineages are likely correlated.</p>
    </sec>
    <sec>
      <title>Calculating Neutral Evolutionary Probabilities</title>
      <p>According to the neutral theory of molecular evolution, most differences in molecular sequences across species are expected to have little to no impact on fitness (<xref rid="msab120-B5" ref-type="bibr">Kimura 1983</xref>). Therefore, multispecies sequence alignments have been used to estimate neutral evolutionary probabilities (<italic toggle="yes">EP</italic>) of observing alternative alleles (amino acid residues or nucleotides) in a species, contingent on the given species timetree (<xref rid="msab120-B13" ref-type="bibr">Liu et al. 2016</xref>). MEGA implements an advanced option for this Bayesian approach in which the species timetree containing relative times is computed automatically by using RelTime (<xref rid="msab120-B16" ref-type="bibr">Patel and Kumar 2019</xref>). Alleles with <italic toggle="yes">EP</italic> less than 0.05 are nonneutral, whereas evolutionary permissible (neutral) alleles show much higher EPs. Disease-associated amino acid variants in human populations have <italic toggle="yes">EP</italic> &lt; 0.05 and are rarely found in the population (<xref rid="msab120-B13" ref-type="bibr">Liu et al. 2016</xref>). Many human adaptive variants in populations also have low EPs, that is, nonneutral from an evolutionary perspective, but they show high allele frequencies (<xref rid="msab120-B17" ref-type="bibr">Patel et al. 2018</xref>). Therefore, one may use <italic toggle="yes">EP</italic>s to diagnose disease mutations and detect candidate adaptive variants. An <italic toggle="yes">EP wizard</italic> system walks the user through the steps required to set up the analysis. The first sequence in the alignment is used automatically as the focal taxon of interest (one can rearrange sequences in the <italic toggle="yes">Sequence Data Explorer</italic>). <italic toggle="yes">EP</italic> values for all possible bases (4 for nucleotides and 20 for amino acids) at each position in the input sequence alignment are reported in a spreadsheet or text format.</p>
    </sec>
  </sec>
  <sec>
    <title>Technological Advances</title>
    <p>Although some new user interface elements have already been mentioned above (<xref rid="msab120-F1" ref-type="fig">figs. 1–3</xref>), additional technical advances in MEGA11 are as follows.</p>
    <sec>
      <title>Expanded Group Designations</title>
      <p>MEGA has long supported a “group” tag for sequences and other operational taxonomic units (OTUs). Using the sequence “group” tags, MEGA offered a group-wise exploration of input data, selection of data subsets, and computational analyses (<xref rid="msab120-B9" ref-type="bibr">Kumar 2001</xref>). Support for two new tags (“population” and “species”) was added in MEGA7, with the species tags used to mark duplicate genes in multigene family phylogenies (<xref rid="msab120-B8" ref-type="bibr">Kumar et al. 2016</xref>). In MEGA11, sequences can now be tagged to provide information on the continent, country, city, year, month, day, and time. This spatiotemporal information can be used in tip-dating analyses.</p>
      <p>In MEGA11, we have made a MEGA-wide change to use any meta tag to define groups. For example, if one selects the “Year” meta tag for use as a group, they could estimate average diversity within and between sequences sampled in different years (<italic toggle="yes">Distance</italic> menu). In the <italic toggle="yes">Sequence Data Explorer</italic>, one can select/unselect sequences of certain years for phylogenetic analyses. Also, the display of years would be automatically enabled in the <italic toggle="yes">Tree Explorer</italic>, and the feature to collapse sequence clusters will be done by years. Additionally, sequences can be sorted based on years in all the input data and result explorer displays. Therefore, a dynamic designation of groups based on the desired meta tag will enable data exploration and analysis more efficiently.</p>
    </sec>
    <sec>
      <title>Memory Efficient ML Analyses</title>
      <p>ML methods are widely used for phylogenetic inference but place high demands on computer memory, becoming increasingly burdensome for bigger sequence alignments analyzed these days. In MEGA11, we have now completed a long-overdue refactoring of ML calculations by adding a step to identify common site configurations, that is, sites where all sequences have the same bases as at some other sites, to utilize computer memory more efficiently. The memory requirements of Maximum Likelihood and Maximum parsimony analysis are reduced (approximately) by the factor of <italic toggle="yes">m</italic>/<italic toggle="yes">L</italic> when there are <italic toggle="yes">m</italic> distinct site configurations in a sequence alignment containing <italic toggle="yes">L</italic> sites. The memory saving can be substantial for multigene and genome-scale alignments. For example, the memory saving was 660 MB (209 vs. 870 MB) for a sequence alignment of 229 birds with 2,728 sites (<xref rid="msab120-B3" ref-type="bibr">Claramunt and Cracraft 2015</xref>) and 4.5 GB (2.3 vs. 6.8 GB) for an alignment of 162 mammals with 11,010 sites (<xref rid="msab120-B14" ref-type="bibr">Meredith et al. 2011</xref>). This memory saving does not have any detrimental impact on phylogenetic estimates and computational times because identical site configurations have the same likelihood value. The total log-likelihood is simply the sum of site-configuration log-likelihoods weighted by their frequencies. However, this upgrade required refactoring many different parts of MEGA’s calculation engine, including functions for phylogeny construction and model selection.</p>
    </sec>
    <sec>
      <title>Enhanced GUI for Exploring Large Data Sets</title>
      <p>Using a large multiple sequence alignment containing 68,000 genomes and 30,000 bases each, we assessed MEGA GUI's responsiveness during input data file reading, execution of functions in the <italic toggle="yes">Sequence Data Explorer</italic>, estimation of pairwise distances, and building of distance-based phylogenies. We found the GUI to become intermittently unresponsive for such large data sets, which are now common due to resequencing and population sequencing efforts. Consequently, we have moved all potentially long-running operations out of the main GUI thread to background threads in a major overhaul of the source code. Now, large input data files are read rapidly, and calculations of pairwise distance matrices, selection tests, and phylogeny construction for distance-based methods are performed in a background thread. The <italic toggle="yes">Sequence Data Explorer</italic> has been reprogrammed to enable more efficient highlighting of variable sites, and navigation of the sequence alignment has been improved. Also added are options to automatically label sites based on attributes, which annotates sites by providing a one-character label and then using desired labeled sites to subset data for any molecular phylogenetic analysis desired.</p>
    </sec>
  </sec>
  <sec>
    <title>Conclusions</title>
    <p>Version 11 of MEGA adds many methods and tools to keep pace with researchers' growing needs. The addition of evolutionary dating methods in MEGA make it easier to estimate species and strain divergence times by using more informative node calibrations and sampling times. The new CorrTest and EP calculations will enable a more robust evaluation of assumptions about biological characteristics of molecular data. The reduction in memory needs of ML-based computations will allow users to analyze much larger data sets than before. The refactoring of distance-based methods’ calculation to run in threads independent of the main graphical interface and other GUI enhancements greatly improve MEGA usability for very large data sets.</p>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgments</title>
    <p>We thank our laboratory members and many beta testers for providing invaluable feedback and bug reports. This study was supported in part by research grants from the National Institutes of Health (R35GM139504-01), National Science Foundation (DEB-2034228, DBI-1661218), and Japan Society for the Promotion of Science (JSPS) grants-in-aid for scientific research (DB5) to K.T.</p>
    <sec sec-type="data-availability">
      <title>Data Availability</title>
      <p>The software and its source code are available from <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://www.megasoftware.net" ext-link-type="uri">www.megasoftware.net</ext-link>.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="msab120-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Caspermeyer</surname><given-names>J.</given-names></string-name></person-group><year>2018</year>. 
<article-title>MEGA software celebrates silver anniversary</article-title>. <source>Mol Biol Evol</source>. <volume>35</volume>(<issue>6</issue>):<fpage>1558</fpage>–<lpage>1560</lpage>.<pub-id pub-id-type="pmid">29800318</pub-id></mixed-citation>
    </ref>
    <ref id="msab120-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Claramunt</surname><given-names>S</given-names></string-name>, <string-name><surname>Cracraft</surname><given-names>J.</given-names></string-name></person-group><year>2015</year>. 
<article-title>A new time tree reveals Earth history’s imprint on the evolution of modern birds</article-title>. <source>Sci Adv</source>. <volume>1</volume>(<issue>11</issue>):<fpage>e1501005</fpage>.<pub-id pub-id-type="pmid">26824065</pub-id></mixed-citation>
    </ref>
    <ref id="msab120-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hipsley</surname><given-names>CA</given-names></string-name>, <string-name><surname>Müller</surname><given-names>J.</given-names></string-name></person-group><year>2014</year>. 
<article-title>Beyond fossil calibrations: realities of molecular clock practices in evolutionary biology</article-title>. <source>Front Genet</source>. <volume>5</volume>:<fpage>138</fpage>.<pub-id pub-id-type="pmid">24904638</pub-id></mixed-citation>
    </ref>
    <ref id="msab120-B5">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Kimura</surname><given-names>M.</given-names></string-name></person-group><year>1983</year>. <source>The neutral theory of molecular evolution</source>. 
<publisher-loc>New York</publisher-loc>: 
<publisher-name>Cambridge University Press</publisher-name>.</mixed-citation>
    </ref>
    <ref id="msab120-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kumar</surname><given-names>S</given-names></string-name>, <string-name><surname>Stecher</surname><given-names>G</given-names></string-name>, <string-name><surname>Li</surname><given-names>M</given-names></string-name>, <string-name><surname>Knyaz</surname><given-names>C</given-names></string-name>, <string-name><surname>Tamura</surname><given-names>K.</given-names></string-name></person-group><year>2018</year>. 
<article-title>MEGA X: molecular Evolutionary Genetics Analysis across computing platforms</article-title>. <source>Mol Biol Evol</source>. <volume>35</volume>(<issue>6</issue>):<fpage>1547</fpage>–<lpage>1549</lpage>.<pub-id pub-id-type="pmid">29722887</pub-id></mixed-citation>
    </ref>
    <ref id="msab120-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kumar</surname><given-names>S</given-names></string-name>, <string-name><surname>Stecher</surname><given-names>G</given-names></string-name>, <string-name><surname>Peterson</surname><given-names>D</given-names></string-name>, <string-name><surname>Tamura</surname><given-names>K.</given-names></string-name></person-group><year>2012</year>. 
<article-title>MEGA-CC: computing core of molecular evolutionary genetics analysis program for automated and iterative data analysis</article-title>. <source>Bioinformatics</source><volume>28</volume>(<issue>20</issue>):<fpage>2685</fpage>–<lpage>2686</lpage>.<pub-id pub-id-type="pmid">22923298</pub-id></mixed-citation>
    </ref>
    <ref id="msab120-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kumar</surname><given-names>S</given-names></string-name>, <string-name><surname>Stecher</surname><given-names>G</given-names></string-name>, <string-name><surname>Tamura</surname><given-names>K.</given-names></string-name></person-group><year>2016</year>. 
<article-title>MEGA7: molecular Evolutionary Genetics Analysis version 7.0 for bigger datasets</article-title>. <source>Mol Biol Evol</source>. <volume>33</volume>(<issue>7</issue>):<fpage>1870</fpage>–<lpage>1874</lpage>.<pub-id pub-id-type="pmid">27004904</pub-id></mixed-citation>
    </ref>
    <ref id="msab120-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kumar</surname><given-names>S</given-names></string-name>, <string-name><surname>Tamura</surname><given-names>K</given-names></string-name>, <string-name><surname>Jakobsen</surname><given-names>I</given-names></string-name>, <string-name><surname>Nei</surname><given-names>M.</given-names></string-name></person-group><year>2001</year>. 
<article-title>MEGA2: molecular evolutionary genetics analysis software</article-title>. <source>Bioinformatics</source><volume>17</volume>(<issue>12</issue>):<fpage>1244</fpage>–<lpage>1245</lpage>.<pub-id pub-id-type="pmid">11751241</pub-id></mixed-citation>
    </ref>
    <ref id="msab120-B10">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Kumar</surname><given-names>S</given-names></string-name>, <string-name><surname>Tamura</surname><given-names>K</given-names></string-name>, <string-name><surname>Nei</surname><given-names>M.</given-names></string-name></person-group><year>1993</year>. <source>MEGA: Molecular Evolutionary Genetics Analysis version 1.01</source>. 
<publisher-loc>University Park (PA</publisher-loc>): 
<publisher-name>The Pennsylvania State University</publisher-name>.</mixed-citation>
    </ref>
    <ref id="msab120-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kumar</surname><given-names>S</given-names></string-name>, <string-name><surname>Tamura</surname><given-names>K</given-names></string-name>, <string-name><surname>Nei</surname><given-names>M.</given-names></string-name></person-group><year>1994</year>. 
<article-title>MEGA—molecular evolutionary genetics analysis software for microcomputers</article-title>. <source>Comput Appl Biosci</source>. <volume>10</volume>(<issue>2</issue>):<fpage>189</fpage>–<lpage>191</lpage>.<pub-id pub-id-type="pmid">8019868</pub-id></mixed-citation>
    </ref>
    <ref id="msab120-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kumar</surname><given-names>S</given-names></string-name>, <string-name><surname>Tamura</surname><given-names>K</given-names></string-name>, <string-name><surname>Nei</surname><given-names>M.</given-names></string-name></person-group><year>2004</year>. 
<article-title>MEGA3: integrated software for Molecular Evolutionary Genetics Analysis and sequence alignment</article-title>. <source>Brief Bioinform</source>. <volume>5</volume>(<issue>2</issue>):<fpage>150</fpage>–<lpage>163</lpage>.<pub-id pub-id-type="pmid">15260895</pub-id></mixed-citation>
    </ref>
    <ref id="msab120-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>L</given-names></string-name>, <string-name><surname>Tamura</surname><given-names>K</given-names></string-name>, <string-name><surname>Sanderford</surname><given-names>MD</given-names></string-name>, <string-name><surname>Gray</surname><given-names>V</given-names></string-name>, <string-name><surname>Kumar</surname><given-names>S.</given-names></string-name></person-group><year>2016</year>. 
<article-title>A molecular evolutionary reference or the human variome</article-title>. <source>Mol Biol Evol</source>. <volume>33</volume>(<issue>1</issue>):<fpage>245</fpage>–<lpage>254</lpage>.<pub-id pub-id-type="pmid">26464126</pub-id></mixed-citation>
    </ref>
    <ref id="msab120-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Meredith</surname><given-names>RW</given-names></string-name>, <string-name><surname>Janečka</surname><given-names>JE</given-names></string-name>, <string-name><surname>Gatesy</surname><given-names>J</given-names></string-name>, <string-name><surname>Ryder</surname><given-names>OA</given-names></string-name>, <string-name><surname>Fisher</surname><given-names>CA</given-names></string-name>, <string-name><surname>Teeling</surname><given-names>EC</given-names></string-name>, <string-name><surname>Goodbla</surname><given-names>A</given-names></string-name>, <string-name><surname>Eizirik</surname><given-names>E</given-names></string-name>, <string-name><surname>Simão</surname><given-names>TLL</given-names></string-name>, <string-name><surname>Stadler</surname><given-names>T</given-names></string-name></person-group>, <etal>et al</etal><year>2011</year>. 
<article-title>Impacts of the cretaceous terrestrial revolution and KPg extinction on mammal diversification</article-title>. <source>Science</source><volume>334</volume>(<issue>6055</issue>):<fpage>521</fpage>–<lpage>524</lpage>.<pub-id pub-id-type="pmid">21940861</pub-id></mixed-citation>
    </ref>
    <ref id="msab120-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Miura</surname><given-names>S</given-names></string-name>, <string-name><surname>Tamura</surname><given-names>K</given-names></string-name>, <string-name><surname>Tao</surname><given-names>Q</given-names></string-name>, <string-name><surname>Huuki</surname><given-names>LA</given-names></string-name>, <string-name><surname>Pond</surname><given-names>SLK</given-names></string-name>, <string-name><surname>Priest</surname><given-names>J</given-names></string-name>, <string-name><surname>Deng</surname><given-names>J</given-names></string-name>, <string-name><surname>Kumar</surname><given-names>S.</given-names></string-name></person-group><year>2018</year>. 
<article-title>A new method for inferring timetrees from temporally sampled molecular sequences</article-title>. <source>PLoS Comput Biol</source>. <volume>16</volume>:<fpage>24</fpage>.</mixed-citation>
    </ref>
    <ref id="msab120-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Patel</surname><given-names>R</given-names></string-name>, <string-name><surname>Kumar</surname><given-names>S.</given-names></string-name></person-group><year>2019</year>. 
<article-title>On estimating evolutionary probabilities of population variants</article-title>. <source>BMC Evol Biol</source>. <volume>19</volume>(<issue>1</issue>):<fpage>133</fpage> (<lpage>14 pp</lpage>.).<pub-id pub-id-type="pmid">31238981</pub-id></mixed-citation>
    </ref>
    <ref id="msab120-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Patel</surname><given-names>R</given-names></string-name>, <string-name><surname>Scheinfeldt</surname><given-names>LB</given-names></string-name>, <string-name><surname>Sanderford</surname><given-names>MD</given-names></string-name>, <string-name><surname>Lanham</surname><given-names>TR</given-names></string-name>, <string-name><surname>Tamura</surname><given-names>K</given-names></string-name>, <string-name><surname>Platt</surname><given-names>A</given-names></string-name>, <string-name><surname>Glicksberg</surname><given-names>BS</given-names></string-name>, <string-name><surname>Xu</surname><given-names>K</given-names></string-name>, <string-name><surname>Dudley</surname><given-names>JT</given-names></string-name>, <string-name><surname>Kumar</surname><given-names>S.</given-names></string-name></person-group><year>2018</year>. 
<article-title>Adaptive landscape of protein variation in human exomes</article-title>. <source>Mol Biol Evol</source>. <volume>35</volume>(<issue>8</issue>):<fpage>2015</fpage>–<lpage>2025</lpage>.<pub-id pub-id-type="pmid">29846678</pub-id></mixed-citation>
    </ref>
    <ref id="msab120-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stecher</surname><given-names>G</given-names></string-name>, <string-name><surname>Tamura</surname><given-names>K</given-names></string-name>, <string-name><surname>Kumar</surname><given-names>S.</given-names></string-name></person-group><year>2020</year>. 
<article-title>Molecular Evolutionary Genetics Analysis (MEGA) for macOS</article-title>. <source>Mol Biol Evol</source>. <volume>37</volume>(<issue>4</issue>):<fpage>1237</fpage>–<lpage>1239</lpage>.<pub-id pub-id-type="pmid">31904846</pub-id></mixed-citation>
    </ref>
    <ref id="msab120-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tamura</surname><given-names>K</given-names></string-name>, <string-name><surname>Battistuzzi</surname><given-names>FU</given-names></string-name>, <string-name><surname>Billing-Ross</surname><given-names>P</given-names></string-name>, <string-name><surname>Murillo</surname><given-names>O</given-names></string-name>, <string-name><surname>Filipski</surname><given-names>A</given-names></string-name>, <string-name><surname>Kumar</surname><given-names>S.</given-names></string-name></person-group><year>2012</year>. 
<article-title>Estimating divergence times in large molecular phylogenies</article-title>. <source>Proc Natl Acad Sci USA</source>. <volume>109</volume>(<issue>47</issue>):<fpage>19333</fpage>–<lpage>19338</lpage>.<pub-id pub-id-type="pmid">23129628</pub-id></mixed-citation>
    </ref>
    <ref id="msab120-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tamura</surname><given-names>K</given-names></string-name>, <string-name><surname>Peterson</surname><given-names>D</given-names></string-name>, <string-name><surname>Peterson</surname><given-names>N</given-names></string-name>, <string-name><surname>Stecher</surname><given-names>G</given-names></string-name>, <string-name><surname>Nei</surname><given-names>M</given-names></string-name>, <string-name><surname>Kumar</surname><given-names>S.</given-names></string-name></person-group><year>2011</year>. 
<article-title>MEGA5: molecular evolutionary genetic analysis using maximum likelihood, evolutionary distance, and maximum parsimony methods</article-title>. <source>Mol Biol Evol</source>. <volume>28</volume>(<issue>10</issue>):<fpage>2731</fpage>–<lpage>2739</lpage>.<pub-id pub-id-type="pmid">21546353</pub-id></mixed-citation>
    </ref>
    <ref id="msab120-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tamura</surname><given-names>K</given-names></string-name>, <string-name><surname>Stecher</surname><given-names>G</given-names></string-name>, <string-name><surname>Peterson</surname><given-names>D</given-names></string-name>, <string-name><surname>Filipski</surname><given-names>A</given-names></string-name>, <string-name><surname>Kumar</surname><given-names>S.</given-names></string-name></person-group><year>2013</year>. 
<article-title>MEGA6: molecular evolutionary genetics analysis version 6.0</article-title>. <source>Mol Biol Evol</source>. <volume>30</volume>(<issue>12</issue>):<fpage>2725</fpage>–<lpage>2729</lpage>.<pub-id pub-id-type="pmid">24132122</pub-id></mixed-citation>
    </ref>
    <ref id="msab120-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tao</surname><given-names>Q</given-names></string-name>, <string-name><surname>Tamura</surname><given-names>K</given-names></string-name>, <string-name><surname>Battistuzzi</surname><given-names>F</given-names></string-name>, <string-name><surname>Kumar</surname><given-names>S.</given-names></string-name></person-group><year>2019</year>. 
<article-title>A machine learning method for detecting autocorrelation of evolutionary rates in large phylogenies</article-title>. <source>Mol Biol Evol</source>. <volume>36</volume>(<issue>4</issue>):<fpage>811</fpage>–<lpage>824</lpage>.<pub-id pub-id-type="pmid">30689923</pub-id></mixed-citation>
    </ref>
    <ref id="msab120-B24">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Tao</surname><given-names>Q</given-names></string-name>, <string-name><surname>Tamura</surname><given-names>K</given-names></string-name>, <string-name><surname>Kumar</surname><given-names>S.</given-names></string-name></person-group><year>2020</year>. <chapter-title>Efficient methods for dating evolutionary divergences</chapter-title>. In: <person-group person-group-type="editor"><string-name><surname>Ho</surname><given-names>SYW</given-names></string-name></person-group>, editor. <source>The molecular evolutionary clock</source>. 
<publisher-loc>Switzerland</publisher-loc>: 
<publisher-name>Springer Nature</publisher-name>. p. <fpage>197</fpage>–<lpage>219</lpage>.</mixed-citation>
    </ref>
    <ref id="msab120-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tao</surname><given-names>Q</given-names></string-name>, <string-name><surname>Tamura</surname><given-names>K</given-names></string-name>, <string-name><surname>Mello</surname><given-names>B</given-names></string-name>, <string-name><surname>Kumar</surname><given-names>S.</given-names></string-name></person-group><year>2020</year>. 
<article-title>Reliable confidence intervals for RelTime estimates of evolutionary divergence times</article-title>. <source>Mol Biol Evol</source>. <volume>37</volume>(<issue>1</issue>):<fpage>280</fpage>–<lpage>290</lpage>.<pub-id pub-id-type="pmid">31638157</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
