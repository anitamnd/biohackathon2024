<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4893271</article-id>
    <article-id pub-id-type="publisher-id">980</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-016-0980-6</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MDSINE: Microbial Dynamical Systems INference Engine for microbiome time-series analyses</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Bucci</surname>
          <given-names>Vanni</given-names>
        </name>
        <address>
          <email>vanni.bucci@umassd.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tzen</surname>
          <given-names>Belinda</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Ning</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Simmons</surname>
          <given-names>Matt</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tanoue</surname>
          <given-names>Takeshi</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bogart</surname>
          <given-names>Elijah</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Deng</surname>
          <given-names>Luxue</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yeliseyev</surname>
          <given-names>Vladimir</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Delaney</surname>
          <given-names>Mary L.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Liu</surname>
          <given-names>Qing</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Olle</surname>
          <given-names>Bernat</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Stein</surname>
          <given-names>Richard R.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Honda</surname>
          <given-names>Kenya</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bry</surname>
          <given-names>Lynn</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Gerber</surname>
          <given-names>Georg K.</given-names>
        </name>
        <address>
          <email>ggerber@bwh.harvard.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2"/>
      </contrib>
      <aff id="Aff1"><label/>Department of Biology, Program in Biotechnology and Biomedical Engineering, University of Massachusetts Dartmouth, 285 Old Westport Road, N. Dartmouth, MA 02747 USA </aff>
      <aff id="Aff2"><label/>Massachusetts Host-Microbiome Center, Department of Pathology, Brigham and Women’s Hospital, Harvard Medical School, 221 Longwood Ave, Boston, MA 02115 USA </aff>
      <aff id="Aff3"><label/>RIKEN Center for Integrative Medical Sciences (IMS), Yokohama, Kanagawa 230-0045 Japan </aff>
      <aff id="Aff4"><label/>Vedanta Biosciences, 501 Boylston Street, Suite 6102, Boston, MA 02116 USA </aff>
      <aff id="Aff5"><label/>Department of Biostatistics and Computational Biology, Dana-Farber Cancer Institute, 450 Brookline Avenue, Boston, MA 02215 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>3</day>
      <month>6</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>3</day>
      <month>6</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2016</year>
    </pub-date>
    <volume>17</volume>
    <elocation-id>121</elocation-id>
    <history>
      <date date-type="received">
        <day>8</day>
        <month>12</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>6</day>
        <month>5</month>
        <year>2016</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Bucci et al. 2016</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p>Predicting dynamics of host-microbial ecosystems is crucial for the rational design of bacteriotherapies. We present MDSINE, a suite of algorithms for inferring dynamical systems models from microbiome time-series data and predicting temporal behaviors. Using simulated data, we demonstrate that MDSINE significantly outperforms the existing inference method. We then show MDSINE’s utility on two new gnotobiotic mice datasets, investigating infection with <italic>Clostridium difficile</italic> and an immune-modulatory probiotic. Using these datasets, we demonstrate new capabilities, including accurate forecasting of microbial dynamics, prediction of stable sub-communities that inhibit pathogen growth, and identification of bacteria most crucial to community integrity in response to perturbations.</p>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s13059-016-0980-6) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000185</institution-id>
            <institution>Defense Advanced Research Projects Agency</institution>
          </institution-wrap>
        </funding-source>
        <award-id>HR0011-15-C-0094</award-id>
        <principal-award-recipient>
          <name>
            <surname>Gerber</surname>
            <given-names>Georg K.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000062</institution-id>
            <institution>National Institute of Diabetes and Digestive and Kidney Diseases</institution>
          </institution-wrap>
        </funding-source>
        <award-id>P30DK034854</award-id>
        <principal-award-recipient>
          <name>
            <surname>Gerber</surname>
            <given-names>Georg K.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000050</institution-id>
            <institution>National Heart, Lung, and Blood Institute</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2T32HL007627-31</award-id>
        <principal-award-recipient>
          <name>
            <surname>Bogart</surname>
            <given-names>Elijah</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000060</institution-id>
            <institution>National Institute of Allergy and Infectious Diseases</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R15-AI112985-01A</award-id>
        <principal-award-recipient>
          <name>
            <surname>Bucci</surname>
            <given-names>Vanni</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id>
            <institution>National Science Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>1458347</award-id>
        <principal-award-recipient>
          <name>
            <surname>Bucci</surname>
            <given-names>Vanni</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2016</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Increasing evidence indicates that the microbiota is critical to normal host physiology and a driver of human disease when it is disrupted to cause dysbiosis. The microbiota is inherently dynamic [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>], starting with successive colonization of the infant and demonstrating day-to-day variability in the healthy adult due to environmental and other factors. These dynamics are driven by networks of multispecies interactions that involve competition for limited nutrients and attachment sites [<xref ref-type="bibr" rid="CR3">3</xref>], direct killing via bacteriocins [<xref ref-type="bibr" rid="CR4">4</xref>], growth support through secretion of extracellular enzymes or metabolites that other species can cross-feed on [<xref ref-type="bibr" rid="CR5">5</xref>], and a variety of other mechanisms.</p>
    <p>Therapeutic manipulation of the microbiota is currently an area of intense investigation as a possible treatment for infectious [<xref ref-type="bibr" rid="CR6">6</xref>], autoimmune, and other diseases. However, these efforts are hampered by limited methodologies for predicting dynamic behaviors of the microbiota when subjected to perturbations, including dietary changes, infections, and antibiotics. These perturbations can lead to dramatic shifts in microbial composition and even community collapse, which cannot be predicted without advances on existing computational analysis tools. Standard computational analysis methods for analyzing microbial community structures do not explicitly account for time-varying behavior, typically using correlational techniques [<xref ref-type="bibr" rid="CR7">7</xref>] to find undirected connections among bacteria, which cannot be used to predict dynamic behaviors of the ecosystem.</p>
    <p>Dynamical systems models provide an alternative and powerful framework for analyzing microbiome time-series data [<xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR10">10</xref>], with significant advantages over correlational techniques [<xref ref-type="bibr" rid="CR7">7</xref>], including the capability to forecast future system behaviors, to characterize formal properties such as stability, and to infer directed and causal relationships [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR11">11</xref>]. With standard numerical integration techniques [<xref ref-type="bibr" rid="CR12">12</xref>], however, these models are computationally intractable on large datasets. We previously presented an algorithm [<xref ref-type="bibr" rid="CR8">8</xref>] that does not require extensive or explicit numerical integration for inferring parameters of a dynamical systems model, the generalized Lotka-Volterra (gLV) differential equations, and demonstrated for the first time the capability to accurately forecast gut microbiota dynamics in animal and human studies [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR10">10</xref>]. The gLV model was subsequently successfully applied by other groups to analyzing microbiome time-series data [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR13">13</xref>]. Despite these prior innovations, existing algorithms suffer from major shortcomings, including their inability to estimate confidence in predictions and their lack of models of the statistical properties of high-throughput microbiome sequencing data [<xref ref-type="bibr" rid="CR14">14</xref>]; moreover, complete software packages have not been made available to the community.</p>
    <p>Here we present the Microbial Dynamical Systems INference Engine (MDSINE), an open source software package that performs all analysis steps from reading data files through to the generation of figures (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). MDSINE significantly extends our prior work by implementing: (a) a new technique for accurate estimation of microbial growth trajectories and gradients, specifically tailored for microbiome sequencing data that may be noisy and irregularly/sparsely sampled in time; (b) Bayesian [<xref ref-type="bibr" rid="CR15">15</xref>] methods for estimation of confidence in parameters, including connectivity in microbial interaction networks; and (c) biologically realistic constraints on model parameters. The software package provides users with several alternative inference algorithms and analysis options, enabling both exploratory and focused analyses. In the remainder of this article, we describe the MDSINE algorithms, demonstrate the performance of MDSINE on data simulated to mimic key properties of real microbiome studies, and finally apply our method to analysis of two new in vivo experimental datasets, illustrating the utility of our method for predicting the dynamics of infection with an enteric pathogen and investigating the stability of a probiotic cocktail.<fig id="Fig1"><label>Fig. 1</label><caption><p>Schematic of the MDSINE software, which provides a comprehensive toolbox for dynamical systems analyses of microbiota time-series data. MDSINE implements a new algorithm, Bayesian Adaptive Penalized Counts Splines (<italic>BAPCS</italic>), for estimating microbial growth concentrations (trajectories) and their changes over time (gradients) from sequencing data; optionally, gradients can instead be estimated using our previously described first-order difference method. The software implements three new algorithms for dynamical systems inference: maximum likelihood constrained ridge regression (<italic>MLCRR</italic>), Bayesian adaptive lasso (<italic>BAL</italic>), and Bayesian variable selection (<italic>BVS</italic>). Our previously published method [<xref ref-type="bibr" rid="CR8">8</xref>], the maximum likelihood unconstrained ridge regression algorithm (<italic>MLRR</italic>), is also implemented in MDSINE for comparison</p></caption><graphic xlink:href="13059_2016_980_Fig1_HTML" id="MO1"/></fig></p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>Overview of algorithms implemented in the software</title>
      <p>The MDSINE software (Fig. <xref rid="Fig1" ref-type="fig">1</xref>) provides a comprehensive toolbox for dynamical systems analyses of microbiota time-series data. MDSINE requires two inputs: (1) data measuring abundances of microbes over time in the ecosystems of interest, typically consisting of counts (e.g., high-throughput 16S rRNA sequencing data) that may be irregularly sampled temporally; and (2) data measuring overall microbial biomass over time in the ecosystem (e.g., universal 16S rRNA quantitative PCR (qPCR) data). The user may also optionally specify the temporal profiles of one or more experimental perturbations, such as a dietary change or antibiotic treatment. Note that data may include measurements for multiple subjects and subjects do not need to be sampled at the same time points. The same microbial taxa need not be present in all subjects, although a sufficient number of data points measuring dynamics of each taxon must be provided for accurate inference (see “<xref rid="Sec8" ref-type="sec">Discussion</xref>” section).</p>
      <p>MDSINE estimates microbial growth concentrations (trajectories) and their changes over time from the input data. These estimates are then used to infer the parameters of an extended gLV nonlinear ordinary differential equations model (see “<xref rid="Sec10" ref-type="sec">Methods</xref>”). Inferred parameters are then used to make predictions, including forecasts of microbial growth trajectories given starting microbe concentrations specified by the user, directed microbe–microbe interaction and perturbation effect networks, formal stability analyses providing predictions of which combinations of microbes will stably coexist and at what concentrations, and keystoneness analyses providing a quantitative measure of the marginal importance of each species in the ecosystem.</p>
      <p>In order to evaluate the performance of several alternative parameter inference approaches, we implemented four different algorithms in MDSINE (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). Two of the algorithms estimate model parameters using maximum likelihood-based techniques. The first of these algorithms, maximum likelihood ridge regression (MLRR) was previously presented by us [<xref ref-type="bibr" rid="CR8">8</xref>]; it is the only scalable and documented published method for microbial dynamical systems inference but was yet to be included in a publicly available software package. The second of the maximum likelihood-based algorithms, maximum likelihood constrained ridge regression (MLCRR), is a novel extension of the MLRR method that constrains bacterial growth rates and self-inhibition terms in the model to biologically realistic settings and uses an efficient method for inference based on quadratic programming (see “<xref rid="Sec10" ref-type="sec">Methods</xref>”).</p>
      <p>We developed novel Bayesian inference algorithms that provide additional functionality that the maximum likelihood-based techniques do not, namely: (1) estimates of error in inferences of dynamical systems parameters; and (2) statistical modeling of high-throughput sequencing count-based data over time. The first feature, as we demonstrate below, is particularly important for interpreting the relevance of microbial interactions and predictions of dynamics inferred from real microbiome time-series datasets. The second feature builds on substantial work by others demonstrating that greater accuracy can be achieved in analyses of high-throughput sequencing data by directly modeling count data [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR16">16</xref>]. Our approach, Bayesian Adaptive Penalized Counts Splines (BAPCS), uses a method similar to that employed by DESeq2 [<xref ref-type="bibr" rid="CR14">14</xref>] but extended for time-series data and allowing for irregular temporal sampling. The BAPCS algorithm is used to denoise the input microbiome time-series data, estimating the underlying growth trajectories and their gradients. These estimates then serve as input into two alternative Bayesian dynamical systems inference algorithms. The first of the two Bayesian inference algorithms, Bayesian Adaptive Lasso (BAL), is a regularization-based approach conceptually similar to the maximum likelihood ridge regression-based algorithms (MLRR and MLCRR) described above, but can: (a) potentially discriminate true interactions from noise better because it provides more shrinkage for coefficients that are close to zero [<xref ref-type="bibr" rid="CR17">17</xref>]; (b) is more flexible, as it allows for different degrees of regularization on each interaction coefficient [<xref ref-type="bibr" rid="CR9">9</xref>]; and (c) is fully Bayesian, providing estimates of variability for all parameters in the model. The second of the two Bayesian inference algorithms, Bayesian Variable Selection (BVS), uses an alternative approach to the regularization-based methods (MLRR, MLCRR, and BAL) by directly modeling the presence/absence of microbe–microbe interactions or microbe–perturbation effects. We were interested in evaluating a variable selection approach against the regularization-based methods, as variable selection techniques have been shown to reduce bias in model estimates in many settings [<xref ref-type="bibr" rid="CR18">18</xref>]. Moreover, our BVS algorithm allows for direct inference of the underlying qualitative network of bacterial interactions that is of biological interest. See “<xref rid="Sec10" ref-type="sec">Methods</xref>” and Additional file <xref rid="MOESM2" ref-type="media">2</xref> for a complete description of the Bayesian algorithms.</p>
    </sec>
    <sec id="Sec4">
      <title>Validation on simulated ground-truth data</title>
      <p>Ground-truth information is necessary for fully benchmarking the inferential and predictive capabilities of an algorithm. However, the availability of such data is currently too limited for microbial dynamical systems. Thus, we simulated data from an in silico microbial dynamical systems model that captures key features of real microbiome experiments to benchmark and validate MDSINE (see “<xref rid="Sec10" ref-type="sec">Methods</xref>” for complete details). Briefly, we mimicked key features of real microbiome time-series data including noisy count-based measurements with different sequencing depths and assuming compositionality of data [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR20">20</xref>], variability among subjects, limited temporal sampling resolutions, and a pathogen being introduced into a pre-existing microbiota. Repeated random sampling was used to generate different initial conditions and to add noise to the simulated measurements. The simulated data were then used to evaluate several metrics of algorithm performance, including: (a) accuracy of growth rates and interaction coefficients estimates; (b) accuracy of inference of presence/absence of microbial interactions (network structure); and (c) accuracy of prediction of microbial concentrations over time given initial conditions not previously seen by the algorithm.</p>
      <p>Overall, the three new MDSINE algorithms (MLCRR, BAL, and BVS) outperformed our previous method (MLCRR) on all metrics (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). The two Bayesian algorithms (BAL and BVS) showed the greatest robustness to lower sequencing depths and lower resolutions of temporal sampling and demonstrated particularly strong performance on inferring microbial interaction parameters and the underlying network. In contrast, both MLRR and MLCRR as well as standard Spearman correlation analyses (area under the curve (AUC) of 0.53 in the best case) had very poor performance on the underlying network inference task for all simulation regimes (Fig. <xref rid="Fig2" ref-type="fig">2d</xref>).<fig id="Fig2"><label>Fig. 2</label><caption><p>New inference algorithms in MDSINE outperform our previously published method on simulated data. Data were simulated to capture key features of real microbiome surveys, including noise and compositionality. Simulations assumed an underlying dynamical systems model with ten species observed over 30 days and an invading species at day 10. The number of time points sampled was varied between 8 and 27 to mimic common experimental designs and sequencing depths of 1000 or 25,000 reads were evaluated. Performance of the four MDSINE inference algorithms, maximum likelihood ridge regression (MLRR), maximum likelihood constrained ridge regression (MLCRR), Bayesian adaptive lasso (BAL), and Bayesian variable selection (BVS), were compared. Algorithm performance was assessed using four different metrics: root mean square error (RMSE) for microbial growth rates (<bold>a</bold>); RMSE for microbial interaction parameters (<bold>b</bold>); RMSE for prediction of microbe trajectories on held-out subjects given only initial microbe concentrations for the held-out subject (<bold>c</bold>); and area under the receiver operator curve (AUC ROC) for the underlying microbial interaction network (<bold>d</bold>). Lower RMSE values indicate superior performance, whereas higher AUC ROC values indicate superior performance</p></caption><graphic xlink:href="13059_2016_980_Fig2_HTML" id="MO2"/></fig></p>
      <p>Performance on the microbial concentration prediction task was most affected by sequencing depth and temporal sampling resolution for all the MDSINE algorithms, whereas estimation of growth rates and interaction coefficients were less affected. To investigate the effects of read depth further, we performed simulations over a range of read depths from 200 sequences per sample (very suboptimal) to 25,000 sequences per sample. These simulations (Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Figure S1) showed that performance on all metrics, and in particular the microbial concentration prediction metric, did improve with greater read depths for all MDSINE algorithms but essentially saturated at 5000 sequences per sample. These results suggest that the MDSINE inference procedures are robust to compositionality constraints in data and, moreover, maintain robustness even at low sequencing depths. This robustness may in part be due to MDSINE’s capability to leverage continuity over time to compensate for noise in data.</p>
      <p>We also investigated whether connectivity (in-degree) or growth rates of the simulated taxa affected the microbial concentration prediction task. No clear relationship was evident in the case of in-degree. Positive correlations between growth rates of taxa and the ability to forecast their concentrations were seen for all the MDSINE algorithms, suggesting that the algorithms may predict trajectories of faster-growing bacteria with more accuracy in some ecosystems. However, these correlations did not reach statistical significance (Spearman correlation, <italic>p</italic> values for BAL, BVS, MLRR, and MLCRR of 0.30, 0.35, 0.33, and 0.30, respectively).</p>
    </sec>
    <sec id="Sec5">
      <title>Validation against new experimental datasets</title>
      <p>We next validated the performance of MDSINE on two new experimental datasets with several necessary or desirable properties for algorithm evaluation. First, frequent temporal sampling (26–56 time points) was performed to support accurate inference of dynamics [<xref ref-type="bibr" rid="CR2">2</xref>]. Second, microbial ecosystems were perturbed rather than just observed over time. Third, concentrations of bacteria were measured rather than just relative abundances; these measurements are particularly important for studying infections and other perturbations that may alter the bacterial biomass [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. Finally, although not essential for application of our method, we used gnotobiotic experimental systems to ensure that strains could be tracked unequivocally in vivo over time.</p>
    </sec>
    <sec id="Sec6">
      <title><italic>Clostridium difficile</italic> infection experiments</title>
      <p>Our first experimental dataset evaluated the dynamics of infection with <italic>Clostridium difficile</italic> [<xref ref-type="bibr" rid="CR10">10</xref>] (Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Figure S2), a pathogen that causes significant morbidity and mortality in humans. We employed a gnotobiotic mouse model in which animals were pre-colonized with human commensal bacterial type strains, termed the GnotoComplex microflora, chosen to capture the phylogenetic diversity and key physiologic capabilities of a native gut microflora, including metabolism of complex polysaccharides and bile acid transformations (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2 and “Methods” for details). After allowing 28 days for the commensal microbiota to establish, we infected mice with <italic>C. difficile</italic> spores and monitored the animals for an additional 28 days. Mice had diarrhea and showed signs of moderate distress within 3 days of <italic>C. difficile</italic> infection but all exhibited full clinical recovery within 10 days. Throughout the 56-day experiment, 26 fecal samples per mouse were collected and interrogated via high-throughput 16S rRNA sequencing to determine abundances of species and 16S rRNA qPCR using universal primers to estimate the total bacterial biomass present.</p>
      <p>The temporal sampling scheme for this experiment was designed based on our prior experience with kinetics of enteric infections in mouse models [<xref ref-type="bibr" rid="CR21">21</xref>] and response of the microbiota to perturbations [<xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR23">23</xref>]. Our analyses of these prior studies using our MC-TIMME algorithm indicated that OTUs that change in abundance after a perturbation will generally first show detectable changes within a window of 1–3 days and reach steady-state within 2 weeks. Thus, our general approach to designing time-series studies of the microbiota, subject to economic and logistic constraints that prevent sampling every day over the entire time course, is to sample at least daily for 4 days post-perturbation, then reduce sampling to every 2 days up to 2 weeks post-perturbation, and then reduce sampling to every 3–4 days thereafter until the next perturbation (if any).</p>
      <p>We assessed predictive performance of MDSINE on the <italic>C. difficile</italic> infection data using a hold-one-subject-out cross-validation procedure. In this procedure, MDSINE was run on all data from all but one of the mice (the held-out subject) and model parameters were inferred. Using the inferred model parameters and the measured concentrations of the microbiota at an initial time point for the held-out mouse, the trajectory of concentrations of <italic>C. difficile</italic> for that mouse was then forecast for all the remaining time points using numerical integration. This procedure was repeated for each mouse in turn and predictive performance was evaluated as the root mean square error (RMSE) between the predicted trajectory and the actual data (see “<xref rid="Sec10" ref-type="sec">Methods</xref>” for details). The new algorithms in MDSINE outperformed our previous method on this task, with the Bayesian algorithms showing the strongest performance (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3) with RMSEs of 0.56 and 0.66 colony forming units (CFUs)/g stool. These error rates in predictions, corresponding to about a half log in CFU/g, are close to variability in measurements we have observed with traditional culture-based techniques and due to differences in sample handling [<xref ref-type="bibr" rid="CR21">21</xref>] and thus represent strong predictive performance in terms of realistic biological systems.</p>
      <p>We next used MDSINE to infer the underlying qualitative network of microbe–microbe interactions from the complete dataset (Fig. <xref rid="Fig3" ref-type="fig">3a</xref>). The resulting network strongly predicts the presence of 23 interactions among species (Bayes factor ≥10), including inhibition of <italic>C. difficile</italic> by <italic>Clostridium scindens</italic> and <italic>Roseburia hominis</italic>. A <italic>C. scindens</italic> inhibitory effect against <italic>C. difficile</italic> mediated by the alteration of host bile acid composition has previously been demonstrated in conventional mice [<xref ref-type="bibr" rid="CR10">10</xref>], providing confirmatory evidence that MDSINE can detect causal interactions from longitudinal microbiota data.<fig id="Fig3"><label>Fig. 3</label><caption><p>Application of MDSINE to an experimental dataset evaluating the dynamics of <italic>Clostridium difficile</italic> infection in gnotobiotic mice. Germ-free mice were pre-colonized with the GnotoComplex microflora, a mixture of human commensal bacterial type strains chosen to capture the phylogenetic diversity and key physiologic capabilities of a native gut microflora. After the commensal microbiota were allowed to establish for 28 days, mice were infected with <italic>C. difficile</italic> spores and monitored for an additional 28 days. Throughout the experiment, 26 fecal samples per mouse were collected and interrogated via high-throughput 16S rRNA sequencing to determine abundances of species and 16S rRNA qPCR using universal primers to estimate the total bacterial biomass present. <bold>a</bold> Predicted directed microbe–microbe interaction network. <italic>Edge thickness</italic> denotes the magnitude of the evidence favoring presence of the interaction (Bayes factors [<xref ref-type="bibr" rid="CR35">35</xref>]); only edges with strong evidence (Bayes factor ≥10) are displayed. <bold>b</bold> Predicted stable combinations of strains for each possible size of sub-community that optimally inhibit <italic>C. difficile</italic> colonization. Each <italic>row</italic> depicts the sub-community (combination of commensal strains) of a given size that is predicted to stably colonize the gut in the absence of the pathogen and is predicted to maximally inhibit <italic>C. difficile</italic> infection at the experimental end point (28 days). <italic>CDI median</italic> predicted median concentration of <italic>C. difficile</italic> at 28 days, <italic>CDI mad</italic> predicted absolute deviation of the median of the <italic>C. difficile</italic> concentration at 28 days</p></caption><graphic xlink:href="13059_2016_980_Fig3_HTML" id="MO3"/></fig></p>
      <p>In order to predict which bacterial compositions optimally confer resistance against <italic>C. difficile</italic> infection, we used MDSINE to predict the stability and <italic>C. difficile</italic> inhibitory capacity of all subsets of the commensal strains (Fig. <xref rid="Fig3" ref-type="fig">3b</xref>). We began by calculating which of the 2<sup>13</sup> − 1 possible bacterial combinations were predicted to have biologically meaningful steady-state concentrations (non-negative values). Steady states with a probability of stability &gt;90 % were further analyzed using numerical integration starting with the predicted concentrations and adding a simulated <italic>C. difficile</italic> challenge of 10<sup>5</sup> CFU/g, corresponding to a high infectious dose (see “<xref rid="Sec10" ref-type="sec">Methods</xref>” for details). Combinations of bacteria displayed in Fig. <xref rid="Fig3" ref-type="fig">3b</xref> represent those (for all strains in the defined microbiota down to one strain) that led to the minimal median predicted concentrations of <italic>C. difficile</italic> at 28 days, the duration of our actual experiment. Intriguingly, MDSINE predicted that the smallest stable sub-community capable of excluding <italic>C. difficile</italic> with probability &gt;90 % requires just three organisms (<italic>R. hominis</italic>, <italic>B. fragilis</italic>, and <italic>C. hiranonis</italic>). Interestingly, although MDSINE predicts similar colonization resistance for larger communities (all of them including the stable three-species sub-community), the stability probability decreases somewhat for the larger communities.</p>
      <p>It is of interest to understand whether bacterial biomass data are necessary for inference of bacterial interaction networks, or at least if less frequent biomass measurements would suffice, given that biomass has not been routinely measured in many microbiome studies. To test the necessity of biomass data for the <italic>C. difficile</italic> experiments, we replaced biomass measurements with the average value across all mice and all time points, hence providing no useful information on biomass to MDSINE. This “no biomass” inference resulted in an AUC value of 0.76 when compared with the “reference” network inferred using all biomass data. The “no biomass network” had no incoming edges for <italic>C. difficile</italic> with strong evidence (Bayes factors ≥10) but edges for <italic>C. scindens</italic> and <italic>R. hominis</italic> interactions still had borderline Bayes factors of 7.7 and 3.0, respectively. We additionally tested whether our BAPCS algorithm could be used to improve network inference, by interpolating bacterial biomass values, in the scenario in which bacterial biomass was sampled less frequently than bacterial relative abundances. For this test, we hid either six or ten biomass measurements, with time points chosen using the scheme discussed above that prioritizes sampling around perturbations. When six biomass measurements were hidden, the inferred bacterial interaction network was almost identical to the “reference” network (AUC = 0.93), whereas when ten biomass measurements were hidden, performance degraded to the level of the “no biomass” network (AUC = 0.74). These results suggest that many edges of the bacterial interaction network can still be accurately inferred in the absence of biomass data but that biomass data do provide important additional information. Further, our method can be used to interpolate biomass measurements to some extent, allowing for less frequent biomass sampling, but performance dropped off dramatically beyond about 25 % missing measurements.</p>
      <sec id="Sec7">
        <title>Probiotic cocktail colonization and stability experiments</title>
        <p>Our second experimental dataset evaluated the dynamics of colonization of gnotobiotic mice with a probiotic bacterial cocktail and subsequent effects of a dietary perturbation (Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Figure S3). We recently described a set of Clostridia strains (VE-202) that are potent inducers of regulatory T cells (Tregs) and suppressors of inflammation [<xref ref-type="bibr" rid="CR24">24</xref>] and are now being investigated for treatment of inflammatory bowl diseases. To characterize stability and robustness properties of the VE-202 cocktail, we colonized germ-free mice with 13 members of the cocktail and alternated mice between a standard high-fiber diet and a low-fiber dietary perturbation. These dietary shifts were enforced for two reasons. First, accurate model inference requires a sufficient number of non-equilibrium observations, which we expected to achieve with a short dietary perturbation per our previous work demonstrating broad responses to dietary shifts in the microbiota with taxon-dependent kinetics [<xref ref-type="bibr" rid="CR22">22</xref>]. Second, we were interested in whether abundances of the probiotic cocktail organisms would be appreciably shifted with a change to a low-fiber diet, which more closely mimics aspects of a human diet.</p>
        <p>Over the nine-week experiment, 56 fecal samples per mouse were collected (daily sampling with some exceptions for logistical reasons). Bacterial concentrations were measured using strain-specific qPCR primers to estimate concentrations of the microbes (see “<xref rid="Sec10" ref-type="sec">Methods</xref>”; Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4). Note that for these experiments total bacterial biomass was not measured independently, unlike for the <italic>C. difficile</italic> infection experiments that combined taxa relative abundance data from 16S rRNA amplicon sequencing with total bacterial biomass estimated using 16S rRNA universal primers.</p>
        <p>We again evaluated the ability of MDSINE to predict microbial growth concentrations using a hold-one-subject-out cross-validation procedure. In this procedure, MDSINE was run on all data from all but one of the mice (the held-out subject) and model parameters were inferred. Using the inferred model parameters (including for the applied dietary perturbation) and the measured concentrations of the microbiota at an initial time point for the held-out mouse, the trajectories of concentrations of the microbiota for that mouse were then forecast for all the remaining time points using numerical integration. Figure <xref rid="Fig4" ref-type="fig">4a, b</xref> and Additional file <xref rid="MOESM6" ref-type="media">6</xref>: Figure S4 display examples of inferred parameter distributions and predicted trajectories. Interestingly, for this dataset we found no significant differences between the new MDSINE algorithms and our prior algorithm with respect to prediction error (Table S3).<fig id="Fig4"><label>Fig. 4</label><caption><p>Application of MDSINE to an experimental dataset evaluating stability of a probiotic cocktail in gnotobiotic mice. Germ-free mice were inoculated with 13 Clostridia strains from the VE-202 cocktail, a mixture of bacteria previously shown to be Treg inducers [<xref ref-type="bibr" rid="CR24">24</xref>]. Over the 9-week experiment, mice were alternated between a standard high-fiber diet and a low-fiber dietary perturbation. We collected 56 fecal samples per mouse and these were interrogated using strain-specific qPCR primers to estimate strain concentrations. <bold>a</bold> Example of inferred growth and interaction parameters and their variability. The <italic>top grid</italic> displays mean parameter estimates and the <italic>bottom grid</italic> displays standard deviations of parameter estimates. Strains are ordered by their mean estimated growth rates on the standard diet. <italic>Pert.</italic> perturbation effect, <italic>St.</italic> strain. <bold>b</bold> Example forecasts of microbial concentration trajectories. Forecasts were obtained using a hold-one-subject-out procedure. Briefly, MDSINE was run on all data from all but one of the mice (the held-out subject) and model parameters were inferred. Using the inferred model parameters (including for the perturbation) and the measured concentrations of the microbiota at an initial time point for the held-out mouse, the trajectories of the microbiota for the held-out mouse were then forecast for all the remaining time points; the procedure was repeated for each mouse. <italic>Solid lines</italic> denote predicted trajectories and <italic>circles</italic> denote data. <bold>c</bold> Keystoneness analyses for high-fiber (<italic>top</italic>) and low-fiber (<italic>bottom</italic>) diets. <italic>Rows</italic> represent all possible stable states in which each strain has been removed in turn and the others are present (if that configuration is stable). The <italic>grid</italic> displays predicted steady-state concentrations of strains (log<sub>10</sub> ng strain DNA/μg total fecal DNA), with <italic>white entries</italic> indicating absent strains. <italic>Ky</italic> keystoneness, a measure assessing the marginal predicted quantitative effect of removing each strain from the full community, with larger values indicating greater effects on the overall ecosystem</p></caption><graphic xlink:href="13059_2016_980_Fig4_HTML" id="MO4"/></fig></p>
        <p>We used MDSINE to predict the contribution of each member of our bacterial probiotic cocktail to the maintenance of stability and community structure in the presence and absence of the dietary perturbation. Intriguingly, we found that while the low-fiber diet clearly alters the concentrations of many strains in the cocktail, this perturbation does not significantly change the overall stable biodiversity profile of the cocktail (Additional file <xref rid="MOESM7" ref-type="media">7</xref>: Figure S5). To quantify the importance of each strain in maintaining stable community structure, we applied a new measure that we term keystoneness (Fig. <xref rid="Fig4" ref-type="fig">4c</xref>). This measure assesses the marginal predicted quantitative effect of removing each strain from a bacterial community (see “<xref rid="Sec10" ref-type="sec">Methods</xref>” for details). On the high-fiber diet, strain 15 (closest known taxon, <italic>Clostridium asparagiforme</italic>) exhibited the largest keystoneness value (Fig. <xref rid="Fig4" ref-type="fig">4c</xref>, top). Interestingly, MDSINE predicts that, for the low-fiber diet, strain 15 cannot be present if the community is to remain stable and strain 14 (closest known taxon, <italic>Ruminococcus</italic> sp. ID8) attains the highest keystoneness value (Fig. <xref rid="Fig4" ref-type="fig">4c</xref>, bottom). We note that strains 14 and 15 do not have significantly greater connectivity in the inferred qualitative network structure (Additional file <xref rid="MOESM8" ref-type="media">8</xref>: Figure S6), suggesting that the central roles of these species would not be uncovered using standard qualitative measures for finding keystone species [<xref ref-type="bibr" rid="CR13">13</xref>].</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Discussion</title>
    <p>Studies of temporal dynamics of the microbiota coupled to experimental interventions are essential to move beyond descriptive associations to causal mechanisms and, ultimately, to rationally design approaches to manipulate the microbiota to achieve precise and durable therapeutic benefits. However, analysis of data from such studies has been hampered by a lack of appropriate computational tools. In this work, building on our previous research, we present a set of new algorithms implemented in an open-source, actively maintained software package that allows users to infer dynamical systems models from high-throughput microbiome data and generate precise quantitative predictions about the temporal dynamics and stability of the microbial ecosystems.</p>
    <p>To showcase the potential of our method for generating quantitative predictions and testable hypotheses in the context of enteric infections and probiotic cocktail design, we applied our framework to two new datasets generated in our labs. For the first dataset, we conducted massive simulations to determine microbiota combinations predicted to maximize inhibition of the pathogen, <italic>C. difficile</italic>. MDSINE predicted that a community as small as three species, <italic>R. hominis</italic>, <italic>B. fragilis</italic>, and <italic>C. hiranonis</italic>, has the capacity to provide colonization resistance against <italic>C. difficile.</italic> This result highlights the importance of considering quantitative and indirect effects in microbial interaction networks [<xref ref-type="bibr" rid="CR25">25</xref>] as only <italic>R. hominis</italic> is predicted to directly inhibit <italic>C. difficile</italic> whereas the other species in the sub-community are predicted to indirectly support growth of <italic>R. hominis</italic> (Fig. <xref rid="Fig3" ref-type="fig">3a</xref>). Interestingly, MDSINE predicts that larger communities have somewhat lower stability probabilities than the three-species community, suggesting that larger communities may have greater numbers of destabilizing interactions in the network. Overall, these results, which suggest new strategies for rational design of bacteriotherapies [<xref ref-type="bibr" rid="CR6">6</xref>] for <italic>C. difficile</italic> infection, demonstrate the unique probabilistic and quantitative predictive capabilities of the MDSINE framework.</p>
    <p>For our second experimental dataset, we evaluated the stability to dietary changes of a probiotic commensal bacterial cocktail under investigation for treatment of inflammatory bowel disease (IBD). Diet is an acknowledged but poorly defined modulator in IBD, with dietary factors directly interacting with both epithelial and immune cells and indirectly affecting immune homeostasis by modulating the intestinal microbiota [<xref ref-type="bibr" rid="CR26">26</xref>]. Moreover, dietary treatments for IBD are often recommended by clinicians or self-initiated by patients [<xref ref-type="bibr" rid="CR27">27</xref>]. For these reasons, any probiotic cocktail for IBD treatment must be capable of withstanding changing dietary regimes. Application of MDSINE to data from our gnotobiotic mouse model measuring changes in concentrations of strains in a probiotic cocktail subjected to dietary shifts intriguingly suggests different ecological roles of the strains in maintaining community structure depending on the dietary context. These results highlight the complexity of probiotic design and showcase the unique capabilities of MDSINE for this application to exploit dynamical systems methods to tackle a per se combinational design problem to efficiently and rationally choose among probiotic compositions.</p>
    <p>On both simulated and real experimental data, our new algorithms generally outperformed our previous method. Our new algorithms all constrain model parameters to biologically realistic values (non-negative growth rates and negative self-regulation effects), which accounts for some of the improvements in performance, particularly between the MLCR and MLCRR algorithms that differ only in this aspect. The algorithms also handled compositionality of data well, even with quite low read depths, which is likely due in part to their ability to exploit time-series information fully to estimate microbial populations (e.g., temporally adjacent samples can compensate for error), in contrast to standard static analysis methods that effectively treat each sample separately.</p>
    <p>The Bayesian algorithms generally exhibited superior performance, likely due to a combination of their directly modeling noisy count data and their using inference methods that help to reduce bias in parameter estimates. Additionally, we found that the Bayesian methods provided much more reliable estimates of variability in parameters, particularly for the task of inferring underlying bacterial interaction networks. In principle, parameter variability can be estimated within maximum likelihood-based frameworks (Additional file <xref rid="MOESM2" ref-type="media">2</xref>), but we found these estimates to be quite poor. Interestingly, on one task, prediction of held-out trajectories for our probiotic stability dataset, the Bayesian algorithms did not have significantly better performance than the other methods. This dataset had very dense (daily or every other day) temporal sampling and used qPCR measurements to quantify strain concentrations. As discussed, the Bayesian methods were specifically designed to handle irregularly and sparsely temporally sampled sequencing count data and so apparently lost some of their advantages when these features were not present. However, the capability of the Bayesian methods to estimate parameter variability for this dataset was still important, as demonstrated with the keystoneness/stability results that use this information to substantially limit the number of states considered.</p>
    <p>MDSINE models concentrations of micro-organisms rather than relative abundances, which requires estimates of the total microbial biomass in the ecosystem under study. In our <italic>C. difficile</italic> infection or probiotic cocktail experiments, we estimated total bacterial biomass via qPCR either with 16S rRNA universal primers or with strain-specific primers. These methods are susceptible to primer bias and other PCR-related issues; alternative methods, such as flow cytometry [<xref ref-type="bibr" rid="CR28">28</xref>], could overcome some of these difficulties. However, most existing microbiome studies do not include any measurement of total microbial biomass. Can MDSINE still be applied to these data? In some cases, total microbial biomass is unlikely to change appreciably over the course of a study, such as in adult populations undergoing mild dietary shifts. For these cases, MDSINE can be run on just relative abundance data (e.g., 16S rRNA amplicon sequencing data) with the assumption that biomass is constant. In other cases, such as studies of initial colonization of the gut, total microbial biomass is assuredly changing and the assumption of constant total microbial biomass would be erroneous. For other studies, such as antibiotic exposures, infections, or major dietary shifts, the effect on total microbial biomass is not clear a priori. For our <italic>C. difficile</italic> infection dataset, as described in the “Results” section, many bacterial interactions could still be inferred under the assumption of constant bacterial biomass, but some key interactions were lost or evidence of their existence was substantially weakened. For these reasons, we would advocate for measuring total bacterial biomass in future longitudinal microbiome studies, at least in pilot phases, to determine whether biomass changes significantly.</p>
    <p>In terms of runtime, the algorithms in MDSINE can feasibly scale to ecosystems with considerably more taxa than analyzed in the present work because they approximate the dynamical systems inference problem with linear systems of equations. The challenge of scaling to more complex ecosystems, therefore, is not primarily computational but is limited by data: an ecosystem with <italic>N</italic> taxa has <italic>N</italic><sup><italic>2</italic></sup><italic>–N</italic> potential interactions, requiring <italic>O(N</italic><sup><italic>2</italic></sup><italic>)</italic> informative data points to reliably estimate parameters in the absence of regularization or sparsity assumptions. Regularization and sparsity techniques implemented in MDSINE reduce these data requirements, as demonstrated in our simulation studies showing negligible loss of inference accuracy on key metrics even with &gt;50 % data reduction. However, it is important to understand that measurements must be obtained under perturbations of the ecosystem, as multiple measurements at the same steady-state value will not contribute multiple highly informative data points [<xref ref-type="bibr" rid="CR2">2</xref>]. For these reasons, as a broad guideline and assuming reductions in data requirements from regularization or sparsity assumptions as described, we recommend studies include perturbations and collect a minimum of <italic>N</italic><sup><italic>2</italic></sup>/2 total data points (e.g., for a study with five subjects and 13 OTUs to be modeled, at least 17 time points per subject). For users of MDSINE studying complex microbial ecosystems with larger numbers of OTUs, we suggest modeling a smaller number of key OTUs or higher taxonomic groups (e.g., 10–20); we and others have successfully demonstrated this approach using the gLV model in prior publications [<xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR10">10</xref>].</p>
    <p>Our approach has several limitations that suggest areas for future work. First, the underlying gLV dynamical systems model for MDSINE captures only pairwise microbe–microbe interactions and the effects of defined perturbations with relatively simple kinetics. Despite these limitations, we and others have demonstrated the surprisingly good performance of this model for analyzing complex host–microbial ecosystems [<xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR13">13</xref>]. Moreover, the inference framework for MDSINE is quite general and could in the future support richer models of dynamics that incorporate factors such as host immune responses, metabolites, environmental effects, and nonparametric models of dynamics. Second, our method relies on a series of approximations to the underlying dynamical systems model. Our simulation studies demonstrate that this approximation generally works well; however, techniques to further improve these approximations, such as the use of Gaussian Processes [<xref ref-type="bibr" rid="CR29">29</xref>], are an interesting area for future work on MDSINE. Third, we demonstrated application of MDSINE to gnotobiotic animal datasets with microbiota of limited diversity. As discussed, these datasets provided important features that facilitated evaluation of our algorithms and interpretability of the results. However, the microbiota of humans and conventional animals are considerably more complex and present additional analytical challenges. Extensions to MDSINE to automatically reduce the complexity of these ecosystems—for instance, by grouping together OTUs with similar dynamics while still maintaining predictive accuracy—is an interesting direction for future research. Finally, our experimental datasets rely on fecal sampling, which may not accurately reflect microbial populations in the gut, in particular for species that predominantly reside in regions upstream of the colon [<xref ref-type="bibr" rid="CR21">21</xref>]. Measurements of total bacterial biomass from fecal samples also may not be representative of biomass in the gut if the density of stool changes significantly throughout the experiment, such as with severe diarrhea. There is also increasing recognition of the importance of the spatial organization of the microbiota (e.g., [<xref ref-type="bibr" rid="CR30">30</xref>]) that will not be reflected in fecal samples. Future studies that obtain longitudinal samples of tissues in different regions of the gut will be important to more fully model and understand these incredibly rich ecosystems.</p>
  </sec>
  <sec id="Sec9">
    <title>Conclusions</title>
    <p>MDSINE provides a new toolbox that will have broad applicability to studies of microbial dynamics, enabling robust analyses based on quantitative predictions and formal dynamical systems theory as demonstrated on our simulated and new experimental validation datasets. Our open-source software package implements new methods that not only outperform previous approaches but also provides novel functionality, including capabilities to estimate confidence in model parameters and predicted dynamics. Application of MDSINE to two new gnotobiotic experimental datasets demonstrates the capability to generate predictive hypotheses that standard microbiome analysis methods cannot and, moreover, suggests new strategies for rational design of bacteriotherapies.</p>
  </sec>
  <sec id="Sec10">
    <title>Methods</title>
    <sec id="Sec11">
      <title>Software availability</title>
      <p>The Microbial Dynamical Systems INference Engine (MDSINE) is available as an open-source package including MATLAB source code and standalone executables for Mac OS X, Linux and Windows. The software reads formatted input data (strain counts table, total bacterial biomass measurements, and relevant metadata; see the repository instructions and manual for further details—links provided in the “Availability of data and materials” section), then infers dynamical systems models. Further analyses using the inferred models are supported in MDSINE, including predictions of qualitative interaction networks, trajectories, stable states, and keystoneness. R-utility scripts are provided in the package for visualizations of these analyses.</p>
    </sec>
    <sec id="Sec12">
      <title>Mathematical model overview</title>
      <p>We use the extended generalized Lotka-Volterra (gLV) equations as previously described [<xref ref-type="bibr" rid="CR8">8</xref>] for the underlying model of microbial dynamics. For the gLV model for <italic>L</italic> OTUs measured in <italic>S</italic> subjects, the rate of change of the concentration of OTU <italic>l</italic> in subject <italic>s</italic> is expressed as: <disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \frac{d{f}_{ls}}{dt}={\alpha}_l{f}_{ls}(t)+{\displaystyle \sum_{j=1}^L{\beta}_{lj}{f}_{ls}(t){f}_{js}(t)+{\displaystyle \sum_{p=1}^P{\gamma}_{lp}{f}_{ls}(t)}}{u}_p(t) $$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>P</mml:mi></mml:munderover><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math><graphic xlink:href="13059_2016_980_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>The <italic>α</italic> parameters represent unbounded growth rates, the <italic>β</italic> parameters represent pair-wise microbe-microbe interactions, and the <italic>γ</italic> parameters represent effects of <italic>P</italic> perturbations. The functions <italic>u</italic><sub><italic>p</italic></sub><italic>(t)</italic> are binary-valued, indicating if the given perturbation is present at time <italic>t</italic>. Unlike in our previous approach [<xref ref-type="bibr" rid="CR8">8</xref>], which did not assume constraints on the parameters, here we assume positive growth rates and negative self-interaction rates, i.e., <italic>α</italic> &gt; 0 and <italic>β</italic><sub><italic>ll</italic></sub> &lt; 0. These constraints enforce the biologically realistic assumption of logistic growth in the absence of interactions, i.e., growth up to a finite carrying capacity of the ecological system.</p>
      <p>We use a “gradient matching” approach to estimate the ODE parameters. The concept underlying this approach is that if estimates of the gradient and trajectory values are available, parameters can be estimated by solution of systems of equations rather than systems of differential equations. In the case of the gLV model, the “gradient matching” system of equations is linear, and can be written as:<disp-formula id="Equb"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \frac{d{f}_{ls}}{dt}\approx {\widehat{f}}_{lst}^{\prime}\approx {\alpha}_l{\widehat{f}}_{lst}+{\displaystyle \sum_{j=1}^L{\beta}_{lj}{\widehat{f}}_{lst}{\widehat{f}}_{jst}+{\displaystyle \sum_{p=1}^P{\gamma}_{lp}{\widehat{f}}_{lst}}}{u}_p(t) $$\end{document}</tex-math><mml:math id="M4" display="block"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>≈</mml:mo><mml:msubsup><mml:mrow><mml:mover><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:mo>≈</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>P</mml:mi></mml:munderover><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math><graphic xlink:href="13059_2016_980_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Here, <inline-formula id="IEq1"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\widehat{f}}_{lst} $$\end{document}</tex-math><mml:math id="M6" display="block"><mml:msub><mml:mrow><mml:mover><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2016_980_Article_IEq1.gif"/></alternatives></inline-formula> represents an estimate of the concentration of OTU <italic>l</italic> in subject <italic>s</italic> at time point <italic>t</italic> and <inline-formula id="IEq2"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\widehat{f}}_{lst}^{\prime } $$\end{document}</tex-math><mml:math id="M8" display="block"><mml:msubsup><mml:mrow><mml:mover><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_980_Article_IEq2.gif"/></alternatives></inline-formula> represents the corresponding gradient estimate. These estimates are derived from data as described in the sections below and detailed in Additional file <xref rid="MOESM2" ref-type="media">2</xref>. We assume we have measurements of counts <italic>Y</italic><sub><italic>lst</italic></sub> (i.e., obtained via 16S rRNA sequencing) for each OTU <italic>l</italic> in subject <italic>s</italic> at time point <italic>t</italic>, where there are <italic>L</italic> OTUs, <italic>S</italic> subjects and <italic>N</italic><sub><italic>s</italic></sub> time points per subject. We also assume we have measurements of total bacterial biomass <italic>W</italic><sub><italic>st</italic></sub> (e.g., obtained via qPCR) for each time point <italic>t</italic> in each subject <italic>s</italic>.</p>
      <p>The reduction of the gLV differential equations to a linear system of equations via the “gradient matching” approach enables application of statistical models for linear regression. However, we are still faced with estimating <italic>L</italic><sup><italic>2</italic></sup> 
<italic>+ L + LP</italic> parameters, which will result in an under-determined system for typical datasets. We thus developed several algorithms that use regularization or variable selection techniques during the parameter inference process. These algorithms are described below and detailed in Additional file <xref rid="MOESM2" ref-type="media">2</xref>.</p>
      <sec id="Sec13">
        <title>Maximum-likelihood constrained ridge regression (MLCRR) algorithm</title>
        <p>The overall objective of the MLCRR algorithm is to infer point-estimates of growth, interaction, and perturbation effect parameters for the gLV model from high-throughput 16S rRNA gene sequencing data and measurements of microbial biomass. As described above, typical microbiome time-series datasets will not have enough observations relative to potential microbe–microbe interactions and perturbation effects, resulting in an under-determined system. We solve this problem by employing an <italic>L</italic><sub><italic>2</italic></sub>-regularization approach (also known as Tikhonov regularization or ridge regression [<xref ref-type="bibr" rid="CR31">31</xref>]) with cross-validation to set the regularization parameters. The MLCRR algorithm extends our prior maximum likelihood-based algorithm MLRR [<xref ref-type="bibr" rid="CR8">8</xref>] to constrain growth rates to positive values and self-interaction parameters to negative values. We developed an efficient quadratic programming-based approach for inferring parameters in the constrained problem, which is detailed in Additional file <xref rid="MOESM2" ref-type="media">2</xref>.</p>
      </sec>
      <sec id="Sec14">
        <title>Bayesian algorithms</title>
        <p>The overall objective of the MDSINE Bayesian algorithms is to infer distributions of growth, interaction, and perturbation-effect parameters for the gLV model from high-throughput 16S rRNA gene sequencing data and measurements of microbial biomass. Inferred distributions of parameters are then used to compute summary measures, including median predicted trajectories for OTUs, as well as measures of variability and strength of model selection evidence. As with the MLCRR maximum likelihood-based method, we use a “gradient matching” approach to infer parameters for the gLV model.</p>
        <p>For the MDSINE Bayesian algorithms, we use a two-step estimation procedure. First, we estimate trajectories and gradients of OTU concentrations directly from sequencing counts and biomass data using our Bayesian Adaptive Penalized Counts Splines (BAPCS) method described below. Then, we use the estimated trajectories and gradients to infer the gLV parameters using Bayesian linear modeling techniques, Bayesian Adaptive Lasso (BAL) or Bayesian Variable Selection (BVS), each described below. For both steps, we use custom Markov Chain Monte Carlo (MCMC) algorithms detailed in Additional file <xref rid="MOESM2" ref-type="media">2</xref>.</p>
        <p>The Bayesian Adaptive Penalized Counts Splines (BAPCS) algorithm in MDSINE estimates OTU concentration trajectories and gradients from data consisting of time series of noisy counts. Our formulation of the problem explicitly models differing numbers of sequencing reads between samples, overdispersion of counts, and irregular temporal sampling. We assume that counts data follow the Negative Binomial Distribution (NBD), which we and others have previously employed for modeling microbial sequencing counts data [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR23">23</xref>]. For modeling the NBD dispersion parameter, we employ a method similar to that used by DESeq2 [<xref ref-type="bibr" rid="CR14">14</xref>] but extended for time-series data. We model the continuous-time trajectory function for the NBD mean for each OTU in each subject using cubic B-splines [<xref ref-type="bibr" rid="CR32">32</xref>], which provide an efficient and flexible framework for modeling time-series data that we and others have demonstrated yield accurate predictions for large-scale longitudinal biological datasets [<xref ref-type="bibr" rid="CR33">33</xref>]. A challenge with B-spline methods is specifying the position and number of basis functions (break points); these choices influence the amount of smoothing applied to the data. To overcome this challenge, we use a penalized spline framework [<xref ref-type="bibr" rid="CR32">32</xref>] with an adaptive Bayesian regularization approach. Our approach places the break points uniformly at a high frequency (default of every 2 days) and then adaptively regularizes the spline coefficients in nearby temporal regions to encourage minimal changes in the trajectory over time unless larger deviations are warranted by the data. To achieve this, we use a hierarchical adaptive Bayesian lasso-style [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR34">34</xref>] model. See Additional file <xref rid="MOESM2" ref-type="media">2</xref> for a complete description of the BAPCS model and inference algorithm.</p>
        <p>The Bayesian Adaptive Lasso (BAL) algorithm in MDSINE uses an adaptive <italic>L</italic><sub><italic>1</italic></sub> or “lasso”-type regularization technique for inferring the distribution over microbial growth, interaction, and perturbation effect parameters in the gLV model. The BAL algorithm is adaptive in the sense that it allows for different degrees of regularization on each coefficient, i.e., each OTU has a different prior amount of interaction parameter shrinkage that is learned from the data. See Additional file <xref rid="MOESM2" ref-type="media">2</xref> for complete details on the BAL model and inference algorithm.</p>
        <p>The Bayesian Variable Selection (BVS) algorithm in MDSINE also infers the distribution over microbial growth, interaction, and perturbation effect parameters in the gLV model. However, in this approach we use a variable selection technique that directly models the presence or absence of microbe–microbe interactions or perturbation effects. Our model effectively learns a qualitative interaction network on the OTUs and perturbation effects as well as a quantitative interaction and perturbation effects matrix. Stated another way, the MLCRR and BAL regularization-based approaches in MDSINE assume all edges are present in the network, whereas the BVS approach additionally learns the presence/absence of the edges. The BVS algorithm also allows us to readily calculate Bayes factors [<xref ref-type="bibr" rid="CR35">35</xref>], which provide a formal method for comparing two alternative models given evidence (data). For MDSINE, we use Bayes factors to assess alternative models indicating the presence or absence of an interaction or perturbation effect given the data. See Additional file <xref rid="MOESM2" ref-type="media">2</xref> for complete details on the BVS model, the inference algorithm, and calculations of Bayes factors from the model.</p>
      </sec>
      <sec id="Sec15">
        <title>Benchmarking with simulated data</title>
        <p>We used the <italic>C. difficile</italic> infection dataset to obtain rough estimates of the scale and variability of growth rates, interaction coefficients, and initial concentrations of microbes. Estimates were obtained by solving the “gradient-matching” linear regression system using the pseudoinverse solution and forcing growth and self-interaction parameters to be positively and negatively valued, respectively. These estimates were then used to randomly sample growth and interaction parameters for a hypothetical 10-OTU system assuming a 20 % probability of interaction between OTU pairs (roughly what we observed in the <italic>C. difficile</italic> infection data).</p>
        <p>To obtain dynamical systems models for testing simulations, we required that all OTUs be present at steady state and have coefficients of variation for their trajectories &gt;0.25 for 75 % of initial concentrations tested (evaluated by randomly generating initial conditions numerous times and numerically integrating the gLV equations for each initial condition). The resulting dynamical systems model parameters were then used to generate simulated data for benchmarking. These simulations involved random sampling of initial concentrations of OTUs for ten “subjects” and numerical integration of the gLV equations using the initial concentrations to generate noise-free trajectories. We investigated different time point sampling resolutions, with designs of 27, 18, 12, or 8 time points chosen to mimic real experimental designs for in vivo microbiome time-series datasets. See Additional file <xref rid="MOESM2" ref-type="media">2</xref> for complete details on the data simulations.</p>
        <p>Noisy count data and biomass data were then simulated from noise-free trajectories using Dirichlet Multinomial Distribution (DMD) [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR20">20</xref>] and Normal Distribution models, respectively. The dispersion parameter for the Dirichlet Multinomial distribution was estimated from the <italic>C. difficile</italic> infection experimental data (16S rRNA amplicon sequencing counts) using a maximum likelihood procedure implemented in the MGLM toolkit [<xref ref-type="bibr" rid="CR36">36</xref>]. Note that the DMD model assumes compositionality of data (counts sum to a fixed constant for each sample), with over-dispersion of counts. MDSINE uses an alternative noise model based on the Negative Binomial Distribution (NBD), which also assumes over-dispersion of counts but does not assume compositionality of data (counts are generated independently for each sample conditional on a shared intensity parameter). Note that we intentionally tested performance of MDSINE on data generated with the DMD, a different noise model than implemented in MDSINE, to evaluate robustness of our method to compositionality of data.</p>
        <p>We evaluated simulated results for each of the algorithms implemented in the MDSINE package using the following metrics: (a) the root mean square error (RMSE) of the estimated growth rates compared with ground-truth growth rates; (b) the RMSE of the estimated interaction parameters compared with ground-truth interaction parameters; (c) the area under the receiver operator curve (AUC ROC) for presence/absence of interactions, for inferred interaction networks compared with the ground-truth network; (d) the RMSE of the predicted OTU trajectories compared with the ground-truth trajectories on unseen initial conditions (i.e., training on <italic>n</italic> − 1 subjects and prediction of the held-out subject given initial conditions for that subject). The above metrics were computed on 400 samples for each of the regimens described above. See Additional file <xref rid="MOESM2" ref-type="media">2</xref> for complete details on the evaluation procedure.</p>
      </sec>
      <sec id="Sec16">
        <title>C. difficile <italic>infection resistance predictions</italic></title>
        <p>In order to predict which bacterial compositions optimally confer resistance against <italic>C. difficile</italic> infection, we began by calculating which of the 2<sup>13</sup> − 1 possible bacterial combinations were predicted to have biologically meaningful steady-state levels (i.e., concentrations of species ≥0) and were stable (i.e., all the eigenvalues of the Jacobian matrix evaluated in the steady state have negative real part [<xref ref-type="bibr" rid="CR8">8</xref>]; see Additional file <xref rid="MOESM2" ref-type="media">2</xref> for further details). Steady-state concentrations and stability determinations were made from a subsample of MCMC samples obtained from running the BVS inference algorithm (1125 MCMC samples, using a thinning rate of 20 from the full 22,500 MCMC samples). States with a very high confidence of stability (estimated probability of stability &gt;0.9) were retained. Starting from the predicted concentration profile of each stable MCMC sample, we simulated a <italic>C. difficile</italic> infection challenge of 10<sup>5</sup> CFU/g, corresponding to a high infectious dose experimentally. We numerically integrated the corresponding gLV system for 28 days and determined for each microbiota state the level of <italic>C. difficile</italic> infection at the end of the numerical experiment as the median concentration across the corresponding MCMC samples. We then determined which states (for 1 through all species in the defined microbiota) led to the minimal median <italic>C. difficile</italic> concentrations at 28 days.</p>
      </sec>
      <sec id="Sec17">
        <title>Prediction of stable steady state profiles for probiotic cocktail</title>
        <p>In order to determine if switching to a dietary regime with low-fiber content would lead to a reduced number of admissible steady states as well as to reduced biodiversity, we estimated which of the 2<sup>13</sup> − 1 possible bacterial combinations had a stable and biologically meaningful density profile in high- and low-fiber diet conditions. To determine the stability profiles in the presence of the low-fiber perturbations, we calculated the net growth parameter for each strain <italic>i</italic> as the sum of its inferred growth rate <italic>α</italic><sub><italic>i</italic></sub> and its susceptibility to low-fiber diets <italic>γ</italic><sub><italic>i</italic></sub> (perturbation effect parameter). We repeated this analysis using 1125 MCMC samples (with a thinning rate of 20 from the full 22,500 MCMC samples) obtained from running the BVS inference algorithm. We then determined the number of predicted stable steady states in each condition and tested the null hypothesis of equal numbers of stably coexisting strains within stable states under both dietary regimens by applying a Wilcoxon rank sum test.</p>
      </sec>
      <sec id="Sec18">
        <title>Prediction of keystoneness of species</title>
        <p>To investigate the importance of specific strains in the Clostridia community from our probiotic dataset, we developed a quantitative measure of “keystoneness” in the MDSINE package. The measure starts from the community composition that allows the largest number of strains to stably coexist, and then removes each strain from the community in turn. Steady-state concentrations are calculated as described in the above subsection. The Euclidean distance between the concentrations of the starting profile and that of each of the profiles with one strain removed is then calculated, with the calculation excluding the contribution of the removed strain. The strains are then ranked based on the magnitude of the distances obtained as a consequence of their removal.</p>
      </sec>
    </sec>
    <sec id="Sec19">
      <title><italic>C. difficile</italic> infection in gnotobiotic mice</title>
      <sec id="Sec20">
        <title>Commensal bacterial cultures</title>
        <p>We developed a set of defined human commensal bacteria, which we term the GnotoComplex flora, based on extensive review of the literature [<xref ref-type="bibr" rid="CR37">37</xref>–<xref ref-type="bibr" rid="CR52">52</xref>]. Strains were chosen to approximate phylogenetic diversity and key roles of the microbiota in the host, including the ability to transform bile acids and degrade a variety of dietary compounds (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2). The GnotoComplex bacteria were also selected so that they are all distinguishable at the V4 region of the 16S rRNA gene (three or more nucleotide differences in the region) to ensure that the strains can all be differentiated with our high-throughput sequencing method. The GnotoComplex bacterial strains were purchased from either the American Type Culture Collection (ATCC) or the Leibniz Institute DSMZ-German Collection of Microorganisms and Cell Cultures (DSMZ) and propagated according to the propagation procedure on the product sheet for each strain (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2). Aliquots were prepared and stored at −80 °C until needed for the preparation of the bacterial inoculum. An aliquot from each bacterial strain was removed from the −80 °C freezer and plated for isolation onto either Tryptic Soy base with 5 % sheep blood agar (TSA) for the aerobic strains or pre-reduced <italic>Brucella</italic> base blood agar containing 5 % sheep blood, hemin, and vitamin K (BMB) for the anaerobic strains. The TSA plates were incubated at 37 °C in ambient air while the BMB plates were incubated at 37 °C in an anaerobic chamber containing an atmosphere of 10 % hydrogen, 10 % carbon dioxide and 80 % nitrogen. The plates were inspected for purity and Gram stains were performed. Brain Heart Infusion broth (BHI; 5 mL; Anaerobe Systems) was inoculated with a single colony of each bacterial strain and incubated overnight under appropriate conditions. The OD600 was determined and the suspensions diluted with BHI if necessary. The bacterial inoculum for mice was prepared by combining the individual bacterial strains based on their OD to ensure that each strain was equally represented.</p>
      </sec>
      <sec id="Sec21">
        <title><italic>Clostridium difficile</italic> culture</title>
        <p><italic>C. difficile</italic> strain 43255 was purchased from the ATCC and propagated according to the product sheet. For the preparation of spores, <italic>C. difficile</italic> was plated onto BMB to produce a lawn of growth and incubated in an anaerobic chamber for 10 days. The bacteria were recovered from the plate using a sterile cotton swab that had been pre-moistened with sterile phosphate-buffered saline (PBS). The bacteria were suspended in 15 mL of PBS. The suspension was heated in an 80 °C water bath for 10 min to kill the vegetative cells. Aliquots (1 ml) were prepared, flash frozen using liquid nitrogen, and stored at −80 °C. One aliquot was removed from the −80 °C freezer and serially diluted with PBS and plated onto BHI agar plates containing hemin, vitamin K, and 0.1 % (w/v) of taurocholate. The plates were incubated in an anaerobic chamber for 96 h and the spore concentration determined.</p>
      </sec>
      <sec id="Sec22">
        <title>Gnotobiotic mouse experiments</title>
        <p>Germ-free mice were bred and maintained in isolators in the Massachusetts Host-Microbiome Center at Brigham and Women’s Hospital. Five individually caged, male, 8–10-week-old, germ-free C57BL/6 mice were orally gavaged at day 0 with 200 μl of the GnotoComplex bacterial mixture for a total inoculum of ≈ 10<sup>8</sup> CFU per mouse. Fecal pellets were collected at 0.75, 1, 2, 3, 4, 6, 8, 10, 14, 17, 21, 24, and 28 days post-inoculation with the GnotoComplex strains and stored at −80 °C in 10 % PBS buffer. After fecal sample collection on day 28, mice were orally gavaged with 5 × 10<sup>3</sup><italic>C. difficile</italic> spores. Fecal pellets were collected at 0.75, 1, 2, 3, 4, 6, 8, 10, 14, 17, 21, 24, and 28 days post-infection with <italic>C. difficile</italic> and stored at −80 °C in 10 % PBS buffer.</p>
      </sec>
      <sec id="Sec23">
        <title>16S rRNA sequencing</title>
        <p>Bacterial genomic DNA was extracted using the Mo Bio Power Fecal DNA Isolation kit (Mo Bio Laboratories) according to the manufacturer’s instructions for high yields of DNA. To increase the DNA yields, the following modifications were used. An additional bead beater step using the Faster Prep FP120 (Thermo) at 6 m/s for 1 min was used instead of vortex agitation. Incubation with buffers C2 and C3 was increased to 10 min at 4 °C. Starting nucleic acid concentrations were determined by a Qubit Fluromoter (Life Technologies). A multiplexed amplicon library covering the 16S rDNA gene V4 region was prepared using the protocol of [<xref ref-type="bibr" rid="CR53">53</xref>] with dual-index barcodes. The aggregated library pool was size selected from 300–500 bp on a pippin prep 1.5 % agarose cassette (Sage Sciences) according to the manufacturer’s instructions. The concentration of the pool was measured by qPCR (Kapa Biosystems) and loaded onto the MiSeq Illumina instrument (300 bp kit) at 6–9 pM with 40 % phiX spike-in to compensate for low base diversity according to Illumina’s standard loading protocol. Sequences were deposited in the NIH Sequence Read Archive (SRA accession SRP065075).</p>
      </sec>
      <sec id="Sec24">
        <title>Bioinformatic processing of sequences</title>
        <p>Raw sequencing reads were processed using custom Python scripts, which perform denoising, quality filtering, and alignment against the 16S rRNA gene sequences of the species in the defined community. To reduce alignment error, low quality bases (Q &lt; 35) were trimmed using a sliding window (window size = 50 nucleotides). Reads with ambiguous characters or shorter than 250 nucleotides after trimming were removed. Finally, trimmed reads were aligned against a custom database of 16S rRNA sequences using blastn (ncbi-blast-2.2.29+) with default parameters. The blastn database was built using full-length 16S rRNA sequences of the GnotoComplex strains, which were extracted from genome reference sequences in National Center for Biotechnology Information (NCBI; <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/">http://www.ncbi.nlm.nih.gov/</ext-link>) or downloaded nucleotide sequences from NCBI for cases in which reference sequences were not available. After the alignment, sequencing reads were assigned to species using the criteria: best hit with identity ≥99 %, alignment length ≥250 nucleotides, no gaps, mismatches ≤2 nucleotides, and all bases aligned within the V4 hypervariable of the database sequences. To identify the V4 hypervariable region for the species in the defined community, the full-length 16S rRNA sequences were aligned against the Silva database [<xref ref-type="bibr" rid="CR54">54</xref>] of the V4 region using nhmmer [<xref ref-type="bibr" rid="CR55">55</xref>].</p>
      </sec>
    </sec>
    <sec id="Sec25">
      <title>Quantification of bacterial biomass via qPCR</title>
      <p>The universal 16S rRNA qPCR primer (16S-F1048, GTG STG CAY GGY TGT CGT CA; 16S-R1175, ACG TCR TCC MCA CCT TCC TC) was used. The reaction mixture for the SYBR Green assay contained 2U SYBR Green PCR Master Mix (PE Applied Biosystems), 20 pmol of forward and reverse primer and 8 μl of 1:100 diluted extracted DNA. The qPCRs were run on a Bio Rad CFX96 Real time PCR system under standard thermal-cycling conditions, consisting of an initial 10 min of denaturation at 95 °C, followed by 39 cycles of 15 s of denaturation at 95 °C and 60 °C for 60 s of annealing/extension. To quantify bacterial biomass, standard curves were prepared using genomic DNA purified from germ-free mouse stool spiked with serial tenfold dilutions of quantified <italic>Escherichia coli</italic>.</p>
    </sec>
    <sec id="Sec26">
      <title>Probiotic stability experiments in gnotobiotic mice</title>
      <sec id="Sec27">
        <title>Bacterial cultures and gnotobiotic experiments</title>
        <p>Germ-free IQI mice were purchased from Sankyo Laboratories, Japan and maintained in germ-free vinyl isolators in the animal facility of RIKEN. Thirteen Treg-inducing Clostridia strains (strains 1, 3, 8, 18 were omitted from the previously reported VE202 cocktail consisting of 17 Treg-inducing strains [<xref ref-type="bibr" rid="CR24">24</xref>]) were individually cultured in modified Eggerth Gagnon (EG) broth under strictly anaerobic conditions (80 % N<sub>2</sub>, 10 % H<sub>2</sub>, 10 % CO<sub>2</sub>) at 37 °C in an anaerobic chamber (Coy Laboratory Products) to confluence. The cultured bacterial strains were then mixed at equal amounts of media volume and the mixture of 13 strains were orally inoculated into seven IQI germ-free adult mice. Five of the mice were fed with a gamma ray-sterilized high-fiber diet (CMF chow, Oriental Yeast Japan) for 5 weeks, then switched to a low-fiber diet (AIN93G-fomula diet, Oriental Yeast Japan) for 2 weeks, and returned to and maintained on the CMF high-fiber diet for 2 weeks. Two of the mice were maintained on the high-fiber diet for 5 weeks and were not switched to the low-fiber diet. Fecal samples were collected daily or every other day. Fecal pellets were collected at days 1–21 (daily), 23, 25, 27, 29, 31, 33, 35–60 (daily), 62, 63, and 65 for the five mice receiving the dietary perturbation and at days 1–21 (daily), 23, 25, 27, and 29 for the two mice not receiving the perturbation.</p>
      </sec>
      <sec id="Sec28">
        <title>Quantification of bacterial concentrations via qPCR</title>
        <p>Bacterial genomic DNA was extracted from 1–2 fecal pellets using QIAamp DNA Stool Mini Kit (Qiagen). The amount of DNA was quantified using a Qubit dsDNA HS assay kit and Qubit fluorometer (Invitrogen). DNA was then subjected to qPCR using Thunderbird SYBR qPCR Mix (TOYOBO) and a LightCycler 480 (Roche) with primers specific to 16S rRNA genes of the 13 Clostridia strains (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4). Quantification of each strain in each sample was accomplished using standard curves of known concentrations of DNAs purified from each strain individually cultured in vitro. Strain densities in each sample were calculated by dividing the above absolute quantification numbers by the weight of the extracted fecal DNA.</p>
      </sec>
    </sec>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec29">
        <title>Additional files</title>
        <p>
          <media position="anchor" xlink:href="13059_2016_980_MOESM1_ESM.docx" id="MOESM1">
            <label>Additional file 1: Tables S1–4.</label>
            <caption>
              <p>Supplemental tables. (DOCX 21 kb)</p>
            </caption>
          </media>
          <media position="anchor" xlink:href="13059_2016_980_MOESM2_ESM.pdf" id="MOESM2">
            <label>Additional file 2:</label>
            <caption>
              <p>Supplemental methods. (PDF 372 kb)</p>
            </caption>
          </media>
          <media position="anchor" xlink:href="13059_2016_980_MOESM3_ESM.pdf" id="MOESM3">
            <label>Additional file 3: Figure S1.</label>
            <caption>
              <p>Performance of the MDSINE inference algorithms on simulated data with different sequencing depths. Simulations assumed an underlying dynamical systems model with ten species observed over 30 days with 27 time points sampled and an invading species at day 10. Performance of the four MDSINE inference algorithms, maximum likelihood ridge regression (MLRR), maximum likelihood constrained ridge regression (MLCRR), Bayesian adaptive lasso (BAL), and Bayesian variable selection (BVS), were compared. Algorithm performance was assessed using four different metrics: (<bold>a</bold>) root mean-square error (RMSE) for microbial growth rates; (<bold>b</bold>) RMSE for microbial interaction parameters; (<bold>c</bold>) RMSE for prediction of microbe trajectories on held-out subjects given only initial microbe concentrations for the held-out subject; and (<bold>d</bold>) area under the receiver operator curve (AUC ROC) for the underlying microbial interaction network. Lower RMSE values indicate superior performance, whereas higher AUC ROC values indicate superior performance. (PDF 182 kb)</p>
            </caption>
          </media>
          <media position="anchor" xlink:href="13059_2016_980_MOESM4_ESM.pdf" id="MOESM4">
            <label>Additional file 4: Figure S2.</label>
            <caption>
              <p>Experimental design for <italic>Clostridium difficile</italic> infection studies in gnotobiotic mice. Five adult germfree mice were gavaged with 23 human commensal bacterial type strains, chosen to capitulate the phylogenetic diversity and key physiologic capabilities of a native gut flora (see “<xref rid="Sec10" ref-type="sec">Methods</xref>” for details). After allowing 28 days for the commensal flora to establish, mice were gavaged with <italic>C. difficile</italic> spores and monitored for an additional 28 days. Fecal pellets were collected at days 0.75, 1, 2, 3, 4, 6, 8, 10, 14, 17, 21, 24, and 28 of the initial colonization and at days 0.75, 1, 2, 3, 4, 6, 8, 10, 14, 17, 21, 24, and 28 post-infection with <italic>C. difficile</italic>. Fecal samples were interrogated via high-throughput 16S rRNA sequencing to determine abundances of species and 16S rRNA qPCR using universal primers to estimate the total bacterial biomass present. After bioinformatics processing (see “<xref rid="Sec10" ref-type="sec">Methods</xref>”), 13 strains were found to be consistently detectable in pre-infection stool samples. (PDF 87 kb)</p>
            </caption>
          </media>
          <media position="anchor" xlink:href="13059_2016_980_MOESM5_ESM.pdf" id="MOESM5">
            <label>Additional file 5: Figure S3.</label>
            <caption>
              <p>Experimental design for probiotic stability studies in gnotobiotic mice. Seven adult germ-free mice were gavaged with 13 Clostridia strains from the VE202 probiotic cocktail [<xref ref-type="bibr" rid="CR24">24</xref>]. Five mice were maintained on a standard high-fiber diet for 5 weeks, after which mice were switched to a low-fiber diet for 2 weeks and then switched back to the high-fiber diet for another 2 weeks; an additional two mice were inoculated with the same strains but were not subjected to the low-fiber dietary perturbation. Fecal pellets were collected at days 1–21 (daily), 23, 25, 27, 29, 31, 33, 35–60 (daily), 62, 63, and 65 for the five mice receiving the low-fiber dietary perturbation and at days 1–21 (daily), 23, 25, 27, and 29 for the two mice not receiving the perturbation. (PDF 42 kb)</p>
            </caption>
          </media>
          <media position="anchor" xlink:href="13059_2016_980_MOESM6_ESM.pdf" id="MOESM6">
            <label>Additional file 6: Figure S4.</label>
            <caption>
              <p>Forecasts of microbial concentration trajectories for the gnotobiotic mice probiotic stability experiments. The forecasts were obtained using a hold-one-subject-out procedure. Briefly, MDSINE was run on all data from all but one of the mice (the held-out subject) and model parameters were inferred. Using the inferred model parameters (including for the perturbation) and the measured concentrations of the microbiota at an initial time point for the held-out mouse, the trajectories of the microbiota for the held-out mouse were then forecast for all the remaining time points; the procedure was repeated for each mouse in turn. Solid lines denote predicted trajectories and symbols denote actual data. (PDF 7552 kb)</p>
            </caption>
          </media>
          <media position="anchor" xlink:href="13059_2016_980_MOESM7_ESM.pdf" id="MOESM7">
            <label>Additional file 7: Figure S5.</label>
            <caption>
              <p>Predicted stability and steady state concentrations (log<sub>10</sub> ng strain DNA/μg total fecal DNA) for all combinations of the 13 Clostridia strains in mice fed either high-fiber (standard) or low-fiber diets in the probiotic stability experiment. <italic>Columns</italic> and <italic>rows</italic> were ordered using hierarchical clustering using Euclidean distance with Ward linkage. No significant differences were found in the predicted stable biodiversity profiles between the high-fiber and low-fiber dietary regimes (number of strains across all predicted stable states was not significantly different; Wilcoxon rank sum test <italic>p</italic> value = 0.096). (PDF 4845 kb)</p>
            </caption>
          </media>
          <media position="anchor" xlink:href="13059_2016_980_MOESM8_ESM.pdf" id="MOESM8">
            <label>Additional file 8: Figure S6.</label>
            <caption>
              <p>Directed microbe–microbe and microbe–perturbation effect network for the gnotobiotic mice probiotic stability experiment. Edge thickness denotes the magnitude of the evidence favoring presence of the interaction (Bayes factor). Only edges with strong evidence (Bayes factor ≥10) are displayed. (PDF 230 kb)</p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <ack>
    <title>Funding</title>
    <p>This work was supported by the Defense Advanced Projects Agency Biological Robustness in Complex Settings program (DARPA BRICS award HR0011-15-C-0094) and grants from the Harvard Digestive Diseases Center (Pilot and Feasibility Grant to GKG and Core Grant to LB, under NIH Grant P30DK034854), the National Heart, Lung and Blood Institute (grant 2T32HL007627-31 supporting EB), the National Institute of Allergy and Infectious Disease (grant R15-AI112985-01A1 supporting VB), and the National Science Foundation (grant 1458347 supporting VB). GKG also acknowledges support from the Brigham and Women’s Hospital Department of Pathology.</p>
    <sec id="FPar1">
      <title>Availability of data and materials</title>
      <p>The software for the Microbial Dynamical Systems INference Engine (MDSINE) presented in this manuscript is available at <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5281/zenodo.50624">http://dx.doi.org/10.5281/zenodo.50624</ext-link>. Processed data for the <italic>C. difficile</italic> infection and probiotic stability experiments are provided in the software repository. Configuration files and instructions for analyzing these datasets are also included in the software repository, for purposes of providing well-documented analysis examples and ensuring reproducibility of our analyses. Raw sequence data were deposited in the NIH Sequence Read Archive (SRA accession SRP065075).</p>
      <p>MDSINE is also maintained as an open-source software project at <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/MDSINE/mdsine/downloads">https://bitbucket.org/MDSINE/mdsine/downloads</ext-link>. A user manual is available on the repository and installation and execution details are detailed on the main page of the repository <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/MDSINE/mdsine/">https://bitbucket.org/MDSINE/mdsine/</ext-link>.</p>
    </sec>
    <sec id="FPar2">
      <title>Authors’ contributions</title>
      <p>GG, VB, LB, and KH conceived the study. VB and RS developed the MLRR and MLCRR algorithms. GG developed the BAPCS, BAL, and BVS algorithms. VB, GG, BT, and MS developed the software. LD, VY, MD, QL, and LB performed the <italic>C. difficile</italic> infection experiments. TT and KH performed the probiotic stability experiments. VB, GG, NL, TT, EB, BO, KH, and LB analyzed the data. VB and GG wrote the paper. All authors read and approved the final manuscript.</p>
    </sec>
    <sec id="FPar3">
      <title>Competing interests</title>
      <p>GG is a member of the Scientific Advisory Board of Kaleido, Inc. VB, TT, and KH have received support from Vedanta Biosciences, Inc. under research agreements with their institutions. KH is a Co-Founder and Scientific Advisory Board Member of Vedanta Biosciences, Inc. BO is the Chief Executive Officer of Vedanta Biosciences, Inc. The other authors have no competing financial interests.</p>
    </sec>
    <sec id="FPar5">
      <title>Ethics</title>
      <p>All animal work was performed in accordance with institutional guidelines. The <italic>C. difficile</italic> infection experiments were approved by the Harvard Medical Area (HMA) Standing Committee on Animals, Animal Experimentation Protocol #05039. The probiotic stability experiments were approved by the Animal Experiments Committee in RIKEN Yokohama Institute, Protocol # 28-016.</p>
    </sec>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bucci</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Xavier</surname>
            <given-names>JB</given-names>
          </name>
        </person-group>
        <article-title>Towards predictive models of the human gut microbiome</article-title>
        <source>J Mol Biol</source>
        <year>2014</year>
        <volume>426</volume>
        <fpage>3907</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jmb.2014.03.017</pub-id>
        <?supplied-pmid 24727124?>
        <pub-id pub-id-type="pmid">24727124</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gerber</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>The dynamic microbiome</article-title>
        <source>FEBS Lett</source>
        <year>2014</year>
        <volume>588</volume>
        <fpage>4131</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1016/j.febslet.2014.02.037</pub-id>
        <?supplied-pmid 24583074?>
        <pub-id pub-id-type="pmid">24583074</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <mixed-citation publication-type="other">Donaldson GP, Lee SM, Mazmanian SK. Gut biogeography of the bacterial microbiota. Nat Rev Microbiol. 2016;14(1):20-32. doi:10.1038/nrmicro3552</mixed-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Donia</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Fischbach</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>Small molecules from the human microbiota</article-title>
        <source>Science</source>
        <year>2015</year>
        <volume>349</volume>
        <fpage>1254766</fpage>
        <pub-id pub-id-type="doi">10.1126/science.1254766</pub-id>
        <?supplied-pmid 26206939?>
        <pub-id pub-id-type="pmid">26206939</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rakoff-Nahoum</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Coyne</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Comstock</surname>
            <given-names>LE</given-names>
          </name>
        </person-group>
        <article-title>An ecological network of polysaccharide utilization among human intestinal symbionts</article-title>
        <source>Curr Biol</source>
        <year>2014</year>
        <volume>24</volume>
        <fpage>40</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cub.2013.10.077</pub-id>
        <?supplied-pmid 24332541?>
        <pub-id pub-id-type="pmid">24332541</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <mixed-citation publication-type="other">van Nood E, Vrieze A, Nieuwdorp M, Fuentes S, Zoetendal EG, de Vos WM, Visser CE, Kuijper EJ, Bartelsman JF, Tijssen JG, et al. Duodenal infusion of donor feces for recurrent Clostridium difficile. N Engl J Med. 2013;368:407–15.</mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Friedman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Alm</surname>
            <given-names>EJ</given-names>
          </name>
        </person-group>
        <article-title>Inferring correlation networks from genomic survey data</article-title>
        <source>PLoS Comput Biol</source>
        <year>2012</year>
        <volume>8</volume>
        <fpage>e1002687</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1002687</pub-id>
        <?supplied-pmid 23028285?>
        <pub-id pub-id-type="pmid">23028285</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <mixed-citation publication-type="other">Stein RR, Bucci V, Toussaint NC, Buffie CG, Ratsch G, Pamer EG, Sander C, Xavier JB. Ecological modeling from time-series inference: insight into dynamics and stability of intestinal microbiota. PLoS Comput Biol. 2013;9:e1003388.</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marino</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Baxter</surname>
            <given-names>NT</given-names>
          </name>
          <name>
            <surname>Huffnagle</surname>
            <given-names>GB</given-names>
          </name>
          <name>
            <surname>Petrosino</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Schloss</surname>
            <given-names>PD</given-names>
          </name>
        </person-group>
        <article-title>Mathematical modeling of primary succession of murine intestinal microbiota</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2014</year>
        <volume>111</volume>
        <fpage>439</fpage>
        <lpage>44</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1311322111</pub-id>
        <?supplied-pmid 24367073?>
        <pub-id pub-id-type="pmid">24367073</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">Buffie CG, Bucci V, Stein RR, McKenney PT, Ling L, Gobourne A, No D, Liu H, Kinnebrew M, Viale A, et al. Precision microbiome reconstitution restores bile acid mediated resistance to Clostridium difficile. Nature. 2015;517:205–8.</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <mixed-citation publication-type="other">Sugihara G, May R, Ye H, Hsieh CH, Deyle E, Fogarty M, Munch S. Detecting causality in complex ecosystems. Science. 2012;338:496–500.</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Butcher</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <source>Numerical methods for ordinary differential equations</source>
        <year>2008</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Wiley</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fisher</surname>
            <given-names>CK</given-names>
          </name>
          <name>
            <surname>Mehta</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Identifying keystone species in the human gut microbiome from metagenomic timeseries using sparse linear regression</article-title>
        <source>PLoS One</source>
        <year>2014</year>
        <volume>9</volume>
        <fpage>e102451</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0102451</pub-id>
        <?supplied-pmid 25054627?>
        <pub-id pub-id-type="pmid">25054627</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>550</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-014-0550-8</pub-id>
        <?supplied-pmid 25516281?>
        <pub-id pub-id-type="pmid">25516281</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Gelman A, Carlin JB, Stern HS, Rubin DB. Bayesian data analysis. Boca Raton, Florida USA: Chapman &amp; Hall; 2014.</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McMurdie</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Waste not, want not: why rarefying microbiome data is inadmissible</article-title>
        <source>PLoS Comput Biol</source>
        <year>2014</year>
        <volume>10</volume>
        <fpage>e1003531</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1003531</pub-id>
        <?supplied-pmid 24699258?>
        <pub-id pub-id-type="pmid">24699258</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Park</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Casella</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>The Bayesian lasso</article-title>
        <source>J Am Stat Assoc</source>
        <year>2008</year>
        <volume>103</volume>
        <fpage>681</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1198/016214508000000337</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’Hara</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sillanpaa</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A review of bayesian variable selection methods: what, how and which</article-title>
        <source>Bayesian Anal</source>
        <year>2009</year>
        <volume>4</volume>
        <fpage>1</fpage>
        <lpage>33</lpage>
        <pub-id pub-id-type="doi">10.1214/09-BA401</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mosimann</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>On the compound multinomial distribution, the multivariate β-distribution, and correlations among proportions</article-title>
        <source>Biometrika</source>
        <year>1962</year>
        <volume>49</volume>
        <fpage>65</fpage>
        <lpage>82</lpage>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <mixed-citation publication-type="other">La Rosa PS, Brooks JP, Deych E, Boone EL, Edwards DJ, Wang Q, Sodergren E, Weinstock G, Shannon WD. Hypothesis testing and power calculations for taxonomic-based human microbiome data. PLoS One. 2012;7:e52078.</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <mixed-citation publication-type="other">Belzer C, Gerber GK, Roeselers G, Delaney M, DuBois A, Liu Q, Belavusava V, Yeliseyev V, Houseman A, Onderdonk A, et al. Dynamics of the microbiota in response to host infection. PLoS One. 2014;9:e95534.</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Carmody RN, Gerber GK, Luevano Jr JM, Gatti DM, Somes L, Svenson KL, Turnbaugh PJ. Diet dominates host genotype in shaping the murine gut microbiota. Cell Host Microbe. 2015;17:72–84.</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gerber</surname>
            <given-names>GK</given-names>
          </name>
          <name>
            <surname>Onderdonk</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Bry</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Inferring dynamic signatures of microbes in complex host ecosystems</article-title>
        <source>PLoS Comput Biol</source>
        <year>2012</year>
        <volume>8</volume>
        <fpage>e1002624</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1002624</pub-id>
        <?supplied-pmid 22876171?>
        <pub-id pub-id-type="pmid">22876171</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Atarashi K, Tanoue T, Oshima K, Suda W, Nagano Y, Nishikawa H, Fukuda S, Saito T, Narushima S, Hase K, et al. Treg induction by a rationally selected mixture of Clostridia strains from the human microbiota. Nature. 2013;500:232–6.</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schubert</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Sinani</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Schloss</surname>
            <given-names>PD</given-names>
          </name>
        </person-group>
        <article-title>Antibiotic-induced alterations of the murine gut microbiota and subsequent effects on colonization resistance against Clostridium difficile</article-title>
        <source>MBio</source>
        <year>2015</year>
        <volume>6</volume>
        <fpage>e00974</fpage>
        <pub-id pub-id-type="doi">10.1128/mBio.00974-15</pub-id>
        <?supplied-pmid 26173701?>
        <pub-id pub-id-type="pmid">26173701</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schaubeck</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Haller</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Reciprocal interaction of diet and microbiome in inflammatory bowel diseases</article-title>
        <source>Curr Opin Gastroenterol</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>464</fpage>
        <lpage>70</lpage>
        <pub-id pub-id-type="doi">10.1097/MOG.0000000000000216</pub-id>
        <?supplied-pmid 26406564?>
        <pub-id pub-id-type="pmid">26406564</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hou</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Lewis</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Diet and inflammatory bowel disease: review of patient-targeted recommendations</article-title>
        <source>Clin Gastroenterol Hepatol</source>
        <year>2014</year>
        <volume>12</volume>
        <fpage>1592</fpage>
        <lpage>600</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cgh.2013.09.063</pub-id>
        <?supplied-pmid 24107394?>
        <pub-id pub-id-type="pmid">24107394</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maurice</surname>
            <given-names>CF</given-names>
          </name>
          <name>
            <surname>Haiser</surname>
            <given-names>HJ</given-names>
          </name>
          <name>
            <surname>Turnbaugh</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>Xenobiotics shape the physiology and gene expression of the active human gut microbiome</article-title>
        <source>Cell</source>
        <year>2013</year>
        <volume>152</volume>
        <fpage>39</fpage>
        <lpage>50</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2012.10.052</pub-id>
        <?supplied-pmid 23332745?>
        <pub-id pub-id-type="pmid">23332745</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Macdonald</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Higham</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Husmeier</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Controversy in mechanistic modelling with gaussian processes</article-title>
        <source>J Mach Learn Res</source>
        <year>2015</year>
        <volume>37</volume>
        <fpage>1539</fpage>
        <lpage>47</lpage>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mark Welch</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Rossetti</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Rieken</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Dewhirst</surname>
            <given-names>FE</given-names>
          </name>
          <name>
            <surname>Borisy</surname>
            <given-names>GG</given-names>
          </name>
        </person-group>
        <article-title>Biogeography of a human oral microbiome at the micron scale</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2016</year>
        <volume>113</volume>
        <fpage>E791</fpage>
        <lpage>800</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1522149113</pub-id>
        <?supplied-pmid 26811460?>
        <pub-id pub-id-type="pmid">26811460</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Aster R, Borchers B, Thurber C. Parameter estimation and inverse problems. Cambridge, MA: Academic Press; 2012.</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Crainiceanu CM, Ruppert D, Wand MP. Bayesian analysis for penalized spline regression using WinBUGS. J Stat Software. 2005;14(14):1–24.</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bar-Joseph</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Gerber</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Simon</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Gifford</surname>
            <given-names>DK</given-names>
          </name>
          <name>
            <surname>Jaakkola</surname>
            <given-names>TS</given-names>
          </name>
        </person-group>
        <article-title>Comparing the continuous representation of time-series expression profiles to identify differentially expressed genes</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2003</year>
        <volume>100</volume>
        <fpage>10146</fpage>
        <lpage>51</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1732547100</pub-id>
        <?supplied-pmid 12934016?>
        <pub-id pub-id-type="pmid">12934016</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leng</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Tran</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nott</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Bayesian adaptive lasso</article-title>
        <source>Ann Inst Stat Math</source>
        <year>2014</year>
        <volume>66</volume>
        <fpage>221</fpage>
        <lpage>44</lpage>
        <pub-id pub-id-type="doi">10.1007/s10463-013-0429-6</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kass</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Raftery</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Bayes factors</article-title>
        <source>J Am Stat Assoc</source>
        <year>1995</year>
        <volume>90</volume>
        <fpage>773</fpage>
        <lpage>95</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.1995.10476572</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <mixed-citation publication-type="other">Zhang Y, Zhou H, Zhou J, Sun W. Regression models for multivariate count data. J Comput Graphical Stat. 2016:1–37. DOI: 10.1080/10618600.2016.1154063.</mixed-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aries</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Crowther</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Drasar</surname>
            <given-names>BS</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Degradation of bile salts by human intestinal bacteria</article-title>
        <source>Gut</source>
        <year>1969</year>
        <volume>10</volume>
        <fpage>575</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1136/gut.10.7.575</pub-id>
        <?supplied-pmid 5806939?>
        <pub-id pub-id-type="pmid">5806939</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bentley</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Meganathan</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Biosynthesis of vitamin K (menaquinone) in bacteria</article-title>
        <source>Microbiol Rev</source>
        <year>1982</year>
        <volume>46</volume>
        <fpage>241</fpage>
        <lpage>80</lpage>
        <?supplied-pmid 6127606?>
        <pub-id pub-id-type="pmid">6127606</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brandt</surname>
            <given-names>LJ</given-names>
          </name>
        </person-group>
        <article-title>Production of vitamin B12 analogues in patients with small-bowel bacterial overgrowth</article-title>
        <source>Ann Intern Med</source>
        <year>1977</year>
        <volume>87</volume>
        <fpage>546</fpage>
        <pub-id pub-id-type="doi">10.7326/0003-4819-87-5-546</pub-id>
        <?supplied-pmid 921081?>
        <pub-id pub-id-type="pmid">921081</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dabek</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>McCrae</surname>
            <given-names>SI</given-names>
          </name>
          <name>
            <surname>Stevens</surname>
            <given-names>VJ</given-names>
          </name>
          <name>
            <surname>Duncan</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Louis</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Distribution of beta-glucosidase and beta-glucuronidase activity and of beta-glucuronidase gene gus in human colonic bacteria</article-title>
        <source>FEMS Microbiol Ecol</source>
        <year>2008</year>
        <volume>66</volume>
        <fpage>487</fpage>
        <lpage>95</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1574-6941.2008.00520.x</pub-id>
        <?supplied-pmid 18537837?>
        <pub-id pub-id-type="pmid">18537837</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Derrien</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Vaughan</surname>
            <given-names>EE</given-names>
          </name>
          <name>
            <surname>Plugge</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>de Vos</surname>
            <given-names>WM</given-names>
          </name>
        </person-group>
        <article-title>Akkermansia muciniphila gen. nov., sp. nov., a human intestinal mucin-degrading bacterium</article-title>
        <source>Int J Syst Evol Microbiol</source>
        <year>2004</year>
        <volume>54</volume>
        <fpage>1469</fpage>
        <lpage>76</lpage>
        <pub-id pub-id-type="doi">10.1099/ijs.0.02873-0</pub-id>
        <?supplied-pmid 15388697?>
        <pub-id pub-id-type="pmid">15388697</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gilliland</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Speck</surname>
            <given-names>ML</given-names>
          </name>
        </person-group>
        <article-title>Deconjugation of bile acids by intestinal lactobacilli</article-title>
        <source>Appl Environ Microbiol</source>
        <year>1977</year>
        <volume>33</volume>
        <fpage>15</fpage>
        <lpage>8</lpage>
        <?supplied-pmid 13710?>
        <pub-id pub-id-type="pmid">13710</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hayakawa</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hattori</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>7alpha-dehydroxylation of cholic acid by Clostridium bifermentans strain ATCC 9714 and Clostridium sordellii strain NCIB 6929</article-title>
        <source>FEBS Lett</source>
        <year>1970</year>
        <volume>6</volume>
        <fpage>131</fpage>
        <lpage>3</lpage>
        <pub-id pub-id-type="doi">10.1016/0014-5793(70)80020-5</pub-id>
        <?supplied-pmid 11947357?>
        <pub-id pub-id-type="pmid">11947357</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <mixed-citation publication-type="other">Liang WJ, Wilson KJ, Xie H, Knol J, Suzuki S, Rutherford NG, Henderson PJ, Jefferson RA. The gusBC genes of Escherichia coli encode a glucuronide transport system. J Bacteriol. 2005;187:2377–85.</mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>MacDonald</surname>
            <given-names>IA</given-names>
          </name>
          <name>
            <surname>Rochon</surname>
            <given-names>YP</given-names>
          </name>
          <name>
            <surname>Hutchison</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Holdeman</surname>
            <given-names>LV</given-names>
          </name>
        </person-group>
        <article-title>Formation of ursodeoxycholic acid from chenodeoxycholic acid by a 7 beta-hydroxysteroid dehydrogenase-elaborating Eubacterium aerofaciens strain cocultured with 7 alpha-hydroxysteroid dehydrogenase-elaborating organisms</article-title>
        <source>Appl Environ Microbiol</source>
        <year>1982</year>
        <volume>44</volume>
        <fpage>1187</fpage>
        <lpage>95</lpage>
        <?supplied-pmid 6758698?>
        <pub-id pub-id-type="pmid">6758698</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Macdonald</surname>
            <given-names>IA</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Hylemon</surname>
            <given-names>PB</given-names>
          </name>
        </person-group>
        <article-title>Separation of 7 alpha- and 7 beta-hydroxysteroid dehydrogenase activities from clostridium absonum ATCC# 27555 and cellular response of this organism to bile acid inducers</article-title>
        <source>J Lipid Res</source>
        <year>1983</year>
        <volume>24</volume>
        <fpage>1119</fpage>
        <lpage>26</lpage>
        <?supplied-pmid 6579144?>
        <pub-id pub-id-type="pmid">6579144</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miller</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Wolin</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Fermentations by saccharolytic intestinal bacteria</article-title>
        <source>Am J Clin Nutr</source>
        <year>1979</year>
        <volume>32</volume>
        <fpage>164</fpage>
        <lpage>72</lpage>
        <?supplied-pmid 760499?>
        <pub-id pub-id-type="pmid">760499</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pereira</surname>
            <given-names>DI</given-names>
          </name>
          <name>
            <surname>McCartney</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Gibson</surname>
            <given-names>GR</given-names>
          </name>
        </person-group>
        <article-title>An in vitro study of the probiotic potential of a bile-salt-hydrolyzing Lactobacillus fermentum strain, and determination of its cholesterol-lowering properties</article-title>
        <source>Appl Environ Microbiol</source>
        <year>2003</year>
        <volume>69</volume>
        <fpage>4743</fpage>
        <lpage>52</lpage>
        <pub-id pub-id-type="doi">10.1128/AEM.69.8.4743-4752.2003</pub-id>
        <?supplied-pmid 12902267?>
        <pub-id pub-id-type="pmid">12902267</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <mixed-citation publication-type="other">Ridlon JM, Ikegawa S, Alves JM, Zhou B, Kobayashi A, Iida T, Mitamura K, Tanabe G, Serrano M, De Guzman A, et al. Clostridium scindens: a human gut microbe with a high potential to convert glucocorticoids into androgens. J Lipid Res. 2013;54:2437–49.</mixed-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Salyers</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>West</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Vercellotti</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Wilkins</surname>
            <given-names>TD</given-names>
          </name>
        </person-group>
        <article-title>Fermentation of mucins and plant polysaccharides by anaerobic bacteria from the human colon</article-title>
        <source>Appl Environ Microbiol</source>
        <year>1977</year>
        <volume>34</volume>
        <fpage>529</fpage>
        <lpage>33</lpage>
        <?supplied-pmid 563214?>
        <pub-id pub-id-type="pmid">563214</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Suvarna</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Stevenson</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Meganathan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hudspeth</surname>
            <given-names>ME</given-names>
          </name>
        </person-group>
        <article-title>Menaquinone (vitamin K2) biosynthesis: localization and characterization of the menA gene from Escherichia coli</article-title>
        <source>J Bacteriol</source>
        <year>1998</year>
        <volume>180</volume>
        <fpage>2782</fpage>
        <lpage>7</lpage>
        <?supplied-pmid 9573170?>
        <pub-id pub-id-type="pmid">9573170</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Taranto</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Vera</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Hugenholtz</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>De Valdez</surname>
            <given-names>GF</given-names>
          </name>
          <name>
            <surname>Sesma</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Lactobacillus reuteri CRL1098 produces cobalamin</article-title>
        <source>J Bacteriol</source>
        <year>2003</year>
        <volume>185</volume>
        <fpage>5643</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1128/JB.185.18.5643-5647.2003</pub-id>
        <?supplied-pmid 12949118?>
        <pub-id pub-id-type="pmid">12949118</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kozich</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Westcott</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Baxter</surname>
            <given-names>NT</given-names>
          </name>
          <name>
            <surname>Highlander</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Schloss</surname>
            <given-names>PD</given-names>
          </name>
        </person-group>
        <article-title>Development of a dual-index sequencing strategy and curation pipeline for analyzing amplicon sequence data on the MiSeq Illumina sequencing platform</article-title>
        <source>Appl Environ Microbiol</source>
        <year>2013</year>
        <volume>79</volume>
        <fpage>5112</fpage>
        <lpage>20</lpage>
        <pub-id pub-id-type="doi">10.1128/AEM.01043-13</pub-id>
        <?supplied-pmid 23793624?>
        <pub-id pub-id-type="pmid">23793624</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <mixed-citation publication-type="other">Quast C, Pruesse E, Yilmaz P, Gerken J, Schweer T, Yarza P, Peplies J, Glockner FO. The SILVA ribosomal RNA gene database project: improved data processing and web-based tools. Nucleic Acids Res. 2013;41:D590–6.</mixed-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wheeler</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>nhmmer: DNA homology search with profile HMMs</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>2487</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt403</pub-id>
        <?supplied-pmid 23842809?>
        <pub-id pub-id-type="pmid">23842809</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
