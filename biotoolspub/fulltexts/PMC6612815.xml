<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6612815</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btz318</article-id>
    <article-id pub-id-type="publisher-id">btz318</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Ismb/Eccb 2019 Conference Proceedings</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Studies of Phenotypes and Clinical Applications</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MOLI: multi-omics late integration with deep neural networks for drug response prediction</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Sharifi-Noghabi</surname>
          <given-names>Hossein</given-names>
        </name>
        <xref ref-type="aff" rid="btz318-aff1">1</xref>
        <xref ref-type="aff" rid="btz318-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zolotareva</surname>
          <given-names>Olga</given-names>
        </name>
        <xref ref-type="aff" rid="btz318-aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Collins</surname>
          <given-names>Colin C</given-names>
        </name>
        <xref ref-type="aff" rid="btz318-aff2">2</xref>
        <xref ref-type="aff" rid="btz318-aff4">4</xref>
        <xref ref-type="corresp" rid="btz318-cor1"/>
        <!--<email>ccollins@prostatecentre.com</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ester</surname>
          <given-names>Martin</given-names>
        </name>
        <xref ref-type="aff" rid="btz318-aff1">1</xref>
        <xref ref-type="aff" rid="btz318-aff2">2</xref>
        <xref ref-type="corresp" rid="btz318-cor1"/>
        <!--<email>ester@cs.sfu.ca</email>-->
      </contrib>
    </contrib-group>
    <aff id="btz318-aff1"><label>1</label>School of Computing Science, Simon Fraser University, Burnaby, BC, Canada</aff>
    <aff id="btz318-aff2"><label>2</label>Vancouver Prostate Centre, Vancouver, BC, Canada</aff>
    <aff id="btz318-aff3"><label>3</label>International Research Training Group Computational Methods for the Analysis of the Diversity and Dynamics of Genomes and Genome Informatics, Faculty of Technology and Center for Biotechnology, Bielefeld University, Germany</aff>
    <aff id="btz318-aff4"><label>4</label>Department of Urologic Sciences, University of British Columbia, Vancouver, BC, Canada</aff>
    <author-notes>
      <corresp id="btz318-cor1">To whom correspondence should be addressed. <email>ccollins@prostatecentre.com</email> or <email>ester@cs.sfu.ca</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>7</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2019-07-05">
      <day>05</day>
      <month>7</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>05</day>
      <month>7</month>
      <year>2019</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>35</volume>
    <issue>14</issue>
    <fpage>i501</fpage>
    <lpage>i509</lpage>
    <permissions>
      <copyright-statement>© The Author(s) 2019. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btz318.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Historically, gene expression has been shown to be the most informative data for drug response prediction. Recent evidence suggests that integrating additional omics can improve the prediction accuracy which raises the question of how to integrate the additional omics. Regardless of the integration strategy, clinical utility and translatability are crucial. Thus, we reasoned a multi-omics approach combined with clinical datasets would improve drug response prediction and clinical relevance.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We propose MOLI, a <bold>m</bold>ulti-<bold>o</bold>mics <bold>l</bold>ate <bold>i</bold>ntegration method based on deep neural networks. MOLI takes somatic mutation, copy number aberration and gene expression data as input, and integrates them for drug response prediction. MOLI uses type-specific encoding sub-networks to learn features for each omics type, concatenates them into one representation and optimizes this representation via a combined cost function consisting of a triplet loss and a binary cross-entropy loss. The former makes the representations of responder samples more similar to each other and different from the non-responders, and the latter makes this representation predictive of the response values. We validate MOLI on <italic>in vitro</italic> and <italic>in vivo</italic> datasets for five chemotherapy agents and two targeted therapeutics. Compared to state-of-the-art single-omics and early integration multi-omics methods, MOLI achieves higher prediction accuracy in external validations. Moreover, a significant improvement in MOLI’s performance is observed for targeted drugs when training on a pan-drug input, i.e. using all the drugs with the same target compared to training only on drug-specific inputs. MOLI’s high predictive power suggests it may have utility in precision oncology.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p><ext-link ext-link-type="uri" xlink:href="https://github.com/hosseinshn/MOLI">https://github.com/hosseinshn/MOLI</ext-link>.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Canada Foundation for Innovation</named-content>
          <named-content content-type="funder-identifier">10.13039/501100000196</named-content>
        </funding-source>
        <award-id>33440</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">The Canadian Institutes of Health Research</named-content>
        </funding-source>
        <award-id>PJT-153073</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Terry Fox Foundation</named-content>
          <named-content content-type="funder-identifier">10.13039/501100002655</named-content>
        </funding-source>
        <award-id>201012TFF</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">National Science and Engineering Research Council of Canada</named-content>
        </funding-source>
        <award-id>R611347</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Precision oncology is the use of genomic data to tailor therapy for an individual cancer patient. However, response to a cancer treatment—chemotherapy or targeted drugs—is a complex phenotype and often depends on multiple factors especially the genomic profile of the patient (<xref rid="btz318-B27" ref-type="bibr">Lee <italic>et al.</italic>, 2018</xref>). Presently, only 11% of patients treated with precision oncology can be placed in clinical trials and only 5% of patients benefit from precision oncology (<xref rid="btz318-B6" ref-type="bibr">Cheng <italic>et al.</italic>, 2018</xref>; <xref rid="btz318-B31" ref-type="bibr">Marquart <italic>et al.</italic>, 2018</xref>; <xref rid="btz318-B45" ref-type="bibr">Zehir <italic>et al.</italic>, 2017</xref>). Although there are many reasons underlying this modest success rate, improved drug response prediction will significantly increase the number of patients who benefit from targeted therapy (<xref rid="btz318-B31" ref-type="bibr">Marquart <italic>et al.</italic>, 2018</xref>) or chemotherapy, and avoid adverse side effects who will not (<xref rid="btz318-B15" ref-type="bibr">Gavan <italic>et al.</italic>, 2018</xref>; <xref rid="btz318-B32" ref-type="bibr">Mishra and Verma, 2010</xref>). Various <italic>in vitro</italic> studies of cancer cell lines and patient-derived xenograft (PDX) mice models (<xref rid="btz318-B14" ref-type="bibr">Gao <italic>et al.</italic>, 2015</xref>) have created datasets such as Genomics of Drug Sensitivity in Cancer (GDSC) (<xref rid="btz318-B23" ref-type="bibr">Iorio <italic>et al.</italic>, 2016</xref>) and Cancer Cell Line Encyclopedia (CCLE) (<xref rid="btz318-B4" ref-type="bibr">Barretina <italic>et al.</italic>, 2012</xref>). These datasets provide researchers with multi-omics profiles—consisting of genomic [somatic mutation and copy number aberration (CNA)], transcriptomic, proteomic and methylomic data—together with the response to a large number of targeted and chemotherapy drugs. This is different from patient datasets, which record the response only to one or a few drugs that have been administered to a patient. These <italic>in vitro</italic> datasets enable researchers to investigate the drug response mechanism at a large scale, in particular for many drugs, and all the way from various types of pre-clinical models to patients (<xref rid="btz318-B4" ref-type="bibr">Barretina <italic>et al.</italic>, 2012</xref>; <xref rid="btz318-B23" ref-type="bibr">Iorio <italic>et al.</italic>, 2016</xref>). Complementing <italic>in vitro</italic> studies, <italic>in silico</italic> studies have aimed at building computational methods that analyze the cumulative effects of single- or multi-omics data to accurately predict drug response (<xref rid="btz318-B10" ref-type="bibr">Ding <italic>et al.</italic>, 2018</xref>; <xref rid="btz318-B16" ref-type="bibr">Geeleher <italic>et al.</italic>, 2014</xref>). These studies usually measure the drug response as the drug concentration that reduces viability by 50% (IC50).</p>
    <p>A critical challenge in drug response research is the clinical utility, i.e. whether the outcome of the study is translatable to actual patients (<xref rid="btz318-B16" ref-type="bibr">Geeleher <italic>et al.</italic>, 2014</xref>, <xref rid="btz318-B17" ref-type="bibr">2017</xref>). Ideally to achieve translatability, a computational method should be trained on <italic>in vivo</italic> data, however, available <italic>in vivo</italic> datasets such as The Cancer Genome Atlas (TCGA) datasets (<xref rid="btz318-B42" ref-type="bibr">Weinstein <italic>et al.</italic>, 2013</xref>) do not have enough patient records with drug response information and in particular, unlike cell line datasets such as GDSC, they do not report responses to multiple drugs. For <italic>in silico</italic> drug response prediction, translatability in the simplest case means that a model with good performance (e.g. high prediction accuracy) on <italic>in vitro</italic> data—trained on more samples compared to <italic>in vivo</italic> data—should also have good performance on <italic>in vivo</italic> data.</p>
    <p>The majority of studies suggests that gene expression data are the most effective data type for drug response prediction (<xref rid="btz318-B11" ref-type="bibr">Ding <italic>et al.</italic>, 2016</xref>; <xref rid="btz318-B16" ref-type="bibr">Geeleher <italic>et al.</italic>, 2014</xref>; <xref rid="btz318-B20" ref-type="bibr">Graim <italic>et al.</italic>, 2019</xref>; <xref rid="btz318-B23" ref-type="bibr">Iorio <italic>et al.</italic>, 2016</xref>). <xref rid="btz318-B16" ref-type="bibr">Geeleher <italic>et al.</italic> (2014)</xref> showed that a ridge regression model trained on GDCS gene expression data is translatable to Docetaxel, Cisplatin, Erlotinib and Bortezomib clinical trial data. They also showed that, for Docetaxel, including non-breast cancer cell lines in model training increases the predictive power of the final model compared to the model only trained on breast cancer cell lines. This ridge regression-based pipeline on gene expression also imputed the drug response for The Cancer TCGA (<xref rid="btz318-B17" ref-type="bibr">Geeleher <italic>et al.</italic>, 2017</xref>; <xref rid="btz318-B42" ref-type="bibr">Weinstein <italic>et al.</italic>, 2013</xref>). Despite the predictive power of gene expression, adding other omics data types can increase the predictive power especially in pan-cancer models (<xref rid="btz318-B23" ref-type="bibr">Iorio <italic>et al.</italic>, 2016</xref>).</p>
    <p>Multi-omics data provide a machine learning model with different views of the same sample and promise better characterization of biological processes (<xref rid="btz318-B3" ref-type="bibr">Argelaguet <italic>et al.</italic>, 2018</xref>; <xref rid="btz318-B41" ref-type="bibr">Wang <italic>et al.</italic>, 2014</xref>). Multi-omics data have been exploited for different problems such as driver gene identification (<xref rid="btz318-B9" ref-type="bibr">Dimitrakopoulos <italic>et al.</italic>, 2018</xref>; <xref rid="btz318-B33" ref-type="bibr">Mo <italic>et al.</italic>, 2013</xref>; <xref rid="btz318-B38" ref-type="bibr">Shrestha <italic>et al.</italic>, 2017</xref>; <xref rid="btz318-B39" ref-type="bibr">Singh <italic>et al.</italic>, 2019</xref>), patient stratification (<xref rid="btz318-B26" ref-type="bibr">Khakabimamaghani and Ester, 2016</xref>), survival prediction (<xref rid="btz318-B5" ref-type="bibr">Chaudhary <italic>et al.</italic>, 2018</xref>), subgroup discovery (<xref rid="btz318-B29" ref-type="bibr">Liang <italic>et al.</italic>, 2015</xref>) and drug response prediction (<xref rid="btz318-B10" ref-type="bibr">Ding <italic>et al.</italic>, 2018</xref>). For the drug response prediction, <xref rid="btz318-B10" ref-type="bibr">Ding <italic>et al.</italic> (2018)</xref> proposed a method that concatenates mutation, CNA and gene expression data and applies autoencoders to learn features for the concatenated multi-omics cell line data. The learned features were used as the input of an elastic net classifier which predicts the binarized IC50 values. We note that the classifier was validated only on CCLE cell lines without studying its translatability to patients or PDX models.</p>
    <p>A critical challenge in multi-omics data analysis is how to integrate different data types. There are two major approaches to multi-omics integration: early integration and late integration (<xref rid="btz318-B35" ref-type="bibr">Rappoport and Shamir, 2018</xref>; <xref rid="btz318-B46" ref-type="bibr">Zitnik <italic>et al.</italic>, 2019</xref>). In early integration, all omics data types available for a sample are first concatenated, and then an integrated representation of the sample is created by applying some feature learning method, such as autoencoders (<xref rid="btz318-B19" ref-type="bibr">Goodfellow <italic>et al.</italic>, 2016</xref>), to that representation. Early integration has three disadvantages: first, it disregards the unique distribution of each omics data type. Second, it requires proper normalization to avoid giving more weight to the omics data type with more dimensions. Third, it further increases the dimensionality of the input data which often is already a challenge for single-omics input data (<xref rid="btz318-B35" ref-type="bibr">Rappoport and Shamir, 2018</xref>). In late integration, features are learned separately for each omics data type, and these features are then integrated into one unified representation to be used as the input for a classifier or a regressor. The advantage of this approach is that it works with the unique distribution of each omics data type, it can employ single-omics normalization for each data type, and it does not increase the dimensionality of the input space.</p>
    <p>In this paper, we explore the problem of drug response prediction and propose MOLI, a <bold>m</bold>ulti-<bold>o</bold>mics <bold>l</bold>ate <bold>i</bold>ntegration method based on deep neural networks. MOLI takes somatic mutation, CNA and gene expression data as input, and predicts the response to a given drug as the output. MOLI learns features for each omics data type by type-specific encoding sub-networks and concatenates the learned features into one representation of the multi-omics profiles. To the best of our knowledge, MOLI is the first end-to-end late integration method with deep neural networks that optimizes this representation via a combined cost function consisting of a triplet loss function (<xref rid="btz318-B37" ref-type="bibr">Schroff <italic>et al.</italic>, 2015</xref>) and a binary cross-entropy loss function. The former makes the representations of responder cell lines more similar to each and different from the representations of non-responder cell lines and the latter makes this representation predictive of the IC50 values. As another contribution, MOLI employs transfer learning to increase the size of the training dataset. It trains a drug response model on pan-drug inputs (using all the drugs with the same target) instead of drug-specific inputs. <xref ref-type="fig" rid="btz318-F1">Figure 1</xref> illustrates the workflow of MOLI.
</p>
    <fig id="btz318-F1" orientation="portrait" position="float">
      <label>Fig. 1.</label>
      <caption>
        <p>Schematic overview of MOLI (<bold>A</bold>) pre-processing mutation, CNA and gene expression data. (<bold>B</bold>) Each encoding sub-network learns features for its omics data type and the learned features are concatenated into one representation. (<bold>C</bold>) MOLI cost function consists of a triplet loss and a classification loss, obtained from the classifier sub-network that uses the multi-omics representation to predict drug response</p>
      </caption>
      <graphic xlink:href="btz318f1"/>
    </fig>
    <p>We validated MOLI on <italic>in vitro</italic> (PDX) and <italic>in vivo</italic> (TCGA patients) datasets for five chemotherapy agents and two targeted therapeutics. Our comparison with the state-of-the-art single-omics and early integration multi-omics methods showed that MOLI can achieve significantly better performance in terms of Area Under the receiver operating characteristic Curve (AUC) on PDX and patient data. Moreover, we observed substantial improvement in MOLI’s performance for targeted drugs when training on a pan-drug dataset compared to training on drug-specific datasets. We conclude that MOLI models trained on <italic>in vitro</italic> data translate well to <italic>in vivo</italic> data and may have utility for precision oncology. Finally, we showed that the responses predicted by MOLI—while trained on the pan-drug input for the epidermal growth factor receptor (EGFR) inhibitors—for breast, lung, kidney and prostate cancers from TCGA patients (without recorded drug response) had statistically significant associations with some of the genes in the EGFR pathway. This shows that MOLI captures biological aspects of the response.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 MOLI</title>
      <p>MOLI is a deep neural network that predicts the drug response for a given sample, represented by its multi-omics profile, and for a given drug. MOLI assumes that values for the same genes are provided for each omics data type. MOLI’s network consists of the following sub-networks. It has multiple feed forward encoding sub-networks, one for each input omics data type. Each encoding sub-network receives its corresponding omics data and encodes it into a learned feature space. The learned features from the encoding sub-networks are integrated into one representation by concatenation. The concatenated representation serves as input for a classification sub-network, which predicts the drug response. The entire network is trained in an end-to-end fashion using a cost function combining a classification loss and a triplet loss. <xref ref-type="fig" rid="btz318-F1">Figure 1</xref> shows MOLI’s components during training and model development, while <xref ref-type="fig" rid="btz318-F2">Figure 2A</xref> shows the application of MOLI for external validation.
</p>
      <fig id="btz318-F2" orientation="portrait" position="float">
        <label>Fig. 2.</label>
        <caption>
          <p>(<bold>A</bold>) Using MOLI to make predictions for PDX/patient inputs during external validation. (<bold>B</bold>) Combining targeted drugs that target the same pathway or molecule to make a pan-drug training dataset for MOLI</p>
        </caption>
        <graphic xlink:href="btz318f2"/>
      </fig>
      <sec>
        <label>2.1.1</label>
        <title>Learning features by encoding sub-networks</title>
        <p>To learn features for each omics data type in the input, we design separate encoding feed forward sub-networks to map the input space to the feature space. In this paper, we focus on mutation, CNA and gene expression data. <italic>X</italic><sub>M</sub>, <italic>X</italic><sub>E</sub> and <italic>X</italic><sub>C</sub> denote mutation, CNA and gene expression data, respectively, each of which are of dimensionality <italic>N  </italic>×<italic>  D</italic>, where <italic>N</italic> is the number of samples and <italic>D</italic> is the number of genes. We note that the proposed approach can be extended for any number of omics data types. Each encoding sub-network has a fully connected layer with Rectified linear unit (ReLU) activation functions. In addition, each sub-network employs dropout to regularize the model and batch normalization to enhance the training process. The input of each encoding sub-network is one omics data type and the output is the learned features for that omics (<xref ref-type="fig" rid="btz318-F1">Fig. 1B</xref>). We denote these sub-networks as <inline-formula id="IE1"><mml:math id="IM1"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">M</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">M</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> and <inline-formula id="IE2"><mml:math id="IM2"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula>, respectively.</p>
      </sec>
      <sec>
        <label>2.1.2</label>
        <title>Integrating learned features by late integration</title>
        <p>In the integration step, we utilize a late integration approach and concatenate the learned features of the different single-omics data types to obtain one multi-omics representation. For example, if the outputs of three encoding sub-networks are three <italic>M  </italic>×<italic>  N</italic> feature matrices, after concatenation, the output will be one <inline-formula id="IE3"><mml:math id="IM3"><mml:mi>M</mml:mi><mml:mo>×</mml:mo><mml:mn>3</mml:mn><mml:mi>N</mml:mi></mml:math></inline-formula> representation matrix. The integrated representation is further smoothed through an <italic>l</italic>2 normalization layer. We denote MOLI’s integration, receiving multi-omics data as input and returning the integrated representation, as follows:
<disp-formula id="E1"><label>(1)</label><mml:math id="M1"><mml:mo> </mml:mo><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">M</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">M</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">M</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo> ⊕ </mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo> ⊕ </mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:math></disp-formula>
where, ⊕ denotes the concatenation operator.</p>
      </sec>
      <sec>
        <label>2.1.3</label>
        <title>Optimizing the learned features by the combined cost function</title>
        <p>The learned features will be used by a classifier that predicts the drug response. Therefore, the last sub-network of MOLI is a classification layer with the Sigmoid activation function, using dropout and weight decay for regularization (<xref ref-type="fig" rid="btz318-F1">Fig. 1C</xref>). We denote this classifier as <italic>g(.)</italic>. Since the MOLI network will be used for classification, i.e. drug response prediction, the cost function used for training must include a term that measures the difference between the predicted drug response and the ground truth drug response. We choose the binary cross-entropy classification loss, one of the most common classification losses, defined as follows:
<disp-formula id="E2"><mml:math id="M2"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mi mathvariant="double-struck">L</mml:mi><mml:msub><mml:mrow/><mml:mrow><mml:mi mathvariant="normal">Classifier</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mo>[</mml:mo><mml:mi mathvariant="italic">Y</mml:mi><mml:mo> </mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mo> </mml:mo><mml:mi>g</mml:mi><mml:mo>(</mml:mo><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">M</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>Y</mml:mi><mml:mo>)</mml:mo><mml:mi mathvariant="normal">log</mml:mi><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>g</mml:mi><mml:mo>(</mml:mo><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">M</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>]</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
where, <inline-formula id="IE4"><mml:math id="IM4"><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> denotes the binarized IC50 which is used as measure for the drug response.We add a triplet loss to the cost function to impose a further constraint that is necessary for accurate classification. This constraint forces responders to be more similar to each other than to non-responders. The triplet loss function was introduced in FaceNet (<xref rid="btz318-B37" ref-type="bibr">Schroff <italic>et al.</italic>, 2015</xref>) for optimizing the mapping from a space of face images to a Euclidean space where the difference between learned features is correlated with the similarity among faces. The idea is that for the image of a given person’s face, the distance between that image’s learned features and the features of another image of the same person should be smaller than the distance between that image’s learned features and the learned features of the image of some other person. In our context, we employ the triplet loss function as follows. For <italic>T</italic> given triplets in the form of (Anchor, Positive, Negative), where the first two are (the multi-omics data of) responder cell lines to a given anti-cancer drug and the last one is (the multi-omics data of) a non-responder to that drug, we require the following condition: <inline-formula id="IE5"><mml:math id="IM5"><mml:mi>d</mml:mi><mml:mo>(</mml:mo><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="normal">Ancho</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="normal">Positiv</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>≤</mml:mo><mml:mi>d</mml:mi><mml:mo>(</mml:mo><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="normal">Ancho</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="normal">Negativ</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:math></inline-formula>, where <italic>d(.)</italic> is an arbitrary distance function—we used the Euclidean distance.If we move the right hand-side to the left, we obtain:
<disp-formula id="E3"><mml:math id="M3"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mi>d</mml:mi><mml:mo>(</mml:mo><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="italic">Ancho</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="italic">Positiv</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mo>-</mml:mo><mml:mi>d</mml:mi><mml:mo>(</mml:mo><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="italic">Ancho</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="italic">Negativ</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>≤</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>.</mml:mo></mml:math></disp-formula>
In order to avoid the trivial zero solution, a margin <inline-formula id="IE6"><mml:math id="IM6"><mml:mo>ξ</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> is required:
<disp-formula id="E4"><mml:math id="M4"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mi>d</mml:mi><mml:mo>(</mml:mo><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="italic">Ancho</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="italic">Positiv</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mo>-</mml:mo><mml:mi>d</mml:mi><mml:mo>(</mml:mo><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="italic">Ancho</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="italic">Negativ</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mo>ξ</mml:mo><mml:mo>≤</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>.</mml:mo></mml:math></disp-formula>
We want the distance of the Anchor and the Negative to be larger than the distance of the Anchor and the Positive. Thus, the value of the triplet loss function for the <italic>i</italic>-th triplet is:
<disp-formula id="E5"><mml:math id="M5"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">L</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Triplet</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="italic">max</mml:mi><mml:mo>[</mml:mo><mml:mi>d</mml:mi><mml:mo>(</mml:mo><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="italic">Ancho</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="italic">Positiv</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mo>-</mml:mo><mml:mi>d</mml:mi><mml:mo>(</mml:mo><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="italic">Ancho</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="italic">Negativ</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mo>ξ</mml:mo><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
and the total triplet loss for <italic>T</italic> triplets is:
<disp-formula id="E6"><label>(2)</label><mml:math id="M6"><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="double-struck">L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Triplet</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">L</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Triplet</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula>
Generally, there are two approaches to select triplets for the triplet loss function: offline selection and online selection. The offline selection builds the triplets based on the value of the labels (in this case the drug response) before training the model. The online selection selects the triplets from samples in each mini-batch during the training. We adopted the online approach. Triplets can be built based on all possible combinations of the input samples/mini-batches (soft selection) or based only on those triplets with high triplet loss value (hard selection). Soft selection provides the model with more training triplet examples but the network might rely too much on easy cases, and as a result may be unable to perform well on hard examples (<xref rid="btz318-B37" ref-type="bibr">Schroff <italic>et al.</italic>, 2015</xref>). Hard selection solves this problem by only relying on the hard cases in the train data to build the triplets, but this approach may suffer from having fewer training triplets especially in the case of small unbalanced datasets. We adopted the soft selection approach.</p>
        <p>Therefore, the combined cost <italic>J</italic> is defined as follows:
<disp-formula id="E7"><label>(3)</label><mml:math id="M7"><mml:mo> </mml:mo><mml:mi>J</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="double-struck">L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Classifier</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="normal">γ</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="double-struck">L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Triplet</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math></disp-formula>
where γ is a regularization term for the triplet loss.</p>
      </sec>
    </sec>
    <sec>
      <title>2.2 Transfer learning for targeted drugs</title>
      <p>For targeted drugs, we use transfer learning and train MOLI with a new pan-drug input. This pan-drug input consists of multi-omics profiles and drug responses for a family of targeted drugs that target the same pathway or molecule. Such drugs are expected to produce highly correlated responses in cell lines. One MOLI model is trained for a family of drugs instead of one separate model for each individual drug. This approach increases the training dataset size, since the set of the screened cell lines and the obtained responses are similar but not identical for the drugs of one family. In our experiments, we evaluate transfer learning for EGFR pathway inhibitors due to the availability of external validation data, but the approach is applicable to any family of targeted drugs. <xref ref-type="fig" rid="btz318-F2">Figure 2B</xref> illustrates the idea of transfer learning for targeted drugs.</p>
    </sec>
    <sec>
      <title>2.3 Predicting drug response for TCGA patients</title>
      <p>To study MOLI’s performance, similar to <xref rid="btz318-B17" ref-type="bibr">Geeleher <italic>et al.</italic> (2017)</xref>, we employ the model trained on the pan-drug input for the EGFR inhibitors to predict the drug response for patients in several TCGA datasets for which there was no drug response recorded. Since these drugs target EGFR pathway, we expect the expression status of the genes of this pathway to be strongly correlated with the predicted drug response. We obtain the list of genes in EGFR pathway from REACTOME. To study the correlation, we employ multiple linear regression between the predicted responses and the level of expression. We obtain <italic>P</italic>-values for each gene and correct them for multiple comparisons, using Bonferroni correction (<inline-formula id="IE7"><mml:math id="IM7"><mml:mi mathvariant="normal">α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:math></inline-formula>).</p>
    </sec>
    <sec>
      <title>2.4 Datasets</title>
      <p>We use four main resources in this paper:
<list list-type="bullet"><list-item><p>GDSC cell lines dataset (<xref rid="btz318-B23" ref-type="bibr">Iorio <italic>et al.</italic>, 2016</xref>).</p></list-item><list-item><p>PDX Encyclopedia dataset (<xref rid="btz318-B14" ref-type="bibr">Gao <italic>et al.</italic>, 2015</xref>).</p></list-item><list-item><p>TCGA patients with the drug response available in their records (<xref rid="btz318-B11" ref-type="bibr">Ding <italic>et al.</italic>, 2016</xref>).</p></list-item><list-item><p>TCGA patients without the drug response (<xref rid="btz318-B42" ref-type="bibr">Weinstein <italic>et al.</italic>, 2013</xref>).</p></list-item></list></p>
      <p>The GDSC dataset (<xref rid="btz318-B23" ref-type="bibr">Iorio <italic>et al.</italic>, 2016</xref>; <xref rid="btz318-B43" ref-type="bibr">Yang <italic>et al.</italic>, 2012</xref>) has created a multi-omics dataset of more than a thousand cell lines from different cancer types, screened with 265 targeted and chemotherapy drugs. We use GDSC as the training dataset due to a high number of screened drugs. Multi-omics profiles and drug responses for GDSC are retrieved from <ext-link ext-link-type="uri" xlink:href="http://ftp://ftp.sanger.ac.uk/pub/project/cancerrxgene/releases/release-7.0/">ftp://ftp.sanger.ac.uk/pub/project/cancerrxgene/releases/release-7.0/</ext-link>.</p>
      <p>We use the other publicly available multi-omics datasets for external validation as follows:
<list list-type="order"><list-item><p>We apply PDX Encyclopedia mice models published by <xref rid="btz318-B14" ref-type="bibr">Gao <italic>et al.</italic> (2015)</xref>. This dataset has more than 300 PDX models for different cancer types, screened with 34 targeted and chemotherapy drugs.</p></list-item><list-item><p>TCGA (<xref rid="btz318-B42" ref-type="bibr">Weinstein <italic>et al.</italic>, 2013</xref>) data including profiles of tumor samples collected from more than 10<italic> </italic>000 patients with different cancer types, downloaded from Firehose Broad GDAC (<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.7908/C11G0KM9">https://doi.org/10.7908/C11G0KM9</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://gdac.broadinstitute.org/runs/stddata__2016_01_28/">http://gdac.broadinstitute.org/runs/stddata__2016_01_28/</ext-link>). For TCGA datasets, we use clinical annotations of the drug response for some patients which were obtained from Supplementary Material of <xref rid="btz318-B11" ref-type="bibr">Ding <italic>et al.</italic> (2016)</xref>.</p></list-item><list-item><p>We also use TCGA patients for breast (BRCA), bladder (BLCA), pancreatic (PAAD), lung (LUAD), kidney (KIRP) and prostate (PRAD) cancers. These patients are without the drug response in their records.</p></list-item></list></p>
      <p>We note that we used only those genes which are in common for all of the omics data types in both training and external validation datasets for each drug.</p>
      <p>The data pre-processing steps and the used resource files are summarized below and are presented in more detail in the Supplementary Material (Section S1) and <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref>. <xref rid="btz318-T1" ref-type="table">Table 1</xref> provides the characteristics of each dataset such as type of drug, the number of samples and the number of genes. After the pre-processing, we have the same number of genes for the training and the external validation datasets and for each of the three omics data types. We only consider samples for which all three omics data types are available.</p>
      <table-wrap id="btz318-T1" orientation="portrait" position="float">
        <label>Table 1.</label>
        <caption>
          <p>List of the studied drugs from the used resources with multi-omics profiles available</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="(" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Drug</th>
              <th align="left" rowspan="1" colspan="1">Type</th>
              <th align="left" rowspan="1" colspan="1">Resource</th>
              <th align="left" rowspan="1" colspan="1">Number of samples<xref ref-type="table-fn" rid="tblfn2"><sup>a</sup></xref></th>
              <th align="left" rowspan="1" colspan="1">Number of genes<xref ref-type="table-fn" rid="tblfn3"><sup>b</sup></xref></th>
              <th align="left" rowspan="1" colspan="1">Usage</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Afatinib</td>
              <td rowspan="1" colspan="1">Targeted</td>
              <td rowspan="1" colspan="1">GDSC</td>
              <td rowspan="1" colspan="1">828 (NR: 678, RS: 150)</td>
              <td rowspan="1" colspan="1">13<italic> </italic>081</td>
              <td rowspan="1" colspan="1">Training</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Cetuximab</td>
              <td rowspan="1" colspan="1">Targeted</td>
              <td rowspan="1" colspan="1">GDSC</td>
              <td rowspan="1" colspan="1">856 (NR: 735, RS: 121)</td>
              <td rowspan="1" colspan="1">12<italic> </italic>346<xref ref-type="table-fn" rid="tblfn4"><sup>c</sup></xref>/13<italic> </italic>081<xref ref-type="table-fn" rid="tblfn5"><sup>d</sup></xref></td>
              <td rowspan="1" colspan="1">Training</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Cetuximab</td>
              <td rowspan="1" colspan="1">Targeted</td>
              <td rowspan="1" colspan="1">PDX</td>
              <td rowspan="1" colspan="1">60 (NR: 55, RS: 5)</td>
              <td rowspan="1" colspan="1">12<italic> </italic>346<xref ref-type="table-fn" rid="tblfn4"><sup>c</sup></xref>/13<italic> </italic>081<xref ref-type="table-fn" rid="tblfn5"><sup>d</sup></xref></td>
              <td rowspan="1" colspan="1">External validation</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Cisplatin</td>
              <td rowspan="1" colspan="1">Chemotherapy</td>
              <td rowspan="1" colspan="1">GDSC</td>
              <td rowspan="1" colspan="1">829 (NR: 752, RS: 77)</td>
              <td rowspan="1" colspan="1">15<italic> </italic>493</td>
              <td rowspan="1" colspan="1">Training</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Cisplatin</td>
              <td rowspan="1" colspan="1">Chemotherapy</td>
              <td rowspan="1" colspan="1">TCGA</td>
              <td rowspan="1" colspan="1">66 (NR: 6, RS: 60)</td>
              <td rowspan="1" colspan="1">15<italic> </italic>493</td>
              <td rowspan="1" colspan="1">External validation</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Docetaxel</td>
              <td rowspan="1" colspan="1">Chemotherapy</td>
              <td rowspan="1" colspan="1">GDSC</td>
              <td rowspan="1" colspan="1">829 (NR: 764, RS: 65)</td>
              <td rowspan="1" colspan="1">15<italic> </italic>016</td>
              <td rowspan="1" colspan="1">Training</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Docetaxel</td>
              <td rowspan="1" colspan="1">Chemotherapy</td>
              <td rowspan="1" colspan="1">TCGA</td>
              <td rowspan="1" colspan="1">16 (NR: 8, RS: 8)</td>
              <td rowspan="1" colspan="1">15<italic> </italic>016</td>
              <td rowspan="1" colspan="1">External validation</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Erlotinib</td>
              <td rowspan="1" colspan="1">Targeted</td>
              <td rowspan="1" colspan="1">GDSC</td>
              <td rowspan="1" colspan="1">362 (NR: 298, RS: 64)</td>
              <td rowspan="1" colspan="1">12<italic> </italic>325<xref ref-type="table-fn" rid="tblfn4"><sup>c</sup></xref>/13<italic> </italic>081<xref ref-type="table-fn" rid="tblfn5"><sup>d</sup></xref></td>
              <td rowspan="1" colspan="1">Training</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Erlotinib</td>
              <td rowspan="1" colspan="1">Targeted</td>
              <td rowspan="1" colspan="1">PDX</td>
              <td rowspan="1" colspan="1">21 (NR: 18, RS: 3)</td>
              <td rowspan="1" colspan="1">12<italic> </italic>325<xref ref-type="table-fn" rid="tblfn4"><sup>c</sup></xref>/13<italic> </italic>081<xref ref-type="table-fn" rid="tblfn5"><sup>d</sup></xref></td>
              <td rowspan="1" colspan="1">External validation</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Gefitinib</td>
              <td rowspan="1" colspan="1">Targeted</td>
              <td rowspan="1" colspan="1">GDSC</td>
              <td rowspan="1" colspan="1">825 (NR: 710, RS: 115)</td>
              <td rowspan="1" colspan="1">13<italic> </italic>081</td>
              <td rowspan="1" colspan="1">Training</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Gemcitabine</td>
              <td rowspan="1" colspan="1">Chemotherapy</td>
              <td rowspan="1" colspan="1">GDSC</td>
              <td rowspan="1" colspan="1">844 (NR: 790, RS: 54)</td>
              <td rowspan="1" colspan="1">12<italic> </italic>067/15<italic> </italic>381</td>
              <td rowspan="1" colspan="1">Training</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Gemcitabine</td>
              <td rowspan="1" colspan="1">Chemotherapy</td>
              <td rowspan="1" colspan="1">PDX</td>
              <td rowspan="1" colspan="1">25 (NR: 18, RS: 7)</td>
              <td rowspan="1" colspan="1">12<italic> </italic>067</td>
              <td rowspan="1" colspan="1">External validation</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Gemcitabine</td>
              <td rowspan="1" colspan="1">Chemotherapy</td>
              <td rowspan="1" colspan="1">TCGA</td>
              <td rowspan="1" colspan="1">57 (NR: 36, RS: 21)</td>
              <td rowspan="1" colspan="1">15<italic> </italic>381</td>
              <td rowspan="1" colspan="1">External validation</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Lapatinib</td>
              <td rowspan="1" colspan="1">Targeted</td>
              <td rowspan="1" colspan="1">GDSC</td>
              <td rowspan="1" colspan="1">387 (NR: 326, RS: 61)</td>
              <td rowspan="1" colspan="1">13<italic> </italic>081</td>
              <td rowspan="1" colspan="1">Training</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Paclitaxel</td>
              <td rowspan="1" colspan="1">Chemotherapy</td>
              <td rowspan="1" colspan="1">GDSC</td>
              <td rowspan="1" colspan="1">389 (NR: 363, RS: 26)</td>
              <td rowspan="1" colspan="1">12<italic> </italic>482</td>
              <td rowspan="1" colspan="1">Training</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Paclitaxel</td>
              <td rowspan="1" colspan="1">Chemotherapy</td>
              <td rowspan="1" colspan="1">PDX</td>
              <td rowspan="1" colspan="1">43 (NR: 38, RS: 5)</td>
              <td rowspan="1" colspan="1">12<italic> </italic>482</td>
              <td rowspan="1" colspan="1">External validation</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Pan-drug</td>
              <td rowspan="1" colspan="1">Targeted</td>
              <td rowspan="1" colspan="1">GDSC</td>
              <td rowspan="1" colspan="1">3258 (NR: 2747, RS: 511)</td>
              <td rowspan="1" colspan="1">13<italic> </italic>081</td>
              <td rowspan="1" colspan="1">Training</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p><italic>Note</italic>: NR, non-responder; RS, responder.</p>
          </fn>
          <fn id="tblfn2">
            <label>a</label>
            <p>Number of screened samples with all three omics data types available.</p>
          </fn>
          <fn id="tblfn3">
            <label>b</label>
            <p>Number of genes in common between the train data and the external validation data for each drug.</p>
          </fn>
          <fn id="tblfn4">
            <label>c</label>
            <p>Number of genes for the drug-specific experiments.</p>
          </fn>
          <fn id="tblfn5">
            <label>d</label>
            <p>Number of genes for the pan-drug experiments.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <sec>
        <label>2.4.1</label>
        <title>Gene expression profiles</title>
        <p>Raw intensities are obtained from ArrayExpress (E-MTAB-3610) for GDSC dataset were RMA-normalized (<xref rid="btz318-B24" ref-type="bibr">Irizarry <italic>et al.</italic>, 2003</xref>), log-transformed and aggregated to the level of genes. Gene expression values of PDX and all TCGA datasets are converted to TPM (<xref rid="btz318-B28" ref-type="bibr">Li and Dewey, 2011</xref>) and log-transformed. FPKM values for PDX samples are converted into TPM and log-transformed. To make expression profiled by different platforms comparable, we standardize gene expression and perform pairwise homogenization procedure, as described in <xref rid="btz318-B16" ref-type="bibr">Geeleher <italic>et al.</italic> (2014</xref>) and <xref rid="btz318-B25" ref-type="bibr">Johnson <italic>et al.</italic> (2007)</xref>. Also, in each dataset we exclude the 5% of genes with lowest variance assuming them to be not informative.</p>
      </sec>
      <sec>
        <label>2.4.2</label>
        <title>Somatic copy number profiles</title>
        <p>We remove unreliable segments from genome segmentation files for TCGA datasets and assign every gene a value corresponding to the intensity log-ratio of the segment it overlaps. If the gene overlaps more than one segment, we keep the most extreme log-ratio value. Different from TCGA, the GDSC and PDX datasets provided gene-level estimates of total copy number. In order to make these data comparable with TCGA, we compute for every gene the logarithm of its copy number divided by the ploidy of copy-neutral state in the sample. Finally, for all four datasets we binarize gene-level copy number estimates assigning zeros to copy-neutral genes and ones to all genes overlapping deletions or amplifications.</p>
      </sec>
      <sec>
        <label>2.4.3</label>
        <title>Somatic point mutations</title>
        <p>Similarly with previous works (<xref rid="btz318-B10" ref-type="bibr">Ding <italic>et al.</italic>, 2018</xref>; <xref rid="btz318-B23" ref-type="bibr">Iorio <italic>et al.</italic>, 2016</xref>), we assign ones to genes carrying somatic point mutations and zeros to all others.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Experimental design</title>
      <p>In our experiments, we investigated the following questions:
<list list-type="bullet"><list-item><p>Does MOLI outperform single-omics and early integration baselines in terms of prediction AUC on PDX and patient data?</p></list-item><list-item><p>Does transfer learning work for targeted drugs, i.e. does MOLI trained on pan-drug data outperform MOLI trained on drug-specific (single drug) data?</p></list-item><list-item><p>Finally, for the targeted drugs, does the predicted response by MOLI have associations with the target of that drug?</p></list-item></list></p>
      <p>We trained MOLI on GDSC cell lines screened with Docetaxel, Cisplatin, Gemcitabine, Paclitaxel, Erlotinib and Cetuximab. We chose these drugs based on availability of PDX/patient multi-omics data for these drugs which is necessary for external validations. We trained all of the baselines for the same drugs and compared them to MOLI in terms of prediction AUC.</p>
      <p>We compared MOLI against early integration via deep neural networks inspired by <xref rid="btz318-B10" ref-type="bibr">Ding <italic>et al.</italic> (2018)</xref> and early integration via non-negative matrix factorization (NMF) (<xref rid="btz318-B8" ref-type="bibr">Cichocki and Phan, 2009</xref>; <xref rid="btz318-B13" ref-type="bibr">Févotte and Idier, 2011</xref>), against the single-omics (gene expression) ridge regression method proposed by <xref rid="btz318-B16" ref-type="bibr">Geeleher <italic>et al.</italic> (2014)</xref>, against an ordinary feed forward network with classification loss trained on the expression data, and against a version of MOLI trained only on the gene expression data. To test whether the triplet loss contributes to improve the performance, we compared MOLI to a late integration feed forward network with an architecture similar to MOLI but using only a classification loss.</p>
      <p>Finally, to study transfer learning for the targeted drugs, we focused on drugs that target the EGFR pathway because we have Cetuximab and Erlotinib that target this pathway in the PDX dataset utilized for external validations. In addition, GDSC was screened with numerous drugs that target EGFR including: Afatinib, Cetuximab, Erlotinib, Gefitinib and Lapatinib. We used multi-omics data of all of these drugs in GDSC and created a large training set (&gt;3000 samples). We trained MOLI on this pan-drug data and compared the results to MOLI which was trained on the drug-specific inputs.</p>
      <p>We used 5-fold cross validation in most of the experiments to tune the hyper-parameters of the deep neural networks based on the AUC. The hyper-parameters tuned were number of nodes in the hidden layers, learning rates, mini-batch size, weight decay, the dropout rate, number of epochs and margin and regularization term (only for the triplet loss). Details on the ranges considered for each hyper-parameter and the selected settings for each drug are provided in Supplementary Tables S2 and S3. Finally, the network was re-trained on the obtained hyper-parameters on the entire dataset for that drug (train and validation). We used Adagrad for optimizing parameters in all of the deep neural networks (<xref rid="btz318-B12" ref-type="bibr">Duchi <italic>et al.</italic>, 2011</xref>). We used the PyTorch framework to implement all deep neural networks codes. For the ridge regression pipeline, we downloaded the implemented pipeline with leave-one-out cross validation provided by the original authors (<xref rid="btz318-B16" ref-type="bibr">Geeleher <italic>et al.</italic>, 2014</xref>) and applied it to our datasets. To make sure that both the downloaded pipeline and the way we pre-processed the gene expression data are correct, we evaluated it on the datasets from the original paper and got AUCs for Docetaxel and Bortezomib comparable to those of <xref rid="btz318-B22" ref-type="bibr">He <italic>et al.</italic> (2018)</xref>. For early integration via NMF, we first concatenate the omics data types, and then train an NMF on the resulting matrix to learn the latent factors. Finally we train the <xref rid="btz318-B16" ref-type="bibr">Geeleher <italic>et al.</italic> (2014)</xref> method (using the learned factors as features) to predict the drug response. The details of this new baseline and the tuning of its hyper-parameter are presented in the Supplementary Material (Section S2).</p>
    </sec>
    <sec>
      <title>3.2 Multi-omics integration by MOLI improves the drug response performance</title>
      <p><xref rid="btz318-T2" ref-type="table">Table 2</xref> reports the performance of MOLI and the baselines in terms of AUC.</p>
      <table-wrap id="btz318-T2" orientation="portrait" position="float">
        <label>Table 2.</label>
        <caption>
          <p>Performance of different versions of MOLI compared to the baselines in terms of prediction AUC across two targeted therapeutics and five chemotherapy agents</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Method</th>
              <th align="left" rowspan="1" colspan="1">PDX</th>
              <th align="left" rowspan="1" colspan="1">PDX</th>
              <th align="left" rowspan="1" colspan="1">PDX</th>
              <th align="left" rowspan="1" colspan="1">PDX</th>
              <th align="left" rowspan="1" colspan="1">TCGA</th>
              <th align="left" rowspan="1" colspan="1">TCGA</th>
              <th align="left" rowspan="1" colspan="1">TCGA</th>
              <th rowspan="2" colspan="1">Input omics</th>
            </tr>
            <tr>
              <th align="left" rowspan="1" colspan="1">Drug</th>
              <th align="left" rowspan="1" colspan="1">Paclitaxel</th>
              <th align="left" rowspan="1" colspan="1">Gemcitabine</th>
              <th align="left" rowspan="1" colspan="1">Cetuximab</th>
              <th align="left" rowspan="1" colspan="1">Erlotinib</th>
              <th align="left" rowspan="1" colspan="1">Docetaxel</th>
              <th align="left" rowspan="1" colspan="1">Cisplatin</th>
              <th align="left" rowspan="1" colspan="1">Gemcitabine</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">
                <xref rid="btz318-B16" ref-type="bibr">Geeleher <italic>et al.</italic> (2014)</xref>
              </td>
              <td rowspan="1" colspan="1">0.52</td>
              <td rowspan="1" colspan="1">0.59</td>
              <td rowspan="1" colspan="1">
                <italic>0.58</italic>
              </td>
              <td rowspan="1" colspan="1">
                <italic>0.67</italic>
              </td>
              <td rowspan="1" colspan="1">0.59</td>
              <td rowspan="1" colspan="1">0.62</td>
              <td rowspan="1" colspan="1">0.53</td>
              <td rowspan="1" colspan="1">Expression</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Early integration via NMF</td>
              <td rowspan="1" colspan="1">0.24</td>
              <td rowspan="1" colspan="1">0.56</td>
              <td rowspan="1" colspan="1">0.53</td>
              <td rowspan="1" colspan="1">0.28</td>
              <td rowspan="1" colspan="1">0.39</td>
              <td rowspan="1" colspan="1">0.40</td>
              <td rowspan="1" colspan="1">0.58</td>
              <td rowspan="1" colspan="1">Multi</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Early integration via DNNs</td>
              <td rowspan="1" colspan="1">NSC</td>
              <td rowspan="1" colspan="1">
                <bold>0.66</bold>
              </td>
              <td rowspan="1" colspan="1">NSC</td>
              <td rowspan="1" colspan="1">NSC</td>
              <td rowspan="1" colspan="1">0.52</td>
              <td rowspan="1" colspan="1">NSC</td>
              <td rowspan="1" colspan="1">0.59</td>
              <td rowspan="1" colspan="1">Multi</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Feed forward net</td>
              <td rowspan="1" colspan="1">0.68</td>
              <td rowspan="1" colspan="1">0.48</td>
              <td rowspan="1" colspan="1">0.43</td>
              <td rowspan="1" colspan="1">0.37</td>
              <td rowspan="1" colspan="1">
                <bold>0.69</bold>
              </td>
              <td rowspan="1" colspan="1">0.44</td>
              <td rowspan="1" colspan="1">
                <italic>0.65</italic>
              </td>
              <td rowspan="1" colspan="1">Expression</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">MOLI complete</td>
              <td rowspan="1" colspan="1">
                <italic>0.69</italic>
              </td>
              <td rowspan="1" colspan="1">0.52</td>
              <td rowspan="1" colspan="1">0.51</td>
              <td rowspan="1" colspan="1">0.39</td>
              <td rowspan="1" colspan="1">
                <italic>0.63</italic>
              </td>
              <td rowspan="1" colspan="1">
                <bold>0.75</bold>
              </td>
              <td rowspan="1" colspan="1">0.64</td>
              <td rowspan="1" colspan="1">Expression</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">MOLI with classifier</td>
              <td rowspan="1" colspan="1">NSC</td>
              <td rowspan="1" colspan="1">0.55</td>
              <td rowspan="1" colspan="1">0.46</td>
              <td rowspan="1" colspan="1">NSC</td>
              <td rowspan="1" colspan="1">0.58</td>
              <td rowspan="1" colspan="1">0.6</td>
              <td rowspan="1" colspan="1">
                <bold>0.69</bold>
              </td>
              <td rowspan="1" colspan="1">Multi</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">MOLI complete</td>
              <td rowspan="1" colspan="1">
                <bold>0.74</bold>
              </td>
              <td rowspan="1" colspan="1">
                <italic>0.64</italic>
              </td>
              <td rowspan="1" colspan="1">0.53</td>
              <td rowspan="1" colspan="1">0.63</td>
              <td rowspan="1" colspan="1">0.58</td>
              <td rowspan="1" colspan="1">
                <italic>0.66</italic>
              </td>
              <td rowspan="1" colspan="1">
                <italic>0.65</italic>
              </td>
              <td rowspan="1" colspan="1">Multi</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">MOLI complete Pan-drug</td>
              <td rowspan="1" colspan="1">NA</td>
              <td rowspan="1" colspan="1">NA</td>
              <td rowspan="1" colspan="1">
                <bold>0.80</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>0.72</bold>
              </td>
              <td rowspan="1" colspan="1">NA</td>
              <td rowspan="1" colspan="1">NA</td>
              <td rowspan="1" colspan="1">NA</td>
              <td rowspan="1" colspan="1">Multi</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn6">
            <p><italic>Note</italic>: NSC: no stable classifier during cross validation or final training. Boldface indicates the best method for the corresponding drug and italics indicates the second best method. NA: the corresponding drug is not for targeted therapy. Complete: when MOLI has both classification and the triplet losses; NMF, non-negative matrix factorization; DNNs, deep neural networks.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>First, we compared the complete MOLI (MOLI trained on multi-omics data and using its combined cost function) to the early integration baselines. MOLI achieved better performance in six out of seven external validation datasets compared to early integration via deep neural networks. Moreover, MOLI also achieved better performance in all of the external validation datasets compared to early integration via NMF. These results indicate that MOLI outperforms multi-omics early integration. Second, we compared MOLI trained on multi-omics data with two deep neural network scenarios trained only on the gene expression data (one of them was MOLI itself). MOLI trained on multi-omics data showed better performance in four out of seven external validation datasets and tied in another dataset. These results indicate that deep neural networks trained on multi-omics data achieve better performance than those trained on single-omics data.</p>
      <p>Third, we compared MOLI with MOLI without the triplet loss, both trained on multi-omics input. MOLI with its combined cost function obtained better performance in five out of seven external validation datasets and tied in another one. These results demonstrate the contribution of the triplet loss to improving the prediction performance.</p>
      <p>Finally, we compared MOLI against a single-omics non-deep neural networks baseline which is the only published method for drug response prediction (<xref rid="btz318-B16" ref-type="bibr">Geeleher <italic>et al.</italic>, 2014</xref>) that had been tested on patient data. MOLI achieved better performance in four out of seven external validation datasets and tied with this baseline in another one. These experiments show the substantial gain in predictive performance resulting from the combination of using multi-omics data, deep neural networks and the proposed cost function.</p>
      <p>MOLI when trained on the pan-drug input (only applicable for targeted drugs) had significantly better performance compared to itself when it was trained on the drug-specific inputs for Erlotinib and Cetuximab. The majority of the baselines had either poor performance or no stable classifier status (NSC) for Paclitaxel and Erlotinib. NSC means that during either cross validation or final re-training with the obtained hyper-parameters the cost and/or AUC curves were fluctuating. This may be due to the small number of samples, because both of these drugs had the fewest number of cell lines (∼400). Also, we observed NSC in the early integration baseline for four drugs which may be due to the concatenation at the beginning because it increased the dimensionality substantially, which makes feature learning harder for the autoencoder and later the classifier in this method.</p>
      <p>MOLI achieved an AUC of &gt;0.7 for four drugs (Paclitaxel, Cetuximab, Erlotinib and Cisplatin) which may be beneficial for precision oncology particularly for the targeted drugs (Cetuximab and Erlotinib).</p>
      <p>We also studied the area under precision–recall curve for MOLI and the main baselines including the early integration methods and the <xref rid="btz318-B16" ref-type="bibr">Geeleher <italic>et al.</italic> (2014)</xref> method. Compared to the early integration methods, MOLI achieved better performance in four out of seven external validation datasets and tied in two other datasets. Compared to the (<xref rid="btz318-B16" ref-type="bibr">Geeleher <italic>et al.</italic>, 2014</xref>) single-omics baseline, MOLI had better performance in six out of seven external validation datasets. We also investigated the area under precision–recall curve for the pan-drug training data. MOLI trained on pan-drug data had better performance in one external validation dataset and had competitive performance in another one compared to MOLI trained on the drug-specific input (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S4</xref>). All these results again suggest that MOLI may be beneficial for precision oncology.</p>
    </sec>
    <sec>
      <title>3.3 Transfer learning for targeted drugs improves performance significantly</title>
      <p>We observed that for the targeted drugs (in our experiment, EGFR inhibitors), MOLI trained on the pan-drug multi-omics inputs achieved significantly better performance than MOLI trained on drug-specific inputs. Pan-drug MOLI achieved an AUC of 0.8 for Cetuximab and 0.72 for Erlotinib which were significantly higher than the drug-specific performance. This suggests that transfer learning can improve the prediction performance for the targeted drugs.</p>
    </sec>
    <sec>
      <title>3.4 Predictions for TCGA patients by MOLI have associations with EGFR genes</title>
      <p>We applied MOLI (trained on the pan-drug input for EGFR inhibitors) to multi-omics data without drug response downloaded from TCGA (breast, bladder, pancreatic, lung, kidney and prostate cancers) and predicted the response for these patients. According to the <italic>P</italic>-values obtained from multiple linear regression, there are a number of strong associations between EGFR genes and the responses predicted by MOLI. For breast cancer, we observed statistically significant associations between the level of expression in AP2A1 (<italic>P </italic>=<italic> </italic>0.007), CALM2 (<italic>P </italic>=<italic> </italic>0.01), CLTA (<italic>P </italic>=<italic> </italic>0.0002), EGFR (<inline-formula id="IE8"><mml:math id="IM8"><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo></mml:mrow></mml:msup><mml:mn>5</mml:mn></mml:math></inline-formula>), PIK3CA (<italic>P </italic>=<italic> </italic>0.007) and UBA52 (<inline-formula id="IE9"><mml:math id="IM9"><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo></mml:mrow></mml:msup><mml:mn>6</mml:mn></mml:math></inline-formula>) genes and the predicted responses. For prostate cancer, we found that the predicted responses have statistically significant associations with the expression of AKT1 (<italic>P </italic>=<italic> </italic>0.02), CDK1 (<italic>P </italic>=<italic> </italic>0.01), RICTOR (<italic>P </italic>=<italic> </italic>0.0002), CREB1 (<italic>P </italic>=<italic> </italic>0.02) and CSK (<italic>P </italic>=<italic> </italic>0.01). In kidney cancer, expression of EGFR (<italic>P </italic>=<italic> </italic>0.04) gene had association with the predicted response. In lung cancer, we observed significant associations for CDC42 (<italic>P </italic>=<italic> </italic>0.04), EGFR (<inline-formula id="IE10"><mml:math id="IM10"><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo></mml:mrow></mml:msup><mml:mn>5</mml:mn></mml:math></inline-formula>) and PRKAR2A (<italic>P </italic>=<italic> </italic>0.01) genes. However, for bladder and pancreatic cancers, we did not observe any significant associations.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>In this paper, we proposed MOLI method based on deep neural networks to predict drug response. MOLI integrates somatic mutation, CNA and gene expression data and predicts the drug responses. To the best of our knowledge, MOLI is the first end-to-end method for MOLI with deep neural networks that utilize a combined cost function. Our experiments showed that MOLI with its combined cost function can achieve better performance than single-omics and early integration multi-omics methods based on deep neural networks. We also observed that transfer learning for targeted drugs improves the prediction performance compared to drug-specific inputs. To the best of our knowledge, this is the first method to use transfer learning with a pan-drug approach for targeted drugs. Finally, we analyzed MOLI’s predictions for drugs targeting the EGFR pathway on breast, kidney, lung and prostate cancer patients in TCGA. We showed that MOLI’s predictions have statistically significant associations with the level of expression for some of the genes in the EGFR pathway, including the EGFR gene itself, for breast, kidney and lung cancers.</p>
    <p>We would like to point out the following directions for future research.</p>
    <p>Although we used only somatic mutation, CNA and gene expression data in our experiments, MOLI can be extended for integrating other omics data types. For example, proteomics data can be a good candidate because it has been shown to be a contributing factor in pan-cancer drug response prediction (<xref rid="btz318-B1" ref-type="bibr">Ali <italic>et al.</italic>, 2018</xref>) and is known to be in concordance with the other omics data types (<xref rid="btz318-B18" ref-type="bibr">Gonçalves <italic>et al.</italic>, 2017</xref>; <xref rid="btz318-B36" ref-type="bibr">Ryan <italic>et al.</italic>, 2017</xref>). We performed experiments on transfer learning only for the drugs that target EGFR, but this approach is also applicable for other families of targeted drugs if multi-omics data are available for external validation. Another advantage of the pan-drug approach is that there is no need to train separate pan-drug models for each EGFR inhibitor, and one model can be validated on different external datasets. In the drug-specific approach, we trained one model on Cetuximab data and another one on Erlotinib data, and could not validate them on each other’s external validation data. However, in the pan-drug approach, we trained one model for all of the EGFR inhibitors and validated it on both Cetuximab and Erlotinib data.</p>
    <p>While we studied only the triplet loss for optimizing the concatenated representation, we note that this loss function can be replaced by other similar losses such as the contrastive loss function which was used in the Siamese network (<xref rid="btz318-B21" ref-type="bibr">Hadsell <italic>et al.</italic>, 2006</xref>). We trained separate MOLI models for different drugs, but it is an interesting direction for future research to utilize multi-task learning (<xref rid="btz318-B44" ref-type="bibr">Yuan <italic>et al.</italic>, 2016</xref>) and predict the outcome for multiple drugs at the same time. Unlike areas such as medical imaging, transfer learning is yet to be explored in genomics, especially cancer genomics (<xref rid="btz318-B7" ref-type="bibr">Ching <italic>et al.</italic>, 2018</xref>). While in this paper we explored transferring related samples (also known as instance-transfer), other aspects of transfer learning such as relational-knowledge-transfer (<xref rid="btz318-B34" ref-type="bibr">Pan and Yang, 2010</xref>) should be explored in the future.</p>
    <p>In all of the experiments and utilized datasets, we used pan-cancer inputs. The advantage of using pan-cancer multi-omics input is that it can address, to some degree, the challenge of inter-tumor heterogeneity (<xref rid="btz318-B2" ref-type="bibr">Almendro <italic>et al.</italic>, 2013</xref>). However, these datasets are not suitable for addressing intra-tumor heterogeneity, which would require other resources such as single cell data. <xref rid="btz318-B16" ref-type="bibr">Geeleher <italic>et al.</italic> (2014)</xref> showed that training on non-breast cancer cell lines in addition to breast cancer cell lines leads to improved prediction accuracy. However, predictions were tested only on breast cancer clinical trial cohort data and only for Docetaxel, a primary treatment for breast cancer. Because some drug-cancer event associations are specific to the tissue of origin and are less detectable in pan-cancer settings (<xref rid="btz318-B23" ref-type="bibr">Iorio <italic>et al.</italic>, 2016</xref>), we believe that further research in this area is required to study the performance of pan-cancer versus cancer-specific training data for a more diverse range of cancer types and for more drugs.</p>
    <p>We would like to point out the following limitations of this study:
<list list-type="order"><list-item><p>The datasets used were from different resources were not in the same format and required substantial pre-processing and standardization (see the Supplementary Material). For example, different studies used different pipelines to detect CNA and reported different estimates of copy number which could not be compared directly. A similar issue was also observed for the drug response. While the GDSC cell lines used IC50 as the response measure, the majority of datasets used other metrics to measure the response. For example, the PDX dataset used tumor volume based on RECIST criteria to define responders and non-responders. Therefore, lack of standardization on both the input and the output side adds extra challenges to the drug response prediction task.</p></list-item><list-item><p>In this study we focused on monotherapy and did not explore the effect of the combination of drugs.</p></list-item><list-item><p>We did not discriminate between driver and passenger events in the somatic mutation and CNA data and treated all of them similarly. However, in reality, the majority of these genomic alterations seems to have no impact on cancer development (<xref rid="btz318-B40" ref-type="bibr">Vogelstein <italic>et al.</italic>, 2013</xref>) and might appear just by chance. Therefore, in future work, we plan to use another format for these data types to distinguish between potential driver and passenger events.</p></list-item><list-item><p>All of the datasets used suffered from severely unbalanced class distributions, since the number of responders was much smaller than the number of non-responders. We addressed this problem by oversampling the minority class. However, this approach often causes overfitting particularly for deep neural networks with many parameters. We reduced overfitting with strong regularization such as high dropout rate and weight decay. Moreover, using triplets as input of the network increased the number of samples and led to a more stable network, due to the large number of different combinations for triplets.</p></list-item><list-item><p>As a first investigation of late integration, we did not consider interactions between genes in different omics data types in MOLI or the compared baselines. In reality, genes do not function in isolation and work in biological networks and interact with each other. Recently, <xref rid="btz318-B30" ref-type="bibr">Ma <italic>et al.</italic> (2018)</xref> have shown that incorporating biological domain knowledge from the Gene Ontology leads to more interpretable neural networks with performance comparable to those of purely data-driven neural networks. Therefore, incorporating domain expert knowledge to MOLI via deep neural networks is a promising future direction.</p></list-item></list></p>
  </sec>
  <sec>
    <title>5 Conclusion</title>
    <p>In this paper, we proposed MOLI, a method for drug response prediction based on deep neural networks and MOLI. We trained MOLI on a pan-cancer cell line dataset and successfully validated it on PDX and patient data for five chemotherapy agents and two targeted therapeutics.</p>
    <p>Our results suggest four major findings:
<list list-type="order"><list-item><p>MOLI outperforms single-omics (gene expression) prediction performance in terms of AUC and area under precision–recall curve.</p></list-item><list-item><p>MOLI outperforms deep neural networks using early integration in terms of AUC and area under precision–recall curve.</p></list-item><list-item><p>MOLI with its combined cost function outperforms single- and multi-omics baselines with only the classification loss.</p></list-item><list-item><p>MOLI trained on the pan-drug inputs, employing transfer learning, outperforms MOLI trained on drug-specific inputs for targeted therapeutics that target EGFR.</p></list-item></list></p>
    <p>Finally, we analyzed the biological significance of MOLI and found substantial evidence that the responses predicted by MOLI have statistically significant associations with the expression level of numerous genes in the EGFR pathway for TCGA patients with breast, kidney, lung and prostate cancers.</p>
    <p>In conclusion, our experimental results suggest MOLI may have a role in precision oncology where currently only ∼5% of all patients benefit from precision oncology.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>btz318_Supplementary_Data</label>
      <media xlink:href="btz318_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We would like to thank Hossein Asghari, Baraa Orabi, Raunak Shrestha and Yen-Yi Lin (Vancouver Prostate Centre), Anne-Marie Therien-Daniel, Nazanin Mehrasa and Mehrdad Mansouri (Simon Fraser University), Paul Geeleher (St Jude Children’s Research Hospital) and Lukas Folkman (CeMM) for their kind supports. We also would like to thank Compute Canada, WestGrid and Vancouver Prostate Centre for providing us with the computational resources for this research.</p>
    <sec>
      <title>Authors’ contributions</title>
      <p>Study concept and design: H.S.-N., C.C.C., M.E.</p>
      <p>Deep learning design, implementations and analysis: H.S.-N.</p>
      <p>Data pre-processing, analysis and interpretation: O.Z.</p>
      <p>Analysis and interpretation of results: H.S.-N., O.Z.</p>
      <p>Drafting of the manuscript: All authors read and approved the final manuscript.</p>
      <p>Supervision: C.C.C., M.E.</p>
    </sec>
    <sec>
      <title>Funding</title>
      <p>This work was supported by Canada Foundation for Innovation (33440 to C.C.C.), The Canadian Institutes of Health Research (PJT-153073 to C.C.C.), Terry Fox Foundation (201012TFF to C.C.C.), International DFG Research Training Group GRK 1906 (to support O.Z.) and a Discovery Grant from the National Science and Engineering Research Council of Canada R611347 (to H.S.-N. and M.E.).</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btz318-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ali</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Global proteomics profiling improves drug sensitivity prediction: results from a multi-omics, pan-cancer modeling approach</article-title>. <source>Bioinformatics</source>, <volume>34</volume>, <fpage>1353</fpage>–<lpage>1362</lpage>.<pub-id pub-id-type="pmid">29186355</pub-id></mixed-citation>
    </ref>
    <ref id="btz318-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Almendro</surname><given-names>V.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Cellular heterogeneity and molecular evolution in cancer</article-title>. <source>Ann. Rev. Pathol</source>., <volume>8</volume>, <fpage>277</fpage>–<lpage>302</lpage>.<pub-id pub-id-type="pmid">23092187</pub-id></mixed-citation>
    </ref>
    <ref id="btz318-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Argelaguet</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Multi-omics factor analysis a framework for unsupervised integration of multi-omics data sets</article-title>. <source>Mol. Syst. Biol</source>., <volume>14</volume>, <fpage>e8124.</fpage><pub-id pub-id-type="pmid">29925568</pub-id></mixed-citation>
    </ref>
    <ref id="btz318-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Barretina</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>The Cancer Cell Line Encyclopedia enables predictive modelling of anticancer drug sensitivity</article-title>. <source>Nature</source>, <volume>483</volume>, <fpage>603</fpage>–<lpage>607</lpage>.<pub-id pub-id-type="pmid">22460905</pub-id></mixed-citation>
    </ref>
    <ref id="btz318-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Chaudhary</surname><given-names>K.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Deep learning-based multi-omics integration robustly predicts survival in liver cancer</article-title>. <source>Clin. Cancer Res</source>., <volume>24</volume>, <fpage>1248</fpage>–<lpage>1259</lpage>.<pub-id pub-id-type="pmid">28982688</pub-id></mixed-citation>
    </ref>
    <ref id="btz318-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cheng</surname><given-names>M.L.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Clinical tumour sequencing for precision oncology: time for a universal strategy</article-title>. <source>Nat. Rev. Cancer</source>, <volume>18</volume>, <fpage>527</fpage>–<lpage>582</lpage>.<pub-id pub-id-type="pmid">30030494</pub-id></mixed-citation>
    </ref>
    <ref id="btz318-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ching</surname><given-names>T.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Opportunities and obstacles for deep learning in biology and medicine</article-title>. <source>J. R. Soc. Interface</source>, <volume>15</volume>, <fpage>20170387.</fpage><pub-id pub-id-type="pmid">29618526</pub-id></mixed-citation>
    </ref>
    <ref id="btz318-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cichocki</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Phan</surname><given-names>A.-H.</given-names></name></person-group> (<year>2009</year>) <chapter-title>Fast local algorithms for large scale nonnegative matrix and tensor factorizations</chapter-title> In: <source>IEICE Transactions on Fundamentals of Electronics, Communications and Computer Sciences</source>. Vol. <volume>92</volume>, The Institute of Electronics, Information and Communication Engineers, Tokyo, Japan, pp. <fpage>708</fpage>–<lpage>721</lpage>. </mixed-citation>
    </ref>
    <ref id="btz318-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Dimitrakopoulos</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Network-based integration of multi-omics data for prioritizing cancer genes</article-title>. <source>Bioinformatics</source>, <volume>34</volume>, <fpage>2441</fpage>–<lpage>2448</lpage>.<pub-id pub-id-type="pmid">29547932</pub-id></mixed-citation>
    </ref>
    <ref id="btz318-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ding</surname><given-names>M.Q.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Precision oncology beyond targeted therapy: combining omics data with machine learning matches the majority of cancer cells to effective therapeutics</article-title>. <source>Mol. Cancer Res</source>., <volume>16</volume>, <fpage>269</fpage>–<lpage>278</lpage>.<pub-id pub-id-type="pmid">29133589</pub-id></mixed-citation>
    </ref>
    <ref id="btz318-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ding</surname><given-names>Z.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Evaluating the molecule-based prediction of clinical drug responses in cancer</article-title>. <source>Bioinformatics</source>, <volume>32</volume>, <fpage>2891</fpage>–<lpage>2895</lpage>.<pub-id pub-id-type="pmid">27354694</pub-id></mixed-citation>
    </ref>
    <ref id="btz318-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Duchi</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>Adaptive subgradient methods for online learning and stochastic optimization</article-title>. <source>J. Mach. Learn. Res</source>., <volume>12</volume>, <fpage>2121</fpage>–<lpage>2159</lpage>.</mixed-citation>
    </ref>
    <ref id="btz318-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Févotte</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Idier</surname><given-names>J.</given-names></name></person-group> (<year>2011</year>) 
<article-title>Algorithms for nonnegative matrix factorization with the <italic>β</italic>-divergence</article-title>. <source>Neural Comput</source>., <volume>23</volume>, <fpage>2421</fpage>–<lpage>2456</lpage>.</mixed-citation>
    </ref>
    <ref id="btz318-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gao</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>High-throughput screening using patient-derived tumor xenografts to predict clinical trial drug response</article-title>. <source>Nat. Med</source>., <volume>21</volume>, <fpage>1318</fpage>–<lpage>1325</lpage>.<pub-id pub-id-type="pmid">26479923</pub-id></mixed-citation>
    </ref>
    <ref id="btz318-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gavan</surname><given-names>S.P.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>The economic case for precision medicine</article-title>. <source>Expert Rev. Precis. Med. Drug Dev</source>., <volume>3</volume>, <fpage>1</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">29682615</pub-id></mixed-citation>
    </ref>
    <ref id="btz318-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Geeleher</surname><given-names>P.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Clinical drug response can be predicted using baseline gene expression levels and in vitro drug sensitivity in cell lines</article-title>. <source>Genome Biol</source>., <volume>15</volume>, <fpage>R47.</fpage><pub-id pub-id-type="pmid">24580837</pub-id></mixed-citation>
    </ref>
    <ref id="btz318-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Geeleher</surname><given-names>P.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Discovering novel pharmacogenomic biomarkers by imputing drug response in cancer patients from large genomics studies</article-title>. <source>Genome Res</source>., <volume>27</volume>, <fpage>1743</fpage>–<lpage>1751</lpage>.<pub-id pub-id-type="pmid">28847918</pub-id></mixed-citation>
    </ref>
    <ref id="btz318-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gonçalves</surname><given-names>E.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Widespread post-transcriptional attenuation of genomic copy-number variation in cancer</article-title>. <source>Cell Syst</source>., <volume>5</volume>, <fpage>386</fpage>–<lpage>398</lpage>.<pub-id pub-id-type="pmid">29032074</pub-id></mixed-citation>
    </ref>
    <ref id="btz318-B19">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Goodfellow</surname><given-names>I.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) <source>Deep Learning</source>. <volume>Vol. 1</volume>
<publisher-name>MIT Press</publisher-name>, 
<publisher-loc>Cambridge</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btz318-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Graim</surname><given-names>K.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>PLATYPUS: a multiple-view learning predictive framework for cancer drug sensitivity prediction</article-title>. <source>Pac. Symp. Biocomput</source>., <volume>24</volume>, <fpage>136</fpage>–<lpage>147</lpage>.<pub-id pub-id-type="pmid">30864317</pub-id></mixed-citation>
    </ref>
    <ref id="btz318-B21">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Hadsell</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2006</year>) 
<article-title>Dimensionality reduction by learning an invariant mapping</article-title>. In: <italic>IEEE Computer Society Conference on Computer Vision and Pattern Recognition (CVPR'06), New York, NY</italic>, pp. <fpage>1735</fpage>–<lpage>1742</lpage>.</mixed-citation>
    </ref>
    <ref id="btz318-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>He</surname><given-names>X.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Kernelized rank learning for personalized drug recommendation</article-title>. <source>Bioinformatics</source>, <volume>34</volume>, <fpage>2808</fpage>–<lpage>2816</lpage>.<pub-id pub-id-type="pmid">29528376</pub-id></mixed-citation>
    </ref>
    <ref id="btz318-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Iorio</surname><given-names>F.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>A landscape of pharmacogenomic interactions in cancer</article-title>. <source>Cell</source>, <volume>166</volume>, <fpage>740</fpage>–<lpage>754</lpage>.<pub-id pub-id-type="pmid">27397505</pub-id></mixed-citation>
    </ref>
    <ref id="btz318-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Irizarry</surname><given-names>R.A.</given-names></name></person-group><etal>et al</etal> (<year>2003</year>) 
<article-title>Summaries of Affymetrix GeneChip probe level data</article-title>. <source>Nucleic Acids Res</source>., <volume>31</volume>, <fpage>e15</fpage>.<pub-id pub-id-type="pmid">12582260</pub-id></mixed-citation>
    </ref>
    <ref id="btz318-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Johnson</surname><given-names>W.E.</given-names></name></person-group><etal>et al</etal> (<year>2007</year>) 
<article-title>Adjusting batch effects in microarray expression data using empirical Bayes methods</article-title>. <source>Biostatistics</source>, <volume>8</volume>, <fpage>118</fpage>–<lpage>127</lpage>.<pub-id pub-id-type="pmid">16632515</pub-id></mixed-citation>
    </ref>
    <ref id="btz318-B26">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Khakabimamaghani</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Ester</surname><given-names>M.</given-names></name></person-group> (<year>2016</year>) <chapter-title>Bayesian biclustering for patient stratification</chapter-title> In: <source>CC BY: PSB 2016 proceedings are published as Open Access chapters by World Scientific Publishing Company and distributed under the terms of the Creative Commons Attribution (CC BY) 4.0 License</source>. 
<publisher-name>World Scientific</publisher-name>, pp. <fpage>345</fpage>–<lpage>356</lpage>.</mixed-citation>
    </ref>
    <ref id="btz318-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lee</surname><given-names>J.-K.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Pharmacogenomic landscape of patient-derived tumor cells informs precision oncology therapy</article-title>. <source>Nat. Genet</source>., <volume>50</volume>, <fpage>1399</fpage>–<lpage>1411</lpage>.<pub-id pub-id-type="pmid">30262818</pub-id></mixed-citation>
    </ref>
    <ref id="btz318-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>B.</given-names></name>, <name name-style="western"><surname>Dewey</surname><given-names>C.N.</given-names></name></person-group> (<year>2011</year>) 
<article-title>RSEM: accurate transcript quantification from RNA-seq data with or without a reference genome</article-title>. <source>BMC Bioinformatics</source>, <volume>12</volume>, <fpage>323</fpage>.<pub-id pub-id-type="pmid">21816040</pub-id></mixed-citation>
    </ref>
    <ref id="btz318-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Liang</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Integrative data analysis of multi-platform cancer data with a multimodal deep learning approach</article-title>. <source>IEEE/ACM Trans. Comput. Biol. Bioinform</source>., <volume>12</volume>, <fpage>928</fpage>–<lpage>937</lpage>.<pub-id pub-id-type="pmid">26357333</pub-id></mixed-citation>
    </ref>
    <ref id="btz318-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ma</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Using deep learning to model the hierarchical structure and function of a cell</article-title>. <source>Nat. Methods</source>, <volume>15</volume>, <fpage>290</fpage>–<lpage>298</lpage>.<pub-id pub-id-type="pmid">29505029</pub-id></mixed-citation>
    </ref>
    <ref id="btz318-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Marquart</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Estimation of the percentage of US patients with cancer who benefit from genome-driven oncology</article-title>. <source>JAMA Oncol</source>., <volume>4</volume>, <fpage>1093</fpage>–<lpage>1098</lpage>.<pub-id pub-id-type="pmid">29710180</pub-id></mixed-citation>
    </ref>
    <ref id="btz318-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Mishra</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Verma</surname><given-names>M.</given-names></name></person-group> (<year>2010</year>) 
<article-title>Cancer biomarkers: are we ready for the prime time?</article-title><source>Cancers</source>, <volume>2</volume>, <fpage>190</fpage>–<lpage>208</lpage>.<pub-id pub-id-type="pmid">24281040</pub-id></mixed-citation>
    </ref>
    <ref id="btz318-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Mo</surname><given-names>Q.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Pattern discovery and cancer gene identification in integrated cancer genomic data</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>110</volume>, <fpage>4245</fpage>–<lpage>4250</lpage>.<pub-id pub-id-type="pmid">23431203</pub-id></mixed-citation>
    </ref>
    <ref id="btz318-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pan</surname><given-names>S.J.</given-names></name>, <name name-style="western"><surname>Yang</surname><given-names>Q.</given-names></name></person-group> (<year>2010</year>) 
<article-title>A survey on transfer learning</article-title>. <source>IEEE Trans. Knowl. Data Eng</source>., <volume>22</volume>, <fpage>1345</fpage>–<lpage>1359</lpage>.</mixed-citation>
    </ref>
    <ref id="btz318-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rappoport</surname><given-names>N.</given-names></name>, <name name-style="western"><surname>Shamir</surname><given-names>R.</given-names></name></person-group> (<year>2018</year>) 
<article-title>Multi-omic and multi-view clustering algorithms: review and cancer benchmark</article-title>. <source>Nucleic Acids Res</source>., <volume>46</volume>, <fpage>10546</fpage>–<lpage>10562</lpage>.<pub-id pub-id-type="pmid">30295871</pub-id></mixed-citation>
    </ref>
    <ref id="btz318-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ryan</surname><given-names>C.J.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>A compendium of co-regulated protein complexes in breast cancer reveals collateral loss events</article-title>. <source>Cell Syst</source>., <volume>5</volume>, <fpage>399</fpage>–<lpage>409</lpage>.<pub-id pub-id-type="pmid">29032073</pub-id></mixed-citation>
    </ref>
    <ref id="btz318-B37">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Schroff</surname><given-names>F.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) <chapter-title>FaceNet: a unified embedding for face recognition and clustering</chapter-title> In: <source>Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition</source>, <italic>Boston, MA</italic>, pp. <fpage>815</fpage>–<lpage>823</lpage>.</mixed-citation>
    </ref>
    <ref id="btz318-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Shrestha</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>HIT’nDRIVE: patient-specific multidriver gene prioritization for precision oncology</article-title>. <source>Genome Res</source>., <volume>27</volume>, <fpage>1573</fpage>–<lpage>1588</lpage>.<pub-id pub-id-type="pmid">28768687</pub-id></mixed-citation>
    </ref>
    <ref id="btz318-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Singh</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>DIABLO: an integrative approach for identifying key molecular drivers from multi-omic assays</article-title>. <source>Bioinformatics</source>, [Epub ahead of print, doi:10.1093/bioinformatics/bty1054, January 18, 2019].</mixed-citation>
    </ref>
    <ref id="btz318-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Vogelstein</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Cancer genome landscapes</article-title>. <source>Science</source>, <volume>339</volume>, <fpage>1546</fpage>–<lpage>1558</lpage>.<pub-id pub-id-type="pmid">23539594</pub-id></mixed-citation>
    </ref>
    <ref id="btz318-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wang</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Similarity network fusion for aggregating data types on a genomic scale</article-title>. <source>Nat. Methods</source>, <volume>11</volume>, <fpage>333</fpage>–<lpage>337</lpage>.<pub-id pub-id-type="pmid">24464287</pub-id></mixed-citation>
    </ref>
    <ref id="btz318-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Weinstein</surname><given-names>J.N.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>The Cancer Genome Atlas pan-cancer analysis project</article-title>. <source>Nature Genet</source>., <volume>45</volume>, <fpage>1113</fpage>–<lpage>1120</lpage>.<pub-id pub-id-type="pmid">24071849</pub-id></mixed-citation>
    </ref>
    <ref id="btz318-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yang</surname><given-names>W.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Genomics of Drug Sensitivity in Cancer (GDSC): a resource for therapeutic biomarker discovery in cancer cells</article-title>. <source>Nucleic Acids Res</source>., <volume>41</volume>, <fpage>D955</fpage>–<lpage>D961</lpage>.<pub-id pub-id-type="pmid">23180760</pub-id></mixed-citation>
    </ref>
    <ref id="btz318-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yuan</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Multitask learning improves prediction of cancer drug sensitivity</article-title>. <source>Sci. Rep</source>., <volume>6</volume>, <fpage>31619</fpage>.<pub-id pub-id-type="pmid">27550087</pub-id></mixed-citation>
    </ref>
    <ref id="btz318-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zehir</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Mutational landscape of metastatic cancer revealed from prospective clinical sequencing of 10, 000 patients</article-title>. <source>Nature Medicine</source>, <volume>23</volume>, <fpage>703</fpage>–<lpage>713</lpage>.</mixed-citation>
    </ref>
    <ref id="btz318-B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zitnik</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>Machine learning for integrating data in biology and medicine: principles, practice, and opportunities</article-title>. <source>Inf. Fusion</source>, <volume>50</volume>, <fpage>71</fpage>–<lpage>91</lpage>.<pub-id pub-id-type="pmid">30467459</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
