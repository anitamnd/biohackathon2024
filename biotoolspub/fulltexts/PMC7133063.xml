<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">J Appl Crystallogr</journal-id>
    <journal-id journal-id-type="iso-abbrev">J Appl Crystallogr</journal-id>
    <journal-id journal-id-type="publisher-id">J. Appl. Cryst.</journal-id>
    <journal-title-group>
      <journal-title>Journal of Applied Crystallography</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0021-8898</issn>
    <issn pub-type="epub">1600-5767</issn>
    <publisher>
      <publisher-name>International Union of Crystallography</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7133063</article-id>
    <article-id pub-id-type="publisher-id">vh5110</article-id>
    <article-id pub-id-type="doi">10.1107/S1600576720000527</article-id>
    <article-id pub-id-type="coden">JACGAR</article-id>
    <article-id pub-id-type="pii">S1600576720000527</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Computer Programs</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Simulation of small-angle X-ray scattering data of biological macromolecules in solution</article-title>
      <alt-title>Simulation of SAXS for macromolecules in solution </alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Franke</surname>
          <given-names>Daniel</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
        <xref ref-type="corresp" rid="cor">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hajizadeh</surname>
          <given-names>Nelly R.</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
        <xref ref-type="aff" rid="b">b</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0003-0830-5696</contrib-id>
        <name>
          <surname>Svergun</surname>
          <given-names>Dmitri I.</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
      </contrib>
      <aff id="a"><label>a</label><institution>European Molecular Biology Laboratory</institution>, Notkestrasse 85 c/o DESY, Hamburg, 22607, <country>Germany</country></aff>
      <aff id="b"><label>b</label><institution>ETH</institution>, ScopeM IDA Group, HPZ G 35.1, John-von-Neumann-Weg 9, 8093, Zurich, <country>Switzerland</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor">Correspondence e-mail: <email>franke@embl-hamburg.de</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>4</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>18</day>
      <month>2</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>18</day>
      <month>2</month>
      <year>2020</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>53</volume>
    <issue>Pt 2</issue>
    <issue-id pub-id-type="publisher-id">j200200</issue-id>
    <fpage>536</fpage>
    <lpage>539</lpage>
    <history>
      <date date-type="received">
        <day>09</day>
        <month>11</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>1</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Daniel Franke et al. 2020</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution (CC-BY) Licence, which permits unrestricted
use, distribution, and reproduction in any medium, provided the original authors and source are cited.</license-p>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/">http://creativecommons.org/licenses/by/4.0/</ali:license_ref>
      </license>
    </permissions>
    <self-uri xlink:href="https://doi.org/10.1107/S1600576720000527">A full version of this article is available from Crystallography Journals Online.</self-uri>
    <abstract abstract-type="toc">
      <p>An application is presented to simulate images on an area detector for isotropic small-angle X-ray scattering, explicitly accounting for the experimental geometry and yielding radially averaged 1D scattering patterns with statistically appropriate variations.</p>
    </abstract>
    <abstract>
      <p>This article presents <italic>IMSIM</italic>, an application to simulate two-dimensional small-angle X-ray scattering patterns and, further, one-dimensional profiles from biological macromolecules in solution. <italic>IMSIM</italic> implements a statistical approach yielding two-dimensional images in TIFF, CBF or EDF format, which may be readily processed by existing data-analysis pipelines. Intensities and error estimates of one-dimensional patterns obtained from the radial average of the two-dimensional images exhibit the same statistical properties as observed with actual experimental data. With initial input on an absolute scale, [cm<sup>−1</sup>]/c[mg ml<sup>−1</sup>], the simulated data frames may also be scaled to absolute scale such that the forward scattering after subtraction of the background is proportional to the molecular weight of the solute. The effects of changes of concentration, exposure time, flux, wavelength, sample–detector distance, detector dimensions, pixel size, and the mask as well as incident beam position can be considered for the simulation. The simulated data may be used in method development, for educational purposes, and also to determine the most suitable beamline setup for a project prior to the application and use of the actual beamtime. <italic>IMSIM</italic> is available as part of the <italic>ATSAS</italic> software package (3.0.0) and is freely available for academic use (<ext-link ext-link-type="uri" xlink:href="http://www.embl-hamburg.de/biosaxs/download.html">http://www.embl-hamburg.de/biosaxs/download.html</ext-link>).</p>
    </abstract>
    <kwd-group>
      <kwd>small-angle X-ray scattering</kwd>
      <kwd>SAXS</kwd>
      <kwd>data simulation</kwd>
      <kwd>computer programs</kwd>
      <kwd>solution scattering</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>Horizon 2020</funding-source>
        <award-id>653706</award-id>
      </award-group>
      <award-group>
        <funding-source>Bundesministerium für Bildung und Forschung</funding-source>
        <award-id>05K16YEA</award-id>
      </award-group>
      <funding-statement>This work was funded by <funding-source>Horizon 2020</funding-source> grant <award-id>653706</award-id>. <funding-source>Bundesministerium für Bildung und Forschung</funding-source> grant <award-id>05K16YEA</award-id>. </funding-statement>
    </funding-group>
    <counts>
      <page-count count="4"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="introduction" id="sec1">
    <label>1.</label>
    <title>Introduction   </title>
    <p>A small-angle X-ray scattering (SAXS) experiment performed on a solution of biological macromolecules typically produces an isotropic 2D scattering pattern originating from the random orientations of the molecule in solution. To access shape and size information of the solute, the image is first radially (or azimuthally) averaged into a 1D curve, which depicts the scattering intensity <italic>I</italic>(<italic>s</italic>) against the momentum transfer <italic>s</italic>. The scattering intensities depend on the wavelength (λ) and the angle between the incoming and scattered photons (2Θ) as <italic>s</italic> = (4πsinΘ)/λ. To extract the structural parameters of the molecule, the background contribution to the scattering from components such as the capillary or the buffer needs to be subtracted from that of the sample.</p>
    <p>So far, the most common approach to calculate SAXS data has been at the level of the 1D curve, typically on the basis of atomic structures (Svergun <italic>et al.</italic>, 1995<xref ref-type="bibr" rid="bb18"> ▸</xref>; Schneidman-Duhovny <italic>et al.</italic>, 2010<xref ref-type="bibr" rid="bb16"> ▸</xref>; Knight &amp; Hub, 2015<xref ref-type="bibr" rid="bb10"> ▸</xref>; Grishaev <italic>et al.</italic>, 2010<xref ref-type="bibr" rid="bb8"> ▸</xref>; Liu <italic>et al.</italic>, 2012<xref ref-type="bibr" rid="bb12"> ▸</xref>; Tjioe &amp; Heller, 2007<xref ref-type="bibr" rid="bb19"> ▸</xref>; Virtanen <italic>et al.</italic>, 2011<xref ref-type="bibr" rid="bb20"> ▸</xref>) or from geometric bodies (Konarev <italic>et al.</italic>, 2003<xref ref-type="bibr" rid="bb11"> ▸</xref>). There are significantly fewer options for generating 2D scattering images. Of those available, most are tailored to calculate the scattering from oriented systems and/or for single-particle diffraction experiments, both for coherent and incoherent sources, using explicit equations or numerical methods (Chen &amp; Luo, 2017<xref ref-type="bibr" rid="bb4"> ▸</xref>; McAlister &amp; Grady, 2002<xref ref-type="bibr" rid="bb13"> ▸</xref>; Fritz-Popovski, 2013<xref ref-type="bibr" rid="bb7"> ▸</xref>; Saldin <italic>et al.</italic>, 2010<xref ref-type="bibr" rid="bb15"> ▸</xref>; Alves <italic>et al.</italic>, 2017<xref ref-type="bibr" rid="bb1"> ▸</xref>). All these latter methods result in theoretically calculated 2D images or 1D scattering patterns without any random components. For simulations of experimental data, approximations of random noise are often added by <italic>ad hoc</italic> methods.</p>
    <p>As many aspects of the beamline setup, <italic>e.g.</italic> detector type, sample–detector distance, X-ray wavelength and the incident beam position on the detector, are propagated into the uncertainties of the final 1D scattering pattern, it is necessary to simulate scattering patterns on area detectors. Importantly, the instrumental parameters influence not only the angular range and spacing but also the point-to-point variation of the individual data points in the 1D scattering data. Here we present <italic>IMSIM</italic>, an application to accurately simulate a 2D SAXS scattering image based on the input of a calculated 1D SAXS curve: with the focus that, when radially averaged again, it accurately reproduces the source data up to a scaling factor and the desired random noise.</p>
    <p>An overview of all command-line options and arguments of <italic>IMSIM</italic>, as well as a full usage example, are provided online: <ext-link ext-link-type="uri" xlink:href="https://www.embl-hamburg.de/biosaxs/manuals/imsim.html">https://www.embl-hamburg.de/biosaxs/manuals/imsim.html</ext-link>.</p>
  </sec>
  <sec id="sec2">
    <label>2.</label>
    <title><italic>IMSIM</italic> architecture   </title>
    <sec id="sec2.1">
      <label>2.1.</label>
      <title>Simulation method   </title>
      <p>The simulation is initialized with a continuous rectangular virtual detector plane of infinite size in polar coordinates. Individual random photon-like arrival events are generated in polar coordinates as well, then mapped and quantized onto a rectangular pixel grid, such that the resulting Cartesian image exhibits the same statistical properties and overall features as observed with experimental data. Here, sampling in polar coordinates is a canonical choice as isotropic scattering implies no preference of direction; hence a random variable of uniform distribution over [−π, π) may be employed to determine the direction. In turn, the probability of a certain distance is proportional to the intensities of the calculated input scattering scaled by the Cartesian circle area and normalized to sum to 1.0 [Fig. 1<xref ref-type="fig" rid="fig1"> ▸</xref>(<italic>a</italic>)]. Drawing randomly from a uniform variable over the interval [0, 1] and applying the quantile function of the intensity probability distribution yields the angular position of the virtual photon event [Fig. 1<xref ref-type="fig" rid="fig1"> ▸</xref>(<italic>b</italic>)]. The total number of overall events generated depends on the input parameters on application start-up, <italic>e.g.</italic> virtual flux, exposure time and concentration. Each random set of polar coordinates is then mapped to Cartesian space and, in the last step, quantized to the configured detector pixel grid with a point-spread function of one pixel. The physical dimensions of the final image depend on the wavelength, sample–detector distance and pixel size of the virtual detector [Fig. 1<xref ref-type="fig" rid="fig1"> ▸</xref>(<italic>c</italic>)].</p>
    </sec>
    <sec id="sec2.2">
      <label>2.2.</label>
      <title><italic>IMSIM</italic> input/output   </title>
      <p><italic>IMSIM</italic> is a command-line application that takes as input a file with calculated one-dimensional scattering intensities on an absolute scale (Svergun <italic>et al.</italic>, 1995<xref ref-type="bibr" rid="bb18"> ▸</xref>), with the first and second columns corresponding to the momentum transfer in inverse ångström and calculated intensities, respectively. To simulate the 2D scattering pattern, setup details such as the detector type, exposure time (seconds), X-ray wavelength (metres), detector distance (metres) and flux (events per second) need to be specified through command-line options. There are currently two types of detectors pre-defined in <italic>IMSIM</italic>, namely Pilatus and Eiger photon-counting detectors of various sizes (Broennimann <italic>et al.</italic>, 2006<xref ref-type="bibr" rid="bb3"> ▸</xref>; Dinapoli <italic>et al.</italic>, 2011<xref ref-type="bibr" rid="bb5"> ▸</xref>). Here, the detector selection defines the physical dimensions as pixel count and size of the final image. Non-photon-counting detectors, <italic>e.g.</italic> CCDs, are not (yet) implemented in <italic>IMSIM</italic> as they have a point-spread function larger than the one pixel of the Pilatus and Eiger detectors. Introducing a point-spread function would be conceptually simple and could be done on popular request. The sample concentration has to be provided as well, where a concentration of 0.0 corresponds to simulation of background scattering only. Analogous to the sample scattering, a background scattering pattern on an absolute scale may be supplied to be used as background, for example scattering of a filled capillary. Otherwise a default ‘flat’ background modeled by a double-exponential function<xref ref-type="fn" rid="fn1">1</xref> is applied.</p>
      <p>For convenience, <italic>IMSIM</italic> also provides means to obtain a template for a beamstop mask with module gaps suitable for the selected detector and the angular axis for the defined experimental setup. The axis file is generated using information about the wavelength and sample–detector distance, while the shape of the mask is defined by the detector geometry (<italic>e.g.</italic> size and positions of the detector modules). Masks may be exported in a <italic>FIT2D</italic> binary <monospace>.MSK</monospace> format (Hammersley, 2016<xref ref-type="bibr" rid="bb9"> ▸</xref>) and it is possible to shift the mask on the 2D scattering pattern by defining offsets in the <bold>x</bold> and <bold>y</bold> directions to account for different locations of the beam center on the 2D image [Fig. 1<xref ref-type="fig" rid="fig1"> ▸</xref>(<italic>c</italic>)]. The default output of <italic>IMSIM</italic> is an image with the simulated 2D scattering pattern in TIFF, EDF or CBF format.</p>
    </sec>
    <sec id="sec2.3">
      <label>2.3.</label>
      <title>Statistical properties   </title>
      <p>As presented in Fig. 2<xref ref-type="fig" rid="fig2"> ▸</xref>, the 1D scattering patterns after radial averaging with <italic>RADAVER</italic>/<italic>IM2DAT</italic> (<italic>RADAVER</italic> in <italic>ATSAS 2.8</italic> and earlier, <italic>IM2DAT</italic> as of <italic>ATSAS 3.0</italic>; Franke <italic>et al.</italic>, 2017<xref ref-type="bibr" rid="bb6"> ▸</xref>), background subtraction and normalization are similar to the calculated input data up to the simulated noise. In particular, the standardized residuals are randomly distributed and follow a standard normal distribution. This may be statistically validated with (<italic>a</italic>) the reduced χ<sup>2</sup> statistic (Pearson, 1900<xref ref-type="bibr" rid="bb14"> ▸</xref>) to test the hypothesis whether the observed differences between calculated input scattering and simulated output data may be explained by chance alone, <italic>i.e.</italic> whether they are similar up to noise or systematically different; and (<italic>b</italic>) the Anderson–Darling statistic (Anderson &amp; Darling, 1954<xref ref-type="bibr" rid="bb2"> ▸</xref>; Stephens, 1974<xref ref-type="bibr" rid="bb17"> ▸</xref>) to test whether the empirical distribution of the standardized residuals is similar to a standard normal distribution with mean zero and standard deviation of one. As detailed in Table 1<xref ref-type="table" rid="table1"> ▸</xref>, none of the hypotheses of similarity up to noise and standard normal distribution of residuals may be rejected at a significance threshold α = 0.01.</p>
      <p>In addition, 1000 independent background frames were simulated and compared pairwise with the reduced χ<sup>2</sup> test. The obtained histogram of the reduced χ<sup>2</sup> values of the resulting 499 500 comparisons closely follows the expected χ<sup>2</sup> distribution (not shown).</p>
    </sec>
  </sec>
  <sec id="sec3">
    <label>3.</label>
    <title>Applications   </title>
    <p><italic>IMSIM</italic> is implemented as a cross-platform command-line application that can easily be used interactively, integrated into shell scripts and also employed as a data source, for example, for testing data-analysis pipelines. As <italic>IMSIM</italic> can quickly generate a large number of realistic scattering patterns from a multitude of setups (Fig. 2<xref ref-type="fig" rid="fig2"> ▸</xref>), it may be used for all aspects of method development. Owing to the intentional absence of instrument or sample effects, it is straightforward to validate radial-averaging and data-analysis applications by testing on the simulated data provided by <italic>IMSIM</italic>. Such tests could validate the error propagation, provide insights into the effects of statistical noise on the analysis procedures, or, for example, reveal how over- and/or undersubtraction would influence the results. The methods that so far ignored the information contained in error estimates may be re-evaluated to check whether, or how, accurate error estimates would improve the results. In addition, facility users may use <italic>IMSIM</italic> to evaluate likely experimental outcomes of their system on the basis of the available setup and may request adjustments of detector position or wavelength in advance, if beneficial for the particular specimen. Also, educational facilities may employ <italic>IMSIM</italic> to generate data for courses and presentations and provide them to students who would not have easy access to large-scale synchrotron facilities or laboratory sources to obtain data for training.</p>
  </sec>
  <sec id="sec4">
    <label>4.</label>
    <title>Limitations and future developments   </title>
    <p>The method described generates experimentally idealized, but statistically appropriate, data by emulating a virtual beamline with photons being spontaneously created from the provided sample without any physical components that might interfere, <italic>i.e.</italic> no ray-tracing is performed. At present, the sample does not allow for a structure factor coming from specific or unspecific aggregation or repulsion effects in solution. The effects of excluded volume at high solute concentrations are not considered owing to a lack of theoretical background to rely on. Future developments of <italic>IMSIM</italic> may include support for beam profiles, detector point-spread functions and wavelength spread, allowing for the generation of instrumentally smeared (<italic>e.g.</italic> neutron scattering) data.</p>
  </sec>
  <sec id="sec5">
    <label>5.</label>
    <title>Availability   </title>
    <p><italic>IMSIM</italic> is available as part of the <italic>ATSAS</italic> software package (3.0.0; Franke <italic>et al.</italic>, 2017<xref ref-type="bibr" rid="bb6"> ▸</xref>) and is freely available for academic use (<ext-link ext-link-type="uri" xlink:href="http://www.embl-hamburg.de/biosaxs/download.html">http://www.embl-hamburg.de/biosaxs/download.html</ext-link>).</p>
  </sec>
  <sec sec-type="conclusions" id="sec6">
    <label>6.</label>
    <title>Conclusions   </title>
    <p>We present a program to simulate isotropic 2D scattering patterns from one-dimensional small-angle X-ray scattering data. The principle is based on simulating the photon arrival on a virtual detector by modeling it as a probabilistic event, generating appropriately randomized data and their errors. As all of the files needed for the radial averaging can be produced by <italic>IMSIM</italic>, <italic>i.e.</italic> mask, axis and uniform background, it is possible to rapidly obtain a subtracted data set based on simulated data that are virtually indiscernible from experimental data. <italic>IMSIM</italic> may be utilized by experimentalists, methods developers and educational facilities in need of a large number of data sets with close resemblance to experimental data.</p>
  </sec>
</body>
<back>
  <fn-group>
    <fn id="fn1">
      <label>1</label>
      <p>Namely 0.01632exp[10exp(100<italic>s</italic>)], where 0.01632 corresponds to the expected scattering of water at 293 K. The scaling factors 10 and 100 were empirically determined.</p>
    </fn>
  </fn-group>
  <ack>
    <p>The authors would like to acknowledge useful discussions and input from Martin Schroer, Andrey Gruzinov and Clement Blanchet.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="bb1">
      <mixed-citation publication-type="other">Alves, C., Pedersen, J. S. &amp; Oliveira, C. L. P. (2017). <italic>J. Appl. Cryst.</italic>
<bold>50</bold>, 840–850.</mixed-citation>
    </ref>
    <ref id="bb2">
      <mixed-citation publication-type="other">Anderson, T. W. &amp; Darling, D. A. (1954). <italic>J. Am. Stat. Assoc.</italic>
<bold>49</bold>, 765–769.</mixed-citation>
    </ref>
    <ref id="bb3">
      <mixed-citation publication-type="other">Broennimann, Ch., Eikenberry, E. F., Henrich, B., Horisberger, R., Huelsen, G., Pohl, E., Schmitt, B., Schulze-Briese, C., Suzuki, M., Tomizaki, T., Toyokawa, H. &amp; Wagner, A. (2006). <italic>J. Synchrotron Rad.</italic>
<bold>13</bold>, 120–130.</mixed-citation>
    </ref>
    <ref id="bb30">
      <mixed-citation publication-type="other">Bujacz, A. (2012). <italic>Acta Cryst.</italic> D<bold>68</bold>, 1278–1289.</mixed-citation>
    </ref>
    <ref id="bb4">
      <mixed-citation publication-type="other">Chen, S., E, J. &amp; Luo, S.-N. (2017). <italic>J. Appl. Cryst.</italic>
<bold>50</bold>, 951–958.</mixed-citation>
    </ref>
    <ref id="bb5">
      <mixed-citation publication-type="other">Dinapoli, R., Bergamaschi, A., Henrich, B., Horisberger, R., Johnson, I., Mozzanica, A., Schmid, E., Schmitt, B., Schreiber, A., Shi, X. &amp; Theidel, G. (2011). <italic>Nucl. Instrum. Methods Phys. Res. A</italic>, <bold>650</bold>, 79–83.</mixed-citation>
    </ref>
    <ref id="bb6">
      <mixed-citation publication-type="other">Franke, D., Petoukhov, M. V., Konarev, P. V., Panjkovich, A., Tuukkanen, A., Mertens, H. D. T., Kikhney, A. G., Hajizadeh, N. R., Franklin, J. M., Jeffries, C. M. &amp; Svergun, D. I. (2017). <italic>J. Appl. Cryst.</italic>
<bold>50</bold>, 1212–1225.</mixed-citation>
    </ref>
    <ref id="bb7">
      <mixed-citation publication-type="other">Fritz-Popovski, G. (2013). <italic>J. Appl. Cryst.</italic>
<bold>46</bold>, 1447–1454.</mixed-citation>
    </ref>
    <ref id="bb21">
      <mixed-citation publication-type="other">Granier, T., Gallois, B., Dautant, A., Langlois d’Estaintot, B. &amp; Précigoux, G. (1997). <italic>Acta Cryst.</italic> D<bold>53</bold>, 580–587.</mixed-citation>
    </ref>
    <ref id="bb8">
      <mixed-citation publication-type="other">Grishaev, A., Guo, L. A., Irving, T. &amp; Bax, A. (2010). <italic>J. Am. Chem. Soc.</italic>
<bold>132</bold>, 15484–15486.</mixed-citation>
    </ref>
    <ref id="bb9">
      <mixed-citation publication-type="other">Hammersley, A. P. (2016). <italic>J. Appl. Cryst.</italic>
<bold>49</bold>, 646–652.</mixed-citation>
    </ref>
    <ref id="bb10">
      <mixed-citation publication-type="other">Knight, C. J. &amp; Hub, J. S. (2015). <italic>Nucleic Acids Res.</italic>
<bold>43</bold>, W225–W230.</mixed-citation>
    </ref>
    <ref id="bb11">
      <mixed-citation publication-type="other">Konarev, P. V., Volkov, V. V., Sokolova, A. V., Koch, M. H. J. &amp; Svergun, D. I. (2003). <italic>J. Appl. Cryst.</italic>
<bold>36</bold>, 1277–1282.</mixed-citation>
    </ref>
    <ref id="bb12">
      <mixed-citation publication-type="other">Liu, H., Poon, B. K., Janssen, A. J. E. M. &amp; Zwart, P. H. (2012). <italic>Acta Cryst.</italic> A<bold>68</bold>, 561–567.</mixed-citation>
    </ref>
    <ref id="bb22">
      <mixed-citation publication-type="other">Maurus, R., Overall, C. M., Bogumil, R., Luo, Y., Mauk, A. G., Smith, M. &amp; Brayer, G. D. (1997). <italic>Biochim. Biophys. Acta</italic>, <bold>1341</bold>, 1–13.</mixed-citation>
    </ref>
    <ref id="bb13">
      <mixed-citation publication-type="other">McAlister, B. C. &amp; Grady, B. P. (2002). <italic>Macromol. Symp.</italic>
<bold>190</bold>, 117–130.</mixed-citation>
    </ref>
    <ref id="bb14">
      <mixed-citation publication-type="other">Pearson, K. (1900). <italic>London Edinb. Dubl. Philos. Mag. J. Sci.</italic>
<bold>50</bold>, 157–175.</mixed-citation>
    </ref>
    <ref id="bb15">
      <mixed-citation publication-type="other">Saldin, D. K., Poon, H. C., Shneerson, V. L., Howells, M., Chapman, H. N., Kirian, R. A., Schmidt, K. E. &amp; Spence, J. C. H. (2010). <italic>Phys. Rev. B</italic>, <bold>81</bold>, 174105.</mixed-citation>
    </ref>
    <ref id="bb16">
      <mixed-citation publication-type="other">Schneidman-Duhovny, D., Hammel, M. &amp; Sali, A. (2010). <italic>Nucleic Acids Res</italic>
<bold>38</bold>, W540–W544.</mixed-citation>
    </ref>
    <ref id="bb17">
      <mixed-citation publication-type="other">Stephens, M. A. (1974). <italic>J. Am. Stat. Assoc.</italic>
<bold>69</bold>, 730–737.</mixed-citation>
    </ref>
    <ref id="bb18">
      <mixed-citation publication-type="other">Svergun, D., Barberato, C. &amp; Koch, M. H. J. (1995). <italic>J. Appl. Cryst.</italic>
<bold>28</bold>, 768–773.</mixed-citation>
    </ref>
    <ref id="bb19">
      <mixed-citation publication-type="other">Tjioe, E. &amp; Heller, W. T. (2007). <italic>J. Appl. Cryst.</italic>
<bold>40</bold>, 782–785.</mixed-citation>
    </ref>
    <ref id="bb20">
      <mixed-citation publication-type="other">Virtanen, J. J., Makowski, L., Sosnick, T. R. &amp; Freed, K. F. (2011). <italic>Biophys. J.</italic>
<bold>101</bold>, 2061–2069.</mixed-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="fig1" orientation="portrait" position="float">
    <label>Figure 1</label>
    <caption>
      <p>Simulation of native horse spleen ferritin (PDB code <ext-link ext-link-type="uri" xlink:href="https://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=1ier">1ier</ext-link>; Granier <italic>et al.</italic>, 1997<xref ref-type="bibr" rid="bb21"> ▸</xref>) at 6.0 m detector distance. The theoretical scattering pattern was calculated by <italic>CRYSOL</italic> (Svergun <italic>et al.</italic>, 1995<xref ref-type="bibr" rid="bb18"> ▸</xref>) with 5000 points, in the range from 0.0 to 5.0 nm<sup>−1</sup>. (<italic>a</italic>) The expected probability density for the simulated events of the flat background (blue) and of the sample (red), adjusted for the increase in the detector area. (<italic>b</italic>) The corresponding cumulative density functions used to determine the non-uniform <italic>s</italic> position from a uniform random number in [0, 1]. (<italic>c</italic>) The resulting image at a 6.0 m position with a Pilatus 6M detector mask applied; here the count data are displayed on a logarithmic scale for improved visualization.</p>
    </caption>
    <graphic xlink:href="j-53-00536-fig1"/>
  </fig>
  <fig id="fig2" orientation="portrait" position="float">
    <label>Figure 2</label>
    <caption>
      <p>Examples of simulated data from samples of varying size and shape with constant wavelength at multiple distances of the Pilatus 6M detector from the sample position. All backgrounds were generated with an exposure time of 10 s, the samples with an exposure of 1 s. (<italic>a</italic>) The simulated data of three different samples after background subtraction and scaling by concentration, offset for clarity. These are native horse spleen ferritin (<ext-link ext-link-type="uri" xlink:href="https://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=1ier">1ier</ext-link>) at 6.0 m detector distance at a concentration of 0.5 mg ml<sup>−1</sup> (green) and 2 mg ml<sup>−1</sup> (light blue); bovine serum albumin (<ext-link ext-link-type="uri" xlink:href="https://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=4f5s">4f5s</ext-link>; Bujacz, 2012<xref ref-type="bibr" rid="bb30"> ▸</xref>) at 3.0 m detector distance at a concentration of 0.5 mg ml<sup>−1</sup> (yellow) and 2.0 mg ml<sup>−1</sup> (violet); and myoglobin (<ext-link ext-link-type="uri" xlink:href="https://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=1wla">1wla</ext-link>; Maurus <italic>et al.</italic>, 1997<xref ref-type="bibr" rid="bb22"> ▸</xref>) at 1.5 m detector distance at a concentration of 0.5 mg ml<sup>−1</sup> (dark blue) and 2.0 mg ml<sup>−1</sup> (red). The calculated scattering curves are overlaid in white. Error bars of all data are relative errors in logarithmic scale {SE(<italic>I</italic>)/[<italic>I</italic>log(10)]} and partially truncated for visibility. (<italic>b</italic>)–(<italic>d</italic>) The respective standardized residuals of the simulated data minus the calculated input scattering, divided by the error estimate. Standardized residuals are expected to be randomly distributed and to follow a standard normal distribution, <italic>i.e.</italic> &gt;99% of all standardized residuals should be located in the range [−3; +3].</p>
    </caption>
    <graphic xlink:href="j-53-00536-fig2"/>
  </fig>
  <table-wrap id="table1" orientation="portrait" position="float">
    <label>Table 1</label>
    <caption>
      <title>Simulation summary and statistics</title>
      <p>The three samples (exposure time 1 s) are simulated together with a flat background (exposure time 10 s). Each sample is simulated at two concentrations for the given sample–detector distance (different distances are used for all samples). At all positions a 3 mm circular ‘beamstop’ was masked out at the incident beam position, resulting in a different angular range at each detector position. All generated data sets have <italic>n</italic> = 2647 data points. Reduced χ<sup>2</sup> and Anderson–Darling test statistics and associated probabilities of obtaining a result more extreme than the ones observed (<italic>p</italic> values) are provided for each setup.</p>
    </caption>
    <table frame="hsides" rules="groups">
      <thead valign="top">
        <tr>
          <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="bottom">Sample (PDB code)</th>
          <th style="border-bottom:1px solid black;" rowspan="1" colspan="2" align="left" valign="bottom">1ier</th>
          <th style="border-bottom:1px solid black;" rowspan="1" colspan="2" align="left" valign="bottom">4f5s</th>
          <th style="border-bottom:1px solid black;" rowspan="1" colspan="2" align="left" valign="bottom">1wla</th>
        </tr>
        <tr>
          <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="top">Concentration (mg ml<sup>−1</sup>)</th>
          <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="top">0.5</th>
          <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="top">2.0</th>
          <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="top">0.5</th>
          <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="top">2.0</th>
          <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="top">0.5</th>
          <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="top">2.0</th>
        </tr>
      </thead>
      <tbody valign="top">
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">Detector distance (m)</td>
          <td rowspan="1" colspan="2" align="left" valign="top">6.0</td>
          <td rowspan="1" colspan="2" align="left" valign="top">3.0</td>
          <td rowspan="1" colspan="2" align="left" valign="top">1.5</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">Angular range (nm<sup>−1</sup>)</td>
          <td rowspan="1" colspan="2" align="left" valign="top">[0.0145–3.8497]</td>
          <td rowspan="1" colspan="2" align="left" valign="top">[0.0291–7.6499]</td>
          <td rowspan="1" colspan="2" align="left" valign="top">[0.0581–14.9253]</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">χ<sup>2</sup>/(<italic>n</italic> − 1)</td>
          <td rowspan="1" colspan="1" align="left" valign="top">1.026</td>
          <td rowspan="1" colspan="1" align="left" valign="top">0.993</td>
          <td rowspan="1" colspan="1" align="left" valign="top">0.997</td>
          <td rowspan="1" colspan="1" align="left" valign="top">0.975</td>
          <td rowspan="1" colspan="1" align="left" valign="top">1.048</td>
          <td rowspan="1" colspan="1" align="left" valign="top">0.958</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top"><italic>p</italic>(&gt;χ<sup>2</sup>)</td>
          <td rowspan="1" colspan="1" align="left" valign="top">0.172</td>
          <td rowspan="1" colspan="1" align="left" valign="top">0.600</td>
          <td rowspan="1" colspan="1" align="left" valign="top">0.533</td>
          <td rowspan="1" colspan="1" align="left" valign="top">0.816</td>
          <td rowspan="1" colspan="1" align="left" valign="top">0.042</td>
          <td rowspan="1" colspan="1" align="left" valign="top">0.940</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">Anderson–Darling <italic>A</italic>
<sup>2</sup>
</td>
          <td rowspan="1" colspan="1" align="left" valign="top">2.771</td>
          <td rowspan="1" colspan="1" align="left" valign="top">0.530</td>
          <td rowspan="1" colspan="1" align="left" valign="top">1.932</td>
          <td rowspan="1" colspan="1" align="left" valign="top">1.414</td>
          <td rowspan="1" colspan="1" align="left" valign="top">0.742</td>
          <td rowspan="1" colspan="1" align="left" valign="top">2.548</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top"><italic>p</italic>(&gt;<italic>A</italic><sup>2</sup>)</td>
          <td rowspan="1" colspan="1" align="left" valign="top">0.0359</td>
          <td rowspan="1" colspan="1" align="left" valign="top">0.716</td>
          <td rowspan="1" colspan="1" align="left" valign="top">0.100</td>
          <td rowspan="1" colspan="1" align="left" valign="top">0.198</td>
          <td rowspan="1" colspan="1" align="left" valign="top">0.525</td>
          <td rowspan="1" colspan="1" align="left" valign="top">0.047</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
</floats-group>
