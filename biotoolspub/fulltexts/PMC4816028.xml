<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4816028</article-id>
    <article-id pub-id-type="pmid">25143289</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btu553</article-id>
    <article-id pub-id-type="publisher-id">btu553</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Acceleration of short and long DNA read mapping without loss of accuracy using suffix array</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Tárraga</surname>
          <given-names>Joaquín</given-names>
        </name>
        <xref ref-type="aff" rid="btu553-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btu553-AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Arnau</surname>
          <given-names>Vicente</given-names>
        </name>
        <xref ref-type="aff" rid="btu553-AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Martínez</surname>
          <given-names>Héctor</given-names>
        </name>
        <xref ref-type="aff" rid="btu553-AFF1">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Moreno</surname>
          <given-names>Raul</given-names>
        </name>
        <xref ref-type="aff" rid="btu553-AFF1">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cazorla</surname>
          <given-names>Diego</given-names>
        </name>
        <xref ref-type="aff" rid="btu553-AFF1">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Salavert-Torres</surname>
          <given-names>José</given-names>
        </name>
        <xref ref-type="aff" rid="btu553-AFF1">
          <sup>6</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Blanquer-Espert</surname>
          <given-names>Ignacio</given-names>
        </name>
        <xref ref-type="aff" rid="btu553-AFF1">
          <sup>6</sup>
        </xref>
        <xref ref-type="aff" rid="btu553-AFF1">
          <sup>7</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dopazo</surname>
          <given-names>Joaquín</given-names>
        </name>
        <xref ref-type="aff" rid="btu553-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btu553-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="btu553-AFF1">
          <sup>8</sup>
        </xref>
        <xref ref-type="corresp" rid="btu553-COR1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Medina</surname>
          <given-names>Ignacio</given-names>
        </name>
        <xref ref-type="aff" rid="btu553-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="btu553-COR1">*</xref>
        <xref ref-type="author-notes" rid="btu553-FN1">
          <sup>†</sup>
        </xref>
      </contrib>
      <aff id="btu553-AFF1"><sup>1</sup>Department of Computational Genomics, Centro de Investigación Príncipe Felipe (CIPF), <sup>2</sup>Functional Genomics Node, (INB) at CIPF 46012, <sup>3</sup>Departamento de Informática, Universidad de Valencia, 46100 Valencia, <sup>4</sup>Departamento de Ingeniería y Ciencia de Computadores, Universitat Jaume I, 12071 Castellón de la Plana, <sup>5</sup>Instituto de Investigación en Informática de Albacete, Universidad de Castilla-La Mancha, Campus Universitario, 02071 Albacete, <sup>6</sup>Universitat Politècnica de València, Instituto de Instrumentación para Imagen Molecular, 46022 Valencia, <sup>7</sup>Grupo de Investigación Biomédica de Imagen (GIBI 2^30), La Fe Polytechnic University Hospital, 46022 Valencia and <sup>8</sup>Bioinformatics of Rare Diseases (BIER), CIBER de Enfermedades Raras (CIBERER), Valencia, Spain</aff>
    </contrib-group>
    <author-notes>
      <corresp id="btu553-COR1">*To whom correspondence should be addressed.</corresp>
      <fn id="FN2">
        <p>Associate Editor: Inanc Birol</p>
      </fn>
      <fn id="btu553-FN1">
        <p><sup>†</sup>Present address: European Bioinformatics Institute (EMBL-EBI), European Molecular Biology Laboratory, Wellcome Trust Genome Campus, Hinxton, Cambridge CB10 1SD, UK.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>12</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>20</day>
      <month>8</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>20</day>
      <month>8</month>
      <year>2014</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>30</volume>
    <issue>23</issue>
    <fpage>3396</fpage>
    <lpage>3398</lpage>
    <history>
      <date date-type="received">
        <day>1</day>
        <month>4</month>
        <year>2014</year>
      </date>
      <date date-type="rev-recd">
        <day>29</day>
        <month>7</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>12</day>
        <month>8</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2014. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2014</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/" license-type="creative-commons">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>HPG Aligner applies suffix arrays for DNA read mapping. This implementation produces a highly sensitive and extremely fast mapping of DNA reads that scales up almost linearly with read length. The approach presented here is faster (over 20× for long reads) and more sensitive (over 98% in a wide range of read lengths) than the current state-of-the-art mappers. HPG Aligner is not only an optimal alternative for current sequencers but also the only solution available to cope with longer reads and growing throughputs produced by forthcoming sequencing technologies.</p>
      <p><bold>Availability and implementation:</bold><ext-link ext-link-type="uri" xlink:href="https://github.com/opencb/hpg-aligner">https://github.com/opencb/hpg-aligner</ext-link>.</p>
      <p><bold>Contact:</bold><email>jdopazo@cipf.es</email> or <email>imedina@ebi.ac.uk</email></p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu553/-/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 INTRODUCTION</title>
    <p>Among the many applications of the high-throughput sequencing (HTS) technologies, DNA resequencing is probably the most extensively used because of its important clinical implications (<xref rid="btu553-B1" ref-type="bibr">Biesecker, 2010</xref>). The most time-consuming step in HTS data processing is the mapping process, for which many tools are already available (<xref rid="btu553-B6" ref-type="bibr">Fonseca <italic>et al.</italic>, 2012</xref>). However, while accuracy of short reads mapping process is quite reasonable, speed still remains to be an issue. And, moreover, given the way in which available mappers implement current state-of-the-art mapping algorithms, such as Burroughs-Wheeler Transform, accuracy usually falls down as read length increases because of the accumulation of errors. Therefore, there is an obvious need of new approaches that overcome these current and future problems, given that the trend in HTS technologies is to increase read length and throughput (<xref rid="btu553-B15" ref-type="bibr">Watson, 2014</xref>). Suffix array (SA) has recently started to be applied to accelerate DNA (<xref rid="btu553-B2" ref-type="bibr">Bussotti <italic>et al.</italic>, 2011</xref>; <xref rid="btu553-B4" ref-type="bibr">Chen <italic>et al.</italic>, 2013</xref>) or RNA (<xref rid="btu553-B5" ref-type="bibr">Dobin <italic>et al.</italic>, 2013</xref>) read mapping. Here, we propose an approach, based on SA (<xref rid="btu553-B10" ref-type="bibr">Mamber and Myers, 1993</xref>), that enormously increases the mapping speed without sacrificing accuracy for an ample range of read lengths.</p>
  </sec>
  <sec>
    <title>2 METHODS</title>
    <p>Our approach combines the performance of uncompressed SAs with the sensitivity of the Smith-Waterman (SW) algorithm (<xref rid="btu553-B14" ref-type="bibr">Smith and Waterman, 1981</xref>). SAs are data structures designed for efficient searching within a large text. Each suffix is a string starting at a certain position in the large text and ending at the end of the text. Searching within a text can be performed by binary search using the SA. Applying SA in DNA mapping, the large text is the reference genome, and the query text is the read sequence. This approach achieves an ultrafast read mapping, even in noisy scenarios with high numbers of mismatches and indels. Our mapping strategy (Fig. 1) consists of three major steps. Firstly, in the <italic>seed searching step</italic> the reads are split into a number of seeds distributed uniformly along the read (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu553/-/DC1">Supplementary Fig. S1A</ext-link>). HPG Aligner uses an uncompressed SA to map each of these seeds into the reference genome (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu553/-/DC1">Supplementary Fig. S1B</ext-link>). To speed up the binary search in SA, the program implements a pre-indexing strategy with a prefix table that contains all possible prefixes of length 18 (user-defined parameter). The number of all possible prefixes of length 18 exceeds by far the memory of current computers. To save memory, a compressed row storage has been implemented, where only existing prefixes are stored efficiently. For the human genome, &lt;10 GB of memory is needed. This allows HPG Aligner to use longer prefixes to speed up searches. Secondly, in the <italic>seed extension and clustering</italic> step (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu553/-/DC1">Supplementary Fig. S1C</ext-link>), each mapped seed is extended in both forward and reverse directions of the read until reaching a maximum number of mismatches. Clusters of the extended seeds define the candidate alignment locations (CALs), i.e. regions that correspond to highly probable mappings of a read. CALs are formed by extended seeds within a given range of distance and longer than a threshold. Only the best CALs (that better cover the read) are selected for the next step. Finally, in the <italic>mapping completion step</italic>, a high-performance computing (HPC) implementation of SW attempts to fill all the gaps left in the previous step (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu553/-/DC1">Supplementary Fig. S1D</ext-link>). This implementation exploits the multiple cores of the CPUs and, within them, the Streaming SIMD Extensions (SSE) registers to achieve two levels of parallelization: (i) inter-core parallelization, by distributing batches of pairs of query sequence and reference gap sequence to be aligned among multiple cores/threads in the processor, and (ii) intra-core parallelization (<xref rid="btu553-B13" ref-type="bibr">Rognes and Seeberg, 2000</xref>), by processing a batch of sequence pairs using the SSE registers within a core. The use of SSE 4.2 instructions allows processing simultaneously up to four sequence alignments within each single core. Once gaps in a CAL are mapped, a score for that CAL based on user-defined penalties for mismatches and indels is calculated.</p>
  </sec>
  <sec>
    <title>3 RESULTS</title>
    <p>We have compared the proposed aligner to the most extensively used DNA-seq mappers, BWA 0.7.5a MEM (<xref rid="btu553-B8" ref-type="bibr">Li, 2013</xref>) and Bowtie 2 2.1.0 (<xref rid="btu553-B7" ref-type="bibr">Langmead and Salzberg, 2012</xref>). Benchmarks were performed in a high-end machine with two hexa-core Intel Xeon E5645 2.40 GHz CPUs and 48 GB of memory. All executions were done using the 12 cores available and memory use was monitored. HPG Aligner showed a memory peak of 32 GB.</p>
    <sec id="SEC3.1">
      <title>3.1 Simulated data</title>
      <p>The program dwgsim 0.1.10 from the SAMtools (<ext-link ext-link-type="uri" xlink:href="http://sourceforge.net/apps/mediawiki/dnaa/index.php?title=Whole_Genome_Simulation">http://sourceforge.net/apps/mediawiki/dnaa/index.php?title=Whole_Genome_Simulation</ext-link>) was used to simulate single-end reads from the human genome (Ensembl73 built upon GRCh37). The program dwgsim was run in ‘Illumina’ mode to generate datasets with 40 million reads of lengths of 100, 150, 400, 800, 2000 and 5000 bp. We generated a high-quality dataset containing 0.1% of mutations (option ‘-r 0.001’) and a second dataset with higher proportion of mutations (1% per read with option ‘-r 0.01’). In both configurations, 10% of these mutations were indels (option ‘-R 0.1’), and 30% of these indels are extended with option − X 0.30’. In addition to the mutation rate, dwgsim reproduces errors of the sequencer [-e FLOAT per base/color/flow error rate of the first read (from 0.020 to 0.020 by 0.000)]. Finally, the maximum of N’s was set to 2 (option ‘-n 2’).</p>
      <p><xref ref-type="table" rid="btu553-T1">Table 1</xref> shows a comparative of HPG Aligner with BWA MEM and Bowtie 2. Reads are considered correctly mapped if chromosome, strand and position (±5bp) are coincident with the mapping coordinates, otherwise is incorrectly mapped. While percentages of correctly mapped reads were quite similar, HPG Aligner runtimes were significantly lower than BWA MEM ones, especially when read length increases, arriving to 18× for long reads (5000 bp). Bowtie 2 runtimes were even slower and the program was unable to end the mapping of reads over 800 bp. Despite other programs have been optimized for speed, like bowtie3 (<xref rid="btu553-B9" ref-type="bibr">Liu <italic>et al.</italic>, 2012</xref>) or Isaac (<xref rid="btu553-B12" ref-type="bibr">Raczy <italic>et al.</italic>, 2013</xref>), they can only deal with low error reads. Percentages of unmapped reads and incorrectly mapped reads are low for all the programs (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu553/-/DC1">Supplementary Table S1</ext-link>). The results were similar for the equivalent pair-end benchmark (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu553/-/DC1">Supplementary Table S2</ext-link>).
<table-wrap id="btu553-T1" position="float"><label>Table 1.</label><caption><p>Benchmark results comparing HPG Aligner to BWA MEM and Bowtie 2</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="2" colspan="1">RL</th><th rowspan="2" colspan="1">MR (%)</th><th colspan="2" align="center" rowspan="1">HPG Aligner<hr/></th><th colspan="2" align="center" rowspan="1">BWA MEM<hr/></th><th colspan="2" align="center" rowspan="1">Bowtie 2<hr/></th></tr><tr><th rowspan="1" colspan="1">CM</th><th rowspan="1" colspan="1">Time</th><th rowspan="1" colspan="1">CM</th><th rowspan="1" colspan="1">Time</th><th rowspan="1" colspan="1">CM</th><th rowspan="1" colspan="1">Time</th></tr></thead><tbody align="left"><tr><td rowspan="3" colspan="1">100</td><td rowspan="1" colspan="1">0.1</td><td rowspan="1" colspan="1">98.77</td><td rowspan="1" colspan="1">20.57</td><td rowspan="1" colspan="1">96.99</td><td rowspan="1" colspan="1">29.34</td><td rowspan="1" colspan="1">94.67</td><td rowspan="1" colspan="1">29.40</td></tr><tr><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">98.22</td><td rowspan="1" colspan="1">19.66</td><td rowspan="1" colspan="1">96.65</td><td rowspan="1" colspan="1">33.34</td><td rowspan="1" colspan="1">92.98</td><td rowspan="1" colspan="1">29.15</td></tr><tr><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">97.45</td><td rowspan="1" colspan="1">17.46</td><td rowspan="1" colspan="1">96.11</td><td rowspan="1" colspan="1">37.62</td><td rowspan="1" colspan="1">90.52</td><td rowspan="1" colspan="1">29.04</td></tr><tr><td rowspan="3" colspan="1">150</td><td rowspan="1" colspan="1">0.1</td><td rowspan="1" colspan="1">99.54</td><td rowspan="1" colspan="1">22.90</td><td rowspan="1" colspan="1">98.09</td><td rowspan="1" colspan="1">43.35</td><td rowspan="1" colspan="1">96.71</td><td rowspan="1" colspan="1">47.61</td></tr><tr><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">99.29</td><td rowspan="1" colspan="1">22.09</td><td rowspan="1" colspan="1">97.96</td><td rowspan="1" colspan="1">49.12</td><td rowspan="1" colspan="1">95.93</td><td rowspan="1" colspan="1">46.50</td></tr><tr><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">98.96</td><td rowspan="1" colspan="1">18.13</td><td rowspan="1" colspan="1">97.72</td><td rowspan="1" colspan="1">54.03</td><td rowspan="1" colspan="1">94.73</td><td rowspan="1" colspan="1">46.36</td></tr><tr><td rowspan="3" colspan="1">400</td><td rowspan="1" colspan="1">0.1</td><td rowspan="1" colspan="1">99.93</td><td rowspan="1" colspan="1">31.35</td><td rowspan="1" colspan="1">99.12</td><td rowspan="1" colspan="1">124.16</td><td rowspan="1" colspan="1">98.82</td><td rowspan="1" colspan="1">209.26</td></tr><tr><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">99.78</td><td rowspan="1" colspan="1">30.49</td><td rowspan="1" colspan="1">99.06</td><td rowspan="1" colspan="1">142.81</td><td rowspan="1" colspan="1">98.71</td><td rowspan="1" colspan="1">221.92</td></tr><tr><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">99.58</td><td rowspan="1" colspan="1">26.30</td><td rowspan="1" colspan="1">98.95</td><td rowspan="1" colspan="1">157.65</td><td rowspan="1" colspan="1">98.56</td><td rowspan="1" colspan="1">200.11</td></tr><tr><td rowspan="3" colspan="1">800</td><td rowspan="1" colspan="1">0.1</td><td rowspan="1" colspan="1">99.95</td><td rowspan="1" colspan="1">35.57</td><td rowspan="1" colspan="1">99.42</td><td rowspan="1" colspan="1">279.54</td><td rowspan="1" colspan="1">99.29</td><td rowspan="1" colspan="1">4604.90</td></tr><tr><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">99.74</td><td rowspan="1" colspan="1">35.00</td><td rowspan="1" colspan="1">99.38</td><td rowspan="1" colspan="1">312.55</td><td rowspan="1" colspan="1">99.24</td><td rowspan="1" colspan="1">2750.26</td></tr><tr><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">99.47</td><td rowspan="1" colspan="1">34.70</td><td rowspan="1" colspan="1">99.28</td><td rowspan="1" colspan="1">340.46</td><td rowspan="1" colspan="1">99.18</td><td rowspan="1" colspan="1">2894.38</td></tr></tbody></table><table-wrap-foot><fn id="btu553-TF1"><p><italic>Notes:</italic> Percentages of correct mapping (CM) and runtimes in min (Time) are displayed for different read length in base pairs (RL) and percentages of mutation rate [MR(%)]. For RLs, &gt;800 bp Bowtie2 was unable to finish in 3 days.</p></fn></table-wrap-foot></table-wrap></p>
      <p>Additionally, the effect of indels was studied in other simulated datasets containing gaps of increasing size (minimum gap size of: 5, 7, 10 and 20 bp) for increasingly longer reads (100, 150, 400 and 800 bp). In the most difficult scenario (reads 800 bp long with gaps of ≥20 bp), runtimes of HPG Aligner and BWA MEM are comparable; however, HPG Aligner sensitivity is clearly higher (80.12% versus 63.73%). General performance of Bowtie 2 is comparatively poorer (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu553/-/DC1">Supplementary Table S3</ext-link>).</p>
    </sec>
    <sec id="SEC3.2">
      <title>3.2 Real datasets</title>
      <p>We have tested the aligners in a real scenario: <italic>Drosophila</italic> genomic sequences obtained using the PacBio technology, with ∼ 1 million long reads (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu553/-/DC1">Supplementary Table S4</ext-link>). With long reads, programs often report unrealistic alignments in which only a few tens of nucleotides were aligned while thousands were annotated as deletions. Therefore, here we consider a read correctly mapped when the mapping covers a minimum of 80% of its length. HPG Aligner was capable of mapping 93.21% of the reads, which, after removing reads below the minimal accepted covering threshold, constituted an effective 92.95% of correctly mapped reads. BWA MEM initially mapped 99.95% of the reads. However, when poorly covered reads were excluded, the effective mapping was only of 90.22%. Moreover, while HPG Aligner completed the mapping in only 27.51 min, BWA MEM required 130.34 min. This constitutes almost 5× speed-up in a real dataset, with improved alignment. Bowtie 2 could not finish the mapping, reporting systematically an out of memory error (signal 9 kill). BLASR (<xref rid="btu553-B3" ref-type="bibr">Chaisson and Tesler, 2012</xref>) did a good job at mapping (99.81%) but with extremely long runtime (342 min). For short read lengths, we have used a dataset of 32.7 million reads, 100 bp long, from the 1000 genomes. The relative runtimes for this length are similar to what is described in <xref ref-type="table" rid="btu553-T1">Table 1</xref> (1.5×: HPG Aligner 14 min versus BWA MEM 21 min), as well as the mappings (96.30% HPG Aligner versus 97.13% BWA MEM, see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu553/-/DC1">Supplementary Table S4</ext-link>).</p>
    </sec>
    <sec id="SEC3.3">
      <title>3.3 Other technical advantages</title>
      <p>HPG Aligner has additional advantages. The program can directly read the FASTQ file gzipped, saving in this way both disk space and the time required for the decompression. In addition, users can specify several FASTQ files in a single command line. The mappings of each FASTQ file are concatenated in a single output file. By default, the output file is saved in the SAM format, but HPG Aligner can directly generate a BAM format file by using the option ‘--bam-format’, saving the step of SAM to BAM conversion. HPG Aligner also performs an indel realignment of mappings with the option ‘--realignment’, and a base quality score recalibration with the option ‘--recalibration’. HPC implementations of GATK recalibrator and indel realignment algorithms (<xref rid="btu553-B11" ref-type="bibr">McKenna <italic>et al.</italic>, 2010</xref>) have been included in HPG Aligner (see an example in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu553/-/DC1">Supplementary Fig. S2</ext-link>).</p>
    </sec>
    <sec id="SEC3.4">
      <title>3.4 Program availability</title>
      <p>Source code and development process has been opened to the community and released in GitHub at <ext-link ext-link-type="uri" xlink:href="https://github.com/opencb/hpg-aligner">https://github.com/opencb/hpg-aligner</ext-link>. Contributions to HPG Aligner are welcome. Documentation and software are available at <ext-link ext-link-type="uri" xlink:href="http://wiki.opencb.org/projects/hpg/doku.php?id=aligner:overview">http://wiki.opencb.org/projects/hpg/doku.php?id=aligner:overview</ext-link>.</p>
      <p><italic>Funding</italic>: This work is supported by <award-id>BIO2011-27069</award-id> and <award-id>PRI-PIBIN-2011-1289</award-id> (<funding-source>Spanish Ministry of Economy and Competitiveness</funding-source>), the <funding-source>HPC4G initiative</funding-source> (<ext-link ext-link-type="uri" xlink:href="http://www.hpc4g.org">http://www.hpc4g.org</ext-link>) and the <funding-source>Bull-CIPF Chair for Computational Genomics</funding-source>.</p>
      <p><italic>Conflict of interest</italic>: none declared.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_30_23_3396__index.html"/>
      <media xlink:role="associated-file" mimetype="image" mime-subtype="tiff" xlink:href="supp_btu553_DNA-mapper-Supplementary_Figure_1.tif"/>
      <media xlink:role="associated-file" mimetype="image" mime-subtype="tiff" xlink:href="supp_btu553_DNA-mapper-Supplementary_Figure_2.tif"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="msword" xlink:href="supp_btu553_DNA-mapper-Supplementary_table_1.R1.docx"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="msword" xlink:href="supp_btu553_DNA-mapper-Supplementary_table_2.R1.docx"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="msword" xlink:href="supp_btu553_DNA-mapper-Supplementary_table_3.R1.docx"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="msword" xlink:href="supp_btu553_DNA-mapper-Supplementary_table_4.R1.docx"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="btu553-B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Biesecker</surname>
            <given-names>LG</given-names>
          </name>
        </person-group>
        <article-title>Exome sequencing makes medical genomics a reality</article-title>
        <source>Nat. Genet.</source>
        <year>2010</year>
        <volume>42</volume>
        <fpage>13</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="pmid">20037612</pub-id>
      </element-citation>
    </ref>
    <ref id="btu553-B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bussotti</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>BlastR—fast and accurate database searches for non-coding RNAs</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2011</year>
        <volume>39</volume>
        <fpage>6886</fpage>
        <lpage>6895</lpage>
        <pub-id pub-id-type="pmid">21624887</pub-id>
      </element-citation>
    </ref>
    <ref id="btu553-B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chaisson</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Tesler</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Mapping single molecule sequencing reads using basic local alignment with successive refinement (BLASR): application and theory</article-title>
        <source>BMC Bioinformatics</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>238</fpage>
        <pub-id pub-id-type="pmid">22988817</pub-id>
      </element-citation>
    </ref>
    <ref id="btu553-B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CGAP-align: a high performance DNA short read alignment tool</article-title>
        <source>PLoS One</source>
        <year>2013</year>
        <volume>8</volume>
        <fpage>e61033</fpage>
        <pub-id pub-id-type="pmid">23593381</pub-id>
      </element-citation>
    </ref>
    <ref id="btu553-B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dobin</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>STAR: ultrafast universal RNA-seq aligner</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>15</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="pmid">23104886</pub-id>
      </element-citation>
    </ref>
    <ref id="btu553-B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fonseca</surname>
            <given-names>NA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Tools for mapping high-throughput sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>3169</fpage>
        <lpage>3177</lpage>
        <pub-id pub-id-type="pmid">23060614</pub-id>
      </element-citation>
    </ref>
    <ref id="btu553-B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Fast gapped-read alignment with Bowtie 2</article-title>
        <source>Nat. Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>357</fpage>
        <lpage>359</lpage>
        <pub-id pub-id-type="pmid">22388286</pub-id>
      </element-citation>
    </ref>
    <ref id="btu553-B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Aligning sequence reads, clone sequences and assembly contigs with BWA-MEM</article-title>
        <source>arXiv</source>
        <year>2013</year>
        <comment>1303.3997</comment>
      </element-citation>
    </ref>
    <ref id="btu553-B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>CM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SOAP3: ultra-fast GPU-based parallel alignment tool for short reads</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>878</fpage>
        <lpage>879</lpage>
        <pub-id pub-id-type="pmid">22285832</pub-id>
      </element-citation>
    </ref>
    <ref id="btu553-B10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mamber</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Suffix arrays: a new method for on-line string searches</article-title>
        <source>SIAM J. Comput.</source>
        <year>1993</year>
        <volume>22</volume>
        <fpage>935</fpage>
        <lpage>948</lpage>
      </element-citation>
    </ref>
    <ref id="btu553-B11">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McKenna</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The genome analysis toolkit: a mapreduce framework for analyzing next-generation DNA sequencing data</article-title>
        <source>Genome Res.</source>
        <year>2010</year>
        <volume>20</volume>
        <fpage>1297</fpage>
        <lpage>1303</lpage>
        <pub-id pub-id-type="pmid">20644199</pub-id>
      </element-citation>
    </ref>
    <ref id="btu553-B12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Raczy</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Isaac: ultra-fast whole-genome secondary analysis on Illumina sequencing platforms</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>2041</fpage>
        <lpage>2043</lpage>
        <pub-id pub-id-type="pmid">23736529</pub-id>
      </element-citation>
    </ref>
    <ref id="btu553-B13">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rognes</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Seeberg</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Six-fold speed-up of Smith-Waterman sequence database searches using parallel processing on common microprocessors</article-title>
        <source>Bioinformatics</source>
        <year>2000</year>
        <volume>16</volume>
        <fpage>699</fpage>
        <lpage>706</lpage>
        <pub-id pub-id-type="pmid">11099256</pub-id>
      </element-citation>
    </ref>
    <ref id="btu553-B14">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>TF</given-names>
          </name>
          <name>
            <surname>Waterman</surname>
            <given-names>MS</given-names>
          </name>
        </person-group>
        <article-title>Identification of common molecular subsequences</article-title>
        <source>J. Mol. Biol.</source>
        <year>1981</year>
        <volume>147</volume>
        <fpage>195</fpage>
        <lpage>197</lpage>
        <pub-id pub-id-type="pmid">7265238</pub-id>
      </element-citation>
    </ref>
    <ref id="btu553-B15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Watson</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Illuminating the future of DNA sequencing</article-title>
        <source>Genome Biol.</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>108</fpage>
        <pub-id pub-id-type="pmid">25001875</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
