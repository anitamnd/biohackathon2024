<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2971573</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btq531</article-id>
    <article-id pub-id-type="publisher-id">btq531</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group>
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>girafe – an R/Bioconductor package for functional exploration of aligned next-generation sequencing reads</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Toedling</surname>
          <given-names>Joern</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>4</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>5</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ciaudo</surname>
          <given-names>Constance</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>4</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>5</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>6</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Voinnet</surname>
          <given-names>Olivier</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>6</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Heard</surname>
          <given-names>Edith</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>4</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Barillot</surname>
          <given-names>Emmanuel</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><sup>1</sup>Institut Curie, 26 rue d'Ulm, F-75248 Paris, <sup>2</sup>INSERM U900, F-75248 Paris, <sup>3</sup>Mines ParisTech, F-77300 Fontainebleau, <sup>4</sup>CNRS UMR3215, F-75248 Paris, <sup>5</sup>INSERM U934, F-75248 Paris and <sup>6</sup>Institut de Biologie Moléculaire des Plantes, CNRS UPR2357, Université Louis Pasteur, Strasbourg, France</aff>
    <author-notes>
      <corresp id="COR1">* To whom correspondence should be addressed.</corresp>
      <fn>
        <p>Associate Editor: Alex Bateman</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>11</month>
      <year>2010</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>21</day>
      <month>9</month>
      <year>2010</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>21</day>
      <month>9</month>
      <year>2010</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>26</volume>
    <issue>22</issue>
    <fpage>2902</fpage>
    <lpage>2903</lpage>
    <history>
      <date date-type="received">
        <day>1</day>
        <month>6</month>
        <year>2010</year>
      </date>
      <date date-type="rev-recd">
        <day>20</day>
        <month>8</month>
        <year>2010</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>9</month>
        <year>2010</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2010. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2010</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.5">http://creativecommons.org/licenses/by-nc/2.5</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Summary:</bold> The R/Bioconductor package <italic>girafe</italic> facilitates the functional exploration of alignments of sequence reads from next-generation sequencing data to a genome. It allows users to investigate the genomic intervals together with the aligned reads and to work with, visualise and export these intervals. Moreover, the package operates within and extends the ever-growing Bioconductor framework and thus enables users to leverage a multitude of methods for their data in order to answer specific research questions.</p>
      <p><bold>Availability and Implementation:</bold> The R package <italic>girafe</italic> is available from the Bioconductor web site: <ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org/packages/release/bioc/html/girafe.html">http://www.bioconductor.org/packages/release/bioc/html/girafe.html</ext-link></p>
      <p>An extensive vignette and the Bioconductor mailing lists provide additional documentation and help for using the package.</p>
      <p>
        <bold>Contact:</bold>
        <email>joern.toedling@curie.fr</email>
      </p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btq531/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>1 INTRODUCTION</title>
    <p>Next-generation sequencing (NGS) technologies provide users with millions of comparatively short RNA or DNA <italic>reads</italic> from biological samples of interest. The first step in the analysis of these data usually is to align the reads to the chosen reference genome, using powerful, specific alignment tools. For the secondary analysis that follows, there is a need for an integrated work environment which allows users to explore and annotate the genome intervals with the aligned reads. Besides providing functionality for data exploration, this environment must also provide interfaces to other available tools, especially as the field of NGS analysis software is comparatively new and rapidly evolving. Previously described, excellent tools that provide frameworks for working with aligned reads include <italic>Galaxy</italic> (Giardine <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">2005</xref>) and <italic>SAMtools</italic> (Li <italic>et al.</italic>, <xref ref-type="bibr" rid="B5">2009</xref>).</p>
    <p>Here, we describe the R/Bioconductor package <italic>girafe</italic> that enables users to investigate the genome intervals with the aligned reads, henceforth referred to as <italic>aligned intervals</italic>, and to work with, visualise and export these aligned intervals. One advantage of <italic>girafe</italic> over other tools for working with aligned reads is that the package operates within the open source, open development and constantly growing Bioconductor framework (Gentleman <italic>et al.</italic>, <xref ref-type="bibr" rid="B2">2004</xref>). Thus, this package enables users to leverage a multitude of methods in the analysis of their data in order to answer specific research questions.</p>
  </sec>
  <sec id="SEC2">
    <title>2 AVAILABLE FUNCTIONALITY</title>
    <p>In the following, we present some functionalities of <italic>girafe</italic>. The package is built on, and greatly enhances, the functionalities of the Bioconductor packages <italic>genomeIntervals</italic> and <italic>ShortRead</italic> (Morgan <italic>et al.</italic>, <xref ref-type="bibr" rid="B6">2009</xref>).</p>
    <p>For this demonstration, we use example data downloaded from the Gene Expression Omnibus database (Edgar <italic>et al.</italic>, <xref ref-type="bibr" rid="B1">2002</xref>, GSE10364). The data are Solexa reads obtained from small RNA profiling of mouse oocytes (Tam <italic>et al.</italic>, <xref ref-type="bibr" rid="B7">2008</xref>).</p>
    <p><italic>Importing aligned reads</italic>: The reads were mapped to the mouse genome (assembly <italic>mm9</italic>) using the <italic>Bowtie</italic> aligner (Langmead <italic>et al.</italic>, <xref ref-type="bibr" rid="B4">2009</xref>). The resulting file can be read into R, using the <italic>ShortRead</italic> package, and converted into an object of class <italic>AlignedGenomeIntervals</italic>, the core class of package <italic>girafe</italic>.</p>
    <p><italic>Exploring aligned intervals</italic>: Objects of this class can easily be explored using standard R functions to obtain summary statistics answering questions, such as (i) how long are the reads aligned to specific intervals? or (ii) how many intervals are located on each chromosome?</p>
    <p><italic>Processing the aligned intervals</italic>: Basic interval operations, such as sorting, shifting and determining intersections and unions of interval sets, are readily supported. Moreover, the function <monospace>reduce</monospace> provides a flexible way to combine, or merge, aligned intervals. One intention could be to combine aligned reads at exactly the same position, which only differ in their sequence due to sequencing errors. Another example objective could be to combine overlapping short reads that may be (degradation) products of the same primary transcript.</p>
    <p><italic>Visualisation</italic>: The package <italic>girafe</italic> contains functions for visualising aligned intervals with the powerful plotting facilities of R. These visualisation functions are a flexible alternative to those provided by genome browsers and may be especially relevant for sequencing data from organisms which are not well represented in genome browsers. <xref ref-type="fig" rid="F1">Figure 1</xref> shows aligned intervals from the example data in a 500 bp region on the X chromosome. The reads aligned in this region correspond to two miRNAs reported to be highly expressed in these data (Tam <italic>et al.</italic>, <xref ref-type="bibr" rid="B7">2008</xref>).
<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>Visualisation of genome intervals with aligned reads. Two miRNAs (shown in pink) have been annotated on the Crick strand within this region on the X chromosome. Reads were exclusively aligned to the Crick strand in this region and mostly correspond to the mature and star sequences of the miRNAs. Intervals with uniquely aligned reads are shown in blue while grey marks non-unique reads. For <italic>mmu-mir-503</italic> (left), the original data are shown while for <italic>mmu-mir-322</italic> (right) the overlapping <italic>AlignedGenomeIntervals</italic> have been merged using the function <monospace>reduce</monospace>.</p></caption><graphic xlink:href="btq531f1"/></fig></p>
    <p><italic>Summarising the data using sliding windows</italic>: The data can be searched for genome regions of defined interest using a sliding-window approach. For each window, the number of intervals with aligned reads, the total number of reads aligned, the number of unique reads aligned, the fraction of intervals on the Watson strand, and the higher number of aligned reads at a single interval within the window are reported.</p>
    <p><italic>Overlap with annotated genome features</italic>: A frequent task is to determine the overlap of the aligned intervals with genome elements that are described in databases, in order to annotate the aligned reads. <italic>girafe</italic> includes functions for efficiently determining these overlaps and allows the user to specify custom requirements, such as a minimum fraction of the total interval length, for considering intervals and features to be truly overlapping.</p>
    <p><italic>Exporting the data</italic>: The <italic>girafe</italic> package contains methods for exporting the data into tab-delimited text files, which can be uploaded to genome browsers for further visualisation and exploration. Currently supported formats include ‘bed’, ‘bedGraph’ and ‘wiggle’.</p>
    <p><italic>Vignette</italic>: The package vignette provides more detailed examples together with the corresponding R source code and discusses memory usage and interactions with other Bioconductor packages.</p>
  </sec>
  <sec sec-type="conclusions" id="SEC3">
    <title>3 CONCLUSION</title>
    <p>The R/Bioconductor package <italic>girafe</italic> provides users with a powerful, flexible and extensible framework to explore NGS data, following alignment of the reads to a reference genome.</p>
    <p>The package interacts with other Bioconductor packages and allows export of the data in various formats for exploring them in other software, with the aim of not restricting the user to a limited set of analysis tools.</p>
    <p>The field of NGS analysis software is growing rapidly. Thus, future developments of the package will include adding further methods for working with aligned genome intervals, reducing the memory footprint, and providing additional interfaces to other R/Bioconductor packages and other software.</p>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>Many thanks to Nicolas Servant, Valérie Cognat, Nicolas Delhomme and Patrick Aboyoun for suggestions and feedback on the package. Special thanks to Julien Gagneur and Richard Bourgon for writing <italic>genomeIntervals</italic>. The plotting functions in package <italic>girafe</italic> are based on the function <monospace>plotAlongChrom</monospace> from package <italic>tilingArray</italic>, written by Wolfgang Huber.</p>
    <p><italic>Funding</italic>: Institut Curie, INCa “GepiG”.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edgar</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gene Expression Omnibus: NCBI gene expression and hybridization array data repository</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2002</year>
        <volume>30</volume>
        <fpage>207</fpage>
        <lpage>210</lpage>
        <pub-id pub-id-type="pmid">11752295</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gentleman</surname>
            <given-names>RC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Bioconductor: open software development for computational biology and bioinformatics</article-title>
        <source>Genome Biol.</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>R80</fpage>
        <pub-id pub-id-type="pmid">15461798</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Giardine</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Galaxy: a platform for interactive large-scale genome analysis</article-title>
        <source>Genome Res.</source>
        <year>2005</year>
        <volume>15</volume>
        <fpage>1451</fpage>
        <lpage>1455</lpage>
        <pub-id pub-id-type="pmid">16169926</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title>
        <source>Genome Biol.</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>R25</fpage>
        <pub-id pub-id-type="pmid">19261174</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Sequence Alignment/Map format and SAMtools</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Morgan</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ShortRead: a bioconductor package for input, quality assessment and exploration of high-throughput sequence data</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2607</fpage>
        <lpage>2608</lpage>
        <pub-id pub-id-type="pmid">19654119</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tam</surname>
            <given-names>OH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Pseudogene-derived small interfering RNAs regulate gene expression in mouse oocytes</article-title>
        <source>Nature</source>
        <year>2008</year>
        <volume>453</volume>
        <fpage>534</fpage>
        <lpage>538</lpage>
        <pub-id pub-id-type="pmid">18404147</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
