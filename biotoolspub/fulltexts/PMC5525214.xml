<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5525214</article-id>
    <article-id pub-id-type="publisher-id">1763</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-017-1763-0</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Visibiome: an efficient microbiome search engine based on a scalable, distributed architecture</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Azman</surname>
          <given-names>Syafiq Kamarul</given-names>
        </name>
        <address>
          <email>mbinkamarulazman@masdar.ac.ae</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Anwar</surname>
          <given-names>Muhammad Zohaib</given-names>
        </name>
        <address>
          <email>mzanwar@envs.au.dk</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <name>
          <surname>Henschel</surname>
          <given-names>Andreas</given-names>
        </name>
        <address>
          <email>ahenschel@masdar.ac.ae</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1755 2442</institution-id><institution-id institution-id-type="GRID">grid.419469.7</institution-id><institution>Department of Electrical Engineering and Computer Science, </institution><institution>Masdar Institute of Science and Technology, </institution></institution-wrap>Masdar City, Abu Dhabi, UAE </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 1956 2722</institution-id><institution-id institution-id-type="GRID">grid.7048.b</institution-id><institution>Department of Environmental Science, </institution><institution>Aarhus University, </institution></institution-wrap>Frederiksborgvej 399, Roskilde, Denmark </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>24</day>
      <month>7</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>24</day>
      <month>7</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2017</year>
    </pub-date>
    <volume>18</volume>
    <elocation-id>353</elocation-id>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>3</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>7</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2017</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>Given the current influx of 16S rRNA profiles of microbiota samples, it is conceivable that large amounts of them eventually are available for search, comparison and contextualization with respect to novel samples. This process facilitates the identification of similar compositional features in microbiota elsewhere and therefore can help to understand driving factors for microbial community assembly.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We present Visibiome, a microbiome search engine that can perform exhaustive, phylogeny based similarity search and contextualization of user-provided samples against a comprehensive dataset of 16S rRNA profiles environments, while tackling several computational challenges. In order to scale to high demands, we developed a distributed system that combines web framework technology, task queueing and scheduling, cloud computing and a dedicated database server. To further ensure speed and efficiency, we have deployed Nearest Neighbor search algorithms, capable of sublinear searches in high-dimensional metric spaces in combination with an optimized Earth Mover Distance based implementation of weighted UniFrac. The search also incorporates pairwise (adaptive) rarefaction and optionally, 16S rRNA copy number correction. The result of a query microbiome sample is the contextualization against a comprehensive database of microbiome samples from a diverse range of environments, visualized through a rich set of interactive figures and diagrams, including barchart-based compositional comparisons and ranking of the closest matches in the database.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>Visibiome is a convenient, scalable and efficient framework to search microbiomes against a comprehensive database of environmental samples. The search engine leverages a popular but computationally expensive, phylogeny based distance metric, while providing numerous advantages over the current state of the art tool.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s12859-017-1763-0) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Microbiome</kwd>
      <kwd>Microbial diversity</kwd>
      <kwd>Search engine</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Masdar Institute of Science and Technology</institution>
        </funding-source>
        <award-id>SSG2015-000012</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2017</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Similarity search of microbial community profiles against a comprehensive microbiome database can unravel surprising results. For example, [<xref ref-type="bibr" rid="CR1">1</xref>] reports that samples taken from 2.5 km below the deep-sea surface are closer to organotrophic forest soils in terms of microbial composition than to samples of shallower depths from the same study. This similarity is attributed to the abundance of methanogens. Like in the above-mentioned case, to understand the environmental factors that govern microbial community assembly for a particular sample at hand, it is desirable to find the most similar microbial communities that have been investigated, sequenced and deposited by other researchers. The subsequent analysis of commonalities with respect to their isolation source, description and environmental factors that have led to the observed taxonomic composition of community constituents can unravel the underlying ecological mechanisms and functionality aspects. Such comparison faces three main requirements: (i) the consistent deposition of microbial community profiles in suitable databases, including standardized metadata, (ii) the availability of tools that analyze microbial communities and (iii) the possibility to query against a comprehensive database of diverse samples.</p>
    <p>The former two problems have been readily addressed. Thanks to advances in metagenomics, environmental sampling of microbial communities using Next Generation Sequencing and multiplexing, large amounts of descriptive genetic data are accumulated, particularly 16S rRNA profiles of microbial communities. Moreover, recent years have seen a dramatic increase in microbiome research, which is in part due to the fact that the role of the microbiome is recognized in a wider range of diseases but also environmental processes. Notable trailblazing efforts are the Human Microbiome Project [<xref ref-type="bibr" rid="CR2">2</xref>] and the Earth Microbiome Project [<xref ref-type="bibr" rid="CR3">3</xref>]. However, few problems remain and reflect on the quality of solutions for the third problem. For example, the importance of metadata annotation has been emphasized in [<xref ref-type="bibr" rid="CR4">4</xref>], but the complete and consistent implementation of the developed standards is still in a nascent state. As a result, microbiome search engines can currently not be equipped with search criteria such as pH, salinity, isolation source or temperature. The third problem, to query a user provided sample against a large, comprehensive dataset has not been tackled, except for very few approaches [<xref ref-type="bibr" rid="CR5">5</xref>]. The task of comparing microbial community profiles is computationally expensive and demands an efficient implementation. Ideally, the implementation must cope with the growth of users as well as the growth of the underlying database.</p>
    <p>We here set out to improve on this last category in various aspects: we describe the design and implementation of a scalable, distributed architecture that can handle queries from multiple simultaneous users. Each user can provide multiple samples in form of BIOM tables [<xref ref-type="bibr" rid="CR6">6</xref>], representing high-dimensional (but sparse) Operational Taxonomic Unit (OTU) abundance vectors as measured by 16S rRNA sequence counts. For comparability reasons, we require that all samples are derived from consistent closed reference OTU picking. These abundance vectors are not only compared with each other but are searched and contextualized against samples from a broad range of environments. We therefore strive to employ the most comprehensive database of microbial communities available. NCBI’s Sequence Read Archive (SRA, [<xref ref-type="bibr" rid="CR7">7</xref>]) is likely to be the largest repository of 16S rRNA profiles. However, SRA usually stores raw sequence reads leaving further processing, especially quality control, to the users. Furthermore, the provision of additional metadata such as those specified in MIMARKS as well as barcodes, primer sequences are study-specific, not standardized and therefore difficult to automatize. Qiime-DB/Qiita [<xref ref-type="bibr" rid="CR8">8</xref>] is a microbial study management platform, supporting multiple analytical pipelines. However as with SRA, it does not have the capability of querying a user-provided sample against the underlying database. Likewise, tools like VAMPS [<xref ref-type="bibr" rid="CR9">9</xref>], myPhyloDB [<xref ref-type="bibr" rid="CR10">10</xref>], Mothur [<xref ref-type="bibr" rid="CR11">11</xref>] and Megan [<xref ref-type="bibr" rid="CR12">12</xref>] can compare, store and analyze microbial community profiles, but do not provide a complete similarity search against a comprehensive database. We aim to complement those tools by providing such database search while still facilitating interoperability through standardized file formats such as BIOM and FASTA. This also includes the incorporation of the most commonly used phylogenetic and non-phylogenetic distance measures for microbial communities: weighted UniFrac and Bray-Curtis dissimilarity, respectively. Weighted UniFrac calculations are computationally expensive, and was previously tackled by using Trie-index based heuristics to reduce the number of comparisons [<xref ref-type="bibr" rid="CR5">5</xref>]. We show that this approach is afflicted with a considerable number of False Negatives (i.e. very similar samples were overlooked due to slightly differing indices). To overcome this issue, we deploy an accurate, sublinear similarity search using Geometric Near-neighbor Access Trees (GNAT, [<xref ref-type="bibr" rid="CR13">13</xref>]) which facilitate similarity searches in high dimensional metric spaces. In addition, we deploy AESA (Approximating and Eliminating Search Algorithm), [<xref ref-type="bibr" rid="CR14">14</xref>], which excels in query-intensive systems, i.e., in situations where heavy precalculation is feasible and the number of distance calculations per query needs to be kept minimal. Thanks to the recent realization that Weighted UniFrac is a metric ([<xref ref-type="bibr" rid="CR15">15</xref>]), we show that it is suitable for similarity searches in high dimensional metric spaces using GNATs and AESA. Finally, various aspects for microbial community comparison are taken into account: copy number correction ([<xref ref-type="bibr" rid="CR16">16</xref>]) and rarefaction in order to deal with varying sequencing depths of samples.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p>To tackle the problem of increasing user-base and increasing popularity of sample querying systems, we present a web application called Visibiome. Visibiome features a distributed architecture to maximize usability and minimize dependency issues for personal and public deployments. In its entirety, Visibiome is developed using open-source software. The Visibiome core is built using the web development framework Django which has several benefits for distributed web application development (e.g. it is database agnostic and modular), which is fitting for computationally-heavy search query systems since single-machine implementations will not scale very well with multiple concurrent queries. Here, we explain the modularization of Visibiome and how it scales as a search engine.</p>
    <p>Visibiome uses MySQL as the preferred relational database management system (RDBMS). MySQL is favourable for being open-source, well-received, able to handle complex relational models and is performant [<xref ref-type="bibr" rid="CR17">17</xref>]. Visibiome is connected to two main databases: (i) the Visibiome database (<italic>D</italic>
<sub><italic>V</italic></sub>) and (ii) the indexed microbiome database (<italic>D</italic>
<sub><italic>M</italic></sub>). <italic>D</italic>
<sub><italic>V</italic></sub> contains user schema and user query metadata while <italic>D</italic>
<sub><italic>M</italic></sub> houses an annotated database assembled from various other microbiome databases (described in [<xref ref-type="bibr" rid="CR18">18</xref>]), comprising additional information for samples (such as sample size, Environmental Ontology (EnvO) annotation) and GreenGenes OTUs (taxonomic lineage, 16S rRNA copy number). Visibiome mainly performs complex, multiple read queries on both databases and few, simple write queries on <italic>D</italic>
<sub><italic>V</italic></sub>. While it can reduce connection lag to install <italic>D</italic>
<sub><italic>V</italic></sub> and <italic>D</italic>
<sub><italic>M</italic></sub> in the same vicinities as the computation server, competitions for CPU threads can happen when a query is invoked. Visibiome prefers decoupling the database from the server. This separation enables the web server to focus on serving the web application while a dedicated MySQL server performs complex queries.</p>
    <p>Similarly, for the web server, CPU thread hogging of the query computations over the service of web pages can happen. In this scenario, it is likely that usability of the system will diminish. To remedy this, we deploy Celery for task queuing and deferring [<xref ref-type="bibr" rid="CR19">19</xref>]. Celery enables multiple tasks to be processed in parallel provided that the server has enough CPUs to match the number of “workers” (entities which perform computations). Task queuing is automatically managed by Celery and can be configured to prioritize urgent tasks (for example, lengthy computations). Celery requires a message queuing service to queue the tasks. In Visibiome, we employed Redis as the message queuing service for its high-performance and speed [<xref ref-type="bibr" rid="CR20">20</xref>].</p>
    <p>Newer standards of server technology has made deployment of web services highly automated. Legacy solutions involving configuration is being replaced by conventional means. Interfacing web services through Web Service Gateway Interface (WSGI) is currently a growing standard of which Visibiome takes advantage. Visibiome is served using Nginx and uWSGI to improve speed over traditional Apache servers. To ensure rapid content delivery, considerations have been made for transferring large files and potentially blocking code. For scalability, we deploy Visibiome on an Amazon AWS EC2 server featuring flexible CPU and memory scaling and providing global access for users. A typical schematic of the technology and data flow of the Visibiome system can be seen in Fig. <xref rid="Fig1" ref-type="fig">1</xref>.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Visibiome’s schematic. A brief schematic of a typical Visibiome deployment showing implemented technology (depicted as different shapes and models) and data flow paths (depicted as <italic>arrows</italic>). Visibiome features a distributed architecture. Independent entities can be deployed as a dedicated service rather than coupled to the web server. Flexible entities can be customized to user preferences such as RDBMS. The schematic shows how data are transferred between the implemented technology. The <italic>orange</italic> paths depict user interaction to the web server. The <italic>green</italic> paths depict data flow when queries (computations) are performed. The <italic>grey</italic> path shows the set of original databases compiled into a single MySQL database which contains pre-computed sample distances and metadata</p></caption><graphic xlink:href="12859_2017_1763_Fig1_HTML" id="MO1"/></fig>
</p>
    <sec id="Sec3">
      <title>Using Visibiome and the user interface</title>
      <p>Visibiome is free for public use through its web interface on <ext-link ext-link-type="uri" xlink:href="https://visibiome.org/">https://visibiome.org/</ext-link> (see for more options in “<xref rid="Sec12" ref-type="sec">Availability</xref>” section). Before submitting a sample into Visibiome, users are encouraged to register an account. Anonymous submissions will be stored in a private guest account which is automatically created upon submission. It should be noted that although guest accounts are private, all guest accounts share the same password. Also, guest accounts are temporary and will be deleted within 24 h along with any submissions, uploaded files and processed files attached to the guest account. To avoid loss of processed submissions, the user can upgrade the guest account into a full-fledged account by updating their username and password for the guest account.</p>
      <p>Submissions into Visibiome are OTU tables in BIOM format [<xref ref-type="bibr" rid="CR6">6</xref>]. These can be produced with currently available services such as VAMPS [<xref ref-type="bibr" rid="CR9">9</xref>] or Qiime [<xref ref-type="bibr" rid="CR21">21</xref>]. The BIOM format is notably common (for marker-gene data), standardized and size-efficient. Visibiome accepts BIOM tables in the following file formats: TSV (tab separated values), JSON or HDF5 which allows the data to be human-readable and also space-efficient. User-submitted BIOM tables must be produced by closed-reference OTU picking against GreenGenes 13.5 [<xref ref-type="bibr" rid="CR22">22</xref>] in order to ensure comparability to database samples, but also guarantee fast taxonomic composition analysis of user samples. Visibiome will yield errors for BIOM tables subjected to <italic>de novo</italic> and open referenced OTU picking. This restriction is imposed by the indexing of <italic>D</italic>
<sub><italic>M</italic></sub>. Note that closed reference OTU picking is far more suitable for the type of database search presented here, and we further justify this choice in the “<xref rid="Sec6" ref-type="sec">Results and discussion</xref>” section. In addition, we provide the possibility for users to submit FASTA files with sequence identifiers that are in a format as expected by QIIME’s OTU picking scripts (&lt;sample-id&gt;_&lt;sequence-id&gt;, see QIIME’s documentation on file formats, <ext-link ext-link-type="uri" xlink:href="http://qiime.org/documentation/file_formats.html">qiime.org/documentation/file_formats.html</ext-link>). Visibiome automatically recognizes FASTA files (by file extension) and picks OTUs compatible with the outlined workflow. For full metagenomic shotgun datasets we recommend to preprocess the sequences with tools that produce taxonomic profiles, such as SortMeRNA [<xref ref-type="bibr" rid="CR23">23</xref>]. Last but not least, Visibiome works with normalized and non-normalized OTU counts by prompting users to normalize 16S copy numbers during query (which is achieved by extracting pre-calculated values for all OTUs from the database, populated with PICRUSt’s script normalize_by_copy_number.py [<xref ref-type="bibr" rid="CR24">24</xref>]).</p>
      <p>Present-era web applications often feature data management and browser-based user interface; for example, in the realm of bioinformatics: [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR26">26</xref>] and many others. Considering the numerous combinations of query settings and outputs available in Visibiome, a simple but sophisticated organization of these information is imperative. We ease client-side file management by recording user submissions as individual entities called jobs. When performing a query, a user provides settings and filters for a job, along with the desired BIOM file, before submitting it into the system. All jobs are private to the submitting user and are conveniently listed in the user dashboard. Jobs are annotated with metadata which includes links to access the output visualizations, time-based information, all user-selected settings during query and any error messages encountered during processing. Jobs can also be removed and rerun.</p>
      <p>Visibiome produces visualizations of user queries as an output. Visualizations are displayed on the user’s browser by leveraging cutting-edge plotting libraries: matplotlib [<xref ref-type="bibr" rid="CR27">27</xref>], d3.js [<xref ref-type="bibr" rid="CR28">28</xref>] and mpld3 [<xref ref-type="bibr" rid="CR29">29</xref>]. These output visualizations are separated into different pages. The “Ranking” page presents a high-level summary of the search query. Closest matching database samples to the user-queried samples are ranked into a list of cards. Each card contains metadata relating to the database-matched samples and, where possible, provide a URL to the source of the data. The “Ranking” page also features barcharts for comparison of sample compositions, thus allowing users to inspect the culprit of taxonomic similarity between query samples and matched samples, see Fig. <xref rid="Fig2" ref-type="fig">2</xref>. Visibiome produces interactive, zoomable barcharts for up to three user selected taxonomic ranks. An interactive, metadata-labelled, principle coordinate analysis (PCoA) plot is also available with zoom functionality to closely distinguish sample points. Queried samples can also be contextualized through a metadata-labelled dendrogram plot of the closest matches. More details regarding the contextualization of the samples can be found in later sections of this work. For a list of secreenshots of Visibiome, see Fig. <xref rid="Fig3" ref-type="fig">3</xref>.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Compositional comparison of query sample and matched sample. The barcharts show compositional correspondences on genus-, family-, and phylum level. The fractions of constituents are consistently ordered with respect to the size in the query sample. This facilitates visual inspection as to why samples have been deemed similar in terms of the chosen distance measure</p></caption><graphic xlink:href="12859_2017_1763_Fig2_HTML" id="MO2"/></fig>
<fig id="Fig3"><label>Fig. 3</label><caption><p>Screenshot of the user interface. User interface with input mask, providing the user with several ways to upload an OTU table in BIOM format or raw sequences in FASTA format and to select search criteria to narrow the search to a subset of predefined ecosystems. Users can also supply other available search parameters to a query such as the distance measure and the ranking levels for visualization</p></caption><graphic xlink:href="12859_2017_1763_Fig3_HTML" id="MO3"/></fig>
</p>
      <sec id="Sec4">
        <title>Search algorithms</title>
        <p>In order to speed up search against a large database, we deploy two fast search algorithms: Geometric Near-neighbor Access Trees (GNATs) [<xref ref-type="bibr" rid="CR13">13</xref>] and the Approximating and Eliminating Search Algorithm (AESA) [<xref ref-type="bibr" rid="CR30">30</xref>]. While GNATs are suitable for larger databases due to the lower (subquadratic) precalculation cost, AESA excels by reducing the number of distance (metric) computations per query to <italic>O</italic>(1) on average. We chose GNATs and AESA over other similarity search techniques due to their great performance in high-dimensional metric spaces. We combine both algorithms with an optimized weighted UniFrac calculation as metric. As we use GreenGenes 13.5 as closed reference, every sample is expressed as a sparse vector of (relative) abundances of dimensionality equal to the size of our OTU reference (99.325 OTUs for 97% sequence identity) which we denote as <italic>L</italic>.</p>
        <p>We use the Python based GNAT implementation from coord_util [<xref ref-type="bibr" rid="CR31">31</xref>], which is compatible with any user defined metric. We implemented AESA according to the algorithm description in [<xref ref-type="bibr" rid="CR32">32</xref>]. We use our previously published and indexed MySQL database for rapid sample information retrieval [<xref ref-type="bibr" rid="CR18">18</xref>]. We calculate the weighted UniFrac metric using an optimized version of EMDUnifrac [<xref ref-type="bibr" rid="CR33">33</xref>], an efficient algorithm inspired by the recognition that weighted UniFrac is a metric equivalent to the Earth Mover Distance (EMD) [<xref ref-type="bibr" rid="CR34">34</xref>]. EMDUnifrac starts with relative abundance differences at the leaves of the phylogeny and propagates “earth” (here: abundance differences) in a bottom-up manner, while balancing sources and sinks during each traversed node. The original algorithm traverses every node of the phylogeny and its complexity is provided with <italic>O</italic>(<italic>L</italic>). Note that the chosen choice of similarity threshold (here 97%) relates to <italic>L</italic> and hence affects the emdusparse In our case, <italic>L</italic> is very large. To further reduce the complexity, we base our optimization on the observation that most abundance vectors are sparse (i.e. 0 for most OTUs) and thus do not contribute to the distance calculation. We therefore consider only leaves that have non-zero abundance differences. To account for the varying depth of the GreenGenes phylogeny we perform tree traversal strictly level-wise using a list of dictionaries, one for each level. The dictionaries maintain the amount of unbalanced “earth” received from its children. Only when all children are processed can the remaining amount be propagated to the node’s parent, if the amount is non-zero. We refer to this algorithm as emdusparse.</p>
        <p>We build GNATs for the entire database comprising |<italic>M</italic>|=24.615 samples as well as for individual ecosystems. We denote the cardinality of the user-submitted samples as |<italic>N</italic>|, which varies between 1 and 10 in the interest of timely computation. Contextualization through principal coordinates analysis (denoted as PCoA) and Hierarchical Clustering (denoted as HC) requires a complete |<italic>M</italic>
<sup>′</sup>∪<italic>N</italic>|×|<italic>M</italic>
<sup>′</sup>∪<italic>N</italic>| distance matrix that includes meaningful samples from our database (<italic>M</italic>
<sup>′</sup>⊆<italic>M</italic>) as well as the provided user samples (<italic>N</italic>). For each user sample, we initiate a GNAT range search with a distance threshold of 0.3 (motivated by the empirical <italic>p</italic>-value discussed below and the amount of pruning that is possible with smaller thresholds). All computed distances of encountered comparisons are recorded; however, the encountered GNAT nodes for each search differ from user sample to user sample, in particular when user samples are very different from each other. In our implementation, a full beta-diversity distance matrix without missing values is required for contextualization (HC, PCoA). We therefore consider only those database samples that have been compared to all user samples during the individual GNAT searches. From this set, we retain only those that are within the top <italic>k</italic> (default 20) for at least one of the user samples, yielding a conveniently sized context <italic>M</italic>
<sup>′</sup>. Note that the encounters of samples associated with GNAT nodes make for a meaningful combination for contextualization: a few remote samples (from top-level GNAT nodes) and a number of more closely related samples as the GNAT search narrows in. This procedure yields a |<italic>M</italic>
<sup>′</sup>|×|<italic>N</italic>| distance matrix without missing values (see also Fig. <xref rid="Fig4" ref-type="fig">4</xref>, second and third item in the box for Analysis Type I). We then compose the complete matrix as follows: the |<italic>M</italic>
<sup>′</sup>|×|<italic>M</italic>
<sup>′</sup>| distance matrix is extracted from the pre-calculated |<italic>M</italic>|×|<italic>M</italic>| matrix (fourth item in Analysis Type I, Fig. <xref rid="Fig4" ref-type="fig">4</xref>). The required (|<italic>M</italic>|2)=302.961.420 weighted UniFrac calculations were performed on our in-house High Performance Computing Center using a parallelized script splitting the task into 10.000 jobs over 384 processors. In order to extract the submatrix from this matrix (4.6 GB on disk space), we use NumPy, Dask [<xref ref-type="bibr" rid="CR35">35</xref>] (which facilitates out-of-core computation), and fancy indexing with the matrix being stored in HDF5 format. The user samples <italic>N</italic> are compared with each other, calling emdusparse for each pair (fifth item in Analysis Type I, Fig. <xref rid="Fig4" ref-type="fig">4</xref>). We finally combine all submatrices to obtain the complete beta-diversity distance matrix for all samples including the context <italic>M</italic>
<sup>′</sup> and the user samples <italic>N</italic>.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Visibiome’s workflow. The figure outlines the typical workflows when using Visibiome. The upper part deals with the Web interface and user interaction. At the core of Visibiome are two analysis types, comprehensive/phylogeny based and quick/non-phylogenetic distance based. Note that Analysis Type I (GNAT search) selectively compares to chosen database samples during GNAT traversal which are specific to the query sample. For some parts of the visualization however, a complete beta diversity distance matrix is required. As a consequence, the algorithm chooses M’ samples from the intersection of the individual search spaces. Moreover, barcharts for compositional comparisons <sup>∗</sup> are currently only generated for Analysis Type I</p></caption><graphic xlink:href="12859_2017_1763_Fig4_HTML" id="MO4"/></fig>
</p>
        <p>Note that GNAT and AESA require distance measures that are metrics, i.e. fulfil the triangle inequality, are symmetric and non-negative, which is not the case for the popular Bray-Curtis dissimilarity. To address the lack of such properties, we introduce a coarse-level search algorithm by searching against up to 1000 randomly-selected representative samples (derived from HC) seeded from a pool of representatives by an ecosystem filter. Once completed, the user samples are contextualized against the representative samples by means of visualizations. We pre-calculated the Bray-Curtis dissimilarity for a large subset of 10.500 samples in the database. For PCoA/HC that requires a complete beta-diversity distance matrix, a query sample still would give rise to <italic>M</italic> individual comparisons. However, by comparing only against representatives, we can substantially reduce the amount of comparisons to identify the top <italic>k</italic> samples and to produce a relevant beta-diversity distance matrix.</p>
      </sec>
      <sec id="Sec5">
        <title>Contextualization</title>
        <p>The dataset used in this work to contextualize user-submitted samples is described in [<xref ref-type="bibr" rid="CR18">18</xref>]. Notably all samples are associated with metadata. In particular, standardized, hierarchically structured descriptors about the sample’s environment are utilized: every sample from QIIME-DB contains up to three annotations from the Environmental Ontology (denoted as EnvO, [<xref ref-type="bibr" rid="CR36">36</xref>]), namely environmental material, environmental feature and biome. Other samples in the dataset did not have EnvO annotations originally and were added retroactively using text mining as described in [<xref ref-type="bibr" rid="CR18">18</xref>]. For improved comprehension of context, further grouping of EnvO annotations into high-level ecosystems (soil, human-associated, fresh water, marine, plant associated, etc.) were carried out exploiting the hierarchical nature of the ontology, the details of which are also provided in [<xref ref-type="bibr" rid="CR18">18</xref>].</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec6">
    <title>Results and discussion</title>
    <p>We here presented a multi-component architecture that performs search and contextualization of microbial community 16S rRNA profiles against a large database of samples from all environments. Several computational challenges are tackled. The overall work-flow is shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. In summary, user samples uploaded to the web server undergo a series of analysis types, namely search against the database, yielding a ranking of closest matches. Subsequently, the algorithm constructs an extended distance matrix—while utilizing pre-calculated distances for database samples—in order to perform PCoA and HC of ranked database samples and user samples together. A typical result is shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>: the user can see the submitted samples in relation to each other <italic>and</italic> in the context of the closest matches. More screenshots are in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S4–S8. We provide two types of searches, one for the most popular non-phylogenetic distance measure (Bray Curtis dissimilarity) and one for the most popular phylogenetic distance measure, weighted UniFrac. The latter is a distance metric and as such lends itself to similarity search algorithms in metric spaces. The dimensionality of the metric space is in our case determined by the size of the deployed reference library, GreenGenes 13.5, as samples are represented as equal-sized OTU abundance vectors. The high dimensionality is thus a result of the recognized microbial diversity and it is conceivable that this number is to grow even further as more OTUs enter the reference. We reference [<xref ref-type="bibr" rid="CR37">37</xref>], who reported 5.6 million OTUs from open reference picking.
<fig id="Fig5"><label>Fig. 5</label><caption><p>PCoA plot of user-submitted samples against closest matches. The figure shows a typical PCoA plot from the output of querying several samples (depicted as red star points) against the Visibiome database samples (depicted as circular points in varying colors). The PCoA plot allows users to contextualize the submitted samples against its closest matching database samples. Visibiome displays the matched samples with ecosystem labels and EnvO labels. Other metadata are also attached to each sample point (if available)</p></caption><graphic xlink:href="12859_2017_1763_Fig5_HTML" id="MO5"/></fig>
</p>
    <sec id="Sec7">
      <title>Feasibility of OTU picking strategies in online database search</title>
      <p>While open reference or <italic>de novo</italic> OTU picking is desirable, it would incur further requirements and inaccuracies: in addition to extremely high dimensionality in open reference picking, OTU picking (at least for the de novo part) would be required for the entire database <italic>after</italic> user submission. Moreover, an all-encompassing phylogeny (including de novo OTUs) is needed to run UniFrac (or any other phylogenetic distance measure), a demanding feat best performed on full length sequences (it is not straightforward, how phylogenies for millions of OTUs should be generated). Last but not least, open reference/<italic>de novo</italic> OTU picking is not feasible for comparison of samples for which non-overlapping segments (i.e., different hypervariable regions where sequenced) which limits the scope of meta-analyses further. Instead, we here estimate the impact from the loss of information for the task of similarity search to show that closed reference based distances are a suitable approximation. We calculate <italic>β</italic>-diversity distances with and without sequences that don’t match the reference for a set of environmental samples that have around 66% matches against the reference (GreenGenes 13.5), see [<xref ref-type="bibr" rid="CR18">18</xref>], Table S2 therein. The results show that distance calculations do not differ much (Additional file <xref rid="MOESM2" ref-type="media">2</xref>) and hence rarely affect the ranking in similarity searches.</p>
    </sec>
    <sec id="Sec8">
      <title>Search efficiency</title>
      <p>We investigated the state-of-the-art Nearest Neighbor search techniques such as K-D trees, Ball Trees, and Vantage Point Trees explained in [<xref ref-type="bibr" rid="CR32">32</xref>]. All of them performed poorly (i.e. resorted to brute force linear search) due to the very high dimensionality of the present search space. Only GNAT and AESA avoided a complete linear search, but the former still required several thousands of comparisons during a single query while the latter reduced comparisons significantly (for details, see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S9. On the other hand, note that the pre-calculation of the complete |<italic>M</italic>|×|<italic>M</italic>| distance matrix constitutes the main computational challenge and is the central requirement for AESA. Therefore, contextualization and AESA search will only be possible for mid-size databases, while GNAT can go beyond. Since also the phylogeny-based distance measure calculation is computationally expensive, we not only minimized the number of calculations but also optimized the distance measure (weighted UniFrac) itself through building on recent results presented in [<xref ref-type="bibr" rid="CR33">33</xref>], in which the authors present an algorithm that traverses the entire phylogeny (i.e., 198.642 nodes for the comprehensive GreenGenes phylogeny encompassing 99.325 OTUs from 97% sequences similarity clustering). The sparse vector based calculation presented here led to a reduction of traversed nodes as exemplified for ten samples in Fig. <xref rid="Fig6" ref-type="fig">6</xref>. The boxplot shows, for each sample, the number of traversed nodes of the reference phylogeny when emdusparse is invoked with the samples encountered during GNAT search (each yielding a data point, respectively). This approach requires only the traversal of subtrees above leaves with non-zero abundance differences. Thus, by traversing only the relevant part of the phylogeny, the number of visited nodes is roughly two orders of magnitudes smaller than the full-size phylogeny.
<fig id="Fig6"><label>Fig. 6</label><caption><p>Efficient search through search spaces similarity search and sparse EMD-UniFrac (emdusparse). The number of nodes visited during an individual emdusparse traversal of the reference phylogeny reduces from 198.642 to an average of 400-1300 nodes, i.e. 0.2-0.6%, respectively. Note that for each boxplot we collected the traversal counts from all emdusparse comparisons during the entire GNAT search for the respective sample. The speedup is particularly noticeable for samples with few distinct or phylogenetically similar OTUs</p></caption><graphic xlink:href="12859_2017_1763_Fig6_HTML" id="MO6"/></fig>
</p>
      <p>Note that rarefaction further decreases the number of non-zero entries in abundance vectors by ridding low abundance OTUs. Also note that traversal is generally faster for less complex samples with lower numbers of OTUs, i.e., lower (phylogenetic) <italic>α</italic>-diversity.</p>
      <p>We empirically evaluated the running time of Analysis Type I and Analysis Type II by simulating user submissions. Each submission contains varying number of samples and are distributed randomly. For GNAT search and Bray-Curtis distance, the number of samples range from 1 to 10 samples; for AESA search, 10 to 100 samples in intervals of 10. Samples were randomly generated from various sources such as NCBI SRA, MgRAST and unpublished samples, meaning that submissions can contain samples which are very distant and possibly foreign to the server samples. To be conservative, we measured the running time of each analysis type from the moment the submitted BIOM file was validated. The preceding measurement takes into account all facets of the computations in Visibiome: computation of pairwise distances, querying of the pre-indexed database, queuing times and generation of visualization files.</p>
      <p>The evaluation was done on a t2.medium AWS EC2 machine (specified to have 2 vCPUs and 4GB of RAM) utilizing two Celery workers to perform search queries. We subjected the submissions into two scenarios: (i) when the server is under no stress and search jobs are initiated infrequently and (ii) when the server is under stress of a large influx of jobs. We make our case by performing searches against the “All” criteria, implying searching over all ecosystem types, which is a heavy workload. To artificially replicate scenario A, a script automatically submits a new search job every 15 min. For scenario B, the time interval between new search jobs is 15 s. A total of 200 jobs were submitted split over 10 sample sizes giving 20 data points per sample size.</p>
      <p>We found that in scenario A (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1(a)), Analysis Type II generally performs a search against “All” ecosystems in under one minute. This is attributed to the minimal queuing time for each search job and the coarse-grained nature of the Bray-Curtis analysis type. The processing time rises due to the complexity of pairwise distance calculations for increasing number of samples. The results of Analysis Type I (for both GNAT and AESA search) were similar: ranging from an average time of just under 2 min for a submission containing 1 sample (and 10 samples, respectively) up to 13 min for 10 samples (and 100 samples, respectively). See Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2 and Fig. <xref rid="Fig7" ref-type="fig">7</xref> for the empirical plots. For scenario B, it can be seen in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1(b) that, under heavy stress, Analysis Type II completes in around 5 min, on average. Again, similar trends were observed in Analysis Type I although queuing times were significantly longer (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2 and Fig. <xref rid="Fig8" ref-type="fig">8</xref>).
<fig id="Fig7"><label>Fig. 7</label><caption><p>Boxplots of search query time for different number of samples in AESA search (Analysis Type I) under different stress levels. The boxplots show the running time (as in “job completion time”) for search queries of different input sizes in low server stress scenario, (<bold>a</bold>), and high server stress scenario, (<bold>b</bold>). The <italic>red asterisk</italic> represents the average running time, calculated over 20 running times, for each input size. The complexity of performing a search query can be directly inferred from (<bold>a</bold>) while in (<bold>b</bold>) this correlation is confounded by the addition of long queuing time. This trend is similarly seen in Analysis Type II but with lower running time than those of Analysis Type I</p></caption><graphic xlink:href="12859_2017_1763_Fig7_HTML" id="MO7"/></fig>
<fig id="Fig8"><label>Fig. 8</label><caption><p>Boxplots of search query time for different number of samples in AESA search under high-stress scenario. The boxplots show the running time for search queries of different input sizes in high server stress scenarios on different AWS machine specifications. The <italic>red asterisk</italic> represents the average running time, calculated over 20 running times, for each sample size. The magenta dotted line represents the overall average time for the jobs (25815.3s in (<bold>a</bold>) and 2340.6s in (<bold>b</bold>)). It is clear that the system scales well provided more computations can be done in parallel</p></caption><graphic xlink:href="12859_2017_1763_Fig8_HTML" id="MO8"/></fig>
</p>
      <p>This delay is due to the random queue into which jobs are put. Since jobs are collected asynchronously into a queue, and coupled with the speed at which jobs are invoked, jobs can be processed much later although requested earlier. The randomized queuing is unfortunately a feature of Celery which can possibly be mitigated by relaying jobs into priority queues. The algorithm for performing the relays are nontrivial and can have caveats in real scenarios due to randomness.</p>
      <p>To evaluate the running time of range searches at different range values, we subjected a single sample size to the different meaningful ranges provided in Visibiome (which are 0.1, 0.2, 0.3 and 0.4). Similar to the tests we performed above, we executed 20 trials for each range with randomized samples under low and high stress. The results can be viewed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S10 and S11. As expected, we see similar trends to the analysis shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S9 depicting a polynomial increase in number of comparisons. In high stress situations, the queuing of jobs levels the processing time although at 0.4 range the running time are mostly escalated.</p>
      <p>It is important to note that the running time of search queries have been recorded to be as long as 48 h for AESA search (again, due to extended queuing instead of processing time) when the server is encumbered. We expect such scenarios to be unlikely and can be mitigated by scaling up the server specifications and employing more Celery workers. Note that thanks to cloud elasticity, this step has minimal requirements: we just had to order additional (virtual) hardware for a short period of time. To evaluate this, we scaled up the deployment server from t2.medium to c4.4xlarge with 16 vCPUS and 30 GB of RAM and employed only 8 Celery workers. We subjected the same high-stress scenario as previously described to GNAT and AESA search. The results for the simulation under high stress situations revealed that running times were significantly reduced by upscaling (see Fig. <xref rid="Fig8" ref-type="fig">8</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3).</p>
      <p>According to these findings, our suggestion for prospective heavy users is to download the prepared distribution of Visibiome and perform queries on their personal computers. We envision a way to make Visibiome more available to users: our modular, scalable architecture lends itself to crowd-deployed pool aggregation of Visibiome servers, from which users can select to quickly obtain results from their queries.</p>
    </sec>
    <sec id="Sec9">
      <title>Comparison to existing microbial community analysis tools/databases</title>
      <p>Our web interface, job management and querying features are akin to those presented in IMNGS [<xref ref-type="bibr" rid="CR25">25</xref>], although no searching of 16S rRNA profiles against a comprehensive database was provided in the system. Our approach compares well to Meta-Storms [<xref ref-type="bibr" rid="CR5">5</xref>], the only other published microbiome search engine (to the best of our knowledge).</p>
      <p>In the original work, Meta-Storms was described to require the building of a database from samples collected by the users before comparison is done. Visibiome features a comprehensive set of prepared samples against which user samples can be immediately compared removing the need to self-curate databases. While an example database was provided for demonstration purposes in Meta-Storms, Visibiome boasts a much larger sample database. The sample sources collected in Visibiome were formed from various study sizes but is broad in terms of ecosystems. Meta-Storms (as part of the Parallel-META pipeline [<xref ref-type="bibr" rid="CR38">38</xref>]) can make use of the GPU for faster processing. On the other hand, Visibiome focuses on being catered to commodity server hardware, enabling cheap horizontal and vertical scaling. A summary of these differences are listed in Table <xref rid="Tab1" ref-type="table">1</xref>.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Comparison of key features between Meta-Storm and Visibiome</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Criterion</th><th align="left">Meta-Storms</th><th align="left">Visibiome</th></tr></thead><tbody><tr><td align="left">Scalable architecture</td><td align="justify">No</td><td align="justify">Yes</td></tr><tr><td align="left">Job-queuing/Scheduling</td><td align="justify">No</td><td align="justify">Yes</td></tr><tr><td align="left">GPU support</td><td align="justify">Yes (Parallel-Meta)</td><td align="justify">No</td></tr><tr><td align="left">Web interface</td><td align="justify">No</td><td align="justify">Yes</td></tr><tr><td align="left">Database implementation</td><td align="justify">Indexed Flat files</td><td align="justify">MySQL and NumPy matrix</td></tr><tr><td align="left">Database size</td><td align="justify">1,318 samples</td><td align="justify">24,615</td></tr><tr><td align="left">Number of studies</td><td align="justify">18</td><td align="justify">2767</td></tr><tr><td align="left">Input</td><td align="justify">Custom Preprocessing</td><td align="justify">FASTA or BIOM</td></tr><tr><td align="left">Max. samples per submission</td><td align="justify">1</td><td align="justify">10 (GNAT)/100 (AESA)</td></tr><tr><td align="left">Copy number correction</td><td align="justify">No</td><td align="justify">Yes</td></tr><tr><td align="left">Adaptive Rarefaction</td><td align="justify">No</td><td align="justify">Yes</td></tr><tr><td align="left">Interactive bar diagrams</td><td align="justify">No</td><td align="justify">Yes</td></tr><tr><td align="left">PCoA</td><td align="justify">Yes (Parallel-Meta req.)</td><td align="justify">Yes</td></tr><tr><td align="left">Hierarchical Clustering</td><td align="justify">Yes (Parallel-Meta req.)</td><td align="justify">Yes</td></tr><tr><td align="left">Distance Measure</td><td align="justify">Unifrac-Like Score</td><td align="justify">EMD-UniFrac</td></tr></tbody></table></table-wrap>
</p>
      <p>Sample comparison in Meta-Storms is guided by indices derived from the ordered top five most abundant phyla of a sample. A quick analysis in our database of 24.615 samples shows a relatively large number of False Negatives, i.e., samples that would not be retrieved but should have been: from the (246152) pre-calculated distances, we chose distances that are below a certain threshold. From the selected distances, we check whether the corresponding sample pair has differing indices. The results are shown in Table <xref rid="Tab2" ref-type="table">2</xref>. Even with a very small UniFrac distance of 0.1 (wrt. the utilized GreenGenes phylogeny), a substantial number (1402) of pairs of samples have differing top 5 phyla indices. With our Analysis Type I search we avoid this type of error all together. Instead we ensure efficient computation and 100% recall (wrt. to the user provided range search threshold) algorithmically: When using precalculated data structures, the search space is rapidly pruned by discarding all samples for which their representatives are too distant from the query, in terms of the chosen ecological distance metric.
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Observed False Negatives for top 5 phyla indexing (as done in Meta-Storms) in the presented database, i.e., the number of sample pairs below a specified threshold though with differing top 5 phyla indices; listed in dependence of various UniFrac thresholds</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Weighted UniFrac</th><th align="left">Total pairs</th><th align="left">Pairs with</th><th align="left">Percentage</th></tr><tr><th align="left">threshold</th><th align="left">below threshold</th><th align="left">different keys</th><th align="left"/></tr></thead><tbody><tr><td align="left">0.05</td><td align="left">28,247</td><td align="left">351</td><td align="left">1.24</td></tr><tr><td align="left">0.10</td><td align="left">96,977</td><td align="left">1,402</td><td align="left">1.45</td></tr><tr><td align="left">0.20</td><td align="left">846,107</td><td align="left">14,993</td><td align="left">1.77</td></tr><tr><td align="left">0.30</td><td align="left">4,847,874</td><td align="left">91,902</td><td align="left">1.90</td></tr></tbody></table><table-wrap-foot><p>Note that this type of error is avoided in our work by the use of GNAT data structures (Analysis Type I)</p></table-wrap-foot></table-wrap>
</p>
    </sec>
    <sec id="Sec10">
      <title>Significance of matches</title>
      <p>We estimate the significance of a match <italic>m</italic> to a query sample <italic>q</italic> by calculating the empirical <italic>p</italic>-value (see Fig. <xref rid="Fig9" ref-type="fig">9</xref>): the computed distance between a query and a match is put into perspective by relating to all 302 Million observed distances, i.e., what fraction of them is smaller than the distance <italic>d</italic>(<italic>m</italic>,<italic>q</italic>), see Eq. <xref rid="Equ1" ref-type="">1</xref>. 
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ p = \frac{|\{m^{\prime}, m^{\prime\prime} \in M\ |\ d(m^{\prime}, m^{\prime\prime}) &lt; d(m,q) \}|}{\genfrac{(}{)}{0pt}{}{|M|}{2}}   $$ \end{document}</tex-math><mml:math id="M2"><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mo>{</mml:mo><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>′′</mml:mi></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:mi>M</mml:mi><mml:mspace width="1em"/><mml:mo>|</mml:mo><mml:mspace width="1em"/><mml:mi>d</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>′′</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mo>&lt;</mml:mo><mml:mi>d</mml:mi><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo>)</mml:mo><mml:mo>}</mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mfrac linethickness="0.0pt"><mml:mrow><mml:mo>|</mml:mo><mml:mi>M</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="12859_2017_1763_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>
<fig id="Fig9"><label>Fig. 9</label><caption><p>Empirical <italic>p</italic>-value calculation. The histogram shows the number of observed distances in bins of size 10<sup>−4</sup> (<italic>black bars, left y-axis</italic>). From this we calculate the empirical <italic>p</italic>-value for a given distance as provided in Eq. <xref rid="Equ1" ref-type="">1</xref> (<italic>red line, right axis</italic>)</p></caption><graphic xlink:href="12859_2017_1763_Fig9_HTML" id="MO9"/></fig>
</p>
      <p>In order to perform this computation efficiently, we pre-calculated a histogram of distances with 10.000 bins and in turn, the cumulative sum thereof, thus obtaining an accurate estimate for the numerator in Eq. <xref rid="Equ1" ref-type="">1</xref>.</p>
    </sec>
    <sec id="Sec11">
      <title>Application of Visibiome</title>
      <p>Recall the findings in [<xref ref-type="bibr" rid="CR1">1</xref>] where the authors found deep subsurface metagenomes to be similar to forest metagenomes. In light of this relatively “alien” sample, we took to Visibiome to discover other similar samples. We subjected the subsurface samples (which varied in the sampling depth) to the available search methods in Visibiome and discuss the results.</p>
      <p>The output results from Visibiome can be viewed (publicly) at the following links 
<list list-type="bullet"><list-item><p>GNAT search: <ext-link ext-link-type="uri" xlink:href="https://visibiome.org/public/jobs/2801/details">https://visibiome.org/public/jobs/2801/details</ext-link>
</p></list-item><list-item><p>AESA search: <ext-link ext-link-type="uri" xlink:href="https://visibiome.org/public/jobs/2800/details">https://visibiome.org/public/jobs/2800/details</ext-link>
</p></list-item><list-item><p>Bray-Curtis search: <ext-link ext-link-type="uri" xlink:href="https://visibiome.org/public/jobs/2797/details">https://visibiome.org/public/jobs/2797/details</ext-link>
</p></list-item></list>
</p>
      <p>Surprisingly, the deepest sample (SRR1777625) exhibits similarities to database samples from entirely different environments, not reported previously. Figure <xref rid="Fig2" ref-type="fig">2</xref> shows the compositional similarities to one of the closest matches, sample ID 4.1.CD.N from Qiita study 314: airborne microbial communities at high altitude. Both samples are composed of the families Comamonadaceae, Pseudomonadaceae, Methylobacteriaceae, Oxalobacteraceae, Xanthomonadaceae and Propionicateriaceae. On genus level, compositional similarities are less obvious. We argue that these nontrivial commonalities are rarely possible to retrieve manually from a search space of many thousands of samples.</p>
    </sec>
    <sec id="Sec12">
      <title>Availability</title>
      <p>All described functionality is freely accessible through the web interface <ext-link ext-link-type="uri" xlink:href="https://visibiome.org/">https://visibiome.org/</ext-link>. We provide the web interface generously but users may suffer from long queue times as a result of few CPUs available to process jobs in parallel. The choice of few processing CPUs is in the interest of minimizing hosting costs and it is encouraged that prospective users download a distribution of Visibiome for personal use. For those who intend to have a personal deployment of Visibiome, a VirtualBox distribution with Ubuntu and Visibiome is also freely available for download. The current implementation of Visibiome has some strict, albeit light, system requirements to be usable on an independent installation. Visibiome has only been tested to work as expected on Ubuntu 12.04 or newer. A minimum of 3 GB of RAM is recommended due to the need to load large files during computation; however, Dask based out-of-core computation enables functioning on lower specifications. Adequate storage is necessary for pre-calculated data, the indexed MySQL database and user-uploaded files. As explained previously, Visibiome pairs with Python libraries seamlessly giving users the freedom to customize and augment the computational scripts. The source code for Visibiome is available from Bitbucket licensed under GPL v3.0. The Git repository can be found at <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/syaffers/visibiome.git">https://bitbucket.org/syaffers/visibiome.git</ext-link> and the authors welcome future contributors to the project.</p>
    </sec>
  </sec>
  <sec id="Sec13" sec-type="conclusion">
    <title>Conclusion</title>
    <p>Visibiome is a microbiome search engine that boasts various architectural features to be scalable to many simultaneous user requests. It was demonstrated to serve computationally demanding jobs under high stress. We also showed that job completion time scales well through addition of more processors and according adjustment of number of workers. In addition to the state of the art job distribution and user management, users can provide multiple samples at once, which are then compared to each other as well as to the database.</p>
    <p>We offer two types of analysis. The rationale for this is to provide one phylogeny-aware search technique with high accuracy (no false negatives as with phyla based indices) and one search with speed as top priority with a coarse-grained overview. For the former, we have implemented a search engine that is able to perform thousands of Weighted UniFrac calculations for a complete database search in a reasonable amount of time thanks to two main algorithmic advances: the use of GNAT and AESA structures for microbiome similarity search and the deployment of an optimized form of EMDUniFrac. Visibiome is available as a web server, as source code or as a pre-configured virtual machine.</p>
  </sec>
  <sec id="Sec14">
    <title>Availability and requirements</title>
    <p>
      <list list-type="bullet">
        <list-item>
          <p><bold>Project name:</bold> Visibiome</p>
        </list-item>
        <list-item>
          <p>
            <bold>Project home page:</bold>
            <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/syaffers/visibiome">https://bitbucket.org/syaffers/visibiome</ext-link>
          </p>
        </list-item>
        <list-item>
          <p><bold>Archived version:</bold> Not applicable</p>
        </list-item>
        <list-item>
          <p><bold>Operating system(s):</bold> Platform independent (tested on Ubuntu 12.04 and above)</p>
        </list-item>
        <list-item>
          <p><bold>Programming language:</bold> Python</p>
        </list-item>
        <list-item>
          <p><bold>Other requirements:</bold> Nginx 1.10, MySQL 5.5, Redis 3.0.6, Python 2.7+, QIIME 1.9.1, NumPy 1.10+, see requirements.txt in the repository for more Python package requirements</p>
        </list-item>
        <list-item>
          <p><bold>License:</bold> GPL v3.0</p>
        </list-item>
        <list-item>
          <p><bold>Any restrictions to use by non-academics:</bold> None</p>
        </list-item>
        <list-item>
          <p>The randomly generated BIOM tables used in this study are available in the Amazon AWS S3 bucket, <ext-link ext-link-type="uri" xlink:href="https://s3.amazonaws.com/visibiome-data-files/supplementary/generated-biom.tar.gz">https://s3.amazonaws.com/visibiome-data-files/supplementary/generated-biom.tar.gz</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://s3.amazonaws.com/visibiome-data-files/supplementary/AESA-biom.tar.gz">https://s3.amazonaws.com/visibiome-data-files/supplementary/AESA-biom.tar.gz</ext-link>
</p>
        </list-item>
        <list-item>
          <p>Supplementary figures and data can be found in a git repository, <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/syaffers/visibiome-supplementary/">https://bitbucket.org/syaffers/visibiome-supplementary/</ext-link>
</p>
        </list-item>
      </list>
    </p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional files</title>
    <sec id="Sec15">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2017_1763_MOESM1_ESM.pdf">
            <label>Additional file 1</label>
            <caption>
              <p>Supplementary figures are collected in this document. (PDF 723 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2017_1763_MOESM2_ESM.xlsx">
            <label>Additional file 2</label>
            <caption>
              <p>Spreadsheet comparing Open and Closed reference OTU picking The file is a spreadsheet in Microsoft Excel format. (XLSX 15 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>AESA</term>
        <def>
          <p>Approximating and eliminating search algorithm</p>
        </def>
      </def-item>
      <def-item>
        <term>EMD</term>
        <def>
          <p>Earth mover distance</p>
        </def>
      </def-item>
      <def-item>
        <term>GNAT</term>
        <def>
          <p>Geometric near-neighbor access tree</p>
        </def>
      </def-item>
      <def-item>
        <term>HC</term>
        <def>
          <p>Hierarchical clustering</p>
        </def>
      </def-item>
      <def-item>
        <term>OTU</term>
        <def>
          <p>Operational taxonomic unit</p>
        </def>
      </def-item>
      <def-item>
        <term>PCoA</term>
        <def>
          <p>Principal coordinates analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>SRA</term>
        <def>
          <p>Sequence read archive</p>
        </def>
      </def-item>
      <def-item>
        <term>SRA</term>
        <def>
          <p>Sequence read archive</p>
        </def>
      </def-item>
      <def-item>
        <term>WSGI</term>
        <def>
          <p>Web service gateway interface</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Electronic supplementary material</bold>
      </p>
      <p>The online version of this article (doi:10.1186/s12859-017-1763-0) contains supplementary material, which is available to authorized users.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We would like to express our gratitude to the Research Computing team of Masdar Institute for their support using the High performance computing facility, enabling us to perform large scale computations (precalculation of UniFrac distance matrices) that would have otherwise not been possible on conventional hardware.</p>
    <sec id="d29e1601">
      <title>Funding</title>
      <p>Funded by Masdar Institute Student Support Grant SSG2015-000012.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>SKA - composition of web framework components including job scheduling, database management, user management, user interface, code integration, refactoring of legacy code of Analysis Type II, visualizations, writing of the manuscript, VirtualBox image creation, deployment; MZA - Conception and code development of Analysis Type II, database management; AH - Project management, conception and code development of Analysis Type I, writing of the manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="COI-statement">
    <sec id="d29e1612">
      <title>Ethics approval and consent to participate</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="d29e1617">
      <title>Consent for publication</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="d29e1622">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="d29e1627">
      <title>Publisher’s Note</title>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </sec>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Inagaki</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Hinrichs</surname>
            <given-names>KU</given-names>
          </name>
          <name>
            <surname>Kubo</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Bowles</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Heuer</surname>
            <given-names>VB</given-names>
          </name>
          <name>
            <surname>Hong</surname>
            <given-names>WL</given-names>
          </name>
          <name>
            <surname>Hoshino</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ijiri</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Imachi</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ito</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kaneko</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lever</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>YS</given-names>
          </name>
          <name>
            <surname>Methé</surname>
            <given-names>B. A</given-names>
          </name>
          <name>
            <surname>Morita</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Morono</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Tanikawa</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Bihan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bowden</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Elvert</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Glombitza</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gross</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Harrington</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Hori</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Limmer</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Murayama</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ohkouchi</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Ono</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>YS</given-names>
          </name>
          <name>
            <surname>Phillips</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Prieto-Mollar</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Purkey</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Riedinger</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Sanada</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Sauvage</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Susilawati</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Takano</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Tasumi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Terada</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tomaru</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Trembath-Reichert</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>DT</given-names>
          </name>
          <name>
            <surname>Yamada</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Exploring deep microbial life in coal-bearing sediment down to ~2.5 km below the ocean floor</article-title>
        <source>Science</source>
        <year>2015</year>
        <volume>349</volume>
        <issue>6246</issue>
        <fpage>420</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aaa6882</pub-id>
        <?supplied-pmid 26206933?>
        <pub-id pub-id-type="pmid">26206933</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Turnbaugh</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Ley</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Hamady</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Fraser-Liggett</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gordon</surname>
            <given-names>JI</given-names>
          </name>
        </person-group>
        <article-title>The human microbiome project: exploring the microbial part of ourselves in a changing world</article-title>
        <source>Nature</source>
        <year>2007</year>
        <volume>449</volume>
        <issue>7164</issue>
        <fpage>804</fpage>
        <pub-id pub-id-type="doi">10.1038/nature06244</pub-id>
        <?supplied-pmid 17943116?>
        <pub-id pub-id-type="pmid">17943116</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gilbert</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Jansson</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>The Earth Microbiome project: successes and aspirations</article-title>
        <source>BMC Biology</source>
        <year>2014</year>
        <volume>12</volume>
        <fpage>69</fpage>
        <pub-id pub-id-type="doi">10.1186/s12915-014-0069-1</pub-id>
        <?supplied-pmid 25184604?>
        <pub-id pub-id-type="pmid">25184604</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yilmaz</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kottmann</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Field</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Cole</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Amaral-Zettler</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Gilbert</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Karsch-Mizrachi</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Johnston</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cochrane</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Vaughan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hunter</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Morrison</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Rocca-Serra</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Sterk</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Arumugam</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bailey</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Baumgartner</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Birren</surname>
            <given-names>BW</given-names>
          </name>
          <name>
            <surname>Blaser</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Bonazzi</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Booth</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Bushman</surname>
            <given-names>FD</given-names>
          </name>
          <name>
            <surname>Buttigieg</surname>
            <given-names>PL</given-names>
          </name>
          <name>
            <surname>Chain</surname>
            <given-names>PSG</given-names>
          </name>
          <name>
            <surname>Charlson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Costello</surname>
            <given-names>EK</given-names>
          </name>
          <name>
            <surname>Huot-Creasy</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Dawyndt</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>DeSantis</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Fierer</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Fuhrman</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Gallery</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Gevers</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gibbs</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Gil</surname>
            <given-names>IS</given-names>
          </name>
          <name>
            <surname>Gonzalez</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gordon</surname>
            <given-names>JI</given-names>
          </name>
          <name>
            <surname>Guralnick</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hankeln</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Highlander</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hugenholtz</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Jansson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kau</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Kelley</surname>
            <given-names>ST</given-names>
          </name>
          <name>
            <surname>Kennedy</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Knights</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Koren</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Kuczynski</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kyrpides</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Larsen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lauber</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Legg</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ley</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Lozupone</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Ludwig</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Lyons</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Maguire</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Methé</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Muegge</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Nakielny</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nelson</surname>
            <given-names>KE</given-names>
          </name>
          <name>
            <surname>Nemergut</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Neufeld</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Newbold</surname>
            <given-names>LK</given-names>
          </name>
          <name>
            <surname>Oliver</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Pace</surname>
            <given-names>NR</given-names>
          </name>
          <name>
            <surname>Palanisamy</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Peplies</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Petrosino</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Proctor</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Pruesse</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Quast</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Raes</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ratnasingham</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ravel</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Relman</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Assunta-Sansone</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schloss</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Schriml</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Sinha</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Sodergren</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Spor</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Stombaugh</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tiedje</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Ward</surname>
            <given-names>DV</given-names>
          </name>
          <name>
            <surname>Weinstock</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Wendel</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Whiteley</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wilke</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wortman</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Yatsunenko</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Glöckner</surname>
            <given-names>FO</given-names>
          </name>
        </person-group>
        <article-title>Minimum information about a marker gene sequence (MIMARKS) and minimum information about any (x) sequence (MIxS) specifications</article-title>
        <source>Nat Biotechnol</source>
        <year>2011</year>
        <volume>29</volume>
        <issue>5</issue>
        <fpage>415</fpage>
        <lpage>20</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1823</pub-id>
        <?supplied-pmid 21552244?>
        <pub-id pub-id-type="pmid">21552244</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Su</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ning</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Meta-Storms: efficient search for similar microbial communities based on a novel indexing scheme and similarity score for metagenomic data</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>19</issue>
        <fpage>2493</fpage>
        <lpage>501</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts470</pub-id>
        <?supplied-pmid 22843983?>
        <pub-id pub-id-type="pmid">22843983</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McDonald</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Clemente</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Kuczynski</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rideout</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Stombaugh</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wendel</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wilke</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Huse</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hufnagle</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Biological Observation Matrix (BIOM) format or: how I learned to stop worrying and love the ome-ome</article-title>
        <source>GigaScience</source>
        <year>2012</year>
        <volume>1</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <pub-id pub-id-type="doi">10.1186/2047-217X-1-7</pub-id>
        <pub-id pub-id-type="pmid">23587310</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leinonen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sugawara</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Shumway</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The sequence read archive</article-title>
        <source>Nucleic Acids Res</source>
        <year>2010</year>
        <volume>39</volume>
        <fpage>1019</fpage>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <mixed-citation publication-type="other">Qiita. <ext-link ext-link-type="uri" xlink:href="http://qiita.microbio.me">http://qiita.microbio.me</ext-link>. Accessed 16 Mar 2017.</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huse</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Welch</surname>
            <given-names>DBM</given-names>
          </name>
          <name>
            <surname>Voorhis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Shipunova</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Morrison</surname>
            <given-names>HG</given-names>
          </name>
          <name>
            <surname>Eren</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Sogin</surname>
            <given-names>ML</given-names>
          </name>
        </person-group>
        <article-title>VAMPS: a website for visualization and analysis of microbial population structures</article-title>
        <source>BMC Bioinforma</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>1</issue>
        <fpage>41</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-15-41</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Manter</surname>
            <given-names>DK</given-names>
          </name>
          <name>
            <surname>Korsa</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tebbe</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Delgado</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>myPhyloDB: a local web server for the storage and analysis of metagenomic data</article-title>
        <source>Database</source>
        <year>2016</year>
        <volume>2016</volume>
        <fpage>037</fpage>
        <pub-id pub-id-type="doi">10.1093/database/baw037</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schloss</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Westcott</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Ryabin</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Hartmann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hollister</surname>
            <given-names>EB</given-names>
          </name>
          <name>
            <surname>Lesniewski</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Oakley</surname>
            <given-names>BB</given-names>
          </name>
          <name>
            <surname>Parks</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>CJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Introducing mothur: open-source, platform-independent, community-supported software for describing and comparing microbial communities</article-title>
        <source>Appl Environ Microbiol</source>
        <year>2009</year>
        <volume>75</volume>
        <issue>23</issue>
        <fpage>7537</fpage>
        <lpage>41</lpage>
        <pub-id pub-id-type="doi">10.1128/AEM.01541-09</pub-id>
        <?supplied-pmid 19801464?>
        <pub-id pub-id-type="pmid">19801464</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huson</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Auch</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Qi</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Schuster</surname>
            <given-names>SC</given-names>
          </name>
        </person-group>
        <article-title>MEGAN analysis of metagenomic data</article-title>
        <source>Genome Res</source>
        <year>2007</year>
        <volume>17</volume>
        <issue>3</issue>
        <fpage>377</fpage>
        <lpage>86</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.5969107</pub-id>
        <?supplied-pmid 17255551?>
        <pub-id pub-id-type="pmid">17255551</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Brin</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Near neighbor search in large metric spaces</article-title>
        <source>Proceedings of the 21th International Conference on Very Large Data Bases</source>
        <year>1995</year>
        <publisher-loc>San Francisco</publisher-loc>
        <publisher-name>Morgan Kaufmann Publishers Inc.</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Micó</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Oncina</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Vidal</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>A new version of the nearest-neighbour approximating and eliminating search algorithm (aesa) with linear preprocessing time and memory requirements</article-title>
        <source>Pattern Recogn Lett</source>
        <year>1994</year>
        <volume>15</volume>
        <issue>1</issue>
        <fpage>9</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="doi">10.1016/0167-8655(94)90095-7</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lozupone</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lladser</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Knights</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Stombaugh</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Unifrac: an effective distance metric for microbial community comparison</article-title>
        <source>ISME J</source>
        <year>2011</year>
        <volume>5</volume>
        <issue>2</issue>
        <fpage>169</fpage>
        <pub-id pub-id-type="doi">10.1038/ismej.2010.133</pub-id>
        <?supplied-pmid 20827291?>
        <pub-id pub-id-type="pmid">20827291</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kembel</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Eisen</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>JL</given-names>
          </name>
        </person-group>
        <article-title>Incorporating 16s gene copy number information improves estimates of microbial diversity and abundance</article-title>
        <source>PLoS Comput Biol</source>
        <year>2012</year>
        <volume>8</volume>
        <issue>10</issue>
        <fpage>1002743</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1002743</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <mixed-citation publication-type="other">Ahmed M, Uddin MM, Azad MS, Haseeb S. Mysql performance analysis on a limited resource server: Fedora vs. ubuntu linux. In: Proceedings of the 2010 Spring Simulation Multiconference. San Diego: Society for Computer Simulation International: 2010. p. 99. <ext-link ext-link-type="uri" xlink:href="http://dl.acm.org/citation.cfm?id=1878641">http://dl.acm.org/citation.cfm?id=1878641</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Henschel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Anwar</surname>
            <given-names>MZ</given-names>
          </name>
          <name>
            <surname>Manohar</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive meta-analysis of ontology annotated 16S rRNA profiles identifies beta diversity clusters of environmental bacterial communities</article-title>
        <source>PLoS Comput Biol</source>
        <year>2015</year>
        <volume>11</volume>
        <issue>10</issue>
        <fpage>1004468</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1004468</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Pierfederici</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <source>Distributed Computing with Python</source>
        <year>2016</year>
        <publisher-loc>Mumbai</publisher-loc>
        <publisher-name>Packt Publishing Ltd</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Carlson</surname>
            <given-names>JL</given-names>
          </name>
        </person-group>
        <source>Redis in Action</source>
        <year>2013</year>
        <publisher-loc>Shelter Island</publisher-loc>
        <publisher-name>Manning Publications Co</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Caporaso</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Kuczynski</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Stombaugh</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bittinger</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bushman</surname>
            <given-names>FD</given-names>
          </name>
          <name>
            <surname>Costello</surname>
            <given-names>EK</given-names>
          </name>
          <name>
            <surname>Fierer</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Pena</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Goodrich</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Gordon</surname>
            <given-names>JI</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Qiime allows analysis of high-throughput community sequencing data</article-title>
        <source>Nat Methods</source>
        <year>2010</year>
        <volume>7</volume>
        <issue>5</issue>
        <fpage>335</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.f.303</pub-id>
        <?supplied-pmid 20383131?>
        <pub-id pub-id-type="pmid">20383131</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DeSantis</surname>
            <given-names>TZ</given-names>
          </name>
          <name>
            <surname>Hugenholtz</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Larsen</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Rojas</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Brodie</surname>
            <given-names>EL</given-names>
          </name>
          <name>
            <surname>Keller</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Dalevi</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Andersen</surname>
            <given-names>GL</given-names>
          </name>
        </person-group>
        <article-title>Greengenes, a chimera-checked 16S rRNA gene database and workbench compatible with ARB</article-title>
        <source>Appl Environ Microbiol</source>
        <year>2006</year>
        <volume>72</volume>
        <issue>7</issue>
        <fpage>5069</fpage>
        <lpage>072</lpage>
        <pub-id pub-id-type="doi">10.1128/AEM.03006-05</pub-id>
        <?supplied-pmid 16820507?>
        <pub-id pub-id-type="pmid">16820507</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kopylova</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Noé</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Touzet</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Sortmerna: fast and accurate filtering of ribosomal rnas in metatranscriptomic data</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>24</issue>
        <fpage>3211</fpage>
        <lpage>217</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts611</pub-id>
        <?supplied-pmid 23071270?>
        <pub-id pub-id-type="pmid">23071270</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langille</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>Zaneveld</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Caporaso</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>McDonald</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Knights</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Reyes</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Clemente</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Burkepile</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Thurber</surname>
            <given-names>RLV</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Predictive functional profiling of microbial communities using 16s rrna marker gene sequences</article-title>
        <source>Nat Biotechnol</source>
        <year>2013</year>
        <volume>31</volume>
        <issue>9</issue>
        <fpage>814</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2676</pub-id>
        <?supplied-pmid 23975157?>
        <pub-id pub-id-type="pmid">23975157</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <mixed-citation publication-type="other">Lagkouvardos I, Joseph D, Kapfhammer M, Giritli S, Horn M, Haller D, Clavel T. Imngs: A comprehensive open resource of processed 16s rrna microbial profiles for ecology and diversity studies. Sci Rep. 2016;6(33721). <ext-link ext-link-type="uri" xlink:href="https://www.nature.com/articles/srep33721">https://www.nature.com/articles/srep33721</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boratyn</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Camacho</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Cooper</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Coulouris</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Fong</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Madden</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Matten</surname>
            <given-names>WT</given-names>
          </name>
          <name>
            <surname>McGinnis</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Merezhuk</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Blast: a more efficient report with usability improvements</article-title>
        <source>Nucleic Acids Res</source>
        <year>2013</year>
        <volume>41</volume>
        <issue>W1</issue>
        <fpage>29</fpage>
        <lpage>33</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkt282</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hunter</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>Matplotlib: A 2d graphics environment</article-title>
        <source>Comput Sci Eng</source>
        <year>2007</year>
        <volume>9</volume>
        <issue>3</issue>
        <fpage>90</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1109/MCSE.2007.55</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bostock</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ogievetsky</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Heer</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>D <sup>3</sup> data-driven documents</article-title>
        <source>IEEE Trans Vis Comput Graph</source>
        <year>2011</year>
        <volume>17</volume>
        <issue>12</issue>
        <fpage>2301</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1109/TVCG.2011.185</pub-id>
        <?supplied-pmid 22034350?>
        <pub-id pub-id-type="pmid">22034350</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <mixed-citation publication-type="other">mpld, 3: D3 Renderings of Matplotlib Graphics. <ext-link ext-link-type="uri" xlink:href="https://github.com/mpld3/mpld3">https://github.com/mpld3/mpld3</ext-link>. Accessed 16 Mar 2017.</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ruiz</surname>
            <given-names>EV</given-names>
          </name>
        </person-group>
        <article-title>An algorithm for finding nearest neighbours in (approximately) constant average time</article-title>
        <source>Pattern Recogn Lett</source>
        <year>1986</year>
        <volume>4</volume>
        <issue>3</issue>
        <fpage>145</fpage>
        <lpage>57</lpage>
        <pub-id pub-id-type="doi">10.1016/0167-8655(86)90013-9</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <mixed-citation publication-type="other">coord_util - Utility functions and modules for manipulating molecules for molecular dynamics simulations. <ext-link ext-link-type="uri" xlink:href="https://github.com/plediii/coord_util">https://github.com/plediii/coord_util</ext-link>. Accessed 12 Mar 2017.</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Zezula</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Amato</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Dohnal</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Batko</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <source>Similarity Search: the Metric Space Approach vol. 32</source>
        <year>2006</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <mixed-citation publication-type="other">McClelland J, Koslicki D. EMDUnifrac: Exact linear time computation of the Unifrac metric and identification of differentially abundant organisms. 2016. <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1611.04634">https://arxiv.org/abs/1611.04634</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lozupone</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>UniFrac: a new phylogenetic method for comparing microbial communities</article-title>
        <source>Appl Environ Microbiol</source>
        <year>2005</year>
        <volume>71</volume>
        <issue>12</issue>
        <fpage>8228</fpage>
        <lpage>35</lpage>
        <pub-id pub-id-type="doi">10.1128/AEM.71.12.8228-8235.2005</pub-id>
        <?supplied-pmid 16332807?>
        <pub-id pub-id-type="pmid">16332807</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <mixed-citation publication-type="other">Rocklin M. Dask: Parallel computation with blocked algorithms and task scheduling. In: Proceedings of the 14th Python in Science Conference. Austin: Citeseer: 2015. p. 130–6. <ext-link ext-link-type="uri" xlink:href="http://conference.scipy.org/proceedings/scipy2015/">http://conference.scipy.org/proceedings/scipy2015/</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR36">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buttigieg</surname>
            <given-names>PL</given-names>
          </name>
          <name>
            <surname>Morrison</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Mungall</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Lewis</surname>
            <given-names>SE</given-names>
          </name>
        </person-group>
        <article-title>The environment ontology: contextualising biological and biomedical entities</article-title>
        <source>J Biomed Semant</source>
        <year>2013</year>
        <volume>4</volume>
        <issue>1</issue>
        <fpage>43</fpage>
        <pub-id pub-id-type="doi">10.1186/2041-1480-4-43</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rideout</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Navas-Molina</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Walters</surname>
            <given-names>WA</given-names>
          </name>
          <name>
            <surname>Ursell</surname>
            <given-names>LK</given-names>
          </name>
          <name>
            <surname>Gibbons</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Chase</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>McDonald</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gonzalez</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Robbins-Pianka</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Subsampled open-reference clustering creates consistent, comprehensive OTU definitions and scales to billions of sequences</article-title>
        <source>PeerJ</source>
        <year>2014</year>
        <volume>2</volume>
        <fpage>545</fpage>
        <pub-id pub-id-type="doi">10.7717/peerj.545</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Su</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Pan</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ning</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Parallel-meta 2.0: enhanced metagenomic data analysis with functional annotation, high performance computing and advanced visualization</article-title>
        <source>PLoS ONE</source>
        <year>2014</year>
        <volume>9</volume>
        <issue>3</issue>
        <fpage>89323</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0089323</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
