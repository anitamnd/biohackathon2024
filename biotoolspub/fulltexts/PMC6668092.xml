<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6668092</article-id>
    <article-id pub-id-type="publisher-id">2978</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-019-2978-z</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Stochastic Lanczos estimation of genomic variance components for linear mixed-effects models</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-6293-2968</contrib-id>
        <name>
          <surname>Border</surname>
          <given-names>Richard</given-names>
        </name>
        <address>
          <email>richard.border@colorado.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Becker</surname>
          <given-names>Stephen</given-names>
        </name>
        <address>
          <email>stephen.becker@colorado.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000000096214564</institution-id><institution-id institution-id-type="GRID">grid.266190.a</institution-id><institution>Institute for Behavioral Genetics, University of Colorado Boulder, </institution></institution-wrap>Boulder, 80309 CO USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000000096214564</institution-id><institution-id institution-id-type="GRID">grid.266190.a</institution-id><institution>Department of Psychology and Neuroscience, University of Colorado Boulder, </institution></institution-wrap>Boulder, 80309 CO USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000000096214564</institution-id><institution-id institution-id-type="GRID">grid.266190.a</institution-id><institution>Department of Applied Mathematics, University of Colorado Boulder, </institution></institution-wrap>Boulder, 80309 CO USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>30</day>
      <month>7</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>30</day>
      <month>7</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>411</elocation-id>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>4</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>6</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>Linear mixed-effects models (LMM) are a leading method in conducting genome-wide association studies (GWAS) but require residual maximum likelihood (REML) estimation of variance components, which is computationally demanding. Previous work has reduced the computational burden of variance component estimation by replacing direct matrix operations with iterative and stochastic methods and by employing loose tolerances to limit the number of iterations in the REML optimization procedure. Here, we introduce two novel algorithms, <italic>stochastic Lanczos derivative-free REML</italic> (SLDF_REML) and <italic>Lanczos first-order Monte Carlo REML</italic> (L_FOMC_REML), that exploit problem structure via the principle of Krylov subspace shift-invariance to speed computation beyond existing methods. Both novel algorithms only require a single round of computation involving iterative matrix operations, after which their respective objectives can be repeatedly evaluated using vector operations. Further, in contrast to existing stochastic methods, SLDF_REML can exploit precomputed genomic relatedness matrices (GRMs), when available, to further speed computation.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>Results of numerical experiments are congruent with theory and demonstrate that interpreted-language implementations of both algorithms match or exceed existing compiled-language software packages in speed, accuracy, and flexibility.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>Both the SLDF_REML and L_FOMC_REML algorithms outperform existing methods for REML estimation of variance components for LMM and are suitable for incorporation into existing GWAS LMM software implementations.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (10.1186/s12859-019-2978-z) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>GWAS</kwd>
      <kwd>Linear mixed-effects models</kwd>
      <kwd>Variance components</kwd>
      <kwd>REML</kwd>
      <kwd>Conjugate gradients</kwd>
      <kwd>Stochastic trace estimation</kwd>
      <kwd>Stochastic Lanczos quadrature</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000025</institution-id>
            <institution>National Institute of Mental Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>T32 MH01688</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id>
            <institution>National Science Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>DMS-1819251</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Linear mixed-effects modeling (LMM) is a leading methodology employed in genome-wide association studies (GWAS) of complex traits in humans, offering the dual benefits of controlling for population stratification while permitting the inclusion of data from related individuals [<xref ref-type="bibr" rid="CR1">1</xref>]. However, the implementation of LMM comes at the cost of increased computational burden relative to ordinary least-squares regression, particularly in performing residual maximum likelihood (REML) estimation of genomic variance components. Conventional REML algorithms require multiple <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {O}\left (n^{3}\right)$\end{document}</tex-math><mml:math id="M2"><mml:mi mathvariant="script">O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq1.gif"/></alternatives></inline-formula> or <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {O}\left (mn^{2}\right)$\end{document}</tex-math><mml:math id="M4"><mml:mi mathvariant="script">O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>m</mml:mi><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq2.gif"/></alternatives></inline-formula> matrix operations, where <italic>m</italic> and <italic>n</italic> are the numbers of markers and individuals, respectively, rendering them infeasible for large biobank scale data sets. Further, common numerical methods for REML estimation rely on sparse matrix methods suitable for traditional LMM applications (e.g., pedigree data or experiments with repeated measures [<xref ref-type="bibr" rid="CR2">2</xref>]) that are inapplicable to genomics variance components models since these models involve dense relatedness matrices. As a result, the problem of increasing the computational efficiency of REML estimation of genomic variance components has generated considerable research activity [<xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR8">8</xref>].</p>
    <p>In the case of the standard two variance component model (<xref rid="Equ1" ref-type="">1</xref>), the estimation of which is the focus of the current research, previous efforts toward increasing computational efficiency fit into two primary categories: 1., reducing the number of cubic time complexity matrix operations needed to achieve convergence; and 2., substituting stochastic and iterative matrix operations for deterministic, direct methods to obtain procedures with quadratic time complexity. The first approach is embodied by the methods implemented in the FaST-LMM and GEMMA packages [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>], which take advantage of the fact that the genetic relatedness matrix (GRM) and identity matrix comprising the covariance structure are simultaneously diagonalizable. As a result, after performing a single spectral decomposition of the GRM and a small number of matrix-vector multiplications, the REML criterion (<xref rid="Equ3" ref-type="">3</xref>) and its gradient and Hessian can be repeatedly evaluated using only vector operations. The second approach is exemplified by the popular BOLT-LMM software [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>], which avoids all cubic operations by solving linear systems via the method of conjugate gradients (CG) and employing stochastic trace estimators in place of deterministic computations.</p>
    <p>In the current research, we propose two algorithms, stochastic Lanczos derivative-free residual maximum likelihood (SLDF_REML; Algorithm 3) and Lanczos first-order Monte Carlo residual maximum likelihood (L_FOMC_REML; Algorithm 4), that combine features of both approaches (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). Here, we translate the simultaneous diagonalizability of the heritable and non-heritable components of the covariance structure to stochastic and iterative methods via the principle of Krylov subspace shift-invariance. As a result, we only need to compute the costliest portions of the objective function once (via stochastic/iterative methods), computing all subsequent iterations of the REML optimization problem only using vector operations. We develop the theory underlying these methods and demonstrate their performance relative to previous methods via numerical experiment.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Time complexity analogies with respect to existing and proposed methods. Heuristically, the novel algorithms (bottom right) are to the stochastic, iterative algorithm implemented in the BOLT-LMM software [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>] (bottom left) as the direct methods exploiting the shifted structure of the two component genomic variance component model (<xref rid="Equ1" ref-type="">1</xref>) (e.g., FaST-LMM and GEMMA [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR5">5</xref>]; top right) are to standard direct methods (top left). For simplicity, we assume here that the number of markers is equal to the number of observations and omit low-order terms related to the spectral conditioning of the covariance structure and the number of random vectors generated by the stochastic methods; further details are provided in Table <xref rid="Tab1" ref-type="table">1</xref>. <italic>n</italic><sub>eval</sub> denotes the number of objective function evaluations needed to achieve convergence</p></caption><graphic xlink:href="12859_2019_2978_Fig1_HTML" id="MO1"/></fig>
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Time complexity of stochastic algorithms</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Method</th><th align="left">Overhead</th><th align="left">Objective function evaluation</th></tr></thead><tbody><tr><td align="left">SLDF_REML<inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\left \{\begin {array}{l}\text {with precomputed GRM}\\ \text {with genotype matrix}\end {array}\right.$\end{document}</tex-math><mml:math id="M6"><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable class="array" columnalign="left"><mml:mtr><mml:mtd><mml:mtext>with precomputed GRM</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>with genotype matrix</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq3.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {O}{\left (n^{2}\cdot (n_{\text {rand}}+c)\cdot n_\kappa \right)}$\end{document}</tex-math><mml:math id="M8"><mml:mi mathvariant="script">O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>·</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext>rand</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mo>)</mml:mo><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>κ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq4.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {O}{(n\cdot c\cdot n_\kappa)}$\end{document}</tex-math><mml:math id="M10"><mml:mi mathvariant="script">O</mml:mi><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>·</mml:mo><mml:mi>c</mml:mi><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>κ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq5.gif"/></alternatives></inline-formula></td></tr><tr><td align="left"/><td align="left"><inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {O}(2m\cdot n\cdot (n_{\text {rand}}+c)\cdot n_\kappa)$\end{document}</tex-math><mml:math id="M12"><mml:mi mathvariant="script">O</mml:mi><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mi>m</mml:mi><mml:mo>·</mml:mo><mml:mi>n</mml:mi><mml:mo>·</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext>rand</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mo>)</mml:mo><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>κ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq6.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {O}(n\cdot c\cdot n_\kappa)$\end{document}</tex-math><mml:math id="M14"><mml:mi mathvariant="script">O</mml:mi><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>·</mml:mo><mml:mi>c</mml:mi><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>κ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq7.gif"/></alternatives></inline-formula></td></tr><tr><td align="left">L_FOMC_REML</td><td align="left"><inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {O}(4m\cdot n\cdot n_{\text {rand}}\cdot n_\kappa)$\end{document}</tex-math><mml:math id="M16"><mml:mi mathvariant="script">O</mml:mi><mml:mo>(</mml:mo><mml:mn>4</mml:mn><mml:mi>m</mml:mi><mml:mo>·</mml:mo><mml:mi>n</mml:mi><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext>rand</mml:mtext></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>κ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq8.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {O}(m\cdot n\cdot n_{\text {rand}})$\end{document}</tex-math><mml:math id="M18"><mml:mi mathvariant="script">O</mml:mi><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>·</mml:mo><mml:mi>n</mml:mi><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext>rand</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq9.gif"/></alternatives></inline-formula></td></tr><tr><td align="left">BOLT_LMM</td><td align="left"><inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {O}\left (n\cdot c^{2}+m\cdot c\right)$\end{document}</tex-math><mml:math id="M20"><mml:mi mathvariant="script">O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>n</mml:mi><mml:mo>·</mml:mo><mml:msup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>m</mml:mi><mml:mo>·</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq10.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {O}(4m\cdot n\cdot n_{\text {rand}}\cdot n_\kappa)$\end{document}</tex-math><mml:math id="M22"><mml:mi mathvariant="script">O</mml:mi><mml:mo>(</mml:mo><mml:mn>4</mml:mn><mml:mi>m</mml:mi><mml:mo>·</mml:mo><mml:mi>n</mml:mi><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext>rand</mml:mtext></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>κ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq11.gif"/></alternatives></inline-formula></td></tr></tbody></table><table-wrap-foot><p><italic>n</italic> denotes the number of individuals, <italic>m</italic> the number of markers, and <italic>c</italic> the number of covariates. <italic>n</italic><sub>rand</sub> indicates the number of random probing vectors and is fixed at 15 in all numerical experiments. <italic>n</italic><sub><italic>κ</italic></sub> reflects the number of conjugate gradient iterations required to achieve convergence at a specified tolerance and can be bounded in terms of the spectral condition number of <italic>H</italic><sub>0</sub>. As noted in [<xref ref-type="bibr" rid="CR8">8</xref>], implicit preconditioning of <italic>H</italic><sub>0</sub> can be achieved by including the first few right singular vectors of the genotype matrix (or eigenvectors of the GRM) as covariates</p></table-wrap-foot></table-wrap></p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <p>Across 20 replications per condition for random subsamples of <italic>n</italic>=16,000 to 256,000 unrelated European-ancestry individuals, both SLDF_REML and L_FOMC_REML produced heritability estimates for height consistent with those generated by the GCTA software package (Figs. <xref rid="Fig4" ref-type="fig">4</xref> and <xref rid="Fig5" ref-type="fig">5</xref>). For large samples, the novel algorithms achieved greater accuracy than either version of BOLT-LMM (e.g., for <italic>n</italic>=250,000, mean-squared error was 1.74 ×10<sup>−6</sup> for BOLT-LMM v2.3.2 versus 1.24 ×10<sup>−7</sup> for L_FOMC_REML). Particularly, the time required per additional iteration after initial overhead computations was low for the novel algorithms (e.g., <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\overline {t}$\end{document}</tex-math><mml:math id="M24"><mml:mover accent="false"><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq12.gif"/></alternatives></inline-formula>=20.07 min for BOLT-LMM v2.3.2 versus 2.06 min for L_FOMC_REML; Table <xref rid="Tab2" ref-type="table">2</xref>), enabling increased precision at minor cost. With respect to total timings, SLDF_REML dramatically outperformed all other methods when the precomputed GRM was available (Table <xref rid="Tab2" ref-type="table">2</xref> and Fig. <xref rid="Fig3" ref-type="fig">3</xref>), which we expect whenever the number of markers exceeds the sample size. Examining methods taking genotype matrices as inputs, SLDF_REML and L_FOMC_REML performed similarly, whereas BOLT-LMM v2.3.2 converged more quickly than either in smaller samples (Fig. <xref rid="Fig3" ref-type="fig">3</xref>), though the differences for <italic>n</italic> =256,000 were relatively minor (e.g., <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\overline {t}=$\end{document}</tex-math><mml:math id="M26"><mml:mover accent="false"><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover><mml:mo>=</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq13.gif"/></alternatives></inline-formula>91.09 min for BOLT-LMM v2.3.2 versus 102.21 min for L_FOMC_REML; Table <xref rid="Tab2" ref-type="table">2</xref>). The older version of BOLT-LMM, v2.1, performed significantly more slowly than any of the other implementations examined (e.g., average wall clock time was 177.95 min at <italic>n</italic> =256,000), demonstrating the importance of implementation optimization.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Overhead versus iterative optimization procedure timing results. Trimmed mean wall clock time for overhead computations and iterative REML optimization procedures across twenty replications per condition on the log10 scale (<bold>a</bold>) and natural scale (<bold>b</bold>). Error bars reflect per condition standard errors and lines connect per condition means</p></caption><graphic xlink:href="12859_2019_2978_Fig2_HTML" id="MO2"/></fig>
<fig id="Fig3"><label>Fig. 3</label><caption><p>Timing results. Trimmed mean wall clock time across twenty replications for per condition on the log10 scale (<bold>a</bold>) and natural scale (<bold>b</bold>). Error bars reflect per condition standard errors and lines connect per condition trimmed means</p></caption><graphic xlink:href="12859_2019_2978_Fig3_HTML" id="MO3"/></fig>
<fig id="Fig4"><label>Fig. 4</label><caption><p>Accuracy results. Comparison of heritability estimates for height generated by BOLT-LMM versions 2.1 and 2.3.2, SLDF_REML, and L_FOMC_REML versus those generated by the deterministic algorithm implemented in the GCTA software package <sup>∗</sup> [<xref ref-type="bibr" rid="CR4">4</xref>], for varying sub-samples of 16,000 to 256,000 unrelated European-ancestry UK Biobank participants. Data are comprised of twenty independent replications per condition. Red dashed lines indicate standard errors of GCTA estimate. Points represent individual observations whereas boxes indicate the 95% confidence intervals for the trimmed mean estimate after a Bonferroni correction for 25 comparisons. The bias evidenced by the BOLT-LMM estimators is likely due to the combination of performing a small number of secant iterations with fixed start values and loose tolerances for determining convergence. <sup>∗</sup>For <italic>n</italic>=256,000, memory requirements prohibited the use of GCTA, so we instead averaged ten estimates generated by the high-accuracy stochastic estimator implemented in BOLT-REML [<xref ref-type="bibr" rid="CR31">31</xref>] (standard errors were 6.32e-5 and 2.45e-7 for the mean REML heritability estimate and its standard error, respectively)</p></caption><graphic xlink:href="12859_2019_2978_Fig4_HTML" id="MO4"/></fig>
<fig id="Fig5"><label>Fig. 5</label><caption><p>Numerical experiments: accuracy versus time. Average absolute error on the log10 scale with respect to the GCTA estimate <sup>∗</sup> versus trimmed mean wall clock time across twenty replications per condition. Error bars reflect per condition standard errors and lines connect per condition trimmed means. <sup>∗</sup>For <italic>n</italic>=256,000, memory requirements prohibited the use of GCTA, so we instead averaged ten estimates generated by the high-accuracy stochastic estimator implemented in BOLT-REML v2.3.2 [<xref ref-type="bibr" rid="CR31">31</xref>] (standard errors were 6.32e-5 and 2.45e-7 for the mean heritability and its standard error, respectively)</p></caption><graphic xlink:href="12859_2019_2978_Fig5_HTML" id="MO5"/></fig>
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Overhead and per objective function evaluation timings of stochastic algorithms for <italic>n</italic>=256,000</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Method</th><th align="left"/><th align="left">Overhead</th><th align="left">Per evaluation</th><th align="left">Evaluation count</th><th align="left">Total</th></tr></thead><tbody><tr><td align="left">BOLT-LMM v2.1</td><td align="left"/><td align="left">34.63</td><td align="left">35.83</td><td align="left">4</td><td align="left">177.95</td></tr><tr><td align="left">BOLT-LMM v2.3.2</td><td align="left"/><td align="left">10.82</td><td align="left">20.07</td><td align="left">4</td><td align="left">91.09</td></tr><tr><td align="left">L_FOMC_REML</td><td align="left"/><td align="left">89.87</td><td align="left">2.06</td><td align="left">6</td><td align="left">102.21</td></tr><tr><td align="left">SLDF_REML {</td><td align="left">with genotype matrix</td><td align="left">90.22</td><td align="left">1.06</td><td align="left">9</td><td align="left">99.73</td></tr><tr><td align="left"/><td align="left">with precomputed GRM</td><td align="left">28.95</td><td align="left">1.07</td><td align="left">9</td><td align="left">38.60</td></tr></tbody></table><table-wrap-foot><p>Data reflect trimmed mean wall clock time in minutes over 20 iterations per condition</p></table-wrap-foot></table-wrap></p>
    <p>As the computations needed to compute the Lanczos decompositions in L_FOMC_REML and BOLT-LMM v2.3.2 are equivalent in time and memory complexity, we expect that an optimized compiled-language implementation of L_FOMC_REML would reduce the overhead computation time by a significant linear factor (≈3 for <italic>n</italic> =256,000, comparing the sum of the overhead time and single objective function evaluation time for BOLT-LMM v2.3.2 to its total running time; Table <xref rid="Tab2" ref-type="table">2</xref>). Consistent with theory, the wall clock times per objective function evaluation for the novel algorithms were trivial given the Lanczos decompositions (e.g., for <italic>n</italic> =256,000, <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\overline {t}$\end{document}</tex-math><mml:math id="M28"><mml:mover accent="false"><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq14.gif"/></alternatives></inline-formula> = 2.06 versus 20.07 min for L_FOMC_REML and BOLT-LMM v2.3.2, respectively; Table <xref rid="Tab2" ref-type="table">2</xref> and Fig. <xref rid="Fig2" ref-type="fig">2</xref>).</p>
  </sec>
  <sec id="Sec3" sec-type="discussion">
    <title>Discussion</title>
    <p>We have proposed stochastic algorithms for estimating the two variance component model (<xref rid="Equ1" ref-type="">1</xref>), both of which theoretically offer substantial time savings relative to existing methods. Our methods capitalize on the principle of Krylov subspace shift invariance to reduce the number of steps involving <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {O} \left (n^{2}\right)$\end{document}</tex-math><mml:math id="M30"><mml:mi mathvariant="script">O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq15.gif"/></alternatives></inline-formula> or <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {O} (mn)$\end{document}</tex-math><mml:math id="M32"><mml:mi mathvariant="script">O</mml:mi><mml:mo>(</mml:mo><mml:mtext mathvariant="italic">mn</mml:mtext><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq16.gif"/></alternatives></inline-formula> computations to one, whereas existing methods perform equivalent computations at each iteration of the REML optimization procedure. For large samples, when taking genotype matrices as inputs, our interpreted-language implementations of L_FOMC_REML and SLDF_REML [<xref ref-type="bibr" rid="CR9">9</xref>] produced more accurate variance component estimates than the highly-optimized, compiled BOLT-LMM implementations, while taking similar amounts of time. Thus, we expect comparably-optimized implementations of the novel algorithms to compute high accuracy REML estimates in close to the time required by BOLT-LMM v2.3.2 for a <italic>single</italic> objective function evaluation. Further, in contrast to the BOLT_LMM algorithm, which requires the genotype matrix, SLDF_REML can exploit precomputed GRMs to reduce operation count by an <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {O}(2m/n)$\end{document}</tex-math><mml:math id="M34"><mml:mi mathvariant="script">O</mml:mi><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mi>m</mml:mi><mml:mo>/</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq17.gif"/></alternatives></inline-formula> factor (Table <xref rid="Tab1" ref-type="table">1</xref>), which yields dramatic time savings when the number of markers greatly exceeds the number of individuals (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). While GRM precomputation is itself <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {O}\left (mn^{2}\right)$\end{document}</tex-math><mml:math id="M36"><mml:mi mathvariant="script">O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>m</mml:mi><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq18.gif"/></alternatives></inline-formula>, it can be effectively and asynchronously parallelized across multiple compute nodes, substantially mitigating computational burden (though we note that serial input/output constraints can interfere with efficient parallelization). However, as the L_FOMC_REML algorithm involves the computation of BLUPs of SNP effects, L_FOMC_REML is preferable to SLDF_REML when BLUP estimates are desired for prediction (as in [<xref ref-type="bibr" rid="CR10">10</xref>]).</p>
    <p>There are several limitations to the proposed approaches. First, SLDF_REML, which benefits from the ability to take GRMs as input, depends linearly on the number of included covariates, which might grow prohibitive in samples spanning numerous genotyping batches and ascertainment locations. However, as in BOLT_LMM, L_FOMC_REML requires <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {O}(mn)$\end{document}</tex-math><mml:math id="M38"><mml:mi mathvariant="script">O</mml:mi><mml:mo>(</mml:mo><mml:mtext mathvariant="italic">mn</mml:mtext><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq19.gif"/></alternatives></inline-formula> matrix multiplications for BLUP computation at each step of the REML optimization procedure, whereas SLDF_REML requires only vector operations. Thus, though the options provided by the two novel algorithms increase researchers’ flexibility overall, the choice of whether to employ SLDF_REML versus L_FOMC_REML is problem-specific and necessitates greater researcher attention to resource allocation. For example, even when a precomputed GRM is available, it might be preferable to use L_FOMC_REML if BLUPs of latent SNP effects are desired. On the other hand, if a researcher intends to sequentially analyze a large number of phenotypes in a relatively small sample of individuals, it might prove most efficient to compute a GRM, despite the involved computational burden, in order to speed subsequent computations by supplying the GRM to the SLDF_REML algorithm. Second, neither algorithm mitigates the substantial <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {O}(mn)$\end{document}</tex-math><mml:math id="M40"><mml:mi mathvariant="script">O</mml:mi><mml:mo>(</mml:mo><mml:mtext mathvariant="italic">mn</mml:mtext><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq20.gif"/></alternatives></inline-formula> or <inline-formula id="IEq21"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {O}\left (n^{2}\right)$\end{document}</tex-math><mml:math id="M42"><mml:mi mathvariant="script">O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq21.gif"/></alternatives></inline-formula> memory complexity common to all algorithms for REML estimation of genomic variance components, requiring that researchers have access to high-memory compute nodes to work with large samples (though we note that neither of the novel algorithms substantial increases this burden either). Finally, for the same reasons that the spectral decomposition-based direct methods implemented in the FaST-LMM and GEMMA packages [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>] are restricted to the simple two component model (<xref rid="Equ1" ref-type="">1</xref>) (i.e., whereas the GRM and identity matrix are simultaneously diagonalizable, the same doesn’t hold for arbitrary collections of three or more symmetric positive semidefinite matrices), the shift-invariance property exploited by the proposed methods does not extend to multiple genomic variance components. Given that the two component model is insufficient for precise heritability estimation for many complex traits [<xref ref-type="bibr" rid="CR11">11</xref>], our novel algorithms apply to the particular, though common, tasks of variance component and BLUP estimation for LMM in association studies.</p>
    <p>Despite these limitations, the proposed algorithms have clear advantages over existing methods in terms of flexibility, accuracy, and speed of computation. We provide both pseudocode and heavily annotated Python 3 implementations [<xref ref-type="bibr" rid="CR9">9</xref>] to facilitate their incorporation into existing software packages. Further, though our algorithms are restricted to the two variance component model, they can be used to generate the inputs necessary for estimation of more complex models, such as the mixture model estimated via variational approximation implemented in [<xref ref-type="bibr" rid="CR7">7</xref>], and thus have applications to non-infinitesimal models. Finally, we suggest that the methods presented in our theoretical development, in particular stochastic trace estimation and stochastic Lanczos quadrature, are likely to find uses in REML estimation of other models of interest to researchers in genomics. In particular, we suggest the development of models that exploit Krylov subspace shift-invariance to speed up variance/covariance component estimation for the case of multivariate phenotypes as a target for future research. Such models necessarily involve the computation or approximation of Hessian matrices, thereby introducing additional complexity in comparison to the univariate case considered above. However, the extension of fast cubic complexity methods based on the spectral decomposition of the covariance matrix [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR5">5</xref>] to the multivariate case [<xref ref-type="bibr" rid="CR6">6</xref>] suggests the potential for multivariate analogues of the algorithms presented here.</p>
  </sec>
  <sec id="Sec4" sec-type="conclusion">
    <title>Conclusions</title>
    <p>The proposed algorithms, SLDF_REML and L_FOMC_REML, unify previous approaches to estimating the two variance component model (<xref rid="Equ1" ref-type="">1</xref>) by exploiting the simultaneous diagonalizability of the covariance structure components while avoiding matrix operations with cubic time complexity. As a result, the most expensive operations only need to be performed once, as with the spectral decomposition performed in the FaST-LMM and GEMMA software packages [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>], but these operations consist only of matrix-vector products, as in the BOLT-LMM software package [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>]. All but one iteration of the REML optimization procedure requires only vector operations, yielding increased speed and numerical precision relative to existing methods. Furthermore, the unique strengths of the two methods lead to a flexible approach depending on researcher goals: SLDF_REML is capable of operating on precomputed GRMs when available, whereas L_FOMC_REML can generate BLUPs of latent SNP effects without added computational burden. We recommend these algorithms for incorporation into GWAS LMM implementations.</p>
  </sec>
  <sec id="Sec5">
    <title>Method</title>
    <p>We consider the two component genomic variance components model commonly employed in LMM association studies [<xref ref-type="bibr" rid="CR1">1</xref>], which is of the form 
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} y&amp;=X\beta+\frac{1}{\sqrt{m}}Zu+e,\\ u&amp;\stackrel{{i.i.d.}}{\sim}\mathcal{N}\left(0,\sigma_{g}^{2}\right),\quad e\stackrel{{i.i.d.}}{\sim}\mathcal{N}\left(0,\sigma_{e}^{2}\right),  \end{array} $$ \end{document}</tex-math><mml:math id="M44"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mi>y</mml:mi></mml:mtd><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:mi>Xβ</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mtext mathvariant="italic">Zu</mml:mtext><mml:mo>+</mml:mo><mml:mi>e</mml:mi><mml:mo>,</mml:mo><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"><mml:mi>u</mml:mi></mml:mtd><mml:mtd class="align-2"><mml:mover><mml:mrow><mml:mo>∼</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi>i.i.d.</mml:mi></mml:mrow></mml:mrow></mml:mover><mml:mi mathvariant="script">N</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>e</mml:mi><mml:mover><mml:mrow><mml:mo>∼</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi>i.i.d.</mml:mi></mml:mrow></mml:mrow></mml:mover><mml:mi mathvariant="script">N</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2019_2978_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
    <p>where <italic>y</italic> is a measured phenotype, the <italic>c</italic>≪<italic>n</italic> columns of <inline-formula id="IEq22"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X\in \mathbb {R}^{n\times c}$\end{document}</tex-math><mml:math id="M46"><mml:mi>X</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq22.gif"/></alternatives></inline-formula> are covariates (including an intercept term) with corresponding fixed effects <italic>β</italic>, and <inline-formula id="IEq23"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$Z\in \mathbb {R}^{n\times m}$\end{document}</tex-math><mml:math id="M48"><mml:mi>Z</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq23.gif"/></alternatives></inline-formula> is a matrix of <italic>n</italic> individuals’ standardized genotypes at <italic>m</italic> loci. Without loss of generality, we assume that <italic>X</italic> has full column rank; in the case of numerical rank deficiency we can simply replace <italic>X</italic> by the optimal full rank approximation generated by its economy singular value decomposition or rank revealing QR decomposition. The latent genetic effects <inline-formula id="IEq24"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$u\in \mathbb {R}^{m}$\end{document}</tex-math><mml:math id="M50"><mml:mi>u</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq24.gif"/></alternatives></inline-formula> and residuals <inline-formula id="IEq25"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$e\in \mathbb {R}^{n}$\end{document}</tex-math><mml:math id="M52"><mml:mi>e</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq25.gif"/></alternatives></inline-formula> are random variables with distributions parametrized by the heritable and non-heritable variance components, <inline-formula id="IEq26"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sigma _{g}^{2}$\end{document}</tex-math><mml:math id="M54"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq26.gif"/></alternatives></inline-formula> and <inline-formula id="IEq27"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sigma _{e}^{2}$\end{document}</tex-math><mml:math id="M56"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq27.gif"/></alternatives></inline-formula>, respectively. The REML criterion corresponds to the marginal likelihood of <inline-formula id="IEq28"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sigma _{g}^{2},\sigma _{e}^{2}\vert K^{T}y$\end{document}</tex-math><mml:math id="M58"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:msup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi>y</mml:mi></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq28.gif"/></alternatives></inline-formula>, where <italic>K</italic><sup><italic>T</italic></sup> projects to an (<italic>n</italic>−<italic>c</italic>)-dimensional subspace orthogonal to the covariate vectors such that the null space of <italic>K</italic><sup><italic>T</italic></sup> is exactly the column space of <italic>X</italic> [<xref ref-type="bibr" rid="CR12">12</xref>]. In other words <inline-formula id="IEq29"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$K^{T}:\mathbb {R}^{n}\rightarrow \mathcal {S}\subset \mathbb {R}^{n-c}$\end{document}</tex-math><mml:math id="M60"><mml:msup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>:</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>→</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>⊂</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq29.gif"/></alternatives></inline-formula> such that <inline-formula id="IEq30"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathbb {R}^{n}=\mathcal {S}\oplus \text {col}\ X$\end{document}</tex-math><mml:math id="M62"><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>⊕</mml:mo><mml:mtext>col</mml:mtext><mml:mspace width="1em"/><mml:mi>X</mml:mi></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq30.gif"/></alternatives></inline-formula>. The transformed random variable <italic>K</italic><sup><italic>T</italic></sup><italic>y</italic> has the marginal distribution <inline-formula id="IEq31"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$K^{T}y\sim \mathcal {MVN}\left (0,\sigma _{g}^{2}\frac {1}{m}K^{T}ZZ^{T}K+\sigma _{e}^{2}KK^{T}\right)$\end{document}</tex-math><mml:math id="M64"><mml:msup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi>y</mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="script">ℳ</mml:mi><mml:mi mathvariant="script">V</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi>Z</mml:mi><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi>K</mml:mi><mml:msup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq31.gif"/></alternatives></inline-formula>, which we reparametrize as <inline-formula id="IEq32"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$K^{T}y\sim \mathcal {MVN}\left (0,\sigma _{g}^{2}K^{T}H_{\tau }K\right)$\end{document}</tex-math><mml:math id="M66"><mml:msup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi>y</mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="script">ℳ</mml:mi><mml:mi mathvariant="script">V</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mi>K</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq32.gif"/></alternatives></inline-formula>, where 
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ H_{\tau}=\frac{1}{m}ZZ^{T}+\tau I_{n},\quad \tau=\sigma_{e}^{2}/\sigma_{g}^{2}.  $$ \end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mfrac><mml:mi>Z</mml:mi><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>τ</mml:mi><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>/</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi>.</mml:mi></mml:math><graphic xlink:href="12859_2019_2978_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
    <p>Here, <inline-formula id="IEq33"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\frac {1}{m}ZZ^{T}$\end{document}</tex-math><mml:math id="M70"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mfrac><mml:mi>Z</mml:mi><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq33.gif"/></alternatives></inline-formula>, which indicates the average covariance between individuals’ standardized genotypes, is often referred to as the <italic>genomic relatedness matrix</italic> (GRM). The <italic>REML criterion</italic>, or marginal log likelihood, can be expressed as a function of <italic>τ</italic>: 
<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \ell\left(\tau\vert K^{T}y\right)\propto &amp; -(n-c)\ln\left(\hat{\sigma}^{2}_{g}(\tau)\right)-\hat{\sigma}^{2}_{e}(\tau)^{-1}y^{T}P_{\tau} y \\\ &amp;-\ln\left(\det\left(K^{T}H_{\tau} K\right)\right), \end{array} $$ \end{document}</tex-math><mml:math id="M72"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mi>ℓ</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>τ</mml:mi><mml:mo>|</mml:mo><mml:msup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi>y</mml:mi></mml:mrow></mml:mfenced><mml:mo>∝</mml:mo></mml:mtd><mml:mtd class="align-2"><mml:mo>−</mml:mo><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>c</mml:mi><mml:mo>)</mml:mo><mml:mo>ln</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munderover><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:mo>(</mml:mo><mml:mi>τ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:munderover><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>τ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mi>y</mml:mi><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-2"><mml:mo>−</mml:mo><mml:mo>ln</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>det</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mi>K</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2019_2978_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
    <p>where <italic>P</italic><sub><italic>τ</italic></sub>=<italic>K</italic>(<italic>K</italic><sup><italic>T</italic></sup><italic>H</italic><sub><italic>τ</italic></sub><italic>K</italic>)<sup>−1</sup><italic>K</italic><sup><italic>T</italic></sup>, and, as implied by the REML first-order (stationarity) conditions, <inline-formula id="IEq34"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\sigma }^{2}_{e}(\tau)$\end{document}</tex-math><mml:math id="M74"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:mi>τ</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq34.gif"/></alternatives></inline-formula> is the expected residual variance component given <italic>τ</italic> and <inline-formula id="IEq35"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\sigma }^{2}_{g}(\tau)=\hat {\sigma }^{2}_{e}(\tau)/\tau $\end{document}</tex-math><mml:math id="M76"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:mi>τ</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:mi>τ</mml:mi><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mi>τ</mml:mi></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq35.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR13">13</xref>]. In practice, <italic>K</italic> is never explicitly formed.</p>
    <p>Naïve procedures for maximizing the REML criterion require evaluating (<xref rid="Equ3" ref-type="">3</xref>) or its derivatives at each iteration of the optimization procedure. Previous methods either reduce the number of necessary cubic time complexity operations to one by exploiting problem structure, or substitute quadratic time complexity iterative and stochastic matrix operations for direct computations (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). Here, we unify these approaches via the principle of Krylov subspace shift invariance to achieve methods that only require a single iteration of quadratic time complexity operations.</p>
    <p>In what follows, we first present a brief survey of the Lanczos process, its applications to families of shifted linear systems, and its use in constructing Gaussian quadratures for spectral matrix functions. We assume familiarity with the method of conjugate gradients, an iterative procedure for approximating solutions to symmetric positive definite linear systems, and Gaussian quadrature, a method for approximating the integral of a given function by a well chosen weighted sum of its values; if not, see [<xref ref-type="bibr" rid="CR14">14</xref>] and [<xref ref-type="bibr" rid="CR15">15</xref>], respectively. We present these methods toward the goal of efficiently evaluating the quadratic form and log-determinant terms appearing in the REML criterion (<xref rid="Equ3" ref-type="">3</xref>). We then present the details of the SLDF_REML and L_FOMC_REML algorithms, both of which exploit problem structure via Lanczos process-based methods in order to speed computation. Finally, we derive expressions for the computational complexity of the present algorithms, which we confirm via numerical experiment.</p>
    <p>
      <graphic position="anchor" xlink:href="12859_2019_2978_Figa_HTML" id="MO6"/>
    </p>
    <sec id="Sec6">
      <title>Preliminaries</title>
      <p>The notation in this section is self-contained. Our presentation borrows from the literature extensively; further details on the (block) Lanczos procedure [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR16">16</xref>], conjugate gradients for shifted linear systems [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>], stochastic trace estimation [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR20">20</xref>], and stochastic Lanczos quadrature [<xref ref-type="bibr" rid="CR21">21</xref>–<xref ref-type="bibr" rid="CR23">23</xref>] are suggested in the bibliography.</p>
      <sec id="Sec7">
        <title>Krylov subspaces</title>
        <p>Consider a symmetric positive-definite matrix <italic>A</italic> and nonzero vector <italic>b</italic>. Define the <italic>m</italic><sup><italic>t</italic><italic>h</italic></sup> Krylov subspace by the span of the first <italic>m</italic>−1 monomials in <italic>A</italic> applied to <italic>b</italic>; that is, <inline-formula id="IEq36"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {K}_{m}(A,b)=\text {span}\, \left \{A^{k}b:k=0,\ldots,m-1\right \}$\end{document}</tex-math><mml:math id="M78"><mml:msub><mml:mrow><mml:mi mathvariant="script">K</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mtext>span</mml:mtext><mml:mspace width="0.3em"/><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mi>b</mml:mi><mml:mo>:</mml:mo><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq36.gif"/></alternatives></inline-formula>. Krylov subspaces are <italic>shift invariant</italic>—i.e., for real numbers <italic>σ</italic>, we have <inline-formula id="IEq37"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {K}_{m}(A,b)=\mathcal {K}_{m}(A+\sigma I,b)$\end{document}</tex-math><mml:math id="M80"><mml:msub><mml:mrow><mml:mi mathvariant="script">K</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">K</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>+</mml:mo><mml:mi>σI</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq37.gif"/></alternatives></inline-formula>.</p>
      </sec>
      <sec id="Sec8">
        <title>The Lanczos procedure</title>
        <p>The Lanczos procedure generates the decomposition <italic>A</italic><italic>U</italic><sub><italic>m</italic></sub>=<italic>U</italic><sub><italic>m</italic></sub><italic>T</italic><sub><italic>m</italic></sub>, where the columns <italic>u</italic><sub>1</sub>,…,<italic>u</italic><sub><italic>m</italic></sub> of <italic>U</italic><sub><italic>m</italic></sub> form an orthonormal basis for <inline-formula id="IEq38"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {K}_{m}(A,b)$\end{document}</tex-math><mml:math id="M82"><mml:msub><mml:mrow><mml:mi mathvariant="script">K</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq38.gif"/></alternatives></inline-formula> and the <italic>Jacobi matrices</italic><inline-formula id="IEq39"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$T_{m}\in \mathbb {R}^{m\times m}$\end{document}</tex-math><mml:math id="M84"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>×</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq39.gif"/></alternatives></inline-formula> are symmetric tridiagonal. Choosing <italic>u</italic><sub>1</sub>=<italic>b</italic>/∥<italic>b</italic>∥, successive columns are uniquely determined by the sequence of Lanczos polynomials <inline-formula id="IEq40"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\{p_{k}\}_{k=1}^{m-1}$\end{document}</tex-math><mml:math id="M86"><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq40.gif"/></alternatives></inline-formula> such that each <italic>u</italic><sub><italic>k</italic></sub>=<italic>p</italic><sub><italic>k</italic>−1</sub>(<italic>A</italic>)<italic>u</italic><sub>1</sub> and each <italic>p</italic><sub><italic>k</italic></sub> is the characteristic polynomial of Jacobi matrix <italic>T</italic><sub><italic>k</italic></sub> consisting of the first <italic>k</italic> rows and columns of <italic>T</italic><sub><italic>m</italic></sub>. The Lanczos procedure is equivalent to the well-known method of conjugate gradients (CG) for solving the linear system <italic>A</italic><italic>x</italic>=<italic>b</italic> in that the <italic>m</italic><sup><italic>t</italic><italic>h</italic></sup> step CG approximate solution <italic>x</italic><sup>(<italic>m</italic>)</sup> is obtained from the above decomposition using only vector operations (see Algorithm 1). The number of steps <italic>m</italic> prior to termination corresponds to the number of CG iterations need to bound the norm of the residual below a specified tolerance: ∥<italic>A</italic><italic>x</italic><sup>(<italic>m</italic>)</sup>−<italic>b</italic>∥&lt;<italic>ε</italic>. The rate of convergence depends on the spectral properties of <italic>A</italic> and can be controlled in terms of the spectral condition number <italic>κ</italic>(<italic>A</italic>). In the present application, the fact that all complex traits of interest generally have a non-trivial non-heritable component results in well-conditioned systems [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR9">9</xref>].</p>
      </sec>
      <sec id="Sec9">
        <title>Solving families of shifted linear systems</title>
        <p>Having applied the Lanczos process to the <italic>seed system</italic>
<italic>A</italic><italic>x</italic>=<italic>b</italic>, shift-invariance can be exploited to obtain the <italic>m</italic><sup><italic>t</italic><italic>h</italic></sup> step CG approximate solution <inline-formula id="IEq41"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$x_{\sigma }^{(m)}$\end{document}</tex-math><mml:math id="M88"><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq41.gif"/></alternatives></inline-formula> to the <italic>shifted linear system</italic>
<italic>A</italic><sub><italic>σ</italic></sub><italic>x</italic><sub><italic>σ</italic></sub>=(<italic>A</italic>+<italic>σ</italic><italic>I</italic>)<italic>x</italic><sub><italic>σ</italic></sub>=<italic>b</italic>, only using vector operations [<xref ref-type="bibr" rid="CR17">17</xref>]. It can be shown that any positive shift by <italic>σ</italic>≥0 improves the rate of convergence such that <inline-formula id="IEq42"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\left \Vert A_{\sigma }x_{\sigma }^{(m)}-b\left \Vert = \frac {\delta _{m}}{\delta _{m}+\sigma }\right \Vert Ax^{(m)}-b\right \Vert $\end{document}</tex-math><mml:math id="M90"><mml:mfenced close="∥" open="∥" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>σ</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mi>b</mml:mi><mml:mfenced close="∥" open="∥" separators=""><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mi>A</mml:mi><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq42.gif"/></alternatives></inline-formula>, where <italic>δ</italic><sub><italic>m</italic></sub>&gt;0 is the <italic>m</italic><sup><italic>t</italic><italic>h</italic></sup> diagonal element of the Lanczos Jacobi matrix corresponding to <inline-formula id="IEq43"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {K}_{m}(A,b)$\end{document}</tex-math><mml:math id="M92"><mml:msub><mml:mrow><mml:mi mathvariant="script">K</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq43.gif"/></alternatives></inline-formula>.</p>
        <p>
          <graphic position="anchor" xlink:href="12859_2019_2978_Figb_HTML" id="MO7"/>
        </p>
      </sec>
      <sec id="Sec10">
        <title>Lanczos polynomials and Gaussian quadrature</title>
        <p>Additionally, the Lanczos polynomials comprise a sequence of orthogonal polynomials with respect to the <italic>spectral measure</italic>
<disp-formula id="Equa"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\mu_{A,v}(t)=\sum_{j=1}^{\ell:\lambda_{\ell}\leq t} \left(Q^{T}v\right)_{j}^{2}, $$ \end{document}</tex-math><mml:math id="M94"><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi>v</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2019_2978_Article_Equa.gif" position="anchor"/></alternatives></disp-formula> where <italic>A</italic>=<italic>Q</italic><italic>Λ</italic><italic>Q</italic><sup><italic>T</italic></sup> is the spectral decomposition [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR22">22</xref>]. Quadratic forms <italic>v</italic><sup><italic>T</italic></sup><italic>f</italic>(<italic>A</italic>)<italic>v</italic> involving <italic>spectral functions</italic>
<italic>f</italic>(<italic>A</italic>)=<italic>Q</italic><italic>f</italic>(<italic>Λ</italic>)<italic>Q</italic><sup><italic>T</italic></sup>, e.g., for the matrix logarithm, <inline-formula id="IEq44"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$v^{T}(\log A)v = \sum _{i=1}^{n} \left [\ln (\lambda _{i})\left (Q^{T}v\right)_{i}^{2}\right ]$\end{document}</tex-math><mml:math id="M96"><mml:msup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mo>log</mml:mo><mml:mi>A</mml:mi><mml:mo>)</mml:mo><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mo>ln</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:munderover><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi>v</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq44.gif"/></alternatives></inline-formula>, can be written as Riemann–Stieltjes integrals of the form 
<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ v^{T}Qf(\Lambda)Q^{T}v=\int_{\lambda_{1}}^{\lambda_{n}}f(t)d\mu_{A,v}(t).  $$ \end{document}</tex-math><mml:math id="M98"><mml:msup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mtext mathvariant="italic">Qf</mml:mtext><mml:mo>(</mml:mo><mml:mi>Λ</mml:mi><mml:mo>)</mml:mo><mml:msup><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∫</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mi>.</mml:mi></mml:math><graphic xlink:href="12859_2019_2978_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>The Lanczos decomposition <italic>A</italic><italic>U</italic><sub><italic>m</italic></sub>=<italic>U</italic><sub><italic>m</italic></sub><italic>T</italic><sub><italic>m</italic></sub> generates the weights and nodes for an <italic>m</italic>-point Gaussian quadrature approximating the above integral. Denoting the spectral decomposition of the <italic>j</italic><sup><italic>t</italic><italic>h</italic></sup> Jacobi matrix <inline-formula id="IEq45"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$T_{j}=W_{j}D_{j}W_{j}^{T}$\end{document}</tex-math><mml:math id="M100"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq45.gif"/></alternatives></inline-formula> for <italic>j</italic>=1,…,<italic>m</italic>, we approximate (<xref rid="Equ4" ref-type="">4</xref>) as 
<disp-formula id="Equb"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\int_{\lambda_{1}}^{\lambda_{n}}f(t)d\mu_{A,v}(t)\approx\sum_{\ell=1}^{m}\omega_{j,\ell}f(\theta_{j,\ell}), $$ \end{document}</tex-math><mml:math id="M102"><mml:mrow><mml:munderover><mml:mrow><mml:mo>∫</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>≈</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2019_2978_Article_Equb.gif" position="anchor"/></alternatives></disp-formula> where <italic>θ</italic><sub><italic>j</italic>,<italic>ℓ</italic></sub>={<italic>D</italic><sub><italic>j</italic></sub>}<sub><italic>ℓ</italic>,<italic>ℓ</italic></sub> and <inline-formula id="IEq46"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\omega _{j,\ell }=\left \{e_{1}^{T}W_{j}\right \}_{\ell }$\end{document}</tex-math><mml:math id="M104"><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq46.gif"/></alternatives></inline-formula>. As <italic>m</italic> here corresponds to the number of CG iterations needed to ensure that ∥<italic>A</italic><italic>x</italic><sup>(<italic>m</italic>)</sup>−<italic>v</italic>∥ is smaller than a specified tolerance, the tridiagonal Jacobi matrices are small and calculating their spectral decompositions is computationally trivial.</p>
      </sec>
      <sec id="Sec11">
        <title>Stochastic Lanczos quadrature</title>
        <p><italic>Stochastic Lanczos quadrature</italic> (SLQ) combines the above quadrature formulation with Hutchinson-type stochastic trace estimators [<xref ref-type="bibr" rid="CR21">21</xref>]. Such estimators approximate the trace of a matrix <inline-formula id="IEq47"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$H\in \mathbb {R}^{n\times n}$\end{document}</tex-math><mml:math id="M106"><mml:mi>H</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq47.gif"/></alternatives></inline-formula> by a weighted sum of quadratic forms <inline-formula id="IEq48"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\text {tr}(H)\approx \frac {n}{n_{\text {rand}}}\sum _{k=1}^{n_{\text {rand}}}v_{k}^{T}{Hv}_{k}$\end{document}</tex-math><mml:math id="M108"><mml:mtext>tr</mml:mtext><mml:mo>(</mml:mo><mml:mi>H</mml:mi><mml:mo>)</mml:mo><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext>rand</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext>rand</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mtext mathvariant="italic">Hv</mml:mtext></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq48.gif"/></alternatives></inline-formula> for normalized, suitably distributed i.i.d. random <italic>probing vectors</italic><inline-formula id="IEq49"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\{v_{j}\}_{j=1}^{n_{\text {rand}}}$\end{document}</tex-math><mml:math id="M110"><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext>rand</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq49.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR19">19</xref>]. The SLQ approximate trace of a spectral function of a matrix, tr(<italic>f</italic>(<italic>A</italic>)), is then 
<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \text{tr}(f(A)) &amp; \approx \frac{n}{n_{\text{rand}}} \sum_{k=1}^{n_{\text{rand}}}v_{k}^{T}Qf(A)Q^{T}v_{k} \\ &amp;=\frac{n}{n_{\text{rand}}}\sum_{k=1}^{n_{\text{rand}}}\int_{\lambda_{1}}^{\lambda_{n}}f(t)d\mu_{A,v_{k}}(t)\\ &amp;\approx\frac{n}{n_{\text{rand}}}\sum_{k=1}^{n_{\text{rand}}}\sum_{\ell=1}^{m_{\kappa}}\omega_{k,\ell}f(\theta_{k,\ell}). \end{array} $$ \end{document}</tex-math><mml:math id="M112"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mtext>tr</mml:mtext><mml:mo>(</mml:mo><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mtd><mml:mtd class="align-2"><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext>rand</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext>rand</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mtext mathvariant="italic">Qf</mml:mtext><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>)</mml:mo><mml:msup><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"/><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext>rand</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext>rand</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:munderover><mml:mrow><mml:mo>∫</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"/><mml:mtd class="align-2"><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext>rand</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext>rand</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>κ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mi>.</mml:mi><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2019_2978_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>Whereas the number of probing vectors <italic>n</italic><sub>rand</sub> is chosen a priori, the number quadrature nodes <italic>m</italic><sub><italic>κ</italic></sub> corresponds to the number of conjugate gradient iterations needed to ensure <inline-formula id="IEq50"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\left \Vert A_{\sigma }x_{j \sigma }^{(m_{\kappa })}-v_{j}\right \Vert $\end{document}</tex-math><mml:math id="M114"><mml:mfenced close="∥" open="∥" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>σ</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>jσ</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>κ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq50.gif"/></alternatives></inline-formula> is less than a specified tolerance for each <italic>j</italic>=1,…,<italic>n</italic><sub>rand</sub>.</p>
      </sec>
      <sec id="Sec12">
        <title>SLQ and shift invariance</title>
        <p>For a fixed probing vector <italic>v</italic><sub><italic>i</italic></sub>, we can exploit the shift invariance of <inline-formula id="IEq51"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {K}_{m}(A,v_{i})$\end{document}</tex-math><mml:math id="M116"><mml:msub><mml:mrow><mml:mi mathvariant="script">K</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq51.gif"/></alternatives></inline-formula> to efficiently update Gaussian quadrature generated by the corresponding Lanczos decomposition <italic>A</italic><italic>U</italic><sub><italic>m</italic></sub>=<italic>U</italic><sub><italic>m</italic></sub><italic>T</italic><sub><italic>m</italic></sub>. Again denoting the spectral decomposition of the Jacobi matrix <inline-formula id="IEq52"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$T_{i}=W_{i}D_{i}W_{i}^{T}$\end{document}</tex-math><mml:math id="M118"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq52.gif"/></alternatives></inline-formula>, the Lanczos decomposition of the shifted system is simply <inline-formula id="IEq53"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$A_{\sigma }U_{m}=U_{m}W_{m}(D_{m}+\sigma I_{m})W_{m}^{T}$\end{document}</tex-math><mml:math id="M120"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>σ</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>σ</mml:mi><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq53.gif"/></alternatives></inline-formula>. Thus, given the approximation (<xref rid="Equ5" ref-type="">5</xref>) for tr(<italic>f</italic>(<italic>A</italic>)), we can efficiently compute an approximation of tr(<italic>f</italic>(<italic>A</italic><sub><italic>σ</italic></sub>)) for any <italic>σ</italic>&gt;0. In Algorithm 2 we implement a method for estimating tr(log(<italic>A</italic><sub><italic>σ</italic></sub>)) in <inline-formula id="IEq54"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {O}(n_{\text {rand}})$\end{document}</tex-math><mml:math id="M122"><mml:mi mathvariant="script">O</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext>rand</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq54.gif"/></alternatives></inline-formula> operations given the spectral decompositions of the Jacobi matrices corresponding to <inline-formula id="IEq55"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {K}_{m}(A,v_{j})$\end{document}</tex-math><mml:math id="M124"><mml:msub><mml:mrow><mml:mi mathvariant="script">K</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq55.gif"/></alternatives></inline-formula> for probing vectors <inline-formula id="IEq56"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\{v_{j}\}_{j=1}^{n_{\text {rand}}}$\end{document}</tex-math><mml:math id="M126"><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext>rand</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq56.gif"/></alternatives></inline-formula>.</p>
      </sec>
      <sec id="Sec13">
        <title>Block methods</title>
        <p>For multiple right hand sides <italic>B</italic>=[<italic>b</italic><sub>1</sub>|⋯|<italic>b</italic><sub><italic>c</italic></sub>], the Lanczos procedure can be generalized to the <italic>block Krylov subspace</italic><inline-formula id="IEq57"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {K}_{m}(A,B)=\bigotimes _{j=1}^{c}\mathcal {K}_{m}(A,b_{j})$\end{document}</tex-math><mml:math id="M128"><mml:msub><mml:mrow><mml:mi mathvariant="script">K</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>⊗</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi mathvariant="script">K</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq57.gif"/></alternatives></inline-formula>, resulting in a collection of Lanczos decompositions <italic>A</italic><italic>U</italic><sub><italic>j</italic></sub>=<italic>U</italic><sub><italic>j</italic></sub><italic>T</italic><sub><italic>j</italic></sub> such that {<italic>U</italic><sub><italic>j</italic></sub>}<sub>1</sub>=<italic>b</italic><sub><italic>j</italic></sub>/∥<italic>b</italic><sub><italic>j</italic></sub>∥ for <italic>j</italic>=1,…,<italic>c</italic>. This process is equivalent to block CG methods in that the Jacobi matrices can again be used to generate an approximate solution <italic>X</italic><sup>(<italic>m</italic>)</sup> to the matrix equation <italic>A</italic><italic>X</italic><sup>(<italic>m</italic>)</sup>=<italic>B</italic>. We provide an implementation of the block Lanczos procedure in L_Seed [<xref ref-type="bibr" rid="CR9">9</xref>], employing a conservative convergence criterion defined in terms of the magnitude of the (1,2) operator norm of the residual <inline-formula id="IEq58"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\left \Vert AB- X^{(m)}\right \Vert _{1\rightarrow 2}=\max _{j}\left \Vert {Ab}_{j}- x^{(m)}_{j}\right \Vert _{2}$\end{document}</tex-math><mml:math id="M130"><mml:msub><mml:mrow><mml:mfenced close="∥" open="∥" separators=""><mml:mrow><mml:mtext mathvariant="italic">AB</mml:mtext><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>→</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>max</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mfenced close="∥" open="∥" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mtext mathvariant="italic">Ab</mml:mtext></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq58.gif"/></alternatives></inline-formula>. Compared to performing <italic>c</italic> separate Lanczos procedures with respect to <inline-formula id="IEq59"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\{\mathcal {K}_{m}(A,b_{j})\}_{j=1}^{c}$\end{document}</tex-math><mml:math id="M132"><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">K</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq59.gif"/></alternatives></inline-formula>, block Lanczos with respect to <inline-formula id="IEq60"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {K}_{m}(A,b)$\end{document}</tex-math><mml:math id="M134"><mml:msub><mml:mrow><mml:mi mathvariant="script">K</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq60.gif"/></alternatives></inline-formula>, with <italic>B</italic>=[<italic>b</italic><sub>1</sub>|⋯|<italic>b</italic><sub><italic>c</italic></sub>], produces the same result (for a fixed number of steps). However, block Lanczos employs BLAS-3 operations and is thus more performant, especially when implemented on top of parallelized linear algebra subroutines.</p>
      </sec>
    </sec>
    <sec id="Sec14">
      <title>A derivative-free REML algorithm</title>
      <p>We propose the stochastic Lanczos derivative-free residual maximum likelihood algorithm (SLDF_REML; Algorithm 3), a method for efficiently and repeatedly evaluating the REML criterion, which is then subject to a zeroth-order optimization scheme. To achieve this goal, we first identify the parameter space of interest with a family of shifted linear systems. We then develop a scheme for evaluating the quadratic form <italic>y</italic><sup><italic>T</italic></sup><italic>P</italic><sub><italic>τ</italic></sub><italic>y</italic> and log determinant ln(det(<italic>K</italic><sup><italic>T</italic></sup><italic>H</italic><sub><italic>τ</italic></sub><italic>K</italic>)) terms in the REML criterion (<xref rid="Equ3" ref-type="">3</xref>) that use the previously discussed Lanczos methods to exploit this shifted structure. Specifically, after obtaining a collection of Lanczos decompositions, we can repeatedly solve the linear systems involved in the quadratic form term via Lanczos conjugate gradients and approximate the log determinant term via stochastic Lanczos quadrature.</p>
      <p>
        <graphic position="anchor" xlink:href="12859_2019_2978_Figc_HTML" id="MO8"/>
      </p>
      <sec id="Sec15">
        <title>The parameter space as shifted linear systems</title>
        <p>Given a range of possible values of the <italic>standardized genetic variance component</italic>, or <italic>heritability</italic>, 
<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ h^{2}=\sigma_{g}^{2}/\left(\sigma_{g}^{2}+\sigma_{e}^{2}\right),\quad h^{2}\in\left[h^{2}_{\min},h^{2}_{\max}\right],  $$ \end{document}</tex-math><mml:math id="M136"><mml:msup><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>/</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msup><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mo>min</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mo>max</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12859_2019_2978_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>we set <inline-formula id="IEq61"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\phantom {\dot {i}\!}\tau _{0}=(1-h^{2}_{\max })/h^{2}_{\max }$\end{document}</tex-math><mml:math id="M138"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mo>max</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:msubsup><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mo>max</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq61.gif"/></alternatives></inline-formula> and define <inline-formula id="IEq62"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$H_{0}=H_{\tau _{0}}\phantom {\dot {i}\!}$\end{document}</tex-math><mml:math id="M140"><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq62.gif"/></alternatives></inline-formula>, noting that for all <inline-formula id="IEq63"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tau \in \Theta =\left \{\left (1-h^{2}\right)/h^{2}: h^{2}\in \left [h^{2}_{\min },h^{2}_{\max }\right ]\right \}\phantom {\dot {i}\!}$\end{document}</tex-math><mml:math id="M142"><mml:mi>τ</mml:mi><mml:mo>∈</mml:mo><mml:mi>Θ</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>/</mml:mo><mml:msup><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>:</mml:mo><mml:msup><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mo>min</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mo>max</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq63.gif"/></alternatives></inline-formula>, the spectral condition number of <italic>H</italic><sub><italic>τ</italic></sub> will be less than that of <italic>H</italic><sub>0</sub> as the identity component of <italic>H</italic><sub><italic>τ</italic></sub> will only increase. Further, we have now identified elements of our parameter space <italic>τ</italic>∈<italic>Θ</italic> with the family of shifted linear systems 
<disp-formula id="Equc"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\mathcal{H}_{\tau_{0}} = \{H_{\sigma} = H_{\tau}=H_{0}+\sigma I_{n}:\sigma=\tau-\tau_{0}\}. $$ \end{document}</tex-math><mml:math id="M144"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">ℋ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>σ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>σ</mml:mi><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mi>τ</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>}</mml:mo><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2019_2978_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>For any vector <italic>v</italic> for which we have computed the Lanczos decomposition <italic>H</italic><sub>0</sub><italic>U</italic>=<italic>U</italic><italic>T</italic> with the first column of <italic>U</italic> equal to <italic>v</italic>/∥<italic>v</italic>∥, we can use Algorithm 1 to obtain the CG approximate solution <inline-formula id="IEq64"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\phantom {\dot {i}\!}x_{\sigma }\approx H_{\sigma }^{-1}v$\end{document}</tex-math><mml:math id="M146"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>σ</mml:mi></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:msubsup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi>v</mml:mi></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq64.gif"/></alternatives></inline-formula> for all <italic>σ</italic>≥0 in <italic>O</italic>(<italic>n</italic>) operations.</p>
      </sec>
      <sec id="Sec16">
        <title>The quadratic form</title>
        <p>Directly evaluating the quadratic form 
<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ y^{T}P_{\tau} y = y^{T}K\left(K^{T}H_{\tau} K\right)^{-1}K^{T}y  $$ \end{document}</tex-math><mml:math id="M148"><mml:msup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi>K</mml:mi><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mi>K</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi>y</mml:mi></mml:math><graphic xlink:href="12859_2019_2978_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>is computationally demanding and is typically avoided in direct estimation methods [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR13">13</xref>]. Writing the complete QR decomposition of the covariate matrix <inline-formula id="IEq65"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\phantom {\dot {i}\!}X=[Q_{X}\vert Q_{X^{\perp }}]R$\end{document}</tex-math><mml:math id="M150"><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mo>⊥</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>]</mml:mo><mml:mi>R</mml:mi></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq65.gif"/></alternatives></inline-formula> allows us to define <inline-formula id="IEq66"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\phantom {\dot {i}\!}K^{T}=Q_{X^{\perp }}^{T}$\end{document}</tex-math><mml:math id="M152"><mml:msup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mo>⊥</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq66.gif"/></alternatives></inline-formula>, noting that substituting <inline-formula id="IEq67"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\phantom {\dot {i}\!}Q_{X^{\perp }}Q_{X^{\perp }}^{T}$\end{document}</tex-math><mml:math id="M154"><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mo>⊥</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mo>⊥</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq67.gif"/></alternatives></inline-formula> for <italic>K</italic><sup><italic>T</italic></sup> preserves the value of (<xref rid="Equ7" ref-type="">7</xref>). <inline-formula id="IEq68"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$Q_{X^{\perp }}Q_{X^{\perp }}^{T}$\end{document}</tex-math><mml:math id="M156"><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mo>⊥</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mo>⊥</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq68.gif"/></alternatives></inline-formula> is equivalent to the orthogonal projection operator <inline-formula id="IEq69"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\phantom {\dot {i}\!}S:v\mapsto v - Q_{X}Q_{X}^{T}v$\end{document}</tex-math><mml:math id="M158"><mml:mi>S</mml:mi><mml:mo>:</mml:mo><mml:mi>v</mml:mi><mml:mo>↦</mml:mo><mml:mi>v</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mi>v</mml:mi></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq69.gif"/></alternatives></inline-formula>, which admits an efficient implicit construction and is computed in <italic>O</italic>(<italic>n</italic><italic>c</italic><sup>2</sup>) operations via the <italic>economy</italic> QR decomposition <italic>X</italic>=<italic>Q</italic><sub><italic>X</italic></sub><italic>R</italic><sub><italic>X</italic></sub>. Then, reexpressing (<xref rid="Equ7" ref-type="">7</xref>) as <italic>y</italic><sup><italic>T</italic></sup><italic>S</italic>(<italic>S</italic><italic>H</italic><sub><italic>τ</italic></sub><italic>S</italic>)<sup><italic>†</italic></sup><italic>S</italic><italic>y</italic>, we can use the Lanczos process to construct an orthonormal basis and corresponding Jacobi matrix for the Krylov subspace <inline-formula id="IEq70"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {K}({SH}_{0}S,Sy)$\end{document}</tex-math><mml:math id="M160"><mml:mi mathvariant="script">K</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mtext mathvariant="italic">SH</mml:mtext></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mtext mathvariant="italic">Sy</mml:mtext><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq70.gif"/></alternatives></inline-formula>. We can then obtain the CG approximation of <italic>y</italic><sup><italic>T</italic></sup><italic>S</italic>(<italic>S</italic><italic>H</italic><sub><italic>σ</italic></sub><italic>S</italic>)<sup>−1</sup><italic>S</italic><italic>y</italic> using vector operations as, for any shift <italic>σ</italic>, we have <italic>y</italic><sup><italic>T</italic></sup><italic>S</italic>(<italic>S</italic><italic>H</italic><sub><italic>σ</italic></sub><italic>S</italic>)<sup><italic>†</italic></sup><italic>S</italic><italic>y</italic>=<italic>y</italic><sup><italic>T</italic></sup><italic>S</italic>(<italic>S</italic><italic>H</italic><sub>0</sub><italic>S</italic>+<italic>σ</italic><italic>I</italic><sub><italic>n</italic></sub>)<sup>−1</sup><italic>S</italic><italic>y</italic> (see Lemma 1 in Additional file <xref rid="MOESM1" ref-type="media">1</xref> for proof).</p>
      </sec>
      <sec id="Sec17">
        <title>The log determinant</title>
        <p>We use an equivalent formulation [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR24">24</xref>] of the term ln(det(<italic>K</italic><sup><italic>T</italic></sup><italic>H</italic><sub><italic>τ</italic></sub><italic>K</italic>)), rewriting it as 
<disp-formula id="Equd"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\ln(\det(H_{\tau}))+\ln\left(\det\left(X^{T}H^{-1}_{\tau} X\right)\right)- \ln\left(\det\left(X^{T}X\right)\right). $$ \end{document}</tex-math><mml:math id="M162"><mml:mrow><mml:mo>ln</mml:mo><mml:mo>(</mml:mo><mml:mo>det</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mo>ln</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>det</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mi>X</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:mo>ln</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>det</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi>X</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2019_2978_Article_Equd.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>The det(<italic>X</italic><sup><italic>T</italic></sup><italic>X</italic>) term is constant with respect to <italic>τ</italic> and can be disregarded. For <italic>c</italic>≪<italic>n</italic>, <inline-formula id="IEq71"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\det \left (X^{T}H^{-1}_{\tau } X\right)$\end{document}</tex-math><mml:math id="M164"><mml:mo>det</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi>X</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq71.gif"/></alternatives></inline-formula> is computationally trivial via direct methods given <inline-formula id="IEq72"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$H^{-1}_{\tau } X$\end{document}</tex-math><mml:math id="M166"><mml:msubsup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi>X</mml:mi></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq72.gif"/></alternatives></inline-formula>, which we can compute for all parameter values of interest in <italic>O</italic>(<italic>n</italic>) operations having first applied the block Lanczos process with respect to <inline-formula id="IEq73"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {K}(H_{0},X)$\end{document}</tex-math><mml:math id="M168"><mml:mi mathvariant="script">K</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>X</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq73.gif"/></alternatives></inline-formula>. Computing the block Lanczos decomposition corresponding to <inline-formula id="IEq74"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {K}(H_{0},X)$\end{document}</tex-math><mml:math id="M170"><mml:mi mathvariant="script">K</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>X</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq74.gif"/></alternatives></inline-formula>, which is only performed once, unfortunately scales with the number of covariates <italic>c</italic>, a disadvantage not shared by our second algorithm (Algorithm 4). The remaining term, ln(det(<italic>H</italic><sub><italic>τ</italic></sub>)), is approximated by applying SLQ (Algorithm 2) to a special case of (<xref rid="Equ5" ref-type="">5</xref>): We rewrite the log determinant as the trace of the matrix logarithm 
<disp-formula id="Eque"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \ln(\det(H_{\tau}))&amp;=\text{tr\,}(\log(H_{\tau}))\\ &amp;=\text{tr\,}Q[\ln(\lambda_{1}+\sigma)\vert\cdots\vert\ln(\lambda_{n} + \sigma)]Q^{T}, \end{array} $$ \end{document}</tex-math><mml:math id="M172"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mo>ln</mml:mo><mml:mo>(</mml:mo><mml:mo>det</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mtd><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:mtext>tr</mml:mtext><mml:mo>(</mml:mo><mml:mo>log</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"/><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:mtext>tr</mml:mtext><mml:mi>Q</mml:mi><mml:mo>[</mml:mo><mml:mo>ln</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>σ</mml:mi><mml:mo>)</mml:mo><mml:mo>|</mml:mo><mml:mo>⋯</mml:mo><mml:mo>|</mml:mo><mml:mo>ln</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>σ</mml:mi><mml:mo>)</mml:mo><mml:mo>]</mml:mo><mml:msup><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2019_2978_Article_Eque.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>where we have spectrally decomposed <italic>H</italic><sub>0</sub>=<italic>Q</italic><italic>Λ</italic><italic>Q</italic><sup><italic>T</italic></sup> for some <italic>τ</italic><sub>0</sub>≤<italic>τ</italic> with <italic>σ</italic>=<italic>τ</italic>−<italic>τ</italic><sub>0</sub>. We draw <italic>n</italic><sub>rand</sub>
<italic>i</italic>.<italic>i</italic>.<italic>d</italic>. normalized Rademacher random vectors <inline-formula id="IEq75"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$v_{1},\ldots,v_{n_{\text {rand}}}\phantom {\dot {i}\!}$\end{document}</tex-math><mml:math id="M174"><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext>rand</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq75.gif"/></alternatives></inline-formula>, where each element of each vector <italic>v</italic><sub><italic>i</italic></sub> takes values of either 1/∥<italic>v</italic><sub><italic>i</italic></sub>∥ or −1/∥<italic>v</italic><sub><italic>i</italic></sub>∥ with equal probability. The SLQ approximate of the log determinant for the seed system is 
<disp-formula id="Equf"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\ln(\det(H_{\sigma}))\approx\frac{n}{n_{\text{rand}}}\sum_{i=1}^{n_{\text{rand}}}\sum_{\ell=1}^{m_{i}}\omega_{i,\ell}\ln(\theta_{i,\ell}+\sigma), $$ \end{document}</tex-math><mml:math id="M176"><mml:mrow><mml:mo>ln</mml:mo><mml:mo>(</mml:mo><mml:mo>det</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>σ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext>rand</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext>rand</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub><mml:mo>ln</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>σ</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2019_2978_Article_Equf.gif" position="anchor"/></alternatives></disp-formula> where the weights <italic>w</italic><sub><italic>i</italic>,<italic>ℓ</italic></sub> and nodes <italic>θ</italic><sub><italic>i</italic>,<italic>ℓ</italic></sub> are respectively derived by using the Lanczos process to construct orthonormal bases for <inline-formula id="IEq76"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {K}(H_{0},v_{i})$\end{document}</tex-math><mml:math id="M178"><mml:mi mathvariant="script">K</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq76.gif"/></alternatives></inline-formula> (in practice, we apply block Lanczos to <inline-formula id="IEq77"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {K}(H_{0},(v_{1},\ldots,v_{n_{\text {rand}}}))$\end{document}</tex-math><mml:math id="M180"><mml:mi mathvariant="script">K</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext>rand</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq77.gif"/></alternatives></inline-formula>) [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR22">22</xref>].</p>
        <p>
          <graphic position="anchor" xlink:href="12859_2019_2978_Figd_HTML" id="MO9"/>
        </p>
      </sec>
      <sec id="Sec18">
        <title>The SLDF_REML algorithm</title>
        <p>Stochastic Lanczos derivative-free residual maximum likelihood (SLDF_REML; Algorithm 3), conceptually similar to the derivative-free algorithm of Graser and colleagues [<xref ref-type="bibr" rid="CR13">13</xref>], applies the previously introduced Lanczos methods to approximate the above reparametrization of the REML criterion. Shift-invariance is then exploited such that, with the exception of the initial Lanczos decompositions, the REML log likelihood can be repeatedly evaluated using only vector operations. SLDF_REML takes a phenotype vector <inline-formula id="IEq78"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$y\in \mathbb {R}^{n}$\end{document}</tex-math><mml:math id="M182"><mml:mi>y</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq78.gif"/></alternatives></inline-formula>, a covariate matrix <inline-formula id="IEq79"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X\in \mathbb {R}^{n\times c}$\end{document}</tex-math><mml:math id="M184"><mml:mi>X</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq79.gif"/></alternatives></inline-formula>, either the genetic relatedness matrix <inline-formula id="IEq80"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$ZZ^{T}\in \mathbb {R}^{n\times n}$\end{document}</tex-math><mml:math id="M186"><mml:mi>Z</mml:mi><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq80.gif"/></alternatives></inline-formula> or the standardized genotype matrix <inline-formula id="IEq81"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$Z\in \mathbb {R}^{n\times m}$\end{document}</tex-math><mml:math id="M188"><mml:mi>Z</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq81.gif"/></alternatives></inline-formula> (in which case the action of the GRM as a linear operator is coded implicitly as <italic>v</italic>↦<italic>Z</italic>(<italic>Z</italic><sup><italic>T</italic></sup><italic>v</italic>)), and a range of possible standardized genomic variance component values <inline-formula id="IEq82"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\Theta = \left [h^{2}_{\text {min}},h^{2}_{\max }\right ]$\end{document}</tex-math><mml:math id="M190"><mml:mi>Θ</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mo>max</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq82.gif"/></alternatives></inline-formula> as arguments and generates a function REML_criterion<inline-formula id="IEq83"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$:\Theta \rightarrow \mathbb {R}$\end{document}</tex-math><mml:math id="M192"><mml:mo>:</mml:mo><mml:mi>Θ</mml:mi><mml:mo>→</mml:mo><mml:mi>ℝ</mml:mi></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq83.gif"/></alternatives></inline-formula> that efficiently computes the log-likelihood of <italic>τ</italic>|<italic>K</italic><sup><italic>T</italic></sup><italic>y</italic>. This function is then subject to scalar optimization via Brent’s method, which is feasible given the low cost of evaluation and low dimension of <italic>Θ</italic>. Hyperparameters include the number of probing vectors to be used for the SLQ approximation of the log determinant <italic>n</italic><sub>rand</sub>, as well as tolerances corresponding to the REML criterion, parameter estimates, and the Lanczos residual norms. Convergence to a given tolerance on a sensible scale is ensured by optimizing with respect to the heritability <italic>h</italic><sup>2</sup>∈<italic>Θ</italic>⊆ [ 0,1] and evaluating the REML criterion at <italic>τ</italic>=(1−<italic>h</italic><sup>2</sup>)/<italic>h</italic><sup>2</sup>. The REML criterion can be repeatedly evaluated in <inline-formula id="IEq84"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {O}(n)$\end{document}</tex-math><mml:math id="M194"><mml:mi mathvariant="script">O</mml:mi><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq84.gif"/></alternatives></inline-formula> operations, making high accuracy computationally feasible.</p>
      </sec>
    </sec>
    <sec id="Sec19">
      <title>A first-order Monte Carlo REML algorithm</title>
      <p>We additionally propose the Lanczos first-order Monte Carlo residual maximum likelihood algorithm (L_FOMC_REML; Algorithm 4), which also takes advantage of the shifted structure of the standard genomic variance components model to speed computation. We first present the related first-order algorithm implemented in the efficient and widely-used BOLT-LMM software [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>], which we refer to as BOLT_LMM and of which the proposed L_FOMC_REML algorithm is a straightforward extension.</p>
      <sec id="Sec20">
        <title>BOLT_LMM (First-order Monte Carlo REML)</title>
        <p>The BOLT_LMM algorithm is based on the observation that at stationary points of the REML criterion (<xref rid="Equ3" ref-type="">3</xref>), the first-order REML conditions (i.e., ∇<italic>ℓ</italic>=0) imply that 
<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \mathbb{E}\left[\tilde{u}^{T}\tilde{u}\vert y\right] =\tilde{u}^{T}\tilde{u},\quad \mathbb{E}\left[\tilde{e}^{T}\tilde{e}\vert y\right] =\tilde{e}^{T}\tilde{e},  $$ \end{document}</tex-math><mml:math id="M196"><mml:mi mathvariant="double-struck">𝔼</mml:mi><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>ũ</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi>ũ</mml:mi><mml:mo>|</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>ũ</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi>ũ</mml:mi><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi mathvariant="double-struck">𝔼</mml:mi><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover><mml:mo>|</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12859_2019_2978_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>where <inline-formula id="IEq85"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {u}$\end{document}</tex-math><mml:math id="M198"><mml:mi>ũ</mml:mi></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq85.gif"/></alternatives></inline-formula> and <inline-formula id="IEq86"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {e}$\end{document}</tex-math><mml:math id="M200"><mml:mover accent="true"><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq86.gif"/></alternatives></inline-formula> are the best linear unbiased predictions (BLUPs) of the latent genetic effects and residuals, respectively [<xref ref-type="bibr" rid="CR25">25</xref>]. The BLUPs are functions of <italic>τ</italic> given by 
<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \tilde{u}(\tau)&amp;=m^{-1/2}Z^{T}S\acute{H}_{\tau}^{-1}Sy, \\ \tilde{e}(\tau)&amp;=\tau\acute{H}_{\tau}^{-1}Sy, \end{array} $$ \end{document}</tex-math><mml:math id="M202"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mi>ũ</mml:mi><mml:mo>(</mml:mo><mml:mi>τ</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi>S</mml:mi><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mo>´</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mtext mathvariant="italic">Sy</mml:mtext><mml:mo>,</mml:mo><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"><mml:mover accent="true"><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mi>τ</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:mi>τ</mml:mi><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mo>´</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mtext mathvariant="italic">Sy</mml:mtext><mml:mo>,</mml:mo><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2019_2978_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>where we have defined <inline-formula id="IEq87"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\acute {H}_{\tau }= \frac {1}{m}SZZ^{T}S+\tau I_{n}$\end{document}</tex-math><mml:math id="M204"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mo>´</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mfrac><mml:mtext mathvariant="italic">SZ</mml:mtext><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi>S</mml:mi><mml:mo>+</mml:mo><mml:mi>τ</mml:mi><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq87.gif"/></alternatives></inline-formula>. The expectations (<xref rid="Equ8" ref-type="">8</xref>) are approximated via the following stochastic procedure: Monte Carlo samples of the latent variables, <inline-formula id="IEq88"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\check {u}_{k}\stackrel {i.i.d}{\sim }\mathcal {MVN}(0,I_{m})$\end{document}</tex-math><mml:math id="M206"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mo>ˇ</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mover><mml:mrow><mml:mo>∼</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi>i.i.d</mml:mi></mml:mrow></mml:mrow></mml:mover><mml:mi mathvariant="script">ℳ</mml:mi><mml:mi mathvariant="script">V</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq88.gif"/></alternatives></inline-formula>, <inline-formula id="IEq89"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\check {e}_{k}\stackrel {i.i.d}{\sim }\mathcal {MVN}(0,S)$\end{document}</tex-math><mml:math id="M208"><mml:msub><mml:mrow><mml:mi>ě</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mover><mml:mrow><mml:mo>∼</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi>i.i.d</mml:mi></mml:mrow></mml:mrow></mml:mover><mml:mi mathvariant="script">ℳ</mml:mi><mml:mi mathvariant="script">V</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq89.gif"/></alternatives></inline-formula> are used to generate samples of the projected phenotype vector 
<disp-formula id="Equg"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\check{y}_{k} = m^{-1/2}SZ\check{u}_{k} + \check{e}_{k},\quad k=1,\ldots n_{\text{rand}}. $$ \end{document}</tex-math><mml:math id="M210"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>ˇ</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mtext mathvariant="italic">SZ</mml:mtext><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mo>ˇ</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ě</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext>rand</mml:mtext></mml:mrow></mml:msub><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2019_2978_Article_Equg.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>BLUPs are then computed as in (<xref rid="Equ9" ref-type="">9</xref>), yielding the approximations 
<disp-formula id="Equh"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \mathop{\mathbb{E}}_{\text{MC}}\left[\tilde{u}^{T}\tilde{u}\vert y\right] &amp;= \frac{n_{\text{rand}}^{-1}}{\sqrt{m}} \sum_{k=1}^{n_{\text{rand}}} \left\Vert Z^{T}S\acute{H}_{\tau}^{-1}S\check{y}_{k} \right\Vert^{2}, \\ \mathop{\mathbb{E}}_{\text{MC}}\left[\tilde{e}^{T}\tilde{e}\vert y\right] &amp;= n_{\text{rand}}^{-1} \sum_{k=1}^{n_{\text{rand}}} \left\Vert \tau\acute{H}_{\tau}^{-1}S\check{y}_{k} \right\Vert^{2}. \end{array} $$ \end{document}</tex-math><mml:math id="M212"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:msub><mml:mrow><mml:mo>𝔼</mml:mo></mml:mrow><mml:mrow><mml:mtext>MC</mml:mtext></mml:mrow></mml:msub><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>ũ</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi>ũ</mml:mi><mml:mo>|</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfenced></mml:mtd><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext>rand</mml:mtext></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext>rand</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mfenced close="∥" open="∥" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi>S</mml:mi><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mo>´</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi>S</mml:mi><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>ˇ</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"><mml:msub><mml:mrow><mml:mo>𝔼</mml:mo></mml:mrow><mml:mrow><mml:mtext>MC</mml:mtext></mml:mrow></mml:msub><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover><mml:mo>|</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfenced></mml:mtd><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext>rand</mml:mtext></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext>rand</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mfenced close="∥" open="∥" separators=""><mml:mrow><mml:mi>τ</mml:mi><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mo>´</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi>S</mml:mi><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>ˇ</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>.</mml:mi><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2019_2978_Article_Equh.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>Using the above expressions, Loh et al. [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>] apply a zeroth-order root-finding algorithm to the quantity 
<disp-formula id="Equi"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$f_{r}(\tau)= \ln \left[ \frac{\tilde{u}^{T}\tilde{u}}{\tilde{e}^{T}\tilde{e}} \right] - \ln \left[ \frac{\mathop{\mathbb{E}}_{\text{MC}}\left[\tilde{u}^{T}\tilde{u}\vert y\right]}{\mathop{\mathbb{E}}_{\text{MC}}\left[\tilde{e}^{T}\tilde{e}\vert y\right]} \right], $$ \end{document}</tex-math><mml:math id="M214"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>τ</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>ln</mml:mo><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>ũ</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi>ũ</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:mo>ln</mml:mo><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mo>𝔼</mml:mo></mml:mrow><mml:mrow><mml:mtext>MC</mml:mtext></mml:mrow></mml:msub><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>ũ</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi>ũ</mml:mi><mml:mo>|</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>𝔼</mml:mo></mml:mrow><mml:mrow><mml:mtext>MC</mml:mtext></mml:mrow></mml:msub><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover><mml:mo>|</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2019_2978_Article_Equi.gif" position="anchor"/></alternatives></disp-formula> noting that <italic>f</italic><sub><italic>r</italic></sub>=0 is a necessary condition (and, in practice, a sufficient condition) for (<xref rid="Equ8" ref-type="">8</xref>). Using CG to approximate solutions to the linear systems involved in BLUP computations results in an efficient REML estimation procedure involving <italic>O</italic>(<italic>n</italic>·<italic>m</italic>·<italic>n</italic><sub>rand</sub>) operations for well-conditioned covariance structures (i.e., for nontrivial non-heritable variance component values). As noted in [<xref ref-type="bibr" rid="CR8">8</xref>], implicit preconditioning of <italic>H</italic><sub>0</sub> can be achieved by including the first few right singular vectors of the genotype matrix (or eigenvectors of the GRM) as columns of the covariate matrix <italic>X</italic>.</p>
      </sec>
      <sec id="Sec21">
        <title>The L_FOMC_REML algorithm</title>
        <p>The BOLT_LMM algorithm described above involves solving <italic>n</italic><sub>rand</sub>+1 linear systems 
<disp-formula id="Equj"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\acute{H}_{\tau_{\ell}}^{-1}S\check{y},\ \acute{H}_{\tau_{\ell}}^{-1}S\check{y}_{1},\ \ldots,\ \acute{H}_{\tau_{\ell}}^{-1}S\check{y}_{n_{\text{rand}}}, $$ \end{document}</tex-math><mml:math id="M216"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mo>´</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi>S</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>ˇ</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mo>´</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi>S</mml:mi><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>ˇ</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mo>´</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi>S</mml:mi><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>ˇ</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext>rand</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2019_2978_Article_Equj.gif" position="anchor"/></alternatives></disp-formula> at each iteration of the optimization scheme in order to compute BLUPs of the latent variables for the observed phenotype vector and each of the Monte Carlo samples. However, each iteration involves spectral shifts of the left hand side of the form 
<disp-formula id="Equk"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\acute{H}_{\tau_{\ell+1}}^{-1}=\left(\acute{H}_{\tau_{\ell}}+\sigma I_{n}\right)^{-1},\quad \sigma=(\tau_{\ell+1}-\tau_{\ell}). $$ \end{document}</tex-math><mml:math id="M218"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mo>´</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mo>´</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>σ</mml:mi><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2019_2978_Article_Equk.gif" position="anchor"/></alternatives></disp-formula> As in the SLDF_REML algorithm, the underlying block Krylov subspace is invariant to these shifts (i.e., <inline-formula id="IEq90"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {K}_{m}\left (\acute {H}_{\tau },Y\right)=\mathcal {K}_{m}\left (\acute {H}_{\tau }+\sigma I,Y\right)$\end{document}</tex-math><mml:math id="M220"><mml:msub><mml:mrow><mml:mi mathvariant="script">K</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mo>´</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">K</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mo>´</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>σI</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq90.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq91"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$Y=\left [y\vert \check {y}_{1}\vert \cdots \vert \check {y}_{n_{\text {rand}}}\right ]$\end{document}</tex-math><mml:math id="M222"><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mi>y</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>ˇ</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>⋯</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mo>ˇ</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext>rand</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq91.gif"/></alternatives></inline-formula>). Thus, having performed the Lanczos process for an initial parameter value <italic>τ</italic><sub>0</sub>, we can use L_Solve (Algorithm 1) to obtain the block CG approximate solution <inline-formula id="IEq92"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X_{\sigma }^{(m)}\approx \acute {H}_{\tau +\sigma }^{-1}Y$\end{document}</tex-math><mml:math id="M224"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>≈</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mo>´</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>τ</mml:mi><mml:mo>+</mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi>Y</mml:mi></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq92.gif"/></alternatives></inline-formula> in <italic>O</italic>(<italic>n</italic>·<italic>n</italic><sub>rand</sub>) operations. We are thus able to avoid solving linear systems in all subsequent iterations, though the relatively small number of matrix-vector products involved in computing BLUPs for the latent genetic effects at each step are unavoidable. The requirement of the genotype matrix for computing (<xref rid="Equ9" ref-type="">9</xref>) prevents both L_FOMC_REML and BOLT_LMM from efficiently exploiting precomputed GRMs.</p>
      </sec>
    </sec>
    <sec id="Sec22">
      <title>Comparison of methods</title>
      <p>We compare theoretical and empirical properties of our proposed algorithms, SLDF_REML and L_FOMC_REML, to those of BOLT_LMM.</p>
      <sec id="Sec23">
        <title>Computational complexity</title>
        <p>In contrast to BOLT_LMM, the Lanczos-decomposition based algorithms we have proposed only need to perform the computationally demanding operations necessary to evaluate the REML criterion once. As such, we differentiate between <italic>overhead</italic> computations, which occur once and do not depend on the number of iterations needed to achieve convergence, and <italic>per-iteration</italic> computations, which are repeated until convergence of the optimization process (Table <xref rid="Tab1" ref-type="table">1</xref> and Fig. <xref rid="Fig2" ref-type="fig">2</xref>).</p>
        <p>The overhead computations of SLDF_REML are dominated by the need to construct bases for the <italic>n</italic><sub>rand</sub>+<italic>c</italic>+1 subspaces <inline-formula id="IEq93"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {K}(H_{0},[\check {v}_{1},\ldots,\check {v}_{n_{\text {rand}}},x_{1},\ldots,x_{c},y])$\end{document}</tex-math><mml:math id="M226"><mml:mi mathvariant="script">K</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mo>ˇ</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mo>ˇ</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext>rand</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>]</mml:mo><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq93.gif"/></alternatives></inline-formula>, and are thus <inline-formula id="IEq94"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {O}\left (n^{2}(n_{\text {rand}}+c)n_\kappa \right)$\end{document}</tex-math><mml:math id="M228"><mml:mi mathvariant="script">O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext>rand</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>κ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq94.gif"/></alternatives></inline-formula> when a precomputed GRM is available and <inline-formula id="IEq95"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {O}(2m\cdot n(n_{\text {rand}}+c)n_\kappa)$\end{document}</tex-math><mml:math id="M230"><mml:mi mathvariant="script">O</mml:mi><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mi>m</mml:mi><mml:mo>·</mml:mo><mml:mi>n</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext>rand</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>κ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq95.gif"/></alternatives></inline-formula> otherwise. Here, <italic>n</italic><sub><italic>κ</italic></sub> denotes the number of Lanczos iterations needed to achieve convergence at a pre-specified tolerance and increases with <inline-formula id="IEq96"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$h^{2}_{\max }$\end{document}</tex-math><mml:math id="M232"><mml:msubsup><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mo>max</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq96.gif"/></alternatives></inline-formula>. Subsequent iterations are dominated by the cost of solving <italic>c</italic>+1 shifted linear systems via L_Solve and are thus <inline-formula id="IEq97"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {O}(n\cdot c\cdot n_\kappa)$\end{document}</tex-math><mml:math id="M234"><mml:mi mathvariant="script">O</mml:mi><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>·</mml:mo><mml:mi>c</mml:mi><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>κ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq97.gif"/></alternatives></inline-formula>. The overhead computations in L_FOMC_REML are dominated by the Lanczos decompositions corresponding to the 2<italic>n</italic><sub>rand</sub>+1 seed systems, where the GRM is implicitly represented in terms of the standardized genotype matrix, and is thus <inline-formula id="IEq98"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {O}(4m\cdot n\cdot n_{\text {rand}} \cdot n_\kappa)$\end{document}</tex-math><mml:math id="M236"><mml:mi mathvariant="script">O</mml:mi><mml:mo>(</mml:mo><mml:mn>4</mml:mn><mml:mi>m</mml:mi><mml:mo>·</mml:mo><mml:mi>n</mml:mi><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext>rand</mml:mtext></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>κ</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq98.gif"/></alternatives></inline-formula>. Operations of equivalent complexity are needed at <italic>every</italic> iteration of BOLT_LMM.</p>
      </sec>
      <sec id="Sec24">
        <title>Numerical experiments</title>
        <p>We compared wall clock times for genomic variance component estimation for height in nested random subsets of 16,000, 32,000, 64,000, 128,000, and 256,000 unrelated <inline-formula id="IEq99"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$(\hat {\pi }&lt;.05)$\end{document}</tex-math><mml:math id="M238"><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>&lt;</mml:mo><mml:mi>.</mml:mi><mml:mn>05</mml:mn><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq99.gif"/></alternatives></inline-formula> European ancestry individuals from the widely used UK Biobank data set [<xref ref-type="bibr" rid="CR26">26</xref>]. All analyses included 24 covariates consisting of age, sex, and testing center and used hard-called genotypes from 330,723 array SNPs remaining after enforcing a 1% minor allele frequency cutoff. We compared SLDF_REML, with and without a precomputed GRM, to L_FOMC_REML which requires the genotype matrix. For the novel algorithms, absolute tolerances for the Lanczos iterations and the REML optimization procedure were set to 5e-5 and 1e-5, respectively. Additionally, we compared our interpreted Python 3.6 code to BOLT-LMM versions 2.1 and 2.3.3 (C++ code compiled against the Intel MKL and Boost libraries) [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR27">27</xref>, <xref ref-type="bibr" rid="CR28">28</xref>]. We ran each algorithm twenty times per condition, trimming away the two most extreme timings in each condition. Mirroring the default settings of the BOLT-LMM software packages, we set <italic>n</italic><sub>rand</sub>=15 across both of our proposed methods.</p>
        <p>Novel algorithms were implemented in the Python v3.6.5 computing environment [<xref ref-type="bibr" rid="CR9">9</xref>], using NumPy v1.14.3 and SciPy v1.1.0 compiled against the Intel Math Kernel Library v2018.0.2 [<xref ref-type="bibr" rid="CR28">28</xref>–<xref ref-type="bibr" rid="CR30">30</xref>]. Optimization was performed using SciPy’s implementation of Brent’s method, with convergence determined via absolute tolerance of the standardized genomic variance component <inline-formula id="IEq100"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {h}^{2}$\end{document}</tex-math><mml:math id="M240"><mml:msup><mml:mrow><mml:mi>ĥ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2019_2978_Article_IEq100.gif"/></alternatives></inline-formula>. Timing results (Table <xref rid="Tab2" ref-type="table">2</xref> and Figs. <xref rid="Fig3" ref-type="fig">3</xref> and <xref rid="Fig5" ref-type="fig">5</xref>) do not include time required to read genotypes into memory, or, when applicable, to compute GRMs, and reflect total running time on an Intel(R) Xeon(R) Gold 6130 CPU @ 2.10GHz with 32 physical cores and 1 terabyte of RAM. Timing experiments excluded methods with cubic time complexity, including GCTA, FaST-LMM, and GEMMA. Accuracy was assessed by comparing heritability estimates generated by the stochastic algorithms to those estimated via the direct, deterministic average-information Newton–Raphson algorithm as implemented in the GCTA software package v1.92.0b2 [<xref ref-type="bibr" rid="CR4">4</xref>] (Figs. <xref rid="Fig4" ref-type="fig">4</xref> and <xref rid="Fig5" ref-type="fig">5</xref>).</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional file</title>
    <sec id="Sec25">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2019_2978_MOESM1_ESM.pdf">
            <label>Additional file 1</label>
            <caption>
              <p>Proof of result used to efficiently compute the quadratic form (<xref rid="Equ7" ref-type="">7</xref>). (PDF 125 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>BLAS</term>
        <def>
          <p>Basic linear algebra subprogram</p>
        </def>
      </def-item>
      <def-item>
        <term>BLUP</term>
        <def>
          <p>Basic linear unbiased prediction</p>
        </def>
      </def-item>
      <def-item>
        <term>CG</term>
        <def>
          <p>Conjugate gradients method</p>
        </def>
      </def-item>
      <def-item>
        <term>GCTA</term>
        <def>
          <p>Genome-wide complex trait analysis [<xref ref-type="bibr" rid="CR4">4</xref>]</p>
        </def>
      </def-item>
      <def-item>
        <term>GRM</term>
        <def>
          <p>Genomic relatedness matrix</p>
        </def>
      </def-item>
      <def-item>
        <term>GWAS</term>
        <def>
          <p>Genome-wide association study</p>
        </def>
      </def-item>
      <def-item>
        <term>LMM</term>
        <def>
          <p>Linear mixed-effects model</p>
        </def>
      </def-item>
      <def-item>
        <term>REML</term>
        <def>
          <p>Residual maximum likelihood</p>
        </def>
      </def-item>
      <def-item>
        <term>SLQ</term>
        <def>
          <p>Stochastic Lanczos quadrature</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors wish to thank UK Biobank participants. Additionally, the authors thank Matthew C. Keller and Luke M. Evans for their thoughtful comments and provision of computational resources. Publication of this article was funded by the University of Colorado Boulder Libraries Open Access Fund.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>RB wrote the manuscript, developed the algorithms, wrote the code used in numerical experiments, and analyzed the data. SB supervised the project and contributed to the development of the algorithms and the writing of the manuscript. Both authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Richard Border was supported by a training grant from the National Institute of Mental Health (T32 MH016880) and by the Institute for Behavioral Genetics. Stephen Becker acknowledges funding by NSF grant DMS-1819251.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The UK Biobank data are available to qualified researchers via the UK Biobank Access Management System (<ext-link ext-link-type="uri" xlink:href="https://bbams.ndph.ox.ac.uk/ams">https://bbams.ndph.ox.ac.uk/ams</ext-link>). The code used in the numerical experiments is available on Github (<ext-link ext-link-type="uri" xlink:href="https://github.com/rborder/SL_REML">https://github.com/rborder/SL_REML</ext-link>).</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p>UK Biobank data collection procedures were approved by the UK Biobank Research Ethics Committee (reference 11/NW/0382).</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p>Not applicable.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zaitlen</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Goddard</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Visscher</surname>
            <given-names>PM</given-names>
          </name>
          <name>
            <surname>Price</surname>
            <given-names>AL</given-names>
          </name>
        </person-group>
        <article-title>Advantages and Pitfalls in the Application of Mixed Model Association Methods</article-title>
        <source>Nat Genet</source>
        <year>2014</year>
        <volume>46</volume>
        <issue>2</issue>
        <fpage>100</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.2876</pub-id>
        <pub-id pub-id-type="pmid">24473328</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <mixed-citation publication-type="other">Bates D, Mächler M, Bolker B, Walker S. Fitting Linear Mixed-Effects Models Using Lme4. 2014. arXiv preprint arXiv:14065823.</mixed-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Genome-Wide Efficient Mixed Model Analysis for Association Studies</article-title>
        <source>Nat Genet</source>
        <year>2012</year>
        <volume>44</volume>
        <issue>7</issue>
        <fpage>821</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.2310</pub-id>
        <pub-id pub-id-type="pmid">22706312</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Goddard</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Visscher</surname>
            <given-names>PM</given-names>
          </name>
        </person-group>
        <article-title>GCTA: A Tool for Genome-Wide Complex Trait Analysis</article-title>
        <source>Am J Hum Genet</source>
        <year>2011</year>
        <volume>88</volume>
        <issue>1</issue>
        <fpage>76</fpage>
        <lpage>82</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ajhg.2010.11.011</pub-id>
        <pub-id pub-id-type="pmid">21167468</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lippert</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Listgarten</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kadie</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Davidson</surname>
            <given-names>RI</given-names>
          </name>
          <name>
            <surname>Heckerman</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>FaST Linear Mixed Models for Genome-Wide Association Studies</article-title>
        <source>Nat Methods</source>
        <year>2011</year>
        <volume>8</volume>
        <issue>10</issue>
        <fpage>833</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1681</pub-id>
        <pub-id pub-id-type="pmid">21892150</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Efficient Multivariate Linear Mixed Model Algorithms for Genome-Wide Association Studies</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <issue>4</issue>
        <fpage>407</fpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2848</pub-id>
        <pub-id pub-id-type="pmid">24531419</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Loh</surname>
            <given-names>PR</given-names>
          </name>
          <name>
            <surname>Tucker</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Bulik-Sullivan</surname>
            <given-names>BK</given-names>
          </name>
          <name>
            <surname>Vilhjálmsson</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Finucane</surname>
            <given-names>HK</given-names>
          </name>
          <name>
            <surname>Salem</surname>
            <given-names>RM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Efficient Bayesian Mixed-Model Analysis Increases Association Power in Large Cohorts</article-title>
        <source>Nat Genet</source>
        <year>2015</year>
        <volume>47</volume>
        <issue>3</issue>
        <fpage>284</fpage>
        <lpage>90</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.3190</pub-id>
        <pub-id pub-id-type="pmid">25642633</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Loh</surname>
            <given-names>PR</given-names>
          </name>
          <name>
            <surname>Kichaev</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gazal</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schoech</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Price</surname>
            <given-names>AL</given-names>
          </name>
        </person-group>
        <article-title>Mixed-Model Association for Biobank-Scale Datasets</article-title>
        <source>Nat Genet</source>
        <year>2018</year>
        <volume>50</volume>
        <fpage>906</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-018-0144-6</pub-id>
        <pub-id pub-id-type="pmid">29892013</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <mixed-citation publication-type="other">Border R. Stochastic Lanczos Likelihood Estimation of Genomic Variance Components. Appl Math Grad Theses Dissertations. 2018;120.</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>de los</surname>
            <given-names>Campos</given-names>
          </name>
          <name>
            <surname>Vazquez</surname>
            <given-names>AI</given-names>
          </name>
          <name>
            <surname>Fernando</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Klimentidis</surname>
            <given-names>YC</given-names>
          </name>
          <name>
            <surname>Sorensen</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Prediction of Complex Human Traits Using the Genomic Best Linear Unbiased Predictor</article-title>
        <source>PLoS Genet</source>
        <year>2013</year>
        <volume>9</volume>
        <issue>7</issue>
        <fpage>e1003608</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1003608</pub-id>
        <pub-id pub-id-type="pmid">23874214</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Evans</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Tahmasbi</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Vrieze</surname>
            <given-names>SI</given-names>
          </name>
          <name>
            <surname>Abecasis</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Das</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gazal</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comparison of Methods That Use Whole Genome Data to Estimate the Heritability and Genetic Architecture of Complex Traits</article-title>
        <source>Nat Genet</source>
        <year>2018</year>
        <volume>50</volume>
        <issue>5</issue>
        <fpage>737</fpage>
        <lpage>45</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-018-0108-x</pub-id>
        <pub-id pub-id-type="pmid">29700474</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Searle</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Casella</surname>
            <given-names>G</given-names>
          </name>
          <collab>McCulloch CE</collab>
        </person-group>
        <source>Variance Components, vol. 391</source>
        <year>2009</year>
        <publisher-loc>United States</publisher-loc>
        <publisher-name>Wiley</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Graser</surname>
            <given-names>HU</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>SP</given-names>
          </name>
          <name>
            <surname>Tier</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>A Derivative-Free Approach for Estimating Variance Components in Animal Models by Restricted Maximum Likelihood</article-title>
        <source>J Anim Sci</source>
        <year>1987</year>
        <volume>64</volume>
        <issue>5</issue>
        <fpage>1362</fpage>
        <lpage>70</lpage>
        <pub-id pub-id-type="doi">10.2527/jas1987.6451362x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Björck</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <source>Numerical Methods in Matrix Computations, vol. 59</source>
        <year>2015</year>
        <publisher-loc>Switzerland</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Atkinson</surname>
            <given-names>KE</given-names>
          </name>
        </person-group>
        <source>An Introduction to Numerical Analysis</source>
        <year>2008</year>
        <publisher-loc>United Kingdom</publisher-loc>
        <publisher-name>Wiley</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’Leary</surname>
            <given-names>DP</given-names>
          </name>
        </person-group>
        <article-title>The Block Conjugate Gradient Algorithm and Related Methods</article-title>
        <source>Linear Algebra Appl</source>
        <year>1980</year>
        <volume>29</volume>
        <fpage>293</fpage>
        <lpage>322</lpage>
        <pub-id pub-id-type="doi">10.1016/0024-3795(80)90247-5</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frommer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Maass</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Fast CG-Based Methods for Tikhonov-Phillips Regularization</article-title>
        <source>SIAM J Sci Comput</source>
        <year>1999</year>
        <volume>20</volume>
        <issue>5</issue>
        <fpage>1831</fpage>
        <lpage>50</lpage>
        <pub-id pub-id-type="doi">10.1137/S1064827596313310</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <mixed-citation publication-type="other">Sogabe T. A Fast Numerical Method for Generalized Shifted Linear Systems with Complex Symmetric Matrices. Recent Dev Num Anal Num Comput Algoritm. 2010;:13.</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hutchinson</surname>
            <given-names>MF</given-names>
          </name>
        </person-group>
        <article-title>A Stochastic Estimator of the Trace of the Influence Matrix for Laplacian Smoothing Splines</article-title>
        <source>Commun Stat Simul Comput</source>
        <year>1990</year>
        <volume>19</volume>
        <issue>2</issue>
        <fpage>433</fpage>
        <lpage>50</lpage>
        <pub-id pub-id-type="doi">10.1080/03610919008812866</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Avron</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Toledo</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Randomized Algorithms for Estimating the Trace of an Implicit Symmetric Positive Semi-Definite Matrix</article-title>
        <source>J ACM</source>
        <year>2011</year>
        <volume>58</volume>
        <issue>2</issue>
        <fpage>8:1</fpage>
        <lpage>8:34</lpage>
        <pub-id pub-id-type="doi">10.1145/1944345.1944349</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Golub</surname>
            <given-names>GH</given-names>
          </name>
          <name>
            <surname>Matrices</surname>
            <given-names>MG</given-names>
          </name>
        </person-group>
        <source>Moments and Quadrature with Applications</source>
        <year>2009</year>
        <publisher-loc>Princeton</publisher-loc>
        <publisher-name>Princeton University Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ubaru</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Saad</surname>
            <given-names>Y.</given-names>
          </name>
        </person-group>
        <article-title>Fast Estimation of Tr(f(A)) via Stochastic Lanczos Quadrature</article-title>
        <source>SIAM J Matrix Anal Appl</source>
        <year>2017</year>
        <volume>38</volume>
        <issue>4</issue>
        <fpage>1075</fpage>
        <lpage>99</lpage>
        <pub-id pub-id-type="doi">10.1137/16M1104974</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <mixed-citation publication-type="other">Chen J, Saad Y. A Posteriori Error Estimate for Computing Tr(f(A)) by Using the Lanczos Method. 2018. arXiv:180204928 [math].</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <mixed-citation publication-type="other">Zhu S, Wathen AJ. Essential Formulae for Restricted Maximum Likelihood and Its Derivatives Associated with the Linear Mixed Models. 2018. arXiv:180505188 [stat].</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>McCulloch</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Searle</surname>
            <given-names>SR</given-names>
          </name>
          <collab>Neuhaus JM</collab>
        </person-group>
        <source>Generalized, Linear, and Mixed Models</source>
        <year>2008</year>
        <publisher-loc>Hoboken</publisher-loc>
        <publisher-name>Wiley</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sudlow</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gallacher</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Allen</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Beral</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Burton</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Danesh</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>UK Biobank: An Open Access Resource for Identifying the Causes of a Wide Range of Complex Diseases of Middle and Old Age</article-title>
        <source>PLoS Med</source>
        <year>2015</year>
        <volume>12</volume>
        <issue>3</issue>
        <fpage>e1001779</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pmed.1001779</pub-id>
        <pub-id pub-id-type="pmid">25826379</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Schling</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <source>The Boost C++ Libraries</source>
        <year>2011</year>
        <publisher-loc>USA</publisher-loc>
        <publisher-name>XML Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <mixed-citation publication-type="other">Wang E, Zhang Q, Shen B, Zhang G, Lu X, Wu Q, et al. Intel Math Kernel Library. In: High-Performance Computing on the Intel®Xeon Phi™. New York: 2014. p. 167–88.</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <mixed-citation publication-type="other">Oliphant T. NumPy: A Guide to NumPy. 2006.</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <mixed-citation publication-type="other">Jones E, Oliphant T, Peterson P, et al. SciPy: Open Source Scientific Tools for Python. 2001.</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Loh</surname>
            <given-names>PR</given-names>
          </name>
          <name>
            <surname>Bhatia</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gusev</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Finucane</surname>
            <given-names>HK</given-names>
          </name>
          <name>
            <surname>Bulik-Sullivan</surname>
            <given-names>BK</given-names>
          </name>
          <name>
            <surname>Pollack</surname>
            <given-names>SJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Contrasting Genetic Architectures of Schizophrenia and Other Complex Diseases Using Fast Variance Components Analysis</article-title>
        <source>Nat Genet</source>
        <year>2015</year>
        <volume>47</volume>
        <issue>12</issue>
        <fpage>1385</fpage>
        <lpage>92</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.3431</pub-id>
        <pub-id pub-id-type="pmid">26523775</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
