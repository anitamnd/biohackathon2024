<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">IUCrJ</journal-id>
    <journal-id journal-id-type="iso-abbrev">IUCrJ</journal-id>
    <journal-id journal-id-type="publisher-id">IUCrJ</journal-id>
    <journal-title-group>
      <journal-title>IUCrJ</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2052-2525</issn>
    <publisher>
      <publisher-name>International Union of Crystallography</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6126648</article-id>
    <article-id pub-id-type="publisher-id">jt5027</article-id>
    <article-id pub-id-type="doi">10.1107/S2052252518010552</article-id>
    <article-id pub-id-type="coden">IUCRAJ</article-id>
    <article-id pub-id-type="pii">S2052252518010552</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Papers</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Homology-based loop modeling yields more complete crystallographic protein structures</article-title>
      <alt-title>Homology-based loop modeling</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-2183-2901</contrib-id>
        <name>
          <surname>van Beusekom</surname>
          <given-names>Bart</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Joosten</surname>
          <given-names>Krista</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-9081-4707</contrib-id>
        <name>
          <surname>Hekkelman</surname>
          <given-names>Maarten L.</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-2323-2686</contrib-id>
        <name>
          <surname>Joosten</surname>
          <given-names>Robbie P.</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
        <xref ref-type="corresp" rid="cor">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-1151-6227</contrib-id>
        <name>
          <surname>Perrakis</surname>
          <given-names>Anastassis</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
        <xref ref-type="corresp" rid="cor">*</xref>
      </contrib>
      <aff id="a"><label>a</label>Department of Biochemistry, <institution>The Netherlands Cancer Institute</institution>, Plesmanlaan 121, Amsterdam 1066CX, <country>The Netherlands</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor">Correspondence e-mail: <email>r.joosten@nki.nl</email>, <email>a.perrakis@nki.nl</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>9</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>08</day>
      <month>8</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>08</day>
      <month>8</month>
      <year>2018</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>5</volume>
    <issue>Pt 5</issue>
    <issue-id pub-id-type="publisher-id">m180500</issue-id>
    <fpage>585</fpage>
    <lpage>594</lpage>
    <history>
      <date date-type="received">
        <day>18</day>
        <month>5</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>7</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© van Beusekom et al. 2018</copyright-statement>
      <copyright-year>2018</copyright-year>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0/uk/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution (CC-BY) Licence, which permits unrestricted
use, distribution, and reproduction in any medium, provided the original authors and source are cited.</license-p>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/">http://creativecommons.org/licenses/by/2.0/uk/</ali:license_ref>
      </license>
    </permissions>
    <self-uri xlink:href="https://doi.org/10.1107/S2052252518010552">A full version of this article is available from Crystallography Journals Online.</self-uri>
    <abstract abstract-type="toc">
      <p>Thousands of regions missing from existing protein structure models are completed using new methods based on homology.</p>
    </abstract>
    <abstract>
      <p>Inherent protein flexibility, poor or low-resolution diffraction data or poorly defined electron-density maps often inhibit the building of complete structural models during X-ray structure determination. However, recent advances in crystallographic refinement and model building often allow completion of previously missing parts. This paper presents algorithms that identify regions missing in a certain model but present in homologous structures in the Protein Data Bank (PDB), and ‘graft’ these regions of interest. These new regions are refined and validated in a fully automated procedure. Including these developments in the <italic>PDB-REDO</italic> pipeline has enabled the building of 24 962 missing loops in the PDB. The models and the automated procedures are publicly available through the PDB-REDO databank and webserver. More complete protein structure models enable a higher quality public archive but also a better understanding of protein function, better comparison between homologous structures and more complete data mining in structural bioinformatics projects.</p>
    </abstract>
    <kwd-group>
      <kwd>loop building</kwd>
      <kwd>structural re-building</kwd>
      <kwd>PDB-REDO</kwd>
      <kwd>model completion</kwd>
      <kwd>crystallography</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>Netherlands Organization for Scientific Research (NWO)</funding-source>
        <award-id>723.013.003</award-id>
        <principal-award-recipient>Robbie P. Joosten</principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>European Comission Horizon 2020 programme</funding-source>
        <award-id>675858</award-id>
        <award-id>653706</award-id>
        <principal-award-recipient>Anastassis Perrakis</principal-award-recipient>
        <principal-award-recipient>Anastassis Perrakis</principal-award-recipient>
      </award-group>
      <funding-statement>This work was funded by <funding-source>Netherlands Organization for Scientific Research (NWO)</funding-source> grant <award-id>723.013.003</award-id> to Robbie P. Joosten. <funding-source>European Comission Horizon 2020 programme</funding-source> grants <award-id>675858</award-id> and <award-id>653706</award-id>. </funding-statement>
    </funding-group>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="sec1">
    <label>1.</label>
    <title>Introduction   </title>
    <p>Protein structure models give direct and detailed insights into biochemistry (Lamb <italic>et al.</italic>, 2015<xref ref-type="bibr" rid="bb26"> ▸</xref>) and are therefore highly relevant to many areas of biology and biotechnology (Terwilliger &amp; Bricogne, 2014<xref ref-type="bibr" rid="bb37"> ▸</xref>). For decades, crystallography has been the leading technique in determining protein structure models (Berman <italic>et al.</italic>, 2014<xref ref-type="bibr" rid="bb2"> ▸</xref>) and to date, over 120 000 crystallographic structure models are available from the Protein Data Bank (PDB; Burley <italic>et al.</italic>, 2017<xref ref-type="bibr" rid="bb6"> ▸</xref>). It is important to realize that all structures are interpretations of the underlying experimental data (Lamb <italic>et al.</italic>, 2015<xref ref-type="bibr" rid="bb26"> ▸</xref>; Wlodawer <italic>et al.</italic>, 2013<xref ref-type="bibr" rid="bb42"> ▸</xref>) and the quality of a structure model should therefore be scrutinized by validation (Read <italic>et al.</italic>, 2011<xref ref-type="bibr" rid="bb33"> ▸</xref>; Richardson <italic>et al.</italic>, 2013<xref ref-type="bibr" rid="bb34"> ▸</xref>).</p>
    <p>Owing to numerous improvements in refinement and validation methods, the quality of protein structure models is continuously increasing (Read <italic>et al.</italic>, 2011<xref ref-type="bibr" rid="bb33"> ▸</xref>); however, the completeness of models is decreasing (Fig. 1<xref ref-type="fig" rid="fig1"> ▸</xref>). About 70% of all crystallographic protein structures have regions that are missing (Djinovic-Carugo &amp; Carugo, 2015<xref ref-type="bibr" rid="bb13"> ▸</xref>) and this percentage is increasing. Typically, but not necessarily, these missing regions are loops between helices and strands. Loops occupy a large conformational space and can therefore be missing as a result of intrinsic disorder, meaning they cannot be modeled reliably in a single conformation. However, there are many cases where the experimental data provide useful information on the loop conformation and hence many loops can be built into protein structure models. The term ‘loop’ will be used in this paper in its broader definition to denote a missing region of protein structure, regardless of secondary structure conformation.</p>
    <p>Missing protein regions or ‘loops’ are typically modeled towards the end of crystal structure determination. By that stage, all obvious features have typically been modeled, the electron-density maps have improved and it is possible to model the loops. Many programs are available for modeling loops either interactively (Emsley <italic>et al.</italic>, 2010<xref ref-type="bibr" rid="bb15"> ▸</xref>) or automatically (Terwilliger <italic>et al.</italic>, 2008<xref ref-type="bibr" rid="bb38"> ▸</xref>; Joosten <italic>et al.</italic>, 2008<xref ref-type="bibr" rid="bb19"> ▸</xref>; Cowtan, 2012<xref ref-type="bibr" rid="bb10"> ▸</xref>; Kleywegt &amp; Jones, 1998<xref ref-type="bibr" rid="bb24"> ▸</xref>; DePristo <italic>et al.</italic>, 2005<xref ref-type="bibr" rid="bb12"> ▸</xref>). Completing the protein structure by modeling all loops that can be modeled, has two advantages: locally, the density becomes unavailable for modeling erroneous structural features such as other parts of the protein (<italic>e.g.</italic> side chains), crystallization agents and water molecules; and globally, a correctly fitted loop will reduce the phase error and give an overall improvement of the electron-density maps. Available loop-building approaches rely on one form or another of conformational sampling that attempts to find the best-fitting conformation of the loops based on the local electron density and our general knowledge of protein structure.</p>
    <p>Building loops is often one of the most difficult, time-demanding and sometimes frustrating stages of crystallographic model building. If loops are too disordered to yield traceable electron density, they cannot be built and there is no problem. In many cases however, loops are sufficiently rigid to yield interpretable density. Typically, this electron density is not as clear as desired, which makes it challenging for crystallographers and model-building programs to model a loop in a realistic conformation. Whether this is eventually successful depends on many factors such as perseverance and skill of the crystallographer(s) and the algorithmic quality and ease-of-use of loop-building programs. Noteworthy are algorithms that attempt to interpret the electron density with multiple loop conformations (Burnley <italic>et al.</italic>, 2012<xref ref-type="bibr" rid="bb7"> ▸</xref>; Levin <italic>et al.</italic>, 2007<xref ref-type="bibr" rid="bb28"> ▸</xref>). Although there is little doubt that very often multiple conformations can better represent the experimental data, here we wanted to deal with the problem where a loop is not modeled at all despite strong experimental evidence that it can be modeled.</p>
    <p>Previously, we have developed algorithms to transfer information about homologous protein structures for obtaining geometric restraints for low-resolution refinement (van Beusekom <italic>et al.</italic>, 2018<xref ref-type="bibr" rid="bb4"> ▸</xref>). Here we exploit the relationship between homologous proteins for loop building. We reasoned that as highly similar (in terms of sequence) proteins have very similar structure, the conformation of a loop in one homologous structure can assist in identifying the loop location in another homologous structure that is being built. The presence of a loop in a homologous structure is also an indication that loop building is viable. If a region has not been modeled in any of the homologs, it is unlikely to be buildable in the new structure (provided there are many homologous models solved by different crystallographers), but if it is built at least once there is a good chance that the same region can be modeled in the structure in question. Of course there are exceptions to the similarity of homologous loops, as loops can adopt distinct conformations which are often of high significance for function: there are countless examples that describe loop motions associated with ligand interactions or a change in the context of different crystallographic contacts.</p>
    <p>It has already been shown for a set of 16 370 PDB structures (Le Gall <italic>et al.</italic>, 2007<xref ref-type="bibr" rid="bb27"> ▸</xref>) that although 92.2% of all crystallized residues were always ordered in all homologs and 4.4% were always disordered, 3.3% are ‘ambiguous’; these residues were modeled in at least one structure but disordered in other(s). Another survey (Zhang <italic>et al.</italic>, 2007<xref ref-type="bibr" rid="bb44"> ▸</xref>) observed that such regions, named ‘dual personality’ fragments, occur in 45% of sequence-identical structure groups. Of the ambiguous loop regions, 59% are predicted to be ordered by all three protein disorder predictors used in a third study (DeForte &amp; Uversky, 2016<xref ref-type="bibr" rid="bb11"> ▸</xref>). Thus, the increasing redundancy of homologs in the PDB, the increasing percentage of unmodeled residues (Fig. 1<xref ref-type="fig" rid="fig1"> ▸</xref>) and the disorder predictions for these regions, argue that using ‘dual personality’ regions between homologous structures is a viable strategy for increasing the completeness of protein structure models.</p>
    <p>We have therefore decided to develop a procedure for building loops in cases where a loop is available in other homologous structure(s). The implementation of these new ideas has taken place in the context of <italic>PDB-REDO</italic>, a procedure we are developing to (re-)refine and partially rebuild protein structure models, both retrospectively [by updating existing PDB entries (Joosten <italic>et al.</italic>, 2012<xref ref-type="bibr" rid="bb21"> ▸</xref>)] and proactively [our software is available as a webserver (Joosten <italic>et al.</italic>, 2014<xref ref-type="bibr" rid="bb22"> ▸</xref>) and for local installation]. As the PDB-REDO electron-density maps are often better than the original maps and can be simply recalculated from the PDB entries, incorporating this work in the PDB-REDO framework allows us to have the best possible maps for building and validation of the missing loops. For every structure in question, the missing loop is first identified, then built by grafting it from a homologous structure, refined to fit the electron-density map in real space, and finally validated against geometric criteria and the electron density. We have built and validated several thousands of loops missing from structures deposited in the PDB. Here we discuss the methods and show some examples where our procedure makes a notable difference in the structure model.</p>
  </sec>
  <sec id="sec2">
    <label>2.</label>
    <title>Methods   </title>
    <sec id="sec2.1">
      <label>2.1.</label>
      <title>Loop building   </title>
      <p>We have developed algorithms to transfer loops from homologous protein structures to the target structure (Fig. 2<xref ref-type="fig" rid="fig2"> ▸</xref>). The manner of handling the homologs in <italic>Loopwhole</italic> is nearly identical to our previous program <italic>HODER</italic> (Beusekom <italic>et al.</italic>, 2018<xref ref-type="bibr" rid="bb4"> ▸</xref>), which generates homology-based hydrogen-bond restraints. The only difference is that homologs are not filtered by resolution in <italic>Loopwhole</italic>. The default maximum length for attempted loop transfer is 30 amino acids.</p>
      <p>Before any loop building is attempted, the density fit per chain is evaluated with <italic>EDSTATS</italic> (Tickle, 2012<xref ref-type="bibr" rid="bb39"> ▸</xref>). In the rare case that the real-space correlation coefficient (RSCC) for an entire chain is below 0.80, we do not attempt to build loops in that chain, but instead warn the user that the density fit is low making the overall chain conformation unreliable.</p>
      <p>There are two initial requirements for loop transfer: the presence of unmodeled loops in the input structure and modeled equivalent loops in the homologs. Unmodeled loops are detected using <italic>pdb2fasta</italic> in <italic>PDB-REDO</italic> and high-identity homologs are aligned by sequence. The details of these algorithms have been described earlier (van Beusekom <italic>et al.</italic>, 2018<xref ref-type="bibr" rid="bb4"> ▸</xref>). If both requirements are met, loop transfer is attempted for each of the homologs that has a complete backbone model for that homolog. Both input model and homolog are required to have at least five consecutive modeled residues on each side of the loop. Of these ten residues, the two residues directly adjacent to the loop are remodeled together with the loop because they were often found to be in a suboptimal conformation. The remaining eight residues are used for alignment. To prepare residues for the alignment, side-chain atoms are deleted when mutations are present, and administrative flips for Asp, Glu, Phe and Tyr residues (DEFY flips) are performed to ensure equivalent atoms are in equivalent positions. A homolog is skipped if the sequence identity in the loop or the aligned residues is less than 50%; the exception is a single-residue loop, which is allowed to be mutated. Finally, structural alignment is performed using quaternions (Kuipers, 2002<xref ref-type="bibr" rid="bb25"> ▸</xref>).</p>
      <p>If the backbone RMSD of alignment is less than 2.0 Å (in default settings), an initial loop transfer is performed. The two residues directly adjacent to the loop are deleted and the aligned loop, including the two aligned and directly adjacent residues, is inserted into the protein model. In the transferred loop, side chains are cropped where appropriate in the case of mutations, the occupancy of all atoms is set to 1.00 and the <italic>B</italic> factor is multiplied for each atom by the ratio of average <italic>B</italic> factors between input structure and homolog. Me­thio­nine is mutated to seleno­methio­nine and <italic>vice versa</italic> based on the other residues present in the input model.</p>
      <p>The next check for the initial transfer of a loop is the evaluation of clashes with the modeled atoms already present, or with symmetry copies thereof. We make a distinction between main-chain and side-chain atom clashes. Since the position of a C<sup>β</sup> is significantly limited by the main-chain conformation, we include this side-chain atom in the main chain for clash analysis. Heavy clashes are defined as atom–atom distances &lt;2.1 Å and small clashes as &lt;2.6 Å.</p>
      <p>In cases of clashes, important atom(s) must be retained. In <italic>Loopwhole</italic> we use hierarchical rules of atom importance to decide how to proceed. The atoms that are always kept are main-chain atoms and most ligands [the exceptions are glycerol, ethanol, and 1,2-ethane­diol and its polymeric (PEG) forms]. Whenever a main-chain atom from a loop candidate clashes with the previously modeled backbone or most ligands, the loop candidate is discarded. In contrast, if the main chain of a loop candidate clashes with a compound from the list of exceptions (such as glycerol), that compound is discarded. The second most important group is the side chains: they can be discarded temporarily to be added back later by the program <italic>SideAide</italic> (Joosten <italic>et al.</italic>, 2011<xref ref-type="bibr" rid="bb20"> ▸</xref>). Previously modeled side chains are considered more important than loop side chains. Side chains, in turn, are considered more important than water molecules and any atoms with an occupancy of 0.01 or lower. These principles led to the following decisions.</p>
      <p>Previously modeled side chains are removed only if they clash heavily with the loop backbone, unless they form a cysteine bridge: in such cases the loop candidate is discarded. Loop side chains [from γ-atom(s) onwards] are deleted if they clash heavily with any previously modeled protein (main chain or side chain) or with any other compound except for water. Ligands from the exception list are removed whenever they clash heavily with the main chain of the loop. Waters and atoms with an occupancy of 0.01 or less are removed even in cases of small clashes with any loop atom.</p>
      <p>If there are no insuperable clashes, the loop candidate is saved and existing candidates are sorted according to RMSD. If two loop candidates have a very similar conformation (RMSD &lt; 0.1 Å), the candidate with the worst RMSD of alignment is discarded. Once all <italic>BLAST</italic> hits are evaluated, the top candidates (by default, the top ten) are subjected to real-space refinement by <italic>coot-mini-rsr</italic> (Emsley <italic>et al.</italic>, 2010<xref ref-type="bibr" rid="bb15"> ▸</xref>) using torsion-angle restraints. One extra residue from the existing protein on either side of the loop is added to the real-space refinement region, which allows the existing protein model to better adapt to the new loop. In the <italic>coot-mini-rsr</italic> input PDB file, clashing atoms are removed, atom numbering is updated (including CONECT records) and ‘gap’ LINK records are deleted. Sometimes, there are still small gaps at the boundary of the transferred loop and the existing model. To increase the success rate of <italic>coot-mini-rsr</italic> closing these gaps, the backbone N atoms on the loop edges are moved into this gap. This can temporarily create unlikely atom bond lengths and angles, but these will be resolved in real-space refinement (or in the subsequent reciprocal-space refinement).</p>
      <p>After running <italic>coot-mini-rsr</italic>, it is checked again to confirm whether there are no insuperable clashes between the loop and the protein, because we have observed that the loop may be placed into the density of other moieties in the real-space refinement, such as a symmetry copy of itself.</p>
      <p>At this stage, all remaining loop candidates with bad geometry are discarded. First, candidates where there is no peptide bond between two consecutive residues or where <italic>coot-mini-rsr</italic> has not converged to a minimum are removed. The resulting RMS <italic>Z</italic> scores from <italic>coot-mini-rsr</italic> are used to filter bad geometry candidates: loops are rejected if bond or angle RMS <italic>Z</italic> values exceed 1.2, chirality RMS <italic>Z</italic> exceeds 1.5, or if plane or torsion RMS <italic>Z</italic> values exceed 2.0. In this filter, the RMS <italic>Z</italic> values are allowed to be relatively high because subsequent reciprocal-space refinement will further improve the loop. Loop candidates are only allowed to have <italic>cis</italic>-peptides if the corresponding residue in the original loop of the homolog is also a <italic>cis</italic>-peptide. Loops that have multiple sequential distorted omega angles (maximum deviation 30° from 0 or 180°) are discarded, but single distortions are allowed as these are usually resolved in subsequent refinement. Finally, loop candidates are evaluated on their Ramachandran <italic>Z</italic> score. If the <italic>Z</italic> score is poor (lower than −5), it is compared with the <italic>Z</italic> scores of the other loop candidates and also the <italic>Z</italic> scores of the loop in the homologous-structure models from which it was adapted. Then, the candidate is discarded if it is a 2σ negative outlier [according to Grubbs’ test (Grubbs, 1950<xref ref-type="bibr" rid="bb16"> ▸</xref>)], either compared with the other loop candidates or with the original conformation of the loop. The Ramachandran <italic>Z</italic>-score calculation is performed using the algorithms of the new <italic>PDB-REDO</italic> program <italic>tortoize</italic>. This algorithm is based on the implementation in <italic>WHAT_CHECK</italic> (Hooft <italic>et al.</italic>, 1997<xref ref-type="bibr" rid="bb18"> ▸</xref>) and is described in the <ext-link ext-link-type="uri" xlink:href="#suppinfoanchor">Supporting Information</ext-link>.</p>
      <p>The density for each remaining candidate is then computed using the cubic interpolation function from <italic>clipper</italic> (Cowtan, 2003<xref ref-type="bibr" rid="bb9"> ▸</xref>). It is computed only for the main-chain atoms of the candidate loop to ensure that the metric is not influenced by the presence, absence or length of the side chains of the loop. Additionally, the density is computed for all main-chain atoms that are ordered in all homologs, <italic>i.e.</italic> the set of atoms that are always ordered. If there are fewer than 30 atoms in this set, all non-loop main-chain atoms in the input structure model are taken. The ratio between average loop-candidate density and the average density of the control set is then computed. This ratio must be over 0.25 for a loop candidate to be acceptable. The cut-off was established after manual inspection of several hundred candidate loops.</p>
      <p>Finally, there is an option to subject a number of candidates (by default only the loop with the best density fit) to the <italic>PDB-REDO</italic> programs <italic>SideAide</italic> and <italic>pepflip</italic> (Joosten <italic>et al.</italic>, 2011<xref ref-type="bibr" rid="bb20"> ▸</xref>) to complete the side chains and check for potential peptide flips of the loop area. However, this is not default behavior since these programs are already run after <italic>Loopwhole</italic> in the <italic>PDB-REDO</italic> implementation. However, <italic>Loopwhole</italic> writes a list of amino acids whose side chains are incomplete: at low resolution, <italic>SideAide</italic> is not run by default on all amino acids in <italic>PDB-REDO</italic>, but only on amino acids in a list, to which the novel residues in the loop are added.</p>
      <p>After the optional running of <italic>SideAide</italic> and <italic>pepflip</italic>, the loop with the best main-chain density fit is kept.</p>
      <p>There are a few special cases where detection or building of a missing loop is more complicated. First, there is the possibility that a loop is in fact modeled, but with all atoms modeled at zero occupancy or at an occupancy of 0.01. We consider such loops as unmodeled and proceed as described above; however, we treat the current zero-occupancy loop itself as an extra candidate. Since this loop is already at the correct location in the model, no alignment is necessary; aside from this, the candidate is treated the same as others.</p>
      <p>Another special case is dealing with alternates in and near loops. If there are any main-chain alternates among the residues that are to be aligned with homologs, the missing loop is skipped because the alignment target is ambiguous. An exception is made if the only backbone alternate atoms are C<sup>α</sup> atoms (which is common for residues with alternate side-chain conformations); then simply the first atom is picked. In such cases, the positions of alternate C<sup>α</sup> atoms are very close to each other. Alternate side chains are truncated before alignment. In homologs, backbone alternate conformations are treated as separate candidates: structure alignment is performed for each alternate in the homolog and/or each alternate loop is transplanted. If there are multiple stretches that contain alternates with full occupancy atoms in between, combinations of these alternates must be aligned for completeness and the exponential increase of combinations makes computation expensive, hence these (rare) cases are excluded.</p>
      <p>Finally, there are cases where residues next to a loop are only partially present. In such cases, the partially modeled residue is also removed before the loop fitting. That is, the loop is extended by one more residue and the partial residue is replaced.</p>
    </sec>
    <sec id="sec2.2">
      <label>2.2.</label>
      <title>Adding missing atoms, atom pairs or atom trios: <italic>fixDMC</italic>   </title>
      <p>We observed that some protein models are missing one or several atoms from a peptide backbone. In order to also correct these smaller missing parts, the program <italic>fixDMC (fix ‘dat’ main chain)</italic> corrects these omissions, adds missing C-terminal O atoms, and resets occupancies to 1.0 in regions where there are no alternates and surrounding atoms are modeled at full occupancy.</p>
      <p>We make use of the fact that C<sup>α<italic>i</italic></sup>, C<sup><italic>i</italic></sup>, O<sup><italic>i</italic></sup>, N<sup><italic>i</italic></sup> and C<sup>α<italic>i</italic>+1</sup> lie in a plane. Whenever at least three atoms of a single plane are present, this planarity combined with the known geometry of an amino acid gives enough information to compute its coordinates. The C<sup>α</sup> atom lies in two planes: that of the preceding and the following amino-acid residues. Therefore, it can be added based on either of these residues. By applying the geometrical rules of planarity extensively, we can compute any set of one, two or three atoms provided that the preceding and following residues are modeled.</p>
      <p>Additionally, <italic>fixDMC</italic> uses functionality from <italic>pdb2fasta</italic> in <italic>PDB-REDO</italic> (van Beusekom <italic>et al.</italic>, 2018<xref ref-type="bibr" rid="bb4"> ▸</xref>) to add the second C-terminal O (‘OXT’) if the SEQRES records or user-inputted FASTA file indicate that the complete C-terminal residue has been modeled except for this atom. The addition of this atom can also be based on the peptide plane.</p>
      <p>Finally, the occupancy of protein atoms is reset to full occupancy if the residue contains no alternates, and the preceding and subsequent atoms are both modeled at full occupancy. An exception is made for the carbonyl O atom: since this atom is only bound to a single C atom, only that C atom is required to be modeled at full occupancy.</p>
    </sec>
    <sec id="sec2.3">
      <label>2.3.</label>
      <title>Implementation in <italic>PDB-REDO</italic>   </title>
      <p>The program <italic>fixDMC</italic> is run at the early stages of <italic>PDB-REDO</italic> after the initial electron-density maps are calculated, before any individual atomic coordinate or <italic>B</italic> factor refinement. The OXT atoms are only added if you can rely on the fact that the final modeled residue is the actual C-terminus of the crystallized construct. Therefore, this step is only performed if the header of the input PDB file has SEQRES records or if user-supplied sequence(s) can be mapped to the modeled atomic coordinates.</p>
      <p><italic>Loopwhole</italic> is run after the initial refinement in <italic>PDB-REDO</italic>. The default behavior is to always attempt to build loops, but this can be switched off if needed. It should be noted that on the PDB-REDO webserver, loops can only be built if the sequence of the missing residues is known. That is, users must supply the sequence as a FASTA file or as SEQRES records in the PDB file. If <italic>Loopwhole</italic> builds any residues, <italic>REFMAC5</italic> (Murshudov <italic>et al.</italic>, 2011<xref ref-type="bibr" rid="bb32"> ▸</xref>) is run to obtain more accurate <italic>B</italic> factor estimates and new electron-density map coefficients. This refinement uses automated geometric restraint weighting and five refinement cycles; if a loop has an RSCC below 0.60, it is discarded and any water molecules or other compounds initially deleted to fit the loop are restored. Then the other rebuilding stages of <italic>PDB-REDO</italic> (Joosten <italic>et al.</italic>, 2011<xref ref-type="bibr" rid="bb20"> ▸</xref>) are run.</p>
      <p>Sequence files in <italic>PDB-REDO</italic> mark residues with a complete backbone in uppercase letters and incomplete or unmodeled residues with lowercase letters (van Beusekom <italic>et al.</italic>, 2018<xref ref-type="bibr" rid="bb4"> ▸</xref>), an idea adopted from the SEQATOMS server (Brandt <italic>et al.</italic>, 2008<xref ref-type="bibr" rid="bb5"> ▸</xref>). Therefore, both <italic>Loopwhole</italic> and <italic>fixDMC</italic> write updated FASTA files to reflect changes in residue completeness or presence. Additionally, <italic>Loopwhole</italic> updates the TLS groups in <italic>PDB-REDO</italic>. If a TLS group is surrounding the loop, the loop is added to that group; if the loop is on the border of two TLS groups, it is added to the first one.</p>
      <p>At the final stage of <italic>PDB-REDO</italic>, the program <italic>Modelcompare</italic> writes a datafile that is used by <italic>Coot</italic> (Emsley <italic>et al.</italic>, 2010<xref ref-type="bibr" rid="bb15"> ▸</xref>) and <italic>3Dbionotes</italic> (Segura <italic>et al.</italic>, 2017<xref ref-type="bibr" rid="bb35"> ▸</xref>; Tabas-Madrid <italic>et al.</italic>, 2016<xref ref-type="bibr" rid="bb36"> ▸</xref>) to highlight the new loops.</p>
    </sec>
    <sec id="sec2.4">
      <label>2.4.</label>
      <title>Testing   </title>
      <p><italic>Loopwhole</italic> was run over all entries available in PDB-REDO to identify which loops could be built. Hundreds of randomly selected loops were manually analyzed to empirically establish the validation cut-offs mentioned above. Finally, from all entries in which <italic>Loopwhole</italic> built loops, 2000 entries were randomly selected for further analysis in PDB-REDO. These entries were subjected to the <italic>PDB-REDO</italic> pipeline twice: once with and once without loop building. Owing to various limitations (not related to loop building), ten <italic>PDB-REDO</italic> jobs were not completed, hence the final test set consisted of 1990 entries.</p>
    </sec>
  </sec>
  <sec id="sec3">
    <label>3.</label>
    <title>Results   </title>
    <sec id="sec3.1">
      <label>3.1.</label>
      <title>Loop building   </title>
      <p>The computer program <italic>Loopwhole</italic> was developed to build protein loops based on homology (Fig. 2<xref ref-type="fig" rid="fig2"> ▸</xref>). We first applied <italic>Loopwhole</italic> to the structures available in the PDB (Table 1<xref ref-type="table" rid="table1"> ▸</xref>). When <italic>Loopwhole</italic> was then applied to the PDB-REDO databank, we observed an increase of 11% in the number of built loops. This is likely to be because the structure models and the electron-density maps in PDB-REDO (which are obtained after modern re-refinement and rebuilding) are of higher quality than their ‘static’ PDB counterparts. The total number of missing loops in the PDB-REDO databank was 148 919. An initial loop was constructed by <italic>Loopwhole</italic> in 66 035 cases (44%). For the other 56%, there were either no homologous loops available, or the loop conformation was too different between the ‘donor’ and ‘acceptor’ structures as a result of genuine structural differences, or because of ‘sequence register’ errors. Another 41 073 loops (28% of total) were discarded according to various validation criteria (Fig. 3<xref ref-type="fig" rid="fig3"> ▸</xref>), keeping 24 962 successfully built loops in the final model. Many loops were rejected as their fit to the electron density was too poor (Fig. 3<xref ref-type="fig" rid="fig3"> ▸</xref>
<italic>b</italic>), and less often based on geometrical criteria or because both density fit and geometry were poor. The remaining loops have excellent geometry, typically better than the loop in the original structure (Fig. 3<xref ref-type="fig" rid="fig3"> ▸</xref>
<italic>c</italic>) and a good fit to the density.</p>
      <p>The current version of <italic>Loopwhole</italic> was able to build a total of 24 962 missing loops in 11 571 entries. For 359 cases in which a loop was built, a zero-occupancy loop was present in the original model. To place the loops, 18 449 water molecules were removed; additionally, small molecules such as glycerol or ethane­diol were removed in 22 cases. The distribution of the length of the built loops is shown in Fig. 3<xref ref-type="fig" rid="fig3"> ▸</xref>(<italic>a</italic>).</p>
      <p>Next, we examined whether incorporating <italic>Loopwhole</italic> in the <italic>PDB-REDO</italic> pipeline had an impact on the performance of <italic>PDB-REDO</italic> as a whole. We thus ran <italic>PDB-REDO</italic> on 1990 randomly selected structures in which loops could be built, once with and once without loop building. The impact of loop building on standard validation metrics (Read <italic>et al.</italic>, 2011<xref ref-type="bibr" rid="bb33"> ▸</xref>) such as <italic>R</italic>
<sub>free</sub>, the Ramachandran <italic>Z</italic> score and packing <italic>Z</italic> score was minimal (Fig. S1). The mean RSCC values (indicating the fit to the density) correlate well with the mean <italic>B</italic> factor for the loops in most cases (Fig. S2). The mean RSCC and RSR values for the loops themselves were 0.75 and 0.14, respectively (Fig. 4<xref ref-type="fig" rid="fig4"> ▸</xref>). These values are naturally lower than for well defined parts of the structure model, but are for example, consistent with density criteria for acceptable ligands (Weichenberger <italic>et al.</italic>, 2013<xref ref-type="bibr" rid="bb41"> ▸</xref>; Cereto-Massagué <italic>et al.</italic>, 2013<xref ref-type="bibr" rid="bb8"> ▸</xref>; Warren <italic>et al.</italic>, 2012<xref ref-type="bibr" rid="bb40"> ▸</xref>). However, some built loops had lower than anticipated RSCC values. Following manual examination of example cases, we decided to discard loops with an RSCC below 0.60 (Fig. 4<xref ref-type="fig" rid="fig4"> ▸</xref>). Of the 3419 loops built in the test set, 305 loops were discarded in this step, yielding a total of 3114 loops built in the test entries. We then manually inspected examples of loops that passed the RSCC cutoff, but had density ratios between the cut-off value of 0.25 and 0.3. We concluded that these ‘lowest-quality’ loops still fit the density well and should be kept in the model; six randomly selected examples are shown in Fig. 5<xref ref-type="fig" rid="fig5"> ▸</xref>. Thus, loop building in <italic>PDB-REDO</italic> has now been enabled by default. For practical reasons (lack of CPU time) the remaining PDB entries are being gradually ‘redone’ and placed in the PDB-REDO databank.</p>
    </sec>
    <sec id="sec3.2">
      <label>3.2.</label>
      <title>Completing the main chain   </title>
      <p>Rather surprisingly, we found that many structures in the PDB are missing individual atoms in the main chain. Therefore, we created the program <italic>fixDMC</italic> that can add one to three missing main-chain atoms based on the geometry of the existing atoms (see §2<xref ref-type="sec" rid="sec2"/> for details). Running it in the same PDB-REDO dataset as above, single atoms were added in 1500 cases (of which, 1281 were carbonyl O atoms), atom pairs were added in 55 cases and in 40 residues three atoms were added. Additionally, there were 38 101 cases with individual backbone atoms that had their occupancies set to values less than 1.00 without being part of an alternate conformation or of a partially occupied peptide ligand, out of which, 2926 cases had an occupancy of zero. Finally, we found that the second C-terminal O atom (OXT in PDB nomenclature) is missing in many PDB entries; <italic>fixDMC</italic> added OXTs to 41 120 protein chains, where the terminal residue in the structure coincides with the terminal residue in the declared construct sequence. Notably, the percentage of protein chains with missing C-terminal O atoms has been steadily increasing over the years (Fig. 6<xref ref-type="fig" rid="fig6"> ▸</xref>). In 2017, OXT is missing from 44% of chains with a modeled C-terminal amino acid.</p>
    </sec>
    <sec id="sec3.3">
      <label>3.3.</label>
      <title>Examples of built loops   </title>
      <p>To illustrate the relevance of building loops in the PDB, here we show several examples in which <italic>Loopwhole</italic> clearly improves structure interpretation.</p>
      <p>First, a structure of β-glucosidase (PDB entry <ext-link ext-link-type="uri" xlink:href="http://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=3abz">3abz</ext-link>; Yoshida <italic>et al.</italic>, 2010<xref ref-type="bibr" rid="bb43"> ▸</xref>) has seven missing regions, five of which can be added. Only the first of four NCS copies is complete. One of the missing regions, a stretch of 14 residues, is shown in Fig. 7<xref ref-type="fig" rid="fig7"> ▸</xref>(<italic>a</italic>). The electron density for this loop is very clear. By adding the loops to the structure, the structure model is now much more complete and thus more easily interpreted.</p>
      <p>A second example shows how the general improvement of fit to the crystallographic data in PDB-REDO can facilitate when loop building is included. As shown in Fig. 7<xref ref-type="fig" rid="fig7"> ▸</xref>(<italic>b</italic>), a strand is missing from the β-sheet of the α3 subunit of HLA in PDB entry <ext-link ext-link-type="uri" xlink:href="http://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=5iro">5iro</ext-link> (Li <italic>et al.</italic>, 2016<xref ref-type="bibr" rid="bb29"> ▸</xref>), a protein complex of Adenovirus type 4 E3-19K with HLA class I histocompatibility antigen. By optimization of the structure model by <italic>PDB-REDO</italic> including loop building, the <italic>R</italic>/<italic>R</italic>
<sub>free</sub> drops from 0.220/0.236 to 0.182/0.190. The overall improvement of the model leads to much clearer maps into which the missing strand can be built unequivocally.</p>
      <p>Finally, two loops are missing from PDB entry <ext-link ext-link-type="uri" xlink:href="http://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=2amj">2amj</ext-link>, the apo-structure model of modulator of drug activity B (MdaB), a putative DT-diaphorase (Adams &amp; Jia, 2006<xref ref-type="bibr" rid="bb1"> ▸</xref>). In this paper, the authors also discuss the FAD-bound state structure (<ext-link ext-link-type="uri" xlink:href="http://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=2b3d">2b3d</ext-link>; Adams &amp; Jia, 2006<xref ref-type="bibr" rid="bb1"> ▸</xref>), where both loops are ordered: it is stated, that these loops become ordered upon binding of FAD as a result of the rearrangement in the hydrogen-bonding network. However, there is clear density for one of the loops (L2). No less than 13 water molecules have been built into the density of the missing loop in chain D (Fig. 7<xref ref-type="fig" rid="fig7"> ▸</xref>
<italic>c</italic>). It was proposed (Adams &amp; Jia, 2006<xref ref-type="bibr" rid="bb1"> ▸</xref>) that FAD binding induces loop stabilization through changes in the hydrogen-bonding network; modeling this loop shows that the structure model of the apo-form and FAD-bound form are highly similar. Therefore, the structural evidence does not necessarily support this claim.</p>
    </sec>
  </sec>
  <sec id="sec4">
    <label>4.</label>
    <title>Discussion   </title>
    <p>The increasing number of residues that are not built into new protein structures can be attributed to many factors: the ever larger structures determined by X-ray crystallography (van Beusekom <italic>et al.</italic>, 2016<xref ref-type="bibr" rid="bb3"> ▸</xref>) are more likely to contain flexible regions within stable scaffolds; better annotation of the sequence of crystallized constructs (Henrick <italic>et al.</italic>, 2008<xref ref-type="bibr" rid="bb17"> ▸</xref>; Dutta <italic>et al.</italic>, 2009<xref ref-type="bibr" rid="bb14"> ▸</xref>) highlights missing regions better; and opportunities to built loops supported by the electron density are ignored because of haste or lack of experience (Mowbray <italic>et al.</italic>, 1999<xref ref-type="bibr" rid="bb31"> ▸</xref>) as new generations of crystallographers are determining structures with a higher throughput. A worrying observation we made whilst teaching is that some students had deleted parts of a model to improve validation statistics (Read <italic>et al.</italic>, 2011<xref ref-type="bibr" rid="bb33"> ▸</xref>) such as the percentage of RSR <italic>Z</italic> outliers.</p>
    <p>It is generally accepted that loops with a less defined electron density occur in multiple conformations. In many cases, a single model with a sufficiently large margin of error represented in the <italic>B</italic> factors is suitable to represent the experimental data. There may be cases where more than one discrete loop could be modeled. At present in such cases, we build a single conformation for these loops. Though an extension towards building multiple conformations of such loops is possible, existing solutions could be used to explicitly model this conformational variability (<italic>e.g.</italic> Burnley <italic>et al.</italic>, 2012<xref ref-type="bibr" rid="bb7"> ▸</xref>; Levin <italic>et al.</italic>, 2007<xref ref-type="bibr" rid="bb28"> ▸</xref>).</p>
    <p>We argue that models should be built as complete as possible given the data, because high completeness will increase their usefulness to the user community. For instance, simulations of protein-complex formation might improve when the protein structure model is as complete (and correct) as possible: it is better to have a starting experimental conformation available even if supported only by weak electron density, rather than predicting by purely computational methods. Also, the presence of loops in the refinement improves the local-structure quality of the loop surroundings because the added atoms impose better conformational restraints in the structural neighborhood.</p>
    <p>In some instances, our methods were unable to build a missing loop in an area with relatively clear electron density. This had to do with either the lack of well aligned homologous loops or the poor geometry of the fitted fragments. In some cases, this could point to register errors (a few residues aligned erroneously onto the sequence). Better comparison between homologous structures, for instance, using tools like <italic>phenix.structure_comparison</italic> (Moriarty <italic>et al.</italic>, 2018<xref ref-type="bibr" rid="bb30"> ▸</xref>), could be used to identify such regions more reliably; this is not feasible in an automated fashion with the current methods.</p>
    <p>The algorithms we have developed to decide whether loops should be kept or not may also be applied to existing parts of protein structure models. We have emphasized in this paper the number of loops that are <italic>not</italic> built in the PDB but may be buildable; however, there may also be cases where crystallographers have modeled loops over-enthusiastically. To estimate the extent of this, we analyzed the distribution of the density ratio between atoms in loops and random atoms in the template structures (the structures where the loops were copied from). This density ratio is better for the template loops than the density threshold cutoff for the newly built loops in most cases (Fig. 8<xref ref-type="fig" rid="fig8"> ▸</xref>); this is to be expected because the loops are normally missing precisely because their electron density was not very clear. However, there are also cases where the density fit of the template loop is quite poor; inspection of several cases shows that the majority of these loops are likely to have a correct conformation that is supported by the electron density. However, there are also cases where the loop should not have been modeled.</p>
    <p>A possible addition to the methods presented here is building partial loops or expanding the termini. At first, we allowed partial loops to be built by <italic>Loopwhole</italic> if the density fit for that part of the loop was above the density threshold. Although the majority of the 8217 partial loops we built were modeled correctly, building partial loops was not sufficiently reliable to automate. Too often, an amino acid would be modeled into the neighboring density of water molecules or unidentified ligands such as PEG. The same issue would arise for terminal extensions with two additional difficulties. First, the number of residues that may be added is not always clear. Many residues can be missing from the terminus and, since it is unclear <italic>a priori</italic> how far the terminus can be extended, the residues should be added one by one. This is less efficient than loop fitting and therefore likely to cost much more CPU time per added residue. Second, instead of two anchor points on the ends of a missing loop, a terminus only has a single anchor point: the current terminus. The absence of a second anchor point means a drastic loss of information about the general direction in which the residues should be built. Therefore, it is more difficult to detect cases where the expanded fragment is not built into the correct electron density. The combination of these two limitations has kept us from implementing termini extension at present.</p>
    <p>New structure models are added to the PDB every week, enriching the set of homologous structure data. The availability of suitable candidates for loop transfer will therefore only increase further, facilitating loop modeling for new structures. The pro-active updating of existing structure models by PDB-REDO ensures that older structure models also benefit from the increased availability of homologs. The original struggle to find a good loop conformation for the first published structure model in a protein family will remain, but it has become a temporary problem; solving the first structure of a protein provides a handle for much future structural research and now in return this future research also provides means to make this first structure more complete. We have clearly demonstrated that the increased availability of homologous data can be used to improve the completeness of protein structure models of the past, the present and the future.</p>
  </sec>
  <sec id="sec5">
    <label>5.</label>
    <title>Availability   </title>
    <p>Both the PDB-REDO databank and webserver are hosted on <ext-link ext-link-type="uri" xlink:href="https://pdb-redo.eu">https://pdb-redo.eu</ext-link>. On the webserver, crystallographers can submit their work-in-progress models to run <italic>PDB-REDO</italic> including the new loop-building procedure. The 1990 models from the test set are available through the databank. Existing databank entries are gradually updated to include the loop-building procedure. On the PDB-REDO databank entry pages, registered users can submit an update request to prioritize the update of that entry. Binary executables of <italic>Loopwhole</italic>, <italic>fixDMC</italic> and <italic>tortoize</italic> are available from the website and source code is available on request.</p>
  </sec>
  <sec id="sec6">
    <label>6.</label>
    <title>Related literature   </title>
    <p>The following reference is cited in the <ext-link ext-link-type="uri" xlink:href="#suppinfoanchor">supporting information</ext-link> for this article: Wang &amp; Dunbrack (2005<xref ref-type="bibr" rid="bb50"> ▸</xref>).</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data">
      <p>Supplementary methods and figures.. DOI: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1107/S2052252518010552/jt5027sup1.pdf">10.1107/S2052252518010552/jt5027sup1.pdf</ext-link>
</p>
      <media mimetype="application" mime-subtype="pdf" xlink:href="m-05-00585-sup1.pdf" orientation="portrait" id="d35e140" position="anchor"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>The authors thank the NKI research high-performance computing facility for providing computational resources. BvB designed and executed research, analysed all data, prepared figures and drafted the manuscript; KJ and MLH contributed specific algorithms and code; RPJ and AP designed and supervised the research. The authors declare no competing interests.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="bb1">
      <mixed-citation publication-type="other">Adams, M. A. &amp; Jia, Z. (2006). <italic>J. Mol. Biol.</italic>
<bold>359</bold>, 455–465.</mixed-citation>
    </ref>
    <ref id="bb2">
      <mixed-citation publication-type="other">Berman, H. M., Kleywegt, G. J., Nakamura, H. &amp; Markley, J. L. (2014). <italic>J. Comput. Aided Mol. Des.</italic>
<bold>28</bold>, 1009–1014.</mixed-citation>
    </ref>
    <ref id="bb3">
      <mixed-citation publication-type="other">Beusekom, B. van, Perrakis, A. &amp; Joosten, R. P. (2016). <italic>Methods Mol. Biol.</italic>
<bold>1415</bold>, 107–138.</mixed-citation>
    </ref>
    <ref id="bb4">
      <mixed-citation publication-type="other">Beusekom, B. van, Touw, W. G., Tatineni, M., Somani, S., Rajagopal, G., Luo, J., Gilliland, G. L., Perrakis, A. &amp; Joosten, R. P. (2018). <italic>Protein Sci.</italic>
<bold>27</bold>, 798–808.</mixed-citation>
    </ref>
    <ref id="bb5">
      <mixed-citation publication-type="other">Brandt, B. W., Heringa, J. &amp; Leunissen, J. A. M. (2008). <italic>Nucleic Acids Res.</italic>
<bold>36</bold>, W255–W259.</mixed-citation>
    </ref>
    <ref id="bb6">
      <mixed-citation publication-type="other">Burley, S. K., Berman, H. M., Kleywegt, G. J., Markley, J. L., Nakamura, H. &amp; Velankar, S. (2017). <italic>Methods Mol. Biol.</italic>
<bold>1607</bold>, 627–641.</mixed-citation>
    </ref>
    <ref id="bb7">
      <mixed-citation publication-type="other">Burnley, B. T., Afonine, P. V., Adams, P. D. &amp; Gros, P. (2012). <italic>eLife</italic>, <bold>1</bold>, e00311.</mixed-citation>
    </ref>
    <ref id="bb8">
      <mixed-citation publication-type="other">Cereto-Massagué, A., Ojeda, M. J., Joosten, R. P., Valls, C., Mulero, M., Salvado, M. J., Arola-Arnal, A., Arola, L., Garcia-Vallvé, S. &amp; Pujadas, G. (2013). <italic>J. Cheminform.</italic>
<bold>5</bold>, 36.</mixed-citation>
    </ref>
    <ref id="bb9">
      <mixed-citation publication-type="other">Cowtan, K. (2003). <italic>IUCr Comput. Commun. Newsl.</italic>
<bold>2</bold>, 4–9.</mixed-citation>
    </ref>
    <ref id="bb10">
      <mixed-citation publication-type="other">Cowtan, K. (2012). <italic>Acta Cryst.</italic> D<bold>68</bold>, 328–335.</mixed-citation>
    </ref>
    <ref id="bb11">
      <mixed-citation publication-type="other">DeForte, S. &amp; Uversky, V. N. (2016). <italic>Protein Sci.</italic>
<bold>25</bold>, 676–688.</mixed-citation>
    </ref>
    <ref id="bb12">
      <mixed-citation publication-type="other">DePristo, M. A., de Bakker, P. I. W., Johnson, R. J. K. &amp; Blundell, T. L. (2005). <italic>Structure</italic>, <bold>13</bold>, 1311–1319.</mixed-citation>
    </ref>
    <ref id="bb13">
      <mixed-citation publication-type="other">Djinovic-Carugo, K. &amp; Carugo, O. (2015). <italic>Intrinsically Disord Proteins.</italic>
<bold>3</bold>, e1095697.</mixed-citation>
    </ref>
    <ref id="bb14">
      <mixed-citation publication-type="other">Dutta, S., Burkhardt, K., Young, J., Swaminathan, G. J., Matsuura, T., Henrick, K., Nakamura, H. &amp; Berman, H. M. (2009). <italic>Mol. Biotechnol.</italic>
<bold>42</bold>, 1–13.</mixed-citation>
    </ref>
    <ref id="bb15">
      <mixed-citation publication-type="other">Emsley, P., Lohkamp, B., Scott, W. G. &amp; Cowtan, K. (2010). <italic>Acta Cryst.</italic> D<bold>66</bold>, 486–501.</mixed-citation>
    </ref>
    <ref id="bb16">
      <mixed-citation publication-type="other">Grubbs, F. E. (1950). <italic>Ann. Math. Stat.</italic>
<bold>21</bold>, 27–58.</mixed-citation>
    </ref>
    <ref id="bb17">
      <mixed-citation publication-type="other">Henrick, K., Feng, Z., Bluhm, W. F., Dimitropoulos, D., Doreleijers, J. F., Dutta, S., Flippen-Anderson, J. L., Ionides, J., Kamada, C., Krissinel, E., Lawson, C. L., Markley, J. L., Nakamura, H., Newman, R., Shimizu, Y., Swaminathan, J., Velankar, S., Ory, J., Ulrich, E. L., Vranken, W., Westbrook, J., Yamashita, R., Yang, H., Young, J., Yousufuddin, M. &amp; Berman, H. M. (2008). <italic>Nucleic Acids Res.</italic>
<bold>36</bold>, D426–D433.</mixed-citation>
    </ref>
    <ref id="bb18">
      <mixed-citation publication-type="other">Hooft, R. W., Sander, C. &amp; Vriend, G. (1997). <italic>Comput. Appl. Biosci.</italic>
<bold>13</bold>, 425–430.</mixed-citation>
    </ref>
    <ref id="bb19">
      <mixed-citation publication-type="other">Joosten, K., Cohen, S. X., Emsley, P., Mooij, W., Lamzin, V. S. &amp; Perrakis, A. (2008). <italic>Acta Cryst.</italic> D<bold>64</bold>, 416–424.</mixed-citation>
    </ref>
    <ref id="bb20">
      <mixed-citation publication-type="other">Joosten, R. P., Joosten, K., Cohen, S. X., Vriend, G. &amp; Perrakis, A. (2011). <italic>Bioinformatics</italic>, <bold>27</bold>, 3392–3398.</mixed-citation>
    </ref>
    <ref id="bb21">
      <mixed-citation publication-type="other">Joosten, R. P., Joosten, K., Murshudov, G. N. &amp; Perrakis, A. (2012). <italic>Acta Cryst.</italic> D<bold>68</bold>, 484–496.</mixed-citation>
    </ref>
    <ref id="bb22">
      <mixed-citation publication-type="other">Joosten, R. P., Long, F., Murshudov, G. N. &amp; Perrakis, A. (2014). <italic>IUCrJ</italic>, <bold>1</bold>, 213–220.</mixed-citation>
    </ref>
    <ref id="bb23">
      <mixed-citation publication-type="other">Kim, D. H., Jang, D. S., Nam, G. H., Choi, G., Kim, J. S., Ha, N. C., Kim, M. S., Oh, B. H. &amp; Choi, K. Y. (2000). <italic>Biochemistry</italic>, <bold>39</bold>, 4581–4589.</mixed-citation>
    </ref>
    <ref id="bb24">
      <mixed-citation publication-type="other">Kleywegt, G. J. &amp; Jones, T. A. (1998). <italic>Acta Cryst.</italic> D<bold>54</bold>, 1119–1131.</mixed-citation>
    </ref>
    <ref id="bb25">
      <mixed-citation publication-type="other">Kuipers, J. (2002). <italic>Quaternions and Rotation Sequences</italic>. New Jersey: Princeton University Press.</mixed-citation>
    </ref>
    <ref id="bb26">
      <mixed-citation publication-type="other">Lamb, A. L., Kappock, T. J. &amp; Silvaggi, N. R. (2015). <italic>Biochim. Biophys. Acta</italic>, <bold>1854</bold>, 258–268.</mixed-citation>
    </ref>
    <ref id="bb27">
      <mixed-citation publication-type="other">Le Gall, T., Romero, P. R., Cortese, M. S., Uversky, V. N. &amp; Dunker, A. K. (2007). <italic>J. Biomol. Struct. Dyn.</italic>
<bold>24</bold>, 325–342.</mixed-citation>
    </ref>
    <ref id="bb28">
      <mixed-citation publication-type="other">Levin, E. J., Kondrashov, D. A., Wesenberg, G. E. &amp; Phillips, G. N. Jr (2007). <italic>Structure</italic>, <bold>15</bold>, 1040–1052.</mixed-citation>
    </ref>
    <ref id="bb29">
      <mixed-citation publication-type="other">Li, L., Santarsiero, B. D. &amp; Bouvier, M. (2016). <italic>J. Immunol.</italic>
<bold>197</bold>, 1399–1407.</mixed-citation>
    </ref>
    <ref id="bb30">
      <mixed-citation publication-type="other">Moriarty, N. W., Liebschner, D., Klei, H. E., Echols, N., Afonine, P. V., Headd, J., Poon, B. K. &amp; Adams, P. D. (2018). <italic>Protein Sci.</italic>, <bold>1</bold>, 182–194</mixed-citation>
    </ref>
    <ref id="bb31">
      <mixed-citation publication-type="other">Mowbray, S. L., Helgstrand, C., Sigrell, J. A., Cameron, A. D. &amp; Jones, T. A. (1999). <italic>Acta Cryst.</italic> D<bold>55</bold>, 1309–1319.</mixed-citation>
    </ref>
    <ref id="bb32">
      <mixed-citation publication-type="other">Murshudov, G. N., Skubák, P., Lebedev, A. A., Pannu, N. S., Steiner, R. A., Nicholls, R. A., Winn, M. D., Long, F. &amp; Vagin, A. A. (2011). <italic>Acta Cryst.</italic> D<bold>67</bold>, 355–367.</mixed-citation>
    </ref>
    <ref id="bb33">
      <mixed-citation publication-type="other">Read, R. J., Adams, P. D., Arendall, W. B., Brunger, A. T., Emsley, P., Joosten, R. P., Kleywegt, G. J., Krissinel, E. B., Lütteke, T., Otwinowski, Z., Perrakis, A., Richardson, J. S., Sheffler, W. H., Smith, J. L., Tickle, I. J., Vriend, G. &amp; Zwart, P. H. (2011). <italic>Structure</italic>, <bold>19</bold>, 1395–1412.</mixed-citation>
    </ref>
    <ref id="bb34">
      <mixed-citation publication-type="other">Richardson, J. S., Prisant, M. G. &amp; Richardson, D. C. (2013). <italic>Curr. Opin. Struct. Biol.</italic>
<bold>23</bold>, 707–714.</mixed-citation>
    </ref>
    <ref id="bb35">
      <mixed-citation publication-type="other">Segura, J., Sanchez-Garcia, R., Martinez, M., Cuenca-Alba, J., Tabas-Madrid, D., Sorzano, C. O. S. &amp; Carazo, J. M. (2017). <italic>Bioinformatics</italic>, <bold>33</bold>, 3655–3657.</mixed-citation>
    </ref>
    <ref id="bb36">
      <mixed-citation publication-type="other">Tabas-Madrid, D., Segura, J., Sanchez-Garcia, R., Cuenca-Alba, J., Sorzano, C. O. S. &amp; Carazo, J. M. (2016). <italic>J. Struct. Biol.</italic>
<bold>194</bold>, 231–234.</mixed-citation>
    </ref>
    <ref id="bb37">
      <mixed-citation publication-type="other">Terwilliger, T. C. &amp; Bricogne, G. (2014). <italic>Acta Cryst.</italic> D<bold>70</bold>, 2533–2543.</mixed-citation>
    </ref>
    <ref id="bb38">
      <mixed-citation publication-type="other">Terwilliger, T. C., Grosse-Kunstleve, R. W., Afonine, P. V., Moriarty, N. W., Zwart, P. H., Hung, L.-W., Read, R. J. &amp; Adams, P. D. (2008). <italic>Acta Cryst.</italic> D<bold>64</bold>, 61–69.</mixed-citation>
    </ref>
    <ref id="bb39">
      <mixed-citation publication-type="other">Tickle, I. J. (2012). <italic>Acta Cryst.</italic> D<bold>68</bold>, 454–467.</mixed-citation>
    </ref>
    <ref id="bb50">
      <mixed-citation publication-type="other">Wang, G. &amp; Dunbrack, R. L. Jr (2005).<italic> Nucleic Acids Res.</italic>
<bold>33</bold>, W94–W98.</mixed-citation>
    </ref>
    <ref id="bb40">
      <mixed-citation publication-type="other">Warren, G. L., Do, T. D., Kelley, B. P., Nicholls, A. &amp; Warren, S. D. (2012). <italic>Drug Discov. Today</italic>, <bold>17</bold>, 1270–1281.</mixed-citation>
    </ref>
    <ref id="bb41">
      <mixed-citation publication-type="other">Weichenberger, C. X., Pozharski, E. &amp; Rupp, B. (2013). <italic>Acta Cryst.</italic> F<bold>69</bold>, 195–200.</mixed-citation>
    </ref>
    <ref id="bb42">
      <mixed-citation publication-type="other">Wlodawer, A., Minor, W., Dauter, Z. &amp; Jaskolski, M. (2013). <italic>FEBS J.</italic>
<bold>280</bold>, 5705–5736.</mixed-citation>
    </ref>
    <ref id="bb43">
      <mixed-citation publication-type="other">Yoshida, E., Hidaka, M., Fushinobu, S., Koyanagi, T., Minami, H., Tamaki, H., Kitaoka, M., Katayama, T. &amp; Kumagai, H. (2010). <italic>Biochem. J.</italic>
<bold>431</bold>, 39–49.</mixed-citation>
    </ref>
    <ref id="bb44">
      <mixed-citation publication-type="other">Zhang, Y., Stec, B. &amp; Godzik, A. (2007). <italic>Structure</italic>, <bold>15</bold>, 1141–1147.</mixed-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="fig1" orientation="portrait" position="float">
    <label>Figure 1</label>
    <caption>
      <p>Cumulative percentage (left) and absolute number (right) of residues missing in termini and in loops for all structures over the years.</p>
    </caption>
    <graphic xlink:href="m-05-00585-fig1"/>
  </fig>
  <fig id="fig2" orientation="portrait" position="float">
    <label>Figure 2</label>
    <caption>
      <p>Stepwise illustration of the <italic>Loopwhole</italic> algorithm, applied to three missing glycines (PDB entry <ext-link ext-link-type="uri" xlink:href="http://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=1dmn">1dmn</ext-link>; Kim <italic>et al.</italic>, 2000<xref ref-type="bibr" rid="bb23"> ▸</xref>). All 2<italic>mF</italic>
<sub>o</sub> − <italic>DF</italic>
<sub>c</sub> and <italic>mF</italic>
<sub>o</sub> − <italic>DF</italic>
<sub>c</sub> electron-density maps are shown at 0.7σ and 3.0σ, respectively. (<italic>a</italic>) The PDB structure has no apparent gap: two residues are wrongly bound to one another (highlighted in brown). The gap is detected from the sequence. (<italic>b</italic>) The two residues immediately adjacent to the missing loop are removed, as these are often in the wrong conformation. (<italic>c</italic>) All homologous chains with the loop present are structurally aligned to the target structure model (only four homologs shown). (<italic>d</italic>) If the surrounding residues align well, the loop is grafted into the target structure model. By default, the top ten alignments are kept (only one shown). (<italic>e</italic>) After real-space optimization, the loop with the best density fit is kept provided the density fit and geometrical quality pass the filter criteria.</p>
    </caption>
    <graphic xlink:href="m-05-00585-fig2"/>
  </fig>
  <fig id="fig3" orientation="portrait" position="float">
    <label>Figure 3</label>
    <caption>
      <p>Cumulative distributions for properties of loops that can be built in the PDB. (Left) Most of the buildable loops are short. (Middle) Density ratio of loop candidates; in contrast to the other two subfigures, this includes loops that were not built. This metric represents the observed density for the loop main chain divided by the average main-chain density. The minimum required density ratio of 0.25 is indicated by the vertical red line. Of all initial loop candidates, 60% have insufficient density and are therefore discarded. (Right) The Ramachandran <italic>Z</italic> score for candidate loops and their counterparts in the structure model from which they were taken. The backbone conformation of the built loops is excellent and better than the conformation of loops in structures from which they were taken, which is largely a result of the application of Ramachandran restraints in the real-space refinement of loops in <italic>coot-mini-rsr</italic> (Emsley <italic>et al.</italic>, 2010<xref ref-type="bibr" rid="bb15"> ▸</xref>).</p>
    </caption>
    <graphic xlink:href="m-05-00585-fig3"/>
  </fig>
  <fig id="fig4" orientation="portrait" position="float">
    <label>Figure 4</label>
    <caption>
      <p>Distribution of the RSCC for all loops built in 1990 PDB-REDO entries. The RSCC was calculated on the final PDB-REDO structure models. All loops with an RSCC below 0.6 are colored red and are discarded.</p>
    </caption>
    <graphic xlink:href="m-05-00585-fig4"/>
  </fig>
  <fig id="fig5" orientation="portrait" position="float">
    <label>Figure 5</label>
    <caption>
      <p>Six examples of loops with a density ratio between the cutoff value (0.25) and 0.30. The 2<italic>mF</italic>
<sub>o</sub> − <italic>DF</italic>
<sub>c</sub> maps are shown at 0.8σ; <italic>mF</italic>
<sub>o</sub> − <italic>DF</italic>
<sub>c</sub> maps are shown at 3.0σ. (<italic>a</italic>) <ext-link ext-link-type="uri" xlink:href="http://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=4fc9">4fc9</ext-link> C474–476, density ratio 0.27; (<italic>b</italic>) <ext-link ext-link-type="uri" xlink:href="http://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=5h8p">5h8p</ext-link> A151-152, density ratio 0.29; (<italic>c</italic>) <ext-link ext-link-type="uri" xlink:href="http://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=2d31">2d31</ext-link> A266-267, density ratio 0.25; (<italic>d</italic>) <ext-link ext-link-type="uri" xlink:href="http://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=2y1t">2y1t</ext-link> F18, density ratio 0.27; (<italic>e</italic>) <ext-link ext-link-type="uri" xlink:href="http://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=2y7q">2y7q</ext-link> B480–484, density ratio 0.26. For part of the loop, no density is observed at 0.8σ; however, it does show up at 0.6σ; (<italic>f</italic>) <ext-link ext-link-type="uri" xlink:href="http://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=4w9x">4w9x</ext-link> A121–123, density ratio 0.26. For clarity, the side chain of TrpA124 is not shown.</p>
    </caption>
    <graphic xlink:href="m-05-00585-fig5"/>
  </fig>
  <fig id="fig6" orientation="portrait" position="float">
    <label>Figure 6</label>
    <caption>
      <p>The percentage of C-terminal O atoms (OXT): present in the PDB; missing the C-terminal amino acid and thus not buildable; and newly added to the C-terminal amino acid.</p>
    </caption>
    <graphic xlink:href="m-05-00585-fig6"/>
  </fig>
  <fig id="fig7" orientation="portrait" position="float">
    <label>Figure 7</label>
    <caption>
      <p>Examples of built loops. Newly built parts are shown in pink. (<italic>a</italic>) <ext-link ext-link-type="uri" xlink:href="http://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=3abz">3abz</ext-link> chain B residues 497–510. The RSCC for this loop is 0.76; in OMIT map it is 0.55. (<italic>b</italic>) <ext-link ext-link-type="uri" xlink:href="http://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=5iro">5iro</ext-link> chain I residues 243–249. RSCC values (normal/OMIT) are 0.84 and 0.98. (<italic>c</italic>) <ext-link ext-link-type="uri" xlink:href="http://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=2amj">2amj</ext-link> chain D residues 108–117. RSCC values (normal/OMIT) are 0.80 and 0.61. Details described in the main text. The 2<italic>mF</italic>
<sub>o</sub> − <italic>DF</italic>
<sub>c</sub> maps are shown at 0.8, 1.2 and 1.0σ, respectively. The <italic>mF</italic>
<sub>o</sub> − <italic>DF</italic>
<sub>c</sub> maps are shown at 3.0σ in all cases.</p>
    </caption>
    <graphic xlink:href="m-05-00585-fig7"/>
  </fig>
  <fig id="fig8" orientation="portrait" position="float">
    <label>Figure 8</label>
    <caption>
      <p>Frequency of specific density ratios of loop backbone <italic>versus</italic> the rest of the backbone for the loops that were used as template from homologous structures. Most template loops have sufficient density and therefore they would also have been built by <italic>Loopwhole</italic>: those loops are to the right side of the red line indicating the density ratio cutoff of 0.25.</p>
    </caption>
    <graphic xlink:href="m-05-00585-fig8"/>
  </fig>
  <table-wrap id="table1" orientation="portrait" position="float">
    <label>Table 1</label>
    <caption>
      <title>Number of built loops and affected structures in the PDB and PDB-REDO databanks. We used 112 385 PDB-REDO entries available in February 2018</title>
    </caption>
    <table frame="hsides" rules="groups">
      <thead valign="bottom">
        <tr>
          <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="bottom">Model origin</th>
          <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" char="." charoff="23" valign="bottom">No. of loops built</th>
          <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" char="." charoff="19" valign="bottom">No. of entries modified</th>
        </tr>
      </thead>
      <tbody valign="top">
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">PDB</td>
          <td rowspan="1" colspan="1" align="left" char="." charoff="23" valign="top">22480</td>
          <td rowspan="1" colspan="1" align="left" char="." charoff="19" valign="top">10806</td>
        </tr>
        <tr>
          <td rowspan="1" colspan="1" align="left" valign="top">PDB-REDO</td>
          <td rowspan="1" colspan="1" align="left" char="." charoff="23" valign="top">24962</td>
          <td rowspan="1" colspan="1" align="left" char="." charoff="19" valign="top">11571</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
</floats-group>
