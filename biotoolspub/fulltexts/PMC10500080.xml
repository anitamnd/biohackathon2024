<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10500080</article-id>
    <article-id pub-id-type="pmid">37672040</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad549</article-id>
    <article-id pub-id-type="publisher-id">btad549</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Databases and Ontologies</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>FunTaxIS-lite: a simple and light solution to investigate protein functions in all living organisms</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Bianca</surname>
          <given-names>Federico</given-names>
        </name>
        <aff><institution>Computational Medicine Group (MedComp), Department of Molecular Medicine, University of Padova</institution>, Padova, <country country="IT">Italy</country></aff>
        <xref rid="btad549-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ispano</surname>
          <given-names>Emilio</given-names>
        </name>
        <aff><institution>Computational Medicine Group (MedComp), Department of Molecular Medicine, University of Padova</institution>, Padova, <country country="IT">Italy</country></aff>
        <xref rid="btad549-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gazzola</surname>
          <given-names>Ermanno</given-names>
        </name>
        <aff><institution>Computational Medicine Group (MedComp), Department of Molecular Medicine, University of Padova</institution>, Padova, <country country="IT">Italy</country></aff>
        <xref rid="btad549-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lavezzo</surname>
          <given-names>Enrico</given-names>
        </name>
        <aff><institution>Computational Medicine Group (MedComp), Department of Molecular Medicine, University of Padova</institution>, Padova, <country country="IT">Italy</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fontana</surname>
          <given-names>Paolo</given-names>
        </name>
        <aff><institution>Research and Innovation Center, Edmund Mach Foundation, San Michele all'Adige</institution>, Trento, <country country="IT">Italy</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-0246-3119</contrib-id>
        <name>
          <surname>Toppo</surname>
          <given-names>Stefano</given-names>
        </name>
        <aff><institution>Computational Medicine Group (MedComp), Department of Molecular Medicine, University of Padova</institution>, Padova, <country country="IT">Italy</country></aff>
        <xref rid="btad549-cor1" ref-type="corresp"/>
        <!--stefano.toppo@unipd.it-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Robinson</surname>
          <given-names>Peter</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad549-cor1">Corresponding author. Computational Medicine Group (MedComp), Department of Molecular Medicine, University of Padova, via Ugo Bassi 58b, 35121 Padova PD, Italy. E-mail: <email>stefano.toppo@unipd.it</email> (S.T.)</corresp>
      <fn id="btad549-FM1">
        <p>Federico Bianca, Emilio Ispano and Ermanno Gazzola contributed equally to this work.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-09-06">
      <day>06</day>
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>06</day>
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>9</issue>
    <elocation-id>btad549</elocation-id>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>2</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>27</day>
        <month>7</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>02</day>
        <month>9</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>05</day>
        <month>9</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>13</day>
        <month>9</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad549.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Defining the full domain of protein functions belonging to an organism is a complex challenge that is due to the huge heterogeneity of the taxonomy, where single or small groups of species can bear unique functional characteristics. FunTaxIS-lite provides a solution to this challenge by determining taxon-based constraints on Gene Ontology (GO) terms, which specify the functions that an organism can or cannot perform. The tool employs a set of rules to generate and spread the constraints across both the taxon hierarchy and the GO graph.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>The taxon-based constraints produced by FunTaxIS-lite extend those provided by the Gene Ontology Consortium by an average of 300%. The implementation of these rules significantly reduces errors in function predictions made by automatic algorithms and can assist in correcting inconsistent protein annotations in databases.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>FunTaxIS-lite is available on <ext-link xlink:href="https://www.medcomp.medicina.unipd.it/funtaxis-lite" ext-link-type="uri">https://www.medcomp.medicina.unipd.it/funtaxis-lite</ext-link> and from <ext-link xlink:href="https://github.com/MedCompUnipd/FunTaxIS-lite" ext-link-type="uri">https://github.com/MedCompUnipd/FunTaxIS-lite</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Ministero dell’Istruzione, dell’Università e della Ricerca, PON</institution>
          </institution-wrap>
        </funding-source>
        <award-id>DOT1319403-4</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Università degli Studi di Padova, Italy</institution>
          </institution-wrap>
        </funding-source>
        <award-id>DOR2020</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="5"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The sequence data for many species has increased significantly due to the progress in omics sciences. However, characterizing the functional aspects of taxonomy poses substantial challenges. To address this, the Gene Ontology Consortium has collaborated internationally to provide ontologies describing unequivocally gene functions (GO terms) which are integrated in a direct acyclic graph. While GO-encoded annotations are independent of species, many of these annotations represent functions and biological processes that are not universally present across all taxa. The absence of explicit formalization regarding the specific protein functions that a particular species can exhibit (referred to as taxon constraints) can lead to improper functional transfers between proteins of different species, solely based on shared sequence similarities. Considering that protein/gene information in databases typically includes the species of origin, it becomes feasible to implicitly partition the GO graph based on taxonomic criteria. In this context, two types of taxonomic constraints can be identified: positive (“only-in-taxon”) and negative (“never-in-taxon”) relationships. Positive relationships define GO terms that can solely annotate a specific taxon, while negative relationships indicate GO terms that can never be applied to a taxon. The need to create taxonomic constraints appeared clear with the growth of the databases accumulating issues in the protein annotations due to the percolation of errors (<xref rid="btad549-B4" ref-type="bibr">Gilks <italic toggle="yes">et al.</italic> 2005</xref>). These problems persist not only in the protein annotations created automatically and labeled as “Inferred from Electronic Annotation” (IEA), which amount to 98% of the total annotations available, but also in manually curated protein functions. In GOA release of June 2023, for instance, “chloroplast thylakoid” (GO id: GO:0009534) is used to annotate two proteins Q38AK2 and Q4Q1E9 belonging to <italic toggle="yes">Trypanosoma brucei brucei</italic> and <italic toggle="yes">Leishmania major</italic>, respectively with the manually reviewed code Inferred from Biological aspect of Ancestor (IBA). These parasitic protozoans, that cause the sleeping sickness (<italic toggle="yes">Trypanosoma</italic>) and leishmaniasis (<italic toggle="yes">Leishmania</italic>) in humans, lack chloroplasts. For these reasons, since 2010, the Gene Ontology Consortium has developed a manually validated list of taxonomic constraints, specifying them at various levels of the ontology. However, manually defining constraints for over 40 000 GO terms and hundreds of thousands of species is a demanding task and present coverage of both species and GO terms is poor. To address this challenge, we have developed FunTaxIS-lite as an enhanced and faster version of its predecessor, FunTaxIS (<xref rid="btad549-B3" ref-type="bibr">Falda <italic toggle="yes">et al.</italic> 2016</xref>). FunTaxIS-lite enables the inference of functional peculiarities and similarities between different taxa, determining the presence or absence of specific functions in the vast majority of organism/species. The tool aims at: (i) being as broader as possible in covering the taxonomic tree and the GO graph, (ii) helping function prediction tools to discard wrong predicted annotations for the species under study, and (iii) helping database curators to fix potential issues of annotations in databanks.</p>
  </sec>
  <sec>
    <title>2 FunTaxIS-lite pipeline</title>
    <p>FunTaxIS-lite automatically assigns GO constraints to specific taxa and is able to integrate both the constraints defined by the GO Consortium (GOC) (<xref rid="btad549-B1" ref-type="bibr">Ashburner <italic toggle="yes">et al.</italic> 2000</xref>, <xref rid="btad549-B7" ref-type="bibr">The Gene Ontology Consortium 2021</xref>) and those manually curated by the user. This ensures a refined and tailored annotation process for exploring functional peculiarities across the taxonomic tree. The input files of the tool are the GOA database, the taxonomy database from NCBI, and the GO graph in Web Ontology Language (OWL) format. A breakdown of the main steps of the FunTaxIS-lite pipeline are herein explained (for further details, see <xref rid="sup1" ref-type="supplementary-material">Supplementary Material S1</xref>).</p>
    <list list-type="bullet">
      <list-item>
        <p>Gene Otology Annotation (GOA) database cleaning step: GOA annotations undergo a cleaning process. The tool removes: annotations with no biological data available (“ND” evidence code), annotations stating that a protein does not perform a specific function (“NOT” evidence code), root GO terms (GO:0005575, GO:0008150, and GO:0003674) and annotations related to the tags “RNAcentral” and “environmental samples.”</p>
      </list-item>
      <list-item>
        <p>Taxonomic Reference Nodes determination: a list of highly annotated taxonomic reference node which are used to group organisms based on common biological traits, is established. The objective is to have a reliable set of constraints for each species subsumed by these reference taxa and to cover a broad range of the taxonomy hierarchy.</p>
      </list-item>
      <list-item>
        <p>Grouping GOs and cumulative frequencies calculation: GO annotations in the GOA database are grouped by organisms and, for each organism, a list of associated GO terms is generated. Each organism is traced back to its closest reference parent node. Then, for each GO term in the reference node, the cumulative frequency over its GO descendants is calculated.</p>
      </list-item>
      <list-item>
        <p>Creation of “never_in” GO Taxon Constraints: only GO terms with a cumulative frequency of at least 500 in the whole GOA database are considered. GO terms with a cumulative frequency of 0 in the reference taxon node are marked as “never_in” for that node and for all its descendant species. This means that the GO term (and all of its descendant GO terms in the GO graph) cannot be used to annotate any protein product in any species that belongs to the reference taxon node.</p>
      </list-item>
      <list-item>
        <p>Merging automatic, GOC, and manual constraints: in the final step, the automatic constraints generated by the FunTaxIS-lite program are combined with the GOC constraints, with the latter taking precedence in case of conflicts. The GOC constraints are defined as “never_in” or “only_in”, where “only_in” constraints specify that certain GO terms are restricted to a specific taxon. These constraints are converted into “never_in” for all of the species except those where the “only_in” is specified and added to the existing constraints. Moreover, a list of “manual constraints” is made based on direct observation of annotation issues that can be created by the end-user following a simple syntax in a configuration file. These constraints have the highest priority in the pipeline.</p>
      </list-item>
    </list>
  </sec>
  <sec>
    <title>3 FunTaxIS-lite web server</title>
    <p>FunTaxIS-lite is a freely accessible web site (<ext-link xlink:href="https://www.medcomp.medicina.unipd.it/funtaxis-lite" ext-link-type="uri">https://www.medcomp.medicina.unipd.it/funtaxis-lite</ext-link>) and downloadable tool (<ext-link xlink:href="https://github.com/MedCompUnipd/FunTaxIS-lite" ext-link-type="uri">https://github.com/MedCompUnipd/FunTaxIS-lite</ext-link>). Browsing the web site, the user can visualize and/or download the list of all prohibited GO terms (“never_in”) in tabular format by looking for taxa via taxonomic id or taxon name. FunTaxIS-lite tool can also be installed and run locally, allowing the user to explore different options and to add custom manual constraints to generate from scratch the lists of “never-in” terms. The parameters which can be customized are the database files from which the constraints are generated (GO graph file, GOA file, NCBI taxonomy files), the list of manual constraints and the cutoff on the cumulative frequency threshold.</p>
  </sec>
  <sec>
    <title>4 FunTaxIS-lite vs FunTaxIS old version</title>
    <p>FunTaxIS-lite is faster and more user-friendly than the previous version. One of the principal changes that differentiates it from FunTaxIS is the user’s capability to add the manually validated constraints to the automatically generated constraints, as well as those supplied by the GOC.</p>
    <p>The main changes are:</p>
    <list list-type="bullet">
      <list-item>
        <p>The number of “reference taxon nodes” has been expanded from 50 to 171 thanks to a new automated selection process based on the quantity and diversity of annotations at specific taxonomic nodes. The growth of the GOA dataset over time has also enabled this expansion of “reference taxon nodes.” The uneven distribution of annotations across taxa in the GOA has forced us to introduce two categories of reference taxonomic nodes: “Reliable” (70) and “Unreliable” (101). The “Reliable” nodes represent high-confidence nodes in the taxonomic hierarchy that group well-annotated branches. They owe their robustness to the inclusion of extensively studied model organisms with rich functional information. On the other hand, the “Unreliable” nodes group poorly annotated taxonomic branches with limited available knowledge for which the tool is able to define a small but usable set of constraints.</p>
      </list-item>
      <list-item>
        <p>Simplification of calculations. Within the tool, we have made the selection of “never_in” GO terms more efficient by removing the previous fuzzy logic that didn’t provide any effective contribution.</p>
      </list-item>
      <list-item>
        <p>Completely revisited the integration of GOC constraints due to the introduction of the novel manual constraints and resolution of potential conflicts among manual and automatic constraints.</p>
      </list-item>
      <list-item>
        <p>A more user-friendly, light, and effective web site has been developed, offering rapid access to the “never_in” GO list corresponding to any species within the taxonomic tree. All the taxon-constraints are precomputed and loaded into the database, which is periodically updated by our research group, according to the latest releases of GO, GOA, and Taxonomy databases.</p>
      </list-item>
    </list>
  </sec>
  <sec>
    <title>5 Benchmark datasets and assessment</title>
    <p>The “functional domain” created by FunTaxIS-lite refers to a collection of Gene Ontology (GO) terms that establish the defined boundaries within which the species can exert its own functions. We performed a “species-centric” assessment by designing a benchmark where a similarity search based on DIAMOND (<xref rid="btad549-B2" ref-type="bibr">Buchfink <italic toggle="yes">et al.</italic> 2015</xref>) and our automatic function prediction tool Argot (<xref rid="btad549-B6" ref-type="bibr">Lavezzo <italic toggle="yes">et al.</italic> 2016</xref>) have been challenged to annotate the proteins coming from four different species in a classical blind test. The four species have been chosen as representatives of highly different taxonomic ranks: the plant <italic toggle="yes">Amborella trichopoda</italic> (tax id: 13333), the lobe-fin bony fish <italic toggle="yes">Latimeria chalumnae</italic> (tax id: 7897), the bacterium <italic toggle="yes">Pseudomonas fluorescens SBW25</italic> (tax id: 216595), and the yeast <italic toggle="yes">S. kudriavzevii IFO 1802</italic> (tax id: 226230). UniProt protein database (2023_03) has been used for the similarity searches (DIAMOND) and Argot predictions. Proteins attributed to the taxonomic group Bacteria have been excluded from UniProt for <italic toggle="yes">P.fluorescens</italic>, whereas proteins associated with the taxon node Eukaryotes have been eliminated for <italic toggle="yes">A.trichopoda</italic>, <italic toggle="yes">S.kudriavzevii IFO 1802</italic>, and <italic toggle="yes">L.chalumnae</italic> before using Argot and DIAMOND. This strategy has been chosen to put DIAMOND and Argot methods under probative test conditions where only distantly related species are available in the protein databank. Annotations obtained from these two methods were filtered using the constraints generated by FunTaxIS-lite and by PANNZER (<xref rid="btad549-B8" ref-type="bibr">Törönen and Holm 2022</xref>), for comparative purposes. The “species-centric” benchmark involves aggregating all the predicted annotations obtained from any protein belonging to the species under evaluation in a single non-redundant set of GO terms. Since a GO term can be associated with multiple target proteins, its score has been defined as the highest score obtained by the prediction tool for that particular GO term. This ensures that the highest confidence is considered for every function attributed to a certain species, while eliminating GO term redundancy. To evaluate the performance, we used the official metrics used in the Critical Assessment of protein Function Annotation challenge (CAFA) (<xref rid="btad549-B9" ref-type="bibr">Zhou <italic toggle="yes">et al.</italic> 2019</xref>): F<sub>max</sub> that is the harmonic mean of precision and recall measures, the weighted F<sub>max</sub> (wF<sub>max</sub>) that considers the information content (<italic toggle="yes">ic</italic>) of each GO term to calculate the F<sub>max</sub> and the minimum semantic distance (S<sub>min</sub>) from the remaining uncertainty (<italic toggle="yes">ru</italic>) and misinformation (<italic toggle="yes">mi</italic>) (<xref rid="btad549-B5" ref-type="bibr">Jiang <italic toggle="yes">et al.</italic> 2016</xref>). The details of the metrics are reported in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material S1</xref>. We have evaluated the metrics for each subontology of GO: Biological Process (BP), Cellular Component (CC), and Molecular Function (MF).</p>
  </sec>
  <sec>
    <title>6 Results</title>
    <p>The constraints generated by FunTaxIS-lite encompass not only its own constraints but also those from GOC. We have conducted a thorough investigation to determine the extent of our automatic taxonomic constraints compared to those provided by GOC, and the differences between them are minimal. The majority of the manually curated GOC constraints are also present in our tool alone. Moreover, our approach, which relies on propagation rules over both the taxonomy and the GO graph, along with the extensive coverage of the taxonomic hierarchy, has enabled us to expand the GOC constraints by an average of 300% in every taxon node considered by GOC (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>).</p>
    <p>When compared with its predecessor version, FunTaxIS-lite always performs better in all the tested scenarios (<xref rid="btad549-T1" ref-type="table">Table 1</xref>) and in any metrics used (see also <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>). The detailed comparison of taxonomic filters applied to DIAMOND and Argot results is presented in <xref rid="btad549-F1" ref-type="fig">Fig. 1</xref> for <italic toggle="yes">P.fluorescens SBW25</italic>. The results for <italic toggle="yes">A.trichopoda</italic>, <italic toggle="yes">L.chalumnae</italic>, and <italic toggle="yes">S.kudriavzevii IFO 1802</italic> are available in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>. The baseline is established by plotting the unfiltered set of GO terms from both Argot and DIAMOND, providing a reference to evaluate the improvements achieved by applying the FunTaxIS-lite and PANNZER filters. The combination of Argot and FunTaxIS-lite filters (argot_FT) demonstrates superior performance in each subontology, as measured by F<sub>max</sub> and wF<sub>max</sub>. For the best S<sub>min</sub> metric, the performance of the DIAMOND + FunTaxIS-lite filters (diamond_FT) is slightly better in BP, while the DIAMOND + PANNZER filters (diamond_PZ) outperform in CC, and Argot + FunTaxIS-lite filters perform better in MF. In general, FunTaxIS-lite performs well across all species used in this study, enhancing the assessment metrics of both DIAMOND and ARGOT unfiltered predictions on average, respectively, by 8.32% and 5.88% for <italic toggle="yes">A.trichopoda</italic>; by 8.63% and 5.58% for <italic toggle="yes">L. calumniae</italic>; by 22.21% and 42.08% for <italic toggle="yes">P.fluorescens SBW25</italic>; by 7.22% and 2.64% for <italic toggle="yes">S. kudriazevii IFO 1802</italic> (for more detailed results see <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>). Performances measured with FunTaxIS-lite filters are overall better than those with PANNZER filters except few cases. PANNZER shows a slight advantage over both wF<sub>max</sub> and S<sub>min</sub> for CC in <italic toggle="yes">P.fluorescens SBW25</italic> and <italic toggle="yes">L.calumniae</italic>. This could be attributed to our strategy, which considers deeper taxonomic nodes compared to PANNZER, enabling the inclusion of IEA annotations in our lists. Further analysis of this effect is presented in Section 7.</p>
    <fig position="float" id="btad549-F1">
      <label>Figure 1.</label>
      <caption>
        <p>Comparison of evaluation metrics of FunTaxIS-lite and PANNZER. (A) This panel shows the performances for the <italic toggle="yes">species P.fluorescens SBW25</italic> (tax ID: 216595). We have evaluated wF<sub>max</sub> for each subontology (BP, CC, and MF) starting from the GO terms extracted by the protein hits found by DIAMOND (dashed line) and Argot (solid line). Performances have been evaluated without filtering (unfilt) and using both FunTaxIS-lite (FT) and PANNZER (PZ) taxonomic constraints. In Panel B, the S<sub>min</sub> evaluation is reported for each subontology.</p>
      </caption>
      <graphic xlink:href="btad549f1" position="float"/>
    </fig>
    <table-wrap position="float" id="btad549-T1">
      <label>Table 1.</label>
      <caption>
        <p>Comparative analysis of FunTaxIS-lite and FunTaxIS.<xref rid="tblfn1" ref-type="table-fn"><sup>a</sup></xref></p>
      </caption>
      <table frame="hsides" rules="groups">
        <colgroup span="1">
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="center" span="1"/>
          <col valign="top" align="center" span="1"/>
          <col valign="top" align="center" span="1"/>
        </colgroup>
        <thead>
          <tr>
            <th rowspan="1" colspan="1">Species</th>
            <th rowspan="1" colspan="1">Ns</th>
            <th rowspan="1" colspan="1">Tool</th>
            <th rowspan="1" colspan="1">F<sub>max</sub></th>
            <th rowspan="1" colspan="1">wF<sub>max</sub></th>
            <th rowspan="1" colspan="1">S<sub>min</sub></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="6" colspan="1">
              <bold>
                <italic toggle="yes">A.trichopoda</italic>
              </bold>
            </td>
            <td rowspan="2" colspan="1">
              <bold>BP</bold>
            </td>
            <td rowspan="1" colspan="1">FT_lite</td>
            <td rowspan="1" colspan="1">
              <bold>0.665</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>0.591</bold>
            </td>
            <td rowspan="1" colspan="1"><bold>37</bold> <bold>367</bold></td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">FT_old</td>
            <td rowspan="1" colspan="1">0.633</td>
            <td rowspan="1" colspan="1">0.562</td>
            <td rowspan="1" colspan="1">38 003</td>
          </tr>
          <tr>
            <td rowspan="2" colspan="1">
              <bold>MF</bold>
            </td>
            <td rowspan="1" colspan="1">FT_lite</td>
            <td rowspan="1" colspan="1">
              <bold>0.778</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>0.711</bold>
            </td>
            <td rowspan="1" colspan="1"><bold>10</bold> <bold>801</bold></td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">FT_old</td>
            <td rowspan="1" colspan="1">0.733</td>
            <td rowspan="1" colspan="1">0.664</td>
            <td rowspan="1" colspan="1">12 421</td>
          </tr>
          <tr>
            <td rowspan="2" colspan="1">
              <bold>CC</bold>
            </td>
            <td rowspan="1" colspan="1">FT_lite</td>
            <td rowspan="1" colspan="1">
              <bold>0.499</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>0.417</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>7171</bold>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">FT_old</td>
            <td rowspan="1" colspan="1">0.485</td>
            <td rowspan="1" colspan="1">0.406</td>
            <td rowspan="1" colspan="1">7187</td>
          </tr>
          <tr>
            <td rowspan="6" colspan="1">
              <bold>
                <italic toggle="yes">L.chalumnae</italic>
              </bold>
            </td>
            <td rowspan="2" colspan="1">
              <bold>BP</bold>
            </td>
            <td rowspan="1" colspan="1">FT_lite</td>
            <td rowspan="1" colspan="1">
              <bold>0.555</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>0.483</bold>
            </td>
            <td rowspan="1" colspan="1"><bold>46</bold> <bold>399</bold></td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">FT_old</td>
            <td rowspan="1" colspan="1">0.537</td>
            <td rowspan="1" colspan="1">0.467</td>
            <td rowspan="1" colspan="1">46 945</td>
          </tr>
          <tr>
            <td rowspan="2" colspan="1">
              <bold>MF</bold>
            </td>
            <td rowspan="1" colspan="1">FT_lite</td>
            <td rowspan="1" colspan="1">
              <bold>0.764</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>0.707</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>9736</bold>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">FT_old</td>
            <td rowspan="1" colspan="1">0.718</td>
            <td rowspan="1" colspan="1">0.659</td>
            <td rowspan="1" colspan="1">11 148</td>
          </tr>
          <tr>
            <td rowspan="2" colspan="1">
              <bold>CC</bold>
            </td>
            <td rowspan="1" colspan="1">FT_lite</td>
            <td rowspan="1" colspan="1">
              <bold>0.522</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>0.456</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>5830</bold>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">FT_old</td>
            <td rowspan="1" colspan="1">0.518</td>
            <td rowspan="1" colspan="1">0.453</td>
            <td rowspan="1" colspan="1">5832</td>
          </tr>
          <tr>
            <td rowspan="6" colspan="1">
              <bold>
                <italic toggle="yes">P.fluorescens SBW25</italic>
              </bold>
            </td>
            <td rowspan="2" colspan="1">
              <bold>BP</bold>
            </td>
            <td rowspan="1" colspan="1">FT_lite</td>
            <td rowspan="1" colspan="1">
              <bold>0.801</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>0.757</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>8905</bold>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">FT_old</td>
            <td rowspan="1" colspan="1">0.702</td>
            <td rowspan="1" colspan="1">0.64</td>
            <td rowspan="1" colspan="1">16 887</td>
          </tr>
          <tr>
            <td rowspan="2" colspan="1">
              <bold>MF</bold>
            </td>
            <td rowspan="1" colspan="1">FT_lite</td>
            <td rowspan="1" colspan="1">
              <bold>0.845</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>0.807</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>4417</bold>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">FT_old</td>
            <td rowspan="1" colspan="1">0.823</td>
            <td rowspan="1" colspan="1">0.781</td>
            <td rowspan="1" colspan="1">5302</td>
          </tr>
          <tr>
            <td rowspan="2" colspan="1">
              <bold>CC</bold>
            </td>
            <td rowspan="1" colspan="1">FT_lite</td>
            <td rowspan="1" colspan="1">
              <bold>0.668</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>0.604</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>936</bold>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">FT_old</td>
            <td rowspan="1" colspan="1">0.508</td>
            <td rowspan="1" colspan="1">0.422</td>
            <td rowspan="1" colspan="1">2298</td>
          </tr>
          <tr>
            <td rowspan="6" colspan="1">
              <bold>
                <italic toggle="yes">S.kudriavzevii IFO 1802</italic>
              </bold>
            </td>
            <td rowspan="2" colspan="1">
              <bold>BP</bold>
            </td>
            <td rowspan="1" colspan="1">FT_lite</td>
            <td rowspan="1" colspan="1">
              <bold>0.778</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>0.732</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>8559</bold>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">FT_old</td>
            <td rowspan="1" colspan="1">0.773</td>
            <td rowspan="1" colspan="1">0.727</td>
            <td rowspan="1" colspan="1">8633</td>
          </tr>
          <tr>
            <td rowspan="2" colspan="1">
              <bold>MF</bold>
            </td>
            <td rowspan="1" colspan="1">FT_lite</td>
            <td rowspan="1" colspan="1">
              <bold>0.822</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>0.784</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>3415</bold>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">FT_old</td>
            <td rowspan="1" colspan="1">0.815</td>
            <td rowspan="1" colspan="1">0.776</td>
            <td rowspan="1" colspan="1">3534</td>
          </tr>
          <tr>
            <td rowspan="2" colspan="1">
              <bold>CC</bold>
            </td>
            <td rowspan="1" colspan="1">FT_lite</td>
            <td rowspan="1" colspan="1">
              <bold>0.559</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>0.499</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>3077</bold>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">FT_old</td>
            <td rowspan="1" colspan="1">0.557</td>
            <td rowspan="1" colspan="1">0.497</td>
            <td rowspan="1" colspan="1">3080</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <fn id="tblfn1">
          <label>a</label>
          <p>The table shows the performance comparison between FunTaxIS-lite (FT_lite) and the previous version (FT_old). The results for <italic toggle="yes">A.trichopoda</italic>, <italic toggle="yes">L.chalumnae</italic>, <italic toggle="yes">P.fluorescens SBW25</italic>, and <italic toggle="yes">S.kudriavzevii IFO 1802</italic> are reported. The metrics F<sub>max</sub>, wF<sub>max</sub>, and S<sub>min</sub> have been calculated for the BP, MF, and CC subontologies for each species. The best performing filter between FunTaxIS-lite and old FunTaxIS is highlighted in bold. The table exclusively presents Argot results as the performances of DIAMOND are found to be identical.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
  </sec>
  <sec>
    <title>7 Discussion</title>
    <p>The process of functional annotation of genes and proteins largely depends on automated tools (over 98% of annotations are IEA), which perform functional transfer between highly (and experimentally) studied organisms and other, less known, species. This process must be tightly regulated, to avoid the erroneous transfer of functions that are not present in the functional domain of the recipient organism. On the other hand, if functional transfer between species is not allowed, the annotation coverage of millions of proteins present in UniProt databank would be marginal. The generation of functional constraints for the entire taxonomy is a challenging task, particularly due to biases inherent in functional databases and the limited availability of experimental studies. To ensure a wide coverage of the constraints over the taxonomy, the exploitation of experimental annotations alone is not sufficient, making it necessary to rely also on electronically inferred functions. Additionally, experimental annotations are not always reliable, as we pointed out with some examples in the introduction section to achieve this accomplishment, we have developed FunTaxIS-lite, which provides information about allowed/forbidden annotations at the species level for almost the entire taxonomy. To mitigate the biases of functional databases, we have employed two complementary strategies. Firstly, we have considered as many model organisms as possible, thereby increasing the granularity of the functional domains. Secondly, we have restricted the generation of constraints to functions that are adequately represented in GOA, excluding highly specific functions that may be associated exclusively with a single model organism. The significant difference in the number of “never_in” constraints provided by FunTaxIS-lite compared to GOC is noteworthy. This outcome is a direct result of the strategic approach we have implemented, which involves exploring both the taxonomy and the Gene Ontology (GO) graph. As a result, we not only obtain more fine-grained constraint lists but also capture a larger amount of information embedded in the databases.</p>
    <p>The improvement in prediction performance when filters are applied shows a great difference between <italic toggle="yes">P.fluorescens SBW25</italic> and all other species. After careful investigation, we have identified two main factors that are responsible for this effect. Firstly, the benchmarking approach involved excluding all proteins related to <italic toggle="yes">Bacteria</italic> and its taxonomic descendants from the database during the prediction process, which led to a much higher number of incorrect annotations (False Positives hits) compared to the other three species. In addition, generating “never-in” filters for bacterial species has proven to be less challenging than for other taxonomic nodes due to the reduced functional variability within the taxonomic node <italic toggle="yes">Bacteria</italic>. The combined effect of these two factors, (i) high quality filters and (ii) predictions with a very high background noise, has contributed significantly to the marked increase in prediction performance for <italic toggle="yes">P.fluorescens SBW25</italic> compared to the other three species. This has been observed both for FunTaxIS-lite and PANNZER filters.</p>
    <p>In comparison with PANNZER, which is another tool with similar purposes, FunTaxIS-lite displays better performance on most of the tested settings, with differences that are likely due to the different logical approaches of the two algorithms. FunTaxIS-lite defines a list of prohibited GO terms for many different nodes across the taxonomy, while PANNZER define the GO terms that are allowed for only highly generic taxon nodes and inherited by all their descendants. This approach, although valid in many cases, can sometimes lead to wrong outcomes. To make an example, we have found that some GO terms predicted for the species evaluated in the benchmark were not purged by the PANNZER filters. For example, both Argot and DIAMOND erroneously reported the GO term “GO:0009521” photosystem for the species <italic toggle="yes">P.fluorescens SBW25</italic>. This GO term is correct for some prokaryotes (<italic toggle="yes">cyanobacteria</italic>, for example), but this is not true for <italic toggle="yes">Pseudomonadales</italic>, belonging to a completely different branch of prokaryotes. The PANNZER filters are also too stringent in a few cases, as they purge correct GO terms from the ground truth. For example, the term “GO:0006147” guanine catabolic process is vastly present in many bacteria, including <italic toggle="yes">Pseudomonadales</italic>, as IEA annotations (&gt;25 000) and is thus reasonably associated with bacteria, but disallowed by PANNZER non-IEA based filters.</p>
  </sec>
  <sec>
    <title>8 Conclusions</title>
    <p>To summarize, the taxonomic filters generated by FunTaxIS-lite are useful for both curators and biologists. They can be used in different scenarios. (i) Investigating specific functions oddly absent in some taxa. (ii) Spotting possible errors in the database. If a particular function is reported for a taxon, but it is not allowed by the taxonomic filters, then it is possible that the annotation is incorrect. (iii) Refining the output of automatic protein function prediction tools. Automatic protein function prediction tools use a variety of sources of information to predict the functions of proteins. However, these tools can sometimes make mistakes. By using the taxonomic filters, it is possible to remove some false positive annotations from the output of these tools, which can improve the accuracy of the predictions. As shown in the results comparing the unfiltered versus filtered results of Argot, the taxonomic filters can significantly improve the accuracy of automatic protein function prediction tools.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad549_Supplementary_Data</label>
      <media xlink:href="btad549_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>All the evaluation metrics were performed with the CAFA-evaluator tool (<ext-link xlink:href="https://github.com/BioComputingUP/CAFA-evaluator" ext-link-type="uri">https://github.com/BioComputingUP/CAFA-evaluator</ext-link>).</p>
    <p>We thank Davide Storato for his help in developing the tool.</p>
  </ack>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by Ministero dell’Istruzione, dell’Università e della Ricerca, PON [Grant No. DOT1319403-4] and Università degli Studi di Padova, Italy [Local Grant No. DOR2020].</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>FunTaxIS-lite is available on <ext-link xlink:href="https://www.medcomp.medicina.unipd.it/funtaxis-lite" ext-link-type="uri">https://www.medcomp.medicina.unipd.it/funtaxis-lite</ext-link> and from <ext-link xlink:href="https://github.com/MedCompUnipd/FunTaxIS-lite" ext-link-type="uri">https://github.com/MedCompUnipd/FunTaxIS-lite</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad549-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ashburner</surname><given-names>M</given-names></string-name>, <string-name><surname>Ball</surname><given-names>CA</given-names></string-name>, <string-name><surname>Blake</surname><given-names>JA</given-names></string-name></person-group><etal>et al</etal><article-title>Gene ontology: tool for the unification of biology</article-title>. <source>Nat Genet</source><year>2000</year>;<volume>25</volume>:<fpage>25</fpage>–<lpage>9</lpage>. <pub-id pub-id-type="doi">10.1038/75556</pub-id><pub-id pub-id-type="pmid">10802651</pub-id></mixed-citation>
    </ref>
    <ref id="btad549-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buchfink</surname><given-names>B</given-names></string-name>, <string-name><surname>Xie</surname><given-names>C</given-names></string-name>, <string-name><surname>Huson</surname><given-names>DH.</given-names></string-name></person-group><article-title>Fast and sensitive protein alignment using DIAMOND</article-title>. <source>Nat Methods</source><year>2015</year>;<volume>12</volume>:<fpage>59</fpage>–<lpage>60</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.3176</pub-id><pub-id pub-id-type="pmid">25402007</pub-id></mixed-citation>
    </ref>
    <ref id="btad549-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Falda</surname><given-names>M</given-names></string-name>, <string-name><surname>Lavezzo</surname><given-names>E</given-names></string-name>, <string-name><surname>Fontana</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>Eliciting the functional taxonomy from protein annotations and taxa</article-title>. <source>Sci Rep</source><year>2016</year>;<volume>6</volume>:<fpage>31971</fpage>. <pub-id pub-id-type="doi">10.1038/srep31971</pub-id><pub-id pub-id-type="pmid">27534507</pub-id></mixed-citation>
    </ref>
    <ref id="btad549-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gilks</surname><given-names>WR</given-names></string-name>, <string-name><surname>Audit</surname><given-names>B</given-names></string-name>, <string-name><surname>De Angelis</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal><article-title>Percolation of annotation errors through hierarchically structured protein sequence databases</article-title>. <source>Math Biosci</source><year>2005</year>;<volume>193</volume>:<fpage>223</fpage>–<lpage>34</lpage>. <pub-id pub-id-type="doi">10.1016/j.mbs.2004.08.001</pub-id><pub-id pub-id-type="pmid">15748731</pub-id></mixed-citation>
    </ref>
    <ref id="btad549-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jiang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Oron</surname><given-names>TR</given-names></string-name>, <string-name><surname>Clark</surname><given-names>WT</given-names></string-name></person-group><etal>et al</etal><article-title>An expanded evaluation of protein function prediction methods shows an improvement in accuracy</article-title>. <source>Genome Biol</source><year>2016</year>;<volume>17</volume>:<fpage>184</fpage>. <pub-id pub-id-type="doi">10.1186/s13059-016-1037-6</pub-id><pub-id pub-id-type="pmid">27604469</pub-id></mixed-citation>
    </ref>
    <ref id="btad549-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lavezzo</surname><given-names>E</given-names></string-name>, <string-name><surname>Falda</surname><given-names>M</given-names></string-name>, <string-name><surname>Fontana</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>Enhancing protein function prediction with taxonomic constraints—the Argot2.5 web server</article-title>. <source>Methods</source><year>2016</year>;<volume>93</volume>:<fpage>15</fpage>–<lpage>23</lpage>. <pub-id pub-id-type="doi">10.1016/j.ymeth.2015.08.021</pub-id><pub-id pub-id-type="pmid">26318087</pub-id></mixed-citation>
    </ref>
    <ref id="btad549-B7">
      <mixed-citation publication-type="journal"><collab>The Gene Ontology Consortium</collab>. <article-title>The gene ontology resource: enriching a GOld mine</article-title>. <source>Nucleic Acids Res</source><year>2021</year>;<volume>49</volume>:<fpage>D325</fpage>–<lpage>34</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkaa1113</pub-id><pub-id pub-id-type="pmid">33290552</pub-id></mixed-citation>
    </ref>
    <ref id="btad549-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Törönen</surname><given-names>P</given-names></string-name>, <string-name><surname>Holm</surname><given-names>L.</given-names></string-name></person-group><article-title>PANNZER—a practical tool for protein function prediction</article-title>. <source>Protein Sci</source><year>2022</year>;<volume>31</volume>:<fpage>118</fpage>–<lpage>28</lpage>. <pub-id pub-id-type="doi">10.1002/pro.4193</pub-id><pub-id pub-id-type="pmid">34562305</pub-id></mixed-citation>
    </ref>
    <ref id="btad549-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhou</surname><given-names>N</given-names></string-name>, <string-name><surname>Jiang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Bergquist</surname><given-names>TR</given-names></string-name></person-group><etal>et al</etal><article-title>The CAFA challenge reports improved protein function prediction and new functional annotations for hundreds of genes through experimental screens</article-title>. <source>Genome Biol</source><year>2019</year>;<volume>20</volume>:<fpage>244</fpage>. <pub-id pub-id-type="doi">10.1186/s13059-019-1835-8</pub-id><pub-id pub-id-type="pmid">31744546</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10500080</article-id>
    <article-id pub-id-type="pmid">37672040</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad549</article-id>
    <article-id pub-id-type="publisher-id">btad549</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Databases and Ontologies</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>FunTaxIS-lite: a simple and light solution to investigate protein functions in all living organisms</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Bianca</surname>
          <given-names>Federico</given-names>
        </name>
        <aff><institution>Computational Medicine Group (MedComp), Department of Molecular Medicine, University of Padova</institution>, Padova, <country country="IT">Italy</country></aff>
        <xref rid="btad549-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ispano</surname>
          <given-names>Emilio</given-names>
        </name>
        <aff><institution>Computational Medicine Group (MedComp), Department of Molecular Medicine, University of Padova</institution>, Padova, <country country="IT">Italy</country></aff>
        <xref rid="btad549-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gazzola</surname>
          <given-names>Ermanno</given-names>
        </name>
        <aff><institution>Computational Medicine Group (MedComp), Department of Molecular Medicine, University of Padova</institution>, Padova, <country country="IT">Italy</country></aff>
        <xref rid="btad549-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lavezzo</surname>
          <given-names>Enrico</given-names>
        </name>
        <aff><institution>Computational Medicine Group (MedComp), Department of Molecular Medicine, University of Padova</institution>, Padova, <country country="IT">Italy</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fontana</surname>
          <given-names>Paolo</given-names>
        </name>
        <aff><institution>Research and Innovation Center, Edmund Mach Foundation, San Michele all'Adige</institution>, Trento, <country country="IT">Italy</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-0246-3119</contrib-id>
        <name>
          <surname>Toppo</surname>
          <given-names>Stefano</given-names>
        </name>
        <aff><institution>Computational Medicine Group (MedComp), Department of Molecular Medicine, University of Padova</institution>, Padova, <country country="IT">Italy</country></aff>
        <xref rid="btad549-cor1" ref-type="corresp"/>
        <!--stefano.toppo@unipd.it-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Robinson</surname>
          <given-names>Peter</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad549-cor1">Corresponding author. Computational Medicine Group (MedComp), Department of Molecular Medicine, University of Padova, via Ugo Bassi 58b, 35121 Padova PD, Italy. E-mail: <email>stefano.toppo@unipd.it</email> (S.T.)</corresp>
      <fn id="btad549-FM1">
        <p>Federico Bianca, Emilio Ispano and Ermanno Gazzola contributed equally to this work.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-09-06">
      <day>06</day>
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>06</day>
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>9</issue>
    <elocation-id>btad549</elocation-id>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>2</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>27</day>
        <month>7</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>02</day>
        <month>9</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>05</day>
        <month>9</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>13</day>
        <month>9</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad549.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Defining the full domain of protein functions belonging to an organism is a complex challenge that is due to the huge heterogeneity of the taxonomy, where single or small groups of species can bear unique functional characteristics. FunTaxIS-lite provides a solution to this challenge by determining taxon-based constraints on Gene Ontology (GO) terms, which specify the functions that an organism can or cannot perform. The tool employs a set of rules to generate and spread the constraints across both the taxon hierarchy and the GO graph.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>The taxon-based constraints produced by FunTaxIS-lite extend those provided by the Gene Ontology Consortium by an average of 300%. The implementation of these rules significantly reduces errors in function predictions made by automatic algorithms and can assist in correcting inconsistent protein annotations in databases.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>FunTaxIS-lite is available on <ext-link xlink:href="https://www.medcomp.medicina.unipd.it/funtaxis-lite" ext-link-type="uri">https://www.medcomp.medicina.unipd.it/funtaxis-lite</ext-link> and from <ext-link xlink:href="https://github.com/MedCompUnipd/FunTaxIS-lite" ext-link-type="uri">https://github.com/MedCompUnipd/FunTaxIS-lite</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Ministero dell’Istruzione, dell’Università e della Ricerca, PON</institution>
          </institution-wrap>
        </funding-source>
        <award-id>DOT1319403-4</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Università degli Studi di Padova, Italy</institution>
          </institution-wrap>
        </funding-source>
        <award-id>DOR2020</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="5"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The sequence data for many species has increased significantly due to the progress in omics sciences. However, characterizing the functional aspects of taxonomy poses substantial challenges. To address this, the Gene Ontology Consortium has collaborated internationally to provide ontologies describing unequivocally gene functions (GO terms) which are integrated in a direct acyclic graph. While GO-encoded annotations are independent of species, many of these annotations represent functions and biological processes that are not universally present across all taxa. The absence of explicit formalization regarding the specific protein functions that a particular species can exhibit (referred to as taxon constraints) can lead to improper functional transfers between proteins of different species, solely based on shared sequence similarities. Considering that protein/gene information in databases typically includes the species of origin, it becomes feasible to implicitly partition the GO graph based on taxonomic criteria. In this context, two types of taxonomic constraints can be identified: positive (“only-in-taxon”) and negative (“never-in-taxon”) relationships. Positive relationships define GO terms that can solely annotate a specific taxon, while negative relationships indicate GO terms that can never be applied to a taxon. The need to create taxonomic constraints appeared clear with the growth of the databases accumulating issues in the protein annotations due to the percolation of errors (<xref rid="btad549-B4" ref-type="bibr">Gilks <italic toggle="yes">et al.</italic> 2005</xref>). These problems persist not only in the protein annotations created automatically and labeled as “Inferred from Electronic Annotation” (IEA), which amount to 98% of the total annotations available, but also in manually curated protein functions. In GOA release of June 2023, for instance, “chloroplast thylakoid” (GO id: GO:0009534) is used to annotate two proteins Q38AK2 and Q4Q1E9 belonging to <italic toggle="yes">Trypanosoma brucei brucei</italic> and <italic toggle="yes">Leishmania major</italic>, respectively with the manually reviewed code Inferred from Biological aspect of Ancestor (IBA). These parasitic protozoans, that cause the sleeping sickness (<italic toggle="yes">Trypanosoma</italic>) and leishmaniasis (<italic toggle="yes">Leishmania</italic>) in humans, lack chloroplasts. For these reasons, since 2010, the Gene Ontology Consortium has developed a manually validated list of taxonomic constraints, specifying them at various levels of the ontology. However, manually defining constraints for over 40 000 GO terms and hundreds of thousands of species is a demanding task and present coverage of both species and GO terms is poor. To address this challenge, we have developed FunTaxIS-lite as an enhanced and faster version of its predecessor, FunTaxIS (<xref rid="btad549-B3" ref-type="bibr">Falda <italic toggle="yes">et al.</italic> 2016</xref>). FunTaxIS-lite enables the inference of functional peculiarities and similarities between different taxa, determining the presence or absence of specific functions in the vast majority of organism/species. The tool aims at: (i) being as broader as possible in covering the taxonomic tree and the GO graph, (ii) helping function prediction tools to discard wrong predicted annotations for the species under study, and (iii) helping database curators to fix potential issues of annotations in databanks.</p>
  </sec>
  <sec>
    <title>2 FunTaxIS-lite pipeline</title>
    <p>FunTaxIS-lite automatically assigns GO constraints to specific taxa and is able to integrate both the constraints defined by the GO Consortium (GOC) (<xref rid="btad549-B1" ref-type="bibr">Ashburner <italic toggle="yes">et al.</italic> 2000</xref>, <xref rid="btad549-B7" ref-type="bibr">The Gene Ontology Consortium 2021</xref>) and those manually curated by the user. This ensures a refined and tailored annotation process for exploring functional peculiarities across the taxonomic tree. The input files of the tool are the GOA database, the taxonomy database from NCBI, and the GO graph in Web Ontology Language (OWL) format. A breakdown of the main steps of the FunTaxIS-lite pipeline are herein explained (for further details, see <xref rid="sup1" ref-type="supplementary-material">Supplementary Material S1</xref>).</p>
    <list list-type="bullet">
      <list-item>
        <p>Gene Otology Annotation (GOA) database cleaning step: GOA annotations undergo a cleaning process. The tool removes: annotations with no biological data available (“ND” evidence code), annotations stating that a protein does not perform a specific function (“NOT” evidence code), root GO terms (GO:0005575, GO:0008150, and GO:0003674) and annotations related to the tags “RNAcentral” and “environmental samples.”</p>
      </list-item>
      <list-item>
        <p>Taxonomic Reference Nodes determination: a list of highly annotated taxonomic reference node which are used to group organisms based on common biological traits, is established. The objective is to have a reliable set of constraints for each species subsumed by these reference taxa and to cover a broad range of the taxonomy hierarchy.</p>
      </list-item>
      <list-item>
        <p>Grouping GOs and cumulative frequencies calculation: GO annotations in the GOA database are grouped by organisms and, for each organism, a list of associated GO terms is generated. Each organism is traced back to its closest reference parent node. Then, for each GO term in the reference node, the cumulative frequency over its GO descendants is calculated.</p>
      </list-item>
      <list-item>
        <p>Creation of “never_in” GO Taxon Constraints: only GO terms with a cumulative frequency of at least 500 in the whole GOA database are considered. GO terms with a cumulative frequency of 0 in the reference taxon node are marked as “never_in” for that node and for all its descendant species. This means that the GO term (and all of its descendant GO terms in the GO graph) cannot be used to annotate any protein product in any species that belongs to the reference taxon node.</p>
      </list-item>
      <list-item>
        <p>Merging automatic, GOC, and manual constraints: in the final step, the automatic constraints generated by the FunTaxIS-lite program are combined with the GOC constraints, with the latter taking precedence in case of conflicts. The GOC constraints are defined as “never_in” or “only_in”, where “only_in” constraints specify that certain GO terms are restricted to a specific taxon. These constraints are converted into “never_in” for all of the species except those where the “only_in” is specified and added to the existing constraints. Moreover, a list of “manual constraints” is made based on direct observation of annotation issues that can be created by the end-user following a simple syntax in a configuration file. These constraints have the highest priority in the pipeline.</p>
      </list-item>
    </list>
  </sec>
  <sec>
    <title>3 FunTaxIS-lite web server</title>
    <p>FunTaxIS-lite is a freely accessible web site (<ext-link xlink:href="https://www.medcomp.medicina.unipd.it/funtaxis-lite" ext-link-type="uri">https://www.medcomp.medicina.unipd.it/funtaxis-lite</ext-link>) and downloadable tool (<ext-link xlink:href="https://github.com/MedCompUnipd/FunTaxIS-lite" ext-link-type="uri">https://github.com/MedCompUnipd/FunTaxIS-lite</ext-link>). Browsing the web site, the user can visualize and/or download the list of all prohibited GO terms (“never_in”) in tabular format by looking for taxa via taxonomic id or taxon name. FunTaxIS-lite tool can also be installed and run locally, allowing the user to explore different options and to add custom manual constraints to generate from scratch the lists of “never-in” terms. The parameters which can be customized are the database files from which the constraints are generated (GO graph file, GOA file, NCBI taxonomy files), the list of manual constraints and the cutoff on the cumulative frequency threshold.</p>
  </sec>
  <sec>
    <title>4 FunTaxIS-lite vs FunTaxIS old version</title>
    <p>FunTaxIS-lite is faster and more user-friendly than the previous version. One of the principal changes that differentiates it from FunTaxIS is the user’s capability to add the manually validated constraints to the automatically generated constraints, as well as those supplied by the GOC.</p>
    <p>The main changes are:</p>
    <list list-type="bullet">
      <list-item>
        <p>The number of “reference taxon nodes” has been expanded from 50 to 171 thanks to a new automated selection process based on the quantity and diversity of annotations at specific taxonomic nodes. The growth of the GOA dataset over time has also enabled this expansion of “reference taxon nodes.” The uneven distribution of annotations across taxa in the GOA has forced us to introduce two categories of reference taxonomic nodes: “Reliable” (70) and “Unreliable” (101). The “Reliable” nodes represent high-confidence nodes in the taxonomic hierarchy that group well-annotated branches. They owe their robustness to the inclusion of extensively studied model organisms with rich functional information. On the other hand, the “Unreliable” nodes group poorly annotated taxonomic branches with limited available knowledge for which the tool is able to define a small but usable set of constraints.</p>
      </list-item>
      <list-item>
        <p>Simplification of calculations. Within the tool, we have made the selection of “never_in” GO terms more efficient by removing the previous fuzzy logic that didn’t provide any effective contribution.</p>
      </list-item>
      <list-item>
        <p>Completely revisited the integration of GOC constraints due to the introduction of the novel manual constraints and resolution of potential conflicts among manual and automatic constraints.</p>
      </list-item>
      <list-item>
        <p>A more user-friendly, light, and effective web site has been developed, offering rapid access to the “never_in” GO list corresponding to any species within the taxonomic tree. All the taxon-constraints are precomputed and loaded into the database, which is periodically updated by our research group, according to the latest releases of GO, GOA, and Taxonomy databases.</p>
      </list-item>
    </list>
  </sec>
  <sec>
    <title>5 Benchmark datasets and assessment</title>
    <p>The “functional domain” created by FunTaxIS-lite refers to a collection of Gene Ontology (GO) terms that establish the defined boundaries within which the species can exert its own functions. We performed a “species-centric” assessment by designing a benchmark where a similarity search based on DIAMOND (<xref rid="btad549-B2" ref-type="bibr">Buchfink <italic toggle="yes">et al.</italic> 2015</xref>) and our automatic function prediction tool Argot (<xref rid="btad549-B6" ref-type="bibr">Lavezzo <italic toggle="yes">et al.</italic> 2016</xref>) have been challenged to annotate the proteins coming from four different species in a classical blind test. The four species have been chosen as representatives of highly different taxonomic ranks: the plant <italic toggle="yes">Amborella trichopoda</italic> (tax id: 13333), the lobe-fin bony fish <italic toggle="yes">Latimeria chalumnae</italic> (tax id: 7897), the bacterium <italic toggle="yes">Pseudomonas fluorescens SBW25</italic> (tax id: 216595), and the yeast <italic toggle="yes">S. kudriavzevii IFO 1802</italic> (tax id: 226230). UniProt protein database (2023_03) has been used for the similarity searches (DIAMOND) and Argot predictions. Proteins attributed to the taxonomic group Bacteria have been excluded from UniProt for <italic toggle="yes">P.fluorescens</italic>, whereas proteins associated with the taxon node Eukaryotes have been eliminated for <italic toggle="yes">A.trichopoda</italic>, <italic toggle="yes">S.kudriavzevii IFO 1802</italic>, and <italic toggle="yes">L.chalumnae</italic> before using Argot and DIAMOND. This strategy has been chosen to put DIAMOND and Argot methods under probative test conditions where only distantly related species are available in the protein databank. Annotations obtained from these two methods were filtered using the constraints generated by FunTaxIS-lite and by PANNZER (<xref rid="btad549-B8" ref-type="bibr">Törönen and Holm 2022</xref>), for comparative purposes. The “species-centric” benchmark involves aggregating all the predicted annotations obtained from any protein belonging to the species under evaluation in a single non-redundant set of GO terms. Since a GO term can be associated with multiple target proteins, its score has been defined as the highest score obtained by the prediction tool for that particular GO term. This ensures that the highest confidence is considered for every function attributed to a certain species, while eliminating GO term redundancy. To evaluate the performance, we used the official metrics used in the Critical Assessment of protein Function Annotation challenge (CAFA) (<xref rid="btad549-B9" ref-type="bibr">Zhou <italic toggle="yes">et al.</italic> 2019</xref>): F<sub>max</sub> that is the harmonic mean of precision and recall measures, the weighted F<sub>max</sub> (wF<sub>max</sub>) that considers the information content (<italic toggle="yes">ic</italic>) of each GO term to calculate the F<sub>max</sub> and the minimum semantic distance (S<sub>min</sub>) from the remaining uncertainty (<italic toggle="yes">ru</italic>) and misinformation (<italic toggle="yes">mi</italic>) (<xref rid="btad549-B5" ref-type="bibr">Jiang <italic toggle="yes">et al.</italic> 2016</xref>). The details of the metrics are reported in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material S1</xref>. We have evaluated the metrics for each subontology of GO: Biological Process (BP), Cellular Component (CC), and Molecular Function (MF).</p>
  </sec>
  <sec>
    <title>6 Results</title>
    <p>The constraints generated by FunTaxIS-lite encompass not only its own constraints but also those from GOC. We have conducted a thorough investigation to determine the extent of our automatic taxonomic constraints compared to those provided by GOC, and the differences between them are minimal. The majority of the manually curated GOC constraints are also present in our tool alone. Moreover, our approach, which relies on propagation rules over both the taxonomy and the GO graph, along with the extensive coverage of the taxonomic hierarchy, has enabled us to expand the GOC constraints by an average of 300% in every taxon node considered by GOC (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>).</p>
    <p>When compared with its predecessor version, FunTaxIS-lite always performs better in all the tested scenarios (<xref rid="btad549-T1" ref-type="table">Table 1</xref>) and in any metrics used (see also <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>). The detailed comparison of taxonomic filters applied to DIAMOND and Argot results is presented in <xref rid="btad549-F1" ref-type="fig">Fig. 1</xref> for <italic toggle="yes">P.fluorescens SBW25</italic>. The results for <italic toggle="yes">A.trichopoda</italic>, <italic toggle="yes">L.chalumnae</italic>, and <italic toggle="yes">S.kudriavzevii IFO 1802</italic> are available in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>. The baseline is established by plotting the unfiltered set of GO terms from both Argot and DIAMOND, providing a reference to evaluate the improvements achieved by applying the FunTaxIS-lite and PANNZER filters. The combination of Argot and FunTaxIS-lite filters (argot_FT) demonstrates superior performance in each subontology, as measured by F<sub>max</sub> and wF<sub>max</sub>. For the best S<sub>min</sub> metric, the performance of the DIAMOND + FunTaxIS-lite filters (diamond_FT) is slightly better in BP, while the DIAMOND + PANNZER filters (diamond_PZ) outperform in CC, and Argot + FunTaxIS-lite filters perform better in MF. In general, FunTaxIS-lite performs well across all species used in this study, enhancing the assessment metrics of both DIAMOND and ARGOT unfiltered predictions on average, respectively, by 8.32% and 5.88% for <italic toggle="yes">A.trichopoda</italic>; by 8.63% and 5.58% for <italic toggle="yes">L. calumniae</italic>; by 22.21% and 42.08% for <italic toggle="yes">P.fluorescens SBW25</italic>; by 7.22% and 2.64% for <italic toggle="yes">S. kudriazevii IFO 1802</italic> (for more detailed results see <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>). Performances measured with FunTaxIS-lite filters are overall better than those with PANNZER filters except few cases. PANNZER shows a slight advantage over both wF<sub>max</sub> and S<sub>min</sub> for CC in <italic toggle="yes">P.fluorescens SBW25</italic> and <italic toggle="yes">L.calumniae</italic>. This could be attributed to our strategy, which considers deeper taxonomic nodes compared to PANNZER, enabling the inclusion of IEA annotations in our lists. Further analysis of this effect is presented in Section 7.</p>
    <fig position="float" id="btad549-F1">
      <label>Figure 1.</label>
      <caption>
        <p>Comparison of evaluation metrics of FunTaxIS-lite and PANNZER. (A) This panel shows the performances for the <italic toggle="yes">species P.fluorescens SBW25</italic> (tax ID: 216595). We have evaluated wF<sub>max</sub> for each subontology (BP, CC, and MF) starting from the GO terms extracted by the protein hits found by DIAMOND (dashed line) and Argot (solid line). Performances have been evaluated without filtering (unfilt) and using both FunTaxIS-lite (FT) and PANNZER (PZ) taxonomic constraints. In Panel B, the S<sub>min</sub> evaluation is reported for each subontology.</p>
      </caption>
      <graphic xlink:href="btad549f1" position="float"/>
    </fig>
    <table-wrap position="float" id="btad549-T1">
      <label>Table 1.</label>
      <caption>
        <p>Comparative analysis of FunTaxIS-lite and FunTaxIS.<xref rid="tblfn1" ref-type="table-fn"><sup>a</sup></xref></p>
      </caption>
      <table frame="hsides" rules="groups">
        <colgroup span="1">
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="center" span="1"/>
          <col valign="top" align="center" span="1"/>
          <col valign="top" align="center" span="1"/>
        </colgroup>
        <thead>
          <tr>
            <th rowspan="1" colspan="1">Species</th>
            <th rowspan="1" colspan="1">Ns</th>
            <th rowspan="1" colspan="1">Tool</th>
            <th rowspan="1" colspan="1">F<sub>max</sub></th>
            <th rowspan="1" colspan="1">wF<sub>max</sub></th>
            <th rowspan="1" colspan="1">S<sub>min</sub></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="6" colspan="1">
              <bold>
                <italic toggle="yes">A.trichopoda</italic>
              </bold>
            </td>
            <td rowspan="2" colspan="1">
              <bold>BP</bold>
            </td>
            <td rowspan="1" colspan="1">FT_lite</td>
            <td rowspan="1" colspan="1">
              <bold>0.665</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>0.591</bold>
            </td>
            <td rowspan="1" colspan="1"><bold>37</bold> <bold>367</bold></td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">FT_old</td>
            <td rowspan="1" colspan="1">0.633</td>
            <td rowspan="1" colspan="1">0.562</td>
            <td rowspan="1" colspan="1">38 003</td>
          </tr>
          <tr>
            <td rowspan="2" colspan="1">
              <bold>MF</bold>
            </td>
            <td rowspan="1" colspan="1">FT_lite</td>
            <td rowspan="1" colspan="1">
              <bold>0.778</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>0.711</bold>
            </td>
            <td rowspan="1" colspan="1"><bold>10</bold> <bold>801</bold></td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">FT_old</td>
            <td rowspan="1" colspan="1">0.733</td>
            <td rowspan="1" colspan="1">0.664</td>
            <td rowspan="1" colspan="1">12 421</td>
          </tr>
          <tr>
            <td rowspan="2" colspan="1">
              <bold>CC</bold>
            </td>
            <td rowspan="1" colspan="1">FT_lite</td>
            <td rowspan="1" colspan="1">
              <bold>0.499</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>0.417</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>7171</bold>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">FT_old</td>
            <td rowspan="1" colspan="1">0.485</td>
            <td rowspan="1" colspan="1">0.406</td>
            <td rowspan="1" colspan="1">7187</td>
          </tr>
          <tr>
            <td rowspan="6" colspan="1">
              <bold>
                <italic toggle="yes">L.chalumnae</italic>
              </bold>
            </td>
            <td rowspan="2" colspan="1">
              <bold>BP</bold>
            </td>
            <td rowspan="1" colspan="1">FT_lite</td>
            <td rowspan="1" colspan="1">
              <bold>0.555</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>0.483</bold>
            </td>
            <td rowspan="1" colspan="1"><bold>46</bold> <bold>399</bold></td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">FT_old</td>
            <td rowspan="1" colspan="1">0.537</td>
            <td rowspan="1" colspan="1">0.467</td>
            <td rowspan="1" colspan="1">46 945</td>
          </tr>
          <tr>
            <td rowspan="2" colspan="1">
              <bold>MF</bold>
            </td>
            <td rowspan="1" colspan="1">FT_lite</td>
            <td rowspan="1" colspan="1">
              <bold>0.764</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>0.707</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>9736</bold>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">FT_old</td>
            <td rowspan="1" colspan="1">0.718</td>
            <td rowspan="1" colspan="1">0.659</td>
            <td rowspan="1" colspan="1">11 148</td>
          </tr>
          <tr>
            <td rowspan="2" colspan="1">
              <bold>CC</bold>
            </td>
            <td rowspan="1" colspan="1">FT_lite</td>
            <td rowspan="1" colspan="1">
              <bold>0.522</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>0.456</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>5830</bold>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">FT_old</td>
            <td rowspan="1" colspan="1">0.518</td>
            <td rowspan="1" colspan="1">0.453</td>
            <td rowspan="1" colspan="1">5832</td>
          </tr>
          <tr>
            <td rowspan="6" colspan="1">
              <bold>
                <italic toggle="yes">P.fluorescens SBW25</italic>
              </bold>
            </td>
            <td rowspan="2" colspan="1">
              <bold>BP</bold>
            </td>
            <td rowspan="1" colspan="1">FT_lite</td>
            <td rowspan="1" colspan="1">
              <bold>0.801</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>0.757</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>8905</bold>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">FT_old</td>
            <td rowspan="1" colspan="1">0.702</td>
            <td rowspan="1" colspan="1">0.64</td>
            <td rowspan="1" colspan="1">16 887</td>
          </tr>
          <tr>
            <td rowspan="2" colspan="1">
              <bold>MF</bold>
            </td>
            <td rowspan="1" colspan="1">FT_lite</td>
            <td rowspan="1" colspan="1">
              <bold>0.845</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>0.807</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>4417</bold>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">FT_old</td>
            <td rowspan="1" colspan="1">0.823</td>
            <td rowspan="1" colspan="1">0.781</td>
            <td rowspan="1" colspan="1">5302</td>
          </tr>
          <tr>
            <td rowspan="2" colspan="1">
              <bold>CC</bold>
            </td>
            <td rowspan="1" colspan="1">FT_lite</td>
            <td rowspan="1" colspan="1">
              <bold>0.668</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>0.604</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>936</bold>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">FT_old</td>
            <td rowspan="1" colspan="1">0.508</td>
            <td rowspan="1" colspan="1">0.422</td>
            <td rowspan="1" colspan="1">2298</td>
          </tr>
          <tr>
            <td rowspan="6" colspan="1">
              <bold>
                <italic toggle="yes">S.kudriavzevii IFO 1802</italic>
              </bold>
            </td>
            <td rowspan="2" colspan="1">
              <bold>BP</bold>
            </td>
            <td rowspan="1" colspan="1">FT_lite</td>
            <td rowspan="1" colspan="1">
              <bold>0.778</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>0.732</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>8559</bold>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">FT_old</td>
            <td rowspan="1" colspan="1">0.773</td>
            <td rowspan="1" colspan="1">0.727</td>
            <td rowspan="1" colspan="1">8633</td>
          </tr>
          <tr>
            <td rowspan="2" colspan="1">
              <bold>MF</bold>
            </td>
            <td rowspan="1" colspan="1">FT_lite</td>
            <td rowspan="1" colspan="1">
              <bold>0.822</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>0.784</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>3415</bold>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">FT_old</td>
            <td rowspan="1" colspan="1">0.815</td>
            <td rowspan="1" colspan="1">0.776</td>
            <td rowspan="1" colspan="1">3534</td>
          </tr>
          <tr>
            <td rowspan="2" colspan="1">
              <bold>CC</bold>
            </td>
            <td rowspan="1" colspan="1">FT_lite</td>
            <td rowspan="1" colspan="1">
              <bold>0.559</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>0.499</bold>
            </td>
            <td rowspan="1" colspan="1">
              <bold>3077</bold>
            </td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">FT_old</td>
            <td rowspan="1" colspan="1">0.557</td>
            <td rowspan="1" colspan="1">0.497</td>
            <td rowspan="1" colspan="1">3080</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <fn id="tblfn1">
          <label>a</label>
          <p>The table shows the performance comparison between FunTaxIS-lite (FT_lite) and the previous version (FT_old). The results for <italic toggle="yes">A.trichopoda</italic>, <italic toggle="yes">L.chalumnae</italic>, <italic toggle="yes">P.fluorescens SBW25</italic>, and <italic toggle="yes">S.kudriavzevii IFO 1802</italic> are reported. The metrics F<sub>max</sub>, wF<sub>max</sub>, and S<sub>min</sub> have been calculated for the BP, MF, and CC subontologies for each species. The best performing filter between FunTaxIS-lite and old FunTaxIS is highlighted in bold. The table exclusively presents Argot results as the performances of DIAMOND are found to be identical.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
  </sec>
  <sec>
    <title>7 Discussion</title>
    <p>The process of functional annotation of genes and proteins largely depends on automated tools (over 98% of annotations are IEA), which perform functional transfer between highly (and experimentally) studied organisms and other, less known, species. This process must be tightly regulated, to avoid the erroneous transfer of functions that are not present in the functional domain of the recipient organism. On the other hand, if functional transfer between species is not allowed, the annotation coverage of millions of proteins present in UniProt databank would be marginal. The generation of functional constraints for the entire taxonomy is a challenging task, particularly due to biases inherent in functional databases and the limited availability of experimental studies. To ensure a wide coverage of the constraints over the taxonomy, the exploitation of experimental annotations alone is not sufficient, making it necessary to rely also on electronically inferred functions. Additionally, experimental annotations are not always reliable, as we pointed out with some examples in the introduction section to achieve this accomplishment, we have developed FunTaxIS-lite, which provides information about allowed/forbidden annotations at the species level for almost the entire taxonomy. To mitigate the biases of functional databases, we have employed two complementary strategies. Firstly, we have considered as many model organisms as possible, thereby increasing the granularity of the functional domains. Secondly, we have restricted the generation of constraints to functions that are adequately represented in GOA, excluding highly specific functions that may be associated exclusively with a single model organism. The significant difference in the number of “never_in” constraints provided by FunTaxIS-lite compared to GOC is noteworthy. This outcome is a direct result of the strategic approach we have implemented, which involves exploring both the taxonomy and the Gene Ontology (GO) graph. As a result, we not only obtain more fine-grained constraint lists but also capture a larger amount of information embedded in the databases.</p>
    <p>The improvement in prediction performance when filters are applied shows a great difference between <italic toggle="yes">P.fluorescens SBW25</italic> and all other species. After careful investigation, we have identified two main factors that are responsible for this effect. Firstly, the benchmarking approach involved excluding all proteins related to <italic toggle="yes">Bacteria</italic> and its taxonomic descendants from the database during the prediction process, which led to a much higher number of incorrect annotations (False Positives hits) compared to the other three species. In addition, generating “never-in” filters for bacterial species has proven to be less challenging than for other taxonomic nodes due to the reduced functional variability within the taxonomic node <italic toggle="yes">Bacteria</italic>. The combined effect of these two factors, (i) high quality filters and (ii) predictions with a very high background noise, has contributed significantly to the marked increase in prediction performance for <italic toggle="yes">P.fluorescens SBW25</italic> compared to the other three species. This has been observed both for FunTaxIS-lite and PANNZER filters.</p>
    <p>In comparison with PANNZER, which is another tool with similar purposes, FunTaxIS-lite displays better performance on most of the tested settings, with differences that are likely due to the different logical approaches of the two algorithms. FunTaxIS-lite defines a list of prohibited GO terms for many different nodes across the taxonomy, while PANNZER define the GO terms that are allowed for only highly generic taxon nodes and inherited by all their descendants. This approach, although valid in many cases, can sometimes lead to wrong outcomes. To make an example, we have found that some GO terms predicted for the species evaluated in the benchmark were not purged by the PANNZER filters. For example, both Argot and DIAMOND erroneously reported the GO term “GO:0009521” photosystem for the species <italic toggle="yes">P.fluorescens SBW25</italic>. This GO term is correct for some prokaryotes (<italic toggle="yes">cyanobacteria</italic>, for example), but this is not true for <italic toggle="yes">Pseudomonadales</italic>, belonging to a completely different branch of prokaryotes. The PANNZER filters are also too stringent in a few cases, as they purge correct GO terms from the ground truth. For example, the term “GO:0006147” guanine catabolic process is vastly present in many bacteria, including <italic toggle="yes">Pseudomonadales</italic>, as IEA annotations (&gt;25 000) and is thus reasonably associated with bacteria, but disallowed by PANNZER non-IEA based filters.</p>
  </sec>
  <sec>
    <title>8 Conclusions</title>
    <p>To summarize, the taxonomic filters generated by FunTaxIS-lite are useful for both curators and biologists. They can be used in different scenarios. (i) Investigating specific functions oddly absent in some taxa. (ii) Spotting possible errors in the database. If a particular function is reported for a taxon, but it is not allowed by the taxonomic filters, then it is possible that the annotation is incorrect. (iii) Refining the output of automatic protein function prediction tools. Automatic protein function prediction tools use a variety of sources of information to predict the functions of proteins. However, these tools can sometimes make mistakes. By using the taxonomic filters, it is possible to remove some false positive annotations from the output of these tools, which can improve the accuracy of the predictions. As shown in the results comparing the unfiltered versus filtered results of Argot, the taxonomic filters can significantly improve the accuracy of automatic protein function prediction tools.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad549_Supplementary_Data</label>
      <media xlink:href="btad549_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>All the evaluation metrics were performed with the CAFA-evaluator tool (<ext-link xlink:href="https://github.com/BioComputingUP/CAFA-evaluator" ext-link-type="uri">https://github.com/BioComputingUP/CAFA-evaluator</ext-link>).</p>
    <p>We thank Davide Storato for his help in developing the tool.</p>
  </ack>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by Ministero dell’Istruzione, dell’Università e della Ricerca, PON [Grant No. DOT1319403-4] and Università degli Studi di Padova, Italy [Local Grant No. DOR2020].</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>FunTaxIS-lite is available on <ext-link xlink:href="https://www.medcomp.medicina.unipd.it/funtaxis-lite" ext-link-type="uri">https://www.medcomp.medicina.unipd.it/funtaxis-lite</ext-link> and from <ext-link xlink:href="https://github.com/MedCompUnipd/FunTaxIS-lite" ext-link-type="uri">https://github.com/MedCompUnipd/FunTaxIS-lite</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad549-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ashburner</surname><given-names>M</given-names></string-name>, <string-name><surname>Ball</surname><given-names>CA</given-names></string-name>, <string-name><surname>Blake</surname><given-names>JA</given-names></string-name></person-group><etal>et al</etal><article-title>Gene ontology: tool for the unification of biology</article-title>. <source>Nat Genet</source><year>2000</year>;<volume>25</volume>:<fpage>25</fpage>–<lpage>9</lpage>. <pub-id pub-id-type="doi">10.1038/75556</pub-id><pub-id pub-id-type="pmid">10802651</pub-id></mixed-citation>
    </ref>
    <ref id="btad549-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buchfink</surname><given-names>B</given-names></string-name>, <string-name><surname>Xie</surname><given-names>C</given-names></string-name>, <string-name><surname>Huson</surname><given-names>DH.</given-names></string-name></person-group><article-title>Fast and sensitive protein alignment using DIAMOND</article-title>. <source>Nat Methods</source><year>2015</year>;<volume>12</volume>:<fpage>59</fpage>–<lpage>60</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.3176</pub-id><pub-id pub-id-type="pmid">25402007</pub-id></mixed-citation>
    </ref>
    <ref id="btad549-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Falda</surname><given-names>M</given-names></string-name>, <string-name><surname>Lavezzo</surname><given-names>E</given-names></string-name>, <string-name><surname>Fontana</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>Eliciting the functional taxonomy from protein annotations and taxa</article-title>. <source>Sci Rep</source><year>2016</year>;<volume>6</volume>:<fpage>31971</fpage>. <pub-id pub-id-type="doi">10.1038/srep31971</pub-id><pub-id pub-id-type="pmid">27534507</pub-id></mixed-citation>
    </ref>
    <ref id="btad549-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gilks</surname><given-names>WR</given-names></string-name>, <string-name><surname>Audit</surname><given-names>B</given-names></string-name>, <string-name><surname>De Angelis</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal><article-title>Percolation of annotation errors through hierarchically structured protein sequence databases</article-title>. <source>Math Biosci</source><year>2005</year>;<volume>193</volume>:<fpage>223</fpage>–<lpage>34</lpage>. <pub-id pub-id-type="doi">10.1016/j.mbs.2004.08.001</pub-id><pub-id pub-id-type="pmid">15748731</pub-id></mixed-citation>
    </ref>
    <ref id="btad549-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jiang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Oron</surname><given-names>TR</given-names></string-name>, <string-name><surname>Clark</surname><given-names>WT</given-names></string-name></person-group><etal>et al</etal><article-title>An expanded evaluation of protein function prediction methods shows an improvement in accuracy</article-title>. <source>Genome Biol</source><year>2016</year>;<volume>17</volume>:<fpage>184</fpage>. <pub-id pub-id-type="doi">10.1186/s13059-016-1037-6</pub-id><pub-id pub-id-type="pmid">27604469</pub-id></mixed-citation>
    </ref>
    <ref id="btad549-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lavezzo</surname><given-names>E</given-names></string-name>, <string-name><surname>Falda</surname><given-names>M</given-names></string-name>, <string-name><surname>Fontana</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>Enhancing protein function prediction with taxonomic constraints—the Argot2.5 web server</article-title>. <source>Methods</source><year>2016</year>;<volume>93</volume>:<fpage>15</fpage>–<lpage>23</lpage>. <pub-id pub-id-type="doi">10.1016/j.ymeth.2015.08.021</pub-id><pub-id pub-id-type="pmid">26318087</pub-id></mixed-citation>
    </ref>
    <ref id="btad549-B7">
      <mixed-citation publication-type="journal"><collab>The Gene Ontology Consortium</collab>. <article-title>The gene ontology resource: enriching a GOld mine</article-title>. <source>Nucleic Acids Res</source><year>2021</year>;<volume>49</volume>:<fpage>D325</fpage>–<lpage>34</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkaa1113</pub-id><pub-id pub-id-type="pmid">33290552</pub-id></mixed-citation>
    </ref>
    <ref id="btad549-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Törönen</surname><given-names>P</given-names></string-name>, <string-name><surname>Holm</surname><given-names>L.</given-names></string-name></person-group><article-title>PANNZER—a practical tool for protein function prediction</article-title>. <source>Protein Sci</source><year>2022</year>;<volume>31</volume>:<fpage>118</fpage>–<lpage>28</lpage>. <pub-id pub-id-type="doi">10.1002/pro.4193</pub-id><pub-id pub-id-type="pmid">34562305</pub-id></mixed-citation>
    </ref>
    <ref id="btad549-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhou</surname><given-names>N</given-names></string-name>, <string-name><surname>Jiang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Bergquist</surname><given-names>TR</given-names></string-name></person-group><etal>et al</etal><article-title>The CAFA challenge reports improved protein function prediction and new functional annotations for hundreds of genes through experimental screens</article-title>. <source>Genome Biol</source><year>2019</year>;<volume>20</volume>:<fpage>244</fpage>. <pub-id pub-id-type="doi">10.1186/s13059-019-1835-8</pub-id><pub-id pub-id-type="pmid">31744546</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
