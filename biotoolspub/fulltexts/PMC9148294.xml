<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">J Cheminform</journal-id>
    <journal-id journal-id-type="iso-abbrev">J Cheminform</journal-id>
    <journal-title-group>
      <journal-title>Journal of Cheminformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1758-2946</issn>
    <publisher>
      <publisher-name>Springer International Publishing</publisher-name>
      <publisher-loc>Cham</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9148294</article-id>
    <article-id pub-id-type="publisher-id">606</article-id>
    <article-id pub-id-type="doi">10.1186/s13321-022-00606-7</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>canSAR chemistry registration and standardization pipeline</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Dolciami</surname>
          <given-names>Daniela</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Villasclaras-Fernandez</surname>
          <given-names>Eloy</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kannas</surname>
          <given-names>Christos</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Meniconi</surname>
          <given-names>Mirco</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Al-Lazikani</surname>
          <given-names>Bissan</given-names>
        </name>
        <address>
          <email>ballazikani@mdanderson.org</email>
        </address>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Antolin</surname>
          <given-names>Albert A.</given-names>
        </name>
        <address>
          <email>Albert.Antolin@icr.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.18886.3f</institution-id><institution>Department of Data Science, </institution><institution>The Institute of Cancer Research, </institution></institution-wrap>London, SM2 5NG UK </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.18886.3f</institution-id><institution>Cancer Research UK Cancer Therapeutics Unit, </institution><institution>The Institute of Cancer Research, </institution></institution-wrap>London, SM2 5NG UK </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.418151.8</institution-id><institution-id institution-id-type="ISNI">0000 0001 1519 6403</institution-id><institution>Molecular AI, Discovery Sciences, R&amp;D, AstraZeneca, </institution></institution-wrap>Gothenburg, Sweden </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.240145.6</institution-id><institution-id institution-id-type="ISNI">0000 0001 2291 4776</institution-id><institution>MD Anderson Cancer Center, </institution></institution-wrap>Houston, TX 77054 USA </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.507943.c</institution-id><institution-id institution-id-type="ISNI">0000 0004 7536 1038</institution-id><institution>Present Address: BenevolentAI, </institution></institution-wrap>London, W1T 5HD UK </aff>
      <aff id="Aff6"><label>6</label>Present Address: Dunad therapeutics, Cambridge, UK </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>28</day>
      <month>5</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>28</day>
      <month>5</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>14</volume>
    <elocation-id>28</elocation-id>
    <history>
      <date date-type="received">
        <day>4</day>
        <month>2</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>4</day>
        <month>4</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Integration of medicinal chemistry data from numerous public resources is an increasingly important part of academic drug discovery and translational research because it can bring a wealth of important knowledge related to compounds in one place. However, different data sources can report the same or related compounds in various forms (e.g., tautomers, racemates, etc.), thus highlighting the need of organising related compounds in hierarchies that alert the user on important bioactivity data that may be relevant. To generate these compound hierarchies, we have developed and implemented canSARchem, a new compound registration and standardization pipeline as part of the canSAR public knowledgebase. canSARchem builds on previously developed ChEMBL and PubChem pipelines and is developed using KNIME. We describe the pipeline which we make publicly available, and we provide examples on the strengths and limitations of the use of hierarchies for bioactivity data exploration. Finally, we identify canonicalization enrichment in FDA-approved drugs, illustrating the benefits of our approach.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We created a chemical registration and standardization pipeline in KNIME and made it freely available to the research community. The pipeline consists of five steps to register the compounds and create the compounds’ hierarchy: 1. Structure checker, 2. Standardization, 3. Generation of canonical tautomers and representative structures, 4. Salt strip, and 5. Generation of abstract structure to generate the compound hierarchy. Unlike ChEMBL’s RDKit pipeline, we carry out compound canonicalization ahead of getting the parent structure, similar to PubChem’s OpenEye pipeline. canSARchem has a lower rejection rate compared to both PubChem and ChEMBL. We use our pipeline to assess the impact of grouping the compounds in hierarchies for bioactivity data exploration. We find that FDA-approved drugs show statistically significant sensitivity to canonicalization compared to the majority of bioactive compounds which demonstrates the importance of this step.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">We use canSARchem to standardize all the compounds uploaded in canSAR (&gt; 3 million) enabling efficient data integration and the rapid identification of alternative compound forms with useful bioactivity data. Comparison with PubChem and ChEMBL pipelines evidenced comparable performances in compound standardization, but only PubChem and canSAR canonicalize tautomers and canSAR has a slightly lower rejection rate. Our results highlight the importance of compound hierarchies for bioactivity data exploration. We make canSARchem available under a Creative Commons Attribution-ShareAlike 4.0 International License (CC BY-SA 4.0) at <ext-link ext-link-type="uri" xlink:href="https://gitlab.icr.ac.uk/cansar-public/compound-registration-pipeline">https://gitlab.icr.ac.uk/cansar-public/compound-registration-pipeline</ext-link>.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13321-022-00606-7.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>canSAR</kwd>
      <kwd>KNIME</kwd>
      <kwd>Standardization</kwd>
      <kwd>Tautomerism</kwd>
      <kwd>Compound hierarchy</kwd>
      <kwd>FDA-approved drugs</kwd>
      <kwd>Canonicalization</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000289</institution-id>
            <institution>Cancer Research UK</institution>
          </institution-wrap>
        </funding-source>
        <award-id>C35696/A23187</award-id>
        <award-id>C35696/A23187</award-id>
        <award-id>C35696/A23187</award-id>
        <award-id>C309/A11566</award-id>
        <principal-award-recipient>
          <name>
            <surname>Dolciami</surname>
            <given-names>Daniela</given-names>
          </name>
          <name>
            <surname>Villasclaras-Fernandez</surname>
            <given-names>Eloy</given-names>
          </name>
          <name>
            <surname>Kannas</surname>
            <given-names>Christos</given-names>
          </name>
          <name>
            <surname>Al-Lazikani</surname>
            <given-names>Bissan</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100010269</institution-id>
            <institution>Wellcome Trust</institution>
          </institution-wrap>
        </funding-source>
        <award-id>212969/Z/18/Z</award-id>
        <award-id>204735/Z/16/Z</award-id>
        <principal-award-recipient>
          <name>
            <surname>Al-Lazikani</surname>
            <given-names>Bissan</given-names>
          </name>
          <name>
            <surname>Antolin</surname>
            <given-names>Albert A.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100011264</institution-id>
            <institution>FP7 People: Marie-Curie Actions</institution>
          </institution-wrap>
        </funding-source>
        <award-id>FP7/2007–2013</award-id>
        <principal-award-recipient>
          <name>
            <surname>Antolin</surname>
            <given-names>Albert A.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par4">canSAR (<ext-link ext-link-type="uri" xlink:href="http://cansar.icr.ac.uk">http://cansar.icr.ac.uk</ext-link>) [<xref ref-type="bibr" rid="CR1">1</xref>] is the largest, public, integrative drug discovery knowledgebase with a primary focus on oncology but also useful and easily extendable to other diseases [<xref ref-type="bibr" rid="CR2">2</xref>]. canSAR integrates vast multidisciplinary data including chemical, drug, pharmacological, genomic, and protein data with structural biology and protein networks, among others. canSAR is widely used internationally by academia and industry and provides AI-informed target assessment and druggability across the human proteome and support for experimental design in translational research. Crucially, canSAR also provides unique data, curation and annotation, particularly on cancer drugs and their mechanisms of action, and chemical probes in close collaboration with The Chemical Probes Portal [<xref ref-type="bibr" rid="CR3">3</xref>]. Currently, canSAR integrates information from 3,455,492 unique 2D chemical structures from ChEMBL [<xref ref-type="bibr" rid="CR4">4</xref>], BindingDB [<xref ref-type="bibr" rid="CR5">5</xref>], PDB [<xref ref-type="bibr" rid="CR6">6</xref>], The Chemical Probes Portal [<xref ref-type="bibr" rid="CR3">3</xref>] as well as additional bioactive compounds that we curated from the literature. In a recent analysis, we identified that many valuable, high-quality chemical probes were originally published outside the medicinal chemistry literature and therefore absent from public databases such as ChEMBL or BindingDB [<xref ref-type="bibr" rid="CR7">7</xref>]. Accordingly, we started to abstract and curate these valuable chemical structures and associated bioactivity data from the literature in collaboration with The Chemical Probes Portal. During this exercise, we encountered several challenges, particularly: 1. The need to have a robust and transparent chemical registration pipeline to handle these disparate types of data and 2. To handle the different forms and representations of compounds coming from different sources. This latter point is particularly pertinent as compounds can sometimes be registered as separate entities in public databases and linked to different data (e.g., tautomers), and also with different double bond isomerism, salt stripping, stereoisomerism and isotope annotations. To better serve our users, we needed a means to link these compounds and their associated data in a transparent and traceable way; alert about the existence of relevant information that may otherwise be missed and enable the seamless exploration of their bioactivity data. canSAR initially utilised the ChEMBL pipeline because it is transparent, robust and publicly available [<xref ref-type="bibr" rid="CR8">8</xref>]. However, it was designed to serve a different purpose, namely faithfully preserving the original sources of data, and it did not enable to create the compound hierarchy that we envisioned, including handling issues around tautomers, canonicalization, etc. The NIH/CADD pipeline addressed these issues effectively, but it is built using commercial software and is therefore not available for download and implementation in the public domain [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>].</p>
    <p id="Par5">Building on these two approaches, and to facilitate better integration of all these chemical and biological sources of information, we developed a new canSAR chemistry registration and standardization pipeline, canSARchem, and its full open access version, canSARchem_RDKit. Both pipelines are implemented with the KNIME [<xref ref-type="bibr" rid="CR10">10</xref>] analytics platform, and we have made them freely and publicly available.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Using a non-standard InChI as a unique identifier</title>
      <p id="Par6">To enable this integration, we carefully considered the best standardization and generation of a unique identifier to assign to each chemical structure irrespective of its source. Challenges of large-scale 2D chemical structure database integration related to the use of specific machine-readable chemical structure representations are well documented [<xref ref-type="bibr" rid="CR11">11</xref>–<xref ref-type="bibr" rid="CR16">16</xref>]. It is known that widely-used chemical structure representations such as the simplified molecular input line entry system (SMILES) are not unique [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>]. The IUPAC developed the Standard InChI (International Chemistry Identifier) to alleviate some of these issues, but certain limitations remain, particularly at handling tautomeric forms, some of which are aggregated into the same Standard InChI [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR20">20</xref>]. Overall, the choice of the most appropriate chemical structure representation is strategic, also for the assessment of the uniqueness in the dataset itself. Some databases use the Standard InChI as their unique identifier, but it has some limitations, for example at handling some tautomeric forms that are automatically merged [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR19">19</xref>]. To address this limitation, we decided to use the Non-Standard InChI and the corresponding hashed Non-Standard InChIKey as our uniqueness identifier, which includes the optional fixed-H layer. The fixed-H layer is essential to obtain a different chemical representation for different tautomeric forms, allowing the InChI to be tautomer sensitive [<xref ref-type="bibr" rid="CR21">21</xref>].</p>
    </sec>
    <sec id="Sec4">
      <title>Developing canSARchem</title>
      <p id="Par7">canSARchem was developed to be robust, modular and maximally benefit from the user-friendliness and wide adoption of the open-source pipelining software KNIME [<xref ref-type="bibr" rid="CR22">22</xref>]. In addition, we used the open-source RDKit [<xref ref-type="bibr" rid="CR23">23</xref>] for specific standardization steps in line with the ChEMBL chemical structure curation pipeline [<xref ref-type="bibr" rid="CR8">8</xref>]. Automated tautomerisation algorithms are widely known to have limitations; yet enumerating different tautomeric forms of the same compound would be an important tool in grouping related compounds. After extensive assessment, we found that open-source software solutions had significant limitations, discussed below, in managing the tautomerisation step, and identified commercial software that provided a more robust, albeit still imperfect, solution. Therefore, for maximal fidelity to the input structures, we use SDF files as the external chemical data submitted to the canSARchem whenever possible. V2000 molfile format is then used to handle and export registered compounds data to upload in the database. To aid the researcher in identifying relevant biological data from different compounds, we implemented a compound hierarchy to enable the navigation between different forms of compounds (e.g., tautomers, racemic forms, etc.) and their associated bioactivity data. We developed a nomenclature to define each level, building on the definition of NCI/CADD structure identifiers used in PubChem without the generation of the corresponding hash codes, isomeric canonical SMILES or the use of the commercial software [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR24">24</xref>]. As shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>, after an initial checking, the pipeline standardises the input compounds to give the ‘Standard Compound’ output. Next, canonicalization is performed on the standard compound, to obtain the Canonical Representative. Salts and solvents are then stripped to generate the Unsalted Canonical Representative output before the final step consisting in generating the Abstract Compound devoid of any stereochemistry or isotope labels. The valganciclovir example in Fig. <xref rid="Fig1" ref-type="fig">1</xref> illustrates the use of our pipeline to delineate relationships between compounds using this hierarchy, enabling users to be alerted that (<italic>S</italic>)-valganciclovir is solved in complex, whereas a functional assay is reported against valganciclovir hydrochloride.<fig id="Fig1"><label>Fig. 1</label><caption><p>Scheme of canSARchem chemical registration and standardization pipeline. Input chemical structures are firstly validated through the Checking step where SDFs are parsed, molecules with empty mol blocks are removed and valid structures are progressed through a sanitisation step. Standardized compounds are then generated to be submitted to the canonicalization step. Salt stripping with neutralization is used to obtain the unsalted canonical representatives that are finally stripped of stereochemistry and isotopes to give the abstract compounds. In the valganciclovir example, salt and stereochemistry stripping are key steps to enable data integration on the basis of chemical structure. Indeed, the abstract form is the same for the two input structures</p></caption><graphic xlink:href="13321_2022_606_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec5">
      <title>Workflow description and development</title>
      <p id="Par8">The whole process described in this paper is implemented in KNIME (version 4.5.0). The workflow, along with instructions for installation and use, is available on Gitlab at <ext-link ext-link-type="uri" xlink:href="https://gitlab.icr.ac.uk/cansar-public/compound-registration-pipeline">https://gitlab.icr.ac.uk/cansar-public/compound-registration-pipeline</ext-link>. We have also made the workflow publicly available in the KNIME Hub (<ext-link ext-link-type="uri" xlink:href="https://hub.knime.com/danieladolciami/spaces/Public/latest/canSARchem~hquSdFp3di4kiEv">https://hub.knime.com/danieladolciami/spaces/Public/latest/canSARchem~hquSdFp3di4kiEv</ext-link>). We provide the pipeline openly under a Creative Commons Attribution-ShareAlike 4.0 International License (CC BY-SA 4.0, <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-sa/4.0/">https://creativecommons.org/licenses/by-sa/4.0/</ext-link>) to ensure maximal utility to the research community.</p>
      <p id="Par9">canSARchem consists of 5 steps:<list list-type="order"><list-item><p id="Par10">Structure Checker: wrong or problematic structures are discarded.</p></list-item><list-item><p id="Par11">Structures standardization according to MolVS [<xref ref-type="bibr" rid="CR25">25</xref>] rules as implemented in RDKit Standardized Module (Cleanup function).</p></list-item><list-item><p id="Par12">Generation of canonical representatives, prioritizing aromaticity and protecting tetrahedral stereo centres and double bond isomerism.</p></list-item><list-item><p id="Par13">Salt strip: salts, solvents and fragments are removed.</p></list-item><list-item><p id="Par14">Generation of abstract structure clearing double bond isomerism and sp<sup>3</sup> stereochemistry along with isotope annotation.</p></list-item></list></p>
      <p id="Par15">Figure <xref rid="Fig2" ref-type="fig">2</xref> shows an overview of the workflow. SD files are read and processed in the A block of the workflow. After the rejection of problematic compounds (B), structures are standardized (C) and subsequently exported as Standard Compound output (D). Block E determines the canonical tautomer and generates the Canonical Representative. Block F strips any salt and feeds block G that, after stripping stereochemistry, isomers and isotopes labels generates the Abstract Compound.<fig id="Fig2"><label>Fig. 2</label><caption><p>Implemented KNIME workflow for compound standardization and registration. <bold>A</bold> Structure import and creation of variables for the writing of output files. <bold>B</bold> Structures checker. <bold>C</bold> Standardization. <bold>D</bold> Output generation for standardized compounds. <bold>E</bold> Canonical representative generation. <bold>F</bold> Salt stripping and generation of unsalted canonical representative output file/s. <bold>G</bold> Stereoisomery, isomerism and isotopes strip with the generation of the abstract compounds. <bold>H</bold> Node to execute in order to run the pipeline</p></caption><graphic xlink:href="13321_2022_606_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par16">All the above steps use KNIME nodes from: Indigo KNIME integration (v2.0.0), RDKit Nodes Features (v202106041552), KNIME Base Chemistry Type and Nodes (v202104131254), ChemAxon/Infocom Marvin and JChem Extensions (v211100), KNIME Python integration (v202106250919), KNIME Java Snippet (v202106241003). RDKit (v2021.09.4) has been used for specific tasks through python scripts.</p>
      <sec id="Sec6">
        <title>Structure checker</title>
        <p id="Par17">The first step for compound processing consists in importing compounds in KNIME. The <italic>SDF Reader</italic> node in the workflow retrieves the file/s path from the <italic>List files</italic> node. Only files with sdf.gz extension are imported, as specified in the <italic>List files</italic> node. Subsequently, sdf.gz files are processed individually. Output directories and files names are created or edited using the Java Edit Variable node (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1A).</p>
        <p id="Par18">The <italic>SDF Reader</italic> node imports the correct structures into KNIME to be progressed to the next steps, but, at the same time, unparsed wrong structures go to the second output port and, in turn, are written in the <italic>Errors</italic> folder (with the suffix: <italic>SDF_Parsing_Errors.sdf.gz</italic>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1B).</p>
        <p id="Par19">Before converting the SDF structures into RDKit mol format, a Kekulization is performed through the <italic>Dearomatizer</italic> node. This step avoids errors during sanitisation with the <italic>RDKit from Molecule</italic> node concerning how the aromaticity is perceived. This extra step can prevent a large percentage of such errors, enabling one to proceed to the next steps with a higher number of compounds. SDF to RDKit mol conversion is done generating 2D coordinates and with a partial sanitisation of compounds which includes aromaticity checking and correction of stereochemistry. In addition, compounds that cannot be sanitised are written in the <italic>Errors</italic> folder with the suffix: <italic>Sanitisation_Errors.sdf.gz</italic>. In the last step of the checker process, the <italic>RDKit Substructure Filter</italic> node filters out structures with an empty <italic>mol</italic> block and report them in the <italic>No_structures</italic> folder, as described in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1B.</p>
      </sec>
      <sec id="Sec7">
        <title>Standardization</title>
        <p id="Par20">The standardization step is done using the <italic>Cleanup</italic> function of the Standardization module of RDKit (<italic>rdMolStandardize</italic>) that is built on the MolVS standardization tool [<xref ref-type="bibr" rid="CR25">25</xref>]. During the standardization, functional groups are normalized, separated charges are recombined (e.g., from O<sup>−</sup>–S<sup>2+</sup>–O<sup>−</sup> to O=S=O), and metal bonds are disconnected. A re-ionization step is performed ensuring the strongest acid ionizes first, charges are neutralized, and stereochemistry information is standardized or removed. A validation step to identify molecules with unusual characteristics is also run to prevent the progression of compounds with issues that cannot be fixed. Before being standardized, compounds are submitted to the <italic>Chunk Loop Start</italic> node, which progresses only 3000 entries for each iteration (note that users can modify this arbitrary number of entries to adapt to the CPUs of the system they are using). In turn, these entries are further split in as many chunks as the available cores, leaving one core free in the <italic>Parallel Chunk Start</italic> node. (Number of available cores is calculated in the <italic>Java Edit Variable</italic> node and treated as a variable). A further kekulization is then performed before the actual standardization that is run through a python script (<italic>Python Script</italic> node). When building this pipeline, we realised that RDKit failed to neutralize some chemical structures. Therefore, we added a <italic>Standardizer</italic> node to neutralize those structures whose charge was not neutralized through the RDKit Standardization (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2 for examples). Since this node converts molecules to SDF, a further step to convert again the SDF format into the RDKit mol one is performed. Afterwards, the <italic>Rule-based Row Splitter</italic> node enables the identification of compounds that fail the standardization and will be written to the <italic>Errors</italic> folder with the suffix <italic>_Standardization_Errors</italic>.sdf.gz. Standardized compounds are instead submitted to the <italic>Break Metal Bonds</italic> metanode that can break those metal bonds which are not identified by the RDKit Standardizer tool (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3 for examples). After this step, compounds are neutralized. The two following steps are important to generate coordinates and assign stereochemistry preferentially from 3D structure, when available. The two <italic>Python Script</italic> nodes work through RDKit functions (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4).</p>
        <p id="Par21">The standardized output file/s (Standard Compound) is/are written in the <italic>Results</italic> folder generating Canonical SMILES, InChI, NonStandard InChI and the corresponding InChI keys through the Standard Compound output metanode. All these steps are performed through dedicated RDKit nodes (<italic>RDKit to InChI</italic>, <italic>RDKit Canonical SMILES</italic>). For the generation of the NonStandard InChI, which, importantly, is the uniqueness measure in the canSAR knowledgebase, we used an <italic>RDKit to InChI</italic> node fixing the hydrogen atoms (“/FixedH” has been added on the Advanced tab). All these string representations are written in all the output files (Standard Compound = CH_SC, Canonical Representative = CH_CR, Unsalted Canonical Representative = CH_UCR and Abstract Compound = CH_AC) enabling an easy comparison of the molecules.</p>
      </sec>
      <sec id="Sec8">
        <title>Tautomerisation and generation of Canonical Representative</title>
        <p id="Par22">The generation of the Canonical Representative has been the most challenging step in the development of the pipeline. Ahead of the canonicalization, we calculate the number of heavy atoms of molecules, through the <italic>RDKit Descriptor Calculation</italic> to prevent the generation of tautomers on very large molecules with more than 100 heavy atoms. Then, canonicalization is performed through the ChemAxon <italic>Tautomers</italic> node protecting charge, aromaticity, chiral centres and double bond isomerism. Although there are well-documented examples of racemization occurring with tautomerization in solution [<xref ref-type="bibr" rid="CR16">16</xref>], bioactivity data for different enantiomers cannot be assumed to be equivalent and indeed often differ. To ensure fidelity and traceability of data, we prioritise the protection of chiral centres and preserve chirality tags according to the original sources. For use cases where knowledge about different stereoisomers is relevant, we provide a different level of our hierarchy to connect these for the user. The canonicalization step is the most time-consuming of the pipeline with approximately 600,000 molecules processed in 24 h on average [using an Intel(R) Core™ i7-9850H, CPU 2.60 GHz, RAM 32 GB]. Additional extra steps after canonicalization aim at manipulating the output structures through format conversion. Then, in the <italic>Standardize Molecule</italic> metanode, all the string representations needed are generated, as in the case of Standard Compound output (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5). Despite the charges being protected during canonicalization, we detected a low number of cases (11,661—0.45% of all Standard Compounds) involving salted forms that became charged after canonicalization. As these are artefacts and not related to any biological data, they are rejected from the pipeline. It is worth stressing that the Canonical Representatives may in some cases not be present in any other database and therefore may not be associated with any bioactivity data but they represent a key link to related compounds with potential relevant bioactivities or other metadata and are a necessary step in the creation of the compound hierarchy.</p>
      </sec>
      <sec id="Sec9">
        <title>Salt strip</title>
        <p id="Par23">Whilst developing the pipeline, we identified that individual nodes were incapable of correctly stripping all the salts. Accordingly, we developed several sequential steps that enable us to correctly strip the salts, addressing the exceptions that we have identified. The first metanode splits compounds into organic and inorganic to avoid stripping salts from the latter ones. Therefore, only organic molecules proceed to the following steps to be stripped from any salts. At this point, only compounds that are formed by more than one molecule are submitted to the stripping process to save time in the calculation. We identified a second exception concerning cases where the salt had a higher number of atoms than the compound of interest. Since most of the salt stripping approaches work by deleting the smallest string, in these specific cases the salt or solvent was kept. To avoid these cases, we used custom lists of solvents and organic and inorganic salts to perform the first strip through the <italic>RDKit Salt Stripper</italic> node. Then, since these lists were not exhaustive for all salts and solvents, (i.e. did not include all the charged forms for inorganic salts such as Bi<sup>3+</sup>), a further step to clear salts has been added employing ChemAxon <italic>Standardizer</italic> node. The <italic>Concatenate</italic> node is then used to concatenate together all the processed molecules to be exported as the Unsalted Canonical Representative output (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S6). In the vast majority of cases, typical bioactivity data reported for compounds grouped at this level of the hierarchy are interchangeable. However, as in any approach, users are encouraged to take care while merging data.</p>
      </sec>
      <sec id="Sec10">
        <title>Generation of stereo-agnostic, abstract compound</title>
        <p id="Par24">The last step of compounds processing, which we perform through the ChemAxon <italic>Standardizer</italic> node, is the generation of the Abstract Compound. Specifically, stereoisomerism, double bound isomerism (including both cis/trans and E/Z) and isotope annotations are cleared to generate the abstract compound. This is the key structure in the canSAR hierarchy to generate the compound families. The choice of ChemAxon standardizer was made in view of the possibility to clear <italic>E/Z</italic> double bond isomerism. Indeed, most standardizer tools such as the Indigo <italic>Standardizer</italic> node, allow to clear the <italic>cis/trans</italic> but not the <italic>E/Z</italic> isomerism. After standardization, the Abstract Compound output is generated and written in the <italic>Results</italic> folder, as shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S7. In the canSAR database, compound uniqueness is assessed through the NonStandard InChI where hydrogens are fixed. Accordingly, compound families are also generated based on the NonStandard InChI of Abstract Compounds and then linked to the corresponding Standardized Compound, Canonical Representative and Unsalted Canonical Representative compounds employing the identifier, that in the case of example files is the chembl_id. Knowledge of different stereoisomers of a compound is useful in many scientific applications, hence we provide it through our hierarchy. However, care must be taken not to automatically combine all data at this level as they may not be equivalent.</p>
      </sec>
    </sec>
    <sec id="Sec11">
      <title>Pre-requisites and instructions to run the KNIME workflow</title>
      <p id="Par25">KNIME is freely downloadable at <ext-link ext-link-type="uri" xlink:href="https://www.knime.com/downloads">https://www.knime.com/downloads</ext-link>. The workflow described herein requires a Python 3 environment with RDKit tool installed. A regular license must be obtained from ChemAxon to execute the ChemAxon nodes. Three example input files are also provided as part of the workflow. To process custom input files, the <italic>List Files</italic> node needs to point to the location where the files are stored. <italic>Errors</italic>, <italic>No_Structures</italic> and <italic>Results</italic> directories are automatically created. Output file names are created from the original input file names by adding a suffix. Suffixes provide information on the file content (e.g. <italic>_SDF_Parsing_Errors</italic>.sdf.gz) and the loop iteration (e.g. <italic>_CH_SC_0</italic>.sdf.gz, where “0” indicate the output has been generated during the first iteration). By default settings, the workflow processes 3,000 molecules during each iteration. Four output files (CH_SC, CH_CR, CH_UCR and CH_AC) are generated for each input file and each iteration. As an example to improve clarity, an SD file of 7000 molecules generates 12 output files, all stored in the Results directory.</p>
    </sec>
    <sec id="Sec12">
      <title>Developing canSARchem_RDKit</title>
      <p id="Par26">In order to provide a fully open access version of our pipeline that did not rely on any commercial software to facilitate openness and reusability, we have also developed canSARchem_RDKit. canSARchem_RDKit mirrors the canSARchem pipeline with the only difference that all ChemAxon software has been removed and replaced with RDKit alternatives. The main differences between both pipelines are the following:<list list-type="order"><list-item><p id="Par27">Standardizer—neutralization of charged compounds following RDKit standardization is performed through the ‘Uncharger’ module of RDKitMolStandardizer instead of using ChemAxon Standardizer.</p></list-item><list-item><p id="Par28">Canonical representative—canonicalization in canSARchem_RDKit is performed with rdMolStandardize.TautomerEnumerator.Canonicalize with the “remove sp3 stereo” and “remove bond stereo” settings set up as ‘False’.</p></list-item><list-item><p id="Par29">Salt strip—RDKit Salt Strip Standardizer (without solvent lists) has replaced ChemAxon Standardizer node in the 4. Salt Strip Standardizer.</p></list-item><list-item><p id="Par30">Isotopes and stereochemistry—the standardizer node from Indigo extension was used to strip isotopes and stereochemistry using standardize-clear-isotope, standardize-clear-cis–trans and standardize-clear-stereo. However, the node has no option to strip E/Z isomerism. Accordingly, we added a string manipulation node to strip E/Z isomerism removing slashes or back-slashes from SMILES.</p></list-item></list></p>
      <p id="Par31">canSARchem_RDKit is available in the same Gitlab repository as canSARchem, and we have also deposited it in the KNIME Hub (<ext-link ext-link-type="uri" xlink:href="https://hub.knime.com/danieladolciami/spaces/Public/latest/canSARchem_RDKit~7Qe3vnQZ9zpIla4Z">https://hub.knime.com/danieladolciami/spaces/Public/latest/canSARchem_RDKit~7Qe3vnQZ9zpIla4Z</ext-link>). The differences between canSARchem and canSARchem_RDKit have been further tested with a list of 5735 compounds and the results are presented in the results and discussion section.</p>
    </sec>
  </sec>
  <sec id="Sec13">
    <title>Results and discussion</title>
    <sec id="Sec14">
      <title>Integration of chemical and pharmacological data</title>
      <p id="Par32">We created a new chemical registration and standardization pipeline, canSARchem. Compounds processed through the pipeline can be grouped according to their Canonical Representative, Unsalted Canonical Representative and Abstract Compound, regardless of their original representation. Importantly, we processed all compounds in the public canSAR database with this new pipeline, enabling users to rapidly identify alternative representations of a chemical compound and explore their associated bioactivities where appropriate. Indeed, while we keep the bioactivity data registered versus the original compound form, the user is alerted of the presence of related compounds that may hold useful information.</p>
      <p id="Par33">To this aim, five sequential steps are carried out on input molecules imported from external databases such as ChEMBL, BindingDB, PDB or our unique curated data. As shown in Table <xref rid="Tab1" ref-type="table">1</xref>, the Standard Compound output has been generated through the structure checker and standardization and then submitted to canonicalization to give the Canonical Representative output. Accordingly, Standard Compounds and Canonical Representatives enable to group together compounds with the same Canonical Representative, regardless of their input structure. The Canonical Representative output is then used to generate the free base Canonical Representatives by stripping salts, solvents and small fragments to give the Unsalted Canonical Representative output. Finally, the Abstract Compound is obtained clearing stereochemistry, cis/trans and E/Z isomerism and isotopes annotations.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Description of canSAR hierarchy and steps to generate each output</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">3,157,884 unique 2D structures in canSAR</th><th align="left">canSAR Hierarchy</th><th align="left">Input file</th><th align="left">Description</th><th align="left">Steps</th></tr></thead><tbody><tr><td align="left" rowspan="8">2,668,609 Standard Forms and Canonical Representatives</td><td align="left" rowspan="4">Standardized Compound (SC)</td><td align="left" rowspan="4">Original source DBs in SDF format</td><td align="left" rowspan="4">Standard form</td><td align="left">1. Checker and 2. Standardizer</td></tr><tr><td align="left"> SDF parsing and filtering of empty molblocks</td></tr><tr><td align="left"> RDKit sanitization</td></tr><tr><td align="left"> Structure Standardization through RDKit Standardizer</td></tr><tr><td align="left" rowspan="4">Canonical Representative (CR)</td><td align="left" rowspan="4">SC Output</td><td align="left" rowspan="4">Canonical Representative</td><td align="left">3. Generation of Canonical Representative</td></tr><tr><td align="left"> Generation of at most 30 canonical tautomers</td></tr><tr><td align="left"> Prevent canonicalization in the presence of chiral center</td></tr><tr><td align="left"> Time-out for canonicalization set at 250 ms</td></tr><tr><td align="left" rowspan="6"><p>2,304,805 Unsalted</p><p>Canonical Representatives</p></td><td align="left" rowspan="6">Unsalted Canonical Representative (UCR)</td><td align="left" rowspan="6">CR Output</td><td align="left" rowspan="6">Free base canonical tautomer</td><td align="left">4. Salt strip</td></tr><tr><td align="left"> Strip inorganic and organic counterions</td></tr><tr><td align="left"> Strip solvents and fragments</td></tr><tr><td align="left"> Strip shorter SMILES string</td></tr><tr><td align="left"> Keep first fragment with two identical SMILES strings</td></tr><tr><td align="left"> Neutralization</td></tr><tr><td align="left" rowspan="4"><p>2,162,736 Abstract</p><p>Representation</p></td><td align="left" rowspan="4">Abstract Representation (AR)</td><td align="left" rowspan="4">UCR Output</td><td align="left" rowspan="4">Abstract representation (Canonical compound stripped of salts and stereochemistry)</td><td align="left">5. Generation of abstract structure to get parent compounds</td></tr><tr><td align="left"> Strip stereochemistry</td></tr><tr><td align="left"> Strip cis/trans and E/Z isomerism</td></tr><tr><td align="left"> Strip isotopes</td></tr></tbody></table><table-wrap-foot><p>The total number of unique 2D structures in canSAR is reported for each hierarchy level together with the input file and the steps carried out to generate the corresponding output files</p></table-wrap-foot></table-wrap></p>
      <p id="Par34">In canSAR there are, in total, 2,668,609 unique Standard Compounds and Canonical Representatives, 2,304,805 unique free base/acid Unsalted Canonical Representatives and 2,162,736 Abstract Compounds, encompassing clinical candidates, research compounds and chemical probes. Importantly, the 17.6% drop of structures from Standard Compounds and Canonical Representatives to Abstract Compounds confirms the importance of the hierarchy generation for data aggregation. It is important to stress that data associated with one form of the compound is not necessarily immediately transferable to other forms. For example, the protein bioactivities of two stereoisomers are not necessarily the same. Meanwhile, some biological data may be artificially disconnected because of differences in the tautomeric registration of a compound at the source. But it is always important for the researcher to know what data are available in a fully transparent and traceable way. Bioactivity data or crystal structures registered for different forms of a compound will be useful and will be highlighted in the canSAR interface.</p>
      <p id="Par35">To illustrate the utility of the canSARchem pipeline, we report two examples in Figs. <xref rid="Fig3" ref-type="fig">3</xref> and  <xref rid="Fig4" ref-type="fig">4</xref> that demonstrate the challenges in data aggregation from several resources and how our hierarchy can help the user identify potentially valuable data. In the case of Ganciclovir (Fig. <xref rid="Fig3" ref-type="fig">3</xref>), five different input structures with different tautomeric and salt forms were submitted to the canSAR pipeline from different source databases (ChEMBL, BindingDB, PDBe, raw curation and Drug Store). The generation of the Canonical Representative enabled to group all these forms into one family. As shown in the top part of the image, the data registered versus each compound form is significantly different. It is particularly important to highlight that there is one unsalted tautomeric form registered in ChEMBL (GANCICLOVIR, in red) whilst a different one is registered in the PDB/BindingDB (GA2, in blue) that have significantly different data. For example, BindingDB reports binding affinity for Ganciclovir against metabotropic glutamate receptors from a patent application that could be missed if only the other tautomer was explored. Moreover, a recent paper that was abstracted in canSAR reported binding affinity data for another tautomer of Ganciclovir (canSAR3446248) against the NUDT15 hydrolase, whilst the old Drug Store database had registered yet another Ganciclovir tautomer. The canSARchem hierarchy enables to alert the user that these alternative compound forms exist to facilitate the exploration of their bioactivity data. The compound synopsis in the canSAR website has been particularly designed to enable this by raising awareness of these alternative forms of compounds in the same hierarchy and associated data (<ext-link ext-link-type="uri" xlink:href="https://cansarblack.icr.ac.uk/compound/1070449/synopsis/structure">https://cansarblack.icr.ac.uk/compound/1070449/synopsis/structure</ext-link>).<fig id="Fig3"><label>Fig. 3</label><caption><p>Example of the advantages of canSAR hierarchy. Different tautomers, salt forms and double bond isomerism for ganciclovir are submitted to canSARchem. The generation of canonical representatives, unsalted canonical representatives and abstract compound allows to group and consolidate all the 5 input entries in the same family enabling the user to quickly identify all the alternative forms that exist in canSAR. This, in turn, makes the user aware of the data measured and registered versus the different compound forms. Circles at the top represent the different data types and the number of bioactivity data points associated with each one of them. As it can be observed, the biochemical assays of ganciclovir against metabotropic glutamate receptors from BindingDB (associated with GA2, in blue), could be missed if the user only explored the tautomer associated with the ‘GANCICLOVIR’ name tag</p></caption><graphic xlink:href="13321_2022_606_Fig3_HTML" id="MO3"/></fig><fig id="Fig4"><label>Fig. 4</label><caption><p>Example of the advantages of canSAR hierarchy (II). Different salt forms and stereoisomers for BMS-863233. Salt strip and clear stereochemistry steps allow to generate the compound family. It is important to highlight that the racemate BMS-863233 is associated with a large-scale selectivity profiling data whilst the pure enantiomer OSX is associated with structural and ADME data. Circles at the bottom represent the different data types and the number of bioactivity data points associated with each one of them</p></caption><graphic xlink:href="13321_2022_606_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par36">Another example of the benefit of the canSAR hierarchy is BMS-863233 (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). In this case, the PDB, ADME and functional data are registered versus 0SX, which has a defined stereochemistry; but the ‘BMS-863233’ name, clinical candidate tag and large-scale kinome profiling data are registered against the racemate form. This is somewhat surprising as both large-scale profiling data, co-crystallization and ADME are typically measured against the same compound form—the one in clinical trials. In general, the data associated with an enantiomeric form should not be merged with the racemate as both can have different properties. However, a close inspection at the original publication shows that the clinical candidate is enantiomerically pure and thus the name tag and clinical candidate tag should be associated with 0SX and not with the racemate. It is also very likely that the large-scale kinome profiling was also performed on the enantiomerically pure compound, but the stereochemistry was not appropriately reported in that publication and thus the data ended up associated with the racemate. Therefore, exceptionally, in this particular case, users may want to consider merging the bioactivity data of the racemate and enantiomerically pure compounds. This example illustrates the complexities of integrating chemical and bioactivity data, the existence of errors in public databases that need to be taken into consideration, and how the canSAR pipeline can easily flag the existence of alternative forms of compounds and associated data that may need to be considered by the users.</p>
    </sec>
    <sec id="Sec15">
      <title>Challenges of implementing the chemical standardization pipeline: Canonical Representative generation</title>
      <p id="Par37">As expected, the most challenging step in the implementation of this pipeline is the tautomerisation as part of the generation of the Canonical Representative. Although canonicalization is widely recognised as a challenging, time-consuming step and avoided in many databases [<xref ref-type="bibr" rid="CR8">8</xref>], 67% of chemical compounds are estimated to be affected by tautomerism [<xref ref-type="bibr" rid="CR16">16</xref>]. Therefore, we felt it was important to address this issue to our best ability and introduce a canonicalization step to link compounds into families and alert on associated data as best as possible. Various algorithms for tautomer generation and enumeration are available but finding the best tool is challenging as all approaches are known to have limitations [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR26">26</xref>–<xref ref-type="bibr" rid="CR28">28</xref>]. We, accordingly, explored four different approaches, namely <italic>Ambit’s Tautomer Generator</italic> node from Knime-CDK extension, <italic>MolVS Tautomer canonicalization</italic> [<xref ref-type="bibr" rid="CR29">29</xref>], the canonicalization function from <italic>RDKit Tautomer enumerator</italic> [<xref ref-type="bibr" rid="CR30">30</xref>] and <italic>Tautomers</italic> node from ChemAxon/Infocom JChem extensions. Unfortunately, <italic>Ambit’s Tautomer generator</italic> node has no option for the generation of the canonical tautomer and is consequently not a valid option. <italic>MolVS Tautomer canonicalization</italic> does not allow stereochemistry protection when the proton shift involves a chiral carbon with the consequent loss of chirality annotation producing misleading results in our compound hierarchy. This issue has been partially fixed in the very recent release of <italic>RDKit Tautomer enumerator</italic>. Therefore, we have performed a thorough comparison of ChemAxon and RDKit in tautomer canonicalization in terms of both the tautomeric form obtained and execution time on the three example files provided in the KNIME workflow released with this paper. First, we generated all possible tautomeric forms for the 5,735 unique compounds in the example files using <italic>Ambit’s Tautomer Generator</italic> node. This step generated 8,706 unique molecules that were submitted to canonicalization protecting sp<sup>3</sup> stereoisomerism and double bond isomerism with the two approaches. The results showed that RDKit was less effective at protecting stereoisomerism and double-bond isomerism in comparison to the more conservative approach used by ChemAxon. Indeed, 2019 molecules were modified during the canonicalization with RDKit, with 640 new generated structures, whilst ChemAxon modified 1826 compounds with only 298 new structures. In most cases, the higher number of molecules modified by RDKit is due to double bond protection that is not behaving as expected, as illustrated in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1.</p>
      <p id="Par38">In terms of execution time, RDKit is faster than ChemAxon as the whole workflow runs in about 5 min with the <italic>Python Script</italic> node for <italic>RDKit canonicalizer</italic> whereas it needs approximately 10 min to process the example files with ChemAxon <italic>Tautomers</italic> node. However, if the approach was used in KNIME through a <italic>Python script</italic> node and running on a bigger number of compounds, the job would likely be halted as we have experienced generating canonical tautomers through <italic>Python script</italic> nodes on bigger databases. Therefore, the speed advantage of RDKit might not be an advantage in KNIME.</p>
      <p id="Par39">Overall and despite our efforts to use open software wherever possible, we find that ChemAxon <italic>Tautomers</italic> node outperforms the other approaches we tested. The criteria we used were focused on protecting double-bond isomerism and stereoisomerism. While errors were still observed and limitations identified, it was the method that provided the most robust outputs and consequently is our choice for canonicalization. Although successful in most cases, we have identified edge examples where the ChemAxon tool incorrectly standardised compounds. An interesting example to consider is that of sunitinib (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). ChemAxon identifies canSAR557724 as a tautomer of sunitinib, although the sp<sup>2</sup>/sp<sup>3</sup> transition is highly unlikely. This exemplifies a potential limitation of our pipeline because the inclusion of canSAR557724 and canSAR289623 in the same compound hierarchy as sunitinib could be debatable. It is important to highlight that all methods need improvement to better handle tautomers. The availability of more robust open-source tautomerisation and canonicalization pipelines will be transformative for the in-silico chemistry community. Despite the limitations, in order to provide a fully open access pipeline to the community we have also developed canSARchem_RDKit, that does not use ChemAxon software. We have compared canSARchem and canSARchem_RDKit with a list of 5737 compounds. A different output on the standardizer step (see “<xref rid="Sec2" ref-type="sec">Methods</xref>” section) was found in only one compound (CHEMBL3740280). As expected, the major differences between both pipelines originated in the Canonicalization step, where 750 molecules had a different output compared with the canSARchem pipeline that uses ChemAxon. In addition, 1015 molecules had a different output after salt strip and 763 molecules were processed differently after stripping isotope and stereochemistry information. Despite these differences finally translated into only one additional family, the differences in family numbers will likely increase significantly when large databases are processed. Users should be mindful of the differences between both pipelines and their strengths and limitations.<fig id="Fig5"><label>Fig. 5</label><caption><p>Hierarchy of sunitinib. Example of the limitations of canSARchem hierarchy. Different tautomers, salt forms and double bond isomerism for sunitinib are submitted to canSARchem. The generation of canonical representative, unsalted canonical representative and abstract compound allows to group and consolidate all the 6 input entries in the same family. However, the 3<italic>H</italic>-pyrrole of canSAR289623 and canSAR775524 (in blue) has very different properties than the pyrrole of the other compounds in the family and a high energy barrier of interconversion that is unlikely to enable tautomerism between these compounds in solution. Therefore, it is debatable if these compounds belong to the same hierarchy. Circles at the top represent the different data types and the number of bioactivity data points associated with each one of them</p></caption><graphic xlink:href="13321_2022_606_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
    <sec id="Sec16">
      <title>Standardization success and modification rates</title>
      <p id="Par40">In order to standardize compounds and create a compound hierarchy that enables grouping molecules into families, we processed all the canSAR data sources, both external (ChEMBL, BindingDB and PDB) and internally curated through canSARchem. This accounts for a total of 3 million compounds. The overall processing success rate was 97.53% (Table <xref rid="Tab2" ref-type="table">2</xref>). In total, 70 k molecules failed, with 99.4% of them imported from BindingDB (using BindingDB download file named Terse_m11_2020). The most common problems of rejected compounds were related to aromaticity and valence (Fig. <xref rid="Fig6" ref-type="fig">6</xref>). Examples of aromaticity errors are presented in Fig. <xref rid="Fig6" ref-type="fig">6</xref>a and b, whereas Fig. <xref rid="Fig6" ref-type="fig">6</xref>c and d represent structures with malformed valence for structures from BindingDB (Structure checker, Step 1, Table <xref rid="Tab1" ref-type="table">1</xref>).<table-wrap id="Tab2"><label>Table 2</label><caption><p>Number of compounds from external sources processed through the canSAR pipeline</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"/><th align="left"/><th align="left">ChEMBL27</th><th align="left">BindingDB<break/>Terse_m11_2020</th><th align="left">PDB</th></tr><tr><th align="left"># Structures in source db</th><th align="left">1,941,411</th><th align="left">898,561</th><th align="left">35,258</th></tr></thead><tbody><tr><td align="left" rowspan="3">1.Checker</td><td align="left">SDF parsing errors</td><td align="left">0</td><td align="left">3</td><td align="left">0</td></tr><tr><td align="left">RDKIT sanitization errors</td><td align="left">1</td><td align="left">70,385</td><td align="left">0</td></tr><tr><td align="left">Empty molblock</td><td align="left">0</td><td align="left">6</td><td align="left">0</td></tr><tr><td align="left">2. Standardizer</td><td align="left">Total standardized structures</td><td align="left">1,941,410</td><td align="left">828,167</td><td align="left">35,076</td></tr><tr><td align="left" rowspan="2">3. Canonical Tautomer generation</td><td align="left">Modified structures</td><td align="left">179,276 (9.23%)</td><td align="left">19,721 (6.14%)</td><td align="left">2911 (8.3%)</td></tr><tr><td align="left">Total new structures</td><td align="left">101,642</td><td align="left">1207</td><td align="left">2862</td></tr><tr><td align="left">4. Salt strip</td><td align="left">Structures strip from salt, fragments, solvents</td><td align="left">101,833 (5.2%)</td><td align="left">1264 (0.39%)</td><td align="left">266 (0.75%)</td></tr><tr><td align="left">5. Abstract structure generation</td><td align="left">Generated abstract structures</td><td align="left">682,321 (35%)</td><td align="left">118,074 (36.78%)</td><td align="left">19,691 (55.85%)</td></tr></tbody></table><table-wrap-foot><p>Compounds modified in each pipeline step are reported for every external database</p></table-wrap-foot></table-wrap><fig id="Fig6"><label>Fig. 6</label><caption><p>Examples of rejected structures for aromaticity (<bold>a</bold> and <bold>b</bold>) or valence (<bold>c</bold> and <bold>d</bold>) errors. <bold>a</bold> BindingDB MonomerID 60884 and <bold>b</bold> BindingDB MonomerID 185783 are incorrectly represented as aromatic, wrong portion of the molecule are highlighted in red. In <bold>c</bold> BindingDB MonomerID 142162 and <bold>d</bold> BindingDB MonomerID 289106, the valence of the red Nitrogen atom is wrong</p></caption><graphic xlink:href="13321_2022_606_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par41">All checked molecules successfully passed the standardization step (step 2, Table <xref rid="Tab1" ref-type="table">1</xref>), where functional groups are normalized, metal atoms bonds are broken, charges are neutralized, as described in the Methods section. In the subsequent step of tautomerisation, 201,908 total structures (7%) were modified to the Canonical Representative, with 105,902 new molecules generated (3.7%). Of note, the modification rate for the PDB database (8.3%), ChEMBL (9.23%) and BindingDB (6.14%) were similar (Table <xref rid="Tab2" ref-type="table">2</xref>). As a result of the canSARchem pipeline, the bioactivity data corresponding to different tautomeric and other forms can now be easily explored and consolidated. For example, in Fig. <xref rid="Fig3" ref-type="fig">3</xref> the binding data of ganciclovir against metabotropic glutamate receptors from BindingDB (associated with GA2), which could be missed if you only explored the tautomer associated with the ‘GANCICLOVIR’ name tag, can be quickly identified via the compound family. Other examples include tivozanib and its tautomer AV9, and pemetrexed and LYA, all cases, where the PDB structures are registered versus a different tautomeric form than the rest of bioactivity data, and thus exploring only the structure associated with the drug name may lead to the user missing very valuable crystallographic information that is associated with a different tautomeric form. Other cases that show the value of the canSARchem hierarchy are examples of two different tautomers co-crystallized against different entries in the PDB. For example, 2-(4-Hydroxyphenylazo)benzoic acid (HAB) is co-crystallized against Streptavidin from <italic>Streptomyces avidinii</italic> (PDB ID: 1SRE) whilst its tautomer 55R is co-crystallized against Avidin from <italic>Gallus gallus</italic> (PDB ID: 5CHK). Both compounds are brought together in the canSAR hierarchy, making it easy for the user to recognize that an alternative form is co-crystallized against another protein, when one of the compound forms is searched which provides useful information (<ext-link ext-link-type="uri" xlink:href="https://cansarblack-alpha.icr.ac.uk/compound/2871690/synopsis/structure">https://cansarblack-alpha.icr.ac.uk/compound/2871690/synopsis/structure</ext-link>).</p>
      <p id="Par42">It is worth highlighting that we submitted to canonicalization only compounds with a number of heavy atoms lower than 100, in order to prevent the pipeline from halting. As a result, 131,616 molecules (35,101 from BindingDB, 95,393 from ChEMBL and 1122 from PDB) were not submitted to the canonicalization step. Therefore, the numbers reported above may underestimate the number of molecules that were already in the canonical form or do not have tautomers and have not been modified. Moreover, the protection of stereochemistry and double-bond isomerism during canonicalization could have also contributed to an underestimated modification rate. For example, 36% of substances were altered by canonicalization in the Standardize Valence Bond step in PubChem database [<xref ref-type="bibr" rid="CR9">9</xref>]. However, other studies show a different modification rate, with tautomerism demonstrated to be possible for around 67% of chemical structures [<xref ref-type="bibr" rid="CR16">16</xref>]. The accurate estimation of the modification rate is also dependent on how the number of canonicalized structures is computed. Herein, we were more interested in counting molecules that differ in their Standard Compound and Canonical Representative levels, to understand how much the canonicalization step affected our final aim of linking associated biological data. In this respect, the percentage of newly generated structures over the modified ones (52.4%) indicates that 47.6% of generated tautomers match with at least one existing structure, that was in the canonical form. This highlights the value of canonicalization to enable chemical structure-based data aggregation regardless of the input tautomeric form, despite the limitations of current canonicalization algorithms that we have already discussed.</p>
      <p id="Par43">The Canonical Representatives were then submitted to the salt strip step where salts, solvents or fragments are removed (Step 4, Table <xref rid="Tab1" ref-type="table">1</xref>). 103,284‬ molecules (3.69%) were affected by salt strip, generating the Unsalted Canonical Representative output.</p>
      <p id="Par44">In the last step (step 5, Table <xref rid="Tab1" ref-type="table">1</xref>) for Abstract Compound generation, 807,487 (28.84%) were modified, enabling grouping compounds in families. Abstract Compounds have been generated clearing tetrahedral configuration, <italic>cis/trans</italic> and <italic>E/Z</italic> isomerism, and isotopes.</p>
    </sec>
    <sec id="Sec17">
      <title>Comparison with published standardization pipelines</title>
      <p id="Par45">In order to assess the global performance of canSARchem, we performed a comparative analysis with PubChem [<xref ref-type="bibr" rid="CR9">9</xref>] and ChEMBL [<xref ref-type="bibr" rid="CR8">8</xref>] pipelines. The comparison involved three main aspects: i. Most relevant features and differences among the three pipelines, ii. The impact of these different approaches on the output standardized compounds and iii. Differences in detection and rejection of problematic structures.</p>
      <p id="Par46">Table <xref rid="Tab3" ref-type="table">3</xref> summarises the comparison of the most relevant features of the three pipelines, which are all publicly accessible. canSARchem is freely available as a KNIME workflow, with a license required for ChemAxon/InfoCom KNIME nodes. It’s worth noting that for academic users, ChemAxon provides a freeweb license to perform the canonicalization step but the corresponding KNIME node is not freely available. Although we made our best effort to use open-access tools for canSARchem, ChemAxon suite outperforms other open-access KNIME-accessible packages for canonicalization. The overall advantages of the KNIME workflow format consist in the integration of an easy to use software (without knowledge of coding) with real-time visualization of executed nodes enabling inspection of the output of each step facilitating troubleshooting as well as modifications. Moreover, since we provide canSARchem under a CC BY-SA license, users can easily modify any of the steps in the pipeline to include different tautomerization modules or reconfigure any KNIME node, but of course, this will impact the final result.<table-wrap id="Tab3"><label>Table 3</label><caption><p>Comparison of ChEMBL, PubChem and canSAR chemical structure standardization pipelines</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left"/><th align="left">canSAR pipeline</th><th align="left">ChEMBL pipeline [<xref ref-type="bibr" rid="CR8">8</xref>]</th><th align="left">PubChem pipeline [<xref ref-type="bibr" rid="CR9">9</xref>]</th></tr></thead><tbody><tr><td align="left"/><td align="left">Pipeline availability</td><td align="left">Freely available as a Knime Workflow (ChemAxon components require a license)</td><td align="left">Open source, public available in GitHub and as Conda package</td><td align="left">Open source web-based and programmatic interface</td></tr><tr><td align="left" rowspan="17">Chemical Structure Curation</td><td align="left">1. Checker</td><td align="left"><bold>✔</bold></td><td align="left"><bold>✔</bold></td><td align="left"><bold>✔</bold></td></tr><tr><td align="left" colspan="4">2. Standardizer</td></tr><tr><td align="left"> 2.1 Aromaticity standardization</td><td align="left">Kekulization</td><td align="left">Kekulization</td><td align="left">Kekulization</td></tr><tr><td align="left"> 2.2 Atom valence</td><td align="left"><bold>✔</bold></td><td align="left"><bold>✔</bold></td><td align="left"><bold>✔</bold></td></tr><tr><td align="left"> 2.3 Radicals</td><td align="left"><bold>✔</bold></td><td align="left"><bold>✔</bold></td><td align="left"><bold>✔</bold></td></tr><tr><td align="left"> 2.5 Hydrogens treatment</td><td align="left">Remove explicit Hs</td><td align="left">Remove explicit Hs</td><td align="left">Convert implicit Hs into explicit</td></tr><tr><td align="left"> 2.6 Metal bonds disconnection</td><td align="left"><bold>✔</bold></td><td align="left"><bold>✔</bold></td><td align="left"><bold>✔</bold></td></tr><tr><td align="left"> 2.7 Apply normalization rules</td><td align="left"><bold>✔</bold></td><td align="left"><bold>✔</bold></td><td align="left">Conversion of functional group into the preferred form</td></tr><tr><td align="left"> 2.8 Verify stereochemistry</td><td align="left"><bold>✔</bold></td><td align="left"><bold>✔</bold></td><td align="left"><bold>✔</bold></td></tr><tr><td align="left">3. Generation of Canonical Tautomers</td><td align="left"><bold>✔</bold></td><td align="left"><bold>✘</bold></td><td align="left"><bold>✔</bold></td></tr><tr><td align="left">4. Salt Strip</td><td align="left"><bold>✔</bold></td><td align="left"><bold>✔</bold></td><td align="left"><bold>✘</bold><sup>a</sup></td></tr><tr><td align="left" colspan="4">5. Abstract structure</td></tr><tr><td align="left"> 5.1 Tautomers</td><td align="left"><bold>✔</bold></td><td align="left"><bold>✘</bold></td><td align="left"><bold>✘</bold><sup>a</sup></td></tr><tr><td align="left"> 5.2 Stereoisomers</td><td align="left"><bold>✔</bold></td><td align="left"><bold>✘</bold></td><td align="left"><bold>✘</bold><sup>a</sup></td></tr><tr><td align="left"> 5.3 E/Z and cis/trans isomers</td><td align="left"><bold>✔</bold></td><td align="left"><bold>✘</bold></td><td align="left"><bold>✘</bold><sup>a</sup></td></tr><tr><td align="left"> 5.4 Isotopes</td><td align="left"><bold>✔</bold></td><td align="left"><bold>✔</bold></td><td align="left"><bold>✘</bold><sup>a</sup></td></tr><tr><td align="left"> 5.5 Salts, solvents</td><td align="left"><bold>✔</bold></td><td align="left"><bold>✔</bold></td><td align="left"><bold>✘</bold><sup>a</sup></td></tr><tr><td align="left"/><td align="left">Uniqueness identifier</td><td align="left">NonStandard InChI</td><td align="left">Standard InChI and corresponding hashed InChIKey</td><td align="left">De-aromatized isomeric canonical SMILES</td></tr><tr><td align="left"/><td align="left">Actions on compounds which fail to be processed</td><td align="left"><p>Compounds are corrected where possible</p><p>Compounds failed to be sanitised or standardized are not loaded into the DB</p></td><td align="left"><p>Different actions based on perceived errors</p><p>Compounds with fatal errors are not uploaded into ChEMBL database (penalty score of 7) or uploaded without Molfile (penalty score of 6) or uploaded but prioritized for manual curation (penalty score 5 or 2)</p></td><td align="left">Structures rejected from the standardization pipeline are not pushed into the Compounds database</td></tr><tr><td align="left"/><td align="left">Employed tools/libraries</td><td align="left">RDKit, MolVS and ChemAxon</td><td align="left">RDKit and MolVS</td><td align="left">OpenEye Scientific Software, Inc. C<sup>++</sup></td></tr><tr><td align="left"/><td align="left">Parent compounds usage</td><td align="left">Canonical tautomers as well as compounds strip from salt and chirality are used to create a compound hierarchy displayed in the structure synopsis</td><td align="left">Compounds strip from salts and isotopes are used to get parents shown as alternative forms of compounds</td><td align="left">Canonicial tautomers, isolated and neutralized covalent units used to generate related, parent and component compounds</td></tr><tr><td align="left"/><td align="left">Mapping bioactivity data</td><td align="left"><p>Bioactivity and structural data on the same compound form are aggregated through chemical structure</p><p>Bioactivity data are mapped against the form it is measured on</p></td><td align="left"><p>Bioactivity data on the same compound form are aggregated through chemical structure</p><p>Bioactivity data are mapped against the form it is measured on</p></td><td align="left">Bioactivity data are linked to unstandardized compounds (substances)</td></tr></tbody></table><table-wrap-foot><p>Differences and similarities of the various step for compounds standardization are highlighted</p><p><sup>a</sup>Not performed through the released pipeline. For compounds registered in DB by the PubChem team, parent structures can be retrieved</p></table-wrap-foot></table-wrap></p>
      <p id="Par47">ChEMBL pipeline is available in GitHub and as Conda package. PubChem can be accessed through open-source web-based and programmatic interfaces. In the case of PubChem, only the generation of canonical tautomer is possible through the web-based application, but not the salt strip or the generation of the abstract structure that however is retrievable for compounds registered in the PubChem DB (steps marked by a superindex ‘a’ in Table <xref rid="Tab3" ref-type="table">3</xref>). For the purpose of this paper, steps not typically available to users through the available tool or not described in the PubChem chemical structure standardization paper are not discussed. The main difference for the standardization step is the conversion of Hydrogens from implicit to explicit operated by PubChem pipeline that differs from canSAR and ChEMBL approaches. Of note, canonicalization is not performed by the ChEMBL pipeline as a result of their decision to avoid the generation of tautomers [<xref ref-type="bibr" rid="CR8">8</xref>]. The abstract structures in ChEMBL are obtained through the GetParent component and consist of salt strip and removal of information about isotopes. In canSAR, we decided to strip stereoisomerism and double bond isomerism instead, in order to generate inclusive compounds family with a higher probability to connect data registered against different compound forms. Other important differences concern the uniqueness identifier and the actions on compounds that fail to be standardized. In ChEMBL, InChI and the corresponding InChIKey have been chosen as uniqueness identifiers. PubChem team opted for de-aromatized isomeric canonical SMILES to define a structure as unique. Since one of the risks of using SMILES is the generation of the string itself, in canSAR, we chose Non Standard InChI with fixed Hydrogens as our uniqueness identifier. Indeed, the FixedH option allows appending an extra layer to the InChI string which is essential for making it specific for a single tautomeric form of the structure [<xref ref-type="bibr" rid="CR21">21</xref>]. Checker and standardization steps are generally used as a choice to reject/accept compounds. However, canSAR approach differs from ChEMBL and PubChem. Using RDKit sanitisation, canSAR pipeline attempts to correct kekulized forms and stereochemistry where possible. Compounds that fail steps 1 and 2 are not imported into the canSAR database. The ChEMBL ‘checker’ component scores compounds before eventually loading them into the database, with the action undertaken depending on the score itself. The PubChem pipeline, in contrast, does not push any rejected structures into the database. Both canSARchem and ChEMBL pipelines are developed on RDKit and MolVS tools. However, ChemAxon suite is used in canSARchem to generate canonical tautomers, for salt stripping and generation of the abstract structure. PubChem chemical registration pipeline was built using the commercial software OpenEye. Parent structures are used to link alternative forms of compounds. The same approach of registering bioactivity data versus the compound form it is measured on is adopted by all three databases.</p>
      <p id="Par48">Regarding the second aspect of the comparison, that is the output compounds generated, Table <xref rid="Tab4" ref-type="table">4</xref> illustrates with examples how structures are processed by the three pipelines for standardization. As mentioned previously, in PubChem, the generation of the parent structure is unavailable in the web-based tool and therefore has not been considered. The three pipelines similarly fix the hypervalent Nitro group in entry 1 as well as disconnect the metal bond in entry 2. Of note, canSARchem generated a different parent structure compared to ChEMBL. Indeed, Na<sup>+</sup> is stripped in the salt strip step (to get the Unsalted Canonical Representative output) in canSARchem and the following neutralization generate benzoic acid as a parent structure (Abstract Compound). Example 3 shows how ChEMBL standardizes sulphoxide with charge-separated forms, at odds with PubChem and canSAR. Standardization of doxycycline (entry 4) resulted in three different compound forms. The ChEMBL pipeline does not modify the input structure, due to lack of tautomer generation, whereas two different outputs are obtained through PubChem and canSARchem pipelines corresponding to different tautomeric forms for the tetracyclic scaffold. Eltrombopag (entries 5 and 6) highlights how a different tautomeric form is processed by the ChEMBL pipeline in comparison to PubChem and canSAR pipelines. Without tautomer generation, the two different forms of Eltrombopag give two different outputs in ChEMBL. PubChem and canSAR pipelines generate the same canonical tautomer, regardless of the input structure itself.<table-wrap id="Tab4"><label>Table 4</label><caption><p>Standardized and abstract structure generated through canSAR, ChEMBL and PubChem pipelines</p></caption><graphic position="anchor" xlink:href="13321_2022_606_Tab4_HTML" id="MO7"/><table-wrap-foot><p>Examples show how the three examined pipelines deal with specific chemical issues: 1. Valence of Nitro group. 2. Metal bond disconnection 3. Sulphoxides standardization 4. Tautomer generation and salt strip 5 and 6. Double bond isomerism and tautomer generation. Compounds analysed have been chosen among those shown in the comparison tables in Bento’s paper [<xref ref-type="bibr" rid="CR8">8</xref>]</p></table-wrap-foot></table-wrap></p>
      <p id="Par49">We also analysed the similarities/discrepancies in the detection and rejection of problematic structures between the three pipelines. The ideal pipeline would be able to correct issues with structures and reduce the overall rejection rate. To this aim, we used the supplementary files provided in the ChEMBL [<xref ref-type="bibr" rid="CR8">8</xref>] and PubChem [<xref ref-type="bibr" rid="CR9">9</xref>] pipelines papers. A key issue faced by all three pipelines is the assumption that the structure originally registered into any of the source databases is correct and an accurate reflection of the publication/experiment. Our standardiser attempts to modify and correct structures wherever appropriate, i.e. in entry 1 in Table <xref rid="Tab4" ref-type="table">4</xref>, the hypervalent nitro group is fixed during the standardisation. Table <xref rid="Tab5" ref-type="table">5</xref> highlights the rejection rates for canSAR and ChEMBL pipelines for 3 supplementary files from Bento and colleagues [<xref ref-type="bibr" rid="CR8">8</xref>], namely a file from Sure ChEMBL with 52 k structures, a file from ChEMBL with about 300 k compounds and a file from ChEMBL literature containing 147 k compounds with 0 rejections. Overall the performances of canSARchem and ChEMBL pipeline were similar, with canSARchem being more inclusive with Sure ChEMBL and PubChem files but less inclusive with the ChEMBL literature file rejecting 3 compounds. Only 0.22% of structures were rejected by canSARchem, versus the 1.6% of ChEMBL in the case of the Sure ChEMBL file. Specifically, most of the errors were due to sanitization errors concerning valence and wedge errors. 97.5% of PubChem file compounds are accepted by canSARchem, with 3,261 more compounds compared to ChEMBL (96.41%). In this case, most of the errors causing rejection by canSARchem were due to problems with empty molblock. The rejection rate with ChEMBL literature was very similar.<table-wrap id="Tab5"><label>Table 5</label><caption><p>Detections of problematic structure (I)</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">Sure_ChEMBL (SI1)</th><th align="left">Pubchem (SI2)</th><th align="left">ChEMBL literautre (SI3)</th></tr></thead><tbody><tr><td align="left">Structures #</td><td align="left">52,074</td><td align="left">297,864</td><td align="left">147,008</td></tr><tr><td align="left">ChEMBL pipeline errors (not uploaded structures)</td><td align="left">849 (1.6%)</td><td align="left">10,692 (3.59%)</td><td align="left">0</td></tr><tr><td align="left">ChEMBL uploaded structures</td><td align="left">51,225 (98.37%)</td><td align="left">287,172 (96.41%)</td><td align="left">100%</td></tr><tr><td align="left">canSAR pipeline errors (rejected structures)</td><td align="left">114 (0.22%)</td><td align="left">7431 (2.5%)</td><td align="left">3 (0.002%)</td></tr><tr><td align="left"> SDF parsing errors</td><td align="left">0</td><td align="left">0</td><td align="left">0</td></tr><tr><td align="left"> Sanitization errors</td><td align="left">110</td><td align="left">1540</td><td align="left">2</td></tr><tr><td align="left"> Standardization errors</td><td align="left">4</td><td align="left">67</td><td align="left">0</td></tr><tr><td align="left"> Empty molblock</td><td align="left">0</td><td align="left">5824</td><td align="left">1</td></tr><tr><td align="left">canSAR accepted structures</td><td align="left">51,960 (99.78%)</td><td align="left">290,433 (97.5%)</td><td align="left">147,005 (99.99%)</td></tr></tbody></table><table-wrap-foot><p>Comparison with ChEMBL Checker on Supplementary files available in ChEMBL chemical standardization pipeline paper [<xref ref-type="bibr" rid="CR8">8</xref>]. The canSAR pipeline is overall more inclusive with a lower percentage of rejected structures</p></table-wrap-foot></table-wrap></p>
      <p id="Par50">Aiming at comparing the rejection rate with PubChem, we processed the Additional file 4 supplied in the PubChem standardization pipeline paper [<xref ref-type="bibr" rid="CR9">9</xref>] through canSARchem. Specifically, this file contains substances that failed PubChem standardization but succeeded InChI normalization with the generation of the InChI string. The results, shown in Table <xref rid="Tab6" ref-type="table">6</xref>, highlight the higher inclusiveness of canSARchem compared to PubChem. Indeed, only 76.07% of structures are rejected by canSARchem with about 90 k compounds that can still be uploaded (Table <xref rid="Tab6" ref-type="table">6</xref>).<table-wrap id="Tab6"><label>Table 6</label><caption><p>Detections of problematic structure (II)</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left"/><th align="left">PubChem<break/>Add_File_4</th></tr></thead><tbody><tr><td align="left"/><td align="left">Structures #</td><td align="left">375,397</td></tr><tr><td align="left"/><td align="left"> PubChem pipeline errors (rejected compounds)</td><td align="left">375,397 (100%)</td></tr><tr><td align="left" rowspan="4"><p>ERRORS found</p><p>PubChem Checker</p></td><td align="left">  Invalid isotope specifications</td><td align="left">141</td></tr><tr><td align="left">  Valence check</td><td align="left">364,946 (97.22%)</td></tr><tr><td align="left">  Identical charges on adjacent atoms or invalid valence after valence bond canonicalization</td><td align="left">10,243</td></tr><tr><td align="left">  Excess the limit of 999 explicit atoms</td><td align="left">65</td></tr><tr><td align="left"/><td align="left"> canSAR pipeline errors (rejected compounds)</td><td align="left">285,552 (76.07%)</td></tr><tr><td align="left"/><td align="left">  SDF parsing errors</td><td align="left">0</td></tr><tr><td align="left" rowspan="2"/><td align="left">  Sanitization errors</td><td align="left">270,131 (71.96%)</td></tr><tr><td align="left">  Standardization errors</td><td align="left">2954 (0.78%)</td></tr><tr><td align="left"/><td align="left">  Empty molblock</td><td align="left">12,467 (3.37%)</td></tr><tr><td align="left"/><td align="left">canSAR accepted structures</td><td align="left">89,845 (23.93%)</td></tr></tbody></table><table-wrap-foot><p>Comparison with PubChem Checker on Supplementary files available from PubChem chemical standardization pipeline paper [<xref ref-type="bibr" rid="CR9">9</xref>]. Additional file 4 was used. The canSAR pipeline is overall more inclusive with a lower percentage of rejected structures but a superior performance in correcting wrong structure ahead of importing them in the database</p></table-wrap-foot></table-wrap></p>
      <p id="Par51">To understand the reason for such differences in the percentage of rejection rate, we looked at some specific examples of compounds accepted by canSARchem. Table <xref rid="Tab7" ref-type="table">7</xref> includes three examples of compounds where canSARchem identified errors/inconsistencies and fixed them during the standardization and thus there were successfully accepted for registration. Entry 1 (compound 757 in Additional file 4 from PubChem) was successfully standardized and accepted by canSARchem although having an unusual valence on the sulphur atom. The detected error in PubChem concerns precisely the sulphur valence and the same issue (with a score of 6) is detected by the ChEMBL checker. Importantly, in the ChEMBL pipeline, the decision for rejecting or accepting structures is based on the score obtained in the Checker step. A score of 6 means that the compounds are loaded into the database but without a molfile, since the issue is considered to be relevant. Thus, the standardization process in ChEMBL is not diagnostic for wrong structures. This example illustrates a limitation of our pipeline which is not able to reject this compound despite the wrong valence. A similar case is shown in entry 2 (425,614), where PubChem detects the same error of the wrong valence for a sulphur atom. In this case, however, ChEMBL gives a score which is not related to the sulphur valence and the overall score would allow accepting the structure for database uploading. The examples in entries 3 and 4 represent the same compound (219,012) submitted to the pipelines as it was in the Additional file 4 (entry 3) and after canSAR standardization. canSAR and ChEMBL in this case outperform PubChem at fixing the hypervalent nitro group, generating an output structure that is perceived as correct by PubChem. Therefore, on the one hand, canSAR pipeline can be sometimes too inclusive in accepting compounds with a wrong valence, but, on the other hand, it is effective at fixing many compounds. Importantly, the issues around sulphur atom valence are not easy to solve, as demonstrated also by the different scores for a similar case given by ChEMBL to compounds from entries 1 and 2.<table-wrap id="Tab7"><label>Table 7</label><caption><p>Example of compounds rejected by PubChem pipeline</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Entry</th><th align="left">Input molecule</th><th align="left">canSAR standardization (FICTS)</th><th align="left">PubChem errors</th><th align="left">ChEMBL standardization</th><th align="left">ChEMBL errors</th></tr></thead><tbody><tr><td align="left">1</td><td align="left"><inline-graphic xlink:href="13321_2022_606_Figa_HTML.gif" id="d32e2216"/></td><td align="left"><inline-graphic xlink:href="13321_2022_606_Figb_HTML.gif" id="d32e2221"/></td><td align="left">Detect illegal valence for element “S”</td><td align="left"><inline-graphic xlink:href="13321_2022_606_Figc_HTML.gif" id="d32e2229"/></td><td align="left">6, [‘InChI: accepted unusual valence(s)’], (2, ‘InChI: metal was disconnected’)</td></tr><tr><td align="left">2</td><td align="left"><inline-graphic xlink:href="13321_2022_606_Figd_HTML.gif" id="d32e2241"/></td><td align="left"><inline-graphic xlink:href="13321_2022_606_Fige_HTML.gif" id="d32e2246"/></td><td align="left">Detect illegal valence for element “S”</td><td align="left"><inline-graphic xlink:href="13321_2022_606_Figf_HTML.gif" id="d32e2254"/></td><td align="left">2, ‘InChI: Metal was disconnected’</td></tr><tr><td align="left">3</td><td align="left"><inline-graphic xlink:href="13321_2022_606_Figg_HTML.gif" id="d32e2266"/></td><td align="left"><inline-graphic xlink:href="13321_2022_606_Figh_HTML.gif" id="d32e2271"/></td><td align="left">Unable to fix pentavalent nitroso group</td><td align="left"><inline-graphic xlink:href="13321_2022_606_Figi_HTML.gif" id="d32e2279"/></td><td align="left">No issues detected</td></tr><tr><td align="left">4</td><td align="left"><inline-graphic xlink:href="13321_2022_606_Figj_HTML.gif" id="d32e2291"/></td><td align="left"><inline-graphic xlink:href="13321_2022_606_Figk_HTML.gif" id="d32e2296"/></td><td align="left">No issues detected</td><td align="left"><inline-graphic xlink:href="13321_2022_606_Figl_HTML.gif" id="d32e2304"/></td><td align="left">No issues detected</td></tr></tbody></table><table-wrap-foot><p>Examples of compounds rejected by the PubChem pipeline. All these compounds are valid according to the canSAR pipeline, which results to be more inclusive. Of note, inclusiveness of canSAR seems to be higher in edge cases with organometallic complexes where the valence is not easily perceived</p></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="Sec18">
      <title>Statistical analysis of FDA-approved drugs</title>
      <p id="Par52">After processing all 3 million compounds through canSARchem, we investigated the degree to which FDA-approved drugs were affected for canonicalization and chirality and thus will be impacted by the amount of biological data that can be consolidated from different sources. We compared structures of FDA approved drugs (4094) against all other compounds in canSAR (3,153,790). To count compounds that were not registered as canonical forms, we compared the Standardized Compounds and the Canonical Representatives. To ensure structure uniqueness and to avoid different salt forms of the same drug counting as different compounds, we performed the comparison at the level of the Unsalted Standard Compound (which was generated ad hoc) and the Unsalted Canonical Tautomer. It is important to stress that there could be a small bias in this analysis as tautomers are only calculated for compounds with less than 100 atoms which are slightly less common among drugs (91.7%) than the rest of compounds (93.6%). H-fixed NonStandard InChIs of these forms were then compared showing that 9.7% (1,988,409) of all canSAR compounds were registered as non-canonical forms and underwent modifications during canonicalization. A much larger fraction (17.51%) of FDA-approved drugs were modified during canonicalization, showing a statistically significant enrichment (p value &lt; 0.0001) in the chi-squared over all other compounds in canSAR. Correction of chirality, on the other hand, was similar between the two groups (44.78% for all canSAR compounds and 42.01% for FDA-approved drugs, Table <xref rid="Tab8" ref-type="table">8</xref>). The enrichment of tautomeric forms among FDA-approved drugs highlights the importance of canonicalization for accurate data aggregation based on the chemical structure in public databases. To further assess the impact of the tautomerization, we looked for compounds families where the canSARchem pipeline allowed us to bring together data that would have otherwise been separated. We found 160 compounds families, containing at least one compound tagged as an FDA-approved drug, with at least two different tautomeric forms with registered bioactivity data. The above-mentioned tivozanib, pemetrexed and ganciclovir, together with valacyclovir, oxypurinol, dihydroxyacetone, malic acid and idelalisib are all examples of bioactivity and crystallography data linked to alternative tautomeric forms brought together through the canSARchem hierarchy.<table-wrap id="Tab8"><label>Table 8</label><caption><p>FDA-approved drugs enrichment</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">All canSAR compounds</th><th align="left">FDA-approved drugs</th><th align="left">Chi-squared test</th></tr></thead><tbody><tr><td align="left">Total number of unique valid structures</td><td align="left">1,988,409</td><td align="left">2450</td><td align="left">–</td></tr><tr><td align="left">Compounds registered as non canonical forms</td><td align="left">192,933 (9.7%)</td><td align="left">429 (17.51%)</td><td align="left"><p>χ<sup>2</sup> = 8,558,547,933</p><p>p-value &lt; 0.0001</p></td></tr><tr><td align="left">Chiral compounds</td><td align="left">890,562 (44.78%)</td><td align="left">1031 (42.01%)</td><td align="left">Not enriched</td></tr></tbody></table><table-wrap-foot><p>FDA-approved drugs were compared to all compounds registered in canSAR for canonicalization and chirality enrichment. A significant p-value for compounds modified during canonicalization has been found through the Chi-squared test</p></table-wrap-foot></table-wrap></p>
    </sec>
  </sec>
  <sec id="Sec19">
    <title>Conclusions</title>
    <p id="Par53">We have developed a chemical registration and standardization pipeline using KNIME and made it freely available. We used the pipeline to process &gt; 3 M compounds available in canSAR, grouping them to enable users to rapidly identify alternative representations of any chemical compound and explore their bioactivities where appropriate. As exemplified in Figs. <xref rid="Fig3" ref-type="fig">3</xref> and <xref rid="Fig4" ref-type="fig">4</xref>, the compound grouping created by canSARchem facilitates the identification of important bioactivity data and curation errors that may otherwise be missed. These hierarchies have been implemented in the canSAR website to facilitate their use. Despite its importance, canonical tautomerization continues to be a challenging, and not completely solved problem in cheminformatics that can affect some of the hierarchies. Our comparison between four different approaches demonstrates that the commercial software ChemAxon outperforms publicly available approaches and has therefore been chosen for the canSAR pipeline. However, the progress of public canonicalization approaches in RDKit is very encouraging and raise hopes of transitioning to open access canonicalization software in the near future. A thorough comparison between the canSAR, ChEMBL and PubChem pipelines demonstrates that all three pipelines show comparable performance in compound standardization. The main differences lie in the use of open-access software and canonicalization. ChEMBL uses fully open access software but does not perform canonicalization. PubChem includes a canonicalization step but under fully commercial software and many components of the pipeline are not available for users. canSARchem also performs canonicalization but uses mostly open-access software and the full pipeline is available under a Creative Commons licence but requires that users obtain their own ChemAxon license. canSARchem pipeline also has a slightly lower rejection rate compared to both PubChem and ChEMBL. Overall, canSARchem KNIME pipeline represents a solid compound registration and standardization approach, that generates a compound hierarchy that can help users identify valuable bioactivity data from related structures that otherwise could be missed. Given that FDA-approved drugs have shown a significant enrichment of canonicalization compared to other compounds in canSAR, our results also highlight the importance of canonicalizing in public medicinal chemistry databases and the urgent need for better canonicalization approaches.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec20">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13321_2022_606_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1: Figure S1. A</bold> Files importer. sdf.gz files are imported through the <italic>SDF Reader</italic> node with their paths being read through the <italic>List Files</italic> node. <bold>B</bold> Structure Checker. Correct molecules are imported in KNIME through the <italic>SDF</italic>
<italic>Reader</italic> node and after kekulization (by means of the <italic>Dearomatizer</italic> node) are converted into RDKit mol format and partially sanitised using the <italic>RDKit from Molecule</italic> node. As a last sanity check, compounds with empty mol block are removed through the <italic>RDKit Substructure Filter</italic> node and are ready for the standardization step. All wrong compounds identified through these steps go to the <italic>Errors_No_Structures</italic> metanode to be written in the <italic>Errors</italic> or <italic>No_Structures</italic> folders. <bold>Figure S2.</bold> Examples of differences in neutralization between MolVS, ChemAxon and RDKit. In BindingDB, 11,284 molecules were charged after RDKit standardization. From them, 5212 molecules were still charged after Neutralization performed through ChemAxon Standardizer, including inorganic salts and charged functional groups (e.g., nitro). In contrast, about 200 additional compounds (5063 charged molecules after RDKit neutralization) were neutralized by the RDKit neutralization function in comparison to ChemAxon, i.e., entries 1 and 2 (rdMolStandardize.Uncharger module). Examples below illustrate these differences. Users should be mindful about the differences, particularly when using the fully open access version of our pipeline, canSARchemRDKit, that may neutralize some additional compounds. <bold>Figure S3.</bold> Examples of metal bonds. Entry 1 represents a case where the metal bond was not processed during RDKit standardization and was disconnected through the subsequent extra step. Entry 2 represents a case where RDKit standardization efficiently dealt with metal bond. <bold>Figure S4.</bold> Standardizer. Compounds standardization is performed through RDKit. Exceptions are dealt with separately using an additional neutralization step as well as an extra step to break metal bonds, which are not recognized by RDKit. <bold>Figure S5.</bold> Generation of canonical representatives. ChemAxon/Infocom Tautomers node is used to generate the canonical tautomers with the protection of stereochemistry and double bond annotations. <bold>Figure S6.</bold> Salt Strip. Sequential steps for stripping salts and solvents from compounds and generating the unsalted canonical representatives. <bold>Figure S7.</bold> Generation of abstract compound. Abstract compound is obtained through clearing stereoisomerism, double bond isomerism and isotopes annotations aiming to group compounds into families. <bold>Table S1.</bold> Comparison of ChemAxon and RDKit canonicalization. ChemAxon and RDKit canonicalization have been executed protecting double-bond isomerism and stereochemistry. Entry 1 and 4 show examples of ineffective protection of double-bond isomerism by RDKit tool. In entry 2 and 3, instead, the stereochemistry label is lost in the RDKit output. In all cases, ChemAxon output was the same as the input molecule evidencing its higher reliability at protecting both stereo and double-bond isomerism.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank the Heather Beckwith Charitable Settlement and The John L. Beckwith Charitable Trust for their generous support of our High Performance Computing facility. We would like to thank all the members of the canSAR Team and the canSAR’s Scientific Advisory Board whose advice, guidance and commitment to the development of canSARchem have been invaluable. We would also want to thank Ian Collins, John Overington and Huabin Hu for their help assessing the pipeline.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>DD, EV-F, CK, MM, AAA, and BA-L designed the research and contributed to manuscript preparation. DD, EV-F, and CK performed the computational research. DD, EV-F, CK, AAA, and BA-L conducted data analysis and interpretation. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>AAA is primarily supported by a Wellcome Trust Sir Henry Wellcome Postdoctoral Fellowship (204735/Z/16/Z); the People Programme (Marie Curie Actions) of the 7th Framework Programme of the European Union (FP7/2007–2013) under REA Grant Agreement No. 600388 (TECNIOspring programme); and the Agency of Business Competitiveness of the Government of Catalonia, ACCIO. BA-L, DD and MM are funded by a Cancer Research UK (CRUK) programme grant to the CRUK Cancer Therapeutics Unit (grant C309/A11566). BA-L receives research funding from a Wellcome Trust biomedical resource and technology Grant to sustain and develop the Chemical Probes Portal (212969/Z/18/Z) and from canSAR Research UK Drug Discovery Committee strategic award to sustain and develop canSAR (C35696/A23187). DD and EV-F are funded by a CRUK Drug Discovery Committee strategic award to sustain and develop canSAR (C35696/A23187). We acknowledge infrastructure support from CRUK for the ICR CRUK Centre and NHS funding to the NIHR Biomedical Research Centre at the ICR and Royal Marsden NHS Foundation Trust. The open access fees were covered by the ICR Sir John Beckwith Library.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The datasets supporting the conclusions of this article are available in ChEMBL (<ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/chembl/">https://www.ebi.ac.uk/chembl/</ext-link>), PubChem (<ext-link ext-link-type="uri" xlink:href="https://pubchem.ncbi.nlm.nih.gov/">https://pubchem.ncbi.nlm.nih.gov/</ext-link>) and PDB (<ext-link ext-link-type="uri" xlink:href="https://www.rcsb.org/">https://www.rcsb.org/</ext-link>).</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par54">DD, EV-F, CK, MM, AAA and BA-L are/were employees of The Institute of Cancer Research (ICR), which has a commercial interest in a range of drug targets. The ICR operates a Rewards to Inventors scheme whereby employees of the ICR may receive financial benefits following the commercial licensing of a project. BA-L is an employee of MD Anderson Cancer Center which also operates a Reward to Inventors Scheme. BA-L declares commercial interest in Exscientia and Astra Zeneca. BA-L is/was a consultant/ scientific advisory board member for GSK, Open Targets, Astex Pharmaceuticals, Astellas Pharma and is an ex-employee of Inpharmatica Ltd. AAA is/was a consultant of Darwin Health. CK is an employee of Astra Zeneca. DD, EV-F, CK, AAA and BA-L have been instrumental in the creation/development of canSAR and/or Probe Miner. BA-L was instrumental in the creation of ChEMBL and is a Director of the non-profit Chemical Probes Portal.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mitsopoulos</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Di Micco</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Fernandez</surname>
            <given-names>EV</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CanSAR: Update to the cancer translational research and drug discovery knowledgebase</article-title>
        <source>Nucleic Acids Res</source>
        <year>2021</year>
        <volume>49</volume>
        <fpage>D1074</fpage>
        <lpage>D1082</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkaa1059</pub-id>
        <?supplied-pmid 33219674?>
        <pub-id pub-id-type="pmid">33219674</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mitsopoulos</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Antolin</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Fernandez</surname>
            <given-names>EV</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Coronavirus canSAR—a data-driven, AI-enabled</article-title>
        <source>Drug Discov Resour Res Commun</source>
        <year>2020</year>
        <pub-id pub-id-type="doi">10.26434/CHEMRXIV.12286877.V1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Arrowsmith</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Audia</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Austin</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The promise and peril of chemical probes</article-title>
        <source>Nat Chem Biol</source>
        <year>2015</year>
        <volume>11</volume>
        <issue>8</issue>
        <fpage>536</fpage>
        <lpage>541</lpage>
        <pub-id pub-id-type="doi">10.1038/nchembio.1867</pub-id>
        <?supplied-pmid 26196764?>
        <pub-id pub-id-type="pmid">26196764</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mendez</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gaulton</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bento</surname>
            <given-names>AP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ChEMBL: towards direct deposition of bioassay data</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <fpage>D930</fpage>
        <lpage>D940</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky1075</pub-id>
        <?supplied-pmid 30398643?>
        <pub-id pub-id-type="pmid">30398643</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gilson</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Baitaluk</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>BindingDB in 2015: a public database for medicinal chemistry, computational chemistry and systems pharmacology</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>D1045</fpage>
        <lpage>D1053</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv1072</pub-id>
        <?supplied-pmid 26481362?>
        <pub-id pub-id-type="pmid">26481362</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>Consortium Pdb-K</collab>
          <name>
            <surname>Varadi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Berrisford</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PDBe-KB: a community-driven resource for structural and functional annotations</article-title>
        <source>Nucleic Acids Res</source>
        <year>2020</year>
        <volume>48</volume>
        <fpage>D344</fpage>
        <lpage>D353</lpage>
        <pub-id pub-id-type="doi">10.1093/NAR/GKZ853</pub-id>
        <pub-id pub-id-type="pmid">31584092</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Antolin</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Tym</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Komianou</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Objective, quantitative, data-driven assessment of chemical probes</article-title>
        <source>Cell Chem Biol</source>
        <year>2018</year>
        <volume>25</volume>
        <fpage>194</fpage>
        <lpage>205.e5</lpage>
        <pub-id pub-id-type="doi">10.1016/j.chembiol.2017.11.004</pub-id>
        <?supplied-pmid 29249694?>
        <pub-id pub-id-type="pmid">29249694</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bento</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Hersey</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Félix</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An open source chemical structure curation pipeline using RDKit</article-title>
        <source>J Cheminformatics</source>
        <year>2020</year>
        <volume>12</volume>
        <fpage>51</fpage>
        <pub-id pub-id-type="doi">10.1186/s13321-020-00456-1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hähnke</surname>
            <given-names>VD</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bolton</surname>
            <given-names>EE</given-names>
          </name>
        </person-group>
        <article-title>PubChem chemical structure standardization</article-title>
        <source>J Cheminformatics</source>
        <year>2018</year>
        <volume>10</volume>
        <fpage>36</fpage>
        <pub-id pub-id-type="doi">10.1186/s13321-018-0293-8</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Berthold</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Cebron</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Dill</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>KNIME: the Konstanz information miner</article-title>
        <source>Stud Classif Data Anal Knowl Organ</source>
        <year>2008</year>
        <pub-id pub-id-type="doi">10.1007/978-3-540-78246-9_38</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hersey</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Chambers</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bellis</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Chemical databases: curation or integration by user-defined equivalence?</article-title>
        <source>Drug Discov Today Technol</source>
        <year>2015</year>
        <volume>14</volume>
        <fpage>17</fpage>
        <lpage>24</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ddtec.2015.01.005</pub-id>
        <?supplied-pmid 26194583?>
        <pub-id pub-id-type="pmid">26194583</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Akhondi</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Kors</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Muresan</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Consistency of systematic chemical identifiers within and between small-molecule databases</article-title>
        <source>J Cheminformatics</source>
        <year>2012</year>
        <volume>4</volume>
        <fpage>35</fpage>
        <pub-id pub-id-type="doi">10.1186/1758-2946-4-35</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Warr</surname>
            <given-names>WA</given-names>
          </name>
        </person-group>
        <article-title>Representation of chemical structures</article-title>
        <source>Wiley Interdiscip Rev Comput Mol Sci</source>
        <year>2011</year>
        <volume>1</volume>
        <fpage>557</fpage>
        <lpage>579</lpage>
        <pub-id pub-id-type="doi">10.1002/wcms.36</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Williams</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Ekins</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>A quality alert and call for improved curation of public chemistry databases</article-title>
        <source>Drug Discov Today</source>
        <year>2011</year>
        <volume>16</volume>
        <fpage>747</fpage>
        <lpage>750</lpage>
        <pub-id pub-id-type="doi">10.1016/j.drudis.2011.07.007</pub-id>
        <?supplied-pmid 21871970?>
        <pub-id pub-id-type="pmid">21871970</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Williams</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Ekins</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tkachenko</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Towards a gold standard: regarding quality in public domain chemistry databases and approaches to improving the situation</article-title>
        <source>Drug Discov Today</source>
        <year>2012</year>
        <volume>17</volume>
        <fpage>685</fpage>
        <lpage>701</lpage>
        <pub-id pub-id-type="doi">10.1016/j.drudis.2012.02.013</pub-id>
        <?supplied-pmid 22426180?>
        <pub-id pub-id-type="pmid">22426180</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sitzmann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ihlenfeldt</surname>
            <given-names>WD</given-names>
          </name>
          <name>
            <surname>Nicklaus</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <article-title>Tautomerism in large databases</article-title>
        <source>J Comput Aided Mol Des</source>
        <year>2010</year>
        <volume>24</volume>
        <fpage>521</fpage>
        <lpage>551</lpage>
        <pub-id pub-id-type="doi">10.1007/s10822-010-9346-4</pub-id>
        <?supplied-pmid 20512400?>
        <pub-id pub-id-type="pmid">20512400</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weininger</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>SMILES, a chemical language and information system: 1: introduction to methodology and encoding rules</article-title>
        <source>J Chem Inf Comput Sci</source>
        <year>1988</year>
        <volume>28</volume>
        <fpage>31</fpage>
        <lpage>36</lpage>
        <pub-id pub-id-type="doi">10.1021/ci00057a005</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weininger</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Weininger</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Weininger</surname>
            <given-names>JL</given-names>
          </name>
        </person-group>
        <article-title>SMILES. 2. Algorithm for generation of unique SMILES notation</article-title>
        <source>J Chem Inf Comput Sci</source>
        <year>1989</year>
        <volume>29</volume>
        <fpage>97</fpage>
        <lpage>101</lpage>
        <pub-id pub-id-type="doi">10.1021/ci00062a008</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heller</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>McNaught</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Stein</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>InChI—the worldwide chemical structure identifier standard</article-title>
        <source>J Cheminformatics</source>
        <year>2013</year>
        <volume>5</volume>
        <fpage>7</fpage>
        <pub-id pub-id-type="doi">10.1186/1758-2946-5-7</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heller</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>McNaught</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pletnev</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>InChI, the IUPAC international chemical identifier</article-title>
        <source>J Cheminformatics</source>
        <year>2015</year>
        <volume>7</volume>
        <fpage>23</fpage>
        <pub-id pub-id-type="doi">10.1186/s13321-015-0068-4</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <mixed-citation publication-type="other">Technical FAQ—InChI Trust. <ext-link ext-link-type="uri" xlink:href="https://www.inchi-trust.org/technical-faq-2/#2.6">https://www.inchi-trust.org/technical-faq-2/#2.6</ext-link>. Accessed 20 May 2021</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">KNIME Analytics Platform|KNIME. <ext-link ext-link-type="uri" xlink:href="https://www.knime.com/knime-analytics-platform">https://www.knime.com/knime-analytics-platform</ext-link>. Accessed 28 Apr 2021</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">RDKit. <ext-link ext-link-type="uri" xlink:href="http://www.rdkit.org/">http://www.rdkit.org/</ext-link>. Accessed 15 Dec 2021</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sitzmann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Filippov</surname>
            <given-names>IV</given-names>
          </name>
          <name>
            <surname>Nicklaus</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <article-title>Internet resources integrating many small-molecule databases</article-title>
        <source>SAR QSAR Environ Res</source>
        <year>2008</year>
        <volume>19</volume>
        <fpage>1</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1080/10629360701843540</pub-id>
        <?supplied-pmid 18311630?>
        <pub-id pub-id-type="pmid">18311630</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <mixed-citation publication-type="other">MolVS: Molecule Validation and Standardization—MolVS 0.1.1 documentation. <ext-link ext-link-type="uri" xlink:href="https://molvs.readthedocs.io/en/latest/">https://molvs.readthedocs.io/en/latest/</ext-link>. Accessed 20 Mar 2022</mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dhaked</surname>
            <given-names>DK</given-names>
          </name>
          <name>
            <surname>Ihlenfeldt</surname>
            <given-names>WD</given-names>
          </name>
          <name>
            <surname>Patel</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Toward a comprehensive treatment of tautomerism in chemoinformatics including in InChI V2</article-title>
        <source>J Chem Inf Model</source>
        <year>2020</year>
        <volume>60</volume>
        <fpage>1253</fpage>
        <lpage>1275</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jcim.9b01080</pub-id>
        <?supplied-pmid 32043883?>
        <pub-id pub-id-type="pmid">32043883</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katritzky</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Dennis Hall</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>El-Gendy</surname>
            <given-names>BEDM</given-names>
          </name>
          <name>
            <surname>Draghici</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Tautomerism in drug discovery</article-title>
        <source>J Comput Aided Mol Des</source>
        <year>2010</year>
        <volume>24</volume>
        <fpage>475</fpage>
        <lpage>484</lpage>
        <pub-id pub-id-type="doi">10.1007/s10822-010-9359-z</pub-id>
        <?supplied-pmid 20490619?>
        <pub-id pub-id-type="pmid">20490619</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guasch</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Yapamudiyansel</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Peach</surname>
            <given-names>ML</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Experimental and chemoinformatics study of tautomerism in a database of commercially available screening samples</article-title>
        <source>J Chem Inf Model</source>
        <year>2016</year>
        <volume>56</volume>
        <fpage>2149</fpage>
        <lpage>2161</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jcim.6b00338</pub-id>
        <?supplied-pmid 27669079?>
        <pub-id pub-id-type="pmid">27669079</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">MolVS: molecule validation and standardization—MolVS 0.1.1 documentation. <ext-link ext-link-type="uri" xlink:href="https://molvs.readthedocs.io/en/latest/">https://molvs.readthedocs.io/en/latest/</ext-link>. Accessed 28 Apr 2021</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">rdkit.Chem.MolStandardize.rdMolStandardize module—The RDKit 2021.03.1 documentation. <ext-link ext-link-type="uri" xlink:href="https://www.rdkit.org/docs/source/rdkit.Chem.MolStandardize.rdMolStandardize.html">https://www.rdkit.org/docs/source/rdkit.Chem.MolStandardize.rdMolStandardize.html</ext-link>. Accessed 30 Jul 2021</mixed-citation>
    </ref>
  </ref-list>
</back>
