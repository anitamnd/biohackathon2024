<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9990256</article-id>
    <article-id pub-id-type="pmid">36879227</article-id>
    <article-id pub-id-type="publisher-id">5205</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-023-05205-3</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>coda4microbiome: compositional data analysis for microbiome cross-sectional and longitudinal studies</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9334-415X</contrib-id>
        <name>
          <surname>Calle</surname>
          <given-names>M. Luz</given-names>
        </name>
        <address>
          <email>malu.calle@uvic.cat</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-0313-3506</contrib-id>
        <name>
          <surname>Pujolassos</surname>
          <given-names>Meritxell</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-0874-2784</contrib-id>
        <name>
          <surname>Susin</surname>
          <given-names>Antoni</given-names>
        </name>
        <address>
          <email>toni.susin@upc.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.440820.a</institution-id><institution>Biosciences Department, Faculty of Sciences, Technology and Engineering, </institution><institution>University of Vic - Central University of Catalonia, </institution></institution-wrap>Carrer de La Laura, 13, 08500 Vic, Spain </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.6835.8</institution-id><institution-id institution-id-type="ISNI">0000 0004 1937 028X</institution-id><institution>Mathematical Department, </institution><institution>UPC-Barcelona Tech, </institution></institution-wrap>Barcelona, Spain </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>6</day>
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>6</day>
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>82</elocation-id>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>7</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>2</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">One of the main challenges of microbiome analysis is its compositional nature that if ignored can lead to spurious results. Addressing the compositional structure of microbiome data is particularly critical in longitudinal studies where abundances measured at different times can correspond to different sub-compositions.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We developed <italic>coda4microbiome</italic>, a new R package for analyzing microbiome data within the Compositional Data Analysis (CoDA) framework in both, cross-sectional and longitudinal studies. The aim of <italic>coda4microbiome</italic> is prediction, more specifically, the method is designed to identify a model (microbial signature) containing the minimum number of features with the maximum predictive power. The algorithm relies on the analysis of log-ratios between pairs of components and variable selection is addressed through penalized regression on the “all-pairs log-ratio model”, the model containing all possible pairwise log-ratios. For longitudinal data, the algorithm infers dynamic microbial signatures by performing penalized regression over the summary of the log-ratio trajectories (the area under these trajectories). In both, cross-sectional and longitudinal studies, the inferred microbial signature is expressed as the (weighted) balance between two groups of taxa, those that contribute positively to the microbial signature and those that contribute negatively. The package provides several graphical representations that facilitate the interpretation of the analysis and the identified microbial signatures. We illustrate the new method with data from a Crohn's disease study (cross-sectional data) and on the developing microbiome of infants (longitudinal data).</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3"><italic>coda4microbiome</italic> is a new algorithm for identification of microbial signatures in both, cross-sectional and longitudinal studies. The algorithm is implemented as an R package that is available at CRAN (<ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/coda4microbiome/">https://cran.r-project.org/web/packages/coda4microbiome/</ext-link>) and is accompanied with a vignette with a detailed description of the functions. The website of the project contains several tutorials: <ext-link ext-link-type="uri" xlink:href="https://malucalle.github.io/coda4microbiome/">https://malucalle.github.io/coda4microbiome/</ext-link></p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-023-05205-3.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Compositional data analysis</kwd>
      <kwd>Log-ratio analysis</kwd>
      <kwd>Longitudinal studies</kwd>
      <kwd>Microbiome analysis</kwd>
      <kwd>Microbial signatures</kwd>
      <kwd>Penalized regression</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100017642</institution-id>
            <institution>Spanish National Plan for Scientific and Technical Research and Innovation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>PID2019-104830RB-I00</award-id>
        <award-id>PID2021-123657OB-C33</award-id>
        <award-id>PID2021-122136OB-C21</award-id>
        <principal-award-recipient>
          <name>
            <surname>Calle</surname>
            <given-names>M. Luz</given-names>
          </name>
          <name>
            <surname>Susin</surname>
            <given-names>Antoni</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par4">Although there are still many unknowns about the specific mechanisms of action of the human microbiome, there is growing evidence of its relevance in human health [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR38">38</xref>]. In recent years, much progress has been made in microbiome research thanks to high-throughput DNA sequencing technologies that allow precise quantification of the composition of the microbiome. The study of the microbiome is considered a great opportunity for improving the current treatment of some diseases and for deriving microbial biomarkers that could be used as diagnostic or prognostic tools.</p>
    <p id="Par5">Microbiome composition is dynamic and the study of microbiome changes over time is of primary importance for understanding the relationship between microbiome and human phenotypes. Longitudinal studies are costly, both economically and logistically, but there is growing evidence of the limitations of cross-sectional studies for providing a full picture of the role of the microbime in human health. Microbiome longitudinal studies can be very valuable in this context, provided appropriate methods of analysis are used [<xref ref-type="bibr" rid="CR34">34</xref>]. The analysis of microbiome data involves significant experimental and computational challenges [<xref ref-type="bibr" rid="CR5">5</xref>]. One of them is the compositional nature of the data, which requires the use of specific methods of analysis [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR17">17</xref>–<xref ref-type="bibr" rid="CR19">19</xref>]. Compositional data refers to constraint multivariate non-negative data that carry relative information. Microbiome relative abundances (proportions) are constrained by a total sum equal to one. This total constraint induces strong dependencies among the observed abundances of the different taxa. In fact, the observed abundance of each taxon is not informative and only provide a relative measure of abundance when compared to the abundances of other taxa [<xref ref-type="bibr" rid="CR36">36</xref>]. Ignoring the compositional nature of microbiome data can lead to spurious results [<xref ref-type="bibr" rid="CR28">28</xref>, <xref ref-type="bibr" rid="CR37">37</xref>]. This is particularly critical in the context of microbiome longitudinal studies where compositions measured at different times can be affected by distinct batch effects and similar quality control or filtering protocols may yield to different sub-compositions at each time point.</p>
    <p id="Par6">Aitchison [<xref ref-type="bibr" rid="CR2">2</xref>] laid the foundations of Compositional Data Analysis (CoDA), which relies on extracting the relative information of compositional data by comparing the parts of the composition. Logarithms of ratios between components (log-ratios) are the fundamental transformation in this framework [<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR31">31</xref>] and is known as the log-ratio approach.</p>
    <p id="Par7">Some methods used in microbiome analysis, such as <italic>ALDEx2</italic> [<xref ref-type="bibr" rid="CR13">13</xref>], <italic>LinDA</italic> [<xref ref-type="bibr" rid="CR39">39</xref>, <xref ref-type="bibr" rid="CR40">40</xref>], <italic>ANCOM</italic> [<xref ref-type="bibr" rid="CR26">26</xref>], <italic>ANCOM-BC</italic> [<xref ref-type="bibr" rid="CR23">23</xref>], <italic>fastANCOM</italic> [<xref ref-type="bibr" rid="CR39">39</xref>] and <italic>LOOCM</italic> [<xref ref-type="bibr" rid="CR21">21</xref>], perform the log-ratio approach to identify differential abundant taxa between two study groups. Here we introduce <italic>coda4microbiome</italic>, a new R package for analyzing microbiome data within the CoDA framework in both, cross-sectional and longitudinal studies. <italic>coda4microbiome</italic> is an improvement of our previous algorithm, <italic>selbal</italic> [<xref ref-type="bibr" rid="CR33">33</xref>], using a more flexible model and a more computationally efficient global variable selection method that results in a considerable reduction of computational time. <italic>coda4microbiome</italic> differs from most differential abundance (DA) testing methods that aim to characterize microbial communities by selecting taxa with significant different abundances between two study groups (<italic>e.g.</italic>, controls vs cases). Like <italic>selbal</italic>, the aim of <italic>coda4microbiome</italic> is prediction, <italic>i.e.</italic>, the method is designed to identify a model (microbial signature) containing the minimum number of features with the maximum predictive power. The algorithm relies on the analysis of log-ratios between pairs of components and variable selection is addressed through penalized regression on the “all-pairs log-ratio model”, the model containing all possible pairwise log-ratios.</p>
    <p id="Par8">For longitudinal data, pairwise log-ratios measured at different time points gives a curve profile or trajectory for each sample. A summary of the shape of these individual trajectories will be the basis for the analysis. More specifically, the algorithm infers dynamic microbial signatures by performing penalized regression over the summary of the log-ratio trajectories (the area under these trajectories).</p>
    <p id="Par9">In both, cross-sectional and longitudinal studies, after reparameterization of the initial “all-pairs log-ratio model”, the inferred microbial signature is expressed as a function of the (log-transformed) initial variables in the form of a log-contrast model [<xref ref-type="bibr" rid="CR3">3</xref>], <italic>i.e.</italic>, a log-linear model with the constraint that the sum of the coefficients is equal to zero. The zero-sum constraint ensures the invariance principle required for compositional data analysis. These microbial signatures can be interpreted as the (weighted) balance between two groups of taxa, those that contribute positively to the microbial signature and those that contribute negatively. For longitudinal data and a binary outcome (<italic>e.g.</italic> disease status), the signature provides two groups of taxa with different log-ratio trajectories for cases and controls.</p>
    <p id="Par10">The algorithm is implemented in the R package “code4microbiome” (<ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/coda4microbiome/">https://cran.r-project.org/web/packages/coda4microbiome/</ext-link>). Several graphical representations of the results are provided that facilitate the interpretation of the analysis: plot of the log-ratio trajectories, plot of the signature (selected taxa and coefficients) and plot of the prediction accuracy of the model. In fact, <italic>coda4microbiome</italic> is not just an R package but a broader initiative that aims to bridge the gap between compositional data analysis and microbiome research. To this end, we are conducting training activities and developing materials that are available at the website of the project: <ext-link ext-link-type="uri" xlink:href="https://malucalle.github.io/coda4microbiome/">https://malucalle.github.io/coda4microbiome/</ext-link></p>
    <p id="Par11">The methodology for cross-sectional data is described in “<xref rid="Sec3" ref-type="sec">Microbioal signature based on log-ratio analysis: cross-sectional studies</xref>” Section and illustrated with data from a pediatric Crohn's disease study (“<xref rid="Sec10" ref-type="sec">Cross-sectional data: Crohn’s disease (CD) study</xref>” Section). The methodology for longitudinal data is described in “<xref rid="Sec6" ref-type="sec">Microbial signature based on log-ratio analysis: longitudinal studies</xref>” Section and illustrated in “<xref rid="Sec11" ref-type="sec">Longitudinal data: early childhood and the microbiome study</xref>” Section with data from the “Early childhood and the microbiome (ECAM) study” [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>]. We performed a simulation study for benchmarking of several microbiome analysis algorithms (“<xref rid="Sec8" ref-type="sec">Simulation study</xref>” and “<xref rid="Sec12" ref-type="sec">Simulation study results</xref>” Section) and applied <italic>coda4microbiome</italic> in several real datasets (“<xref rid="Sec13" ref-type="sec">Real datasets analysis</xref>” Section).</p>
  </sec>
  <sec id="Sec2">
    <title>Materials and methods</title>
    <sec id="Sec3">
      <title>Microbioal signature based on log-ratio analysis: cross-sectional studies</title>
      <p id="Par12">Assume we have <italic>n</italic> subjects with phenotype <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y = \left( {Y_{1} , \ldots ,{ }Y_{n} } \right)$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mrow/><mml:msub><mml:mi>Y</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq1.gif"/></alternatives></inline-formula> and denote by <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X_{i} = \left( {X_{i1} ,{ }X_{i2} , \ldots ,X_{iK} } \right)$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mrow/><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">iK</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq2.gif"/></alternatives></inline-formula> the microbiome composition of subject <italic>i</italic> for <italic>K</italic> taxa. <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X$$\end{document}</tex-math><mml:math id="M6"><mml:mi>X</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq3.gif"/></alternatives></inline-formula> can represent either relative abundances (proportions) or raw read counts. We approach the identification of those taxa that are associated to the outcome through penalized regression on the “all-pairs log-ratio model”, a generalized linear model containing all possible pairwise log-ratios [<xref ref-type="bibr" rid="CR6">6</xref>]:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g\left( {E\left( Y \right)} \right) = \beta_{0} + \mathop \sum \limits_{1 \le j &lt; k \le K} \beta_{jk} \cdot{\text{log}}\left( {X_{j} /X_{k} } \right)$$\end{document}</tex-math><mml:math id="M8" display="block"><mml:mrow><mml:mi>g</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>E</mml:mi><mml:mfenced close=")" open="("><mml:mi>Y</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi mathvariant="italic">jk</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:mtext>log</mml:mtext><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2023_5205_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par13">The regression coefficients in Eq. (<xref rid="Equ1" ref-type="disp-formula">1</xref>) are estimated to minimize a loss function <inline-formula id="IEq4"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L\left( \beta \right)$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi>L</mml:mi><mml:mfenced close=")" open="("><mml:mi>β</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq4.gif"/></alternatives></inline-formula> subject to an elastic-net penalization term on the regression coefficients<inline-formula id="IEq5"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$:$$\end{document}</tex-math><mml:math id="M12"><mml:mo>:</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq5.gif"/></alternatives></inline-formula><disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{\beta } = \mathop {{\text{argmin}}}\limits_{\beta } \left\{ {L\left( \beta \right) + \lambda_{1} ||\beta||_{2}^{2} + \lambda_{2} ||\beta||_{1} } \right\}$$\end{document}</tex-math><mml:math id="M14" display="block"><mml:mrow><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:munder><mml:mtext>argmin</mml:mtext><mml:mi>β</mml:mi></mml:munder><mml:mfenced close="}" open="{"><mml:mrow><mml:mi>L</mml:mi><mml:mfenced close=")" open="("><mml:mi>β</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2023_5205_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par14">A common reparameterization of the penalization parameters is <inline-formula id="IEq6"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda_{1} = \lambda \left( {1 - \alpha } \right)/2$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>λ</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:mfenced><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq6.gif"/></alternatives></inline-formula> and <inline-formula id="IEq7"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda_{2} = \lambda \alpha$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>λ</mml:mi><mml:mi>α</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq7.gif"/></alternatives></inline-formula> where <inline-formula id="IEq8"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M20"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq8.gif"/></alternatives></inline-formula> controls the amount of penalization and <inline-formula id="IEq9"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M22"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq9.gif"/></alternatives></inline-formula> the mixing between the two norms.</p>
      <p id="Par15">For the linear regression model the loss function is given by the residual sum of squares<disp-formula id="Equa"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{\beta } = \mathop {{\text{argmin}}}\limits_{\beta } \left\{ {Y - M\beta_{2}^{2} + \lambda_{1} ||\beta||_{2}^{2} + \lambda_{2} ||\beta||_{1} } \right\},$$\end{document}</tex-math><mml:math id="M24" display="block"><mml:mrow><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:munder><mml:mtext>argmin</mml:mtext><mml:mi>β</mml:mi></mml:munder><mml:mfenced close="}" open="{"><mml:mrow><mml:mi>Y</mml:mi><mml:mo>-</mml:mo><mml:mi>M</mml:mi><mml:msubsup><mml:mi>β</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2023_5205_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq10"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M$$\end{document}</tex-math><mml:math id="M26"><mml:mi>M</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq10.gif"/></alternatives></inline-formula> is the matrix of all pairwise log-ratios and has dimension <inline-formula id="IEq11"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M28"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq11.gif"/></alternatives></inline-formula> by <inline-formula id="IEq12"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K\left( {K - 1} \right)/2$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:mi>K</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>K</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq12.gif"/></alternatives></inline-formula>. The expression of the optimization problem (<xref rid="Equ2" ref-type="disp-formula">2</xref>) for other models, like the logistic regression, can be found in Friedman et al. [<xref ref-type="bibr" rid="CR14">14</xref>]. We use the function cv.glmnet() from the R package <italic>glmnet</italic> [<xref ref-type="bibr" rid="CR14">14</xref>] to solve (<xref rid="Equ2" ref-type="disp-formula">2</xref>) within a cross-validation process that provides the optimal value of <inline-formula id="IEq13"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M32"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq13.gif"/></alternatives></inline-formula> with a default value for <inline-formula id="IEq14"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M34"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq14.gif"/></alternatives></inline-formula> equal to 0.9. Non-compositional covariates are previously modeled with <italic>Y</italic> and the fitted values are considered as “offset” in the penalized regression.</p>
      <p id="Par16">The result of the penalized optimization provides a set of selected pairs of taxa, those with a non-null estimated coefficient. The linear predictor of the generalized linear model (<xref rid="Equ2" ref-type="disp-formula">2</xref>) provides a microbial signature score for each individual, <inline-formula id="IEq15"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i \in \left\{ {1, \ldots , n} \right\}$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq15.gif"/></alternatives></inline-formula>, <inline-formula id="IEq16"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_{i} = \mathop \sum \limits_{1 \le j &lt; k \le K } \hat{\beta }_{jk} \cdot{\text{log}}\left( {X_{ij} /X_{ik} } \right)$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">jk</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:mtext>log</mml:mtext><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq16.gif"/></alternatives></inline-formula>, which is associated with the phenotype <inline-formula id="IEq17"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_{i}$$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq17.gif"/></alternatives></inline-formula>. Because of the linearity of the logarithm, the microbial signature <italic>M</italic> can be rewritten in terms of the selected single taxa which is more interpretable than in terms of pairs of taxa:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M = \mathop \sum \limits_{1 \le j &lt; k \le K } \hat{\beta }_{jk} \cdot {\text{log}}\left( {X_{j} /X_{k} } \right) = \mathop \sum \limits_{j = 1}^{K} \hat{\theta }_{j} \cdot {\text{log}}\left( {X_{j} } \right)$$\end{document}</tex-math><mml:math id="M42" display="block"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">jk</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:mtext>log</mml:mtext><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:mtext>log</mml:mtext><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2023_5205_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq18"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{\theta }_{j} = \mathop \sum \limits_{k = j + 1}^{K} \hat{\beta }_{jk} - \mathop \sum \limits_{k = 1}^{j - 1} \hat{\beta }_{kj}$$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">jk</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">kj</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq18.gif"/></alternatives></inline-formula>, that is, the sum of the coefficients <inline-formula id="IEq19"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{\beta }$$\end{document}</tex-math><mml:math id="M46"><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq19.gif"/></alternatives></inline-formula> that correspond to a log-ratio that involves component <italic>j</italic> [<xref ref-type="bibr" rid="CR6">6</xref>].</p>
      <p id="Par17">It can be proved that <inline-formula id="IEq20"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathop \sum \limits_{j = 1}^{K} \hat{\theta }_{j} = 0$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq20.gif"/></alternatives></inline-formula> and thus, the microbial signature <italic>M</italic> is a log-contrast function involving the selected taxa (those with <inline-formula id="IEq21"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{\theta }_{j} \ne 0)$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>≠</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq21.gif"/></alternatives></inline-formula>. This ensures the invariance principle required for proper compositional data analysis and it facilitates the interpretation of the microbial signature. Indeed, expression <inline-formula id="IEq22"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathop \sum \limits_{j = 1}^{K} \hat{\theta }_{j} \cdot{\text{log}}\left( {X_{j} } \right)$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:mtext>log</mml:mtext><mml:mfenced close=")" open="("><mml:msub><mml:mi>X</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq22.gif"/></alternatives></inline-formula> in (<xref rid="Equ3" ref-type="disp-formula">3</xref>) can be interpreted as a weighted balance between two groups of taxa, <inline-formula id="IEq23"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_{1}$$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq23.gif"/></alternatives></inline-formula> and <inline-formula id="IEq24"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_{2}$$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq24.gif"/></alternatives></inline-formula>, the taxa with a positive coefficient vs those with a negative coefficient [<xref ref-type="bibr" rid="CR36">36</xref>].</p>
    </sec>
    <sec id="Sec4">
      <title>Microbial signature based on log-ratio analysis: longitudinal studies</title>
      <sec id="Sec5">
        <title>Summary of log-ratio trajectories</title>
        <p id="Par18">Assume <italic>n</italic> subjects with fixed phenotype <inline-formula id="IEq25"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y = \left( {Y_{1} ,{ } \ldots ,{ }Y_{n} } \right)$$\end{document}</tex-math><mml:math id="M58"><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mrow/><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mrow/><mml:msub><mml:mi>Y</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq25.gif"/></alternatives></inline-formula>. Subject <italic>i</italic> has been observed in <inline-formula id="IEq26"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_{i} { }$$\end{document}</tex-math><mml:math id="M60"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow/></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq26.gif"/></alternatives></inline-formula> time points, <inline-formula id="IEq27"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left( {t_{i1} ,{ }t_{i2} ,{ } \ldots ,{ }t_{{iL_{i} }} } \right)$$\end{document}</tex-math><mml:math id="M62"><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mrow/><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mrow/><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mrow/><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq27.gif"/></alternatives></inline-formula>. We denote by <inline-formula id="IEq28"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X_{i} \left( {t_{ij} } \right) = \left( {X_{i1} \left( {t_{ij} } \right),{ }X_{i2} \left( {t_{ij} } \right),{ } \ldots ,X_{iK} \left( {t_{ij} } \right)} \right)$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>,</mml:mo><mml:mrow/><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>,</mml:mo><mml:mrow/><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">iK</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq28.gif"/></alternatives></inline-formula> the microbiome composition of subject <italic>i</italic> at time <inline-formula id="IEq29"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_{ij}$$\end{document}</tex-math><mml:math id="M66"><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq29.gif"/></alternatives></inline-formula>, where <italic>K</italic> is the number of taxa which is assumed to be the same for all the individuals and all the time points. <inline-formula id="IEq30"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X_{i} \left( {t_{ij} } \right)$$\end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq30.gif"/></alternatives></inline-formula> can represent either relative abundances (proportions) or raw counts. We denote by <inline-formula id="IEq31"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$logX_{i} \left( {t_{ij} } \right)$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq31.gif"/></alternatives></inline-formula> the logarithm transformation of microbiome abundances after zero imputation [<xref ref-type="bibr" rid="CR27">27</xref>]. The log-abundance trajectory of component A for individual <italic>i</italic> is denoted by <inline-formula id="IEq32"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$logX_{iA} = \left( {logX_{iA} \left( {t_{i1} } \right), logX_{i2A} \left( {t_{i2} } \right), \ldots ,logX_{iA} \left( {t_{{iL_{i} }} } \right)} \right)$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">iA</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">iA</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mfenced><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mfenced><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">iA</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq32.gif"/></alternatives></inline-formula> and the log-ratio trajectory between components A and B for individual <italic>i</italic> is given by:<disp-formula id="Equb"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$logX_{iA} - logX_{iB} = \left( {logX_{iA} \left( {t_{i1} } \right) - logX_{iB} \left( {t_{i1} } \right), logX_{iA} \left( {t_{i2} } \right) - logX_{iB} \left( {t_{i2} } \right), \ldots ,logX_{iA} \left( {t_{{iL_{i} }} } \right) - logX_{iB} \left( {t_{{iL_{i} }} } \right)} \right)$$\end{document}</tex-math><mml:math id="M74" display="block"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">iA</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">iB</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">iA</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mfenced><mml:mo>-</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">iB</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mfenced><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">iA</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mfenced><mml:mo>-</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">iB</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mfenced><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">iA</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mfenced><mml:mo>-</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">iB</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2023_5205_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par19">We summarize the log-ratio trajectory between components A and B for individual <italic>i</italic> within two time points <inline-formula id="IEq33"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l_{1}$$\end{document}</tex-math><mml:math id="M76"><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq33.gif"/></alternatives></inline-formula> and <inline-formula id="IEq34"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l_{2}$$\end{document}</tex-math><mml:math id="M78"><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq34.gif"/></alternatives></inline-formula> as the integral of the log-ratio trajectory:<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_{i} \left( {A,B} \right) = \mathop \smallint \limits_{{l_{1} }}^{{l_{2} }} \left( {logX_{iA} \left( t \right) - logX_{iB} \left( t \right)} \right) dt,$$\end{document}</tex-math><mml:math id="M80" display="block"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:munderover><mml:mo largeop="false">∫</mml:mo><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:munderover><mml:mfenced close=")" open="("><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">iA</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mo>-</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">iB</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2023_5205_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>where the values of the log-ratio for <inline-formula id="IEq35"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t \notin \left( {t_{i1} , t_{i2} , \ldots , t_{{iL_{i} }} } \right)$$\end{document}</tex-math><mml:math id="M82"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∉</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq35.gif"/></alternatives></inline-formula> are linearly interpolated.</p>
        <p id="Par20">We do not take the absolute value in Eq. (<xref rid="Equ4" ref-type="disp-formula">4</xref>) because the sign of the integral is informative: Positive values of <inline-formula id="IEq36"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_{i} \left( {A,B} \right)$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq36.gif"/></alternatives></inline-formula> correspond to trajectories of component A above trajectories of component B, that is, larger relative abundances of A with respect to B, while negative values represent the opposite. Values of <inline-formula id="IEq37"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_{i} \left( {A,B} \right)$$\end{document}</tex-math><mml:math id="M86"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq37.gif"/></alternatives></inline-formula> around zero can represent similar abundances between A and B over time or a non-homogeneous trend between A and B within the observed region.</p>
        <p id="Par21">Another advantage of the summary <inline-formula id="IEq38"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_{i} \left( {A,B} \right)$$\end{document}</tex-math><mml:math id="M88"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq38.gif"/></alternatives></inline-formula> is computational. Since the integral is linear, <inline-formula id="IEq39"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_{i} \left( {A,B} \right)$$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq39.gif"/></alternatives></inline-formula> is equal to the difference between the integrals of log-transformed microbiome abundances of taxa A and taxa B:<disp-formula id="Equc"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_{i} \left( {A,B} \right) = \mathop \smallint \limits_{{l_{1} }}^{{l_{2} }} logX_{iA} \left( t \right)dt - \mathop \smallint \limits_{{l_{1} }}^{{l_{2} }} logX_{iB} \left( t \right) dt$$\end{document}</tex-math><mml:math id="M92" display="block"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:munderover><mml:mo largeop="false">∫</mml:mo><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:munderover><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">iA</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:munderover><mml:mo largeop="false">∫</mml:mo><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:munderover><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">iB</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2023_5205_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par22">Thus, the number of integrals to be calculated is of the order of <italic>K</italic>, the number of taxa, instead of <inline-formula id="IEq40"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K\left( {K - 1} \right)/2$$\end{document}</tex-math><mml:math id="M94"><mml:mrow><mml:mi>K</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>K</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq40.gif"/></alternatives></inline-formula>, the number of pairwise log-ratios.</p>
      </sec>
      <sec id="Sec6">
        <title>Microbial signature based on log-ratio analysis</title>
        <p id="Par23">To identify those log-ratios that are most associated with the outcome <italic>Y</italic>, we implement glm penalized regression on the log-ratio summaries of all pairs of taxa:<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g\left( {E\left( Y \right)} \right) = \beta_{0} + \mathop \sum \limits_{1 \le j &lt; k \le K} \beta_{jk} \cdot s\left( {j, k} \right)$$\end{document}</tex-math><mml:math id="M96" display="block"><mml:mrow><mml:mi>g</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>E</mml:mi><mml:mfenced close=")" open="("><mml:mi>Y</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi mathvariant="italic">jk</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:mi>s</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2023_5205_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq41"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s\left( {j,k} \right)$$\end{document}</tex-math><mml:math id="M98"><mml:mrow><mml:mi>s</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq41.gif"/></alternatives></inline-formula> is the summary of the log-ratio trajectory corresponding to components <inline-formula id="IEq42"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X_{j}$$\end{document}</tex-math><mml:math id="M100"><mml:msub><mml:mi>X</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq42.gif"/></alternatives></inline-formula> and <inline-formula id="IEq43"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X_{k}$$\end{document}</tex-math><mml:math id="M102"><mml:msub><mml:mi>X</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq43.gif"/></alternatives></inline-formula>.</p>
        <p id="Par24">Equation (<xref rid="Equ5" ref-type="disp-formula">5</xref>) is identical to Eq. (<xref rid="Equ1" ref-type="disp-formula">1</xref>) for cross-sectional studies except for the change of the pairwise log-ratios by the summary of the log-ratios trajectories. Thus, the inference and variable selection process is performed similarly with elastic-net penalized regression within a cross-validation process using cv.glmnet() from the R package <italic>glmnet</italic> [<xref ref-type="bibr" rid="CR14">14</xref>].</p>
        <p id="Par25">For each individual, <inline-formula id="IEq44"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i \in \left\{ {1, \ldots , n} \right\}$$\end{document}</tex-math><mml:math id="M104"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq44.gif"/></alternatives></inline-formula>, the microbial signature score is given by <inline-formula id="IEq45"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_{i} = \mathop \sum \limits_{1 \le j &lt; k \le K } \hat{\beta }_{jk} \cdot s_{i} \left( {j,k} \right)$$\end{document}</tex-math><mml:math id="M106"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">jk</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq45.gif"/></alternatives></inline-formula>. Because of the linearity of the integrals used as summaries of the log-ratio trajectories and following the same reparameterization than in Eq. (<xref rid="Equ3" ref-type="disp-formula">3</xref>), <italic>M</italic> can be rewritten in terms of the selected single taxa which is more interpretable than the selected pairs of components:<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} M &amp; = \mathop \sum \limits_{1 \le j &lt; k \le K } \hat{\beta }_{jk} \cdot s\left( {j_{1} ,j_{2} } \right) \\ &amp; = \mathop \sum \limits_{1 \le j &lt; k \le K } \hat{\beta }_{jk} \cdot \mathop \smallint \limits_{{l_{1} }}^{{l_{2} }} logX_{j} \left( t \right)dt - \mathop \sum \limits_{1 \le j &lt; k \le K } \hat{\beta }_{jk} \cdot \mathop \smallint \limits_{{l_{1} }}^{{l_{2} }} logX_{k} \left( t \right)dt \\ &amp; = \mathop \sum \limits_{k = 1}^{K} \hat{\theta }_{j} \cdot \mathop \smallint \limits_{{l_{1} }}^{{l_{2} }} logX_{j} \left( t \right)dt \\ &amp; = \mathop \smallint \limits_{{l_{1} }}^{{l_{2} }} \left( {\mathop \sum \limits_{k = 1}^{K} \hat{\theta }_{j} \cdot logX_{j} \left( t \right)} \right)dt \\ \end{aligned}$$\end{document}</tex-math><mml:math id="M108" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mi>M</mml:mi></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">jk</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:mi>s</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">jk</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:munderover><mml:mo largeop="false">∫</mml:mo><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:munderover><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">jk</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:munderover><mml:mo largeop="false">∫</mml:mo><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:munderover><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:munderover><mml:mo largeop="false">∫</mml:mo><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:munderover><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo largeop="false">∫</mml:mo><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:munderover><mml:mfenced close=")" open="("><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2023_5205_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq46"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{\theta }_{j} = \mathop \sum \limits_{k = j + 1}^{K} \hat{\beta }_{jk} - \mathop \sum \limits_{k = 1}^{j - 1} \hat{\beta }_{kj}$$\end{document}</tex-math><mml:math id="M110"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">jk</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">kj</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq46.gif"/></alternatives></inline-formula>.</p>
        <p id="Par26">Since <inline-formula id="IEq47"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathop \sum \limits_{k = 1}^{K} \hat{\theta }_{k} = 0$$\end{document}</tex-math><mml:math id="M112"><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq47.gif"/></alternatives></inline-formula>, the microbial signature <italic>M</italic> is the integral of the trajectory of a log-contrast function involving the selected taxa (those with <inline-formula id="IEq48"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{\theta }_{k} \ne 0)$$\end{document}</tex-math><mml:math id="M114"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo>≠</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq48.gif"/></alternatives></inline-formula> and, similarly to the signatures for cross-sectional data, it can be interpreted as a weighted balance between two groups of taxa, <inline-formula id="IEq49"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_{1}$$\end{document}</tex-math><mml:math id="M116"><mml:msub><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq49.gif"/></alternatives></inline-formula> and <inline-formula id="IEq50"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_{2}$$\end{document}</tex-math><mml:math id="M118"><mml:msub><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq50.gif"/></alternatives></inline-formula>, the taxa with a positive coefficient vs those with a negative coefficient.</p>
      </sec>
    </sec>
    <sec id="Sec7">
      <title>coda4microbiome main functions</title>
      <p id="Par27">The package <italic>coda4microbiome</italic> [<xref ref-type="bibr" rid="CR10">10</xref>] contains several functions that implement the proposed algorithms. The method for the identification of microbial signatures in cross-sectional studies (“<xref rid="Sec4" ref-type="sec">Microbioal signature based on log-ratio analysis: cross-sectional studies</xref>” Section) is implemented in function coda_glmnet() and the method for longitudinal data (“<xref rid="Sec6" ref-type="sec">Microbial signature based on log-ratio analysis: longitudinal studies</xref>” Section) is implemented in function coda_glmnet_longitudinal().</p>
      <p id="Par28">The library also contains additional functions like plot_signature_curves() that provides a plot of the signature trajectories or filter_longitudinal() that filters those individuals and taxa with enough longitudinal information.</p>
      <p id="Par29">The <italic>coda4microbiome</italic> methodology is visually described with a pictogram in the supplementary material (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1).</p>
    </sec>
    <sec id="Sec8">
      <title>Simulation study</title>
      <p id="Par30">We performed a case–control simulation study to evaluate the discrimination (or classification) performance and computational burden of <italic>coda4microbiome</italic> in comparison to other methods used for microbiome analysis: <italic>selbal</italic> [<xref ref-type="bibr" rid="CR33">33</xref>], <italic>ANCOM-BC </italic>[<xref ref-type="bibr" rid="CR23">23</xref>], <italic>ALDEx2</italic> [<xref ref-type="bibr" rid="CR13">13</xref>], <italic>DESeq2</italic> [<xref ref-type="bibr" rid="CR25">25</xref>], <italic>edgeR</italic> [<xref ref-type="bibr" rid="CR32">32</xref>], <italic>metagenomeSeq</italic> [<xref ref-type="bibr" rid="CR30">30</xref>], and <italic>LinDA</italic> [<xref ref-type="bibr" rid="CR40">40</xref>].</p>
      <p id="Par31">Both, <italic>coda4microbiome</italic> and <italic>selbal,</italic> provide a classification model (microbial signature) that defines how the selected taxa are combined. For the other methods that only provide a set of differentially abundant taxa, the classification model was obtained by fitting a logistic regression model containing the DA taxa. Metagenomic simulated data was generated using faecal samples from the “Global Patterns” dataset [<xref ref-type="bibr" rid="CR11">11</xref>] as template, following the data generation model described by Weiss et al. [<xref ref-type="bibr" rid="CR37">37</xref>]. This model generates true positives taxa so that their relative abundances match their real abundance in the environment. As in Weiss et al. [<xref ref-type="bibr" rid="CR37">37</xref>], some of the simulation parameters were fixed for all scenarios: the number of most prevalent taxa to keep in simulation template (2000 taxa), the number of true positive taxa (100 taxa), and the sequencing depth (2000 reads). Both categories had the same number of samples, being 50 or 100 samples in each group. The effect size of the true positive taxa was set to 1.25, 1.5, 2, 5, 10 or 20. This results in a total of 12 simulated scenarios, and we considered 10 replicates for each one. After simulated metagenomic datasets were generated, taxa with less than 5% of prevalence among samples were removed, and 1 count was added to all taxa abundances to overcome problems with log-transformations.</p>
      <p id="Par32">To evaluate the discrimination accuracy of the different methods, a five-fold cross-validation process was applied. Samples in each simulation set were randomly grouped into five different cv-fold groups, ensuring the same number of cases and controls in each one. For every cross-validation fold, the train set includes all cv-fold groups except one, used for testing the model afterwards. The same cv-fold groups assignment in a simulation set were used for testing all the algorithms. For DA methods, a taxa selection step was performed on the train set based on the significance of the Benjamini–Hochberg adjusted p-value [<xref ref-type="bibr" rid="CR4">4</xref>] with a threshold of 0.05. Relative abundances of selected taxa were used to fit a logistic regression model able to classify the two groups. <italic>coda4microbiome</italic> and <italic>selbal</italic> were trained on the train set and the obtained microbial signature was evaluated on the test set. For all methods, the measure of performance was the Area Under the ROC Curve (AUC). We also compared the number of taxa selected by each method and the computational time.</p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Results</title>
    <sec id="Sec10">
      <title>Cross-sectional data: Crohn’s disease (CD) study</title>
      <p id="Par33">We illustrate <italic>coda4microbiome</italic> algorithm for cross-sectional studies with data from a pediatric Crohn’s disease (CD) study [<xref ref-type="bibr" rid="CR16">16</xref>]. The dataset, available at <italic>coda4microbiome</italic> package, includes microbiome compositions of 975 individuals, 662 with CD and 313 without any symptoms. The abundance table agglomerated at the genus level contains 48 genera.</p>
      <p id="Par34">We implemented coda4microbiome::coda_glmnet() function to the Crohn’s dataset. The algorithm identifies that the outcome is binary and implements a penalized logistic regression. The results of the analysis provide a first plot (Fig. <xref rid="Fig1" ref-type="fig">1</xref>) showing the cross-validation accuracy (AUC) curve from cv.glmnet(). For the default lambda (“lambda.1se”), the algorithm selects 27 pairwise log-ratios that, as we will see later, correspond to 24 different taxa.<fig id="Fig1"><label>Fig. 1</label><caption><p>Cross-validation accuracy curve for different degrees of penalization: Log-transformed penalization parameter (x axis), cross-validation AUC (y axis), and, on top of the plot, the number of selected variables for each penalization value. Highlighted with a vertical line the values of "lambda.min" and "lambda.1se" (default penalization value)</p></caption><graphic xlink:href="12859_2023_5205_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par35">The results of coda_glmnet include the number, the name, and the coefficients of the selected taxa. These can be visualized in a bar plot where the selected taxa and the corresponding coefficients are represented (Fig. <xref rid="Fig2" ref-type="fig">2</xref>).<fig id="Fig2"><label>Fig. 2</label><caption><p>Microbial signature for Crohn’s disease: Taxa composing the microbial signature that best discriminates between Crohn's disease patients and controls. The magnitude of the coefficients represents the contribution of each variable to the model. (green: positive coefficient and red: negative coefficient)</p></caption><graphic xlink:href="12859_2023_5205_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par36">A third plot describes the discrimination capacity of the selected microbial signature (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). This is accompanied with three classification accuracy measures: the apparent AUC, <italic>i.e.</italic>, the AUC of the signature applied to the same data that was used to generate the model, and the mean and sd of the cross-validation AUC obtained from the output of cv.glmnet(). For this dataset, the apparent AUC is 0.84 and the mean (sd) cross-validation AUC are 0.82 (0.0081).<fig id="Fig3"><label>Fig. 3</label><caption><p>Box-plot and density plots representing the distribution of predicted values (microbial signature scores) for Crohn’s disease patients (orange) and controls (blue)</p></caption><graphic xlink:href="12859_2023_5205_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par37">When the outcome is a continuous numerical variable, coda_glmnet() function implements penalized linear regression and Fig. <xref rid="Fig3" ref-type="fig">3</xref> is a scatter plot between predictions and the outcome values.</p>
    </sec>
    <sec id="Sec11">
      <title>Longitudinal data: early childhood and the microbiome study</title>
      <p id="Par38">To illustrate <italic>coda4microbiome</italic> for longitudinal studies we use data from the “Early childhood and the microbiome (ECAM) study” that followed a cohort of 43 U.S. infants during the first 2 years of life for the study of their microbial development and its association with early-life antibiotic exposures, cesarean section, and formula feeding [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>].</p>
      <p id="Par39">Metadata and microbiome data were downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/caporaso-lab/longitudinal-notebooks">https://github.com/caporaso-lab/longitudinal-notebooks</ext-link><underline>.</underline> Initially the data contained information on 43 child and 445 taxa at the genus level. We filtered those individuals and taxa with enough information for time-course profiling: we removed individuals with only one time-point observation and those taxa with less than 30 children (70% of individuals) with at least 3 non-zero observations over the follow-up period. After this filtering, the data reduced to 42 children and 37 taxa.</p>
      <p id="Par40">Here we focus on the effects of the diet on the early modulation of the microbiome by comparing microbiome profiles between children with breastmilk diet (bd) vs. formula milk diet (fd) in their first 3 months of life.</p>
      <p id="Par41">Using function coda_glmnet_longitudinal(), we identified a microbial signature with maximum discrimination accuracy between the two diet groups. The signature is defined by the relative abundances of two groups of taxa, <inline-formula id="IEq51"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_{1}$$\end{document}</tex-math><mml:math id="M120"><mml:msub><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq51.gif"/></alternatives></inline-formula> and <inline-formula id="IEq52"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_{2}$$\end{document}</tex-math><mml:math id="M122"><mml:msub><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq52.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq53"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_{1}$$\end{document}</tex-math><mml:math id="M124"><mml:msub><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq53.gif"/></alternatives></inline-formula> is composed of 6 taxa (those with a positive coefficient in the regression model) and <inline-formula id="IEq54"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_{2}$$\end{document}</tex-math><mml:math id="M126"><mml:msub><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq54.gif"/></alternatives></inline-formula> is composed of 2 taxa (those with a negative coefficient) (Table <xref rid="Tab1" ref-type="table">1</xref> and Fig. <xref rid="Fig4" ref-type="fig">4</xref>). Group <inline-formula id="IEq55"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_{1}$$\end{document}</tex-math><mml:math id="M128"><mml:msub><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq55.gif"/></alternatives></inline-formula> is mainly dominated by three taxa within the order <italic>Clostridiales</italic> (family <italic>Ruminococcaceae</italic> (2) and gender <italic>Blautia</italic>) and one taxon within the gender <italic>Actinomyces.</italic> Two taxa (<italic>g_Veillonella</italic> and <italic>f_Lachnospiraceae</italic>) have a coefficient close to zero and will have a very small contribution to the signature. Group <inline-formula id="IEq56"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_{2}$$\end{document}</tex-math><mml:math id="M130"><mml:msub><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq56.gif"/></alternatives></inline-formula> is composed by two taxa within the genders <italic>Haemophilus</italic> and <italic>Staphylococcus.</italic><table-wrap id="Tab1"><label>Table 1</label><caption><p>Taxa included in the microbial signature that best discriminates between the two diet groups</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Balance group</th><th align="left">Coefficient</th><th align="left">Taxanomic assignment</th></tr></thead><tbody><tr><td align="left" rowspan="6"><italic>G</italic><sub>1</sub></td><td char="." align="char">0.3359</td><td align="left"><italic>p_Firmicutes;c_Clostridia;o_Clostridiales;f_Ruminococcaceae;g_1</italic></td></tr><tr><td char="." align="char">0.2730</td><td align="left"><italic>p_Firmicutes;c_Clostridia;o_Clostridiales;f_Lachnospiraceae;g_Blautia</italic></td></tr><tr><td char="." align="char">0.2159</td><td align="left"><italic>p_Actinobacteria;c_Actinobacteria;o_Actinomycetales;f_Actinomycetaceae;g_Actinomyces</italic></td></tr><tr><td char="." align="char">0.1358</td><td align="left"><italic>p_Firmicutes;c_Clostridia;o_Clostridiales;f_Ruminococcaceae;g_2</italic></td></tr><tr><td char="." align="char">0.0337</td><td align="left"><italic>p_Firmicutes;c_Clostridia;o_Clostridiales;f_Veillonellaceae;g_Veillonella</italic></td></tr><tr><td char="." align="char">0.0055</td><td align="left"><italic>p_Firmicutes;c_Clostridia;o_Clostridiales;f_Lachnospiraceae;g_</italic></td></tr><tr><td align="left" rowspan="2"><italic>G</italic><sub>2</sub></td><td char="." align="char"> − 0.4327</td><td align="left"><italic>p_Proteobacteria;c_Gammaproteobacteria;o_Pasteurellales;f_Pasteurellaceae;g_Haemophilus</italic></td></tr><tr><td char="." align="char"> − 0.5672</td><td align="left"><italic>p_Firmicutes;c_Bacilli;o_Bacillales;f_Staphylococcaceae;g_Staphylococcus</italic></td></tr></tbody></table></table-wrap><fig id="Fig4"><label>Fig. 4</label><caption><p>Taxa composing the microbial signature that best discriminates between the two diet groups (green: positive coefficient and red: negative coefficient)</p></caption><graphic xlink:href="12859_2023_5205_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par42">The trajectories of the microbial signature over the observed period are represented in Fig. <xref rid="Fig5" ref-type="fig">5</xref>, where the color of the curves corresponds to the diet group. Each trajectory represents the relative mean abundances between the two taxa groups for each child. We can see that the two groups are clearly separated. Those children under breastmilk diet (in orange) usually have trajectories below zero, which means they have more relative mean abundance of <italic>g_Haemophilus</italic> and <italic>g_Staphylococcus</italic> with respect to the relative abundance of taxa in group <inline-formula id="IEq57"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_{1}$$\end{document}</tex-math><mml:math id="M132"><mml:msub><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq57.gif"/></alternatives></inline-formula>, while children with formula milk diet (in blue) have more relative abundance of taxa in group <inline-formula id="IEq58"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_{1}$$\end{document}</tex-math><mml:math id="M134"><mml:msub><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq58.gif"/></alternatives></inline-formula> relative to <inline-formula id="IEq59"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_{2} .$$\end{document}</tex-math><mml:math id="M136"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq59.gif"/></alternatives></inline-formula><fig id="Fig5"><label>Fig. 5</label><caption><p>Relative abundance between group <inline-formula id="IEq60"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_{1}$$\end{document}</tex-math><mml:math id="M138"><mml:msub><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq60.gif"/></alternatives></inline-formula> and <inline-formula id="IEq61"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_{2}$$\end{document}</tex-math><mml:math id="M140"><mml:msub><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5205_Article_IEq61.gif"/></alternatives></inline-formula> during the first three months of life. Highlighted curves represent the mean value of the signature for each diet group (orange: breast milk diet, blue: formula milk diet)</p></caption><graphic xlink:href="12859_2023_5205_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par43">Figure <xref rid="Fig6" ref-type="fig">6</xref> displays the distribution of the microbial signature scores for the two diet groups and offers a visual assessment of the (apparent) discrimination accuracy of the signature. Quantitatively, the apparent discrimination accuracy of the signature (i. e. the AUC of the signature applied to the same data that was used to generate the model) is 0.96 and the mean cross-validation AUC is 0.74 (sd = 0.10).<fig id="Fig6"><label>Fig. 6</label><caption><p>Box-plot and density plots representing the distribution of predicted values (microbial signature scores) for the two diet groups (orange: breast milk diet, blue: formula milk diet)</p></caption><graphic xlink:href="12859_2023_5205_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par44">The results are consistent with previous studies on the association of the infant gut microbiome composition and breastmilk feeding practices. In Fehr et al. [<xref ref-type="bibr" rid="CR12">12</xref>], <italic>Haemophilus parainfluenzae</italic> and <italic>Staphylococcus</italic> were found to be enriched with exclusive breastmilk feeding together with lower prevalence of <italic>Actinomyces</italic> at 3 months. <italic>Lachnospiraceae</italic> (<italic>Blautia</italic>) was enriched among infants who were no longer fed breastmilk. Similar results are reported in Laursen et al. [<xref ref-type="bibr" rid="CR22">22</xref>] where the duration of exclusive breastfeeding was negatively correlated with genera within <italic>Lachnospiraceae</italic> (<italic>e.g.</italic>, <italic>Blautia</italic>) and genera within <italic>Ruminococcaceae</italic>. Positive correlations with exclusive breastfeeding were observed for <italic>g_Bifidobacterium</italic> and <italic>Pasteurellaceae</italic> (<italic>Haemophilus</italic>).</p>
    </sec>
    <sec id="Sec12">
      <title>Simulation study results</title>
      <p id="Par45">Figure <xref rid="Fig7" ref-type="fig">7</xref> show the number of selected taxa by each method for simulated datasets with different effect sizes (1.25, 1.5, 2, 5, 10 and 20) and 100 samples per group. Similar results are obtained for simulations with 50 samples per group (results not shown). For all methods, except for <italic>coda4microbiome</italic> and <italic>selbal</italic>, the larger the effect size, the more taxa are selected, as it is expected since the power of the DA tests increases with larger effect sizes. The opposite is true for <italic>coda4microbiome</italic> and <italic>selbal</italic>, as the effect size increases, less variables are needed in the model to obtain good classifications. Despite the fold effect and sample size, <italic>coda4microbiome</italic> finds a predictive microbial signature with less features than <italic>selbal</italic>, with similar AUCs.<fig id="Fig7"><label>Fig. 7</label><caption><p>Mean number of selected taxa of the different methods for simulated datasets with different effect sizes (1.25, 1.5, 2, 5, 10 and 20) and 100 samples per group</p></caption><graphic xlink:href="12859_2023_5205_Fig7_HTML" id="MO7"/></fig></p>
      <p id="Par46">Figures <xref rid="Fig8" ref-type="fig">8</xref> provides two different representations of the discrimination accuracy (AUC) of each method: a boxplot distribution and a line plot of the mean cv-AUC for the 10 replicates of each scenario and 50 samples per group. Figure <xref rid="Fig9" ref-type="fig">9</xref> provides the same information for the case of 100 samples per group. The numerical results (mean and sd) are detailed in Table <xref rid="Tab2" ref-type="table">2</xref>. <italic>coda4microbiome</italic> and <italic>selbal</italic> perform similarly in all scenarios. The higher classification accuracy of <italic>coda4microbiome</italic> and <italic>selbal</italic> is especially remarkable in scenarios with low effect size and a small sample size (Fig. <xref rid="Fig8" ref-type="fig">8</xref>). For an effect size equal to 1.25 the mean cv-AUC of these two methods is 0.763 and 0.795, respectively, while all the other methods have mean cv-AUC below 0.6. For an effect size of 1.5, <italic>coda4microbiome</italic> and <italic>selbal</italic> discrimination is 0.943 and 0.912, respectively, and only <italic>DESeq2</italic> and <italic>edgeR</italic> have a good performance, though with lower discrimination values (0.851 and 0.841, respectively). All the other methods methods have mean cv-AUC below 0.6. For larger effect sizes the performance of all the methods if good (discrimination around 1) except for <italic>LinDA</italic> that has a poor performance in all the scenarios. Similar results are obtained for larger sample sizes (Fig. <xref rid="Fig9" ref-type="fig">9</xref>). In this case, <italic>DESeq2</italic> and <italic>edgeR</italic> perform very well, with discrimination accuracy still slightly lower than <italic>coda4microbiome</italic> and <italic>selbal</italic> when the effect size is equal to 1.25 but slightly larger to <italic>coda4microbiome</italic> when the effect size is equal to 1.5. All methods, except <italic>LinDA</italic>, reach AUCs over 0.9 in simulations with a fold effect of 2, 5 or 10. On scenarios with very high fold effect, such as 20, classification performance decreases for most of the methods except for <italic>coda4microbiome</italic>, selbal and <italic>ALDEx2</italic>.<fig id="Fig8"><label>Fig. 8</label><caption><p>Boxplots distribution and line plots of the mean cross-validation AUCs of every methodology for different effect sizes (1.25, 1.5, 2, 5, 10 and 20) and 50 samples per group</p></caption><graphic xlink:href="12859_2023_5205_Fig8_HTML" id="MO8"/></fig><fig id="Fig9"><label>Fig. 9</label><caption><p>Boxplots distribution and line plots of the mean cross-validation AUCs of every methodology for different effect sizes (1.25, 1.5, 2, 5, 10 and 20) and 100 samples per group</p></caption><graphic xlink:href="12859_2023_5205_Fig9_HTML" id="MO9"/></fig><table-wrap id="Tab2"><label>Table 2</label><caption><p>Mean and standard deviation discrimination accuracy (AUC) of the different methods for different effect sizes</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Method</th><th align="left" colspan="6">n1 = n2 = 50</th><th align="left" colspan="6">n1 = n2 = 100</th></tr><tr><th align="left">Effect size</th><th align="left">1.25</th><th align="left">1.5</th><th align="left">2</th><th align="left">5</th><th align="left">10</th><th align="left">20</th><th align="left">1.25</th><th align="left">1.5</th><th align="left">2</th><th align="left">5</th><th align="left">10</th><th align="left">20</th></tr></thead><tbody><tr><td align="left">coda4microbiome</td><td align="left">0.763 (0.12)</td><td align="left">0.943 (0.1)</td><td align="left">0.988 (0.05)</td><td align="left">0.999 (0.01)</td><td align="left">1 (0)</td><td align="left">1 (0)</td><td align="left">0.776 (0.12)</td><td align="left">0.891 (0.08)</td><td align="left">0.987 (0.02)</td><td align="left">1 (0)</td><td align="left">1 (0)</td><td align="left">1 (0.03)</td></tr><tr><td align="left">selbal</td><td align="left">0.795 (0.12)</td><td align="left">0.912 (0.11)</td><td align="left">0.993 (0.07)</td><td align="left">1 (0)</td><td align="left">1 (0)</td><td align="left">1 (0)</td><td align="left">0.761 (0.11)</td><td align="left">0.924 (0.09)</td><td align="left">0.987 (0.01)</td><td align="left">1 (0.01)</td><td align="left">1 (0)</td><td align="left">1 (0)</td></tr><tr><td align="left">aldex2</td><td align="left">0.59 (0.06)</td><td align="left">0.6 (0.16)</td><td align="left">0.946 (0.13)</td><td align="left">1 (0)</td><td align="left">1 (0)</td><td align="left">1 (0)</td><td align="left">0.629 (0.11)</td><td align="left">0.898 (0.16)</td><td align="left">0.982 (0.02)</td><td align="left">1 (0)</td><td align="left">1 (0)</td><td align="left">1 (0)</td></tr><tr><td align="left">ancombc</td><td align="left">0.573 (0.04)</td><td align="left">0.603 (0.06)</td><td align="left">0.963 (0.07)</td><td align="left">1 (0.01)</td><td align="left">1 (0)</td><td align="left">0.954 (0.1)</td><td align="left">0.569 (0.03)</td><td align="left">0.847 (0.13)</td><td align="left">0.971 (0.02)</td><td align="left">1 (0.01)</td><td align="left">1 (0)</td><td align="left">1 (0.01)</td></tr><tr><td align="left">DESeq2</td><td align="left">0.56 (0.12)</td><td align="left">0.851 (0.15)</td><td align="left">0.973 (0.04)</td><td align="left">1 (0)</td><td align="left">1 (0.01)</td><td align="left">0.882 (0.09)</td><td align="left">0.672 (0.11)</td><td align="left">0.92 (0.07)</td><td align="left">0.989 (0.01)</td><td align="left">1 (0.01)</td><td align="left">1 (0)</td><td align="left">1 (0)</td></tr><tr><td align="left">edgeR</td><td align="left">0.581 (0.12)</td><td align="left">0.841 (0.14)</td><td align="left">0.974 (0.03)</td><td align="left">1 (0)</td><td align="left">1 (0.01)</td><td align="left">0.925 (0.11)</td><td align="left">0.692 (0.11)</td><td align="left">0.921 (0.07)</td><td align="left">0.988 (0.01)</td><td align="left">1 (0.01)</td><td align="left">1 (0)</td><td align="left">1 (0)</td></tr><tr><td align="left">metagenomeSeq</td><td align="left">0.573 (0.04)</td><td align="left">0.593 (0.14)</td><td align="left">0.962 (0.06)</td><td align="left">1 (0.01)</td><td align="left">0.997 (0.04)</td><td align="left">0.929 (0.07)</td><td align="left">0.591 (0.03)</td><td align="left">0.829 (0.12)</td><td align="left">0.982 (0.02)</td><td align="left">1 (0.01)</td><td align="left">1 (0.12)</td><td align="left">0.972 (0.13)</td></tr><tr><td align="left">LinDA</td><td align="left">0.583 (0.04)</td><td align="left">0.604 (0.08)</td><td align="left">0.7 (0.09)</td><td align="left">0.859 (0.06)</td><td align="left">0.907 (0.05)</td><td align="left">0.883 (0.1)</td><td align="left">0.575 (0.03)</td><td align="left">0.662 (0.07)</td><td align="left">0.729 (0.1)</td><td align="left">0.936 (0.07)</td><td align="left">0.976 (0.02)</td><td align="left">1 (0.01)</td></tr></tbody></table></table-wrap></p>
      <p id="Par47">Figure <xref rid="Fig10" ref-type="fig">10</xref> show the computational times for each method for different effect sizes (1.25, 1.5, 2, 5, 10 and 20) and 100 samples per group. Similar results are obtained for simulations with 50 samples per group (results not shown). <italic>ANCOM-BC</italic> and <italic>selbal</italic> are the two methods that spent more time in the analysis. <italic>coda4microbiome</italic> is clearly more computationally efficient than <italic>selbal</italic>.<fig id="Fig10"><label>Fig. 10</label><caption><p>Median computational times for each methodology in simulation datasets with 100 samples per group</p></caption><graphic xlink:href="12859_2023_5205_Fig10_HTML" id="MO10"/></fig></p>
    </sec>
    <sec id="Sec13">
      <title>Real datasets analysis</title>
      <p id="Par48">In order to better compare the computational times of <italic>coda4microbiome</italic> over <italic>selbal</italic>, we applied both methods to 8 real datasets available at [<xref ref-type="bibr" rid="CR28">28</xref>]. Table <xref rid="Tab3" ref-type="table">3</xref> shows the great improvement of <italic>coda4microbiome</italic> in comparison with <italic>selbal</italic>, especially when using the recommended function selbal.cv() that, as <italic>coda4microbiome</italic>, implements cross-validation in the analysis and thus, provides more robust results. In fact, because of the computational burden of selbal.cv(), we only could use selbal() function in the simulations. Table <xref rid="Tab3" ref-type="table">3</xref> is ordered according to the number of taxa in each dataset and this allows to easily see the high correlation between computational time and the number of features.<table-wrap id="Tab3"><label>Table 3</label><caption><p>Computational times for coda_glmnet() function from R package <italic>coda4microbiome</italic> and functions selbal() and selbal.cv() from R package <italic>selbal</italic></p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Dataset</th><th align="left">Number of taxa</th><th align="left">Total sample size (N1; N2)</th><th align="left">coda4microbime coda_glmnet()</th><th align="left">selbal()</th><th align="left">selbal.cv()</th></tr></thead><tbody><tr><td align="left">cdi_schubert</td><td char="." align="char">75</td><td align="left">237 [84;153]</td><td char="." align="char">0.057</td><td char="." align="char">0.291</td><td char="." align="char">7.591</td></tr><tr><td align="left">ob_goodrich</td><td char="." align="char">117</td><td align="left">613 [428;185]</td><td char="." align="char">0.112</td><td char="." align="char">0.752</td><td char="." align="char">18.841</td></tr><tr><td align="left">hiv_noguerajulian</td><td char="." align="char">140</td><td align="left">170 [28;142]</td><td char="." align="char">0.071</td><td char="." align="char">0.543</td><td char="." align="char">14.962</td></tr><tr><td align="left">Ji_WTP_DS</td><td char="." align="char">155</td><td align="left">59 [30;29]</td><td char="." align="char">0.088</td><td char="." align="char">0.334</td><td char="." align="char">9.427</td></tr><tr><td align="left">Office</td><td char="." align="char">242</td><td align="left">625 [341;284]</td><td char="." align="char">0.569</td><td char="." align="char">2.742</td><td char="." align="char">119.696</td></tr><tr><td align="left">ArcticFreshwaters</td><td char="." align="char">274</td><td align="left">1023 [540;483]</td><td char="." align="char">0.781</td><td char="." align="char">8.156</td><td char="." align="char">145.931</td></tr><tr><td align="left">Blueberry</td><td char="." align="char">418</td><td align="left">63 [24;39]</td><td char="." align="char">0.942</td><td char="." align="char">2.155</td><td char="." align="char">68.607</td></tr><tr><td align="left">sw_sed_detender</td><td char="." align="char">1025</td><td align="left">78 [60;18]</td><td char="." align="char">27.841</td><td char="." align="char">13.76</td><td char="." align="char">463.544</td></tr></tbody></table></table-wrap></p>
    </sec>
  </sec>
  <sec id="Sec14">
    <title>Discussion</title>
    <p id="Par49"><italic>coda4microbiome</italic> algorithm represents an improvement of our previous algorithm <italic>selbal</italic> [<xref ref-type="bibr" rid="CR33">33</xref>]. Both, <italic>coda4microbiome</italic> and <italic>selbal</italic> search for two groups of taxa, A and B, that are jointly associated with the outcome of interest Y. The main differences between both algorithms are (1) the model for combining the relative abundances of taxa in group A and B, (2) the process for selecting the taxa that will constitute the microbial signature and (3) the type of study that can be approached with each method:<list list-type="order"><list-item><p id="Par50"><italic>selbal</italic> expresses the microbial signature as an ilr balance between A and B [<xref ref-type="bibr" rid="CR31">31</xref>], <italic>i.e.</italic>, as the log-ratio of the geometric mean abundances of taxa in group A vs taxa in group B. Instead, <italic>coda4microbiome</italic> microbial signature is expressed as a log-contrast model where those taxa with a positive coefficient define group A, those with a negative coefficient define group B and those with a zero coefficient are not part of the microbial signature.</p></list-item><list-item><p id="Par51"><italic>selbal</italic> performs forward selection and <italic>coda4microbime</italic> implements elastic-net penalized regression variable selection.</p></list-item><list-item><p id="Par52"><italic>selbal</italic> is only available for cross-sectional studies while <italic>coda4microbime</italic> is implemented for both cross-sectional and longitudinal studies.</p></list-item></list></p>
    <p id="Par53">In summary, <italic>coda4microbiome</italic> improves <italic>selbal</italic> by considering a more general model (an ilr balance is a special log-contrast), a more powerful variable selection process (forward selection does not ensure a global optimum) and can be used in both, cross-sectional and longitudinal studies.</p>
    <p id="Par54">The results of our simulations indicate that when the aim is classification, DA tests followed by fitting a regression model with the selected significant taxa perform worse than <italic>coda4microbiome</italic> or <italic>selbal</italic>, which are methods specifically developed for model prediction. <italic>coda4microbiome</italic> performs very well even in situations where the fold change of the associated taxa is quite low (e.g. 1.25), which is probably the case for most of real microbiome associations. Under such small fold effects, other methods such as <italic>edgeR</italic>, <italic>DESeq2</italic>, <italic>ALEDx2</italic>, <italic>ANCOM-BC</italic>, <italic>MetagenomeSeq</italic> and <italic>LinDA</italic> perform poorly. <italic>Selbal</italic> instead, performs similarly to <italic>coda4microbiome</italic> with good discrimination accuracy for the same simulation scenarios. Though selbal and <italic>coda4microbiome</italic> have similar classification power, the latest requires less computational time which is an important advantage especially for datasets with a large number of features.</p>
  </sec>
  <sec id="Sec15">
    <title>Conclusions</title>
    <p id="Par55">We developed an R package for microbiome analysis that deals with the compositional nature of microbiome data in both, cross-sectional and longitudinal studies. <italic>coda4microbiome</italic> provides a set of functions to explore and study microbiome data within the CoDA framework, with a special focus on identification of microbial signatures that can serve as biomarkers of disease risk and prognostic. The results are expressed as the (weighted) balance between two groups of taxa, those that contribute positively to the microbial signature and those that contribute negatively. The interpretability of results is of major importance in this context. The package provides several graphical representations that facilitate the interpretation of the analysis and the identified microbial signatures.</p>
    <p id="Par56">The main difference between <italic>coda4microbiome</italic> and other CoDA methods that also employ the log-ratio approach, such as <italic>ALDEx2</italic> [<xref ref-type="bibr" rid="CR13">13</xref>], <italic>ANCOM-BC</italic> [<xref ref-type="bibr" rid="CR23">23</xref>] or <italic>fastANCOM</italic> [<xref ref-type="bibr" rid="CR39">39</xref>], is that they perform differential abundance testing while <italic>coda4microbiome</italic> is focused on prediction. <italic>coda4microbiome</italic> improves our previous algorithm, <italic>selbal</italic> [<xref ref-type="bibr" rid="CR33">33</xref>]. Both have similar performance but coda4microbiome is more computationally efficient.</p>
    <p id="Par57">Longitudinal microbiome studies, especially those focused on the human microbiome, have usually low resolution: the number of individuals is small, each individual has few observation times, the observations of the different individuals are not made at exactly the same time, the data are very variable, the expected behavior of the abundance trajectories is not linear or quadratic, etc. This makes it difficult to justify and implement a parametric modeling of trajectories and limits the use of models for longitudinal data (time series, mixed models). In this context, a description of the trajectories such as the one we propose, although less precise, allows to extract valuable information from the data as we have shown in the example. Other longitudinal data modeling strategies [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR29">29</xref>, <xref ref-type="bibr" rid="CR35">35</xref>] could be used in longitudinal microbiome studies with higher resolution such as laboratory or animal experimental studies. Simulation studies should be performed to assess the performance of <italic>coda4microbiome</italic> for longitudinal microbiome data against other existing methods.</p>
    <p id="Par58">With this new R package, we aim to enhance microbiome analysis by taking into consideration the compositional nature of microbiome data through the use of compositional data analysis methods.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec16">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2023_5205_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1.</bold> Pictogram of<italic> coda4microbiome</italic> algorithm.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>MC and AS participated in all the stages of the project: implementation of the application, writing the documentation and preparing the manuscript, analysis and interpretation of results. MP implemented the simulation analysis. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was partially supported by the Spanish Ministry of Economy, Industry and Competitiveness, references PID2019-104830RB-I00 (M.L.C), PID2021-123657OB-C33 (A.S) and PID2021-122136OB-C21 (A.S.).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The algorithm is implemented as an R package <italic>code4microbiome</italic> available at CRAN (<ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/coda4microbiome/">https://cran.r-project.org/web/packages/coda4microbiome/</ext-link>) Project name: coda4microbiome. Project home page: <ext-link ext-link-type="uri" xlink:href="https://malucalle.github.io/coda4microbiome/">https://malucalle.github.io/coda4microbiome/</ext-link><underline>.</underline> Operating system(s): Platform independent. Programming language: R. Other requirements: R (≥ 3.5.0). License: MIT + file LICENSE. Any restrictions to use by non-academics: none. The datasets used to illustrate the algorithm is available as a data object in the “coda4microbiome” package.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par59">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par60">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par61">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Äijö</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Bonneau</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Temporal probabilistic modeling of bacterial compositions derived from 16S rRNA sequencing</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>3</issue>
        <fpage>372</fpage>
        <lpage>380</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx549</pub-id>
        <?supplied-pmid 28968799?>
        <pub-id pub-id-type="pmid">28968799</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aitchison</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>The statistical analysis of compositional data</article-title>
        <source>J R Statist Soc</source>
        <year>1982</year>
        <volume>44</volume>
        <fpage>139</fpage>
        <lpage>177</lpage>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aitchison</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bacon-Shone</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Log contrast models for experiments with mixtures</article-title>
        <source>Biometrika</source>
        <year>1984</year>
        <volume>71</volume>
        <fpage>323</fpage>
        <lpage>330</lpage>
        <pub-id pub-id-type="doi">10.1093/biomet/71.2.323</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hochberg</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>
        <source>J R Stat Soc Ser B</source>
        <year>1995</year>
        <volume>57</volume>
        <issue>1</issue>
        <fpage>289</fpage>
        <lpage>300</lpage>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bharti</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Grimm</surname>
            <given-names>DG</given-names>
          </name>
        </person-group>
        <article-title>Current challenges and best-practice protocols for microbiome analysis</article-title>
        <source>Brief Bioinform</source>
        <year>2021</year>
        <volume>22</volume>
        <issue>1</issue>
        <fpage>178</fpage>
        <lpage>193</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbz155</pub-id>
        <?supplied-pmid 31848574?>
        <pub-id pub-id-type="pmid">31848574</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bates</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Log-ratio lasso: scalable, sparse estimation for log-ratio models</article-title>
        <source>Biometrics</source>
        <year>2019</year>
        <volume>75</volume>
        <fpage>613</fpage>
        <lpage>624</lpage>
        <pub-id pub-id-type="doi">10.1111/biom.12995</pub-id>
        <?supplied-pmid 30387139?>
        <pub-id pub-id-type="pmid">30387139</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bokulich</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Chung</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Battaglia</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Henderson</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Jay</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Lieber</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Perez-Perez</surname>
            <given-names>GI</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Schweizer</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Contreras</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dominguez-Bello</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>Blaser</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Antibiotics, birth mode, and diet shape microbiome maturation during early life</article-title>
        <source>Sci Transl Med.</source>
        <year>2016</year>
        <volume>8</volume>
        <fpage>343ra82</fpage>
        <pub-id pub-id-type="doi">10.1126/scitranslmed.aad7121</pub-id>
        <?supplied-pmid 27306664?>
        <pub-id pub-id-type="pmid">27306664</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bokulich</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Dillon</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Rideout</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Bolyen</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Albert</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Caporaso</surname>
            <given-names>JG</given-names>
          </name>
        </person-group>
        <article-title>q2-longitudinal: longitudinal and paired-sample analyses of microbiome data</article-title>
        <source>mSystems.</source>
        <year>2018</year>
        <volume>3</volume>
        <fpage>e00219</fpage>
        <lpage>e318</lpage>
        <pub-id pub-id-type="doi">10.1128/mSystems.00219-18</pub-id>
        <?supplied-pmid 30505944?>
        <pub-id pub-id-type="pmid">30505944</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Calle</surname>
            <given-names>ML</given-names>
          </name>
        </person-group>
        <article-title>Statistical analysis of metagenomics data</article-title>
        <source>Genomics Inform</source>
        <year>2019</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>e6</fpage>
        <pub-id pub-id-type="doi">10.5808/GI.2019.17.1.e6</pub-id>
        <?supplied-pmid 30929407?>
        <pub-id pub-id-type="pmid">30929407</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">Calle ML, Susin A. coda4microbiome: Compositional Data Analysis for Microbiome Studies <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=coda4microbiome">https://cran.r-project.org/package=coda4microbiome</ext-link>. (2022).</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Caporaso</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Lauber</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Walters</surname>
            <given-names>WA</given-names>
          </name>
          <name>
            <surname>Berg-Lyons</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Lozupone</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Turnbaugh</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Fierer</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Global patterns of 16S rRNA diversity at a depth of millions of sequences per sample</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2011</year>
        <volume>108</volume>
        <issue>SUPPL. 1</issue>
        <fpage>4516</fpage>
        <lpage>4522</lpage>
        <pub-id pub-id-type="doi">10.1073/PNAS.1000080107/SUPPL_FILE/PNAS.201000080SI.PDF</pub-id>
        <?supplied-pmid 20534432?>
        <pub-id pub-id-type="pmid">20534432</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fehr</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Moossavi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sbihi</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Finlay</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Turvey</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Azad</surname>
            <given-names>MB</given-names>
          </name>
        </person-group>
        <article-title>Breastmilk feeding practices are associated with the co-occurrence of bacteria in mothers’ milk and the infant gut: the CHILD Cohort study</article-title>
        <source>Cell Host &amp; Microbiome</source>
        <year>2020</year>
        <volume>28</volume>
        <issue>2</issue>
        <fpage>285</fpage>
        <lpage>297.e4</lpage>
        <pub-id pub-id-type="doi">10.1016/j.chom.2020.06.009</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fernandes</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Reid</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Macklaim</surname>
            <given-names>JM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Unifying the analysis of high-throughput sequencing datasets: characterizing RNA-seq, 16S rRNA gene sequencing and selective growth experiments by compositional data analysis</article-title>
        <source>Microbiome</source>
        <year>2014</year>
        <volume>2</volume>
        <fpage>15</fpage>
        <pub-id pub-id-type="doi">10.1186/2049-2618-2-15</pub-id>
        <?supplied-pmid 24910773?>
        <pub-id pub-id-type="pmid">24910773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Friedman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hastie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Regularization paths for generalized linear models via coordinate descent</article-title>
        <source>J Stat Softw</source>
        <year>2010</year>
        <volume>33</volume>
        <fpage>1</fpage>
        <lpage>22</lpage>
        <pub-id pub-id-type="doi">10.18637/JSS.V033.I01</pub-id>
        <?supplied-pmid 20808728?>
        <pub-id pub-id-type="pmid">20808728</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gerber</surname>
            <given-names>GK</given-names>
          </name>
          <name>
            <surname>Onderdonk</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Bry</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Inferring dynamic signatures of microbes in complex host ecosystems</article-title>
        <source>PLoS Comput Biol</source>
        <year>2012</year>
        <volume>8</volume>
        <issue>8</issue>
        <fpage>e1002624</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1002624</pub-id>
        <?supplied-pmid 22876171?>
        <pub-id pub-id-type="pmid">22876171</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gevers</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Kugathasan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Denson</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Vázquez-Baeza</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Van Treuren</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Schwager</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Knights</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Yassour</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Morgan</surname>
            <given-names>XC</given-names>
          </name>
          <name>
            <surname>Kostic</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>González</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>McDonald</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Haberman</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Walters</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Baker</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rosh</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Heyman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Markowitz</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Baldassano</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Griffiths</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sylvester</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Mack</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Crandall</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Hyams</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Huttenhower</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Xavier</surname>
            <given-names>RJ</given-names>
          </name>
        </person-group>
        <article-title>The treatment-naïve microbiome in new-onset Crohn’s disease</article-title>
        <source>Cell Host Microbe</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>382</fpage>
        <lpage>392</lpage>
        <pub-id pub-id-type="doi">10.1016/j.chom.2014.02.005</pub-id>
        <?supplied-pmid 24629344?>
        <pub-id pub-id-type="pmid">24629344</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gloor</surname>
            <given-names>GB</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Pawlowsky-Glahn</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Egozcue</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>It's all relative: analyzing microbiome data as compositions</article-title>
        <source>Ann Epidemiol</source>
        <year>2016</year>
        <volume>26</volume>
        <issue>5</issue>
        <fpage>322</fpage>
        <lpage>329</lpage>
        <pub-id pub-id-type="doi">10.1016/j.annepidem.2016.03.003</pub-id>
        <?supplied-pmid 27143475?>
        <pub-id pub-id-type="pmid">27143475</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gloor</surname>
            <given-names>GB</given-names>
          </name>
          <name>
            <surname>Reid</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Compositional analysis: a valid approach to analyze microbiome high throughput sequencing data</article-title>
        <source>Can J Microbiol</source>
        <year>2016</year>
        <volume>62</volume>
        <issue>8</issue>
        <fpage>692</fpage>
        <lpage>703</lpage>
        <pub-id pub-id-type="doi">10.1139/cjm-2015-0821</pub-id>
        <?supplied-pmid 27314511?>
        <pub-id pub-id-type="pmid">27314511</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gloor</surname>
            <given-names>GB</given-names>
          </name>
          <name>
            <surname>Macklaim</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Pawlowsky-Glahn</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Egozcue</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>Microbiome datasets are compositional: and this is not optional</article-title>
        <source>Front Microbiol</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>2224</fpage>
        <pub-id pub-id-type="doi">10.3389/fmicb.2017.02224</pub-id>
        <?supplied-pmid 29187837?>
        <pub-id pub-id-type="pmid">29187837</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Greenacre</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Compositional data analysis</article-title>
        <source>Annu al Rev Stat Appl</source>
        <year>2021</year>
        <volume>8</volume>
        <fpage>271</fpage>
        <lpage>299</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-statistics-042720-124436</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Satten</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>YJ</given-names>
          </name>
        </person-group>
        <article-title>LOCOM: a logistic regression model for testing differential abundance in compositional microbiome data with false discovery rate control</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2022</year>
        <volume>119</volume>
        <issue>30</issue>
        <fpage>e2122788119</fpage>
        <pub-id pub-id-type="doi">10.1073/pnas.2122788119</pub-id>
        <?supplied-pmid 35867822?>
        <pub-id pub-id-type="pmid">35867822</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Laursen</surname>
            <given-names>MF</given-names>
          </name>
          <name>
            <surname>Andersen</surname>
            <given-names>LBB</given-names>
          </name>
          <name>
            <surname>Michaelsen</surname>
            <given-names>KF</given-names>
          </name>
          <name>
            <surname>Mølgaard</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Trolle</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Bahl</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Licht</surname>
            <given-names>TR</given-names>
          </name>
        </person-group>
        <article-title>Infant gut microbiota development is driven by transition to family foods independent of maternal obesity</article-title>
        <source>MSphere</source>
        <year>2016</year>
        <volume>1</volume>
        <issue>1</issue>
        <fpage>e00069</fpage>
        <lpage>e115</lpage>
        <pub-id pub-id-type="doi">10.1128/mSphere.00069-1</pub-id>
        <?supplied-pmid 27303699?>
        <pub-id pub-id-type="pmid">27303699</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Peddada</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Analysis of compositions of microbiomes with bias correction</article-title>
        <source>Nat Commun</source>
        <year>2020</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-17041-7</pub-id>
        <pub-id pub-id-type="pmid">31911652</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lo</surname>
            <given-names>BC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gut microbiota and systemic immunity in health and disease</article-title>
        <source>Int Immunol</source>
        <year>2021</year>
        <volume>33</volume>
        <fpage>197</fpage>
        <lpage>209</lpage>
        <pub-id pub-id-type="doi">10.1093/intimm/dxaa079</pub-id>
        <?supplied-pmid 33367688?>
        <pub-id pub-id-type="pmid">33367688</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>12</issue>
        <fpage>1</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1186/S13059-014-0550-8/FIGURES/9</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mandal</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Van Treuren</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Eggesbø</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Peddada</surname>
            <given-names>SD</given-names>
          </name>
        </person-group>
        <article-title>Analysis of composition of microbiomes: a novel method for studying microbial composition</article-title>
        <source>Microb Ecol Health Dis</source>
        <year>2015</year>
        <volume>26</volume>
        <fpage>27663</fpage>
        <pub-id pub-id-type="doi">10.3402/mehd.v26.27663</pub-id>
        <?supplied-pmid 26028277?>
        <pub-id pub-id-type="pmid">26028277</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martín-Fernández</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Hron</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Templ</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Filzmoser</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Palarea-Albaladejo</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Model-based replacement of rounded zeros in compositional data: classical and robust approaches</article-title>
        <source>Comput Stat Data Anal</source>
        <year>2012</year>
        <volume>56</volume>
        <fpage>2688</fpage>
        <lpage>2704</lpage>
        <pub-id pub-id-type="doi">10.1016/j.csda.2012.02.012</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nearing</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Douglas</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Hayes</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>MacDonald</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Desai</surname>
            <given-names>DK</given-names>
          </name>
          <name>
            <surname>Allward</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>CAM</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Dhanani</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Comeau</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Langille</surname>
            <given-names>MGI</given-names>
          </name>
        </person-group>
        <article-title>Microbiome differential abundance methods produce different results across 38 datasets</article-title>
        <source>Nat Comm</source>
        <year>2022</year>
        <volume>13</volume>
        <fpage>342</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-022-28034-z</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Park</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ufondu</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Jayaraman</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Emerging computational tools and models for studying gut microbiota composition and function</article-title>
        <source>Curr Opin Biotechnol</source>
        <year>2020</year>
        <volume>66</volume>
        <fpage>301</fpage>
        <lpage>311</lpage>
        <pub-id pub-id-type="doi">10.1016/j.copbio.2020.10.005</pub-id>
        <?supplied-pmid 33248408?>
        <pub-id pub-id-type="pmid">33248408</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paulson</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Colin Stine</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Bravo</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Pop</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Differential abundance analysis for microbial marker-gene surveys</article-title>
        <source>Nat Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <issue>12</issue>
        <fpage>1200</fpage>
        <lpage>1202</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2658</pub-id>
        <?supplied-pmid 24076764?>
        <pub-id pub-id-type="pmid">24076764</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Pawlowsky-Glahn</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Egozcue</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Tolosana-Delgado</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <source>Modeling and analysis of compositional data: Statistics in practice</source>
        <year>2015</year>
        <publisher-loc>Chichester</publisher-loc>
        <publisher-name>Wiley</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>1</issue>
        <fpage>139</fpage>
        <lpage>140</lpage>
        <pub-id pub-id-type="doi">10.1093/BIOINFORMATICS/BTP616</pub-id>
        <?supplied-pmid 19910308?>
        <pub-id pub-id-type="pmid">19910308</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rivera-Pinto</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Egozcue</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Pawlowsky-Glahn</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Paredes</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Noguera-Julian</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Calle</surname>
            <given-names>ML</given-names>
          </name>
        </person-group>
        <article-title>Balances: a new perspective for microbiome analysis</article-title>
        <source>MSystems</source>
        <year>2018</year>
        <volume>3</volume>
        <issue>4</issue>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1128/msystems.00053-18</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schmidt</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Raes</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>The human gut microbiome: from association to modulation</article-title>
        <source>Cell</source>
        <year>2018</year>
        <volume>172</volume>
        <fpage>1198</fpage>
        <lpage>1215</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2018.02.044</pub-id>
        <?supplied-pmid 29522742?>
        <pub-id pub-id-type="pmid">29522742</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Silverman</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Durand</surname>
            <given-names>HK</given-names>
          </name>
          <name>
            <surname>Bloom</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Mukherjee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>David</surname>
            <given-names>LA</given-names>
          </name>
        </person-group>
        <article-title>Dynamic linear models guide design and analysis of microbiota studies within artificial human guts</article-title>
        <source>Microbiome</source>
        <year>2018</year>
        <volume>6</volume>
        <fpage>202</fpage>
        <pub-id pub-id-type="doi">10.1186/s40168-018-0584-3</pub-id>
        <?supplied-pmid 30419949?>
        <pub-id pub-id-type="pmid">30419949</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Susin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lê Cao</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Calle</surname>
            <given-names>ML</given-names>
          </name>
        </person-group>
        <article-title>Variable selection in microbiome compositional data analysis</article-title>
        <source>NAR Genomics Bioinform</source>
        <year>2020</year>
        <volume>2</volume>
        <issue>2</issue>
        <fpage>lqaa029</fpage>
        <pub-id pub-id-type="doi">10.1093/nargab/lqaa029</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weiss</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>ZZ</given-names>
          </name>
          <name>
            <surname>Peddada</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Amir</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bittinger</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Gonzalez</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lozupone</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Zaneveld</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Vázquez-Baeza</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Birmingham</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hyde</surname>
            <given-names>ER</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Normalization and microbial differential abundance strategies depend upon data characteristics</article-title>
        <source>Microbiome</source>
        <year>2017</year>
        <volume>5</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="doi">10.1186/s40168-017-0237-y</pub-id>
        <pub-id pub-id-type="pmid">28086968</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Liwinski</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Elinavet</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Interaction between microbiota and immunity in health and disease</article-title>
        <source>Cell Res</source>
        <year>2020</year>
        <volume>30</volume>
        <fpage>492</fpage>
        <lpage>506</lpage>
        <pub-id pub-id-type="doi">10.1038/s41422-020-0332-7</pub-id>
        <?supplied-pmid 32433595?>
        <pub-id pub-id-type="pmid">32433595</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>fastANCOM: a fast method for analysis of compositions of microbiomes</article-title>
        <source>Bioinformatics</source>
        <year>2022</year>
        <volume>38</volume>
        <issue>7</issue>
        <fpage>2039</fpage>
        <lpage>2041</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btac060</pub-id>
        <?supplied-pmid 35134120?>
        <pub-id pub-id-type="pmid">35134120</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>LinDA: linear models for differential abundance analysis of microbiome compositional data</article-title>
        <source>Genome Biol</source>
        <year>2022</year>
        <volume>23</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>23</lpage>
        <pub-id pub-id-type="doi">10.1186/S13059-022-02655-5/FIGURES/5</pub-id>
        <pub-id pub-id-type="pmid">34980209</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
