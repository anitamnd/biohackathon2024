<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8667531</article-id>
    <article-id pub-id-type="publisher-id">2561</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-021-02561-2</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CIDER: an interpretable meta-clustering framework for single-cell RNA-seq data integration and evaluation</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Hu</surname>
          <given-names>Zhiyuan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Ahmed</surname>
          <given-names>Ahmed A.</given-names>
        </name>
        <address>
          <email>ahmed.ahmed@wrh.ox.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-7615-8523</contrib-id>
        <name>
          <surname>Yau</surname>
          <given-names>Christopher</given-names>
        </name>
        <address>
          <email>christopher.yau@manchester.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.4991.5</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8948</institution-id><institution>Ovarian Cancer Cell Laboratory, MRC Weatherall Institute of Molecular Medicine, </institution><institution>University of Oxford, </institution></institution-wrap>Oxford, OX3 9DS UK </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.4991.5</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8948</institution-id><institution>Nuffield Department of Women’s and Reproductive Health, </institution><institution>University of Oxford, </institution></institution-wrap>Oxford, OX3 9DU UK </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.4991.5</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8948</institution-id><institution>Current Address: MRC Weatherall Institute of Molecular Medicine, Radcliffe Department of Medicine, </institution><institution>University of Oxford, </institution></institution-wrap>Oxford, OX3 9DS UK </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.5379.8</institution-id><institution-id institution-id-type="ISNI">0000000121662407</institution-id><institution>Division of Informatics, Imaging and Data Sciences, Faculty of Biology Medicine and Health, </institution><institution>The University of Manchester, </institution></institution-wrap>Manchester, M13 9PT UK </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.499548.d</institution-id><institution-id institution-id-type="ISNI">0000 0004 5903 3632</institution-id><institution>Alan Turing Institute, </institution></institution-wrap>London, NW1 2DB UK </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="GRID">grid.507332.0</institution-id><institution>Health Data Research UK, </institution></institution-wrap>Gibbs Building, 215 Euston Road, London, NW1 2BE UK </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>13</day>
      <month>12</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>13</day>
      <month>12</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <elocation-id>337</elocation-id>
    <history>
      <date date-type="received">
        <day>5</day>
        <month>5</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>29</day>
        <month>11</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Clustering of joint single-cell RNA-Seq (scRNA-Seq) data is often challenged by confounding factors, such as batch effects and biologically relevant variability. Existing batch effect removal methods typically require strong assumptions on the composition of cell populations being near identical across samples. Here, we present CIDER, a meta-clustering workflow based on inter-group similarity measures. We demonstrate that CIDER outperforms other scRNA-Seq clustering methods and integration approaches in both simulated and real datasets. Moreover, we show that CIDER can be used to assess the biological correctness of integration in real datasets, while it does not require the existence of prior cellular annotations.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13059-021-02561-2.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Clustering</kwd>
      <kwd>Single-cell RNA-Seq</kwd>
      <kwd>Confounding factors</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000265</institution-id>
            <institution>Medical Research Council</institution>
          </institution-wrap>
        </funding-source>
        <award-id>MR/P02646X/1</award-id>
        <award-id>MR/L001411/1</award-id>
        <principal-award-recipient>
          <name>
            <surname>Yau</surname>
            <given-names>Christopher</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000266</institution-id>
            <institution>Engineering and Physical Sciences Research Council</institution>
          </institution-wrap>
        </funding-source>
        <award-id>EP/V023233/1</award-id>
        <award-id>EP/N510129/1</award-id>
        <principal-award-recipient>
          <name>
            <surname>Yau</surname>
            <given-names>Christopher</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000272</institution-id>
            <institution>National Institute for Health Research</institution>
          </institution-wrap>
        </funding-source>
        <award-id>IS-BRC-1215-20008</award-id>
        <principal-award-recipient>
          <name>
            <surname>Ahmed</surname>
            <given-names>Ahmed A.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par2">The widespread adoption of single-cell RNA sequencing (scRNA-Seq) as a modality for the investigation of functional cellular heterogeneity means it is now routine for multiple datasets to be generated from the same type of tissues and organs across a number of individuals. Integration of multiple scRNA-Seq datasets can provide more comprehensive interpretations by borrowing information across experiments and even species [<xref ref-type="bibr" rid="CR1">1</xref>]. However, the data from multiple experiments are often confounded by inter-batch or inter-donor variability.</p>
    <p id="Par3">Existing clustering workflows can effectively identify cell populations in batch-effect-free datasets [<xref ref-type="bibr" rid="CR2">2</xref>], by partitioning cells based on the inter-cell distance matrix computed from the expression data of high variance genes (HVGs) or the derived principal components. For example, SC3 constructs the distance matrix by applying Euclidean, Pearson, and Spearman metrics on the expression data of HVGs and transfers this distance matrix by principal component analysis (PCA) or graph Laplacian transformation, before consensus clustering [<xref ref-type="bibr" rid="CR3">3</xref>]. RaceID computes the distance matrix in the same way as SC3 but provides more options of distance measures, including Kendall and proportionality [<xref ref-type="bibr" rid="CR4">4</xref>]. Seurat v3 calculates Euclidean distances from the principal components and then infers the graph of shared nearest neighbors for the subsequent graph-based clustering, such as Louvain clustering [<xref ref-type="bibr" rid="CR5">5</xref>]. However, distance measurements used by these workflows cannot effectively distinguish biological variation from the technical one and, thus, their performance is compromised in datasets confounded by batch effects or other variability caused by unwanted or unexplained factors.</p>
    <p id="Par4">In data confounded by batch effects, workflows combining batch correction or integration methods and downstream clustering algorithms are used to identify cell populations. Some existing batch correction and integration methods can efficiently correct the gene expression or dimensionality reduction spaces for visualization and other downstream analyses. For example, mutual nearest neighbors [<xref ref-type="bibr" rid="CR6">6</xref>] (MNN) uses the cell pairs that are mutually nearest neighbors to compute a vector that aligns multiple batches into a common space, which is also incorporated in the Monocle3 pipeline [<xref ref-type="bibr" rid="CR7">7</xref>]. Scanorama [<xref ref-type="bibr" rid="CR8">8</xref>] also used the concept of MNNs to merge datasets with substantial improvement in the MNN search strategies. Seurat exploits canonical correlation analysis [<xref ref-type="bibr" rid="CR9">9</xref>] (CCA) and reciprocal PCA [<xref ref-type="bibr" rid="CR10">10</xref>] (RPCA) to compute a subspace and then used the identified MNNs, i.e., “anchors,” to correct the data. Harmony [<xref ref-type="bibr" rid="CR11">11</xref>] iteratively diminishes batch effects in the PCA space by soft clustering across batches and then adjusting cell positions based on the global and dataset-specific cluster centroids. LIGER [<xref ref-type="bibr" rid="CR12">12</xref>] exploits integrative non-negative matrix factorization to compute the factor loading matrix for cell type assignment. Combat [<xref ref-type="bibr" rid="CR13">13</xref>] leverages the empirical Bayesian framework to derive the corrected gene expression matrix. Clustering on network of samples [<xref ref-type="bibr" rid="CR14">14</xref>] (Conos) computes the cell-cell connection and downweights the intra-sample connections to construct a joint graph for downstream analysis. However, for the majority of integration methods, performance can vary substantially across data types and scenarios [<xref ref-type="bibr" rid="CR15">15</xref>]. An additional limitation of the commonly used integration algorithms, e.g., CCA and Harmony, is that they work on the low-dimensional representation, which can be affected by the bias in the initial selection of HVGs and principal components. Furthermore, it is often difficult to determine why existing methods drive cells from different batches into the same cluster. This lack of explainability or interpretability can make it difficult to ascertain if integration has been successful.</p>
    <p id="Par5">To address this limitation, we recently introduced the use of meta-clustering to partition scRNA-Seq data from ovarian cancer fallopian tube epithelial cells confounded by structured batch effects and inter-patient variability [<xref ref-type="bibr" rid="CR16">16</xref>]. This method was based on a functional hypothesis that cells from the same biological population (either cell type, subtype, or state) share a similar differential expression pattern, i.e., the differentially expressed genes (DEGs) having more weights to determine cell classes compared to other genes. Moreover, these DEGs are less affected by batch effects by regressing out the unwanted factors. In this work, we present a scalable version of this methodology and demonstrate its generalizable utility for wider application.</p>
    <p id="Par6">Here, we introduce a novel similarity metric based on Inter-group Differential ExpRession (IDER) and propose a workflow of Clustering by IDER (CIDER). We demonstrate that the performance of CIDER is comparable or superior to existing clustering workflows applied on uncorrected and batch-corrected datasets in a variety of scenarios for both simulated and real scRNA-Seq data. Furthermore, as IDER is a substantively different form of distance metric compared to those used in popular integration algorithms, we show that CIDER can also be used as a ground-truth-free evaluation metric for accurately identifying falsely integrated populations.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>Design of CIDER and proof-of-concept experiment</title>
      <p id="Par7">The core of CIDER is the IDER metric, which can be used to compute the similarity between two groups of cells across datasets (Fig. <xref rid="Fig1" ref-type="fig">1</xref>A). IDER first identifies the differentially expressed signature (DES) for each group of cells against all other cells with the unwanted variables regressed out. Next, a similarity measure is computed by using the consistency of DESs between two groups across datasets. Differential expression in IDER is computed using the same principle as limma-trend [<xref ref-type="bibr" rid="CR17">17</xref>], which was chosen from a collection of approaches for differential expression analysis based on a number of performance criteria (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1A, B) [<xref ref-type="bibr" rid="CR18">18</xref>].
<fig id="Fig1"><label>Fig. 1</label><caption><p>IDER metric accurately measures the biological similarity between cell groups. <bold>A</bold> Schematic diagram shows how the IDER metric measures the inter-group similarity. <bold>B</bold> The diagram shows the theoretical justification for CIDER. <italic>E</italic><sub><italic>ijk</italic></sub> denotes the expression level of gene <italic>j</italic> in cell <italic>i</italic> of batch <italic>k</italic>, <italic>z</italic><sub><italic>ik</italic></sub> cell assignment of cells of cell <italic>i</italic>, <italic>C</italic> cluster effect, <italic>B</italic> batch effect, and <italic>P</italic> patient effect or other biases. In the lower panel, <italic>z</italic><sub><italic>ik</italic></sub> is set to 1. <bold>C</bold> Schematic diagram of asCIDER and dnCIDER. <bold>d</bold>
<italic>t</italic>-SNE plots show the cells from three batches of Dataset 1. Each subpanel represents a batch. Cells are colored by the population. Each batch-specific cluster is denoted by a label. <bold>E</bold> The IDER metric generated higher similarity between group pairs, (g<sub>1</sub>, g<sub>1</sub>’) and (g<sub>2</sub>, g<sub>2</sub>’), from identical cell types and lower similarity between group pairs from different cell types</p></caption><graphic xlink:href="13059_2021_2561_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par8">CIDER is established on the hypothesis that the expression level contains the linear combination of the effects of cluster, batch, donor, platform, etc. (Fig. <xref rid="Fig1" ref-type="fig">1</xref>B). The within-dataset clustering enables the identification of the cluster effect (i.e., cell assignment) for a given dataset, as the confounding effect (e.g., batch effects, inter-donor variability, or inter-species variability) is a constant within the same dataset. Once the cell assignments are completed for all datasets, we use limma to regress out the confounding effects across datasets and identify consistent cluster effects, represented by DESs, from multiple datasets. Groups with a consistent cluster effect will be merged into one final cluster. In the workflow of CIDER, IDER is used to measure the pairwise inter-group similarity among the batch-specific initial clusters (Fig. <xref rid="Fig1" ref-type="fig">1</xref>C). These initial clusters can be either curated annotations or outputs from a clustering algorithm. The output of the IDER step, i.e., a similarity matrix, is used to merge the connected initial clusters into final cross-batch clusters. Depending on how the initial clusters were derived, we named the CIDER workflows as de novo CIDER (dnCIDER), where initial clusters were the output of a clustering algorithm, and assisted CIDER (asCIDER), where initial clusters were curated annotations of cell populations. These two scenarios were considered in our benchmarking because they are common in real-world usage.</p>
      <p id="Par9">We set about to test if the IDER metric could accurately estimate the cluster effects and regress out biases in data confounded by batch effects. As a proof-of-concept experiment, we applied it to a multiple cell line dataset (Dataset 1) [<xref ref-type="bibr" rid="CR19">19</xref>], in which three batches corresponded to pure 293T cells, pure Jurkat cells, and a 50/50 mixture of both cell lines. The IDER metric was used to calculate the pairwise similarity among four groups from these three batches (Fig. <xref rid="Fig1" ref-type="fig">1</xref>D, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2). We showed that the similarity computed by IDER was higher for the group pairs from the identical cell type compared to the pairs from different cell types (Fig. <xref rid="Fig1" ref-type="fig">1</xref>E), demonstrating the utility of IDER as a metric to identify cluster similarity across datasets when confounded by batch effects.</p>
    </sec>
    <sec id="Sec4">
      <title>Benchmarking clustering performance on simulated data</title>
      <p id="Par10">To test the accuracy of identifying populations, we benchmarked CIDER against other 12 workflows: nine workflows that combined integration approaches and clustering (Seurat-CCA [<xref ref-type="bibr" rid="CR9">9</xref>], fastMNN [<xref ref-type="bibr" rid="CR6">6</xref>], Scanorama [<xref ref-type="bibr" rid="CR8">8</xref>], Harmony [<xref ref-type="bibr" rid="CR11">11</xref>], LIGER [<xref ref-type="bibr" rid="CR12">12</xref>], Combat [<xref ref-type="bibr" rid="CR13">13</xref>], Monocle3 [<xref ref-type="bibr" rid="CR7">7</xref>], Conos [<xref ref-type="bibr" rid="CR14">14</xref>], and RPCA [<xref ref-type="bibr" rid="CR10">10</xref>]) and three single-cell clustering approaches (Seurat v3-Louvain [<xref ref-type="bibr" rid="CR5">5</xref>], SC3 [<xref ref-type="bibr" rid="CR3">3</xref>], and RaceID [<xref ref-type="bibr" rid="CR4">4</xref>]).</p>
      <p id="Par11">We used a simulated dataset (Dataset 2, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1) as a tailor-made, toy example, where three batches comprised non-identical compositions of populations (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3A, B). The challenge is to be able to match clusters across batches, e.g., to identify that Group 3 cells (Yellow) exist across all three batches. In this scenario, the cross-batch similarity computed by CIDER correctly recognized the connection among initial clusters (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A, B). In contrast, MNN and CCA overcorrected the batch effects, leading to the incorrect merging of disparate populations as previously reported [<xref ref-type="bibr" rid="CR8">8</xref>] (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3C-F). To quantitatively compare their performance, we computed the adjusted Rand indexes (ARIs) between cell labels and clustering results (ARI<sub>population</sub>) or the ARIs between batches and clustering results (ARI<sub>batch</sub>). Ideal performance is characterized by high ARI<sub>population</sub> and low ARI<sub>batch</sub> (i.e., high 1-ARI<sub>batch</sub>) such that cluster allocation is dominated by cell type and not batch, while in this scenario of unbalanced cell composition 1-ARI<sub>batch</sub> close to 1 corresponds to overcorrection. The experimental replicates (<italic>n</italic> = 20) confirmed that CIDER robustly outperformed fastMNN and CCA in this scenario of non-identical cellular compositions (Fig. <xref rid="Fig2" ref-type="fig">2</xref>C). While Harmony, Scanorama, and SC3 could also identify the exact cell classes, like fastMNN and CCA, LIGER, Monocle3, and Conos also overcorrected the batch effects (Fig. <xref rid="Fig2" ref-type="fig">2</xref>D). For this dataset (<italic>n</italic> = 6000 cells), the running time (1.5 s and 10.9 s average) of asCIDER and dnCIDER was comparable to that of Harmony (15.5 s), Scanorama (15.9 s), and Seurat clustering (19.1 s) (Fig. <xref rid="Fig2" ref-type="fig">2</xref>E). While this was a toy example, this simple simulation illustrates the challenge of confounding effects. We next benchmarked CIDER on four real datasets.
<fig id="Fig2"><label>Fig. 2</label><caption><p>CIDER accurately identifies cross-batch populations. <bold>A</bold>
<italic>t</italic>-SNE plot shows the nine initial clusters from three batches of the simulated dataset (Dataset 2). Cells are colored by initial clusters. <bold>B</bold> The graph network shows the similarity among initial clusters. Vertexes represent initial clusters, colored by populations. The width of edges represents the similarity levels. <bold>C</bold> Distribution of ARI<sub>population</sub> for 20 replicates of simulated data across integration workflows and clustering algorithms. The <italic>x</italic>-axis denotes the workflow performance by calculating ARIs between cell populations and clustering results, and the <italic>y</italic>-axis denotes clustering and integration workflows. The whiskers from left to right in the boxplot represent the first quartile, the median, and the third quartile. <bold>D</bold>, <bold>E</bold> Distribution of 1-ARI<sub>batch</sub> (<bold>D</bold>) and runtime (<bold>E</bold>) for 20 replicates of simulated data across integration workflows and clustering algorithms</p></caption><graphic xlink:href="13059_2021_2561_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec5">
      <title>Benchmarking clustering performance on real data</title>
      <p id="Par12">We next tested CIDER with Dataset 3 of human peripheral blood mononuclear cells (PBMCs) [<xref ref-type="bibr" rid="CR19">19</xref>]. Cells were annotated into nine cell types and subtypes, namely B cell, CD4 T cell, CD8 T cell, hematopoietic stem cell (HSC), megakaryocyte, CD14 monocyte, FCGR3A monocyte, natural killer (NK) cell, and plasmacytoid dendritic cell [<xref ref-type="bibr" rid="CR20">20</xref>]. Cells of this dataset were sequenced by either of two techniques (10x 3’ and 5’ single-cell gene expression), which we termed Batch 1 and Batch 2, respectively. The uncorrected space suggested that the data were confounded by batch effects (the variability introduced by techniques in this scenario), which forced a cognate cell population into more than one cluster (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4A, B). We set the technique effect as the unwanted variable and regressed it out from the derived DES, which eliminated the influence of technique variability on the inter-group similarity matrix and the results of subsequently final clustering. Both dnCIDER and asCIDER outperformed other batch correction and clustering workflows regarding the accuracy of identifying populations (Fig. <xref rid="Fig3" ref-type="fig">3</xref>A). The meta-clustering workflows also overcame the effect of techniques, while the accuracy of sole clustering methods (Seurat clustering, SC3, and RaceID) was interfered as implied by the lower values of 1-ARI<sub>batch</sub> (Fig. <xref rid="Fig3" ref-type="fig">3</xref>B). CIDER also had the shortest runtime in this dataset of moderate size (<italic>n</italic> = 14,876 cells) compared to other benchmarked methods (Fig. <xref rid="Fig3" ref-type="fig">3</xref>C). Because the dnCIDER clustering results have not been annotated according to biological functions, the results of asCIDER are used as an example to elucidate its biological relevance and interpretability for this dataset and the following ones. Beyond achieving joint clustering, asCIDER could reveal the underlying relationships among initial clusters via a network graph (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4C, D). The cliques in the network graph suggested a hierarchical structure of cell populations. It not only presented the binary relationship, i.e., which initial clusters should be merged, but also quantified the strength of agreement, i.e., IDER-based similarity, among homogenous and heterogeneous populations. In addition to showing the connections, it revealed the relationships between heterogeneous populations. For example, CD4 and CD8 T cell populations, CD14 and FCGR3A monocyte populations, shared high pairwise similarity. The clustering results of CIDER methods, e.g., asCIDER, could be visualized in the unaligned low-dimensional space (Fig. <xref rid="Fig3" ref-type="fig">3</xref>D, E). In the downstream analysis, we regressed out the technical variability and identified the cluster-specific marker genes (Fig. <xref rid="Fig3" ref-type="fig">3</xref>F, G).
<fig id="Fig3"><label>Fig. 3</label><caption><p>CIDER leads to precise cell classification in the joint PBMC data sequenced by two techniques (Dataset 3). <bold>A</bold>–<bold>C</bold> Distribution of ARI<sub>population</sub> (<bold>A</bold>), 1-ARI<sub>batch</sub> (<bold>B</bold>), and runtime (<bold>C</bold>) across integration workflows and clustering algorithms. <bold>D</bold>
<italic>t</italic>-SNE plot of cells from Batch 1, colored by asCIDER clustering results (final clusters). <bold>E</bold>
<italic>t</italic>-SNE plot of cells from Batch 2. <bold>F</bold>
<italic>t</italic>-SNE plots of cells show expression levels of marker genes in two batches. <bold>G</bold> Average expression levels and percentages of expression of top marker genes across asCIDER clusters. The size of dots denotes the percentage of expression, and the color represents the average expression level</p></caption><graphic xlink:href="13059_2021_2561_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par13">Given interest in cross-species comparative analysis, we benchmarked CIDER on Dataset 4 that contains both human and mouse pancreatic data (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5A, B) [<xref ref-type="bibr" rid="CR21">21</xref>]. This dataset is composed of 2 mouse samples and 4 human samples, resulting in the structured combination of species effect and donor effect. CIDER was aimed to regress out the species effect, in which case the donor effect was treated as the nesting variable in the regression model. CIDER workflows outperformed other pipelines regarding the accuracy of identifying cell classes (ARI<sub>population</sub>) (Fig. <xref rid="Fig4" ref-type="fig">4</xref>A). With respect to the capability to correct batch effects (1-ARI<sub>batch</sub>), CIDER workflows were comparable to the other integration methods ranging between 0.97 and 1, except Combat and Monocle3, which had lower 1-ARI<sub>batch</sub> (0.93 and 0.94, respectively) (Fig. <xref rid="Fig4" ref-type="fig">4</xref>B). Moreover, asCIDER cost the least amount of processing time, while the runtime of dnCIDER was slightly longer than Scanorama, fastMNN, and Harmony (Fig. <xref rid="Fig4" ref-type="fig">4</xref>C). Dataset 4 (<italic>n</italic> = 10,127) has fewer cells than Dataset 3 (<italic>n</italic> = 14,876). CIDER took longer to process Dataset 4 than Dataset 3 because its running time is approximately associated with the numbers of batch-specific clusters. In addition to identifying cell assignment, the asCIDER result revealed that the between-species similarity was inconsistent across cell types (Fig. <xref rid="Fig4" ref-type="fig">4</xref>D). Unlike methods based on low-dimensional space, the gene-level analysis of CIDER empowered its explainability by delineating how various genes contributed to inter-group similarity. The influence of individual genes was derived by the Fisher <italic>z</italic>-transformation. Positive values of influence indicated the affirmative contribution to similarity, while negative values denoted the contribution to dissimilarity. For example, the inter-species similarity (0.40) of the ductal cell population was suppressed by the existence of negative-influence genes, e.g., <italic>CLU</italic>, <italic>TMSB4X</italic>, and <italic>B2M</italic> (Fig. <xref rid="Fig4" ref-type="fig">4</xref>E). Yet the top positive-influence genes, e.g., <italic>KRT8</italic> and <italic>KRT18</italic>, were the main drivers of aligning human and mouse ductal groups. On the other hand, the alpha cell population had a high value of inter-species similarity (0.62) owing to top positive-influence genes, e.g., <italic>GCG</italic> and <italic>TTR</italic> (Fig. <xref rid="Fig4" ref-type="fig">4</xref>F).
<fig id="Fig4"><label>Fig. 4</label><caption><p>CIDER accurately identifies clusters between human and mouse samples in the cross-species pancreas data (Dataset 4). <bold>A</bold>–<bold>C</bold> Distribution of ARI<sub>population</sub> (<bold>A</bold>), 1-ARI<sub>batch</sub> (<bold>B</bold>), and runtime (<bold>C</bold>) across integration workflows and clustering algorithms. <bold>D</bold> Heatmap shows the inter-group similarity between mouse populations (<italic>x</italic>-axis) and human ones (<italic>y</italic>-axis). Cells are colored by the similarity levels, as shown by the numbers. <bold>E</bold> Scatter plot shows genes driving the similarity and dissimilarity between the human ductal group and the mouse ductal group. The <italic>x</italic>- and <italic>y</italic>-axes denote the DESs in humans and mice. Each dot is a gene, colored and sized by the influence and its abstract value. The gray line is the linear regression line for reference. Genes with the ten largest abstract values of influence are labeled. <bold>F</bold> Scatter plot shows genes driving the similarity and dissimilarity between the human alpha group and the mouse alpha group</p></caption><graphic xlink:href="13059_2021_2561_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par14">We next tested the capability of coping condition effects on data from a recent COVID-19 study (Dataset 5) [<xref ref-type="bibr" rid="CR22">22</xref>]. This dataset contained 59,572 PBMCs collected from healthy donors, patients with severe influenza, and patients with various severity of COVID-19 (asymptomatic, mild, and severe). These cells were cataloged into 15 populations: lgG− B cell, lgG+ B cell, effector memory (EM)-like CD4+ T cell, non-EM-like CD4+ T cell, EM-like CD8+ T cell, non-EM-like CD8+ T cell, NK cell, classical monocyte, intermediate monocyte, nonclassical monocyte, dendritic cell (DC), uncategorized 1, uncategorized 2, red blood cell (RBC), and platelet. For this dataset, the health condition was treated as the confounding factor for correction. Among the benchmarked methods, asCIDER had the highest ARI<sub>population</sub>, while the other methods, except LIGER, Combat, RaceID, and Monocle3, had similar ARI<sub>population</sub> values between 0.45 and 0.60 (Fig. <xref rid="Fig5" ref-type="fig">5</xref>A). The overall low level of ARI<sub>population</sub> was likely due to the manually curated and merged cell annotations [<xref ref-type="bibr" rid="CR22">22</xref>], where the similarity between defined cell populations might not reflect the statistical similarity defined by these clustering and integration algorithms. Besides, because the cell type annotations were generated from CCA-corrected data, it was expected that the comparison results favored CCA and similar methodologies. The lower ARI<sub>batch</sub> values of Seurat and SC3 clustering results suggested that this dataset was mildly confounded by the effect of health conditions (Fig. <xref rid="Fig5" ref-type="fig">5</xref>B). AsCIDER consumed the shortest running time, while dnCIDER was slightly slower than Harmony and fastMNN but faster than other integration methods (Fig. <xref rid="Fig5" ref-type="fig">5</xref>C). After regressing out the systematic effect of health conditions, the inter-group distance matrix generated by asCIDER unraveled the cell-type-specific local relationship of various conditions. For example, the populations of classical monocytes, natural killer (NK) cells, red blood cells (RBC), dendritic cells (DC), and lgG+ B cells from patients with severe COVID-19 were more akin to the ones from patients with severe influenza than the ones from patients with mild or asymptomatic COVID-19, while nonclassical monocytes and effector memory (EM)-like CD8 T cells were not (Fig. <xref rid="Fig5" ref-type="fig">5</xref>D–G, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6A-C).
<fig id="Fig5"><label>Fig. 5</label><caption><p>CIDER identified cross-condition cell classes in the PBMC data from healthy donors and patients with COVID-19 or influenza (Dataset 5). <bold>A</bold>–<bold>C</bold> The distribution of ARI<sub>population</sub> (<bold>A</bold>), 1-ARI<sub>batch</sub> (<bold>B</bold>), and runtime (<bold>C</bold>) of benchmarked algorithms. SC3 and RaceID were ran on the dataset downsampled by the factor of 5. <bold>D</bold>–<bold>G</bold> Dendrograms show the local relationships of the classical monocyte population (<bold>D</bold>), nonclassical monocyte population (<bold>E</bold>), the EM-like CD8 T cell population (<bold>F</bold>), and the natural killer (NK) population (<bold>G</bold>) from donors with different health conditions</p></caption><graphic xlink:href="13059_2021_2561_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par15">To demonstrate the scalability of CIDER, we benchmarked CIDER and other methods on a breast cancer dataset (Dataset 6) containing 170,350 cells from 31 patients with the estrogen receptor-positive (ER+) subtype, the human epidermal growth factor receptor 2-negative (HER2−) subtype, and the triple-negative breast cancer (TNBC) [<xref ref-type="bibr" rid="CR23">23</xref>]. For each patient, two samples were collected, one before the treatment and one during the subsequent surgery. Thus, three potential covariates existed, namely the donor effect, the treatment effect, and the disease effect, and donor was the nesting variable to disease. To identify the cross-patient populations, we generated patient-specific initial clusters and then used donor and treatment (pre-treatment or on-treatment) as covariates to calculate the IDER-based similarity matrix, which enabled regressing out donor and treatment effects. Compared to other methods, CIDER methods had higher accuracy in identifying cross-donor populations (Fig. <xref rid="Fig6" ref-type="fig">6</xref>A). They were also less affected by the donor effect compared to solely using Louvain clustering (Fig. <xref rid="Fig6" ref-type="fig">6</xref>B). Both algorithmic variants dnCIDER and asCIDER consumed less time than other integration methods applied to the full dataset (Fig. <xref rid="Fig6" ref-type="fig">6</xref>C). Other than providing the clustering results, asCIDER also revealed that the tumor cells and, interestingly, the B cells had higher levels of intra-population heterogeneity, even after regressing out the systematic cross-population donor and treatment effects (Fig. <xref rid="Fig6" ref-type="fig">6</xref>D). Such heterogeneity was expected in the tumor cells [<xref ref-type="bibr" rid="CR23">23</xref>], while the one in B cells has remained obscure.
<fig id="Fig6"><label>Fig. 6</label><caption><p>CIDER identifies cross-donor populations in the breast tumor data of 170,350 cells from 31 patients (Dataset 6). <bold>A</bold>–<bold>C</bold> The distribution of ARI<sub>population</sub> (<bold>A</bold>), 1-ARI<sub>batch</sub> (<bold>B</bold>), and runtime (<bold>C</bold>) of benchmarked algorithms. <bold>D</bold> Heatmap shows the inter-group similarity matrix for donor-specific initial clusters of asCIDER. Tiles are colored by the similarity levels. The annotation bars are colored by diseases or cell types</p></caption><graphic xlink:href="13059_2021_2561_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par16">Overall, it suggested that the clustering performance of asCIDER and dnCIDER was more accurate on data confounded by technical effects, species difference, disease variability, and inter-donor variability, compared to the clustering results generated from the corrected low-dimensional representations. CIDER methods could also provide insights into the intra-population heterogeneity across different conditions.</p>
    </sec>
    <sec id="Sec6">
      <title>CIDER as a ground-truth-free test metric of integration</title>
      <p id="Par17">One of the common pitfalls of multiple dataset integration is incorrect alignment, where two heterogeneous groups of cells are merged in the corrected space (Fig. <xref rid="Fig7" ref-type="fig">7</xref>A). Although existing test metrics, such as the cell-type local inverse Simpson Index (cLISI) [<xref ref-type="bibr" rid="CR11">11</xref>], can measure the local impurity in the joint low-dimensional representation, its major limitation is the demand for predefined cell populations. To address this limitation, we embedded CIDER into a workflow of evaluating the integration outcome, and our evaluation method does not require the ground truth of cell type annotations (Fig. <xref rid="Fig7" ref-type="fig">7</xref>B). In this workflow, after data are corrected by a chosen integration tool, an initial clustering step generates cross-batch clusters based on the corrected expression matrix or low-dimensional representation. Using the IDER metric, the inter-group similarity is calculated between the initial clusters split by batches. The empirical probability of rejecting the alignment is next computed by comparing the distributions of similarity between the targeted cluster and the background. Low similarity or a high empirical probability putatively indicates the falsely aligned cluster, i.e., rejection of the fact that cells from a cross-batch cluster belong to a homogeneous population.
<fig id="Fig7"><label>Fig. 7</label><caption><p>CIDER can evaluate the biological accuracy of integration results without reliance on ground truth. <bold>A</bold> The diagram shows two scenarios, one, where the cell types from two batches are correctly aligned, and one, where the two heterogeneous cell types (1 and 3) from two batches are falsely aligned, often because of overcorrection. <bold>B</bold> The schematic diagram elucidates the workflow for assessing the integrated outcome to identify falsely aligned clusters, which have lower inter-group similarity. CIDER can identify the second scenario without prior information of cell types</p></caption><graphic xlink:href="13059_2021_2561_Fig7_HTML" id="MO7"/></fig></p>
      <p id="Par18">We applied CCA on the dendritic cell dataset (Dataset 7) [<xref ref-type="bibr" rid="CR24">24</xref>], which contains four cell subtypes (CD141, CD1C, double negative [DoubleNeg], and plasmacytoid dendritic cell [pDC]). The integration algorithm is prone to merging the CD141 cell population and the CD1C population incorrectly (Fig. <xref rid="Fig8" ref-type="fig">8</xref>A) [<xref ref-type="bibr" rid="CR15">15</xref>]. After integration and dimensionality reduction, we applied CIDER on the corrected low-dimensional representation to compute the similarity and empirical probabilities (Fig. <xref rid="Fig7" ref-type="fig">7</xref>B and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7A-D). The cluster that had lower similarity and high probability of rejection was the mixture of the CD141 and CD1C populations, while the other two clusters (DoubleNeg and pDC) with high similarity and low empirical probability were properly aligned (Fig. <xref rid="Fig8" ref-type="fig">8</xref>B, C). It demonstrated that CIDER could accurately identify falsely aligned populations. To further visualize the local diversity and compare it with the CIDER metric, we used the cLISI metric [<xref ref-type="bibr" rid="CR11">11</xref>], where the cLISI over 1 indicated the local heterogeneity of cell classes. The results of CIDER were in accord with cLISI (Fig. <xref rid="Fig8" ref-type="fig">8</xref>D).
<fig id="Fig8"><label>Fig. 8</label><caption><p>CIDER identifies the falsely aligned CD1C and CD141 subtypes in the dendritic cell data (Dataset 7). <bold>A</bold>–<bold>D</bold>
<italic>t</italic>-SNE plots of the CCA-corrected data, where cells are colored by cell populations (<bold>A</bold>), the similarity score computed by CIDER (<bold>B</bold>), the empirical probability of rejection computed from the background distribution (<bold>C</bold>), and the cLISI values (<bold>D</bold>)</p></caption><graphic xlink:href="13059_2021_2561_Fig8_HTML" id="MO8"/></fig></p>
      <p id="Par19">We next tested CIDER on the mouse hematopoietic progenitor data (Dataset 8) with the continuous data structure [<xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR26">26</xref>]. Cells of this dataset were assigned to three populations, the common myeloid progenitor (CMP), the megakaryocyte/erythrocyte progenitor (MEP), and the granulocyte/macrophage progenitor (GMP), and profiled by two platforms, MARS-seq [<xref ref-type="bibr" rid="CR26">26</xref>] and Smart-Seq2 [<xref ref-type="bibr" rid="CR25">25</xref>] (Fig. <xref rid="Fig9" ref-type="fig">9</xref>A). After integration and dimensionality reduction, we used CIDER to compute the similarity and empirical probabilities. The CIDER metrics indicated that the cells around the bifurcating point shared lower levels of agreement between the two experiments (Fig. <xref rid="Fig9" ref-type="fig">9</xref>B, C). Based on the ground truth of cell annotations, the results of cLISI also suggested that multiple populations were mixed around the bifurcating point (cLISI ≥ 2; Fig. <xref rid="Fig9" ref-type="fig">9</xref>D). Moreover, the results of CIDER showed that the alignment scores of CMP, the direct ancestor of both MEP and GMP, were lower than those of MEP and GMP between two experiments, which was consistent with the distribution of 3-cLISI (Fig. <xref rid="Fig9" ref-type="fig">9</xref>E, F). This is likely due to the higher level of heterogeneity in the predefined CMP population compared to MEP [<xref ref-type="bibr" rid="CR26">26</xref>]. Taken together, we demonstrated that CIDER could accurately evaluate the local biological homogeneity without relying on predefined cell annotations.
<fig id="Fig9"><label>Fig. 9</label><caption><p>CIDER identifies a high level of heterogeneity within the CMP population in the mouse hematopoietic progenitor data (Dataset 8). <bold>A</bold>–<bold>D</bold> Diffusion maps of the CCA-corrected data, where cells are colored by cell populations (<bold>A</bold>), the similarity score computed by CIDER (<bold>B</bold>), the empirical probability of rejection (<bold>C</bold>), and the local purity represented by 3-cLISI (<bold>D</bold>). <bold>E</bold> The distribution of agreement (<italic>y</italic>-axis), denoted by the similarity calculated by CIDER, between two experiments for three cell populations (<italic>x</italic>-axis), CMP, GMP, and MEP. <bold>F</bold> The distribution of agreement, denoted by 3-cLISI, between two experiments</p></caption><graphic xlink:href="13059_2021_2561_Fig9_HTML" id="MO9"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec7">
    <title>Discussion</title>
    <p id="Par20">In this work, we presented a meta-clustering framework, CIDER, for scRNA-Seq data integration and evaluation. The benchmarking demonstrated the performance of CIDER regarding the accuracy of recognizing cellular populations, the effectiveness of removing batch effects, and its scalability.</p>
    <p id="Par21">CIDER used a novel and intuitive strategy that measures the similarity by performing group-level calculations, which stabilize the gene-wise variability. Compared to other distance measures or anchors used for clustering and integration [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR9">9</xref>], we show that IDER is versatile in its ability to quantify biological similarity and readily interpretable. CIDER can be exploited for preliminary analysis, standalone clustering, or independent validation. Since IDER is built on a different rationale from conventional integration approaches, the similarity graph it generates can provide insights that can be treated as an alternative to standard techniques, which often cannot genuinely preserve long-distance and short-distance relationships. Moreover, CIDER can compute a similarity score between cell groups from two conditions, enabling the inference of local relationships based on the expression profiles. Among other methods, Scanorama [<xref ref-type="bibr" rid="CR8">8</xref>] can also calculate an alignment score for pairs of datasets for better interpretability, but it is derived from the membership of shared nearest neighbors rather than directly estimated from expression profiles.</p>
    <p id="Par22">A common question of integration is which effects should be considered. Two criteria, the magnitude of the bias and their relevance to the purpose of the study, can be used to choose covariates for correction. In the first scenario, such as Dataset 2 (simulated data) and Datasets 3 (PBMC), the simulated batch effect and the technical effect introduced bias into the clustering if not corrected (Figs. <xref rid="Fig2" ref-type="fig">2</xref> and <xref rid="Fig3" ref-type="fig">3</xref>C and A), indicating the covariates for regression. On the other hand, advances in the droplet-based scRNA-Seq platform and the cryopreservation technique have enabled the minimization of technically introduced batch effects. Thus, in the experiments that follow one consistent experimental protocol and include multiple donors, the inter-sample variability can be largely attributed to the “biological” variability, such as donors’ condition and genetic diversity [<xref ref-type="bibr" rid="CR27">27</xref>, <xref ref-type="bibr" rid="CR28">28</xref>]. In this scenario, the selection of covariates for regression can be based on the relevance to the research goal. For example, the health condition in Dataset 5 (COVID-19 versus severe flu) and the donor, as well as the treatment, in Dataset 6 (breast cancer) were corrected to identify cross-condition and cross-donor populations.</p>
    <p id="Par23">Multiple sample integration has become one of the most frequently used tools for scRNA-Seq data analysis [<xref ref-type="bibr" rid="CR29">29</xref>]. Along with the rapidly growing amount of available scRNA-Seq data, the recent advances in neural network models and approaches for transfer learning have facilitated the query-reference mapping [<xref ref-type="bibr" rid="CR30">30</xref>]. This highlights the importance of accurate integration. We demonstrated the usefulness of CIDER for evaluating the integration outcome, which can be used to select integration tools and tune the parameters if a joint low-dimensional representation is desired.</p>
    <p id="Par24">CIDER is currently designed for scRNA-Seq data and cannot be used for the integration of single-cell multi-modal data [<xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR32">32</xref>]. Future work can be focused on adapting the linear model embedded in CIDER for this purpose. Although the group-level analysis CIDER performs is coarse-grained, CIDER can be applied to data with continuous structures, as we demonstrated; further work to develop specific extensions in this methodological direction is required.</p>
  </sec>
  <sec id="Sec8">
    <title>Conclusions</title>
    <p id="Par25">CIDER provides a clustering framework for integrative analysis of multiple scRNA-Seq datasets, enabling identifying cell assignments across datasets and validating the integration output for the assembly of multiple scRNA-Seq datasets.</p>
  </sec>
  <sec id="Sec9">
    <title>Methods</title>
    <sec id="Sec10">
      <title>Measurement of inter-group similarity</title>
      <p id="Par26">The infrastructure of IDER was built on limma-trend [<xref ref-type="bibr" rid="CR17">17</xref>] or voom [<xref ref-type="bibr" rid="CR33">33</xref>]. Both limma-trend and voom estimate the mean-variance relationship non-parametrically by locally weighted regression and then leverage the estimation for DE analysis. The difference between limma-trend and voom is that the mean-variance relationships exploited by them are at the gene level and at the level of individual observations, respectively.</p>
      <p id="Par27">Limma methods were selected out of a collection of tools for DE analysis. First, limma-trend and voom were top performers for scRNA-Seq data demonstrated by a recent benchmarking study [<xref ref-type="bibr" rid="CR18">18</xref>]. Secondly, the linear models of limma enabled complex design. Additionally, we benchmarked limma with other top performers (MAST [<xref ref-type="bibr" rid="CR34">34</xref>] and edgeR [<xref ref-type="bibr" rid="CR35">35</xref>]) in a simulated dataset confounded by batch effects. MAST uses a hurdle model of a two-part generalized linear model, aiming to model the bimodality expression pattern of zero-inflated scRNA-Seq data, while edgeR fits the coefficients and the dispersion parameters using the negative binomial distribution. In our benchmarking experiment, the limma methods detected the signal-to-noise better than MAST and edgeR, and its computing speed was much faster (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1A, B), which was consistent with previous results [<xref ref-type="bibr" rid="CR33">33</xref>]. Moreover, limma-trend was faster than voom, because voom has an additional step of inferring variance at the level of individual observations. Limma-trend was recommended when the runtime is a major concern, while voom may perform slightly better when library sizes are unequal [<xref ref-type="bibr" rid="CR33">33</xref>].</p>
      <p id="Par28">IDER is aimed to measure inter-group similarity. In the scenario of multiple batches, IDER first compares two groups, <italic>g</italic><sub><italic>i</italic></sub> and <italic>g</italic><sub><italic>j</italic></sub><italic>’</italic>, with the background, i.e., cells that do not belong to <italic>g</italic><sub><italic>i</italic></sub> and <italic>g</italic><sub><italic>j</italic></sub><italic>’</italic>, respectively (Fig. <xref rid="Fig1" ref-type="fig">1</xref>A). For each comparison, the DE analysis is performed with the linear regression including covariates of group (<italic>g</italic><sub><italic>i</italic></sub>, <italic>g</italic><sub><italic>j</italic></sub><italic>’</italic>, and background), batch, and scaled cellular detection rate. The cellular detection rate measures the number of genes detected per cell as previously described [<xref ref-type="bibr" rid="CR34">34</xref>]. After the estimated coefficients are computed, the DE signature, vector <italic>d</italic><sub><italic>i</italic></sub>, for group <italic>g</italic><sub><italic>i</italic></sub> (or <italic>d</italic><sub><italic>j</italic></sub><italic>’</italic> for group <italic>g</italic><sub><italic>j</italic></sub><italic>’</italic>) is computed by fitting the contrast of <italic>g</italic><sub><italic>i</italic></sub> – background (or <italic>g</italic><sub><italic>j</italic></sub><italic>’</italic> – background). The length of <italic>d</italic><sub><italic>i</italic></sub> or <italic>d</italic><sub><italic>j</italic></sub><italic>’</italic> is equal to the number of genes used. The DE signature is denoted by the estimated coefficients, i.e., log<sub>2</sub> fold-change. Between the two groups, <italic>g</italic><sub><italic>i</italic></sub> and <italic>g</italic><sub><italic>j</italic></sub><italic>’</italic>, the similarity <italic>s(g</italic><sub><italic>i</italic></sub><italic>, g</italic><sub><italic>j</italic></sub><italic>’)</italic> is measured by the Pearson correlation coefficients between DE signatures, <italic>d</italic><sub><italic>i</italic></sub> and <italic>d</italic><sub><italic>j</italic></sub><italic>’</italic>. This similarity measure ranges from −1 to 1. IDER can also be used to measure inter-group similarity for data with multiple levels of confounding factors. Under this circumstance, the additional covariates were included as a covariate in the regression model. For example, in the breast cancer data (Dataset 6), both the donor effect and the treatment effect were included in the regression model <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {E}_{ij k}={C}_{j,{z}_{ik}}+{B}_{jk}+{T}_{ij}+{R}_i $$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2021_2561_Article_IEq1.gif"/></alternatives></inline-formula>, where <italic>E</italic><sub><italic>ijk</italic></sub> denotes the expression level of gene <italic>j</italic> in cell <italic>i</italic> of donor <italic>k</italic>, <italic>z</italic><sub><italic>ik</italic></sub> cell assignment of cells of cell <italic>i</italic>, <italic>C</italic> cluster effect, <italic>B</italic> donor effect, <italic>T</italic> treatment effect, and <italic>R</italic> cellular detection rate.</p>
    </sec>
    <sec id="Sec11">
      <title>CIDER for identifying cell populations</title>
      <p id="Par29">To cluster multi-batch data, CIDER consists of three steps: initial clustering, computing the similarity matrix, and final clustering. For dnCIDER, we first used Louvain clustering to cluster cells within each batch. Pairs of batch-specific clusters with high similarity of IDER were merged, generating the initial clusters for the next step. For asCIDER, we concatenated the batch tag and the cell annotation as the initial cluster. Next, to generate the similarity matrix, the pairwise similarity was computed for inter-batch initial clusters by IDER. We downsampled each initial cluster to the same size (35 to 50 cells). We do not suggest downsampling to a number smaller than 15. For initial clusters smaller than this size, we allowed replacement for sampling. To visualize the similarity among initial clusters, this similarity matrix was transferred to a graph by using igraph in R (<ext-link ext-link-type="uri" xlink:href="https://igraph.org/r/">https://igraph.org/r/</ext-link>). In the final clustering step, the similarity matrix <bold><italic>S</italic></bold> was transferred to a distance matrix by 1 − <bold><italic>S</italic></bold> and the initial clusters were merged by the hierarchical agglomerative clustering with complete linkage, enabling the initial clusters with the highest similarity to be merged first. For large datasets, parallel computation (R package doParallel) was used to shorten the runtime.</p>
      <sec id="Sec12">
        <title>Interpretability</title>
        <p id="Par30">To measure the influence of individual genes on the inter-group similarity, the correlation <italic>r</italic><sub><italic>i</italic></sub> of only leaving gene <italic>i</italic> out was calculated and the Fisher <italic>z</italic>-transformation <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \frac{1}{2}\mathit{\ln}\left(\frac{1+{r}_i}{1-{r}_i}\right) $$\end{document}</tex-math><mml:math id="M4" display="inline"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo mathvariant="italic">ln</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2021_2561_Article_IEq2.gif"/></alternatives></inline-formula> was taken, which transformed the sample distribution of the correlation coefficients to the Gaussian distribution. The influence was computed as <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \frac{1}{2}\mathit{\ln}\left(\frac{1+r}{1-r}\right)-\frac{1}{2}\mathit{\ln}\left(\frac{1+{r}_i}{1-{r}_i}\right) $$\end{document}</tex-math><mml:math id="M6" display="inline"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo mathvariant="italic">ln</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo mathvariant="italic">ln</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2021_2561_Article_IEq3.gif"/></alternatives></inline-formula>, where <italic>r</italic> denotes the correlation including all genes.</p>
      </sec>
      <sec id="Sec13">
        <title>Downstream analysis of marker genes</title>
        <p id="Par31">We used limma-voom to identify the marker genes. For Dataset 3, clustering results, batch information, and the cellular detection rate were used to construct the design matrix. The linear model was first fitted for the given design matrix, and then the estimated coefficients were computed for the contrasts between the target cluster and the background. Empirical Bayes statistics were calculated. Expression of the top marker genes with Benjamini-Hochberg-adjusted <italic>p</italic> values lower than 1.83 × 10<sup>−18</sup> and log<sub>2</sub> fold-changes over 1.47 were visualized using the function DotPlot from Seurat.</p>
      </sec>
    </sec>
    <sec id="Sec14">
      <title>External data</title>
      <sec id="Sec15">
        <title>Cell line data (Dataset 1) [<xref ref-type="bibr" rid="CR19">19</xref>]</title>
        <p id="Par32">We obtained the data of 293T cells and Jurkat cells from <ext-link ext-link-type="uri" xlink:href="http://scanorama.csail.mit.edu/data.tar.gz">http://scanorama.csail.mit.edu/data.tar.gz</ext-link> [<xref ref-type="bibr" rid="CR8">8</xref>]. This dataset came from three batches. The first batch has only 293T cells, the second batch only Jurkat cells, and the third batch 1:1 mixture of these two cell lines.</p>
      </sec>
      <sec id="Sec16">
        <title>Human PBMC data (Dataset 3) [<xref ref-type="bibr" rid="CR19">19</xref>]</title>
        <p id="Par33">This dataset contains 14,876 cells of human PBMC samples from two platforms (10x 3’ and 10x 5’). The raw count matrix and the sample information were downloaded from <ext-link ext-link-type="uri" xlink:href="https://hub.docker.com/r/jinmiaochenlab/batch-effect-removal-benchmarking">https://hub.docker.com/r/jinmiaochenlab/batch-effect-removal-benchmarking</ext-link>, which were curated in the recent benchmarking study [<xref ref-type="bibr" rid="CR15">15</xref>]. Cells were annotated [<xref ref-type="bibr" rid="CR20">20</xref>]. Cells with at least 500 genes detected were kept for further analysis. Putative doublets were filtered by DoubletFinder [<xref ref-type="bibr" rid="CR36">36</xref>] for each batch. The first 10 PCs were used for clustering analysis. The resolution of Louvain clustering was 0.4.</p>
      </sec>
      <sec id="Sec17">
        <title>Cross-species pancreatic data (Dataset 4) [<xref ref-type="bibr" rid="CR21">21</xref>]</title>
        <p id="Par34">The count matrix and sample information were downloaded from NCBI GEO accession GSE84133. We kept cells with minimum 500 genes detected for downstream analysis. Doublets were filtered by DoubletFinder. The gene set shared by both the human and the mouse was kept for downstream analysis. The human gene <italic>INS</italic> was treated as the mouse gene <italic>Ins1</italic> as previously described [<xref ref-type="bibr" rid="CR9">9</xref>].</p>
      </sec>
      <sec id="Sec18">
        <title>COVID-19 data (Dataset 5) [<xref ref-type="bibr" rid="CR22">22</xref>]</title>
        <p id="Par35">The 10x data were downloaded from GSE149689, and the cell annotations were downloaded from <ext-link ext-link-type="uri" xlink:href="https://junglab.wixsite.com/home/db-link">https://junglab.wixsite.com/home/db-link</ext-link>.</p>
      </sec>
      <sec id="Sec19">
        <title>Breast cancer data (Dataset 6) [<xref ref-type="bibr" rid="CR23">23</xref>]</title>
        <p id="Par36">The count matrix and cell annotations were downloaded from <ext-link ext-link-type="uri" xlink:href="https://lambrechtslab.sites.vib.be/en/single-cell">https://lambrechtslab.sites.vib.be/en/single-cell</ext-link>. Cells were cataloged into eight cell types, namely cancer cell, myeloid, T cell, pDC, fibroblast, endothelial, B cell, and mast. Putative doublets were filtered by DoubletFinder [<xref ref-type="bibr" rid="CR36">36</xref>] for each batch.</p>
      </sec>
      <sec id="Sec20">
        <title>Human dendritic data (Dataset 7) [<xref ref-type="bibr" rid="CR24">24</xref>]</title>
        <p id="Par37">The data were downloaded from <ext-link ext-link-type="uri" xlink:href="https://hub.docker.com/r/jinmiaochenlab/batch-effect-removal-benchmarking">https://hub.docker.com/r/jinmiaochenlab/batch-effect-removal-benchmarking</ext-link> [<xref ref-type="bibr" rid="CR15">15</xref>]. The data contained four cell subtypes (CD141, CD1C, DoubleNeg, and pDC) from two batches [<xref ref-type="bibr" rid="CR24">24</xref>]. The raw count matrix and the sample information were also downloaded from the curated set [<xref ref-type="bibr" rid="CR15">15</xref>]. Cells with less than 500 genes detected were removed.</p>
      </sec>
      <sec id="Sec21">
        <title>Mouse hematopoietic progenitor data (Dataset 8) [<xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR26">26</xref>]</title>
        <p id="Par38">The data were downloaded from <ext-link ext-link-type="uri" xlink:href="https://hub.docker.com/r/jinmiaochenlab/batch-effect-removal-benchmarking">the</ext-link> curated set [<xref ref-type="bibr" rid="CR15">15</xref>] and contain three cell populations, named CMP, GMP, and MEP, sequenced by two platforms (MARS-seq and Smart-seq). CMP was recognized as the direct ancestor of GMP and MEP.</p>
      </sec>
    </sec>
    <sec id="Sec22">
      <title>Integration pipelines</title>
      <sec id="Sec23">
        <title>Seurat CCA and RPCA</title>
        <p id="Par39">We used the recommended CCA and RPCA correction pipelines of Seurat v4.0.3 [<xref ref-type="bibr" rid="CR9">9</xref>]. We first split objects by batches, followed by normalization and selection of HVGs based on the relationship between mean and variance. The integration anchors were identified to integrate the data. The corrected low-dimensional representation was used for Louvain clustering.</p>
      </sec>
      <sec id="Sec24">
        <title>fastMNN</title>
        <p id="Par40">We used scran v1.14.5 to identify HVGs, which were used as the input of fastMNN (R package batchelor v1.2.4) [<xref ref-type="bibr" rid="CR6">6</xref>]. The fastMNN-corrected low-dimensional representation was used for Louvain clustering.</p>
      </sec>
      <sec id="Sec25">
        <title>Scanorama</title>
        <p id="Par41">We used Scanorama [<xref ref-type="bibr" rid="CR8">8</xref>] via reticulate v1.16 in R as suggested by the Scanorama repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/brianhie/scanorama">https://github.com/brianhie/scanorama</ext-link>). The corrected embedding was used for Louvain clustering.</p>
      </sec>
      <sec id="Sec26">
        <title>Harmony</title>
        <p id="Par42">We used the RunHarmony function of Harmony v1.0 [<xref ref-type="bibr" rid="CR11">11</xref>] to perform integration and used the first 15 corrected PCs as the input of Louvain clustering with the resolution of 0.4.</p>
      </sec>
      <sec id="Sec27">
        <title>LIGER</title>
        <p id="Par43">We used rliger v1.0.0 [<xref ref-type="bibr" rid="CR12">12</xref>]. The Seurat object was first converted to the Liger object, followed by normalization, HVG selection, scaling, integrative non-negative matrix factorization, construction of the shared factor neighborhood graph, and the Louvain clustering.</p>
      </sec>
      <sec id="Sec28">
        <title>Combat</title>
        <p id="Par44">We used R package sva v3.34.0 [<xref ref-type="bibr" rid="CR13">13</xref>]. The count matrix was log<sub>2</sub> transformed and corrected by the Combat function. The corrected expression matrix was used as the scaled data for the HVG selection, PCA computing, and Louvain clustering. The downsampling factor of Dataset 6 was 3.</p>
      </sec>
      <sec id="Sec29">
        <title>Conos</title>
        <p id="Par45">R packages conos v1.4.2 [<xref ref-type="bibr" rid="CR14">14</xref>], SeuratWrappers v0.3.0, and pagoda2 v1.0.5 were used. The data were first split by the batch variable and preprocessed by the Seurat pipeline. The joint graph was built in the PCA space, and then, the cell clusters were identified as communities in the joint graph.</p>
      </sec>
      <sec id="Sec30">
        <title>Monocle3</title>
        <p id="Par46">We used monocle3 v1.0.0 [<xref ref-type="bibr" rid="CR10">10</xref>] for preprocessing, dimension reduction, batch effect removal [<xref ref-type="bibr" rid="CR6">6</xref>], and clustering [<xref ref-type="bibr" rid="CR37">37</xref>].</p>
      </sec>
    </sec>
    <sec id="Sec31">
      <title>Clustering pipelines</title>
      <sec id="Sec32">
        <title>Seurat Louvain clustering</title>
        <p id="Par47">We used the suggested pipeline of Seurat v3.1.5 [<xref ref-type="bibr" rid="CR5">5</xref>]. The top 2000 HVGs were used to compute PCs, while the first fourteen PCs were used for Louvain clustering with the resolution of 0.4.</p>
      </sec>
      <sec id="Sec33">
        <title>SC3</title>
        <p id="Par48">We used SC3 v1.14.0 [<xref ref-type="bibr" rid="CR3">3</xref>]. The number of clusters based on ground truth was given to the clustering function. The downsampling factor of Datasets 5 and 6 was five.</p>
      </sec>
      <sec id="Sec34">
        <title>RaceID</title>
        <p id="Par49">We used the suggested pipeline of RaceID v0.1.9 [<xref ref-type="bibr" rid="CR4">4</xref>], including filterdata, getfdata, compdist, and clustexp. The number of clusters based on ground truth was given to the clustering function. As the SingleCellExperiment object that SC3 and RaceID depended on consumed a substantial amount of memory, the data were downsampled for Datasets 5 and 6 before applying SC3 and RaceID. The downsampling factor of Datasets 5 and 6 was five.</p>
      </sec>
    </sec>
    <sec id="Sec35">
      <title>Proof-of-concept analysis</title>
      <p id="Par50">The cell line dataset (Dataset 1) was corrected by Scanorama as previously described [<xref ref-type="bibr" rid="CR8">8</xref>]. The first two components of <italic>t</italic>-SNE were used to perform Hierarchical DBSCAN (R package dbscan v1.1) with the minimum size of clusters set at 75. The output of DBSCAN and the batch information were combined to generate initial clusters. The Scanorama correction was used here as the ground truth, as its correctness has been demonstrated previously [<xref ref-type="bibr" rid="CR8">8</xref>]. The initial clusters were downsampled to the size of 50 cells. The IDER-based similarity matrix was computed among the initial clusters to demonstrate the ability to capture biological variance.</p>
    </sec>
    <sec id="Sec36">
      <title>Data simulation</title>
      <p id="Par51">We used Splatter v1.10.0 [<xref ref-type="bibr" rid="CR38">38</xref>] to simulate scRNA-Seq data. We first simulated a dataset with five groups and three batches and removed groups 4 and 5 from batch 1, groups 1 and 5 from batch 2, and groups 1 and 3 from batch 3. This generated the non-overlapped scenario (Dataset 2). The replications were generated in the same way with various seed values.</p>
    </sec>
    <sec id="Sec37">
      <title>Benchmarking clustering performance</title>
      <p id="Par52">The adjusted Rand index (ARI) was used to measure the consistency between clustering results and ground truth.</p>
      <sec id="Sec38">
        <title>ARI<sub>population</sub></title>
        <p id="Par53">We calculated the ARI between clustering results and the annotation of cell populations, termed ARI<sub>population</sub>. It indicates the accuracy of identifying cell populations.</p>
      </sec>
      <sec id="Sec39">
        <title>1-ARI<sub>batch</sub></title>
        <p id="Par54">We also computed the ARI between clustering outcome and the annotation of batches, termed ARI<sub>batch</sub>. It represents the confounding effects of batches. Therefore, a larger value of 1-ARI<sub>batch</sub> indicates that the clustering result is less confounded by batch effects.</p>
      </sec>
      <sec id="Sec40">
        <title>Runtime</title>
        <p id="Par55">The runtime was tested on a Linux server with a maximum number of cores of 16. Given that CIDER needed to compute pairwise similarity, the runtime of CIDER was approximately <italic>O</italic>(<italic>n</italic><sup>2</sup>), where <italic>n</italic> denotes the number of batch-specific initial clusters. It was also positively associated with the covariates and the number of genes included in the regression.</p>
      </sec>
    </sec>
    <sec id="Sec41">
      <title>CIDER for evaluating integration</title>
      <p id="Par56">In this evaluation workflow, the batch-corrected low-dimensional representation was first used to partition cells into multi-batch clusters. These multi-batch clusters were further divided into batch-specific subclusters. Within each cluster, the inter-group similarity was calculated between subclusters from a pair of batches, while the batch effects were regressed out by using the IDER metric. Higher levels of inter-group similarity indicated better quality of integration for the cluster. For two batch-specific subclusters from the same cluster, we could estimate the probability of whether they come from a true biological population (either cell type, subtype, or state). To estimate the probability, we assumed that the two mutual nearest batch-specific groups with the highest similarity are from the same population (“mutual nearest neighbor” hypothesis) and that the variability within a given biological population is at an almost constant level (“constant variability” hypothesis). By further partitioning the combination of these two batch-specific subclusters, we could get a distribution of the variability within this merged cluster. An empirical probability was next calculated for each pair of subclusters from the same cluster to indicate the probability of belonging to the same population.</p>
      <p id="Par57">The cLISI metric, computed by R package lisi [<xref ref-type="bibr" rid="CR11">11</xref>], was used to validate the similarity and the empirical probability calculated by CIDER. LISI measures the population diversity within the neighbors of a given cell, and the neighborhoods are defined by Gaussian kernel-based distributions. Here, cLISI was calculated as the LISI between the ground-truth annotations of cell populations in the batch-corrected <italic>t</italic>-SNE space.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec42">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2021_2561_MOESM1_ESM.docx">
            <caption>
              <p>
                <bold>Additional file 1: Fig. S1-S7 and Table S1.</bold>
              </p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2021_2561_MOESM2_ESM.docx">
            <caption>
              <p><bold>Additional file 2.</bold> Review history.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Professor Eui-Cheol Shin for kindly providing the data. We thank the Computational Biology Research Group (CBRG) at the MRC Weatherall Institute of Molecular Medicine for providing their technical support and resources.</p>
    <sec id="FPar1">
      <title>Review history</title>
      <p id="Par58">The review history is available as Additional file <xref rid="MOESM2" ref-type="media">2</xref>.</p>
    </sec>
    <sec id="FPar2">
      <title>Peer review information</title>
      <p id="Par59">Wenjing She was the primary editor of this article and managed its editorial process and peer review in collaboration with the rest of the editorial team.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>ZH and CY conceived of the idea and designed experiments. ZH implemented the software and performed experiments. ZH, AAA, and CY all contributed to the writing of the paper. The authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>ZH was supported by the Oxford NIHR Biomedical Research Centre and acknowledges the support of the China Scholarship Council—Nuffield Department of Medicine Scholarships (Ref: GAF1516_CSCUO_839316) from the China Scholarship Council (on behalf of the Chinese Ministry of Education) and the University of Oxford. AAA was supported by Ovarian Cancer Action and Oxford National Institute for Health Research Biomedical Research Centre (IS-BRC-1215-20008). CY is supported by a UKRI-EPSRC Turing AI Fellowship (EP/V023233/1), the UK Medical Research Council (MR/L001411/1, MR/P02646X/2), and the Alan Turing Institute under EPSRC grant EP/N510129/1.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>Raw data are available from SRA under accession number SRP073767 [<xref ref-type="bibr" rid="CR19">19</xref>]; GEO under accession numbers GSE84133 [<xref ref-type="bibr" rid="CR21">21</xref>], GSE149689 [<xref ref-type="bibr" rid="CR22">22</xref>], GSE94820 [<xref ref-type="bibr" rid="CR24">24</xref>], GSE81682 [<xref ref-type="bibr" rid="CR25">25</xref>], and GSE72857 [<xref ref-type="bibr" rid="CR26">26</xref>]; and the European Genome-phenome Archive (EGA) under accession number EGAD00001006608 [<xref ref-type="bibr" rid="CR23">23</xref>]. Analysis scripts of this work are deposited on GitHub <ext-link ext-link-type="uri" xlink:href="https://github.com/zhiyhu/CIDER-paper">https://github.com/zhiyhu/CIDER-paper</ext-link> [<xref ref-type="bibr" rid="CR39">39</xref>] and Zenodo <ext-link ext-link-type="uri" xlink:href="https://urldefense.com/v3/__https:/zenodo.org/record/5715956__;!!NLFGqXoFfo8MMQ!5wDMSgeVSmNKRWusvF_4avlgfY72fXSLctxrF2KDAf-6IbIMT389cI9lu2YZpGkZhiZAXsc$">https://zenodo.org/record/5715956</ext-link> [<xref ref-type="bibr" rid="CR40">40</xref>]. The R package CIDER is available at GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/zhiyhu/CIDER">https://github.com/zhiyhu/CIDER</ext-link>) [<xref ref-type="bibr" rid="CR41">41</xref>] and Zenodo <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/5716025">https://zenodo.org/record/5716025</ext-link> [<xref ref-type="bibr" rid="CR42">42</xref>]. The R package CIDER has also been deposited at CRAN (<ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=CIDER">https://CRAN.R-project.org/package=CIDER</ext-link>).</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar3">
      <title>Ethics approval and consent to participate</title>
      <p id="Par60">Not applicable.</p>
    </notes>
    <notes id="FPar4" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par61">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rozenblatt-Rosen</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Stubbington</surname>
            <given-names>MJT</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>The Human Cell Atlas: from vision to reality</article-title>
        <source>Nature.</source>
        <year>2017</year>
        <volume>550</volume>
        <issue>7677</issue>
        <fpage>451</fpage>
        <lpage>453</lpage>
        <pub-id pub-id-type="doi">10.1038/550451a</pub-id>
        <?supplied-pmid 29072289?>
        <pub-id pub-id-type="pmid">29072289</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tian</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Dong</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Freytag</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lê Cao</surname>
            <given-names>K-A</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>JalalAbadi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Amann-Zalcenstein</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Weber</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Seidi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Jabbari</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Naik</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Ritchie</surname>
            <given-names>ME</given-names>
          </name>
        </person-group>
        <article-title>Benchmarking single cell RNA-sequencing analysis pipelines using mixture control experiments</article-title>
        <source>Nat Meth. Nature Publishing Group</source>
        <year>2019</year>
        <volume>16</volume>
        <issue>6</issue>
        <fpage>479</fpage>
        <lpage>487</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0425-8</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kiselev</surname>
            <given-names>VY</given-names>
          </name>
          <name>
            <surname>Kirschner</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Schaub</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Andrews</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Yiu</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Chandra</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Natarajan</surname>
            <given-names>KN</given-names>
          </name>
          <name>
            <surname>Reik</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Barahona</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Hemberg</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>SC3: consensus clustering of single-cell RNA-seq data</article-title>
        <source>Nat Meth.</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>5</issue>
        <fpage>483</fpage>
        <lpage>486</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4236</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Herman</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>Sagar, Grün D. FateID infers cell fate bias in multipotent progenitors from single-cell RNA-seq data. Nat Meth</article-title>
        <source>Nature Publishing Group</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>379</fpage>
        <lpage>386</lpage>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Farrell</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Gennert</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Schier</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Spatial reconstruction of single-cell gene expression data</article-title>
        <source>Nat. Biotechnol. Nature Research</source>
        <year>2015</year>
        <volume>33</volume>
        <issue>5</issue>
        <fpage>495</fpage>
        <lpage>U206</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3192</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lun</surname>
            <given-names>ATL</given-names>
          </name>
          <name>
            <surname>Morgan</surname>
            <given-names>MD</given-names>
          </name>
        </person-group>
        <article-title>Batch effects in single-cell RNA-sequencing data are corrected by matching mutual nearest neighbors</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2018</year>
        <volume>36</volume>
        <fpage>421</fpage>
        <lpage>427</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4091</pub-id>
        <pub-id pub-id-type="pmid">29608177</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cao</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Spielmann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Qiu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Ibrahim</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Mundlos</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Christiansen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Steemers</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Shendure</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>The single-cell transcriptional landscape of mammalian organogenesis</article-title>
        <source>Nature.</source>
        <year>2019</year>
        <volume>566</volume>
        <issue>7745</issue>
        <fpage>496</fpage>
        <lpage>502</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-0969-x</pub-id>
        <?supplied-pmid 30787437?>
        <pub-id pub-id-type="pmid">30787437</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hie</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Bryson</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Berger</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Efficient integration of heterogeneous single-cell transcriptomes using Scanorama</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2019</year>
        <volume>37</volume>
        <issue>6</issue>
        <fpage>685</fpage>
        <lpage>691</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-019-0113-3</pub-id>
        <?supplied-pmid 31061482?>
        <pub-id pub-id-type="pmid">31061482</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Stuart T, Butler A, Hafemeister C, Mauck WM, Hao Y, Stoeckius M, et al. Comprehensive integration of single-cell data. Cell. 2019;177:1888–1902.e21.</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">Hao Y, Hao S, Andersen-Nissen E, Mauck WM, Zheng S, Butler A, et al. Integrated analysis of multimodal single-cell data. Cell. 2021;184:3573–3587.e29.</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Korsunsky</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Millard</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Slowikowski</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Baglaenko</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Brenner</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Loh</surname>
            <given-names>PR</given-names>
          </name>
          <name>
            <surname>Raychaudhuri</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Fast, sensitive and accurate integration of single-cell data with Harmony</article-title>
        <source>Nat Meth.</source>
        <year>2019</year>
        <volume>16</volume>
        <issue>12</issue>
        <fpage>1289</fpage>
        <lpage>1296</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0619-0</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Welch JD, Kozareva V, Ferreira A, Vanderburg C, Martin C, Macosko EZ. Single-cell multi-omic integration compares and contrasts features of brain cell identity. Cell. Elsevier Inc; 2019;177:1873–1887.e17.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Johnson</surname>
            <given-names>WE</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Rabinovic</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Adjusting batch effects in microarray expression data using empirical Bayes methods</article-title>
        <source>Biostatistics.</source>
        <year>2007</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>118</fpage>
        <lpage>127</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxj037</pub-id>
        <?supplied-pmid 16632515?>
        <pub-id pub-id-type="pmid">16632515</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barkas</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Petukhov</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Nikolaeva</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Lozinsky</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Demharter</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Khodosevich</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kharchenko</surname>
            <given-names>PV</given-names>
          </name>
        </person-group>
        <article-title>Joint analysis of heterogeneous single-cell RNA-seq dataset collections</article-title>
        <source>Nat Meth.</source>
        <year>2019</year>
        <volume>16</volume>
        <issue>8</issue>
        <fpage>695</fpage>
        <lpage>698</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0466-z</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tran</surname>
            <given-names>HTN</given-names>
          </name>
          <name>
            <surname>Ang</surname>
            <given-names>KS</given-names>
          </name>
          <name>
            <surname>Chevrier</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>NYS</given-names>
          </name>
          <name>
            <surname>Goh</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A benchmark of batch-effect correction methods for single-cell RNA sequencing data</article-title>
        <source>Genome Biol</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>1</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1850-9</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Artibani</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Alsaadi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wietek</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Morotti</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Zhong</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Santana Gonzalez</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>el-Sahhar</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>KaramiNejadRanjbar</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mallett</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Masuda</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Chong</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Damato</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dhar</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Campo</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Garruto Campanile</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Soleymani majd</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Rai</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Maldonado-Perez</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cerundolo</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Sauka-Spengler</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Yau</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ahmed</surname>
            <given-names>AA</given-names>
          </name>
        </person-group>
        <article-title>The repertoire of serous ovarian cancer non-genetic heterogeneity revealed by single-cell sequencing of normal fallopian tube epithelial cells</article-title>
        <source>Cancer Cell.</source>
        <year>2020</year>
        <volume>37</volume>
        <issue>2</issue>
        <fpage>226</fpage>
        <lpage>227</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ccell.2020.01.003</pub-id>
        <?supplied-pmid 32049047?>
        <pub-id pub-id-type="pmid">32049047</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Ritchie ME, Phipson B, Wu D, Hu Y, Law CW, Shi W, et al. limma powers differential expression analyses for RNA-sequencing and microarray studies. Nucleic Acids Res. 2015;43:e47.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Soneson</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
        </person-group>
        <article-title>Bias, robustness and scalability in single-cell differential expression analysis</article-title>
        <source>Nat Meth.</source>
        <year>2018</year>
        <volume>18</volume>
        <issue>4</issue>
        <fpage>735</fpage>
        <lpage>261</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4612</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>GXY</given-names>
          </name>
          <name>
            <surname>Terry</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Belgrader</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ryvkin</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Bent</surname>
            <given-names>ZW</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ziraldo</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Wheeler</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>McDermott</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gregory</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Shuga</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Montesclaros</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Underwood</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Masquelier</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Nishimura</surname>
            <given-names>SY</given-names>
          </name>
          <name>
            <surname>Schnall-Levin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wyatt</surname>
            <given-names>PW</given-names>
          </name>
          <name>
            <surname>Hindson</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Bharadwaj</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ness</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Beppu</surname>
            <given-names>LW</given-names>
          </name>
          <name>
            <surname>Deeg</surname>
            <given-names>HJ</given-names>
          </name>
          <name>
            <surname>McFarland</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Loeb</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Valente</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Ericson</surname>
            <given-names>NG</given-names>
          </name>
          <name>
            <surname>Stevens</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Radich</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Mikkelsen</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Hindson</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Bielas</surname>
            <given-names>JH</given-names>
          </name>
        </person-group>
        <article-title>Massively parallel digital transcriptional profiling of single cells</article-title>
        <source>Nature Communications.</source>
        <year>2017</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>14049</fpage>
        <pub-id pub-id-type="doi">10.1038/ncomms14049</pub-id>
        <?supplied-pmid 28091601?>
        <pub-id pub-id-type="pmid">28091601</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Polanski</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Miao</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>KB</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>J-E</given-names>
          </name>
        </person-group>
        <article-title>BBKNN: fast batch alignment of single cell transcriptomes</article-title>
        <source>Bioinformatics.</source>
        <year>2020</year>
        <volume>36</volume>
        <issue>3</issue>
        <fpage>964</fpage>
        <lpage>965</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btz625</pub-id>
        <?supplied-pmid 31400197?>
        <pub-id pub-id-type="pmid">31400197</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <mixed-citation publication-type="other">Baron M, Veres A, Wolock SL, Faust AL, Gaujoux R, Vetere A, et al. A single-cell transcriptomic map of the human and mouse pancreas reveals inter- and intra-cell population structure. Cell Syst. 2016;3:346–360.e4.</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Lee JS, Park S, Jeong HW, Ahn JY, Choi SJ, Lee H, et al. Immunophenotyping of COVID-19 and influenza highlights the role of type I interferons in development of severe COVID-19. Sci Immunol. 2020;5:eabd1554.</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bassez</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vos</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Van Dyck</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Floris</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Arijs</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Desmedt</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A single-cell map of intratumoral changes during anti-PD1 treatment of patients with breast cancer</article-title>
        <source>Nat. Med.</source>
        <year>2021</year>
        <volume>27</volume>
        <issue>5</issue>
        <fpage>820</fpage>
        <lpage>832</lpage>
        <pub-id pub-id-type="doi">10.1038/s41591-021-01323-8</pub-id>
        <?supplied-pmid 33958794?>
        <pub-id pub-id-type="pmid">33958794</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Villani A-C, Satija R, Reynolds G, Sarkizova S, Shekhar K, Fletcher J, et al. Single-cell RNA-seq reveals new types of human blood dendritic cells, monocytes, and progenitors. Science. 2017;356(6335). 10.1126/science.aah4573.</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nestorowa</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hamey</surname>
            <given-names>FK</given-names>
          </name>
          <name>
            <surname>Pijuan Sala</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Diamanti</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Shepherd</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Laurenti</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>NK</given-names>
          </name>
          <name>
            <surname>Kent</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Göttgens</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>A single-cell resolution map of mouse hematopoietic stem and progenitor cell differentiation</article-title>
        <source>Blood.</source>
        <year>2016</year>
        <volume>128</volume>
        <issue>8</issue>
        <fpage>e20</fpage>
        <lpage>e31</lpage>
        <pub-id pub-id-type="doi">10.1182/blood-2016-05-716480</pub-id>
        <?supplied-pmid 27365425?>
        <pub-id pub-id-type="pmid">27365425</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paul</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Arkin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Giladi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Jaitin</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Kenigsberg</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Keren-Shaul</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcriptional heterogeneity and lineage commitment in myeloid progenitors</article-title>
        <source>Cell.</source>
        <year>2016</year>
        <volume>164</volume>
        <issue>1-2</issue>
        <fpage>325</fpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.12.046</pub-id>
        <?supplied-pmid 28915372?>
        <pub-id pub-id-type="pmid">28915372</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Fan J, Lee H-O, Lee S, Ryu D-E, Lee S, Xue C, et al. Linking transcriptional and genetic tumor heterogeneity through allele analysis of single-cell RNA-seq data. Cold Spring Harbor Lab; 2018;:gr.228080.117.</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van der Wijst</surname>
            <given-names>MGP</given-names>
          </name>
          <name>
            <surname>Brugge</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>de Vries</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Deelen</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Swertz</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>LifeLines Cohort Study, et al. Single-cell RNA sequencing identifies celltype-specific cis-eQTLs and co-expression QTLs</article-title>
        <source>Nat Genet.</source>
        <year>2018</year>
        <volume>50</volume>
        <issue>4</issue>
        <fpage>493</fpage>
        <lpage>497</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-018-0089-9</pub-id>
        <?supplied-pmid 29610479?>
        <pub-id pub-id-type="pmid">29610479</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Zappia L, Theis FJ. Over 1000 tools reveal trends in the single-cell RNA-seq analysis landscape. bioRxiv. Cold Spring Harbor Laboratory; 2021;:2021.08.13.456196.</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">Lotfollahi M, Naghipourfar M, Luecken MD, Khajavi M, Büttner M, Wagenstetter M, et al. Mapping single-cell data to reference atlases by transfer learning. Nat. Biotechnol. 2021.</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Argelaguet</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Arnol</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Bredikhin</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Deloro</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Velten</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Stegle</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>MOFA+: a statistical framework for comprehensive integration of multi-modal single-cell data</article-title>
        <source>Genome Biol.</source>
        <year>2020</year>
        <volume>21</volume>
        <issue>1</issue>
        <fpage>111</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-020-02015-1</pub-id>
        <?supplied-pmid 32393329?>
        <pub-id pub-id-type="pmid">32393329</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Efremova</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>Computational methods for single-cell omics across modalities</article-title>
        <source>Nat Meth. Nature Publishing Group</source>
        <year>2020</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>14</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0692-4</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <mixed-citation publication-type="other">Law CW, Chen Y, Shi W, Smyth GK. voom: precision weights unlock linear model analysis tools for RNA-seq read counts. Genome Biol. BioMed Central; 2014;15:R29.</mixed-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Finak</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>McDavid</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yajima</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gersuk</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Shalek</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Slichter</surname>
            <given-names>CK</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>HW</given-names>
          </name>
          <name>
            <surname>McElrath</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Prlic</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Linsley</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Gottardo</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>MAST: a flexible statistical framework for assessing transcriptional changes and characterizing heterogeneity in single-cell RNA sequencing data</article-title>
        <source>Genome Biol.</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>278</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-015-0844-5</pub-id>
        <?supplied-pmid 26653891?>
        <pub-id pub-id-type="pmid">26653891</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>Differential expression analysis of multifactor RNA-Seq experiments with respect to biological variation</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2012</year>
        <volume>40</volume>
        <issue>10</issue>
        <fpage>4288</fpage>
        <lpage>4297</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks042</pub-id>
        <?supplied-pmid 22287627?>
        <pub-id pub-id-type="pmid">22287627</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <mixed-citation publication-type="other">McGinnis CS, Murrow LM, Gartner ZJ. DoubletFinder: doublet detection in single-cell RNA sequencing data using artificial nearest neighbors. Cell Syst. 2019;8:329–337.e4.</mixed-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Levine</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Simonds</surname>
            <given-names>EF</given-names>
          </name>
          <name>
            <surname>Bendall</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>KL</given-names>
          </name>
          <name>
            <surname>Amir</surname>
            <given-names>E-AD</given-names>
          </name>
          <name>
            <surname>Tadmor</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Litvin</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Fienberg</surname>
            <given-names>HG</given-names>
          </name>
          <name>
            <surname>Jager</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zunder</surname>
            <given-names>ER</given-names>
          </name>
          <name>
            <surname>Finck</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gedman</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Radtke</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Downing</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Pe’er</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Nolan</surname>
            <given-names>GP</given-names>
          </name>
        </person-group>
        <article-title>Data-driven phenotypic dissection of AML reveals progenitor-like cells that correlate with prognosis</article-title>
        <source>Cell.</source>
        <year>2015</year>
        <volume>162</volume>
        <issue>1</issue>
        <fpage>184</fpage>
        <lpage>197</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.05.047</pub-id>
        <?supplied-pmid 26095251?>
        <pub-id pub-id-type="pmid">26095251</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <mixed-citation publication-type="other">Zappia L, Phipson B, Oshlack A. Splatter: simulation of single-cell RNA sequencing data. Genome Biol. BioMed Central. 2017;18(1). 10.1186/s13059-017-1305-0.</mixed-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <mixed-citation publication-type="other">Hu Z, Yau C, Ahmed A. CIDER: an interpretable meta-clustering framework for single-cell RNA-seq data integration and evaluation. Github. <ext-link ext-link-type="uri" xlink:href="https://github.com/zhiyhu/CIDER-paper">https://github.com/zhiyhu/CIDER-paper</ext-link>. 2021.</mixed-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <mixed-citation publication-type="other">Hu Z, Yau C, Ahmed A. CIDER: an interpretable meta-clustering framework for single-cell RNA-seq data integration and evaluation. Zenodo. <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/5715956">https://zenodo.org/record/5715956</ext-link>. 2021.</mixed-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <mixed-citation publication-type="other">Hu Z, Yau C, Ahmed A. R package CIDER. Github. <ext-link ext-link-type="uri" xlink:href="https://github.com/zhiyhu/CIDER">https://github.com/zhiyhu/CIDER</ext-link>. 2021.</mixed-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <mixed-citation publication-type="other">Hu Z, Yau C, Ahmed A. R package CIDER. Zenodo. <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/5716025">https://zenodo.org/record/5716025</ext-link>. 2021.</mixed-citation>
    </ref>
  </ref-list>
</back>
