<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10918629</article-id>
    <article-id pub-id-type="pmid">38377398</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btae098</article-id>
    <article-id pub-id-type="publisher-id">btae098</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Data and Text Mining</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>imputomics: web server and R package for missing values imputation in metabolomics data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-5467-018X</contrib-id>
        <name>
          <surname>Chilimoniuk</surname>
          <given-names>Jarosław</given-names>
        </name>
        <aff><institution>Clinical Research Centre, Medical University of Białystok</institution>, Białystok, <country country="PL">Poland</country></aff>
        <xref rid="btae098-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-2581-7722</contrib-id>
        <name>
          <surname>Grzesiak</surname>
          <given-names>Krystyna</given-names>
        </name>
        <aff><institution>Clinical Research Centre, Medical University of Białystok</institution>, Białystok, <country country="PL">Poland</country></aff>
        <aff><institution>Faculty of Mathematics and Computer Science, University of Wrocław</institution>, Wrocław, <country country="PL">Poland</country></aff>
        <xref rid="btae098-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-7187-6988</contrib-id>
        <name>
          <surname>Kała</surname>
          <given-names>Jakub</given-names>
        </name>
        <aff><institution>Clinical Research Centre, Medical University of Białystok</institution>, Białystok, <country country="PL">Poland</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-3515-4320</contrib-id>
        <name>
          <surname>Nowakowski</surname>
          <given-names>Dominik</given-names>
        </name>
        <aff><institution>Department of Biostatistics and Medical Informatics, Medical University of Białystok</institution>, Białystok, <country country="PL">Poland</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-4522-4978</contrib-id>
        <name>
          <surname>Krętowski</surname>
          <given-names>Adam</given-names>
        </name>
        <aff><institution>Clinical Research Centre, Medical University of Białystok</institution>, Białystok, <country country="PL">Poland</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-8145-579X</contrib-id>
        <name>
          <surname>Kolenda</surname>
          <given-names>Rafał</given-names>
        </name>
        <aff><institution>Quadram Institute Biosciences, Norwich Research Park</institution>, Norwich, <country country="GB">United Kingdom</country></aff>
        <aff><institution>Faculty of Veterinary Medicine, Wrocław University of Environmental and Life Sciences</institution>, Wrocław, <country country="PL">Poland</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-3729-0518</contrib-id>
        <name>
          <surname>Ciborowski</surname>
          <given-names>Michał</given-names>
        </name>
        <aff><institution>Clinical Research Centre, Medical University of Białystok</institution>, Białystok, <country country="PL">Poland</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8926-582X</contrib-id>
        <name>
          <surname>Burdukiewicz</surname>
          <given-names>Michał</given-names>
        </name>
        <aff><institution>Clinical Research Centre, Medical University of Białystok</institution>, Białystok, <country country="PL">Poland</country></aff>
        <aff><institution>Institute of Biotechnology and Biomedicine, Autonomous University of Barcelona</institution>, Cerdanyola del Vallès, <country country="ES">Spain</country></aff>
        <xref rid="btae098-cor1" ref-type="corresp"/>
        <!--michaljan.burdukiewicz@uab.cat-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Wren</surname>
          <given-names>Jonathan</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btae098-cor1">Corresponding author. Institute of Biotechnology and Biomedicine, Universitat Autònoma de Barcelona, 08193 Cerdanyola del Vallès, Barcelona, Spain. E-mail: <email>michaljan.burdukiewicz@uab.cat</email> (M.B.)</corresp>
      <fn id="btae098-FM1">
        <p>Jarosław Chilimoniuk and Krystyna Grzesiak contributed equally to this work.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <month>3</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2024-02-20">
      <day>20</day>
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>20</day>
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <volume>40</volume>
    <issue>3</issue>
    <elocation-id>btae098</elocation-id>
    <history>
      <date date-type="received">
        <day>20</day>
        <month>10</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>26</day>
        <month>1</month>
        <year>2024</year>
      </date>
      <date date-type="editorial-decision">
        <day>09</day>
        <month>2</month>
        <year>2024</year>
      </date>
      <date date-type="accepted">
        <day>19</day>
        <month>2</month>
        <year>2024</year>
      </date>
      <date date-type="corrected-typeset">
        <day>06</day>
        <month>3</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btae098.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Missing values are commonly observed in metabolomics data from mass spectrometry. Imputing them is crucial because it assures data completeness, increases the statistical power of analyses, prevents inaccurate results, and improves the quality of exploratory analysis, statistical modeling, and machine learning. Numerous Missing Value Imputation Algorithms (MVIAs) employ heuristics or statistical models to replace missing information with estimates. In the context of metabolomics data, we identified 52 MVIAs implemented across 70 R functions. Nevertheless, the usage of those 52 established methods poses challenges due to package dependency issues, lack of documentation, and their instability.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Our R package, ‘imputomics’, provides a convenient wrapper around 41 (plus random imputation as a baseline model) out of 52 MVIAs in the form of a command-line tool and a web application. In addition, we propose a novel functionality for selecting MVIAs recommended for metabolomics data with the best performance or execution time.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>‘imputomics’ is freely available as an R package (<ext-link xlink:href="http://github.com/BioGenies/imputomics" ext-link-type="uri">github.com/BioGenies/imputomics</ext-link>) and a Shiny web application (<ext-link xlink:href="http://biogenies.info/imputomics-ws" ext-link-type="uri">biogenies.info/imputomics-ws</ext-link>). The documentation is available at <ext-link xlink:href="http://biogenies.info/imputomics" ext-link-type="uri">biogenies.info/imputomics</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Science Centre</institution>
            <institution-id institution-id-type="DOI">10.13039/501100004281</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>2021/43/O/ST6/02805</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Medical University of Białystok</institution>
          </institution-wrap>
        </funding-source>
        <award-id>B.SUB.23.53</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="4"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Metabolomics is a quickly growing branch of ‘-omics’ studies that focus on the detection of small molecules, known as metabolites, produced by living organisms and biological systems on different levels of the organization. By studying them, researchers can acquire insight into the organism’s phenotype affected by diverse factors such as genetics or diet. Hence, metabolomics has numerous applications, starting with medicine, food sciences, and ending with environmental biology.</p>
    <p>Metabolite detection involves the usage of cutting-edge analytical techniques, such as mass spectrometry (MS) paired with gas or liquid chromatography (<xref rid="btae098-B11" ref-type="bibr">Villas-Bôas <italic toggle="yes">et al.</italic> 2005</xref>, <xref rid="btae098-B14" ref-type="bibr">Zampieri <italic toggle="yes">et al.</italic> 2017</xref>). Due to the sheer variability of metabolites, sensitivity of analytical instruments, and high-throughput nature of those techniques, enormous amounts of data are generated. However, technical and biological factors like poor sample quality or instrumental limitations cause the appearance of missing values, hindering subsequent data analysis (<xref rid="btae098-B1" ref-type="bibr">Armitage <italic toggle="yes">et al.</italic> 2015</xref>).</p>
    <p>Ignoring missing values is problematic because it leads to the loss of valuable information and can result in erroneous conclusions, ultimately decreasing the credibility and utility of data analysis. However, addressing missing values may be equally problematic, as each type of missing data requires specific consideration and handling methods, such as data imputation. In general, there are three types of missing value patterns. Missing completely at random (MCAR), when missing values are due to random errors and stochastic fluctuations during the data acquisition process, such as incomplete derivation or ionization. Missing at random (MAR) assumes that other observed variables determine the possibility of missing a variable. Missing not at random (MNAR), is considered for censored missing values, that are caused by the limit of detection (LOD) of a device (<xref rid="btae098-B8" ref-type="bibr">Rubin 1976</xref>, <xref rid="btae098-B5" ref-type="bibr">Karpievitch <italic toggle="yes">et al.</italic> 2012</xref>). In most real-world scenarios, it is expected to encounter mixtures of at least two types of missing data patterns.</p>
    <p>The importance of this issue led the metabolomics community to use existing or introduce new missing value imputation algorithms (MVIAs), which replace the missing value with its estimate. Our extensive literature review (<xref rid="sup1" ref-type="supplementary-material">Supplementary data SI1</xref>) revealed that 52 MVIAs proposed for metabolomics data are implemented in 70 R functions (<xref rid="sup1" ref-type="supplementary-material">Supplementary data SI2</xref>) and described in 20 articles. Moreover, the most robust web server for missing data imputation in metabolomics, MetImp (<xref rid="btae098-B12" ref-type="bibr">Wei <italic toggle="yes">et al.</italic> 2018</xref>), covers only 10 out of 52 proposed MVIAs (19.23%).</p>
    <p>Nonetheless, such a wide range of diverse methods imposes new challenges. The maintenance level and implementation quality of available MVIAs differs from algorithm to algorithm, leading to problems with usage, stability, and reproducibility. The latter is also affected by the lack of common standards (e.g. the presence of hard-coded random seeds). Moreover, the usage of some MVIAs is hindered by their specific environment requirements that are hard to reproduce by less R-fluent users.</p>
    <p>In response to the complexities introduced by the multitude of MVIAs and the challenges they pose, we recognized the need for a streamlined and user-friendly solution. We have developed an R package ‘imputomics’, which contains a comprehensive set of imputation methods while providing a unified and intuitive programming interface. It aims to simplify the imputation process for researchers by reducing the burden of managing package dependencies, enhance code maintainability, and help in selecting appropriate MVIAs. Furthermore, to make data imputation more accessible, we have established an ‘imputomics’ web application. It facilitates not only missingness analysis, data imputation, and diagnosis of the imputed data but also allows users to leverage insights from our benchmark comparing the performance of MVIAs. Based on the benchmark results, users can confidently choose the best-performing or fastest methods that align with their specific research needs.</p>
  </sec>
  <sec>
    <title>2 Implementation</title>
    <p>First, we have gathered a collection of articles related to MVIAs in metabolomics research (collection, curation, and extraction pipeline can be seen in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). We have selected the MVIAs written in R and used for metabolomics data imputation. We have also added (with permission of the authors) two MVIAs that were already proposed but never shared publicly (<xref rid="btae098-B9" ref-type="bibr">Shah <italic toggle="yes">et al.</italic> 2019</xref>). In addition to that, we brought back to CRAN implementations of MVIAs that were removed due to the lack of maintenance (<xref rid="btae098-B7" ref-type="bibr">Perry <italic toggle="yes">et al.</italic> 2023</xref>). Additionally, we have implemented random imputation (imputation using random numbers within the variable’s range) as a baseline for performance comparison with other MVIAs. Finally, ‘imputomics’ package contains 41 (plus random imputation as a baseline MVIA) out of the 52 identified MVIAs. We excluded a total of 11 methods due to at least one of the following reasons:</p>
    <list list-type="bullet">
      <list-item>
        <p>The code does not work without significant alterations, even for default data.</p>
      </list-item>
      <list-item>
        <p>MVIA requires additional information such as spectrum peaks or class labels.</p>
      </list-item>
      <list-item>
        <p>The exact package or function is not specified in the associated research paper.</p>
      </list-item>
      <list-item>
        <p>At least one of the columns has to contain no missing values.</p>
      </list-item>
      <list-item>
        <p>Besides imputation, MVIA modifies non-missing data points.</p>
      </list-item>
    </list>
    <p>The list of removed methods, citations, and references to the code can be found in <xref rid="sup1" ref-type="supplementary-material">Supplementary data SI1.1</xref>. This approach ensures that all methods in the ‘imputomics’ package have the same scope and application.</p>
    <p>One of the main goals of our study was also to enhance the reproducibility of MVIAs. Thus, we have created a stable environment for computations using the ‘renv’ R package (<xref rid="btae098-B10" ref-type="bibr">Ushey and Wickham 2023</xref>), which isolates project dependencies, minimizing the risk of conflicts and ensuring consistency. Moreover, for computational safety and convenience, we have implemented individualized wrapper functions for each MVIAs. Each wrapper is tailored to perform the following tasks:</p>
    <list list-type="order">
      <list-item>
        <p>Uniformity: The wrapper function ensures that all imputing functions accept and return ‘data.frames’ (and, by extension, ‘tibbles’) to ensure the tidy data processing (<xref rid="btae098-B13" ref-type="bibr">Wickham <italic toggle="yes">et al.</italic> 2019</xref>). We also revert all other changes introduced by the original imputing functions irrelevant to the missing data imputation, such as the change of column names or transposition of original data. Moreover, we designed all helper functions (e.g. scaling) only to accept ‘data.frames’.</p>
      </list-item>
      <list-item>
        <p>Input data verification: Our wrapper functions automatically check for the presence of missing values in the form of ‘Not Available’ (NAs) or zeros/ones within the data (these numbers are commonly used in metabolomics to denote missing values). We also ensure that the provided input data consists exclusively of numeric, non-negative values. In addition, we perform additional data integrity checks if the authors of MVIA advise them but do not implement them in their original function.</p>
      </list-item>
      <list-item>
        <p>Passing arguments to function calls: The wrapper ensures that relevant arguments are appropriately passed to the underlying imputation functions while keeping the default values from the original implementations. If we alter the default behavior of the function (e.g. by removing a predefined random seed), this information is marked in the documentation. To prevent unnecessary screen prompts produced during the imputation, each function is additionally enhanced with the boolean ‘verbose’ argument.</p>
      </list-item>
    </list>
    <p>To facilitate evaluation and testing of imputing functions, ‘imputomics’ also possesses amputation functions allowing building synthetic datasets containing missing MCAR, MAR, and MNAR values as well as their mixtures. These functions were tailored to simulate real-life situations occurring in metabolomics data as LODs (<xref rid="sup1" ref-type="supplementary-material">Supplementary data SI3.2</xref>).</p>
    <p>Profiting from having a robust wrapper over MVIAs, we created a user-friendly web application based on the shiny framework (<xref rid="btae098-B2" ref-type="bibr">Chang <italic toggle="yes">et al.</italic> 2024</xref>). Our tool enables less R-fluent researchers to impute missing values in their datasets. In addition, it provides graphical methods to examine the input data (<xref rid="btae098-F1" ref-type="fig">Fig. 1A</xref>) and inspect the distribution of imputed data (explained in <xref rid="sup1" ref-type="supplementary-material">Supplementary data SI8</xref>) (<xref rid="btae098-F1" ref-type="fig">Fig. 1B</xref>). The ‘imputomics’ shiny application is available as a web server (<ext-link xlink:href="http://biogenies.info/imputomics-ws" ext-link-type="uri">biogenies.info/imputomics-ws</ext-link>). The R package and its detailed installation guide can be found at <ext-link xlink:href="http://github.com/BioGenies/imputomics" ext-link-type="uri">github.com/BioGenies/imputomics</ext-link>.</p>
    <fig position="float" id="btae098-F1">
      <label>Figure 1.</label>
      <caption>
        <p>(A) A graphical representation of missing values in a preliminary analysis of dataset. (B) Distribution of imputed data compared to the observed data. (C) Occurrence of MVIAs (missing value imputation algorithms). Filled squares mark the presence of a given MVIA. The right-hand side annotations represent the number of MVIAs covered by a given article. The top annotations represent the articles covering a given MVIA. (D) Normalized root mean squared error (NRMSE) of MVIAs. The vertical line marks the baseline MVIA: random imputation. As the NRMSE for PEMM exceeded <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mn>6.03</mml:mn><mml:mo>×</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mn>16</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, this MVIA is not represented on the chart. (E) The maximum time [ms] necessary to impute missing values. Both in (D) and (E), the color of the bars marks the percentage of datasets on which an MVIA converged successfully in under 2 min.</p>
      </caption>
      <graphic xlink:href="btae098f1" position="float"/>
    </fig>
    <p>To further guide users of our web application, we attempted to determine which methods deliver the most accurate imputation or exhibit the highest speed based on existing literature. However, there is no definitive answer to that question. The most extensive benchmark of MVIAs for assessing the accuracy, execution time, and computational stability (<xref rid="btae098-B3" ref-type="bibr">Davis <italic toggle="yes">et al.</italic> 2022</xref>) covers only 18 algorithms, which is 34.62% of all considered MVIAs (<xref rid="btae098-F1" ref-type="fig">Fig. 1C</xref>) and 25.71% of all considered implementations (<xref rid="sup1" ref-type="supplementary-material">Supplementary data SI2</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). Therefore, to assist users in choosing the most suitable MVIA from a wide array of available methods, we have decided to conduct a benchmark to showcase their performance.</p>
    <p>To evaluate the performance of MVIAs, we ran them with their default parameters in all 230 scenarios (10 missing values patterns <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mo>×</mml:mo></mml:math></inline-formula> 23 different-sized datasets). During our preliminary assessment, we noticed that MVIAs either converged quite fast or were imputing data endlessly, so we decided to limit the computation time to two minutes per single run of the MVIA code. Each MVIA was executed three times, if the attempt failed to impute MV in each of the three approaches, we marked it as not working for a given scenario (<xref rid="sup1" ref-type="supplementary-material">Supplementary data SI3.3</xref>). To assess the imputation quality, we utilized the normalized root mean squared error (NRMSE). The NRMSE is a widely accepted measure for quantifying the accuracy of imputed data, as it is not sensitive to heteroscedasticity among the variables, allowing for relative error assessment (<xref rid="sup1" ref-type="supplementary-material">Supplementary data SI4</xref>) (<xref rid="btae098-B6" ref-type="bibr">Oba <italic toggle="yes">et al.</italic> 2003</xref>).</p>
    <p>Furthermore, to assist users of our web server in selecting the most suitable method for their dataset, we introduced the option to choose methods that demonstrated the best performance in simulations—in terms of speed, overall effectiveness, and suitability for specific missing value patterns (i.e. MCAR, MAR, and MNAR).</p>
  </sec>
  <sec>
    <title>3 Results and conclusions</title>
    <p>‘imputomics’ stands as the most comprehensive R package for the imputation of missing data in R, encompassing 42 MVIAs. It represents an effort to bridge the gap between the richness of available methods and the practical usability of these techniques, making advanced data imputation accessible to a broader spectrum of researchers in the field of metabolomics.</p>
    <p>The instant accessibility of multiple MVIAs enables the choice of MVIAs based on the covariate distribution and the missing value pattern. However, we warn potential users against selecting the method to support a preconceived hypothesis. The choice of the optimal MVIA should happen <italic toggle="yes">a priori</italic> or result from an understanding of the data structure. To guide such choices, our simulation results provide a more comprehensive understanding of the performance of various MVIA implementations depending on the type of missingness and the data dimensionality.</p>
    <p>Out of 42 MVIA implementations, 17 (40.48%) would not consistently succeed in every scenario (<xref rid="btae098-F1" ref-type="fig">Fig. 1D</xref>). It is important to emphasize that 25.53% of errors are attributed to instances where convergence failed to occur within the defined timeout. This instability can sometimes be attributed to running MVIAs implementations with default parameters. However, this outcome holds significance for users who do not intend to fine-tune their missing value imputation pipeline or seek a robust solution that offers relatively swift imputation. Among the most stable algorithms, the top performers include EM from the R package missMDA (<xref rid="btae098-B4" ref-type="bibr">Josse and Husson 2016</xref>), and KNN-EU (<xref rid="btae098-B9" ref-type="bibr">Shah <italic toggle="yes">et al.</italic> 2019</xref>), both achieving NRMSE values lower than 0.5. Eight MVIAs implementations (19.05%) failed to surpass the baseline model, which, in our case, involves imputation by a random number (<xref rid="btae098-F1" ref-type="fig">Fig. 1D</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary data SI5</xref>). Depending on the type of missing data (MCAR, MAR, and, resulting from LOD, MNAR), different MVIAs respectively had the best performance: Random Forest (as implemented in MetabImpute) (<xref rid="btae098-B3" ref-type="bibr">Davis <italic toggle="yes">et al.</italic> 2022</xref>), missMDA (<xref rid="btae098-B4" ref-type="bibr">Josse and Husson 2016</xref>), and min (as implemented in MetabImpute or ‘imputomics’ packages) (<xref rid="sup1" ref-type="supplementary-material">Supplementary data SI6</xref>).</p>
    <p>The benchmarked MVIAs exhibit considerable diversity in their evaluation times (<xref rid="btae098-F1" ref-type="fig">Fig. 1E</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary data SI5</xref>). Interestingly, there is no significant correlation between the performance of MVIAs implementations and their computation time (<italic toggle="yes">P</italic>-value: 0.13, Spearman’s correlation coefficient: −0.31).</p>
    <p>Looking ahead, we anticipate ‘imputomics’ to streamline and tidy up the complicated landscape of the missing value imputation in R. We consider metabolomics as an appropriate starting point to extend our package to cover also MVIAs proposed for other branches of ‘-omics’. Presently, both ‘imputomics’ R package and web application for the first time provide easy and robust access to the majority of MVIAs implemented in R.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btae098_Supplementary_Data</label>
      <media xlink:href="btae098_supplementary_data.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We want to thank the Clinical Research Centre (Medical University of Białystok) members for fruitful discussions. The study was supported by the Ministry of Education and Science funds within the project ‘Excellence Initiative—Research University’. We also acknowledge the Center for Artificial Intelligence at the Medical University of Białystok (funded by the Ministry of Health of the Republic of Poland). Also, we want to express our gratitude to the authors of all MVIAs included in our article and Małgorzata Bogdan (University of Wrocław) for fruitful discussions.</p>
  </ack>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the National Science Centre [2021/43/O/ST6/02805 to K.G.]; and the Medical University of Białystok grant [B.SUB.23.53 to M.C.].</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The data underlying this article are available in the article and in its online supplementary material.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btae098-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Armitage</surname><given-names>EG</given-names></string-name>, <string-name><surname>Godzien</surname><given-names>J</given-names></string-name>, <string-name><surname>Alonso-Herranz</surname><given-names>V</given-names></string-name></person-group><etal>et al</etal><article-title>Missing value imputation strategies for metabolomics data</article-title>. <source>Electrophoresis</source><year>2015</year>;<volume>36</volume>:<fpage>3050</fpage>–<lpage>60</lpage>.<pub-id pub-id-type="pmid">26376450</pub-id></mixed-citation>
    </ref>
    <ref id="btae098-B2">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Chang</surname><given-names>W</given-names></string-name>, <string-name><surname>Cheng</surname><given-names>J</given-names></string-name>, <string-name><surname>Allaire</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><italic toggle="yes">Shiny: Web Application Framework for R</italic>, <year>2024</year>. <ext-link xlink:href="https://github.com/rstudio/shiny" ext-link-type="uri">https://github.com/rstudio/shiny</ext-link>.</mixed-citation>
    </ref>
    <ref id="btae098-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Davis</surname><given-names>TJ</given-names></string-name>, <string-name><surname>Firzli</surname><given-names>TR</given-names></string-name>, <string-name><surname>Higgins Keppler</surname><given-names>EA</given-names></string-name></person-group><etal>et al</etal><article-title>Addressing missing data in GC <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mo>×</mml:mo></mml:math></inline-formula> GC metabolomics: identifying missingness type and evaluating the impact of imputation methods on experimental replication</article-title>. <source>Anal Chem</source><year>2022</year>;<volume>94</volume>:<fpage>10912</fpage>–<lpage>20</lpage>.<pub-id pub-id-type="pmid">35881554</pub-id></mixed-citation>
    </ref>
    <ref id="btae098-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Josse</surname><given-names>J</given-names></string-name>, <string-name><surname>Husson</surname><given-names>F.</given-names></string-name></person-group><article-title>missMDA: a package for handling missing values in multivariate data analysis</article-title>. <source>J Stat Soft</source><year>2016</year>;<volume>70</volume>:<fpage>1</fpage>–<lpage>31</lpage>.</mixed-citation>
    </ref>
    <ref id="btae098-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Karpievitch</surname><given-names>YV</given-names></string-name>, <string-name><surname>Dabney</surname><given-names>AR</given-names></string-name>, <string-name><surname>Smith</surname><given-names>RD</given-names></string-name></person-group><etal>et al</etal><article-title>Normalization and missing value imputation for label-free LC-MS analysis</article-title>. <source>BMC Bioinformatics</source><year>2012</year>;<volume>13</volume>:<fpage>S5</fpage>.</mixed-citation>
    </ref>
    <ref id="btae098-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Oba</surname><given-names>S</given-names></string-name>, <string-name><surname>Sato</surname><given-names>M-A</given-names></string-name>, <string-name><surname>Takemasa</surname><given-names>I</given-names></string-name></person-group><etal>et al</etal><article-title>A Bayesian missing value estimation method for gene expression profile data</article-title>. <source>Bioinformatics </source><year>2003</year>;<volume>19</volume>:<fpage>2088</fpage>–<lpage>96</lpage>.<pub-id pub-id-type="pmid">14594714</pub-id></mixed-citation>
    </ref>
    <ref id="btae098-B7">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Perry</surname><given-names>PO</given-names></string-name>, <string-name><surname>Najibi</surname><given-names>SM</given-names></string-name>, <string-name><surname>Burdukiewicz</surname><given-names>M</given-names></string-name></person-group>. bcv: Cross-Validation for the SVD (Bi-Cross-Validation), <year>2023</year>. <ext-link xlink:href="https://cran.r-project.org/package=bcv" ext-link-type="uri">https://cran.r-project.org/package=bcv</ext-link>.</mixed-citation>
    </ref>
    <ref id="btae098-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rubin</surname><given-names>DB.</given-names></string-name></person-group><article-title>Inference and missing data</article-title>. <source>Biometrika</source><year>1976</year>;<volume>63</volume>:<fpage>581</fpage>–<lpage>92</lpage>.</mixed-citation>
    </ref>
    <ref id="btae098-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shah</surname><given-names>J</given-names></string-name>, <string-name><surname>Brock</surname><given-names>GN</given-names></string-name>, <string-name><surname>Gaskins</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>BayesMetab: treatment of missing values in metabolomic studies using a Bayesian modeling approach</article-title>. <source>BMC Bioinformatics</source><year>2019</year>;<volume>20</volume>:<fpage>673</fpage>.<pub-id pub-id-type="pmid">31861984</pub-id></mixed-citation>
    </ref>
    <ref id="btae098-B10">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Ushey</surname><given-names>K</given-names></string-name>, <string-name><surname>Wickham</surname><given-names>H.</given-names></string-name></person-group><italic toggle="yes">renv: Project Environments</italic>, <year>2023</year>. <ext-link xlink:href="https://rstudio.github.io/renv/" ext-link-type="uri">https://rstudio.github.io/renv/</ext-link>.</mixed-citation>
    </ref>
    <ref id="btae098-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Villas-Bôas</surname><given-names>SG</given-names></string-name>, <string-name><surname>Mas</surname><given-names>S</given-names></string-name>, <string-name><surname>Akesson</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Mass spectrometry in metabolome analysis</article-title>. <source>Mass Spectrom Rev</source><year>2005</year>;<volume>24</volume>:<fpage>613</fpage>–<lpage>46</lpage>.<pub-id pub-id-type="pmid">15389842</pub-id></mixed-citation>
    </ref>
    <ref id="btae098-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wei</surname><given-names>R</given-names></string-name>, <string-name><surname>Wang</surname><given-names>J</given-names></string-name>, <string-name><surname>Su</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Missing value imputation approach for mass spectrometry-based metabolomics data</article-title>. <source>Sci Rep</source><year>2018</year>;<volume>8</volume>:<fpage>663</fpage>.<pub-id pub-id-type="pmid">29330539</pub-id></mixed-citation>
    </ref>
    <ref id="btae098-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wickham</surname><given-names>H</given-names></string-name>, <string-name><surname>Averick</surname><given-names>M</given-names></string-name>, <string-name><surname>Bryan</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Welcome to the Tidyverse</article-title>. <source>JOSS</source><year>2019</year>;<volume>4</volume>:<fpage>1686</fpage>.</mixed-citation>
    </ref>
    <ref id="btae098-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zampieri</surname><given-names>M</given-names></string-name>, <string-name><surname>Sekar</surname><given-names>K</given-names></string-name>, <string-name><surname>Zamboni</surname><given-names>N</given-names></string-name></person-group><etal>et al</etal><article-title>Frontiers of high-throughput metabolomics</article-title>. <source>Curr Opin Chem Biol</source><year>2017</year>;<volume>36</volume>:<fpage>15</fpage>–<lpage>23</lpage>.<pub-id pub-id-type="pmid">28064089</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10918629</article-id>
    <article-id pub-id-type="pmid">38377398</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btae098</article-id>
    <article-id pub-id-type="publisher-id">btae098</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Data and Text Mining</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>imputomics: web server and R package for missing values imputation in metabolomics data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-5467-018X</contrib-id>
        <name>
          <surname>Chilimoniuk</surname>
          <given-names>Jarosław</given-names>
        </name>
        <aff><institution>Clinical Research Centre, Medical University of Białystok</institution>, Białystok, <country country="PL">Poland</country></aff>
        <xref rid="btae098-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-2581-7722</contrib-id>
        <name>
          <surname>Grzesiak</surname>
          <given-names>Krystyna</given-names>
        </name>
        <aff><institution>Clinical Research Centre, Medical University of Białystok</institution>, Białystok, <country country="PL">Poland</country></aff>
        <aff><institution>Faculty of Mathematics and Computer Science, University of Wrocław</institution>, Wrocław, <country country="PL">Poland</country></aff>
        <xref rid="btae098-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-7187-6988</contrib-id>
        <name>
          <surname>Kała</surname>
          <given-names>Jakub</given-names>
        </name>
        <aff><institution>Clinical Research Centre, Medical University of Białystok</institution>, Białystok, <country country="PL">Poland</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-3515-4320</contrib-id>
        <name>
          <surname>Nowakowski</surname>
          <given-names>Dominik</given-names>
        </name>
        <aff><institution>Department of Biostatistics and Medical Informatics, Medical University of Białystok</institution>, Białystok, <country country="PL">Poland</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-4522-4978</contrib-id>
        <name>
          <surname>Krętowski</surname>
          <given-names>Adam</given-names>
        </name>
        <aff><institution>Clinical Research Centre, Medical University of Białystok</institution>, Białystok, <country country="PL">Poland</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-8145-579X</contrib-id>
        <name>
          <surname>Kolenda</surname>
          <given-names>Rafał</given-names>
        </name>
        <aff><institution>Quadram Institute Biosciences, Norwich Research Park</institution>, Norwich, <country country="GB">United Kingdom</country></aff>
        <aff><institution>Faculty of Veterinary Medicine, Wrocław University of Environmental and Life Sciences</institution>, Wrocław, <country country="PL">Poland</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-3729-0518</contrib-id>
        <name>
          <surname>Ciborowski</surname>
          <given-names>Michał</given-names>
        </name>
        <aff><institution>Clinical Research Centre, Medical University of Białystok</institution>, Białystok, <country country="PL">Poland</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8926-582X</contrib-id>
        <name>
          <surname>Burdukiewicz</surname>
          <given-names>Michał</given-names>
        </name>
        <aff><institution>Clinical Research Centre, Medical University of Białystok</institution>, Białystok, <country country="PL">Poland</country></aff>
        <aff><institution>Institute of Biotechnology and Biomedicine, Autonomous University of Barcelona</institution>, Cerdanyola del Vallès, <country country="ES">Spain</country></aff>
        <xref rid="btae098-cor1" ref-type="corresp"/>
        <!--michaljan.burdukiewicz@uab.cat-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Wren</surname>
          <given-names>Jonathan</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btae098-cor1">Corresponding author. Institute of Biotechnology and Biomedicine, Universitat Autònoma de Barcelona, 08193 Cerdanyola del Vallès, Barcelona, Spain. E-mail: <email>michaljan.burdukiewicz@uab.cat</email> (M.B.)</corresp>
      <fn id="btae098-FM1">
        <p>Jarosław Chilimoniuk and Krystyna Grzesiak contributed equally to this work.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <month>3</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2024-02-20">
      <day>20</day>
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>20</day>
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <volume>40</volume>
    <issue>3</issue>
    <elocation-id>btae098</elocation-id>
    <history>
      <date date-type="received">
        <day>20</day>
        <month>10</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>26</day>
        <month>1</month>
        <year>2024</year>
      </date>
      <date date-type="editorial-decision">
        <day>09</day>
        <month>2</month>
        <year>2024</year>
      </date>
      <date date-type="accepted">
        <day>19</day>
        <month>2</month>
        <year>2024</year>
      </date>
      <date date-type="corrected-typeset">
        <day>06</day>
        <month>3</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btae098.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Missing values are commonly observed in metabolomics data from mass spectrometry. Imputing them is crucial because it assures data completeness, increases the statistical power of analyses, prevents inaccurate results, and improves the quality of exploratory analysis, statistical modeling, and machine learning. Numerous Missing Value Imputation Algorithms (MVIAs) employ heuristics or statistical models to replace missing information with estimates. In the context of metabolomics data, we identified 52 MVIAs implemented across 70 R functions. Nevertheless, the usage of those 52 established methods poses challenges due to package dependency issues, lack of documentation, and their instability.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Our R package, ‘imputomics’, provides a convenient wrapper around 41 (plus random imputation as a baseline model) out of 52 MVIAs in the form of a command-line tool and a web application. In addition, we propose a novel functionality for selecting MVIAs recommended for metabolomics data with the best performance or execution time.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>‘imputomics’ is freely available as an R package (<ext-link xlink:href="http://github.com/BioGenies/imputomics" ext-link-type="uri">github.com/BioGenies/imputomics</ext-link>) and a Shiny web application (<ext-link xlink:href="http://biogenies.info/imputomics-ws" ext-link-type="uri">biogenies.info/imputomics-ws</ext-link>). The documentation is available at <ext-link xlink:href="http://biogenies.info/imputomics" ext-link-type="uri">biogenies.info/imputomics</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Science Centre</institution>
            <institution-id institution-id-type="DOI">10.13039/501100004281</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>2021/43/O/ST6/02805</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Medical University of Białystok</institution>
          </institution-wrap>
        </funding-source>
        <award-id>B.SUB.23.53</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="4"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Metabolomics is a quickly growing branch of ‘-omics’ studies that focus on the detection of small molecules, known as metabolites, produced by living organisms and biological systems on different levels of the organization. By studying them, researchers can acquire insight into the organism’s phenotype affected by diverse factors such as genetics or diet. Hence, metabolomics has numerous applications, starting with medicine, food sciences, and ending with environmental biology.</p>
    <p>Metabolite detection involves the usage of cutting-edge analytical techniques, such as mass spectrometry (MS) paired with gas or liquid chromatography (<xref rid="btae098-B11" ref-type="bibr">Villas-Bôas <italic toggle="yes">et al.</italic> 2005</xref>, <xref rid="btae098-B14" ref-type="bibr">Zampieri <italic toggle="yes">et al.</italic> 2017</xref>). Due to the sheer variability of metabolites, sensitivity of analytical instruments, and high-throughput nature of those techniques, enormous amounts of data are generated. However, technical and biological factors like poor sample quality or instrumental limitations cause the appearance of missing values, hindering subsequent data analysis (<xref rid="btae098-B1" ref-type="bibr">Armitage <italic toggle="yes">et al.</italic> 2015</xref>).</p>
    <p>Ignoring missing values is problematic because it leads to the loss of valuable information and can result in erroneous conclusions, ultimately decreasing the credibility and utility of data analysis. However, addressing missing values may be equally problematic, as each type of missing data requires specific consideration and handling methods, such as data imputation. In general, there are three types of missing value patterns. Missing completely at random (MCAR), when missing values are due to random errors and stochastic fluctuations during the data acquisition process, such as incomplete derivation or ionization. Missing at random (MAR) assumes that other observed variables determine the possibility of missing a variable. Missing not at random (MNAR), is considered for censored missing values, that are caused by the limit of detection (LOD) of a device (<xref rid="btae098-B8" ref-type="bibr">Rubin 1976</xref>, <xref rid="btae098-B5" ref-type="bibr">Karpievitch <italic toggle="yes">et al.</italic> 2012</xref>). In most real-world scenarios, it is expected to encounter mixtures of at least two types of missing data patterns.</p>
    <p>The importance of this issue led the metabolomics community to use existing or introduce new missing value imputation algorithms (MVIAs), which replace the missing value with its estimate. Our extensive literature review (<xref rid="sup1" ref-type="supplementary-material">Supplementary data SI1</xref>) revealed that 52 MVIAs proposed for metabolomics data are implemented in 70 R functions (<xref rid="sup1" ref-type="supplementary-material">Supplementary data SI2</xref>) and described in 20 articles. Moreover, the most robust web server for missing data imputation in metabolomics, MetImp (<xref rid="btae098-B12" ref-type="bibr">Wei <italic toggle="yes">et al.</italic> 2018</xref>), covers only 10 out of 52 proposed MVIAs (19.23%).</p>
    <p>Nonetheless, such a wide range of diverse methods imposes new challenges. The maintenance level and implementation quality of available MVIAs differs from algorithm to algorithm, leading to problems with usage, stability, and reproducibility. The latter is also affected by the lack of common standards (e.g. the presence of hard-coded random seeds). Moreover, the usage of some MVIAs is hindered by their specific environment requirements that are hard to reproduce by less R-fluent users.</p>
    <p>In response to the complexities introduced by the multitude of MVIAs and the challenges they pose, we recognized the need for a streamlined and user-friendly solution. We have developed an R package ‘imputomics’, which contains a comprehensive set of imputation methods while providing a unified and intuitive programming interface. It aims to simplify the imputation process for researchers by reducing the burden of managing package dependencies, enhance code maintainability, and help in selecting appropriate MVIAs. Furthermore, to make data imputation more accessible, we have established an ‘imputomics’ web application. It facilitates not only missingness analysis, data imputation, and diagnosis of the imputed data but also allows users to leverage insights from our benchmark comparing the performance of MVIAs. Based on the benchmark results, users can confidently choose the best-performing or fastest methods that align with their specific research needs.</p>
  </sec>
  <sec>
    <title>2 Implementation</title>
    <p>First, we have gathered a collection of articles related to MVIAs in metabolomics research (collection, curation, and extraction pipeline can be seen in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). We have selected the MVIAs written in R and used for metabolomics data imputation. We have also added (with permission of the authors) two MVIAs that were already proposed but never shared publicly (<xref rid="btae098-B9" ref-type="bibr">Shah <italic toggle="yes">et al.</italic> 2019</xref>). In addition to that, we brought back to CRAN implementations of MVIAs that were removed due to the lack of maintenance (<xref rid="btae098-B7" ref-type="bibr">Perry <italic toggle="yes">et al.</italic> 2023</xref>). Additionally, we have implemented random imputation (imputation using random numbers within the variable’s range) as a baseline for performance comparison with other MVIAs. Finally, ‘imputomics’ package contains 41 (plus random imputation as a baseline MVIA) out of the 52 identified MVIAs. We excluded a total of 11 methods due to at least one of the following reasons:</p>
    <list list-type="bullet">
      <list-item>
        <p>The code does not work without significant alterations, even for default data.</p>
      </list-item>
      <list-item>
        <p>MVIA requires additional information such as spectrum peaks or class labels.</p>
      </list-item>
      <list-item>
        <p>The exact package or function is not specified in the associated research paper.</p>
      </list-item>
      <list-item>
        <p>At least one of the columns has to contain no missing values.</p>
      </list-item>
      <list-item>
        <p>Besides imputation, MVIA modifies non-missing data points.</p>
      </list-item>
    </list>
    <p>The list of removed methods, citations, and references to the code can be found in <xref rid="sup1" ref-type="supplementary-material">Supplementary data SI1.1</xref>. This approach ensures that all methods in the ‘imputomics’ package have the same scope and application.</p>
    <p>One of the main goals of our study was also to enhance the reproducibility of MVIAs. Thus, we have created a stable environment for computations using the ‘renv’ R package (<xref rid="btae098-B10" ref-type="bibr">Ushey and Wickham 2023</xref>), which isolates project dependencies, minimizing the risk of conflicts and ensuring consistency. Moreover, for computational safety and convenience, we have implemented individualized wrapper functions for each MVIAs. Each wrapper is tailored to perform the following tasks:</p>
    <list list-type="order">
      <list-item>
        <p>Uniformity: The wrapper function ensures that all imputing functions accept and return ‘data.frames’ (and, by extension, ‘tibbles’) to ensure the tidy data processing (<xref rid="btae098-B13" ref-type="bibr">Wickham <italic toggle="yes">et al.</italic> 2019</xref>). We also revert all other changes introduced by the original imputing functions irrelevant to the missing data imputation, such as the change of column names or transposition of original data. Moreover, we designed all helper functions (e.g. scaling) only to accept ‘data.frames’.</p>
      </list-item>
      <list-item>
        <p>Input data verification: Our wrapper functions automatically check for the presence of missing values in the form of ‘Not Available’ (NAs) or zeros/ones within the data (these numbers are commonly used in metabolomics to denote missing values). We also ensure that the provided input data consists exclusively of numeric, non-negative values. In addition, we perform additional data integrity checks if the authors of MVIA advise them but do not implement them in their original function.</p>
      </list-item>
      <list-item>
        <p>Passing arguments to function calls: The wrapper ensures that relevant arguments are appropriately passed to the underlying imputation functions while keeping the default values from the original implementations. If we alter the default behavior of the function (e.g. by removing a predefined random seed), this information is marked in the documentation. To prevent unnecessary screen prompts produced during the imputation, each function is additionally enhanced with the boolean ‘verbose’ argument.</p>
      </list-item>
    </list>
    <p>To facilitate evaluation and testing of imputing functions, ‘imputomics’ also possesses amputation functions allowing building synthetic datasets containing missing MCAR, MAR, and MNAR values as well as their mixtures. These functions were tailored to simulate real-life situations occurring in metabolomics data as LODs (<xref rid="sup1" ref-type="supplementary-material">Supplementary data SI3.2</xref>).</p>
    <p>Profiting from having a robust wrapper over MVIAs, we created a user-friendly web application based on the shiny framework (<xref rid="btae098-B2" ref-type="bibr">Chang <italic toggle="yes">et al.</italic> 2024</xref>). Our tool enables less R-fluent researchers to impute missing values in their datasets. In addition, it provides graphical methods to examine the input data (<xref rid="btae098-F1" ref-type="fig">Fig. 1A</xref>) and inspect the distribution of imputed data (explained in <xref rid="sup1" ref-type="supplementary-material">Supplementary data SI8</xref>) (<xref rid="btae098-F1" ref-type="fig">Fig. 1B</xref>). The ‘imputomics’ shiny application is available as a web server (<ext-link xlink:href="http://biogenies.info/imputomics-ws" ext-link-type="uri">biogenies.info/imputomics-ws</ext-link>). The R package and its detailed installation guide can be found at <ext-link xlink:href="http://github.com/BioGenies/imputomics" ext-link-type="uri">github.com/BioGenies/imputomics</ext-link>.</p>
    <fig position="float" id="btae098-F1">
      <label>Figure 1.</label>
      <caption>
        <p>(A) A graphical representation of missing values in a preliminary analysis of dataset. (B) Distribution of imputed data compared to the observed data. (C) Occurrence of MVIAs (missing value imputation algorithms). Filled squares mark the presence of a given MVIA. The right-hand side annotations represent the number of MVIAs covered by a given article. The top annotations represent the articles covering a given MVIA. (D) Normalized root mean squared error (NRMSE) of MVIAs. The vertical line marks the baseline MVIA: random imputation. As the NRMSE for PEMM exceeded <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mn>6.03</mml:mn><mml:mo>×</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mn>16</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, this MVIA is not represented on the chart. (E) The maximum time [ms] necessary to impute missing values. Both in (D) and (E), the color of the bars marks the percentage of datasets on which an MVIA converged successfully in under 2 min.</p>
      </caption>
      <graphic xlink:href="btae098f1" position="float"/>
    </fig>
    <p>To further guide users of our web application, we attempted to determine which methods deliver the most accurate imputation or exhibit the highest speed based on existing literature. However, there is no definitive answer to that question. The most extensive benchmark of MVIAs for assessing the accuracy, execution time, and computational stability (<xref rid="btae098-B3" ref-type="bibr">Davis <italic toggle="yes">et al.</italic> 2022</xref>) covers only 18 algorithms, which is 34.62% of all considered MVIAs (<xref rid="btae098-F1" ref-type="fig">Fig. 1C</xref>) and 25.71% of all considered implementations (<xref rid="sup1" ref-type="supplementary-material">Supplementary data SI2</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). Therefore, to assist users in choosing the most suitable MVIA from a wide array of available methods, we have decided to conduct a benchmark to showcase their performance.</p>
    <p>To evaluate the performance of MVIAs, we ran them with their default parameters in all 230 scenarios (10 missing values patterns <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mo>×</mml:mo></mml:math></inline-formula> 23 different-sized datasets). During our preliminary assessment, we noticed that MVIAs either converged quite fast or were imputing data endlessly, so we decided to limit the computation time to two minutes per single run of the MVIA code. Each MVIA was executed three times, if the attempt failed to impute MV in each of the three approaches, we marked it as not working for a given scenario (<xref rid="sup1" ref-type="supplementary-material">Supplementary data SI3.3</xref>). To assess the imputation quality, we utilized the normalized root mean squared error (NRMSE). The NRMSE is a widely accepted measure for quantifying the accuracy of imputed data, as it is not sensitive to heteroscedasticity among the variables, allowing for relative error assessment (<xref rid="sup1" ref-type="supplementary-material">Supplementary data SI4</xref>) (<xref rid="btae098-B6" ref-type="bibr">Oba <italic toggle="yes">et al.</italic> 2003</xref>).</p>
    <p>Furthermore, to assist users of our web server in selecting the most suitable method for their dataset, we introduced the option to choose methods that demonstrated the best performance in simulations—in terms of speed, overall effectiveness, and suitability for specific missing value patterns (i.e. MCAR, MAR, and MNAR).</p>
  </sec>
  <sec>
    <title>3 Results and conclusions</title>
    <p>‘imputomics’ stands as the most comprehensive R package for the imputation of missing data in R, encompassing 42 MVIAs. It represents an effort to bridge the gap between the richness of available methods and the practical usability of these techniques, making advanced data imputation accessible to a broader spectrum of researchers in the field of metabolomics.</p>
    <p>The instant accessibility of multiple MVIAs enables the choice of MVIAs based on the covariate distribution and the missing value pattern. However, we warn potential users against selecting the method to support a preconceived hypothesis. The choice of the optimal MVIA should happen <italic toggle="yes">a priori</italic> or result from an understanding of the data structure. To guide such choices, our simulation results provide a more comprehensive understanding of the performance of various MVIA implementations depending on the type of missingness and the data dimensionality.</p>
    <p>Out of 42 MVIA implementations, 17 (40.48%) would not consistently succeed in every scenario (<xref rid="btae098-F1" ref-type="fig">Fig. 1D</xref>). It is important to emphasize that 25.53% of errors are attributed to instances where convergence failed to occur within the defined timeout. This instability can sometimes be attributed to running MVIAs implementations with default parameters. However, this outcome holds significance for users who do not intend to fine-tune their missing value imputation pipeline or seek a robust solution that offers relatively swift imputation. Among the most stable algorithms, the top performers include EM from the R package missMDA (<xref rid="btae098-B4" ref-type="bibr">Josse and Husson 2016</xref>), and KNN-EU (<xref rid="btae098-B9" ref-type="bibr">Shah <italic toggle="yes">et al.</italic> 2019</xref>), both achieving NRMSE values lower than 0.5. Eight MVIAs implementations (19.05%) failed to surpass the baseline model, which, in our case, involves imputation by a random number (<xref rid="btae098-F1" ref-type="fig">Fig. 1D</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary data SI5</xref>). Depending on the type of missing data (MCAR, MAR, and, resulting from LOD, MNAR), different MVIAs respectively had the best performance: Random Forest (as implemented in MetabImpute) (<xref rid="btae098-B3" ref-type="bibr">Davis <italic toggle="yes">et al.</italic> 2022</xref>), missMDA (<xref rid="btae098-B4" ref-type="bibr">Josse and Husson 2016</xref>), and min (as implemented in MetabImpute or ‘imputomics’ packages) (<xref rid="sup1" ref-type="supplementary-material">Supplementary data SI6</xref>).</p>
    <p>The benchmarked MVIAs exhibit considerable diversity in their evaluation times (<xref rid="btae098-F1" ref-type="fig">Fig. 1E</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary data SI5</xref>). Interestingly, there is no significant correlation between the performance of MVIAs implementations and their computation time (<italic toggle="yes">P</italic>-value: 0.13, Spearman’s correlation coefficient: −0.31).</p>
    <p>Looking ahead, we anticipate ‘imputomics’ to streamline and tidy up the complicated landscape of the missing value imputation in R. We consider metabolomics as an appropriate starting point to extend our package to cover also MVIAs proposed for other branches of ‘-omics’. Presently, both ‘imputomics’ R package and web application for the first time provide easy and robust access to the majority of MVIAs implemented in R.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btae098_Supplementary_Data</label>
      <media xlink:href="btae098_supplementary_data.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We want to thank the Clinical Research Centre (Medical University of Białystok) members for fruitful discussions. The study was supported by the Ministry of Education and Science funds within the project ‘Excellence Initiative—Research University’. We also acknowledge the Center for Artificial Intelligence at the Medical University of Białystok (funded by the Ministry of Health of the Republic of Poland). Also, we want to express our gratitude to the authors of all MVIAs included in our article and Małgorzata Bogdan (University of Wrocław) for fruitful discussions.</p>
  </ack>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the National Science Centre [2021/43/O/ST6/02805 to K.G.]; and the Medical University of Białystok grant [B.SUB.23.53 to M.C.].</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The data underlying this article are available in the article and in its online supplementary material.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btae098-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Armitage</surname><given-names>EG</given-names></string-name>, <string-name><surname>Godzien</surname><given-names>J</given-names></string-name>, <string-name><surname>Alonso-Herranz</surname><given-names>V</given-names></string-name></person-group><etal>et al</etal><article-title>Missing value imputation strategies for metabolomics data</article-title>. <source>Electrophoresis</source><year>2015</year>;<volume>36</volume>:<fpage>3050</fpage>–<lpage>60</lpage>.<pub-id pub-id-type="pmid">26376450</pub-id></mixed-citation>
    </ref>
    <ref id="btae098-B2">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Chang</surname><given-names>W</given-names></string-name>, <string-name><surname>Cheng</surname><given-names>J</given-names></string-name>, <string-name><surname>Allaire</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><italic toggle="yes">Shiny: Web Application Framework for R</italic>, <year>2024</year>. <ext-link xlink:href="https://github.com/rstudio/shiny" ext-link-type="uri">https://github.com/rstudio/shiny</ext-link>.</mixed-citation>
    </ref>
    <ref id="btae098-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Davis</surname><given-names>TJ</given-names></string-name>, <string-name><surname>Firzli</surname><given-names>TR</given-names></string-name>, <string-name><surname>Higgins Keppler</surname><given-names>EA</given-names></string-name></person-group><etal>et al</etal><article-title>Addressing missing data in GC <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mo>×</mml:mo></mml:math></inline-formula> GC metabolomics: identifying missingness type and evaluating the impact of imputation methods on experimental replication</article-title>. <source>Anal Chem</source><year>2022</year>;<volume>94</volume>:<fpage>10912</fpage>–<lpage>20</lpage>.<pub-id pub-id-type="pmid">35881554</pub-id></mixed-citation>
    </ref>
    <ref id="btae098-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Josse</surname><given-names>J</given-names></string-name>, <string-name><surname>Husson</surname><given-names>F.</given-names></string-name></person-group><article-title>missMDA: a package for handling missing values in multivariate data analysis</article-title>. <source>J Stat Soft</source><year>2016</year>;<volume>70</volume>:<fpage>1</fpage>–<lpage>31</lpage>.</mixed-citation>
    </ref>
    <ref id="btae098-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Karpievitch</surname><given-names>YV</given-names></string-name>, <string-name><surname>Dabney</surname><given-names>AR</given-names></string-name>, <string-name><surname>Smith</surname><given-names>RD</given-names></string-name></person-group><etal>et al</etal><article-title>Normalization and missing value imputation for label-free LC-MS analysis</article-title>. <source>BMC Bioinformatics</source><year>2012</year>;<volume>13</volume>:<fpage>S5</fpage>.</mixed-citation>
    </ref>
    <ref id="btae098-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Oba</surname><given-names>S</given-names></string-name>, <string-name><surname>Sato</surname><given-names>M-A</given-names></string-name>, <string-name><surname>Takemasa</surname><given-names>I</given-names></string-name></person-group><etal>et al</etal><article-title>A Bayesian missing value estimation method for gene expression profile data</article-title>. <source>Bioinformatics </source><year>2003</year>;<volume>19</volume>:<fpage>2088</fpage>–<lpage>96</lpage>.<pub-id pub-id-type="pmid">14594714</pub-id></mixed-citation>
    </ref>
    <ref id="btae098-B7">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Perry</surname><given-names>PO</given-names></string-name>, <string-name><surname>Najibi</surname><given-names>SM</given-names></string-name>, <string-name><surname>Burdukiewicz</surname><given-names>M</given-names></string-name></person-group>. bcv: Cross-Validation for the SVD (Bi-Cross-Validation), <year>2023</year>. <ext-link xlink:href="https://cran.r-project.org/package=bcv" ext-link-type="uri">https://cran.r-project.org/package=bcv</ext-link>.</mixed-citation>
    </ref>
    <ref id="btae098-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rubin</surname><given-names>DB.</given-names></string-name></person-group><article-title>Inference and missing data</article-title>. <source>Biometrika</source><year>1976</year>;<volume>63</volume>:<fpage>581</fpage>–<lpage>92</lpage>.</mixed-citation>
    </ref>
    <ref id="btae098-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shah</surname><given-names>J</given-names></string-name>, <string-name><surname>Brock</surname><given-names>GN</given-names></string-name>, <string-name><surname>Gaskins</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>BayesMetab: treatment of missing values in metabolomic studies using a Bayesian modeling approach</article-title>. <source>BMC Bioinformatics</source><year>2019</year>;<volume>20</volume>:<fpage>673</fpage>.<pub-id pub-id-type="pmid">31861984</pub-id></mixed-citation>
    </ref>
    <ref id="btae098-B10">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Ushey</surname><given-names>K</given-names></string-name>, <string-name><surname>Wickham</surname><given-names>H.</given-names></string-name></person-group><italic toggle="yes">renv: Project Environments</italic>, <year>2023</year>. <ext-link xlink:href="https://rstudio.github.io/renv/" ext-link-type="uri">https://rstudio.github.io/renv/</ext-link>.</mixed-citation>
    </ref>
    <ref id="btae098-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Villas-Bôas</surname><given-names>SG</given-names></string-name>, <string-name><surname>Mas</surname><given-names>S</given-names></string-name>, <string-name><surname>Akesson</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Mass spectrometry in metabolome analysis</article-title>. <source>Mass Spectrom Rev</source><year>2005</year>;<volume>24</volume>:<fpage>613</fpage>–<lpage>46</lpage>.<pub-id pub-id-type="pmid">15389842</pub-id></mixed-citation>
    </ref>
    <ref id="btae098-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wei</surname><given-names>R</given-names></string-name>, <string-name><surname>Wang</surname><given-names>J</given-names></string-name>, <string-name><surname>Su</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Missing value imputation approach for mass spectrometry-based metabolomics data</article-title>. <source>Sci Rep</source><year>2018</year>;<volume>8</volume>:<fpage>663</fpage>.<pub-id pub-id-type="pmid">29330539</pub-id></mixed-citation>
    </ref>
    <ref id="btae098-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wickham</surname><given-names>H</given-names></string-name>, <string-name><surname>Averick</surname><given-names>M</given-names></string-name>, <string-name><surname>Bryan</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Welcome to the Tidyverse</article-title>. <source>JOSS</source><year>2019</year>;<volume>4</volume>:<fpage>1686</fpage>.</mixed-citation>
    </ref>
    <ref id="btae098-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zampieri</surname><given-names>M</given-names></string-name>, <string-name><surname>Sekar</surname><given-names>K</given-names></string-name>, <string-name><surname>Zamboni</surname><given-names>N</given-names></string-name></person-group><etal>et al</etal><article-title>Frontiers of high-throughput metabolomics</article-title>. <source>Curr Opin Chem Biol</source><year>2017</year>;<volume>36</volume>:<fpage>15</fpage>–<lpage>23</lpage>.<pub-id pub-id-type="pmid">28064089</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10918629</article-id>
    <article-id pub-id-type="pmid">38377398</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btae098</article-id>
    <article-id pub-id-type="publisher-id">btae098</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Data and Text Mining</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>imputomics: web server and R package for missing values imputation in metabolomics data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-5467-018X</contrib-id>
        <name>
          <surname>Chilimoniuk</surname>
          <given-names>Jarosław</given-names>
        </name>
        <aff><institution>Clinical Research Centre, Medical University of Białystok</institution>, Białystok, <country country="PL">Poland</country></aff>
        <xref rid="btae098-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-2581-7722</contrib-id>
        <name>
          <surname>Grzesiak</surname>
          <given-names>Krystyna</given-names>
        </name>
        <aff><institution>Clinical Research Centre, Medical University of Białystok</institution>, Białystok, <country country="PL">Poland</country></aff>
        <aff><institution>Faculty of Mathematics and Computer Science, University of Wrocław</institution>, Wrocław, <country country="PL">Poland</country></aff>
        <xref rid="btae098-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-7187-6988</contrib-id>
        <name>
          <surname>Kała</surname>
          <given-names>Jakub</given-names>
        </name>
        <aff><institution>Clinical Research Centre, Medical University of Białystok</institution>, Białystok, <country country="PL">Poland</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-3515-4320</contrib-id>
        <name>
          <surname>Nowakowski</surname>
          <given-names>Dominik</given-names>
        </name>
        <aff><institution>Department of Biostatistics and Medical Informatics, Medical University of Białystok</institution>, Białystok, <country country="PL">Poland</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-4522-4978</contrib-id>
        <name>
          <surname>Krętowski</surname>
          <given-names>Adam</given-names>
        </name>
        <aff><institution>Clinical Research Centre, Medical University of Białystok</institution>, Białystok, <country country="PL">Poland</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-8145-579X</contrib-id>
        <name>
          <surname>Kolenda</surname>
          <given-names>Rafał</given-names>
        </name>
        <aff><institution>Quadram Institute Biosciences, Norwich Research Park</institution>, Norwich, <country country="GB">United Kingdom</country></aff>
        <aff><institution>Faculty of Veterinary Medicine, Wrocław University of Environmental and Life Sciences</institution>, Wrocław, <country country="PL">Poland</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-3729-0518</contrib-id>
        <name>
          <surname>Ciborowski</surname>
          <given-names>Michał</given-names>
        </name>
        <aff><institution>Clinical Research Centre, Medical University of Białystok</institution>, Białystok, <country country="PL">Poland</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8926-582X</contrib-id>
        <name>
          <surname>Burdukiewicz</surname>
          <given-names>Michał</given-names>
        </name>
        <aff><institution>Clinical Research Centre, Medical University of Białystok</institution>, Białystok, <country country="PL">Poland</country></aff>
        <aff><institution>Institute of Biotechnology and Biomedicine, Autonomous University of Barcelona</institution>, Cerdanyola del Vallès, <country country="ES">Spain</country></aff>
        <xref rid="btae098-cor1" ref-type="corresp"/>
        <!--michaljan.burdukiewicz@uab.cat-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Wren</surname>
          <given-names>Jonathan</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btae098-cor1">Corresponding author. Institute of Biotechnology and Biomedicine, Universitat Autònoma de Barcelona, 08193 Cerdanyola del Vallès, Barcelona, Spain. E-mail: <email>michaljan.burdukiewicz@uab.cat</email> (M.B.)</corresp>
      <fn id="btae098-FM1">
        <p>Jarosław Chilimoniuk and Krystyna Grzesiak contributed equally to this work.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <month>3</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2024-02-20">
      <day>20</day>
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>20</day>
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <volume>40</volume>
    <issue>3</issue>
    <elocation-id>btae098</elocation-id>
    <history>
      <date date-type="received">
        <day>20</day>
        <month>10</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>26</day>
        <month>1</month>
        <year>2024</year>
      </date>
      <date date-type="editorial-decision">
        <day>09</day>
        <month>2</month>
        <year>2024</year>
      </date>
      <date date-type="accepted">
        <day>19</day>
        <month>2</month>
        <year>2024</year>
      </date>
      <date date-type="corrected-typeset">
        <day>06</day>
        <month>3</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btae098.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Missing values are commonly observed in metabolomics data from mass spectrometry. Imputing them is crucial because it assures data completeness, increases the statistical power of analyses, prevents inaccurate results, and improves the quality of exploratory analysis, statistical modeling, and machine learning. Numerous Missing Value Imputation Algorithms (MVIAs) employ heuristics or statistical models to replace missing information with estimates. In the context of metabolomics data, we identified 52 MVIAs implemented across 70 R functions. Nevertheless, the usage of those 52 established methods poses challenges due to package dependency issues, lack of documentation, and their instability.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Our R package, ‘imputomics’, provides a convenient wrapper around 41 (plus random imputation as a baseline model) out of 52 MVIAs in the form of a command-line tool and a web application. In addition, we propose a novel functionality for selecting MVIAs recommended for metabolomics data with the best performance or execution time.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>‘imputomics’ is freely available as an R package (<ext-link xlink:href="http://github.com/BioGenies/imputomics" ext-link-type="uri">github.com/BioGenies/imputomics</ext-link>) and a Shiny web application (<ext-link xlink:href="http://biogenies.info/imputomics-ws" ext-link-type="uri">biogenies.info/imputomics-ws</ext-link>). The documentation is available at <ext-link xlink:href="http://biogenies.info/imputomics" ext-link-type="uri">biogenies.info/imputomics</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Science Centre</institution>
            <institution-id institution-id-type="DOI">10.13039/501100004281</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>2021/43/O/ST6/02805</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Medical University of Białystok</institution>
          </institution-wrap>
        </funding-source>
        <award-id>B.SUB.23.53</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="4"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Metabolomics is a quickly growing branch of ‘-omics’ studies that focus on the detection of small molecules, known as metabolites, produced by living organisms and biological systems on different levels of the organization. By studying them, researchers can acquire insight into the organism’s phenotype affected by diverse factors such as genetics or diet. Hence, metabolomics has numerous applications, starting with medicine, food sciences, and ending with environmental biology.</p>
    <p>Metabolite detection involves the usage of cutting-edge analytical techniques, such as mass spectrometry (MS) paired with gas or liquid chromatography (<xref rid="btae098-B11" ref-type="bibr">Villas-Bôas <italic toggle="yes">et al.</italic> 2005</xref>, <xref rid="btae098-B14" ref-type="bibr">Zampieri <italic toggle="yes">et al.</italic> 2017</xref>). Due to the sheer variability of metabolites, sensitivity of analytical instruments, and high-throughput nature of those techniques, enormous amounts of data are generated. However, technical and biological factors like poor sample quality or instrumental limitations cause the appearance of missing values, hindering subsequent data analysis (<xref rid="btae098-B1" ref-type="bibr">Armitage <italic toggle="yes">et al.</italic> 2015</xref>).</p>
    <p>Ignoring missing values is problematic because it leads to the loss of valuable information and can result in erroneous conclusions, ultimately decreasing the credibility and utility of data analysis. However, addressing missing values may be equally problematic, as each type of missing data requires specific consideration and handling methods, such as data imputation. In general, there are three types of missing value patterns. Missing completely at random (MCAR), when missing values are due to random errors and stochastic fluctuations during the data acquisition process, such as incomplete derivation or ionization. Missing at random (MAR) assumes that other observed variables determine the possibility of missing a variable. Missing not at random (MNAR), is considered for censored missing values, that are caused by the limit of detection (LOD) of a device (<xref rid="btae098-B8" ref-type="bibr">Rubin 1976</xref>, <xref rid="btae098-B5" ref-type="bibr">Karpievitch <italic toggle="yes">et al.</italic> 2012</xref>). In most real-world scenarios, it is expected to encounter mixtures of at least two types of missing data patterns.</p>
    <p>The importance of this issue led the metabolomics community to use existing or introduce new missing value imputation algorithms (MVIAs), which replace the missing value with its estimate. Our extensive literature review (<xref rid="sup1" ref-type="supplementary-material">Supplementary data SI1</xref>) revealed that 52 MVIAs proposed for metabolomics data are implemented in 70 R functions (<xref rid="sup1" ref-type="supplementary-material">Supplementary data SI2</xref>) and described in 20 articles. Moreover, the most robust web server for missing data imputation in metabolomics, MetImp (<xref rid="btae098-B12" ref-type="bibr">Wei <italic toggle="yes">et al.</italic> 2018</xref>), covers only 10 out of 52 proposed MVIAs (19.23%).</p>
    <p>Nonetheless, such a wide range of diverse methods imposes new challenges. The maintenance level and implementation quality of available MVIAs differs from algorithm to algorithm, leading to problems with usage, stability, and reproducibility. The latter is also affected by the lack of common standards (e.g. the presence of hard-coded random seeds). Moreover, the usage of some MVIAs is hindered by their specific environment requirements that are hard to reproduce by less R-fluent users.</p>
    <p>In response to the complexities introduced by the multitude of MVIAs and the challenges they pose, we recognized the need for a streamlined and user-friendly solution. We have developed an R package ‘imputomics’, which contains a comprehensive set of imputation methods while providing a unified and intuitive programming interface. It aims to simplify the imputation process for researchers by reducing the burden of managing package dependencies, enhance code maintainability, and help in selecting appropriate MVIAs. Furthermore, to make data imputation more accessible, we have established an ‘imputomics’ web application. It facilitates not only missingness analysis, data imputation, and diagnosis of the imputed data but also allows users to leverage insights from our benchmark comparing the performance of MVIAs. Based on the benchmark results, users can confidently choose the best-performing or fastest methods that align with their specific research needs.</p>
  </sec>
  <sec>
    <title>2 Implementation</title>
    <p>First, we have gathered a collection of articles related to MVIAs in metabolomics research (collection, curation, and extraction pipeline can be seen in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). We have selected the MVIAs written in R and used for metabolomics data imputation. We have also added (with permission of the authors) two MVIAs that were already proposed but never shared publicly (<xref rid="btae098-B9" ref-type="bibr">Shah <italic toggle="yes">et al.</italic> 2019</xref>). In addition to that, we brought back to CRAN implementations of MVIAs that were removed due to the lack of maintenance (<xref rid="btae098-B7" ref-type="bibr">Perry <italic toggle="yes">et al.</italic> 2023</xref>). Additionally, we have implemented random imputation (imputation using random numbers within the variable’s range) as a baseline for performance comparison with other MVIAs. Finally, ‘imputomics’ package contains 41 (plus random imputation as a baseline MVIA) out of the 52 identified MVIAs. We excluded a total of 11 methods due to at least one of the following reasons:</p>
    <list list-type="bullet">
      <list-item>
        <p>The code does not work without significant alterations, even for default data.</p>
      </list-item>
      <list-item>
        <p>MVIA requires additional information such as spectrum peaks or class labels.</p>
      </list-item>
      <list-item>
        <p>The exact package or function is not specified in the associated research paper.</p>
      </list-item>
      <list-item>
        <p>At least one of the columns has to contain no missing values.</p>
      </list-item>
      <list-item>
        <p>Besides imputation, MVIA modifies non-missing data points.</p>
      </list-item>
    </list>
    <p>The list of removed methods, citations, and references to the code can be found in <xref rid="sup1" ref-type="supplementary-material">Supplementary data SI1.1</xref>. This approach ensures that all methods in the ‘imputomics’ package have the same scope and application.</p>
    <p>One of the main goals of our study was also to enhance the reproducibility of MVIAs. Thus, we have created a stable environment for computations using the ‘renv’ R package (<xref rid="btae098-B10" ref-type="bibr">Ushey and Wickham 2023</xref>), which isolates project dependencies, minimizing the risk of conflicts and ensuring consistency. Moreover, for computational safety and convenience, we have implemented individualized wrapper functions for each MVIAs. Each wrapper is tailored to perform the following tasks:</p>
    <list list-type="order">
      <list-item>
        <p>Uniformity: The wrapper function ensures that all imputing functions accept and return ‘data.frames’ (and, by extension, ‘tibbles’) to ensure the tidy data processing (<xref rid="btae098-B13" ref-type="bibr">Wickham <italic toggle="yes">et al.</italic> 2019</xref>). We also revert all other changes introduced by the original imputing functions irrelevant to the missing data imputation, such as the change of column names or transposition of original data. Moreover, we designed all helper functions (e.g. scaling) only to accept ‘data.frames’.</p>
      </list-item>
      <list-item>
        <p>Input data verification: Our wrapper functions automatically check for the presence of missing values in the form of ‘Not Available’ (NAs) or zeros/ones within the data (these numbers are commonly used in metabolomics to denote missing values). We also ensure that the provided input data consists exclusively of numeric, non-negative values. In addition, we perform additional data integrity checks if the authors of MVIA advise them but do not implement them in their original function.</p>
      </list-item>
      <list-item>
        <p>Passing arguments to function calls: The wrapper ensures that relevant arguments are appropriately passed to the underlying imputation functions while keeping the default values from the original implementations. If we alter the default behavior of the function (e.g. by removing a predefined random seed), this information is marked in the documentation. To prevent unnecessary screen prompts produced during the imputation, each function is additionally enhanced with the boolean ‘verbose’ argument.</p>
      </list-item>
    </list>
    <p>To facilitate evaluation and testing of imputing functions, ‘imputomics’ also possesses amputation functions allowing building synthetic datasets containing missing MCAR, MAR, and MNAR values as well as their mixtures. These functions were tailored to simulate real-life situations occurring in metabolomics data as LODs (<xref rid="sup1" ref-type="supplementary-material">Supplementary data SI3.2</xref>).</p>
    <p>Profiting from having a robust wrapper over MVIAs, we created a user-friendly web application based on the shiny framework (<xref rid="btae098-B2" ref-type="bibr">Chang <italic toggle="yes">et al.</italic> 2024</xref>). Our tool enables less R-fluent researchers to impute missing values in their datasets. In addition, it provides graphical methods to examine the input data (<xref rid="btae098-F1" ref-type="fig">Fig. 1A</xref>) and inspect the distribution of imputed data (explained in <xref rid="sup1" ref-type="supplementary-material">Supplementary data SI8</xref>) (<xref rid="btae098-F1" ref-type="fig">Fig. 1B</xref>). The ‘imputomics’ shiny application is available as a web server (<ext-link xlink:href="http://biogenies.info/imputomics-ws" ext-link-type="uri">biogenies.info/imputomics-ws</ext-link>). The R package and its detailed installation guide can be found at <ext-link xlink:href="http://github.com/BioGenies/imputomics" ext-link-type="uri">github.com/BioGenies/imputomics</ext-link>.</p>
    <fig position="float" id="btae098-F1">
      <label>Figure 1.</label>
      <caption>
        <p>(A) A graphical representation of missing values in a preliminary analysis of dataset. (B) Distribution of imputed data compared to the observed data. (C) Occurrence of MVIAs (missing value imputation algorithms). Filled squares mark the presence of a given MVIA. The right-hand side annotations represent the number of MVIAs covered by a given article. The top annotations represent the articles covering a given MVIA. (D) Normalized root mean squared error (NRMSE) of MVIAs. The vertical line marks the baseline MVIA: random imputation. As the NRMSE for PEMM exceeded <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mn>6.03</mml:mn><mml:mo>×</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mn>16</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, this MVIA is not represented on the chart. (E) The maximum time [ms] necessary to impute missing values. Both in (D) and (E), the color of the bars marks the percentage of datasets on which an MVIA converged successfully in under 2 min.</p>
      </caption>
      <graphic xlink:href="btae098f1" position="float"/>
    </fig>
    <p>To further guide users of our web application, we attempted to determine which methods deliver the most accurate imputation or exhibit the highest speed based on existing literature. However, there is no definitive answer to that question. The most extensive benchmark of MVIAs for assessing the accuracy, execution time, and computational stability (<xref rid="btae098-B3" ref-type="bibr">Davis <italic toggle="yes">et al.</italic> 2022</xref>) covers only 18 algorithms, which is 34.62% of all considered MVIAs (<xref rid="btae098-F1" ref-type="fig">Fig. 1C</xref>) and 25.71% of all considered implementations (<xref rid="sup1" ref-type="supplementary-material">Supplementary data SI2</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). Therefore, to assist users in choosing the most suitable MVIA from a wide array of available methods, we have decided to conduct a benchmark to showcase their performance.</p>
    <p>To evaluate the performance of MVIAs, we ran them with their default parameters in all 230 scenarios (10 missing values patterns <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mo>×</mml:mo></mml:math></inline-formula> 23 different-sized datasets). During our preliminary assessment, we noticed that MVIAs either converged quite fast or were imputing data endlessly, so we decided to limit the computation time to two minutes per single run of the MVIA code. Each MVIA was executed three times, if the attempt failed to impute MV in each of the three approaches, we marked it as not working for a given scenario (<xref rid="sup1" ref-type="supplementary-material">Supplementary data SI3.3</xref>). To assess the imputation quality, we utilized the normalized root mean squared error (NRMSE). The NRMSE is a widely accepted measure for quantifying the accuracy of imputed data, as it is not sensitive to heteroscedasticity among the variables, allowing for relative error assessment (<xref rid="sup1" ref-type="supplementary-material">Supplementary data SI4</xref>) (<xref rid="btae098-B6" ref-type="bibr">Oba <italic toggle="yes">et al.</italic> 2003</xref>).</p>
    <p>Furthermore, to assist users of our web server in selecting the most suitable method for their dataset, we introduced the option to choose methods that demonstrated the best performance in simulations—in terms of speed, overall effectiveness, and suitability for specific missing value patterns (i.e. MCAR, MAR, and MNAR).</p>
  </sec>
  <sec>
    <title>3 Results and conclusions</title>
    <p>‘imputomics’ stands as the most comprehensive R package for the imputation of missing data in R, encompassing 42 MVIAs. It represents an effort to bridge the gap between the richness of available methods and the practical usability of these techniques, making advanced data imputation accessible to a broader spectrum of researchers in the field of metabolomics.</p>
    <p>The instant accessibility of multiple MVIAs enables the choice of MVIAs based on the covariate distribution and the missing value pattern. However, we warn potential users against selecting the method to support a preconceived hypothesis. The choice of the optimal MVIA should happen <italic toggle="yes">a priori</italic> or result from an understanding of the data structure. To guide such choices, our simulation results provide a more comprehensive understanding of the performance of various MVIA implementations depending on the type of missingness and the data dimensionality.</p>
    <p>Out of 42 MVIA implementations, 17 (40.48%) would not consistently succeed in every scenario (<xref rid="btae098-F1" ref-type="fig">Fig. 1D</xref>). It is important to emphasize that 25.53% of errors are attributed to instances where convergence failed to occur within the defined timeout. This instability can sometimes be attributed to running MVIAs implementations with default parameters. However, this outcome holds significance for users who do not intend to fine-tune their missing value imputation pipeline or seek a robust solution that offers relatively swift imputation. Among the most stable algorithms, the top performers include EM from the R package missMDA (<xref rid="btae098-B4" ref-type="bibr">Josse and Husson 2016</xref>), and KNN-EU (<xref rid="btae098-B9" ref-type="bibr">Shah <italic toggle="yes">et al.</italic> 2019</xref>), both achieving NRMSE values lower than 0.5. Eight MVIAs implementations (19.05%) failed to surpass the baseline model, which, in our case, involves imputation by a random number (<xref rid="btae098-F1" ref-type="fig">Fig. 1D</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary data SI5</xref>). Depending on the type of missing data (MCAR, MAR, and, resulting from LOD, MNAR), different MVIAs respectively had the best performance: Random Forest (as implemented in MetabImpute) (<xref rid="btae098-B3" ref-type="bibr">Davis <italic toggle="yes">et al.</italic> 2022</xref>), missMDA (<xref rid="btae098-B4" ref-type="bibr">Josse and Husson 2016</xref>), and min (as implemented in MetabImpute or ‘imputomics’ packages) (<xref rid="sup1" ref-type="supplementary-material">Supplementary data SI6</xref>).</p>
    <p>The benchmarked MVIAs exhibit considerable diversity in their evaluation times (<xref rid="btae098-F1" ref-type="fig">Fig. 1E</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary data SI5</xref>). Interestingly, there is no significant correlation between the performance of MVIAs implementations and their computation time (<italic toggle="yes">P</italic>-value: 0.13, Spearman’s correlation coefficient: −0.31).</p>
    <p>Looking ahead, we anticipate ‘imputomics’ to streamline and tidy up the complicated landscape of the missing value imputation in R. We consider metabolomics as an appropriate starting point to extend our package to cover also MVIAs proposed for other branches of ‘-omics’. Presently, both ‘imputomics’ R package and web application for the first time provide easy and robust access to the majority of MVIAs implemented in R.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btae098_Supplementary_Data</label>
      <media xlink:href="btae098_supplementary_data.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We want to thank the Clinical Research Centre (Medical University of Białystok) members for fruitful discussions. The study was supported by the Ministry of Education and Science funds within the project ‘Excellence Initiative—Research University’. We also acknowledge the Center for Artificial Intelligence at the Medical University of Białystok (funded by the Ministry of Health of the Republic of Poland). Also, we want to express our gratitude to the authors of all MVIAs included in our article and Małgorzata Bogdan (University of Wrocław) for fruitful discussions.</p>
  </ack>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the National Science Centre [2021/43/O/ST6/02805 to K.G.]; and the Medical University of Białystok grant [B.SUB.23.53 to M.C.].</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The data underlying this article are available in the article and in its online supplementary material.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btae098-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Armitage</surname><given-names>EG</given-names></string-name>, <string-name><surname>Godzien</surname><given-names>J</given-names></string-name>, <string-name><surname>Alonso-Herranz</surname><given-names>V</given-names></string-name></person-group><etal>et al</etal><article-title>Missing value imputation strategies for metabolomics data</article-title>. <source>Electrophoresis</source><year>2015</year>;<volume>36</volume>:<fpage>3050</fpage>–<lpage>60</lpage>.<pub-id pub-id-type="pmid">26376450</pub-id></mixed-citation>
    </ref>
    <ref id="btae098-B2">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Chang</surname><given-names>W</given-names></string-name>, <string-name><surname>Cheng</surname><given-names>J</given-names></string-name>, <string-name><surname>Allaire</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><italic toggle="yes">Shiny: Web Application Framework for R</italic>, <year>2024</year>. <ext-link xlink:href="https://github.com/rstudio/shiny" ext-link-type="uri">https://github.com/rstudio/shiny</ext-link>.</mixed-citation>
    </ref>
    <ref id="btae098-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Davis</surname><given-names>TJ</given-names></string-name>, <string-name><surname>Firzli</surname><given-names>TR</given-names></string-name>, <string-name><surname>Higgins Keppler</surname><given-names>EA</given-names></string-name></person-group><etal>et al</etal><article-title>Addressing missing data in GC <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mo>×</mml:mo></mml:math></inline-formula> GC metabolomics: identifying missingness type and evaluating the impact of imputation methods on experimental replication</article-title>. <source>Anal Chem</source><year>2022</year>;<volume>94</volume>:<fpage>10912</fpage>–<lpage>20</lpage>.<pub-id pub-id-type="pmid">35881554</pub-id></mixed-citation>
    </ref>
    <ref id="btae098-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Josse</surname><given-names>J</given-names></string-name>, <string-name><surname>Husson</surname><given-names>F.</given-names></string-name></person-group><article-title>missMDA: a package for handling missing values in multivariate data analysis</article-title>. <source>J Stat Soft</source><year>2016</year>;<volume>70</volume>:<fpage>1</fpage>–<lpage>31</lpage>.</mixed-citation>
    </ref>
    <ref id="btae098-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Karpievitch</surname><given-names>YV</given-names></string-name>, <string-name><surname>Dabney</surname><given-names>AR</given-names></string-name>, <string-name><surname>Smith</surname><given-names>RD</given-names></string-name></person-group><etal>et al</etal><article-title>Normalization and missing value imputation for label-free LC-MS analysis</article-title>. <source>BMC Bioinformatics</source><year>2012</year>;<volume>13</volume>:<fpage>S5</fpage>.</mixed-citation>
    </ref>
    <ref id="btae098-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Oba</surname><given-names>S</given-names></string-name>, <string-name><surname>Sato</surname><given-names>M-A</given-names></string-name>, <string-name><surname>Takemasa</surname><given-names>I</given-names></string-name></person-group><etal>et al</etal><article-title>A Bayesian missing value estimation method for gene expression profile data</article-title>. <source>Bioinformatics </source><year>2003</year>;<volume>19</volume>:<fpage>2088</fpage>–<lpage>96</lpage>.<pub-id pub-id-type="pmid">14594714</pub-id></mixed-citation>
    </ref>
    <ref id="btae098-B7">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Perry</surname><given-names>PO</given-names></string-name>, <string-name><surname>Najibi</surname><given-names>SM</given-names></string-name>, <string-name><surname>Burdukiewicz</surname><given-names>M</given-names></string-name></person-group>. bcv: Cross-Validation for the SVD (Bi-Cross-Validation), <year>2023</year>. <ext-link xlink:href="https://cran.r-project.org/package=bcv" ext-link-type="uri">https://cran.r-project.org/package=bcv</ext-link>.</mixed-citation>
    </ref>
    <ref id="btae098-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rubin</surname><given-names>DB.</given-names></string-name></person-group><article-title>Inference and missing data</article-title>. <source>Biometrika</source><year>1976</year>;<volume>63</volume>:<fpage>581</fpage>–<lpage>92</lpage>.</mixed-citation>
    </ref>
    <ref id="btae098-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shah</surname><given-names>J</given-names></string-name>, <string-name><surname>Brock</surname><given-names>GN</given-names></string-name>, <string-name><surname>Gaskins</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>BayesMetab: treatment of missing values in metabolomic studies using a Bayesian modeling approach</article-title>. <source>BMC Bioinformatics</source><year>2019</year>;<volume>20</volume>:<fpage>673</fpage>.<pub-id pub-id-type="pmid">31861984</pub-id></mixed-citation>
    </ref>
    <ref id="btae098-B10">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Ushey</surname><given-names>K</given-names></string-name>, <string-name><surname>Wickham</surname><given-names>H.</given-names></string-name></person-group><italic toggle="yes">renv: Project Environments</italic>, <year>2023</year>. <ext-link xlink:href="https://rstudio.github.io/renv/" ext-link-type="uri">https://rstudio.github.io/renv/</ext-link>.</mixed-citation>
    </ref>
    <ref id="btae098-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Villas-Bôas</surname><given-names>SG</given-names></string-name>, <string-name><surname>Mas</surname><given-names>S</given-names></string-name>, <string-name><surname>Akesson</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Mass spectrometry in metabolome analysis</article-title>. <source>Mass Spectrom Rev</source><year>2005</year>;<volume>24</volume>:<fpage>613</fpage>–<lpage>46</lpage>.<pub-id pub-id-type="pmid">15389842</pub-id></mixed-citation>
    </ref>
    <ref id="btae098-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wei</surname><given-names>R</given-names></string-name>, <string-name><surname>Wang</surname><given-names>J</given-names></string-name>, <string-name><surname>Su</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Missing value imputation approach for mass spectrometry-based metabolomics data</article-title>. <source>Sci Rep</source><year>2018</year>;<volume>8</volume>:<fpage>663</fpage>.<pub-id pub-id-type="pmid">29330539</pub-id></mixed-citation>
    </ref>
    <ref id="btae098-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wickham</surname><given-names>H</given-names></string-name>, <string-name><surname>Averick</surname><given-names>M</given-names></string-name>, <string-name><surname>Bryan</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Welcome to the Tidyverse</article-title>. <source>JOSS</source><year>2019</year>;<volume>4</volume>:<fpage>1686</fpage>.</mixed-citation>
    </ref>
    <ref id="btae098-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zampieri</surname><given-names>M</given-names></string-name>, <string-name><surname>Sekar</surname><given-names>K</given-names></string-name>, <string-name><surname>Zamboni</surname><given-names>N</given-names></string-name></person-group><etal>et al</etal><article-title>Frontiers of high-throughput metabolomics</article-title>. <source>Curr Opin Chem Biol</source><year>2017</year>;<volume>36</volume>:<fpage>15</fpage>–<lpage>23</lpage>.<pub-id pub-id-type="pmid">28064089</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
