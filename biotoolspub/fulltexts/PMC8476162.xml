<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8476162</article-id>
    <article-id pub-id-type="pmid">32573714</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btaa584</article-id>
    <article-id pub-id-type="publisher-id">btaa584</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Structural Bioinformatics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Molywood: streamlining the design and rendering of molecular movies</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Wieczór</surname>
          <given-names>Miłosz</given-names>
        </name>
        <aff><institution>Department of Physical Chemistry, Gdańsk University of Technology</institution>, Gdańsk 80-233, <country country="PL">Poland</country></aff>
        <aff><institution>Institute for Research in Biomedicine (IRB Barcelona), Barcelona Institute of Science and Technology</institution>, Barcelona 08028, <country country="ES">Spain</country></aff>
        <xref rid="btaa584-cor1" ref-type="corresp"/>
        <!--milosz.wieczor@pg.edu.pl-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hospital</surname>
          <given-names>Adam</given-names>
        </name>
        <aff><institution>Institute for Research in Biomedicine (IRB Barcelona), Barcelona Institute of Science and Technology</institution>, Barcelona 08028, <country country="ES">Spain</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bayarri</surname>
          <given-names>Genis</given-names>
        </name>
        <aff><institution>Institute for Research in Biomedicine (IRB Barcelona), Barcelona Institute of Science and Technology</institution>, Barcelona 08028, <country country="ES">Spain</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Czub</surname>
          <given-names>Jacek</given-names>
        </name>
        <aff><institution>Department of Physical Chemistry, Gdańsk University of Technology</institution>, Gdańsk 80-233, <country country="PL">Poland</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Orozco</surname>
          <given-names>Modesto</given-names>
        </name>
        <aff><institution>Institute for Research in Biomedicine (IRB Barcelona), Barcelona Institute of Science and Technology</institution>, Barcelona 08028, <country country="ES">Spain</country></aff>
        <aff><institution>Department of Biochemistry and Biomedicine, University of Barcelona</institution>, Barcelona 08028, <country country="ES">Spain</country></aff>
        <xref rid="btaa584-cor1" ref-type="corresp"/>
        <!--modesto.orozco@irbbarcelona.org-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Elofsson</surname>
          <given-names>Arne</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btaa584-cor1">To whom correspondence should be addressed. E-mail: <email>milosz.wieczor@pg.edu.pl</email> or <email>modesto.orozco@irbbarcelona.org</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>9</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2020-06-23">
      <day>23</day>
      <month>6</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>23</day>
      <month>6</month>
      <year>2020</year>
    </pub-date>
    <volume>36</volume>
    <issue>17</issue>
    <fpage>4660</fpage>
    <lpage>4661</lpage>
    <history>
      <date date-type="received">
        <day>04</day>
        <month>3</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>04</day>
        <month>6</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>15</day>
        <month>6</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btaa584.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>High-quality dynamic visuals are needed at all levels of science communication, from the conference hall to the classroom. As scientific journals embrace new article formats, many key concepts—particularly, in structural biology—are also more easily conveyed as videos than still frames. Notwithstanding, the design and rendering of a complex molecular movie remain an arduous task. Here, we introduce Molywood, a robust and intuitive tool that builds on the capabilities of Visual Molecular Dynamics (VMD) to automate all stages of movie rendering.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Molywood is a Python-based script that uses an integrated workflow to give maximal flexibility in movie design. It implements the basic concepts of actions, layers, grids and concurrency and requires no programming experience to run.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The script is freely available on GitLab (gitlab.com/KomBioMol/molywood) and PyPI (through pip), and features an extended documentation, tutorial and gallery hosted on mmb.irbbarcelona.org/molywood.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Polish National Agency for Academic Exchange</institution>
            <institution-id institution-id-type="DOI">10.13039/501100014434</institution-id>
          </institution-wrap>
          <!-- oupReleaseDelayRemoved from OA Article (12|0) -->
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Instituto Nacional de Bioinformática</institution>
          </institution-wrap>
          <!-- oupReleaseDelayRemoved from OA Article (12|0) -->
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Union’s Horizon 2020</institution>
          </institution-wrap>
          <!-- oupReleaseDelayRemoved from OA Article (12|0) -->
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Biomolecular and Bioinformatics Resources Platform</institution>
          </institution-wrap>
          <!-- oupReleaseDelayRemoved from OA Article (12|0) -->
        </funding-source>
        <award-id>ISCIII PT 13/0001/0030</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>MINECO Severo Ochoa Award of Excellence</institution>
          </institution-wrap>
          <!-- oupReleaseDelayRemoved from OA Article (12|0) -->
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Since the groundbreaking resolution of the 3-dimensional structure of myoglobin in 1960 (<xref rid="btaa584-B6" ref-type="bibr">Kendrew <italic toggle="yes">et al.</italic>, 1960</xref>), our understanding of processes of life has increasingly relied on the visualization of molecules. The two revolutions in high-resolution structural biology—first in X-ray crystallography, second in cryogenic electron microscopy (cryo-EM) imaging (<xref rid="btaa584-B8" ref-type="bibr">Stuart <italic toggle="yes">et al.</italic>, 2016</xref>)—resulted in tens of thousands of unique protein structures being deposited in public databases, ultimately providing us with an atomistic-level insight into the peculiar world of molecular shapes and conformational changes. However, the scientific communication of these findings primarily relies on still images and figures, often obscuring or distorting the structural insights.</p>
    <p>This situation could be rectified through widespread adoption of molecular movies as a complementary visual aid in the dissemination of scientific findings (<xref rid="btaa584-B7" ref-type="bibr">McGill, 2008</xref>). Not only are publishers starting to actively encourage the use of multimedia in the new enhanced, web-only article formats, but also science communication has become increasingly visual due to the proliferation of science-oriented blogs, vlogs and social media channels (<xref rid="btaa584-B9" ref-type="bibr">Welbourne and Grant, 2016</xref>). On the other hand, researchers often find existing tools inadequately suited to these challenges. In fact, a very limited choice of such tools exists today: VMD’s Movie Maker remains limited to simplest cases, BioBlender and ePMV require programming and/or Blender skills (<xref rid="btaa584-B1" ref-type="bibr">Andrei <italic toggle="yes">et al.</italic>, 2012</xref>; <xref rid="btaa584-B5" ref-type="bibr">Johnson <italic toggle="yes">et al.</italic>, 2011</xref>), while PyMOL’s eMovie effectively vanished from the Web (<xref rid="btaa584-B2" ref-type="bibr">Hodis <italic toggle="yes">et al.</italic>, 2007</xref>; <xref rid="btaa584-B3" ref-type="bibr">Hsin <italic toggle="yes">et al.</italic>, 2008</xref>). Simultaneously, platforms such as Molecular Maya are commercial and thus not accessible to many researchers. While molecular movies of excellent quality do exist in the literature, they are usually a result of a lengthy work on integrating workflows, automatizing and post-processing.</p>
    <p>These shortcomings prompted us to create Molywood, a Python tool capable of managing complex moviemaking workflows across a range of utilities, including the open-source utilities FFmpeg and Imagemagick, Python’s Matplotlib and VMD with its extended Tcl scripting capabilities (<xref rid="btaa584-B4" ref-type="bibr">Humphrey <italic toggle="yes">et al.</italic>, 1996</xref>). With an easy-to-follow syntax and flexible composition rules, the tool greatly simplifies movie design, allowing the user to focus on conceptual rather than technical issues. Finally, we provide a library of minimal working examples and featured full-fledged movies—hosted at mmb.irbbarcelona.org/molywood—to guide users through the supported options.
</p>
    <fig position="float" id="btaa584-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>The conceptual organization of Molywood. A Script is divided into possibly multiple Scenes, which in turn consist of instantaneous, consecutive or simultaneous Actions. Individual Actions can access external resources, such as numeric data, figures or other movies. A number of simple global parameters control video quality</p>
      </caption>
      <graphic xlink:href="btaa584f1" position="float"/>
    </fig>
  </sec>
  <sec>
    <title>2 Application</title>
    <p>Molywood is organized around three hierarchical concepts: Scripts, Scenes and Actions (Fig. 1). A Script is a collection of Scenes, and defines the entire movie; similarly, a Scene is a collection of Actions and can be thought of as a single panel. Most movies will consist of a single Scene, so here we focus on Actions first.</p>
    <p>An Action is the main primitive that abstracts a single event—a rotation, zoom, highlight, etc.—either with a specific duration or effected instantaneously. In Molywood, many Actions can overlap in time, e.g. one can rotate the view while simultaneously zooming in and animating the trajectory. Moreover, Actions can be asynchronous (i.e. overlap only partially with one another): following the above example, it is possible to start the rotation when the zoom-in and animation are already underway. All Actions are controlled by key-value pairs that specify all tunable parameters, such as action duration, transition smoothness or color of the highlight. For more complex behavior, they can interact with other Actions: for instance, a structural highlight can be labeled upon creation, so that the same highlight can be later altered or removed. Arbitrarily long extracts from audio files (e.g. voice narratives) can also be easily aligned with specific Actions.</p>
    <p>A large portion of Molywood is structured around Overlays—graphical elements that can be overlaid on the basal scene. Overlays support dynamically changing text, 1D and 2D graphs with custom formatting, external figures and movies, as well as other Scene objects (i.e. one molecular movie can be used as an inset in another one). One can also dynamically change the position, relative size and opacity of the Overlays, with no limit to their number or the stacking of layers. Overlays are hence indispensable in augmenting the bare visuals with additional data, such as labels, analysis results, insets or zooms, logos or ending credits.</p>
    <p>In turn, the concept of Scenes was primarily introduced to enable multi-panel movies, e.g. to contrast-related systems side-by-side. Their use, however, is very flexible: they might as well be treated as overlays, or joined consecutively to yield movie-like cuts and transitions. Moreover, different Scenes can visualize different molecular systems. This flexibility in design fosters users’ creativity in making appealing videos targeted at the general public.</p>
    <p>Finally, several global options exist that make the tool even more easily customized. Each Scene can be loaded from a saved VMD visualization state, preserving user-defined viewpoints, selections and settings. Alternatively, a quick start is also possible from an existing PDB structure and/or trajectory, with an option to download PDB structures on-the-fly from the online database. Movie quality can be easily set by specifying frame-per-second values and Scene resolution. In case of resource-intensive renders, frames can be preserved to allow for restarting when only minor changes are introduced. Last but not least, four hierarchical rendering modes exist to speed up the design process: (i) no rendering, with frames only displayed in VMD; (ii) quick-and-dirty rendering via VMD’s Snapshot; (iii) proper rendering with Tachyon, possibly on an external machine; (iv) professional rendering with shading and Tachyon’s Ambient Occlusion. By changing render modes, one can quickly get through the design process and offload the most resource-heavy rendering step to an external workstation, where all dependencies can be conveniently batch-installed in a separate conda environment.</p>
  </sec>
  <sec>
    <title>3 Discussion</title>
    <p>Due to the evolving character of Molywood, finer details of the implementation, an extended documentation of all keywords, a set of mini-tutorials and the examples gallery are hosted on <ext-link xlink:href="https://mmb.irbbarcelona.org/molywood" ext-link-type="uri">https://mmb.irbbarcelona.org/molywood</ext-link> and regularly updated. The gallery, in particular, is intended as an ever-growing collection of highlights to serve other users as both guidelines and inspiration; users may submit their movies along with self-contained input datasets if they want to share their work. Meanwhile, the tutorials provide a detailed overview of all available keywords, parameters and defaults, serving as an extended and more intuitive documentation. We also encourage user feedback to help Molywood better address the needs of the community, hoping the tool will eventually define new standards in movie generation, as well as inspire further developments of open-source visualization software. With this common goal, we shall see the future of the field as yet more visually appealing.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the Polish National Agency for Academic Exchange, the Instituto Nacional de Bioinformática, the European Union’s Horizon 2020 research and innovation program [BioExcel-2 project], the Biomolecular and Bioinformatics Resources Platform (ISCIII PT 13/0001/0030) as well as the MINECO Severo Ochoa Award of Excellence (Government of Spain) (awarded to IRB Barcelona). M.O. is an ICREA Research Professor.</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btaa584-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Andrei</surname><given-names>R.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2012</year>) 
<article-title>Intuitive representation of surface properties of biomolecules using BioBlender</article-title>. <source>BMC Bioinformatics</source>, <volume>13</volume>, <fpage>S16</fpage>.</mixed-citation>
    </ref>
    <ref id="btaa584-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hodis</surname><given-names>E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2007</year>) eMovie: a storyboard-based tool for making molecular movies. <italic toggle="yes">Trends Biochem. Sci.</italic>, <volume>32</volume>, 199–204.</mixed-citation>
    </ref>
    <ref id="btaa584-B3">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Hsin</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2008</year>) Using VMD: an introductory tutorial. <italic toggle="yes">Curr. Protoc. Bioinform.</italic>, 5.</mixed-citation>
    </ref>
    <ref id="btaa584-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Humphrey</surname><given-names>W.</given-names></string-name></person-group>  <etal>et al</etal> (<year>1996</year>) 
<article-title>VMD: visual molecular dynamics</article-title>. <source>J. Mol. Graph</source>., <volume>14</volume>, <fpage>33</fpage>–<lpage>38</lpage>.<pub-id pub-id-type="pmid">8744570</pub-id></mixed-citation>
    </ref>
    <ref id="btaa584-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Johnson</surname><given-names>G.T.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2011</year>) 
<article-title>ePMV embeds molecular modeling into professional animation software environments</article-title>. <source>Structure</source>, <volume>19</volume>, <fpage>293</fpage>–<lpage>303</lpage>.<pub-id pub-id-type="pmid">21397181</pub-id></mixed-citation>
    </ref>
    <ref id="btaa584-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kendrew</surname><given-names>J.C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>1960</year>) 
<article-title>Structure of myoglobin: a three-dimensional Fourier synthesis at 2 Å. Resolution</article-title>. <source>Nature</source>, <volume>185</volume>, <fpage>422</fpage>–<lpage>427</lpage>.<pub-id pub-id-type="pmid">18990802</pub-id></mixed-citation>
    </ref>
    <ref id="btaa584-B7">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>McGill</surname><given-names>G.</given-names></string-name></person-group> (<year>2008</year>) Molecular movies… coming to a lecture near you. <italic toggle="yes">Cell</italic>, 133, 1127 - 1132.</mixed-citation>
    </ref>
    <ref id="btaa584-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stuart</surname><given-names>D.I.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) The democratization of cryo-EM. <italic toggle="yes">Nature Methods</italic>, <volume>13</volume>, <fpage>607</fpage>–<lpage>608</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa584-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Welbourne</surname><given-names>D.J.</given-names></string-name>, <string-name><surname>Grant</surname><given-names>W.J.</given-names></string-name></person-group> (<year>2016</year>) 
<article-title>Science communication on YouTube: factors that affect channel and video popularity</article-title>. <source>Public Understand. Sci.</source>, <volume>25</volume>, <fpage>706</fpage>–<lpage>718</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
