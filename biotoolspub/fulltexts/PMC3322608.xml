<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Acta Crystallogr D Biol Crystallogr</journal-id>
    <journal-id journal-id-type="iso-abbrev">Acta Crystallogr. D Biol. Crystallogr</journal-id>
    <journal-id journal-id-type="publisher-id">Acta Cryst. D</journal-id>
    <journal-title-group>
      <journal-title>Acta Crystallographica Section D: Biological Crystallography</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0907-4449</issn>
    <issn pub-type="epub">1399-0047</issn>
    <publisher>
      <publisher-name>International Union of Crystallography</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3322608</article-id>
    <article-id pub-id-type="publisher-id">ba5174</article-id>
    <article-id pub-id-type="doi">10.1107/S0907444911054515</article-id>
    <article-id pub-id-type="coden">ABCRE6</article-id>
    <article-id pub-id-type="pii">S0907444911054515</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Papers</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>PDB_REDO</italic>: constructive validation, more than just looking for errors</article-title>
      <alt-title>
        <italic>PDB_REDO</italic>
      </alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Joosten</surname>
          <given-names>Robbie P.</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
        <xref ref-type="corresp" rid="cor">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Joosten</surname>
          <given-names>Krista</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Murshudov</surname>
          <given-names>Garib N.</given-names>
        </name>
        <xref ref-type="aff" rid="b">b</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Perrakis</surname>
          <given-names>Anastassis</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
      </contrib>
      <aff id="a"><label>a</label>Department of Biochemistry, <institution>Netherlands Cancer Institute</institution>, Plesmanlaan 121, 1066 CX Amsterdam, <country>The Netherlands</country></aff>
      <aff id="b"><label>b</label>Structural Studies Division, <institution>MRC Laboratory of Molecular Biology</institution>, Cambridge CB2 0QH, <country>England</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor">Correspondence e-mail: <email>r.joosten@nki.nl</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>4</month>
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>16</day>
      <month>3</month>
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>3</month>
      <year>2012</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>68</volume>
    <issue>Pt 4</issue>
    <issue-id pub-id-type="publisher-id">d120400</issue-id>
    <fpage>484</fpage>
    <lpage>496</lpage>
    <history>
      <date date-type="received">
        <day>03</day>
        <month>8</month>
        <year>2011</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>12</month>
        <year>2011</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Joosten et al. 2012</copyright-statement>
      <copyright-year>2012</copyright-year>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0/uk/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original authors and source are cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:type="simple" xlink:href="http://dx.doi.org/10.1107/S0907444911054515">A full version of this article is available from Crystallography Journals Online.</self-uri>
    <abstract abstract-type="toc">
      <p>The decision-making algorithms and software used in <italic>PDB_REDO</italic> to re-refine and rebuild crystallographic protein structures in the PDB are presented and discussed.</p>
    </abstract>
    <abstract>
      <p>Developments of the <italic>PDB_REDO</italic> procedure that combine re-refinement and rebuilding within a unique decision-making framework to improve structures in the PDB are presented. <italic>PDB_REDO</italic> uses a variety of existing and custom-built software modules to choose an optimal refinement protocol (<italic>e.g.</italic> anisotropic, isotropic or overall <italic>B</italic>-factor refinement, TLS model) and to optimize the geometry <italic>versus</italic> data-refinement weights. Next, it proceeds to rebuild side chains and peptide planes before a final optimization round. <italic>PDB_REDO</italic> works fully automatically without the need for intervention by a crystallographic expert. The pipeline was tested on 12 000 PDB entries and the great majority of the test cases improved both in terms of crystallographic criteria such as <italic>R</italic>
<sub>free</sub> and in terms of widely accepted geometric validation criteria. It is concluded that <italic>PDB_REDO</italic> is useful to update the otherwise ‘static’ structures in the PDB to modern crystallographic standards. The publically available <italic>PDB_REDO</italic> database provides better model statistics and contributes to better refinement and validation targets.</p>
    </abstract>
    <kwd-group>
      <kwd>validation</kwd>
      <kwd>refinement</kwd>
      <kwd>model building</kwd>
      <kwd>automation</kwd>
      <kwd>PDB</kwd>
    </kwd-group>
    <conference>
      <conf-date/>
      <conf-name>Model building, refinement and validation</conf-name>
      <conf-loc/>
    </conference>
  </article-meta>
</front>
<body>
  <sec id="sec1">
    <label>1.</label>
    <title>Introduction
 
</title>
    <sec id="sec1.1">
      <label>1.1.</label>
      <title>Validation
 
</title>
      <p>A crystallographic experiment and the ensuing process of phasing, model building and refinement (hopefully) culminates in a three-dimensional structure model that fits both the experimental X-ray data and our prior knowledge of macromolecular chemistry. Validation helps to guide this process and enables crystallographers to produce high-quality structure models suitable for biological interpretation. Validation software routines have been available since the early 1990s (Laskowski <italic>et al.</italic>, 1993<xref ref-type="bibr" rid="bb35"> ▶</xref>; Hooft <italic>et al.</italic>, 1996<xref ref-type="bibr" rid="bb19"> ▶</xref>; Davis <italic>et al.</italic>, 2004<xref ref-type="bibr" rid="bb8"> ▶</xref>). These check many aspects of crystallographic (or other) structures, typically with a strong focus on macromolecules and specifically on proteins. Validation of nucleic acid structures is also available, for example in <italic>MolProbity</italic> (Chen <italic>et al.</italic>, 2010<xref ref-type="bibr" rid="bb46"> ▶</xref>; Richardson <italic>et al.</italic>, 2008<xref ref-type="bibr" rid="bb56"> ▶</xref>). Validation software for other chemical entities is available as well, <italic>e.g. PDB-care</italic> (Lütteke &amp; von der Lieth, 2004<xref ref-type="bibr" rid="bb36"> ▶</xref>) for carbohydrates and <italic>WASP</italic> (Nayal &amp; Di Cera, 1996<xref ref-type="bibr" rid="bb40"> ▶</xref>) for metal ions. Various validation tools are also available directly through graphical model-building software such as <italic>O</italic> (Jones <italic>et al.</italic>, 1991<xref ref-type="bibr" rid="bb24"> ▶</xref>) and <italic>Coot</italic> (Emsley &amp; Cowtan, 2004<xref ref-type="bibr" rid="bb10"> ▶</xref>; Emsley <italic>et al.</italic> 2010<xref ref-type="bibr" rid="bb11"> ▶</xref>).</p>
      <p>While finalizing a crystallographic structure, validation can be used constructively to detect anomalies in the model and the crystallographer can either remove the anomaly or confirm that it is real, <italic>i.e.</italic> by assuring that there is sufficient (experimental) evidence for a model with this anomaly. This process has many complications. For example, large overall bond-length deviations typically arise from wrong or erroneous restraint settings; however, they can also be the result of errors in the experimental determination of unit-cell parameters and should not be resolved by tightening the restraints but rather by updating the unit-cell parameters.</p>
      <p>Most validation tools focus on the identification of outliers: residues which are, based on statistical measures of our growing empirical knowledge of macromolecular structure, not similar to other residues in known structures. Focusing on outliers is sensible because these residues are most likely to be either interesting or wrongly modelled, but it takes away attention from the rest of the model. This becomes a problem when the absence of outliers is seen as a confirmation that the model is optimal. Side-chain rotamers are a good example: having no (or few) outliers does not mean all the rotamers are optimal with respect to the experimental data.</p>
    </sec>
    <sec id="sec1.2">
      <label>1.2.</label>
      <title>Validation after structure deposition
 
</title>
      <p>After a crystallographic structure has been finalized, deposited in the PDB and released, the atomic coordinates are set in stone. The Protein Data Bank (Bernstein <italic>et al.</italic>, 1977<xref ref-type="bibr" rid="bb5"> ▶</xref>; Berman <italic>et al.</italic>, 2003<xref ref-type="bibr" rid="bb4"> ▶</xref>) is a historical archive and does not change the atomic coordinates, although their annotation may be updated (Henrick <italic>et al.</italic>, 2008<xref ref-type="bibr" rid="bb16"> ▶</xref>) to deal with the changing needs of depositors and users. The static nature of structure models in the PDB has many implications. The obvious consequence is that models that are several decades old often lack the accuracy and precision that modern crystallographic software offers, while they also lack the benefit of constructive validation which was either lacking or less ‘mature’ at the time these older models were constructed. This way, the users of the PDB often have access to models that are suboptimal by modern-day criteria. In addition, a less obvious consequence is that even when a user validates an existing PDB entry or uses ready-made validation reports as provided by, for example, the <italic>PDBREPORT</italic> data bank (Hooft <italic>et al.</italic>, 1996<xref ref-type="bibr" rid="bb19"> ▶</xref>; Joosten, te Beek <italic>et al.</italic>, 2011<xref ref-type="bibr" rid="bb27"> ▶</xref>), validation is no longer constructive: any anomalies found do not lead to an improved structure model because most PDB users do not have the crystallographic expertise to make the structure better before using it. In this context, validation may lead to the outright rejection of a structure model when an alternative with better validation results is available. This situation not only affects the older models in the PDB, which were accumulating at a slower pace (more crystallographic structures have entered the PDB in the last three years alone than in its first thirty years): a model submitted now will simply be an old model in a few years time, as crystallographic methods are still improving at an appreciable pace.</p>
    </sec>
    <sec id="sec1.3">
      <label>1.3.</label>
      <title><italic>PDB_REDO</italic>
 
</title>
      <p>To keep PDB models up to date, we decided to apply some of the latest crystallographic methods to all PDB entries for which experimental X-ray data are available (Joosten, Salzemann <italic>et al.</italic>, 2009<xref ref-type="bibr" rid="bb26"> ▶</xref>) and created the <italic>PDB_REDO</italic> software pipeline that takes atom coordinates and X-ray data from the PDB and re-refines the structure model in <italic>REFMAC</italic> (Murshudov <italic>et al.</italic>, 1997<xref ref-type="bibr" rid="bb39"> ▶</xref>, 2011<xref ref-type="bibr" rid="bb38"> ▶</xref>). A strong focus was placed on automation in order to deal with the tens of thousands of PDB entries, which meant dealing with the problems the PDB still had (at the time) with inconsistent annotation of coordinate and reflection files. The most important strength of automation is that it allowed us to optimize the weight between the X-­ray data and the geometric restraints, something that is a lot of work to do by hand even for a single structure model. In our re-refinement we consistently used TLS models for anisotropic atom movement (Schomaker &amp; Trueblood, 1968<xref ref-type="bibr" rid="bb47"> ▶</xref>; Winn <italic>et al.</italic>, 2001<xref ref-type="bibr" rid="bb54"> ▶</xref>), which has only recently been made accessible to macromolecular crystallography, thus using the latest developments in refinement for all PDB entries. The resulting structure models showed an improvement in terms of <italic>R</italic>
<sub>free</sub> (Brünger, 1992<xref ref-type="bibr" rid="bb6"> ▶</xref>), and model validation showed a substantial improvement in overall model-quality estimators such as the Ramachandran plot (Ramachandran <italic>et al.</italic>, 1963<xref ref-type="bibr" rid="bb44"> ▶</xref>) <italic>Z</italic> score, which compares the combination of backbone torsion angles for each residue with a residue-type and secondary-structure specific distribution in high-quality protein structure models (Hooft <italic>et al.</italic>, 1997<xref ref-type="bibr" rid="bb18"> ▶</xref>), and the number of atomic clashes or bumps. A notable result was that very recent PDB entries also improved, although in most cases the improvement was not as great or as common as in older PDB entries.</p>
      <p>Making the improved structure models available to the PDB user community through the <italic>PDB_REDO</italic> data bank (Joosten &amp; Vriend, 2007<xref ref-type="bibr" rid="bb28"> ▶</xref>) was an initial step towards a constructive form of structure validation of deposited structure models. However, it was clear that local fitting errors and other problems in structure models could not be resolved by the approach we used (Joosten, Womack <italic>et al.</italic>, 2009<xref ref-type="bibr" rid="bb29"> ▶</xref>). A much more comprehensive approach that incorporates real-space model rebuilding was needed.</p>
    </sec>
    <sec id="sec1.4">
      <label>1.4.</label>
      <title>Real-space rebuilding
 
</title>
      <p>Algorithms for real-space fitting and rebuilding parts of the structure model have existed for decades (Diamond, 1971<xref ref-type="bibr" rid="bb9"> ▶</xref>; Jones, 1978<xref ref-type="bibr" rid="bb23"> ▶</xref>). The problem lies in deciding <italic>how</italic> they should be applied and <italic>where</italic> in the structure. The typical approach has been to manually update the structure model using molecular graphics, with a validation report to hand. The program <italic>OOPS</italic> (Kleywegt &amp; Jones, 1996<xref ref-type="bibr" rid="bb33"> ▶</xref>) provided a significant speed-up of this process by automating the <italic>where</italic> part of the problem: it used validation results from <italic>O</italic> (Jones <italic>et al.</italic>, 1991<xref ref-type="bibr" rid="bb24"> ▶</xref>) and <italic>WHAT_CHECK</italic> (Hooft <italic>et al.</italic>, 1996<xref ref-type="bibr" rid="bb19"> ▶</xref>) and turned them into a ‘macro’ for <italic>O</italic> that takes a user through the flagged parts of the structure model automatically. Similar implementations are available to interface <italic>MolProbity</italic> (Chen <italic>et al.</italic>, 2010<xref ref-type="bibr" rid="bb46"> ▶</xref>) with <italic>Coot</italic> (Emsley <italic>et al.</italic>, 2010<xref ref-type="bibr" rid="bb11"> ▶</xref>). Solving the <italic>how</italic> part of the problem still remains a challenge in structure validation: finding an anomaly is often easier than understanding what caused it.</p>
      <p>We recently described two programs (<italic>pepflip</italic> and <italic>SideAide</italic>) that rebuild structure models using a strategy that incorporates both the <italic>where</italic> and the <italic>how</italic> in a single decision-making framework (Joosten, Joosten <italic>et al.</italic>, 2011<xref ref-type="bibr" rid="bb25"> ▶</xref>). Instead of improving crystallographic structures just by rebuilding the parts of the model flagged by validation routines, the main chain and side chain of every residue is rebuilt and validated; if rebuilding leads to an improved fit to the crystallographic maps, then the model is updated with the new conformation. Instead of specifically looking for errors, this approach focuses on improvable features of the structure model and therefore has much greater coverage of the structure model than validation-based methods. The algorithms are fully automated and not particularly computationally intensive, enabling us to incorporate them in the <italic>PDB_REDO</italic> pipeline.</p>
      <p>The main challenge in automation lies in decision making. Decisions, and the priority they are given, are often taken based on statistic measures, but also on personal preference, experience or gut feeling, or even on dogmatic principles. Many decisions are taken without even realising it, <italic>e.g.</italic> by applying default values to many parameters. Fully automated software pipelines need to formalize all these decisions to a closed set of rules. Here, we discuss <italic>PDB_REDO</italic> as a decision-making framework, showing the choices we face and how we resolved them, and also present an extensive test on 12 000 PDB entries.</p>
    </sec>
  </sec>
  <sec id="sec2">
    <label>2.</label>
    <title>Methods
 
</title>
    <p>The different model-quality metrics used in the decision-making process of model optimization are described in Table 1<xref ref-type="table" rid="table1"> ▶</xref>. The software programs used in the procedure are discussed in the text and summarized in Table 2<xref ref-type="table" rid="table2"> ▶</xref>.</p>
    <sec id="sec2.1">
      <label>2.1.</label>
      <title>The <italic>PDB_REDO</italic> pipeline
 
</title>
      <p>The <italic>PDB_REDO</italic> software pipeline uses the PDB file with the deposited crystallographic structure coordinates and the associated reflection file containing the X-ray diffraction data.</p>
      <sec id="sec2.1.1">
        <label>2.1.1.</label>
        <title>Preparation of the diffraction data (CIF file)
 
</title>
        <p>The reflection file is standardized with <italic>Cif2cif</italic> (Joosten, Salzemann <italic>et al.</italic>, 2009<xref ref-type="bibr" rid="bb26"> ▶</xref>), which writes out Miller indices and amplitudes (or intensities if amplitudes are not given) for each reflection. σ values and <italic>R</italic>
<sub>free</sub>-set flags are written out if available. Only the first data set in the reflection file is used. Some basic sanity tests are performed as follows. <list list-type="simple"><list-item><p>(i) Reflections with negative values are rejected if they are marked as amplitudes, but are kept if they are intensities.</p></list-item><list-item><p>(ii) If σ values are given the set is tested for information content. If all values are the same, the σ values cannot be used for scaling purposes in refinement. Individual σ values of 0.0 are reset to the highest σ value in the data set.</p></list-item><list-item><p>(iii) The <italic>R</italic>
<sub>free</sub> set is validated, as discussed below (§<xref ref-type="sec" rid="sec2.2.1"/>2.2.1).</p></list-item></list>The standardized data set is then completed and converted to an MTZ file using tools from the <italic>CCP</italic>4 suite (Winn <italic>et al.</italic>, 2011<xref ref-type="bibr" rid="bb7"> ▶</xref>). Intensities are converted to amplitudes using <italic>CTRUNCATE</italic>, which deals with negative intensities (French &amp; Wilson, 1978<xref ref-type="bibr" rid="bb13"> ▶</xref>). The <italic>B</italic>
<sub>Wilson</sub> is calculated by <italic>SFCHECK</italic> (Vaguine <italic>et al.</italic>, 1999<xref ref-type="bibr" rid="bb52"> ▶</xref>). <italic>SFCHECK</italic> is also used to check the data completeness and to check for the presence of twinning.</p>
      </sec>
      <sec id="sec2.1.2">
        <label>2.1.2.</label>
        <title>Preparation of the coordinates (PDB file)
 
</title>
        <p>The PDB file is parsed with <italic>Extractor</italic> to extract cell dimensions, space group, waters and special residues that are involved in chemical interactions (as marked in LINK records in the PDB header). Parameters about refinement are also extracted at this stage: the <italic>R</italic> factor and the <italic>R</italic>
<sub>free</sub> from the PDB header (<italic>R</italic>
<sub>head</sub>, <italic>R</italic>
<sub>free,head</sub>), TLS-group selections and tensors, and the type of solvent model. The following records are removed from the PDB file by the program <italic>Stripper</italic>, mostly to ensure proper restraint generation for refinement: explicit H atoms, atoms with occupancy &lt; 0.01, superfluous O atoms in carbohydrates, if detected by <italic>PDB-care</italic>, unknown ligands (UNLs), side-chain atoms beyond C<sup>β</sup> for unknown residues (UNKs), inter-symmetry LINK and SSBOND records, fields containing atomic distances in LINK records, unknown atoms (UNXs) and any other atoms of element X since no scattering factors can be assigned.</p>
      </sec>
      <sec id="sec2.1.3">
        <label>2.1.3.</label>
        <title>Calculation of baseline values for model quality
 
</title>
        <p>The original structure is validated using <italic>WHAT_CHECK</italic>. <italic>REFMAC</italic> is then used (without any refinement) to calculate <italic>R</italic>
<sub>calc</sub> and <italic>R</italic>
<sub>free,calc</sub> in five steps.<list list-type="simple"><list-item><p>(i) The ‘TLS ambiguity’ is resolved first: are the <italic>B</italic> factors of the model ‘total’ or ‘residual’? To decide, a run with and without the TLS model (if available) is attempted and the approach that gives the lowest <italic>R</italic>
<sub>calc</sub> is chosen.</p></list-item><list-item><p>(ii) If the difference between the calculated <italic>R</italic> factor (<italic>R</italic>
<sub>calc</sub>) and that extracted from the header of PDB file (<italic>R</italic>
<sub>head</sub>) is more than 5% (<italic>R</italic>
<sub>calc</sub> − <italic>R</italic>
<sub>head</sub> &gt; 5%) and a twin fraction of &gt;5% was detected by <italic>SFCHECK</italic>, then <italic>REFMAC</italic> is run with twinning.</p></list-item><list-item><p>(iii) If the above difference persists, rigid-body refinement is tried.</p></list-item><list-item><p>(iv) If a difference of above 5% still persists, then five cycles of TLS refinement are tried (only if TLS tensors were extracted from the PDB file header) in an attempt to deal with possible corruption of the TLS tensors.</p></list-item><list-item><p>(v) If after these steps the difference between the reported and the calculated metrics is more than 10%, it is decided that something is inherently wrong with this PDB entry and the <italic>PDB_REDO</italic> pipelines stops prematurely.</p></list-item></list>New restraint files for compounds not yet in the <italic>REFMAC</italic> dictionary (Vagin <italic>et al.</italic>, 2004<xref ref-type="bibr" rid="bb51"> ▶</xref>) are generated automatically. The final values of <italic>R</italic>
<sub>calc</sub> and <italic>R</italic>
<sub>free,calc</sub> plus those of <italic>R</italic>
<sub>ratio</sub>, <italic>R</italic>
<sub>free,unb,calc</sub>, <italic>Z</italic>(<italic>R</italic>
<sub>free,calc</sub>), r.m.s.<italic>Z</italic>(bond)<sub>calc</sub> and r.m.s.<italic>Z</italic>(angle)<sub>calc</sub> are used as baseline values for further refinement.</p>
      </sec>
      <sec id="sec2.1.4">
        <label>2.1.4.</label>
        <title>Re-refinement
 
</title>
        <p>To get the most out of refinement in <italic>REFMAC</italic>, many parameters should be optimized. In the original <italic>PDB_REDO</italic> pipeline we only optimized the geometric restraint weight. Despite the presence of a robust and reliable option to automatically weight X-ray data and geometry in newer versions of <italic>REFMAC</italic>, we find that our search method can have advantages. We use the geometry-weight optimization and also systematically explore the usage of many other refinement strategies, as follows.<list list-type="simple"><list-item><p>(i) If <italic>SFCHECK</italic> finds a twin fraction of &gt;5%, twinning is evaluated in <italic>REFMAC</italic>. If <italic>REFMAC</italic> finds twin operators with <italic>R</italic>
<sub>merge</sub> &lt; 44% and twin fraction &gt;7%, refinement is performed with twin target functions.</p></list-item><list-item><p>(ii) Four different <italic>B</italic>-factor models are evaluated: anistropic <italic>B</italic> factors, isotropic <italic>B</italic> factors with TLS, isotropic <italic>B</italic> factors without TLS and one overall <italic>B</italic> factor with TLS. The selection of the optimal algorithm is discussed below.<list list-type="simple"><list-item><p>(1) If it is decided that anisotropic <italic>B</italic> factors cannot be used, the possibility of TLS refinement is tested by resetting all atomic <italic>B</italic> factors to the <italic>B</italic>
<sub>Wilson</sub> (or the average <italic>B</italic> factor at resolutions 4 Å or worse) and calculating <italic>R</italic>
<sub>TLS</sub> and <italic>R</italic>
<sub>free,TLS</sub>, followed by TLS refinement alone. Multiple TLS models are tested whenever possible: a simple model with one TLS group per chain, the TLS model extracted from the PDB header and any additional user-provided TLS models (for instance, from <italic>TLSMD</italic>; Painter &amp; Merritt, 2006<xref ref-type="bibr" rid="bb41"> ▶</xref>). The selection algorithm for the best TLS model is also discussed in §<xref ref-type="sec" rid="sec3"/>3. If TLS refinement decreases <italic>R</italic>
<sub>free</sub> with respect to <italic>R</italic>
<sub>free,TLS</sub>, the output TLS model will be used in further refinements as is.</p></list-item><list-item><p>(2) If individual <italic>B</italic> factors are used, the weight of the <italic>B</italic>-­factor restraints (which keep neighbouring <italic>B</italic> factors similar) is optimized by performing a grid search of up to seven different values. For each weight a short refinement is performed with automatic geometric restraint weighting. The selection algorithm for the best weight is discussed in §2.2.4<xref ref-type="sec" rid="sec2.2.4"/>.</p></list-item></list>
</p></list-item></list>After all these choices have been made, the actual re-refinement is performed. A riding hydrogen model is always used to optimally benefit from van der Waals restraints. Local NCS restraints (Murshudov <italic>et al.</italic>, 2011<xref ref-type="bibr" rid="bb38"> ▶</xref>) are used when applicable, regardless of the data resolution. In this re-refinement, up to seven different geometric restraint weights are used, meaning that a final model will be selected from a number of candidates; the selection algorithm is also discussed in §2.2.4<xref ref-type="sec" rid="sec2.2.4"/>.</p>
        <p>Our previous <italic>PDB_REDO</italic> results showed that re-refinement could benefit from making the search space for the geometric restraint weight resolution-dependent. We have performed this by assigning each input model to one of six different categories (Table 3<xref ref-type="table" rid="table3"> ▶</xref>) based on the resolution of the data and the number of X-ray reflections per atom. The latter is important because at a given data resolution the number of reflections per atom varies greatly depending on the solvent content: for example, at 3.0 Å resolution values of between 1.9 and 7.8 reflections per atom are observed. In addition to assigning the geometric restraint-weight search space, the ‘resolution’ categories are also used for determining the <italic>B</italic>-­factor restraint-weight search space and the application of ‘jelly-body’ restraints (Murshudov <italic>et al.</italic>, 2011<xref ref-type="bibr" rid="bb38"> ▶</xref>), which we use to stabilize the re-refinement of structures belonging to the two lowest resolution categories (‘vlow’ and ‘xlow’).</p>
      </sec>
      <sec id="sec2.1.5">
        <label>2.1.5.</label>
        <title>Rebuilding
 
</title>
        <p>The re-refinement results in a structure model with new (difference) electron-density maps. These maps are used to rebuild the structure model in four steps.<list list-type="simple"><list-item><p>(i) The program <italic>Centrifuge</italic> removes all waters with low weighted mean density fit to the 2<italic>mF</italic>
<sub>o</sub> − <italic>DF</italic>
<sub>c</sub> map [fit(ρ) &lt; 0.37]. This resolution-independent cutoff value used within <italic>PDB_REDO</italic> was optimized to minimize the false-positive rate, <italic>i.e.</italic> to ensure that waters were not deleted where they should be kept; however, water deletion and eventual addition remains a major area with need for future development.</p></list-item><list-item><p>(ii) The program <italic>pepflip</italic> (Joosten, Joosten <italic>et al.</italic>, 2011<xref ref-type="bibr" rid="bb25"> ▶</xref>) is used to flip the orientation of peptide planes in the model if this improves the fit of the peptide with, in order of importance, the <italic>mF</italic>
<sub>o</sub> − <italic>DF</italic>
<sub>c</sub> map at the position of the oxygen, the 2<italic>mF</italic>
<sub>o</sub> − <italic>DF</italic>
<sub>c</sub> map of the whole peptide and a combination of the two fits and the geometry, while maintaining or improving the backbone torsion angles with respect to the Ramachandran plot (Ramachandran <italic>et al.</italic>, 1963<xref ref-type="bibr" rid="bb44"> ▶</xref>) of the two residues involved.</p></list-item><list-item><p>(iii) The side chains are rebuilt in rotameric conformations, followed by refinement in real space, by the program <italic>SideAide</italic> (Joosten, Joosten <italic>et al.</italic>, 2011<xref ref-type="bibr" rid="bb25"> ▶</xref>) if this improves the fit to the 2<italic>mF</italic>
<sub>o</sub> − <italic>DF</italic>
<sub>c</sub> map. Missing side chains are added. Water molecules that are erroneously built at side-chain positions are removed in the process.</p></list-item><list-item><p>(iv) The model is validated with <italic>WHAT_CHECK</italic> and the results are used in a separate <italic>SideAide</italic> run to flip His, Asn and Gln side chains to improve hydrogen bonding, to flip Asp, Glu, Phe and Tyr side chains to standardize the χ<sub>2</sub> angle (χ<sub>3</sub> for Glu), unswap mixed-up N<sup>∊</sup> atoms in Arg to standardize the geometry and finally to fix (administrative) chirality errors in the C<sup>β</sup> atom of Thr, Ile and Val and the C<sup>γ</sup> atom of Leu. This second side-chain rebuilding run is needed to fix side chains that were not rebuilt in the previous step.</p></list-item></list>Only structures in the ‘atomic’, ‘high’, ‘medium’ and ‘low’ categories are included in rebuilding steps (ii), (iii) and (iv), since the maps are generally not clear enough for un­supervised rebuilding for the ‘vlow’ and ‘xlow’ categories.</p>
        <p>The rebuilt model is refined in <italic>REFMAC</italic> one last time. The TLS model (if used) is updated, followed by restrained refinement with the previously established refinement parameters but with three different geometric restraint weights: the optimal weight from the re-refinement, a slightly tighter restraint weight and a slightly looser one. The final model is selected using the same selection algorithm as used in the re-refinement.</p>
      </sec>
      <sec id="sec2.1.6">
        <label>2.1.6.</label>
        <title>Final output
 
</title>
        <p>The final model is validated with <italic>WHAT_CHECK</italic>. The validation scores and the <italic>R</italic> and <italic>R</italic>
<sub>free</sub> values are combined to give a web page for the <italic>PDB_REDO</italic> data bank and an unformatted file that can be used for data mining. Three-dimensional scenes are created that show the model atoms coloured by atomic movement, with warmer colours marking increasing atomic shifts with respect to the original structure model (Fig. 1<xref ref-type="fig" rid="fig1"> ▶</xref>), and the model atoms coloured by TLS group. The scenes can be visualized in the free viewer version of <italic>YASARA</italic> (Krieger <italic>et al.</italic>, 2002<xref ref-type="bibr" rid="bb34"> ▶</xref>). A plug-in for <italic>Coot</italic> (Emsley <italic>et al.</italic>, 2010<xref ref-type="bibr" rid="bb11"> ▶</xref>) is available to download and visualize <italic>PDB_REDO</italic> optimized structure models and their electron-density maps.</p>
      </sec>
    </sec>
    <sec id="sec2.2">
      <label>2.2.</label>
      <title>Decision-making algorithms in <italic>PDB_REDO</italic>
 
</title>
      <p>To be able to apply the <italic>PDB_REDO</italic> pipeline to the entire PDB, it was necessary to create decision-making algorithms that can deal with the many choices available when optimizing structure models without supervision or user input. Here, we show the result of our developments in the five main decision-making algorithms.</p>
      <sec id="sec2.2.1">
        <label>2.2.1.</label>
        <title>Using the <italic>R</italic>
<sub>free</sub> set
 
</title>
        <p>The introduction of the <italic>R</italic>
<sub>free</sub> metric (Brünger, 1992<xref ref-type="bibr" rid="bb6"> ▶</xref>) was an important step in macromolecular crystallography as it helped to detect overfitting and overrefinement of the model. However, until the mid-1990s many structures were refined without using <italic>R</italic>
<sub>free</sub>. Properly dealing with <italic>R</italic>
<sub>free</sub> sets is therefore essential for structure-model optimization; <italic>PDB_REDO</italic> deals with <italic>R</italic>
<sub>free</sub> sets using the following procedure.<list list-type="simple"><list-item><p>(i) The size of the <italic>R</italic>
<sub>free</sub> set is checked. If it is greater than the work set the sets are swapped. The <italic>R</italic>
<sub>free</sub> set is rejected if it contains more than 25% of all reflections or fewer than 500 reflections.</p></list-item><list-item><p>(ii) If an <italic>R</italic>
<sub>free</sub> set is not available, it is created using of 5% of the reflections, but in this case <italic>R</italic>
<sub>free,calc</sub> is treated as ‘biased’. If this set consists of less than 1000 reflections the percentage of reflections for the free set is increased to a maximum of 10%.</p></list-item><list-item><p>(iii) Test to see if the <italic>R</italic>
<sub>free</sub> set is really ‘free’, <italic>i.e.</italic> attempt to make sure that it was not previously used in refinement. The <italic>R</italic>
<sub>free,calc</sub> is treated as ‘biased’ if the following apply.<list list-type="simple"><list-item><p>(1) A new <italic>R</italic>
<sub>free</sub> set was created in the step above.</p></list-item><list-item><p>(2) <italic>R</italic>
<sub>free</sub> is less than <italic>R</italic> (<italic>R</italic>
<sub>free,calc</sub> &lt;<italic> R</italic>
<sub>calc</sub>).</p></list-item><list-item><p>(3) <italic>R</italic>
<sub>free,calc</sub> is much lower than expected with respect to <italic>R</italic>
<sub>free,calc,unb</sub> [<italic>Z</italic>(<italic>R</italic>
<sub>free,calc</sub>) &gt; 10.0].</p></list-item><list-item><p>(4) The difference between <italic>R</italic>
<sub>free,calc</sub> and <italic>R</italic>
<sub>calc</sub> is much smaller than expected [<italic>R</italic>
<sub>free,calc</sub> − <italic>R</italic>
<sub>calc</sub> &lt; 0.33 × (<italic>R</italic>
<sub>free,head</sub> − <italic>R</italic>
<sub>head</sub>)].</p></list-item></list>
</p></list-item><list-item><p>(iv) If <italic>R</italic>
<sub>free,calc</sub> is biased it is not used as baseline value for the structure optimization. <italic>R</italic>
<sub>free,calc,unb</sub> is used instead. At the same time the refinement protocol is adapted by increasing the number of refinement cycles and by resetting the atomic <italic>B</italic> factors to <italic>B</italic>
<sub>Wilson</sub>. When the refinement converges the new <italic>R</italic>
<sub>free</sub> values are considered to be ‘free’ again.</p></list-item></list>
</p>
      </sec>
      <sec id="sec2.2.2">
        <label>2.2.2.</label>
        <title>Selecting a <italic>B</italic>-factor model
 
</title>
        <p>The atomic displacement factors, commonly referred to as <italic>B</italic> factors, can be parameterized to represent various levels of detail: anisotropic <italic>B</italic> factors require nine parameters per atom, isotropic <italic>B</italic> factors four and a single <italic>B</italic> factor for all atoms only three. In <italic>PDB_REDO</italic> we assign the type of <italic>B</italic>-factor model based on the number of X-ray reflections per atom (RPA) using the following successive criteria.<list list-type="simple"><list-item><p>(i) If the atomic parameters including anisotropic <italic>B</italic> factors are twofold overdetermined, use anisotropic <italic>B</italic> factors (RPA &gt; 18).</p></list-item><list-item><p>(ii) If there are still 50% more reflections than parameters including anisotropic <italic>B</italic> factors (18 &gt; RPA &gt; 13.5) the atomic <italic>B</italic> factors are set to <italic>B</italic>
<sub>Wilson</sub> and two refinements using isotropic and anisotropic <italic>B</italic> factors are run using automatic geometric restraint weighting and default <italic>B</italic>-factor restraints. The program <italic>bselect</italic> (see below) is then used to pick the best <italic>B</italic>-­factor model.</p></list-item><list-item><p>(iii) If there are more than three reflections per atom (13.5 &gt; RPA &gt; 3) isotropic <italic>B</italic> factors are used.</p></list-item><list-item><p>(iv) If there are fewer than three reflections per atom (RPA &lt; 3) the TLS model is optimized first. The TLS model and automatic geometric restraint weighting are used for a refinement with isotropic <italic>B</italic> factors and tight <italic>B</italic>-factor restraints and a refinement with an overall <italic>B</italic> factor only; <italic>bselect</italic> is then used to pick the best <italic>B</italic>-factor model.</p></list-item><list-item><p>(v) If TLS cannot be used (<italic>e.g.</italic> because it is unstable in refinement) then isotropic <italic>B</italic> factors are used.</p></list-item></list>Making the <italic>B</italic>-factor model more detailed adds a large number of extra parameters to the structure model. This typically causes a drop in the <italic>R</italic> factor but also in <italic>R</italic>
<sub>free</sub> (Bacchi <italic>et al.</italic>, 1996<xref ref-type="bibr" rid="bb3"> ▶</xref>). As a result, a drop in <italic>R</italic>
<sub>free</sub> cannot be used to decide whether or not a more detailed <italic>B</italic>-factor model is acceptable. The Hamilton test (Hamilton, 1965<xref ref-type="bibr" rid="bb15"> ▶</xref>; Bacchi <italic>et al.</italic>, 1996<xref ref-type="bibr" rid="bb3"> ▶</xref>) provides a way to test the significance of a perceived model improvement resulting from adding more parameters to a model by looking at the ratio of <italic>R</italic>
<sub>w</sub> or <italic>R</italic>
<sub>free,w</sub> values for the simple and the more complex model. The problem with this method is that the degrees of freedom of the simple and the complex model must be known, which requires knowledge of the number of experimental data points and model parameters and the effective number of model restraints. The latter number can be described as the absolute number of restraints multiplied by a weight <italic>w</italic>. The value of <italic>w</italic> is not known, but a recent implementation of the Hamilton test (Merritt, 2012<xref ref-type="bibr" rid="bb37"> ▶</xref>) circumvents this issue by establishing a range for <italic>w</italic>
<sub>1</sub> for the basic restraints in both models and <italic>w</italic>
<sub>2</sub> for the extra restraints in the complex model and then checking all the possible values. The program <italic>bselect</italic> uses this method and other criteria to decide between two <italic>B</italic>-factor models in successive steps.<list list-type="simple"><list-item><p>(i) If the weighted value for the more complex model is higher than that of the simpler model (<italic>R</italic>
<sub>free,w,complex</sub> &gt; <italic>R</italic>
<sub>free,w,simple</sub>) the simpler model is used.</p></list-item><list-item><p>(ii) All possible combinations of <italic>w</italic>
<sub>1</sub> and <italic>w</italic>
<sub>2</sub> are used for Hamilton tests. The percentage of tests that gave an acceptable result (where ‘acceptable’ means that the more complex model is appropriate) is then calculated. If less than 30% of the Hamilton tests were acceptable, the simpler model is used. If more than 95% of the Hamilton tests were acceptable, the more complex model is used.</p></list-item><list-item><p>(iii) If the step above is inconclusive (acceptable tests between 30 and 95%), the complex model is examined by looking for signs of overrefinement and the simpler model is used if the <italic>Z</italic> score for <italic>R</italic>
<sub>free</sub> is too low [<italic>Z</italic>(<italic>R</italic>
<sub>free</sub>)<sub>complex</sub> &lt; −3.0]. If <italic>Z</italic>(<italic>R</italic>
<sub>free</sub>)<sub>complex</sub> cannot be calculated reliably (when the <italic>R</italic>
<sub>ratio</sub> calculation fails) we check the difference between the <italic>R</italic>
<sub>free</sub> and <italic>R</italic> of the complex model: if this is larger than a cutoff value (<italic>R</italic>
<sub>free,complex</sub> − <italic>R</italic>
<sub>complex</sub> &gt; <italic>cutoff</italic>, where <italic>cutoff</italic> is 4% for anisotropic <italic>B</italic> factors and 6% for isotropic <italic>B</italic> factors) then the simpler model is used. Finally, if the difference between the <italic>R</italic>
<sub>free</sub> and the <italic>R</italic> factor for the complex model is more than two times the difference for the simpler model [(<italic>R</italic>
<sub>free,</sub>
<sub>complex</sub> − <italic>R</italic>
<sub>complex</sub>) &gt; 2.0 × (<italic>R</italic>
<sub>free,</sub>
<sub>simple</sub> − <italic>R</italic>
<sub>simple</sub>)] then the simpler model is used. Otherwise, we consider that there are no signs of overrefinement and the more complex model is used.</p></list-item></list>
</p>
      </sec>
      <sec id="sec2.2.3">
        <label>2.2.3.</label>
        <title>Selecting the number of refinement cycles
 
</title>
        <p>A large number of <italic>REFMAC</italic> refinement runs are performed to try different parameters; thus, the number of internal refinement cycles becomes an important contributor to the time needed to optimize a model. Based on our experience with <italic>REFMAC</italic>, we use a set of empirical rules to assign the number of refinement cycles.<list list-type="simple"><list-item><p>(i) For rigid-body refinement, we use ten cycles when attempting to reproduce the <italic>R</italic> factor reported in the PDB header, <italic>R</italic>
<sub>head</sub> (see §2.2.2<xref ref-type="sec" rid="sec2.2.2"/>). Rigid-body refinement is also used for ‘legacy’ structure models predating 1990; in this case, 15 cycles are used since older structure models may be further away from convergence.</p></list-item><list-item><p>(ii) For TLS refinement, we use five cycles for reproducing <italic>R</italic>
<sub>head</sub> (see §2.2.2<xref ref-type="sec" rid="sec2.2.2"/>), ten cycles for optimizing the TLS model (15 cycles for ‘legacy’ models) and five cycles in the final model refinement.</p></list-item><list-item><p>(iii) During re-refinement, 20 cycles are used by default. If no TLS models are used, five additional cycles are introduced. In the cases where a new <italic>R</italic>
<sub>free</sub> was created 30 cycles are used, and finally when using anisotropic <italic>B </italic>factors 40 cycles are used since anisotropic refinement takes longer to converge. For ‘legacy’ models, 50 cycles are used by default and 60 cycles are used when using anisotropic <italic>B</italic> factors.</p></list-item><list-item><p>(iv) For choosing the <italic>B</italic>-factor model and weights, we use the same number of cycles as in re-refinement when deciding between individual isotropic <italic>B</italic> factors or one constrained <italic>B</italic> factor. For deciding between isotropic and anisotropic <italic>B</italic> factors 50 cycles are used. Finally, ten cycles are used for optimizing the <italic>B</italic>-factor restraint weight with TLS models and 15 cycles when TLS models are not used.</p></list-item></list>
</p>
      </sec>
      <sec id="sec2.2.4">
        <label>2.2.4.</label>
        <title>Selection of the optimal model from a set of refinement results
 
</title>
        <p>The TLS-model optimization, <italic>B</italic>-factor restraint-weight optimization, re-refinement and final refinement require the selection of the best model from a set of refinement results. The program <italic>picker</italic> selects the model with the best fit to the experimental data while minimizing the risk of overrefinement. To do this, the quality of the starting structure is also taken into account. <italic>Picker</italic> uses the following procedure.<list list-type="simple"><list-item><p>(i) Firstly, we establish <italic>R</italic>
<sub>co</sub> and <italic>R</italic>
<sub>free,co</sub> as cutoff values depending on the source of the models in question. <italic>R</italic>
<sub>TLS</sub> and <italic>R</italic>
<sub>free,TLS</sub> are used if the models originate from TLS-model optimization refinement; <italic>R</italic>
<sub>calc</sub> and <italic>R</italic>
<sub>free,calc</sub> are used in all other cases. If <italic>R</italic>
<sub>free,calc</sub> has been considered to be ‘biased’ then <italic>R</italic>
<sub>free,unb,calc</sub> is used instead of <italic>R</italic>
<sub>free,calc</sub>.</p></list-item><list-item><p>(ii) Similarly, r.m.s.<italic>Z</italic>(bond)<sub>co</sub> and r.m.s.<italic>Z</italic>(angle)<sub>co</sub> are established as geometry cutoff values. The default cutoff values are 1.0, but the values are increased to r.m.s.<italic>Z</italic>(bond)<sub>calc</sub> and r.m.s.<italic>Z</italic>(angle)<sub>calc</sub>, respectively, if these were greater than 1.0.</p></list-item><list-item><p>(iii) For each refinement condition <italic>i</italic>, <italic>Z</italic>(<italic>R</italic>
<sub>free</sub>)<sub><italic>i</italic></sub> and σ(<italic>R</italic>
<sub>free</sub>)<sub><italic>i</italic></sub> are calculated. From these, a maximum value for <italic>R</italic>
<sub>free</sub> is calculated [<italic>R</italic>
<sub>free,max,<italic>i</italic></sub> = <italic>R</italic>
<sub><italic>i</italic></sub> × <italic>R</italic>
<sub>ratio</sub> + 3.5 × σ(<italic>R</italic>
<sub>free</sub>)<sub><italic>i</italic></sub>]. <italic>R</italic>
<sub>free,max,<italic>i</italic></sub> is then set to the lower of <italic>R</italic>
<sub>free,max,<italic>i</italic></sub> and (<italic>R</italic>
<sub><italic>i</italic></sub> + 6%) to make sure that the difference between <italic>R</italic> and <italic>R</italic>
<sub>free</sub> is not too large. Finally, <italic>R</italic>
<sub>free,max,<italic>i</italic></sub> is set to the higher of <italic>R</italic>
<sub>free,max,<italic>i</italic></sub> and (<italic>R</italic>
<sub>free,co</sub>/<italic>R</italic>
<sub>co</sub> × <italic>R</italic>
<sub><italic>i</italic></sub>) to deal with structures that had a high initial <italic>R</italic>
<sub>free</sub>/<italic>R</italic> ratio.</p></list-item><list-item><p>(iv) After the cutoff values have been established, any model is rejected if a model metric exceeds the preset limits [r.m.s.<italic>Z</italic>(bond)<sub><italic>i</italic></sub> &gt; r.m.s.<italic>Z</italic>(bond)<sub>co</sub>, r.m.s.<italic>Z</italic>(angle)<sub><italic>i</italic></sub> &gt; r.m.s.<italic>Z</italic>(angle)<sub>co</sub>, <italic>R</italic>
<sub>free,<italic>i</italic></sub> &gt; <italic>R</italic>
<sub>free,max,<italic>i</italic></sub>, <italic>R</italic>
<sub>free,<italic>i</italic></sub> &gt; <italic>R</italic>
<sub>free,co</sub>). For structures in the ‘vlow’ and ‘xlow’ categories the difference between <italic>R</italic>
<sub>free</sub> and the <italic>R</italic> factor is also taken into account for model rejection [(<italic>R</italic>
<sub>free,<italic>i</italic></sub> − <italic>R</italic>
<sub><italic>i</italic></sub>) &gt; 2.0 × (<italic>R</italic>
<sub>free,co</sub> − <italic>R</italic>
<sub>co</sub>)].</p></list-item><list-item><p>(v) Finally, the optimal refinement is selected from the remaining conditions. The models with the lowest free likelihood (LL<sub>free</sub>) and the lowest <italic>R</italic>
<sub>free</sub> are selected. If these two models are different, that with the highest <italic>Z</italic>(<italic>R</italic>
<sub>free</sub>) is finally selected.</p></list-item></list>The algorithm in <italic>picker</italic> rejects all refinements if none pass the established criteria and the <italic>PDB_REDO</italic> pipeline adapts accordingly. Depending on the set of refinements evaluated by <italic>picker</italic>, TLS might not be used further in refinement or the <italic>B</italic>-­factor restraint weight can be set to the <italic>REFMAC</italic> default. If the evaluation after re-refinement does not produce a better model, the original structure is used in the subsequent rebuilding steps and the final refinement is performed with auto weighting for the geometric restraints.</p>
      </sec>
      <sec id="sec2.2.5">
        <label>2.2.5.</label>
        <title>Selection of atoms for exclusion from rebuilding
 
</title>
        <p>The first three steps of rebuilding are meant to be comprehensive, so by default all residues are considered. Negative selection is applied to ‘special’ residues for which automated unsupervised rebuilding is too risky or not needed.<list list-type="simple"><list-item><p>(i) <italic>Centrifuge</italic> ignores all waters involved in LINKs (see §2.1.2<xref ref-type="sec" rid="sec2.1.2"/>).</p></list-item><list-item><p>(ii) <italic>Pepflip</italic> ignores all residues in which the backbone N or the backbone O atom is involved in a LINK. Residues in the middle of secondary-structure elements, as designated by <italic>DSSP</italic> (Kabsch &amp; Sander, 1983<xref ref-type="bibr" rid="bb30"> ▶</xref>), are very unlikely candidates for flips. They are ignored as well to speed up peptide flipping.</p></list-item><list-item><p>(iii) <italic>SideAide</italic> ignores all side chains involved in LINK records and all side chains with multiple conformations.</p></list-item></list>The final rebuilding step uses positive selection of candidates based on a <italic>WHAT_CHECK</italic> validation report. However, the negative selectors above still apply.</p>
      </sec>
    </sec>
    <sec id="sec2.3">
      <label>2.3.</label>
      <title>Evaluation data set
 
</title>
      <p>We attempted to optimize all of the PDB entries with deposited X-­ray diffraction data (&gt;53 000) for inclusion in the <italic>PDB_REDO</italic> data bank. Fewer than 900 PDB entries (&lt;2%) cannot be used at the moment owing to various problems. The reasons for these missing entries are listed in the <italic>WHY_NOT</italic> data-bank annotation server (Joosten, te Beek <italic>et al.</italic>, 2011<xref ref-type="bibr" rid="bb27"> ▶</xref>). Some of the reasons for the exclusion of structures from the <italic>PDB_REDO</italic> data bank are as follows.<list list-type="simple"><list-item><p>(i) The atomic coordinates do not describe the entire asymmetric unit. This is mostly the case for PDB entries split over multiple files owing to limitations in the PDB format.</p></list-item><list-item><p>(ii) No <italic>R</italic> factor is given in the PDB header and it cannot be recovered from the literature. This is mostly a problem with unrefined low-resolution assemblies. </p></list-item><list-item><p>(iii) The <italic>R</italic> factor cannot be reproduced to within ten percentage points of the reported value. This can be caused by limitations in our current methods, but also by partially missing data or by deposition of the wrong experimental data.</p></list-item><list-item><p>(iv) The structure was determined by ‘other’ diffraction methods such as neutron, fibre or powder diffraction.</p></list-item><list-item><p>(v) The model contains only C<sup>α</sup> atoms.</p></list-item></list>Here, we discuss the results obtained based on a random subset of the PDB consisting of 12 000 structure models deposited between 1995 and 2010.</p>
    </sec>
  </sec>
  <sec id="sec3">
    <label>3.</label>
    <title>Results and discussion
 
</title>
    <sec id="sec3.1">
      <label>3.1.</label>
      <title>High-throughput testing
 
</title>
      <p>The new <italic>PDB_REDO</italic> pipeline was tested with our evaluation data set of 12 000 PDB entries. Table 4<xref ref-type="table" rid="table4"> ▶</xref> shows a summary of structure-quality metrics for the data set in the original PDB entry, the re-refined structure model and the final re-refined and rebuilt structure model. On average the improvement in <italic>R</italic>
<sub>free</sub> was 1.8%, corresponding to a significant relative improvement of 6.4σ(<italic>R</italic>
<sub>free</sub>). A total of over 70 000 unsatisfied hydrogen-bond donors or acceptors and more than 310 000 atomic bumps were removed. Over 200 000 erroneous water molecules were removed and 57 000 previously missing side chains were built in total. On average, only a single peptide flip was needed in every second model (still accounting for about 7000 wrongly modelled peptides in total). The least common fix of those attempted was explicit chirality fixes of threonine, valine and isoleucine C<sup>β</sup> atoms and leucine C<sup>γ</sup> atoms, which were applied only 12 times in the entire data set.</p>
      <p>To obtain a better perspective on the performance of <italic>PDB_REDO</italic> on individual PDB entries, we made ‘traffic-light’ diagrams for the structure-quality metrics (Fig. 2<xref ref-type="fig" rid="fig2"> ▶</xref>). Each diagram shows the percentage of structure models that became better, stayed the same or became worse after re-refinement and rebuilding, according to different metrics. Depending on the metric used, 31–75% of the models improved on re-refinement and 45–86% of the models improved on full optimization including rebuilding. The greatest improvements are found in <italic>R</italic>
<sub>free</sub> and in the side-chain rotamer and Ramachandran plot <italic>Z</italic> scores (Hooft <italic>et al.</italic>, 1997<xref ref-type="bibr" rid="bb18"> ▶</xref>). The first two are explicitly optimized and such a result would be expected. However, the Ramachandran plot improvement is an independent metric and its improvement is particularly encouraging. The typical distribution of backbone torsion angles in the Ramachandran plot is brought on by steric hindrance; thus, the improvement of the Ramachandran plot <italic>Z</italic> score is very likely to be the result of using riding H atoms and tight van der Waals restraints in the refinement, which enforce proper steric hindrance. The change in the Ramachandran plot <italic>Z</italic> score strongly depends on resolution (Fig. 3<xref ref-type="fig" rid="fig3"> ▶</xref>), with <italic>PDB_REDO</italic> having a stronger impact at resolutions lower than 2.0 Å. This is partly a natural consequence of the original distribution in <italic>Z</italic> scores (there is more room for improvement at lower resolution), but the riding H atoms might also play an important role, since it was (and still is) common practice to not use riding H atoms in lower resolution refinement. This practice is particularly strange considering that riding H atoms add no extra parameters to the refinement, but do add extra restraints or, from an alternative perspective, make already existing van de Waals restraints more effective. This leads to an improvement of the effective data-to-parameter ratio, which is especially important at low resolution.</p>
      <p>The <italic>PDB_REDO</italic> pipeline now contains partial model rebuilding and not only re-refinement as in its first implementation. The added value of rebuilding, in combination with a second round of refinement, is made apparent by comparing the distributions in the re-refined and final structure models. In most cases, the rebuilding and extra refinement increases the fraction of models that improve. Interestingly, however, the new steps also increase the fraction of models that become worse according to some of the criteria: this is most evident for <italic>R</italic>
<sub>free</sub> and the number of atomic bumps (an additional 6% of all models became worse according to these criteria).</p>
      <p>For the case of <italic>R</italic>
<sub>free</sub>, there is however a rather simple explanation. If after the first re-refinement <italic>PDB_REDO</italic> fails to find optimal refinement settings, the model is still rebuilt and refined with automatic geometric restraint weighting. This is likely to explain why the percentage of models with worse <italic>R</italic>
<sub>free</sub> increases in the re-refined and rebuilt set of models. Indeed, for 72% of the models that end up with a worse <italic>R</italic>
<sub>free</sub>, we had failed to find a good re-refinement setting in the first place. This is in sharp contrast to the 11% we find in all test cases (incidentally, this is an enormous improvement over the 33% in the first version of <italic>PDB_REDO</italic>). The difference that successful re-refinement makes is made clear in Fig. 4<xref ref-type="fig" rid="fig4"> ▶</xref>. In the cases where re-refinement succeeds, all but five structures end up with better free <italic>R</italic> factors at the end. In the cases where re-­refinement fails, even if <italic>R</italic>
<sub>free</sub> still improves on average regardless of resolution, many structures end up having a higher <italic>R</italic>
<sub>free</sub> than that recorded in the header of the starting PDB file. This means that further development of the pipeline should focus on better dealing with this problem or avoiding the problem as much as possible. The latter can be achieved by increasing the number of restraints, <italic>e.g.</italic> by applying jelly-body restraints at higher resolutions or by extending the restraint-weight search space. Optimization of the bulk-solvent mask parameters (the probe size and the shrinkage factor) has recently been implemented and this may also improve the re-refinement results. In 12% of the cases with increased final <italic>R</italic>
<sub>free</sub> the initially calculated <italic>R</italic>
<sub>free</sub> was significantly higher than the <italic>R</italic>
<sub>free</sub> reported in the PDB header [<italic>R</italic>
<sub>free,calc</sub> &gt; 5σ(<italic>R</italic>
<sub>free</sub>)<sub>calc</sub> + <italic>R</italic>
<sub>free,head</sub>], while for the total data set this was 5%. Reproducing <italic>R</italic> factors is known to be a challenging problem (Kleywegt <italic>et al.</italic>, 2004<xref ref-type="bibr" rid="bb32"> ▶</xref>; Afonine <italic>et al.</italic>, 2010<xref ref-type="bibr" rid="bb1"> ▶</xref>) and many problems can be reduced to a lack of knowledge of the original refinement parameters, <italic>e.g.</italic> about the treatment of bulk solvent. Because the annotation of new PDB entries has improved substantially, we can now adapt <italic>Extractor</italic> to obtain a more detailed description of the original refinement settings. These collectively indicate that part of the problem with worsened <italic>R</italic>
<sub>free</sub> is partly artificial.</p>
      <p>Deterioration in <italic>R</italic>
<sub>free</sub> does not mean that the model becomes worse in terms of all other quality metrics. In fact, this is very rare and only occurs in 0.5% (58 structures) of the test set (Fig. 4<xref ref-type="fig" rid="fig4"> ▶</xref>); deterioration of three or more metrics is still rare and occurs in 6% of the test set. The opposite, improvement of all model-quality metrics, occurs in 16% (1934 structures) of the structures (Fig. 4<xref ref-type="fig" rid="fig4"> ▶</xref>), while improvement of three or more quality metrics occurs in 85% of structures in the evaluation set (Fig. 5<xref ref-type="fig" rid="fig5"> ▶</xref>).</p>
    </sec>
    <sec id="sec3.2">
      <label>3.2.</label>
      <title>More constructive validation
 
</title>
      <p>During high-throughput testing of <italic>PDB_REDO</italic> on existing PDB entries, more than 800 fixable errors were encountered and were reported back to the PDB. Although mostly trivial annotation problems, these errors can be devastating when structure models are used in automated computational studies. Most issues were resolved at short notice, fixing the problem for all PDB users rather than just for <italic>PDB_REDO</italic>.</p>
    </sec>
    <sec id="sec3.3">
      <label>3.3.</label>
      <title>Outlook
 
</title>
      <sec id="sec3.3.1">
        <label>3.3.1.</label>
        <title>Ongoing development
 
</title>
        <p>The results shown here are encouraging, but also show that there is still ample room for improvement. For instance, the sulfate ion in Fig. 1<xref ref-type="fig" rid="fig1"> ▶</xref>(<italic>d</italic>) was distorted, which was traced back to a problem with chiral volume restraints for the S atom. In real-life chemistry the O atoms are equivalent and the sulfur is not chiral. However, the O atoms are different computationally (they have different names), which makes the sulfur chiral during refinement. This means that a swap of any two O atoms in sulfate inverts the chirality of the sulfur. The chiral volume restraints now erroneously push the refinement towards improving the chiral volume, resulting in a distorted molecule. We are currently testing a new tool, called <italic>chiron</italic>, that fixes these computational chirality problems. In the long term, chemical chirality problems (where the atomic coordinates do not match the residue name) should also be fixed by either renaming the compound or rebuilding it. However, this can only be performed when reliable information about the chemical nature of the compound can be obtained automatically, and touches on the issue of constructive validation of ligand entries in the PDB, arguably a more important, but also a significantly more complex, task.</p>
        <p>The refinement of a structure model with NCS constraints is available in <italic>REFMAC</italic> and implemented in <italic>PDB_REDO</italic>. Unfortunately, using this option often requires manual intervention because the so-called MTRIX records that describe strict NCS in PDB files frequently have annotation errors. We are working on a decision-making algorithm that can properly deal with such cases.</p>
        <p>Our current rebuilding tools can be improved to allow support for noncanonical amino acids such as methylated lysines. Also, more substantial backbone rebuilding, for instance by building missing or poorly defined stretches of many residues, is a target for further improvement of <italic>PDB_REDO</italic>. Adding multiple conformations of side chains and of stretches of main chain presents an additional challenge.</p>
        <p>Representation of the optimization results has become much more important now that we are actively changing structure models. We currently use molecular scenes from <italic>YASARA</italic> to highlight changes in the model, but this requires that installation of software and can only show one thing at a time. An approach such as Proteopedia (Hodis <italic>et al.</italic>, 2008<xref ref-type="bibr" rid="bb17"> ▶</xref>; Prilusky <italic>et al.</italic>, 2011<xref ref-type="bibr" rid="bb43"> ▶</xref>) could be more flexible and could allow the visualization of results directly in a web browser. Such a tool can allow us to highlight peptides that have been flipped or waters that have been removed.</p>
        <p>The current model-quality <italic>Z</italic> scores are robust metrics, but are somewhat less comprehensible by statistically unaware users than, for example, the percentile scores used in <italic>MolProbity</italic> (Chen <italic>et al.</italic>, 2010<xref ref-type="bibr" rid="bb46"> ▶</xref>); the percentile scores have, besides obvious advantages, some caveats for asymmetric distributions. In addition, the absolute number of bumps that we use in our reports can cause misinterpretation, simply because it does not account for the severity of the bumps. This can lead to misleading results: in absolute terms ten bumps with atomic overlaps of 0.05 Å are worse than a single bump with overlap 0.5 Å even though the former is likely the result of suboptimal restraints and the latter of a fitting error. A new metric for bumps should be developed. Local measures for the fit to the experimental data are not yet included in the <italic>PDB_REDO</italic> pipeline and should be added.</p>
        <p>In the near future, the brief validation reports proposed by the PDB Validation Task Force (Read <italic>et al.</italic>, 2012<xref ref-type="bibr" rid="bb45"> ▶</xref>) are very likely to become the preferred way of presenting <italic>PDB_REDO</italic> results. The relative metrics that are recommended for adoption in this report (and are under development in the PDB) can and should be implemented comparing <italic>PDB_REDO</italic> structures both against average PDB structures but also against average <italic>PDB_REDO</italic> structures.</p>
      </sec>
      <sec id="sec3.3.2">
        <label>3.3.2.</label>
        <title>Using <italic>PDB_REDO</italic>
 
</title>
        <p>The <italic>PDB_REDO</italic> pipeline can also be used to refine structures in the process of finalizing a structure in any laboratory. We now regularly employ <italic>PDB_REDO</italic> in our laboratory, usually to optimize near-complete models, but sometimes as early as straight after molecular replacement. While the software is available for download at <ext-link ext-link-type="uri" xlink:href="http://www.cmbi.ru.nl/pdb_redo">http://www.cmbi.ru.nl/pdb_redo</ext-link> for use in one’s own laboratory (see, for example, Peng <italic>et al.</italic>, 2010<xref ref-type="bibr" rid="bb42"> ▶</xref>; Guan <italic>et al.</italic>, 2011<xref ref-type="bibr" rid="bb14"> ▶</xref>), it is admittedly not straightforward to install and has several system dependencies at the moment. We are also working on a <italic>PDB_REDO</italic> web server that will provide a more user-friendly way to use the <italic>PDB_REDO</italic> pipeline in the near future.</p>
        <p>We encourage the usage of <italic>PDB_REDO</italic> prior to structure deposition because it can improve the structure model and its interpretation. It must also be noted that <italic>PDB_REDO</italic> chases a moving target: unlike the PDB models, the <italic>PDB_REDO</italic> data bank models are not static and must all eventually be replaced or supplemented by a new version incorporating new methodological advances.</p>
        <p>Individual entries in the <italic>PDB_REDO</italic> data bank (<ext-link ext-link-type="uri" xlink:href="http://www.cmbi.ru.nl/pdb_redo">http://www.cmbi.ru.nl/pdb_redo</ext-link>) can be used for any structural biology study, <italic>e.g.</italic> for homology modelling (van der Wijst <italic>et al.</italic>, 2010<xref ref-type="bibr" rid="bb53"> ▶</xref>; Flueck <italic>et al.</italic>, 2011<xref ref-type="bibr" rid="bb12"> ▶</xref>). Importantly, the collection of models can also be used as a homogeneously treated data set for statistical analysis of structure models. For example, the Ramachandran plot quality (Fig. 3<xref ref-type="fig" rid="fig3"> ▶</xref>) or average r.m.s.<italic>Z</italic>(angle) (Fig. 6<xref ref-type="fig" rid="fig6"> ▶</xref>) distributions in the <italic>PDB_REDO</italic> differ distinctly from those in the PDB. These distributions can be used to define new refinement targets and new criteria for choosing reliable water molecules or to construct (stricter) validation criteria (Kota <italic>et al.</italic>, 2011<xref ref-type="bibr" rid="bb55"> ▶</xref>). Further development to alleviate all cases in which some models deteriorate according at least to some criteria will be required before the full potential of <italic>PDB_REDO</italic> can be unleashed for the community.</p>
      </sec>
    </sec>
  </sec>
  <sec id="sec4">
    <label>4.</label>
    <title>Conclusions
 
</title>
    <p>The natural and constructive follow-up to structure model validation is to improve the model based on the validation results, as is now common practice by competent X-ray crystallographers. The process of improving the model still requires many decisions to be taken by crystallographers. The <italic>PDB_REDO</italic> pipeline combines refinement and model rebuilding with a decision-making framework that can autonomously optimize structure models. It makes ‘constructive validation’ possible without the need for manual intervention. This is particularly important for structure models in the PDB, which are never updated otherwise. Applying the <italic>PDB_REDO</italic> pipeline to 12 000 random PDB entries showed that the majority of PDB entries can be improved according to commonly accepted quality criteria. This improvement is resolution-dependent: greater improvement occurs at lower resolution. Real-space model rebuilding has substantial added value to re-refinement, especially for improving geometrical targets. The limiting factors to improving models appear to be in finding optimal refinement parameters, but also in extending the scope of rebuilding to larger portions of the main chain and adding multiple conformations. The final hurdles are likely to be uniform and reliable water modelling, and last (but by no means least) the PDB-wide rebuilding of additional macromolecules (nucleic acids and carbohydrates) and the various hetero-compounds (ligands) bound to protein structures.</p>
  </sec>
</body>
<back>
  <ack>
    <p>The authors thank the National Computing Facilities Foundation (NCF) for the use of supercomputer facilities with financial support from the Netherlands Organization for Scientific Research (NWO). RPJ is supported by a Veni grant from NWO (722.011.011).</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="bb1">
      <mixed-citation publication-type="other">Afonine, P. V., Grosse-Kunstleve, R. W., Chen, V. B., Headd, J. J., Moriarty, N. W., Richardson, J. S., Richardson, D. C., Urzhumtsev, A., Zwart, P. H. &amp; Adams, P. D. (2010). <italic>J. Appl. Cryst.</italic>
<bold>43</bold>, 669–676.</mixed-citation>
    </ref>
    <ref id="bb2">
      <mixed-citation publication-type="other">Akiba, T., Ishii, N., Rashid, N., Morikawa, M., Imanaka, T. &amp; Harata, K. (2005). <italic>Nucleic Acids Res.</italic>
<bold>33</bold>, 3412–3423.</mixed-citation>
    </ref>
    <ref id="bb3">
      <mixed-citation publication-type="other">Bacchi, A., Lamzin, V. S. &amp; Wilson, K. S. (1996). <italic>Acta Cryst.</italic> D<bold>52</bold>, 641–646.</mixed-citation>
    </ref>
    <ref id="bb4">
      <mixed-citation publication-type="other">Berman, H., Henrick, K. &amp; Nakamura, H. (2003). <italic>Nature Struct. Biol.</italic>
<bold>10</bold>, 980.</mixed-citation>
    </ref>
    <ref id="bb5">
      <mixed-citation publication-type="other">Bernstein, F. C., Koetzle, T. F., Williams, G. J., Meyer, E. F., Brice, M. D., Rodgers, J. R., Kennard, O., Shimanouchi, T. &amp; Tasumi, M. (1977). <italic>J. Mol. Biol.</italic>
<bold>112</bold>, 535–542.</mixed-citation>
    </ref>
    <ref id="bb6">
      <mixed-citation publication-type="other">Brünger, A. T. (1992). <italic>Nature (London)</italic>, <bold>355</bold>, 472–475.</mixed-citation>
    </ref>
    <ref id="bb46">
      <mixed-citation publication-type="other">Chen, V. B., Arendall, W. B., Headd, J. J., Keedy, D. A., Immormino, R. M., Kapral, G. J., Murray, L. W., Richardson, J. S. &amp; Richardson, D. C. (2010). <italic>Acta Cryst.</italic> D<bold>66</bold>, 12–21.</mixed-citation>
    </ref>
    <ref id="bb8">
      <mixed-citation publication-type="other">Davis, I. W., Murray, L. W., Richardson, J. S. &amp; Richardson, D. C. (2004). <italic>Nucleic Acids Res.</italic>
<bold>32</bold>, W615–W619.</mixed-citation>
    </ref>
    <ref id="bb9">
      <mixed-citation publication-type="other">Diamond, R. (1971). <italic>Acta Cryst.</italic> A<bold>27</bold>, 436–452.</mixed-citation>
    </ref>
    <ref id="bb10">
      <mixed-citation publication-type="other">Emsley, P. &amp; Cowtan, K. (2004). <italic>Acta Cryst.</italic> D<bold>60</bold>, 2126–2132.</mixed-citation>
    </ref>
    <ref id="bb11">
      <mixed-citation publication-type="other">Emsley, P., Lohkamp, B., Scott, W. G. &amp; Cowtan, K. (2010). <italic>Acta Cryst.</italic> D<bold>66</bold>, 486–501.</mixed-citation>
    </ref>
    <ref id="bb12">
      <mixed-citation publication-type="other">Flueck, C. E., Pandey, A. V., Dick, B., Camats, N., Fernandez-Cancio, M., Clemente, M., Gussinye, M., Carrascosa, A., Mullis, P. E. &amp; Audi, L. (2011). <italic>PLoS One</italic>, <bold>6</bold>, e20178.</mixed-citation>
    </ref>
    <ref id="bb13">
      <mixed-citation publication-type="other">French, S. &amp; Wilson, K. (1978). <italic>Acta Cryst.</italic> A<bold>34</bold>, 517–525.</mixed-citation>
    </ref>
    <ref id="bb14">
      <mixed-citation publication-type="other">Guan, R., Ma, L.-C., Leonard, P. G., Amer, B. R., Sridharan, H., Zhao, C., Krug, R. M. &amp; Montelione, G. T. (2011). <italic>Proc. Natl Acad. Sci. USA</italic>, <bold>108</bold>, 13468–13473.</mixed-citation>
    </ref>
    <ref id="bb15">
      <mixed-citation publication-type="other">Hamilton, W. C. (1965). <italic>Acta Cryst.</italic>
<bold>18</bold>, 502–510.</mixed-citation>
    </ref>
    <ref id="bb16">
      <mixed-citation publication-type="other">Henrick, K. <italic>et al.</italic> (2008). <italic>Nucleic Acids Res.</italic>
<bold>36</bold>, D426–D433.</mixed-citation>
    </ref>
    <ref id="bb17">
      <mixed-citation publication-type="other">Hodis, E., Prilusky, J., Martz, E., Silman, I., Moult, J. &amp; Sussman, J. L. (2008). <italic>Genome Biol.</italic>
<bold>9</bold>, R121.</mixed-citation>
    </ref>
    <ref id="bb18">
      <mixed-citation publication-type="other">Hooft, R. W., Sander, C. &amp; Vriend, G. (1997). <italic>Comput. Appl. Biosci.</italic>
<bold>13</bold>, 425–430.</mixed-citation>
    </ref>
    <ref id="bb19">
      <mixed-citation publication-type="other">Hooft, R. W., Vriend, G., Sander, C. &amp; Abola, E. E. (1996). <italic>Nature (London)</italic>, <bold>381</bold>, 272.</mixed-citation>
    </ref>
    <ref id="bb20">
      <mixed-citation publication-type="other">James, L. C., Jones, P. C., McCoy, A., Tennent, G. A., Pepys, M. B., Famm, K. &amp; Winter, G. (2007). <italic>J. Mol. Biol.</italic>
<bold>367</bold>, 603–608.</mixed-citation>
    </ref>
    <ref id="bb21">
      <mixed-citation publication-type="other">James, L. C., Roversi, P. &amp; Tawfik, D. S. (2003). <italic>Science</italic>, <bold>299</bold>, 1362–1367.</mixed-citation>
    </ref>
    <ref id="bb22">
      <mixed-citation publication-type="other">Jauch, R., Jäkel, S., Netter, C., Schreiter, K., Aicher, B., Jäckle, H. &amp; Wahl, M. C. (2005). <italic>Structure</italic>, <bold>13</bold>, 1559–1568.</mixed-citation>
    </ref>
    <ref id="bb23">
      <mixed-citation publication-type="other">Jones, T. A. (1978). <italic>J. Appl. Cryst.</italic>
<bold>11</bold>, 268–272.</mixed-citation>
    </ref>
    <ref id="bb24">
      <mixed-citation publication-type="other">Jones, T. A., Zou, J.-Y., Cowan, S. W. &amp; Kjeldgaard, M. (1991). <italic>Acta Cryst.</italic> A<bold>47</bold>, 110–119.</mixed-citation>
    </ref>
    <ref id="bb25">
      <mixed-citation publication-type="other">Joosten, R. P., Joosten, K., Cohen, S. X., Vriend, G. &amp; Perrakis, A. (2011). <italic>Bioinformatics</italic>, <bold>27</bold>, 3392–3398.</mixed-citation>
    </ref>
    <ref id="bb26">
      <mixed-citation publication-type="other">Joosten, R. P., Salzemann, J. <italic>et al.</italic> (2009). <italic>J. Appl. Cryst.</italic>
<bold>42</bold>, 376–384.</mixed-citation>
    </ref>
    <ref id="bb27">
      <mixed-citation publication-type="other">Joosten, R. P., te Beek, T. A., Krieger, E., Hekkelman, M. L., Hooft, R. W., Schneider, R., Sander, C. &amp; Vriend, G. (2011). <italic>Nucleic Acids Res.</italic>
<bold>39</bold>, D411–D419.</mixed-citation>
    </ref>
    <ref id="bb28">
      <mixed-citation publication-type="other">Joosten, R. P. &amp; Vriend, G. (2007). <italic>Science</italic>, <bold>317</bold>, 195–196.</mixed-citation>
    </ref>
    <ref id="bb29">
      <mixed-citation publication-type="other">Joosten, R. P., Womack, T., Vriend, G. &amp; Bricogne, G. (2009). <italic>Acta Cryst.</italic> D<bold>65</bold>, 176–185.</mixed-citation>
    </ref>
    <ref id="bb30">
      <mixed-citation publication-type="other">Kabsch, W. &amp; Sander, C. (1983). <italic>Biopolymers</italic>, <bold>22</bold>, 2577–2637.</mixed-citation>
    </ref>
    <ref id="bb31">
      <mixed-citation publication-type="other">Kang, S. A., Marjavaara, P. J. &amp; Crane, B. R. (2004). <italic>J. Am. Chem. Soc.</italic>
<bold>126</bold>, 10836–10837.</mixed-citation>
    </ref>
    <ref id="bb32">
      <mixed-citation publication-type="other">Kleywegt, G. J., Harris, M. R., Zou, J., Taylor, T. C., Wählby, A. &amp; Jones, T. A. (2004). <italic>Acta Cryst.</italic> D<bold>60</bold>, 2240–2249.</mixed-citation>
    </ref>
    <ref id="bb33">
      <mixed-citation publication-type="other">Kleywegt, G. J. &amp; Jones, T. A. (1996). <italic>Acta Cryst.</italic> D<bold>52</bold>, 829–832.</mixed-citation>
    </ref>
    <ref id="bb55">
      <mixed-citation publication-type="other">Kota, P., Ding, F., Ramachandran, S. &amp; Dokholyan, N. V. (2011). <italic>Bioinformatics</italic>, <bold>27</bold>, 2209–2215.</mixed-citation>
    </ref>
    <ref id="bb34">
      <mixed-citation publication-type="other">Krieger, E., Koraimann, G. &amp; Vriend, G. (2002). <italic>Proteins</italic>, <bold>47</bold>, 393–402.</mixed-citation>
    </ref>
    <ref id="bb35">
      <mixed-citation publication-type="other">Laskowski, R. A., MacArthur, M. W., Moss, D. S. &amp; Thornton, J. M. (1993). <italic>J. Appl. Cryst.</italic>
<bold>26</bold>, 283–291.</mixed-citation>
    </ref>
    <ref id="bb36">
      <mixed-citation publication-type="other">Lütteke, T. &amp; von der Lieth, C. W. (2004). <italic>BMC Bioinformatics</italic>, <bold>5</bold>, 69.</mixed-citation>
    </ref>
    <ref id="bb37">
      <mixed-citation publication-type="other">Merritt, E. A. (2012). <italic>Acta Cryst.</italic> D<bold>68</bold>, 468–477.</mixed-citation>
    </ref>
    <ref id="bb38">
      <mixed-citation publication-type="other">Murshudov, G. N., Skubák, P., Lebedev, A. A., Pannu, N. S., Steiner, R. A., Nicholls, R. A., Winn, M. D., Long, F. &amp; Vagin, A. A. (2011). <italic>Acta Cryst.</italic> D<bold>67</bold>, 355–367.</mixed-citation>
    </ref>
    <ref id="bb39">
      <mixed-citation publication-type="other">Murshudov, G. N., Vagin, A. A. &amp; Dodson, E. J. (1997). <italic>Acta Cryst.</italic> D<bold>53</bold>, 240–255.</mixed-citation>
    </ref>
    <ref id="bb40">
      <mixed-citation publication-type="other">Nayal, M. &amp; Di Cera, E. (1996). <italic>J. Mol. Biol.</italic>
<bold>256</bold>, 228–234.</mixed-citation>
    </ref>
    <ref id="bb41">
      <mixed-citation publication-type="other">Painter, J. &amp; Merritt, E. A. (2006). <italic>Acta Cryst.</italic> D<bold>62</bold>, 439–450.</mixed-citation>
    </ref>
    <ref id="bb42">
      <mixed-citation publication-type="other">Peng, Y.-H., Coumar, M. S., Leou, J.-S., Wu, J.-S., Shiao, H.-Y., Lin, C.-H., Lin, W.-H., Lien, T. W., Chen, X., Hsu, J. T.-A., Chao, Y.-S., Huang, C.-F., Lyu, P.-C., Hsieh, H.-P. &amp; Wu, S.-Y. (2010). <italic>ChemMedChem</italic>, <bold>5</bold>, 1707–1716.</mixed-citation>
    </ref>
    <ref id="bb43">
      <mixed-citation publication-type="other">Prilusky, J., Hodis, E., Canner, D., Decatur, W. A., Oberholser, K., Martz, E., Berchanski, A., Harel, M. &amp; Sussman, J. L. (2011). <italic>J. Struct. Biol.</italic>
<bold>175</bold>, 244–252.</mixed-citation>
    </ref>
    <ref id="bb44">
      <mixed-citation publication-type="other">Ramachandran, G. N., Ramakrishnan, C. &amp; Sasisekharan, V. (1963). <italic>J. Mol. Biol.</italic>
<bold>7</bold>, 95–99.</mixed-citation>
    </ref>
    <ref id="bb45">
      <mixed-citation publication-type="other">Read, R. J. <italic>et al.</italic> (2012). <italic>Structure</italic>, <bold>19</bold>, 1395–1412.</mixed-citation>
    </ref>
    <ref id="bb56">
      <mixed-citation publication-type="other">Richardson, J. S. <italic>et al.</italic> (2008). <italic>RNA</italic>, <bold>14</bold>, 465–481.<italic>Structure</italic>, <bold>19</bold>, 1395–1412.</mixed-citation>
    </ref>
    <ref id="bb47">
      <mixed-citation publication-type="other">Schomaker, V. &amp; Trueblood, K. N. (1968). <italic>Acta Cryst.</italic> B<bold>24</bold>, 63–76.</mixed-citation>
    </ref>
    <ref id="bb48">
      <mixed-citation publication-type="other">Silvian, L., Jin, P., Carmillo, P., Boriack-Sjodin, P. A., Pelletier, C., Rushe, M., Gong, B., Sah, D., Pepinsky, B. &amp; Rossomando, A. (2006). <italic>Biochemistry</italic>, <bold>45</bold>, 6801–6812.</mixed-citation>
    </ref>
    <ref id="bb49">
      <mixed-citation publication-type="other">Tickle, I. J., Laskowski, R. A. &amp; Moss, D. S. (1998). <italic>Acta Cryst.</italic> D<bold>54</bold>, 547–557.</mixed-citation>
    </ref>
    <ref id="bb50">
      <mixed-citation publication-type="other">Tickle, I. J., Laskowski, R. A. &amp; Moss, D. S. (2000). <italic>Acta Cryst.</italic> D<bold>56</bold>, 442–450.</mixed-citation>
    </ref>
    <ref id="bb51">
      <mixed-citation publication-type="other">Vagin, A. A., Steiner, R. A., Lebedev, A. A., Potterton, L., McNicholas, S., Long, F. &amp; Murshudov, G. N. (2004). <italic>Acta Cryst.</italic> D<bold>60</bold>, 2184–2195.</mixed-citation>
    </ref>
    <ref id="bb52">
      <mixed-citation publication-type="other">Vaguine, A. A., Richelle, J. &amp; Wodak, S. J. (1999). <italic>Acta Cryst.</italic> D<bold>55</bold>, 191–205.</mixed-citation>
    </ref>
    <ref id="bb53">
      <mixed-citation publication-type="other">van der Wijst, J., Glaudemans, B., Venselaar, H., Nair, A. V., Forst, A. L., Hoenderop, J. G. &amp; Bindels, R. J. (2010). <italic>J. Biol. Chem.</italic>
<bold>285</bold>, 171–178.</mixed-citation>
    </ref>
    <ref id="bb7">
      <mixed-citation publication-type="other">Winn, M. D. <italic>et al.</italic> (2011). <italic>Acta Cryst.</italic> D<bold>67</bold>, 235–242.</mixed-citation>
    </ref>
    <ref id="bb54">
      <mixed-citation publication-type="other">Winn, M. D., Isupov, M. N. &amp; Murshudov, G. N. (2001). <italic>Acta Cryst.</italic> D<bold>57</bold>, 122–133.</mixed-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="fig1" position="float">
    <label>Figure 1</label>
    <caption>
      <p><italic>YASARA</italic> scene showing the changes made to PDB entry <ext-link ext-link-type="uri" xlink:href="http://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=2ask">2ask</ext-link> (Silvian <italic>et al.</italic>, 2006<xref ref-type="bibr" rid="bb48"> ▶</xref>) by <italic>PDB_REDO</italic>. The atoms are coloured by atomic shift, with warmer colours marking larger shifts. (<italic>a</italic>) Overview of the structure model with atoms as spheres. Grey atoms were newly built by <italic>SideAide</italic>. (<italic>b</italic>) The residue with the greatest atomic shift (Arg<italic>A</italic>85) before (left) and after <italic>PDB_REDO</italic>. The side chain is moved to a completely different rotamer. (<italic>c</italic>) The rotamer change in Leu112 has led to a large displacement of the C<sup>δ</sup> atoms, whereas the C<sup>γ</sup> atom has hardly moved. (<italic>d</italic>) His<italic>A</italic>32 with typical colouring for a side-chain flip. In the new conformation the side chain makes hydrogen bonds (thin orange rods) to sulfate <italic>A</italic>504 and water <italic>A</italic>508.</p>
    </caption>
    <graphic xlink:href="d-68-00484-fig1"/>
  </fig>
  <fig id="fig2" position="float">
    <label>Figure 2</label>
    <caption>
      <p>Traffic-light diagrams of change in structure model-quality metrics after re-refinement (left column) and after full model optimization (re-refined and rebuilt; right column) for 12 000 structure models. Green bars represent improved structure models and red bars deteriorated models. Models are considered to be the same (yellow bars) if |Δ<italic>R</italic>
<sub>free</sub>| ≤ 2σ(<italic>R</italic>
<sub>free</sub>), |Δ<italic>Z</italic> score| ≤ 0.1 (for Ramachandran plot, rotamers, coarse and fine packing), |Δ(No. of bumps)| ≤ 10 or |Δ(No. of unsatisfied hydrogen-bond donors/acceptors)| ≤ 2.</p>
    </caption>
    <graphic xlink:href="d-68-00484-fig2"/>
  </fig>
  <fig id="fig3" position="float">
    <label>Figure 3</label>
    <caption>
      <p>Box-and-whisker plot of the Ramachandran plot <italic>Z</italic> score (higher is better) of the original PDB entries (white) and the fully optimized <italic>PDB_REDO</italic> models (grey) in 0.2 Å resolution bins; the size of each bin is given in the bar chart. One severe outlier, PDB entry <ext-link ext-link-type="uri" xlink:href="http://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=2ac3">2ac3</ext-link> (Jauch <italic>et al.</italic>, 2005<xref ref-type="bibr" rid="bb22"> ▶</xref>), was caused by a TLS-related bug in <italic>PDB_REDO</italic>. With the latest version of <italic>PDB_REDO</italic>, the final <italic>Z</italic> score is −1.1.</p>
    </caption>
    <graphic xlink:href="d-68-00484-fig3"/>
  </fig>
  <fig id="fig4" position="float">
    <label>Figure 4</label>
    <caption>
      <p>Box-and-whisker plots of <italic>R</italic>
<sub>free</sub> extracted from the PDB header and for the fully optimized <italic>PDB_REDO</italic> models in 0.2 Å resolution bins; the size of each bin is given in the bar chart. The data are divided into two subsets: models for which the initial re-refinement was successful (10 662 models; left) and models for which it failed (1338 models; right). In the case of successful re-refinement <italic>R</italic>
<sub>free</sub> improves over the entire resolution range. The five marked outliers were tested with a new version of <italic>PDB_REDO</italic>: PDB entry <ext-link ext-link-type="uri" xlink:href="http://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=1ocw">1ocw</ext-link> (James <italic>et al.</italic>, 2003<xref ref-type="bibr" rid="bb21"> ▶</xref>) was removed from <italic>PDB_REDO</italic> because <italic>R</italic>
<sub>head</sub> could not be reproduced, <ext-link ext-link-type="uri" xlink:href="http://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=2ac3">2ac3</ext-link> (Jauch <italic>et al.</italic>, 2005<xref ref-type="bibr" rid="bb22"> ▶</xref>) and <ext-link ext-link-type="uri" xlink:href="http://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=1u74">1u74</ext-link> (Kang <italic>et al.</italic>, 2004<xref ref-type="bibr" rid="bb31"> ▶</xref>) were no longer outliers and <ext-link ext-link-type="uri" xlink:href="http://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=2cvf">2cvf</ext-link> (Akiba <italic>et al.</italic>, 2005<xref ref-type="bibr" rid="bb2"> ▶</xref>) and <ext-link ext-link-type="uri" xlink:href="http://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=2bx5">2bx5</ext-link> (James <italic>et al.</italic>, 2007<xref ref-type="bibr" rid="bb20"> ▶</xref>) could no longer be re-refined successfully and will be investigated further. If the initial re-refinement fails, <italic>R</italic>
<sub>free</sub> typically increases with many severe outliers.</p>
    </caption>
    <graphic xlink:href="d-68-00484-fig4"/>
  </fig>
  <fig id="fig5" position="float">
    <label>Figure 5</label>
    <caption>
      <p>Percentage of structures in the test set as a function of the number of model-quality metrics (see Fig. 2<xref ref-type="fig" rid="fig2"> ▶</xref>) that improve (grey; left) or deteriorate (black; right). 85% of the structures improve in three metrics or more, whereas only 6% of the structures deteriorate in three metrics or more.</p>
    </caption>
    <graphic xlink:href="d-68-00484-fig5"/>
  </fig>
  <fig id="fig6" position="float">
    <label>Figure 6</label>
    <caption>
      <p>Overall bond-angle deviations from target values expressed as root-mean-square <italic>Z</italic> scores (calculated by <italic>WHAT_CHECK</italic>). Each point is the average of all values in a 0.2 Å resolution bin. Only models with successful initial re-refinement were used. The values in the PDB (wcori; solid line) follow a downward trend to 1.9 Å and then level off; the values after full optimization in <italic>PDB_REDO</italic> (wcfin; dashed line) follow a downward trend to 2.7 Å and then increase. Bond-length deviations (not shown) follow the same trend.</p>
    </caption>
    <graphic xlink:href="d-68-00484-fig6"/>
  </fig>
  <table-wrap id="table1" position="float">
    <label>Table 1</label>
    <caption>
      <title>Model-quality metrics</title>
    </caption>
    <table frame="hsides" rules="groups">
      <thead valign="bottom">
        <tr>
          <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="top">Metric</th>
          <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="top">Description</th>
        </tr>
      </thead>
      <tbody valign="top">
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>R</italic>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">The standard <italic>R</italic> factor, <italic>R</italic> = <inline-formula><inline-graphic xlink:href="d-68-00484-efi1.jpg" mimetype="image" mime-subtype="gif"/></inline-formula><inline-formula><inline-graphic xlink:href="d-68-00484-efi2.jpg" mimetype="image" mime-subtype="gif"/></inline-formula>, where <italic>h</italic>, <italic>k</italic> and <italic>l</italic> are the Miller indices of the reflections and <italic>m</italic> is a scale factor. Used with the subscripts head<xref ref-type="table-fn" rid="tfn1">†</xref>, calc<xref ref-type="table-fn" rid="tfn2">‡</xref>, TLS<xref ref-type="table-fn" rid="tfn3">§</xref>, co<xref ref-type="table-fn" rid="tfn4">¶</xref>, complex<xref ref-type="table-fn" rid="tfn5">††</xref> and simple<xref ref-type="table-fn" rid="tfn5">††</xref>.</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>R</italic>
            <sub>free</sub>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">Like <italic>R</italic>, but calculated over a subset of the reflection data (Brünger, 1992<xref ref-type="bibr" rid="bb6"> ▶</xref>). Subscripts: head<xref ref-type="table-fn" rid="tfn1">†</xref>, calc<xref ref-type="table-fn" rid="tfn2">‡</xref>, TLS<xref ref-type="table-fn" rid="tfn3">§</xref>, co<xref ref-type="table-fn" rid="tfn4">¶</xref>, complex<xref ref-type="table-fn" rid="tfn5">††</xref>, simple<xref ref-type="table-fn" rid="tfn5">††</xref> and final<xref ref-type="table-fn" rid="tfn6">‡‡</xref>.</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>R</italic>
            <sub>ratio</sub>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">The expected ratio of <italic>R</italic><sub>free</sub>/<italic>R</italic> for a converged refinement (Tickle <italic>et al.</italic>, 1998<xref ref-type="bibr" rid="bb49"> ▶</xref>).</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>R</italic>
            <sub>w</sub>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">The weighted <italic>R</italic> factor, <italic>R</italic><sub>w</sub> = <inline-formula><inline-graphic xlink:href="d-68-00484-efi3.jpg" mimetype="image" mime-subtype="gif"/></inline-formula><inline-formula><inline-graphic xlink:href="d-68-00484-efi4.jpg" mimetype="image" mime-subtype="gif"/></inline-formula> (Hamilton, 1965<xref ref-type="bibr" rid="bb15"> ▶</xref>), where <italic>w</italic><sub><italic>hkl</italic></sub> is the the weight for an individual reflection. Subscripts: complex, simple.</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>R</italic>
            <sub>free,w</sub>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">The weighted free <italic>R</italic> factor. Subscripts: complex, simple.</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">σ(<italic>R</italic><sub>free</sub>)</td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">The estimated standard deviation of <italic>R</italic><sub>free</sub>: <italic>R</italic><sub>free</sub>/[2(No. of test-set reflections)]<sup>1/2</sup>. Subscripts: calc (Tickle <italic>et al.</italic>, 2000<xref ref-type="bibr" rid="bb50"> ▶</xref>).</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>R</italic>
            <sub>free,unb</sub>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">The expected <italic>R</italic><sub>free</sub> for a converged unbiased refinement (Tickle <italic>et al.</italic>, 1998<xref ref-type="bibr" rid="bb49"> ▶</xref>): <italic>R</italic><sub>free,unb</sub> = <italic>R</italic> × <italic>R</italic><sub>ratio</sub>. Subscripts: calc.</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top"><italic>Z</italic> score</td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top"><italic>Z</italic> = (<italic>x</italic><sub>model</sub> − <italic>x</italic><sub>target</sub>)/σ(<italic>x</italic>), where <italic>x</italic> is a metric such as bond length and σ(<italic>x</italic>) is its standard deviation.</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top"><italic>Z</italic>(<italic>R</italic><sub>free</sub>)</td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">The <italic>R</italic><sub>free</sub><italic>Z</italic> score<xref ref-type="table-fn" rid="tfn7">§§</xref>: <italic>Z</italic>(<italic>R</italic><sub>free</sub>) = (<italic>R</italic><sub>free,unb</sub> − <italic>R</italic><sub>free</sub>)/σ(<italic>R</italic><sub>free</sub>). Subscripts: calc, complex.</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>R</italic>
            <sub>free,max</sub>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">The maximal allowed <italic>R</italic><sub>free</sub> value calculated by <italic>picker</italic>.</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">fit(ρ)</td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">The weighted mean fit of a group of atoms <italic>a</italic> with mean displacement <italic>U</italic> to the map at grid points <italic>x<sub>g</sub></italic>: WM = <inline-formula><inline-graphic xlink:href="d-68-00484-efi5.jpg" mimetype="image" mime-subtype="gif"/></inline-formula><inline-formula><inline-graphic xlink:href="d-68-00484-efi6.jpg" mimetype="image" mime-subtype="gif"/></inline-formula>; <italic>t</italic>(<italic>x</italic>) = <inline-formula><inline-graphic xlink:href="d-68-00484-efi7.jpg" mimetype="image" mime-subtype="gif"/></inline-formula>, where <italic>r</italic><sub>atom</sub> is the radius of the atom and <bold>x</bold><sub><italic>a</italic></sub> is the position of the atom (Joosten, Joosten <italic>et al.</italic>, 2011<xref ref-type="bibr" rid="bb25"> ▶</xref>).</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>B</italic>
            <sub>Wilson</sub>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">The Wilson <italic>B</italic> factor.</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">r.m.s.<italic>Z</italic>(bond)</td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">The root-mean-square <italic>Z</italic> score for <italic>n</italic> bonds with <italic>Z</italic> score <italic>Z<sub>i</sub></italic>: r.m.s.<italic>Z</italic>(bond) = <inline-formula><inline-graphic xlink:href="d-68-00484-efi8.jpg" mimetype="image" mime-subtype="gif"/></inline-formula>. Subscripts: calc, co, wcori<xref ref-type="table-fn" rid="tfn8">¶¶</xref>, wcfin<xref ref-type="table-fn" rid="tfn9">†††</xref>.</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">r.m.s.<italic>Z</italic>(angle)</td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">Like r.m.s.<italic>Z</italic>(bond), but calculated for bond-angle deviations. Subscripts: calc, co, wcori, wcfin.</td>
        </tr>
      </tbody>
    </table>
    <table-wrap-foot>
      <fn id="tfn1">
        <label>†</label>
        <p>Extracted from the header of the input PDB file.</p>
      </fn>
      <fn id="tfn2">
        <label>‡</label>
        <p>Calculated by <italic>REFMAC</italic> before refinement.</p>
      </fn>
      <fn id="tfn3">
        <label>§</label>
        <p>Calculated during TLS refinement in <italic>REFMAC</italic> directly after resetting the <italic>B</italic> factors.</p>
      </fn>
      <fn id="tfn4">
        <label>¶</label>
        <p>Used as a cutoff value for <italic>picker</italic>.</p>
      </fn>
      <fn id="tfn5">
        <label>††</label>
        <p>Complex refers to the model with the most (<italic>B</italic>-factor-related) parameters and simple to the model with fewest.</p>
      </fn>
      <fn id="tfn6">
        <label>‡‡</label>
        <p>Calculated by <italic>REFMAC</italic> after the final refinement.</p>
      </fn>
      <fn id="tfn7">
        <label>§§</label>
        <p>The terms are swapped to compensate for the ‘lower-is-better’ nature of <italic>R</italic>
<sub>free</sub>.</p>
      </fn>
      <fn id="tfn8">
        <label>¶¶</label>
        <p>Calculated by <italic>WHAT_CHECK</italic> for the input PDB file.</p>
      </fn>
      <fn id="tfn9">
        <label>†††</label>
        <p>Calculated by <italic>WHAT_CHECK</italic> for the final model.</p>
      </fn>
    </table-wrap-foot>
  </table-wrap>
  <table-wrap id="table2" position="float">
    <label>Table 2</label>
    <caption>
      <title>Programs in the <italic>PDB_REDO</italic> pipeline</title>
    </caption>
    <table frame="hsides" rules="groups">
      <thead valign="bottom">
        <tr>
          <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="top">Program</th>
          <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="top">Software suite</th>
          <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="top">Application in <italic>PDB_REDO</italic></th>
        </tr>
      </thead>
      <tbody valign="top">
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>Stripper</italic>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>PDB_REDO</italic>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">Removes unwanted atoms and edits LINK records in PDB files</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top"><italic>Cif</italic>2<italic>cif</italic></td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>PDB_REDO</italic>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">Checks and standardizes reflection data in mmCIF files</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>Extractor</italic>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>PDB_REDO</italic>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">Extracts the description of the structure model and refinement from a PDB file</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>Fitr</italic>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>PDB_REDO</italic>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">Compares <italic>R</italic> factors</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>Chiron</italic>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>PDB_REDO</italic>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">Fixes chirality errors</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>Bselect</italic>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>PDB_REDO</italic>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">Selects <italic>B</italic>-factor model complexity</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>Picker</italic>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>PDB_REDO</italic>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">Selects the best refinement from a set</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>Centrifuge</italic>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>PDB_REDO</italic>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">Removes waters</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>SideAide</italic>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>PDB_REDO</italic>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">Real-space rebuilds side chains and add missing ones</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>pepflip</italic>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>PDB_REDO</italic>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">Flips peptide planes</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>What_todo</italic>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>PDB_REDO</italic>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">Parses <italic>WHAT_CHECK</italic> reports for <italic>SideAide</italic></td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>REFMAC</italic>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top"><italic>CCP</italic>4</td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">Performs reciprocal-space refinement</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>TLSANL</italic>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top"><italic>CCP</italic>4</td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">Checks TLS-group definitions and converts total <italic>B</italic> factors to residuals</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top"><italic>CIF</italic>2<italic>MTZ</italic></td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top"><italic>CCP</italic>4</td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">Converts reflection data from mmCIF to MTZ format</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top"><italic>MTZ</italic>2<italic>VARIOUS</italic></td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top"><italic>CCP</italic>4</td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">Converts reflection data from MTZ to mmCIF format</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>CTRUNCATE</italic>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top"><italic>CCP</italic>4</td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">Converts reflection intensities to amplitudes</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>MTZUTILS</italic>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top"><italic>CC</italic>P4</td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">Manipulates MTZ files</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>CAD</italic>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top"><italic>CCP</italic>4</td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">Merges MTZ files</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>UNIQUE</italic>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top"><italic>CCP</italic>4</td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">Creates all possible reflections given unit-cell parameters and resolution</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>FREERFLAG</italic>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top"><italic>CCP</italic>4</td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">Creates and completes <italic>R</italic><sub>free</sub> set</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>SFCHECK</italic>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top"><italic>CCP</italic>4</td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">Calculates completeness, twinning fraction and <italic>B</italic><sub>Wilson</sub></td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>DSSP</italic>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">—</td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">Assigns secondary structure</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>Umfconverter</italic>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>PDB-care</italic>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">Validates carbohydrates in structure model</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>WHAT_CHECK</italic>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>WHAT IF</italic>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">Validates the structure model</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top"><italic>Pdbout</italic>2<italic>html</italic></td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>WHAT IF</italic>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">Converts <italic>WHAT_CHECK</italic> validation reports to html</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>YASARA Structure</italic>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">
            <italic>YASARA</italic>
          </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">Creates scenes for result visualization</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  <table-wrap id="table3" position="float">
    <label>Table 3</label>
    <caption>
      <title>Structure-model categories</title>
    </caption>
    <table frame="hsides" rules="groups">
      <thead valign="bottom">
        <tr>
          <th style="" rowspan="1" colspan="1" align="left" valign="top"> </th>
          <th style="border-bottom:1px solid black;" rowspan="1" colspan="2" align="left" valign="top">Cutoff values</th>
        </tr>
        <tr>
          <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="top">Category</th>
          <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="top">Reflections per atom<xref ref-type="table-fn" rid="tfn10">†</xref></th>
          <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="top">Data resolution</th>
        </tr>
      </thead>
      <tbody valign="top">
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">xlow</td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">&lt;1.0 reflections per atom </td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">Resolution ≥ 5.00 Å</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">vlow</td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">1.0 ≤ reflections per atom &lt; 2.5</td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">3.50 Å ≤ resolution &lt; 5.00 Å</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">low</td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">NA<xref ref-type="table-fn" rid="tfn11">†</xref></td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">2.80 Å ≤ resolution &lt; 3.50 Å</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">medium</td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">NA<xref ref-type="table-fn" rid="tfn11">†</xref></td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">1.70 Å ≤ resolution &lt; 2.80 Å</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">high</td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">NA<xref ref-type="table-fn" rid="tfn11">†</xref></td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">1.20 Å ≤ resolution &lt; 1.70 Å</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">atomic</td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">NA<xref ref-type="table-fn" rid="tfn11">†</xref></td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">Resolution &lt; 1.20 Å</td>
        </tr>
      </tbody>
    </table>
    <table-wrap-foot>
      <fn id="tfn10">
        <label>†</label>
        <p>Reflections per atom takes precedence over data resolution.</p>
      </fn>
      <fn id="tfn11">
        <label>‡</label>
        <p>In these categories only resolution cutoffs are used.</p>
      </fn>
    </table-wrap-foot>
  </table-wrap>
  <table-wrap id="table4" position="float">
    <label>Table 4</label>
    <caption>
      <title>Whole data-set averages for model-quality metrics</title>
    </caption>
    <table frame="hsides" rules="groups">
      <thead valign="bottom">
        <tr>
          <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="bottom">Metric</th>
          <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="bottom">PDB entry</th>
          <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="bottom">Re-refined model</th>
          <th style="border-bottom:1px solid black;" rowspan="1" colspan="1" align="left" valign="bottom">Final model</th>
        </tr>
      </thead>
      <tbody valign="top">
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top"><italic>R</italic> (%)</td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">19.8<xref ref-type="table-fn" rid="tfn12">†</xref></td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">18.3</td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">18.4</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top"><italic>R</italic><sub>free</sub> (%)</td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">24.0<xref ref-type="table-fn" rid="tfn12">†</xref></td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">22.0</td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">22.2</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">Ramachandran plot<xref ref-type="table-fn" rid="tfn13">‡</xref></td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">−1.30</td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">−0.66</td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">−0.61</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">Side-chain rotamers<xref ref-type="table-fn" rid="tfn13">‡</xref></td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">−1.21</td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">−0.69</td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">−0.24</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">Coarse packing<xref ref-type="table-fn" rid="tfn13">‡</xref></td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">−0.24</td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">−0.16</td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">−0.12</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">Fine packing<xref ref-type="table-fn" rid="tfn13">‡</xref></td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">−0.97</td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">−0.85</td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">−0.70</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">No. of atomic bumps</td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">108</td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">78</td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">82</td>
        </tr>
        <tr>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">No. of unsatisfied hydrogen-bond donors/acceptors</td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">43</td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">37</td>
          <td style="" rowspan="1" colspan="1" align="left" valign="top">37</td>
        </tr>
      </tbody>
    </table>
    <table-wrap-foot>
      <fn id="tfn12">
        <label>†</label>
        <p>Values extracted from the PDB header.</p>
      </fn>
      <fn id="tfn13">
        <label>‡</label>
        <p>Model-normality <italic>Z</italic> scores from <italic>WHAT_CHECK</italic> with respect to a test set of 500+ high-resolution structure models. Higher values are better.</p>
      </fn>
    </table-wrap-foot>
  </table-wrap>
</floats-group>
