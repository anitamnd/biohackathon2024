<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with OASIS Tables with MathML3 v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archive-oasis-article1-mathml3.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jpoasis-nisons2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">J Comput Chem</journal-id>
    <journal-id journal-id-type="iso-abbrev">J Comput Chem</journal-id>
    <journal-id journal-id-type="doi">10.1002/(ISSN)1096-987X</journal-id>
    <journal-id journal-id-type="publisher-id">JCC</journal-id>
    <journal-title-group>
      <journal-title>Journal of Computational Chemistry</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0192-8651</issn>
    <issn pub-type="epub">1096-987X</issn>
    <publisher>
      <publisher-name>John Wiley &amp; Sons, Inc.</publisher-name>
      <publisher-loc>Hoboken, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7384070</article-id>
    <article-id pub-id-type="doi">10.1002/jcc.26198</article-id>
    <article-id pub-id-type="publisher-id">JCC26198</article-id>
    <article-categories>
      <subj-group subj-group-type="overline">
        <subject>Software News and Updates</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Software News and Updates</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><styled-content style="fixed-case" toggle="no">MkVsites</styled-content>: A tool for creating <styled-content style="fixed-case" toggle="no">GROMACS</styled-content> virtual sites parameters to increase performance in all‐atom molecular dynamics simulations</article-title>
      <alt-title alt-title-type="left-running-head">Larsson et al.</alt-title>
    </title-group>
    <contrib-group>
      <contrib id="jcc26198-cr-0001" contrib-type="author" corresp="yes">
        <name>
          <surname>Larsson</surname>
          <given-names>Per</given-names>
        </name>
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-8418-4956</contrib-id>
        <xref ref-type="aff" rid="jcc26198-aff-0001">
          <sup>1</sup>
        </xref>
        <address>
          <email>per.larsson@farmaci.uu.se</email>
        </address>
      </contrib>
      <contrib id="jcc26198-cr-0002" contrib-type="author">
        <name>
          <surname>Kneiszl</surname>
          <given-names>Rosita C.</given-names>
        </name>
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-5563-2908</contrib-id>
        <xref ref-type="aff" rid="jcc26198-aff-0001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib id="jcc26198-cr-0003" contrib-type="author" corresp="yes">
        <name>
          <surname>Marklund</surname>
          <given-names>Erik G.</given-names>
        </name>
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-9804-5009</contrib-id>
        <xref ref-type="aff" rid="jcc26198-aff-0002">
          <sup>2</sup>
        </xref>
        <address>
          <email>erik.marklund@kemi.uu.se</email>
        </address>
      </contrib>
    </contrib-group>
    <aff id="jcc26198-aff-0001">
      <label>
        <sup>1</sup>
      </label>
      <named-content content-type="organisation-division">Department of Pharmacy, Uppsala Biomedical Research Centre</named-content>
      <institution>Uppsala University</institution>
      <city>Uppsala</city>
      <country country="SE">Sweden</country>
    </aff>
    <aff id="jcc26198-aff-0002">
      <label>
        <sup>2</sup>
      </label>
      <named-content content-type="organisation-division">Department of Chemistry – BMC, Uppsala Biomedical Research Centre</named-content>
      <institution>Uppsala University</institution>
      <city>Uppsala</city>
      <country country="SE">Sweden</country>
    </aff>
    <author-notes>
      <corresp id="correspondenceTo"><label>*</label><bold>Correspondence</bold><break/>
Per Larsson, Department of Pharmacy, Uppsala Biomedical Research Centre, Uppsala University, 75123 Uppsala, Sweden. Email: <email>per.larsson@farmaci.uu.se</email> and Erik G. Marklund, Department of Chemistry – BMC, Uppsala Biomedical Research Centre, Uppsala University, 75123 Uppsala, Sweden.<break/>
Email: <email>erik.marklund@kemi.uu.se</email><break/></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>13</day>
      <month>4</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>6</month>
      <year>2020</year>
    </pub-date>
    <volume>41</volume>
    <issue>16</issue>
    <issue-id pub-id-type="doi">10.1002/jcc.v41.16</issue-id>
    <fpage>1564</fpage>
    <lpage>1569</lpage>
    <history>
      <date date-type="received">
        <day>10</day>
        <month>2</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>11</day>
        <month>3</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>3</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <!--<copyright-statement content-type="issue-copyright"> &#x000a9; 2020 Wiley Periodicals, Inc. <copyright-statement>-->
      <copyright-statement content-type="article-copyright">© 2020 The Authors. <italic>Journal of Computational Chemistry</italic> published by Wiley Periodicals LLC</copyright-statement>
      <license license-type="creativeCommonsBy">
        <license-p>This is an open access article under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link> License, which permits use, distribution and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="file:JCC-41-1564.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>The absolute performance of any all‐atom molecular dynamics simulation is typically limited by the length of the individual timesteps taken when integrating the equations of motion. In the GROMACS simulation software, it has for a long time been possible to use so‐called virtual sites to increase the length of the timestep, resulting in a large gain of simulation efficiency. Up until now, support for this approach has in practice been limited to the standard 20 amino acids however, shrinking the applicability domain of virtual sites. MkVsites is a set of python tools which provides a convenient way to obtain all parameters necessary to use virtual sites for virtually any molecules in a simulation. Required as input to MkVsites is the molecular topology of the molecule(s) in question, along with a specification of where to find the parent force field. As such, MkVsites can be a very valuable tool suite for anyone who is routinely using GROMACS for the simulation of molecular systems.</p>
    </abstract>
    <abstract abstract-type="graphical">
      <p>Insufficient sampling is a common problem for molecular dynamics simulations of biomolecules. With the virtual sites approach, all hydrogen atoms are maintained, but at the same time, mass‐less interaction sites are introduced. This means that the length of the timestep in a simulation can be increased by a factor of 2.5, giving a considerable performance boost practically for free. MkVsites is a python tool for obtaining virtual sites parameters for virtually any molecule in a simulation.<boxed-text position="anchor" content-type="graphic" id="jcc26198-blkfxd-0001" orientation="portrait"><graphic xlink:href="JCC-41-1564-g006.jpg" position="anchor" id="nlm-graphic-1" orientation="portrait"/></boxed-text>
</p>
    </abstract>
    <kwd-group kwd-group-type="author-generated">
      <kwd id="jcc26198-kwd-0001">GROMACS</kwd>
      <kwd id="jcc26198-kwd-0002">molecular dynamics</kwd>
      <kwd id="jcc26198-kwd-0003">sampling</kwd>
      <kwd id="jcc26198-kwd-0004">timestep</kwd>
    </kwd-group>
    <funding-group>
      <award-group id="funding-0001">
        <funding-source>
          <institution-wrap>
            <institution>Seventh Framework Programme </institution>
            <institution-id institution-id-type="open-funder-registry">10.13039/100011102</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>2015‐00559</award-id>
      </award-group>
      <award-group id="funding-0002">
        <funding-source>
          <institution-wrap>
            <institution>Vetenskapsrådet </institution>
            <institution-id institution-id-type="open-funder-registry">10.13039/501100004359</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group id="funding-0003">
        <funding-source>
          <institution-wrap>
            <institution>VINNOVA </institution>
            <institution-id institution-id-type="open-funder-registry">10.13039/501100001858</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>2017‐02690</award-id>
      </award-group>
    </funding-group>
    <counts>
      <fig-count count="5"/>
      <table-count count="0"/>
      <page-count count="6"/>
      <word-count count="3561"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>source-schema-version-number</meta-name>
        <meta-value>2.0</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>cover-date</meta-name>
        <meta-value>June 15, 2020</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>details-of-publishers-convertor</meta-name>
        <meta-value>Converter:WILEY_ML3GV2_TO_JATSPMC version:5.8.6 mode:remove_FC converted:27.07.2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <p content-type="self-citation">
      <mixed-citation publication-type="journal" id="jcc26198-cit-9001"><string-name><surname>Larsson</surname><given-names>P</given-names></string-name>, <string-name><surname>Kneiszl</surname><given-names>RC</given-names></string-name>, <string-name><surname>Marklund</surname><given-names>EG</given-names></string-name>. <article-title>MkVsites: A tool for creating GROMACS virtual sites parameters to increase performance in all‐atom molecular dynamics simulations</article-title>. <source xml:lang="en">J Comput Chem</source>. <year>2020</year>;<volume>41</volume>:<fpage>1564</fpage>–<lpage>1569</lpage>. <pub-id pub-id-type="doi">10.1002/jcc.26198</pub-id><pub-id pub-id-type="pmid">32282082</pub-id></mixed-citation>
    </p>
    <fn-group>
      <fn id="jcc26198-note-1002">
        <p><bold>Funding information</bold> Seventh Framework Programme, Grant/Award Number: 2015‐00559; Vetenskapsrådet; VINNOVA, Grant/Award Number: 2017‐02690</p>
      </fn>
    </fn-group>
  </notes>
</front>
<body id="jcc26198-body-0001">
  <sec id="jcc26198-sec-0001">
    <label>1</label>
    <title>INTRODUCTION</title>
    <p>For dynamic heterogeneous systems such as biological membranes, aggregation processes, and studies of protein folding and motion, molecular dynamics (MD) simulations enables the generation of mechanistic hypotheses via detailed physical models for observed phenomena. These advances are due to progress in parallel and stream computing, new molecular interaction parameters with increased physical accuracy, and development of methods that enable robust statistical estimates of physical observables.<sup>[</sup>
<xref rid="jcc26198-bib-0001" ref-type="ref"><sup>1</sup></xref>
<sup>]</sup> Ultimately, however, the amount of useful data that can be obtained from MD will always be limited by how many timesteps that can be afforded, and the length of those timesteps.</p>
    <p>In atomistic simulations, the length of the timestep is limited by the fastest degrees of freedom in a molecule, typically bond vibrations in bonds involving hydrogen atoms.<sup>[</sup>
<xref rid="jcc26198-bib-0002" ref-type="ref"><sup>2</sup></xref>
<sup>]</sup> To get around this issue and increase the overall performance, a number of options have been described in the literature, including the use of united‐atom force fields,<sup>[</sup>
<xref rid="jcc26198-bib-0003" ref-type="ref"><sup>3</sup></xref>
<sup>]</sup> removing all but the polar hydrogen atoms, or putting explicit constraints on the bonds involving hydrogens.<sup>[</sup>
<xref rid="jcc26198-bib-0004" ref-type="ref">4</xref>, <xref rid="jcc26198-bib-0005" ref-type="ref">5</xref>
<sup>]</sup> These strategies still limit the timestep to 2 fs however. A number of studies seek to go beyond this by repartitioning the masses of hydrogen and connecting heavy atoms, making the hydrogens heavier while conserving overall mass of each molecule.<sup>[</sup>
<xref rid="jcc26198-bib-0006" ref-type="ref">6</xref>, <xref rid="jcc26198-bib-0007" ref-type="ref">7</xref>
<sup>]</sup> While such repartitioning will not perturb the free energy surface, it will inevitably affect dynamic properties.</p>
    <p>An alternative means to increase the timestep is so‐called virtual interaction sites, which are used in conjunction with bond constraints. Here, the masses of the hydrogens together with all forces acting on the latter are redistributed to the adjacent heavy atoms, and integration of the equations of motion are then done based on the heavy atoms.<sup>[</sup>
<xref rid="jcc26198-bib-0002" ref-type="ref"><sup>2</sup></xref>
<sup>]</sup> After the positions of the heavy atoms have been updated during an integration step, the massless hydrogen positions get determined through linear or nonlinear combinations of the positions of the heavy atoms located one or two bonds away. For most aliphatic hydrogens, this operation is relatively straightforward and GROMACS can create the necessary parameters for virtually any new residue or ligand without additional information.</p>
    <p>For some functional groups, the situation is more complicated, and more complex constructions that require additional parameters are needed. For example, –CH<sub>3</sub> and –NH<sub>3</sub> are able to spin around their axis, so that the hydrogen positions are not fully defined by the bonded heavy atoms. A solution is to add two dummy particles and let the combined mass of the group be completely redistributed to them, then let the hydrogens’ positions be determined from the dummy particles, analogous to the case with aliphatic hydrogens. Additionally, for groups like hydroxyls, which have a heavy atom connecting a single hydrogen to an “anchoring” heavy atom, a constraint can be added between the hydrogen and the anchor, keeping the angle constant while allowing free rotation of the group. These measures, illustrated in Figure <xref rid="jcc26198-fig-0001" ref-type="fig">1</xref>, maintain the masses and moments of inertia of chemical groups as well as the interatomic interactions while disabling hydrogen vibrations. Consequently, the dynamics of the system are largely conserved, except for the fastest degrees of freedom, but in return, the timestep can be more than doubled to 5 fs for biomolecular systems.</p>
    <fig fig-type="Figure" xml:lang="en" id="jcc26198-fig-0001" orientation="portrait" position="float">
      <label>Figure 1</label>
      <caption>
        <p>The image shows ethanol with a constraint connecting the hydoxyl hydrogen to the “anchor,” keeping the angle fixed, and two dummy particles (teal) for the methyl group. Virtual‐site specific constraints are shown as black rods. Note the triangle of constraints connecting the dummy particles and the anchor, keeping the center of mass and moment of inertia constant and correct [Color figure can be viewed at <ext-link ext-link-type="uri" xlink:href="http://wileyonlinelibrary.com">wileyonlinelibrary.com</ext-link>]</p>
      </caption>
      <graphic id="nlm-graphic-3" xlink:href="JCC-41-1564-g001"/>
    </fig>
    <p>Virtual site parameters are available in GROMACS<sup>[</sup>
<xref rid="jcc26198-bib-0008" ref-type="ref">8</xref>, <xref rid="jcc26198-bib-0009" ref-type="ref">9</xref>
<sup>]</sup> for simulations of the common amino acids, and more recently has also started to become available for lipids, and are widely used to increase the timestep.<sup>[</sup>
<xref rid="jcc26198-bib-0010" ref-type="ref"><sup>10</sup></xref>
<sup>]</sup> For most nonprotein molecules, however, no such parameters exist, effectively limiting the timestep and consequently, the sampling in all simulations including such components. Given the large number of biological relevant molecules, including drug molecules, carbohydrates, and post‐translationally modified proteins, this limitation is doubtlessly significant.</p>
    <p>Virtual site parameters can be constructed from information in the force field and a molecular topology. Biomolecular force fields typically provide abstract description of the interatomic interactions via interaction parameters between types of atoms, where the atom type reflects not only the element, but also electronic properties such as hybridization, degree of polarization, and so on. The bonded interactions are normally expressed in terms of deviations from reference bond lengths, angles, dihedral angles, and so on. A topology file, on the other hand, provides a specific description of the interactions by stating which atoms are connected and which atom types they are. From the combination of these two descriptions, the ideal geometry of chemical groups, such as methyl and amines, can be determined, and their centers of mass and moments of inertia can be calculated in turn, which is all that is needed to make appropriate dummy‐mass constructions. Analogously, for hydroxyl‐like groups the ideal distance between the hydrogen and anchor can be precisely determined, defining the constraint length required to maintain their geometries.</p>
    <p>Derivation of virtual site parameters currently requires a considerable manual effort in terms of finding bond parameters and atom type properties in force field file, as well as geometry calculations to determine constraint lengths and dummy‐mass positions. To greatly facilitate applying the virtual site approach for arbitrary biomolecules we here present MkVsites, a python tool that automates the calculations of all necessary parameters for any molecule such as ligands, noncanonical amino acids, lipids, nucleic acids, or small drug‐like compounds. MkVsites moreover provides additional functionality to facilitate the inclusion of newly parameterized molecules and residues in biomolecular simulation more generally.</p>
  </sec>
  <sec id="jcc26198-sec-0002">
    <label>2</label>
    <title>METHODS</title>
    <p>MkVsites works through two python programs: One that makes virtual site parameters for a given topology based on information in the force field (mkvsites.py), and one auxiliary program that extracts the interaction parameters that are not already in the force field (topinspect.py). Both take a molecular topology together with information from the force field and automate most of the process of complementing the force field with the required virtual site parameters.</p>
    <sec id="jcc26198-sec-0003">
      <label>2.1</label>
      <title>Catching new atom types and interactions in the topology: topinspect.py</title>
      <p>topinspect.py is an auxiliary program that is useful when a compound contains new atom types or have special interactions in its topology. For example, when having parameterized a new ligand. It is however not required for many biomolecular building blocks, such as nucleotides, that are already defined by the force field. Taking an itp/top file as input, topinspect.py identifies atom types and interactions that are not already present in the force field files and displays them in a manner that makes for an easy incorporation in the force field (Figure <xref rid="jcc26198-fig-0002" ref-type="fig">2</xref>). While the latter step—incorporation into existing force field files—could in principle be automated, we have noted that some topology files contain ambiguous information about the elements of new atom types, which either require assumptions from the software or a manual step carried out by the user. We have chosen the latter for transparency reasons and for reducing the risk of silent errors entering the simulations. With the new atom types and interaction parameters incorporated, all the abstract information that is required for the generation of virtual sites parameters are now present in the force field.</p>
      <fig fig-type="Figure" xml:lang="en" id="jcc26198-fig-0002" orientation="portrait" position="float">
        <label>Figure 2</label>
        <caption>
          <p>Simplified flowcharts describing the workings of MkVsites's two programs: topinspect.py and mkvsites.py. topinspect.py lists new atom types and interactions from a topology file, optionally converting the dihedrals from one type to another, and optionally creating an rtp file for use with pdb2gmx. mkvsites.py reads a topology from an rtp or itp/top file and combines it with information from the force field to establish the geometry and the mass moments of chemical groups. After a check to ensure all atom types are found in the force field, the angle constraints for –OH and –SH are calculated, and new dummy particle atom types and the associated constraints and parameters are created [Color figure can be viewed at <ext-link ext-link-type="uri" xlink:href="http://wileyonlinelibrary.com">wileyonlinelibrary.com</ext-link>]</p>
        </caption>
        <graphic id="nlm-graphic-5" xlink:href="JCC-41-1564-g002"/>
      </fig>
      <p>topinspect.py provides additional functionality to facilitate the inclusion of ligands and new residues. First, it can use the input topology to optionally output a residue topology (rtp), which enables the GROMACS program pdb2gmx to go directly from a pdb file to a complete topology. This feature is handy when preparing a system for simulation in general, but it also makes use of the capability of pdb2gmx to generate all virtual sites constructions, including placing all dummy‐mass atoms exactly where they should be relative to other atoms and adding all associated constraints. Additionally, topinspect.py can optionally convert dihedrals from one functional form to another, which can be used to harmonize, for example, a newly parameterized noncanonical amino acid with existing amino acids in the force field. For example, the parametrization might yield dihedrals of a specific type, while existing rtp entries in the force field use another type. Specifically, topinspect.py converts between ordinary proper dihedrals, Fourier dihedrals, and Ryckaert–Belleman dihedrals. Conversion is impossible for some combinations of parameter values, due to their mathematical functional forms, in which case an error will be raised by the program. Moreover, conversion will most often yield a constant offset to the energy, which is normally not a problem as long as the gradient, and hence the forces in the simulation, is preserved. These two features—rtp creation from top/itp files, and conversion of dihedral parameters—have, to the best of our knowledge, not been implemented anywhere else, and make a time consuming and error‐prone manual operation fully automatic.</p>
    </sec>
    <sec id="jcc26198-sec-0004">
      <label>2.2</label>
      <title>Automatic derivation of the virtual site parameters: mkvsites.py</title>
      <p>mkvsites.py reads an itp/top or rtp file, and the force field files, to generate all parameters needed for applying virtual sites (Figure <xref rid="jcc26198-fig-0002" ref-type="fig">2</xref>). It reads the input and searches for heavy atoms (nonhydrogen) with only one other heavy‐atom bound. If the atom is also bound to three hydrogen atoms (–CH<sub>3</sub> and –NH<sub>3</sub> groups) the mass moments are calculated for making dummy particles, for which new atom types and necessary default constraints are generated (Figure <xref rid="jcc26198-fig-0001" ref-type="fig">1</xref>). If only one hydrogen is bound to the heavy atom (currently only –OH and –SH), then a constraint between the bound heavy atom and the hydrogen is generated to keep the angle rigid. mkvsites.py derives all parameters from the data already present in the force field (after potential additions from topinspect.py). The new parameters and dummy atoms types are printed to the terminal for incorporation in the force field files. MkVsites does not generate parameters for, for example, aliphatic hydrogens, since they are handled automatically by GROMACS without need of additional parameters.</p>
    </sec>
    <sec id="jcc26198-sec-0005">
      <label>2.3</label>
      <title>Testing and validating <styled-content style="fixed-case" toggle="no">MkVsites</styled-content>
</title>
      <p>To test the accuracy of the dihedral conversion implemented in topinspect.py, we created a four‐atom molecule without non‐bonded interactions, where the atoms were connected in sequence with angles of 109.5°. The molecule thus had one dihedral angle, which we rotated one full revolution in steps of 10°. Three different topologies were created, based on an original Ryckaert–Belleman dihedral potential, and the conversion to Fourier and proper dihedrals. The topologies and the “trajectory” of the dihedral scan was used as input to GROMACS to calculate the energies.</p>
      <p>To validate and showcase the usefulness of MkVsites, simulations with and without virtual sites on the protein and ligand were started from the crystal structure of the estrogen receptor, PDB ID 5TOA, using the amber99sb<sup>[</sup>
<xref rid="jcc26198-bib-0011" ref-type="ref"><sup>11</sup></xref>
<sup>]</sup> force field. Some missing atoms were first added using Modeler,<sup>[</sup>
<xref rid="jcc26198-bib-0012" ref-type="ref"><sup>12</sup></xref>
<sup>]</sup> and a topology (initially without virtual sites) for the estrogen cofactor was generated using the Stage<sup>[</sup>
<xref rid="jcc26198-bib-0013" ref-type="ref"><sup>13</sup></xref>
<sup>]</sup> software with the GAFF force field. An rtp‐file was created from the topology file to allow us to use the existing virtual‐sites machinery in the GROMACS tool pdb2gmx. Virtual site parameters for the bound cofactor was derived using MkVsites: ./mkvsites.py ‐ff /path/to/amber99sb.ff ‐r EST EST.rtp.</p>
      <p>The initial structures were solvated in a box with roughly 29,000 TIP3P water molecules in each case. Long‐range electrostatics were calculated using PME<sup>[</sup>
<xref rid="jcc26198-bib-0014" ref-type="ref"><sup>14</sup></xref>
<sup>]</sup> using a real‐space cutoff of 1.0 nm. Lennard‐Jones interactions were evaluated using a straight 1.0 nm cutoff. Both systems were first energy minimized for 500 steps using steepest descent, and simulations were then run for 500 ns each using either a 2 or 5‐fs time step at a temperature of 310 K maintained by the V‐rescale thermostat<sup>[</sup>
<xref rid="jcc26198-bib-0015" ref-type="ref"><sup>15</sup></xref>
<sup>]</sup> and a pressure of 1 bar with the Parrinello–Rahman barostat.<sup>[</sup>
<xref rid="jcc26198-bib-0016" ref-type="ref"><sup>16</sup></xref>
<sup>]</sup> Hydrogen bond analysis as well as root‐mean‐square calculations were done using standard GROMACS tools, and molecular graphics generated with Blender.</p>
    </sec>
  </sec>
  <sec id="jcc26198-sec-0006">
    <label>3</label>
    <title>RESULTS</title>
    <p>To ensure that conversion of dihedrals from one form to another does not affect the forces calculated during a simulation, we compared the energies from Ryckaert–Belleman dihedrals with Fourier and proper dihedrals converted from the former using GROMACS. Apart from an expected constant energy offset between the three dihedral types, the energy profiles were indistinguishable (Figure <xref rid="jcc26198-fig-0003" ref-type="fig">3</xref>), validating the implementation.</p>
    <fig fig-type="Figure" xml:lang="en" id="jcc26198-fig-0003" orientation="portrait" position="float">
      <label>Figure 3</label>
      <caption>
        <p>Energies calculated using GROMACS for the Ryckaert–Belleman, Fourier, and proper dihedrals. The parameters for latter two were obtained via topinspect.py by conversion from the Ryckaert–Belleman form. The energies have an expected constant offset, but have indistinguishable gradients, yielding identical forces in simulations [Color figure can be viewed at <ext-link ext-link-type="uri" xlink:href="http://wileyonlinelibrary.com">wileyonlinelibrary.com</ext-link>]</p>
      </caption>
      <graphic id="nlm-graphic-7" xlink:href="JCC-41-1564-g003"/>
    </fig>
    <p>To test and illustrate the usefulness of MkVsites, we performed two simulations of a hormone‐bound estrogen receptor (Figure <xref rid="jcc26198-fig-0004" ref-type="fig">4</xref>). The estrogen molecules, parametrized through the GAFF force field, contains atom types which are not found in the parent amber99sb force field files (even though the atom types are commonly used in GAFF). This highlights one of the key strengths with MkVsites, that it works also in cases where a molecule previously not possible to represent with virtual sites also contain new atom types (Figure <xref rid="jcc26198-fig-0005" ref-type="fig">5</xref>).</p>
    <fig fig-type="Figure" xml:lang="en" id="jcc26198-fig-0004" orientation="portrait" position="float">
      <label>Figure 4</label>
      <caption>
        <p>Simple quality measures for a set of simulations, performed for a complex with the estrogen receptor with bound estrogen, using both a 2 and 5 fs timestep. Neither the total number of hydrogen bonds between the ligand and the receptor (top) or the RMSD of the ligand (bottom) over the 500‐ns simulation period show significant differences. All lines show running averages using a window of 20‐ns width, except near the endpoints where the window is narrowed down symmetrically to fit within the data range, giving the appearance of locally larger fluctuations [Color figure can be viewed at <ext-link ext-link-type="uri" xlink:href="http://wileyonlinelibrary.com">wileyonlinelibrary.com</ext-link>]</p>
      </caption>
      <graphic id="nlm-graphic-9" xlink:href="JCC-41-1564-g004"/>
    </fig>
    <fig fig-type="Figure" xml:lang="en" id="jcc26198-fig-0005" orientation="portrait" position="float">
      <label>Figure 5</label>
      <caption>
        <p>Snapshot of a single estrogen molecule with one methyl group having dummy masses, and with angle constraints for the two hydroxyl groups. All other hydrogen atoms are virtual interaction sites that are already handled by GROMACS automatically [Color figure can be viewed at <ext-link ext-link-type="uri" xlink:href="http://wileyonlinelibrary.com">wileyonlinelibrary.com</ext-link>]</p>
      </caption>
      <graphic id="nlm-graphic-11" xlink:href="JCC-41-1564-g005"/>
    </fig>
  </sec>
  <sec id="jcc26198-sec-0007">
    <label>4</label>
    <title>CONCLUSIONS</title>
    <p>MkVsites provides the research community with a tool that makes it possible and simple to derive necessary virtual site parameters for any molecule. This means that the virtual sites‐approach for enhanced simulation performance can be applied for all simulations, as long as the corresponding molecular topologies can be derived in a manner consistent with the parent force field. While MkVsites was developed for GROMACS formats, the inner workings of the software are based on general concepts such as bonds, angles, and so on. As such, one can extend MkVsites with interfaces for other force‐field and topology formats to derive parameters for a wider range of simulation packages. Although the virtual sites method is currently only fully implemented in GROMACS (to our knowledge), MkVsites could be of utility for future implementations, and at least the angle constraints should be easy to use immediately. Moreover, MkVsites has been developed for simulations of biological or organic molecules, but can easily be extended to other classes of compounds that include other, heavier elements as long as their bound hydrogens can be handled using existing virtual sites models.</p>
    <p>MkVsites is written in Python and requires no special external libraries. MkVsites can be downloaded and installed from <ext-link ext-link-type="uri" xlink:href="https://github.com/ErikMarklund/mkvsites">https://github.com/ErikMarklund/mkvsites</ext-link>, where additional documentation and more usage examples can also be found.</p>
  </sec>
</body>
<back>
  <ack id="jcc26198-sec-0008">
    <title>ACKNOWLEDGMENTS</title>
    <p>The simulations were performed on resources provided by the Swedish National Infrastructure for Computing (SNIC) at the Uppsala Multidisciplinary Center for Advanced Computational Science (UPPMAX) under project 2018/3‐551 and the Center for High‐Performance Computing (PDC) under project 2018/3‐550. EGM thankfully acknowledges the Swedish Research Council and the European Union's Seventh Framework Programme for a Marie Skłodowska Curie International Career Grant (2015‐00559). This study is part of the science program of the Swedish Drug Delivery Forum (SDDF) and received financial support from Vinnova (Dnr 2017‐02690).</p>
  </ack>
  <ref-list id="jcc26198-bibl-0001" content-type="cited-references">
    <title>REFERENCES</title>
    <ref id="jcc26198-bib-0001">
      <label>1</label>
      <mixed-citation publication-type="journal" id="jcc26198-cit-0001"><string-name><given-names>K.</given-names><surname>Lindorff‐Larsen</surname></string-name>, <string-name><given-names>P.</given-names><surname>Maragakis</surname></string-name>, <string-name><given-names>S.</given-names><surname>Piana</surname></string-name>, <string-name><given-names>M. P.</given-names><surname>Eastwood</surname></string-name>, <string-name><given-names>R. O.</given-names><surname>Dror</surname></string-name>, <string-name><given-names>D. E.</given-names><surname>Shaw</surname></string-name>, <source xml:lang="en">PLoS One</source><year>2012</year>, <volume>7</volume>(<issue>2</issue>), <elocation-id>e32131</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0032131</pub-id>.<pub-id pub-id-type="pmid">22384157</pub-id></mixed-citation>
    </ref>
    <ref id="jcc26198-bib-0002">
      <label>2</label>
      <mixed-citation publication-type="journal" id="jcc26198-cit-0002"><string-name><given-names>K. A.</given-names><surname>Feenstra</surname></string-name>, <string-name><given-names>B.</given-names><surname>Hess</surname></string-name>, <string-name><given-names>H. J. C.</given-names><surname>Berendsen</surname></string-name>, <source xml:lang="en">J Comput Chem</source><year>1999</year>, <volume>20</volume>(<issue>8</issue>), <fpage>786</fpage>.</mixed-citation>
    </ref>
    <ref id="jcc26198-bib-0003">
      <label>3</label>
      <mixed-citation publication-type="journal" id="jcc26198-cit-0003"><string-name><given-names>A.</given-names><surname>Kukol</surname></string-name>, <source xml:lang="en">J Chem Theory Comput</source><year>2009</year>, <volume>5</volume>(<issue>3</issue>), <fpage>615</fpage><pub-id pub-id-type="doi">10.1021/ct8003468</pub-id>.<pub-id pub-id-type="pmid">26610227</pub-id></mixed-citation>
    </ref>
    <ref id="jcc26198-bib-0004">
      <label>4</label>
      <mixed-citation publication-type="journal" id="jcc26198-cit-0004"><string-name><given-names>J.‐P.</given-names><surname>Ryckaert</surname></string-name>, <string-name><given-names>G.</given-names><surname>Ciccotti</surname></string-name>, <string-name><given-names>H. J. C.</given-names><surname>Berendsen</surname></string-name>, <source xml:lang="en">J Comput Phys</source><year>1977</year>, <volume>23</volume>(<issue>3</issue>), <fpage>327</fpage><pub-id pub-id-type="doi">10.1016/0021-9991(77)90098-5</pub-id>.</mixed-citation>
    </ref>
    <ref id="jcc26198-bib-0005">
      <label>5</label>
      <mixed-citation publication-type="journal" id="jcc26198-cit-0005"><string-name><given-names>S.</given-names><surname>Miyamoto</surname></string-name>, <string-name><given-names>P. A.</given-names><surname>Kollman</surname></string-name>, <source xml:lang="en">J Comput Chem</source><year>1992</year>, <volume>13</volume>, <fpage>952</fpage>.</mixed-citation>
    </ref>
    <ref id="jcc26198-bib-0006">
      <label>6</label>
      <mixed-citation publication-type="journal" id="jcc26198-cit-0006"><string-name><given-names>C.</given-names><surname>Balusek</surname></string-name>, <string-name><given-names>H.</given-names><surname>Hwang</surname></string-name>, <string-name><given-names>C. H.</given-names><surname>Lau</surname></string-name>, <string-name><given-names>K.</given-names><surname>Lundquist</surname></string-name>, <string-name><given-names>A.</given-names><surname>Hazel</surname></string-name>, <string-name><given-names>A.</given-names><surname>Pavlova</surname></string-name>, <string-name><given-names>D. L.</given-names><surname>Lynch</surname></string-name>, <string-name><given-names>P. H.</given-names><surname>Reggio</surname></string-name>, <string-name><given-names>Y.</given-names><surname>Wang</surname></string-name>, <string-name><given-names>J. C.</given-names><surname>Gumbart</surname></string-name>, <source xml:lang="en">J Chem Theory Comput</source><year>2019</year>, <volume>15</volume>(<issue>8</issue>), <fpage>4673</fpage><pub-id pub-id-type="doi">10.1021/acs.jctc.9b00160</pub-id>.<pub-id pub-id-type="pmid">31265271</pub-id></mixed-citation>
    </ref>
    <ref id="jcc26198-bib-0007">
      <label>7</label>
      <mixed-citation publication-type="journal" id="jcc26198-cit-0007"><string-name><given-names>C. W.</given-names><surname>Hopkins</surname></string-name>, <string-name><given-names>S.</given-names><surname>Le Grand</surname></string-name>, <string-name><given-names>R. C.</given-names><surname>Walker</surname></string-name>, <string-name><given-names>A. E.</given-names><surname>Roitberg</surname></string-name>, <source xml:lang="en">J Chem Theory Comput</source><year>2015</year>, <volume>11</volume>(<issue>4</issue>), <fpage>1864</fpage><pub-id pub-id-type="doi">10.1021/ct5010406</pub-id>.<pub-id pub-id-type="pmid">26574392</pub-id></mixed-citation>
    </ref>
    <ref id="jcc26198-bib-0008">
      <label>8</label>
      <mixed-citation publication-type="journal" id="jcc26198-cit-0008"><string-name><given-names>M. J.</given-names><surname>Abraham</surname></string-name>, <string-name><given-names>T.</given-names><surname>Murtola</surname></string-name>, <string-name><given-names>R.</given-names><surname>Schulz</surname></string-name>, <string-name><given-names>S.</given-names><surname>Páll</surname></string-name>, <string-name><given-names>J. C.</given-names><surname>Smith</surname></string-name>, <string-name><given-names>B.</given-names><surname>Hess</surname></string-name>, <string-name><given-names>E.</given-names><surname>Lindahl</surname></string-name>, <source xml:lang="en">SoftwareX</source><year>2015</year>, <volume>1–2</volume>, <fpage>19</fpage><pub-id pub-id-type="doi">10.1016/j.softx.2015.06.001</pub-id>.</mixed-citation>
    </ref>
    <ref id="jcc26198-bib-0009">
      <label>9</label>
      <mixed-citation publication-type="journal" id="jcc26198-cit-0009"><string-name><given-names>S.</given-names><surname>Pronk</surname></string-name>, <string-name><given-names>S.</given-names><surname>Páll</surname></string-name>, <string-name><given-names>R.</given-names><surname>Schulz</surname></string-name>, <string-name><given-names>P.</given-names><surname>Larsson</surname></string-name>, <string-name><given-names>P.</given-names><surname>Bjelkmar</surname></string-name>, <string-name><given-names>R.</given-names><surname>Apostolov</surname></string-name>, <string-name><given-names>M. R.</given-names><surname>Shirts</surname></string-name>, <string-name><given-names>J. C.</given-names><surname>Smith</surname></string-name>, <string-name><given-names>P. M.</given-names><surname>Kasson</surname></string-name>, <string-name><given-names>D.</given-names><surname>van der Spoel</surname></string-name>, <string-name><given-names>B.</given-names><surname>Hess</surname></string-name>, <string-name><given-names>E.</given-names><surname>Lindahl</surname></string-name>, <source xml:lang="en">Bioinformatics</source><year>2013</year>, <volume>29</volume>(<issue>7</issue>), <fpage>845</fpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btt055</pub-id>.<pub-id pub-id-type="pmid">23407358</pub-id></mixed-citation>
    </ref>
    <ref id="jcc26198-bib-0010">
      <label>10</label>
      <mixed-citation publication-type="journal" id="jcc26198-cit-0010"><string-name><given-names>K.</given-names><surname>Olesen</surname></string-name>, <string-name><given-names>N.</given-names><surname>Awasthi</surname></string-name>, <string-name><given-names>D. S.</given-names><surname>Bruhn</surname></string-name>, <string-name><given-names>W.</given-names><surname>Pezeshkian</surname></string-name>, <string-name><given-names>H.</given-names><surname>Khandelia</surname></string-name>, <source xml:lang="en">J Chem Theory Comput</source><year>2018</year>, <volume>14</volume>(<issue>6</issue>), <fpage>3342</fpage><pub-id pub-id-type="doi">10.1021/acs.jctc.8b00267</pub-id>.<pub-id pub-id-type="pmid">29750867</pub-id></mixed-citation>
    </ref>
    <ref id="jcc26198-bib-0011">
      <label>11</label>
      <mixed-citation publication-type="journal" id="jcc26198-cit-0011"><string-name><given-names>V.</given-names><surname>Hornak</surname></string-name>, <string-name><given-names>R.</given-names><surname>Abel</surname></string-name>, <string-name><given-names>A.</given-names><surname>Okur</surname></string-name>, <string-name><given-names>B.</given-names><surname>Strockbine</surname></string-name>, <string-name><given-names>A.</given-names><surname>Roitberg</surname></string-name>, <string-name><given-names>C.</given-names><surname>Simmerling</surname></string-name>, <source xml:lang="en">Proteins</source><year>2006</year>, <volume>65</volume>(<issue>3</issue>), <fpage>712</fpage><pub-id pub-id-type="doi">10.1002/prot.21123</pub-id>.<pub-id pub-id-type="pmid">16981200</pub-id></mixed-citation>
    </ref>
    <ref id="jcc26198-bib-0012">
      <label>12</label>
      <mixed-citation publication-type="journal" id="jcc26198-cit-0012"><string-name><given-names>A.</given-names><surname>Sali</surname></string-name>, <string-name><given-names>T. L.</given-names><surname>Blundell</surname></string-name>, <source xml:lang="en">J Mol Biol</source><year>1993</year>, <volume>234</volume>(<issue>3</issue>), <fpage>779</fpage><pub-id pub-id-type="doi">10.1006/jmbi.1993.1626</pub-id>.<pub-id pub-id-type="pmid">8254673</pub-id></mixed-citation>
    </ref>
    <ref id="jcc26198-bib-0013">
      <label>13</label>
      <mixed-citation publication-type="journal" id="jcc26198-cit-0013"><string-name><given-names>M.</given-names><surname>Lundborg</surname></string-name>, <string-name><given-names>E.</given-names><surname>Lindahl</surname></string-name>, <source xml:lang="en">J Phys Chem B</source><year>2014</year>, <volume>119</volume>(<issue>3</issue>), <fpage>810</fpage>.<pub-id pub-id-type="pmid">25343332</pub-id></mixed-citation>
    </ref>
    <ref id="jcc26198-bib-0014">
      <label>14</label>
      <mixed-citation publication-type="journal" id="jcc26198-cit-0014"><string-name><given-names>T.</given-names><surname>Darden</surname></string-name>, <string-name><given-names>D.</given-names><surname>York</surname></string-name>, <string-name><given-names>L.</given-names><surname>Pedersen</surname></string-name>, <source xml:lang="en">J Chem Phys</source><year>1993</year>, <volume>98</volume>(<issue>12</issue>), <fpage>10089</fpage><pub-id pub-id-type="doi">10.1063/1.464397</pub-id>.</mixed-citation>
    </ref>
    <ref id="jcc26198-bib-0015">
      <label>15</label>
      <mixed-citation publication-type="journal" id="jcc26198-cit-0015"><string-name><given-names>G.</given-names><surname>Bussi</surname></string-name>, <string-name><given-names>D.</given-names><surname>Donadio</surname></string-name>, <string-name><given-names>M.</given-names><surname>Parrinello</surname></string-name>, <source xml:lang="en">J Chem Phys</source><year>2007</year>, <volume>126</volume>(<issue>1</issue>), <elocation-id>014101</elocation-id><pub-id pub-id-type="doi">10.1063/1.2408420</pub-id>.<pub-id pub-id-type="pmid">17212484</pub-id></mixed-citation>
    </ref>
    <ref id="jcc26198-bib-0016">
      <label>16</label>
      <mixed-citation publication-type="journal" id="jcc26198-cit-0016"><string-name><given-names>M.</given-names><surname>Parrinello</surname></string-name>, <string-name><given-names>A.</given-names><surname>Rahman</surname></string-name>, <source xml:lang="en">J Appl Phys</source><year>1981</year>, <volume>52</volume>(<issue>12</issue>), <fpage>7182</fpage><pub-id pub-id-type="doi">10.1063/1.328693</pub-id>.</mixed-citation>
    </ref>
  </ref-list>
</back>
