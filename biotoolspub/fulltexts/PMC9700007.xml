<?DTDIdentifier.IdentifierValue -//ES//DTD journal article DTD version 5.6.0//EN//XML?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName art560.dtd?>
<?SourceDTD.Version 5.6.0?>
<?ConverterInfo.XSLTName elsevier2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<?origin publisher?>
<?FILEmeta_ISCI105535 xml ?>
<?FILEmain xml ?>
<?FILEmain pdf ?>
<?FILEgr1 jpg ?>
<?FILEgr2 jpg ?>
<?FILEgr3 jpg ?>
<?FILEgr4 jpg ?>
<?FILEgr5 jpg ?>
<?FILEgr6 jpg ?>
<?FILEgr7 jpg ?>
<?FILEgr8 jpg ?>
<?FILEfx1 jpg ?>
<?FILEmmc1 pdf ?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">iScience</journal-id>
    <journal-id journal-id-type="iso-abbrev">iScience</journal-id>
    <journal-title-group>
      <journal-title>iScience</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2589-0042</issn>
    <publisher>
      <publisher-name>Elsevier</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9700007</article-id>
    <article-id pub-id-type="pii">S2589-0042(22)01807-7</article-id>
    <article-id pub-id-type="doi">10.1016/j.isci.2022.105535</article-id>
    <article-id pub-id-type="publisher-id">105535</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>GILoop: Robust chromatin loop calling across multiple sequencing depths on Hi-C data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="au1">
        <name>
          <surname>Wang</surname>
          <given-names>Fuzhou</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author" id="au2">
        <name>
          <surname>Gao</surname>
          <given-names>Tingxiao</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author" id="au3">
        <name>
          <surname>Lin</surname>
          <given-names>Jiecong</given-names>
        </name>
        <xref rid="aff3" ref-type="aff">3</xref>
      </contrib>
      <contrib contrib-type="author" id="au4">
        <name>
          <surname>Zheng</surname>
          <given-names>Zetian</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author" id="au5">
        <name>
          <surname>Huang</surname>
          <given-names>Lei</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author" id="au6">
        <name>
          <surname>Toseef</surname>
          <given-names>Muhammad</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author" id="au7">
        <name>
          <surname>Li</surname>
          <given-names>Xiangtao</given-names>
        </name>
        <email>lixt314@jlu.edu.cn</email>
        <xref rid="aff4" ref-type="aff">4</xref>
        <xref rid="cor1" ref-type="corresp">∗</xref>
      </contrib>
      <contrib contrib-type="author" id="au8">
        <name>
          <surname>Wong</surname>
          <given-names>Ka-Chun</given-names>
        </name>
        <email>kc.w@cityu.edu.hk</email>
        <xref rid="aff1" ref-type="aff">1</xref>
        <xref rid="fn1" ref-type="fn">5</xref>
        <xref rid="cor2" ref-type="corresp">∗∗</xref>
      </contrib>
      <aff id="aff1"><label>1</label>Department of Computer Science, City University of Hong Kong, Kowloon Tong, Hong Kong SAR, China</aff>
      <aff id="aff2"><label>2</label>Department of Medical Biophysics, Faculty of Medicine, University of Toronto, Toronto, ON M5G1L7, Canada</aff>
      <aff id="aff3"><label>3</label>Molecular Pathology Unit, Center for Cancer Research, Massachusetts General Hospital, Department of Pathology, Harvard Medical School, Boston, MA 02129, USA</aff>
      <aff id="aff4"><label>4</label>School of Artificial Intelligence, Jilin University, Changchun 132000, China</aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><label>∗</label>Corresponding author <email>lixt314@jlu.edu.cn</email></corresp>
      <corresp id="cor2"><label>∗∗</label>Corresponding author <email>kc.w@cityu.edu.hk</email></corresp>
      <fn id="fn1">
        <label>5</label>
        <p id="ntpara0010">Lead contact</p>
      </fn>
    </author-notes>
    <pub-date pub-type="pmc-release">
      <day>10</day>
      <month>11</month>
      <year>2022</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on <pub-date
						pub-type="epub">.-->
    <pub-date pub-type="collection">
      <day>22</day>
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>10</day>
      <month>11</month>
      <year>2022</year>
    </pub-date>
    <volume>25</volume>
    <issue>12</issue>
    <elocation-id>105535</elocation-id>
    <history>
      <date date-type="received">
        <day>29</day>
        <month>6</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>4</day>
        <month>9</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>7</day>
        <month>11</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2022.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder/>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbyncndlicense">https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref>
        <license-p>This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).</license-p>
      </license>
    </permissions>
    <abstract id="abs0010">
      <title>Summary</title>
      <p>Graph and image are two common representations of Hi-C <italic>cis</italic>-contact maps. Existing computational tools have only adopted Hi-C data modeled as unitary data structures but neglected the potential advantages of synergizing the information of different views. Here we propose GILoop, a dual-branch neural network that learns from both representations to identify genome-wide CTCF-mediated loops. With GILoop, we explore the combined strength of integrating the two view representations of Hi-C data and corroborate the complementary relationship between the views. In particular, the model outperforms the state-of-the-art loop calling framework and is also more robust against low-quality Hi-C libraries. We also uncover distinct preferences for matrix density by graph-based and image-based models, revealing interesting insights into Hi-C data elucidation. Finally, along with multiple transfer-learning case studies, we demonstrate that GILoop can accurately model the organizational and functional patterns of CTCF-mediated looping across different cell lines.</p>
    </abstract>
    <abstract abstract-type="graphical" id="abs0015">
      <title>Graphical abstract</title>
      <fig id="undfig1" position="anchor">
        <graphic xlink:href="fx1"/>
      </fig>
    </abstract>
    <abstract abstract-type="author-highlights" id="abs0020">
      <title>Highlights</title>
      <p>
        <list list-type="simple" id="ulist0010">
          <list-item id="u0010">
            <label>•</label>
            <p id="p0010">A deep learning-based Hi-C loop caller robust across multiple sequencing depths</p>
          </list-item>
          <list-item id="u0015">
            <label>•</label>
            <p id="p0015">Integrating the graph-image duality of Hi-C data to deliver synergistic performance</p>
          </list-item>
          <list-item id="u0020">
            <label>•</label>
            <p id="p0020">Graph- and image-based models have distinct preferences for contact map density</p>
          </list-item>
          <list-item id="u0025">
            <label>•</label>
            <p id="p0025">GILoop is generalizable across cell lines and transferable across target proteins</p>
          </list-item>
        </list>
      </p>
    </abstract>
    <abstract abstract-type="teaser" id="abs0025">
      <p>Computational bioinformatics; Genomic analysis; Neural networks.</p>
    </abstract>
    <kwd-group id="kwrds0010">
      <title>Subject areas</title>
      <kwd>Computational bioinformatics</kwd>
      <kwd>Genomic analysis</kwd>
      <kwd>Neural networks</kwd>
    </kwd-group>
  </article-meta>
  <notes>
    <p id="misc0010">Published: December 22, 2022</p>
  </notes>
</front>
<body>
  <sec id="sec1">
    <title>Introduction</title>
    <p id="p0050">High-throughput chromosome conformation capture technique (Hi-C) and its variant protocols<xref rid="bib1" ref-type="bibr"><sup>1</sup></xref><sup>,</sup><xref rid="bib2" ref-type="bibr"><sup>2</sup></xref><sup>,</sup><xref rid="bib3" ref-type="bibr"><sup>3</sup></xref><sup>,</sup><xref rid="bib4" ref-type="bibr"><sup>4</sup></xref> have facilitated the study of the spatial organization of eukaryotic genome in the past decade. By combining the DNA crosslinking and chromatin proximity ligation with high-throughput sequencing, billions of read pairs can be generated in an Hi-C experiment, enabling the mapping of chromosomal interaction landscape throughout the whole genome. With the genome-wide view, it has been revealed that chromatin in the three-dimensional space is packaged hierarchically into multiple levels of fundamental architectural elements,<xref rid="bib5" ref-type="bibr"><sup>5</sup></xref><sup>,</sup><xref rid="bib6" ref-type="bibr"><sup>6</sup></xref> including compartments and sub-compartments,<xref rid="bib1" ref-type="bibr"><sup>1</sup></xref><sup>,</sup><xref rid="bib3" ref-type="bibr"><sup>3</sup></xref><sup>,</sup><xref rid="bib7" ref-type="bibr"><sup>7</sup></xref> topologically associating domains (TADs),<xref rid="bib8" ref-type="bibr"><sup>8</sup></xref><sup>,</sup><xref rid="bib9" ref-type="bibr"><sup>9</sup></xref> and chromatin loops.<xref rid="bib3" ref-type="bibr"><sup>3</sup></xref> On the other hand, Hi-C data have also been an effective tool for interpreting the complex relationships between the genome functions and the higher-order topology of chromatin.<xref rid="bib10" ref-type="bibr"><sup>10</sup></xref><sup>,</sup><xref rid="bib11" ref-type="bibr"><sup>11</sup></xref><sup>,</sup><xref rid="bib12" ref-type="bibr"><sup>12</sup></xref><sup>,</sup><xref rid="bib13" ref-type="bibr"><sup>13</sup></xref><sup>,</sup><xref rid="bib14" ref-type="bibr"><sup>14</sup></xref> To gain insightful understanding of the genome architecture in 3D space, extensive computational tools have been developed to analyze Hi-C data. These tools aim to either identify the architectural elements or decipher the underlying connections between the 3D structures of chromatin and functional properties.</p>
    <p id="p0055">Among those <italic>in silico</italic> tools, Hi-C data are typically modeled as different data structures according to specific task contexts. Most naturally, Hi-C <italic>cis</italic>-contact maps can be represented as a graph structure because the genomic loci and the interaction frequencies of locus-pairs closely resemble the vertices and edges in the definition of weighted graph. This graph representation is usually employed for detecting genome compartmentalisation<xref rid="bib7" ref-type="bibr"><sup>7</sup></xref> and is used for identifying TADs among chromatin.<xref rid="bib15" ref-type="bibr"><sup>15</sup></xref><sup>,</sup><xref rid="bib16" ref-type="bibr"><sup>16</sup></xref><sup>,</sup><xref rid="bib17" ref-type="bibr"><sup>17</sup></xref><sup>,</sup><xref rid="bib18" ref-type="bibr"><sup>18</sup></xref> Besides, in the latest studies, Hi-C graph has also been leveraged for modeling gene regulation patterns and predicting gene expression levels.<xref rid="bib19" ref-type="bibr"><sup>19</sup></xref> Another commonly adopted representation of Hi-C data mainly focuses on the 2D features of the <italic>cis</italic>-contact matrix. The linear connectivity of genomic loci enables the interaction matrix to manifest visually recognizable patterns on a grid-like 2D coordinate system, and thus it can be treated as an image. Specifically, TADs are characterized as square blocks along the diagonal and chromatin loops are radially symmetric focal peaks that are of higher interaction frequencies than the local or global background. Various tools have been developed based on such image representation of <italic>cis</italic>-contact maps; for example, in SIP<xref rid="bib20" ref-type="bibr"><sup>20</sup></xref> and Chromosight,<xref rid="bib21" ref-type="bibr"><sup>21</sup></xref> the matrices are regarded as images. Therefore, computer vision-based algorithms are leveraged for the detection of chromatin loops from interaction maps. In a recent study, Yoon et al.<xref rid="bib22" ref-type="bibr"><sup>22</sup></xref> employed the image view of Hi-C matrices to detect architectural stripes which exist at the boundaries of TADs. In addition, the image representation is the most commonly adopted data structure in the studies of Hi-C resolution enhancement.<xref rid="bib23" ref-type="bibr"><sup>23</sup></xref><sup>,</sup><xref rid="bib24" ref-type="bibr"><sup>24</sup></xref><sup>,</sup><xref rid="bib25" ref-type="bibr"><sup>25</sup></xref><sup>,</sup><xref rid="bib26" ref-type="bibr"><sup>26</sup></xref></p>
    <p id="p0060">The computational tools covered above have largely contributed to the computer-assisted analysis of Hi-C data. However, it is observed that each of them only focuses on a single view representation. In particular, under the subject of loop calling, all existing computational methods only adopt traditional probabilistic modeling or image-based computer vision algorithms to identify chromatin loops. Previous researchers have not used the graph representation in this specific field of study. This is an intriguing phenomenon – the graph representation and the image representation are different views which can provide effective information for performing the algorithms on their corresponding tasks, whereas the two pieces of information have never been combined together to conduct any analysis in existing computational models to the best of our knowledge. For this reason, the synergistic relationship between different data views has remained unclear and it is largely unknown whether the combination of the two sources of information extracted from each view can make any contribution in terms of both performance and insights.</p>
    <p id="p0065">In this study, we examine the graph-image duality (i.e., the property that Hi-C data can be represented as either a graph or an image) of Hi-C <italic>cis</italic>-contact map and elucidate that the graph view and the image view can provide complementary information to each other in the context of CCCTC-binding factor (CTCF)-mediated loop calling. We exemplify it by developing a dual-branch neural network termed GILoop, which learns from both views of the intra-chromosomal interaction matrix; and we experimentally demonstrate that the graph view and the image view both contribute to the recognition of CTCF-mediated loops. With the higher-level features fused from both streams of the model, GILoop not only expresses strong capability of annotating loops among the genome, significantly outperforming the existing machine learning-based loop calling algorithm Peakachu,<xref rid="bib27" ref-type="bibr"><sup>27</sup></xref> but also presents remarkable robustness against low quality Hi-C libraries. Moreover, the GILoop framework proposed in this work is transferable across cell lines. A trained GILoop model is able to predict CTCF-mediated loops in another cell line with minimal performance decay, enabling the generalization of GILoop to unknown cell types.</p>
    <p id="p0070">Based on the experimental results at different sequencing depths, we further discover that the deep learning models which learn from the graph view and the image view have different preferences on the sparsity of interaction matrix. Denser maps are preferred by image-based models whilst moderate sparsity is beneficial for graph-based deep learning on Hi-C data. The finding suggests that the density of Hi-C contact maps can be considered as a clue for performance optimization when applying machine learning algorithms on the graph view of Hi-C data. As a general principle, our finding may provide simple yet instructive experience for future researchers.</p>
  </sec>
  <sec id="sec2">
    <title>Results</title>
    <sec id="sec2.1">
      <title>Overview of GILoop</title>
      <p id="p0075">GILoop was designed for predicting chromatin interactions that are specifically mediated by CTCF across the genome when only Hi-C data and static DNA sequences are available. The two-branch architecture of GILoop was inspired by the graph-image duality described in the <xref rid="sec1" ref-type="sec">introduction</xref> section. The model extracts two streams of high-level features that are incorporated in different data representations, such that the fused information can describe the data from different perspectives. In particular, it consists of a U-Net<xref rid="bib28" ref-type="bibr"><sup>28</sup></xref> branch responsible for pixel-wise feature extraction from the image view and a graph convolutional network (GCN)<xref rid="bib29" ref-type="bibr"><sup>29</sup></xref> branch that extracts the edge-wise information from the graph view.</p>
      <p id="p0080">To form the input data for this special dual-branch model, we apply a patch sampling strategy to break down the large Hi-C matrix into small patches. The image part of the input is composed of these patches whereas the graph part is transformed from the image set (<xref rid="fig1" ref-type="fig">Figure 1</xref>A). Furthermore, as the GCN encoder accepts node features, k-mer sequence features and architectural-motif features are collected from the static DNA sequence of each genomic locus.<fig id="fig1"><label>Figure 1</label><caption><p>Proposed patch sampling strategy and the architecture of GILoop model</p><p>(A) The workflow of the patch sampling strategy starts from decomposing the target region (genomic distance less than 2 Mb) into multiple tiles. The patches collected along the diagonal are symmetric whilst those off-diagonal are asymmetric. These patches together make up the image set. Both types of the patches are transformed to generate the symmetric adjacency matrices. In addition to the adjacency matrices, static DNA features are scanned as node features of the graph set.</p><p>(B) The architecture of GILoop consists of two branches. The upper one on the figure is the U-Net branch which learns from the image view, taking in the image set sampled from the Hi-C data; the lower one is the GCN branch which extracts the graph features for prediction. The two branches are firstly pre-trained separately, and then they are combined through the bilinear pooling and are fine-tuned together to generate the fused feature maps. The fine-tuned fused model is then used for annotating the CTCF-mediated loops on other cell lines.</p></caption><graphic xlink:href="gr1"/></fig></p>
      <p id="p0085">Training a GILoop model requires two individual steps. Firstly each branch is pre-trained on their corresponding view of data, and then the separately trained branches are fused via a bilinear pooling operation. Throughout the two steps of the training stage, the supervision information is drawn from the orthogonal ChIA-PET data which annotate the CTCF-mediated loops pixel-wise.</p>
      <p id="p0090">At the annotation stage, the same sampling mechanism is applied and the results are projected back to the original genomic coordinates after the prediction is completed for all patches. Finally a paired genomic coordinate file is generated as the predictive results. <xref rid="fig1" ref-type="fig">Figure 1</xref>B illustrates the overall architecture and working principles of GILoop.</p>
      <p id="p0095">Taking in two streams of information, the model demonstrated a strong ability in recognizing CTCF-associated loop peaks. We adopted the Area Under Curve of the Precision-Recall curve (PR-AUC) to evaluate the performance of the model throughout this project. A brief workflow of GILoop can be found in <xref rid="mmc1" ref-type="supplementary-material">Figure S1</xref>.</p>
    </sec>
    <sec id="sec2.2">
      <title>Graph and image are complementary views of intra-chromosomal contact maps</title>
      <p id="p0100">A Hi-C <italic>cis</italic>-contact map can be represented as either a graph or an image, which enables various kinds of computational methods to perform on it. In the context of loop calling, existing tools only focus on the image properties of the data. However, whether the graph view of the Hi-C matrix encompasses information for chromatin looping prediction remains unclear. To investigate this, we carried out a series of ablation analysis and demonstrated that the two representations of Hi-C contact maps provide complementary information in the task of chromatin loop detection.</p>
      <p id="p0105">We treated the graph representation and the image representation as different data modalities in these experiments. Each stream of GILoop (i.e., the U-Net stream and the GCN stream) was pre-trained to the highest performance at their unitary data modality, and then both streams were fused and jointly fine-tuned on multi-modal supports. In this way, a comparison can be made to examine the existence of any inclusive relationship between the graph and image views on the data. If the returned co-training results are significantly better than those of either single modality, it implies that there exists distinct information provided by each view of data that is unseen by the other, and it could be concluded that the modalities are complementary to each other and it is not a relationship of inclusion between them. To model the most general cases in the real-world configuration, we downsampled the Hi-C data of the deeply sequenced GM12878 cell line<xref rid="bib1" ref-type="bibr"><sup>1</sup></xref> to 20% of its original sequencing depth (20% of 2.6 billion <italic>cis</italic>-reads), to obtain a moderate number of valid pairs that is common for normal Hi-C experiments. We found that the dual-branch model constantly outperforms either of the two uni-modal streams (<xref rid="fig2" ref-type="fig">Figure 2</xref>C). The PR curves of the three models trained in one experiment are presented as <xref rid="fig2" ref-type="fig">Figure 2</xref>D. It is reflected from the figure that the performance of the complete model is largely benefited from the image information extracted by the U-Net branch, whereas the graph stream provides a supportive function to its parallel network that helps improve the model’s ability in identifying CTCF-mediated loops.<fig id="fig2"><label>Figure 2</label><caption><p>Performance comparisons across the U-Net branch, the GCN branch, and the full model</p><p>(A) A set of CTCF-mediated loops that were not reported by the U-Net were successfully discovered by the fused model.</p><p>(B) A set of false positive loops reported by the unitary U-Net model were corrected by the fused model. The annotations of the fused model in both (a) and (b) were generated at the optimal probability thresholds, i.e., the threshold that had the highest F1 score (see <xref rid="sec4.4.2" ref-type="sec">metrics for performance evaluation</xref> in STAR Methods). For a fair comparison, in (a) the models output the same precision, and in (b) the models have the same recall.</p><p>(C) The distribution of the PR-AUCs evaluated on 11 times of experiments on the dataset of 520 million <italic>cis</italic>-reads (20% of the full GM12878 Hi-C data). Black horizontal lines denote the average PRAUC of each group. Asterisks (∗) denote <inline-formula><mml:math id="M1" altimg="si2.gif"><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula>-values smaller than 0.05 using Wilcoxon signed-rank test.</p><p>(D) The PR curves evaluated on the results predicted by the U-Net, the GCN, and the fused model in one of the experiments.</p></caption><graphic xlink:href="gr2"/></fig></p>
      <p id="p0110">We reason that the GCN branch learns the implicit features of the graph edges, which may help recognize the CTCF-mediated loops that are visually elusive on the interaction maps. <xref rid="fig2" ref-type="fig">Figure 2</xref>A shows an example where a set of loops were successfully captured by the full model whilst they were omitted by the uni-modal stream of U-Net. Moreover, there were also false positive loops that were corrected by the dual-stream model (<xref rid="fig2" ref-type="fig">Figure 2</xref>B). These observations indicate that the supportive information provided by the GCN branch is complementary to the image information and is indispensable for the accurate annotation of the CTCF-mediated loops. The learning ability of GILoop is a result of the combined strength of the graph stream and the image stream, which sets an example where the graph-image duality of Hi-C data is brought in the process of chromatin loop calling.</p>
    </sec>
    <sec id="sec2.3">
      <title>GILoop is highly targeted at CTCF-mediated loops</title>
      <p id="p0115">Although CTCF plays an important role in the mediation of chromatin looping, the variety of chromatin loops goes far beyond that. Previous studies have shown that loops can be mediated by other types of proteins such as transcription factors.<xref rid="bib30" ref-type="bibr"><sup>30</sup></xref><sup>,</sup><xref rid="bib31" ref-type="bibr"><sup>31</sup></xref> RNA Polymerase II has also been recognized as a key factor that orchestrates long-range interactions among the chromatin.<xref rid="bib31" ref-type="bibr"><sup>31</sup></xref><sup>,</sup><xref rid="bib32" ref-type="bibr"><sup>32</sup></xref><sup>,</sup><xref rid="bib33" ref-type="bibr"><sup>33</sup></xref> In recent years, emerging evidence has also suggested that RNA can perform the function of directing looping behaviors.<xref rid="bib34" ref-type="bibr"><sup>34</sup></xref> Traditional loop calling methods operating on Hi-C data typically annotate a mixed set of all kinds of loops, as Hi-C is an unbiased protocol that captures chromatin proximity without any specificity for regulatory elements. Here, with the supervision information provided by ChIA-PET,<xref rid="bib30" ref-type="bibr"><sup>30</sup></xref><sup>,</sup><xref rid="bib35" ref-type="bibr"><sup>35</sup></xref> GILoop expresses the strong ability of distinguishing CTCF-associated interactions from other types of significant interactions.</p>
      <p id="p0120">To illustrate the predictive ability of GILoop, we compared GILoop with a slightly modified version of Peakachu,<xref rid="bib27" ref-type="bibr"><sup>27</sup></xref> which is a previously published loop calling framework that leverages a random forest algorithm to recognize looping entries from non-looping interactions. This framework is trained on the datasets that are <inline-formula><mml:math id="M2" altimg="si1.gif"><mml:mrow><mml:mn>11</mml:mn><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo><mml:mn>11</mml:mn></mml:mrow></mml:math></inline-formula> sliding windows sampled from the Hi-C matrices, which outputs a genome-wide probability map of chromatin looping. As the computational pipeline of Peakachu includes a clustering step, which summarizes the probability map as a series of representative loops and eliminates the probability scores of the genome-wide interactions, the Peakachu model’s final output is a single point on the precision-recall plot. Therefore, to provide a more informative comparison between Peakachu and GILoop along the whole PR curves, we also considered a non-clustering version of Peakachu, in which the last step (i.e., the clustering step) was detached from the full pipeline so that the model could output the probability score for each pixel to generate the corresponding PR curves. <xref rid="fig3" ref-type="fig">Figure 3</xref>D compares Peakachu (both the full Peakachu pipeline and the non-clustering version) and GILoop on the 520 million-read Hi-C data – GILoop achieves significantly higher PRAUC on the test sets (chromosome take-out evaluation), indicating that the annotations made by GILoop are more accurate and have higher specificity targeting at the CTCF-mediated loops in terms of the average precision of all probability thresholds. We have also shown the precision-recall plots at different sequencing depths (<xref rid="mmc1" ref-type="supplementary-material">Figure S2</xref>), and it can be observed that the advantage of GILoop over Peakachu in identifying the CTCF-mediated loops is remarkable at other sequencing depths as well.<fig id="fig3"><label>Figure 3</label><caption><p>Comparisons between GILoop and benchmark models</p><p>(A) The loop probability map predicted by GILoop.</p><p>(B) The loop probability map predicted by Peakachu.</p><p>(C) The ground truths of CTCF-mediated loops in the same interaction region as (a) and (b).</p><p>(D) PR curves evaluated on the probability maps generated by GILoop and Peakachu, as well as the precision-recall point of the representative loops selected by Peakachu clustering step.</p><p>(E) APA plots of the loop sets output by GILoop, Peakachu, Chromosight, and SIP. L: left anchor, R: right anchor.</p><p>(F) The recovery plots of GILoop, Peakachu, Chromosight, and SIP, estimated on chromosome 5. Well-supported loops were obtained by taking the intersection of loop calls generated by HICCUPS and FitHiC.</p></caption><graphic xlink:href="gr3"/></fig></p>
      <p id="p0125">To better understand where the performance difference comes from, we plotted the probability maps generated by GILoop and Peakachu for an intuitive view of the results. We observed that GILoop could achieve a finer-grained probability mapping among the genome – the Peakachu model is blurred around the ground truths (<xref rid="fig3" ref-type="fig">Figures 3</xref>B and 3C). In contrast, GILoop outputs grid-like probabilities (<xref rid="fig3" ref-type="fig">Figures 3</xref>A and 3C) that are significantly and specifically highlighted at the entries of chromatin loops. Furthermore, the grid-like output generated by the model is highly consistent with the boundaries of TADs, which conforms to the rule that CTCF-mediated loops usually demarcate the boundary of TADs. This grid-like prediction also indicates a potential extension of GILoop in the future that it could be useful for the assistance in finding CTCF-demarcated TADs on the Hi-C matrices.</p>
      <p id="p0130">Apart from the evaluation conducted on the CTCF ChIA-PET labels, we were also intrigued by the validity of the putative loops in terms of their visual patterns and sensitivity to high-confidence loops. Hence, we first carried out aggregate peak analysis (APA)<xref rid="bib3" ref-type="bibr"><sup>3</sup></xref> on the annotations output by GILoop to validate the local enrichment of the loop calls with respect to the Hi-C background. For validation purposes, we benchmarked the APA plot of GILoop against Peakachu and the other two image-based loop callers SIP<xref rid="bib20" ref-type="bibr"><sup>20</sup></xref> and Chromosight.<xref rid="bib21" ref-type="bibr"><sup>21</sup></xref>
<xref rid="fig3" ref-type="fig">Figure 3</xref>E shows the average loop patterns yielded by APA, where each model proved to output a set of loops that are significantly enriched at the local areas (<italic>Z score</italic>&gt; 1.64; pvalue &lt; 0.05), and GILoop-detected loops are enriched at a more stringent or comparable significance level compared with the other three models.</p>
      <p id="p0135">For the sensitivity assessment, we performed recovery analysis on GILoop probability maps to evaluate the model’s capability of capturing well-supported loops (the loops reported by both HICCUPS<xref rid="bib3" ref-type="bibr"><sup>3</sup></xref> and FitHiC<xref rid="bib36" ref-type="bibr"><sup>36</sup></xref><sup>,</sup><xref rid="bib37" ref-type="bibr"><sup>37</sup></xref>). By calculating the recovery rates at each probability threshold, we created the recovery plots for GILoop, Peakachu, Chromosight, and SIP (<xref rid="fig3" ref-type="fig">Figures 3</xref>F, <xref rid="mmc1" ref-type="supplementary-material">S3</xref>, and <xref rid="mmc1" ref-type="supplementary-material">S4</xref>). Strikingly, even though GILoop was not trained on this particular set of labels, it performed the best among the four models in terms of finding those well-supported loops, highlighting the label generalizability and predictive reliability of GILoop.</p>
    </sec>
    <sec id="sec2.4">
      <title>The graph view provides robust support against low library quality</title>
      <p id="p0140">To examine the predictive ability of GILoop at multiple sequencing depths, we trained and tested models at seven different sequencing depths by downsampling the original GM12878 Hi-C data to different proportions of <italic>cis</italic>-read pairs – 39 million reads (1.5% downsample), 260 million (10% downsample), 520 million (20% downsample), 1.3 billion (50% downsample), 1.8 billion (70% downsample), 2.3 billion (90% downsample), and 2.6 billion (the full GM12878 contact map). The reader is referred to the downsampling section in <xref rid="sec4" ref-type="sec">STAR methods</xref> to know about how we downsampled the data.</p>
      <p id="p0145">From <xref rid="fig4" ref-type="fig">Figures 4</xref>A and 4C, it can be observed that the performance of the full model decreases as the sequencing depth becomes lower. Despite this, we found that the fused model was highly robust against low sequencing depths even when it was trained on the data that were downsampled to 1.5% and had only 39 million <italic>cis</italic>-reads left (<xref rid="fig4" ref-type="fig">Figures 4</xref>B and 4C; <xref rid="mmc1" ref-type="supplementary-material">Table S10</xref>). In this extreme case, the PRAUC can be maintained at around 0.208 (the mean value of the set of experiments). More intuitively, the annotations generated at different sequencing depths (<xref rid="fig4" ref-type="fig">Figure 4</xref>A) display similar patterns in the example region. Although the models at lower sequencing depths predicted more false positives and more false negatives (i.e., the undetected loops), the models were still able to locate the loops to the positions close to the ground truths, markedly reflecting the robustness of GILoop.<fig id="fig4"><label>Figure 4</label><caption><p>Performance results of U-Net, GCN, and the fused model are varied with the sequencing depth levels</p><p>(A) Annotations generated by GILoop at the sequencing depths of 39 million, 520 million, and 2.3 billion <italic>cis</italic>-reads. The true positives, false positives, and the undetected loops are denoted with different colors. The top 1,000 predictions with the highest probabilities on chromosome 18 were used to create these figures.</p><p>(B) The average PR-AUC of the multiple experiments at each sequencing depth. At each sequencing depth, there were 11 times of replicate experiments. In the figure, the flanking regions on the two sides of the line denote the SD estimated from the replicates. Outliers (the experiments where models did not converge) are trimmed at 1.5 interquartile range.</p><p>(C) The PR curves of the fused model trained at multiple sequencing depths.</p></caption><graphic xlink:href="gr4"/></fig></p>
      <p id="p0150">At the low resolution, the 2D image features become obscure and can be challenging to recognize with the naked eyes (<xref rid="mmc1" ref-type="supplementary-material">Figure S5</xref>), whilst the model can deliver a relatively high performance. To scrutinize the source that supports this robustness, we compared the full model with the single-branch models that were trained on unitary views at the 7 sequencing depths. We found that the collapse of the image features led to a large reduction of the performance on the U-Net branch, whereas the trend of the GCN branch was reversed to that (<xref rid="fig4" ref-type="fig">Figures 4</xref>B and <xref rid="mmc1" ref-type="supplementary-material">S6</xref>; <xref rid="mmc1" ref-type="supplementary-material">Tables S4–S10</xref>). The performance of the GCN model was very low and unstable at high sequencing depths, which is reflected in the figure as a low average PRAUC and a high standard deviation. As the sequencing depth went lower, the convergence became more stable and the performance of the model was constantly enhanced until the number of read pairs reached 260 million reads (i.e., 10% of the original GM12878 <italic>cis</italic>-reads), and thereafter the performance only decreased slightly. Therefore, as a fusion of two branches, the performance decay of the full model was not as fragile as that of the U-Net. These tendencies indicate that the robustness of GILoop is a result of the enriched features fused from both views, and that the GCN stream which learns from the graph view can avoid the performance loss brought by the low sequencing depth and thus plays an increasingly important role in practical situations. In a specific example when the downsampling level was 1.5% (39 million <italic>cis</italic>-reads), the PRAUC of the U-Net model dropped drastically to 0.135 (mean value), which was comparable to that of its complementary GNN branch (0.101 on average), whereas their fused model could achieve an average of 0.208 at this extreme experimental setting by taking in the features extracted based on both views of data. In this case, the image features extracted were weak and the performance improvement largely benefited from the supportive information provided by the graph view.</p>
    </sec>
    <sec id="sec2.5">
      <title>Views of graph and image have different preferences on sequencing depth</title>
      <p id="p0155">It was observed from <xref rid="fig4" ref-type="fig">Figure 4</xref>B that the performance of the two branches changes toward different directions as the sequencing depth shifts around. The opposite trends of U-Net and GCN imply a difference in their preference for the density of Hi-C matrix. In this section, we attempt to explain this phenomenon with an insight into the mechanism behind it.</p>
      <p id="p0160">Intuitively, it can be observed from the example patches (<xref rid="mmc1" ref-type="supplementary-material">Figure S5</xref>) that the loop regions are increasingly blurred, and the border between TAD regions and non-TAD regions becomes less steep, which also explains the performance decay of the U-Net model for loop calling – the broken patterns on the images can severely undermine the performance of the feature extractors based on convolutional filters (i.e., the U-Net).</p>
      <p id="p0165">The trend of GCN performance, however, is counter-intuitive – the reduction of Hi-C sequencing reads results in a loss of interaction information, yet triggers an ascent in terms of the performance of the graph-based machine learning model. The learning rule of graph neural networks may explain this phenomenon. The common form of GNNs includes two major steps: message transformation and neighborhood aggregation.<xref rid="bib38" ref-type="bibr"><sup>38</sup></xref> At each GNN layer, all the node features are transformed by applying a transformation function to the features passed from the previous layer, and afterward the new representation of the node is formed by aggregating its neighboring nodes. This formalism, termed “smoothing”, enables GNNs to learn on the assumption that the neighboring nodes tend to share the same or similar properties. At the same time, this propagation mechanism also makes the node representations tend to get close to each other after passing through multiple GNN layers and thus become indistinguishable in the embedded space, because multiple aggregation processes would introduce the messages from the nodes that are very remote from the desired node, resulting in the over-mixing of useful information and noisy information for a particular learning task. This phenomenon is so-called over-smoothing.<xref rid="bib39" ref-type="bibr"><sup>39</sup></xref><sup>,</sup><xref rid="bib40" ref-type="bibr"><sup>40</sup></xref><sup>,</sup><xref rid="bib41" ref-type="bibr"><sup>41</sup></xref><sup>,</sup><xref rid="bib42" ref-type="bibr"><sup>42</sup></xref></p>
      <p id="p0170">Under the scenario of this study, the adjacency matrices are weighted and are dense at the high sequencing depth. For a GNN model with only two GCN layers, a dense adjacency matrix with numerous non task-related connections may cause a higher likelihood for noisy information to be absorbed in the aggregation process, and thus aggravate the extent of over-smoothness. When the sequencing depth is low, the proportion of zero entries becomes larger, whereas the edges that are informative to the identification of chromatin loops are relatively preserved. The problem of over-smoothing is therefore alleviated, making the performance of the GCN model even greater when sequencing depth becomes lower.</p>
      <p id="p0175">To validate this hypothesis, we quantified the smoothness of the GCN models at different depth levels using Mean Average Distance (MAD)<xref rid="bib43" ref-type="bibr"><sup>43</sup></xref> (<xref rid="fig5" ref-type="fig">Figure 5</xref>, larger MAD indicates less smoothness) and it came out that the overall tendency of MAD is consistent with the models’ performance shifting over sequencing depths, which implies that the learning of the GCN model is highly correlated with the sequencing depth of Hi-C data. With the above evidence, we concluded that the appropriate sparsity of the contact matrix is beneficial for GNNs to learn on the Hi-C data, and we point out that in any graph-based deep learning applications that operate on Hi-C data, the recommended approach is to tune the contact matrix sparsity as a hyper-parameter instead of blindly taking the sequencing depth as high as possible.<fig id="fig5"><label>Figure 5</label><caption><p>Joint-plot of the PR-AUCs and MADs at different sequencing depths</p><p>Both metrics are evaluated on one experiment per sequencing depth. The MADs are computed based on a random part of the nodes of Hi-C graphs due to the overflowing memory growth.</p></caption><graphic xlink:href="gr5"/></fig></p>
    </sec>
    <sec id="sec2.6">
      <title>Combination of matrix sparsities yields the best performance</title>
      <p id="p0180">We carried out further experiments based on the discoveries described in the previous section and corroborated that the best results can be delivered only when the proper matrix densities are selected for training the branches of GILoop.</p>
      <p id="p0185">We pre-trained the GCN branch and the U-Net branch at the sequencing depths of 260 million reads (GM12878 Hi-C downsampled to 10%) and 2.6 billion reads (the full GM12878 dataset), respectively. The two pre-trained models were then jointly fine-tuned based on this mixed dataset. The experiments were replicated multiple times and we found that the mixed dataset can enhance the performance. The mean PRAUC of the models trained on the mixed densities is 0.3790, whereas this value is 0.3718 for the best models trained on single-depth 90% datasets (<xref rid="mmc1" ref-type="supplementary-material">Table S11</xref>). This set of experiments intuitively demonstrates that the combination of the best sparsities for the image view and the graph view can improve the model’s predictive ability. This finding further validates our conclusion obtained in the previous section that tuning the sparsity for GCN can be beneficial to the model, revealing the importance of choosing the appropriate combination of matrix densities – in a real-world application scenario, we can promote GILoop’s performance by choosing the highest sequencing depth for the U-Net branch but using a relatively sparse Hi-C matrix (i.e., downsampled to around 260 million <italic>cis</italic>-reads) for training the GCN branch.</p>
    </sec>
    <sec id="sec2.7">
      <title>GILoop is transferrable across cell lines</title>
      <p id="p0190">Once a GILoop model is trained on the Hi-C data of any cell line, it can be transferred to other human cell lines to predict the CTCF-mediated loops as long as the Hi-C data of the target cell line is available. The cross-cell-line predictive ability shows the use case of GILoop framework. We performed genome-wide predictions on the human K562 cell line using the model that was trained on the 520 million-read GM12878 dataset, and applied the 1.3 billion-read GM12878 model on the HeLa-S3 Hi-C. <xref rid="fig6" ref-type="fig">Figure 6</xref> illustrates the performances on the target datasets compared to those on the source datasets. The rationale behind the adoption of the downsampled GM12878 data of 520 million and 1.3 billion <italic>cis</italic>-reads is that the source and the target have the difference in terms of Hi-C sequencing depth (GM12878 2.6 billion, K562 500 million, and HeLa-S3 1.4 billion <italic>cis</italic>-read pairs. See <xref rid="mmc1" ref-type="supplementary-material">Table S1</xref>). Accordingly, the 20%-downsampled GM12878 Hi-C (520 million <italic>cis</italic>-reads) is the numerically closest to the K562 dataset (500 million <italic>cis</italic>-reads), and the 50% dataset (1.3 billion <italic>cis</italic>-reads) matches HeLa-S3 (also 1.3 billion <italic>cis</italic>-reads) the best. It was expressed by the results that the performance of GILoop on the transferred experimental settings is hardly altered compared to the test PRAUC on the source dataset, which supports the conclusion that the GILoop model is transferable across different cell types.<fig id="fig6"><label>Figure 6</label><caption><p>PR curves of GILoop evaluated on source datasets and the target datasets</p><p>(A) The PR curves on K562 (target dataset) and 20% GM12878 (source dataset).</p><p>(B) The PR curves on HeLa-S3 (target dataset) and 50% GM12878 (source dataset).</p></caption><graphic xlink:href="gr6"/></fig></p>
      <p id="p0195">With one GILoop model trained on a reliable dataset, it can be used to annotate CTCF-mediated loops for other cell types of similar sequencing depths. The robustness of our GLoop framework against sequencing depth broadens the use case of it – even if the qualities of Hi-C libraries are different for the source and target cell types, we can still transfer the model and keep a remarkable performance by downsampling one of the libraries to the comparable sequencing depth as that of the other one.</p>
      <p id="p0200">Moreover, to enable a wider application of GILoop framework, we released a series of models trained at different sequencing depths and made it available at <ext-link ext-link-type="uri" xlink:href="https://github.com/fzbio/GILoop" id="intref0010">https://github.com/fzbio/GILoop</ext-link>. These portable models can be downloaded and employed for the annotation of CTCF-mediated loops with the scripts provided in the project repository.</p>
    </sec>
    <sec id="sec2.8">
      <title>Properties of the chromatin loops predicted by GILoop</title>
      <p id="p0205">The chromatin loops predicted by GILoop possess significant genomic properties. We will show it in this section by comparing GILoop predictions with Peakachu predictions. To perform a fair comparison, we used the GILoop model trained on GM12878 to predict on cell line K562, and manually selected the probability threshold of 0.48 for the model. At this threshold, GILoop predicted a comparable number of loops as that of the clustered Peakachu annotation of K562 which is hosted on 3D genome browser.<xref rid="bib44" ref-type="bibr"><sup>44</sup></xref></p>
      <p id="p0210">We found that when the two models predict a similar number of loops, the vast majority of predicted loops do not overlap with those in the other group. <xref rid="fig7" ref-type="fig">Figure 7</xref>A shows the Venn diagram of GILoop- and Peakachu-predicted loops – only 3,795 out of over 16,000 loops are in the intersection of the two sets. The unique loops annotated by each model, however, have substantial discrepancies in terms of their organizational and functional characteristics. First of all, we examined the distribution of the genomic distances between the loop anchors for each group. It can be observed from the histograms (<xref rid="fig7" ref-type="fig">Figures 7</xref>B and 7C) that the GILoop-unique loops have a distribution that resembles the true distribution more than that of the Peakachu-unique loops. Compared to GILoop-unique loops, the loops predicted by Peakachu tend to have larger genomic distances in-between.<fig id="fig7"><label>Figure 7</label><caption><p>Organizational and functional comparisons between the loops on cell line K562 predicted by GILoop and Peakachu</p><p>(A) Venn diagram depicting the overlap between the loops annotated by GILoop and Peakachu.</p><p>(B and C) The histograms of the genomic distances between the anchors of GILoop- and Peakachu-predicted loops, in comparison with the true distribution (the distribution of the ChIA-PET loops).</p><p>(D) The enrichment of CTCF ChIP-Seq peaks surrounding the loop anchors among the GILoop-unique and Peakachu-unique loops. The average number of ChIP-Seq peaks is calculated for each locus within upstream and downstream 250 kb.</p><p>(E) CTCF motif orientations of the loops uniquely predicted by GILoop and Peakachu.</p><p>(F) Transcriptional regulatory elements at the loop anchors of each group. P: promoter; E: enhancer; N: there is no regulatory element at the anchor locus.</p></caption><graphic xlink:href="gr7"/></fig></p>
      <p id="p0215">We anticipated that the models trained with CTCF ChIA-PET data are more likely to predict loops that have enriched CTCF binding on the anchors. We validated this by visualizing the CTCF ChIP-Seq signals on the flanking regions of loop anchors predicted by each model. <xref rid="fig7" ref-type="fig">Figure 7</xref>D demonstrates that CTCF is highly enriched at the loop anchors annotated by both models. It is also evident that such enrichment is much stronger among the anchors of GILoop-unique loops, which indicates that GILoop can identify loops with more stringent CTCF relevance than Peakachu does.</p>
      <p id="p0220">On top of that, the formation of CTCF-mediated loops is highly correlated with the orientation of the CTCF binding motifs at the anchors<xref rid="bib3" ref-type="bibr"><sup>3</sup></xref><sup>,</sup><xref rid="bib45" ref-type="bibr"><sup>45</sup></xref><sup>,</sup><xref rid="bib46" ref-type="bibr"><sup>46</sup></xref> – the loops preferentially have convergent polarity of motifs on the anchors. We profiled the motif orientations of loop anchors predicted by both models with <xref rid="fig7" ref-type="fig">Figure 7</xref>E. Notwithstanding that both models predicted few loops with divergent motifs, loops uniquely predicted by GILoop are characterized by a high proportion (more than 60%) of convergent motifs, whereas less than 30% of the Peakachu-unique loops have convergent CTCF motifs. The ratio of tandem orientation is also higher among the GILoop-unique loops. Moreover, loops with single CTCF or with no motifs on either anchor are much fewer in the GILoop-unique group than in the Peakachu group. These results are highly consistent with the aforementioned theory that the convergence of the binding motifs is a determinant of the formation of CTCF loops.</p>
      <p id="p0225">The profile of regulatory elements on the loop anchors validates the functional properties of the loops predicted by GILoop (<xref rid="fig7" ref-type="fig">Figure 7</xref>F). Compared with Peakachu, GILoop predicted a higher percentage of loops with promoter-enhancer, promoter-promoter, and enhancer-enhancer interactions on the anchors. The proportion of loops with no transcriptional regulatory elements is also smaller among the loops annotated by GILoop. This property suggests that loops predicted by GILoop are more likely to have functional implications.</p>
    </sec>
    <sec id="sec2.9">
      <title>Pre-trained GILoop is generalizable to other proteins</title>
      <p id="p0230">Aside from CTCF loops, GILoop models are also able to detect the interactions mediated by other proteins, in a transfer learning fashion. GILoop makes use of the knowledge that has already been learned from the distribution of CTCF-mediated loops, and adjusts its parameters to adapt to the unseen yet related problem domain. This generalizability largely broadens the usability of GILoop, enabling a rapid deployment for annotating chromatin loops on a wider range of practical cases.</p>
      <p id="p0235">To demonstrate this transferability of GILoop, we conducted a series of experiments on an independently sequenced ChIA-PET dataset using the pre-trained models we obtained in the CTCF experiments. We used the ChIA-PET data on RAD21<xref rid="bib47" ref-type="bibr"><sup>47</sup></xref> (a member of cohesin complex) in these experiments, by which we explored GILoop’s ability in locating cohesin-associated loops. After training for several epochs, the model adapted to the new labels and yielded accurate predictions. The performance of GILoop in the transfer settings was also evaluated with PR curves, and the comparison between GILoop and Peakachu conducted on the 520 million-read dataset is shown in <xref rid="fig8" ref-type="fig">Figure 8</xref>. It can be observed that the PR curve of GILoop is far above the one of Peakachu (non-clustering version) and the point of the Peakachu representative loops. The results of protein-wise transfer learning experiments on other sequencing depths (39 million reads and 2.3 billion reads) are also impressive (<xref rid="mmc1" ref-type="supplementary-material">Figure S7</xref>).<fig id="fig8"><label>Figure 8</label><caption><p>PR curves of GILoop and Peakachu models trained on the 520 million-read dataset with RAD21 ChIA-PET labels</p></caption><graphic xlink:href="gr8"/></fig></p>
      <p id="p0240">The success of this cross-protein adaptation suggests that the high-level features learned by GILoop on the CTCF dataset are effective for robust and generic predictions in different downstream tasks, further illustrating the usability of GILoop. In future studies, the features extracted by GILoop have the potential to be used for different tasks, not limited to the area of loop calling.</p>
    </sec>
  </sec>
  <sec id="sec3">
    <title>Discussion</title>
    <p id="p0245">In this study, we explored the graph-image duality, which is an important property of the Hi-C intra-chromosomal contact map. Hi-C <italic>cis</italic>-matrix can be either regarded as a graph or an image, enabling a variety of graph-based and image-based algorithms to be applied. In previous studies, the Hi-C data were typically only treated as one of the data structures for detecting different architectural units of chromatin, whereas the property of graph-image duality has never been leveraged by any <italic>in silico</italic> software in the field of 3D genomics. The GILoop framework we developed in this work is an initial attempt that makes use of this property.</p>
    <p id="p0250">The proposed model is a deep learning model designed for extracting features from both views of Hi-C data, and thus it is a dual-branch structure composed of two parallel feature extractors. A U-Net-like branch extracts the pixel-wise image features, whereas the GCN branch is responsible for the extraction of edge-wise graph features. The final outputs of the model are learned based on the features extracted by both branches. With multiple experiments, we found that the graph view and image view of the data can provide complementary information for the recognition of CTCF-mediated chromatin loops, as the performance of the fused model is constantly better than any unitary branch. This finding indicates that the information incorporated by the image view or the graph view is not fully included by each other and that the computational algorithms focusing only on a single view can lead to a great loss of information.</p>
    <p id="p0255">In addition to the model architecture, we also introduced a patch sampling strategy to generate datasets that can be used for training deep learning models based on the graph-image duality of Hi-C data. This patching scheme divides the target region into multiple small blocks of equal sizes and transforms them into symmetric adjacency matrices, by which a set of images and a set of graphs are derived. In such a way, we overcome the challenge when the original Hi-C contact maps are too large in size and too few for a graph-based machine learning algorithm to learn from.</p>
    <p id="p0260">Taking in the enriched information originated from both sources of view, our model exhibited a strong predictive ability on detecting CTCF-mediated interactions among Hi-C <italic>cis</italic>-contact maps. GILoop significantly outperforms Peakachu in finding CTCF-associated loops – the latter is the most recent machine learning-based chromatin loop detector which also uses orthogonal ChIA-PET data as labels. Our experiments demonstrated that a trained GILoop model is transferable across different cell lines, and this transferability enables GILoop to annotate CTCF-mediated chromatin loops on unseen cell types. Moreover, our model shows strong robustness against low quality Hi-C library, which further extends the usability of GILoop. We also released multiple GILoop models pre-trained at various sequencing depths, making it available for future researchers to explore their Hi-C data easily with this promising tool.</p>
    <p id="p0265">The most significant discovery we made in this work is that there exists a discrepancy between the two branches of GILoop with regard to their preferences on the density of Hi-C contact maps. We explained the rationale behind this phenomenon by measuring the smoothness of the embeddings learned by the GCN extractor, attributing the performance degradation of GCNs to the over-smoothness caused by the increasing density of Hi-C contact maps. With this in mind, we pointed out the principles that should be followed when designing GNNs for graph feature extractions on Hi-C-like data – the matrix density (i.e. the sequencing depths) should be tuned as a hyper-parameter to balance the trade-off between the extent of GNN smoothness and the loss of interaction information. In the GILoop repository, we provide a function for matrix downsampling at the training stage, which automatically downsamples the Hi-C contact map to the optimal density that we experimentally obtained in this study (260 million <italic>cis</italic>-contacts), so that the performance of the GCN branch can be maximized. Nevertheless, users can also choose to use the non-downsampling mode (the “lazy” mode) to train the model, which directly trains the GCN branch on the input matrix and usually saves time because of the absence of the downsampling process. Overall, as the first computational tool making use of graph-image duality of Hi-C data, GILoop not only performs as an effective loop finder, but also offers new insights into the information encompassed by Hi-C-like data and pave the way for future 3D genomic studies wherever graph-based deep learning approaches are involved.</p>
    <sec id="sec3.1">
      <title>Limitations of the study</title>
      <p id="p0270">Single-cell Hi-C (scHi-C) data have become increasingly available in the past decade, and the demand for computational tools crafted for scHi-C is also drastically increasing. The tool we developed in this study, however, only focuses on bulk Hi-C. Despite the robustness against low sequencing depth (of bulk Hi-C), the proposed tool is still not capable enough to deal with the extremely sparse scHi-C data. Therefore, a promising piece of future work is replacing the downsampling step with an imputation process to investigate GILoop’s predictive ability on scHi-C datasets.</p>
      <p id="p0275">On the other hand, GILoop requires a relatively large amount of time to pre-process the data before sending the data into the computational pipeline to train the model. This pre-processing time mainly comes from the downsampling procedure, which involves a number of matrix transformations (i.e., drawing from the binomial distribution in batch, normalizing the downsampled data, and O/E matrix estimation) and hard disk reading/writing. Although this shortcoming is not a flaw of the time complexity of the core algorithm itself, it does lead to weak usability, if the targeted cell line has a sequencing depth different from any of the pre-trained models provided in the repository. This problem is likely to be addressed in the near future, as the authors of FAN-C<xref rid="bib48" ref-type="bibr"><sup>48</sup></xref> have scheduled a major update, in which a much faster version of FAN-C will be developed. GILoop will potentially be benefited from the later version of FAN-C to seek for reduced time consumption.</p>
    </sec>
  </sec>
  <sec id="sec4">
    <title>STAR★Methods</title>
    <sec id="sec4.1">
      <title>Key resources table</title>
      <p id="p0280">
        <table-wrap position="float" id="undtbl1">
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <th>REAGENT or RESOURCE</th>
                <th>SOURCE</th>
                <th>IDENTIFIER</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="3">
                  <bold>Deposited data</bold>
                </td>
              </tr>
              <tr>
                <td colspan="3">
                  <hr/>
                </td>
              </tr>
              <tr>
                <td>GM12878 Hi-C</td>
                <td>GEO</td>
                <td>GEO: <ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSE63525" id="intref0015">GSE63525</ext-link></td>
              </tr>
              <tr>
                <td>K562 Hi-C</td>
                <td>GEO</td>
                <td>GEO: <ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSE63525" id="intref0020">GSE63525</ext-link></td>
              </tr>
              <tr>
                <td>HeLa-S3 Hi-C</td>
                <td>4D Nucleome</td>
                <td>4D Nucleome: 4DNESCMX7L58</td>
              </tr>
              <tr>
                <td>GM12878 CTCF ChIA-PET</td>
                <td>GEO</td>
                <td>GEO: GSM1872886</td>
              </tr>
              <tr>
                <td>K562 CTCF ChIA-PET</td>
                <td>ENCODE</td>
                <td>ENCODE: ENCSR597AKG</td>
              </tr>
              <tr>
                <td>HeLa-S3 CTCF ChIA-PET</td>
                <td>GEO</td>
                <td>GEO: GSM1872888</td>
              </tr>
              <tr>
                <td>K562 chromatin state segmentation</td>
                <td>UCSC genome browser</td>
                <td>UCSC data: wgEncodeEH000790</td>
              </tr>
              <tr>
                <td>GM12878 RAD21 ChIA-PET</td>
                <td>Heidari et al., 2014</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/gr.176586.114" id="intref0025">https://doi.org/10.1101/gr.176586.114</ext-link>
                </td>
              </tr>
              <tr>
                <td>HICCUPS annotations on GM12878</td>
                <td>GEO</td>
                <td>GEO: <ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSE63525" id="intref0030">GSE63525</ext-link></td>
              </tr>
              <tr>
                <td>FitHiC annotations on GM12878</td>
                <td>Zenodo</td>
                <td>Zenodo: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.3380589" id="intref0035">https://doi.org/10.5281/zenodo.3380589</ext-link></td>
              </tr>
              <tr>
                <td colspan="3">
                  <hr/>
                </td>
              </tr>
              <tr>
                <td colspan="3">
                  <bold>Software and algorithms</bold>
                </td>
              </tr>
              <tr>
                <td colspan="3">
                  <hr/>
                </td>
              </tr>
              <tr>
                <td>GILoop</td>
                <td>This study</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://github.com/fzbio/GILoop" id="intref0040">https://github.com/fzbio/GILoop</ext-link>
                </td>
              </tr>
              <tr>
                <td>Peakachu</td>
                <td>Salameh et al., 2020</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://github.com/tariks/peakachu" id="intref0045">https://github.com/tariks/peakachu</ext-link>
                </td>
              </tr>
              <tr>
                <td>FAN-C</td>
                <td>Kruse et al., 2020</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://github.com/vaquerizaslab/fanc" id="intref0050">https://github.com/vaquerizaslab/fanc</ext-link>
                </td>
              </tr>
              <tr>
                <td>Keras</td>
                <td>Chollet et al., 2015</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://github.com/keras-team/keras" id="intref0055">https://github.com/keras-team/keras</ext-link>
                </td>
              </tr>
              <tr>
                <td>Tensorflow</td>
                <td>Abadi et al., 2015</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://github.com/tensorflow/tensorflow" id="intref0060">https://github.com/tensorflow/tensorflow</ext-link>
                </td>
              </tr>
              <tr>
                <td>SciPy</td>
                <td>Virtanen et al., 2020</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://github.com/scipy/scipy" id="intref0065">https://github.com/scipy/scipy</ext-link>
                </td>
              </tr>
              <tr>
                <td>Scikit-learn</td>
                <td>Pedregosa et al., 2011</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://github.com/scikit-learn/scikit-learn" id="intref0070">https://github.com/scikit-learn/scikit-learn</ext-link>
                </td>
              </tr>
              <tr>
                <td>FIMO</td>
                <td>Grant et al., 2011</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://meme-suite.org/meme/doc/fimo.html" id="intref0075">https://meme-suite.org/meme/doc/fimo.html</ext-link>
                </td>
              </tr>
              <tr>
                <td>Chromosight</td>
                <td>Matthey-Doret et al., 2020</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://github.com/koszullab/chromosight" id="intref0080">https://github.com/koszullab/chromosight</ext-link>
                </td>
              </tr>
              <tr>
                <td>SIP</td>
                <td>Rowley et al., 2020</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://github.com/PouletAxel/SIP" id="intref0085">https://github.com/PouletAxel/SIP</ext-link>
                </td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
      </p>
    </sec>
    <sec id="sec4.2">
      <title>Resource availability</title>
      <sec id="sec4.2.1">
        <title>Lead contact</title>
        <p id="p0285">Further information and requests for resources should be directed to and will be fulfilled by the lead contact, Ka-Chun Wong (<ext-link ext-link-type="uri" xlink:href="mailto:kc.w@cityu.edu.hk" id="interref0010">kc.w@cityu.edu.hk</ext-link>).</p>
      </sec>
      <sec id="sec4.2.2">
        <title>Materials availability</title>
        <p id="p0290">This study did not generate new unique reagents.</p>
      </sec>
    </sec>
    <sec id="sec4.3">
      <title>Method details</title>
      <sec id="sec4.3.1">
        <title>The graph-image duality and data pre-processing</title>
        <p id="p0295">Hi-C data are closely associated with the pair-wise spatial relationships across all genomic loci in the 3D space and thus they can be naturally represented as a graph-like data structure <inline-formula><mml:math id="M3" altimg="si3.gif"><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow></mml:math></inline-formula>. For such a Hi-C interaction graph, the vertex set <inline-formula><mml:math id="M4" altimg="si4.gif"><mml:mrow><mml:mi mathvariant="script">V</mml:mi></mml:mrow></mml:math></inline-formula> consists of all genomic loci on that chromosome and the edge set <inline-formula><mml:math id="M5" altimg="si5.gif"><mml:mrow><mml:mi mathvariant="script">E</mml:mi></mml:mrow></mml:math></inline-formula> is composed of the interaction frequencies across them. On the other hand, a Hi-C intra-chromosomal matrix can also be regarded as an image. As the genomic loci on the same chromosome are connected physically and sequentially with phosphodiester bond, local structures such as TADs and chromatin loops can be preserved when the matrix is visualized on a 2D coordinate system (e.g., square blocks along the diagonal are recognized as TADs; chromatin loops can be supported by visually recognizable foci on the interaction map). As such, it is demonstrated that a Hi-C <italic>cis</italic>-matrix can be represented as either a graph, where each entry is interpreted as the edge strength between two nodes, or an image, where the contact frequencies are treated as greyscale values of pixels. We term this property as graph-image duality.</p>
        <p id="p0300">This graph-image duality makes it possible to perform graph-based and image-based machine learning algorithms on different views of the same set of Hi-C data. However, there exists an obstacle from making use of it – the linear connectivity of loci also introduces a distance effect, by which a pair of loci that are close to each other on the 1D DNA sequence usually also have higher contact frequency. On the 2D interaction map, the distance effect is characterized by the decreasing mean value of the <inline-formula><mml:math id="M6" altimg="si6.gif"><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula>-th diagonal as <inline-formula><mml:math id="M7" altimg="si6.gif"><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula> increases. Therefore, the overall distribution of the edge weights is highly skewed and would add to the difficulty to learn on it. To get rid of the distance effect, we standardized the KR-normalized <italic>cis</italic>-matrix by dividing the entries on the <inline-formula><mml:math id="M8" altimg="si6.gif"><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula>-th diagonal with the mean, which is corresponding with the O/E matrix described in.<xref rid="bib1" ref-type="bibr"><sup>1</sup></xref> In this way, entries at all distances on the matrix were normalized to have an identical mean, i.e. the unit 1. After the O/E operation, a logarithmic transformation was applied to the adjacency matrix. Numerically, the element-wise transformation is computed as:<disp-formula id="fd1"><label>(Equation 1)</label><mml:math id="M9" altimg="si7.gif"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>ˆ</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="badbreak">=</mml:mo><mml:mi>log</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mfrac><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mtext>mean</mml:mtext><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mtext>diag</mml:mtext><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo linebreak="badbreak">−</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo linebreak="badbreak">+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="M10" altimg="si8.gif"><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo linebreak="badbreak">−</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> denotes the vector of elements on the <inline-formula><mml:math id="M11" altimg="si9.gif"><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo linebreak="badbreak">−</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula>-th diagonal of the original contact matrix. Theself-incremented unit 1 in the formula is to keep the transformed values positive. The transformed data were then clipped with a maximum of the 0.996 quantile of the training data to eliminate the outliers and then were re-scaled to the range of <inline-formula><mml:math id="M12" altimg="si10.gif"><mml:mrow><mml:mo>[</mml:mo><mml:mn>0,1</mml:mn><mml:mo>]</mml:mo></mml:mrow></mml:math></inline-formula>. The dataset for fitting a GILoop model was generated from the transformed <italic>cis</italic>-matrix with a patch sampling tactic as described in the next section.</p>
      </sec>
      <sec id="sec4.3.2">
        <title>Patch sampling strategy</title>
        <p id="p0305">The intra-chromosomal Hi-C maps at 10 kb resolution are extremely large (matrix size varying from <inline-formula><mml:math id="M13" altimg="si11.gif"><mml:mrow><mml:mn>4813</mml:mn><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo><mml:mn>4813</mml:mn></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="M14" altimg="si12.gif"><mml:mrow><mml:mn>24926</mml:mn><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo><mml:mn>24926</mml:mn></mml:mrow></mml:math></inline-formula> for humans) and there are only 23 such graphs (i.e., 23 chromosomes for humans) among the whole genome. A dataset composed of these raw matrices would contain 23 samples with various sizes and extremely large memory usage. Neither graph-based nor image-based algorithms could learn on such a dataset. To address this issue, we applied a patch sampling strategy which generated a large number of small images and sub-graphs for downstream machine learning algorithms.</p>
        <p id="p0310">Patches were collected from the region that is less than 2 Mb away from the chromosomal diagonal – 2 Mb is the upper bound of the valid area where most TADs exist and few significant loops are located outside it.<xref rid="bib3" ref-type="bibr"><sup>3</sup></xref><sup>,</sup><xref rid="bib23" ref-type="bibr"><sup>23</sup></xref> The patches are of size <inline-formula><mml:math id="M15" altimg="si13.gif"><mml:mrow><mml:mn>64</mml:mn><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo><mml:mn>64</mml:mn><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:msup><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and they can be tiled to cover the whole valid region. The image set is composed of the patches that were sampled from the upper triangular matrix of the Hi-C map (including those along the diagonal). However, this kind of squares did not meet the condition of forming graph adjacency matrices as the patches that are off the major diagonal are non-symmetric. Therefore, to construct the graph set, each adjacency matrix was formed by transposing the corresponding image and arranging the original and transposed images along the minor diagonal. Formally, an adjacency matrix in the graph set is defined as:<disp-formula id="fd2"><label>(Equation 2)</label><mml:math id="M16" altimg="si14.gif"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo linebreak="badbreak">=</mml:mo><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>X</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="M17" altimg="si15.gif"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> denotes the <inline-formula><mml:math id="M18" altimg="si16.gif"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula>-th sample of the graph set, and <inline-formula><mml:math id="M19" altimg="si17.gif"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M20" altimg="si18.gif"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> are the <inline-formula><mml:math id="M21" altimg="si16.gif"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula>-th image and its transposed matrix, respectively. The size of each graph is <inline-formula><mml:math id="M22" altimg="si19.gif"><mml:mrow><mml:mn>128</mml:mn><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo><mml:mn>128</mml:mn></mml:mrow></mml:math></inline-formula>. The zero entries in <xref rid="fd2" ref-type="disp-formula">Equation 2</xref> guarantee that each graph sample is distinct and does not have overlapping information with each other, preventing information leakage to the test set at the training stage. The adjacency matrices constructed from symmetric patches and the asymmetric patches are of the same form in the graph set, which also enabled the model to deliver the best performance in practice. With this approach, the dataset can also cover the whole area of the target region.</p>
        <p id="p0315">The labels for the dataset are matrices of the same size as that of the patches – for each sampled patch, there is a label matrix where each entry is a binary indicator denoting whether the corresponding position is a CTCF-mediated chromatin loop or not, which establishes a point-to-point mapping between the Hi-C matrix and the loops identified by CTCF ChIA-PET experiments.</p>
      </sec>
      <sec id="sec4.3.3">
        <title>The dual-branch autoencoder structure</title>
        <p id="p0320">Loop calling is a pixel-wise (edge-wise for the graph view) classification task with a serious data imbalance problem. Based on the aforementioned graph-image duality and the problem configuration, a dual-branch neural network was designed to learn the loop classification from both views of the Hi-C <italic>cis</italic>-contact maps. Specifically, the encoder part of the architecture consists of a GCN branch and a U-Net branch, extracting the graph features and the image features, respectively. A dense decoder is connected on the top of the encoder to output the predictions based on the high-level graph and image features. The output of the model is a binary matrix of the same size as the sampled patches, and thus the annotations made by the model can cover each pixel/edge of the target region. The technical details of the two branches and the joint training are introduced in the next three sections.</p>
      </sec>
      <sec id="sec4.3.4">
        <title>The GCN branch for graph feature extraction</title>
        <p id="p0325">To learn from the graph view of the data, we employed a GCN<xref rid="bib29" ref-type="bibr"><sup>29</sup></xref>-based encoder to extract features at the edge level. This model takes the adjacency matrix and its corresponding node feature matrix as input, and outputs the embeddings of the edges. Specifically, the encoder presented in this work consists of two components. The first part is the core GCN unit, which extracts the high-level node features of the graph by message transformation and aggregation.<xref rid="bib38" ref-type="bibr"><sup>38</sup></xref> The GCN layer approximates the spectral graph convolution<xref rid="bib49" ref-type="bibr"><sup>49</sup></xref><sup>,</sup><xref rid="bib50" ref-type="bibr"><sup>50</sup></xref> with the following propagation rule:<xref rid="bib29" ref-type="bibr"><sup>29</sup></xref><disp-formula id="fd3"><label>(Equation 3)</label><mml:math id="M23" altimg="si20.gif"><mml:mrow><mml:msup><mml:mi>Z</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo linebreak="badbreak">=</mml:mo><mml:mi>σ</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mtext>sym</mml:mtext></mml:msub><mml:msup><mml:mi>Z</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="M24" altimg="si21.gif"><mml:mrow><mml:msup><mml:mi>Z</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is the vertex features extracted by the <inline-formula><mml:math id="M25" altimg="si22.gif"><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:math></inline-formula>-th GCN layer, and <inline-formula><mml:math id="M26" altimg="si23.gif"><mml:mrow><mml:msup><mml:mi>Z</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is the original node features input to the network. <inline-formula><mml:math id="M27" altimg="si24.gif"><mml:mrow><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> denotes the learnable filter at the <inline-formula><mml:math id="M28" altimg="si22.gif"><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:math></inline-formula>-th GCN layer. An activation function <inline-formula><mml:math id="M29" altimg="si25.gif"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow></mml:math></inline-formula> is applied to introduce the non-linearity to the network. In particular, <inline-formula><mml:math id="M30" altimg="si26.gif"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mtext>sym</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> is the symmetrically normalized adjacency matrix of the graph<inline-formula><mml:math id="M31" altimg="si27.gif"><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow></mml:math></inline-formula>, whose node set has a cardinality of <inline-formula><mml:math id="M32" altimg="si28.gif"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>. This normalization can be represented as:<disp-formula id="fd4"><label>(Equation 4)</label><mml:math id="M33" altimg="si29.gif"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mtext>sym</mml:mtext></mml:msub><mml:mo linebreak="badbreak">=</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:msup><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="M34" altimg="si30.gif"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo linebreak="goodbreak" linebreakstyle="after">∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> denotes the adjacency matrix adding a self-connection (i.e. <inline-formula><mml:math id="M35" altimg="si31.gif"><mml:mrow><mml:mi>I</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">+</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="M36" altimg="si32.gif"><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:math></inline-formula> is the graph’s adjacency matrix and <inline-formula><mml:math id="M37" altimg="si33.gif"><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula> is an identity matrix). <inline-formula><mml:math id="M38" altimg="si34.gif"><mml:mrow><mml:mover accent="true"><mml:mi>D</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is the degree matrix of <inline-formula><mml:math id="M39" altimg="si35.gif"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>, which is a diagonal matrix where the <inline-formula><mml:math id="M40" altimg="si16.gif"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula>-th entry is the sum of the corresponding <inline-formula><mml:math id="M41" altimg="si16.gif"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula>-th row of <inline-formula><mml:math id="M42" altimg="si35.gif"><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> such that <inline-formula><mml:math id="M43" altimg="si36.gif"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>.</p>
        <p id="p0330">In formula 3, <inline-formula><mml:math id="M44" altimg="si24.gif"><mml:mrow><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> performs as the transformation function applied to node features <inline-formula><mml:math id="M45" altimg="si21.gif"><mml:mrow><mml:msup><mml:mi>Z</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, and the result of this operation multiplying <inline-formula><mml:math id="M46" altimg="si26.gif"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mtext>sym</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> aggregates the neighbouring nodes among the topology. Stacked GCN layers can learn the implicit advanced features of graph vertices, combining the topological information and node features. The node features for this model are static DNA features of the genomic loci which include k-mer features and architectural motif features. The node feature selection is introduced in the later sub-section of the <xref rid="sec4" ref-type="sec">STAR Methods</xref> Section.</p>
        <p id="p0335">The second part of the encoder is a set of node-to-edge and edge-to-node operations similar to the definitions in.<xref rid="bib51" ref-type="bibr"><sup>51</sup></xref> These small layers not only generate edge embeddings from node activations, but also enhance the learning ability of the encoder. The two operations are defined as:<disp-formula id="fd5"><label>(Equation 5)</label><mml:math id="M47" altimg="si37.gif"><mml:mrow><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:mrow><mml:mtext>node</mml:mtext><mml:mo linebreak="badbreak">−</mml:mo><mml:mtext>to</mml:mtext><mml:mo linebreak="badbreak">−</mml:mo><mml:mtext>edge</mml:mtext><mml:mo>:</mml:mo><mml:mspace width="1em"/></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo linebreak="badbreak">=</mml:mo><mml:msubsup><mml:mtext>MLP</mml:mtext><mml:mi>e</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mtext>edge</mml:mtext><mml:mo linebreak="badbreak">−</mml:mo><mml:mtext>to</mml:mtext><mml:mo linebreak="badbreak">−</mml:mo><mml:mtext>node</mml:mtext><mml:mo>:</mml:mo><mml:mspace width="1em"/></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo linebreak="badbreak">+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo linebreak="badbreak">=</mml:mo><mml:msubsup><mml:mtext>MLP</mml:mtext><mml:mi>v</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo linebreak="badbreak">∈</mml:mo><mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:msubsup><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="M48" altimg="si38.gif"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M49" altimg="si39.gif"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> represent feature vectors of node <inline-formula><mml:math id="M50" altimg="si16.gif"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M51" altimg="si40.gif"><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula> at the <inline-formula><mml:math id="M52" altimg="si22.gif"><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:math></inline-formula>-th layer, and <inline-formula><mml:math id="M53" altimg="si41.gif"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> denotes the embedding of the edge connecting node <inline-formula><mml:math id="M54" altimg="si16.gif"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M55" altimg="si40.gif"><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula>. <inline-formula><mml:math id="M56" altimg="si42.gif"><mml:mrow><mml:msubsup><mml:mtext>MLP</mml:mtext><mml:mi>e</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M57" altimg="si43.gif"><mml:mrow><mml:msubsup><mml:mtext>MLP</mml:mtext><mml:mi>v</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> are small multi-layer perceptrons (MLPs) that transform the edge embeddings or node embeddings. <inline-formula><mml:math id="M58" altimg="si44.gif"><mml:mrow><mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is a set containing all nodes that are possible to connect with node <inline-formula><mml:math id="M59" altimg="si40.gif"><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula> to form an edge. <inline-formula><mml:math id="M60" altimg="si45.gif"><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mspace width="0.5em"/><mml:mo linebreak="badbreak">·</mml:mo><mml:mspace width="0.5em"/></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math></inline-formula> denotes the concatenation operation.</p>
        <p id="p0340">The GCN-based encoder described above generates a <inline-formula><mml:math id="M61" altimg="si46.gif"><mml:mrow><mml:mn>16</mml:mn></mml:mrow></mml:math></inline-formula>-dim feature vector for each edge.</p>
      </sec>
      <sec id="sec4.3.5">
        <title>The U-Net branch for image feature extraction</title>
        <p id="p0345">The other branch is a U-Net-like<xref rid="bib28" ref-type="bibr"><sup>28</sup></xref> structure based on CNN, which is responsible for the extraction of image features. The U-Net employed in this study is composed of a compressive path that extracts high-level image features and an expanding path that recovers the high spatial resolution. The compressive path and the expanding path together make up a U-shape and can be leveraged for pixel-wise classification – the final output that has the same size as that of the input is a binary matrix where each entry indicates the existence of the loop at that pixel.</p>
        <p id="p0350">The compressive path has a typical CNN architecture that contains a series of downsampling blocks. Each block consists of two convolution layers with ReLU activation and a sub-sampling max-pooling layer with <inline-formula><mml:math id="M62" altimg="si47.gif"><mml:mrow><mml:mn>2</mml:mn><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> pooling size. The number of feature channels is increased through each block whilst the spatial resolution is consecutively halved by the max-pooling operation. At the end of the compressive path (i.e., the middle of the U shape), the number of channels is increased to 512 and the spatial resolution of the feature maps is reduced to <inline-formula><mml:math id="M63" altimg="si48.gif"><mml:mrow><mml:mn>4</mml:mn><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>. The expanding path is the opposite architecture that replaces the max-pooling layers in the compressive path with upsampling layers, and the number of feature channels is decreased to 32 throughout the path. A residual mechanism for mixing the high-level and low-level features is introduced by concatenating the feature maps in the expanding path with corresponding maps from the compressive path. An additional convolutional layer is used at the end to yield the final feature maps of the desired number of channels, i.e., 16.</p>
      </sec>
      <sec id="sec4.3.6">
        <title>Fusion of information streams and joint training</title>
        <p id="p0355">Each branch of the whole model was pre-trained on their corresponding view for multiple epochs until the best performance was achieved (monitored by an early stopping mechanism). Then, the unitary models were fused by a bilinear layer that combines the information from the two sources. By fine-tuning jointly, the weights of the combined model were updated through epochs to reach the finalized states.</p>
        <p id="p0360">At the pre-training stage, each unitary model has a MLP decoder stacked at the top of the main architecture to output the predictions for gradient computation and performance evaluation. Thereafter at the fine-tuning stage, the MLPs are removed and the two branches are connected by the bilinear layer, which conducts:<list list-type="simple" id="olist0010"><list-item id="o0010"><label>(i)</label><p id="p0365">an outer product operation on two <inline-formula><mml:math id="M64" altimg="si49.gif"><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula>-dim heterogeneous feature vectors extracted by different models to generate a <inline-formula><mml:math id="M65" altimg="si50.gif"><mml:mrow><mml:mi>M</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> feature map;</p></list-item><list-item id="o0015"><label>(ii)</label><p id="p0370">flattening the matrix to a vector of the dimensionality <inline-formula><mml:math id="M66" altimg="si51.gif"><mml:mrow><mml:msup><mml:mi>M</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>;</p></list-item><list-item id="o0020"><label>(iii)</label><p id="p0375">taking the signed square root; and</p></list-item><list-item id="o0025"><label>(iv)</label><p id="p0380">L2 normalization.</p></list-item></list></p>
        <p id="p0385">Formally, the bilinear layer is defined as the following tensor operations where <inline-formula><mml:math id="M67" altimg="si52.gif"><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M68" altimg="si53.gif"><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:math></inline-formula> are feature vectors of size <inline-formula><mml:math id="M69" altimg="si54.gif"><mml:mrow><mml:mi>M</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>:<disp-formula id="fd6"><label>(Equation 6)</label><mml:math id="M70" altimg="si55.gif"><mml:mrow><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mtext>flatten</mml:mtext><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi><mml:msup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mtext>sign</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msqrt><mml:mrow><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:msqrt></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mfrac><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mo>‖</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>‖</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mspace width="1em"/><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo linebreak="goodbreak">∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:msup><mml:mi>M</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:msup></mml:mrow></mml:math></disp-formula></p>
        <p id="p0390">In the dual-branch GILoop model, two <inline-formula><mml:math id="M71" altimg="si46.gif"><mml:mrow><mml:mn>16</mml:mn></mml:mrow></mml:math></inline-formula>-dim feature vectors for a single pixel are extracted by the GCN and the U-Net, respectively. The bilinear operation and the concomitant transformations then yield a <inline-formula><mml:math id="M72" altimg="si56.gif"><mml:mrow><mml:mn>256</mml:mn></mml:mrow></mml:math></inline-formula>-dim feature vector of the pixel at that position following the rule in <xref rid="fd6" ref-type="disp-formula">Equation 6</xref>. This vector is then passed through a new MLP decoder to generate the final predictions. The number of parameters of each model is included in <xref rid="mmc1" ref-type="supplementary-material">Table S2</xref>.</p>
      </sec>
      <sec id="sec4.3.7">
        <title>Focal cross-entropy loss</title>
        <p id="p0395">We leveraged the focal cross-entropy loss<xref rid="bib52" ref-type="bibr"><sup>52</sup></xref> as a countermeasure to tackle the extreme class imbalance problem. Focal loss includes a modulating term and a weighting factor to reduce the loss of the easily classified examples and focus on the hard examples. For a binary classification problem, the focal loss is defined as:<disp-formula id="fd7"><label>(Equation 7)</label><mml:math id="M73" altimg="si57.gif"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo linebreak="badbreak">=</mml:mo><mml:mo linebreak="badbreak">−</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo linebreak="badbreak">−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mi>γ</mml:mi></mml:msup><mml:mo linebreak="badbreak">·</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo linebreak="goodbreak">·</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>in which<inline-formula><mml:math id="M74" altimg="si58.gif"><mml:mrow><mml:mi>γ</mml:mi></mml:mrow></mml:math></inline-formula> denotes the modulating factor, and <inline-formula><mml:math id="M75" altimg="si59.gif"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M76" altimg="si60.gif"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> are defined as follows:<disp-formula id="fd8"><label>(Equation 8)</label><mml:math id="M77" altimg="si61.gif"><mml:mrow><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mspace width="1em"/></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:mi>α</mml:mi></mml:mtd><mml:mtd><mml:mrow><mml:mi>y</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo linebreak="badbreak">−</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>y</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mspace width="1em"/></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:mi>p</mml:mi></mml:mtd><mml:mtd><mml:mrow><mml:mi>y</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo linebreak="badbreak">−</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>y</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="M78" altimg="si2.gif"><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula> is the probability of a pixel/edge being a loop predicted by the network and <inline-formula><mml:math id="M79" altimg="si62.gif"><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:math></inline-formula> is the tunable weighting factor provided by the user. In GILoop framework <inline-formula><mml:math id="M80" altimg="si58.gif"><mml:mrow><mml:mi>γ</mml:mi></mml:mrow></mml:math></inline-formula> was set to 1.2 and <inline-formula><mml:math id="M81" altimg="si62.gif"><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:math></inline-formula> was set to <inline-formula><mml:math id="M82" altimg="si63.gif"><mml:mrow><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula>. Due to the numerically small values of the averaged focal loss, we multiplied the loss by 4,096 to balance with the regularisation loss introduced by the L2 regularisation which was applied to each trainable layer.</p>
      </sec>
      <sec id="sec4.3.8">
        <title>Node features: The static sequence features</title>
        <p id="p0400">The node features for training the GCN model are composed of two parts. For each locus, the frequencies of 3-mer and 4-mer patterns were counted from its DNA sequence, encoded into a 320-dimensional feature space (64 3-mer and 256 4-mer). Apart from the k-mer features, the occurrence counts of multiple architecture-related motifs were scanned from each locus as the second part of the feature input. These architectural motifs are the union of CTCF-motifs and the transcription factor (TF) motifs that are correlated with the sub-compartment units identified by Ashoor et al.<xref rid="bib7" ref-type="bibr"><sup>7</sup></xref> The position weight matrix (PWM) of each motif was downloaded from JASPAR.<xref rid="bib53" ref-type="bibr"><sup>53</sup></xref> The motif occurrences were scanned genome-wide using FIMO, with the <inline-formula><mml:math id="M83" altimg="si64.gif"><mml:mrow><mml:mi>p</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">−</mml:mo><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:math></inline-formula> parameter set to <inline-formula><mml:math id="M84" altimg="si65.gif"><mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. The list of the motifs can be found in <xref rid="mmc1" ref-type="supplementary-material">Table S3</xref>.</p>
      </sec>
      <sec id="sec4.3.9">
        <title>Hi-C datasets and orthogonal annotations</title>
        <p id="p0405">The datasets used in this study include the Hi-C data for input and ChIA-PET data as the ground truth labels. The GM12878 Hi-C data are the deeply sequenced <italic>in situ</italic> Hi-C released by Rao et al.,<xref rid="bib3" ref-type="bibr"><sup>3</sup></xref> which possess 2.6 billion intra-chromosomal and 772 million inter-chromosomal valid pairs. The K562 Hi-C<xref rid="bib3" ref-type="bibr"><sup>3</sup></xref> incorporates 503 million <italic>cis</italic>-read pairs and 126 million trans-pairs. HeLa-S3 Hi-C is available on 4D Nucleome data portal.<xref rid="bib54" ref-type="bibr"><sup>54</sup></xref> Details about the Hi-C data work can be found in <xref rid="mmc1" ref-type="supplementary-material">Table S1</xref>.</p>
        <p id="p0410">The Hi-C data of cell line GM12878 were downsampled to simulate the data at different library qualities. This was achieved by removing the valid pairs in the original library randomly. The downsampling rates in this study are referred to as the ratios of reads that are left in the read pool after the downsampling procedure. For example, suppose the original Hi-C data have <inline-formula><mml:math id="M85" altimg="si66.gif"><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> reads in total, the downsampled data at the 20% downsampling rate would have <inline-formula><mml:math id="M86" altimg="si67.gif"><mml:mrow><mml:mn>0.2</mml:mn><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> reads, and the other <inline-formula><mml:math id="M87" altimg="si68.gif"><mml:mrow><mml:mn>0.8</mml:mn><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> reads would be eliminated (<xref rid="mmc1" ref-type="supplementary-material">Table S1</xref>).</p>
        <p id="p0415">The CTCF ChIA-PET data of cell line GM12878 and HeLa-S3 were both generated in.<xref rid="bib32" ref-type="bibr"><sup>32</sup></xref> The CTCF ChIA-PET annotations of K562 were retrieved from ENCODE project<xref rid="bib55" ref-type="bibr"><sup>55</sup></xref> (<ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/" id="intref0090">https://www.encodeproject.org/</ext-link>). The CTCF ChIA-PET data of K562 and HeLa-S3 were converted to genome builds consistent with their corresponding Hi-C data using liftOver in UCSC genome browser.<xref rid="bib56" ref-type="bibr"><sup>56</sup></xref> For K562 ChIA-PET, a loop was preserved only if it was validated by both replicates of the experiment set. RAD21 ChIA-PET data for GM12878 were published with.<xref rid="bib47" ref-type="bibr"><sup>47</sup></xref> Promoter and enhancer annotations of K562 were created by ENCODE project<xref rid="bib55" ref-type="bibr"><sup>55</sup></xref> and are available at UCSCdata portal. See <xref rid="sec4.1" ref-type="sec">key resources table</xref> for the accession codes of these datasets.</p>
      </sec>
      <sec id="sec4.3.10">
        <title>Aggregate Peak Analysis</title>
        <p id="p0420">We followed the method introduced by Rao et al.<xref rid="bib3" ref-type="bibr"><sup>3</sup></xref> to perform the Aggregate Peak Analysis (APA). We selected the 210 kb <inline-formula><mml:math id="M88" altimg="si69.gif"><mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo></mml:mrow></mml:math></inline-formula> 210 kb submatrices centered at each putative loop and aggregated them to generate the APA plots. All submatrices were derived from the 10 kb-resolution O/E matrix of the KR-normalized 520 million-read dataset (20% downsampling of GM12878). The resulting aggregate matrix for each model is a 21 <inline-formula><mml:math id="M89" altimg="si69.gif"><mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo></mml:mrow></mml:math></inline-formula> 21 square matrix.</p>
        <p id="p0425">We used the default parameters of Chromosight<xref rid="bib21" ref-type="bibr"><sup>21</sup></xref> to create the loop set. When running SIP,<xref rid="bib20" ref-type="bibr"><sup>20</sup></xref> we found that the default parameters generated a very small set of loops on the 10 kb-resolution matrices. Thus, we decreased the Gaussian filter parameter to 0.5 so that SIP could yield more annotations. Despite this, SIP still generated the lowest number of loops among the four models. Therefore, for a fair comparison, we used the first <inline-formula><mml:math id="M90" altimg="si66.gif"><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> loops with the highest scores assigned by GILoop, Peakachu, and Chromosight (<inline-formula><mml:math id="M91" altimg="si66.gif"><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> denotes the total number of SIP loops).</p>
        <p id="p0430">The <italic>z</italic>-scores of each loop set were calculated with the formula below:<disp-formula id="fd9"><label>(Equation 9)</label><mml:math id="M92" altimg="si70.gif"><mml:mrow><mml:mi>z</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mfrac><mml:mrow><mml:mi>x</mml:mi><mml:mo linebreak="badbreak">−</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mi>σ</mml:mi></mml:mfrac></mml:mrow></mml:math></disp-formula>where the standard deviation <inline-formula><mml:math id="M93" altimg="si25.gif"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow></mml:math></inline-formula> and the mean <inline-formula><mml:math id="M94" altimg="si71.gif"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula> were estimated on the 6 <inline-formula><mml:math id="M95" altimg="si69.gif"><mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo></mml:mrow></mml:math></inline-formula> 6 window on the lower left corner the APA matrix, and <inline-formula><mml:math id="M96" altimg="si72.gif"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula> in the formula denotes the value at the center of the APA matrix. A <italic>z</italic>-score higher than 1.64 indicates a <italic>p</italic>-value lower than 0.05, which signifies the enrichment.</p>
      </sec>
      <sec id="sec4.3.11">
        <title>Recovery plot for well-supported loops</title>
        <p id="p0435">We employed recovery plots similar to the ones shown in<xref rid="bib57" ref-type="bibr"><sup>57</sup></xref> to evaluate GILoop’s ability in recovering the well-supported chromatin loops. The ground truths in this analysis were the overlap between the loops annotated by HICCUPS<xref rid="bib3" ref-type="bibr"><sup>3</sup></xref> and FitHiC<xref rid="bib36" ref-type="bibr"><sup>36</sup></xref><sup>,</sup><xref rid="bib37" ref-type="bibr"><sup>37</sup></xref> on the deeply sequenced GM12878 full contact matrix.</p>
        <p id="p0440">For each model, we sorted the putative loops in the descending order of score and gradually took one more loop for each iteration. At the <inline-formula><mml:math id="M97" altimg="si16.gif"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula>-th iteration, the first <inline-formula><mml:math id="M98" altimg="si16.gif"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula> loops were overlapped with the ground truths, and the ratio of the number of the loops in the intersection over the total number of the ground truths was recorded and finally plotted on the figure.</p>
      </sec>
      <sec id="sec4.3.12">
        <title>Implementation</title>
        <p id="p0445">The neural networks in this study were implemented with Keras 2.7.0<xref rid="bib58" ref-type="bibr"><sup>58</sup></xref> and TensorFlow 2.7.0.<xref rid="bib59" ref-type="bibr"><sup>59</sup></xref> Multiple Python libraries were imported for mathematical calculations and linear algebra operations, including NumPy 1.19.2<xref rid="bib60" ref-type="bibr"><sup>60</sup></xref> and SciPy 1.6.2.<xref rid="bib61" ref-type="bibr"><sup>61</sup></xref> Figures were plotted with Matplotlib 3.3.4.<xref rid="bib62" ref-type="bibr"><sup>62</sup></xref> Scikit-learn 0.24.1<xref rid="bib63" ref-type="bibr"><sup>63</sup></xref> was adopted for building the data pre-processing pipeline and calculating evaluation metrics. FAN-C 0.9.21<xref rid="bib48" ref-type="bibr"><sup>48</sup></xref> was adopted to obtain the statistics of Hi-C datasets, downsample the Hi-C data, and apply Knight-Ruiz (KR) normalization on the downsampled matrices. We employed FIMO 5.4.1<xref rid="bib64" ref-type="bibr"><sup>64</sup></xref> to scan the whole genome to estimate the occurrences of the architectural motifs of each locus. FIMO parameter <italic>p</italic>-value threshold was set to <inline-formula><mml:math id="M99" altimg="si65.gif"><mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>.</p>
      </sec>
    </sec>
    <sec id="sec4.4">
      <title>Quantification and statistical analysis</title>
      <sec id="sec4.4.1">
        <title>Statistical analysis</title>
        <p id="p0450">We performed statistical analyses with SciPy<xref rid="bib61" ref-type="bibr"><sup>61</sup></xref> throughout the study. Wilcoxon signed-rank test was used to compare the paired experimental results (i.e., the stream fusion experiments). A <italic>p</italic>-value smaller than 0.05 would signify the difference between groups.</p>
      </sec>
      <sec id="sec4.4.2">
        <title>Metrics for performance evaluation</title>
        <p id="p0455">We used PR-AUC and F1 score as evaluation metrics, which are both criteria that evaluate the performance of a classifier under the dataset configuration where the classes are imbalanced.</p>
        <p id="p0460">The concept of PR-AUC derives from the Precision-Recall curve. Precision is calculated by dividing the number of true positives <inline-formula><mml:math id="M100" altimg="si73.gif"><mml:mrow><mml:mo>(</mml:mo><mml:mtext>TP</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> by the sum of false positives <inline-formula><mml:math id="M101" altimg="si74.gif"><mml:mrow><mml:mo>(</mml:mo><mml:mtext>FP</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> and true positives, which is formulated as:<disp-formula id="fd10"><label>(Equation 10)</label><mml:math id="M102" altimg="si75.gif"><mml:mrow><mml:mtext>Precision</mml:mtext><mml:mo linebreak="badbreak">=</mml:mo><mml:mfrac><mml:mtext>TP</mml:mtext><mml:mrow><mml:mtext>TP</mml:mtext><mml:mo linebreak="badbreak">+</mml:mo><mml:mtext>FP</mml:mtext></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p>
        <p id="p0465">Recall, by contrast, is defined as the ratio between true positives and the sum of false negatives <inline-formula><mml:math id="M103" altimg="si76.gif"><mml:mrow><mml:mo>(</mml:mo><mml:mtext>FN</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> and true positives:<disp-formula id="fd11"><label>(Equation 11)</label><mml:math id="M104" altimg="si77.gif"><mml:mrow><mml:mtext>Recall</mml:mtext><mml:mo linebreak="badbreak">=</mml:mo><mml:mfrac><mml:mtext>TP</mml:mtext><mml:mrow><mml:mtext>TP</mml:mtext><mml:mo linebreak="badbreak">+</mml:mo><mml:mtext>FN</mml:mtext></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p>
        <p id="p0470">The PR curve is the curve of a model’s precision versus recall at all thresholds, which can reflect the trade-off between the two measurements. The main metric we employed in this study is PR-AUC, which summarizes the predictive ability of the model by integrating the area under the precision-recall curve. The mathematical formula of PR-AUC is as follows:<disp-formula id="fd12"><label>(Equation 12)</label><mml:math id="M105" altimg="si78.gif"><mml:mrow><mml:mtext>PR</mml:mtext><mml:mo linebreak="badbreak">−</mml:mo><mml:mtext>AUC</mml:mtext><mml:mo linebreak="badbreak">=</mml:mo><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mtext>Recall</mml:mtext><mml:mi>k</mml:mi></mml:msub><mml:mo linebreak="badbreak">−</mml:mo><mml:msub><mml:mtext>Recall</mml:mtext><mml:mrow><mml:mi>k</mml:mi><mml:mo linebreak="badbreak">−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:msub><mml:mtext>Precision</mml:mtext><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="M106" altimg="si66.gif"><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> represents the total number of possible thresholds generated by the model; <inline-formula><mml:math id="M107" altimg="si6.gif"><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula> denotes the index in the descending order of the thresholds.</p>
        <p id="p0475">A dummy classifier (i.e., a classifier that predicts randomly) would have a PR-AUC numerically equal to the positive ratio (i.e., the number of positives divided by the total number of samples) of the dataset. For example, if the CTCF ChIA-PET within 2 Mb of the genomic distance has a positive ratio of 0.0012, the dummy classifier will have the same PR-AUC of 0.0012.</p>
        <p id="p0480">F1-score is the harmonic mean of the two metrics (i.e., Precision and Recall) at a certain threshold, which is defined below:<disp-formula id="fd13"><label>(Equation 13)</label><mml:math id="M108" altimg="si79.gif"><mml:mrow><mml:mi mathvariant="normal">F</mml:mi><mml:mn>1</mml:mn><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>2</mml:mn><mml:mo linebreak="goodbreak">×</mml:mo><mml:mfrac><mml:mrow><mml:mtext>Precision</mml:mtext><mml:mo linebreak="badbreak">×</mml:mo><mml:mtext>Recall</mml:mtext></mml:mrow><mml:mrow><mml:mtext>Precision</mml:mtext><mml:mo linebreak="badbreak">+</mml:mo><mml:mtext>Recall</mml:mtext></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p>
        <p id="p0485">In particular, the calculation of F1-score requires a threshold as the cutoff to convert the probabilities to binary annotations. For each trained model, the best F1-score was obtained by calculating F1-scores over 100 thresholds evenly taken from the interval <inline-formula><mml:math id="M109" altimg="si80.gif"><mml:mrow><mml:mo>(</mml:mo><mml:mn>0,1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
      </sec>
      <sec id="sec4.4.3">
        <title>Metric of GNN smoothness</title>
        <p id="p0490">We evaluated the extent of the smoothness by calculating the MAD<xref rid="bib43" ref-type="bibr"><sup>43</sup></xref> of the node embeddings generated by the last GCN layer. The value of MAD reflects the extent to which the node embeddings are similar to each other in the latent space. Smaller value of MAD indicates more severe smoothness.</p>
        <p id="p0495">The calculation of MAD is shown as follows. Given a graph<inline-formula><mml:math id="M110" altimg="si3.gif"><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow></mml:math></inline-formula> with <inline-formula><mml:math id="M111" altimg="si28.gif"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> nodes, firstly the matrix of cosine distance is computed by:<disp-formula id="fd14"><label>(Equation 14)</label><mml:math id="M112" altimg="si81.gif"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn><mml:mo linebreak="badbreak">−</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true">|</mml:mo></mml:mrow><mml:mo linebreak="badbreak">·</mml:mo><mml:mrow><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="true">|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mspace width="1em"/><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo linebreak="goodbreak">∈</mml:mo><mml:mi mathvariant="script">N</mml:mi></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="M113" altimg="si82.gif"><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:math></inline-formula> is the cosine distance matrix of size <inline-formula><mml:math id="M114" altimg="si83.gif"><mml:mrow><mml:mi>N</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="M115" altimg="si84.gif"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> denotes the pair-wise cosine distance between node <inline-formula><mml:math id="M116" altimg="si16.gif"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M117" altimg="si40.gif"><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula>. <inline-formula><mml:math id="M118" altimg="si85.gif"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M119" altimg="si86.gif"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> are the node embeddings of node <inline-formula><mml:math id="M120" altimg="si16.gif"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M121" altimg="si40.gif"><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula>, respectively. <inline-formula><mml:math id="M122" altimg="si27.gif"><mml:mrow><mml:mi mathvariant="script">N</mml:mi></mml:mrow></mml:math></inline-formula> is the node set of graph<inline-formula><mml:math id="M123" altimg="si3.gif"><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow></mml:math></inline-formula>.</p>
        <p id="p0500">Then, MAD is computed with <xref rid="fd15" ref-type="disp-formula">Equations 15</xref> and <xref rid="fd16" ref-type="disp-formula">16</xref> based on the definition of <inline-formula><mml:math id="M124" altimg="si82.gif"><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:math></inline-formula>:<disp-formula id="fd15"><label>(Equation 15)</label><mml:math id="M125" altimg="si87.gif"><mml:msub><mml:mover><mml:mi>D</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">N</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">N</mml:mi></mml:mrow></mml:msub><mml:mn mathvariant="double-struck">1</mml:mn><mml:mfenced><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mfrac></mml:math></disp-formula>where <inline-formula><mml:math id="M126" altimg="si88.gif"><mml:mn mathvariant="double-struck">1</mml:mn></mml:math></inline-formula> defines a function that <inline-formula><mml:math id="M127" altimg="si89.gif"><mml:mn mathvariant="double-struck">1</mml:mn><mml:mfenced><mml:mi>d</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> when <inline-formula><mml:math id="M128" altimg="si90.gif"><mml:mrow><mml:mi>d</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. Else, <inline-formula><mml:math id="M129" altimg="si88.gif"><mml:mn mathvariant="double-struck">1</mml:mn></mml:math></inline-formula> outputs 0. The formula above takes the summation along the column and divides it with the count of non-zero distance on each row.<disp-formula id="fd16"><label>(Equation 16)</label><mml:math id="M130" altimg="si91.gif"><mml:mtext>MAD</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">N</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mover><mml:mi>D</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">N</mml:mi></mml:mrow></mml:msub><mml:mn mathvariant="double-struck">1</mml:mn><mml:mfenced><mml:msub><mml:mover><mml:mi>D</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mfrac></mml:math></disp-formula></p>
        <p id="p0505">The equation above gives the desired MAD value.</p>
      </sec>
    </sec>
  </sec>
</body>
<back>
  <ref-list id="cebib0010">
    <title>References</title>
    <ref id="bib1">
      <label>1</label>
      <element-citation publication-type="journal" id="sref1">
        <person-group person-group-type="author">
          <name>
            <surname>Lieberman-Aiden</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>van Berkum</surname>
            <given-names>N.L.</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Imakaev</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Ragoczy</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Telling</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Amit</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Lajoie</surname>
            <given-names>B.R.</given-names>
          </name>
          <name>
            <surname>Sabo</surname>
            <given-names>P.J.</given-names>
          </name>
          <name>
            <surname>Dorschner</surname>
            <given-names>M.O.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive mapping of long-range interactions reveals folding principles of the human genome</article-title>
        <source>Science</source>
        <volume>326</volume>
        <year>2009</year>
        <fpage>289</fpage>
        <lpage>293</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1181369</pub-id>
        <pub-id pub-id-type="pmid">19815776</pub-id>
      </element-citation>
    </ref>
    <ref id="bib2">
      <label>2</label>
      <element-citation publication-type="journal" id="sref2">
        <person-group person-group-type="author">
          <name>
            <surname>Sexton</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Yaffe</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Kenigsberg</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Bantignies</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Leblanc</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Hoichman</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Parrinello</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Tanay</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Cavalli</surname>
            <given-names>G.</given-names>
          </name>
        </person-group>
        <article-title>Three-dimensional folding and functional organization principles of the Drosophila genome</article-title>
        <source>Cell</source>
        <volume>148</volume>
        <year>2012</year>
        <fpage>458</fpage>
        <lpage>472</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2012.01.010</pub-id>
        <pub-id pub-id-type="pmid">22265598</pub-id>
      </element-citation>
    </ref>
    <ref id="bib3">
      <label>3</label>
      <element-citation publication-type="journal" id="sref3">
        <person-group person-group-type="author">
          <name>
            <surname>Rao</surname>
            <given-names>S.S.P.</given-names>
          </name>
          <name>
            <surname>Huntley</surname>
            <given-names>M.H.</given-names>
          </name>
          <name>
            <surname>Durand</surname>
            <given-names>N.C.</given-names>
          </name>
          <name>
            <surname>Stamenova</surname>
            <given-names>E.K.</given-names>
          </name>
          <name>
            <surname>Bochkov</surname>
            <given-names>I.D.</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>J.T.</given-names>
          </name>
          <name>
            <surname>Sanborn</surname>
            <given-names>A.L.</given-names>
          </name>
          <name>
            <surname>Machol</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Omer</surname>
            <given-names>A.D.</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>E.S.</given-names>
          </name>
          <name>
            <surname>Aiden</surname>
            <given-names>E.L.</given-names>
          </name>
        </person-group>
        <article-title>A 3D map of the human genome at kilobase resolution reveals principles of chromatin looping</article-title>
        <source>Cell</source>
        <volume>159</volume>
        <year>2014</year>
        <fpage>1665</fpage>
        <lpage>1680</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2014.11.021</pub-id>
        <pub-id pub-id-type="pmid">25497547</pub-id>
      </element-citation>
    </ref>
    <ref id="bib4">
      <label>4</label>
      <element-citation publication-type="journal" id="sref4">
        <person-group person-group-type="author">
          <name>
            <surname>Nagano</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Lubling</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Stevens</surname>
            <given-names>T.J.</given-names>
          </name>
          <name>
            <surname>Schoenfelder</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Yaffe</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Dean</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Laue</surname>
            <given-names>E.D.</given-names>
          </name>
          <name>
            <surname>Tanay</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Fraser</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>Single-cell Hi-C reveals cell-to-cell variability in chromosome structure</article-title>
        <source>Nature</source>
        <volume>502</volume>
        <year>2013</year>
        <fpage>59</fpage>
        <lpage>64</lpage>
        <pub-id pub-id-type="doi">10.1038/nature12593</pub-id>
        <pub-id pub-id-type="pmid">24067610</pub-id>
      </element-citation>
    </ref>
    <ref id="bib5">
      <label>5</label>
      <element-citation publication-type="journal" id="sref5">
        <person-group person-group-type="author">
          <name>
            <surname>Eagen</surname>
            <given-names>K.P.</given-names>
          </name>
        </person-group>
        <article-title>Principles of chromosome architecture revealed by Hi-C</article-title>
        <source>Trends Biochem. Sci.</source>
        <volume>43</volume>
        <year>2018</year>
        <fpage>469</fpage>
        <lpage>478</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tibs.2018.03.006</pub-id>
        <pub-id pub-id-type="pmid">29685368</pub-id>
      </element-citation>
    </ref>
    <ref id="bib6">
      <label>6</label>
      <element-citation publication-type="journal" id="sref6">
        <person-group person-group-type="author">
          <name>
            <surname>Misteli</surname>
            <given-names>T.</given-names>
          </name>
        </person-group>
        <article-title>The self-organizing genome: principles of genome architecture and function</article-title>
        <source>Cell</source>
        <volume>183</volume>
        <year>2020</year>
        <fpage>28</fpage>
        <lpage>45</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2020.09.014</pub-id>
        <pub-id pub-id-type="pmid">32976797</pub-id>
      </element-citation>
    </ref>
    <ref id="bib7">
      <label>7</label>
      <element-citation publication-type="journal" id="sref7">
        <person-group person-group-type="author">
          <name>
            <surname>Ashoor</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Rosikiewicz</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Graph embedding and unsupervised learning predict genomic sub-compartments from HiC chromatin interaction data</article-title>
        <source>Nat. Commun.</source>
        <volume>11</volume>
        <year>2020</year>
        <fpage>1173</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-14974-x</pub-id>
        <pub-id pub-id-type="pmid">32127534</pub-id>
      </element-citation>
    </ref>
    <ref id="bib8">
      <label>8</label>
      <element-citation publication-type="journal" id="sref8">
        <person-group person-group-type="author">
          <name>
            <surname>Nora</surname>
            <given-names>E.P.</given-names>
          </name>
          <name>
            <surname>Lajoie</surname>
            <given-names>B.R.</given-names>
          </name>
          <name>
            <surname>Schulz</surname>
            <given-names>E.G.</given-names>
          </name>
          <name>
            <surname>Giorgetti</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Okamoto</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Servant</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Piolot</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>van Berkum</surname>
            <given-names>N.L.</given-names>
          </name>
          <name>
            <surname>Meisig</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Sedat</surname>
            <given-names>J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Spatial partitioning of the regulatory landscape of the X-inactivation centre</article-title>
        <source>Nature</source>
        <volume>485</volume>
        <year>2012</year>
        <fpage>381</fpage>
        <lpage>385</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11049</pub-id>
        <pub-id pub-id-type="pmid">22495304</pub-id>
      </element-citation>
    </ref>
    <ref id="bib9">
      <label>9</label>
      <element-citation publication-type="journal" id="sref9">
        <person-group person-group-type="author">
          <name>
            <surname>Dixon</surname>
            <given-names>J.R.</given-names>
          </name>
          <name>
            <surname>Selvaraj</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Yue</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>J.S.</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>B.</given-names>
          </name>
        </person-group>
        <article-title>Topological domains in mammalian genomes identified by analysis of chromatin interactions</article-title>
        <source>Nature</source>
        <volume>485</volume>
        <year>2012</year>
        <fpage>376</fpage>
        <lpage>380</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11082</pub-id>
        <pub-id pub-id-type="pmid">22495300</pub-id>
      </element-citation>
    </ref>
    <ref id="bib10">
      <label>10</label>
      <element-citation publication-type="journal" id="sref10">
        <person-group person-group-type="author">
          <name>
            <surname>Dixon</surname>
            <given-names>J.R.</given-names>
          </name>
          <name>
            <surname>Jung</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Selvaraj</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Antosiewicz-Bourget</surname>
            <given-names>J.E.</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>A.Y.</given-names>
          </name>
          <name>
            <surname>Ye</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Rajagopal</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>W.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Chromatin architecture reorganization during stem cell differentiation</article-title>
        <source>Nature</source>
        <volume>518</volume>
        <year>2015</year>
        <fpage>331</fpage>
        <lpage>336</lpage>
        <pub-id pub-id-type="doi">10.1038/nature14222</pub-id>
        <pub-id pub-id-type="pmid">25693564</pub-id>
      </element-citation>
    </ref>
    <ref id="bib11">
      <label>11</label>
      <element-citation publication-type="journal" id="sref11">
        <person-group person-group-type="author">
          <name>
            <surname>Bansal</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Michelson</surname>
            <given-names>D.A.</given-names>
          </name>
          <name>
            <surname>Ramirez</surname>
            <given-names>R.N.</given-names>
          </name>
          <name>
            <surname>Viny</surname>
            <given-names>A.D.</given-names>
          </name>
          <name>
            <surname>Levine</surname>
            <given-names>R.L.</given-names>
          </name>
          <name>
            <surname>Benoist</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Mathis</surname>
            <given-names>D.</given-names>
          </name>
        </person-group>
        <article-title>Aire regulates chromatin looping by evicting CTCF from domain boundaries and favoring accumulation of cohesin on superenhancers</article-title>
        <source>Proc. Natl. Acad. Sci. USA</source>
        <volume>118</volume>
        <year>2021</year>
        <pub-id pub-id-type="doi">10.1073/pnas.2110991118</pub-id>
        <comment>e2110991118</comment>
      </element-citation>
    </ref>
    <ref id="bib12">
      <label>12</label>
      <element-citation publication-type="journal" id="sref12">
        <person-group person-group-type="author">
          <name>
            <surname>Rosencrance</surname>
            <given-names>C.D.</given-names>
          </name>
          <name>
            <surname>Ammouri</surname>
            <given-names>H.N.</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>Q.</given-names>
          </name>
          <name>
            <surname>Ge</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Rendleman</surname>
            <given-names>E.J.</given-names>
          </name>
          <name>
            <surname>Marshall</surname>
            <given-names>S.A.</given-names>
          </name>
          <name>
            <surname>Eagen</surname>
            <given-names>K.P.</given-names>
          </name>
        </person-group>
        <article-title>Chromatin hyperacetylation impacts chromosome folding by forming a nuclear subcompartment</article-title>
        <source>Mol. Cell</source>
        <volume>78</volume>
        <year>2020</year>
        <fpage>112</fpage>
        <lpage>126.e12</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2020.03.018</pub-id>
        <pub-id pub-id-type="pmid">32243828</pub-id>
      </element-citation>
    </ref>
    <ref id="bib13">
      <label>13</label>
      <element-citation publication-type="journal" id="sref13">
        <person-group person-group-type="author">
          <name>
            <surname>Johnstone</surname>
            <given-names>S.E.</given-names>
          </name>
          <name>
            <surname>Reyes</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Qi</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Adriaens</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Hegazi</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Pelka</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J.H.</given-names>
          </name>
          <name>
            <surname>Zou</surname>
            <given-names>L.S.</given-names>
          </name>
          <name>
            <surname>Drier</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Hecht</surname>
            <given-names>V.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Large-scale topological changes restrain malignant progression in colorectal cancer</article-title>
        <source>Cell</source>
        <volume>182</volume>
        <year>2020</year>
        <fpage>1474</fpage>
        <lpage>1489.e23</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2020.07.030</pub-id>
        <pub-id pub-id-type="pmid">32841603</pub-id>
      </element-citation>
    </ref>
    <ref id="bib14">
      <label>14</label>
      <element-citation publication-type="journal" id="sref14">
        <person-group person-group-type="author">
          <name>
            <surname>Doane</surname>
            <given-names>A.S.</given-names>
          </name>
          <name>
            <surname>Chu</surname>
            <given-names>C.S.</given-names>
          </name>
          <name>
            <surname>Di Giammartino</surname>
            <given-names>D.C.</given-names>
          </name>
          <name>
            <surname>Rivas</surname>
            <given-names>M.A.</given-names>
          </name>
          <name>
            <surname>Hellmuth</surname>
            <given-names>J.C.</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Yusufova</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Alonso</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Roeder</surname>
            <given-names>R.G.</given-names>
          </name>
          <name>
            <surname>Apostolou</surname>
            <given-names>E.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>OCT2 pre-positioning facilitates cell fate transition and chromatin architecture changes in humoral immunity</article-title>
        <source>Nat. Immunol.</source>
        <volume>22</volume>
        <year>2021</year>
        <fpage>1327</fpage>
        <lpage>1340</lpage>
        <pub-id pub-id-type="doi">10.1038/s41590-021-01025-w</pub-id>
        <pub-id pub-id-type="pmid">34556886</pub-id>
      </element-citation>
    </ref>
    <ref id="bib15">
      <label>15</label>
      <element-citation publication-type="journal" id="sref15">
        <person-group person-group-type="author">
          <name>
            <surname>Fotuhi Siahpirani</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Ay</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Roy</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>A multi-task graph-clustering approach for chromosome conformation capture data sets identifies conserved modules of chromosomal interactions</article-title>
        <source>Genome Biol.</source>
        <volume>17</volume>
        <year>2016</year>
        <fpage>114</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-0962-8</pub-id>
        <pub-id pub-id-type="pmid">27233632</pub-id>
      </element-citation>
    </ref>
    <ref id="bib16">
      <label>16</label>
      <element-citation publication-type="journal" id="sref16">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Yin</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Xiong</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Z.</given-names>
          </name>
        </person-group>
        <article-title>Decoding topologically associating domains with ultra-low resolution Hi-C data by graph structural entropy</article-title>
        <source>Nat. Commun.</source>
        <volume>9</volume>
        <year>2018</year>
        <fpage>3265</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-05691-7</pub-id>
        <pub-id pub-id-type="pmid">30111883</pub-id>
      </element-citation>
    </ref>
    <ref id="bib17">
      <label>17</label>
      <element-citation publication-type="journal" id="sref17">
        <person-group person-group-type="author">
          <name>
            <surname>Norton</surname>
            <given-names>H.K.</given-names>
          </name>
          <name>
            <surname>Emerson</surname>
            <given-names>D.J.</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Titus</surname>
            <given-names>K.R.</given-names>
          </name>
          <name>
            <surname>Gu</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Bassett</surname>
            <given-names>D.S.</given-names>
          </name>
          <name>
            <surname>Phillips-Cremins</surname>
            <given-names>J.E.</given-names>
          </name>
        </person-group>
        <article-title>Detecting hierarchical genome folding with network modularity</article-title>
        <source>Nat. Methods</source>
        <volume>15</volume>
        <year>2018</year>
        <fpage>119</fpage>
        <lpage>122</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4560</pub-id>
        <pub-id pub-id-type="pmid">29334377</pub-id>
      </element-citation>
    </ref>
    <ref id="bib18">
      <label>18</label>
      <element-citation publication-type="journal" id="sref18">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>D.I.</given-names>
          </name>
          <name>
            <surname>Roy</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>GRiNCH: simultaneous smoothing and detection of topological units of genome organization from sparse chromatin contact count matrices with matrix factorization</article-title>
        <source>Genome Biol.</source>
        <volume>22</volume>
        <year>2021</year>
        <fpage>164</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-021-02378-z</pub-id>
        <pub-id pub-id-type="pmid">34034791</pub-id>
      </element-citation>
    </ref>
    <ref id="bib19">
      <label>19</label>
      <element-citation publication-type="journal" id="sref19">
        <person-group person-group-type="author">
          <name>
            <surname>Karbalayghareh</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Sahin</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Leslie</surname>
            <given-names>C.S.</given-names>
          </name>
        </person-group>
        <article-title>Chromatin interaction-aware gene regulatory modeling with graph attention networks</article-title>
        <source>Genome Res.</source>
        <volume>32</volume>
        <year>2022</year>
        <fpage>930</fpage>
        <lpage>944</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.275870.121</pub-id>
        <pub-id pub-id-type="pmid">35396274</pub-id>
      </element-citation>
    </ref>
    <ref id="bib20">
      <label>20</label>
      <element-citation publication-type="journal" id="sref20">
        <person-group person-group-type="author">
          <name>
            <surname>Rowley</surname>
            <given-names>M.J.</given-names>
          </name>
          <name>
            <surname>Poulet</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Nichols</surname>
            <given-names>M.H.</given-names>
          </name>
          <name>
            <surname>Bixler</surname>
            <given-names>B.J.</given-names>
          </name>
          <name>
            <surname>Sanborn</surname>
            <given-names>A.L.</given-names>
          </name>
          <name>
            <surname>Brouhard</surname>
            <given-names>E.A.</given-names>
          </name>
          <name>
            <surname>Hermetz</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Linsenbaum</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Csankovszki</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Lieberman-Aiden</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Corces</surname>
            <given-names>V.G.</given-names>
          </name>
        </person-group>
        <article-title>Analysis of Hi-C data using SIP effectively identifies loops in organisms from C. elegans to mammals</article-title>
        <source>Genome Res.</source>
        <volume>30</volume>
        <year>2020</year>
        <fpage>447</fpage>
        <lpage>458</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.257832.119</pub-id>
        <pub-id pub-id-type="pmid">32127418</pub-id>
      </element-citation>
    </ref>
    <ref id="bib21">
      <label>21</label>
      <element-citation publication-type="journal" id="sref21">
        <person-group person-group-type="author">
          <name>
            <surname>Matthey-Doret</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Baudry</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Breuer</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Montagne</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Guiglielmoni</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Scolari</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Jean</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Campeas</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Chanut</surname>
            <given-names>P.H.</given-names>
          </name>
          <name>
            <surname>Oriol</surname>
            <given-names>E.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Computer vision for pattern detection in chromosome contact maps</article-title>
        <source>Nat. Commun.</source>
        <volume>11</volume>
        <year>2020</year>
        <fpage>5795</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-19562-7</pub-id>
        <pub-id pub-id-type="pmid">33199682</pub-id>
      </element-citation>
    </ref>
    <ref id="bib22">
      <label>22</label>
      <element-citation publication-type="journal" id="sref22">
        <person-group person-group-type="author">
          <name>
            <surname>Yoon</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Chandra</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Vahedi</surname>
            <given-names>G.</given-names>
          </name>
        </person-group>
        <article-title>Stripenn detects architectural stripes from chromatin conformation data using computer vision</article-title>
        <source>Nat. Commun.</source>
        <volume>13</volume>
        <year>2022</year>
        <fpage>1602</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-022-29258-9</pub-id>
        <pub-id pub-id-type="pmid">35332165</pub-id>
      </element-citation>
    </ref>
    <ref id="bib23">
      <label>23</label>
      <element-citation publication-type="journal" id="sref23">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>An</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>W.J.</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Yue</surname>
            <given-names>F.</given-names>
          </name>
        </person-group>
        <article-title>Enhancing Hi-C data resolution with deep convolutional neural network HiCPlus</article-title>
        <source>Nat. Commun.</source>
        <volume>9</volume>
        <year>2018</year>
        <fpage>750</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-03113-2</pub-id>
        <pub-id pub-id-type="pmid">29467363</pub-id>
      </element-citation>
    </ref>
    <ref id="bib24">
      <label>24</label>
      <element-citation publication-type="journal" id="sref24">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z.</given-names>
          </name>
        </person-group>
        <article-title>HiCNN: a very deep convolutional neural network to better enhance the resolution of Hi-C data</article-title>
        <source>Bioinformatics</source>
        <volume>35</volume>
        <year>2019</year>
        <fpage>4222</fpage>
        <lpage>4228</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btz251</pub-id>
        <pub-id pub-id-type="pmid">31056636</pub-id>
      </element-citation>
    </ref>
    <ref id="bib25">
      <label>25</label>
      <element-citation publication-type="journal" id="sref25">
        <person-group person-group-type="author">
          <name>
            <surname>Hu</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>W.</given-names>
          </name>
        </person-group>
        <article-title>EnHiC: learning fine-resolution Hi-C contact maps using a generative adversarial framework</article-title>
        <source>Bioinformatics</source>
        <volume>37</volume>
        <year>2021</year>
        <fpage>i272</fpage>
        <lpage>i279</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btab272</pub-id>
        <pub-id pub-id-type="pmid">34252966</pub-id>
      </element-citation>
    </ref>
    <ref id="bib26">
      <label>26</label>
      <element-citation publication-type="journal" id="sref26">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Plummer</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Cui</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Prabhakar</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Shrinet</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Srinivasan</surname>
            <given-names>D.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DeepLoop robustly maps chromatin interactions from sparse allele-resolved or single-cell Hi-C data at kilobase resolution</article-title>
        <source>Nat. Genet.</source>
        <volume>54</volume>
        <year>2022</year>
        <fpage>1013</fpage>
        <lpage>1025</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-022-01116-w</pub-id>
        <pub-id pub-id-type="pmid">35817982</pub-id>
      </element-citation>
    </ref>
    <ref id="bib27">
      <label>27</label>
      <element-citation publication-type="journal" id="sref27">
        <person-group person-group-type="author">
          <name>
            <surname>Salameh</surname>
            <given-names>T.J.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>S.M.</given-names>
          </name>
          <name>
            <surname>Khunsriraksakul</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Yue</surname>
            <given-names>F.</given-names>
          </name>
        </person-group>
        <article-title>A supervised learning framework for chromatin loop detection in genome-wide contact maps</article-title>
        <source>Nat. Commun.</source>
        <volume>11</volume>
        <year>2020</year>
        <fpage>3428</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-17239-9</pub-id>
        <pub-id pub-id-type="pmid">32647330</pub-id>
      </element-citation>
    </ref>
    <ref id="bib28">
      <label>28</label>
      <element-citation publication-type="book" id="sref28">
        <person-group person-group-type="author">
          <name>
            <surname>Ronneberger</surname>
            <given-names>O.</given-names>
          </name>
          <name>
            <surname>Fischer</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Brox</surname>
            <given-names>T.</given-names>
          </name>
        </person-group>
        <part-title>U-net: convolutional networks for biomedical image segmentation</part-title>
        <person-group person-group-type="editor">
          <name>
            <surname>Navab</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Hornegger</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Wells</surname>
            <given-names>W.M.</given-names>
          </name>
          <name>
            <surname>Frangi</surname>
            <given-names>A.F.</given-names>
          </name>
        </person-group>
        <source>Medical Image Computing and Computer-Assisted Intervention - MICCAI 2015</source>
        <year>2015</year>
        <publisher-name>Springer International Publishing</publisher-name>
        <fpage>234</fpage>
        <lpage>241</lpage>
        <pub-id pub-id-type="doi">10.1007/978-3-319-24574-4_28</pub-id>
      </element-citation>
    </ref>
    <ref id="bib29">
      <label>29</label>
      <element-citation publication-type="book" id="sref29">
        <person-group person-group-type="author">
          <name>
            <surname>Kipf</surname>
            <given-names>T.N.</given-names>
          </name>
          <name>
            <surname>Welling</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <part-title>Semi-supervised classification with graph convolutional networks</part-title>
        <source>Proceedings of the 5th International Conference on Learning Representations</source>
        <year>2017</year>
        <fpage>1</fpage>
        <lpage>14</lpage>
      </element-citation>
    </ref>
    <ref id="bib30">
      <label>30</label>
      <element-citation publication-type="journal" id="sref30">
        <person-group person-group-type="author">
          <name>
            <surname>Fullwood</surname>
            <given-names>M.J.</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>M.H.</given-names>
          </name>
          <name>
            <surname>Pan</surname>
            <given-names>Y.F.</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Mohamed</surname>
            <given-names>Y.B.</given-names>
          </name>
          <name>
            <surname>Orlov</surname>
            <given-names>Y.L.</given-names>
          </name>
          <name>
            <surname>Velkov</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Ho</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Mei</surname>
            <given-names>P.H.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An oestrogen-receptor-<italic>α</italic>-bound human chromatin interactome</article-title>
        <source>Nature</source>
        <volume>462</volume>
        <year>2009</year>
        <fpage>58</fpage>
        <lpage>64</lpage>
        <pub-id pub-id-type="doi">10.1038/nature08497</pub-id>
        <pub-id pub-id-type="pmid">19890323</pub-id>
      </element-citation>
    </ref>
    <ref id="bib31">
      <label>31</label>
      <element-citation publication-type="journal" id="sref31">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Auerbach</surname>
            <given-names>R.K.</given-names>
          </name>
          <name>
            <surname>Sandhu</surname>
            <given-names>K.S.</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Poh</surname>
            <given-names>H.M.</given-names>
          </name>
          <name>
            <surname>Goh</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Lim</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Extensive promoter-centered chromatin interactions provide a topological basis for transcription regulation</article-title>
        <source>Cell</source>
        <volume>148</volume>
        <year>2012</year>
        <fpage>84</fpage>
        <lpage>98</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2011.12.014</pub-id>
        <pub-id pub-id-type="pmid">22265404</pub-id>
      </element-citation>
    </ref>
    <ref id="bib32">
      <label>32</label>
      <element-citation publication-type="journal" id="sref32">
        <person-group person-group-type="author">
          <name>
            <surname>Tang</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>O.J.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>J.J.</given-names>
          </name>
          <name>
            <surname>Szalaj</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Trzaskoma</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Magalska</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Wlodarczyk</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Ruszczycki</surname>
            <given-names>B.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CTCF-mediated human 3D genome architecture reveals chromatin topology for transcription</article-title>
        <source>Cell</source>
        <volume>163</volume>
        <year>2015</year>
        <fpage>1611</fpage>
        <lpage>1627</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.11.024</pub-id>
        <pub-id pub-id-type="pmid">26686651</pub-id>
      </element-citation>
    </ref>
    <ref id="bib33">
      <label>33</label>
      <element-citation publication-type="journal" id="sref33">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>C.H.</given-names>
          </name>
          <name>
            <surname>Birnbaum</surname>
            <given-names>R.Y.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Favaro</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Ngan</surname>
            <given-names>C.Y.</given-names>
          </name>
          <name>
            <surname>Lim</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Tai</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Poh</surname>
            <given-names>H.M.</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>E.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Chromatin connectivity maps reveal dynamic promoter-enhancer long-range associations</article-title>
        <source>Nature</source>
        <volume>504</volume>
        <year>2013</year>
        <fpage>306</fpage>
        <lpage>310</lpage>
        <pub-id pub-id-type="doi">10.1038/nature12716</pub-id>
        <pub-id pub-id-type="pmid">24213634</pub-id>
      </element-citation>
    </ref>
    <ref id="bib34">
      <label>34</label>
      <element-citation publication-type="journal" id="sref34">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Gou</surname>
            <given-names>L.T.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Fu</surname>
            <given-names>X.D.</given-names>
          </name>
        </person-group>
        <article-title>GRID-seq reveals the global RNA-chromatin interactome</article-title>
        <source>Nat. Biotechnol.</source>
        <volume>35</volume>
        <year>2017</year>
        <fpage>940</fpage>
        <lpage>950</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3968</pub-id>
        <pub-id pub-id-type="pmid">28922346</pub-id>
      </element-citation>
    </ref>
    <ref id="bib35">
      <label>35</label>
      <element-citation publication-type="journal" id="sref35">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>O.J.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Piecuch</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>J.J.</given-names>
          </name>
          <name>
            <surname>Tian</surname>
            <given-names>S.Z.</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>Y.</given-names>
          </name>
        </person-group>
        <article-title>Long-read ChIA-PET for base-pair-resolution mapping of haplotype-specific chromatin interactions</article-title>
        <source>Nat. Protoc.</source>
        <volume>12</volume>
        <year>2017</year>
        <fpage>899</fpage>
        <lpage>915</lpage>
        <pub-id pub-id-type="doi">10.1038/nprot.2017.012</pub-id>
        <pub-id pub-id-type="pmid">28358394</pub-id>
      </element-citation>
    </ref>
    <ref id="bib36">
      <label>36</label>
      <element-citation publication-type="journal" id="sref36">
        <person-group person-group-type="author">
          <name>
            <surname>Ay</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Bailey</surname>
            <given-names>T.L.</given-names>
          </name>
          <name>
            <surname>Noble</surname>
            <given-names>W.S.</given-names>
          </name>
        </person-group>
        <article-title>Statistical confidence estimation for Hi-C data reveals regulatory chromatin contacts</article-title>
        <source>Genome Res.</source>
        <volume>24</volume>
        <year>2014</year>
        <fpage>999</fpage>
        <lpage>1011</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.160374.113</pub-id>
        <pub-id pub-id-type="pmid">24501021</pub-id>
      </element-citation>
    </ref>
    <ref id="bib37">
      <label>37</label>
      <element-citation publication-type="journal" id="sref37">
        <person-group person-group-type="author">
          <name>
            <surname>Kaul</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Bhattacharyya</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Ay</surname>
            <given-names>F.</given-names>
          </name>
        </person-group>
        <article-title>Identifying statistically significant chromatin contacts from Hi-C data with FitHiC2</article-title>
        <source>Nat. Protoc.</source>
        <volume>15</volume>
        <year>2020</year>
        <fpage>991</fpage>
        <lpage>1012</lpage>
        <pub-id pub-id-type="doi">10.1038/s41596-019-0273-0</pub-id>
        <pub-id pub-id-type="pmid">31980751</pub-id>
      </element-citation>
    </ref>
    <ref id="bib38">
      <label>38</label>
      <element-citation publication-type="book" id="sref38">
        <person-group person-group-type="author">
          <name>
            <surname>You</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Ying</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Leskovec</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <part-title>Design space for graph neural networks</part-title>
        <source>Proceedings of the 34th International Conference on Neural Information Processing Systems</source>
        <year>2020</year>
        <fpage>17009</fpage>
        <lpage>17021</lpage>
      </element-citation>
    </ref>
    <ref id="bib39">
      <label>39</label>
      <element-citation publication-type="book" id="sref39">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>Q.</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>X.M.</given-names>
          </name>
        </person-group>
        <part-title>Deeper insights into graph convolutional networks for semi-supervised learning</part-title>
        <source>Proceedings of the 32nd AAAI Conference on Artificial Intelligence</source>
        <year>2018</year>
        <fpage>3538</fpage>
        <lpage>3545</lpage>
      </element-citation>
    </ref>
    <ref id="bib40">
      <label>40</label>
      <element-citation publication-type="journal" id="sref40">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Pan</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Long</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>P.S.</given-names>
          </name>
        </person-group>
        <article-title>A comprehensive survey on graph neural networks</article-title>
        <source>IEEE Trans. Neural Netw. Learn. Syst.</source>
        <volume>32</volume>
        <year>2021</year>
        <fpage>4</fpage>
        <lpage>24</lpage>
        <pub-id pub-id-type="doi">10.1109/TNNLS.2020.2978386</pub-id>
        <pub-id pub-id-type="pmid">32217482</pub-id>
      </element-citation>
    </ref>
    <ref id="bib41">
      <label>41</label>
      <element-citation publication-type="book" id="sref41">
        <person-group person-group-type="author">
          <name>
            <surname>Klicpera</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Bojchevski</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Günnemann</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <part-title>Predict then propagate: graph neural networks meet personalized PageRank</part-title>
        <source>Proceedings of the 7th International Conference on Learning Representations</source>
        <year>2019</year>
        <fpage>1</fpage>
        <lpage>15</lpage>
      </element-citation>
    </ref>
    <ref id="bib42">
      <label>42</label>
      <element-citation publication-type="book" id="sref42">
        <person-group person-group-type="author">
          <name>
            <surname>Rong</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <part-title>DropEdge: towards deep graph convolutional networks on node classification</part-title>
        <source>Proceedings of the 8th International Conference on Learning Representations</source>
        <year>2020</year>
        <fpage>1</fpage>
        <lpage>17</lpage>
      </element-citation>
    </ref>
    <ref id="bib43">
      <label>43</label>
      <element-citation publication-type="book" id="sref43">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>X.</given-names>
          </name>
        </person-group>
        <part-title>Measuring and relieving the over-smoothing problem for graph neural networks from the topological view</part-title>
        <source>Proceedings of the 34th AAAI Conference on Artificial Intelligence</source>
        <year>2020</year>
        <fpage>3438</fpage>
        <lpage>3445</lpage>
        <pub-id pub-id-type="doi">10.1609/aaai.v34i04.5747</pub-id>
      </element-citation>
    </ref>
    <ref id="bib44">
      <label>44</label>
      <element-citation publication-type="journal" id="sref44">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Kuang</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Choudhary</surname>
            <given-names>M.N.K.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The 3D Genome Browser: a web-based browser for visualizing 3D genome organization and long-range chromatin interactions</article-title>
        <source>Genome Biol.</source>
        <volume>19</volume>
        <year>2018</year>
        <fpage>151</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-018-1519-9</pub-id>
        <pub-id pub-id-type="pmid">30286773</pub-id>
      </element-citation>
    </ref>
    <ref id="bib45">
      <label>45</label>
      <element-citation publication-type="journal" id="sref45">
        <person-group person-group-type="author">
          <name>
            <surname>de Wit</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Vos</surname>
            <given-names>E.S.M.</given-names>
          </name>
          <name>
            <surname>Holwerda</surname>
            <given-names>S.J.B.</given-names>
          </name>
          <name>
            <surname>Valdes-Quezada</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Verstegen</surname>
            <given-names>M.J.A.M.</given-names>
          </name>
          <name>
            <surname>Teunissen</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Splinter</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Wijchers</surname>
            <given-names>P.J.</given-names>
          </name>
          <name>
            <surname>Krijger</surname>
            <given-names>P.H.L.</given-names>
          </name>
          <name>
            <surname>de Laat</surname>
            <given-names>W.</given-names>
          </name>
        </person-group>
        <article-title>CTCF binding polarity determines chromatin looping</article-title>
        <source>Mol. Cell</source>
        <volume>60</volume>
        <year>2015</year>
        <fpage>676</fpage>
        <lpage>684</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2015.09.023</pub-id>
        <pub-id pub-id-type="pmid">26527277</pub-id>
      </element-citation>
    </ref>
    <ref id="bib46">
      <label>46</label>
      <element-citation publication-type="journal" id="sref46">
        <person-group person-group-type="author">
          <name>
            <surname>Gómez-Marín</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Tena</surname>
            <given-names>J.J.</given-names>
          </name>
          <name>
            <surname>Acemel</surname>
            <given-names>R.D.</given-names>
          </name>
          <name>
            <surname>López-Mayorga</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Naranjo</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>de la Calle-Mustienes</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Maeso</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Beccari</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Aneas</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Vielmas</surname>
            <given-names>E.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evolutionary comparison reveals that diverging CTCF sites are signatures of ancestral topological associating domains borders</article-title>
        <source>Proc. Natl. Acad. Sci. USA</source>
        <volume>112</volume>
        <year>2015</year>
        <fpage>7542</fpage>
        <lpage>7547</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1505463112</pub-id>
        <pub-id pub-id-type="pmid">26034287</pub-id>
      </element-citation>
    </ref>
    <ref id="bib47">
      <label>47</label>
      <element-citation publication-type="journal" id="sref47">
        <person-group person-group-type="author">
          <name>
            <surname>Heidari</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Phanstiel</surname>
            <given-names>D.H.</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Grubert</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Jahanbani</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Kasowski</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>M.Q.</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>M.P.</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide map of regulatory interactions in the human genome</article-title>
        <source>Genome Res.</source>
        <volume>24</volume>
        <year>2014</year>
        <fpage>1905</fpage>
        <lpage>1917</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.176586.114</pub-id>
        <pub-id pub-id-type="pmid">25228660</pub-id>
      </element-citation>
    </ref>
    <ref id="bib48">
      <label>48</label>
      <element-citation publication-type="journal" id="sref48">
        <person-group person-group-type="author">
          <name>
            <surname>Kruse</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Hug</surname>
            <given-names>C.B.</given-names>
          </name>
          <name>
            <surname>Vaquerizas</surname>
            <given-names>J.M.</given-names>
          </name>
        </person-group>
        <article-title>FAN-C: a feature-rich framework for the analysis and visualisation of chromosome conformation capture data</article-title>
        <source>Genome Biol.</source>
        <volume>21</volume>
        <year>2020</year>
        <fpage>303</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-020-02215-9</pub-id>
        <pub-id pub-id-type="pmid">33334380</pub-id>
      </element-citation>
    </ref>
    <ref id="bib49">
      <label>49</label>
      <element-citation publication-type="journal" id="sref49">
        <person-group person-group-type="author">
          <name>
            <surname>Hammond</surname>
            <given-names>D.K.</given-names>
          </name>
          <name>
            <surname>Vandergheynst</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Gribonval</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>Wavelets on graphs via spectral graph theory</article-title>
        <source>Appl. Comput. Harmon. Anal.</source>
        <volume>30</volume>
        <year>2011</year>
        <fpage>129</fpage>
        <lpage>150</lpage>
        <pub-id pub-id-type="doi">10.1016/j.acha.2010.04.005</pub-id>
      </element-citation>
    </ref>
    <ref id="bib50">
      <label>50</label>
      <element-citation publication-type="book" id="sref50">
        <person-group person-group-type="author">
          <name>
            <surname>Defferrard</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Bresson</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Vandergheynst</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <part-title>Convolutional neural networks on graphs with fast localized spectral filtering</part-title>
        <source>Proceedings of the 30th International Conference on Neural Information Processing Systems</source>
        <year>2016</year>
        <fpage>3844</fpage>
        <lpage>3852</lpage>
      </element-citation>
    </ref>
    <ref id="bib51">
      <label>51</label>
      <element-citation publication-type="book" id="sref51">
        <person-group person-group-type="author">
          <name>
            <surname>Kipf</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Fetaya</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>K.C.</given-names>
          </name>
          <name>
            <surname>Welling</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Zemel</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <part-title>Neural relational inference for interacting systems</part-title>
        <source>Proceedings of the 35th International Conference on Machine Learning</source>
        <year>2018</year>
        <fpage>2688</fpage>
        <lpage>2697</lpage>
      </element-citation>
    </ref>
    <ref id="bib52">
      <label>52</label>
      <element-citation publication-type="book" id="sref52">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>T.Y.</given-names>
          </name>
          <name>
            <surname>Goyal</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Girshick</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Dollar</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <part-title>Focal loss for dense object detection</part-title>
        <source>Proceedings of the IEEE International Conference on Computer Vision</source>
        <year>2017</year>
        <fpage>2980</fpage>
        <lpage>2988</lpage>
      </element-citation>
    </ref>
    <ref id="bib53">
      <label>53</label>
      <element-citation publication-type="journal" id="sref53">
        <person-group person-group-type="author">
          <name>
            <surname>Castro-Mondragon</surname>
            <given-names>J.A.</given-names>
          </name>
          <name>
            <surname>Riudavets-Puig</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Rauluseviciute</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Lemma</surname>
            <given-names>R.B.</given-names>
          </name>
          <name>
            <surname>Turchi</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Blanc-Mathieu</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Lucas</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Boddie</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Khan</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Manosalva Pérez</surname>
            <given-names>N.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Jaspar 2022: the 9th release of the open-access database of transcription factor binding profiles</article-title>
        <source>Nucleic Acids Res.</source>
        <volume>50</volume>
        <year>2022</year>
        <fpage>D165</fpage>
        <lpage>D173</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkab1113</pub-id>
        <pub-id pub-id-type="pmid">34850907</pub-id>
      </element-citation>
    </ref>
    <ref id="bib54">
      <label>54</label>
      <element-citation publication-type="journal" id="sref54">
        <person-group person-group-type="author">
          <name>
            <surname>Dekker</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Belmont</surname>
            <given-names>A.S.</given-names>
          </name>
          <name>
            <surname>Guttman</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Leshyk</surname>
            <given-names>V.O.</given-names>
          </name>
          <name>
            <surname>Lis</surname>
            <given-names>J.T.</given-names>
          </name>
          <name>
            <surname>Lomvardas</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Mirny</surname>
            <given-names>L.A.</given-names>
          </name>
          <name>
            <surname>O’Shea</surname>
            <given-names>C.C.</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>P.J.</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>B.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The 4D nucleome project</article-title>
        <source>Nature</source>
        <volume>549</volume>
        <year>2017</year>
        <fpage>219</fpage>
        <lpage>226</lpage>
        <pub-id pub-id-type="doi">10.1038/nature23884</pub-id>
        <pub-id pub-id-type="pmid">28905911</pub-id>
      </element-citation>
    </ref>
    <ref id="bib55">
      <label>55</label>
      <element-citation publication-type="journal" id="sref55">
        <person-group person-group-type="author">
          <name>
            <surname>Luo</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Hitz</surname>
            <given-names>B.C.</given-names>
          </name>
          <name>
            <surname>Gabdank</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Hilton</surname>
            <given-names>J.A.</given-names>
          </name>
          <name>
            <surname>Kagda</surname>
            <given-names>M.S.</given-names>
          </name>
          <name>
            <surname>Lam</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Sud</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Jou</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>K.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>New developments on the Encyclopedia of DNA Elements (ENCODE) data portal</article-title>
        <source>Nucleic Acids Res.</source>
        <volume>48</volume>
        <year>2020</year>
        <fpage>D882</fpage>
        <lpage>D889</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkz1062</pub-id>
        <pub-id pub-id-type="pmid">31713622</pub-id>
      </element-citation>
    </ref>
    <ref id="bib56">
      <label>56</label>
      <element-citation publication-type="journal" id="sref56">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>W.J.</given-names>
          </name>
          <name>
            <surname>Sugnet</surname>
            <given-names>C.W.</given-names>
          </name>
          <name>
            <surname>Furey</surname>
            <given-names>T.S.</given-names>
          </name>
          <name>
            <surname>Roskin</surname>
            <given-names>K.M.</given-names>
          </name>
          <name>
            <surname>Pringle</surname>
            <given-names>T.H.</given-names>
          </name>
          <name>
            <surname>Zahler</surname>
            <given-names>A.M.</given-names>
          </name>
          <name>
            <surname>Haussler</surname>
            <given-names>D.</given-names>
          </name>
        </person-group>
        <article-title>The human genome browser at UCSC</article-title>
        <source>Genome Res.</source>
        <volume>12</volume>
        <year>2002</year>
        <fpage>996</fpage>
        <lpage>1006</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.229102</pub-id>
        <pub-id pub-id-type="pmid">12045153</pub-id>
      </element-citation>
    </ref>
    <ref id="bib57">
      <label>57</label>
      <element-citation publication-type="journal" id="sref57">
        <person-group person-group-type="author">
          <name>
            <surname>Bhattacharyya</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Chandra</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Vijayanand</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Ay</surname>
            <given-names>F.</given-names>
          </name>
        </person-group>
        <article-title>Identification of significant chromatin contacts from HiChIP data by FitHiChIP</article-title>
        <source>Nat. Commun.</source>
        <volume>10</volume>
        <year>2019</year>
        <fpage>4221</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-11950-y</pub-id>
        <pub-id pub-id-type="pmid">31530818</pub-id>
      </element-citation>
    </ref>
    <ref id="bib58">
      <label>58</label>
      <element-citation publication-type="other" id="sref58">
        <person-group person-group-type="author">
          <name>
            <surname>Chollet</surname>
            <given-names>F.</given-names>
          </name>
          <collab>Keras Contributors</collab>
        </person-group>
        <article-title>Keras</article-title>
        <ext-link ext-link-type="uri" xlink:href="https://keras.io" id="intref0110">https://keras.io</ext-link>
        <year>2015</year>
      </element-citation>
    </ref>
    <ref id="bib59">
      <label>59</label>
      <element-citation publication-type="other" id="sref59">
        <person-group person-group-type="author">
          <name>
            <surname>Abadi</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Agarwal</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Barham</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Brevdo</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Citro</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Corrado</surname>
            <given-names>G.S.</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Dean</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Devin</surname>
            <given-names>M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>TensorFlow: Large-Scale Machine Learning on Heterogeneous Systems</article-title>
        <ext-link ext-link-type="uri" xlink:href="https://www.tensorflow.org/" id="intref0115">https://www.tensorflow.org/</ext-link>
        <year>2015</year>
      </element-citation>
    </ref>
    <ref id="bib60">
      <label>60</label>
      <element-citation publication-type="journal" id="sref60">
        <person-group person-group-type="author">
          <name>
            <surname>Harris</surname>
            <given-names>C.R.</given-names>
          </name>
          <name>
            <surname>Millman</surname>
            <given-names>K.J.</given-names>
          </name>
          <name>
            <surname>van der Walt</surname>
            <given-names>S.J.</given-names>
          </name>
          <name>
            <surname>Gommers</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Virtanen</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Cournapeau</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Wieser</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Berg</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>N.J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Array programming with NumPy</article-title>
        <source>Nature</source>
        <volume>585</volume>
        <year>2020</year>
        <fpage>357</fpage>
        <lpage>362</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-020-2649-2</pub-id>
        <pub-id pub-id-type="pmid">32939066</pub-id>
      </element-citation>
    </ref>
    <ref id="bib61">
      <label>61</label>
      <element-citation publication-type="journal" id="sref61">
        <person-group person-group-type="author">
          <name>
            <surname>Virtanen</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Gommers</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Oliphant</surname>
            <given-names>T.E.</given-names>
          </name>
          <name>
            <surname>Haberland</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Reddy</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Cournapeau</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Burovski</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Peterson</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Weckesser</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Bright</surname>
            <given-names>J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SciPy 1.0: fundamental algorithms for scientific computing in Python</article-title>
        <source>Nat. Methods</source>
        <volume>17</volume>
        <year>2020</year>
        <fpage>261</fpage>
        <lpage>272</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0686-2</pub-id>
        <pub-id pub-id-type="pmid">32015543</pub-id>
      </element-citation>
    </ref>
    <ref id="bib62">
      <label>62</label>
      <element-citation publication-type="journal" id="sref62">
        <person-group person-group-type="author">
          <name>
            <surname>Hunter</surname>
            <given-names>J.D.</given-names>
          </name>
        </person-group>
        <article-title>Matplotlib: a 2D graphics environment</article-title>
        <source>Comput. Sci. Eng.</source>
        <volume>9</volume>
        <year>2007</year>
        <fpage>90</fpage>
        <lpage>95</lpage>
        <pub-id pub-id-type="doi">10.1109/MCSE.2007.55</pub-id>
      </element-citation>
    </ref>
    <ref id="bib63">
      <label>63</label>
      <element-citation publication-type="journal" id="sref63">
        <person-group person-group-type="author">
          <name>
            <surname>Pedregosa</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Varoquaux</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Gramfort</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Michel</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Thirion</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Grisel</surname>
            <given-names>O.</given-names>
          </name>
          <name>
            <surname>Blondel</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Prettenhofer</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Weiss</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Dubourg</surname>
            <given-names>V.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Scikit-learn: machine learning in Python</article-title>
        <source>J. Mach. Learn. Res.</source>
        <volume>12</volume>
        <year>2011</year>
        <fpage>2825</fpage>
        <lpage>2830</lpage>
      </element-citation>
    </ref>
    <ref id="bib64">
      <label>64</label>
      <element-citation publication-type="journal" id="sref64">
        <person-group person-group-type="author">
          <name>
            <surname>Grant</surname>
            <given-names>C.E.</given-names>
          </name>
          <name>
            <surname>Bailey</surname>
            <given-names>T.L.</given-names>
          </name>
          <name>
            <surname>Noble</surname>
            <given-names>W.S.</given-names>
          </name>
        </person-group>
        <article-title>FIMO: scanning for occurrences of a given motif</article-title>
        <source>Bioinformatics</source>
        <volume>27</volume>
        <year>2011</year>
        <fpage>1017</fpage>
        <lpage>1018</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr064</pub-id>
        <pub-id pub-id-type="pmid">21330290</pub-id>
      </element-citation>
    </ref>
  </ref-list>
  <sec id="appsec2" sec-type="supplementary-material">
    <title>Supplemental information</title>
    <p id="p0535">
      <supplementary-material content-type="local-data" id="mmc1">
        <caption>
          <title>Document S1. Figures S1–S7 and Tables S1−S11</title>
        </caption>
        <media xlink:href="mmc1.pdf"/>
      </supplementary-material>
    </p>
  </sec>
  <sec sec-type="data-availability" id="da0010">
    <title>Data and code availability</title>
    <p id="p0030">
      <list list-type="simple" id="ulist0015">
        <list-item id="u0030">
          <label>•</label>
          <p id="p0035">The authors analyze existing and publicly available data. These accession numbers for the datasets are listed in the <xref rid="sec4.1" ref-type="sec">key resources table</xref>.</p>
        </list-item>
        <list-item id="u0035">
          <label>•</label>
          <p id="p0040">All original code has been deposited at GitHub and is publicly available as of the date of publication. DOIs are listed in the <xref rid="sec4.1" ref-type="sec">key resources table</xref>.</p>
        </list-item>
        <list-item id="u0040">
          <label>•</label>
          <p id="p0045">Any additional information required to reanalyze the data reported in this paper is available from the <xref rid="sec4.2.1" ref-type="sec">lead contact</xref> upon request.</p>
        </list-item>
      </list>
    </p>
  </sec>
  <ack id="ack0010">
    <title>Acknowledgments</title>
    <p id="p0510">This research was substantially sponsored by the research projects (Grant No. 32170654 and Grant No. 32000464) supported by the <funding-source id="gs1"><institution-wrap><institution-id institution-id-type="doi">10.13039/501100001809</institution-id><institution>National Natural Science Foundation of China</institution></institution-wrap></funding-source> and was substantially supported by the <funding-source id="gs2"><institution-wrap><institution-id institution-id-type="doi">10.13039/100016588</institution-id><institution>Shenzhen Research Institute, City University of Hong Kong</institution></institution-wrap></funding-source>. This project was substantially funded by the <funding-source id="gs4">Strategic Interdisciplinary Research</funding-source> Grant of City University of Hong Kong (Project No. 2021SIRG036). The work described in this paper was substantially supported by the grant from the <funding-source id="gs5"><institution-wrap><institution-id institution-id-type="doi">10.13039/501100005847</institution-id><institution>Health and Medical Research Fund</institution></institution-wrap></funding-source>, the <funding-source id="gs6"><institution-wrap><institution-id institution-id-type="doi">10.13039/501100005407</institution-id><institution>Food and Health Bureau</institution></institution-wrap></funding-source>, The <funding-source id="gs7">Government of the Hong Kong Special Administrative Region</funding-source> [07181426]. The work described in this paper was partially supported by the grants from <funding-source id="gs8"><institution-wrap><institution-id institution-id-type="doi">10.13039/100007567</institution-id><institution>City University of Hong Kong</institution></institution-wrap></funding-source> (CityU 11203520, CityU 11203221).</p>
    <p id="p0515">We used multiple open-source icons to create the graphical abstract. The cell icon and the arrow icons are provided by Servier, which are licensed underCreative Commons Attribution 3.0 Unported (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/3.0/" id="intref0095">https://creativecommons.org/licenses/by/3.0/</ext-link>). Slight changes of color were made to these artworks. The human icon by Marcel Tisch is licensed under CC0 (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/" id="intref0100">https://creativecommons.org/publicdomain/zero/1.0/</ext-link>).</p>
    <sec id="sec5">
      <title>Author contributions</title>
      <p id="p0520">Conceptualization, F.W., X.L., and K.C.W.; Methodology, F.W., T.G., and J.L.; Software, F.W., Z.Z., and L.H.; Investigation, F.W., T.G., and J.L.; Visualization, F.W., T.G., L.H., and M.T.; Writing – Original Draft, F.W.; Writing – Review and Editing, T.G., J.L., Z.Z., M.T., X.L., and K.C.W.; Supervision, X.L. and K.C.W.; Project Administration, X.L. and K.C.W.; Funding Acquisition, K.C.W.</p>
    </sec>
    <sec sec-type="COI-statement" id="sec6">
      <title>Declaration of interests</title>
      <p id="p0525">The authors declare no competing interests.</p>
    </sec>
  </ack>
  <fn-group>
    <fn id="appsec1" fn-type="supplementary-material">
      <p id="p0530">Supplemental information can be found online at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.isci.2022.105535" id="intref0105">https://doi.org/10.1016/j.isci.2022.105535</ext-link>.</p>
    </fn>
  </fn-group>
</back>
