<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <?epub May-30-2008?>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-id journal-id-type="hwp">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2447803</article-id>
    <article-id pub-id-type="pmid">18515346</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkn335</article-id>
    <article-id pub-id-type="publisher-id">gkn335</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Articles</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>bioNMF: a web-based tool for nonnegative matrix factorization in biology</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Mejía-Roa</surname>
          <given-names>E.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Carmona-Saez</surname>
          <given-names>P.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nogales</surname>
          <given-names>R.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Vicente</surname>
          <given-names>C.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Vázquez</surname>
          <given-names>M.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yang</surname>
          <given-names>X. Y.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>García</surname>
          <given-names>C.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tirado</surname>
          <given-names>F.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pascual-Montano</surname>
          <given-names>A.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><sup>1</sup>Computer Architecture Department, Complutense University, 28040, <sup>2</sup>Integromics, S.L. Calle Darwin 3. 28049 and <sup>3</sup>Software Engineering Department, Complutense University, 28040 Madrid, Spain</aff>
    <author-notes>
      <corresp id="COR1">*To whom correspondence should be addressed. <phone>+34 913944420</phone><fax>+34 913944687</fax><email>pascual@fis.ucm.es</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>1</day>
      <month>7</month>
      <year>2008</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>30</day>
      <month>5</month>
      <year>2008</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>30</day>
      <month>5</month>
      <year>2008</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>36</volume>
    <issue>Web Server issue</issue>
    <fpage>W523</fpage>
    <lpage>W528</lpage>
    <history>
      <date date-type="received">
        <day>30</day>
        <month>1</month>
        <year>2008</year>
      </date>
      <date date-type="rev-recd">
        <day>18</day>
        <month>4</month>
        <year>2008</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>5</month>
        <year>2008</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2008 The Author(s)</copyright-statement>
      <copyright-year>2008</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>In the last few years, advances in high-throughput technologies are generating large amounts of biological data that require analysis and interpretation. Nonnegative matrix factorization (NMF) has been established as a very effective method to reveal information about the complex latent relationships in experimental data sets. Using this method as part of the exploratory data analysis, workflow would certainly help in the process of interpreting and understanding the complex biology mechanisms that are underlying experimental data. We have developed bioNMF, a web-based tool that implements the NMF methodology in different analysis contexts to support some of the most important reported applications in biology. This online tool provides a user-friendly interface, combined with a computational efficient parallel implementation of the NMF methods to explore the data in different analysis scenarios. In addition to the online access, bioNMF also provides the same functionality included in the website as a public web services interface, enabling users with more computer expertise to launch jobs into bioNMF server from their own scripts and workflows. bioNMF application is freely available at <ext-link ext-link-type="uri" xlink:href="http://bionmf.dacya.ucm.es">http://bionmf.dacya.ucm.es</ext-link>.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>INTRODUCTION</title>
    <p>The analysis of complex data sets generated by –<italic>omics</italic> technologies requires the use of statistical and data mining techniques able to find natural group structures in the data. Different data mining methods have shown to be very useful in providing significant information for hypothesis formulation and discovery of biological patterns. Clustering algorithms or matrix factorization techniques, such as PCA or SVD, are among the most popular tools for the exploratory analysis of high-dimensional biological datasets.</p>
    <p><italic>Nonnegative matrix factorization</italic> (NMF) (<xref ref-type="bibr" rid="B1">1</xref>) is one of such techniques that, although relatively new, is increasingly used in biomedical sciences. It has gained a lot of popularity in the scientific community due to its capability of providing new insights and relevant information about the complex latent relationships in high-dimensional biological data sets. In the particular case of biomedical sciences, several successful studies have been conducted using this method and some of its variants. For example, NMF has been successfully applied to gene-expression analysis (<xref ref-type="bibr" rid="B2 B3 B4 B5">2–5</xref>), scientific literature mining (<xref ref-type="bibr" rid="B6">6</xref>,<xref ref-type="bibr" rid="B7">7</xref>), proteomics, metabolomics (<xref ref-type="bibr" rid="B8">8</xref>,<xref ref-type="bibr" rid="B9">9</xref>), sequence analysis (<xref ref-type="bibr" rid="B10">10</xref>) or neurosciences (<xref ref-type="bibr" rid="B11">11</xref>), among others.</p>
    <p>Due to the increasing interest on this technique by the bioinformatics community, several standalone applications and code in different programming languages have been developed to support NMF analysis and related alternatives, in special for the biomedical field. In 2006, we introduce one of such standalone applications, <italic>bioNMF</italic> (<xref ref-type="bibr" rid="B12">12</xref>), which implements the NMF methodology in different analysis contexts to support some of the most popular applications of this new methodology. This includes clustering and biclustering of gene-expression data and sample classification.</p>
    <p>Even if standalone applications play their role in the research process, online web tools are clearly the preferred option for most of the users, because no resources and computational expertise are required to run a scientific analysis.</p>
    <p>In this work, we propose a user-friendly, web-based tool that implements the same methodologies present on the previous standalone application (<xref ref-type="bibr" rid="B12">12</xref>). In addition, this web tool offers new improvements to process big data sets in a distributed computing environment without the usage complexity present on this kind of systems. It also provides an automated access to external applications through a web services interface.</p>
    <p>To the best of our knowledge, this is the first web-based dedicated application for NMF. This new tool is freely available at <ext-link ext-link-type="uri" xlink:href="http://bionmf.dacya.ucm.es/">http://bionmf.dacya.ucm.es/</ext-link>.</p>
  </sec>
  <sec>
    <title>FEATURES AND FUNCTIONALITY</title>
    <p>Experimental biological information, like for example gene expression, is usually represented and stored as a numerical data matrix, where observations or genes are stored in rows and conditions, experiments or samples are represented in columns. In this case, each cell corresponds to the expression value of a gene in a specific experimental condition.</p>
    <p>Formally, the nonnegative matrix decomposition can be described as <bold>V</bold> ≈ <bold>WH</bold>, where <inline-formula><inline-graphic xlink:href="gkn335i1.jpg"/></inline-formula> is a positive data matrix with <italic>m</italic> variables and <italic>n</italic> objects, <inline-formula><inline-graphic xlink:href="gkn335i2.jpg"/></inline-formula> are the reduced <italic>k</italic> basis vectors or factors and <inline-formula><inline-graphic xlink:href="gkn335i3.jpg"/></inline-formula> contains the coefficients of the linear combinations of the basis vectors needed to reconstruct the original data. The number of factors (<italic>k</italic>) is generally chosen so that it takes a value less than <italic>n</italic> and <italic>m</italic>. The distinctive attributes of NMF with respect to other factorization models are the nonnegativity constraints imposed on <bold>V</bold>, <bold>W</bold> and <bold>H</bold>. In this way, only additive combinations of <bold>W</bold> and <bold>H</bold> are possible, which induces not only an effective dimensionality reduction but also a more interpretable information (<xref ref-type="bibr" rid="B1">1</xref>). <xref ref-type="fig" rid="F1">Figure 1</xref> shows a graphic representation of the model in the case of gene-expression data.
<fig id="F1" position="float"><label>Figure 1.</label><caption><p>Schematic representation of the NMF model applied to gene-expression data. Input data matrix <bold>V</bold> is represented as a gene–experiment matrix and it is decomposed by the product of two new nonnegative matrices <bold>W</bold> and <bold>H</bold>. The <italic>k</italic> columns of <bold>W</bold>, therefore, will have the dimension of a single array (genes) and are known as basis experiments or factors. The columns of <bold>H</bold> are known as encoding vectors and are in one-to-one correspondence with a single experiment of the gene-expression matrix. Consequently, each row of <bold>H</bold> has the dimension of a single gene and it is denoted as basis gene.</p></caption><graphic xlink:href="gkn335f1"/></fig></p>
    <p>The bioNMF online tool provides a functionality to cover some of the most important applications of the NMF algorithm. More particularly in biology (<xref ref-type="bibr" rid="B2">2</xref>,<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B6">6</xref>,<xref ref-type="bibr" rid="B7">7</xref>,<xref ref-type="bibr" rid="B10">10</xref>,<xref ref-type="bibr" rid="B13">13</xref>). This is achieved through three different modules: <italic>Sample Classification</italic>, <italic>Standard NMF</italic> and <italic>Biclustering Analysis</italic>.</p>
    <p>The <italic>Sample Classification</italic> module implements the method proposed by Brunet <italic>et al</italic>. (<xref ref-type="bibr" rid="B2">2</xref>) to determine the most suitable number of sample clusters in a given data set and to group the data samples into <italic>k</italic> clusters, being <italic>k</italic> the best factorization rank within a given input range. This method is probably one of the most used methods in the field to estimate the best factorization rank.</p>
    <sec>
      <title>Standard NMF</title>
      <p>This module performs the classical NMF factorization using the algorithm proposed by Lee and Seung in 1999 (<xref ref-type="bibr" rid="B1">1</xref>). This wide-ranging module is not specifically focused to any particular analysis, but more generally oriented to any potential application that might use this factorization method. As a new feature with respect to the previous standalone application (<xref ref-type="bibr" rid="B12">12</xref>), this module now integrates the consensus clustering methodology described above to determine the best rank of factorization in a given range. This saves the need of launching the <italic>Standard NMF</italic> analysis (and therefore, uploading the data matrix) several times, or running the <italic>Sample Classification</italic> process as a previous step.</p>
      <p>Finally, the <italic>Biclustering Analysis</italic> module implements a two-way clustering method to identify gene–experiment relationships. bioNMF estimates biclusters using a method based on a modified variant of the NMF algorithm, which produces a suitable decomposition as a product of three matrices that are constrained to have nonnegative elements. This variant, denoted as <italic>Nonsmooth Nonnegative Matrix Factorization</italic> (nsNMF) (<xref ref-type="bibr" rid="B14">14</xref>), produces a sparse representation of the gene-expression data matrix, making possible the simultaneous clustering of genes and conditions that are highly related in sub-portions of the data (<xref ref-type="bibr" rid="B3">3</xref>). This module also incorporates the consensus clustering methodology to determine the best rank of factorization.</p>
    </sec>
  </sec>
  <sec>
    <title>SOFTWARE USAGE</title>
    <p>bioNMF has been designed as a web-based tool that mimics its standalone predecessor application (<xref ref-type="bibr" rid="B12">12</xref>). In all analysis methods, the original matrix is decomposed in two new nonnegative matrices that encode the latent information embedded in the original input data. In addition, visualizations used in this application also help in the interpretation of the results.</p>
    <p>The full process is carried out in three very simple steps:</p>
    <sec>
      <title>Data set selection</title>
      <p>The input data is a single standard tab-delimited text file that contains the data matrix with, or without labels, for example, a gene-expression matrix. In addition, if an email address is provided, the user will be notified when the analysis is finished. This feature is very useful when submitting large data sets or analysis that might take long time to process.</p>
    </sec>
    <sec>
      <title>Data preprocessing</title>
      <p>Before the analysis, the data matrix can be transposed, normalized and/or transformed by several methods to satisfy the nonnegative constraints required by the NMF algorithm. Normalization methods include data centering, standardization of rows and columns (independently or simultaneously), mean subtraction by rows and columns and the normalization method proposed by Getz <italic>et al</italic>. (<xref ref-type="bibr" rid="B15">15</xref>) that first divides each column by its mean and then normalizes each row. On the other hand, transformation methods to make data positive include subtracting the absolute minimum, the exponential scaling and two data folding methods proposed by Kim and Tidor (<xref ref-type="bibr" rid="B13">13</xref>). These folding methods duplicate each row or column in which the first occurrence indicates positive expressions and the second indicates negative values.</p>
    </sec>
    <sec>
      <title>Data analysis</title>
      <p>As described in the previous section, three different types of analysis are provided in <italic>bioNMF</italic> to cover some of the most important applications of this methodology: (i) <italic>Sample Classification</italic>; (ii) <italic>Standard NMF</italic> and (iii) <italic>Biclustering Analysis</italic>.</p>
      <p>The sample classification module implements the methodology described by Brunet <italic>et al</italic>. (<xref ref-type="bibr" rid="B2">2</xref>). This methodology uses NMF and a model selection algorithm to determine the most suitable number of sample clusters in a given data set. This sample classification model is based on a reduced set of metagenes, and it has been proved to provide a more accurate and robust classification with respect to the classification based on the high-dimensional gene space. Results will be an estimation of the best number of clusters in the data set and the cluster assignments of each experimental condition. According to (<xref ref-type="bibr" rid="B2">2</xref>) the proper factorization, rank should be selected where the magnitude of the cophenetic correlation coefficient begins to fall. A graphical representation of the cophenetic correlation coefficient and the ordered consensus matrix as described in ref. (<xref ref-type="bibr" rid="B2">2</xref>) are also provided. <xref ref-type="fig" rid="F2">Figure 2</xref> provides a snapshot of the results of this step when applied to the acute myelogenous leukemia (AML) and acute lymphoblastic leukemia (ALL) data set (<xref ref-type="bibr" rid="B17">17</xref>).
<fig id="F2" position="float"><label>Figure 2.</label><caption><p>Snapshot of the output of the Sample Classification module. Results show the cophenetic correlation coefficient (left) for different values of <italic>k</italic> and the reordered consensus matrices (right) calculated for the AML–ALL data set. (<bold>A</bold>) The consensus matrix pattern for <italic>k</italic> = 2 indicates a stable classification into two samples (most of the values are either 0 or 1 represented in red and blue colors in the picture). This is the expected clustering pattern in this two-class data set. (<bold>B</bold>) Consensus matrix for <italic>k</italic> = 5 showing a scattered pattern that indicates a more unstable classification in five classes.</p></caption><graphic xlink:href="gkn335f2"/></fig></p>
      <p>The ordered consensus matrix, in conjunction with the cophenetic correlation coefficient provided in this step, gives an appropriate idea of the stability of the factorization for a given <italic>k</italic>. Since the NMF algorithm is nondeterministic, its solutions might vary from run to run when executed with different random initial values for <bold>W</bold> and <bold>H</bold>. The rationale behind the model selection approach proposed in ref. (<xref ref-type="bibr" rid="B2">2</xref>) is based on the fact that if the factorization is stable for a given value of <italic>k</italic>, we would expect that column's assignments to those <italic>k</italic> factors would vary little from run to run.</p>
      <p>For each run, the column assignment is defined by a connectivity matrix <bold>C</bold> of size <italic>n</italic> × <italic>n</italic> (where <italic>n</italic> is the number of columns). Each entry <italic>Cij</italic> in this matrix equals 1, if column <italic>i</italic> and <italic>j</italic> have their maximum for the same factor, and <italic>Cij</italic> = 0 if they do not. Consensus matrix is then defined as the average connectivity matrix over many factorization runs with different initial random conditions. The entries range from 0 to 1 and reflect the level of reproducibility of the columns’ assignments. If a factorization is stable <bold>C</bold> will tend not to vary among runs, and thus entries will be close to 0 or 1. Dispersion between 0 and 1 will indicate a lack of reproducibility of the columns’ assignments along the different runs. <bold>C</bold> matrix is then reordered to reflect the column's similarity. The more scattered the reordered matrix is, the less stable solution it reflects, since it will indicate that columns that were assigned to the same factor in one run, are probably assigned to different factors in another.</p>
      <p>The standard NMF module performs the classical NMF factorization to the input data matrix. The tool returns the <bold>W</bold> and <bold>H</bold> matrices resulting in the factorization. It is also possible to run NMF different times using random initial conditions each time. Results can be independently saved or combined for further analysis as described in ref. (<xref ref-type="bibr" rid="B6">6</xref>). NMF is nondeterministic and therefore it may or may not converge to the same solution on each run depending on the random initial conditions. Therefore, executing the algorithm several times with different random initializations is a good approach for selecting the <bold>W</bold> and <bold>H</bold> that best approximates the input matrix <bold>V</bold>. Depending on the problem, less or more runs will be necessary to achieve an optimum solution. However, considering that the computational cost of this algorithm is very high a limited number of runs is recommended. On our own experience a value of 100 runs is normally enough to achieve reasonable results (<xref ref-type="bibr" rid="B3">3</xref>). This flexibility makes this unit a general instrument for any potential application in life sciences.</p>
      <p>The biclustering algorithm module implements the methodology described in ref. (<xref ref-type="bibr" rid="B3">3</xref>). It is intended mainly for gene-expression analysis, although its applications can be extended to other type of data. Taking gene expression as a case study, this analysis group genes and samples based on local features generating sets of samples and genes that are locally related. Results are a set of biclusters (submatrices) encoding modular patterns. Each bicluster matrix contains the set of genes that are highly associated to a local pattern and samples sorted by its importance in this pattern. An image of the heatmap of each bicluster is generated. As an example, <xref ref-type="fig" rid="F3">Figure 3</xref> depicts a bicluster obtained from a data set containing the expression profiles of 46 soft-tissue tumor samples reported in (<xref ref-type="bibr" rid="B16">16</xref>).
<fig id="F3" position="float"><label>Figure 3.</label><caption><p>A Heatmap showing the subset of genes and samples in the bicluster. All samples are shown sorted by it association to the bicluster (local pattern). The plot on the upper part of the image represents the coefficients of all samples in the corresponding row of <bold>H</bold>. In blue are the samples that show the largest coefficient for that factor while in green are those samples associated to others.</p></caption><graphic xlink:href="gkn335f3"/></fig></p>
    </sec>
  </sec>
  <sec>
    <title>WEB SERVICES</title>
    <p>In addition to the online access, bioNMF provides the same functionality included in the website as web services. Web services are a public programmatic API that enables users with more computer expertise to launch jobs into bioNMF server from their own programs, scripts and workflows.</p>
    <p>The web services provided in bioNMF are built on open standards such as SOAP (<italic>Simple Object Access Protocol</italic>, a messaging protocol for transporting information; see <ext-link ext-link-type="uri" xlink:href="http://www.w3.org/TR/soap/">http://www.w3.org/TR/soap/</ext-link>) and WSDL (<italic>Web Services Description Language</italic>, an XML format for describing web service capabilities and provided methods; see <ext-link ext-link-type="uri" xlink:href="http://www.w3.org/TR/wsdl">http://www.w3.org/TR/wsdl</ext-link>). The WDSL file describing bioNMF methods can be accessed at <ext-link ext-link-type="uri" xlink:href="http://bionmf.dacya.ucm.es/WebService/BioNMFWS.wsdl">http://bionmf.dacya.ucm.es/WebService/BioNMFWS.wsdl</ext-link>.</p>
    <p>The system allows the upload of matrices, and performs any of the three analyses described in the previous section. The web service works in a nonblocking way. The user launches the analysis and gets a job identifier as results. By using this job identifier, it is possible to poll the status of the job. Once the job is finished, the results can be retrieved using another web service function. The results for each operation include the essential information; however, all the analysis methods produce a set of files that provide other information, such as visualization images.</p>
    <p>Information about all supported web services can be accessed from the web page at: <ext-link ext-link-type="uri" xlink:href="http://bionmf.dacya.ucm.es/webservices.html">http://bionmf.dacya.ucm.es/webservices.html</ext-link>. Full examples of a client program, implemented in Perl and Ruby are also provided.</p>
  </sec>
  <sec>
    <title>IMPLEMENTATION</title>
    <p>This online tool has been designed to process big data sets in a multiprocessor environment. A batch-queuing manager controls most systems of this kind. In order to make this tool easy to use, bioNMF consists of two main components: the user interface (web or web services), that handles the batch-queuing system, and the analysis software executed by that system in the multiprocessor environment.</p>
    <p>The web interface is implemented in PHP (<italic>PHP: Hypertext Preprocessor</italic>; see <ext-link ext-link-type="uri" xlink:href="http://php.net/">http://php.net/</ext-link>), a programming language for generating dynamic web pages. When an analysis is started, the web server submits a job to the batch-queuing system and shows a status page. This page is refreshed periodically until an independent process produces the results page when the job is finished. This system of two processes allows the user to close the browser at the status page stage without losing the results. An email with an URL to the results is optionally sent to the user when the process is finalized.</p>
    <p>The analysis software is currently implemented in two layers. The external layer makes use of Matlab software (<ext-link ext-link-type="uri" xlink:href="www.mathworks.com">www.mathworks.com</ext-link>) to apply the preprocessing methods to the input data and to generate the graphical visualizations. On the other hand, the core of the system, explained below, is implemented in C language.</p>
    <sec>
      <title>NMF-parallelization</title>
      <p>NMF is a very computing intensive technique. With this web application, we also provide an extremely efficient implementation of the NMF algorithm. All of the methods implemented in bioNMF use <italic>parallel computing</italic>. This technique is based on the principle that large problems can be divided into smaller ones, which may be solved in parallel (i.e. simultaneously) in multiple processors. This permits taking advantage of multicore CPUs and computing clusters environments.</p>
      <p>The parallelization is focused on the most demanding part of the <italic>bioNMF</italic> analysis methods: the NMF algorithm. As it is based on matrix–matrix operations, our approach divides each matrix into a set of sub-matrices. Operations between these sub-matrices are computed in parallel. This is the case of <bold>W</bold> and <bold>H</bold> matrices, which are broken into smaller pieces and distributed among the processors. Each sub-matrix operation is then performed simultaneously. When necessary, the results are gathered in order to synchronize the updated matrices. This is done using MPI (<italic>Message Passing Interface</italic>; see <ext-link ext-link-type="uri" xlink:href="http://www.mpi-forum.org/">http://www.mpi-forum.org/</ext-link>) that provides a low overhead communication mechanism.</p>
      <p>This implementation represents a very cost-effective alternative to improve the throughput of this web-based application where simultaneous user's requests are going to be handled. Currently, a dedicated eight-node cluster is supporting this application.</p>
    </sec>
  </sec>
  <sec>
    <title>APPLICATION PERFORMANCE</title>
    <p>As an example of performance, as well as of validation, a test of <italic>Sample Classification</italic> method was made by comparing the Matlab algorithm reported by Brunet <italic>et al</italic>. (<xref ref-type="bibr" rid="B2">2</xref>), available at <ext-link ext-link-type="uri" xlink:href="www.broad.mit.edu/cancer/pub/nmf/">www.broad.mit.edu/cancer/pub/nmf/</ext-link>with the online bioNMF analysis module. Both algorithms were tested with the AML and ALL data set (<xref ref-type="bibr" rid="B17">17</xref>), which is a 5000-gene by 38-sample data matrix. bioNMF's results are very close to those obtained in. Brunet <italic>et al</italic>.'s (<xref ref-type="bibr" rid="B2">2</xref>) algorithm took 2102 s (about 35 min) to complete the analysis in a single AMD Opteron processor, while bioNMF finished in 310 s (5 min, 10 s) in an Opteron eight-processor system. This effective implementation using parallel computing represents a suitable approach to reduce the long computing times required by bigger data sets. Better speedups can also be obtained if computer clusters with a larger number of nodes are used. The current implementation allows this upgrade in a transparent manner.</p>
  </sec>
  <sec>
    <title>DISCUSSION AND CONCLUSIONS</title>
    <p>In the era of –<italic>omics</italic> technologies, the use of sophisticated statistical and data mining methods has become an essential task in many molecular biology laboratories. Web-based tools offer the opportunity of use complex data analysis methods in a friendly environment that quickly bring to many potential users new methodological developments. These types of applications are helping researchers in the exploration and analysis of large volume of data.</p>
    <p>In this work, we present a web-based implementation of the NMF algorithm. This technique is a matrix factorization method that is increasingly used in many fields, such as image analysis, proteomics, metabolomics or genomics. This tool provides an efficient implementation of the NMF and different analysis pipelines based on this algorithm: standard NMF, biclustering analysis and sample classification. The architecture we used to implement this tool also allows the insertion of new variants of NMF or related methods in a straightforward manner. This is particularly important since many new factorization approaches are developing (<xref ref-type="bibr" rid="B18">18</xref>). A good example of this is the projected gradient NMF algorithms like ALS and HALS (<xref ref-type="bibr" rid="B19">19</xref>,<xref ref-type="bibr" rid="B20">20</xref>) which outperforms in many aspects the standard NMF models (see NMFLAB toolbox at <ext-link ext-link-type="uri" xlink:href="http://www.bsp.brain.riken.jp/ICALAB/nmflab.html">http://www.bsp.brain.riken.jp/ICALAB/nmflab.html</ext-link>).</p>
    <p>The design and implementation of bioNMF permit nonexpert users in exploring their data with NMF algorithm in an easy and transparent manner or even insert this analysis in their workflows using the provided web services. Therefore, it is our hope that bioNMF will become an important tool to assist life-sciences researches in the exploratory data analysis cycle.</p>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>This work has been partially funded by the Spanish grants BIO2007-67150-C03-02, S-Gen-0166/2006, CYTED-505PI0058, CSD00C-07-20811 and TIN2005-5619. E.M.R. is supported by the grant <italic>FPU</italic> from the Spanish Ministry of Education. A.P.M. acknowledges the support of the Spanish <italic>Ramón y Cajal</italic> program. Funding to pay the Open Access publication charges for this article was provided by Spanish Grant. BIO2007-67150-C03-02.</p>
    <p><italic>Conflict of interest statement</italic>. None declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>DD</given-names>
          </name>
          <name>
            <surname>Seung</surname>
            <given-names>HS</given-names>
          </name>
        </person-group>
        <article-title>Learning the parts of objects by non-negative matrix factorization</article-title>
        <source>Nature</source>
        <year>1999</year>
        <volume>401</volume>
        <fpage>788</fpage>
        <lpage>791</lpage>
        <pub-id pub-id-type="pmid">10548103</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brunet</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Tamayo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Golub</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Mesirov</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>Metagenes and molecular pattern discovery using matrix factorization</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2004</year>
        <volume>101</volume>
        <fpage>4164</fpage>
        <lpage>4169</lpage>
        <pub-id pub-id-type="pmid">15016911</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carmona-Saez</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Pascual-Marqui</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Tirado</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Carazo</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Pascual-Montano</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Biclustering of gene expression data by non-smooth non-negative matrix factorization</article-title>
        <source>BMC Bioinform.</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>78</fpage>
      </element-citation>
    </ref>
    <ref id="B4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tamayo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Scanfeld</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ebert</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Gillette</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Roberts</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Mesirov</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>Metagene projection for cross-platform, cross-species characterization of global transcriptional states</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2007</year>
        <volume>104</volume>
        <fpage>5959</fpage>
        <lpage>5964</lpage>
        <pub-id pub-id-type="pmid">17389406</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Inamura</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Fujiwara</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hoshida</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Isagawa</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Virtanen</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Shimane</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Satoh</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Okumura</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nakagawa</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Two subclasses of lung squamous cell carcinoma with different gene expression profiles and prognosis identified by hierarchical clustering and non-negative matrix factorization</article-title>
        <source>Oncogene</source>
        <year>2005</year>
        <volume>24</volume>
        <fpage>7105</fpage>
        <lpage>7113</lpage>
        <pub-id pub-id-type="pmid">16007138</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chagoyen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Carmona-Saez</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Shatkay</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Carazo</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Pascual-Montano</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Discovering semantic features in the literature: a foundation for building functional associations</article-title>
        <source>BMC Bioinform.</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>41</fpage>
      </element-citation>
    </ref>
    <ref id="B7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pehkonen</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Toronen</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Theme discovery from gene lists for identification and viewing of multiple functional groups</article-title>
        <source>BMC Bioinform.</source>
        <year>2005</year>
        <volume>6</volume>
        <fpage>162</fpage>
      </element-citation>
    </ref>
    <ref id="B8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dueck</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Morris</surname>
            <given-names>QD</given-names>
          </name>
          <name>
            <surname>Frey</surname>
            <given-names>BJ</given-names>
          </name>
        </person-group>
        <article-title>Multi-way clustering of microarray data using probabilistic sparse matrix factorization</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <issue>Suppl. 1</issue>
        <fpage>i144</fpage>
        <lpage>i151</lpage>
        <pub-id pub-id-type="pmid">15961451</pub-id>
      </element-citation>
    </ref>
    <ref id="B9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Venter</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Adams</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>PW</given-names>
          </name>
          <name>
            <surname>Mural</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Sutton</surname>
            <given-names>GG</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>HO</given-names>
          </name>
          <name>
            <surname>Yandell</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Evans</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Holt</surname>
            <given-names>RA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The sequence of the human genome</article-title>
        <source>Science</source>
        <year>2001</year>
        <volume>291</volume>
        <fpage>1304</fpage>
        <lpage>1351</lpage>
        <pub-id pub-id-type="pmid">11181995</pub-id>
      </element-citation>
    </ref>
    <ref id="B10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heger</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Holm</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Sensitive pattern discovery with ‘fuzzy’ alignments of distantly related proteins</article-title>
        <source>Bioinformatics</source>
        <year>2003</year>
        <volume>19</volume>
        <issue>Suppl. 1</issue>
        <fpage>i130</fpage>
        <lpage>i137</lpage>
        <pub-id pub-id-type="pmid">12855449</pub-id>
      </element-citation>
    </ref>
    <ref id="B11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lohmann</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Volz</surname>
            <given-names>KG</given-names>
          </name>
          <name>
            <surname>Ullsperger</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Using non-negative matrix factorization for single-trial analysis of fMRI data</article-title>
        <source>Neuroimage</source>
        <year>2007</year>
        <volume>37</volume>
        <fpage>1148</fpage>
        <lpage>1160</lpage>
        <pub-id pub-id-type="pmid">17662621</pub-id>
      </element-citation>
    </ref>
    <ref id="B12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pascual-Montano</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Carmona-Saez</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Chagoyen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tirado</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Carazo</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Pascual-Marqui</surname>
            <given-names>RD</given-names>
          </name>
        </person-group>
        <article-title>bioNMF: a versatile tool for non-negative matrix factorization in biology</article-title>
        <source>BMC Bioinform.</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>366</fpage>
      </element-citation>
    </ref>
    <ref id="B13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>PM</given-names>
          </name>
          <name>
            <surname>Tidor</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Subsystem identification through dimensionality reduction of large-scale gene expression data</article-title>
        <source>Genome Res.</source>
        <year>2003</year>
        <volume>13</volume>
        <fpage>1706</fpage>
        <lpage>1718</lpage>
        <pub-id pub-id-type="pmid">12840046</pub-id>
      </element-citation>
    </ref>
    <ref id="B14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pascual-Montano</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Carazo</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Kochi</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lehmann</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Pascual-Marqui</surname>
            <given-names>RD</given-names>
          </name>
        </person-group>
        <article-title>Nonsmooth nonnegative matrix factorization (nsNMF)</article-title>
        <source>IEEE Trans. Pattern Anal. Mach. Intell.</source>
        <year>2006</year>
        <volume>28</volume>
        <fpage>403</fpage>
        <lpage>415</lpage>
        <pub-id pub-id-type="pmid">16526426</pub-id>
      </element-citation>
    </ref>
    <ref id="B15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Getz</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Levine</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Domany</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Coupled two-way clustering analysis of gene microarray data</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2000</year>
        <volume>97</volume>
        <fpage>12079</fpage>
        <lpage>12084</lpage>
        <pub-id pub-id-type="pmid">11035779</pub-id>
      </element-citation>
    </ref>
    <ref id="B16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nielsen</surname>
            <given-names>TO</given-names>
          </name>
          <name>
            <surname>West</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Linn</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Alter</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Knowling</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>O’Connell</surname>
            <given-names>JX</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Fero</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sherlock</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Pollack</surname>
            <given-names>JR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Molecular characterisation of soft tissue tumours: a gene expression study</article-title>
        <source>Lancet</source>
        <year>2002</year>
        <volume>359</volume>
        <fpage>1301</fpage>
        <lpage>1307</lpage>
        <pub-id pub-id-type="pmid">11965276</pub-id>
      </element-citation>
    </ref>
    <ref id="B17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Golub</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Slonim</surname>
            <given-names>DK</given-names>
          </name>
          <name>
            <surname>Tamayo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Huard</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gaasenbeek</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mesirov</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Coller</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Loh</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Downing</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Caligiuri</surname>
            <given-names>MA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Molecular classification of cancer: class discovery and class prediction by gene expression monitoring</article-title>
        <source>Science</source>
        <year>1999</year>
        <volume>286</volume>
        <fpage>531</fpage>
        <lpage>537</lpage>
        <pub-id pub-id-type="pmid">10521349</pub-id>
      </element-citation>
    </ref>
    <ref id="B18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cichocki</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zdunek</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Amari</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Nonnegative matrix and tensor factorization</article-title>
        <source>IEEE Signal Processing Magazine</source>
        <year>2008</year>
        <volume>25</volume>
        <fpage>142</fpage>
        <lpage>145</lpage>
      </element-citation>
    </ref>
    <ref id="B19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cichocki</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zdunek</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Regularized alternating least squares algorithms for non-negative matrix/tensor factorizations</article-title>
        <source>Lect. Notes Comput. Sci.</source>
        <year>2007</year>
        <volume>4493</volume>
        <fpage>793</fpage>
        <lpage>802</lpage>
      </element-citation>
    </ref>
    <ref id="B20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cichocki</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zdunek</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Amari</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Hierarchical ALS algorithms for nonnegative matrix and 3D tensor factorization</article-title>
        <source>Lect. Notes Comput. Sci.</source>
        <year>2007</year>
        <volume>4666</volume>
        <fpage>169</fpage>
        <lpage>176</lpage>
      </element-citation>
    </ref>
  </ref-list>
</back>
