<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PeerJ Comput Sci</journal-id>
    <journal-id journal-id-type="iso-abbrev">PeerJ Comput Sci</journal-id>
    <journal-id journal-id-type="publisher-id">peerj-cs</journal-id>
    <journal-id journal-id-type="pmc">peerj-cs</journal-id>
    <journal-title-group>
      <journal-title>PeerJ Computer Science</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2376-5992</issn>
    <publisher>
      <publisher-name>PeerJ Inc.</publisher-name>
      <publisher-loc>San Diego, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8176530</article-id>
    <article-id pub-id-type="publisher-id">cs-520</article-id>
    <article-id pub-id-type="doi">10.7717/peerj-cs.520</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Bioinformatics</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Data Science</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Databases</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Software Engineering</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>dxpr</italic>: an R package for generating analysis-ready data from electronic health records—diagnoses and procedures</article-title>
    </title-group>
    <contrib-group>
      <contrib id="author-1" contrib-type="author" corresp="yes">
        <name>
          <surname>Tseng</surname>
          <given-names>Yi-Ju</given-names>
        </name>
        <email>yjtseng.info@gmail.com</email>
        <xref ref-type="aff" rid="aff-1">1</xref>
        <xref ref-type="aff" rid="aff-2">2</xref>
      </contrib>
      <contrib id="author-2" contrib-type="author">
        <name>
          <surname>Chiu</surname>
          <given-names>Hsiang-Ju</given-names>
        </name>
        <xref ref-type="aff" rid="aff-3">3</xref>
      </contrib>
      <contrib id="author-3" contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Chun Ju</given-names>
        </name>
        <xref ref-type="aff" rid="aff-3">3</xref>
        <xref ref-type="aff" rid="aff-4">4</xref>
      </contrib>
      <aff id="aff-1"><label>1</label><institution>Department of Information Management, National Central University</institution>, <city>Taoyuan</city>, <country>Taiwan</country></aff>
      <aff id="aff-2"><label>2</label><institution>Department of Laboratory Medicine, Chang Gung Memorial Hospital at Linkou</institution>, <city>Taoyuan</city>, <country>Taiwan</country></aff>
      <aff id="aff-3"><label>3</label><institution>Department of Information Management, Chang Gung University</institution>, <city>Taoyuan</city>, <country>Taiwan</country></aff>
      <aff id="aff-4"><label>4</label><institution>Department of Information Management, National Taiwan University</institution>, <city>Taipei</city>, <country>Taiwan</country></aff>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Zhang</surname>
          <given-names>Qichun</given-names>
        </name>
      </contrib>
    </contrib-group>
    <pub-date pub-type="epub" date-type="pub" iso-8601-date="2021-05-26">
      <day>26</day>
      <month>5</month>
      <year iso-8601-date="2021">2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>7</volume>
    <elocation-id>e520</elocation-id>
    <history>
      <date date-type="received" iso-8601-date="2020-12-16">
        <day>16</day>
        <month>12</month>
        <year iso-8601-date="2020">2020</year>
      </date>
      <date date-type="accepted" iso-8601-date="2021-04-09">
        <day>9</day>
        <month>4</month>
        <year iso-8601-date="2021">2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>©2021 Tseng et al.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Tseng et al.</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, reproduction and adaptation in any medium and for any purpose provided that it is properly attributed. For attribution, the original author(s), title, publication source (PeerJ Computer Science) and either DOI or URL of the article must be cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="https://peerj.com/articles/cs-520"/>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Enriched electronic health records (EHRs) contain crucial information related to disease progression, and this information can help with decision-making in the health care field. Data analytics in health care is deemed as one of the essential processes that help accelerate the progress of clinical research. However, processing and analyzing EHR data are common bottlenecks in health care data analytics.</p>
      </sec>
      <sec>
        <title>Methods</title>
        <p>The <italic>dxpr</italic> R package provides mechanisms for integration, wrangling, and visualization of clinical data, including diagnosis and procedure records. First, the <italic>dxpr</italic> package helps users transform International Classification of Diseases (ICD) codes to a uniform format. After code format transformation, the <italic>dxpr</italic> package supports four strategies for grouping clinical diagnostic data. For clinical procedure data, two grouping methods can be chosen. After EHRs are integrated, users can employ a set of flexible built-in querying functions for dividing data into case and control groups by using specified criteria and splitting the data into before and after an event based on the record date. Subsequently, the structure of integrated long data can be converted into wide, analysis-ready data that are suitable for statistical analysis and visualization.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We conducted comorbidity data processes based on a cohort of newborns from Medical Information Mart for Intensive Care-III (n = 7,833) by using the <italic>dxpr</italic> package. We first defined patent ductus arteriosus (PDA) cases as patients who had at least one PDA diagnosis (ICD, Ninth Revision, Clinical Modification [ICD-9-CM] 7470*). Controls were defined as patients who never had PDA diagnosis. In total, 381 and 7,452 patients with and without PDA, respectively, were included in our study population. Then, we grouped the diagnoses into defined comorbidities. Finally, we observed a statistically significant difference in 8 of the 16 comorbidities among patients with and without PDA, including fluid and electrolyte disorders, valvular disease, and others.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>This <italic>dxpr</italic> package helps clinical data analysts address the common bottleneck caused by clinical data characteristics such as heterogeneity and sparseness.</p>
      </sec>
    </abstract>
    <kwd-group kwd-group-type="author">
      <kwd>Electronic health records</kwd>
      <kwd>Analysis-ready data</kwd>
      <kwd>Exploratory data analysis</kwd>
      <kwd>R package</kwd>
    </kwd-group>
    <funding-group>
      <award-group id="fund-1">
        <funding-source> Chang Gung Memorial Hospital</funding-source>
        <award-id>CMRPD3K0011</award-id>
      </award-group>
      <award-group id="fund-2">
        <funding-source> Ministry of Science and Technology, Taiwan</funding-source>
        <award-id>MOST 109-2636-E-008-009</award-id>
        <award-id> MOST 110-2636-E-008-008</award-id>
      </award-group>
      <funding-statement>This research was supported by Chang Gung Memorial Hospital (CMRPD3K0011), the Ministry of Science and Technology, Taiwan (MOST 109-2636-E-008-009 and MOST 110-2636-E-008-008). There was no additional external funding received for this study. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>On the basis of the development of electronic health records (EHRs), data analytics in health care is deemed as an essential process for accelerating the progress of clinical research (<xref rid="ref-10" ref-type="bibr">Hersh, 2007</xref>; <xref rid="ref-14" ref-type="bibr">Jensen, Jensen &amp; Brunak, 2012</xref>; <xref rid="ref-17" ref-type="bibr">Miotto &amp; Weng, 2015</xref>). Enriched EHRs contain crucial information related to disease progression, and this information can help with decision making in the health care field including for treatment selection and disease diagnosis (<xref rid="ref-14" ref-type="bibr">Jensen, Jensen &amp; Brunak, 2012</xref>; <xref rid="ref-22" ref-type="bibr">Raghupathi &amp; Raghupathi, 2014</xref>). However, processing and analyzing EHR data are usually challenging because of their heterogeneity and sparsity. These inherent characteristics create a common bottleneck in health care big data analytics (<xref rid="ref-34" ref-type="bibr">Wu, Roy &amp; Stewart, 2010</xref>; <xref rid="ref-12" ref-type="bibr">Hripcsak &amp; Albers, 2013</xref>; <xref rid="ref-32" ref-type="bibr">Weiskopf &amp; Weng, 2013</xref>). Moreover, executing clinical data analysis project across different departments or institutes is difficult because clinical data formats and terminologies used to describe clinical conditions may vary across departments. A method that can standardize and facilitate the sharing of data or analysis pipelines from multiple sources is needed in research on clinical data analysis. Several common data models (CDMs) have been developed for eliminating clinical data format barriers, including the National Patient-Centered Clinical Research Network (PCORnet) (<xref rid="ref-5" ref-type="bibr">Fleurence et al., 2014</xref>; <xref rid="ref-20" ref-type="bibr">PCORnet, 2020</xref>) and Observational Medical Outcomes Partnership (OMOP) CDM (<xref rid="ref-19" ref-type="bibr">Observational Health Data Sciences and Informatics, 2020</xref>). The concept of CDM is to transform data into a CDM and terminology and then allow users to perform systematic analyses by using various sources. Although a CDM can help perform systematic analyses across different sources, the integration of clinical data and the preparation of analysis-ready data are unsolved issues.</p>
    <p>The proposed open-source <italic>dxpr</italic> R package is a software tool aimed at expediting general EHR or claims data analyses through incorporating several functions that enable users to standardize, integrate, wrangle, and visualize clinical diagnosis and procedure records. Preparing an analysis-ready dataset from EHRs or claims data is a complex task that requires both medical knowledge and data science skills. The proposed <italic>dxpr</italic> package simplifies and accelerates the workflow for EHR data extraction and helps clinical data analysts generate simple and clean scripts that can easily be shared and reproduced. The <italic>dxpr</italic> package enables researchers to explore EHRs or claims data to acquire crucial information, understand disease progression, and analyze outcomes without writing complicated data preprocessing scripts. Moreover, the proposed package can support collaborative research across multiple data sources as long as the data include general diagnosis- or procedure-related information.</p>
    <p>The <italic>dxpr</italic> package has three phases to process and analyze diagnosis codes in EHRs (<xref ref-type="fig" rid="fig-1">Fig. 1</xref>). In the first phase, namely data integration, we transform diagnosis codes into a uniform format and provide four strategies to group diagnoses into clinically meaningful categories before the wrangling process. In the second phase, namely, data wrangling, users can use provided functions to query eligible cases, split data based on the index date, and calculate condition era according to the grouped diagnostic categories of each patients. Furthermore, exploratory data analysis preparation can be performed in this phase. Moreover, the <italic>dxpr</italic> package provides a function to convert a long format of grouped data into a wide format, which fits other analytical and plotting functions from other packages better. In the last phase, namely visualization, we provide overviews for diagnosis standardization and data integration, such as comorbidity distribution in the study population, comorbidity differences between case and control groups, and the most common diagnoses that failed to be grouped or transformed. The usage details are presented in the Supplementary Data S1 and S2. For processing and analyzing procedure codes, the concept is similar to diagnosis.</p>
    <fig id="fig-1" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.7717/peerjcs.520/fig-1</object-id>
      <label>Figure 1</label>
      <caption>
        <title>Overview of the <italic>dxpr</italic> package.</title>
      </caption>
      <graphic xlink:href="peerj-cs-07-520-g001"/>
    </fig>
  </sec>
  <sec sec-type="materials|methods">
    <title>Materials and Methods</title>
    <sec>
      <title>Preparation</title>
      <p>The current version of the package is available at Github (<ext-link ext-link-type="uri" xlink:href="https://github.com/DHLab-TSENG/dxpr">https://github.com/DHLab-TSENG/dxpr</ext-link>, Supplementary Data S3) and is accessible through the devtools package that enables installing packages from GitHub (<xref rid="ref-33" ref-type="bibr">Wickham, Hester &amp; Chang, 2020</xref>). To install the <italic>dxpr</italic> R package, users can type the following commands in an R session:</p>
      <p>
        <inline-graphic xlink:href="peerj-cs-07-520-i001.jpg" mimetype="image" mime-subtype="png" content-type="symbol"/>
      </p>
      <p>The imported EHR dataset must contain at least three columns as indicated below:</p>
      <list list-type="simple" id="list-1">
        <list-item>
          <label> •</label>
          <p>Member ID: a patient identifier, which can be numeric, alphanumeric, or a list of characters.</p>
        </list-item>
        <list-item>
          <label> •</label>
          <p>Diagnosis/procedure code: ICD-9 or ICD-10 code assigned to a visit or an admission.</p>
        </list-item>
        <list-item>
          <label> •</label>
          <p>Visit or admission date: the date of the visit, admission, or clinical service provided. The date should be in date format. If the date is recorded in a string format, it has to be recorded in year–month–day format (YYYY/MM/DD or YYYY-MM-DD).</p>
        </list-item>
      </list>
      <p>Column names can be passed in each function by using function arguments.</p>
      <p>The data can be imported from files or databases, with packages provide access to databases within R, such as DBI (<xref rid="ref-21" ref-type="bibr">R Special Interest Group on Databases R-SIG-DB, Wickham &amp; Müller, 2021</xref>) and odbc (<xref rid="ref-11" ref-type="bibr">Hester &amp; Wickham, 2021</xref>). We illustrate the use of the <italic>dxpr</italic> package with a diagnostic sample dataset of 10-year admissions of 38 patients, <monospace>sampleDxFile</monospace>, and the first five records are shown in <xref rid="table-1" ref-type="table">Table 1</xref>.</p>
      <table-wrap id="table-1" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerjcs.520/table-1</object-id>
        <label>Table 1</label>
        <caption>
          <title>The first five diagnosis records of the sample dataset.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="peerj-cs-07-520-g003"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th rowspan="1" colspan="1">
                  <bold>ID</bold>
                </th>
                <th rowspan="1" colspan="1">
                  <bold>ICD</bold>
                </th>
                <th rowspan="1" colspan="1">
                  <bold>Date</bold>
                </th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1">A2</td>
                <td rowspan="1" colspan="1">Z992</td>
                <td rowspan="1" colspan="1">2020-05-22</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">A5</td>
                <td rowspan="1" colspan="1">Z992</td>
                <td rowspan="1" colspan="1">2020-01-24</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">A8</td>
                <td rowspan="1" colspan="1">Z992</td>
                <td rowspan="1" colspan="1">2015-10-27</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">A13</td>
                <td rowspan="1" colspan="1">Z992</td>
                <td rowspan="1" colspan="1">2020-04-26</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">A13</td>
                <td rowspan="1" colspan="1">Z992</td>
                <td rowspan="1" colspan="1">2025-02-02</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
    </sec>
    <sec>
      <title>Data integration</title>
      <sec>
        <title>Code format transformation</title>
        <p>The <italic>dxpr</italic> package first transforms ICD diagnostic codes into a uniform format before code grouping. ICD-9 and ICD-10 diagnostic codes (<xref rid="ref-30" ref-type="bibr">US Centers for Medicare &amp; Medicaid Services, 2017a</xref>) have two formats, namely decimal (with a decimal place separating the code) and short formats. Different hospitals, grouping methods, or standards coded ICD into different formats. For example, studies using Clinical Classifications Software (CCS) (<xref rid="ref-7" ref-type="bibr">HCUP, 2017</xref>; <xref rid="ref-8" ref-type="bibr">HCUP, 2019a</xref>) and comorbidity measures, such as Elixhauser and Charlson (<xref rid="ref-4" ref-type="bibr">Elixhauser et al., 1998</xref>; <xref rid="ref-16" ref-type="bibr">Menendez et al., 2014</xref>; <xref rid="ref-18" ref-type="bibr">Moore et al., 2017</xref>), have coded the ICD in a short format, and a phenome-wide association study (PheWAS) (<xref rid="ref-2" ref-type="bibr">Denny et al., 2010</xref>) coded the ICD in a decimal format. Therefore, format transformation is required before code grouping, and the transformation type is decided by the chosen grouping method.</p>
        <p>The transformation function (<monospace>icdDxShortToDecimal</monospace>) converts ICD-9 and ICD-10 codes into a uniform decimal format because a decimal format is needed for grouping diagnostic codes in PheWAS classification. Similar to <monospace>icdDxShortToDecimal</monospace>, <monospace>icdDxDecimalToShort</monospace> function converts diagnostic codes into a uniform short format, which can be used for grouping to CCS, Elixhauser, or other classifications. These transformative functions not only convert ICD codes into uniform format codes but also check for potential coding errors. We provide two types of warning messages: wrong ICD format and wrong ICD version. Additional suggestions are generated to help users adjust potential incorrect ICD codes if available.</p>
        <p>
          <inline-graphic xlink:href="peerj-cs-07-520-i002.jpg" mimetype="image" mime-subtype="png" content-type="symbol"/>
        </p>
      </sec>
      <sec>
        <title>Code grouping</title>
        <p>The code grouping functions collapse clinical diagnostic data (ICD-9/ICD-10 codes) (<xref rid="ref-30" ref-type="bibr">US Centers for Medicare &amp; Medicaid Services, 2017a</xref>) into a smaller number of clinically meaningful categories that are more useful for presenting descriptive statistics than using individual diagnostic codes (<xref rid="ref-9" ref-type="bibr">HCUP, 2019b</xref>). The <italic>dxpr</italic> package supports four strategies to group EHR diagnosis codes, namely CCS (<xref rid="ref-29" ref-type="bibr">US Centers for Medicare &amp; Medicaid Services, 2017b</xref>), PheWAS (<xref rid="ref-2" ref-type="bibr">Denny et al., 2010</xref>) (<monospace>icdDxToPheWAS</monospace>), comorbidity measures (<xref rid="ref-4" ref-type="bibr">Elixhauser et al., 1998</xref>; <xref rid="ref-16" ref-type="bibr">Menendez et al., 2014</xref>; <xref rid="ref-18" ref-type="bibr">Moore et al., 2017</xref>), and self-defining grouping methods. The CCS grouping strategies includes single-level CCS (<monospace>icdDxToCCS</monospace>) and multiple-level CCS (<monospace>icdDxToCCSLvl</monospace>) (<xref rid="ref-7" ref-type="bibr">HCUP, 2017</xref>; <xref rid="ref-8" ref-type="bibr">HCUP, 2019a</xref>), comorbidity measures (<monospace>icdDxToComorbid</monospace>) includes Elixhauser, Agency for Healthcare Research and Quality (AHRQ) and Charlson (<xref rid="ref-4" ref-type="bibr">Elixhauser et al., 1998</xref>; <xref rid="ref-16" ref-type="bibr">Menendez et al., 2014</xref>; <xref rid="ref-18" ref-type="bibr">Moore et al., 2017</xref>), and self-defining grouping methods includes precise matching (<monospace>icdDxToCustom</monospace>) and searching for lines containing a match (<monospace>icdDxToCustomGrep</monospace>). The grouping functions return two tables of the dataset, one is data with the corresponding grouping categories of each ICD (<xref rid="table-2" ref-type="table">Table 2</xref>), and the other is summarized data exhibiting the earliest/latest record date and diagnosis counts in the same grouping category for each patient (<xref rid="table-3" ref-type="table">Table 3</xref>). For example, after executing function <monospace>icdDxToCCS</monospace> for the records of patients A and B, two output types are shown in <xref rid="table-2" ref-type="table">Tables 2</xref> and <xref rid="table-3" ref-type="table">3</xref>, respectively. Patient A has three diagnosis records (ICD codes: 78550, 78552, and 785.59), which are all in the “shock” category of the CCS classification, with the earliest record on September 1, 2013 and the latest one on October 1, 2014. The <monospace>icdDxToCCS</monospace> function mapped corresponding CCS categories for these ICD codes and returned the grouping results (<xref rid="table-2" ref-type="table">Table 2</xref>). Similarly, patient B has two diagnosis records (ICD codes: 78552 and 250.00) in the “shock” category and “Diabetes mellitus without complication” category of CCS classification, and the grouping results are also shown in <xref rid="table-2" ref-type="table">Table 2</xref>. According to these diagnosis records shown in <xref rid="table-2" ref-type="table">Table 2</xref>, <xref rid="table-3" ref-type="table">Table 3</xref> shows that <monospace>icdDxToCCS</monospace> function can summarize the first and last dates of diagnosis, the total number of diagnoses, and the period between the first and last diagnoses for each category, which can be used for designing the analysis strategy. While <monospace>icdDxToCCS</monospace> groups codes into single-level CCS, <monospace>icdDxToCCSLvl</monospace> groups codes into multi-level CCS. Multi-level CCS expands single-level CCS into a four-level hierarchical system for diagnoses, which provide the opportunity to examine general aggregations or to assess specific conditions (<xref rid="ref-8" ref-type="bibr">HCUP, 2019a</xref>). For instance, if a user wishes to group codes into the second level of multi-level CCS, then this task can be performed through simply entering “<monospace>ccslvl2</monospace>” as the assigned grouping type. These grouping functions not only facilitate users to convert original diagnosis records from detailed levels into clinically meaningful diagnostic groups for further analysis but also provide aggregated information of each diagnostic group that can help research design and hypothesis generation, such as filtering out data based on specified criteria (e.g., first diagnosis dates of a specific chronic disease).</p>
        <table-wrap id="table-2" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.7717/peerjcs.520/table-2</object-id>
          <label>Table 2</label>
          <caption>
            <title>Grouping results from grouping functions—icdDxToCCS.</title>
          </caption>
          <alternatives>
            <graphic xlink:href="peerj-cs-07-520-g004"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col span="1"/>
                <col span="1"/>
                <col span="1"/>
                <col span="1"/>
                <col span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <th rowspan="1" colspan="1">Short</th>
                  <th rowspan="1" colspan="1">
                    <bold>ID</bold>
                  </th>
                  <th rowspan="1" colspan="1">
                    <bold>ICD</bold>
                  </th>
                  <th rowspan="1" colspan="1">
                    <bold>Date</bold>
                  </th>
                  <th rowspan="1" colspan="1">ccs_categories_description </th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td rowspan="1" colspan="1">78550</td>
                  <td rowspan="1" colspan="1">A</td>
                  <td rowspan="1" colspan="1">78550</td>
                  <td rowspan="1" colspan="1">2014/10/01</td>
                  <td rowspan="1" colspan="1">Shock</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">78552</td>
                  <td rowspan="1" colspan="1">A</td>
                  <td rowspan="1" colspan="1">78552</td>
                  <td rowspan="1" colspan="1">2013/10/01</td>
                  <td rowspan="1" colspan="1">Shock</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">78559</td>
                  <td rowspan="1" colspan="1">A</td>
                  <td rowspan="1" colspan="1">785.59</td>
                  <td rowspan="1" colspan="1">2013/09/01</td>
                  <td rowspan="1" colspan="1">Shock</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">78552</td>
                  <td rowspan="1" colspan="1">B</td>
                  <td rowspan="1" colspan="1">78552</td>
                  <td rowspan="1" colspan="1">2013/09/01</td>
                  <td rowspan="1" colspan="1">Shock</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">25000</td>
                  <td rowspan="1" colspan="1">B</td>
                  <td rowspan="1" colspan="1">250.00</td>
                  <td rowspan="1" colspan="1">2012/07/01</td>
                  <td rowspan="1" colspan="1">Diabetes mellitus without complication</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">25000</td>
                  <td rowspan="1" colspan="1">B</td>
                  <td rowspan="1" colspan="1">250.00</td>
                  <td rowspan="1" colspan="1">2012/05/01</td>
                  <td rowspan="1" colspan="1">Diabetes mellitus without complication</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
        </table-wrap>
        <table-wrap id="table-3" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.7717/peerjcs.520/table-3</object-id>
          <label>Table 3</label>
          <caption>
            <title>Summarized results from grouping functions—icdDxToCCS.</title>
          </caption>
          <alternatives>
            <graphic xlink:href="peerj-cs-07-520-g005"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col span="1"/>
                <col span="1"/>
                <col span="1"/>
                <col span="1"/>
                <col span="1"/>
                <col span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <th rowspan="1" colspan="1">ID</th>
                  <th rowspan="1" colspan="1">Categories</th>
                  <th rowspan="1" colspan="1">FirstCaseDate</th>
                  <th rowspan="1" colspan="1">EndCaseDate</th>
                  <th rowspan="1" colspan="1">Count</th>
                  <th rowspan="1" colspan="1">Period</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td rowspan="1" colspan="1">A</td>
                  <td rowspan="1" colspan="1">Shock</td>
                  <td rowspan="1" colspan="1">2013/09/01</td>
                  <td rowspan="1" colspan="1">2014/10/01</td>
                  <td rowspan="1" colspan="1">3</td>
                  <td rowspan="1" colspan="1">395 days</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">B</td>
                  <td rowspan="1" colspan="1">Diabetes mellitus without complication</td>
                  <td rowspan="1" colspan="1">2012/05/01</td>
                  <td rowspan="1" colspan="1">2012/07/01</td>
                  <td rowspan="1" colspan="1">2</td>
                  <td rowspan="1" colspan="1">62 days</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">B</td>
                  <td rowspan="1" colspan="1">Shock</td>
                  <td rowspan="1" colspan="1">2013/09/01</td>
                  <td rowspan="1" colspan="1">2013/09/01</td>
                  <td rowspan="1" colspan="1">1</td>
                  <td rowspan="1" colspan="1">0 days</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
        </table-wrap>
        <p>The usage of code classification function for CCS is as follows:</p>
        <p>
          <inline-graphic xlink:href="peerj-cs-07-520-i003.jpg" mimetype="image" mime-subtype="png" content-type="symbol"/>
        </p>
      </sec>
    </sec>
    <sec>
      <title>Data wrangling</title>
      <sec>
        <title>Case selection</title>
        <p>In clinical data analysis projects, the most crucial step is case definition and selection, such as defining Lyme disease cases from claims data (<xref rid="ref-26" ref-type="bibr">Tseng et al., 2015</xref>) or defining acute ischemic stroke from EHR (<xref rid="ref-28" ref-type="bibr">Tseng et al., 2020</xref>). The analysis results could change based on case definition and lead to a different conclusion. The query function <monospace>selectCases</monospace> can select cases matching case definitions. Users can select cases based on diagnosis (ICD) or diagnostic categories (CCS, PheWAS, comorbidities, or self-defined diagnostic categories). Moreover, the function provides an option to set the minimum number of diagnoses within a specific duration. For example, users can extract diabetes cases by assigning at least two diagnoses in ICD codes “250.xx” or “E10.x-E14.x” within 730 days when a user applies the validated diabetes case definition: “two physician claims within 2 years with diagnosis codes 250.xx or E10.x-E14.x” (<xref rid="ref-1" ref-type="bibr">Chen et al., 2010</xref>). The output dataset of this function provides the start and end dates of the cases, the number of days between them, and the most common ICD codes used in the case definition. Furthermore, a list of people who did not satisfy the required case conditions or practically match the case definition is appended in the returned output table, and these individuals can be defined as a control group or be removed.</p>
        <p>
          <inline-graphic xlink:href="peerj-cs-07-520-i004.jpg" mimetype="image" mime-subtype="png" content-type="symbol"/>
        </p>
      </sec>
      <sec>
        <title>Eligible period identification</title>
        <p>In some clinical data, such as claims data, individuals can join or leave the program on different dates, and the length of available records might affect the analysis completeness. The <italic>dxpr</italic> package provides a function <monospace>getEligiblePeriod</monospace> for researchers to identify the first/last record date for each patient. These outputs can be used as an index date for case exclusion, such as cases without at least 6 months washout or follow-up period, or further data splitting.</p>
        <p>
          <inline-graphic xlink:href="peerj-cs-07-520-i005.jpg" mimetype="image" mime-subtype="png" content-type="symbol"/>
        </p>
      </sec>
      <sec>
        <title>Data splitting based on index date and moving window</title>
        <p>In clinical data analysis projects, users usually need to extract data based on a specific clinical event (e.g., extracting data before the first Lyme disease diagnosis in the records (<xref rid="ref-27" ref-type="bibr">Tseng et al., 2017</xref>)). The date of the specific event (index date) can be the first/last record date of the events or patient record, and the table of the index date for each individual can be generated using <monospace>selectCases</monospace> or <monospace>getEligiblePeriod</monospace> function, respectively. The <italic>dxpr</italic> package provides a convenient function <monospace>splitDataByDate</monospace> that can split data through classifying the data recorded before or after the defined index date and calculating the period between the record date and index date based on a self-defined window. For example, if a user needs to aggregate the data by using a 30-day window, the data recorded on 15 and 45 days after the index date will be defined as window 1 and window 2, respectively. The output of <monospace>splitDataByDate</monospace> function helps users to split the data based on the study design, and this can be applied to further time-series multiple-measurement analysis with period information.</p>
        <p>
          <inline-graphic xlink:href="peerj-cs-07-520-i006.jpg" mimetype="image" mime-subtype="png" content-type="symbol"/>
        </p>
      </sec>
      <sec>
        <title>Condition era generation</title>
        <p>Condition era is a means to apply consistent rules for medical conditions to infer distinct episodes in care, generated through integrating distributed clinical records into a single progression record (<xref rid="ref-23" ref-type="bibr">Reisinger et al., 2010</xref>). The concept of condition era is committed to the length of the persistence gap: when the time interval of any two consecutive admissions for certain conditions is smaller than the length of the persistence gap, then these two admission events will be aggregated into the same condition era. Each condition era consists of one or many events, and differences between any two consecutive admission events are all within the persistence gap. For example, an episode of influenza may include single or multiple outpatient visits, and the length of the influenza course should be the period between the first and last visits of the episode. <monospace>getConditionEra</monospace> function calculates condition era by using the grouped categories or self-defining groups of each patient and then generates a table with individual IDs, the first and last record of an era, and the sequence number of each episode. Users can easily convert scattered diagnoses into an episode of condition based on the chararistics of target disease progression with the proposed function.</p>
        <p>
          <inline-graphic xlink:href="peerj-cs-07-520-i007.jpg" mimetype="image" mime-subtype="png" content-type="symbol"/>
        </p>
      </sec>
      <sec>
        <title>Analysis-ready data generation</title>
        <p>After data integration and wrangling, researchers often need to further analyze these processed data, and function <monospace>groupedDataLongToWide</monospace> converts the long format of grouped data into a wide format, which is fit for other analytical and plotting packages, such as tableone (<xref rid="ref-35" ref-type="bibr">Yoshida &amp; Bartel, 2020</xref>) package.</p>
        <p>
          <inline-graphic xlink:href="peerj-cs-07-520-i008.jpg" mimetype="image" mime-subtype="png" content-type="symbol"/>
        </p>
      </sec>
    </sec>
    <sec>
      <title>Visualization</title>
      <sec>
        <title>Pareto chart of error ICD</title>
        <p>When code transformation is implemented in the <italic>dxpr</italic> package, it generates unified data of diagnosis codes with potential errors. Function <monospace>plotICDError</monospace> visualizes codes with potential error by using the Pareto chart containing a bar plot where error ICD codes are arranged in descending order, and the cumulative total is represented by the line. Users can sort based on the counts of error ICD codes and set the top selected number of the ordered dataset. For instance, if a user chooses the top 10 ordinal rankings, then the Pareto chart shows a plot of the top 10 common error ICD codes and a list with details of these 10 and other error ICD codes.</p>
        <p>
          <inline-graphic xlink:href="peerj-cs-07-520-i009.jpg" mimetype="image" mime-subtype="png" content-type="symbol"/>
        </p>
      </sec>
      <sec>
        <title>Bar chart of diagnostic categories</title>
        <p>Function <monospace>plotDiagCat</monospace> provides an overview of the grouping categories of the diagnoses and summarizes the proportion of individuals diagnosed with grouped diagnostic categories in the whole study population or case and control groups in a bar chart. Users can observe the number and percentage of diagnostic categories in their dataset through this function. Furthermore, this function compares the usage of significantly different diagnostic categories between case and control groups by using the chi-square test or Fisher’s exact test when the data does not match the assumptions of the chi-square test. The default level of statistical significance is considered at 5% (<italic>p</italic> = 0.05). Researchers can set a threshold of the top N significant grouped categories and the minimum prevalence of the diagnostic groups in the case or control group.</p>
        <p>The “<monospace>percentage</monospace>” column shows the proportion of individuals diagnosed with the diagnostic category in the group. For example, there are 38 patients in the sample file, and “Renal Failure” defined in Elixhauser comorbidity accounts for 63.16% of the population (24/38).</p>
        <p>
          <inline-graphic xlink:href="peerj-cs-07-520-i010.jpg" mimetype="image" mime-subtype="png" content-type="symbol"/>
        </p>
      </sec>
    </sec>
    <sec>
      <title>Clinical procedure data processing</title>
      <p>As diagnosis codes, ICD-9-Procedure Coding System (PCS) code also has two formats, namely decimal and short, whereas ICD-10-PCS code only has a short format. The functions (<monospace>icdPrToCCS</monospace> and <monospace>icdPrToProcedureClass</monospace>) provide two strategies (CCS and procedure class) to collapse ICD procedure codes into clinically meaningful categories for further analysis. This procedure has two CCS classifications: single and multiple levels. The usage is similar to the diagnostic CCS classification. A sample file (<monospace>samplePrFile</monospace>) is provided with procedure records, including three patients and 170 records.</p>
      <p>The procedure classes (<xref rid="ref-6" ref-type="bibr">HCUP, 2016</xref>) are created to facilitate health services research on hospital procedures by using administrative data. The procedure classes provide a standard to categorize individual procedure codes into one of the four broad categories: minor diagnostic, minor therapeutic, major diagnostic, and major therapeutic. The aforementioned classification functions mentioned allow the researcher to readily determine whether a procedure is diagnostic or therapeutic and whether a procedure is minor or major in terms of invasiveness, resource use, or both.</p>
    </sec>
    <sec>
      <title>Use case</title>
      <p>To illustrate the main features in the <italic>dxpr</italic> package and the typical workflow, we demonstrated an analysis using the package among newborns who were diagnosed with patent ductus arteriosus (PDA) from Medical Information Mart for Intensive Care-III (MIMIC-III) (<xref rid="ref-15" ref-type="bibr">Johnson et al., 2016</xref>). MMIC-III is a publicly available database comprising deidentified health-related data associated with the admissions of approximately 60,000 patients who stayed in the critical care units of the Beth Israel Deaconess Medical Center between 2001 and 2012.</p>
      <p>We provided a sample file <monospace>sampleFile_MIMIC</monospace> obtained from MIMIC-III (<xref rid="ref-15" ref-type="bibr">Johnson et al., 2016</xref>), a medical dataset of 7,833 newborn patients with 45,674 admissions. This dataset is used for verifying the comorbidity difference between patients with and without PDA based on the <italic>dxpr</italic> package. In this example, we defined PDA cases as patients who had at least one PDA diagnosis (ICD-9-CM 7470*). The controls are defined as patients who never had PDA diagnosis.</p>
    </sec>
    <sec>
      <title>Performance analysis</title>
      <p>The <italic>dxpr</italic> package is designated to accelerate the process of large EHR data integration and provide the ready-for-analysis dataset from the integrated EHR data. We verified the running time 100 times with a simulated dataset of 953,294 unique patients and 7,948,418 distinct diagnosis records in a standard personal computer with 64 GB DDR4 2133 GHz RAM and an Intel<sup>®</sup> Core™ i7-6700 (CPU @3.40 GHz), using Windows 10 (1809), R 4.0.1 (64 bits), and RStudio 1.2.5033.</p>
    </sec>
  </sec>
  <sec>
    <title>Result</title>
    <sec>
      <title>A use case—patients with PDA</title>
      <p>We conducted comorbidity analyses based on a cohort of newborns from MIMIC-III (<italic>n</italic> = 7, 833) by using <italic>dxpr</italic> and tableone (<xref rid="ref-35" ref-type="bibr">Yoshida &amp; Bartel, 2020</xref>) packages. In the <italic>dxpr</italic> package, we first use <monospace>selectCases</monospace> function to define case (PDA) and control (non-PDA) groups. In total, 381 and 7,452 patients with and without PAD were included in our study, respectively. Then, <monospace>icdDxToComorbid</monospace> function was applied to group diagnoses into AHRQ-defined comorbidities. Finally, we analyzed and graphed the AHRQ-defined comorbidities based on <monospace>plot_groupedData</monospace> function (<xref ref-type="fig" rid="fig-2">Fig. 2</xref>) by using the chi-square test and Fisher’s exact test. To focus on comorbidities that were essential and recorded in adequate individuals in our study population, we excluded comorbidities recorded in &lt;1% of the patients in the PDA or non-PDA group. The analysis-ready data generated by <monospace>groupedDataLongToWide</monospace> can be passed to the tableone (<xref rid="ref-35" ref-type="bibr">Yoshida &amp; Bartel, 2020</xref>) package to create objects summarizing all comorbidities stratified by patients with and without PDA and by performing the statistical chi-square tests. The AHRQ comorbidity table revealed 8 of the 16 statistically significant comorbidities (<italic>p</italic> &lt; 0.05, <xref rid="table-4" ref-type="table">Table 4</xref>) among patients with and without PDA, and the comorbidities are visualized in <xref ref-type="fig" rid="fig-2">Fig. 2</xref>.</p>
      <fig id="fig-2" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerjcs.520/fig-2</object-id>
        <label>Figure 2</label>
        <caption>
          <title>Bar chart to visualize the statistically significant difference of diagnostic categories between patients with and without PDA, grouped by the AHRQ-defined comorbidities.</title>
          <p>PDA, patent ductus arteriosus; AHRQ, Agency for Healthcare Research and Quality; FluidsLytes, Fluid and electrolyte disorders; Valvular: valvular disease; CHF, congestive heart failure; HTN, hypertension, uncomplicated; Hypothyroid: hypothyroidism; NeuroOther, other neurological disorders; PHTN, pulmonary circulation disorders.</p>
        </caption>
        <graphic xlink:href="peerj-cs-07-520-g002"/>
      </fig>
      <table-wrap id="table-4" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerjcs.520/table-4</object-id>
        <label>Table 4</label>
        <caption>
          <title>Summary of AHRQ-defined comorbidities based on the tableone package using the integrated data generated by the <italic>dxpr</italic> package.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="peerj-cs-07-520-g006"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th rowspan="1" colspan="1">
                  <bold>AHRQ</bold>
                  <xref ref-type="fn" rid="table-4fn1">
                    <sup>a</sup>
                  </xref>
                  <bold>Comorbidities</bold>
                </th>
                <th rowspan="1" colspan="1">
                  <bold>Non-PDA</bold>
                </th>
                <th rowspan="1" colspan="1">
                  <bold>PDA</bold>
                  <xref ref-type="fn" rid="table-4fn2">
                    <sup>b</sup>
                  </xref>
                </th>
                <th rowspan="1" colspan="1">
                  <bold>p</bold>
                </th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1">
                  <italic>n</italic>
                </td>
                <td rowspan="1" colspan="1">7452</td>
                <td rowspan="1" colspan="1">381</td>
                <td rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Coagulopathy (%)</td>
                <td rowspan="1" colspan="1">7 (0.1)</td>
                <td rowspan="1" colspan="1">4 (1.0)</td>
                <td rowspan="1" colspan="1">&lt;0.001</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Congestive heart failure (%)</td>
                <td rowspan="1" colspan="1">4 (0.1)</td>
                <td rowspan="1" colspan="1">9 (2.4)</td>
                <td rowspan="1" colspan="1">&lt;0.001</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Deficiency anemias (%)</td>
                <td rowspan="1" colspan="1">2 (0.0)</td>
                <td rowspan="1" colspan="1">1 (0.3)</td>
                <td rowspan="1" colspan="1">0.342</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Depression (%)</td>
                <td rowspan="1" colspan="1">1 (0.0)</td>
                <td rowspan="1" colspan="1">0 (0.0)</td>
                <td rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Diabetes, complicated (%)</td>
                <td rowspan="1" colspan="1">2 (0.0)</td>
                <td rowspan="1" colspan="1">0 (0.0)</td>
                <td rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Fluid and electrolye disorders (%)</td>
                <td rowspan="1" colspan="1">43 (0.6)</td>
                <td rowspan="1" colspan="1">19 (5.0)</td>
                <td rowspan="1" colspan="1">&lt;0.001</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Hypertension, complicated (%)</td>
                <td rowspan="1" colspan="1">2 (0.0)</td>
                <td rowspan="1" colspan="1">0 (0.0)</td>
                <td rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Hypertension, uncomplicated (%)</td>
                <td rowspan="1" colspan="1">6 (0.1)</td>
                <td rowspan="1" colspan="1">6 (1.6)</td>
                <td rowspan="1" colspan="1">&lt;0.001</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Hypothyroidism (%)</td>
                <td rowspan="1" colspan="1">5 (0.1)</td>
                <td rowspan="1" colspan="1">5 (1.3)</td>
                <td rowspan="1" colspan="1">&lt;0.001</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Other neurological disorders (%)</td>
                <td rowspan="1" colspan="1">4 (0.1)</td>
                <td rowspan="1" colspan="1">4 (1.0)</td>
                <td rowspan="1" colspan="1">&lt;0.001</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Peripheral vascular disorders (%)</td>
                <td rowspan="1" colspan="1">1 (0.0)</td>
                <td rowspan="1" colspan="1">0 (0.0)</td>
                <td rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Pulmonary circulation disorders (%)</td>
                <td rowspan="1" colspan="1">1 (0.0)</td>
                <td rowspan="1" colspan="1">3 (0.8)</td>
                <td rowspan="1" colspan="1">&lt;0.001</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Renal failure (%)</td>
                <td rowspan="1" colspan="1">1 (0.0)</td>
                <td rowspan="1" colspan="1">0 (0.0)</td>
                <td rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Solid tumor without metastasis (%)</td>
                <td rowspan="1" colspan="1">1 (0.0)</td>
                <td rowspan="1" colspan="1">0 (0.0)</td>
                <td rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Valvular disease (%)</td>
                <td rowspan="1" colspan="1">10 (0.1)</td>
                <td rowspan="1" colspan="1">5 (1.3)</td>
                <td rowspan="1" colspan="1">&lt;0.001</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Weight loss (%)</td>
                <td rowspan="1" colspan="1">2 (0.0)</td>
                <td rowspan="1" colspan="1">0 (0.0)</td>
                <td rowspan="1" colspan="1">1</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="table-4fn">
            <p>
              <bold>Notes.</bold>
            </p>
          </fn>
          <fn id="table-4fn1">
            <label>a</label>
            <p>AHRQ: Agency for Healthcare Research and Quality.</p>
          </fn>
          <fn id="table-4fn2">
            <label>b</label>
            <p>PDA: patent ductus arteriosus.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>Performance</title>
      <p>For a simulated dataset of 953,294 unique patients and 7,948,418 admission records, code grouping with CCS-defined comorbidities required 149 ± 2.48 s (including code transformation). Case selection required 238 ± 3.05 s to query patients with diseases of the urinary system, eligible period identification required 1.12 ± 0.22 s to find the first and last admission date for each patient, data splitting with the first admission date for each patient required 6.50 ± 0.42 s, condition era generation required 372 ± 6.39 s, and analysis-ready data generation required 3.75 ± 0.27 s.</p>
    </sec>
  </sec>
  <sec>
    <title>Discussion and Conclusions</title>
    <p>The <italic>dxpr</italic> package considerably simplifies the extraction, accelerates the processing of clinical data research, and enables researchers to prepare analysis-ready data with a standard workflow. The package had been developed and tested using structured clinical data, such as critical care data (MIMIC-III (<xref rid="ref-15" ref-type="bibr">Johnson et al., 2016</xref>)), a multi-institutional medical care database (Chang Gung Research Database (<xref rid="ref-25" ref-type="bibr">Tsai et al., 2017</xref>; <xref rid="ref-28" ref-type="bibr">Tseng et al., 2020</xref>)), and claims data (National Health Insurance Research Database (<xref rid="ref-13" ref-type="bibr">Hsieh et al., 2019</xref>)), indicating that the package can be applied to data from different countries, institutions, and data structures. The available functions are summarized in <xref rid="table-5" ref-type="table">Table 5</xref>.</p>
    <table-wrap id="table-5" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.7717/peerjcs.520/table-5</object-id>
      <label>Table 5</label>
      <caption>
        <title>Functions in the <italic>dxpr</italic> package.</title>
      </caption>
      <alternatives>
        <graphic xlink:href="peerj-cs-07-520-g007"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col span="1"/>
            <col span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">
                <bold>Functions</bold>
              </th>
              <th rowspan="1" colspan="1">
                <bold>Descriptions</bold>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="2" rowspan="1">
                <bold>I. Data integration</bold>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">icdDxShortToDecimal</td>
              <td rowspan="1" colspan="1">Transform ICD<xref ref-type="fn" rid="table-5fn1"><sup>a</sup></xref> diagnostic codes into decimal format</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">icdDxDecimalToShort</td>
              <td rowspan="1" colspan="1">Transform ICD diagnostic codes into short format</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">icdDxToCCS</td>
              <td rowspan="1" colspan="1">Group ICD diagnostic codes into single CCS<xref ref-type="fn" rid="table-5fn2"><sup>b</sup></xref> category</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">icdDxToCCSLvl</td>
              <td rowspan="1" colspan="1">Group ICD diagnostic codes into multiple CCS category</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">icdDxToComorbid</td>
              <td rowspan="1" colspan="1">Group ICD diagnostic codes into comorbidity category (Elixhauser, Charlson, and AHRQ)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">icdDxToPheWAS</td>
              <td rowspan="1" colspan="1">Group ICD diagnostic codes into PheWAS<xref ref-type="fn" rid="table-5fn3"><sup>c</sup></xref> category</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">icdDxToCustom</td>
              <td rowspan="1" colspan="1">Group ICD diagnostic codes into customized grouping category based on precise method</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">icdDxToCustomGrep</td>
              <td rowspan="1" colspan="1">Group ICD diagnostic codes into customized grouping category based on fuzzy method</td>
            </tr>
            <tr>
              <td colspan="2" rowspan="1">
                <bold>II. Data Wrangling</bold>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">selectCases</td>
              <td rowspan="1" colspan="1">Query matching cases in the EHR<xref ref-type="fn" rid="table-5fn4"><sup>d</sup></xref> data</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">splitDataByDate</td>
              <td rowspan="1" colspan="1">Query data by a clinical event</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">patientRecordDate</td>
              <td rowspan="1" colspan="1">Query the earliest/latest admission date for each patient.</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">getConditionEra</td>
              <td rowspan="1" colspan="1">Calculate condition era by grouped categories of each patient.</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">groupedDataLongToWide</td>
              <td rowspan="1" colspan="1">Convert long format of grouped data into wide format for analytical and plotting functions</td>
            </tr>
            <tr>
              <td colspan="2" rowspan="1">
                <bold>III. Visualization</bold>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">plotICDError</td>
              <td rowspan="1" colspan="1">Pareto chart of error ICD list</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">plotDiagCat</td>
              <td rowspan="1" colspan="1">Bar chart of diagnostic categories</td>
            </tr>
            <tr>
              <td colspan="2" rowspan="1">
                <bold>Procedure</bold>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">icdPrToCCS</td>
              <td rowspan="1" colspan="1">Group ICD procedure codes into single CCS category</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">icdPrToCCSLvl</td>
              <td rowspan="1" colspan="1">Group ICD procedure codes into multiple CCS category</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">icdPrToProcedureClass</td>
              <td rowspan="1" colspan="1">Group ICD procedure codes into procedure class category</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="table-5fn">
          <p>
            <bold>Notes.</bold>
          </p>
        </fn>
        <fn id="table-5fn1">
          <label>a</label>
          <p>ICD, International Classification of Diseases.</p>
        </fn>
        <fn id="table-5fn2">
          <label>b</label>
          <p>CCS, Clinical Classifications Software.</p>
        </fn>
        <fn id="table-5fn3">
          <label>c</label>
          <p>PheWAS, Phenome Wide Association Studies.</p>
        </fn>
        <fn id="table-5fn4">
          <label>d</label>
          <p>EHR, Electronic Health Record.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>Several software and packages were developed to facilitate clinical data analysis. rEHR (<xref rid="ref-24" ref-type="bibr">Springate et al., 2017</xref>) established a clinical data analysis workflow to simplify the processing of EHR. The rEHR package simplifies the process of extracting data from EHR databases. It used the database backend that can accelerate data access and process times. However, this design needs database backend, which might not be suitable in many circumstances. Furthermore, the international diagnosis coding standard, such as ICD, were not used in the package. The ICD (<xref rid="ref-31" ref-type="bibr">Wasey &amp; Lang, 2020</xref>) package is designed for calculating comorbidities and medical risk scores with ICD-9 and ICD-10 codes. It is helpful to group ICD codes according to comorbidities. However, in clinical data analysis, eligible case selection, data split based on the defined index date, and visualization are also essential. Therefore, we designed and developed the <italic>dxpr</italic> package to facilitate diagnosis data analysis.</p>
    <p>The proposed package has limitations, which come from either the data or package itself. For analyzing clinical data, the <italic>dxpr</italic> package highly depends on diagnosis and procedure codes, but these codes may vary in accuracy across different institutions. Furthermore, the effect of switching diagnosis codes from ICD-9 to ICD-10 should be considered if the analysis period is across the switching date. In addition to diagnosis and procedure data, the other data not included in proposed packages, such as medication data, are important in clinical data analysis projects. In the R ecosystem, the AdhereR (<xref rid="ref-3" ref-type="bibr">Dima &amp; Dediu, 2017</xref>) package implements a set of functions that are consistent with current adherence guidelines and definitions. Fourth, we provide an easy-to-use package that will help analysts process raw data and notify them when potential coding errors exist. However, even with this package, analysts should understand their data precisely. This easy-to-use package will help analysts process clinical data with its coding error–checking functions, but may also lead naïve analysts to miss opportunities to find other errors in the data. Finally, the <italic>dxpr</italic> package is focused on analysis-ready data generation so that the statistic method incorporation may be insufficient. However, the R ecosystem’s most significant advantage is that many well-developed packages were developed to facilitate statistical analysis. In the use case demonstration, our package can be used with other packages, such as tableone package. The tableone (<xref rid="ref-35" ref-type="bibr">Yoshida &amp; Bartel, 2020</xref>) package is developed to ease the construction of the common “Table 1” in research papers, providing patient baseline characteristics table with summary statistics and hypothesis tests.</p>
    <p>We demonstrated that the <italic>dxpr</italic> package can play an essential role in complex clinical data preprocessing and analysis-ready data generation through integrating the international standard of clinical data. This package helps clinical data analysts combat the common bottleneck caused by certain clinical data characteristics, such as heterogeneity and sparseness.</p>
  </sec>
</body>
<back>
  <ack>
    <p>We thank Ru-Fang Hu, Yi-An Zhu, and Chia-Wei Chang, from Department of Information Management, Chang Gung University, for testing the <italic>dxpr</italic> package. This manuscript was edited by Wallace Academic Editing.</p>
  </ack>
  <sec sec-type="additional-information">
    <title>Additional Information and Declarations</title>
    <fn-group content-type="competing-interests">
      <title>Competing Interests</title>
      <fn id="conflict-1" fn-type="COI-statement">
        <p>The authors declare there are no competing interests.</p>
      </fn>
    </fn-group>
    <fn-group content-type="author-contributions">
      <title>Author Contributions</title>
      <fn id="contribution-1" fn-type="con">
        <p><xref ref-type="contrib" rid="author-1">Yi-Ju Tseng</xref> conceived and designed the experiments, performed the experiments, analyzed the data, performed the computation work, authored or reviewed drafts of the paper, and approved the final draft.</p>
      </fn>
      <fn id="contribution-2" fn-type="con">
        <p><xref ref-type="contrib" rid="author-2">Hsiang-Ju Chiu</xref> and <xref ref-type="contrib" rid="author-3">Chun Ju Chen</xref> conceived and designed the experiments, analyzed the data, performed the computation work, prepared figures and/or tables, authored or reviewed drafts of the paper, and approved the final draft.</p>
      </fn>
    </fn-group>
    <fn-group content-type="other">
      <title>Data Availability</title>
      <fn id="addinfo-1">
        <p>The following information was supplied regarding data availability:</p>
        <p>The sample code of the dxpr package is available at GitHub:</p>
        <p>
          <ext-link ext-link-type="uri" xlink:href="https://github.com/DHLab-TSENG/dxpr-paper/blob/main/SampleCode.md">https://github.com/DHLab-TSENG/dxpr-paper/blob/main/SampleCode.md</ext-link>
        </p>
        <p>A detailed example of the usage of the dxpr package is available at GitHub:</p>
        <p>
          <ext-link ext-link-type="uri" xlink:href="https://github.com/DHLab-TSENG/dxpr-paper/blob/main/Supplement.md">https://github.com/DHLab-TSENG/dxpr-paper/blob/main/Supplement.md</ext-link>
        </p>
        <p>The source code of the dxpr package is available at GitHub:</p>
        <p><ext-link ext-link-type="uri" xlink:href="https://github.com/DHLab-TSENG/dxpr">https://github.com/DHLab-TSENG/dxpr</ext-link>.</p>
      </fn>
    </fn-group>
  </sec>
  <ref-list content-type="authoryear">
    <title>References</title>
    <ref id="ref-1">
      <label>Chen et al. (2010)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Khan</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Walker</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Quan</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <year>2010</year>
        <article-title>Validating ICD coding algorithms for diabetes mellitus from administrative data</article-title>
        <source>Diabetes Research and Clinical Practice</source>
        <volume>89</volume>
        <fpage>189</fpage>
        <lpage>195</lpage>
        <pub-id pub-id-type="doi">10.1016/j.diabres.2010.03.007</pub-id>
        <pub-id pub-id-type="pmid">20363043</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-2">
      <label>Denny et al. (2010)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Denny</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Ritchie</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Basford</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Pulley</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Bastarache</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Brown-Gentry</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Masys</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Roden</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Crawford</surname>
            <given-names>DC</given-names>
          </name>
        </person-group>
        <year>2010</year>
        <article-title>PheWAS: demonstrating the feasibility of a phenome-wide scan to discover gene-disease associations</article-title>
        <source>Bioinformatics</source>
        <volume>26</volume>
        <fpage>1205</fpage>
        <lpage>1210</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq126</pub-id>
        <pub-id pub-id-type="pmid">20335276</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-3">
      <label>Dima &amp; Dediu (2017)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dima</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Dediu</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <year>2017</year>
        <article-title>Computation of adherence to medication and visualization of medication histories in R with AdhereR: towards transparent and reproducible use of electronic healthcare data</article-title>
        <source>PLOS ONE</source>
        <volume>12</volume>
        <elocation-id>e0174426</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0174426</pub-id>
        <pub-id pub-id-type="pmid">28445530</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-4">
      <label>Elixhauser et al. (1998)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Elixhauser</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Steiner</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Coffey</surname>
            <given-names>RM</given-names>
          </name>
        </person-group>
        <year>1998</year>
        <article-title>Comorbidity measures for use with administrative data</article-title>
        <source>Medical Care</source>
        <volume>36</volume>
        <fpage>8</fpage>
        <lpage>27</lpage>
        <pub-id pub-id-type="doi">10.1097/00005650-199801000-00004</pub-id>
        <pub-id pub-id-type="pmid">9431328</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-5">
      <label>Fleurence et al. (2014)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fleurence</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Curtis</surname>
            <given-names>LH</given-names>
          </name>
          <name>
            <surname>Califf</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Platt</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Selby</surname>
            <given-names>JV</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <year>2014</year>
        <article-title>Launching PCORnet, a national patient-centered clinical research network</article-title>
        <source>Journal of the American Medical Informatics Association</source>
        <volume>21</volume>
        <fpage>578</fpage>
        <lpage>582</lpage>
        <pub-id pub-id-type="doi">10.1136/amiajnl-2014-002747</pub-id>
        <pub-id pub-id-type="pmid">24821743</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-6">
      <label>HCUP (2016)</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <collab>Healthcare Cost and Utilization Project (HCUP)</collab>
        </person-group>
        <year>2016</year>
        <article-title>HCUP Procedure Classes</article-title>
        <uri xlink:href="https://www.hcup-us.ahrq.gov/toolssoftware/procedure/procedure.jsp">https://www.hcup-us.ahrq.gov/toolssoftware/procedure/procedure.jsp</uri>
      </element-citation>
    </ref>
    <ref id="ref-7">
      <label>HCUP (2017)</label>
      <element-citation publication-type="software">
        <person-group person-group-type="author">
          <collab>Healthcare Cost and Utilization Project (HCUP)</collab>
        </person-group>
        <year>2017</year>
        <data-title>Clinical Classifications Software (CCS) for ICD-9-CM</data-title>
        <uri xlink:href="https://www.hcup-us.ahrq.gov/toolssoftware/ccs/ccs.jsp">https://www.hcup-us.ahrq.gov/toolssoftware/ccs/ccs.jsp</uri>
        <date-in-citation content-type="access-date" iso-8601-date="2017-10-08">8 October 2017</date-in-citation>
      </element-citation>
    </ref>
    <ref id="ref-8">
      <label>HCUP (2019a)</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <collab>Healthcare Cost and Utilization Project (HCUP)</collab>
        </person-group>
        <year>2019a</year>
        <article-title>Beta Elixhauser Comorbidity Software for ICD-10-CM</article-title>
        <uri xlink:href="https://www.hcup-us.ahrq.gov/toolssoftware/comorbidityicd10/comorbidity_icd10.jsp"> https://www.hcup-us.ahrq.gov/toolssoftware/comorbidityicd10/comorbidity_icd10.jsp</uri>
      </element-citation>
    </ref>
    <ref id="ref-9">
      <label>HCUP (2019b)</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <collab>Healthcare Cost and Utilization Project (HCUP)</collab>
        </person-group>
        <year>2019b</year>
        <article-title>Beta Clinical Classifications Software (CCS) for ICD-10-CM/PCS</article-title>
        <uri xlink:href="https://www.hcup-us.ahrq.gov/toolssoftware/ccs10/ccs10.jsp">https://www.hcup-us.ahrq.gov/toolssoftware/ccs10/ccs10.jsp</uri>
      </element-citation>
    </ref>
    <ref id="ref-10">
      <label>Hersh (2007)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hersh</surname>
            <given-names>WR</given-names>
          </name>
        </person-group>
        <year>2007</year>
        <article-title>Adding value to the electronic health record through secondary use of data for quality assurance, research, and surveillance</article-title>
        <source>American Journal of Managed Care</source>
        <volume>13</volume>
        <fpage>277</fpage>
        <lpage>278</lpage>
        <pub-id pub-id-type="doi">10.1001/jama.229.4.457</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-11">
      <label>Hester &amp; Wickham (2021)</label>
      <element-citation publication-type="software">
        <person-group person-group-type="author">
          <name>
            <surname>Hester</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wickham</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <year>2021</year>
        <data-title>odbc: Connect to ODBC Compatible Databases (using the DBI Interface)</data-title>
        <uri xlink:href="https://cran.r-project.org/package=odbc">https://cran.r-project.org/package=odbc</uri>
        <date-in-citation content-type="access-date" iso-8601-date="2021-02-23">23 February 2021</date-in-citation>
      </element-citation>
    </ref>
    <ref id="ref-12">
      <label>Hripcsak &amp; Albers (2013)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hripcsak</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Albers</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <year>2013</year>
        <article-title>Next-generation phenotyping of electronic health records</article-title>
        <source>Journal of the American Medical Informatics Association</source>
        <volume>20</volume>
        <fpage>117</fpage>
        <lpage>121</lpage>
        <pub-id pub-id-type="doi">10.1136/amiajnl-2012-001145</pub-id>
        <pub-id pub-id-type="pmid">22955496</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-13">
      <label>Hsieh et al. (2019)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hsieh</surname>
            <given-names>C-Y</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>C-C</given-names>
          </name>
          <name>
            <surname>Shao</surname>
            <given-names>S-C</given-names>
          </name>
          <name>
            <surname>Sung</surname>
            <given-names>S-F</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>S-J</given-names>
          </name>
          <name>
            <surname>Yang Kao</surname>
            <given-names>Y-H</given-names>
          </name>
          <name>
            <surname>Lai</surname>
            <given-names>EC-C</given-names>
          </name>
        </person-group>
        <year>2019</year>
        <article-title>Taiwan’s National Health Insurance Research Database: past and future</article-title>
        <source>Clinical Epidemiology</source>
        <volume>11</volume>
        <fpage>349</fpage>
        <lpage>358</lpage>
        <pub-id pub-id-type="doi">10.2147/CLEP.S196293</pub-id>
        <pub-id pub-id-type="pmid">31118821</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-14">
      <label>Jensen, Jensen &amp; Brunak (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jensen</surname>
            <given-names>PB</given-names>
          </name>
          <name>
            <surname>Jensen</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Brunak</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <year>2012</year>
        <article-title>Mining electronic health records: towards better research applications and clinical care</article-title>
        <source>Nature Reviews Genetics</source>
        <volume>13</volume>
        <fpage>395</fpage>
        <lpage>405</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg3208</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-15">
      <label>Johnson et al. (2016)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Johnson</surname>
            <given-names>AEW</given-names>
          </name>
          <name>
            <surname>Pollard</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Lehman</surname>
            <given-names>LH</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ghassemi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Moody</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Szolovits</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Anthony Celi</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Mark</surname>
            <given-names>RG</given-names>
          </name>
        </person-group>
        <year>2016</year>
        <article-title>MIMIC-III, a freely accessible critical care database</article-title>
        <source>Scientific Data</source>
        <volume>3</volume>
        <fpage>160035</fpage>
        <pub-id pub-id-type="doi">10.1038/sdata.2016.35</pub-id>
        <pub-id pub-id-type="pmid">27219127</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-16">
      <label>Menendez et al. (2014)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Menendez</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Neuhaus</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Van Dijk</surname>
            <given-names>CN</given-names>
          </name>
          <name>
            <surname>Ring</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <year>2014</year>
        <article-title>The Elixhauser comorbidity method outperforms the Charlson index in predicting inpatient death after orthopaedic surgery</article-title>
        <source>Clinical Orthopaedics and Related Research</source>
        <volume>472</volume>
        <fpage>2878</fpage>
        <lpage>2886</lpage>
        <pub-id pub-id-type="doi">10.1007/s11999-014-3686-7</pub-id>
        <pub-id pub-id-type="pmid">24867450</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-17">
      <label>Miotto &amp; Weng (2015)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miotto</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Weng</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <year>2015</year>
        <article-title>Case-based reasoning using electronic health records efficiently identifies eligible patients for clinical trials</article-title>
        <source>Journal of the American Medical Informatics Association</source>
        <volume>22</volume>
        <fpage>e141</fpage>
        <lpage>e150</lpage>
        <pub-id pub-id-type="doi">10.1093/jamia/ocu050</pub-id>
        <pub-id pub-id-type="pmid">25769682</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-18">
      <label>Moore et al. (2017)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moore</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Washington</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Coenen</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Elixhauser</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <year>2017</year>
        <article-title>Identifying increased risk of readmission and in-hospital mortality using hospital administrative data</article-title>
        <source>Medical Care</source>
        <volume>55</volume>
        <fpage>698</fpage>
        <lpage>705</lpage>
        <pub-id pub-id-type="doi">10.1097/MLR.0000000000000735</pub-id>
        <pub-id pub-id-type="pmid">28498196</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-19">
      <label>Observational Health Data Sciences and Informatics (2020)</label>
      <element-citation publication-type="software">
        <person-group person-group-type="author">
          <collab>Observational Health Data Sciences and Informatics</collab>
        </person-group>
        <year>2020</year>
        <data-title>OMOP Common Data Model</data-title>
        <uri xlink:href="https://www.ohdsi.org/data-standardization/the-common-data-model/">https://www.ohdsi.org/data-standardization/the-common-data-model/</uri>
        <date-in-citation content-type="access-date" iso-8601-date="2020-07-28">28 July 2020</date-in-citation>
      </element-citation>
    </ref>
    <ref id="ref-20">
      <label>PCORnet (2020)</label>
      <element-citation publication-type="software">
        <person-group person-group-type="author">
          <collab>PCORnet</collab>
        </person-group>
        <year>2020</year>
        <data-title>PCORnet Common Data Model (CDM)</data-title>
        <uri xlink:href="https://pcornet.org/data-driven-common-model/">https://pcornet.org/data-driven-common-model/</uri>
        <date-in-citation content-type="access-date" iso-8601-date="2020-07-28">28 July 2020</date-in-citation>
      </element-citation>
    </ref>
    <ref id="ref-21">
      <label>R Special Interest Group on Databases R-SIG-DB, Wickham &amp; Müller (2021)</label>
      <element-citation publication-type="software">
        <person-group person-group-type="author">
          <collab>R Special Interest Group on Databases (R-SIG-DB)</collab>
          <name>
            <surname>Wickham</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <year>2021</year>
        <data-title>DBI: R Database Interface</data-title>
        <uri xlink:href="https://cran.r-project.org/package=DBI">https://cran.r-project.org/package=DBI</uri>
        <date-in-citation content-type="access-date" iso-8601-date="2021-02-23">23 February 2021</date-in-citation>
      </element-citation>
    </ref>
    <ref id="ref-22">
      <label>Raghupathi &amp; Raghupathi (2014)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Raghupathi</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Raghupathi</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <year>2014</year>
        <article-title>Big data analytics in healthcare: promise and potential</article-title>
        <source>Health Information Science and Systems</source>
        <volume>2</volume>
        <fpage>3</fpage>
        <pub-id pub-id-type="doi">10.1186/2047-2501-2-3</pub-id>
        <pub-id pub-id-type="pmid">25825667</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-23">
      <label>Reisinger et al. (2010)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reisinger</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Ryan</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>O’Hara</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Powell</surname>
            <given-names>GE</given-names>
          </name>
          <name>
            <surname>Painter</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Pattishall</surname>
            <given-names>EN</given-names>
          </name>
          <name>
            <surname>Morris</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <year>2010</year>
        <article-title>Development and evaluation of a common data model enabling active drug safety surveillance using disparate healthcare databases</article-title>
        <source>Journal of the American Medical Informatics Association</source>
        <volume>17</volume>
        <fpage>652</fpage>
        <lpage>662</lpage>
        <pub-id pub-id-type="doi">10.1136/jamia.2009.002477</pub-id>
        <pub-id pub-id-type="pmid">20962127</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-24">
      <label>Springate et al. (2017)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Springate</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Parisi</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Olier</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Reeves</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Kontopantelis</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <year>2017</year>
        <article-title>rEHR: An R package for manipulating and analysing electronic health record data</article-title>
        <source>PLOS ONE</source>
        <volume>12</volume>
        <elocation-id>e0171784</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0171784</pub-id>
        <pub-id pub-id-type="pmid">28231289</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-25">
      <label>Tsai et al. (2017)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tsai</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>CP</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>YH</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>WC</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>GH</given-names>
          </name>
          <name>
            <surname>Te Tsai</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Tsai</surname>
            <given-names>YH</given-names>
          </name>
        </person-group>
        <year>2017</year>
        <article-title>Chang Gung Research Database: a multi-institutional database consisting of original medical records</article-title>
        <source>Biomedical Journal</source>
        <volume>40</volume>
        <fpage>263</fpage>
        <lpage>269</lpage>
        <pub-id pub-id-type="doi">10.1016/j.bj.2017.08.002</pub-id>
        <pub-id pub-id-type="pmid">29179881</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-26">
      <label>Tseng et al. (2015)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tseng</surname>
            <given-names>Y-J</given-names>
          </name>
          <name>
            <surname>Cami</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Goldmann</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>DeMaria</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mandl</surname>
            <given-names>KD</given-names>
          </name>
        </person-group>
        <year>2015</year>
        <article-title>Incidence and patterns of extended-course antibiotic therapy in patients evaluated for lyme disease</article-title>
        <source>Clinical Infectious Diseases</source>
        <volume>61</volume>
        <fpage>1536</fpage>
        <lpage>1542</lpage>
        <pub-id pub-id-type="doi">10.1093/cid/civ636</pub-id>
        <pub-id pub-id-type="pmid">26223992</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-27">
      <label>Tseng et al. (2017)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tseng</surname>
            <given-names>Y-J</given-names>
          </name>
          <name>
            <surname>DeMaria</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Goldmann</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Mandl</surname>
            <given-names>KD</given-names>
          </name>
        </person-group>
        <year>2017</year>
        <article-title>Claims-based diagnostic patterns of patients evaluated for lyme disease and given extended antibiotic therapy</article-title>
        <source>Vector-Borne and Zoonotic Diseases</source>
        <volume>17</volume>
        <fpage>116</fpage>
        <lpage>122</lpage>
        <pub-id pub-id-type="doi">10.1089/vbz.2016.1991</pub-id>
        <pub-id pub-id-type="pmid">27855040</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-28">
      <label>Tseng et al. (2020)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tseng</surname>
            <given-names>Y-J</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>R-F</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>S-T</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>Y-L</given-names>
          </name>
          <name>
            <surname>Hsu</surname>
            <given-names>C-L</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>S-W</given-names>
          </name>
          <name>
            <surname>Liou</surname>
            <given-names>C-W</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>J-D</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>T-I</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>T-H</given-names>
          </name>
        </person-group>
        <year>2020</year>
        <article-title>Risk factors associated with outcomes of recombinant tissue plasminogen activator therapy in patients with acute ischemic stroke</article-title>
        <source>International Journal of Environmental Research and Public Health</source>
        <volume>17</volume>
        <fpage>618</fpage>
        <pub-id pub-id-type="doi">10.3390/ijerph17020618</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-29">
      <label>US Centers for Medicare &amp; Medicaid Services (2017b)</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <collab>US Centers for Medicare &amp; Medicaid Services</collab>
        </person-group>
        <year>2017b</year>
        <article-title>ICD-10</article-title>
        <uri xlink:href="https://www.cms.gov/Medicare/Coding/ICD10/index.html">https://www.cms.gov/Medicare/Coding/ICD10/index.html</uri>
        <date-in-citation content-type="access-date" iso-8601-date="2017-10-08">8 October 2017</date-in-citation>
      </element-citation>
    </ref>
    <ref id="ref-30">
      <label>US Centers for Medicare &amp; Medicaid Services (2017a)</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <collab>US Centers for Medicare &amp; Medicaid Services</collab>
        </person-group>
        <year>2017a</year>
        <article-title>ICD-10</article-title>
        <uri xlink:href="https://www.cms.gov/Medicare/Coding/ICD9ProviderDiagnosticCodes/codes.html">https://www.cms.gov/Medicare/Coding/ICD9ProviderDiagnosticCodes/codes.html</uri>
        <date-in-citation content-type="access-date" iso-8601-date="2017-10-08">8 October 2017</date-in-citation>
      </element-citation>
    </ref>
    <ref id="ref-31">
      <label>Wasey &amp; Lang (2020)</label>
      <element-citation publication-type="software">
        <person-group person-group-type="author">
          <name>
            <surname>Wasey</surname>
            <given-names>JO</given-names>
          </name>
          <name>
            <surname>Lang</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <year>2020</year>
        <data-title>icd: Comorbidity Calculations and Tools for ICD-9 and ICD-10 Codes</data-title>
        <uri xlink:href="https://cran.r-project.org/web/packages/icd/index.html">https://cran.r-project.org/web/packages/icd/index.html</uri>
        <date-in-citation content-type="access-date" iso-8601-date="2020-07-28">28 July 2020</date-in-citation>
      </element-citation>
    </ref>
    <ref id="ref-32">
      <label>Weiskopf &amp; Weng (2013)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weiskopf</surname>
            <given-names>NG</given-names>
          </name>
          <name>
            <surname>Weng</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <year>2013</year>
        <article-title>Methods and dimensions of electronic health record data quality assessment: enabling reuse for clinical research</article-title>
        <source>Journal of the American Medical Informatics Association</source>
        <volume>20</volume>
        <fpage>144</fpage>
        <lpage>151</lpage>
        <pub-id pub-id-type="doi">10.1136/amiajnl-2011-000681</pub-id>
        <pub-id pub-id-type="pmid">22733976</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-33">
      <label>Wickham, Hester &amp; Chang (2020)</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Wickham</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Hester</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <year>2020</year>
        <article-title>devtools: Tools to Make Developing R Packages Easier</article-title>
        <uri xlink:href="https://cran.r-project.org/package=devtools">https://cran.r-project.org/package=devtools</uri>
      </element-citation>
    </ref>
    <ref id="ref-34">
      <label>Wu, Roy &amp; Stewart (2010)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Roy</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Stewart</surname>
            <given-names>WF</given-names>
          </name>
        </person-group>
        <year>2010</year>
        <article-title>Prediction modeling using EHR data: challenges, strategies, and a comparison of machine learning approaches</article-title>
        <source>Medical Care</source>
        <volume>48</volume>
        <issue>6 Suppl</issue>
        <fpage>S106</fpage>
        <lpage>S113</lpage>
        <pub-id pub-id-type="doi">10.1097/MLR.0b013e3181de9e17</pub-id>
        <pub-id pub-id-type="pmid">20473190</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-35">
      <label>Yoshida &amp; Bartel (2020)</label>
      <element-citation publication-type="software">
        <person-group person-group-type="author">
          <name>
            <surname>Yoshida</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bartel</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <year>2020</year>
        <data-title>tableone: Create Table 1’ to Describe baseline characteristics with or without propensity score weights</data-title>
        <uri xlink:href="https://cran.rproject.org/package=tableone">https://cran.rproject.org/package=tableone</uri>
      </element-citation>
    </ref>
  </ref-list>
</back>
