<?DTDIdentifier.IdentifierValue -//NPG//DTD XML Article//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName NPG_XML_Article.dtd?>
<?SourceDTD.Version 2.7.10?>
<?ConverterInfo.XSLTName nature2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Sci Rep</journal-id>
    <journal-id journal-id-type="iso-abbrev">Sci Rep</journal-id>
    <journal-title-group>
      <journal-title>Scientific Reports</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2045-2322</issn>
    <publisher>
      <publisher-name>Nature Publishing Group</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4548254</article-id>
    <article-id pub-id-type="pii">srep13443</article-id>
    <article-id pub-id-type="doi">10.1038/srep13443</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CADBURE: A generic tool to evaluate the performance of spliced aligners on RNA-Seq data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Kumar</surname>
          <given-names>Praveen Kumar Raj</given-names>
        </name>
        <xref ref-type="aff" rid="a1">1</xref>
        <xref ref-type="author-notes" rid="n1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hoang</surname>
          <given-names>Thanh V.</given-names>
        </name>
        <xref ref-type="aff" rid="a1">1</xref>
        <xref ref-type="author-notes" rid="n1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Robinson</surname>
          <given-names>Michael L.</given-names>
        </name>
        <xref ref-type="aff" rid="a1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tsonis</surname>
          <given-names>Panagiotis A.</given-names>
        </name>
        <xref ref-type="aff" rid="a2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Liang</surname>
          <given-names>Chun</given-names>
        </name>
        <xref ref-type="corresp" rid="c1">a</xref>
        <xref ref-type="aff" rid="a1">1</xref>
        <xref ref-type="aff" rid="a3">3</xref>
      </contrib>
      <aff id="a1"><label>1</label><institution>Department of Biology, Miami University</institution>, Oxford, Ohio 45056, <country>USA</country></aff>
      <aff id="a2"><label>2</label><institution>Department of Biology and Center for Tissue Regeneration and Engineering, The University of Dayton</institution>, Dayton, OH 45469</aff>
      <aff id="a3"><label>3</label><institution>Department of Computer Sciences and Software Engineering, Miami University</institution>, Oxford, Ohio 45056, <country>USA</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="c1">
        <label>a</label>
        <email>liangc@miamioh.edu</email>
      </corresp>
      <fn id="n1">
        <label>*</label>
        <p>These authors contributed equally to this work.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>25</day>
      <month>08</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2015</year>
    </pub-date>
    <volume>5</volume>
    <elocation-id>13443</elocation-id>
    <history>
      <date date-type="received">
        <day>02</day>
        <month>11</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>31</day>
        <month>07</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2015, Macmillan Publishers Limited</copyright-statement>
      <copyright-year>2015</copyright-year>
      <copyright-holder>Macmillan Publishers Limited</copyright-holder>
      <license xmlns:xlink="http://www.w3.org/1999/xlink" license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <!--author-paid-->
        <license-p>This work is licensed under a Creative Commons Attribution 4.0 International License. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in the credit line; if the material is not included under the Creative Commons license, users will need to obtain permission from the license holder to reproduce the material. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p>
      </license>
    </permissions>
    <abstract>
      <p>The fundamental task in RNA-Seq-based transcriptome analysis is alignment of millions of short reads to the reference genome or transcriptome. Choosing the right tool for the dataset in hand from many existent RNA-Seq alignment packages remains a critical challenge for downstream analysis. To facilitate this choice, we designed a novel tool for comparing alignment results of user data based on the relative reliability of uniquely aligned reads (CADBURE). CADBURE can easily evaluate different aligners, or different parameter sets using the same aligner, and selects the best alignment result for any RNA-Seq dataset. Strengths of CADBURE include the ability to compare alignment results without the need for synthetic data such as simulated genomes, alignment regeneration and randomly subsampled datasets. The benefit of a CADBURE selected alignment result was supported by differentially expressed gene (DEG) analysis. We demonstrated that the use of CADBURE to select the best alignment from a number of different alignment results could change the number of DEGs by as much as 10%. In particular, the CADBURE selected alignment result favors fewer false positives in the DEG analysis. We also verified differential expression of eighteen genes with RT-qPCR validation experiments. CADBURE is an open source tool (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://cadbure.sourceforge.net/">http://cadbure.sourceforge.net/</ext-link>).</p>
    </abstract>
  </article-meta>
</front>
<body>
  <p>RNA-Seq analysis describes the collection of methods to characterize transcriptomes using high-throughput sequencing of abundant cDNA fragments<xref ref-type="bibr" rid="b1">1</xref><xref ref-type="bibr" rid="b2">2</xref>. The fundamental task in RNA-Seq-based transcriptome analysis is spliced alignment (called aligning or mapping) of short sequencing reads to the reference genome or transcriptome<xref ref-type="bibr" rid="b1">1</xref><xref ref-type="bibr" rid="b2">2</xref><xref ref-type="bibr" rid="b3">3</xref>. The complexities inherent in RNA-seq data require specialized tools (i.e., aligner) to map them to genome. RNA-seq data possesses many complexities like alternate splice isoforms that can contain many different combinations of exons transcribed from a gene<xref ref-type="bibr" rid="b2">2</xref><xref ref-type="bibr" rid="b4">4</xref>. As with many high-throughput sequencing technologies, the sequence fragments are short (35 nt to 100 nt), presenting considerable challenges to an aligner which must determine the unique mapping location among the many possible locations in the reference genome<xref ref-type="bibr" rid="b5">5</xref><xref ref-type="bibr" rid="b6">6</xref>. Furthermore, the reference genome is most often different than that of the actual biological source of RNAs being sequenced. Organism-specific sequence properties like repetitive sequences, gene structures, polymorphisms, and RNA polymerase fidelity compound the difficulty in achieving proper alignment of a given sequence read. In these circumstances, the aligner’s solution is often a compromise between the sensitivity and specificity provided an initial level of heuristic match<xref ref-type="bibr" rid="b2">2</xref><xref ref-type="bibr" rid="b7">7</xref><xref ref-type="bibr" rid="b8">8</xref><xref ref-type="bibr" rid="b9">9</xref><xref ref-type="bibr" rid="b10">10</xref><xref ref-type="bibr" rid="b11">11</xref>. This tradeoff in specificity and sensitivity makes an aligner work better on some datasets than others.</p>
  <p>In RNA-Seq projects, one major challenge is to choose a right mapping tool among many existing tools. Current tools available for mapping sequencing reads include GSNAP<xref ref-type="bibr" rid="b9">9</xref>, TopHat2<xref ref-type="bibr" rid="b8">8</xref>, CLC Genomics Workbench (CLC Bio-Qiagen, Aarhus, Denmark), MapSplice<xref ref-type="bibr" rid="b11">11</xref>, PALMapper<xref ref-type="bibr" rid="b12">12</xref>, STAR<xref ref-type="bibr" rid="b13">13</xref> to name a few (for an exhaustive list see<xref ref-type="bibr" rid="b14">14</xref>). Although many previous investigations compared different aligners<xref ref-type="bibr" rid="b3">3</xref><xref ref-type="bibr" rid="b8">8</xref><xref ref-type="bibr" rid="b9">9</xref><xref ref-type="bibr" rid="b11">11</xref><xref ref-type="bibr" rid="b13">13</xref><xref ref-type="bibr" rid="b15">15</xref>, to our knowledge, no single aligner demonstrates clear superiority in the critical performance metrics of speed, accuracy and correct mapping placement. Moreover, the performance of an aligner depends on specific properties of the dataset being analyzed. These properties include repeat content, intron-exon architecture, sequence polymorphisms such as insertions, deletions and mismatches, sequence coverage, and sequencing error rate<xref ref-type="bibr" rid="b2">2</xref><xref ref-type="bibr" rid="b3">3</xref>. As a result, aligner choice, or even the parameter set for a specific aligner needs to be evaluated in the context of the dataset of interest. This is not a trivial task since it may be impossible to <italic>a priori</italic> determine which aligner or parameter set best matches the real situation when evaluating an aligner or a parameter set on real data.</p>
  <p>A recently published alignment evaluation tool, ARDEN<xref ref-type="bibr" rid="b16">16</xref> proposes a solution to comparing aligners on a given dataset. However, ARDEN requires time-consuming genome simulation and random data subsampling in pre-processing steps. ARDEN also requires alignment regeneration against a simulated genome using the same parameter set used for generating the original alignments<xref ref-type="bibr" rid="b16">16</xref>. This step is impractical because genome-specific options of the original reference genome (e.g., gene-annotation guided mapping and SNP-tolerant mapping) cannot be used against a simulated genome. To create an easy-to-use mapping comparison utility that avoids time-consuming and complex pre-processing steps, we developed a tool for <underline>c</underline>omparing <underline>a</underline>lignment results of user <underline>d</underline>ata <underline>b</underline>ased on the relative reliability of <underline>u</underline>niquely aligned <underline>re</underline>ads (CADBURE). CADBURE (pronounced “Cadbury”) compares alignment results obtained from two different aligners or two different parameter sets of a single aligner. The alignment comparison in CADBURE is independent of the parameter set used, and does not require alignment regeneration, random dataset subsampling and genome simulation. CADBURE bases its alignment comparison on identifying the relative reliability of uniquely mapped reads between two different alignment results.</p>
  <p>The use of CADBURE was demonstrated by comparing alignment results of 6 RNA-Seq datasets<xref ref-type="bibr" rid="b17">17</xref> from two different mouse lens cell-types. CADBURE found the optimal alignment result among the 3 widely used splice alignment programs: two open source aligners GSNAP and TopHat2, and a commercial software package CLC Genomics Workbench. To demonstrate the reliability of CADBURE in selecting the optimal alignment result, we performed downstream analysis to compare the number of differentially expressed genes (DEGs) identified using the CADBURE selected alignment with alignments not selected by CADBURE. To decide on the method for DEG analysis, we used the CADBURE selected best alignment result to evaluate the performance of five popular tools for DEG analysis: (1) DESeq<xref ref-type="bibr" rid="b18">18</xref>, (2) DESeq2<xref ref-type="bibr" rid="b19">19</xref>, (3) Baggereley test, CLC version 6.5.1, (4) Empirical analysis of differential gene expression (EDGE), CLC version 7.0 and (5) Cuffdiff2<xref ref-type="bibr" rid="b20">20</xref>. To our knowledge, this is the first comparative evaluation involving DESeq2 and the popular commercial CLC software. The RT-qPCR verification of 18 DEGs in the datasets revealed that DESeq results closely correlated with RT-qPCR data. Hence, DESeq was selected for DEG analysis to demonstrate the reliability of the CADBURE selected alignment. Comparing the number of DEGs identified using the CADBURE selected alignment result versus other non-selected alignment results, we discovered differences of approximately 10% in the number of DEGs, which may be important in the biological context. Thus, CADBURE provides biologists with a novel, easy-to-use tool for comparing alignment results of a given RNA-Seq dataset in order to select the best or optimal alignment.</p>
  <sec disp-level="1" sec-type="results">
    <title>Results</title>
    <sec disp-level="2">
      <title>Design of CADBURE</title>
      <p>The purpose of CADBURE is to evaluate spliced aligner performance for user’s RNA-Seq data by comparing a pair of alignment results obtained either from two different aligners with the similar parameter set or from two different parameter sets with the same aligner. In alignment comparison, CADBURE determines the relative reliability of unambiguously (also called uniquely) aligned reads. These uniquely mapped reads form the primary input for downstream analysis in RNA-Seq projects<xref ref-type="bibr" rid="b1">1</xref><xref ref-type="bibr" rid="b2">2</xref><xref ref-type="bibr" rid="b21">21</xref><xref ref-type="bibr" rid="b22">22</xref>. In an alignment result, CADBURE defines the collection of uniquely mapped reads as a positive set and the collection of ambiguously (also called non-uniquely) mapped reads as a negative set in order to provide a discrete measure of specificity and accuracy (<xref ref-type="fig" rid="f1">Fig. 1a</xref>). Then, CADBURE determines true-positives and false-positives among the uniquely mapped reads (i.e. our positives) by evaluating the possible scenarios that can occur with respect to the relative mapping reliability. All the negatives (non-uniquely mapped reads) are assumed as true-negatives. It should be noted that we are not trying to find false negatives in the negatives set (non-unique mapping) because our focus is to find false positives only in the positive set (unique mapping), which is mostly used for downstream analysis in RNA-Seq studies<xref ref-type="bibr" rid="b1">1</xref><xref ref-type="bibr" rid="b2">2</xref><xref ref-type="bibr" rid="b21">21</xref><xref ref-type="bibr" rid="b22">22</xref>.</p>
      <p>As CADBURE compares the alignment of a given read by two different aligners, one of eight scenarios may occur, described below (<xref ref-type="fig" rid="f1">Fig. 1</xref>).</p>
    </sec>
    <sec disp-level="2">
      <title>Scenario 1 (mappings in the positive set)</title>
      <p>Whenever two different aligners uniquely map a particular read to the exact same location, CADBURE considers the result a true-positive mapping for an aligner (<xref ref-type="fig" rid="f1">Fig. 1b</xref>).</p>
    </sec>
    <sec disp-level="2">
      <title>Scenario 2 and 3 (mappings in the positive set)</title>
      <p>When two different aligners uniquely map a particular read to overlapping genomic locations, CADBURE distinguishes two scenarios.</p>
      <sec disp-level="3">
        <title>Scenario 2</title>
        <p>In this case, CADBURE considers the un-spliced alignment or splice alignment with overhang more than two nucleotides a true-positive mapping because all or most nucleotides are continuously mapped by both aligners on the same genome location. Therefore, this is a highly probable correct alignment for this read (see red arrow, <xref ref-type="fig" rid="f1">Fig. 1c</xref>).</p>
      </sec>
      <sec disp-level="3">
        <title>Scenario 3</title>
        <p>If the overhang of the spliced alignment is just one or two nucleotides, i.e., only one or two nucleotides are aligned across an intron, CADBURE considers the spliced alignment as a false-positive alignment, given the high probability that the alignment is misplaced (see blue arrow, <xref ref-type="fig" rid="f1">Fig. 1c</xref>).</p>
      </sec>
    </sec>
    <sec disp-level="2">
      <title>Scenario 4 (mappings in the positive set)</title>
      <p>If both aligners uniquely map a particular read to different genomic locations, CADBURE assigns the mapping as false-positive because both aligners missed the possible read mapping reported by the other aligner and incorrectly reported the alignment as unique (<xref ref-type="fig" rid="f1">Fig. 1d</xref>).</p>
    </sec>
    <sec disp-level="2">
      <title>Scenario 5 (mappings in the positive and negative set)</title>
      <p>If one aligner maps a particular read uniquely and the other aligner maps the same read non-uniquely, CADBURE considers the uniquely aligned read as a false-positive alignment and the non-uniquely mapped read as a true-negative, non-unique mapping (<xref ref-type="fig" rid="f1">Fig. 1e</xref>).</p>
    </sec>
    <sec disp-level="2">
      <title>Scenario 6 (mappings in the positive set)</title>
      <p>If only one of the two aligners uniquely maps a particular sequence read, and if the other aligner fails to map this read at all (either as unique or non-unique), CADBURE considers the unique mapping a true-positive alignment (<xref ref-type="fig" rid="f1">Fig. 1f</xref>).</p>
    </sec>
    <sec disp-level="2">
      <title>Scenario 7 (mappings in the negative set)</title>
      <p>If both aligners map a particular read non-uniquely, CADBURE calls the alignment a true-negative, non-unique alignment (<xref ref-type="fig" rid="f1">Fig. 1g</xref>).</p>
    </sec>
    <sec disp-level="2">
      <title>Scenario 8 (mappings in the negative set)</title>
      <p>If one aligner maps a particular read non-uniquely and the other aligner fails to map the read as either unique or non-unique, CADBURE considers the alignment true-negative (<xref ref-type="fig" rid="f1">Fig. 1h</xref>).</p>
      <p>Finally, CADBURE calculates the specificity and accuracy for each alignment result using the true-positives, false-positives and true-negatives discussed above (see <bold>Methods</bold>). Bootstrapping statistics<xref ref-type="bibr" rid="b23">23</xref> (see <bold>Methods</bold>) ascertains the significance of differences between both the accuracy and specificity of alignment results. Higher accuracy and specificity means fewer false-positives. Non-significant difference in the accuracy and/or specificity measures of alignment results implies neither aligner holds a significant advantage over the other.</p>
    </sec>
    <sec disp-level="2">
      <title>Demonstration of the use of CADBURE</title>
      <p>To demonstrate the use of CADBURE in aiding the selection of optimal mapping results for a given dataset, CADBURE was applied to our RNA-Seq project<xref ref-type="bibr" rid="b17">17</xref> consisting of 6 sequencing samples. The sequenced datasets ranged from 2.4 to 3.3 × 10<sup>7</sup> single-end reads of length 51 bases (Supplemental Table S1). These samples consisted of three biological replicates from two different cell types (lens epithelial cells and lens fiber cells), from newborn inbred <italic>FVB/N</italic> strain mouse lenses.</p>
      <sec disp-level="3">
        <title>Mapping to the reference genome</title>
        <p>After filtering out low quality reads and trimming off sequencing adapters, mapping was performed against a <italic>Mus musculus</italic> reference genome assembly. A SNP database and gene annotation (ENSEMBL<xref ref-type="bibr" rid="b24">24</xref>release 72) were utilized to perform a SNP-tolerant and gene-annotation-guided mapping. Altogether, CADBURE evaluated 12 different parameter sets for the different spliced aligners to fully evaluate the aligner’s performance in spliced alignment. These included the variation of 3 different mismatch levels (0, 1 and 2 mismatches) allowed for 3 different aligners: (i) GSNAP, (ii) TopHat2, and (iii) CLC Genomics Workbench. In addition, GSNAP was evaluated with SNP-tolerant option to account for differences between the reference genome and experimental genome, making it the 4th package for evaluation. Consequently, this results in 12 different parameter sets (i.e., 3 mismatch levels for each of the 4 different packages - see <bold>Methods</bold>). CADBURE only evaluated up to 2 mismatches because 3 or more mismatches would represent greater than 5% of the total read length (mean read length after trimming is 47; Supplemental Table S1) and exceed the observed error rate of next generation sequencing<xref ref-type="bibr" rid="b25">25</xref>. As expected, changes in the allowed mismatch level dramatically affected the alignment yield, ranging from 53.07% to 99.61% (Supplemental Fig. S1 and Supplemental Table S2). As seen in the figure, GSNAP using the maximum 2 mismatches, with and without the SNP-tolerant option, yielded the most consistent mapping for all data samples ranging from 95.47% to 99.61%, followed by TopHat2 ranging from 79.90% to 95.72%. Meanwhile, in comparison to GSNAP and TopHat2 with just 1 allowed mismatch, CLC, surprisingly, demonstrated the lowest yield even with 2 allowed mismatches. The ability of GSNAP to map reads partially by soft clipping ends and aligning reads past annotated exons may be the major reason for many additional mappings with this software.</p>
      </sec>
      <sec disp-level="3">
        <title>Evaluation using CADBURE</title>
        <p>CADBURE evaluated the top 3 alignment results based on the alignment yield, an important factor in evaluating the optimal alignment result: (1) GSNAP with SNP tolerance and 2 mismatches, (2) GSNAP without SNP tolerance, with 2 mismatches and (3) TopHat2 with 2 mismatches (Supplemental Fig. S1). In the initial comparisons between GSNAP and TopHat2, both GSNAP with and without SNP tolerance produced significantly more reliable mappings among the 8 scenarios (see <bold>Design of CADBURE</bold>) than those from TopHat2 for each of the 6 datasets (<xref ref-type="fig" rid="f2">Fig. 2a,b</xref>; Supplemental Table S3–S6). Next, in the comparison of GSNAP with and without SNP tolerance, the former produced significantly more reliable mappings among the 8 mapping scenarios for all 6 data samples (<xref ref-type="fig" rid="f2">Fig. 2c</xref>; Supplemental Table S7, S8). Thus GSNAP with SNP tolerance and two mismatches consistently produced more reliable mappings for each of the 6 datasets.</p>
      </sec>
      <sec disp-level="3">
        <title>Validation of CADBURE</title>
        <p>CADBURE was validated through verification of the automatic identification of true-positive, false-positive and true-negative by visualizing the read mapping scenarios for alignment result comparisons used above. <xref ref-type="fig" rid="f3">Figure 3</xref>, Supplemental Figs S2 and S3 display the snapshot of read mapping visualized by Tablet<xref ref-type="bibr" rid="b26">26</xref> for 3 contradicting read mapping scenarios among compared aligners. The read mapping in <xref ref-type="fig" rid="f3">Fig. 3</xref> provides an example of scenario 2 and 3 of read mapping (<xref ref-type="fig" rid="f1">Fig. 1d</xref>), where both GSNAP and TopHat2 uniquely mapped the highlighted read to an overlapping genomic location, but with different spliced alignment. GSNAP mapped this 40 base read perfectly with no mismatches to Chromosome 2 from 152,318,712 to 152,318,751 (true-positive), whereas TopHat2 mapped the same read as a spliced alignment to Chromosome 2 with 1 base at 152,318,455, leaving a long gap for an intron (257 bp; from 152,318,456 to 152,318,712) with 39 bases mapped from 152,318,713 to 152,318,751 (false-positive). The read mapping in Supplemental Fig. S2 demonstrates an example of scenario 4 (<xref ref-type="fig" rid="f1">Fig. 1e</xref>), where both GSNAP and TopHat2 aligners uniquely mapped the read to different genomic locations. GSNAP mapped the highlighted 40 base read perfectly with no mismatches to Chromosome 11 from 109,011,648 to 109,011,687 (false-positive; scenario 4), whereas TopHat2 mapped the same read with allowed two mismatches to Chromosome 7 from 110,059,825 to 110,059,864 (false-positive; scenario 4). Here, both GSNAP and TopHat2 missed the possible read mapping found by the counterpart and hence wrongly reported a unique mapping. The read mapping in Supplemental Fig. S3 reveals an example of scenario 5 (<xref ref-type="fig" rid="f1">Fig. 1f</xref>), where TopHat2 mapped the highlighted 51 base read with no mismatches to the mitochondrial chromosome from 7,465 to 7,515 uniquely (false-positive), whereas GSNAP, in addition to mapping to the mitochondrial genome, mapped the same read without mismatches to Chromosome 1 from 24,615,063 to 24,615,663 (non-unique mapping; true-negative).</p>
      </sec>
      <sec disp-level="3">
        <title>The reliability and benefit of the optimal alignment result selected by CADBURE</title>
        <p>To demonstrate the reliability of the optimal alignment result selected by CADBURE, which with our datasets is GSNAP with SNP tolerance option and maximum two mismatches, we performed downstream analysis to determine differentially expressed genes (DEGs) on the CADBURE result versus other non-CADBURE results. To decide on the method for DEG analysis, we first used the optimal alignment result selected by CADBURE to evaluate the ability of five popular methods for DEG analysis: (1) DESeq, (2) DESeq2, (3) Baggereley test from CLC version 6.5.1, (4) Empirical analysis of differential gene expression (EDGE) from CLC version 7.0, and (5) Cuffdiff2. We evaluated these methods through different metrics such as: (1) by comparing and contrasting the number of DEGs identified by each method, (2) performance assessment using receiver operating characteristic (ROC) curve, (3) verification with real time quantitative PCR (RT–qPCR). Through the evaluation of different DEG analysis methods (see Supplemental Results and Discussion, Supplemental Figs S4-S6 and Supplemental Table S9), we find DESeq performs the best in DEG detection. Hence, we used DESeq to compare DEG analysis results obtained from the optimal alignment result selected by CADBURE (i.e., GSNAP with SNP tolerance and maximum 2 mismatches allowed) versus two non-CADBURE results: (1) GSNAP without SNP tolerance, with 2 mismatches, and (2) TopHat2 with 2 mismatches.</p>
        <p>As shown in <xref ref-type="fig" rid="f4">Fig. 4</xref>, these three alignment results agree in DEG calling for most genes and the fold change for 18 genes with qRT-PCR verification (see Supplemental Results and Discussion and Supplemental Methods) did not differ among them (Supplemental Fig. S7). Although over 88% of both up-regulated (<xref ref-type="fig" rid="f4">Fig. 4a</xref>) and down-regulated genes (<xref ref-type="fig" rid="f4">Fig. 4b</xref>) identified by DESeq as significant DEGs (padj &lt;= 0.05) agree among the three alignment results, there is still a substantial difference among DEG numbers (<xref ref-type="fig" rid="f4">Fig. 4</xref>). Close examinations reveal that the TopHat2 result, which was found to have a higher false positive reads (<xref ref-type="fig" rid="f1">Figs 1</xref> and <xref ref-type="fig" rid="f2">2</xref>; section <italic><bold>Evaluation using CADBURE</bold></italic>), produced more DEGs (<xref ref-type="fig" rid="f4">Fig. 4</xref>) in comparison with the CADBURE result. In particular, we found one DEG, namely Rpl12 (<italic>Mus musculus</italic> ribosomal protein L12; chr2:32,961,712-32,964,045), displays a drastic difference between the results obtained by TopHat2 and GSNAP with SNP tolerance. Namely, the CADBURE selected result reports RPl12 as up-regulated in Epithelial cells whereas TopHat2 reports the same gene as upregulated in Fiber cells (Supplemental Table S10). Supplemental Fig. S8 shows the read alignment snapshot as seen in IGV (Integrative genomics viewer<xref ref-type="bibr" rid="b27">27</xref>) for the Epithelial replicate 3 (E3) unique reads mapped to gene RPl12 as reported by the CADBURE selected result and TopHat2. Only 650 reads out of 6265 E3 reads reported as uniquely mapped to Rpl12 in TopHat2 are reported as uniquely mapped in the CADBURE selected result (GSNAP with SNP tolerance). Supplemental Table S11 lists all the 6265 E3 reads that are reported in TopHat2 as uniquely aligned to RPl12. Supplemental Table S12 lists the same 6265 E3 reads from the CADBURE selected alignment result, where you can see only 650 of the same reads have been reported as unique alignments. Hence, the difference of RPl12 differential expression reporting in TopHat2 can be mainly attributed to the reads identified as false positives in the TopHat2 mappings (<xref ref-type="fig" rid="f1">Figs 1</xref> and <xref ref-type="fig" rid="f2">2</xref>; see the section <italic><bold>Evaluation using CADBURE</bold></italic>).</p>
      </sec>
    </sec>
  </sec>
  <sec disp-level="1" sec-type="discussion">
    <title>Discussion</title>
    <p>The increasing popularity of RNA-Seq-based approaches in transcriptome analysis necessitates a way to evaluate and compare different methods of data analysis. In this work, we introduce CADBURE, a tool to compare and evaluate the performance of alignment programs on any given RNA-Seq dataset. We also demonstrate the use of CADBURE in selecting an optimal alignment result and the reliability of such selected alignment result for downstream DEG analysis. In addition, we provide an evaluation of five different tools used for DEG analysis (Supplemental Results and Discussion). CADBURE satisfies the need for an easy-to-use tool for the comparison of two existing alignment results. Unlike the existing tool - ARDEN<xref ref-type="bibr" rid="b16">16</xref>, CADBURE comparisons can be independent of the parameters used, and it does not require time-consuming alignment regeneration against a simulated genome or randomly subsampling of the dataset. One of the potential limitations for regenerating alignments against a simulated genome is the preclusion of the use of genome-specific options like gene-annotation or SNP-data guided mapping. CADBURE puts no limitation on the use of these options, eliminating the need for some dispensable preprocessing steps. The only preprocessing step required in CADBURE is the conversion of human-readable SAM (Sequence alignment format) format to machine readable BAM (Binary alignment format) format, which is the input for CADBURE. This SAM to BAM conversion can be easily accomplished using the SAMtools<xref ref-type="bibr" rid="b28">28</xref>, a package for processing SAM files.</p>
    <p>CADBURE is not designed to evaluate the accuracy of read mapping; instead it analyzes the relative reliability and consistency of a read mapping between two alignment programs or parameter sets of the same aligner. The underlying logic of CADBURE is poised to find an aligner that shows optimal performance in terms of the 8 scenarios described in <xref ref-type="fig" rid="f1">Fig. 1</xref>. It should be noted that we are not trying to find false negatives in the negative set (non-unique mapping) because our focus is to find false positives only in the positive set (unique mapping), which is primarily used for downstream analysis in RNA-Seq studies<xref ref-type="bibr" rid="b1">1</xref><xref ref-type="bibr" rid="b21">21</xref><xref ref-type="bibr" rid="b22">22</xref>. Although CADBURE is designed for pairwise comparison of alignment results, it can be easily used for comparing three alignment results. First, users can compare any two alignment results, and then the CADBURE selected result can be compared with the third alignment result to decide on the optimal one among the three alignments. Our future work will be to increase the comparisons to more than two alignment results automatically.</p>
    <p>The demonstration of CADBURE in real data comparison showed the ease of comparing two different alignment results. In our mouse RNA-Seq data, the GSNAP with SNP tolerance option produced more reliable mapping in comparison with other aligners on all of the 6 data samples. However, this result may not hold for other datasets, supporting the strong argument that an aligner must be picked after evaluating different aligners or parameter sets on a particular user’s dataset. In our case, we see the main advantage of GSNAP is its ability to allow mismatches against the reference genome if the read matches the alternate strand of genome and also to map reads partially by soft clipping ends and by aligning reads past annotated exons.</p>
    <p>We also demonstrate the reliability of CADBURE-selected alignment results versus other alignment results by comparing the relevant DEGs. Even though we only see about 10% difference among the number of DEGs (<xref ref-type="fig" rid="f4">Fig. 4</xref>) detected among CADBURE result and other alignment results, the CADBURE result favors fewer false positives in DEG calling. As we have shown in Supplemental Figure S8 and Table S11 and S12, the non-unique alignment found for gene <italic>Rpl12</italic> in the CADBURE selected alignment was incorrectly reported as unique in the non-CADBURE selected alignment, which affected DEG profiles adversely. Moreover, we evaluated five popular RNA-Seq-based DEG analysis methods for their ability to discriminate DEGs. Through three different metrics, we found DESeq performed better with better balance between sensitivity and specificity (Supplemental Results and Discussion, Supplemental Figs S4-S6).</p>
    <p>The popularity of RNA-Seq-based transcriptome profiling has driven the need for the many different analysis tools from spliced alignment to statistical methods for DEG identification<xref ref-type="bibr" rid="b1">1</xref><xref ref-type="bibr" rid="b2">2</xref><xref ref-type="bibr" rid="b3">3</xref>. The software comparison illustrated here, along with an introduction of the CADBURE method for alignment evaluation of user data, demonstrates the need for choosing appropriate tools specific to properties of the data. Although the optimal alignment selected by CADBURE results in a lower number of DEGs, CADBURE performs better in reducing false positive mappings. In the comparison of the statistical methods for discriminating DEGs, DESeq performs better in comparison to other tools used in this study.</p>
  </sec>
  <sec disp-level="1" sec-type="methods">
    <title>Methods</title>
    <sec disp-level="2">
      <title>Accuracy and Specificity by CADBURE</title>
      <p>The deduced true positive (TP), false positive (FP) and true negative (TN) map alignments were used to compute the following measures for each alignment result under comparison.<disp-formula id="eq1"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e478" xlink:href="srep13443-m1.jpg"/></disp-formula><disp-formula id="eq2"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e480" xlink:href="srep13443-m2.jpg"/></disp-formula></p>
      <p>False negative map alignments were not considered in computing accuracy for the reasons presented in the <bold>Results</bold>. Here Specificity (<xref ref-type="disp-formula" rid="eq1">Eq. 1</xref>) and Accuracy (<xref ref-type="disp-formula" rid="eq2">Eq. 2</xref>) denote the true negative rate and accuracy towards reporting respectively. Differences in both Specificity and Accuracy results between aligners or different parameter sets of the same aligner were assessed by building 95% bootstrap confidence intervals for the true difference. 10,000 bootstrap samples were used in building the interval estimates. Results were deemed significant at the 5% significance level if the associated 95% confidence interval (CI) for the differences failed to contain zero.</p>
    </sec>
    <sec disp-level="2">
      <title>Implementation and availability of CADBURE</title>
      <p>We implemented the CADBURE algorithm as a Perl script. For rapid comparison, input files were required to be in Binary Alignment format (BAM) sorted by read name. The comparison involved collection of alignment information in the hash table, which provided a faster way of data search and retrieval. The comparison of tables was performed as per the scenarios 1–8 as described in <xref ref-type="fig" rid="f1">Fig. 1</xref>. The CADBURE script is available at (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://cadbure.sourceforge.net/">http://cadbure.sourceforge.net/</ext-link>).</p>
    </sec>
    <sec disp-level="2">
      <title>Data and pre-processing</title>
      <p>RNA-Seq was carried out as described<xref ref-type="bibr" rid="b17">17</xref>. Briefly, 6 libraries consisted of 3 biological replicates for each of two cell types (epithelial cells and fiber cells) from newborn FVB/N mouse lenses. Libraries were prepared according to the Illumina® TruSeq™ RNA Sample Preparation Kit v3 with mRNAs being poly (A) selected. Sequencing was performed using an Illumia HiSeq 2000 platform to produce 51 base long, single-ended reads. Read quality was assessed using Prinseq<xref ref-type="bibr" rid="b29">29</xref>, FastQC (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/">http://www.bioinformatics.babraham.ac.uk/projects/fastqc/</ext-link>), and CLC Genomics Workbench. CLC Genomics Workbench was used to trim poor quality reads (Phred &lt; 28), ambiguous poly (N) tails, poly (A/T) tails, adapters and primers.</p>
    </sec>
    <sec disp-level="2">
      <title>Spliced alignment to reference genome</title>
      <p>The spliced alignment of final clean reads was performed against the mouse reference genome (ENSEMBL release 72<xref ref-type="bibr" rid="b24">24</xref>) with the guidance of the gene annotation model (GTF; ENSEMBL release 72). The known SNP data in variant call format (VCF; ENSEMBL release 72) was used in the case of SNP tolerant alignment. For GSNAP<xref ref-type="bibr" rid="b9">9</xref> alignment (version 2013-09-30.v2), the known splice site information was extracted from GTF file using the GMAP utility and provided to the aligner with option (-s). For SNP tolerant alignment in GSNAP, SNP information was obtained from the VCF file using the GMAP utility and provided to the aligner with option (-v). Reads filtered by Illumina’s Chastity filter were recognized and filtered by the option (--filter-chastity both) in GSNAP. For Tophat2 alignment (version 2.0.9), the option (-G) was used to utilize the GTF annotation file to aid in splice alignment. For CLC Genomics Workbench (version 6.5.1), the genome was annotated with the GTF file to aid in spliced alignment to the genes. Three different runs were executed for each aligner (GSNAP, Tophat2, and CLC Genomics Workbench) in addition to the SNP tolerant alignment of GSNAP, by varying the mismatch levels (i.e., 0, 1, and 2 mismatches). Mapping results were obtained in Sequence Alignment Format (SAM) from all the aligners. Samtools<xref ref-type="bibr" rid="b28">28</xref> was used to count the total mapped reads with the options (-c -F 4). Uniquely and non-uniquely mapped reads were identified by value to the SAM flag NH:i (<underline>N</underline>umber of <underline>H</underline>its; value 1 for unique mappings and value 2 or more for ambiguous mappings). All RNA-Seq bam files used in our data analysis are available on <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://sourceforge.net/projects/cadbure/files/?source=navbar">http://sourceforge.net/projects/cadbure/files/?source=navbar</ext-link>.</p>
    </sec>
  </sec>
  <sec disp-level="1">
    <title>Additional Information</title>
    <p><bold>How to cite this article</bold>: Kumar, P.K.R. <italic>et al.</italic> CADBURE: A generic tool to evaluate the performance of spliced aligners on RNA-Seq data. <italic>Sci. Rep.</italic>
<bold>5</bold>, 13443; doi: 10.1038/srep13443 (2015).</p>
  </sec>
  <sec sec-type="supplementary-material" id="S1">
    <title>Supplementary Material</title>
    <supplementary-material id="d33e25" content-type="local-data">
      <caption>
        <title>Supplementary Information</title>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep13443-s1.pdf"/>
    </supplementary-material>
    <supplementary-material id="d33e28" content-type="local-data">
      <caption>
        <title>Supplementary Information</title>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep13443-s2.xls"/>
    </supplementary-material>
    <supplementary-material id="d33e31" content-type="local-data">
      <caption>
        <title>Supplementary Information</title>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep13443-s3.xls"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>This work was supported, in part, by NIH grants (R01EY010540 and R01EY16707 to PAT and R21EY022210 and 2R01EY012995-11A1 to MLR). We would also like to acknowledge assistance from the Center for Bioinformatics and Functional Genomics at Miami University. We also thank Dr. Richard Moore and Dr. John Karro for critically reading the manuscript.</p>
  </ack>
  <ref-list>
    <ref id="b1">
      <mixed-citation publication-type="journal"><name><surname>Mortazavi</surname><given-names>A.</given-names></name>, <name><surname>Williams</surname><given-names>B. A.</given-names></name>, <name><surname>McCue</surname><given-names>K.</given-names></name>, <name><surname>Schaeffer</surname><given-names>L.</given-names></name> &amp; <name><surname>Wold</surname><given-names>B.</given-names></name>
<article-title>Mapping and quantifying mammalian transcriptomes by RNA-Seq</article-title>. <source>Nat Meth</source>
<volume>5</volume>, <fpage>621</fpage>–<lpage>628</lpage> (<year>2008</year>).</mixed-citation>
    </ref>
    <ref id="b2">
      <mixed-citation publication-type="journal"><name><surname>Oshlack</surname><given-names>A.</given-names></name>, <name><surname>Robinson</surname><given-names>M.</given-names></name> &amp; <name><surname>Young</surname><given-names>M.</given-names></name>
<article-title>From RNA-seq reads to differential expression results</article-title>. <source>Genome Biol</source>
<volume>11</volume>, <fpage>220</fpage> (<year>2010</year>).<pub-id pub-id-type="pmid">21176179</pub-id></mixed-citation>
    </ref>
    <ref id="b3">
      <mixed-citation publication-type="journal"><name><surname>Engström</surname><given-names>P. G.</given-names></name><italic>et al.</italic><article-title>Systematic evaluation of spliced alignment programs for RNA-seq data</article-title>. <source>Nat. Methods</source><volume>10</volume>, <fpage>1185</fpage>–<lpage>1191</lpage> (<year>2013</year>).<pub-id pub-id-type="pmid">24185836</pub-id></mixed-citation>
    </ref>
    <ref id="b4">
      <mixed-citation publication-type="journal"><name><surname>Sultan</surname><given-names>M.</given-names></name><italic>et al.</italic><article-title>A global view of gene activity and alternative splicing by deep sequencing of the human transcriptome</article-title>. <source>Science</source><volume>321</volume>, <fpage>956</fpage>–<lpage>960</lpage> (<year>2008</year>).<pub-id pub-id-type="pmid">18599741</pub-id></mixed-citation>
    </ref>
    <ref id="b5">
      <mixed-citation publication-type="journal"><name><surname>Treangen</surname><given-names>T. J.</given-names></name> &amp; <name><surname>Salzberg</surname><given-names>S. L.</given-names></name>
<article-title>Repetitive DNA and next-generation sequencing: computational challenges and solutions</article-title>. <source>Nat. Rev. Genet</source>. <volume>13</volume>, <fpage>36</fpage>–<lpage>46</lpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22124482</pub-id></mixed-citation>
    </ref>
    <ref id="b6">
      <mixed-citation publication-type="journal"><name><surname>Shendure</surname><given-names>J.</given-names></name> &amp; <name><surname>Ji</surname><given-names>H.</given-names></name>
<article-title>Next-generation DNA sequencing</article-title>. <source>Nat. Biotechnol</source>. <volume>26</volume>, <fpage>1135</fpage>–<lpage>1145</lpage> (<year>2008</year>).<pub-id pub-id-type="pmid">18846087</pub-id></mixed-citation>
    </ref>
    <ref id="b7">
      <mixed-citation publication-type="journal"><name><surname>Garber</surname><given-names>M.</given-names></name>, <name><surname>Grabherr</surname><given-names>M. G.</given-names></name>, <name><surname>Guttman</surname><given-names>M.</given-names></name> &amp; <name><surname>Trapnell</surname><given-names>C.</given-names></name>
<article-title>Computational methods for transcriptome annotation and quantification using RNA-seq</article-title>. <source>Nat. Methods</source>
<volume>8</volume>, <fpage>469</fpage>–<lpage>477</lpage> (<year>2011</year>).<pub-id pub-id-type="pmid">21623353</pub-id></mixed-citation>
    </ref>
    <ref id="b8">
      <mixed-citation publication-type="journal"><name><surname>Kim</surname><given-names>D.</given-names></name><italic>et al.</italic><article-title>TopHat2: accurate alignment of transcriptomes in the presence of insertions, deletions and gene fusions</article-title>. <source>Genome Biol</source>. <volume>14</volume>, <fpage>R36</fpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23618408</pub-id></mixed-citation>
    </ref>
    <ref id="b9">
      <mixed-citation publication-type="journal"><name><surname>Wu</surname><given-names>T. D.</given-names></name> &amp; <name><surname>Nacu</surname><given-names>S.</given-names></name>
<article-title>Fast and SNP-tolerant detection of complex variants and splicing in short reads</article-title>. <source>Bioinformatics</source>
<volume>26</volume>, <fpage>873</fpage>–<lpage>881</lpage> (<year>2010</year>).<pub-id pub-id-type="pmid">20147302</pub-id></mixed-citation>
    </ref>
    <ref id="b10">
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H.</given-names></name> &amp; <name><surname>Durbin</surname><given-names>R.</given-names></name>
<article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>. <source>Bioinforma. Oxf. Engl</source>. <volume>25</volume>, <fpage>1754</fpage>–<lpage>1760</lpage> (<year>2009</year>).</mixed-citation>
    </ref>
    <ref id="b11">
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>K.</given-names></name><italic>et al.</italic><article-title>MapSplice: Accurate mapping of RNA-seq reads for splice junction discovery</article-title>. <source>Nucleic Acids Res</source>. <volume>38</volume>, <fpage>e178</fpage>–<lpage>e178</lpage> (<year>2010</year>).<pub-id pub-id-type="pmid">20802226</pub-id></mixed-citation>
    </ref>
    <ref id="b12">
      <mixed-citation publication-type="journal"><name><surname>Jean</surname><given-names>G.</given-names></name>, <name><surname>Kahles</surname><given-names>A.</given-names></name>, <name><surname>Sreedharan</surname><given-names>V. T.</given-names></name>, <name><surname>Bona</surname><given-names>F. D.</given-names></name> &amp; <name><surname>Rätsch</surname><given-names>G.</given-names></name>
<source>RNA-Seq Read Alignments with PALMapper in Current Protocols in Bioinformatics</source> (eds <name><surname>Baxevanis</surname><given-names>A. D.</given-names></name>
<italic>et al.</italic> .) <fpage>11.6.1</fpage>–<lpage>11.6.37</lpage> (John Wiley &amp; Sons, <year>2010</year>).</mixed-citation>
    </ref>
    <ref id="b13">
      <mixed-citation publication-type="journal"><name><surname>Dobin</surname><given-names>A.</given-names></name><italic>et al.</italic><article-title>STAR: ultrafast universal RNA-seq aligner</article-title>. <source>Bioinformatics</source><volume>29</volume>, <fpage>15</fpage>–<lpage>21</lpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23104886</pub-id></mixed-citation>
    </ref>
    <ref id="b14">
      <mixed-citation publication-type="journal"><name><surname>Fonseca</surname><given-names>N. A.</given-names></name>, <name><surname>Rung</surname><given-names>J.</given-names></name>, <name><surname>Brazma</surname><given-names>A.</given-names></name> &amp; <name><surname>Marioni</surname><given-names>J. C.</given-names></name>
<article-title>Tools for mapping high-throughput sequencing data</article-title>. <source>Bioinformatics</source>
<volume>28</volume>, <fpage>3169</fpage>–<lpage>3177</lpage> (<year>2012</year>).<pub-id pub-id-type="pmid">23060614</pub-id></mixed-citation>
    </ref>
    <ref id="b15">
      <mixed-citation publication-type="journal"><name><surname>Nookaew</surname><given-names>I.</given-names></name><italic>et al.</italic><article-title>A comprehensive comparison of RNA-Seq-based transcriptome analysis from reads to differential gene expression and cross-comparison with microarrays: a case study in Saccharomyces cerevisiae</article-title>. <source>Nucleic Acids Res</source> (<year>2012</year>). <pub-id pub-id-type="doi">10.1093/nar/gks804</pub-id></mixed-citation>
    </ref>
    <ref id="b16">
      <mixed-citation publication-type="journal"><name><surname>Giese</surname><given-names>S. H.</given-names></name>, <name><surname>Zickmann</surname><given-names>F.</given-names></name> &amp; <name><surname>Renard</surname><given-names>B. Y.</given-names></name>
<article-title>Specificity control for read alignments using an artificial reference genome-guided false discovery rate</article-title>. <source>Bioinformatics</source>
<volume>30</volume>, <fpage>9</fpage>–<lpage>16</lpage> (<year>2014</year>).<pub-id pub-id-type="pmid">23685787</pub-id></mixed-citation>
    </ref>
    <ref id="b17">
      <mixed-citation publication-type="journal"><name><surname>Hoang</surname><given-names>T.</given-names></name>, <name><surname>Raj Kumar</surname><given-names>P. K.</given-names></name>, <name><surname>Sutharzan</surname><given-names>S.</given-names></name>, <name><surname>Tsonis</surname><given-names>P. A.</given-names></name>, <name><surname>Liang</surname><given-names>C.</given-names></name> &amp; <name><surname> Robinson</surname><given-names>M. L.</given-names></name>
<article-title>Comparative transcriptome analysis of epithelial and fiber cells in newborn mouse lenses by RNA sequencing</article-title>. <source>Mol. Vis</source>. <volume>20</volume>, <fpage>1491</fpage>–<lpage>1517</lpage> (<year>2014</year>).<pub-id pub-id-type="pmid">25489224</pub-id></mixed-citation>
    </ref>
    <ref id="b18">
      <mixed-citation publication-type="journal"><name><surname>Anders</surname><given-names>S.</given-names></name> &amp; <name><surname>Huber</surname><given-names>W.</given-names></name>
<article-title>Differential expression analysis for sequence count data</article-title>. <source>Genome Biol</source>
<volume>11</volume>, <fpage>R106</fpage> (<year>2010</year>).<pub-id pub-id-type="pmid">20979621</pub-id></mixed-citation>
    </ref>
    <ref id="b19">
      <mixed-citation publication-type="journal"><name><surname>Love</surname><given-names>M. I.</given-names></name>, <name><surname>Huber</surname><given-names>W.</given-names></name> &amp; <name><surname>Anders</surname><given-names>S.</given-names></name>
<article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>. <source>Genome Biol</source>
<volume>15</volume>, <fpage>550</fpage> (<year>2014</year>).<pub-id pub-id-type="pmid">25516281</pub-id></mixed-citation>
    </ref>
    <ref id="b20">
      <mixed-citation publication-type="journal"><name><surname>Trapnell</surname><given-names>C.</given-names></name><italic>et al.</italic><article-title>Differential analysis of gene regulation at transcript resolution with RNA-seq</article-title>. <source>Nat. Biotechnol</source><volume>31</volume>, <fpage>46</fpage>–<lpage>53</lpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23222703</pub-id></mixed-citation>
    </ref>
    <ref id="b21">
      <mixed-citation publication-type="journal"><name><surname>Ren</surname><given-names>S.</given-names></name><italic>et al.</italic><article-title>RNA-seq analysis of prostate cancer in the Chinese population identifies recurrent gene fusions, cancer-associated long noncoding RNAs and aberrant alternative splicings</article-title>. <source>Cell Res</source>. <volume>22</volume>, <fpage>806</fpage>–<lpage>821</lpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22349460</pub-id></mixed-citation>
    </ref>
    <ref id="b22">
      <mixed-citation publication-type="journal"><name><surname>Rowley</surname><given-names>J. W.</given-names></name><italic>et al.</italic><article-title>Genome-wide RNA-seq analysis of human and mouse platelet transcriptomes</article-title>. <source>Blood</source><volume>118</volume>, <fpage>e101</fpage>–<lpage>e111</lpage> (<year>2011</year>).<pub-id pub-id-type="pmid">21596849</pub-id></mixed-citation>
    </ref>
    <ref id="b23">
      <mixed-citation publication-type="journal"><name><surname>Efron</surname><given-names>B.</given-names></name><article-title>Bootstrap methods for standard errors, confidence intervals, and other measures of statistical accuracy</article-title>. <source>Stat. Sci</source>. <volume>1</volume>, <fpage>54</fpage>–<lpage>75</lpage> (<year>1986</year>).</mixed-citation>
    </ref>
    <ref id="b24">
      <mixed-citation publication-type="journal"><name><surname>Flicek</surname><given-names>P.</given-names></name><italic>et al.</italic><article-title>Ensembl 2013</article-title>. <source>Nucleic Acids Res</source>. <volume>41</volume>, <fpage>D48</fpage>–<lpage>D55</lpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23203987</pub-id></mixed-citation>
    </ref>
    <ref id="b25">
      <mixed-citation publication-type="journal"><name><surname>Loman</surname><given-names>N. J.</given-names></name><italic>et al.</italic><article-title>Performance comparison of benchtop high-throughput sequencing platforms</article-title>. <source>Nat. Biotechnol</source><volume>30</volume>, <fpage>434</fpage>–<lpage>439</lpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22522955</pub-id></mixed-citation>
    </ref>
    <ref id="b26">
      <mixed-citation publication-type="journal"><name><surname>Milne</surname><given-names>I.</given-names></name><italic>et al.</italic><article-title>Using Tablet for visual exploration of second-generation sequencing data</article-title>. <source>Brief. Bioinform</source>. <volume>14</volume>, <fpage>193</fpage>–<lpage>202</lpage> (<year>2013</year>).<pub-id pub-id-type="pmid">22445902</pub-id></mixed-citation>
    </ref>
    <ref id="b27">
      <mixed-citation publication-type="journal"><name><surname>Robinson</surname><given-names>J. T.</given-names></name><italic>et al.</italic><article-title>Integrative genomics viewer</article-title>. <source>Nat. Biotechnol</source>. <volume>29</volume>, <fpage>24</fpage>–<lpage>26</lpage> (<year>2011</year>).<pub-id pub-id-type="pmid">21221095</pub-id></mixed-citation>
    </ref>
    <ref id="b28">
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H.</given-names></name><italic>et al.</italic><article-title>The Sequence Alignment/Map format and SAMtools</article-title>. <source>Bioinformatics</source><volume>25</volume>, <fpage>2078</fpage>–<lpage>2079</lpage> (<year>2009</year>).<pub-id pub-id-type="pmid">19505943</pub-id></mixed-citation>
    </ref>
    <ref id="b29">
      <mixed-citation publication-type="journal"><name><surname>Schmieder</surname><given-names>R.</given-names></name> &amp; <name><surname>Edwards</surname><given-names>R.</given-names></name>
<article-title>Quality control and preprocessing of metagenomic datasets</article-title>. <source>Bioinformatics</source>
<volume>27</volume>, <fpage>863</fpage>–<lpage>864</lpage> (<year>2011</year>).<pub-id pub-id-type="pmid">21278185</pub-id></mixed-citation>
    </ref>
  </ref-list>
  <fn-group>
    <fn>
      <p><bold>Author Contributions</bold> C.L. and M.L.R. coordinated and managed the project. P.K.R.K. and C.L. designed CADBURE. P.K.R.K. carried out implementations of CADBURE and evaluation of RNA-Seq DEG analysis methods and wrote the manuscript. T.V.H. prepared the RNA-Seq data, performed RT-qPCR, and helped evaluate CADBURE. P.A.T. contributed to the RNA-Seq data. All authors edited the manuscript.</p>
    </fn>
  </fn-group>
</back>
<floats-group>
  <fig id="f1">
    <label>Figure 1</label>
    <caption>
      <title>The core algorithm of CADBURE.</title>
      <p>(<bold>a</bold>) The assumption of CADBURE core algorithm and metrics to identify. The collection of UQ (unique) mappings are assumed as a set of positives and the collection of N-UQ (non-unique) mappings are assumed as a set of negatives. (<bold>b</bold>) Scenario 1. UQ mapping by both aligner-1 (red arrow) and aligner-2 (blue arrow) to the same genome location with the same alignment. (<bold>c</bold>) Scenario 2 &amp; 3. UQ mapping by both aligner-1 and aligner-2 to overlapping genome regions with different alignments. Scenario 2: No spliced alignment by aligner-1 is called as TP (true-positive). Scenario 3: spliced-alignment by aligner-2 with a nucleotide overhang is called as FP (false-positive). (<bold>d</bold>) Scenario 4. UQ mapping by both aligner-1 and aligner-2 to different genomic locations, and both are called FP. (<bold>e</bold>) Scenario 5. UQ mapping by aligner-2 is called FP because the same read is reported as N-UQ mapping by aligner-1. The read mapping in the aligner-1 is called TN (true-negative). (<bold>f</bold>) Scenario 6. UQ mapping by aligner-1 is called TP because aligner-2 cannot map this read as either UQ or N-UQ mapping. (<bold>g</bold>) Scenario 7. N-UQ mapping by both aligner-1 and aligner-2 where they agree for a read in that they map it non-uniquely. This case is called TN for both aligners. (<bold>h</bold>) Scenario 8. N-UQ mapping by aligner-1 is called TN because aligner-2 cannot map this read as either UQ or N-UQ read. UQ: Unique, N-UQ: Non-Unique, TP: true-positive, FP: false-positive, TN: true-negative.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep13443-f1"/>
  </fig>
  <fig id="f2">
    <label>Figure 2</label>
    <caption>
      <title>Pairwise comparison of alignment results using CADBURE.</title>
      <p>(<bold>a</bold>) GSNAP with SNP tolerance versus TopHat2. (<bold>b</bold>) GSNAP without SNP tolerance versus TopHat2. (<bold>c</bold>) GSNAP without SNP tolerance versus GSNAP with SNP tolerance. (<bold>a</bold>–<bold>c</bold>) show the comparison of the percentage of TP, FP and TN for each dataset (E1, E2, E3, F1, F2, F3), where E stands for mouse lens epithelial cells, F for mouse lens fiber cells, and the number indicates the biological replicate number. An asterisk at the end of each sample comparison indicates the difference of both specificity and accuracy between the aligners is significant at 5% level with 95% confidence. GSNAP SNP tol: GSNAP with SNP tolerance.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep13443-f2"/>
  </fig>
  <fig id="f3">
    <label>Figure 3</label>
    <caption>
      <title>An example of Scenario 2 &amp; 3.</title>
      <p>Read mapping (highlighted with red line) is identified as Scenario 2 and Scenario 3 by CADBURE and visualized in Tablet<xref ref-type="bibr" rid="b26">26</xref>. Tablet shows reads mapped against the mouse reference genome. The same read (name shown in popup) is mapped differently to the genome by GSNAP and TopHat2 aligners. (<bold>a</bold>) GSNAP mapped the same 40 base read perfectly with no mismatches to Chromosome 2 from 152,318,712 to 152,318,751. (<bold>b</bold>) TopHat2 mapped the same read with a spliced alignment to Chromosome 2 with 1 base at 152,318,455, leaving a long gap for an intron (257 bp; from 152,318,456 to 152,318,712; displayed with ‘N’) and then (<bold>c</bold>) TopHat2 mapped 39 bases continuously from 152,318,713 to 152,318,751.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep13443-f3"/>
  </fig>
  <fig id="f4">
    <label>Figure 4</label>
    <caption>
      <title>Venn diagrams of Differentially Expressed Genes (DEGs) identified using DESeq from three different alignment results:GSNAP with SNP tolerance and 2 mismatches (CADBURE selected alignment), GSNAP without SNP tolerance, with 2 mismatches and TopHat2 with 2 mismatches. </title>
      <p> (<bold>a</bold>) DEGs upregulated in Epithelial cells. (<bold>b</bold>) DEGs upregulated in Fiber cells. Significant DEGs are identified with p-adj value &lt;= 0.05.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep13443-f4"/>
  </fig>
</floats-group>
