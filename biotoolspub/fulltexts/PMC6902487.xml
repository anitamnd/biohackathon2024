<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6902487</article-id>
    <article-id pub-id-type="pmid">31815609</article-id>
    <article-id pub-id-type="publisher-id">3152</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-019-3152-3</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>flowEMMi: an automated model-based clustering tool for microbial cytometric data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ludwig</surname>
          <given-names>Joachim</given-names>
        </name>
        <address>
          <email>joachim.schumann@ufz.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9517-5839</contrib-id>
        <name>
          <surname>zu Siederdissen</surname>
          <given-names>Christian Höner</given-names>
        </name>
        <address>
          <email>choener@bioinf.uni-leipzig.de</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Liu</surname>
          <given-names>Zishu</given-names>
        </name>
        <address>
          <email>zishu.liu@ufz.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Stadler</surname>
          <given-names>Peter F.</given-names>
        </name>
        <address>
          <email>Peter.Stadler@bioinf.uni-leipzig.de</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Müller</surname>
          <given-names>Susann</given-names>
        </name>
        <address>
          <email>susann.mueller@ufz.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0492 3830</institution-id><institution-id institution-id-type="GRID">grid.7492.8</institution-id><institution>Department of Environmental Microbiology, Research Group Flow Cytometry, Helmholtz Centre for Environmental Research, </institution></institution-wrap>Permoserstraße 15, Leipzig, 04318 Germany </aff>
      <aff id="Aff2"><label>2</label>Department of Computer Science, University Leipzig, Härtelstr. 16-18, Leipzig, 04107 Germany </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>9</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>9</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>643</elocation-id>
    <history>
      <date date-type="received">
        <day>6</day>
        <month>6</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>10</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Flow cytometry (FCM) is a powerful single-cell based measurement method to ascertain multidimensional optical properties of millions of cells. FCM is widely used in medical diagnostics and health research. There is also a broad range of applications in the analysis of complex microbial communities. The main concern in microbial community analyses is to track the dynamics of microbial subcommunities. So far, this can be achieved with the help of time-consuming manual clustering procedures that require extensive user-dependent input. In addition, several tools have recently been developed by using different approaches which, however, focus mainly on the clustering of medical FCM data or of microbial samples with a well-known background, while much less work has been done on high-throughput, online algorithms for two-channel FCM.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We bridge this gap with flowEMMi, a model-based clustering tool based on multivariate Gaussian mixture models with subsampling and foreground/background separation. These extensions provide a fast and accurate identification of cell clusters in FCM data, in particular for microbial community FCM data that are often affected by irrelevant information like technical noise, beads or cell debris. flowEMMi outperforms other available tools with regard to running time and information content of the clustering results and provides near-online results and optional heuristics to reduce the running-time further.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">flowEMMi is a useful tool for the automated cluster analysis of microbial FCM data. It overcomes the user-dependent and time-consuming manual clustering procedure and provides consistent results with ancillary information and statistical proof.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Flow cytometry</kwd>
      <kwd>Clustering</kwd>
      <kwd>Data analysis</kwd>
      <kwd>Statistical analysis</kwd>
      <kwd>Microbial communities</kwd>
      <kwd>Expectation-Maximization</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Flow cytometry (FCM) is a high-throughput technology to measure multidimensional optical properties of single cells. Flow cytometry is widely used in medical diagnosis and health research but there is also a large area of applications in the context of complex microbial communities. Microbial communities are present everywhere in our environment. They are also used in biotechnological applications e.g. for the treatment of waste water, the production of biogas or the manufacturing of platform chemicals. Here, FCM can be used for process monitoring such as for testing drinking water quality, process control and process improvement [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR5">5</xref>]. Natural systems can also be well described by flow cytometry and ecological measures such as diversity and stability indices that were recently established [<xref ref-type="bibr" rid="CR6">6</xref>–<xref ref-type="bibr" rid="CR8">8</xref>]. Flow cytometry was also already used to analyze the mice gut microbiome [<xref ref-type="bibr" rid="CR9">9</xref>] and the human oral microbiome [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>].</p>
    <p>The main concern in all of these applications is to follow microbial population [<xref ref-type="bibr" rid="CR12">12</xref>] or microbial community structure variations. Even machine learning methods have been tested to identify exclusive strains in cytometrically measured in-silico communities [<xref ref-type="bibr" rid="CR13">13</xref>]. As the generation times of microbial cells are very short and change population and community structures rapidly and thus also their interactions with environmental surroundings, information about structure variations need to be obtained in a very short time and in an automated way. Bioinformatics tools such as flowCHIC [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR15">15</xref>] and flowCyBar [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>] were developed to reveal insights into microbial community variations.</p>
    <p>While flowCHIC is an automated approach based on whole dot plot pixel densities and can be used to reveal pairwise structural variations between microbial communities, flowCyBar is based on gate/cell cluster information and provides insight into community structures based on numbers of subcommunities, the position of subcommunities within the dot plot and the number of cells inside subcommunities. flowCyBar allows to follow community evolution and if environmental parameters are involved in the evaluation pipeline, correlation analyses between those and subcommunity cell numbers can be performed in order to reveal functional dependencies. Subcommunities of interest can be flow sorted which allows further cell analysis employing next generation sequencing or proteomic approaches. Therefore, flowCyBar is an essential tool to determine cytometric community characteristics.</p>
    <p>To perform the flowCyBar analysis, subcommunities have to be clustered according to their optical properties. These subcommunities are likely to have a certain function within biological processes and show correlations to certain environmental (abiotic) factors that can be revealed by using flowCyBar. The clustering of these subcommunities is the only step in the evaluation pipeline which is still performed manually in an experience-based and time-consuming way due to the high complexity of the data. Different from standard cytometric data of human samples, where cells are usually differentiated using a variation of labeled antibodies, and of different fluorescent excitations and emissions (resulting in only two or three different subpopulations per each 2D-plot) in bacterial flow cytometry the number of subcommunities can increase to up to 30 in each 2D-plot. Only two parameters (usually a nucleic acid dye and FSC) are sufficient to resolve bacterial community structures and follow their dynamics. The appearance of dozens of different clusters within only two dimensions is only known for bacterial samples and requires specialized evaluation procedures. These clusters provide information on cell abundance changes and anticipated cells can further be processed after cell sorting.</p>
    <p>The automatic definition of that many gates in a 2D-plot is a bottleneck that cannot be solved by existing tools with satisfactory precision. To alleviate this issue, we developed a statistical model-based approach with as few as possible parameters (that <italic>require</italic> user control) that fulfills all the requirements on the outcomes of the clustering procedure of microbial community data.</p>
    <p>Therefore, the approach (i) regards only two channels, (ii) recognizes typically between 10 to 20 clusters by (iii) evaluating high cell numbers per sample (200 000 cells) in a (iv) short time because samples are taken within generation times of bacteria (usually 60 min). The data should be available in-time to allow for on-line monitoring approaches.</p>
  </sec>
  <sec id="Sec2">
    <title>Previous work</title>
    <p>To identify cell clusters, several approaches have been developed in the past three decades. These approaches can be classified into (i) manual, (ii) semiautomatic and (iii) fully automatic approaches.</p>
    <p>(i) Manual approaches are common and are represented by cytometric visualization and evaluation software like the commercially available FCS Express (<ext-link ext-link-type="uri" xlink:href="https://www.denovosoftware.com/">https://www.denovosoftware.com/</ext-link>), the device-specific FloMax (<ext-link ext-link-type="uri" xlink:href="https://www.sysmex-partec.com/">https://www.sysmex-partec.com/</ext-link>), and Summit (Dako Colorado Inc. Summit), or the freeware FlowPy [<xref ref-type="bibr" rid="CR18">18</xref>]. All of these tools provide a 2D graphical representation of cytometric data. The measured parameters (e.g. forward-scatter (FSC) or fluorescence intensity) used as axes of a 2D dot plot can be selected by the user. Each axis is divided into channels representing the signal intensity of an event after amplification. To mark cell clusters, the user can draw rectangle, ellipsoid, quadratic or polygonal regions inside the dot plot. Each of these regions identifies a cell cluster. The counts (number of cells) for each cell cluster can be extracted for further analysis. These approaches are time-consuming and user-dependent as the number of marked cell clusters as well as the position and the size of the marked regions is based on the experience of the user [<xref ref-type="bibr" rid="CR19">19</xref>–<xref ref-type="bibr" rid="CR21">21</xref>].</p>
    <p>(ii) Semiautomatic approaches are represented by cytometric visualization and evaluation software such as FlowJo (<ext-link ext-link-type="uri" xlink:href="https://www.flowjo.com/">https://www.flowjo.com/</ext-link>). Besides the manual marking of cell clusters, FlowJo provides a semiautomatic auto-clustering tool to identify cell clusters based on equal probability distributions which is restricting the shape of the clusters. The user can adjust the size and the shape of each identified cell cluster by moving the mouse over the dot plot and changing the vertices of the polygon gate. The number of clusters that can be identified in this way is not restricted and the counts for each cell cluster can also be extracted for further analysis. As the cell clusters are identified in a semiautomatic way, this approach is less time-consuming but the results still need manual effort by the user and are dependent on the user’s experience.</p>
    <p>(iii) Automated approaches comprise software tools that were developed to provide user-independent and reproducible clustering results of flow cytometry data. Recently, new approaches were developed to achieve clustering results automatically that fit the expectations of the user.</p>
    <p>flowFP [<xref ref-type="bibr" rid="CR22">22</xref>] is using the Probability Binning (PB) algorithm [<xref ref-type="bibr" rid="CR23">23</xref>]. The binning procedure divides the two-dimensional dot plot into rectangular regions (bins) that contain nearly equal numbers of data points. This step of dividing the dot plot areas is performed multiple times based on the number of recursions adjusted by the user.</p>
    <p>SamSPECTRAL [<xref ref-type="bibr" rid="CR24">24</xref>] uses a modified spectral clustering algorithm which is based on data subsampling (faithful sampling), graph-theoretical principles and the k-Means algorithm [<xref ref-type="bibr" rid="CR25">25</xref>]. SamSPECTRAL has the capability of identifying arbitrary shape clusters since it is a non-parametric approach that makes no assumptions on the shape and distribution of clusters. The main parameters of this approach are the scaling parameter <italic>sigma</italic> defining the “resolution” in the spectral clustering stage and the <italic>separation factor</italic> being a threshold that controls to what extend clusters should be combined or kept separated. In principle, with a larger <italic>sigma</italic> smaller clusters will be identified and with a larger <italic>separation factor</italic> more clusters will be identified. Both parameters have to be adjusted properly by the user. A strategy to adjust both parameters by reference to one’s own data is provided in the user manual of the package. The general way is to run SamSPECTRAL multiple times using the same data and to change both parameters until they fit the requirements described in the user manual.</p>
    <p>The concept of flowDensity [<xref ref-type="bibr" rid="CR26">26</xref>] is sequential bivariate clustering. flowDensity estimates the region around cell populations using characteristics of a marker density distribution (e.g. the number, height, and width of peaks and the slope of the distribution curve). Predefined cell subsets are identified based on the density distribution of the parent cell population by analyzing the peaks of the density curve. flowDensity aims to gate predefined cell populations of interest where the clustering strategy is known.</p>
    <p>flowMeans [<xref ref-type="bibr" rid="CR27">27</xref>] is based on the k-Means algorithm. The number of modes is counted in every single dimension followed by multidimensional clustering. Adjacent clusters are merged using Euclidean or Mahalanobis distance and the number of clusters is determined by a segmented regression algorithm to detect the change point in the distance between the merged clusters. As this approach is based on the k-Means algorithm which is not considering cluster distributions, it is used to find equal-sized, non-spherical clusters.</p>
    <p>flowClust [<xref ref-type="bibr" rid="CR21">21</xref>] is using a model-based clustering approach based on the estimation of distribution parameters of clusters by using the Expectation-Maximization (EM) algorithm. The number of clusters to be found can be fixed or determined by using the Bayesian Information Criterion (BIC) in a manual way. The number of data points per cluster is calculated and outliers can be identified by specifying quantiles (e.g. 90<italic>%</italic>) of the clusters. This approach is providing good results for Gaussian distributed cell clusters. An extension, flowMerge [<xref ref-type="bibr" rid="CR28">28</xref>] provides automated selection of the best number of clusters, as well as merging overlapping cluster components.</p>
    <p>FLAME [<xref ref-type="bibr" rid="CR29">29</xref>] is an online software placed on the public server of the Broad Institute (Cambridge, Massachusetts, USA) and is a model-based clustering approach using the EM algorithm to estimate the distribution parameters of clusters. To determine the appropriate number of samples, the Scale-free Weighted Ratio (SWR) was invented. This measure is based on the average Mahalanobis distances, normalized for the distinct variances (which determine shape, dispersion, orientation, etc.) of different clusters, that are computed for pairs of points within and across clusters. FLAME also provides the construction of a global template of clusters which can be used to identify clusters across samples and to follow dynamics.</p>
    <p>From this review, we can draw the conclusion that each of the stated tools has advantages towards manual clustering if the complexity of the data is not that high (e.g. a low number of clusters or a low number of data points) and the information content of the clustering results is restricted to general statements like the membership of a measured cell to one of the identified clusters. Each of these tools has different limitations. Based on the data we work with, and which forms the basis of the later evaluation, we point to the following limitations shared to some degree by the above-mentioned tools. Some of the tools are not practicable for microbial flow cytometry data that are different from medical data. The most important point here is the abundance of clusters we are faced with, while medical data tend to have few, mainly two, clusters in samples. Furthermore, our data have only two channels but a large number of distributed subcommunities within this range. We detect changes in the structure of bacterial communities by counting numbers of subcommunities per 2D-plot by recognizing the position of the subcommunities in the same 2D-plot and by counting cell numbers per subcommunity (technically, per gate). This type of analysis can be performed every few minutes without noticable effort time or financial effort. A wealth of information can be drawn from the clusters if community dynamics (i.e. dense sampling) are pursued.</p>
    <p>Medical applications e.g. in oncology or hematology are the broadest field for the use of flow cytometry. Thus most of the automated approaches were designed to fit the requirements of these data sets. The cells measured in medical applications are relatively big (e.g. size of blood cells is around 10-20 <italic>μ</italic>m) and are usually labeled with differently fluorescent antibodies that specify the cell type. As a result, the cytometric data of one sample provide multiple fluorescence parameters besides the intrinsic cell parameters such as forward-scatter (FSC) or side-scatter (SSC). Several 2D plots are required to describe all cell types in a typical sample. Therefore, the number of gates per one 2D plot is frequently low and does not surpass 3 to 5 subpopulations which can be seen in data sets such as GvHD (graft-versus-host disease [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR30">30</xref>], <ext-link ext-link-type="uri" xlink:href="http://flowrepository.org/id/FR-FCM-ZZY2">http://flowrepository.org/id/FR-FCM-ZZY2</ext-link>) or HSCT (hematopoietic stem cell transplant [<xref ref-type="bibr" rid="CR19">19</xref>], <ext-link ext-link-type="uri" xlink:href="http://flowrepository.org/id/FR-FCM-ZZY6">http://flowrepository.org/id/FR-FCM-ZZY6</ext-link>).</p>
    <p>In microbial applications, in particular in applications of microbial community analyses, the cells are much smaller (0.7-2 <italic>μ</italic>m) and are usually treated with only one fluorescent dye to mark all cells in a community and to separate the cells from noise and debris. Commonly, DAPI (4’,6-di-amidino-2-phenyl-indole) or SYBR Green are used that stain the DNA or the nucleic acid of all cells, respectively. In contrast to the highly resolving DAPI the resolution of microbial communities by SYBR Green is much lower and results mainly in only two subcommunities such as low nucleic acid (LNA) and high nucleic acid (HNA) bacteria. Recently, an attempt was made to resolve these two subcommunities even further by applying a deconvolution model [<xref ref-type="bibr" rid="CR31">31</xref>].</p>
    <p>Instead, the data generated from microbial community measurements using DAPI appear as highly complex system which encompass high numbers of taxonomic entities and fast variations in physiological states of the measured cells [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>]. In addition, DAPI is prone to find rare cell types in a complex community as its fluorescence resolution is of high quality. As a result, the number of clusters within the cytometric dot plot can be very large and their separation becomes a difficult problem.</p>
    <p>Based on our desiderata as mentioned above, this leads to the following requirements on the clustering algorithm: it must (i) be fast enough, (ii) determine the number of gates automatically, (iii) separate cell clusters from background clusters containing irrelevant information, and (iv) calculate the real number of data points for each cell cluster. The previously presented automated approaches hit their limits trying to by fulfill these requirements and do not produce adequate results. As a consequence, the identification of cell clusters is still performed in an experience-based, manual way in microbial flow cytometry. This severely limits the amount of data that can be processed. To improve this situation, we developed flowEMMi, a tool that is able to identify real cell cluster distributions in microbial FCM data quasi on-line in an automated way and to export necessary abundance information of every cell cluster for further analyses.</p>
  </sec>
  <sec id="Sec3">
    <title>Methods and implementation</title>
    <sec id="Sec4">
      <title>Conceptual outline</title>
      <p>Each single cell of a microbial community is visualized as a data point in a two dimensional cytometric dot plot. The cell is described by physiological properties such as cell size measured by forward-scatter (FSC) and number of chromosomes per cell measured by fluorescence intensity using DAPI (4’,6-di-amidino-2-phenyl-indole). Both physiological properties were used in recent studies of complex microbial community systems with success [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR32">32</xref>]. Additional parameters can also be used for evaluation such as cell density (side-scatter (SSC)) or pulse width [<xref ref-type="bibr" rid="CR33">33</xref>, <xref ref-type="bibr" rid="CR34">34</xref>].</p>
      <p>Cell clusters are typically drawn as ellipsoid regions within the dot plot by using cytometric visualization and evaluation software such as Summit or FlowJo. Ellipsoids as geometric boundaries make sense for at least three reasons. (i) They are easy to calculate. (ii) They conform to the way practitioners typically define boundaries of clusters in cytometry e.g. to define cell subsets for cell sorting. (iii) More importantly, an ellipsoidal shape conforms well enough to identified clusters in real data because cells typically distribute as bivariate Gaussian curves [<xref ref-type="bibr" rid="CR33">33</xref>].</p>
      <p>Let <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X \subset \mathbb {R}^{k}$\end{document}</tex-math><mml:math id="M2"><mml:mi>X</mml:mi><mml:mo>⊂</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2019_3152_Article_IEq1.gif"/></alternatives></inline-formula> be the set of data points <italic>x</italic>∈<italic>X</italic> obtained from an experiment. The data considered here typically has <italic>k</italic>=2, since clustering is performed on projections onto two parameters. Ellipsoid regions of arbitrary orientation are described via the equation (<italic>x</italic>−<italic>v</italic>)<sup><italic>T</italic></sup><bold>A</bold>(<italic>x</italic>−<italic>v</italic>)=1 where <italic>v</italic> is the vector-valued position of the center, <bold>A</bold> is a positive definite matrix, and <italic>x</italic> denotes solution vectors to the boundary. The corresponding statistical density function is the multivariate normal <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$P(x) \propto \exp \left (- (x-\mu)^{T} \Sigma ^{-1} (x-\mu) \right)$\end{document}</tex-math><mml:math id="M4"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo><mml:mo>∝</mml:mo><mml:mo>exp</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_3152_Article_IEq2.gif"/></alternatives></inline-formula>. Here <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mu \in \mathbb {R}^{k}$\end{document}</tex-math><mml:math id="M6"><mml:mi>μ</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2019_3152_Article_IEq3.gif"/></alternatives></inline-formula> is the mean, <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\Sigma \in \mathbb {R}^{k \times k}$\end{document}</tex-math><mml:math id="M8"><mml:mi>Σ</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>×</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2019_3152_Article_IEq4.gif"/></alternatives></inline-formula> the covariance matrix, and <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$x \in \mathbb {R}^{k}$\end{document}</tex-math><mml:math id="M10"><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2019_3152_Article_IEq5.gif"/></alternatives></inline-formula> are points whose density is given by <italic>P</italic>(<italic>x</italic>). Having more than one Gaussian distribution leads to a mixture model <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sum _{i} \pi _{i} P_{i}(x)$\end{document}</tex-math><mml:math id="M12"><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_3152_Article_IEq6.gif"/></alternatives></inline-formula>, with <italic>π</italic><sub><italic>i</italic></sub> (<inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\pi _{i} \geq 0, \; \sum \pi _{i} =1$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="2.77626pt"/><mml:mo>∑</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="12859_2019_3152_Article_IEq7.gif"/></alternatives></inline-formula>) describing the weight/probability of each Gaussian. From a statistical point-of-view, multivariate normal distributions provide the framework with which to infer the most likely position of the ellipsoid regions [<xref ref-type="bibr" rid="CR35">35</xref>, <xref ref-type="bibr" rid="CR36">36</xref>]. The parameter space of the model is written more succinctly as <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\theta = (\pi,\{\mu _{1}, \dots, \mu _{n}\},\{\Sigma _{1},\dots,\Sigma _{n}\})$\end{document}</tex-math><mml:math id="M16"><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mi>π</mml:mi><mml:mo>,</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo><mml:mo>,</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_3152_Article_IEq8.gif"/></alternatives></inline-formula> for a mixture model with <italic>n</italic> elements, hence <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}${\log \mathcal {L}}(\theta | X) = P_{\theta } (X)$\end{document}</tex-math><mml:math id="M18"><mml:mo>log</mml:mo><mml:mi mathvariant="script">ℒ</mml:mi><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>|</mml:mo><mml:mi>X</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>X</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_3152_Article_IEq9.gif"/></alternatives></inline-formula>.</p>
      <p>As the real distribution parameters are unknown, all parameters, i.e., mean and covariance for each individual Gaussian and the weight vector <italic>π</italic> have to be estimated. Since no closed form solution exists, an iterative procedure has to be employed. It appears natural to use the expectation-maximization (EM, [<xref ref-type="bibr" rid="CR37">37</xref>]) algorithm which is employed to find maximum likelihood estimates of unknown parameters of statistical models. The estimated parameters might not be the best solution as the EM algorithm is only guaranteed to converge to a <italic>local</italic> optimum.</p>
      <p>In the E (expectation) step (Eq. <xref rid="Equ1" ref-type="">1</xref>), the (<inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\log $\end{document}</tex-math><mml:math id="M20"><mml:mo>log</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_3152_Article_IEq10.gif"/></alternatives></inline-formula>-)likelihood is calculated based on the estimated parameters of each cell cluster of the current iteration. In the M (maximization) step (Eq. <xref rid="Equ2" ref-type="">2</xref>), new parameters of each cell cluster are computed to maximize the (log-) likelihood from the E step.
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  Q(\theta | \theta_{t}) = E_{Z | X,\theta_{t}} {\log \mathcal{L}}(\theta; X, Z)  $$ \end{document}</tex-math><mml:math id="M22"><mml:mi>Q</mml:mi><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>log</mml:mo><mml:mi mathvariant="script">ℒ</mml:mi><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>;</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo>)</mml:mo></mml:math><graphic xlink:href="12859_2019_3152_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>
        <disp-formula id="Equ2">
          <label>2</label>
          <alternatives>
            <tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  \theta_{t+1} = \underset{\theta}{\text{arg\,max}} Q (\theta | \theta_{t})  $$ \end{document}</tex-math>
            <mml:math id="M24">
              <mml:msub>
                <mml:mrow>
                  <mml:mi>θ</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>t</mml:mi>
                  <mml:mo>+</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
              </mml:msub>
              <mml:mo>=</mml:mo>
              <mml:munder>
                <mml:mrow>
                  <mml:mtext>arg max</mml:mtext>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>θ</mml:mi>
                </mml:mrow>
              </mml:munder>
              <mml:mi>Q</mml:mi>
              <mml:mo>(</mml:mo>
              <mml:mi>θ</mml:mi>
              <mml:mo>|</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>θ</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>t</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mo>)</mml:mo>
            </mml:math>
            <graphic xlink:href="12859_2019_3152_Article_Equ2.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>Both steps are performed iteratively until a termination condition is fulfilled by using the following criterion:
<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ |{\log \mathcal{L}}(\theta_{t}) - {\log \mathcal{L}}(\theta_{t-1})| \leq 1  $$ \end{document}</tex-math><mml:math id="M26"><mml:mo>|</mml:mo><mml:mo>log</mml:mo><mml:mi mathvariant="script">ℒ</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mo>log</mml:mo><mml:mi mathvariant="script">ℒ</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:math><graphic xlink:href="12859_2019_3152_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>As the likelihood function is steadily growing, the estimated parameters of each cell cluster are converging toward a local optimum. Upon termination of the algorithm, every two-dimensional data point has a probability to belong to one of the determined cell clusters that are defined by the estimated parameters of the underlying distribution. Due to the steady growth of the log-likelihood function, the EM algorithm only finds one local optimum and has therefore to be initialized several times with different start values. Nevertheless, even after a large number of initializations it is possible that the global optimum for the numbers of initializations will not be found and that the calculated estimates of the parameters are not the best possible solution [<xref ref-type="bibr" rid="CR38">38</xref>].</p>
      <p>Usually, the EM algorithm needs to be initialized with start (prior) values for each distribution parameter in the first (E) step. The number of parameters <italic>k</italic> to be initialized is dependent on the number of clusters <italic>c</italic> and is equal to 6<italic>c</italic>−1. For <italic>c</italic>=20, the user would have to pick 119 start values that also need to fulfill some requirements (e.g. <inline-formula id="IEq11"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sum _{i=1}^{c} \pi _{i} = 1$\end{document}</tex-math><mml:math id="M28"><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="12859_2019_3152_Article_IEq11.gif"/></alternatives></inline-formula>). This is a time-consuming procedure and is prone to cause errors. For an easier initialization we changed the order of the steps by choosing the M step first. Thus, the probabilities of each data point belonging to one of each cluster are randomly sampled from a Dirichlet distribution, which can be used as a prior distribution for the probabilities [<xref ref-type="bibr" rid="CR39">39</xref>] with hyper parameter <italic>α</italic>=1 ensuring that the probabilities of one data point sum up to 1. Based on the probability matrix the distribution parameters are calculated first and in the next step the (log-) likelihood is calculated based on the estimates of the parameters of the first iteration. If good prior distribution parameters are available (after the subsampling procedure, see “<xref rid="Sec8" ref-type="sec">Data reduction – subsampling</xref>” section–Subsampling), these are used instead for the initialization.</p>
    </sec>
    <sec id="Sec5">
      <title>Implementation</title>
      <p>To be able to pass objects from R to C++ and back and to achieve an efficient implementation of the EM algorithm we used Rcpp [<xref ref-type="bibr" rid="CR40">40</xref>] and the EigenC++ template library (version 3.3.3) which is provided by the RcppEigen package (version 0.3.3.3.1, [<xref ref-type="bibr" rid="CR41">41</xref>]). As the EM algorithm is based on linear algebra operations, including matrix-vector and matrix-matrix operations, RcppEigen enables convenient access to a high-performance framework to implement these operations efficiently. This package needs to be installed to the R library and is essential for the use of flowEMMi.</p>
      <p>Other packages that need to be installed to the R library for reading and working with the standardized .fcs files, visualizing the cytometric dot plots, calculating the statistical significance of the results and for the random initialization of the EM algorithm are flowCore [<xref ref-type="bibr" rid="CR42">42</xref>], flowViz [<xref ref-type="bibr" rid="CR43">43</xref>], ggplot2 [<xref ref-type="bibr" rid="CR44">44</xref>], randomcoloR [<xref ref-type="bibr" rid="CR45">45</xref>], mixtools [<xref ref-type="bibr" rid="CR46">46</xref>] and gtools [<xref ref-type="bibr" rid="CR47">47</xref>].</p>
    </sec>
    <sec id="Sec6">
      <title>Removal of technical noise and beads</title>
      <p>Technical noises (such as instrumental noise and cell debris) are unavoidable during a cytometric measurement. These are represented by extremely low fluorescence value or scatter signals in each dot plot. Before automatic determination of gates, such technical noises should be removed, in addition to the scatter and fluorescence signals of beads, which are implemented in each measurement for the alignment of samples. In this study, technical noises and beads per sample were removed with three steps (Fig. <xref rid="Fig1" ref-type="fig">1</xref>) by the software FlowJo (<ext-link ext-link-type="uri" xlink:href="https://www.flowjo.com/">https://www.flowjo.com/</ext-link>).
<fig id="Fig1"><label>Fig. 1</label><caption><p>Steps for removing noise and beads from the cytometric dot plot. <bold>a</bold> Technical noise removed by setting a parent gate in forward-scatter vs. side-scatter. <bold>b</bold> Technical noise removed by setting a parent gate in forward-scatter vs. DAPI fluorescence. <bold>c</bold> Beads removed in forward-scatter vs. DAPI fluorescence. <bold>d</bold> Cytometric dot plot only containing cells used as input for flowEMMi</p></caption><graphic xlink:href="12859_2019_3152_Fig1_HTML" id="MO1"/></fig></p>
      <p>First, all events were visualized in the 2D-dot plot of forward-scatter (FSC) vs. side-scatter (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a), and a parent gate (FSC-SSC) was set to remove technical noises from FSC and SSC channels. Second, similarly, technical noise from the channel of the DAPI fluorescence was removed by setting a parent gate (FSC-DAPI) in the 2D-dot plot of FSC vs. DAPI fluorescence (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). Third, bead events were removed via specific gates (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c) with the goal of retaining only events that represent cells (Fig. <xref rid="Fig1" ref-type="fig">1</xref>, d). Once created, the FlowJo workspace containing all these steps can be saved and automatically applied to all samples of the experiment. The final data, only containing cell events, are used as input for flowEMMi.</p>
    </sec>
    <sec id="Sec7">
      <title>Finding the best number of clusters</title>
      <p>In microbial flow cytometry a large number of clusters within one sample is very common. Furthermore, the actual number of clusters is unknown independent of the complexity of the data. To overcome the obstacle of a manual selection, flowEMMi was designed to determine this number automatically. Since the number of clusters is unknown, a (usually larger) range (e.g. <inline-formula id="IEq12"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$c \in \{2, \dots, 20\}$\end{document}</tex-math><mml:math id="M30"><mml:mi>c</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>20</mml:mn><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_3152_Article_IEq12.gif"/></alternatives></inline-formula>) has to be defined by the user to find all clusters at the first run of flowEMMi. A larger range is recommended because flowEMMi should generally have no parameters that need tuning and return the most appropriate number of clusters regardless of whether it is low or high. This prevents time-consuming initializations of the EM algorithm and an overestimation with excessive numbers of clusters.</p>
      <p>To determine the most appropriate number of clusters we used the Bayesian Information Criterion (BIC, [<xref ref-type="bibr" rid="CR48">48</xref>, <xref ref-type="bibr" rid="CR49">49</xref>]). Besides other model selection criteria like the Integrated Complete-data Likelihood (ICL) or Slope Heuristics, the BIC is known to provide the true number of clusters for Gaussian mixture models in most cases [<xref ref-type="bibr" rid="CR35">35</xref>]. Such selection criteria have been used successfully before [<xref ref-type="bibr" rid="CR28">28</xref>]. Equation <xref rid="Equ4" ref-type="">4</xref> describes of calculation of the BIC for <italic>c</italic> clusters, with <inline-formula id="IEq13"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}${\mathcal {L}}(\theta)$\end{document}</tex-math><mml:math id="M32"><mml:mi mathvariant="script">ℒ</mml:mi><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_3152_Article_IEq13.gif"/></alternatives></inline-formula> being the achieved likelihood for a model <italic>θ</italic> with <italic>c</italic> clusters, <italic>k</italic> parameters and <italic>i</italic> data points.
<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  {\text{BIC}(\theta)} = -2 {\log \mathcal{L}}(\theta) + k \log i  $$ \end{document}</tex-math><mml:math id="M34"><mml:mtext>BIC</mml:mtext><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo>log</mml:mo><mml:mi mathvariant="script">ℒ</mml:mi><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo>log</mml:mo><mml:mi>i</mml:mi></mml:math><graphic xlink:href="12859_2019_3152_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>The BIC curve can be plotted and shows the BIC value for each number of clusters <italic>c</italic>. In most cases, the curve has a positive exponential trend and for a particular <italic>c</italic> the trend of the curve is getting nearly linear. Thus, the value of <italic>c</italic> at this point gives a good hint about the most appropriate number of clusters within the sample. Therefore, we defined a threshold for the difference of the BIC value between <italic>c</italic> and <italic>c</italic>+1 for the whole range of <italic>c</italic>. If this difference is below 50 for the first time for the whole range of <italic>c</italic> then this particular value of <italic>c</italic> is considered as the most appropriate number of clusters <italic>c</italic><sub>BIC≤50</sub> for a given parameter set <inline-formula id="IEq14"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\theta _{c=1}, \dots, \theta _{c=n}$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2019_3152_Article_IEq14.gif"/></alternatives></inline-formula> where we suppress the individual <italic>θ</italic>’s in the notation below:
<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  c_{\text{BIC}\leq50} = \underset{c}{\text{arg\,min}} \left(| \text{BIC}(c) - \text{BIC}(c+1) | \leq 50 \right)  $$ \end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mtext>BIC</mml:mtext><mml:mo>≤</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>arg min</mml:mtext></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:munder><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>|</mml:mo><mml:mtext>BIC</mml:mtext><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mtext>BIC</mml:mtext><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="12859_2019_3152_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Nevertheless, it is possible to select a higher value for <italic>c</italic> than suggested by the BIC. A higher value would mean that more clusters are found but the increase of information/likelihood of the model is only marginal.</p>
    </sec>
    <sec id="Sec8">
      <title>Data reduction – subsampling</title>
      <p>The running time of the EM algorithm is dependent on the dimension of the data points, the initialization values of the model parameters (<italic>π</italic>, <italic>μ</italic>, <italic>Σ</italic>), the number of data points <italic>i</italic> and the number of clusters <italic>c</italic> to be found. The dimension is constant and as the initialization values are sampled randomly (see section Idea, last paragraph), the effect on the running time of the EM cannot be determined or adjusted from the very start. Good initialization values result in a low number of iterations and therefore decrease the running time whereby poor initialization values result in a high number of iterations and therefore increase the running time.</p>
      <p>The number of data points <italic>i</italic> used for the clustering can be adjusted and has a notable and measurable influence on the running time. It was shown before that the results of the EM running on a subset of all data points is likely to provide distribution parameters that differ not that much from the distribution parameters resulting from the EM running on all data points [<xref ref-type="bibr" rid="CR50">50</xref>]. As the measurement of the cells does not follow a certain order (e.g. small cells first, big cells last), the data used as input for the EM are unordered, too.</p>
      <p>Thus, a subset of cells can easily be selected by choosing e.g. every 20<sup><italic>t</italic><italic>h</italic></sup> data point of the full data set. With the selection of a subset it is possible to reduce the running time of the EM in order to rapidly get a good approximation for the estimates of the model parameters (<italic>π</italic>, <italic>μ</italic>, <italic>Σ</italic>) of each cluster <italic>c</italic>. For the evaluation of flowEMMi we used samples containing 200 000 cells (without noise and beads) which ensures a high statistical significance of the appearance of cells in respective segregated subsets. Measuring fewer cells produces less precise statistical data, therefore, subsampling is recommended instead of working with fewer measured cell numbers per sample. By creating a subset with, say, every 20<sup><italic>t</italic><italic>h</italic></sup> data point big clusters will still be visible and detected by flowEMMi. Only those clusters with a very low abundance may get lost. By combining the subsampling procedure with the BIC (see “<xref rid="Sec7" ref-type="sec">Finding the best number of clusters</xref>” section), the best number of clusters <italic>c</italic> can also be determined automatically in a very short time.</p>
      <p>Consequently, the reduction of the number of data points and the use of the BIC reduces the running time of the EM and provides the most appropriate value for the number of clusters <italic>c</italic> as well as estimates for the model parameters of each cluster (<italic>π</italic>,<italic>μ</italic>,<italic>Σ</italic>). After this step, these outcomes can be used as already fitted initialization values for the EM running on the full data set thus preventing an elaborate and inaccurate initialization. In addition, instead of random initialization values for samples with similar structures the same fitted initialization values can be used as input which further increases comparison between samples and decreases the running time substantially.</p>
    </sec>
    <sec id="Sec9">
      <title>Data separation</title>
      <p>Another important step is to eliminate irrelevant data points occurring from technical noise, beads or cell debris. These data points are not needed for the analysis of the cell clusters and therefore have to be separated from the real data representing the cells (see “<xref rid="Sec6" ref-type="sec">Removal of technical noise and beads</xref>” section). In addition, not all cells cluster as condensed ellipsoid regions and are instead more evenly distributed across the dot plot. As every cluster algorithm generally is designed to assign every data point to one cluster, a mixed model was developed to create a background model for the evenly distributed data points and a foreground model for the relevant cell data points.</p>
      <p>Cell clusters form condensed ellipsoid regions within the dot plot but the data points of a background cluster spread over a large area. Thus, the variance (of the main diagonal of) <italic>Σ</italic> of a cell cluster distribution is much smaller than the variance of a background cluster distribution. A threshold can be defined to separate the clusters with very high variance from the clusters with smaller variance. A maximum standard deviation <italic>σ</italic> (square root of variance) value is predefined to separate background clusters from foreground clusters but can be changed by the user if required e.g. if only very small clusters (rare subcommunities) or bigger clusters (dominant subcommunities) should be found. We default to a setting where a cluster is set as a background cluster if <inline-formula id="IEq15"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\min _{d}(\sqrt {\Sigma _{d,d}}) \geq \; 2\,500$\end{document}</tex-math><mml:math id="M40"><mml:munder><mml:mrow><mml:mo>min</mml:mo></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:munder><mml:mo>(</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msqrt><mml:mo>)</mml:mo><mml:mo>≥</mml:mo><mml:mspace width="2.77626pt"/><mml:mn>2</mml:mn><mml:mspace width="0.3em"/><mml:mn>500</mml:mn></mml:math><inline-graphic xlink:href="12859_2019_3152_Article_IEq15.gif"/></alternatives></inline-formula>.</p>
      <p>Nevertheless, it was shown that the cell numbers of background distributions, denoted as off-gate cells, are of importance as they can be an indicator for occurring disturbances in microbial systems [<xref ref-type="bibr" rid="CR4">4</xref>]. For this reason, the off-gate cell number of all background clusters is saved in a readable text file besides all cell numbers of the detected cell clusters and can be used for further analyses.</p>
    </sec>
    <sec id="Sec10">
      <title>Calculation of cell numbers/Confidence intervals</title>
      <p>After the clustering procedure, the reduction of the data set, and the separation of background clusters, some cell clusters may not have a clear ellipsoid shape and can also contain outliers. For Gaussian distributions, the calculation of confidence intervals [<xref ref-type="bibr" rid="CR51">51</xref>] is a statistically legitimate way to select data points having a certain significance for being part of an identified cluster. As a confidence interval is the complement of the level of significance (usually called p-value), a 95<italic>%</italic> confidence interval reflects a significance level of 0.05 which is most commonly used in statistics [<xref ref-type="bibr" rid="CR52">52</xref>].</p>
      <p>For multivariate Gaussian distributions the confidence interval of each cell cluster <italic>c</italic> is determined by its mean vector <italic>μ</italic> and its covariance matrix <italic>Σ</italic>. Based on these distribution parameters, the data points lying inside the confidence interval <italic>q</italic>=1−<italic>p</italic> can be calculated using the following equation.
<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  \text{color}(x) = \underset{c}{\text{arg\,max}} \mathcal{N}(x|\mu_{c},\Sigma_{c})  $$ \end{document}</tex-math><mml:math id="M42"><mml:mtext>color</mml:mtext><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>arg max</mml:mtext></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:munder><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><graphic xlink:href="12859_2019_3152_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>A point <italic>x</italic> is considered to be part of the confidence interval for the color <italic>c</italic>, if the following two Dirac- <italic>δ</italic>-functions determine that both, the optimal color for <italic>x</italic> is <italic>c</italic>, and the scaled density is higher than <italic>q</italic>.
<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  {}\text{confident}(x,c) \,=\, \delta(c=\text{color}(x)) \delta(\mathcal{N}(x|\mu_{c},\Sigma_{c})(1-\pi_{c}) \!\geq\! q)  $$ \end{document}</tex-math><mml:math id="M44"><mml:mtext>confident</mml:mtext><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>)</mml:mo><mml:mspace width="0.3em"/><mml:mo>=</mml:mo><mml:mspace width="0.3em"/><mml:mi>δ</mml:mi><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mtext>color</mml:mtext><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mi>δ</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mspace width="0.3em"/><mml:mo>≥</mml:mo><mml:mspace width="0.3em"/><mml:mi>q</mml:mi><mml:mo>)</mml:mo></mml:math><graphic xlink:href="12859_2019_3152_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>As a consequence, the shape of the data points enclosed by the confidence interval is elliptic. If required, the user can change the confidence level (e.g. to 90<italic>%</italic> or 99<italic>%</italic>). After the calculation of the confidence intervals, the numbers of data points of each cell cluster are saved in a .txt file. These numbers can be used to compare the result of the automated clustering with the results of the manual clustering and for further analyses.</p>
    </sec>
  </sec>
  <sec id="Sec11">
    <title>Results and conclusion</title>
    <p>A real FCM sample set containing 10 samples (<ext-link ext-link-type="uri" xlink:href="http://flowrepository.org/id/FR-FCM-ZYK9">http://flowrepository.org/id/FR-FCM-ZYK9</ext-link>) was used to investigate if the methods described above provide adequate results and make our tool flowEMMi suitable for automatic clustering in cytometric microbial community data. In this section, the sample InTH_160712_025.fcs (Fig. <xref rid="Fig1" ref-type="fig">1</xref>) was used representatively. The clustering results of the other 9 samples can be found in the Supplementary information (Additional files <xref rid="MOESM1" ref-type="media">1</xref>, <xref rid="MOESM2" ref-type="media">2</xref>, <xref rid="MOESM3" ref-type="media">3</xref>, <xref rid="MOESM4" ref-type="media">4</xref>, <xref rid="MOESM5" ref-type="media">5</xref>, <xref rid="MOESM6" ref-type="media">6</xref>, <xref rid="MOESM7" ref-type="media">7</xref>, <xref rid="MOESM8" ref-type="media">8</xref>, <xref rid="MOESM9" ref-type="media">9</xref>, and <xref rid="MOESM10" ref-type="media">10</xref>).</p>
    <p>First, we tested whether the optimal number of clusters <italic>c</italic> can be determined using the BIC. To achieve good approximations for the number of clusters <italic>c</italic> as well as for the estimates of the model parameters of each cluster (<italic>π</italic>, <italic>μ</italic>, <italic>Σ</italic>) in this sample, the EM algorithm was initialized with a subsample of all data points (every 40<sup><italic>t</italic><italic>h</italic></sup> data point) and randomly sampled cluster probabilities for each data point. Before subsampling, technical noise and beads were removed. After removing noise and beads 200 000 data points remained in the .fcs file. As only every 40<sup><italic>t</italic><italic>h</italic></sup> data point was used in this step this means that only 5 000 data points were used as input of flowEMMi. As the real number of clusters <italic>c</italic> was unknown the minimum number of clusters to be found was set to 2 and the maximum number of clusters to be found was set to 20. Figure <xref rid="Fig2" ref-type="fig">2</xref> shows the results of flowEMMi after subsampling and calculation of the BIC.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Results of flowEMMi after subsampling and calculation of the BIC for the sample shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref> with separation of cell clusters and background clusters. Background clusters are not encircled and have a gray colour. <bold>a</bold> Curve of the BIC value shown for <inline-formula id="IEq16"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$c \in \{2 \dots 20\}$\end{document}</tex-math><mml:math id="M46"><mml:mi>c</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>2</mml:mn><mml:mo>…</mml:mo><mml:mn>20</mml:mn><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_3152_Article_IEq16.gif"/></alternatives></inline-formula>. <bold>b</bold>R dot plot with linear axes values from 0 to 65 536 containing only every 40<sup><italic>t</italic><italic>h</italic></sup> data point. <bold>c</bold> Clustering result of flowEMMi for <italic>c</italic>=13 calculated as the most appropriate number of clusters with 10 cell clusters and 3 background clusters. <bold>d</bold> Clustering result of flowEMMi for <italic>c</italic>=5 with 4 cell clusters and 1 background cluster. <bold>e</bold> Clustering result of flowEMMi for <italic>c</italic>=20 with 14 cell clusters and 6 background clusters</p></caption><graphic xlink:href="12859_2019_3152_Fig2_HTML" id="MO2"/></fig></p>
    <p>To show the impact on the choice of the number of clusters we provide, in addition to the estimated number of <italic>c</italic>=13 clusters (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c), two extra clustering results. One result gave a very low number of <italic>c</italic>=5 clusters (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d), and the other of <italic>c</italic>=20 which are too many clusters (Fig. <xref rid="Fig2" ref-type="fig">2</xref>e). <italic>c</italic>=13 seems to be an appropriate value as the trend of the BIC curve is nearly linear after this point. The difference of the BIC value between <italic>c</italic>=13 and <italic>c</italic>=14 is below 50 for the first time for the whole range of <italic>c</italic>. This result can be derived by looking at the plot of the BIC curve (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a) as well as output information of flowEMMi.</p>
    <p>As the number of data points in the subsampling step is only <inline-formula id="IEq17"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$1 \over 40$\end{document}</tex-math><mml:math id="M48"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>40</mml:mn></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2019_3152_Article_IEq17.gif"/></alternatives></inline-formula> of the original number it is possible that some clusters are missed after subsampling. Due to that and the possibility that one or more clusters may be identified as background clusters in the full data run, <italic>c</italic>=13 can be seen as a very conservative value which allows to identify the main clusters. If the user wants to detect rare clusters the number of clusters to be found should be set higher than suggested by the BIC for the full data run (e.g. <inline-formula id="IEq18"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$c \in \{13, \dots, 16\}$\end{document}</tex-math><mml:math id="M50"><mml:mi>c</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>13</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>16</mml:mn><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_3152_Article_IEq18.gif"/></alternatives></inline-formula>). We can say that the first run of flowEMMi using a subsampled data set and the BIC provided the appropriate value for the number of clusters <italic>c</italic> as shown by the BIC curve (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a) and good approximations for the parameter estimates (<italic>π</italic>, <italic>μ</italic>, <italic>Σ</italic>) of each cluster. These data are saved as output of flowEMMi and can be used as prior parameters for the full data run.</p>
    <p>Then it was tested if the subsampling procedure decreases the running time by providing good estimates for the number of clusters <italic>c</italic> and good approximations for the parameter estimates of each cluster. flowEMMi was executed three times without and with usage of the subsampling procedure. Both ways were compared by measuring the total running times as well as the numbers of iterations for each of the three runs needed for <inline-formula id="IEq19"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$c \in \{13, \dots, 16\}$\end{document}</tex-math><mml:math id="M52"><mml:mi>c</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>13</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>16</mml:mn><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_3152_Article_IEq19.gif"/></alternatives></inline-formula>. Without subsampling flowEMMi was initialized with a range for the number of clusters to find <inline-formula id="IEq20"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$c \in \{2, \dots, 20\}$\end{document}</tex-math><mml:math id="M54"><mml:mi>c</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>20</mml:mn><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_3152_Article_IEq20.gif"/></alternatives></inline-formula> with only one initialization. With subsampling, the same range was defined and 10 random initializations were executed. Then, the outputs of the subsampling procedure were used as input for the full data run with a smaller range for <inline-formula id="IEq21"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$c \in \{13, \dots, 16\}$\end{document}</tex-math><mml:math id="M56"><mml:mi>c</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>13</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>16</mml:mn><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_3152_Article_IEq21.gif"/></alternatives></inline-formula> and only one initialization was executed to keep the comparability to the values achieved without subsampling. Table <xref rid="Tab1" ref-type="table">1</xref> shows the outcomes of this comparison.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Comparison of running time without and with usage of the subsampling procedure. Mean values (mean) and standard deviations (SD) of the total running time and the number of iterations for <inline-formula id="IEq22"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$c \in \{13, \dots, 16\}$\end{document}</tex-math><mml:math id="M58"><mml:mi>c</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>13</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>16</mml:mn><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_3152_Article_IEq22.gif"/></alternatives></inline-formula> were calculated based on three executions of flowEMMi, respectively</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left" colspan="2">Number of iterations for <inline-formula id="IEq23"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$c \in \{13, \dots, 16\}$\end{document}</tex-math><mml:math id="M60"><mml:mi>c</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>13</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>16</mml:mn><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_3152_Article_IEq23.gif"/></alternatives></inline-formula></th><th align="left" colspan="2">Total running time (mm:ss)</th></tr></thead><tbody><tr><td align="left"/><td align="left">mean</td><td align="left">SD</td><td align="left">mean</td><td align="left">SD</td></tr><tr><td align="left">without subsampling</td><td align="left">228</td><td align="left">83</td><td align="left">24:11</td><td align="left">00:24</td></tr><tr><td align="left">with subsampling</td><td align="left">102</td><td align="left">31</td><td align="left">05:31</td><td align="left">00:34</td></tr></tbody></table></table-wrap></p>
    <p>We can draw the conclusion that the subsampling procedure decreases the number of iterations needed for <inline-formula id="IEq24"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$c \in \{13, \dots, 16\}$\end{document}</tex-math><mml:math id="M62"><mml:mi>c</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>13</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>16</mml:mn><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_3152_Article_IEq24.gif"/></alternatives></inline-formula> up to approximately 60<italic>%</italic> with a much smaller standard deviation and the total running time up to approximately 75<italic>%</italic> with a nearly similar standard deviation. Therefore, we strongly recommend to use the subsampling procedure in order to achieve good results in a short time.</p>
    <p>In the next step, the full data set is used as input with the extended range for <inline-formula id="IEq25"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$c \in \{13 \dots 16\}$\end{document}</tex-math><mml:math id="M64"><mml:mi>c</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>13</mml:mn><mml:mo>…</mml:mo><mml:mn>16</mml:mn><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_3152_Article_IEq25.gif"/></alternatives></inline-formula> to find rare clusters as calculated by the BIC and the prior parameter estimates of each cluster as calculated before by use of the subsampling procedure. Now, an additional threshold was defined to separate cell clusters from background. Figure <xref rid="Fig3" ref-type="fig">3</xref> shows the final clustering results of flowEMMi running on the full data set.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Final result of flowEMMi using prior distribution parameters achieved from the subsamling procedure and an extended range of <inline-formula id="IEq26"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$c \in \{13 \dots 16\}$\end{document}</tex-math><mml:math id="M66"><mml:mi>c</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>13</mml:mn><mml:mo>…</mml:mo><mml:mn>16</mml:mn><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_3152_Article_IEq26.gif"/></alternatives></inline-formula> achieved from the BIC to find rare cell clusters. <bold>a</bold>R dot plot with linear axes values from 0 to 65 536 containing all data points. <bold>b</bold> Clustering result of flowEMMi for <italic>c</italic>=14 with 12 cell clusters and 2 background clusters. Background clusters are not encircled and have a gray colour</p></caption><graphic xlink:href="12859_2019_3152_Fig3_HTML" id="MO3"/></fig></p>
    <p>Only clusters with a standard deviation below the threshold value are marked as cell clusters and are plotted in colors distinct from the gray background. In the next section, a benchmark procedure is performed to compare these final results i) to the results of manual clustering using FlowJo and ii) to the results obtained by the other tools.</p>
    <p>
      <bold>
        <italic>Benchmarking</italic>
      </bold>
    </p>
    <p>To compare the results of flowEMMi with the manual clustering procedure, the sample InTH_160712_025 (Figs. <xref rid="Fig1" ref-type="fig">1</xref>, <xref rid="Fig2" ref-type="fig">2</xref> and <xref rid="Fig3" ref-type="fig">3</xref>) was clustered independently by five expert users to identify the number of clusters, the range of the abundance values of all clusters and the percentage of background and foreground cell numbers based on 200 000 cells. For manual clustering the commercial program FlowJo was used and for comparison with the data generated by flowEMMi the data were biexponential transformed as by default. the following formula was used: 10 <sup>(mean/(65 536/4))</sup>. Note: The value of 65 536 corresponds to the resolution of the cytometer device (here: InFlux, BD Bioscience, New Jersey, USA). For comparison, only those clusters found by flowEMMi that have the same or similar mean values in both parameters (FSC and DAPI-Fluorescence) as the clusters found by manual clustering are considered and counted. Table <xref rid="Tab2" ref-type="table">2</xref> shows the outcome of this comparison. The mean values of each cluster calculated by FlowJo and flowEMMi are given in the additional file 025.csv which is part of the file tables.tar.gz.
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Comparison of clustering results from manual clustering performed by 5 experts using FlowJo and automated clustering using flowEMMi</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left"># clusters</th><th align="left">Range of abundances (%)</th><th align="left" colspan="2">Cell numbers (%)</th><th align="left"># congruent clusters</th></tr><tr><th align="left"/><th align="left"/><th align="left"/><th align="left">Foreground</th><th align="left">Background</th><th align="left"/></tr></thead><tbody><tr><td align="left">flowEMMi</td><td align="left">12</td><td align="left">1.56 - 20.72</td><td align="left">71.6</td><td align="left">28.4</td><td align="left">12</td></tr><tr><td align="left">User 1</td><td align="left">13</td><td align="left">0.25 - 27.7</td><td align="left">76.5</td><td align="left">23.5</td><td align="left">10</td></tr><tr><td align="left">User 2</td><td align="left">15</td><td align="left">0.21 - 30.0</td><td align="left">82.1</td><td align="left">17.9</td><td align="left">11</td></tr><tr><td align="left">User 3</td><td align="left">13</td><td align="left">0.24 - 28.2</td><td align="left">79.1</td><td align="left">20.9</td><td align="left">11</td></tr><tr><td align="left">User 4</td><td align="left">16</td><td align="left">0.26 - 31.2</td><td align="left">90.7</td><td align="left">9.3</td><td align="left">11</td></tr><tr><td align="left">User 5</td><td align="left">15</td><td align="left">0.22 - 32.1</td><td align="left">91.6</td><td align="left">8.4</td><td align="left">11</td></tr></tbody></table><table-wrap-foot><p>Compared were i) the number of clusters that were found, ii) the range of the abundance values of all clusters, iii) the cell numbers of foreground/background cell and iv) the number of congruent clusters that were found by the user and flowEMMi, respectively. Congruent clusters are cell clusters having the same or similar mean values in both parameters (FSC and DAPI-Fluorescence)</p></table-wrap-foot></table-wrap></p>
    <p>It can be seen that the number of cell clusters found by the expert users is in the similar range of the 12 clusters found by flowEMMi and varying from 13 to 16. The range of abundances and the proportions of foreground and background cell numbers is slightly in favor of the expert users which covered more cells within the clusters. Further 9 samples were tested in this regard. The outcomes can be seen in the Supplementary information. For flowEMMi and all previously introduced automated clustering tools (flowFP, SamSPECTRAL, flowDensity, flowMeans, flowClust and FLAME) we also compared the running time, the abilities to determine the number of cell clusters automatically, to separate cell clusters from background clusters and to calculate the cell numbers for each cell cluster. Table <xref rid="Tab3" ref-type="table">3</xref> shows the results of this comparison.
<table-wrap id="Tab3"><label>Table 3</label><caption><p>Comparison of automated clustering approaches</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Tool</th><th align="left">Running time (h:mm:ss) <sup><italic>a</italic></sup></th><th align="left" colspan="4">Output features</th></tr><tr><th align="left"/><th align="left"/><th align="left">Determine number of clusters</th><th align="left">Shape of clusters</th><th align="left">Separate background</th><th align="left">Calculate cell numbers</th></tr></thead><tbody><tr><td align="left">flowEMMi</td><td align="left">0:05:31</td><td align="left">yes</td><td align="left">ellipsoid</td><td align="left">yes</td><td align="left">yes</td></tr><tr><td align="left">flowFP</td><td align="left">0:00:03</td><td align="left">no</td><td align="left">rectangular</td><td align="left">no</td><td align="left">not applicable</td></tr><tr><td align="left">SamSPECTRAL</td><td align="left">0:06:25</td><td align="left">space-part.</td><td align="left">arbitrary</td><td align="left">no</td><td align="left">not applicable</td></tr><tr><td align="left">flowDensity</td><td align="left">0:00:02</td><td align="left">no</td><td align="left">rectangular</td><td align="left">no</td><td align="left">not applicable</td></tr><tr><td align="left">flowMeans</td><td align="left">0:00:17</td><td align="left">space-part.</td><td align="left">non-spherical</td><td align="left">no</td><td align="left">not applicable</td></tr><tr><td align="left">flowClust</td><td align="left">1:15:30</td><td align="left">yes</td><td align="left">ellipsoid</td><td align="left">no</td><td align="left">yes</td></tr><tr><td align="left">flowMerge</td><td align="left">(Table <xref rid="Tab4" ref-type="table">4</xref>)</td><td align="left">yes</td><td align="left">ellipsoid</td><td align="left">yes</td><td align="left">yes</td></tr><tr><td align="left">FLAME</td><td align="left">−<sup>∗</sup></td><td align="left">−<sup>∗</sup></td><td align="left">−<sup>∗</sup></td><td align="left">−<sup>∗</sup></td><td align="left">−<sup>∗</sup></td></tr></tbody></table><table-wrap-foot><p>Automated approaches were compared regarding the running time and the abilities to identify rare cell types, to separate cell clusters from background clusters and to calculate the real cell numbers for each cell cluster. <sup><italic>a</italic></sup> Running time calculated on a Intel(R) Core(TM) i5-3210M CPU @ 2.5 GHz with 4096MB RAM and Windows 7 Enterprise 64-Bit Edition. FLAME: “ −<sup>∗</sup>” denotes that no results were received as our submitted “jobs” were always in the queue for several days and later cancelled by the server. flowEMMi is the implementation discussed in this work. <italic>space-part.</italic> denotes k-means type algorithms that do not produce tight clusters</p></table-wrap-foot></table-wrap></p>
    <p>In addition to this table, the clustering results of all tools are displayed in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. Results for flowMerge have been separated out into Table <xref rid="Tab4" ref-type="table">4</xref> and Additional file <xref rid="MOESM11" ref-type="media">11</xref>, as flowMerge has a similar feature set. From a user standpoint, the better F <sub>1</sub> measure and vastly improved running times of flowEMMi are most important.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Results of clustering tools. <bold>a</bold> Result of flowEMMi. 12 cell clusters and 2 background cluster were identified. <bold>b</bold> Result of flowFP for 4 recursion = 16 clusters. <bold>c</bold> Result for SamSPECTRAL with adjusted parameters (<italic>σ</italic>=1 000, separation=0.3) and automatically determined number of clusters. <bold>d</bold> Result of flowDensity with overlapping densities. <bold>e</bold> Result of flowMeans with Voronoi like cluster shapes (MaxN=20). <bold>f</bold> Result of flowClust with automatically determined best number of clusters for <inline-formula id="IEq27"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$c \in \{2 \dots 20\}$\end{document}</tex-math><mml:math id="M68"><mml:mi>c</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>2</mml:mn><mml:mo>…</mml:mo><mml:mn>20</mml:mn><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_3152_Article_IEq27.gif"/></alternatives></inline-formula> (cf. detailed analysis of flowMerge in Table <xref rid="Tab4" ref-type="table">4</xref> and discussion)</p></caption><graphic xlink:href="12859_2019_3152_Fig4_HTML" id="MO4"/></fig>
<table-wrap id="Tab4"><label>Table 4</label><caption><p>Running times and F <sub>1</sub> score aggregated over experiments with different <italic>ε</italic> stopping criteria</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Label</th><th align="left"><italic>ε</italic>≤</th><th align="left">Time (mean)</th><th align="left">Time (sd)</th><th align="left">F <sub>1</sub> score (mean)</th><th align="left">F <sub>1</sub> (sd)</th></tr></thead><tbody><tr><td align="left">flowEMMi</td><td align="left">1.0</td><td align="left">528</td><td align="left">53</td><td align="left">0.56</td><td align="left">0.18</td></tr><tr><td align="left">flowEMMi</td><td align="left">0.01</td><td align="left">1 080</td><td align="left">214</td><td align="left">0.59</td><td align="left">0.17</td></tr><tr><td align="left">flowEMMi</td><td align="left">10<sup>−5</sup></td><td align="left">1 445</td><td align="left">182</td><td align="left">0.56</td><td align="left">0.17</td></tr><tr><td align="left">flowMerge</td><td align="left">1.0</td><td align="left">8 391</td><td align="left">3 239</td><td align="left">0.54</td><td align="left">0.24</td></tr><tr><td align="left">flowMerge</td><td align="left">0.01</td><td align="left">8 951</td><td align="left">3 597</td><td align="left">0.51</td><td align="left">0.17</td></tr><tr><td align="left">flowMerge</td><td align="left">10<sup>−5</sup></td><td align="left">56 652</td><td align="left">53 379</td><td align="left">0.54</td><td align="left">0.17</td></tr></tbody></table><table-wrap-foot><p>Times and F <sub>1</sub> scores (and their standard deviation (sd)) are aggregated over four experiments and 5 expert user gatings, each. Note that the default flowMerge stopping criterion of 10<sup>−5</sup> yields running times in excess of 1 day. flowEMMi consistently yields better F <sub>1</sub> measures with an average improvement of 4<italic>%</italic> to 16<italic>%</italic> over flowMerge, with much better running times, easily yielding speed improvements of ×8 – ×15 or better. For both algorithms, having a more stringent EM stopping criterion tends to increase the F <sub>1</sub> score, however especially for flowMerge at prohibitive running time costs</p></table-wrap-foot></table-wrap></p>
    <p>Table <xref rid="Tab3" ref-type="table">3</xref> and Fig. <xref rid="Fig4" ref-type="fig">4</xref> show that none of the other tools used for this comparison can separate cell clusters from background clusters. This is important as not only the cell numbers of real cell clusters can be used for further evaluation tools but also background cells as additional information which is useful for some applications. Both, the number of predicted cell clusters, and the relative number of cells, predicted to be part of clusters are important. As such, any tool that severely underestimates the number of clusters will almost certainly mispredict the number of cells that form clusters which makes downstream analysis complicated and can lead to misinterpretation of results. A reasonable estimate of the correct number of clusters is only provided by flowEMMi, flowClust, and flowMerge. For SamSPECTRAL and flowMeans the calculated number is in a good range but too small. The correct shape of clusters and therefore the required distribution parameters are only provided by flowEMMi, flowClust and SamSPECTRAL. The shape of clusters produced by all other tools does not reflect real cell cluster distributions. In addition, the running time of flowEMMi is with 15 times lower than the running time of flowClust and achieves better results. The flowMerge software extends flowClust and is the most close in terms of the set of features we require and therefore we performed an in-depth analysis of its F <sub>1</sub> measure and running times compared to flowEMMi. In comparison, as shown in Table <xref rid="Tab4" ref-type="table">4</xref>, flowEMMi delivers higher F <sub>1</sub> values at vastly superior running times.</p>
    <p>flowEMMi provides all information needed for the evaluation of microbial community FCM data. It fulfills all the requirements of the users and outperforms other tools that were tested with regard to running time and output features.</p>
  </sec>
  <sec id="Sec13">
    <title>Mock communities</title>
    <p>For additional testing of flowEMMi two artificial microbial cytometric mock communities were used consisting of either three or four different bacterial species. One of the artificial communities was harvested from plates and comprised three strains, namely <italic>Stenotrophomonas rhizophila</italic> DSM 14405, <italic>Kocuria rhizophila</italic> DSM 348, and <italic>Paenibacillus polymyxa</italic> DSM 36, while the other was harvested from liquid culture and comprised four strains, namely <italic>Stenotrophomonas rhizophila</italic> DSM 14405, <italic>Escherichia coli</italic> DSM 4230, <italic>Kocuria rhizophila</italic> DSM 348, and <italic>Paenibacillus polymyxa</italic> DSM 36.</p>
    <p>The respective strains were separately cultivated in in Lysogeny Broth (LB, composition: yeast extract 5gl <sup>−1</sup>, NaCl 5gl <sup>−1</sup>, tryptone 10gl <sup>−1</sup>, pH 7.0, and agar 20 gl <sup>−1</sup> in case of plates; Carl Roth GmbH, Karlsruhe, Germany). The cells were harvested and washed in PBS as described elsewhere [<xref ref-type="bibr" rid="CR32">32</xref>], stabilized by adding para-formaldehyde solution (PFA, 2% in PBS), and, after a washing step, fixed in ethanol (70% in bi-distilled water) for storage at -20 ∘C. DNA staining was performed using DAPI as described by [<xref ref-type="bibr" rid="CR32">32</xref>]. For the plate microbial cytometric mock community the strains were mixed at proportions: <italic>S. rhizophila</italic>: 1%, <italic>K. rhizophila</italic>: 19%, <italic>P. polymyxa</italic>: 80%; and for the liquid microbial cytometric mock community the strains were mixed at proportions <italic>S. rhizophila</italic>: 2.5%; <italic>K. rhizophila</italic>: 20%, <italic>P. polymyxa</italic>: 70 %, and <italic>E. coli</italic> 7.5% as was determined by OD (d <sub><italic>λ</italic> 700<italic>n</italic><italic>m</italic></sub> = 0.5 cm). Finally, the two mock communities were measured by flow cytometry with regard to blue fluorescence (355 nm excitation) vs. forward scatter (488 nm excitation) using a BD Influx v7 Cell Sorter (Becton, Dickinson and Company, Franklin Lakes, NJ, USA). The raw data are available at <ext-link ext-link-type="uri" xlink:href="http://flowrepository.org/id/FR-FCM-ZYNW">http://flowrepository.org/id/FR-FCM-ZYNW</ext-link> (file plate mock community: mCMC80.1.19.fcs; file liquid mock community: 70.2.5.20.7.5.fcs).</p>
    <p>The resulting flow cytometric patterns are shown in Additional file <xref rid="MOESM12" ref-type="media">12</xref> while the results of flowEMMi are shown in Additional file <xref rid="MOESM13" ref-type="media">13</xref> and <xref rid="MOESM14" ref-type="media">14</xref>. The data clearly show the powerful performance of flowEMMi which not only could separate the four, respective three strains of the two microbial cytometric mock communities but also even subpopulations of the used pure mock strains.</p>
  </sec>
  <sec id="Sec14" sec-type="discussion">
    <title>Discussion</title>
    <p>We compared the outcomes of flowEMMi to the outcomes of the manual clustering performed by 5 expert users (Table <xref rid="Tab2" ref-type="table">2</xref>) using FlowJo based on one representative sample (Figs. <xref rid="Fig1" ref-type="fig">1</xref>, <xref rid="Fig2" ref-type="fig">2</xref> and <xref rid="Fig3" ref-type="fig">3</xref>). The clusters found manually by using FlowJo and automatically by flowEMMi were very similar concerning the percental abundances and the location of the cell clusters. flowEMMi slightly underestimated the abundances of cell clusters which might be caused by the fact that manually set clusters do not follow statistical conditions e.g. confidence intervals. Cell clusters only containing a small number of cells typically (at least for our data) do not conform to a Gaussian distribution, and instead have a mostly flat density.</p>
    <p>Furthermore, cell clusters that are big and isolated very often vary in size and comprise only low numbers of cells which nevertheless seem to belong to the respective cluster but without statistical confidence. flowEMMi may not recognize such clusters since the cells might not be within the required confidence interval of the respective cluster and thus are not assigned with statistical significance. This gives an additional value to the quality of the clustering result. Nevertheless, the size of the cell clusters can be controlled by the user by decreasing or increasing the confidence interval.</p>
    <p>We put an additional focus on the comparisons between flowEMMi and other automated approaches (Table <xref rid="Tab3" ref-type="table">3</xref>). By using flowFP, one bin is always divided into two smaller bins of the same size. Therefore, the size and the location of each cluster is constrained to spatial subdivison and the number of clusters to be found is always a power of two where the exponent is the recursion depth. The clustering results can also not be used for cell sorting as the cells of interest are always surrounded by a rectangular region that contains more cells which are not of interest and is not reflecting the real distribution of the cell cluster.</p>
    <p>By using SamSPECTRAL, even with adjustment of both parameters (<italic>sigma</italic> and <italic>separation factor</italic>) as described in the user manual, the number of clusters that were found was in general too small. Besides, the final results of SamSPECTRAL are always achieved after a subsampling procedure which is necessary to keep the running time of large data sets in an acceptable scale. The cell numbers per cluster are therefore always relative to the numbers of cells of the reduced input data. flowDensity is primarily designed to gate predefined cell populations of interest where the clustering strategy is known. As densities of cell clusters are often overlapping within one parameter (clusters with similar forward-scatter, i.e. cell size but different fluorescence intensity, i.e. number of chromosomes), these overlapping densities conflate into one big density distribution with one very wide peak what makes the separation almost impossible. Therefore, this approach is only suitable if the cluster densities are not overlapping to a high extend.</p>
    <p>flowMeans is designed to find equal-sized, non-spherical clusters. Therefore, this approach is not suitable for Gaussian distributed clusters that form ellipsoid shapes and are very diverse in size. By using flowClust, background clusters that are evenly distributed across the dot plot are not separated from cell clusters. Besides, the running time of flowClust is relatively long and the number of cell clusters that are found is too low. We were not able to receive results from the online tool FLAME as our submitted “jobs” were always in the queue for several days and later cancelled by the server.</p>
    <p>To increase the reliability of finding correct clusters concerning the location and abundances of cells, we used a model-based approach to determine the parameters of a mixture of multivariate Gaussian distributions. Our current implementation of the EM algorithm utilizes a variant of stochastic EM, which initializes the EM with different starting points for each run. Naturally, this will lead to slightly different clustering results for each run. Despite the fundamental assumption that cells form Gaussian distributed clusters it is also possible that different cell cluster distributions occur (e.g. flat distributions). In general, the EM algorithm is able to estimate the parameters of each existing distribution and also mixtures of different distributions. It is possible to fit parameters of different distributions to each cluster and to select which distribution is describing the cluster more precisely from a statistical point of view. We focused here on Gaussian distributions and achieved satisfactory results. Allowing different distributions could lead to better results as also cell cluster would be found that occur as e.g. clusters with essentially flat densities.</p>
  </sec>
  <sec id="Sec15">
    <title>Conclusion &amp; outlook</title>
    <p>In this work, we devised a method for the automated clustering of flow cytometry data derived from microbial communities. There is a big demand for an automated clustering procedure for the evaluation of cytometric samples derived from biotechnology, natural environment as well as agricultural und human health disciplines e.g. the animal or human microbiomes [<xref ref-type="bibr" rid="CR53">53</xref>].</p>
    <p>Flow cytometric analysis of microbial communities were recently proven to provide much deeper insight into underlying mechanisms of community assembly in comparison to amplicon sequencing technologies [<xref ref-type="bibr" rid="CR8">8</xref>]. Resolving the respective contributions of e.g. deterministic or neutral paradigms to community structure and functions is dependent on sample density which cannot be provided by any other method within community observation time. Thus, the automated clustering procedure derived from microbial communities contributes to an even faster evaluation procedure and would close a gap in currently available automated clustering procedures that were mainly developed for samples with eukaryotic background and diversification in many fluorescent channels thus providing only few subpopulations per 2D dot plot.</p>
    <p>Our automated procedure is now able to find a high number of previously unknown distributions in one 2D dot plot which is a huge step forward for fast and nearly on-line disposal of data to allow interventions for process control or fast diagnostic decisions. Follow up tools for on-line data evaluation were recently published [<xref ref-type="bibr" rid="CR7">7</xref>].</p>
    <p>As cell clusters can not always be described as Gaussian distributions the next step will be to allow different types of distributions (e.g. distributions with flat densities) and to fit the most probable distribution to each cluster. This will allow flowEMMi to find more clusters being better described by the underlying distribution. The EM algorithm is a powerful approach to estimate the unknown parameters of distributions describing clusters of cells with equal or similar optical parameters that are measured by FCM. With this approach it is possible to overcome the user-dependent and time-consuming clustering procedure which is still performed in a manual way.</p>
  </sec>
  <sec id="Sec16">
    <title>Availability and requirements</title>
    <p><bold>Project name:</bold> flowEMMi</p>
    <p>
      <bold>Project home page:</bold>
      <ext-link ext-link-type="uri" xlink:href="http://www.bioinf.uni-leipzig.de/Software/flowEMMi/">http://www.bioinf.uni-leipzig.de/Software/flowEMMi/</ext-link>
    </p>
    <p><bold>Operating system(s):</bold> Platform independent</p>
    <p><bold>Programming language:</bold> R, C++</p>
    <p><bold>Other requirements:</bold> optionally Nix or NixOS for automatic dependency resolution (<ext-link ext-link-type="uri" xlink:href="https://nixos.org">https://nixos.org</ext-link>)</p>
    <p><bold>License:</bold>
GPL-3
</p>
    <p><bold>Any restrictions to use by non-academics:</bold> see <italic>License</italic></p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec17">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2019_3152_MOESM1_ESM.png">
            <caption>
              <p><bold>Additional file 1</bold> Clustering results for sample InTH_160719_039 using flowEMMi with 2 congruent cell clusters and 94.1<italic>%</italic> foreground cells (<bold>a</bold>) and manual clustering performed by 5 expert users using FlowJo (<bold>b-f</bold>). User 1 selected 2 cell clusters with 89.9<italic>%</italic> foreground cells (<bold>b</bold>). User 2 selected 8 cell clusters with 93.4<italic>%</italic> foreground cells (<bold>c</bold>). User 3 selected 2 cell clusters with 91.1<italic>%</italic> foreground cells (<bold>d</bold>). User 4 selected 6 cell clusters with 98.6<italic>%</italic> foreground cells (<bold>e</bold>). User 5 selected 4 cell clusters with 97.7<italic>%</italic> foreground cells (<bold>f</bold>). The label of the clusters selected by using FlowJo is in accordance with the colours of the clusters calculated by flowEMMi. The mean values and abundances of all cell clusters calculated by flowEMMi and FlowJo can be found in the additional file 039.csv.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2019_3152_MOESM2_ESM.png">
            <caption>
              <p><bold>Additional file 2</bold> Clustering results for sample InTH_160728_034 using flowEMMi with 2 congruent cell clusters and 94.1<italic>%</italic> foreground cells (<bold>a</bold>) and manual clustering performed by 5 expert users using FlowJo (<bold>b-f</bold>). User 1 selected 3 cell clusters with 88.8<italic>%</italic> foreground cells (<bold>b</bold>). User 2 selected 10 cell clusters with 94<italic>%</italic> foreground cells (<bold>c</bold>). User 3 selected 2 cell clusters with 88.7<italic>%</italic> foreground cells (<bold>d</bold>). User 4 selected 9 cell clusters with 99<italic>%</italic> foreground cells (<bold>e</bold>). User 5 selected 7 cell clusters with 100<italic>%</italic> foreground cells (<bold>f</bold>). The label of the clusters selected by using FlowJo is in accordance with the colours of the clusters calculated by flowEMMi. The mean values and abundances of all cell clusters calculated by flowEMMi and FlowJo can be found in the additional file 034.csv.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="12859_2019_3152_MOESM3_ESM.png">
            <caption>
              <p><bold>Additional file 3</bold> Clustering results for sample InTH_160720_026 using flowEMMi with 7 congruent cell clusters and 76.4<italic>%</italic> foreground cells (<bold>a</bold>) and manual clustering performed by 5 expert users using FlowJo (<bold>b-f</bold>). User 1 selected 8 cell clusters with 76<italic>%</italic> foreground cells (<bold>b</bold>). User 2 selected 14 cell clusters with 82.8<italic>%</italic> foreground cells (<bold>c</bold>). User 3 selected 9 cell clusters with 79.5<italic>%</italic> foreground cells (<bold>d</bold>). User 4 selected 12 cell clusters with 86.9<italic>%</italic> foreground cells (<bold>e</bold>). User 5 selected 13 cell clusters with 95.9<italic>%</italic> foreground cells (<bold>f</bold>). The label of the clusters selected by using FlowJo is in accordance with the colours of the clusters calculated by flowEMMi. The mean values and abundances of all cell clusters calculated by flowEMMi and FlowJo can be found in the additional file 026.csv.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="12859_2019_3152_MOESM4_ESM.png">
            <caption>
              <p><bold>Additional file 4</bold> Clustering results for sample InTH_160715_019 using flowEMMi with 8 congruent cell clusters and 64.6<italic>%</italic> foreground cells (<bold>a</bold>) and manual clustering performed by 5 expert users using FlowJo (<bold>b-f</bold>). User 1 selected 6 cell clusters with 60.1<italic>%</italic> foreground cells (<bold>b</bold>). User 2 selected 10 cell clusters with 75.9<italic>%</italic> foreground cells (<bold>c</bold>). User 3 selected 6 cell clusters with 67.2<italic>%</italic> foreground cells (<bold>d</bold>). User 4 selected 12 cell clusters with 87.7<italic>%</italic> foreground cells (<bold>e</bold>). User 5 selected 15 cell clusters with 90.6<italic>%</italic> foreground cells (<bold>f</bold>). The label of the clusters selected by using FlowJo is in accordance with the colours of the clusters calculated by flowEMMi. The mean values and abundances of all cell clusters calculated by flowEMMi and FlowJo can be found in the additional file 019.csv.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="12859_2019_3152_MOESM5_ESM.png">
            <caption>
              <p><bold>Additional file 5</bold> Clustering results for sample InTH_160714_033 using flowEMMi with 9 congruent cell clustersand 74.7<italic>%</italic> foreground cells (<bold>a</bold>) and manual clustering performed by 5 expert users using FlowJo (<bold>b-f</bold>). User 1 selected 7 cell clusters with 61.7<italic>%</italic> foreground cells (<bold>b</bold>). User 2 selected 17 cell clusters with 80.1<italic>%</italic> foreground cells <bold>(c)</bold>. User 3 selected 8 cell clusters with 63.2<italic>%</italic> foreground cells (<bold>d</bold>). User 4 selected 16 cell clusters with 92.7<italic>%</italic> foreground cells (<bold>e</bold>). User 5 selected 17 cell clusters with 90.2<italic>%</italic> foreground cells (<bold>f</bold>). The label of the clusters selected by using FlowJo is in accordance with the colours of the clusters calculated by flowEMMi. The mean values and abundances of all cell clusters calculated by flowEMMi and FlowJo can be found in the additional file 033.csv.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="12859_2019_3152_MOESM6_ESM.png">
            <caption>
              <p><bold>Additional file 6</bold> Clustering results for sample InTH_160729_027 using flowEMMi with 10 congruent cell clusters and 66.4<italic>%</italic> foreground cells (<bold>a</bold>) and manual clustering performed by 5 expert users using FlowJo (<bold>b-f</bold>). User 1 selected 6 cell clusters with 69.5<italic>%</italic> foreground cells (<bold>b</bold>). User 2 selected 14 cell clusters with 87<italic>%</italic> foreground cells (<bold>c</bold>). User 3 selected 6 cell clusters with 69.9<italic>%</italic> foreground cells (<bold>d</bold>). User 4 selected 11 cell clusters with 93.7<italic>%</italic> foreground cells (<bold>e</bold>). User 5 selected 12 cell clusters with 93<italic>%</italic> foreground cells (<bold>f</bold>). The label of the clusters selected by using FlowJo is in accordance with the colours of the clusters calculated by flowEMMi. The mean values and abundances of all cell clusters calculated by flowEMMi and FlowJo can be found in the additional file 027.csv.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM7">
          <media xlink:href="12859_2019_3152_MOESM7_ESM.png">
            <caption>
              <p><bold>Additional file 7</bold> Clustering results for sample InTH_160715_020 using flowEMMi with 10 congruent cell clusters and 55.8<italic>%</italic> foreground cells (<bold>a</bold>) and manual clustering performed by 5 expert users using FlowJo (<bold>b-f</bold>). User 1 selected 8 cell clusters with 64.2<italic>%</italic> foreground cells (<bold>b</bold>). User 2 selected 13 cell clusters with 78.2<italic>%</italic> foreground cells (<bold>c</bold>). User 3 selected 8 cell clusters with 70.5<italic>%</italic> foreground cells (<bold>d</bold>). User 4 selected 13 cell clusters with 86.8<italic>%</italic> foreground cells (<bold>e</bold>). User 5 selected 17 cell clusters with 91.3<italic>%</italic> foreground cells (<bold>f</bold>). The label of the clusters selected by using FlowJo is in accordance with the colours of the clusters calculated by flowEMMi. The mean values and abundances of all cell clusters calculated by flowEMMi and FlowJo can be found in the additional file 020.csv.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM8">
          <media xlink:href="12859_2019_3152_MOESM8_ESM.png">
            <caption>
              <p><bold>Additional file 8</bold> Clustering results for sample InTH_160720_035 using flowEMMi with 11 congruent cell clusters and 72.6<italic>%</italic> foreground cells (<bold>a</bold>) and manual clustering performed by 5 expert users using FlowJo (<bold>b-f</bold>). User 1 selected 7 cell clusters with 69.5<italic>%</italic> foreground cells (<bold>b</bold>). User 2 selected 17 cell clusters with 81.7<italic>%</italic> foreground cells (<bold>c</bold>). User 3 selected 7 cell clusters with 71.5<italic>%</italic> foreground cells (<bold>d</bold>). User 4 selected 17 cell clusters with 88.5<italic>%</italic> foreground cells (<bold>e</bold>). User 5 selected 15 cell clusters with 92<italic>%</italic> foreground cells (<bold>f</bold>). The label of the clusters selected by using FlowJo is in accordance with the colours of the clusters calculated by flowEMMi. The mean values and abundances of all cell clusters calculated by flowEMMi and FlowJo can be found in the additional file 035.csv.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM9">
          <media xlink:href="12859_2019_3152_MOESM9_ESM.png">
            <caption>
              <p><bold>Additional file 9</bold> Clustering results for sample InTH_160712_025 using flowEMMi with 12 congruent cell clusters and 71.6<italic>%</italic> foreground cells (<bold>a</bold>) and manual clustering performed by 5 expert users using FlowJo (<bold>b-f</bold>). User 1 selected 13 cell clusters with 76.5<italic>%</italic> foreground cells (<bold>b</bold>). User 2 selected 15 cell clusters with 82.1<italic>%</italic> foreground cells (<bold>c</bold>). User 3 selected 13 cell clusters with 79.1<italic>%</italic> foreground cells (<bold>d</bold>). User 4 selected 16 cell clusters with 90.7<italic>%</italic> foreground cells (<bold>e</bold>). User 5 selected 15 cell clusters with 91.6<italic>%</italic> foreground cells (<bold>f</bold>). The label of the clusters selected by using FlowJo is in accordance with the colours of the clusters calculated by flowEMMi. The mean values and abundances of all cell clusters calculated by flowEMMi and FlowJo can be found in the additional file 025.csv.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM10">
          <media xlink:href="12859_2019_3152_MOESM10_ESM.png">
            <caption>
              <p><bold>Additional file 10</bold> Clustering results for sample InTH_160713_012 using flowEMMi with 14 congruent cell clusters and 49.5<italic>%</italic> foreground cells (<bold>a</bold>) and manual clustering performed by 5 expert users using FlowJo (<bold>b-f</bold>). User 1 selected 13 cell clusters with 49.3<italic>%</italic> foreground cells (<bold>b</bold>). User 2 selected 20 cell clusters with 75.4<italic>%</italic> foreground cells (<bold>c</bold>). User 3 selected 14 cell clusters with 47.3<italic>%</italic> foreground cells (<bold>d</bold>). User 4 selected 19 cell clusters with 66.3<italic>%</italic> foreground cells (<bold>e</bold>). User 5 selected 25 cell clusters with 92<italic>%</italic> foreground cells (<bold>f</bold>). The label of the clusters selected by using FlowJo is in accordance with the colours of the clusters calculated by flowEMMi. The mean values and abundances of all cell clusters calculated by flowEMMi and FlowJo can be found in the additional file 012.csv.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM11">
          <media xlink:href="12859_2019_3152_MOESM11_ESM.pdf">
            <caption>
              <p><bold>Additional file 11</bold> Comparison of running time (note the logarithmic scaling) vs F <sub>1</sub> score for flowEMMi (characters ε, e, Ein blue) and flowMerge(characters μ, m, M in red). flowEMMi yields, on average over all runs shown above ≈10.7<italic>%</italic> better F <sub>1</sub> scores (flowEMMi mean: 0.57, sd:0.17; flowMerge mean: 0.53, sd: 0.20), at very different time scales (flowEMMi mean: 1 012, sd: 427; flowMerge mean: 24 665, sd: 38 019). flowEMMi performs extremely well in a time constrained regime at early Expectation-Minimization cutoff (using on the cutoff at &lt;1 instead of cutoff &lt;0.01 or &lt;10<sup>−5</sup>) with F <sub>1</sub> score mean: 0.56, sd:0.18, and a running time in seconds of mean: 528, sd: 53. While flowMerge has slightly worse F <sub>1</sub> score characteristics (mean: 0.54, sd: 0.24), with running times a lot higher (mean: 8 391, sd: 3 239). Since both algorithms are parallelized, actual wall-clock times are lower by a factor of 2–3 on a 4-core machine. Given running times are total core seconds used.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM12">
          <media xlink:href="12859_2019_3152_MOESM12_ESM.pdf">
            <caption>
              <p><bold>Additional file 12</bold> Flow cytometric measurement of microbial cytometric mock communities. <bold>Left:</bold> strains <italic>Stenotrophomonas rhizophila</italic> DSM 14405, <italic>Escherichia coli</italic> DSM 4230, <italic>Kocuria rhizophila</italic> DSM 348, and <italic>Paenibacillus polymyxa</italic> DSM 36 were grown in liquid culture, respectively. <bold>Right:</bold> strains <italic>Stenotrophomonas rhizophila</italic> DSM 14405, <italic>Kocuria rhizophila</italic> DSM 348, and <italic>Paenibacillus polymyxa</italic> DSM 36 were grown on plate. The beads were introduced for instrumental alignment of the flow cytometer. <bold>Below:</bold> manually set gate templates for the liquid (left) and plate (right) microbial cytometric mock communities.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM13">
          <media xlink:href="12859_2019_3152_MOESM13_ESM.png">
            <caption>
              <p><bold>Additional file 13</bold> Automated gating by flowEMMi revealed the highest abundant subpopulations of the four strains <italic>Stenotrophomonas rhizophila</italic> DSM 14405, <italic>Escherichia coli</italic> DSM 4230, <italic>Kocuria rhizophila</italic> DSM 348, and <italic>Paenibacillus polymyxa</italic> DSM 36 grown in liquid culture. From left to right: full data set, including noise, rectangular cutout without corner noise, gating on subset of data. Automatic gating by flowEMMi yields an F <sub>1</sub> value of 0.85.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM14">
          <media xlink:href="12859_2019_3152_MOESM14_ESM.png">
            <caption>
              <p><bold>Additional file 14</bold> Automated gating by flowEMMi revealed the highest abundant subpopulations of the three strains <italic>Stenotrophomonas rhizophila</italic> DSM 14405, <italic>Kocuria rhizophila</italic> DSM 348, and <italic>Paenibacillus polymyxa</italic> DSM 36 grown on plate. From left to right: full data set, including noise, rectangular cutout without corner noise, gating on subset of data. Automatic gating by flowEMMi yields an F <sub>1</sub> value of 0.81.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>BIC</term>
        <def>
          <p>Bayesian information criterion</p>
        </def>
      </def-item>
      <def-item>
        <term>DAPI</term>
        <def>
          <p>4’,6-di-amidino-2-phenyl-indole</p>
        </def>
      </def-item>
      <def-item>
        <term>EM</term>
        <def>
          <p>Expectation maximization</p>
        </def>
      </def-item>
      <def-item>
        <term>FCM</term>
        <def>
          <p>Flow cytometry</p>
        </def>
      </def-item>
      <def-item>
        <term>FSC</term>
        <def>
          <p>Forward-scatter</p>
        </def>
      </def-item>
      <def-item>
        <term>GvHD</term>
        <def>
          <p>Graft-versus-host disease</p>
        </def>
      </def-item>
      <def-item>
        <term>HNA</term>
        <def>
          <p>High nucleic acid</p>
        </def>
      </def-item>
      <def-item>
        <term>HSCT</term>
        <def>
          <p>Hematopoietic stem cell transplant</p>
        </def>
      </def-item>
      <def-item>
        <term>LNA</term>
        <def>
          <p>Low nucleic acid</p>
        </def>
      </def-item>
      <def-item>
        <term>PB</term>
        <def>
          <p>Probability binning</p>
        </def>
      </def-item>
      <def-item>
        <term>SD</term>
        <def>
          <p>Standard deviation</p>
        </def>
      </def-item>
      <def-item>
        <term>SSC</term>
        <def>
          <p>Side-scatter</p>
        </def>
      </def-item>
      <def-item>
        <term>SWR</term>
        <def>
          <p>Scale-free weighted ration</p>
        </def>
      </def-item>
      <def-item>
        <term>SYBR Green</term>
        <def>
          <p>N’,N’-dimethyl-N-[4-[(E)-(3-methyl-1,3-benzothiazol-2-ylidene)methyl]-1- phenylquinolin-1-ium-2-yl]-N-propylpropane-1,3-diamine</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s12859-019-3152-3.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank Thomas Hübschmann, Florian Schattenberg, Susanne Günther and Johannes Lambrecht for performing the manual clustering with FlowJo.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>JL and CHzS developed the flowEMMi algorithm and wrote the implementation, ZL performed the experiments; JL, SM and CHzS designed the research and JL, SM, CHzS and PFS wrote the manuscript. All authors contributed critically to the drafts and gave final approval for publication.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>We acknowledge the support of the German Federal Ministry of Education and Research (WiPro, grant 031A616K), the German Research Foundation (DFG) and Universität Leipzig within the program of Open Access Publishing, the European Regional Development Funds (EFRE—Europe Funds Saxony, grant 100192205), the China Scholarship Council (CSC) and the Helmholtz Association within RP Renewable Energies. The funding body had no role in the design of the study and collection, analysis, and interpretation of data and in writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The flowEMMi sources and additional files are available here: <ext-link ext-link-type="uri" xlink:href="http://www.bioinf.uni-leipzig.de/Software/flowEMMi/">http://www.bioinf.uni-leipzig.de/Software/flowEMMi/</ext-link>.</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p>Not applicable.</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p>Not applicable.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hammes</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Berney</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Vital</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Köster</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Egli</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Flow-cytometric total bacterial cell counts as a descriptive microbiological parameter for drinking water treatment processes</article-title>
        <source>Water Res</source>
        <year>2008</year>
        <volume>42</volume>
        <issue>1-2</issue>
        <fpage>269</fpage>
        <lpage>77</lpage>
        <pub-id pub-id-type="doi">10.1016/j.watres.2007.07.009</pub-id>
        <?supplied-pmid 17659762?>
        <pub-id pub-id-type="pmid">17659762</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lautenschlager</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Boon</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Egli</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hammes</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Overnight stagnation of drinking water in household taps induces microbial growth and changes in community composition</article-title>
        <source>Water Res</source>
        <year>2010</year>
        <volume>44</volume>
        <issue>17</issue>
        <fpage>4868</fpage>
        <lpage>77</lpage>
        <pub-id pub-id-type="doi">10.1016/j.watres.2010.07.032</pub-id>
        <?supplied-pmid 20696451?>
        <pub-id pub-id-type="pmid">20696451</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lautenschlager</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hwang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ling</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>W-T</given-names>
          </name>
          <name>
            <surname>Boon</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Köster</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Egli</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hammes</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Abundance and composition of indigenous bacterial communities in a multi-step biofiltration-based drinking water treatment plant</article-title>
        <source>Water Res</source>
        <year>2014</year>
        <volume>62</volume>
        <fpage>40</fpage>
        <lpage>52</lpage>
        <pub-id pub-id-type="doi">10.1016/j.watres.2014.05.035</pub-id>
        <?supplied-pmid 24937356?>
        <pub-id pub-id-type="pmid">24937356</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Günther</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Faust</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Schumann</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Harms</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Raes</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Species-sorting and mass-transfer paradigms control managed natural metacommunities</article-title>
        <source>Environ Microbiol</source>
        <year>2016</year>
        <volume>18</volume>
        <issue>12</issue>
        <fpage>4862</fpage>
        <lpage>77</lpage>
        <pub-id pub-id-type="doi">10.1111/1462-2920.13402</pub-id>
        <?supplied-pmid 27338005?>
        <pub-id pub-id-type="pmid">27338005</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lambrecht</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cichocki</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Hübschmann</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Koch</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Harms</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Flow cytometric quantification, sorting and sequencing of methanogenic archaea based on F 420 autofluorescence</article-title>
        <source>Microb Cell Factories</source>
        <year>2017</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>180</fpage>
        <pub-id pub-id-type="doi">10.1186/s12934-017-0793-7</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Props</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Monsieurs</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mysara</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Clement</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Boon</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Measuring the biodiversity of microbial communities by flow cytometry</article-title>
        <source>Methods Ecol Evol</source>
        <year>2016</year>
        <volume>7</volume>
        <issue>11</issue>
        <fpage>1376</fpage>
        <lpage>85</lpage>
        <pub-id pub-id-type="doi">10.1111/2041-210X.12607</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Cichocki</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Bonk</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Günther</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schattenberg</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Harms</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Centler</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Ecological stability properties of microbial communities assessed by flow cytometry</article-title>
        <source>mSphere</source>
        <year>2018</year>
        <volume>3</volume>
        <issue>1</issue>
        <fpage>00564</fpage>
        <lpage>17</lpage>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>Zishu</given-names>
          </name>
          <name>
            <surname>Cichocki</surname>
            <given-names>Nicolas</given-names>
          </name>
          <name>
            <surname>Hübschmann</surname>
            <given-names>Thomas</given-names>
          </name>
          <name>
            <surname>Süring</surname>
            <given-names>Christine</given-names>
          </name>
          <name>
            <surname>Ofiţeru</surname>
            <given-names>Irina Dana</given-names>
          </name>
          <name>
            <surname>Sloan</surname>
            <given-names>William T.</given-names>
          </name>
          <name>
            <surname>Grimm</surname>
            <given-names>Volker</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>Susann</given-names>
          </name>
        </person-group>
        <article-title>Neutral mechanisms and niche differentiation in steady-state insular microbial communities revealed by single cell analysis</article-title>
        <source>Environmental Microbiology</source>
        <year>2018</year>
        <volume>21</volume>
        <issue>1</issue>
        <fpage>164</fpage>
        <lpage>181</lpage>
        <pub-id pub-id-type="doi">10.1111/1462-2920.14437</pub-id>
        <?supplied-pmid 30289191?>
        <pub-id pub-id-type="pmid">30289191</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zimmermann</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hübschmann</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Schattenberg</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Schumann</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Durek</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Riedel</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Friedrich</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Glauben</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Siegmund</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Radbruch</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>H-D</given-names>
          </name>
        </person-group>
        <article-title>High-resolution microbiota flow cytometry reveals dynamic colitis-associated changes in fecal bacterial composition</article-title>
        <source>Eur J Immunol</source>
        <year>2016</year>
        <volume>46</volume>
        <issue>5</issue>
        <fpage>1300</fpage>
        <lpage>03</lpage>
        <pub-id pub-id-type="doi">10.1002/eji.201646297</pub-id>
        <?supplied-pmid 26909672?>
        <pub-id pub-id-type="pmid">26909672</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van Gelder</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Röhrig</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Schattenberg</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Cichocki</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Schumann</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Schmalz</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Haak</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ziebolz</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>A cytometric approach to follow variation and dynamics of the salivary microbiota</article-title>
        <source>Methods</source>
        <year>2018</year>
        <volume>134-135</volume>
        <fpage>67</fpage>
        <lpage>79</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ymeth.2017.08.009</pub-id>
        <?supplied-pmid 28842259?>
        <pub-id pub-id-type="pmid">28842259</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koch</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Personalized microbiome dynamics–cytometric fingerprints for routine diagnostics</article-title>
        <source>Mol Asp Med</source>
        <year>2018</year>
        <volume>59</volume>
        <fpage>123</fpage>
        <lpage>34</lpage>
        <pub-id pub-id-type="doi">10.1016/j.mam.2017.06.005</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buysschaert</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Kerckhof</surname>
            <given-names>F. -M.</given-names>
          </name>
          <name>
            <surname>Vandamme</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>De Baets</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Boon</surname>
            <given-names>N.</given-names>
          </name>
        </person-group>
        <article-title>Flow cytometric fingerprinting for microbial strain discrimination and physiological characterization</article-title>
        <source>Cytom Part A</source>
        <year>2018</year>
        <volume>93</volume>
        <issue>2</issue>
        <fpage>201</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.23302</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rubbens</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Props</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Boon</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Waegeman</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Flow cytometric single-cell identification of populations in synthetic bacterial communities</article-title>
        <source>PloS ONE</source>
        <year>2017</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>0169754</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0169754</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <mixed-citation publication-type="other">Schumann J, Koch C, Fetzer I, Müller S. flowCHIC: Analyze flow cytometric data using histogram information. 2019. R package version 1.18.0. doi:10.18129/B9.bioc.flowCHIC.</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koch</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Fetzer</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Harms</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>CHIC - an automated approach for the detection of dynamic variations in complex microbial communities</article-title>
        <source>Cytom Part A</source>
        <year>2013</year>
        <volume>83</volume>
        <issue>6</issue>
        <fpage>561</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.22286</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <mixed-citation publication-type="other">Schumann J, Koch C, Günther S, Fetzer I, Müller S. flowCyBar: Analyze flow cytometric data using gate information. 2019. R package version 1.20.0, doi:10.18129/B9.bioc.flowCyBar.</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koch</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Fetzer</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Schmidt</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Harms</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Monitoring functions in managed microbial systems by cytometric bar coding</article-title>
        <source>Environ Sci Technol</source>
        <year>2013</year>
        <volume>47</volume>
        <issue>3</issue>
        <fpage>1753</fpage>
        <lpage>60</lpage>
        <?supplied-pmid 23252765?>
        <pub-id pub-id-type="pmid">23252765</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <mixed-citation publication-type="other">Mehta T, Bose B, Saxena S, Seetha Rama Sastry MV, Kumar RS. FlowPy. 2010. <ext-link ext-link-type="uri" xlink:href="http://flowpy.wikidot.com">http://flowpy.wikidot.com</ext-link>, Accessed 25 Oct 2019.</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aghaeepour</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Finak</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Hoos</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Mosmann</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Brinkman</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gottardo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Scheuermann</surname>
            <given-names>RH</given-names>
          </name>
          <collab>FlowCAP Consortium</collab>
          <collab>DREAM Consortium</collab>
        </person-group>
        <article-title>Critical assessment of automated flow cytometry data analysis techniques</article-title>
        <source>Nat Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <issue>3</issue>
        <fpage>228</fpage>
        <lpage>38</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2365</pub-id>
        <?supplied-pmid 23396282?>
        <pub-id pub-id-type="pmid">23396282</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Günther</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Facilitated gate setting by sequential dot plot scanning</article-title>
        <source>Cytom Part A</source>
        <year>2015</year>
        <volume>87</volume>
        <issue>7</issue>
        <fpage>661</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.22656</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lo</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hahne</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Brinkman</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Gottardo</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>flowClust: a Bioconductor package for automated gating of flow cytometry data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2009</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>145</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-10-145</pub-id>
        <?supplied-pmid 19442304?>
        <pub-id pub-id-type="pmid">19442304</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <mixed-citation publication-type="other">Holyst H, Rogers W. flowFP: Fingerprinting for Flow Cytometry. 2009. R package version 1.30.0, doi:10.18129/B9.bioc.flowFP.</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roederer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Moore</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Treister</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hardy</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Herzenberg</surname>
            <given-names>LA</given-names>
          </name>
        </person-group>
        <article-title>Probability binning comparison: A metric for quantitating multivariate distribution differences</article-title>
        <source>Cytom Part A</source>
        <year>2001</year>
        <volume>45</volume>
        <issue>1</issue>
        <fpage>47</fpage>
        <lpage>55</lpage>
        <pub-id pub-id-type="doi">10.1002/1097-0320(20010901)45:1&lt;47::AID-CYTO1143&gt;3.0.CO;2-A</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zare</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Shooshtari</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gupta</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Brinkman</surname>
            <given-names>RR</given-names>
          </name>
        </person-group>
        <article-title>Data reduction for spectral clustering to analyze high throughput flow cytometry data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>403</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-403</pub-id>
        <?supplied-pmid 20667133?>
        <pub-id pub-id-type="pmid">20667133</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kanungo</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Mount</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Netanyahu</surname>
            <given-names>NS</given-names>
          </name>
          <name>
            <surname>Piatko</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Silverman</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>AY</given-names>
          </name>
        </person-group>
        <article-title>An efficient k-means clustering algorithm: Analysis and implementation</article-title>
        <source>IEEE Trans Pattern Analy Mach Intell</source>
        <year>2002</year>
        <volume>24</volume>
        <issue>7</issue>
        <fpage>881</fpage>
        <lpage>92</lpage>
        <pub-id pub-id-type="doi">10.1109/TPAMI.2002.1017616</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Malek</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Taghiyar</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Chong</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Finak</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gottardo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Brinkman</surname>
            <given-names>RR</given-names>
          </name>
        </person-group>
        <article-title>flowDensity: reproducing manual gating of flow cytometry data by automated density-based cell population identification</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>31</volume>
        <issue>4</issue>
        <fpage>606</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu677</pub-id>
        <?supplied-pmid 25378466?>
        <pub-id pub-id-type="pmid">25378466</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aghaeepour</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Nikolic</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hoos</surname>
            <given-names>HH</given-names>
          </name>
          <name>
            <surname>Brinkman</surname>
            <given-names>RR</given-names>
          </name>
        </person-group>
        <article-title>Rapid cell population identification in flow cytometry data</article-title>
        <source>Cytom Part A</source>
        <year>2011</year>
        <volume>79</volume>
        <issue>1</issue>
        <fpage>6</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.21007</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <mixed-citation publication-type="other">Finak G, Bashashati A, Brinkman R, Gottardo R. Merging mixture components for cell population identification in flow cytometry. Adv Bioinforma. 2009; 2009.</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pyne</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Rossin</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>T-I</given-names>
          </name>
          <name>
            <surname>Maier</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Baecher-Allan</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>McLachlan</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Tamayo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hafler</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>De Jager</surname>
            <given-names>PL</given-names>
          </name>
          <name>
            <surname>Mesirov</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>Automated high-dimensional flow cytometric data analysis</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2009</year>
        <volume>106</volume>
        <issue>21</issue>
        <fpage>8519</fpage>
        <lpage>8524</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0903028106</pub-id>
        <?supplied-pmid 19443687?>
        <pub-id pub-id-type="pmid">19443687</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brinkman</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Gasparetto</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>S-JJ</given-names>
          </name>
          <name>
            <surname>Ribickas</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Perkins</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Janssen</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Smiley</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>High-content flow cytometry and temporal data analysis for defining a cellular signature of graft-versus-host disease</article-title>
        <source>Biol Blood Marrow Transplant</source>
        <year>2007</year>
        <volume>13</volume>
        <issue>6</issue>
        <fpage>691</fpage>
        <lpage>700</lpage>
        <pub-id pub-id-type="doi">10.1016/j.bbmt.2007.02.002</pub-id>
        <?supplied-pmid 17531779?>
        <pub-id pub-id-type="pmid">17531779</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Amalfitano</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Fazi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ejarque</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Freixa</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Romaní</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Butturini</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Deconvolution model to resolve cytometric microbial community patterns in flowing waters</article-title>
        <source>Cytom Part A</source>
        <year>2018</year>
        <volume>93</volume>
        <issue>2</issue>
        <fpage>194</fpage>
        <lpage>200</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.23304</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koch</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Günther</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Desta</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Hübschmann</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Cytometric fingerprinting for analyzing microbial intracommunity structure variation and identifying subcommunity function</article-title>
        <source>Nat Protocol</source>
        <year>2013</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>190</fpage>
        <lpage>202</lpage>
        <pub-id pub-id-type="doi">10.1038/nprot.2012.149</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Shapiro</surname>
            <given-names>HM</given-names>
          </name>
        </person-group>
        <source>Practical Flow Cytometry</source>
        <year>2005</year>
        <publisher-loc>Hoboken</publisher-loc>
        <publisher-name>John Wiley &amp; Sons</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Müller</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nebe-von-Caron</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Functional single-cell analyses: flow cytometry and cell sorting of microbial populations and communities</article-title>
        <source>FEMS Microbiol Rev</source>
        <year>2010</year>
        <volume>34</volume>
        <issue>4</issue>
        <fpage>554</fpage>
        <lpage>87</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1574-6976.2010.00214.x</pub-id>
        <?supplied-pmid 20337722?>
        <pub-id pub-id-type="pmid">20337722</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baudry</surname>
            <given-names>J-P</given-names>
          </name>
          <name>
            <surname>Celeux</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>EM for mixtures</article-title>
        <source>Stat Comput</source>
        <year>2015</year>
        <volume>25</volume>
        <issue>4</issue>
        <fpage>713</fpage>
        <lpage>26</lpage>
        <pub-id pub-id-type="doi">10.1007/s11222-015-9561-x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Qin</surname>
            <given-names>SJ</given-names>
          </name>
        </person-group>
        <article-title>Multimode process monitoring with bayesian inference-based finite Gaussian mixture models</article-title>
        <source>AIChE J</source>
        <year>2008</year>
        <volume>54</volume>
        <issue>7</issue>
        <fpage>1811</fpage>
        <lpage>29</lpage>
        <pub-id pub-id-type="doi">10.1002/aic.11515</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dempster</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Laird</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Rubin</surname>
            <given-names>DB</given-names>
          </name>
        </person-group>
        <article-title>Maximum likelihood from incomplete data via the EM algorithm</article-title>
        <source>J R Stat Soc Ser B Methodol</source>
        <year>1977</year>
        <volume>1</volume>
        <fpage>1</fpage>
        <lpage>38</lpage>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>CJ</given-names>
          </name>
        </person-group>
        <article-title>On the convergence properties of the EM algorithm</article-title>
        <source>Ann Stat</source>
        <year>1983</year>
        <volume>1</volume>
        <fpage>95</fpage>
        <lpage>103</lpage>
        <pub-id pub-id-type="doi">10.1214/aos/1176346060</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Connor</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Mosimann</surname>
            <given-names>JE</given-names>
          </name>
        </person-group>
        <article-title>Concepts of independence for proportions with a generalization of the Dirichlet distribution</article-title>
        <source>J Am Stat Assoc</source>
        <year>1969</year>
        <volume>64</volume>
        <issue>325</issue>
        <fpage>194</fpage>
        <lpage>206</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.1969.10500963</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40</label>
      <mixed-citation publication-type="other">Eddelbuettel D, François R. Rcpp: Seamless R and C++ integration. J Stat Softw. 2011; 40(8):1–18. 10.18637/jss.v040.i08.</mixed-citation>
    </ref>
    <ref id="CR41">
      <label>41</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bates</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Eddelbuettel</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Fast and elegant numerical linear algebra using the RcppEigen package</article-title>
        <source>J Stat Softw</source>
        <year>2013</year>
        <volume>52</volume>
        <issue>5</issue>
        <fpage>1</fpage>
        <lpage>24</lpage>
        <pub-id pub-id-type="doi">10.18637/jss.v052.i05</pub-id>
        <pub-id pub-id-type="pmid">23761062</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42</label>
      <mixed-citation publication-type="other">Ellis B, Haaland P, Hahne F, Le Meur N, Gopalakrishnan N, Spidlen J, Jiang M, Finak G. flowCore: flowCore: Basic structures for flow cytometry data. 2016. R package version 1.38.2, doi:10.18129/B9.bioc.flowCore.</mixed-citation>
    </ref>
    <ref id="CR43">
      <label>43</label>
      <mixed-citation publication-type="other">Ellis B, Gentleman R, Hahne F, Le Meur N, Sarkar D, Jiang M. flowViz: Visualization for Flow Cytometry. 2016. R package version 1.36.2.</mixed-citation>
    </ref>
    <ref id="CR44">
      <label>44</label>
      <mixed-citation publication-type="other">Wickham H. ggplot2: Elegant Graphics for Data Analysis. New York: Springer; 2016. <ext-link ext-link-type="uri" xlink:href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45</label>
      <mixed-citation publication-type="other">Ammar R.randomcoloR: Generate Attractive Random Colors. 2016. R package version 1.0.0. <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=randomcoloR">https://CRAN.R-project.org/package=randomcoloR</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR46">
      <label>46</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benaglia</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Chauveau</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hunter</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>mixtools: An R package for analyzing finite mixture models</article-title>
        <source>J Stat Softw</source>
        <year>2009</year>
        <volume>32</volume>
        <issue>6</issue>
        <fpage>1</fpage>
        <lpage>29</lpage>
        <pub-id pub-id-type="doi">10.18637/jss.v032.i06</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47</label>
      <mixed-citation publication-type="other">Warnes GR, Bolker B, Lumley T. gtools: Various R Programming Tools. 2015. R package version 3.5.0. <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=gtools">https://CRAN.R-project.org/package=gtools</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR48">
      <label>48</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schwarz</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Estimating the dimension of a model</article-title>
        <source>Ann Stat</source>
        <year>1978</year>
        <volume>6</volume>
        <issue>2</issue>
        <fpage>461</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="doi">10.1214/aos/1176344136</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wit</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Heuvel</surname>
            <given-names>Evd</given-names>
          </name>
          <name>
            <surname>Romeijn</surname>
            <given-names>J-W</given-names>
          </name>
        </person-group>
        <article-title>’all models are wrong...’: an introduction to model uncertainty</article-title>
        <source>Statistica Neerlandica</source>
        <year>2012</year>
        <volume>66</volume>
        <issue>3</issue>
        <fpage>217</fpage>
        <lpage>36</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1467-9574.2012.00530.x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Neal</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Hinton</surname>
            <given-names>GE</given-names>
          </name>
        </person-group>
        <article-title>A view of the EM algorithm that justifies incremental, sparse, and other variants</article-title>
        <source>Learning in Graphical Models</source>
        <year>1998</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Neyman</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Outline of a theory of statistical estimation based on the classical theory of probability</article-title>
        <source>Phil Trans R Soc Lond A</source>
        <year>1937</year>
        <volume>236</volume>
        <issue>767</issue>
        <fpage>333</fpage>
        <lpage>80</lpage>
        <pub-id pub-id-type="doi">10.1098/rsta.1937.0005</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zar</surname>
            <given-names>JH</given-names>
          </name>
        </person-group>
        <article-title>Biostatistical analysis. 2nd</article-title>
        <source>Prentice Hall USA</source>
        <year>1984</year>
        <volume>54</volume>
        <fpage>55</fpage>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koch</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Personalized microbiome dynamics - Cytometric fingerprints for routine diagnostics</article-title>
        <source>Mol Aspects Med</source>
        <year>2018</year>
        <volume>59</volume>
        <fpage>123</fpage>
        <lpage>34</lpage>
        <pub-id pub-id-type="doi">10.1016/j.mam.2017.06.005</pub-id>
        <?supplied-pmid 28669592?>
        <pub-id pub-id-type="pmid">28669592</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
