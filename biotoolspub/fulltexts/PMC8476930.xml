<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Biol Methods Protoc</journal-id>
    <journal-id journal-id-type="iso-abbrev">Biol Methods Protoc</journal-id>
    <journal-id journal-id-type="publisher-id">biomethods</journal-id>
    <journal-title-group>
      <journal-title>Biology Methods &amp; Protocols</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2396-8923</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8476930</article-id>
    <article-id pub-id-type="doi">10.1093/biomethods/bpab017</article-id>
    <article-id pub-id-type="publisher-id">bpab017</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Innovations</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI00960</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic toggle="yes">OptM</italic>: estimating the optimal number of migration edges on population trees using <italic toggle="yes">Treemix</italic></article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-7398-6259</contrib-id>
        <name>
          <surname>Fitak</surname>
          <given-names>Robert R</given-names>
        </name>
        <xref rid="bpab017-cor1" ref-type="corresp"/>
        <!--Robert.fitak@ucf.edu-->
        <xref rid="bpab017-aff1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="bpab017-aff1"><institution>Department of Biology, Genomics and Bioinformatics Cluster, University of Central Florida</institution>, Orlando, FL 32816, <country country="US">USA</country></aff>
    <author-notes>
      <corresp id="bpab017-cor1">Correspondence address. Department of Biology, Genomics and Bioinformatics Cluster, University of Central Florida, 4110 Libra Dr., Orlando, FL 32816, USA. E-mail: <email>Robert.fitak@ucf.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-09-16">
      <day>16</day>
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <volume>6</volume>
    <issue>1</issue>
    <elocation-id>bpab017</elocation-id>
    <history>
      <date date-type="received">
        <day>20</day>
        <month>8</month>
        <year>2021</year>
      </date>
      <date date-type="rev-recd">
        <day>09</day>
        <month>9</month>
        <year>2021</year>
      </date>
      <date date-type="editorial-decision">
        <day>10</day>
        <month>9</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>9</month>
        <year>2021</year>
      </date>
      <date date-type="corrected-typeset">
        <day>23</day>
        <month>9</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">https://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="bpab017.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>The software <italic toggle="yes">Treemix</italic> has become extensively used to estimate the number of migration events, or edges (<italic toggle="yes">m</italic>), on population trees from genome-wide allele frequency data. However, the appropriate number of edges to include remains unclear. Here, I show that an optimal value of <italic toggle="yes">m</italic> can be inferred from the second-order rate of change in likelihood (Δ<italic toggle="yes">m</italic>) across incremental values of <italic toggle="yes">m</italic>. Repurposed from its original use to estimate the number of population clusters in the software <italic toggle="yes">Structure</italic> (Δ<italic toggle="yes">K</italic>), I show using simulated populations that Δ<italic toggle="yes">m</italic> performs equally as well as current recommendations for <italic toggle="yes">Treemix</italic>. A demonstration of an empirical dataset from domestic dogs indicates that this method may be preferable in large, complex population histories and can prioritize migration events for subsequent investigation. The method has been implemented in a freely available R package called “OptM” and as a web application (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://rfitak.shinyapps.io/OptM/" ext-link-type="uri">https://rfitak.shinyapps.io/OptM/</ext-link>) to interface directly with the output files of <italic toggle="yes">Treemix</italic>.</p>
    </abstract>
    <kwd-group>
      <kwd>likelihood</kwd>
      <kwd>population genomics</kwd>
      <kwd>SNPs</kwd>
      <kwd>structure</kwd>
    </kwd-group>
    <counts>
      <page-count count="6"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>One of the fundamental aspects of modern population genetics is using allele-frequency measurements to recreate the various demographic events that define an extant species. However, species and their constituent populations often contain complex demographic histories that may include various instances and fluctuations in migration, population size, and fragmentation. These complex demographic scenarios often require large amounts of genetic data to be sufficiently resolved. Recent advances in sequencing and genotyping technologies [notably for single-nucleotide polymorphisms (SNPs)] have made the generation of genome-wide allele frequency data for multiple populations increasingly tractable [<xref rid="bpab017-B1" ref-type="bibr">1</xref>], thus limiting studies of demographic history primarily to the statistical models and computational capabilities available.</p>
    <p>A graph-based model for describing the relationships between populations was recently described by Pickrell and Pritchard [<xref rid="bpab017-B2" ref-type="bibr">2</xref>]. This approach is able to estimate population splits and migration by first building a tree model of the populations then subsequently adding migration events (or edges) between populations that poorly fit the tree model. Pickrell and Pritchard implemented their model in a software package called <italic toggle="yes">Treemix</italic>, which has been used to infer gene flow between populations of many species including fungi (e.g., [<xref rid="bpab017-B3" ref-type="bibr">3</xref>]), plants (e.g., [<xref rid="bpab017-B4" ref-type="bibr">4</xref>]), reptiles (e.g., [<xref rid="bpab017-B5" ref-type="bibr">5</xref>]), mammals (e.g., [<xref rid="bpab017-B6" ref-type="bibr">6–9</xref>]), and numerous others. <italic toggle="yes">Treemix</italic> allows the user to model any number of migration edges, and the authors suggested that, based upon simulations, a model that explains 99.8% of variation in the relatedness between populations is sufficiently robust to infer the number of migration edges. Nevertheless, real-world demographic histories are often more complex and this approach may underestimate or overestimate the number of migrations edges. For example, when the ratio of the number of admixed to unadmixed populations is quite large, <italic toggle="yes">Treemix</italic> may simply account for this by shortening the branch to the unadmixed populations in the tree rather than adding multiple migration edges [<xref rid="bpab017-B2" ref-type="bibr">2</xref>].</p>
    <p>In this study, I propose the application of an <italic toggle="yes">ad hoc</italic> statistic similar to the method described by Evanno <italic toggle="yes">et al</italic>. [<xref rid="bpab017-B10" ref-type="bibr">10</xref>] for the software <italic toggle="yes">Structure</italic> [<xref rid="bpab017-B11" ref-type="bibr">11</xref>] to determine the optimal number of migration events to include when using <italic toggle="yes">Treemix</italic>. I demonstrate on simulated populations that this approach performs equally as well as the 99.8% variation threshold suggested by Pickrell and Pritchard [<xref rid="bpab017-B2" ref-type="bibr">2</xref>]. However, using an empirical example of domestic dogs and wolves, I show the utility of this approach under large, complex demographic histories when the recommended threshold becomes difficult to obtain.</p>
  </sec>
  <sec>
    <title>Materials and methods</title>
    <sec>
      <title>Approach</title>
      <p>Inferring the most probable number of migration events in a model, or <italic toggle="yes">m</italic>, is akin to inferring the most likely number of populations, <italic toggle="yes">K</italic>, when using the software <italic toggle="yes">Structure</italic> [<xref rid="bpab017-B11" ref-type="bibr">11</xref>]. <italic toggle="yes">Structure</italic> is perhaps the most widely used program for inferring population structure and admixture [<xref rid="bpab017-B12" ref-type="bibr">12</xref>], and over the past two decades has become a standardized tool for population genetic studies [<xref rid="bpab017-B13" ref-type="bibr">13</xref>]. When using <italic toggle="yes">Structure</italic>, it was recommended to infer the most likely value for <italic toggle="yes">K</italic> by (i) performing multiple runs with various values for <italic toggle="yes">K</italic>, (ii) plotting the log posterior probability of the data given <italic toggle="yes">K</italic> (“<inline-formula id="IE1"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">ln</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>D</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>,” or simply “<italic toggle="yes">L</italic>(<italic toggle="yes">K</italic>)”) for each run, and (iii) observing the value of <italic toggle="yes">K</italic> where <italic toggle="yes">L</italic>(<italic toggle="yes">K</italic>) reaches a plateau and/or the variance begins to increase [<xref rid="bpab017-B14" ref-type="bibr">14</xref>]. However, Evanno <italic toggle="yes">et al</italic>. [<xref rid="bpab017-B10" ref-type="bibr">10</xref>] demonstrated that this approach may not be accurate and proposed a new method that improves the ability to predict the true value of <italic toggle="yes">K</italic>. The method proposed by Evanno <italic toggle="yes">et al</italic>. calculated an <italic toggle="yes">ad hoc</italic> statistic, Δ<italic toggle="yes">K</italic>, based upon the second-order rate of change in <italic toggle="yes">L</italic>(<italic toggle="yes">K</italic>).</p>
      <p>I propose here that the same procedure proposed by Evanno <italic toggle="yes">et al</italic>. can be used to estimate the most likely value for <italic toggle="yes">m</italic> when using <italic toggle="yes">Treemix</italic>. The only difference is <italic toggle="yes">m</italic> can have values ≥0 whereas <italic toggle="yes">K</italic> must be ≥1. The software <italic toggle="yes">Treemix</italic> calculates composite log-likelihoods for each run using models both without migration edges (<italic toggle="yes">m</italic> = 0) and with <italic toggle="yes">m</italic> edges. I define these likelihoods as <italic toggle="yes">L</italic>(<italic toggle="yes">m</italic>) and they are analogous to the <italic toggle="yes">L</italic>(<italic toggle="yes">K</italic>) values produced by <italic toggle="yes">Structure</italic>. By performing multiple runs with different values for <italic toggle="yes">m</italic>, the same methodology to calculate Δ<italic toggle="yes">K</italic> can be used to calculate its migration equivalent, Δ<italic toggle="yes">m</italic>. I refer users to Evanno <italic toggle="yes">et al</italic>. [<xref rid="bpab017-B10" ref-type="bibr">10</xref>] and <xref rid="sup1" ref-type="supplementary-material">Supplementary File S1</xref> for a complete description of the model and its calculations. I have implemented the method in a software package called <italic toggle="yes">OptM</italic> v0.1.5 available for the R programming language through CRAN [<xref rid="bpab017-B15" ref-type="bibr">15</xref>] (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://cran.r-project.org" ext-link-type="uri">https://cran.r-project.org</ext-link>); designed specifically for use with the output files produced by <italic toggle="yes">Treemix</italic> v1.13 (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://bitbucket.org/nygcresearch/treemix" ext-link-type="uri">https://bitbucket.org/nygcresearch/treemix</ext-link>; RRID: SCR_021636). <italic toggle="yes">OptM</italic> was built originally using R v3.2.2, but has been tested extensively to function properly on various platforms (i.e., Windows and Unix) through the current version R v4.1.1. Its dependencies include the packages SiZer (≥v0.1-4), stats, splines, grDevices, and boot (≥v1.3-20). With regard to the input files, <italic toggle="yes">OptM</italic> analyzes all the <italic toggle="yes">Treemix</italic> output files in a given folder with the suffixes “.llik,” “.cov.gz,” and “.modelcov.gz” generated by default using <italic toggle="yes">Treemix</italic>. <italic toggle="yes">OptM</italic> generates an output table with the calculations and an estimated optimal value of <italic toggle="yes">m</italic> and includes a plotting function “<italic toggle="yes">plot_optM</italic>” to visualize the results and produce publication-ready figures. Alternatively, <italic toggle="yes">OptM</italic> incorporates added functionality to estimate <italic toggle="yes">m</italic> using change points estimated from threshold models often employed in ecology (see Ref. [<xref rid="bpab017-B16" ref-type="bibr">16</xref>] and <xref rid="sup1" ref-type="supplementary-material">Supplementary File S1</xref>). <italic toggle="yes">OptM</italic> can fit parametric models such as piecewise linear, bent cable, simple exponential, and non-linear least squares to the <italic toggle="yes">L</italic>(<italic toggle="yes">m</italic>) values across runs and compare them with the Akaike information criterion [<xref rid="bpab017-B17" ref-type="bibr">17</xref>]. The non-parametric “significant zero crossings” method (SiZer) [<xref rid="bpab017-B16" ref-type="bibr">16</xref>] is also available for comparison purposes.</p>
    </sec>
    <sec>
      <title>Testing using simulations</title>
      <p>I generated four simulated datasets each comprising 20 populations that evolved according to a serial bottleneck scenario using the whole-genome coalescent simulator <italic toggle="yes">Argon</italic> v0.1 (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://palamaralab.github.io/software/argon/" ext-link-type="uri">https://palamaralab.github.io/software/argon/</ext-link>; RRID: SCR_021635) [<xref rid="bpab017-B18" ref-type="bibr">18</xref>]. The population graph without any migration events was identical to that in Pickrell and Pritchard [<xref rid="bpab017-B2" ref-type="bibr">2</xref>] (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). The simulations each assumed an effective population size of 10<sup>4</sup> and all populations are descended from a common ancestor 2000 generations in the past. However, within each simulated dataset, 1, 3, 5, or 8 migration events were included 100 generations in the past. The source and recipient population for each migration event were selected at random without replacement, and the recipient population received 30% of its genetic ancestry from the source population. Each simulation produced 60 chromosomes (30 diploid individuals) of 250 megabases for each of the 20 populations. The simulations included a mutation rate of 10<sup>−8</sup> substitutions <inline-formula id="IE2"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM2" display="inline" overflow="scroll"><mml:mo>·</mml:mo></mml:math></inline-formula> site<sup>−1</sup><inline-formula id="IE3"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM3" display="inline" overflow="scroll"><mml:mo>·</mml:mo></mml:math></inline-formula> generation<sup>−1</sup> and recombination rate of 10<sup>−8</sup> recombination <inline-formula id="IE4"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM4" display="inline" overflow="scroll"><mml:mo>·</mml:mo></mml:math></inline-formula> site<sup>−1</sup><inline-formula id="IE5"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM5" display="inline" overflow="scroll"><mml:mo>·</mml:mo></mml:math></inline-formula> generation<sup>−1</sup>. The simulation parameters were identical to that of Pickrell and Pritchard [<xref rid="bpab017-B2" ref-type="bibr">2</xref>]—resulting in patterns of diversity and linkage disequilibrium consistent with that of SNP genotype data for many modern human datasets [<xref rid="bpab017-B19" ref-type="bibr">19</xref>] (see <xref rid="sup1" ref-type="supplementary-material">Supplementary File S1</xref>). To further recapitulate patterns in observed datasets, all loci with a minimum allele frequency &lt;0.05 were removed using <italic toggle="yes">Vcftools</italic> v0.1.13 (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://vcftools.github.io/index.html" ext-link-type="uri">https://vcftools.github.io/index.html</ext-link>; RRID: SCR_001235) [<xref rid="bpab017-B20" ref-type="bibr">20</xref>]. The resulting datasets were run using <italic toggle="yes">Treemix</italic> v1.13 with a global set of rearrangements (-global), and a randomly selected window size (-k) of between 100 and 1000 SNPs (50 SNP increments). The number of migration events (-m) varied between 1 and 10 [<italic toggle="yes">Treemix</italic> natively calculates the <italic toggle="yes">L</italic>(<italic toggle="yes">m</italic> = 0) for each run] and 10 replicates were performed for each value of <italic toggle="yes">m</italic>. Although the parameter “-k” can be fixed across runs, the simulated datasets generally created strong signals that resulted in convergence upon the same composite likelihood across all runs for each value of <italic toggle="yes">m</italic>. This produced a standard deviation across runs of zero, and thus Δ<italic toggle="yes">m</italic> becomes undefined. In this scenario <italic toggle="yes">OptM</italic> will generate a warning to the user, but the practice of permuting across “-k” or across the set of input SNPs will improve the reliability of estimates of Δ<italic toggle="yes">m</italic>. The resulting likelihood files produced by <italic toggle="yes">Treemix</italic> were analyzed and visualized using the functions in <italic toggle="yes">OptM</italic>. See <xref rid="sup1" ref-type="supplementary-material">Supplementary File S1</xref> for a complete description of the methods including computer code used.</p>
    </sec>
    <sec>
      <title>Empirical example</title>
      <p>I applied this method to an empirical dataset composed of 532 domestic dogs from 48 breeds and 15 wolves genotyped for ∼174,000 SNPs on the CanineHD BeadChip [<xref rid="bpab017-B21" ref-type="bibr">21</xref>, <xref rid="bpab017-B22" ref-type="bibr">22</xref>]. In order to accurately estimate allele frequencies, we removed breeds with less than eight individuals genotyped. The SNPs were filtered to include only autosomal loci with a minimum allele frequency ≥0.05 and a genotyping rate ≥0.9 using <italic toggle="yes">Plink</italic> v1.07 (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://zzz.bwh.harvard.edu/plink/" ext-link-type="uri">https://zzz.bwh.harvard.edu/plink/</ext-link>; RRID: SCR_001757) [<xref rid="bpab017-B23" ref-type="bibr">23</xref>]. Individuals with a genotyping rate ≤0.9 were omitted from the analysis. The resulting dataset was run using <italic toggle="yes">Treemix</italic> v1.13 with the same parameters as above with the exceptions of a window size (-k) of 500 SNPs and number of migration events (-m) between 1 and 40. Again, 10 replicates were performed for each value of <italic toggle="yes">m</italic> and the resulting files were analyzed using <italic toggle="yes">OptM</italic> (see <xref rid="sup1" ref-type="supplementary-material">Supplementary File S1</xref>).</p>
    </sec>
  </sec>
  <sec>
    <title>Results and discussion</title>
    <sec>
      <title>Simulated examples</title>
      <p>Four simulated datasets containing either 1 (M1), 3 (M3), 5 (M5), or 8 (M8) migration events from a serial bottleneck model of 20 populations were generated (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). Each migration edge was simulated with 30% admixture (referred to as “migration weight,” or <inline-formula id="IE6"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>, by Pickrell and Pritchard [<xref rid="bpab017-B2" ref-type="bibr">2</xref>]), which <italic toggle="yes">Treemix</italic> was able to accurately infer (range of <inline-formula id="IE7"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> 27% - 33%; <xref rid="bpab017-T1" ref-type="table">Table 1</xref>) in all datasets. However, in M5, <italic toggle="yes">Treemix</italic> incorrectly reported a migration edge from populations 11 → 4 rather than populations 6 → 3 in all iterations, and in M8 a single iteration incorrectly assigned a migration edge between populations 15 → 10 rather than populations 6 → 3 (<xref rid="bpab017-T1" ref-type="table">Table 1</xref>). In M8, <italic toggle="yes">Treemix</italic> reported in 9/10 iterations migration from the common ancestor of populations 19 and 20 into population 10, rather than populations 19 → 10 (<xref rid="bpab017-T1" ref-type="table">Table 1</xref>). The latter error is understandable as populations 19 and 20 only separated ten generations previously. Nevertheless, <italic toggle="yes">Treemix</italic> was able to accurately and consistently infer the correct migration edges across the simulated datasets and is a testament to the utility of this algorithm in inferring population histories.</p>
      <table-wrap position="float" id="bpab017-T1">
        <label>Table 1:</label>
        <caption>
          <p>Admixture proportions inferred by <italic toggle="yes">Treemix</italic> for 1 (M1), 3 (M3), 5 (M5), or 8 (M8) simulated migration edges (rows)</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Migration edge</th>
              <th rowspan="1" colspan="1">M1</th>
              <th rowspan="1" colspan="1">M3</th>
              <th rowspan="1" colspan="1">M5</th>
              <th rowspan="1" colspan="1">M8</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">13 → 5</td>
              <td rowspan="1" colspan="1">0.30 (0.0011)</td>
              <td rowspan="1" colspan="1">0.30 (0.00062)</td>
              <td rowspan="1" colspan="1">0.32 (0.0016)</td>
              <td rowspan="1" colspan="1">0.29 (0.0036)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">4 → 12</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">0.29 (0.00015)</td>
              <td rowspan="1" colspan="1">0.27 (0.0014)</td>
              <td rowspan="1" colspan="1">0.28 (0.00024)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">7 → 16</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">0.30 (0.00037)</td>
              <td rowspan="1" colspan="1">0.31 (0.023)</td>
              <td rowspan="1" colspan="1">0.31 (0.00024)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">6 → 3</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">0.33 (0.0011)<xref rid="tblfn2" ref-type="table-fn"><sup>a</sup></xref></td>
              <td rowspan="1" colspan="1">0.31 (0.00098)<xref rid="tblfn3" ref-type="table-fn"><sup>b</sup></xref></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">9 → 17</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">0.28 (0.0086)</td>
              <td rowspan="1" colspan="1">0.29 (0.00027)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">15 → 1</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">0.29 (0.076)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">14 → 8</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">0.29 (0.00029)</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">19 → 10</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">0.30 (0.012)<xref rid="tblfn4" ref-type="table-fn"><sup>c</sup></xref></td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p>The direction of the simulated migration is reported in the first column (source → sink). The standard deviation from 10 iterations is shown within parentheses.</p>
          </fn>
          <fn id="tblfn2">
            <label>a</label>
            <p><italic toggle="yes">Treemix</italic> incorrectly inferred the migration edge 11 → 4 rather than 6 → 3 for all 10 iterations.</p>
          </fn>
          <fn id="tblfn3">
            <label>b</label>
            <p><italic toggle="yes">Treemix</italic> correctly inferred the 6 → 3 migration edge in 9/10 iterations, but one iteration incorrectly reported a 15 → 10 edge.</p>
          </fn>
          <fn id="tblfn4">
            <label>c</label>
            <p>In 9/10 iterations, <italic toggle="yes">Treemix</italic> reported the source of this migration edge to be the common ancestor of 19 and 20, or 19/20 → 10.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>When using the method in <italic toggle="yes">OptM</italic> to infer the optimal value for <italic toggle="yes">m</italic> from 0 to 10 simulated migration edges, the highest value for the second-order rate of change in likelihood, or Δ<italic toggle="yes">m</italic>, identified the correct number of simulated migration edges in all four datasets (<xref rid="bpab017-F1" ref-type="fig">Fig. 1</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). The inferences based on Δ<italic toggle="yes">m</italic> for datasets M3, M5, and M8 were equivalent to those suggested by the authors of <italic toggle="yes">Treemix</italic> based upon the 99.8% variation cutoff [<xref rid="bpab017-B2" ref-type="bibr">2</xref>]. However, for dataset M1, which had only one migration edge, the 99.8% threshold was exceeded even when no migration edges were inferred, but <italic toggle="yes">OptM</italic> was able to correctly identify this situation. As a result, <italic toggle="yes">OptM</italic> may outperform the previous method when the true number of migration edges is very small. <italic toggle="yes">OptM</italic> was also used to fit piecewise linear, bent cable, simple exponential, and non-linear least squares threshold models to <italic toggle="yes">L</italic>(<italic toggle="yes">m</italic>) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref> and <xref rid="sup1" ref-type="supplementary-material">Fig. S3</xref>), albeit the Δ<italic toggle="yes">m</italic> method outperformed these models.</p>
      <fig position="float" id="bpab017-F1">
        <label>Figure 1:</label>
        <caption>
          <p>The output produced by <italic toggle="yes">OptM</italic> for the simulated dataset with <italic toggle="yes">m</italic> = 3 migration edges. (<bold>a</bold>) The mean and standard deviation (SD) across 10 iterations for the composite likelihood <italic toggle="yes">L</italic>(<italic toggle="yes">m</italic>) (left axis, black circles) and proportion of variance explained (right axis, red “x”s). The 99.8% threshold (horizontal dotted line) is that recommended by Pickrell and Pritchard [<xref rid="bpab017-B2" ref-type="bibr">2</xref>]. (<bold>b</bold>) The second-order rate of change (Δ<italic toggle="yes">m</italic>) across values of <italic toggle="yes">m</italic>.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="bpab017f1" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>Empirical example</title>
      <p>I ran <italic toggle="yes">Treemix</italic> on an empirical dataset that, after filtering, contained 496 domestic dogs from 34 breeds, 12 wolves, and &gt;138 000 SNPs. I ran 400 instances of <italic toggle="yes">Treemix</italic>, 10 iterations for <italic toggle="yes">m</italic> = 1–40 migration edges. Even after including 40 migration edges, the 99.8% recommended threshold for stopping the addition of migration edges was not met (<xref rid="bpab017-F2" ref-type="fig">Fig. 2a</xref>). Rather, <italic toggle="yes">OptM</italic> suggested that five migration edges should be optimally included (<xref rid="bpab017-F2" ref-type="fig">Figs 2b</xref> and <xref rid="bpab017-F3" ref-type="fig">3</xref>).</p>
      <fig position="float" id="bpab017-F2">
        <label>Figure 2:</label>
        <caption>
          <p>The output produced by <italic toggle="yes">OptM</italic> for an empirical dataset of domestic dogs. A total of 10 iterations were run for each possible number of migration edges, <italic toggle="yes">m</italic> = 1–40. (<bold>a</bold>) The mean and standard deviation (SD) for the composite likelihood <italic toggle="yes">L</italic>(<italic toggle="yes">m</italic>) (left axis, black circles) and proportion of variance explained (right axis, red “x”s). The 99.8% threshold is that recommended by Pickrell and Pritchard [<xref rid="bpab017-B2" ref-type="bibr">2</xref>], but not visible here because the threshold is still not met at <italic toggle="yes">m</italic> = 40 edges. <italic toggle="yes">OptM</italic> produces a warning to notify the user that this threshold is not visible. (<bold>b</bold>) The second-order rate of change (Δ<italic toggle="yes">m</italic>) across values of <italic toggle="yes">m</italic>. The arrow indicates the peak in Δ<italic toggle="yes">m</italic> at <italic toggle="yes">m</italic> = 5 edges.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="bpab017f2" position="float"/>
      </fig>
      <p>Although each of the 10 iterations at <italic toggle="yes">m</italic> = 5 inferred a slightly different set of migration edges, five migrations edges were substantially more common than the others (<xref rid="bpab017-T2" ref-type="table">Table 2</xref>). These included <inline-formula id="IE8"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> = 9.3% (SD 0.68%) from the boxer into the Shar-Pei, similar to the <inline-formula id="IE9"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> = 8% reported by Pickrell and Pritchard [<xref rid="bpab017-B2" ref-type="bibr">2</xref>] for the same edge using a different set of SNPs. This edge is likely the result of the Shar-Pei being considered an ancient breed [<xref rid="bpab017-B24" ref-type="bibr">24</xref>, <xref rid="bpab017-B25" ref-type="bibr">25</xref>] and the fact that most canine SNPs on commercial genotyping chips were ascertained from the boxer’s genome [<xref rid="bpab017-B2" ref-type="bibr">2</xref>, <xref rid="bpab017-B22" ref-type="bibr">22</xref>]. Extensive gene flow from the Schipperke into the Eurasian (<inline-formula id="IE10"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> = 41% SD 0.36%) is consistent with the known European × East Asian spitz-type hybrid origin of the Eurasian and has been observed elsewhere [<xref rid="bpab017-B25" ref-type="bibr">25</xref>]. Gene flow from the Schipperke into the Poodle (<inline-formula id="IE11"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> = 41% SD 0.48%) is less clear, as this migration edge has yet to be described, but could be a result of the fact that 65.1% of SNPs on the CanineHD beadchip were ascertained from a Boxer-Poodle comparison [<xref rid="bpab017-B22" ref-type="bibr">22</xref>]. The remaining two notable migration edges were from the English Bulldog into the ancestor of the Nova Scotia Duck Tolling Retriever, Labrador Retriever, Golden Retriever, and Newfoundland (<inline-formula id="IE12"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> = 8.5% SD 0.23%) and both the English Bulldog + English Bull Terrier into the Irish Wolfhound and Greyhound (<inline-formula id="IE13"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> = 21% SD 0.63%). All of the breeds included in these two migration edges originate from the British Isles, and probably illustrate the many cross-breeding events that took place to create hybrid varieties that would excel in dog fighting contests prior to the strict studbook keeping in the middle to late nineteenth century [<xref rid="bpab017-B8" ref-type="bibr">8</xref>, <xref rid="bpab017-B26" ref-type="bibr">26</xref>, <xref rid="bpab017-B27" ref-type="bibr">27</xref>]. All migration edges inferred by <italic toggle="yes">Treemix</italic> appeared early on the various branches (<xref rid="bpab017-F3" ref-type="fig">Fig. 3</xref>), and thus most likely represent ancient gene flow that predates modern breed development and the complex nature of domestic dog evolutionary history.</p>
      <fig position="float" id="bpab017-F3">
        <label>Figure 3:</label>
        <caption>
          <p>The tree structure of the graph inferred by <italic toggle="yes">Treemix</italic> for the 34 dog breeds and gray wolf populations. Five migration edges were allowed as inferred by <italic toggle="yes">OptM</italic>. The migration edges are colored according to their weight (<inline-formula id="IE14"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>). The scale bar indicates ten times the average standard error of the values in the covariance matrix.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="bpab017f3" position="float"/>
      </fig>
      <table-wrap position="float" id="bpab017-T2">
        <label>Table 2:</label>
        <caption>
          <p>Summary of all the migrations edges inferred across 10 iterations at <italic toggle="yes">m</italic> = 5 (the optimal number inferred by <italic toggle="yes">OptM</italic>)</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Source lineage</th>
              <th rowspan="1" colspan="1">Recipient lineage</th>
              <th rowspan="1" colspan="1"><inline-formula id="IE15"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> (SD)</th>
              <th rowspan="1" colspan="1">Number of iterations</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Box</td>
              <td rowspan="1" colspan="1">ShP</td>
              <td rowspan="1" colspan="1">0.093 (0.0068)</td>
              <td rowspan="1" colspan="1">9/10</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Sci</td>
              <td rowspan="1" colspan="1">Eur</td>
              <td rowspan="1" colspan="1">0.41 (0.0036)</td>
              <td rowspan="1" colspan="1">9/10</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Sci</td>
              <td rowspan="1" colspan="1">StP+PdL</td>
              <td rowspan="1" colspan="1">0.41 (0.0048)</td>
              <td rowspan="1" colspan="1">9/10</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">EBD</td>
              <td rowspan="1" colspan="1">NSD+((LRe+GRe)+NFd)</td>
              <td rowspan="1" colspan="1">0.085 (0.0023)</td>
              <td rowspan="1" colspan="1">8/10</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">EBD+EBT</td>
              <td rowspan="1" colspan="1">IrW+Gry</td>
              <td rowspan="1" colspan="1">0.21 (0.0063)</td>
              <td rowspan="1" colspan="1">7/10</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">EBT</td>
              <td rowspan="1" colspan="1">IrW+Gry</td>
              <td rowspan="1" colspan="1">0.16 (0.00094)</td>
              <td rowspan="1" colspan="1">2/10</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">EBD+EBT</td>
              <td rowspan="1" colspan="1">NSD+((GRe +LRe)+NFd)</td>
              <td rowspan="1" colspan="1">0.11 (NA)</td>
              <td rowspan="1" colspan="1">1/10</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">EBD+EBT</td>
              <td rowspan="1" colspan="1">(Rtw+BMD)+(NSD+((GRe+LRe)+NFd))</td>
              <td rowspan="1" colspan="1">0.086 (NA)</td>
              <td rowspan="1" colspan="1">1/10</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">EBD</td>
              <td rowspan="1" colspan="1">ShP</td>
              <td rowspan="1" colspan="1">0.046 (NA)</td>
              <td rowspan="1" colspan="1">1/10</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">EBD</td>
              <td rowspan="1" colspan="1">IrW+Gry</td>
              <td rowspan="1" colspan="1">0.15 (NA)</td>
              <td rowspan="1" colspan="1">1/10</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">ShP</td>
              <td rowspan="1" colspan="1">Box</td>
              <td rowspan="1" colspan="1">0.10 (NA)</td>
              <td rowspan="1" colspan="1">1/10</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">StP</td>
              <td rowspan="1" colspan="1">(((GSl+(Wlf+(ShP+Eur)))+FSp)+Elk)+Sci</td>
              <td rowspan="1" colspan="1">0.15 (NA)</td>
              <td rowspan="1" colspan="1">1/10</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">StP</td>
              <td rowspan="1" colspan="1">((((Wlf+(ShP+Eur))+GSl)+FSp)+Elk)+Sci</td>
              <td rowspan="1" colspan="1">0.17 (NA)</td>
              <td rowspan="1" colspan="1">1/10</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn5">
            <p><inline-formula id="IE16"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>, migration weight, Breed abbreviations are as follows: Box, Boxer; BMD, Burnese Mountain Dog; Elk, Elkhound; EBD, English Bulldog; EBT, English Bull Terrier; Eur, Eurasian; FSp, Finnish Spitz; GRe, Golden Retriever; GSl, Greenland Sledge Dog; Gry, Greyhound; IrW, Irish Wolfhound; LRe, Labrador Retriever; NFd, Newfoundland; NSD, Nova Scotia Duck Tolling Retriever; PdL, Poodle; Rtw, Rottweiler; Sci, Schipperke; ShP, Shar-Pei; StP, Standard Poodle; Wlf, wolf.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
  </sec>
  <sec>
    <title>Conclusions</title>
    <p>I have demonstrated here that the method of Evanno <italic toggle="yes">et al</italic>. [<xref rid="bpab017-B10" ref-type="bibr">10</xref>] developed for inferring the number of population clusters from <italic toggle="yes">Structure</italic> and implemented in <italic toggle="yes">OptM</italic> can be repurposed to infer the optimal number of migration edges using <italic toggle="yes">Treemix</italic>. Using simulated population genomic data, <italic toggle="yes">OptM</italic> performs equally as well as the currently recommended threshold of 99.8% variation explained. However, when tested on empirical data of numerous populations and complex evolutionary history (where the true <italic toggle="yes">m</italic> is quite large), <italic toggle="yes">OptM</italic> can suggest a quantitative and producible measure of the optimal number of migration edges that best explain the tree graph. It must be noted that <italic toggle="yes">OptM</italic> is not attempting to infer the actual number of migration edges, although in less complex scenarios this is possible, but rather a reduced number that can be prioritized for their ability to best improve the fit to the tree model.</p>
    <p>Although <italic toggle="yes">OptM</italic> is very fast, it requires multiple runs of the <italic toggle="yes">Treemix</italic> algorithm which can be computationally intensive, especially for large values of <italic toggle="yes">m</italic>. However, multiple iterations of <italic toggle="yes">Treemix</italic>, especially while varying the SNP-block length (-k) and/or bootstrapped across the input SNPs, can reduce the effects of spurious or weak migration edges. Furthermore, the relative height of various peaks in Δ<italic toggle="yes">m</italic> can indicate other values for <italic toggle="yes">m</italic> worth exploring, although at less explanatory power than the maximum Δ<italic toggle="yes">m</italic> [<xref rid="bpab017-B10" ref-type="bibr">10</xref>]. The method of <italic toggle="yes">OptM</italic> does not resolve occasional shortcomings already described for Δ<italic toggle="yes">K</italic> (i.e., the <italic toggle="yes">K</italic> = 2 conundrum) [<xref rid="bpab017-B28" ref-type="bibr">28</xref>] or <italic toggle="yes">Treemix</italic>, notably when migration is between closely related populations without outgroups, such as incorrect directionality, admixture in populations related to a truly admixed population, and underestimated migration weights when admixture proportions are high [<xref rid="bpab017-B2" ref-type="bibr">2</xref>]. Nevertheless, with the ever-increasing availability of population genomic data for a variety of species, <italic toggle="yes">OptM</italic> serves a valuable purpose in providing a robust and reproducible tool for inferring the optimal number of migration events that can best explain extant levels of genetic variation from complex population histories.</p>
  </sec>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> is available at <italic toggle="yes">Biology Methods and Protocols</italic> online.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p><italic toggle="yes">OptM</italic> v0.1.5 is currently available through CRAN (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://cran.r-project.org/web/packages/OptM" ext-link-type="uri">https://cran.r-project.org/web/packages/OptM</ext-link>) or web application (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://rfitak.shinyapps.io/OptM/" ext-link-type="uri">https://rfitak.shinyapps.io/OptM/</ext-link>; <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>). Additional computer code for generating the simulated datasets and running <italic toggle="yes">OptM</italic> is available in <xref rid="sup1" ref-type="supplementary-material">Supplementary File S1</xref>, and an example configuration file for the simulations can be found in <xref rid="sup1" ref-type="supplementary-material">Supplementary File S2</xref>. The domestic dog dataset from Vaysse <italic toggle="yes">et al</italic>. [<xref rid="bpab017-B22" ref-type="bibr">22</xref>] is publicly available at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://dogs.genouest.org/SWEEP.dir/Supplemental.html" ext-link-type="uri">http://dogs.genouest.org/SWEEP.dir/Supplemental.html</ext-link>.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>bpab017_Supplementary_Data</label>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="bpab017_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>I am grateful to the Duke Compute Cluster for providing the computational resources necessary for this study. I also thank A. Ochoa for commenting on earlier versions of this manuscript. There is no specific funding to report for this study.</p>
    <sec>
      <title>Author contributions</title>
      <p>R.R.F. completed all aspects of the study.</p>
    </sec>
    <sec>
      <title>Conflict of interest</title>
      <p>The author declares no conflict of interest.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="bpab017-B1">
      <label>1</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ellegren</surname><given-names>H.</given-names></string-name></person-group><article-title>Genome sequencing and population genomics in non-model organisms</article-title>. <source>Trends Ecol Evol</source><year>2014</year>;<volume>29</volume>:<fpage>51</fpage>–<lpage>63</lpage>.<pub-id pub-id-type="pmid">24139972</pub-id></mixed-citation>
    </ref>
    <ref id="bpab017-B2">
      <label>2</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pickrell</surname><given-names>JK</given-names></string-name>, <string-name><surname>Pritchard</surname><given-names>JK.</given-names></string-name></person-group><article-title>Inference of population splits and mixtures from genome-wide allele frequency data</article-title>. <source>PLoS Genet</source><year>2012</year>;<volume>8</volume>:<fpage>e1002967</fpage>.<pub-id pub-id-type="pmid">23166502</pub-id></mixed-citation>
    </ref>
    <ref id="bpab017-B3">
      <label>3</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Teixeira</surname><given-names>MM</given-names></string-name>, <string-name><surname>Barker</surname><given-names>BM.</given-names></string-name></person-group><article-title>Use of population genetics to assess the ecology, evolution, and population structure of Coccidioides</article-title>. <source>Emerg Infect Dis</source><year>2016</year>;<volume>22</volume>:<fpage>1022</fpage>–<lpage>30</lpage>.<pub-id pub-id-type="pmid">27191589</pub-id></mixed-citation>
    </ref>
    <ref id="bpab017-B4">
      <label>4</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>von Wettberg</surname><given-names>EJB</given-names></string-name>, <string-name><surname>Chang</surname><given-names>PL</given-names></string-name>, <string-name><surname>Basdemir</surname><given-names>F</given-names></string-name></person-group><etal>et al</etal><article-title>Ecology and genomics of an important crop wild relative as a prelude to agricultural innovation</article-title>. <source>Nat Commun</source><year>2018</year>;<volume>9</volume>:<fpage>649</fpage>.<pub-id pub-id-type="pmid">29440741</pub-id></mixed-citation>
    </ref>
    <ref id="bpab017-B5">
      <label>5</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Card</surname><given-names>DC</given-names></string-name>, <string-name><surname>Schield</surname><given-names>DR</given-names></string-name>, <string-name><surname>Adams</surname><given-names>RH</given-names></string-name></person-group><etal>et al</etal><article-title>Phylogeographic and population genetic analyses reveal multiple species of Boa and independent origins of insular dwarfism</article-title>. <source>Mol Phylogenet Evol</source><year>2016</year>;<volume>102</volume>:<fpage>104</fpage>–<lpage>16</lpage>.<pub-id pub-id-type="pmid">27241629</pub-id></mixed-citation>
    </ref>
    <ref id="bpab017-B6">
      <label>6</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Decker</surname><given-names>JE</given-names></string-name>, <string-name><surname>McKay</surname><given-names>SD</given-names></string-name>, <string-name><surname>Rolf</surname><given-names>MM</given-names></string-name></person-group><etal>et al</etal><article-title>Worldwide patterns of ancestry, divergence, and admixture in domesticated cattle</article-title>. <source>PLoS Genet</source><year>2014</year>;<volume>10</volume>:<fpage>e1004254</fpage>.<pub-id pub-id-type="pmid">24675901</pub-id></mixed-citation>
    </ref>
    <ref id="bpab017-B7">
      <label>7</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Foote</surname><given-names>AD</given-names></string-name>, <string-name><surname>Vijay</surname><given-names>N</given-names></string-name>, <string-name><surname>Avila-Arcos</surname><given-names>MC</given-names></string-name></person-group><etal>et al</etal><article-title>Genome-culture coevolution promotes rapid divergence of killer whale ecotypes</article-title>. <source>Nat Commun</source><year>2016</year>;<volume>7</volume>:<fpage>11693</fpage>.<pub-id pub-id-type="pmid">27243207</pub-id></mixed-citation>
    </ref>
    <ref id="bpab017-B8">
      <label>8</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Parker</surname><given-names>HG</given-names></string-name>, <string-name><surname>Dreger</surname><given-names>DL</given-names></string-name>, <string-name><surname>Rimbault</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Genomic analyses reveal the influence of geographic origin, migration, and hybridization on modern dog breed development</article-title>. <source>Cell Rep</source><year>2017</year>;<volume>19</volume>:<fpage>697</fpage>–<lpage>708</lpage>.<pub-id pub-id-type="pmid">28445722</pub-id></mixed-citation>
    </ref>
    <ref id="bpab017-B9">
      <label>9</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Alberto</surname><given-names>FJ</given-names></string-name>, <string-name><surname>Boyer</surname><given-names>F</given-names></string-name>, <string-name><surname>Orozco-terWengel</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>Convergent genomic signatures of domestication in sheep and goats</article-title>. <source>Nat Commun</source><year>2018</year>;<volume>9</volume>:<fpage>813</fpage>.<pub-id pub-id-type="pmid">29511174</pub-id></mixed-citation>
    </ref>
    <ref id="bpab017-B10">
      <label>10</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Evanno</surname><given-names>G</given-names></string-name>, <string-name><surname>Regnaut</surname><given-names>S</given-names></string-name>, <string-name><surname>Goudet</surname><given-names>J.</given-names></string-name></person-group><article-title>Detecting the number of clusters of individuals using the software structure: a simulation study</article-title>. <source>Mol Ecol</source><year>2005</year>;<volume>14</volume>:<fpage>2611</fpage>–<lpage>20</lpage>.<pub-id pub-id-type="pmid">15969739</pub-id></mixed-citation>
    </ref>
    <ref id="bpab017-B11">
      <label>11</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pritchard</surname><given-names>JK</given-names></string-name>, <string-name><surname>Stephens</surname><given-names>M</given-names></string-name>, <string-name><surname>Donnelly</surname><given-names>P.</given-names></string-name></person-group><article-title>Inference of population structure using multilocus genotype data</article-title>. <source>Genetics</source><year>2000</year>;<volume>155</volume>:<fpage>945</fpage>–<lpage>59</lpage>.<pub-id pub-id-type="pmid">10835412</pub-id></mixed-citation>
    </ref>
    <ref id="bpab017-B12">
      <label>12</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Porras-Hurtado</surname><given-names>L</given-names></string-name>, <string-name><surname>Ruiz</surname><given-names>Y</given-names></string-name>, <string-name><surname>Santos</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>An overview of STRUCTURE: applications, parameter settings, and supporting software</article-title>. <source>Front Genet</source><year>2013</year>;<volume>4</volume>:<fpage>98</fpage>.<pub-id pub-id-type="pmid">23755071</pub-id></mixed-citation>
    </ref>
    <ref id="bpab017-B13">
      <label>13</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Novembre</surname><given-names>J.</given-names></string-name></person-group><article-title>Pritchard, Stephens, and Donnelly on population structure</article-title>. <source>Genetics</source><year>2016</year>;<volume>204</volume>:<fpage>391</fpage>–<lpage>3</lpage>.<pub-id pub-id-type="pmid">27729489</pub-id></mixed-citation>
    </ref>
    <ref id="bpab017-B14">
      <label>14</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Pritchard</surname><given-names>JK</given-names></string-name>, <string-name><surname>Wen</surname><given-names>X</given-names></string-name>, <string-name><surname>Falush</surname><given-names>D.</given-names></string-name></person-group><year>2010</year>. Documentation for <italic toggle="yes">structure</italic> software: Version 2.3. <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://web.stanford.edu/group/pritchardlab/structure_software/release_versions/v2.3.4/structure_doc.pdf" ext-link-type="uri">https://web.stanford.edu/group/pritchardlab/structure_software/release_versions/v2.3.4/structure_doc.pdf</ext-link> (17 September 2021, date last accessed).</mixed-citation>
    </ref>
    <ref id="bpab017-B15">
      <label>15</label>
      <mixed-citation publication-type="other"><collab>R Core Development Team</collab>. R: A Language and Environment for Statistical Computing. Vienna: R Foundation for Statistical Computing, <year>2017</year>. <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://cran.r-project.org/" ext-link-type="uri">https://cran.r-project.org/</ext-link> (17 September 2021, date last accessed).</mixed-citation>
    </ref>
    <ref id="bpab017-B16">
      <label>16</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sonderegger</surname><given-names>DL</given-names></string-name>, <string-name><surname>Wang</surname><given-names>H</given-names></string-name>, <string-name><surname>Clements</surname><given-names>WH</given-names></string-name></person-group><etal>et al</etal><article-title>Using SiZer to detect thresholds in ecological data</article-title>. <source>Front Ecol Environ</source><year>2009</year>;<volume>7</volume>:<fpage>190</fpage>–<lpage>5</lpage>.</mixed-citation>
    </ref>
    <ref id="bpab017-B17">
      <label>17</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Akaike</surname><given-names>H.</given-names></string-name></person-group><part-title>Information theory and an extension of the maximum likelihood principle</part-title>. In: <person-group person-group-type="editor"><string-name><surname>Petrov</surname><given-names>BN</given-names></string-name>, <string-name><surname>Csaki</surname><given-names>F</given-names></string-name></person-group> (eds), <source>Second International Symposium on Information Theory</source>. <publisher-loc>Budapest</publisher-loc>: <publisher-name>Akadémiai Kiadó</publisher-name>. <year>1973</year>, <fpage>267</fpage>–<lpage>81</lpage>.</mixed-citation>
    </ref>
    <ref id="bpab017-B18">
      <label>18</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Palamara</surname><given-names>PF.</given-names></string-name></person-group><article-title>ARGON: fast, whole-genome simulation of the discrete time Wright-fisher process</article-title>. <source>Bioinformatics</source><year>2016</year>;<volume>32</volume>:<fpage>3032</fpage>–<lpage>4</lpage>.<pub-id pub-id-type="pmid">27312410</pub-id></mixed-citation>
    </ref>
    <ref id="bpab017-B19">
      <label>19</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>DeGiorgio</surname><given-names>M</given-names></string-name>, <string-name><surname>Jakobsson</surname><given-names>M</given-names></string-name>, <string-name><surname>Rosenberg</surname><given-names>NA.</given-names></string-name></person-group><article-title>Explaining worldwide patterns of human genetic variation using a coalescent-based serial founder model of migration outward from Africa</article-title>. <source>Proc Natl Acad Sci USA</source><year>2009</year>;<volume>106</volume>:<fpage>16057</fpage>–<lpage>62</lpage>.<pub-id pub-id-type="pmid">19706453</pub-id></mixed-citation>
    </ref>
    <ref id="bpab017-B20">
      <label>20</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Danecek</surname><given-names>P</given-names></string-name>, <string-name><surname>Auton</surname><given-names>A</given-names></string-name>, <string-name><surname>Abecasis</surname><given-names>G</given-names></string-name></person-group><etal>et al</etal>, <collab>1000 Genomes Project Analysis Group</collab>. <article-title>The variant call format and VCFtools</article-title>. <source>Bioinformatics</source><year>2011</year>;<volume>27</volume>:<fpage>2156</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">21653522</pub-id></mixed-citation>
    </ref>
    <ref id="bpab017-B21">
      <label>21</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lequarré</surname><given-names>AS</given-names></string-name>, <string-name><surname>Andersson</surname><given-names>L</given-names></string-name>, <string-name><surname>Andre</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>LUPA: a European initiative taking advantage of the canine genome architecture for unravelling complex disorders in both human and dogs</article-title>. <source>Vet J</source><year>2011</year>;<volume>189</volume>:<fpage>155</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">21752675</pub-id></mixed-citation>
    </ref>
    <ref id="bpab017-B22">
      <label>22</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vaysse</surname><given-names>A</given-names></string-name>, <string-name><surname>Ratnakumar</surname><given-names>A</given-names></string-name>, <string-name><surname>Derrien</surname><given-names>T</given-names></string-name></person-group><etal>et al</etal>, <collab>LUPA Consortium</collab>. <article-title>Identification of genomic regions associated with phenotypic variation between dog breeds using selection mapping</article-title>. <source>PLoS Genet</source><year>2011</year>;<volume>7</volume>:<fpage>e1002316</fpage>.<pub-id pub-id-type="pmid">22022279</pub-id></mixed-citation>
    </ref>
    <ref id="bpab017-B23">
      <label>23</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Purcell</surname><given-names>S</given-names></string-name>, <string-name><surname>Neale</surname><given-names>B</given-names></string-name>, <string-name><surname>Todd-Brown</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal><article-title>PLINK: A tool set for whole-genome association and population-based linkage analyses</article-title>. <source>Am J Hum Genet</source><year>2007</year>;<volume>81</volume>:<fpage>559</fpage>–<lpage>75</lpage>.<pub-id pub-id-type="pmid">17701901</pub-id></mixed-citation>
    </ref>
    <ref id="bpab017-B24">
      <label>24</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>GD</given-names></string-name>, <string-name><surname>Zhai</surname><given-names>WW</given-names></string-name>, <string-name><surname>Yang</surname><given-names>HC</given-names></string-name></person-group><etal>et al</etal><article-title>Out of southern East Asia: the natural history of domestic dogs across the world</article-title>. <source>Cell Res</source><year>2016</year>;<volume>26</volume>:<fpage>21</fpage>–<lpage>33</lpage>.<pub-id pub-id-type="pmid">26667385</pub-id></mixed-citation>
    </ref>
    <ref id="bpab017-B25">
      <label>25</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pilot</surname><given-names>M</given-names></string-name>, <string-name><surname>Malewski</surname><given-names>T</given-names></string-name>, <string-name><surname>Moura</surname><given-names>AE</given-names></string-name></person-group><etal>et al</etal><article-title>On the origin of mongrels: evolutionary history of free-breeding dogs in Eurasia</article-title>. <source>Proc Biol Sci</source><year>2015</year>;<volume>282</volume>:<fpage>20152189</fpage>.<pub-id pub-id-type="pmid">26631564</pub-id></mixed-citation>
    </ref>
    <ref id="bpab017-B26">
      <label>26</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Lee</surname><given-names>RB.</given-names></string-name></person-group><source>A History and Description of the Modern Dogs of Great Britain and Ireland. Sporting Division</source>. <publisher-loc>London</publisher-loc>: <publisher-name>H. Cox</publisher-name>, <year>1897</year>.</mixed-citation>
    </ref>
    <ref id="bpab017-B27">
      <label>27</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Lee</surname><given-names>RB.</given-names></string-name></person-group><source>A History and Description of the Modern Dogs of Great Britain and Ireland. The Terriers</source>. <publisher-loc>London</publisher-loc>: <publisher-name>H. Cox</publisher-name>, <year>1903</year>.</mixed-citation>
    </ref>
    <ref id="bpab017-B28">
      <label>28</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Janes</surname><given-names>JK</given-names></string-name>, <string-name><surname>Miller</surname><given-names>JM</given-names></string-name>, <string-name><surname>Dupuis</surname><given-names>JR</given-names></string-name></person-group><etal>et al</etal><article-title>The K = 2 conundrum</article-title>. <source>Mol Ecol</source><year>2017</year>;<volume>26</volume>:<fpage>3594</fpage>–<lpage>602</lpage>.<pub-id pub-id-type="pmid">28544181</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
