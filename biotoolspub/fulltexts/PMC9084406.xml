<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD with OASIS Tables v1.0 20120330//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing-oasis-article1.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName jats-oasis2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">J Biomed Opt</journal-id>
    <journal-id journal-id-type="iso-abbrev">J Biomed Opt</journal-id>
    <journal-id journal-id-type="coden">JBOPFO</journal-id>
    <journal-id journal-id-type="publisher-id">JBO</journal-id>
    <journal-title-group>
      <journal-title>Journal of Biomedical Optics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1083-3668</issn>
    <issn pub-type="epub">1560-2281</issn>
    <publisher>
      <publisher-name>Society of Photo-Optical Instrumentation Engineers</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9084406</article-id>
    <article-id pub-id-type="pmid">35534924</article-id>
    <article-id pub-id-type="doi">10.1117/1.JBO.27.8.083015</article-id>
    <article-id pub-id-type="publisher-manuscript">JBO-220009SSR</article-id>
    <article-id pub-id-type="publisher-id">220009SSR</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Special Section Celebrating 30 Years of Open Source Monte Carlo Codes in Biomedical Optics</subject>
      </subj-group>
      <subj-group subj-group-type="SPIE-art-type">
        <subject>Paper</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Graphics-processing-unit-accelerated Monte Carlo simulation of polarized light in complex three-dimensional media</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-1983-4625</contrib-id>
        <name>
          <surname>Yan</surname>
          <given-names>Shijie</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">a</xref>
        <xref rid="b1" ref-type="bio"/>
        <email>yan.shiji@northeastern.edu</email>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-5350-7671</contrib-id>
        <name>
          <surname>Jacques</surname>
          <given-names>Steven L.</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">b</xref>
        <xref rid="b2" ref-type="bio"/>
        <email>stevjacq@gmail.com</email>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-5710-6004</contrib-id>
        <name>
          <surname>Ramella-Roman</surname>
          <given-names>Jessica C.</given-names>
        </name>
        <xref rid="aff3" ref-type="aff">c</xref>
        <xref rid="b3" ref-type="bio"/>
        <email>jramella@fiu.edu</email>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-0805-935X</contrib-id>
        <name>
          <surname>Fang</surname>
          <given-names>Qianqian</given-names>
        </name>
        <xref rid="aff4" ref-type="aff">d</xref>
        <xref rid="cor1" ref-type="corresp">*</xref>
        <xref rid="b4" ref-type="bio"/>
        <email>q.fang@neu.edu</email>
      </contrib>
      <aff id="aff1"><label>a</label><institution>Northeastern University</institution>, Department of Electrical and Computer Engineering, Boston, Massachusetts, <country>United States</country></aff>
      <aff id="aff2"><label>b</label><institution>University of Washington</institution>, Department of Bioengineering, Seattle, Washington, <country>United States</country></aff>
      <aff id="aff3"><label>c</label><institution>Florida International University</institution>, Department of Biomedical Engineering, Miami, Florida, <country>United States</country></aff>
      <aff id="aff4"><label>d</label><institution>Northeastern University</institution>, Department of Bioengineering, Boston, Massachusetts, <country>United States</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><label>*</label>Address all correspondence to Qianqian Fang, <email>q.fang@neu.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>9</day>
      <month>5</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <month>8</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>9</day>
      <month>5</month>
      <year>2022</year>
    </pub-date>
    <!--PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>.-->
    <volume>27</volume>
    <issue>8</issue>
    <elocation-id>083015</elocation-id>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>1</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>8</day>
        <month>4</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2022 The Authors</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>The Authors</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>Published by SPIE under a Creative Commons Attribution 4.0 International License. Distribution or reproduction of this work in whole or in part requires full attribution of the original publication, including its DOI.</license-p>
      </license>
    </permissions>
    <self-uri xlink:title="pdf" xlink:href="JBO_27_8_083015.pdf"/>
    <abstract>
      <title>Abstract.</title>
      <sec>
        <title>Significance</title>
        <p>Monte Carlo (MC) methods have been applied for studying interactions between polarized light and biological tissues, but most existing MC codes supporting polarization modeling can only simulate homogeneous or multi-layered domains, resulting in approximations when handling realistic tissue structures.</p>
      </sec>
      <sec>
        <title>Aim</title>
        <p>Over the past decade, the speed of MC simulations has seen dramatic improvement with massively parallel computing techniques. Developing hardware-accelerated MC simulation algorithms that can accurately model polarized light inside three-dimensional (3D) heterogeneous tissues can greatly expand the utility of polarization in biophotonics applications.</p>
      </sec>
      <sec>
        <title>Approach</title>
        <p>Here, we report a highly efficient polarized MC algorithm capable of modeling arbitrarily complex media defined over a voxelated domain. Each voxel of the domain can be associated with spherical scatters of various radii and densities. The Stokes vector of each simulated photon packet is updated through photon propagation, creating spatially resolved polarization measurements over the detectors or domain surface.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We have implemented this algorithm in our widely disseminated MC simulator, Monte Carlo eXtreme (MCX). It is validated by comparing with a reference central-processing-unit-based simulator in both homogeneous and layered domains, showing excellent agreement and a 931-fold speedup.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>The polarization-enabled MCX offers biophotonics community an efficient tool to explore polarized light in bio-tissues, and is freely available at <ext-link xlink:href="http://mcx.space/" ext-link-type="uri">http://mcx.space/</ext-link>.</p>
      </sec>
    </abstract>
    <kwd-group>
      <title>Keywords:</title>
      <kwd>Monte Carlo method</kwd>
      <kwd>light transport</kwd>
      <kwd>polarization</kwd>
      <kwd>optical imaging</kwd>
    </kwd-group>
    <funding-group>
      <award-group id="sp1">
        <funding-source>National Institutes of Health<named-content content-type="fundref:id">https://doi.org/10.13039/100000002</named-content></funding-source>
        <award-id>R01-GM114365</award-id>
        <award-id>R01-CA204443</award-id>
        <award-id>R01-EB026998</award-id>
      </award-group>
    </funding-group>
    <counts>
      <fig-count count="4"/>
      <table-count count="0"/>
      <ref-count count="39"/>
      <page-count count="10"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>running-head</meta-name>
        <meta-value>Yan et al.: Graphics-processing-unit-accelerated Monte Carlo simulation of polarized light in complex…</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="sec1">
    <label>1</label>
    <title>Introduction</title>
    <p>Polarized light has been found to be highly sensitive to medium structures and hence has been widely adopted in optical imaging to probe microstructural features inside biological tissues.<xref rid="r1" ref-type="bibr"><sup>1</sup></xref><named-content content-type="online"><xref rid="r2" ref-type="bibr"/><xref rid="r3" ref-type="bibr"/></named-content><named-content content-type="print"><sup>–</sup></named-content><xref rid="r4" ref-type="bibr"><sup>4</sup></xref> For example, the polarization status of the backscattered light can be measured to characterize the superficial layer of skin for cancer diagnostic purposes.<xref rid="r5" ref-type="bibr"><sup>5</sup></xref><sup>,</sup><xref rid="r6" ref-type="bibr"><sup>6</sup></xref> The measurements of tissue birefringence permit quantification of abnormalities of the retinal nerve fiber layer<xref rid="r7" ref-type="bibr"><sup>7</sup></xref> and cornea,<xref rid="r8" ref-type="bibr"><sup>8</sup></xref> as well as three-dimensional (3D) reconstruction of nerve fiber orientations inside human brains<xref rid="r9" ref-type="bibr"><sup>9</sup></xref> and orientations of collagen within the uterine cervix.<xref rid="r10" ref-type="bibr"><sup>10</sup></xref> By measuring the unequal absorption of left-handed and right-handed circularly polarized light, circular dichroism can rapidly determine the folding properties of proteins.<xref rid="r11" ref-type="bibr"><sup>11</sup></xref> Quantification of collagen and birefringent media alignment can improve evaluation of a therapeutic strategy and its outcome in scar management.<xref rid="r12" ref-type="bibr"><sup>12</sup></xref> Polarized light imaging (PLI) uses linearly co-polarized images subtracted by those of cross-polarized light to create a differential image based on the small population of superficially scattered photons that still retain much of the incident polarization state.<xref rid="r5" ref-type="bibr"><sup>5</sup></xref> PLI subtracts the large randomized population of multiple-scattered photons that produce a blinding background of diffuse light. The resulting difference image enhances the contrast of superficial tissue layers and rejects deeper tissue structures, enabling wide-field screening of epidermal or epithelial layers. Mueller matrix polarimetry and the use of various decomposition methods can also be used to pinpoint different regions and structures within biological tissue.<xref rid="r2" ref-type="bibr"><sup>2</sup></xref><sup>,</sup><xref rid="r3" ref-type="bibr"><sup>3</sup></xref> Accurately simulating polarized light transport inside complex tissues allow quantitative investigations of the depth response of polarized light and the perturbations produced by local tissue abnormalities.</p>
    <p>The propagation of polarized light inside scattering media can be described by the vector radiative transfer equation (VRTE).<xref rid="r13" ref-type="bibr"><sup>13</sup></xref> Analytically solving the VRTE is not viable in complex media such as human tissues. Owing to its high flexibility and simplicity in programming, the Monte Carlo (MC) method, among other numerical techniques,<xref rid="r14" ref-type="bibr"><sup>14</sup></xref><named-content content-type="online"><xref rid="r15" ref-type="bibr"/><xref rid="r16" ref-type="bibr"/><xref rid="r17" ref-type="bibr"/><xref rid="r18" ref-type="bibr"/></named-content><named-content content-type="print"><sup>–</sup></named-content><xref rid="r19" ref-type="bibr"><sup>19</sup></xref> has been one of the limited approaches available to quantitatively model interactions of polarized light with scattering media. Depending on the vectorial representations of polarization states, polarized light MC algorithms can be largely categorized into two formalisms—Jones calculus and Mueller calculus.<xref rid="r2" ref-type="bibr"><sup>2</sup></xref><sup>,</sup><xref rid="r4" ref-type="bibr"><sup>4</sup></xref><sup>,</sup><xref rid="r20" ref-type="bibr"><sup>20</sup></xref> The Jones calculus used in the electric-field MC (EMC) algorithm traces the amplitudes and phases of two orthogonal electric-field components (Jones vector) and is therefore well suited for simulating light coherence effects.<xref rid="r21" ref-type="bibr"><sup>21</sup></xref> On the other hand, the Mueller calculus describes the state of polarization using the Stokes vector.<xref rid="r22" ref-type="bibr"><sup>22</sup></xref><named-content content-type="online"><xref rid="r23" ref-type="bibr"/><xref rid="r24" ref-type="bibr"/><xref rid="r25" ref-type="bibr"/></named-content><named-content content-type="print"><sup>–</sup></named-content><xref rid="r26" ref-type="bibr"><sup>26</sup></xref> The Stokes vector does not contain the absolute phase of the electrical field but allows to model unpolarized, partially polarized and fully polarized light. It can be obtained by measuring four intensity values. Similarly, Mueller matrices can be obtained through 16 intensity measurements and using Mueller matrix decomposition, quantities, such as tissue retardation, depolarization and de-attenuation can be obtained.<xref rid="r4" ref-type="bibr"><sup>4</sup></xref></p>
    <p>A well-known limitation of MC methods is the long computation time. Due to the rapid emergence of massively parallel computing techniques, benefit largely from the fast advances in many core processors such as graphics processing units (GPUs), MC simulations of polarized light have seen significant speed improvement over the past decade. Several groups have reported parallel EMC implementations.<xref rid="r27" ref-type="bibr"><sup>27</sup></xref><named-content content-type="online"><xref rid="r28" ref-type="bibr"/></named-content><named-content content-type="print"><sup>–</sup></named-content><xref rid="r29" ref-type="bibr"><sup>29</sup></xref> Wang et al.<xref rid="r27" ref-type="bibr"><sup>27</sup></xref> presented a compute unified device architecture (CUDA)<xref rid="r30" ref-type="bibr"><sup>30</sup></xref>-based EMC to model coherent light in a single homogeneous slab and achieved over <inline-formula><mml:math id="math1" display="inline" overflow="scroll"><mml:mrow><mml:mn>370</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math></inline-formula> speedup compared to the central processing unit (CPU) counterpart.<xref rid="r21" ref-type="bibr"><sup>21</sup></xref> Ding et al.<xref rid="r29" ref-type="bibr"><sup>29</sup></xref> extended the GPU-based EMC algorithm to consider multi-layered media at the expense of reduced speedup (<inline-formula><mml:math id="math2" display="inline" overflow="scroll"><mml:mrow><mml:mo form="prefix">∼</mml:mo><mml:mn>45</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math></inline-formula>). In addition, Li et al.<xref rid="r31" ref-type="bibr"><sup>31</sup></xref> presented a CUDA-based polarized light MC algorithm to model interstitial media embedded with spherical and cylindrical scatterers. It employed a single-kernel scheme and was hundreds of times faster than its CPU version.<xref rid="r26" ref-type="bibr"><sup>26</sup></xref> In 2019, Oulhaj et al.<xref rid="r32" ref-type="bibr"><sup>32</sup></xref> reported a GPU-accelerated MC algorithm to efficiently compute the sensitivity profile for polarized light inside homogeneous media. The reported GPU implementation was verified against a widely used CPU-based code developed by Ramella-Roman et al.<xref rid="r24" ref-type="bibr"><sup>24</sup></xref> and reported over <inline-formula><mml:math id="math3" display="inline" overflow="scroll"><mml:mrow><mml:mn>150</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math></inline-formula> speedup.</p>
    <p>Although these studies have demonstrated significantly improved simulation speed, most of these simulators only support layered domains and can not address the needs in modeling increasingly complex media.<xref rid="r4" ref-type="bibr"><sup>4</sup></xref> In the simulation of biological tissues with irregular-shaped structures, employing simplifications in domain geometries could introduce significant errors. For example, in the MC modeling of human brains, noticeable differences have been observed between layered-slab models and more anatomically realistic models such as voxel-based and mesh-based brain models.<xref rid="r33" ref-type="bibr"><sup>33</sup></xref></p>
    <p>In this work, we present an open-source and GPU-accelerated MC simulator to model polarized light inside 3D heterogeneous media. This MC algorithm utilizes a 3D voxelated grid to represent spatially varying distributions of spherical scatterers, characterized by their radii and densities. We use Muller calculus to update the Stokes vectors of simulated photon packets, from which we can compute various polarimetry related measurements along the surface of the domain. In the remainder of this paper, we first briefly review the steps of the meridian-plane MC algorithm.<xref rid="r24" ref-type="bibr"><sup>24</sup></xref> Then we detail our GPU-implementation of this algorithm, as part of our enhanced open-source MC software—Monte Carlo eXtreme (MCX),<xref rid="r34" ref-type="bibr"><sup>34</sup></xref> including the preprocessing steps to encode the distribution of particles into a 3D array data structure and optimization strategies to better use GPU resources. In Sec. <xref rid="sec3" ref-type="sec">3</xref>, we validate the proposed GPU-based polarization-enabled MCX (pMCX) against the widely used CPU MC simulator “meridianMC” written by Ramella-Roman et al.<xref rid="r35" ref-type="bibr"><sup>35</sup></xref> and quantify the speed improvement using several benchmarks of homogeneous and heterogeneous domains. Finally, we summarize the key findings and discuss future directions.</p>
  </sec>
  <sec id="sec2">
    <label>2</label>
    <title>Methods</title>
    <sec id="sec2.1">
      <label>2.1</label>
      <title>Meridian-Plane Polarized Light MC</title>
      <p>The meridian-plane polarized light MC algorithm<xref rid="r35" ref-type="bibr"><sup>35</sup></xref> largely follows the standard MC photon transport simulation steps,<xref rid="r36" ref-type="bibr"><sup>36</sup></xref> including “launch,” “move,” “absorb,” “scatter,” and “detection.” At the “launch” stage, the initial weight, position, and direction vector are defined for each photon packet depending on the profile of the incident beam. To describe the polarization state, the Stokes vector is defined with respect to the initial meridian plane for every simulated photon packet.<xref rid="r24" ref-type="bibr"><sup>24</sup></xref> The meridian plane is defined by the plane spanned by the photon propagation direction and the <inline-formula><mml:math id="math4" display="inline" overflow="scroll"><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:math></inline-formula> axis, as shown in Fig. 2 in Ref. <xref rid="r24" ref-type="bibr">24</xref>. The Stokes vector <inline-formula><mml:math id="math5" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">→</mml:mo></mml:mrow></mml:mover></mml:mrow></mml:math></inline-formula> consists of four quantities [<inline-formula><mml:math id="math6" display="inline" overflow="scroll"><mml:mrow><mml:mi>I</mml:mi><mml:mo>,</mml:mo><mml:mi>Q</mml:mi><mml:mo>,</mml:mo><mml:mi>U</mml:mi><mml:mo>,</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:math></inline-formula>], where <inline-formula><mml:math id="math7" display="inline" overflow="scroll"><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="math8" display="inline" overflow="scroll"><mml:mrow><mml:mi>I</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) describes the total light intensity, <inline-formula><mml:math id="math9" display="inline" overflow="scroll"><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="math10" display="inline" overflow="scroll"><mml:mrow><mml:mo form="prefix">−</mml:mo><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>Q</mml:mi><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>) controls the mixing between horizontally (<inline-formula><mml:math id="math11" display="inline" overflow="scroll"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>) and vertically (<inline-formula><mml:math id="math12" display="inline" overflow="scroll"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>) linearly polarized light, <inline-formula><mml:math id="math13" display="inline" overflow="scroll"><mml:mrow><mml:mi>U</mml:mi></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="math14" display="inline" overflow="scroll"><mml:mrow><mml:mo form="prefix">−</mml:mo><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>U</mml:mi><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>) controls the mixing between <inline-formula><mml:math id="math15" display="inline" overflow="scroll"><mml:mrow><mml:mo form="prefix">+</mml:mo><mml:mn>45</mml:mn><mml:mtext>  </mml:mtext><mml:mi>deg</mml:mi></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="math16" display="inline" overflow="scroll"><mml:mrow><mml:mi>U</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>) and <inline-formula><mml:math id="math17" display="inline" overflow="scroll"><mml:mrow><mml:mo form="prefix">−</mml:mo><mml:mn>45</mml:mn><mml:mo> </mml:mo><mml:mi>deg</mml:mi></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="math18" display="inline" overflow="scroll"><mml:mrow><mml:mi>U</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>) linearly polarized light, and <inline-formula><mml:math id="math19" display="inline" overflow="scroll"><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="math20" display="inline" overflow="scroll"><mml:mrow><mml:mo form="prefix">−</mml:mo><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>V</mml:mi><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>) controls the mixing between right (<inline-formula><mml:math id="math21" display="inline" overflow="scroll"><mml:mrow><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>) and left (<inline-formula><mml:math id="math22" display="inline" overflow="scroll"><mml:mrow><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>) circularly polarized light.<xref rid="r1" ref-type="bibr"><sup>1</sup></xref></p>
      <p>After the “launch” step, the photon packet starts propagating inside the simulation domain. In lossy media, the packet weight is monotonically reduced along the photon’s paths and the weight loss is accumulated into the local grid element (such as a voxel or tetrahedral element<xref rid="r37" ref-type="bibr"><sup>37</sup></xref>). When arriving at an interaction site, the photon packet changes direction due to scattering. To compute the new direction cosines, the scattering zenith angle <inline-formula><mml:math id="math23" display="inline" overflow="scroll"><mml:mrow><mml:mi>θ</mml:mi><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi>θ</mml:mi><mml:mo>≤</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and azimuth angle <inline-formula><mml:math id="math24" display="inline" overflow="scroll"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo> </mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> are statistically sampled. Compared to the standard MC, the scattering step in a polarized light simulation requires additional computation to properly update <inline-formula><mml:math id="math25" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">→</mml:mo></mml:mrow></mml:mover></mml:mrow></mml:math></inline-formula>. First, the probability density function (also known as the scattering phase function) of polarized light has a bivariate dependence on both <inline-formula><mml:math id="math26" display="inline" overflow="scroll"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="math27" display="inline" overflow="scroll"><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow></mml:math></inline-formula>. For incident light with a Stokes vector <inline-formula><mml:math id="math28" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">→</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>, the phase function <inline-formula><mml:math id="math29" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula><xref rid="r24" ref-type="bibr"><sup>24</sup></xref> is <disp-formula id="e001"><mml:math id="math30" display="block" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mi>cos</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mi>sin</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math><label>(1)</label></disp-formula>where <inline-formula><mml:math id="math31" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="math32" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>12</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> are elements from the scattering matrix <inline-formula><mml:math id="math33" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> from a homogeneous spherical particle, computed via the Mie theory<xref rid="r38" ref-type="bibr"><sup>38</sup></xref>
<disp-formula id="e002"><mml:math id="math34" display="block" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo minsize="13ex">[</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>33</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>34</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>34</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>33</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable><mml:mo minsize="13ex">]</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math><label>(2)</label></disp-formula></p>
      <p>A rejection method<xref rid="r24" ref-type="bibr"><sup>24</sup></xref> is employed to select both angles <inline-formula><mml:math id="math35" display="inline" overflow="scroll"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="math36" display="inline" overflow="scroll"><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow></mml:math></inline-formula>. Once <inline-formula><mml:math id="math37" display="inline" overflow="scroll"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="math38" display="inline" overflow="scroll"><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow></mml:math></inline-formula> are determined, the Stokes vector must be rotated relative to the new meridian plane using <inline-formula><mml:math id="math39" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> to update the polarization states.</p>
      <p>To efficiently perform the rejection method and Stokes vector rotation, the elements of the scattering matrix <inline-formula><mml:math id="math40" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> of all user-specified spherical scatter species are pre-computed over a discreteized set of <inline-formula><mml:math id="math41" display="inline" overflow="scroll"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:math></inline-formula>. A photon packet is terminated when it escapes from the simulation domain or, if enabled, fails to survive a Russian roulette.<xref rid="r36" ref-type="bibr"><sup>36</sup></xref> It is noteworthy that the original meridian-plane polarized light MC assumes refractive-index matched domain boundaries.<xref rid="r24" ref-type="bibr"><sup>24</sup></xref> The Stokes vector of the escaping photon is rotated relative to the meridian plane of the detector placed immediately outside the domain boundaries, before being accumulated to generate desired output quantities. A detailed description of the formulas used in the meridian plane MC algorithm can be found in the literature.<xref rid="r24" ref-type="bibr"><sup>24</sup></xref></p>
    </sec>
    <sec id="sec2.2">
      <label>2.2</label>
      <title>Implementing Meridian Plane MC in MCX</title>
      <p>The original CPU-based meridian-plane MC program,<xref rid="r35" ref-type="bibr"><sup>35</sup></xref> referred to as “mcMeridian” (stok1.c) hereinafter, is dedicated to modeling homogeneous infinite slab geometries. In contrast, the CUDA-based MCX is capable of modeling arbitrarily heterogeneous media represented by a 3D voxelated domain.<xref rid="r34" ref-type="bibr"><sup>34</sup></xref> In a non-polarization MCX simulation, the domain is represented by a 3D integer array with each number representing the index or label of the tissue at each voxel. The actual optical properties of the tissue label are stored in a look-up table, with four element per tissue type: absorption coefficient <inline-formula><mml:math id="math42" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (1/mm), scattering coefficient <inline-formula><mml:math id="math43" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (1/mm), anisotropy <inline-formula><mml:math id="math44" display="inline" overflow="scroll"><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:math></inline-formula>, and refractive index <inline-formula><mml:math id="math45" display="inline" overflow="scroll"><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula>. To simulate polarized light, the scattering properties of each type of scatterer must be included in addition. To simply the computation, here we only consider spherical scatterers. The radius <inline-formula><mml:math id="math46" display="inline" overflow="scroll"><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="math47" display="inline" overflow="scroll"><mml:mrow><mml:mo> </mml:mo><mml:mi>μ</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:math></inline-formula>), refractive index <inline-formula><mml:math id="math48" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>sph</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, and volumetric number density <inline-formula><mml:math id="math49" display="inline" overflow="scroll"><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="math50" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mo> </mml:mo><mml:mi>μ</mml:mi><mml:msup><mml:mi mathvariant="normal">m</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>) of the spherical particle scatters can be specified for each tissue type. When spherical particle properties are specified, the corresponding <inline-formula><mml:math id="math51" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="math52" display="inline" overflow="scroll"><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:math></inline-formula>, and elements of the scattering matrix <inline-formula><mml:math id="math53" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> are pre-computed using the Mie theory<xref rid="r39" ref-type="bibr"><sup>39</sup></xref> on the host (i.e., CPU). As shown in Eq. (2), the scattering matrix of homogeneous spherical scatterers consists of four independent floating-point numbers <inline-formula><mml:math id="math54" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>12</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>33</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="math55" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>34</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. In our implementation, the scattering parameters are sampled at 1000 evenly spaced points between 0 and <inline-formula><mml:math id="math56" display="inline" overflow="scroll"><mml:mrow><mml:mi>π</mml:mi></mml:mrow></mml:math></inline-formula>, as done in mcMeridian.<xref rid="r35" ref-type="bibr"><sup>35</sup></xref> The pre-computed optical properties and scattering matrix data are then transferred to the device (i.e., GPU), as shown in <xref rid="f1" ref-type="fig">Fig. 1</xref>.</p>
      <fig position="float" id="f1">
        <label>Fig. 1</label>
        <caption>
          <p>Media representation and media data preprocessing in a polarization-enabled Monte Carlo simulation.</p>
        </caption>
        <graphic xlink:href="JBO-027-083015-g001" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec id="sec3">
    <label>3</label>
    <title>Results and Discussions</title>
    <p>In this section, we first validate the aforementioned pMCX in a homogeneous slab using the single-threaded CPU-based implementation (mcMeridian<xref rid="r24" ref-type="bibr"><sup>24</sup></xref>) as a reference, which has been extensively used by the community and validated by experimental studies.<xref rid="r25" ref-type="bibr"><sup>25</sup></xref> The speed improvement is also quantified. It is noteworthy that mcMeridian<xref rid="r35" ref-type="bibr"><sup>35</sup></xref> simulates an infinite slab media geometry in the <inline-formula><mml:math id="math57" display="inline" overflow="scroll"><mml:mrow><mml:mi>x</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:math></inline-formula> directions, whereas in an MCX simulation, a photon is confined inside a bounding box with user-specified dimensions.<xref rid="r34" ref-type="bibr"><sup>34</sup></xref> To ensure that our speed comparison is valid, we modified the source code of mcMeridian and added an implicit bounding box to match the dimension settings in pMCX. In the first benchmark, the simulation domain is a <inline-formula><mml:math id="math58" display="inline" overflow="scroll"><mml:mrow><mml:mn>20</mml:mn><mml:mo>×</mml:mo><mml:mn>20</mml:mn><mml:mo>×</mml:mo><mml:mn>10</mml:mn><mml:mtext>  </mml:mtext><mml:msup><mml:mrow><mml:mi>mm</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> homogeneous slab, the Mie scattering parameters of the embedded spherical scatterer are <inline-formula><mml:math id="math59" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mtext>  </mml:mtext><mml:msup><mml:mrow><mml:mi>mm</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="math60" display="inline" overflow="scroll"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1.015</mml:mn><mml:mtext>  </mml:mtext><mml:mi>μ</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="math61" display="inline" overflow="scroll"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>1.152</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mtext>  </mml:mtext><mml:mi>μ</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="math62" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>sph</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1.59</mml:mn></mml:mrow></mml:math></inline-formula>. The refractive index of the background medium is <inline-formula><mml:math id="math63" display="inline" overflow="scroll"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1.33</mml:mn></mml:mrow></mml:math></inline-formula>. A monochromatic pencil beam source is positioned at the bottom center <inline-formula><mml:math id="math64" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>10,10</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mtext>  </mml:mtext><mml:mi>mm</mml:mi></mml:mrow></mml:math></inline-formula> of the domain, pointing toward the <inline-formula><mml:math id="math65" display="inline" overflow="scroll"><mml:mrow><mml:mo>+</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:math></inline-formula> axis and emitting horizontally polarized light at wavelength <inline-formula><mml:math id="math66" display="inline" overflow="scroll"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>632.8</mml:mn></mml:mrow></mml:math></inline-formula> nm. The initial Stokes vector of the incident beam is <inline-formula><mml:math id="math67" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">→</mml:mo></mml:mrow></mml:mover><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>1,1</mml:mn><mml:mo>,</mml:mo><mml:mn>0,0</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. The backscattered photons are collected by a square-shaped area detector (<inline-formula><mml:math id="math68" display="inline" overflow="scroll"><mml:mrow><mml:mn>20</mml:mn><mml:mo>×</mml:mo><mml:mn>20</mml:mn><mml:mtext>  </mml:mtext><mml:msup><mml:mrow><mml:mi>mm</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>) placed on the boundary at <inline-formula><mml:math id="math69" display="inline" overflow="scroll"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mtext>  </mml:mtext><mml:mi>mm</mml:mi></mml:mrow></mml:math></inline-formula>. In this benchmark, <inline-formula><mml:math id="math70" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mn>8</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> photon packets are simulated on a desktop running Ubuntu 18.04 with an Intel i7-6700K CPU and an NVIDIA RTX 2080 GPU.</p>
    <p>In <xref rid="f2" ref-type="fig">Fig. 2</xref>, we compare the distribution of backscattered [<inline-formula><mml:math id="math71" display="inline" overflow="scroll"><mml:mrow><mml:mi>I</mml:mi><mml:mo>,</mml:mo><mml:mi>Q</mml:mi><mml:mo>,</mml:mo><mml:mi>U</mml:mi><mml:mo>,</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:math></inline-formula>] components using contour plots in MATLAB (MathWorks, Inc., Natick, Massachusetts, United States) and observed excellent agreement between mcMeridian and pMCX solutions. For further quantitative analysis, the root-mean-square errors of <inline-formula><mml:math id="math72" display="inline" overflow="scroll"><mml:mrow><mml:mi>I</mml:mi><mml:mo>,</mml:mo><mml:mi>Q</mml:mi><mml:mo>,</mml:mo><mml:mi>U</mml:mi><mml:mo>,</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:math></inline-formula> (in <inline-formula><mml:math id="math73" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>log</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> scale) between mcMeridian and pMCX are computed on the matching detector area (<inline-formula><mml:math id="math74" display="inline" overflow="scroll"><mml:mrow><mml:mn>20</mml:mn><mml:mo>×</mml:mo><mml:mn>20</mml:mn><mml:mo> </mml:mo><mml:msup><mml:mi>mm</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>), reporting 0.0076, 0.0881, 0.1015, and 0.0938, respectively. We measure the total runtimes, including input data preprocessing, photon transport simulation, and output image generation, with mcMeridian reporting 18111.44 s using the Intel CPU and pMCX reporting 19.45 s on the NVIDIA RTX 2080 GPU, suggesting a <inline-formula><mml:math id="math75" display="inline" overflow="scroll"><mml:mrow><mml:mn>931</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math></inline-formula> speedup. In addition, we also benchmark simulation speeds when storing the scattering matrix data over different GPU memory locations, including global, shared, and constant memories.<xref rid="r30" ref-type="bibr"><sup>30</sup></xref> The global memory implementation reports the fastest speed at 8401 photons/ms, followed by the shared memory (4965 photons/ms) and constant memory (2182 photons/ms) implementations. Although the shared memory is known to be the fastest among the three memory types, its has a very small size, up to 48 KB per block.<xref rid="r30" ref-type="bibr"><sup>30</sup></xref> For storing the scattering matrix of a single species of scatterer at 1000 angular steps, a total of 16 KB memory is needed. Allocating a large amount of shared memory can lead to drastically reduced active block number, which explains the lower speed compared to the global memory case. On the other hand, constant memory also has a small size (64 KB).<xref rid="r30" ref-type="bibr"><sup>30</sup></xref> It is most efficient when a memory value is being reused many times after a single read. However, the use of the rejection method requires random access to the buffer which fails to be accelerated by the constant memory due to high “cache-miss.”<xref rid="r30" ref-type="bibr"><sup>30</sup></xref></p>
    <fig position="float" id="f2">
      <label>Fig. 2</label>
      <caption>
        <p>Contour plots of the absolute backscattered (a) <inline-formula><mml:math id="math76" display="inline" overflow="scroll"><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula>, (b) <inline-formula><mml:math id="math77" display="inline" overflow="scroll"><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:math></inline-formula>, (c) <inline-formula><mml:math id="math78" display="inline" overflow="scroll"><mml:mrow><mml:mi>U</mml:mi></mml:mrow></mml:math></inline-formula> and (d) <inline-formula><mml:math id="math79" display="inline" overflow="scroll"><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:math></inline-formula> (in <inline-formula><mml:math id="math80" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>log</mml:mi></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> scale) generated by mcMeridian (black solid lines) and pMCX (white dashed lines).</p>
      </caption>
      <graphic xlink:href="JBO-027-083015-g002" position="float"/>
    </fig>
    <p>In the next benchmark, we further validate our pMCX simulator by comparing with an extended mcMeridian (with added support of layered media) in a two-layer domain. The slab-shaped simulation domain has a size of <inline-formula><mml:math id="math81" display="inline" overflow="scroll"><mml:mrow><mml:mn>100</mml:mn><mml:mo>×</mml:mo><mml:mn>100</mml:mn><mml:mo>×</mml:mo><mml:mn>50</mml:mn><mml:mtext>  </mml:mtext><mml:msup><mml:mrow><mml:mi>mm</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> with the thickness of the superficial layer, <inline-formula><mml:math id="math82" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, ranging between 0 and 10 mm. The Mie scattering parameters are <inline-formula><mml:math id="math83" display="inline" overflow="scroll"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>632.8</mml:mn><mml:mtext>  </mml:mtext><mml:mi>nm</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="math84" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn><mml:mtext>  </mml:mtext><mml:msup><mml:mrow><mml:mi>mm</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, sphere radius <inline-formula><mml:math id="math85" display="inline" overflow="scroll"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn><mml:mtext>  </mml:mtext><mml:mi>μ</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:math></inline-formula>, number density <inline-formula><mml:math id="math86" display="inline" overflow="scroll"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>19.11</mml:mn><mml:mtext>  </mml:mtext><mml:mi>μ</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="math87" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>sph</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1.59</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="math88" display="inline" overflow="scroll"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1.33</mml:mn></mml:mrow></mml:math></inline-formula> for the superficial layer. The bottom layer has <inline-formula><mml:math id="math89" display="inline" overflow="scroll"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn><mml:mtext>  </mml:mtext><mml:mi>μ</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="math90" display="inline" overflow="scroll"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>2.198</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mtext>  </mml:mtext><mml:mi>μ</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, and the other parameters are the same as the superficial layer. These choices of <inline-formula><mml:math id="math91" display="inline" overflow="scroll"><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="math92" display="inline" overflow="scroll"><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow></mml:math></inline-formula> yield a reduced scattering coefficient <inline-formula><mml:math id="math93" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mtext>  </mml:mtext><mml:msup><mml:mrow><mml:mi>mm</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> for both layers, along with the same absorption <inline-formula><mml:math id="math94" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and hence approximately the same reflected intensity <inline-formula><mml:math id="math95" display="inline" overflow="scroll"><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula> for all <inline-formula><mml:math id="math96" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. A pencil beam is located on the surface of the slab at <inline-formula><mml:math id="math97" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>50,50</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mtext>  </mml:mtext><mml:mi>mm</mml:mi></mml:mrow></mml:math></inline-formula>, pointing toward the <inline-formula><mml:math id="math98" display="inline" overflow="scroll"><mml:mrow><mml:mo>+</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:math></inline-formula> axis and emitting horizontally polarized light, with the initial Stokes vector <inline-formula><mml:math id="math99" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">→</mml:mo></mml:mrow></mml:mover><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>1,1</mml:mn><mml:mo>,</mml:mo><mml:mn>0,0</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. A total of <inline-formula><mml:math id="math100" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> photon packets are simulated for both mcMeridian and pMCX.</p>
    <p>In <xref rid="f3" ref-type="fig">Fig. 3</xref>, we plot the total reflected <inline-formula><mml:math id="math101" display="inline" overflow="scroll"><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="math102" display="inline" overflow="scroll"><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:math></inline-formula> components as a function of the superficial layer thickness <inline-formula><mml:math id="math103" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. We do not include total <inline-formula><mml:math id="math104" display="inline" overflow="scroll"><mml:mrow><mml:mi>U</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="math105" display="inline" overflow="scroll"><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:math></inline-formula> plots because they are nearly zeros across all <inline-formula><mml:math id="math106" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> values, this is expected as <inline-formula><mml:math id="math107" display="inline" overflow="scroll"><mml:mrow><mml:mi>U</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="math108" display="inline" overflow="scroll"><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:math></inline-formula> distributions sum to zeros due to symmetric positive and negative components. The outputs from mcMeridian (black solid lines) and those from pMCX (red circles) once again show excellent agreements. The plot of <inline-formula><mml:math id="math109" display="inline" overflow="scroll"><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:math></inline-formula> increases with the thickness <inline-formula><mml:math id="math110" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> of the superficial layer, which contains smaller spherical scatters and hence stronger back-scattering than the deeper layer. With thickness <inline-formula><mml:math id="math111" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> growing from 0 to 1 cm, the total <inline-formula><mml:math id="math112" display="inline" overflow="scroll"><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula> value shows a minuscule increase by 0.17% (from 0.9080 to 0.9095), as shown in the inset in <xref rid="f3" ref-type="fig">Fig. 3(a)</xref>, as a result of sub-diffusive scattering. The two-phase transition of <inline-formula><mml:math id="math113" display="inline" overflow="scroll"><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:math></inline-formula> matches our expectations: when the superficial layer is very thin, the reflectance values are close to the value as if the domain is entirely filled with the bottom medium (green dashed line); as we increase <inline-formula><mml:math id="math114" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, the reflectance values asymptotically approach those determined by the media in the superficial layer (blue dashed line).</p>
    <fig position="float" id="f3">
      <label>Fig. 3</label>
      <caption>
        <p>Validation of pMCX in a two-layer domain. We plot the backscattered (a) <inline-formula><mml:math id="math115" display="inline" overflow="scroll"><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula> and (b) <inline-formula><mml:math id="math116" display="inline" overflow="scroll"><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:math></inline-formula> components computed by pMCX and mcMeridian as the superficial layer thickness (<inline-formula><mml:math id="math117" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>) increases from 0 to 10 mm. Two dashed lines in (b) indicate back-scattered <inline-formula><mml:math id="math118" display="inline" overflow="scroll"><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:math></inline-formula> values computed from a homogeneous slab filled only with the medium of the bottom layer (green) and that of the superficial layer (blue). The inset in (a) shows a zoom-in view of the <inline-formula><mml:math id="math119" display="inline" overflow="scroll"><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:math></inline-formula> axis of the <inline-formula><mml:math id="math120" display="inline" overflow="scroll"><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula> component obtained by pMCX to demonstrate subtle variations due to sub-diffusive scattering effect.</p>
      </caption>
      <graphic xlink:href="JBO-027-083015-g003" position="float"/>
    </fig>
    <p>Finally, we show simulation of a slab-shaped medium embedded with a spherical inclusion, showcasing pMCX’s capability of modeling heterogeneous domains. In this benchmark (<xref rid="f4" ref-type="fig">Fig. 4</xref>), the simulation domain is a <inline-formula><mml:math id="math121" display="inline" overflow="scroll"><mml:mrow><mml:mn>10</mml:mn><mml:mo>×</mml:mo><mml:mn>10</mml:mn><mml:mo>×</mml:mo><mml:mn>1.2</mml:mn><mml:mtext>  </mml:mtext><mml:msup><mml:mrow><mml:mi>mm</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> slab with a spherical inclusion of radius 0.5 mm centered at <inline-formula><mml:math id="math122" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>6,6</mml:mn><mml:mo>,</mml:mo><mml:mn>0.6</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mtext>  </mml:mtext><mml:mi>mm</mml:mi></mml:mrow></mml:math></inline-formula>. The inclusion and the slab share identical absorption coefficient <inline-formula><mml:math id="math123" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.005</mml:mn><mml:mtext>  </mml:mtext><mml:msup><mml:mrow><mml:mi>mm</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, reduced scattering coefficient <inline-formula><mml:math id="math124" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mtext>  </mml:mtext><mml:msup><mml:mrow><mml:mi>mm</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, and refractive index <inline-formula><mml:math id="math125" display="inline" overflow="scroll"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1.33</mml:mn></mml:mrow></mml:math></inline-formula>. However, the Mie scatters inside both domains are different. The background medium is filled with scatterers of radius <inline-formula><mml:math id="math126" display="inline" overflow="scroll"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn><mml:mtext>  </mml:mtext><mml:mi>μ</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:math></inline-formula> and volume density <inline-formula><mml:math id="math127" display="inline" overflow="scroll"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>19.11</mml:mn><mml:mtext>  </mml:mtext><mml:mi>μ</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>; the inclusion is filled with scatterers of radius <inline-formula><mml:math id="math128" display="inline" overflow="scroll"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mtext>  </mml:mtext><mml:mi>μ</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:math></inline-formula> and volume density <inline-formula><mml:math id="math129" display="inline" overflow="scroll"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>1.11</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mtext>  </mml:mtext><mml:mi>μ</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. The choices of <inline-formula><mml:math id="math130" display="inline" overflow="scroll"><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="math131" display="inline" overflow="scroll"><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow></mml:math></inline-formula> values in either domain was computed based on the Mie theory to ensure their reduced scattering coefficients are the same. All spherical scatterings have a refractive index of, <inline-formula><mml:math id="math132" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>sph</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1.59</mml:mn></mml:mrow></mml:math></inline-formula>. A <inline-formula><mml:math id="math133" display="inline" overflow="scroll"><mml:mrow><mml:mn>10</mml:mn><mml:mo>×</mml:mo><mml:mn>10</mml:mn><mml:mtext>  </mml:mtext><mml:msup><mml:mrow><mml:mi>mm</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> uniform planar light source is placed at the bottom (<inline-formula><mml:math id="math134" display="inline" overflow="scroll"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mtext>  </mml:mtext><mml:mi>mm</mml:mi></mml:mrow></mml:math></inline-formula>) surface, pointing toward the <inline-formula><mml:math id="math135" display="inline" overflow="scroll"><mml:mrow><mml:mo>+</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:math></inline-formula> axis and emitting horizontally polarized light with the wavelength <inline-formula><mml:math id="math136" display="inline" overflow="scroll"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>632.8</mml:mn></mml:mrow></mml:math></inline-formula> nm. A cyclic boundary condition is applied to the four bounding box facets at <inline-formula><mml:math id="math137" display="inline" overflow="scroll"><mml:mrow><mml:mo>±</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mo>±</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:math></inline-formula> directions to approximate an infinite slab and infinite-plane source. The incident Stokes vector is <inline-formula><mml:math id="math138" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">→</mml:mo></mml:mrow></mml:mover><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>1,1</mml:mn><mml:mo>,</mml:mo><mml:mn>0,0</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. A total of <inline-formula><mml:math id="math139" display="inline" overflow="scroll"><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mn>8</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> photons are simulated on an NVIDIA RTX 2080 GPU. We compare the distributions of backscattered <inline-formula><mml:math id="math140" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>I</mml:mi><mml:mo>,</mml:mo><mml:mi>Q</mml:mi><mml:mo>,</mml:mo><mml:mi>U</mml:mi><mml:mo>,</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> at <inline-formula><mml:math id="math141" display="inline" overflow="scroll"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo> </mml:mo><mml:mi>mm</mml:mi></mml:mrow></mml:math></inline-formula>, as shown in <xref rid="f4" ref-type="fig">Fig. 4</xref>. Because the inclusion and background slab share the same <inline-formula><mml:math id="math142" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="math143" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>s</mml:mi><mml:mo>'</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="math144" display="inline" overflow="scroll"><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula>, a regular diffuse optics forward model without polarization capability would generate no contrast to the inclusion. However, our pMCX simulation has revealed distinct image contrasts in <inline-formula><mml:math id="math145" display="inline" overflow="scroll"><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="math146" display="inline" overflow="scroll"><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="math147" display="inline" overflow="scroll"><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:math></inline-formula> images at the correct inclusion locations, suggesting the potential to detect tissue microstructure differences using polarized light. It is noteworthy that the noise level in each of the images is partially related to the anisotropy <inline-formula><mml:math id="math148" display="inline" overflow="scroll"><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:math></inline-formula> determined based on the background scatterer parameters—a larger spherical radius results in a higher <inline-formula><mml:math id="math149" display="inline" overflow="scroll"><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:math></inline-formula> value and less back-scattered photons. The significantly higher amplitude of inclusion contrast in <inline-formula><mml:math id="math150" display="inline" overflow="scroll"><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:math></inline-formula> image compared to that in <inline-formula><mml:math id="math151" display="inline" overflow="scroll"><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula> further demonstrates the advantages of using polarized imaging in detecting scattering differences compared to traditional diffuse optics where only <inline-formula><mml:math id="math152" display="inline" overflow="scroll"><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula> is typically measured.</p>
    <fig position="float" id="f4">
      <label>Fig. 4</label>
      <caption>
        <p>Distributions of (a) <inline-formula><mml:math id="math153" display="inline" overflow="scroll"><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula>, (b) <inline-formula><mml:math id="math154" display="inline" overflow="scroll"><mml:mrow><mml:mi>Q</mml:mi></mml:mrow></mml:math></inline-formula>, (c) <inline-formula><mml:math id="math155" display="inline" overflow="scroll"><mml:mrow><mml:mi>U</mml:mi></mml:mrow></mml:math></inline-formula> and (d) <inline-formula><mml:math id="math156" display="inline" overflow="scroll"><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:math></inline-formula> backscattered from a <inline-formula><mml:math id="math157" display="inline" overflow="scroll"><mml:mrow><mml:mn>10</mml:mn><mml:mo>×</mml:mo><mml:mn>10</mml:mn><mml:mo>×</mml:mo><mml:mn>1.2</mml:mn><mml:mtext>  </mml:mtext><mml:msup><mml:mrow><mml:mi>mm</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> slab. A spherical inclusion of radius 0.5 mm is centered at (6,6,0.6) mm.</p>
      </caption>
      <graphic xlink:href="JBO-027-083015-g004" position="float"/>
    </fig>
  </sec>
  <sec id="sec4">
    <label>4</label>
    <title>Conclusion</title>
    <p>In summary, we report a massively parallel implementation of polarized MC algorithm in our MCX simulator for modeling the propagation of polarized light inside complex media filled with spherical scatterers. Enabled by its built-in voxel-based geometric representation, the pMCX can handle arbitrarily heterogeneous media. We have described the preprocessing steps to encode the scattering properties of spherical particles with various radii and volume densities into a 3D voxel-based data structure. We provide validation and speed benchmarks ranging from simple homogeneous to complex heterogeneous domains. In all benchmarks, our pMCX solver reports excellent match with the widely used reference solver mcMeridian, while providing a speedup nearly three orders of magnitude. In addition, we observed different GPU memory utilization efficiency among global, constant, and shared memories, with the global memory implementation yielding the highest speed and least restriction. It is noteworthy that a limitation in both mcMeridian and pMCX simulations is that all media boundaries are assumed to have matched refractive indices. We plan to further extend this work to update the Stokes vector across mismatched boundaries.</p>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>This research is supported by the National Institutes of Health (Grant Nos. R01-GM114365, R01-CA204443, and R01-EB026998); by STROBE, a National Science Foundation Science &amp; Technology Center (DMR 1548924); and by the National Science Foundation Engineering Research Center for Precise Advanced Technologies and Health Systems for Underserved Populations (PATHS-UP) (Grant No. 1648451).</p>
  </ack>
  <bio id="b1">
    <p><bold>Shijie Yan</bold> is a PhD student in electrical engineering at Northeastern University. He received his BE degree in information science and engineering from Southeast University, China, in 2013, and his MS degree in electrical and computer engineering from Northeastern University in 2017. His research interests include Monte Carlo photon transport simulation algorithms, parallel computing, and GPU programming and optimization.</p>
  </bio>
  <bio id="b2">
    <p><bold>Steven L. Jacques</bold> is an affiliate professor of bioengineering at the University of Washington in Seattle, Washington, United States. He received his PhD from the University of California, Berkeley, in 1984, then served as a research associate/instructor at Massachusetts General Hospital/Harvard Medical School, as an associate professor at the University of Texas M.D. Anderson Cancer Center, and as a full professor at Oregon Health &amp; Science University (OHSU). He has worked in the field of biomedical optics and laser–tissue interactions for 36 years.</p>
  </bio>
  <bio id="b3">
    <p><bold>Jessica C. Ramella-Roman</bold> is an associate professor in the Bioengineering Department, Florida International University (FIU) in Miami, Florida, United States. She received her PhD from Oregon Health &amp; Science University (OHSU) in 2004. She was a postdoctoral fellow at Johns Hopkins University Applied Physics Laboratory and became an assistant professor at Catholic University of America in 2005, and an associate in 2012 before joining FIU in 2013. Her research focuses on the development of imaging modalities based on spectroscopy and polarization including multimodal applications of nonlinear microscopy.</p>
  </bio>
  <bio id="b4">
    <p><bold>Qianqian Fang</bold> is an associate professor in the Bioengineering Department, Northeastern University, Boston, Massachusetts, United States. He received his PhD from Thayer School of Engineering, Dartmouth College, in 2005. He then joined Massachusetts General Hospital and became an instructor of radiology in 2009 and assistant professor of radiology in 2012, before he joined Northeastern University in 2015 as an assistant professor. His research interests include translational medical imaging devices, multi-modal imaging, image reconstruction algorithms, and high performance computing tools to facilitate the development of next-generation imaging platforms.</p>
  </bio>
  <notes notes-type="conflict-of-interest">
    <title>Disclosures</title>
    <p>No conflicts of interest, financial or otherwise, are declared by the authors.</p>
  </notes>
  <sec>
    <title>Code, Data, and Materials Availability</title>
    <p>The pMCX algorithm has been incorporated in our widely disseminated MC simulator and is freely available at <ext-link xlink:href="http://mcx.space/" ext-link-type="uri">http://mcx.space/</ext-link>.</p>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="r1">
      <label>1.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Boas</surname><given-names>D. A.</given-names></name><name><surname>Pitris</surname><given-names>C.</given-names></name><name><surname>Ramanujam</surname><given-names>N.</given-names></name></person-group>, <source>Handbook of Biomedical Optics</source>, <publisher-name>CRC Press</publisher-name>, <publisher-loc>Boca Raton, Florida</publisher-loc> (<year>2011</year>).</mixed-citation>
    </ref>
    <ref id="r2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ramella-Roman</surname><given-names>J. C.</given-names></name><name><surname>Saytashev</surname><given-names>I.</given-names></name><name><surname>Piccini</surname><given-names>M.</given-names></name></person-group>, “<article-title>A review of polarization-based imaging technologies for clinical and preclinical applications</article-title>,” <source>J. Opt.</source>
<volume>22</volume>, <fpage>123001</fpage> (<year>2020</year>).<pub-id pub-id-type="doi">10.1088/2040-8986/abbf8a</pub-id></mixed-citation>
    </ref>
    <ref id="r3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tuchin</surname><given-names>V. V.</given-names></name></person-group>, “<article-title>Polarized light interaction with tissues</article-title>,” <source>J. Biomed. Opt.</source>
<volume>21</volume>(<issue>7</issue>), <fpage>071114</fpage> (<year>2016</year>).<pub-id pub-id-type="doi">10.1117/1.JBO.21.7.071114</pub-id></mixed-citation>
    </ref>
    <ref id="r4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>He</surname><given-names>C.</given-names></name><etal>et al.</etal></person-group>, “<article-title>Polarisation optics for biomedical and clinical applications: a review</article-title>,” <source>Light Sci. Appl.</source>
<volume>10</volume>, <fpage>194</fpage> (<year>2021</year>).<pub-id pub-id-type="doi">10.1038/s41377-021-00639-x</pub-id><pub-id pub-id-type="pmid">34552045</pub-id></mixed-citation>
    </ref>
    <ref id="r5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jacques</surname><given-names>S. L.</given-names></name><name><surname>Ramella-Roman</surname><given-names>J. C.</given-names></name><name><surname>Lee</surname><given-names>K.</given-names></name></person-group>, “<article-title>Imaging skin pathology with polarized light</article-title>,” <source>J. Biomed. Opt.</source>
<volume>7</volume>(<issue>3</issue>), <fpage>329</fpage>–<lpage>340</lpage> (<year>2002</year>).<pub-id pub-id-type="doi">10.1117/1.1484498</pub-id><pub-id pub-id-type="pmid">12175282</pub-id></mixed-citation>
    </ref>
    <ref id="r6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>G. L.</given-names></name><name><surname>Li</surname><given-names>Y.</given-names></name><name><surname>Cameron</surname><given-names>B. D.</given-names></name></person-group>, “<article-title>Polarization-based optical imaging and processing techniques with application to the cancer diagnostics</article-title>,” <source>Proc. SPIE</source>
<volume>4617</volume>, <fpage>208</fpage>–<lpage>220</lpage> (<year>2002</year>).<pub-id pub-id-type="coden">PSISDG</pub-id><issn>0277-786X</issn><pub-id pub-id-type="doi">10.1117/12.472527</pub-id></mixed-citation>
    </ref>
    <ref id="r7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zotter</surname><given-names>S.</given-names></name><etal>et al.</etal></person-group>, “<article-title>Measuring retinal nerve fiber layer birefringence, retardation, and thickness using wide-field, high-speed polarization sensitive spectral domain OCT</article-title>,” <source>Invest. Ophthalmol. Visual Sci.</source>
<volume>54</volume>, <fpage>72</fpage>–<lpage>84</lpage> (<year>2013</year>).<pub-id pub-id-type="coden">IOVSDA</pub-id><issn>0146-0404</issn><pub-id pub-id-type="doi">10.1167/iovs.12-10089</pub-id><pub-id pub-id-type="pmid">23221076</pub-id></mixed-citation>
    </ref>
    <ref id="r8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saytashev</surname><given-names>I.</given-names></name><etal>et al.</etal></person-group>, “<article-title>Self validating Mueller matrix micro–mesoscope (SAMMM) for the characterization of biological media</article-title>,” <source>Opt. Lett.</source>
<volume>45</volume>, <fpage>2168</fpage>–<lpage>2171</lpage> (<year>2020</year>).<pub-id pub-id-type="coden">OPLEDP</pub-id><issn>0146-9592</issn><pub-id pub-id-type="doi">10.1364/OL.387747</pub-id><pub-id pub-id-type="pmid">32287183</pub-id></mixed-citation>
    </ref>
    <ref id="r9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wiese</surname><given-names>H.</given-names></name><etal>et al.</etal></person-group>, “<article-title>Polarized light imaging of the human brain: a new approach to the data analysis of tilted sections</article-title>,” <source>Proc. SPIE</source>
<volume>9099</volume>, <fpage>90990U</fpage> (<year>2014</year>).<pub-id pub-id-type="coden">PSISDG</pub-id><issn>0277-786X</issn><pub-id pub-id-type="doi">10.1117/12.2053305</pub-id></mixed-citation>
    </ref>
    <ref id="r10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chue-Sang</surname><given-names>J.</given-names></name><etal>et al.</etal></person-group>, “<article-title>Use of Mueller matrix polarimetry and optical coherence tomography in the characterization of cervical collagen anisotropy</article-title>,” <source>J. Biomed. Opt.</source>
<volume>8</volume>, <fpage>086010</fpage> (<year>2017</year>).<pub-id pub-id-type="doi">10.1117/1.JBO.22.8.086010</pub-id></mixed-citation>
    </ref>
    <ref id="r11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Greenfield</surname><given-names>N. J.</given-names></name></person-group>, “<article-title>Using circular dichroism spectra to estimate protein secondary structure</article-title>,” <source>Nat. Protoc.</source>
<volume>1</volume>(<issue>6</issue>), <fpage>2876</fpage>–<lpage>2890</lpage> (<year>2006</year>).<issn>1754-2189</issn><pub-id pub-id-type="doi">10.1038/nprot.2006.202</pub-id><pub-id pub-id-type="pmid">17406547</pub-id></mixed-citation>
    </ref>
    <ref id="r12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ramella-Roman</surname><given-names>J. C.</given-names></name><etal>et al.</etal></person-group>, “<article-title>Preferential alignment of birefringent tissue measured with polarization sensitive techniques</article-title>,” <source>Proc. SPIE</source>
<volume>9303</volume>, <fpage>93030I</fpage> (<year>2015</year>).<pub-id pub-id-type="coden">PSISDG</pub-id><issn>0277-786X</issn><pub-id pub-id-type="doi">10.1117/12.2081338</pub-id></mixed-citation>
    </ref>
    <ref id="r13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mishchenko</surname><given-names>M. I.</given-names></name></person-group>, “<article-title>Vector radiative transfer equation for arbitrarily shaped and arbitrarily oriented particles: a microphysical derivation from statistical electromagnetics</article-title>,” <source>Appl. Opt.</source>
<volume>41</volume>, <fpage>7114</fpage>–<lpage>7134</lpage> (<year>2002</year>).<pub-id pub-id-type="coden">APOPAI</pub-id><issn>0003-6935</issn><pub-id pub-id-type="doi">10.1364/AO.41.007114</pub-id><pub-id pub-id-type="pmid">12463259</pub-id></mixed-citation>
    </ref>
    <ref id="r14">
      <label>14.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Chandrasekhar</surname><given-names>S.</given-names></name></person-group>, <source>Radiative Transfer</source>, <publisher-name>Dover Publications</publisher-name>, <publisher-loc>New York</publisher-loc> (<year>1960</year>).</mixed-citation>
    </ref>
    <ref id="r15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Evans</surname><given-names>K.</given-names></name><name><surname>Stephens</surname><given-names>G.</given-names></name></person-group>, “<article-title>A new polarized atmospheric radiative transfer model</article-title>,” <source>J. Quant. Spectrosc. Radiat. Transfer</source>
<volume>46</volume>(<issue>5</issue>), <fpage>413</fpage>–<lpage>423</lpage> (<year>1991</year>).<pub-id pub-id-type="coden">JQSRAE</pub-id><issn>0022-4073</issn><pub-id pub-id-type="doi">10.1016/0022-4073(91)90043-P</pub-id></mixed-citation>
    </ref>
    <ref id="r16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Prahl</surname><given-names>S. A.</given-names></name><name><surname>van Gemert</surname><given-names>M. J. C.</given-names></name><name><surname>Welch</surname><given-names>A. J.</given-names></name></person-group>, “<article-title>Determining the optical properties of turbid media by using the adding–doubling method</article-title>,” <source>Appl. Opt.</source>
<volume>32</volume>, <fpage>559</fpage>–<lpage>568</lpage> (<year>1993</year>).<pub-id pub-id-type="coden">APOPAI</pub-id><issn>0003-6935</issn><pub-id pub-id-type="doi">10.1364/AO.32.000559</pub-id><pub-id pub-id-type="pmid">20802725</pub-id></mixed-citation>
    </ref>
    <ref id="r17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>A. D.</given-names></name><name><surname>Ishimaru</surname><given-names>A.</given-names></name></person-group>, “<article-title>A Chebyshev spectral method for radiative transfer equations applied to electromagnetic wave propagation and scattering in a discrete random medium</article-title>,” <source>J. Comput. Phys.</source>
<volume>152</volume>(<issue>1</issue>), <fpage>264</fpage>–<lpage>280</lpage> (<year>1999</year>).<pub-id pub-id-type="coden">JCTPAH</pub-id><issn>0021-9991</issn><pub-id pub-id-type="doi">10.1006/jcph.1999.6247</pub-id></mixed-citation>
    </ref>
    <ref id="r18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Adams</surname><given-names>M. L.</given-names></name><name><surname>Larsen</surname><given-names>E. W.</given-names></name></person-group>, “<article-title>Fast iterative methods for discrete-ordinates particle transport calculations</article-title>,” <source>Prog. Nucl. Energy</source>
<volume>40</volume>(<issue>1</issue>), <fpage>3</fpage>–<lpage>159</lpage> (<year>2002</year>).<pub-id pub-id-type="coden">PNENDE</pub-id><issn>0149-1970</issn><pub-id pub-id-type="doi">10.1016/S0149-1970(01)00023-3</pub-id></mixed-citation>
    </ref>
    <ref id="r19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>A. D.</given-names></name><name><surname>Keller</surname><given-names>J. B.</given-names></name></person-group>, “<article-title>Light propagation in biological tissue</article-title>,” <source>J. Opt. Soc. Am. A</source>
<volume>20</volume>, <fpage>92</fpage>–<lpage>98</lpage> (<year>2003</year>).<pub-id pub-id-type="doi">10.1364/JOSAA.20.000092</pub-id></mixed-citation>
    </ref>
    <ref id="r20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Akarçay</surname><given-names>H. G.</given-names></name><etal>et al.</etal></person-group>, “<article-title>Monte Carlo modeling of polarized light propagation: Stokes vs. Jones. Part I</article-title>,” <source>Appl. Opt.</source>
<volume>53</volume>, <fpage>7576</fpage>–<lpage>7585</lpage> (<year>2014</year>).<pub-id pub-id-type="coden">APOPAI</pub-id><issn>0003-6935</issn><pub-id pub-id-type="doi">10.1364/AO.53.007576</pub-id><pub-id pub-id-type="pmid">25402926</pub-id></mixed-citation>
    </ref>
    <ref id="r21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>M.</given-names></name></person-group>, “<article-title>Electric field Monte Carlo simulation of polarized light propagation in turbid media</article-title>,” <source>Opt. Express</source>
<volume>12</volume>, <fpage>6530</fpage>–<lpage>6539</lpage> (<year>2004</year>).<pub-id pub-id-type="coden">OPEXFF</pub-id><issn>1094-4087</issn><pub-id pub-id-type="doi">10.1364/OPEX.12.006530</pub-id><pub-id pub-id-type="pmid">19488304</pub-id></mixed-citation>
    </ref>
    <ref id="r22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bartel</surname><given-names>S.</given-names></name><name><surname>Hielscher</surname><given-names>A. H.</given-names></name></person-group>, “<article-title>Monte Carlo simulations of the diffuse backscattering Mueller matrix for highly scattering media</article-title>,” <source>Appl. Opt.</source>
<volume>39</volume>, <fpage>1580</fpage>–<lpage>1588</lpage> (<year>2000</year>).<pub-id pub-id-type="coden">APOPAI</pub-id><issn>0003-6935</issn><pub-id pub-id-type="doi">10.1364/AO.39.001580</pub-id><pub-id pub-id-type="pmid">18345055</pub-id></mixed-citation>
    </ref>
    <ref id="r23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Côté</surname><given-names>D.</given-names></name><name><surname>Vitkin</surname><given-names>I. A.</given-names></name></person-group>, “<article-title>Robust concentration determination of optically active molecules in turbid media with validated three-dimensional polarization sensitive Monte Carlo calculations</article-title>,” <source>Opt. Express</source>
<volume>13</volume>, <fpage>148</fpage>–<lpage>163</lpage> (<year>2005</year>).<pub-id pub-id-type="coden">OPEXFF</pub-id><issn>1094-4087</issn><pub-id pub-id-type="doi">10.1364/OPEX.13.000148</pub-id><pub-id pub-id-type="pmid">19488339</pub-id></mixed-citation>
    </ref>
    <ref id="r24">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ramella-Roman</surname><given-names>J. C.</given-names></name><name><surname>Prahl</surname><given-names>S. A.</given-names></name><name><surname>Jacques</surname><given-names>S. L.</given-names></name></person-group>, “<article-title>Three Monte Carlo programs of polarized light transport into scattering media: part I</article-title>,” <source>Opt. Express</source>
<volume>13</volume>, <fpage>4420</fpage>–<lpage>4438</lpage> (<year>2005</year>).<pub-id pub-id-type="coden">OPEXFF</pub-id><issn>1094-4087</issn><pub-id pub-id-type="doi">10.1364/OPEX.13.004420</pub-id><pub-id pub-id-type="pmid">19495358</pub-id></mixed-citation>
    </ref>
    <ref id="r25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ramella-Roman</surname><given-names>J. C.</given-names></name><name><surname>Prahl</surname><given-names>S. A.</given-names></name><name><surname>Jacques</surname><given-names>S. L.</given-names></name></person-group>, “<article-title>Three Monte Carlo programs of polarized light transport into scattering media: part II</article-title>,” <source>Opt. Express</source>
<volume>13</volume>, <fpage>10392</fpage>–<lpage>10405</lpage> (<year>2005</year>).<pub-id pub-id-type="coden">OPEXFF</pub-id><issn>1094-4087</issn><pub-id pub-id-type="doi">10.1364/OPEX.13.010392</pub-id><pub-id pub-id-type="pmid">19503254</pub-id></mixed-citation>
    </ref>
    <ref id="r26">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yun</surname><given-names>T.</given-names></name><etal>et al.</etal></person-group>, “<article-title>Monte Carlo simulation of polarized photon scattering in anisotropic media</article-title>,” <source>Opt. Express</source>
<volume>17</volume>, <fpage>16590</fpage>–<lpage>16602</lpage> (<year>2009</year>).<pub-id pub-id-type="coden">OPEXFF</pub-id><issn>1094-4087</issn><pub-id pub-id-type="doi">10.1364/OE.17.016590</pub-id><pub-id pub-id-type="pmid">19770874</pub-id></mixed-citation>
    </ref>
    <ref id="r27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Y.</given-names></name><etal>et al.</etal></person-group>, “<article-title>GPU accelerated electric field Monte Carlo simulation of light propagation in turbid media using a finite-size beam model</article-title>,” <source>Opt. Express</source>
<volume>20</volume>, <fpage>16618</fpage>–<lpage>16630</lpage> (<year>2012</year>).<pub-id pub-id-type="coden">OPEXFF</pub-id><issn>1094-4087</issn><pub-id pub-id-type="doi">10.1364/OE.20.016618</pub-id></mixed-citation>
    </ref>
    <ref id="r28">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Doronin</surname><given-names>A.</given-names></name><name><surname>Macdonald</surname><given-names>C.</given-names></name><name><surname>Meglinski</surname><given-names>I. V.</given-names></name></person-group>, “<article-title>Propagation of coherent polarized light in turbid highly scattering medium</article-title>,” <source>J. Biomed. Opt.</source>
<volume>19</volume>(<issue>2</issue>), <fpage>025005</fpage> (<year>2014</year>).<pub-id pub-id-type="doi">10.1117/1.JBO.19.2.025005</pub-id><pub-id pub-id-type="pmid">24556700</pub-id></mixed-citation>
    </ref>
    <ref id="r29">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ding</surname><given-names>C.</given-names></name><etal>et al.</etal></person-group>, “<article-title>Electric field Monte Carlo simulation of polarized light propagation in multi-layered media</article-title>,” <source>Proc. SPIE</source>
<volume>10461</volume>, <fpage>104610E</fpage> (<year>2017</year>).<pub-id pub-id-type="coden">PSISDG</pub-id><issn>0277-786X</issn><pub-id pub-id-type="doi">10.1117/12.2282397</pub-id></mixed-citation>
    </ref>
    <ref id="r30">
      <label>30.</label>
      <mixed-citation publication-type="other"><collab>NVIDIA Corp.</collab>, “<article-title>CUDA C programming guide</article-title>,” Version 10.0 (<year>2018</year>).</mixed-citation>
    </ref>
    <ref id="r31">
      <label>31.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>P.</given-names></name><etal>et al.</etal></person-group>, “<article-title>GPU acceleration of Monte Carlo simulations for polarized photon scattering in anisotropic turbid media</article-title>,” <source>Appl. Opt.</source>
<volume>55</volume>, <fpage>7468</fpage>–<lpage>7476</lpage> (<year>2016</year>).<pub-id pub-id-type="coden">APOPAI</pub-id><issn>0003-6935</issn><pub-id pub-id-type="doi">10.1364/AO.55.007468</pub-id><pub-id pub-id-type="pmid">27661571</pub-id></mixed-citation>
    </ref>
    <ref id="r32">
      <label>32.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oulhaj</surname><given-names>H.</given-names></name><etal>et al.</etal></person-group>, “<article-title>Diffuse optical tomography with polarized light: a GPU-accelerated polarization-sensitive Monte Carlo simulations for efficient sensitivity kernel computation</article-title>,” <source>Proc. SPIE</source>
<volume>11074</volume>, <fpage>110740Q</fpage> (<year>2019</year>).<pub-id pub-id-type="coden">PSISDG</pub-id><issn>0277-786X</issn><pub-id pub-id-type="doi">10.1117/12.2526939</pub-id></mixed-citation>
    </ref>
    <ref id="r33">
      <label>33.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tran</surname><given-names>A. P.</given-names></name><name><surname>Yan</surname><given-names>S.</given-names></name><name><surname>Fang</surname><given-names>Q.</given-names></name></person-group>, “<article-title>Improving model-based functional near-infrared spectroscopy analysis using mesh-based anatomical and light-transport models</article-title>,” <source>Neurophotonics</source>
<volume>7</volume>(<issue>1</issue>), <fpage>015008</fpage> (<year>2020</year>).<pub-id pub-id-type="doi">10.1117/1.NPh.7.1.015008</pub-id><pub-id pub-id-type="pmid">32118085</pub-id></mixed-citation>
    </ref>
    <ref id="r34">
      <label>34.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fang</surname><given-names>Q.</given-names></name><name><surname>Boas</surname><given-names>D. A.</given-names></name></person-group>, “<article-title>Monte Carlo simulation of photon migration in 3D turbid media accelerated by graphics processing units</article-title>,” <source>Opt. Express</source>
<volume>17</volume>(<issue>22</issue>), <fpage>20178</fpage>–<lpage>20190</lpage> (<year>2009</year>).<pub-id pub-id-type="coden">OPEXFF</pub-id><issn>1094-4087</issn><pub-id pub-id-type="doi">10.1364/OE.17.020178</pub-id><pub-id pub-id-type="pmid">19997242</pub-id></mixed-citation>
    </ref>
    <ref id="r35">
      <label>35.</label>
      <mixed-citation publication-type="webpage"><person-group person-group-type="author"><name><surname>Ramella-Roman</surname><given-names>J. C.</given-names></name><name><surname>Prahl</surname><given-names>S. A.</given-names></name><name><surname>Jacques</surname><given-names>S. L.</given-names></name></person-group>, “<article-title>Meridian plane Monte Carlo</article-title>,” <ext-link xlink:href="https://omlc.org/software/polarization/Meridian.html" ext-link-type="uri">https://omlc.org/software/polarization/Meridian.html</ext-link></mixed-citation>
    </ref>
    <ref id="r36">
      <label>36.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>L. V.</given-names></name><name><surname>Jacques</surname><given-names>S. L.</given-names></name><name><surname>Zheng</surname><given-names>L.</given-names></name></person-group>, “<article-title>MCML-Monte Carlo modeling of light transport in multi-layered tissues</article-title>,” <source>Comput. Methods Progr. Biomed.</source>
<volume>47</volume>(<issue>2</issue>), <fpage>131</fpage>–<lpage>146</lpage> (<year>1995</year>).<pub-id pub-id-type="doi">10.1016/0169-2607(95)01640-F</pub-id></mixed-citation>
    </ref>
    <ref id="r37">
      <label>37.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fang</surname><given-names>Q.</given-names></name></person-group>, “<article-title>Mesh-based Monte Carlo method using fast ray-tracing in Plücker coordinates</article-title>,” <source>Biomed. Opt. Express</source>
<volume>1</volume>(<issue>1</issue>), <fpage>165</fpage>–<lpage>175</lpage> (<year>2010</year>).<pub-id pub-id-type="coden">BOEICL</pub-id><issn>2156-7085</issn><pub-id pub-id-type="doi">10.1364/BOE.1.000165</pub-id><pub-id pub-id-type="pmid">21170299</pub-id></mixed-citation>
    </ref>
    <ref id="r38">
      <label>38.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bohren</surname><given-names>C.</given-names></name><name><surname>Huffman</surname><given-names>D. R.</given-names></name></person-group>, <source>Absorption and Scattering of Light by Small Particles</source>, <series>Wiley Science Paperback Series</series> (<year>1998</year>).</mixed-citation>
    </ref>
    <ref id="r39">
      <label>39.</label>
      <mixed-citation publication-type="webpage"><person-group person-group-type="author"><name><surname>Prahl</surname><given-names>S.</given-names></name></person-group>, “<article-title>ANSI C code for Mie scattering</article-title>,” <ext-link xlink:href="https://omlc.org/software/mie/index.html" ext-link-type="uri">https://omlc.org/software/mie/index.html</ext-link></mixed-citation>
    </ref>
  </ref-list>
</back>
