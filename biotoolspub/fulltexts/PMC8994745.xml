<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">J Comput Aided Mol Des</journal-id>
    <journal-id journal-id-type="iso-abbrev">J Comput Aided Mol Des</journal-id>
    <journal-title-group>
      <journal-title>Journal of Computer-Aided Molecular Design</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0920-654X</issn>
    <issn pub-type="epub">1573-4951</issn>
    <publisher>
      <publisher-name>Springer International Publishing</publisher-name>
      <publisher-loc>Cham</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8994745</article-id>
    <article-id pub-id-type="pmid">35314898</article-id>
    <article-id pub-id-type="publisher-id">445</article-id>
    <article-id pub-id-type="doi">10.1007/s10822-022-00445-6</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>RestraintMaker: a graph-based approach to select distance restraints in free-energy calculations with dual topology</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0945-8304</contrib-id>
        <name>
          <surname>Ries</surname>
          <given-names>Benjamin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8036-651X</contrib-id>
        <name>
          <surname>Rieder</surname>
          <given-names>Salomé</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rhiner</surname>
          <given-names>Clemens</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9420-7998</contrib-id>
        <name>
          <surname>Hünenberger</surname>
          <given-names>Philippe H.</given-names>
        </name>
        <address>
          <email>phil@igc.phys.chem.ethz.ch</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1893-4031</contrib-id>
        <name>
          <surname>Riniker</surname>
          <given-names>Sereina</given-names>
        </name>
        <address>
          <email>sriniker@ethz.ch</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.5801.c</institution-id><institution-id institution-id-type="ISNI">0000 0001 2156 2780</institution-id><institution>Laboratory of Physical Chemistry, </institution><institution>ETH Zürich, </institution></institution-wrap>Vladimir-Prelog-Weg 2, Zürich, 8093 Switzerland </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>22</day>
      <month>3</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>22</day>
      <month>3</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <year>2022</year>
    </pub-date>
    <volume>36</volume>
    <issue>3</issue>
    <fpage>175</fpage>
    <lpage>192</lpage>
    <history>
      <date date-type="received">
        <day>14</day>
        <month>12</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>2</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">The calculation of relative binding free energies (RBFE) involves the choice of the end-state/system representation, of a sampling approach, and of a free-energy estimator. System representations are usually termed “single topology” or “dual topology”. As the terminology is often used ambiguously in the literature, a systematic categorization of the system representations is proposed here. In the dual-topology approach, the molecules are simulated as separate molecules. Such an approach is relatively easy to automate for high-throughput RBFE calculations compared to the single-topology approach. Distance restraints are commonly applied to prevent the molecules from drifting apart, thereby improving the sampling efficiency. In this study, we introduce the program RestraintMaker, which relies on a greedy algorithm to find (locally) optimal distance restraints between pairs of atoms based on geometric measures. The algorithm is further extended for multi-state methods such as enveloping distribution sampling (EDS) or multi-site <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda $$\end{document}</tex-math><mml:math id="M2"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq1.gif"/></alternatives></inline-formula>-dynamics. The performance of RestraintMaker is demonstrated for toy models and for the calculation of relative hydration free energies. The Python program can be used in script form or through an interactive GUI within PyMol. The selected distance restraints can be written out in GROMOS or GROMACS file formats. Additionally, the program provides a human-readable JSON format that can easily be parsed and processed further. The code of RestraintMaker is freely available on GitHub <italic>https://github.com/rinikerlab/restraintmaker</italic>.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1007/s10822-022-00445-6.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Molecular dynamics</kwd>
      <kwd>Free energy calculation</kwd>
      <kwd>Protein-ligand binding</kwd>
      <kwd>Topology</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001711</institution-id>
            <institution>Schweizerischer Nationalfonds zur Förderung der Wissenschaftlichen Forschung</institution>
          </institution-wrap>
        </funding-source>
        <award-id>200021-178762</award-id>
        <award-id>200021-175944</award-id>
        <principal-award-recipient>
          <name>
            <surname>Hünenberger</surname>
            <given-names>Philippe H.</given-names>
          </name>
          <name>
            <surname>Riniker</surname>
            <given-names>Sereina</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Swiss Federal Institute of Technology Zurich</institution>
        </funding-source>
      </award-group>
      <open-access>
        <p>Open access funding provided by Swiss Federal Institute of Technology Zurich</p>
      </open-access>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© Springer Nature Switzerland AG 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par2">Recent methodological developments have improved the statistical robustness and the degree of automation of relative binding free energy (RBFE) calculations, which are now routinely applied in drug discovery projects in industry [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR13">13</xref>].</p>
    <p id="Par3">A free-energy calculation provides information about the relative populations of multiple end-states in equilibrium. Examples are found in drug design, where the end-states represent the different ligands that bind to a protein [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR14">14</xref>–<xref ref-type="bibr" rid="CR22">22</xref>], or in protein engineering, where the end-states correspond to the different amino acids considered for one position in the protein [<xref ref-type="bibr" rid="CR23">23</xref>–<xref ref-type="bibr" rid="CR25">25</xref>]. Each free-energy calculation involves the choice of a sampling approach, a free-energy estimator (e.g. thermodynamic integration (TI) [<xref ref-type="bibr" rid="CR26">26</xref>], the Zwanzig equation [<xref ref-type="bibr" rid="CR27">27</xref>], or Bennett’s acceptance ratio (BAR) [<xref ref-type="bibr" rid="CR28">28</xref>]), and a representation of the end-states (i.e., molecules or substructures of molecules) during the simulation.</p>
    <p id="Par4">Several possible representations have been proposed in the past to build a coordinate and topology space of the end-states. Historically, two approaches emerged, which were termed “single topology” [<xref ref-type="bibr" rid="CR29">29</xref>, <xref ref-type="bibr" rid="CR30">30</xref>] and “dual topology” [<xref ref-type="bibr" rid="CR29">29</xref>, <xref ref-type="bibr" rid="CR31">31</xref>]. Unfortunately, the terminology is not always clear in the literature and these terms are used ambiguously [<xref ref-type="bibr" rid="CR32">32</xref>–<xref ref-type="bibr" rid="CR34">34</xref>]. To distinguish the different representation options, we propose here a terminology based on the difference in the respective coordinate space (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). These definitions may differ from the historical ones. The single-topology approach contains a single set of coordinates for both end-states. In contrast, the dual-topology approach involves a separate set of coordinates for each end-state. The two approaches can be seen as opposite extremes. Three sub-variants of the dual-topology approach can be found in the literature: linked, separated and unconstrained. In addition, a “hybrid-topology” approach was recently described [<xref ref-type="bibr" rid="CR21">21</xref>], which presents an intermediate between the single and dual approaches (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). This scheme has been used in many studies for binding free energy calculations previously but not called hybrid topology. In protein engineering, Shobana et al. [<xref ref-type="bibr" rid="CR23">23</xref>] called a similar approach hybrid topology. The different representations vary with respect to sampling efficiency and the capability of handling complex transformations.<fig id="Fig1"><label>Fig. 1</label><caption><p>Three end-state representations can be distinguished based on the coordinate space. The “single-topology” approach (left) contains a single set of coordinates for all end-states. The “dual-topology” approach contains separate sets of coordinates for each end-state (right). The “hybrid-topology” approach (middle) combines atoms of common substructures into one coordinate set, while atoms that differ between the end-states are represented separately. It is therefore an intermediate between the two other representations. The dual topology approach can be further subdivided into three sub-variants: linked, separated, and unconstrained. The linked dual-topology approach is closest to the single topology approach, as the coordinate overlap between the end-states is enforced using direct spatial restraints (e.g. distance restraints). The separated variant is connecting the molecules indirectly by restraining them spatially to the same area, whereas the unconstrained variant does not restrain the molecules at all and is therefore also the most difficult to sample.</p></caption><graphic xlink:href="10822_2022_445_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par5">With the high-throughput application of RBFE calculations comes the need for automation [<xref ref-type="bibr" rid="CR10">10</xref>]. While there exist tools such as FESetup [<xref ref-type="bibr" rid="CR35">35</xref>], ProtoCaller [<xref ref-type="bibr" rid="CR36">36</xref>], SMArt [<xref ref-type="bibr" rid="CR37">37</xref>], or LOMAP [<xref ref-type="bibr" rid="CR38">38</xref>] to automatically set up single-topology RBFE calculations, the dual-topology approaches are in principle the easiest to automate as any alchemical molecule transformation can be realized without requiring atom mapping [<xref ref-type="bibr" rid="CR33">33</xref>]. For the unconstrained dual-topology variant, an automatic set-up procedure is available in the packages pyAutoFEP [<xref ref-type="bibr" rid="CR39">39</xref>] and FEW [<xref ref-type="bibr" rid="CR40">40</xref>]. When representing the end-states with a linked dual-topology approach, the set-up is more difficult than in the unconstrained case as the distance restraints between the molecules need to be chosen. For example, the QligFEP pipeline [<xref ref-type="bibr" rid="CR8">8</xref>] provides an automatic system generation for the linked dual-topology approach, where the distance restraints are placed in the perturbed common substructure of the end-states. These distance restraints only become active if the distance between the restrained atoms exceeds 0.02  nm. However, for complex transformations (e.g. in scaffold hopping), a more flexible approach is needed to select the optimal distance restraints between molecules.</p>
    <p id="Par6">In this work, we present a greedy algorithm to select (locally) optimal distance restraints for RBFE calculations with the linked dual-topology approach, which is also applicable to molecule pairs without a common core. In addition, the algorithm is extended to solve the same problem for multi-state RBFE methods such as enveloping distribution sampling (EDS) [<xref ref-type="bibr" rid="CR41">41</xref>, <xref ref-type="bibr" rid="CR42">42</xref>] and multi-site <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda $$\end{document}</tex-math><mml:math id="M4"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq2.gif"/></alternatives></inline-formula>-dynamics [<xref ref-type="bibr" rid="CR43">43</xref>], resulting in a linked multi-topology approach. Finally, we analyze the sampling behavior and performance of the approach for the calculation of relative hydration free energies. The algorithm is implemented in a Python package (<italic>https://github.com/rinikerlab/restraintmaker</italic>), which can be used as a scripting library or with a GUI inside PyMOL [<xref ref-type="bibr" rid="CR44">44</xref>].</p>
  </sec>
  <sec id="Sec2">
    <title>Theory</title>
    <sec id="Sec3">
      <title>End-state representations</title>
      <p id="Par7">In the following, we provide the categorization of the different system representation approaches (Fig. <xref rid="Fig2" ref-type="fig">2</xref>).<fig id="Fig2"><label>Fig. 2</label><caption><p>The three end-state representations can be illustrated using the coordinate mapping of molecules <italic>a</italic> and <italic>b</italic> in the end-states <italic>A</italic> and <italic>B</italic>. The smallest number of coordinates is required for the single-topology coordinate space (<inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$dim(\mathbf{r}^{AB}_{\text {single}})$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mtext>single</mml:mtext><mml:mrow><mml:mi mathvariant="italic">AB</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq3.gif"/></alternatives></inline-formula>) as the coordinate set is formed from the union of all coordinates (left). If a coordinate is only used in one end-state, it becomes a non-interacting dummy atom in the other end-state. The hybrid-topology approach (middle) requires more coordinates for its coordinate space (<inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{r}^{AB}_{\text {hybrid}}$$\end{document}</tex-math><mml:math id="M8"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mtext>hybrid</mml:mtext><mml:mrow><mml:mi mathvariant="italic">AB</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq4.gif"/></alternatives></inline-formula>), as the coordinates of differing atoms are represented separately. The largest coordinate space is required for the dual-topology approach. Here, the coordinate space (<inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$dim(\mathbf{r}^{AB}_{\text {dual}})$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mtext>dual</mml:mtext><mml:mrow><mml:mi mathvariant="italic">AB</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq5.gif"/></alternatives></inline-formula>) is the sum of both molecules.</p></caption><graphic xlink:href="10822_2022_445_Fig2_HTML" id="MO2"/></fig></p>
      <sec id="Sec4">
        <title>Single topology</title>
        <p id="Par8">The single-topology approach was first used by Jorgensen <italic>et al.</italic> [<xref ref-type="bibr" rid="CR45">45</xref>] to calculate the relative hydration free energies of methanol and ethane. The approach was later termed “single-topology” by Pearlman et al. [<xref ref-type="bibr" rid="CR29">29</xref>]. The end-states are represented by the union of the coordinates of the molecules, limiting the possible transformations that can be handled by this method. Usually, perturbations for a single topology approach include both atom types (i.e. van der Waals parameters and/or partial charges) and covalent terms [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR29">29</xref>, <xref ref-type="bibr" rid="CR30">30</xref>, <xref ref-type="bibr" rid="CR32">32</xref>, <xref ref-type="bibr" rid="CR45">45</xref>–<xref ref-type="bibr" rid="CR50">50</xref>]. A single-topology approach in this definition is constructed as follows for two end-states <italic>A</italic> and <italic>B</italic> nvolving the two molecules <italic>a</italic> and <italic>b</italic> (Fig. <xref rid="Fig2" ref-type="fig">2</xref>),<disp-formula id="Equ7"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} dim(\mathbf{r}_{single}^{AB})&amp;= dim(\mathbf{r}^{(a \cup b)}) \\ \mathbf{r}^{AB}_{\mathrm{single}}&amp;= \{\mathbf{r}^{AB}_{1}, \mathbf{r}^{AB}_{2}, ..., \mathbf{r}^{AB}_{dim(\mathbf{r}_{single}^{AB})}\} \end{aligned}$$\end{document}</tex-math><mml:math id="M12" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="bold">r</mml:mi><mml:mrow><mml:mi mathvariant="italic">single</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">AB</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>∪</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mi mathvariant="normal">single</mml:mi><mml:mrow><mml:mi mathvariant="italic">AB</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mi mathvariant="italic">AB</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mi mathvariant="italic">AB</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="bold">r</mml:mi><mml:mrow><mml:mi mathvariant="italic">single</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">AB</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">AB</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="10822_2022_445_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq6"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$dim(\mathbf{r}_{single}^{AB})$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="bold">r</mml:mi><mml:mrow><mml:mi mathvariant="italic">single</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">AB</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq6.gif"/></alternatives></inline-formula> is the total number of atomic coordinates of the end-states <italic>A</italic> and <italic>B</italic>, and <inline-formula id="IEq7"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{r}_{single}^{AB}$$\end{document}</tex-math><mml:math id="M16"><mml:msubsup><mml:mi mathvariant="bold">r</mml:mi><mml:mrow><mml:mi mathvariant="italic">single</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">AB</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq7.gif"/></alternatives></inline-formula> the corresponding coordinate vector. Note that the unperturbed atoms of the environment (i.e., solvent and/or protein atoms), are not considered here for simplicity.</p>
        <p id="Par9">The single-topology approach has in principle the best sampling efficiency compared to other representations as it is constructed with the smallest number of coordinates and therefore the fewest degrees of freedom are perturbed [<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR30">30</xref>, <xref ref-type="bibr" rid="CR34">34</xref>, <xref ref-type="bibr" rid="CR47">47</xref>]. However, an issue arises when the molecules differ not only in the type of atoms but also in their number. To address this, a non-interacting “dummy” state can be assigned to the vanishing atom(s) [<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR30">30</xref>, <xref ref-type="bibr" rid="CR34">34</xref>, <xref ref-type="bibr" rid="CR47">47</xref>]. Different variants of dummy states are possible. Typically, only the non-bonded interactions are removed. However, it has been shown that also the covalent terms of “dummy” states can influence the free-energy calculations [<xref ref-type="bibr" rid="CR34">34</xref>]. The construction of a single topology becomes increasingly challenging with more complex molecule transformations. For example, to realize complex transformations such as ring-size changes or ring opening/closing, special soft-bond terms have to be implemented [<xref ref-type="bibr" rid="CR17">17</xref>].</p>
      </sec>
      <sec id="Sec5">
        <title>Hybrid topology</title>
        <p id="Par10">The term hybrid single-dual topology was used by Jiang et al. [<xref ref-type="bibr" rid="CR21">21</xref>] in 2019 to describe the combination of a single-topology core (common among the molecules) with dual-topology substituents (differing among the molecules). However, similar schemes were already used in previous studies (but called either single or dual topology) [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR37">37</xref>, <xref ref-type="bibr" rid="CR51">51</xref>–<xref ref-type="bibr" rid="CR53">53</xref>]. A hybrid topology approach in this definition can be constructed as follows for two end-states <italic>A</italic> and <italic>B</italic> involving the two molecules <italic>a</italic> and <italic>b</italic> (Fig. <xref rid="Fig2" ref-type="fig">2</xref>),<disp-formula id="Equ8"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} dim(\mathbf{r}_{hybrid}^{AB})&amp;= dim(\mathbf{r}^{(a \cap b)}) + dim(\mathbf{r}^{ (a \setminus b)}) + dim(\mathbf{r}^{~(b \setminus a)})\\ \mathbf{r}^{AB}_{\mathrm{hybrid}}&amp;= \{\mathbf{r}^{~(a~\cap ~b)}_{1}, \mathbf{r}^{~(a~\cap ~b)}_{2}, ..., \mathbf{r}^{~(a~\cap ~b)}_{dim(\mathbf{r}^{~(a~\cap ~b)})}, \\&amp;~~~\mathbf{r}^{~(a \setminus b)}_{1}, \mathbf{r}^{~(a \setminus b)}_{2}, ..., \mathbf{r}^{~(a \setminus b)}_{dim(\mathbf{r}^{~(a \setminus b)})}, \\&amp;~~~\mathbf{r}^{~(b \setminus a)}_{1}, \mathbf{r}^{~(b \setminus a)}_{2}, ..., \mathbf{r}^{~(b \setminus a)}_{dim(\mathbf{r}^{~(b \setminus a)})}, \} \end{aligned}$$\end{document}</tex-math><mml:math id="M18" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="bold">r</mml:mi><mml:mrow><mml:mi mathvariant="italic">hybrid</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">AB</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>∩</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mspace width="3.33333pt"/><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mi mathvariant="normal">hybrid</mml:mi><mml:mrow><mml:mi mathvariant="italic">AB</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mspace width="3.33333pt"/><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mspace width="3.33333pt"/><mml:mo>∩</mml:mo><mml:mspace width="3.33333pt"/><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mspace width="3.33333pt"/><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mspace width="3.33333pt"/><mml:mo>∩</mml:mo><mml:mspace width="3.33333pt"/><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mspace width="3.33333pt"/><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mspace width="3.33333pt"/><mml:mo>∩</mml:mo><mml:mspace width="3.33333pt"/><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mspace width="3.33333pt"/><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mspace width="3.33333pt"/><mml:mo>∩</mml:mo><mml:mspace width="3.33333pt"/><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="3.33333pt"/><mml:mspace width="3.33333pt"/><mml:mspace width="3.33333pt"/><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mspace width="3.33333pt"/><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mspace width="3.33333pt"/><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mspace width="3.33333pt"/><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mspace width="3.33333pt"/><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="3.33333pt"/><mml:mspace width="3.33333pt"/><mml:mspace width="3.33333pt"/><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mspace width="3.33333pt"/><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mspace width="3.33333pt"/><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mspace width="3.33333pt"/><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mspace width="3.33333pt"/><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo>,</mml:mo><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="10822_2022_445_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>Hybrid topology approaches aim at combining the advantages of single and dual topology, i.e., to keep the number of perturbed degrees of freedom minimal for sampling efficiency while facilitating more complex transformations.</p>
      </sec>
      <sec id="Sec6">
        <title>Dual topology</title>
        <p id="Par11">In a dual topology, two fully separate sets of coordinates are used for the molecules. This approach was first introduced by Gao et al. [<xref ref-type="bibr" rid="CR31">31</xref>], and termed later on “dual topology” by Pearlman et al. [<xref ref-type="bibr" rid="CR29">29</xref>] The atoms of molecule <italic>a</italic>, which are fully interacting in end-state <italic>A</italic>, are transformed to the dummy state in end-state <italic>B</italic>, and vice versa. Importantly, the atoms of the two distinct molecules do not interact with each other and only share the same environment [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR33">33</xref>]. Usually, in such dual topology approaches, only the non-bonded terms are perturbed [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR32">32</xref>, <xref ref-type="bibr" rid="CR54">54</xref>]. A dual-topology approach in this definition can be constructed as follows for the end-states <italic>A</italic> and <italic>B</italic> involving the two molecules <italic>a</italic> and <italic>b</italic> (Fig. <xref rid="Fig2" ref-type="fig">2</xref>),<disp-formula id="Equ9"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} dim(\mathbf{r}_{\mathrm{dual}}^{ AB})&amp;= dim(\mathbf{r}^{ a}) + dim(\mathbf{r}^{ b})\\ \mathbf{r}^{AB}_{\mathrm{dual}}&amp;= \{\mathbf{r}^{ a}_{1}, \mathbf{r}^{~a}_{2}, ..., \mathbf{r}^{~a}_{dim(\mathbf{r}^{ a})}, \mathbf{r}^{ b}_{1}, \mathbf{r}^{ b}_{2}, ..., \mathbf{r}^{ b}_{dim(\mathbf{r}^{ b})}\} \end{aligned}$$\end{document}</tex-math><mml:math id="M20" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="bold">r</mml:mi><mml:mrow><mml:mi mathvariant="normal">dual</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">AB</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mi mathvariant="normal">dual</mml:mi><mml:mrow><mml:mi mathvariant="italic">AB</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mi>a</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mspace width="3.33333pt"/><mml:mi>a</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mspace width="3.33333pt"/><mml:mi>a</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mi>b</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mi>b</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>b</mml:mi></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="10822_2022_445_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula>The separated coordinates lead to a larger number of atoms in the system and thus, more degrees of freedom are perturbed, lowering the sampling efficiency compared to single-topology approaches. Three sub-variants of the dual-topology approach can be distinguished depending on how this issue is addressed in practice: (i) the linked variant with direct spatial restraints between the molecules to prevent them from drifting apart during the simulation [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR55">55</xref>], (ii) the separated variant with restraining to the environment [<xref ref-type="bibr" rid="CR33">33</xref>, <xref ref-type="bibr" rid="CR56">56</xref>], and (iii) the unconstrained variant [<xref ref-type="bibr" rid="CR39">39</xref>, <xref ref-type="bibr" rid="CR57">57</xref>]. The linked dual topology is in principle the most efficient variant if the transformation is relatively simple (no changes in binding modes induced by reorientation or large conformational differences). The separated dual-topology approach is expected to be less efficient than the linked variant, but can handle these more challenging transformations [<xref ref-type="bibr" rid="CR56">56</xref>]. A significant advantage of the dual-topology approach is the straightforward set-up of a system compared to the single and hybrid topologies, especially for more complex transformations or multiple end-states.</p>
      </sec>
    </sec>
    <sec id="Sec7">
      <title>Automated placement of distance restraints</title>
      <p id="Par12">To facilitate the set-up of RBFE calculations with the linked dual-topology approach, the selection of optimal distance restraints between the molecules needs to be automated. The proposed algorithm is based on classical graph algorithms. Its goal is to identify suitable placements for the distance restraints between two molecules <inline-formula id="IEq8"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_i$$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq8.gif"/></alternatives></inline-formula> and <inline-formula id="IEq9"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_j$$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq9.gif"/></alternatives></inline-formula>. The following conditions are enforced: <list list-type="order"><list-item><p id="Par13"><inline-formula id="IEq10"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_i$$\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq10.gif"/></alternatives></inline-formula> and <inline-formula id="IEq11"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_j$$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq11.gif"/></alternatives></inline-formula> are pre-aligned to each other</p></list-item><list-item><p id="Par14">Optimal placement of distance restraints requires that <list list-type="alpha-lower"><list-item><p id="Par15">the restrained atom pairs are maximally distant over the two molecules</p></list-item><list-item><p id="Par16">the restrained atoms have a small distance to each other in the aligned structures</p></list-item><list-item><p id="Par17">the restraints do not influence the conformational sampling of the molecules</p></list-item></list></p></list-item><list-item><p id="Par18">For a user-defined number of required restraints <inline-formula id="IEq12"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{\text {res}}$$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mi>n</mml:mi><mml:mtext>res</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq12.gif"/></alternatives></inline-formula>, it holds that <inline-formula id="IEq13"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{\text {res}} \ll n_{m_i} $$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mtext>res</mml:mtext></mml:msub><mml:mo>≪</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq13.gif"/></alternatives></inline-formula> and <inline-formula id="IEq14"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ ~n_{res} \ll n_{m_j}$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:mspace width="3.33333pt"/><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">res</mml:mi></mml:mrow></mml:msub><mml:mo>≪</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq14.gif"/></alternatives></inline-formula> , where <inline-formula id="IEq15"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_i$$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq15.gif"/></alternatives></inline-formula> and <inline-formula id="IEq16"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_j$$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq16.gif"/></alternatives></inline-formula> are the numbers of atoms of molecules <inline-formula id="IEq17"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_i$$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq17.gif"/></alternatives></inline-formula> and <inline-formula id="IEq18"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_j$$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq18.gif"/></alternatives></inline-formula>, respectively</p></list-item></list>From these conditions follows that only atoms in relatively rigid regions of the molecules such as rings should be selected for the restraint search space. While restraining non-ring atoms might be favorable for achieving maximally distant distribution of the restrained atoms over the molecules, it is more likely to distort the conformational sampling of the molecules. The steps of the algorithm are shown schematically in Fig. <xref rid="Fig3" ref-type="fig">3</xref> and explained in the following subsections.</p>
      <sec id="Sec8">
        <title>Assigning distance restraints for a pair of molecules</title>
        <p id="Par19">
          <fig id="Fig3">
            <label>Fig. 3</label>
            <caption>
              <p>Schematic illustration of the algorithm steps to identify optimal placements for the distance restraints between a pair of molecules. The described algorithm uses a set of possible atoms (here these are the ring atoms). Next, possible restraints are filtered by the user-defined atom distance cutoff <inline-formula id="IEq19"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_\text {res}$$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mi>d</mml:mi><mml:mtext>res</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq19.gif"/></alternatives></inline-formula>. After this filtering step, the midpoints of the remaining possible restraints are calculated and used further as nodes of a graph. These nodes are connected by edges that have assigned weights, corresponding to the Euclidean distance of the midpoints. From this, a spanning tree is built with a min-max decision scheme. The construction of the spanning tree is stopped after <inline-formula id="IEq20"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_\text {res}$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mi>n</mml:mi><mml:mtext>res</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq20.gif"/></alternatives></inline-formula> iterations or if all nodes were connected. The result is a set of optimal restraints, <inline-formula id="IEq21"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{\text {res,opt}}$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mi>C</mml:mi><mml:mtext>res,opt</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq21.gif"/></alternatives></inline-formula>, which will be translated back to an atom selection for further use in MD packages.</p>
            </caption>
            <graphic xlink:href="10822_2022_445_Fig3_HTML" id="MO6"/>
          </fig>
        </p>
        <p id="Par20"><italic>Translation into a graph problem</italic>: The developed algorithm is based on a graph representation of the restraint search space. To solve the problem of selecting an optimal set of atom pairs to define the distance restraints, it needs to be translated into a graph <italic>G</italic> fulfilling,<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} G(N, E, \omega ), E \subseteq \{\{x,y\}\mid x,y\in N\;{\text {and}}\;x\ne y\}, \end{aligned}$$\end{document}</tex-math><mml:math id="M50" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo>⊆</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">}</mml:mo><mml:mo>∣</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>∈</mml:mo><mml:mi>N</mml:mi><mml:mspace width="0.277778em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.277778em"/><mml:mi>x</mml:mi><mml:mo>≠</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="10822_2022_445_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <italic>N</italic> is a set of nodes, <italic>E</italic> a set of edges, and <inline-formula id="IEq22"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\omega $$\end{document}</tex-math><mml:math id="M52"><mml:mi>ω</mml:mi></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq22.gif"/></alternatives></inline-formula> a set of weights.</p>
        <p id="Par21">We consider a molecule pair consisting of the two molecules <inline-formula id="IEq23"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_i$$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq23.gif"/></alternatives></inline-formula> and <inline-formula id="IEq24"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_j$$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq24.gif"/></alternatives></inline-formula>, with their sets of atoms <inline-formula id="IEq25"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_i$$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq25.gif"/></alternatives></inline-formula> and <inline-formula id="IEq26"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_j$$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mi>A</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq26.gif"/></alternatives></inline-formula>, respectively. In a first step, existing algorithms such as e.g. implemented in the RDKit [<xref ref-type="bibr" rid="CR58">58</xref>] or PyMol [<xref ref-type="bibr" rid="CR44">44</xref>] can be used to align the two molecules onto each other. The alignment can for example be based on the maximum common substructure (MCS), or in the case of scaffold hopping the maximal overlap of the van der Waals volumes of the molecules. Next, the sets of possible atoms <inline-formula id="IEq27"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_i$$\end{document}</tex-math><mml:math id="M62"><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq27.gif"/></alternatives></inline-formula> and <inline-formula id="IEq28"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_j$$\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mi>A</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq28.gif"/></alternatives></inline-formula> for the distance restraints are reduced to the ring atoms of the respective molecules, <inline-formula id="IEq29"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A^\text {ring}_i$$\end{document}</tex-math><mml:math id="M66"><mml:msubsup><mml:mi>A</mml:mi><mml:mi>i</mml:mi><mml:mtext>ring</mml:mtext></mml:msubsup></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq29.gif"/></alternatives></inline-formula> and <inline-formula id="IEq30"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A^\text {ring}_j$$\end{document}</tex-math><mml:math id="M68"><mml:msubsup><mml:mi>A</mml:mi><mml:mi>j</mml:mi><mml:mtext>ring</mml:mtext></mml:msubsup></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq30.gif"/></alternatives></inline-formula>. In addition, a user-defined cutoff distance <inline-formula id="IEq31"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_\text {res}$$\end{document}</tex-math><mml:math id="M70"><mml:msub><mml:mi>d</mml:mi><mml:mtext>res</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq31.gif"/></alternatives></inline-formula> between the pairs of atoms is introduced (here, <inline-formula id="IEq32"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_\text {res} = 0.1~\text {nm}$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>res</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn><mml:mspace width="3.33333pt"/><mml:mtext>nm</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq32.gif"/></alternatives></inline-formula>). Therefore, a possible distance restraint is a pair of atoms <inline-formula id="IEq33"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(a^\text {ring}_i, a^\text {ring}_j)$$\end{document}</tex-math><mml:math id="M74"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mtext>ring</mml:mtext></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mi>j</mml:mi><mml:mtext>ring</mml:mtext></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq33.gif"/></alternatives></inline-formula> that fulfills the distance criterion <inline-formula id="IEq34"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d(a^\text {ring}_i, a^\text {ring}_j) \le d_\text {res}$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:mi>d</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mtext>ring</mml:mtext></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mi>j</mml:mi><mml:mtext>ring</mml:mtext></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≤</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mtext>res</mml:mtext></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq34.gif"/></alternatives></inline-formula>.</p>
        <p id="Par22">The possible distance restraints <inline-formula id="IEq35"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_\text {res}$$\end{document}</tex-math><mml:math id="M78"><mml:msub><mml:mi>C</mml:mi><mml:mtext>res</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq35.gif"/></alternatives></inline-formula> are used as nodes <italic>N</italic> to construct a fully connected graph <italic>G</italic>. Each individual restraint <inline-formula id="IEq36"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_\text {res}$$\end{document}</tex-math><mml:math id="M80"><mml:msub><mml:mi>c</mml:mi><mml:mtext>res</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq36.gif"/></alternatives></inline-formula> is represented by the midpoint of the two involved atoms. The undirected edges of <italic>G</italic> have as weight <inline-formula id="IEq37"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\omega ^\text {dist}_{ji}$$\end{document}</tex-math><mml:math id="M82"><mml:msubsup><mml:mi>ω</mml:mi><mml:mrow><mml:mi mathvariant="italic">ji</mml:mi></mml:mrow><mml:mtext>dist</mml:mtext></mml:msubsup></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq37.gif"/></alternatives></inline-formula> the Euclidean distance between the midpoints of the two atom pairs <inline-formula id="IEq38"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\omega ^{dist}_{ji}=d(c_{\text {res}_j},c_{\text {res}_i})$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:msubsup><mml:mi>ω</mml:mi><mml:mrow><mml:mi mathvariant="italic">ji</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">dist</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:msub><mml:mtext>res</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:msub><mml:mtext>res</mml:mtext><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq38.gif"/></alternatives></inline-formula>.</p>
        <p id="Par23"><italic>Solving the graph problem</italic>: From the generated graph, only a subset of restraints fulfills the conditions 1-3 listed above. To obtain a relevant subset of restraints, we use a min-max decision scheme inspired by the minimax theorem [<xref ref-type="bibr" rid="CR59">59</xref>] to build a spanning tree (i.e. a subset of restraints, <inline-formula id="IEq39"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_\text {res,opt}$$\end{document}</tex-math><mml:math id="M86"><mml:msub><mml:mi>C</mml:mi><mml:mtext>res,opt</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq39.gif"/></alternatives></inline-formula>) within a greedy Prim-like approach [<xref ref-type="bibr" rid="CR60">60</xref>].</p>
        <p id="Par24">The algorithm starts by picking the edge in the graph <italic>G</italic> with the largest weight <inline-formula id="IEq40"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\omega ^\text {dist}_{ij}$$\end{document}</tex-math><mml:math id="M88"><mml:msubsup><mml:mi>ω</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mtext>dist</mml:mtext></mml:msubsup></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq40.gif"/></alternatives></inline-formula> (distance), i.e. the two restraints whose midpoints are the furthest apart. After this initial selection of two restraints for <inline-formula id="IEq41"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_\text {res,opt}$$\end{document}</tex-math><mml:math id="M90"><mml:msub><mml:mi>C</mml:mi><mml:mtext>res,opt</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq41.gif"/></alternatives></inline-formula>, the weights of the edges in <italic>G</italic> are updated with the minimal distance of all <inline-formula id="IEq42"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_\text {res}$$\end{document}</tex-math><mml:math id="M92"><mml:msub><mml:mi>c</mml:mi><mml:mtext>res</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq42.gif"/></alternatives></inline-formula> in <inline-formula id="IEq43"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_\text {res,opt}$$\end{document}</tex-math><mml:math id="M94"><mml:msub><mml:mi>C</mml:mi><mml:mtext>res,opt</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq43.gif"/></alternatives></inline-formula> to a respective node <inline-formula id="IEq44"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_i$$\end{document}</tex-math><mml:math id="M96"><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq44.gif"/></alternatives></inline-formula>. Subsequently, all edges and nodes are removed, which contain atoms that are already selected in <inline-formula id="IEq45"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_\text {res,opt}$$\end{document}</tex-math><mml:math id="M98"><mml:msub><mml:mi>C</mml:mi><mml:mtext>res,opt</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq45.gif"/></alternatives></inline-formula>. After the update of the edge weights, the restraint <inline-formula id="IEq46"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_\text {res}$$\end{document}</tex-math><mml:math id="M100"><mml:msub><mml:mi>c</mml:mi><mml:mtext>res</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq46.gif"/></alternatives></inline-formula> with maximal <inline-formula id="IEq47"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\omega ^\text {dist}_{ji}$$\end{document}</tex-math><mml:math id="M102"><mml:msubsup><mml:mi>ω</mml:mi><mml:mrow><mml:mi mathvariant="italic">ji</mml:mi></mml:mrow><mml:mtext>dist</mml:mtext></mml:msubsup></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq47.gif"/></alternatives></inline-formula> is added to <inline-formula id="IEq48"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_\text {res,opt}$$\end{document}</tex-math><mml:math id="M104"><mml:msub><mml:mi>C</mml:mi><mml:mtext>res,opt</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq48.gif"/></alternatives></inline-formula>. This procedure is repeated until either <inline-formula id="IEq49"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|C_\text {res,opt}| = n_\text {res}$$\end{document}</tex-math><mml:math id="M106"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mtext>res,opt</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mtext>res</mml:mtext></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq49.gif"/></alternatives></inline-formula> (in practice we expect a rather small number for <inline-formula id="IEq50"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_\text {res}$$\end{document}</tex-math><mml:math id="M108"><mml:msub><mml:mi>n</mml:mi><mml:mtext>res</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq50.gif"/></alternatives></inline-formula>, typically <inline-formula id="IEq51"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ 4&lt; n_\text {res} &lt; 10$$\end{document}</tex-math><mml:math id="M110"><mml:mrow><mml:mn>4</mml:mn><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mtext>res</mml:mtext></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq51.gif"/></alternatives></inline-formula>) or all remaining nodes are connected.</p>
        <p id="Par25"><italic>Back-mapping</italic>: The selected subset of <inline-formula id="IEq52"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_\text {res}$$\end{document}</tex-math><mml:math id="M112"><mml:msub><mml:mi>n</mml:mi><mml:mtext>res</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq52.gif"/></alternatives></inline-formula> restraints, <inline-formula id="IEq53"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_\text {res,opt}$$\end{document}</tex-math><mml:math id="M114"><mml:msub><mml:mi>C</mml:mi><mml:mtext>res,opt</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq53.gif"/></alternatives></inline-formula> is mapped back to the atoms in the molecules, such that the distance restraints can be written in a format readable by MD packages such as GROMOS [<xref ref-type="bibr" rid="CR61">61</xref>] or GROMACS [<xref ref-type="bibr" rid="CR62">62</xref>]. Additionally, a JSON [<xref ref-type="bibr" rid="CR63">63</xref>] format is provided, allowing to import the results with any standardized JSON-Parser.</p>
        <p id="Par26"><italic>Tie-breaking</italic>: Due to non-perfect alignment and finite numerical precision, a tie between multiple restraints can occur, i.e. they have a very similar distance to the already selected restraints. This practical problem was solved by adding a tie-breaker that detects whether multiple high-priority restraints are within a range of 0.02 nm in a given iteration step and refines the decision result by applying a second criterion. For each candidate restraint in an iteration step, the distance to the center of geometry (COG) of all already selected restraints is calculated, and the restraint is chosen for which this distance is maximal.</p>
      </sec>
      <sec id="Sec9">
        <title>Extension to multiple end-states</title>
        <p id="Par27">For multi-state methods such as EDS [<xref ref-type="bibr" rid="CR41">41</xref>, <xref ref-type="bibr" rid="CR42">42</xref>], replica-exchange EDS (RE-EDS) [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR64">64</xref>, <xref ref-type="bibr" rid="CR65">65</xref>], multi-site <inline-formula id="IEq54"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda $$\end{document}</tex-math><mml:math id="M116"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq54.gif"/></alternatives></inline-formula>-Dynamics [<xref ref-type="bibr" rid="CR43">43</xref>], or multi-state <inline-formula id="IEq55"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda $$\end{document}</tex-math><mml:math id="M118"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq55.gif"/></alternatives></inline-formula>-LEUS [<xref ref-type="bibr" rid="CR66">66</xref>], more than two molecules need to be restrained to each other. Based on our experience with RE-EDS, it is best to apply the distance restraints between multiple molecules in form of a ring, i.e. each molecule is restrained to two neighboring molecules [<xref ref-type="bibr" rid="CR65">65</xref>]. This scheme is used in the following.<fig id="Fig4"><label>Fig. 4</label><caption><p>Schematic illustration of the algorithm steps to link multiple end-states by distance restraints for a multi-state RBFE calculation. The selection is carried out in four steps. (i) Optimal restraints are calculated for all possible molecule pairs, building up a fully connected graph. (ii) The weights <inline-formula id="IEq56"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\omega ^\text {CHV}_i$$\end{document}</tex-math><mml:math id="M120"><mml:msubsup><mml:mi>ω</mml:mi><mml:mi>i</mml:mi><mml:mtext>CHV</mml:mtext></mml:msubsup></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq56.gif"/></alternatives></inline-formula> of the edges are calculated as the convex hull volume (CHV) formed by the selected restraints. (iii) A maximum spanning tree without branching is greedily constructed by selecting the edges with maximal weights. (iv) The ring is closed by connecting the ends of the chain.</p></caption><graphic xlink:href="10822_2022_445_Fig4_HTML" id="MO8"/></fig></p>
        <p id="Par28">In a first step, the pairwise greedy algorithm is used to calculate an optimal set of distance restraints between all possible molecule pairs, building up a fully connected graph (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). The possible sets of restraints are subsequently compared to each other by calculating the convex hull around the coordinates of all the restraint midpoints. The convex hull volume (CHV) is then assigned to the edges of the fully connected graph as weight <inline-formula id="IEq57"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\omega ^\text {CHV}$$\end{document}</tex-math><mml:math id="M122"><mml:msup><mml:mi>ω</mml:mi><mml:mtext>CHV</mml:mtext></mml:msup></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq57.gif"/></alternatives></inline-formula>. The optimal chain of connected molecules is determined by applying another greedy algorithm, inspired by the Kruskal algorithm [<xref ref-type="bibr" rid="CR67">67</xref>], which picks the edges with the largest CHVs without forming cycles or branches (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). The chain is closed to a ring by tying the loose ends together. This last molecule pair may have a less good set of restraints.</p>
      </sec>
    </sec>
    <sec id="Sec10">
      <title>Free-energy methods</title>
      <p id="Par29">Two free-energy methods were tested with the linked dual-topology approach.</p>
      <sec id="Sec11">
        <title>Thermodynamic integration</title>
        <p id="Par30">TI is a standard method to estimate free-energy differences [<xref ref-type="bibr" rid="CR26">26</xref>], where a <inline-formula id="IEq58"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda $$\end{document}</tex-math><mml:math id="M124"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq58.gif"/></alternatives></inline-formula>-dependent path between the two end-states <italic>A</italic> and <italic>B</italic> is sampled. The potential energy of the system is constructed as,<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} V(\mathbf{r}; \lambda ) = (1-\lambda ) ~ V_A(\mathbf{r}) + \lambda ~ V_B(\mathbf{r}) \end{aligned}$$\end{document}</tex-math><mml:math id="M126" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo>;</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="3.33333pt"/><mml:msub><mml:mi>V</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mspace width="3.33333pt"/><mml:msub><mml:mi>V</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="10822_2022_445_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>End-state <italic>A</italic> is obtained when <inline-formula id="IEq59"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda = 0$$\end{document}</tex-math><mml:math id="M128"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq59.gif"/></alternatives></inline-formula>, and end-state <italic>B</italic> when <inline-formula id="IEq60"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda = 1$$\end{document}</tex-math><mml:math id="M130"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq60.gif"/></alternatives></inline-formula>. In practice, simulations at discrete <inline-formula id="IEq61"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda $$\end{document}</tex-math><mml:math id="M132"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq61.gif"/></alternatives></inline-formula>-points between 0 and 1 are performed, and the free-energy difference is obtained by numerical integration,<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \Delta G_{BA} = \int ^{1}_{0} \left\langle \frac{\partial V(\lambda )}{\partial \lambda } \right\rangle _{\lambda } \,d\lambda \end{aligned}$$\end{document}</tex-math><mml:math id="M134" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="italic">BA</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mn>1</mml:mn></mml:msubsup><mml:msub><mml:mfenced close="〉" open="〈"><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>λ</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mi>λ</mml:mi></mml:msub><mml:mspace width="0.166667em"/><mml:mi>d</mml:mi><mml:mi>λ</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="10822_2022_445_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
      </sec>
      <sec id="Sec12">
        <title>Replica-exchange enveloping distribution sampling</title>
        <p id="Par31">RE-EDS [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR64">64</xref>, <xref ref-type="bibr" rid="CR65">65</xref>] is a combination of Hamiltonian replica exchange [<xref ref-type="bibr" rid="CR68">68</xref>, <xref ref-type="bibr" rid="CR69">69</xref>] and EDS [<xref ref-type="bibr" rid="CR41">41</xref>, <xref ref-type="bibr" rid="CR42">42</xref>]. In EDS, a reference state <inline-formula id="IEq62"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_R$$\end{document}</tex-math><mml:math id="M136"><mml:msub><mml:mi>V</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq62.gif"/></alternatives></inline-formula> is sampled, which combines <italic>N</italic> end-states as,<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} V_R\left( \mathbf{r};s,\mathbf{E}^R\right) = -\frac{1}{\beta s}\ln \left[ \sum \limits _{i=1}^N e^{-\beta s\left( V_i(\mathbf{r})-E_i^R\right) }\right] \end{aligned}$$\end{document}</tex-math><mml:math id="M138" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi mathvariant="bold">r</mml:mi><mml:mo>;</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:mrow><mml:mi>R</mml:mi></mml:msup></mml:mfenced><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>β</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mfrac><mml:mo>ln</mml:mo><mml:mfenced close="]" open="["><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi>β</mml:mi><mml:mi>s</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mi>i</mml:mi><mml:mi>R</mml:mi></mml:msubsup></mml:mfenced></mml:mrow></mml:msup></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="10822_2022_445_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>where <italic>s</italic> is the smoothness parameter, <inline-formula id="IEq63"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_i^R$$\end{document}</tex-math><mml:math id="M140"><mml:msubsup><mml:mi>E</mml:mi><mml:mi>i</mml:mi><mml:mi>R</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq63.gif"/></alternatives></inline-formula> a set of energy offsets and <inline-formula id="IEq64"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta =1/(k_B~T)$$\end{document}</tex-math><mml:math id="M142"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mspace width="3.33333pt"/><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq64.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq65"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k_B$$\end{document}</tex-math><mml:math id="M144"><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq65.gif"/></alternatives></inline-formula> is the Boltzmann constant and <italic>T</italic> the absolute temperature. The force on a particle <italic>k</italic> can be calculated as [<xref ref-type="bibr" rid="CR41">41</xref>, <xref ref-type="bibr" rid="CR42">42</xref>],<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \mathbf{f}_k(t)=-\frac{\partial V_R(\mathbf{r}; s, \mathbf{E}^R)}{\partial \mathbf{r}_k} = \sum ^N_{i=1}\frac{e^{-\beta s(V_i(\mathbf{r}) -E_i^R)}}{\sum ^N_{j=1}{e^{-\beta s (V_j(\mathbf{r})-E_j^R)}}} \left( -\frac{\partial V_i(\mathbf{r})}{\partial \mathbf{r}_k} \right) \,. \end{aligned}$$\end{document}</tex-math><mml:math id="M146" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">f</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo>;</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:mrow><mml:mi>R</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi mathvariant="bold">r</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi>β</mml:mi><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mi>i</mml:mi><mml:mi>R</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi>β</mml:mi><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mi>j</mml:mi><mml:mi>R</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi mathvariant="bold">r</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="10822_2022_445_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>For high <italic>s</italic>-values (close to 1.0), the sampling of the reference state is dominated by the end-state with the lowest value of <inline-formula id="IEq66"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_i(\mathbf{r}) - E_i^R$$\end{document}</tex-math><mml:math id="M148"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mi>i</mml:mi><mml:mi>R</mml:mi></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq66.gif"/></alternatives></inline-formula>, whereas for small <italic>s</italic> values (close to zero), all end-states contribute to the forces, resulting in the so-called “undersampling” [<xref ref-type="bibr" rid="CR15">15</xref>].</p>
        <p id="Par32">The free-energy difference between a pair of end-states in the system is then calculated as,<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \Delta G_{BA} = -\frac{1}{\beta }\ln \frac{\langle e^{-\beta (V_B-V_R)}\rangle _R}{\langle e^{-\beta (V_A-V_R}\rangle _R} \, . \end{aligned}$$\end{document}</tex-math><mml:math id="M150" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="italic">BA</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>β</mml:mi></mml:mfrac><mml:mo>ln</mml:mo><mml:mfrac><mml:msub><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mi>R</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mi>R</mml:mi></mml:msub></mml:mfrac><mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="10822_2022_445_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>In practice, an optimal choice of <italic>s</italic> and <inline-formula id="IEq67"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E_i^R$$\end{document}</tex-math><mml:math id="M152"><mml:msubsup><mml:mi>E</mml:mi><mml:mi>i</mml:mi><mml:mi>R</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq67.gif"/></alternatives></inline-formula> is essential to sufficiently sample all end-states in an EDS simulation. RE-EDS overcomes the difficulty of choosing an optimal <italic>s</italic>-value by simulating multiple replicas with different <italic>s</italic>-values and performing replica exchanges between them [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR64">64</xref>].</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec13">
    <title>Methods</title>
    <sec id="Sec14">
      <title>Validation of the restraint selection algorithm</title>
      <p id="Par33">To assess the performance of the greedy algorithm for selecting optimal distance restraints between two molecules, it was first tested on toy models. These contained 12 to 30 particles that were randomly distributed in space. The particles were randomly assigned to two entities representing two molecules. A selection of four restraints was performed with no pre-processing steps. Different algorithmic approaches were compared: the developed greedy algorithm, an averaged random selection (100 repetitions), and two brute-force approaches. One of the brute-force approaches maximizes the sum of the restraint midpoint distances between the selected restraints by considering all possible quadruples of restraints explicitly (BF-maxD). The other one maximizes the CHV around the selected restraints (BF-maxCHV), as done for chaining in multi-state systems. Each number of particles was sampled 20 times (using different particle coordinates each time) to provide an uncertainty estimate. The scripts for this validation are available in the example folder of the GitHub repository (<italic>examples/publication/a_benchmark_algorithms</italic>).</p>
    </sec>
    <sec id="Sec15">
      <title>Molecules with hydration free energies</title>
      <p id="Par34">The algorithm was applied to the calculation of relative hydration free energies <inline-formula id="IEq68"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta \Delta G_{\text {hyd}}$$\end{document}</tex-math><mml:math id="M154"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mtext>hyd</mml:mtext></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq68.gif"/></alternatives></inline-formula> (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). A set of 16 molecules with experimentally available hydration free energies [<xref ref-type="bibr" rid="CR70">70</xref>–<xref ref-type="bibr" rid="CR75">75</xref>] was selected (Table S1 in the Supporting Information). The topologies for these molecules were taken from the ATB server [<xref ref-type="bibr" rid="CR76">76</xref>]. The selected molecules are small and possess a ring core. The corresponding pairwise transformations are nevertheless relatively complex, and involve R-group and ring-size changes as well as scaffold hopping-type transformations (e.g. benzene to cyclohexane).<fig id="Fig5"><label>Fig. 5</label><caption><p>Thermodynamic cycle for the calculation of relative hydration free energies <inline-formula id="IEq69"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta \Delta G_{\text {hyd}_{AB}}$$\end{document}</tex-math><mml:math id="M156"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:msub><mml:mtext>hyd</mml:mtext><mml:mrow><mml:mi mathvariant="italic">AB</mml:mi></mml:mrow></mml:msub></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq69.gif"/></alternatives></inline-formula>. The direct way to obtain <inline-formula id="IEq70"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta \Delta G_{\text {hyd}_{AB}}$$\end{document}</tex-math><mml:math id="M158"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:msub><mml:mtext>hyd</mml:mtext><mml:mrow><mml:mi mathvariant="italic">AB</mml:mi></mml:mrow></mml:msub></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq70.gif"/></alternatives></inline-formula> employs two absolute free-energy calculations giving <inline-formula id="IEq71"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta G^\text {abs}_{\text {hyd}_A}$$\end{document}</tex-math><mml:math id="M160"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:msub><mml:mtext>hyd</mml:mtext><mml:mi>A</mml:mi></mml:msub><mml:mtext>abs</mml:mtext></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq71.gif"/></alternatives></inline-formula> and <inline-formula id="IEq72"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta G^\text {abs}_{\text {hyd}_B}$$\end{document}</tex-math><mml:math id="M162"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:msub><mml:mtext>hyd</mml:mtext><mml:mi>B</mml:mi></mml:msub><mml:mtext>abs</mml:mtext></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq72.gif"/></alternatives></inline-formula>. The indirect way uses two alchemical or relative free-energy calculations giving <inline-formula id="IEq73"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta G^\text {rel}_{\text {vac}_{AB}}$$\end{document}</tex-math><mml:math id="M164"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:msub><mml:mtext>vac</mml:mtext><mml:mrow><mml:mi mathvariant="italic">AB</mml:mi></mml:mrow></mml:msub><mml:mtext>rel</mml:mtext></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq73.gif"/></alternatives></inline-formula> and <inline-formula id="IEq74"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta G^\text {rel}_{\text {wat}_{AB}}$$\end{document}</tex-math><mml:math id="M166"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:msub><mml:mtext>wat</mml:mtext><mml:mrow><mml:mi mathvariant="italic">AB</mml:mi></mml:mrow></mml:msub><mml:mtext>rel</mml:mtext></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq74.gif"/></alternatives></inline-formula>.</p></caption><graphic xlink:href="10822_2022_445_Fig5_HTML" id="MO14"/></fig></p>
      <p id="Par35">Pairwise TI calculations were carried out with a linked dual topology approach for the 16 molecules in a star-like scheme with molecule <bold>12</bold> as center, resulting in 15 relative hydration free energies (Fig. <xref rid="Fig6" ref-type="fig">6</xref>).<fig id="Fig6"><label>Fig. 6</label><caption><p>Set of 16 molecules with experimental hydration free energies available [<xref ref-type="bibr" rid="CR70">70</xref>–<xref ref-type="bibr" rid="CR76">76</xref>]. The black lines indicate the pairs of molecules for which TI calculations were performed. RestraintMaker was used to select pairwise distance restraints between the central molecule and all others (Fig. S1 in the Supporting Information).</p></caption><graphic xlink:href="10822_2022_445_Fig6_HTML" id="MO15"/></fig></p>
      <p id="Par36">For RE-EDS, two subsets of the 16 molecules were generated. The first subset A contains six molecules with the same benzene core and R-group changes (Fig. <xref rid="Fig7" ref-type="fig">7</xref>a). For this set A, all relative hydration energies were also estimated with pairwise TI calculations. The second subset B consists of ten molecules without a common core, involving more complex transformations such as ring-flexibility changes (Fig. <xref rid="Fig7" ref-type="fig">7</xref>b).<fig id="Fig7"><label>Fig. 7</label><caption><p>Subsets A and B used for the RE-EDS simulations. The black lines indicate the relative hydration free energies that can be extracted. (a): Subset A consists of six molecules with the same benzene core and R-group changes. The distance restraints selected by RestraintMaker are shown in Figs. S2 (TI) and S3 (RE-EDS) in the Supporting Information. (b): Subset B consists of ten molecules without a common core, involving ring-flexibility changes. The distance restraints selected by RestraintMaker are shown in Fig. S4 in the Supporting Information.</p></caption><graphic xlink:href="10822_2022_445_Fig7_HTML" id="MO16"/></fig></p>
    </sec>
    <sec id="Sec16">
      <title>Simulation details</title>
      <p id="Par37">All simulations were carried out using the MD software package GROMOS [<xref ref-type="bibr" rid="CR61">61</xref>] version 1.5.0 (freely available on <italic>http://www.gromos.net</italic>) [<xref ref-type="bibr" rid="CR65">65</xref>], the Python RE-EDS pipeline (<italic>https://github.com/rinikerlab/reeds</italic>) and PyGromosTools [<xref ref-type="bibr" rid="CR77">77</xref>] (<italic>https://github.com/rinikerlab/PyGromosTools</italic>).</p>
      <p id="Par38">In order to compare our results with the absolute hydration free energies reported in the ATB server [<xref ref-type="bibr" rid="CR76">76</xref>], the same simulation setup was used. The simple point-charge (SPC) model [<xref ref-type="bibr" rid="CR78">78</xref>] was employed for water. A single cutoff radius of 1.2 nm was used for the calculation of the non-bonded interactions. The integration time step was set to 2 fs and the pairlist was updated every five steps. Long-range nonbonded interactions were calculated using a reaction-field correction [<xref ref-type="bibr" rid="CR79">79</xref>] with <inline-formula id="IEq75"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varepsilon _{\text {rf}}=1$$\end{document}</tex-math><mml:math id="M168"><mml:mrow><mml:msub><mml:mi>ε</mml:mi><mml:mtext>rf</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq75.gif"/></alternatives></inline-formula> for the simulations in vacuum and <inline-formula id="IEq76"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varepsilon _{\text {rf}}=61$$\end{document}</tex-math><mml:math id="M170"><mml:mrow><mml:msub><mml:mi>ε</mml:mi><mml:mtext>rf</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>61</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq76.gif"/></alternatives></inline-formula> for the simulations in water [<xref ref-type="bibr" rid="CR80">80</xref>]. The force constant for the distance restraints was set to 5000 kJ/(mol<inline-formula id="IEq77"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\cdot $$\end{document}</tex-math><mml:math id="M172"><mml:mo>·</mml:mo></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq77.gif"/></alternatives></inline-formula>nm<inline-formula id="IEq78"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^2)$$\end{document}</tex-math><mml:math id="M174"><mml:mrow><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq78.gif"/></alternatives></inline-formula>.</p>
      <sec id="Sec17">
        <title>Thermodynamic integration</title>
        <p id="Par39">The topologies and coordinate files of the single states were obtained from the ATB server [<xref ref-type="bibr" rid="CR76">76</xref>] and merged to pairs using PyGromosTools [<xref ref-type="bibr" rid="CR77">77</xref>]. The coordinates of the different molecules were aligned to each other using the common molecular skeleton of the molecules (only rings), with the <italic>align</italic> function in RDKit [<xref ref-type="bibr" rid="CR58">58</xref>]. After the alignment, RestraintMaker was used to place four restraints with <inline-formula id="IEq79"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_\text {res} = 0.1$$\end{document}</tex-math><mml:math id="M176"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mtext>res</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq79.gif"/></alternatives></inline-formula> nm (Figs. S1 and S2 in the Supporting Information). The computational boxes for the simulations in water were generated with the GROMOS++ [<xref ref-type="bibr" rid="CR81">81</xref>] program <italic>sim_box</italic> using a minimal solute-to-wall distance of 0.8 nm, and relaxed by energy minimization. The scripts can be found in the example folder on Github (<ext-link ext-link-type="uri" xlink:href="https://github.com/rinikerlab/restraintmaker/tree/main/examples/publication/b_ATB_solvationFreeEnergies">https://github.com/rinikerlab/restraintmaker/tree/main/examples/publication/b_ATB_solvationFreeEnergies</ext-link>). The TI calculations were carried out with at 21 evenly spaced <inline-formula id="IEq80"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda $$\end{document}</tex-math><mml:math id="M178"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq80.gif"/></alternatives></inline-formula>-points between 0 and 1, for both the molecules in water and in vacuum. Each <inline-formula id="IEq81"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda $$\end{document}</tex-math><mml:math id="M180"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq81.gif"/></alternatives></inline-formula>-point was equilibrated for 1 ns, followed by a production run of 5 ns. The free-energy differences were calculated using the Simpson integration implemented in the SciPy library [<xref ref-type="bibr" rid="CR82">82</xref>].</p>
      </sec>
      <sec id="Sec18">
        <title>RE-EDS</title>
        <p id="Par40">The merged topologies for the RE-EDS calculations were prepared using PyGromosTools [<xref ref-type="bibr" rid="CR77">77</xref>], and the simulations were set-up using the RE-EDS pipeline [<xref ref-type="bibr" rid="CR65">65</xref>]. The individual steps of the pipeline are described in detail in Ref. [<xref ref-type="bibr" rid="CR65">65</xref>]. The coordinates of the molecules were aligned to reference molecule <bold>1</bold> (Fig. <xref rid="Fig6" ref-type="fig">6</xref>). The RDKit [<xref ref-type="bibr" rid="CR58">58</xref>] was used to determine the pairwise MCSs (using the molecular skeleton of the rings only) and align the molecules based on it. For some molecules, manual modifications were applied to ensure an optimal overlap of the ring atoms and substituents. The corresponding script is available in the example folder on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/rinikerlab/restraintmaker/blob/main/examples/publication/b_ATB_solvationFreeEnergies/sets/multistate/prepare_distance_restraints.py">https://github.com/rinikerlab/restraintmaker/blob/main/examples/publication/b_ATB_solvationFreeEnergies/sets/multistate/prepare_distance_restraints.py</ext-link>). The RestraintMaker was then used to select the distance restraints to connect the molecules in a chain using analogous parameters as for the pairwise restraints for TI (Figs. S3 and S4 in the Supporing Information).</p>
        <p id="Par41">For subset A (Fig. <xref rid="Fig7" ref-type="fig">7</xref>a), six EDS simulations of 2 ns length were carried out with <inline-formula id="IEq82"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s=1.0$$\end{document}</tex-math><mml:math id="M182"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1.0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq82.gif"/></alternatives></inline-formula> in vacuum/water to generate optimized configurations for the starting state mixing (SSM) [<xref ref-type="bibr" rid="CR65">65</xref>]. Each of the six simulations was biased towards one of the end-states by setting the energy offset of that end-state to 500 kJ mol<inline-formula id="IEq83"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{-1}$$\end{document}</tex-math><mml:math id="M184"><mml:msup><mml:mrow/><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq83.gif"/></alternatives></inline-formula> and the energy offsets of the other end-states in the same simulation to – 500 kJ mol<inline-formula id="IEq84"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{-1}$$\end{document}</tex-math><mml:math id="M186"><mml:msup><mml:mrow/><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq84.gif"/></alternatives></inline-formula>. Subsequently, 21 EDS simulations were carried out for 0.2 ns with <italic>s</italic>-values distributed logarithmically between 1 and <inline-formula id="IEq85"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10^{-5}$$\end{document}</tex-math><mml:math id="M188"><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq85.gif"/></alternatives></inline-formula> to determine the lower bound for the RE-EDS simulations (0.00316 in vacuum and 0.001 in water). Next, the energy offsets were estimated from a 0.8 ns RE-EDS simulation, with 12 replicas in vacuum, and 14 replicas in water. In vacuum, one <italic>s</italic>-optimization step of 0.5 ns length adding four replicas was sufficient to achieve frequent round trips and good sampling of all end-states. In water, three <italic>s</italic>-optimization steps of 0.5 ns, 1.0 ns and 1.5 ns, respectively, were carried out to achieve frequent round trips. At each step, five replicas were added. Additionally, in water, the energy offsets were rebalanced over three 0.5 ns simulations to optimize the sampling of all end-states. Energy-offset rebalancing was not necessary in vacuum as all end-states were already sampled well after the <italic>s</italic>-optimization. The production run was 0.5 ns long in vacuum and 1.0 ns in water.</p>
        <p id="Par42">For subset B, ten EDS simulations of 2 ns were performed in vacuum/water to generate optimized configurations analogously to set A. The determination of the lower bounds was carried out as above (0.00178 in vacuum and 0.001 in water). For the energy offset estimation, a 0.8 ns RE-EDS simulation was used again, with 17 replicas in vacuum and 18 replicas in water. In vacuum, one <italic>s</italic>-optimization step of 0.5 ns length adding four replicas was also sufficient. In water, five <italic>s</italic>-optimization steps of 0.5 ns, 1.0 ns, 1.5 ns, 1.5 ns, and 1.5 ns, respectively, were carried out to achieve frequent round trips. At each step, five replicas were added. In water, the energy offsets were rebalanced over five 0.5 ns simulations. The production run was 1.0 ns long in vacuum and 5.0 ns in water.</p>
      </sec>
    </sec>
    <sec id="Sec19">
      <title>Analysis</title>
      <p id="Par43">The analysis of the simulations was carried using GROMOS++ [<xref ref-type="bibr" rid="CR81">81</xref>] and PyGromosTools [<xref ref-type="bibr" rid="CR77">77</xref>]. In addition, the following Python packages were employed for the statistical analysis and plotting: Pandas [<xref ref-type="bibr" rid="CR83">83</xref>], Matplotlib [<xref ref-type="bibr" rid="CR84">84</xref>], NumPy [<xref ref-type="bibr" rid="CR85">85</xref>], SciPy [<xref ref-type="bibr" rid="CR82">82</xref>], mpmath [<xref ref-type="bibr" rid="CR86">86</xref>], and Jupyter notebooks [<xref ref-type="bibr" rid="CR87">87</xref>].</p>
    </sec>
  </sec>
  <sec id="Sec20">
    <title>Results and discussions</title>
    <sec id="Sec21">
      <title>Validation of the restraint selection algorithm</title>
      <p id="Par44">As a greedy algorithm, the approach in RestraintMaker might lead to sub-optimal solutions. To test this, the performance of the algorithm was compared with that of two brute-force approaches. One brute-force approach, BF-maxD, maximizes the distance of all selected restraint midpoints to each other, whereas the second brute-force approach, BF-maxCHV, maximises instead the CHV spanned by the selected restraint midpoints. Toy systems consisting of two strongly overlapping particle clouds were constructed, for which four restraints should be selected. The systems varied in the number of randomly placed particles. Each particle mimics an atom of a hypothetical molecule that might be selected to be restrained.</p>
      <p id="Par45">The advantage of the greedy algorithm is evident when considering the time complexity as the brute-force approaches scale with <inline-formula id="IEq86"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal O(N^4)$$\end{document}</tex-math><mml:math id="M190"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mn>4</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq86.gif"/></alternatives></inline-formula> (where <italic>N</italic> is the number of atoms), making them unusable for larger molecules (Fig. <xref rid="Fig8" ref-type="fig">8</xref>a). For selecting four restraints in the 20 particles toy system, the BF-maxCHV requires 75 s (single core), and 3325 s for 30 particles. In comparison, the greedy algorithm requires only 0.031 s for the 30 particles.<fig id="Fig8"><label>Fig. 8</label><caption><p>Comparison of algorithms to select distance restraints on toy systems. (Top left): Time complexity as a function of the number of particles in the system for the brute-force approaches BF-maxCHV (red) and BF-maxD (blue), and the greedy algorithm (yellow). (Top right):): Distance metric as a function of the number of particles in the system for the brute-force approaches (red and blue), the greedy algorithm (yellow), and random selection with 100 trials (purple). (Middle): CHV as a function of the number of particles in the system. (d and e): Final distance restraints selected by the greedy algorithm for 12 (bottom left) and 30 (bottom right) particles. The restrained atoms are colored in green, red, pink and rose, and connected by yellow dashed lines. The two particle clouds are colored in wheat and light blue.</p></caption><graphic xlink:href="10822_2022_445_Fig8_HTML" id="MO17"/></fig></p>
      <p id="Par46">Comparison of the sum of all distances between restraint midpoints shows that BF-maxD (optimizing for the maximal distance between all midpoints of the selected restraints) yields the best results with the largest distances (blue line in Fig. <xref rid="Fig8" ref-type="fig">8</xref>b). The second brute-force algorithm BF-maxCHV (optimizing for the CHV defined by the restraint midpoints) and our greedy algorithm give comparable results to BF-maxD. All three approaches are very good at maximizing the distance between the selected restraints. Random selection with 100 trials (negative control), on the other hand, performs significantly worse. Second, we compared the approaches based on the CHV generated by the selected restraints (Fig. <xref rid="Fig8" ref-type="fig">8</xref>c). Here, the BF-maxCHV approach yields the best results as expected, while BF-maxD and the greedy algorithm perform similar to each other. The difference in CHV between the latter two approaches and BF-maxCHV increases with increasing number of particles in the toy system. This may be due to the growing number of possible choices, or due to the fact that the distance metric used in BF-maxD and the greedy algorithms is suboptimal. All approaches clearly outperform random selection. The greedy algorithm in RestraintMaker can thus be seen as a trade-off between optimizing a metric (distance or CHV) and limiting the required computing time. It is the fastest algorithm among the ones tested and yields comparable results to the brute-force approaches.</p>
    </sec>
    <sec id="Sec22">
      <title>Calculation of relative hydration free energies</title>
      <sec id="Sec23">
        <title>Thermodynamic integration</title>
        <p id="Par47">To assess the quality of the selected distance restraints, the greedy algorithm in RestraintMaker was tested with a set of 16 small molecules with experimentally available hydration free energies. First, the relative hydration free energies were calculated between molecule <bold>12</bold> and the 15 other molecules using TI (Fig. <xref rid="Fig6" ref-type="fig">6</xref>). The resulting <inline-formula id="IEq87"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta \Delta G_\text {hyd}^\text {TI,indirect}$$\end{document}</tex-math><mml:math id="M192"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:mtext>hyd</mml:mtext><mml:mtext>TI,indirect</mml:mtext></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq87.gif"/></alternatives></inline-formula> agree very well with the experimental values [<xref ref-type="bibr" rid="CR70">70</xref>–<xref ref-type="bibr" rid="CR75">75</xref>], with a root-mean-square error (RMSE) of 4.1 kJ/mol, a mean absolute error (MAE) of 3.1 kJ/mol (Fig. <xref rid="Fig9" ref-type="fig">9</xref>, left) and a Spearman correlation coefficient <inline-formula id="IEq88"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_{\text {Spearman}}$$\end{document}</tex-math><mml:math id="M194"><mml:msub><mml:mi>r</mml:mi><mml:mtext>Spearman</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq88.gif"/></alternatives></inline-formula> of 0.87. The numerical values are reported in Table S2 in the Supporting Information, and the corresponding <inline-formula id="IEq89"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\langle \partial V(\lambda )/\partial \lambda \rangle $$\end{document}</tex-math><mml:math id="M196"><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mi>∂</mml:mi><mml:mi>V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mi>∂</mml:mi><mml:mi>λ</mml:mi><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq89.gif"/></alternatives></inline-formula> curves in water and vacuum in Figs. S5 and S6.</p>
        <p id="Par48">For comparison, <inline-formula id="IEq90"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta \Delta G_{hyd}^\text {TI,direct}$$\end{document}</tex-math><mml:math id="M198"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="italic">hyd</mml:mi></mml:mrow><mml:mtext>TI,direct</mml:mtext></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq90.gif"/></alternatives></inline-formula> values were derived from the calculated absolute hydration free energies reported in the ATB server [<xref ref-type="bibr" rid="CR76">76</xref>], which were carried out with TI using the same topologies. The <inline-formula id="IEq91"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta \Delta G_{hyd}^{TI,direct}$$\end{document}</tex-math><mml:math id="M200"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="italic">hyd</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>I</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq91.gif"/></alternatives></inline-formula> values deviate slightly more from experiment with an RMSE of 6.7 kJ/mol, a MAE of 5.5 kJ/mol and a <inline-formula id="IEq92"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_{\text {Spearman}}$$\end{document}</tex-math><mml:math id="M202"><mml:msub><mml:mi>r</mml:mi><mml:mtext>Spearman</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq92.gif"/></alternatives></inline-formula> of 0.84 (Fig. <xref rid="Fig9" ref-type="fig">9</xref>, center). Generally, the results of the direct [<xref ref-type="bibr" rid="CR76">76</xref>] and indirect TI calculations agree well with each other (Fig. <xref rid="Fig9" ref-type="fig">9</xref>, right). Note that for the molecule pair <bold>5</bold>–<bold>12</bold>, a similarly large deviation from experiment is observed in both types of TI calculations (10.7 kJ/mol and 12.1 kJ/mol, respectively), suggesting either a force-field deficiency or a problematic experimental value.<fig id="Fig9"><label>Fig. 9</label><caption><p>Comparison of the relative hydration free energies <inline-formula id="IEq93"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta \Delta G_{hyd}$$\end{document}</tex-math><mml:math id="M204"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="italic">hyd</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq93.gif"/></alternatives></inline-formula> (with molecule <bold>12</bold> as reference) for the 16 small molecules between experiment (exp), the pairwise relative free-energy calculations with TI and linked dual topology (TI, indirect), and the absolute free-energy calculations with TI taken from the ATB server [<xref ref-type="bibr" rid="CR76">76</xref>] (TI, direct). The numerical values are given in Table S2 in the Supporting Information.</p></caption><graphic xlink:href="10822_2022_445_Fig9_HTML" id="MO18"/></fig></p>
        <p id="Par49">It is crucial for the linked dual-topology approach that the applied distance restraints do not distort the conformational sampling of the molecules. For this, the relative translational motion of the two aligned molecules was analyzed for each <inline-formula id="IEq94"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda $$\end{document}</tex-math><mml:math id="M206"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq94.gif"/></alternatives></inline-formula>-window and molecule pair by calculating the fluctuation of the distance between the COGs of the restrained atoms in the central rings of the two molecules. Figure <xref rid="Fig10" ref-type="fig">10</xref> shows both the standard deviation and the maximum observed distance between the two COGs. The standard deviation is close to zero for all pairs, indicating that the two cores overlap well given the chosen restraints. The maximum distances are around 0.03 nm. For the pair <bold>7</bold>–<bold>12</bold>, the distances are slightly higher, which results from the fact that molecule <bold>7</bold> is a bridged bicycle. The force constant of 5000 kJ/(mol<inline-formula id="IEq95"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\cdot $$\end{document}</tex-math><mml:math id="M208"><mml:mo>·</mml:mo></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq95.gif"/></alternatives></inline-formula>nm<inline-formula id="IEq96"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^2)$$\end{document}</tex-math><mml:math id="M210"><mml:mrow><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq96.gif"/></alternatives></inline-formula> for the distance restraints is found to represent a good compromise to ensure a tight overlap of the molecules without significantly perturbing their conformations. Note that the range of reasonable force constants is rather large and only for extremely high values (i.e. 50’000 kJ/(mol<inline-formula id="IEq97"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\cdot $$\end{document}</tex-math><mml:math id="M212"><mml:mo>·</mml:mo></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq97.gif"/></alternatives></inline-formula>nm<inline-formula id="IEq98"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^2)$$\end{document}</tex-math><mml:math id="M214"><mml:mrow><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq98.gif"/></alternatives></inline-formula> or larger), does the restraining affect the free-energy results.<fig id="Fig10"><label>Fig. 10</label><caption><p>Standard deviation of the distance distribution (blue) and maximum distance (red) between the COGs of the central rings of the molecule pairs in the TI simulations in water. The COG was calculated for the restrained atoms in the rings. The horizontal axis shows for each molecule pair the different <inline-formula id="IEq99"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda $$\end{document}</tex-math><mml:math id="M216"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq99.gif"/></alternatives></inline-formula>-windows between 0 and 1.</p></caption><graphic xlink:href="10822_2022_445_Fig10_HTML" id="MO19"/></fig></p>
        <p id="Par50">A similar analysis was carried out for the relative rotational motions of the molecules, considering the restrained atoms in the molecule pairs (Fig. <xref rid="Fig11" ref-type="fig">11</xref>). In terms of the three Euler angles, a maximum relative rotation of <inline-formula id="IEq100"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$6.3^\circ $$\end{document}</tex-math><mml:math id="M218"><mml:mrow><mml:mn>6</mml:mn><mml:mo>.</mml:mo><mml:msup><mml:mn>3</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq100.gif"/></alternatives></inline-formula> was observed, which is reasonably small for one dimension. The largest fluctuation was again observed for the pair <bold>7</bold>–<bold>12</bold>. The rotation around the <italic>z</italic>-axis shows significantly smaller deviations compared to the other dimensions, because the two molecules need to rotate against each other in plane. In contrast, the rotations around the <italic>x</italic> and <italic>y</italic>-axis correspond to a relative tilt of the molecules, which is easier to realize.<fig id="Fig11"><label>Fig. 11</label><caption><p>Fraction <italic>f</italic> of frames in the TI simulations in water, in which the relative rotation around the <italic>x</italic>-axis (yellow), <italic>y</italic>-axis (purple), and <italic>z</italic>-axis (red) of the central rings of the molecule pair exceeds <inline-formula id="IEq101"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5^{\circ }$$\end{document}</tex-math><mml:math id="M220"><mml:msup><mml:mn>5</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq101.gif"/></alternatives></inline-formula>. The horizontal axis shows for each molecule pair the different <inline-formula id="IEq102"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda $$\end{document}</tex-math><mml:math id="M222"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq102.gif"/></alternatives></inline-formula>-windows between 0 and 1.</p></caption><graphic xlink:href="10822_2022_445_Fig11_HTML" id="MO20"/></fig></p>
        <p id="Par51">While most of the molecule pairs in Fig. <xref rid="Fig6" ref-type="fig">6</xref> have the same central benzene core, the transformations from molecule <bold>12</bold> to molecules <bold>2</bold> and <bold>3</bold> involve the change from benzene to cyclohexane or cyclohexene, respectively. To assess whether the applied distance restraints affect the conformational sampling of the aliphatic ring, the distributions of the three pseudo torsional angles (Pickett and Strauss coordinates [<xref ref-type="bibr" rid="CR88">88</xref>]) were monitored in the simulation at <inline-formula id="IEq103"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda =1.0$$\end{document}</tex-math><mml:math id="M224"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>1.0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq103.gif"/></alternatives></inline-formula>, and compared to plain MD simulations of molecules <bold>2</bold> and <bold>3</bold> in vacuum and in water (Fig. <xref rid="Fig12" ref-type="fig">12</xref>). In both cases, the distributions showed nearly perfect overlap, indicating that the sampling is not affected by the distance restraints in the linked dual topology.<fig id="Fig12"><label>Fig. 12</label><caption><p>Comparison of the normalized torsional angle distributions of the three pseudo torsional angles of the aliphatic ring of molecules <bold>2</bold> (top) and <bold>3</bold> (bottom) in the TI calculation at <inline-formula id="IEq104"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda =1.0$$\end{document}</tex-math><mml:math id="M226"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>1.0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq104.gif"/></alternatives></inline-formula> (filled) and in plain MD simulations (dark red line) in vacuum (top) and in water (bottom).</p></caption><graphic xlink:href="10822_2022_445_Fig12_HTML" id="MO21"/></fig></p>
        <p id="Par52">A similar analysis of the torsional angle distributions was also carried out for the substituents of molecules <bold>1</bold>, <bold>6</bold> and <bold>9</bold> (Fig. S8 in the Supporting Information). Again, no major differences are observed between <inline-formula id="IEq105"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda =1.0$$\end{document}</tex-math><mml:math id="M228"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>1.0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq105.gif"/></alternatives></inline-formula> and the plain simulations.</p>
      </sec>
      <sec id="Sec24">
        <title>Multi-state simulations with RE-EDS</title>
        <p id="Par53">Multi-state simulations were performed with RE-EDS for the two subsets A and B (Fig. <xref rid="Fig7" ref-type="fig">7</xref>). The distance restraints were selected with the developed algorithm using the CHV approach, connecting always one molecule with two others.</p>
        <p id="Par54">Subset A consists of six molecules. To be able to directly compare with the <inline-formula id="IEq106"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta \Delta G_{hyd}$$\end{document}</tex-math><mml:math id="M230"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="italic">hyd</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq106.gif"/></alternatives></inline-formula> values from RE-EDS, TI calculations were also performed for the 15 pairwise transformations in Fig. <xref rid="Fig7" ref-type="fig">7</xref>a. The results using RE-EDS and TI agree very well with each other as well as with experiment (Fig. <xref rid="Fig13" ref-type="fig">13</xref>), with an RMSE of 3.8 kJ/mol and a MAE of 3.0 kJ/mol for TI, and an RMSE of 3.6 kJ/mol and a MAE of 2.9 kJ/mol for RE-EDS. The numerical values are reported in Table S3 in the Supporting Information. For both methods, the Spearman correlation coefficient is 0.93, indicating high correlation with experiment. The highest deviations from experiment are observed for the molecule pair <bold>6</bold>–<bold>11</bold> for both relative methods with deviations of 8.3 kJ/mol and 7.5 kJ/mol, respectively. For comparison, <inline-formula id="IEq107"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta \Delta G_\text {hyd}^\text {TI,direct}$$\end{document}</tex-math><mml:math id="M232"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:mtext>hyd</mml:mtext><mml:mtext>TI,direct</mml:mtext></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq107.gif"/></alternatives></inline-formula> were derived from the absolute hydration free energies reported in the ATB server [<xref ref-type="bibr" rid="CR76">76</xref>], giving an RMSE of 6.2 kJ/mol and a MAE of 5.3 kJ/mol. The Spearman correlation coefficient is almost identical with a value of 0.92. In this case, the highest deviations from experiment are observed for the molecule pairs <bold>1</bold>–<bold>11</bold> and <bold>6</bold>–<bold>11</bold>, with deviations of 11.1 kJ/mol and 11.3 kJ/mol, respectively.</p>
        <p id="Par55">These results highlight the advantage of using RE-EDS for relative free-energy calculations (Table <xref rid="Tab1" ref-type="table">1</xref>). The accuracy of the results is similar for TI and RE-EDS, but RE-EDS is considerably more efficient with a total simulation time (pre-processing plus production) of about 260 ns. Using TI, a total simulation time (equilibration plus production) of about 3800 ns was required for calculating all 15 pairs in subset A. This time can of course be reduced to about 1265 ns when calculating only the minimal number of five pairs. In addition, the length of the production runs could be reduced from 5 to 3 ns for many pairs, without affecting convergence. However, even with these reductions, the total required simulation time with TI is still about three times longer than with RE-EDS. The convergence for both methods is shown in Figs. S7 and S9 in the Supporting Information.<fig id="Fig13"><label>Fig. 13</label><caption><p>Comparison of the relative hydration free energies <inline-formula id="IEq108"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta \Delta G_{hyd}$$\end{document}</tex-math><mml:math id="M234"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="italic">hyd</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq108.gif"/></alternatives></inline-formula> for the six molecules in subset A between experiment (exp), the multi-state relative free-energy calculations with RE-EDS and linked dual topology (RE-EDS, indirect), the pairwise relative calculations with TI and linked dual topology (TI, indirect), and the absolute free-energy calculations with TI taken from the ATB server [<xref ref-type="bibr" rid="CR76">76</xref>] (TI, direct). The corresponding statistical metrics are reported in Table <xref rid="Tab1" ref-type="table">1</xref>. The numerical values are given in Table S3 in the Supporting Information.</p></caption><graphic xlink:href="10822_2022_445_Fig13_HTML" id="MO22"/></fig><table-wrap id="Tab1"><label>Table 1</label><caption><p>Comparison of statistical metrics (RMSE, MAE, and Spearman correlation coefficient relative to experiment) as well as the accumulated simulation time between the different free-energy methods. The simulation time is split into preparation (pre-processing, equilibration) and production run. For relative TI calculations, the time for the minimal number of pairs is reported (five for subset A, and nine for subset B). Calculated absolute hydration free-energies were taken from the ATB server [<xref ref-type="bibr" rid="CR76">76</xref>] to calculate the relative hydration free energies <inline-formula id="IEq109"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta \Delta G_{hyd}^{direct}$$\end{document}</tex-math><mml:math id="M236"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="italic">hyd</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">direct</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq109.gif"/></alternatives></inline-formula>. The uncertainty for the RMSE values was estimated by a 100 times iterated bootstrap approach. The corresponding correlations are shown graphically in Figs. <xref rid="Fig9" ref-type="fig">9</xref>, <xref rid="Fig13" ref-type="fig">13</xref> and <xref rid="Fig14" ref-type="fig">14</xref>.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left" colspan="3">Subset A</th><th align="left" colspan="3">Subset B</th></tr><tr><th align="left"/><th align="left"><inline-formula id="IEq110"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta \Delta G^{direct}_{hyd}$$\end{document}</tex-math><mml:math id="M238"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="italic">hyd</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">direct</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq110.gif"/></alternatives></inline-formula></th><th align="left" colspan="2"><inline-formula id="IEq111"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta \Delta G^{indirect}_{hyd}$$\end{document}</tex-math><mml:math id="M240"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="italic">hyd</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">indirect</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq111.gif"/></alternatives></inline-formula></th><th align="left"><inline-formula id="IEq112"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta \Delta G^{direct}_{hyd}$$\end{document}</tex-math><mml:math id="M242"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="italic">hyd</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">direct</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq112.gif"/></alternatives></inline-formula></th><th align="left" colspan="2"><inline-formula id="IEq113"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta \Delta G^{indirect}_{hyd}$$\end{document}</tex-math><mml:math id="M244"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="italic">hyd</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">indirect</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq113.gif"/></alternatives></inline-formula></th></tr><tr><th align="left"/><th align="left">TI [<xref ref-type="bibr" rid="CR76">76</xref>]</th><th align="left">TI</th><th align="left">RE-EDS</th><th align="left">TI [<xref ref-type="bibr" rid="CR76">76</xref>]</th><th align="left">TI</th><th align="left">RE-EDS</th></tr></thead><tbody><tr><td align="left">RMSE <inline-formula id="IEq114"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[\text {kJ/mol}]$$\end{document}</tex-math><mml:math id="M246"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mtext>kJ/mol</mml:mtext><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq114.gif"/></alternatives></inline-formula></td><td align="left">6.2 ± 0.3</td><td align="left">3.7 ± 0.1</td><td align="left">3.6 ± 0.3</td><td align="left">5.8 ± 0.1</td><td align="left">3.4 ± 0.1</td><td align="left">3.3 ± 0.1</td></tr><tr><td align="left">MAE <inline-formula id="IEq115"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[\text {kJ/mol}]$$\end{document}</tex-math><mml:math id="M248"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mtext>kJ/mol</mml:mtext><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq115.gif"/></alternatives></inline-formula></td><td align="left">5.3 ± 3.2</td><td align="left">3.0 ± 2.1</td><td align="left">3.0 ± 2.2</td><td align="left">4.8 ± 3.3</td><td align="left">2.8 ± 2.0</td><td align="left">2.7 ± 1.8</td></tr><tr><td align="left"><inline-formula id="IEq116"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text {r}_{\text {Spearman}}$$\end{document}</tex-math><mml:math id="M250"><mml:msub><mml:mtext>r</mml:mtext><mml:mtext>Spearman</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq116.gif"/></alternatives></inline-formula></td><td align="left">0.92</td><td align="left">0.93</td><td align="left">0.93</td><td align="left">0.93</td><td align="left">0.96</td><td align="left">0.96</td></tr><tr><td align="left"><inline-formula id="IEq117"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text {t}_{\text {preparation}}~[\text {ns}]$$\end{document}</tex-math><mml:math id="M252"><mml:mrow><mml:msub><mml:mtext>t</mml:mtext><mml:mtext>preparation</mml:mtext></mml:msub><mml:mspace width="3.33333pt"/><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mtext>ns</mml:mtext><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq117.gif"/></alternatives></inline-formula></td><td align="left">−</td><td align="left">215</td><td align="left">222</td><td align="left">−</td><td align="left">378</td><td align="left">418</td></tr><tr><td align="left"><inline-formula id="IEq118"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text {t}_{\text {production}}~[\text {ns}]$$\end{document}</tex-math><mml:math id="M254"><mml:mrow><mml:msub><mml:mtext>t</mml:mtext><mml:mtext>production</mml:mtext></mml:msub><mml:mspace width="3.33333pt"/><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mtext>ns</mml:mtext><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq118.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq119"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$42-102$$\end{document}</tex-math><mml:math id="M256"><mml:mrow><mml:mn>42</mml:mn><mml:mo>-</mml:mo><mml:mn>102</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq119.gif"/></alternatives></inline-formula></td><td align="left">1050</td><td align="left">36</td><td align="left"><inline-formula id="IEq120"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$70-170$$\end{document}</tex-math><mml:math id="M258"><mml:mrow><mml:mn>70</mml:mn><mml:mo>-</mml:mo><mml:mn>170</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq120.gif"/></alternatives></inline-formula></td><td align="left">1890</td><td align="left">212</td></tr></tbody></table></table-wrap></p>
        <p id="Par56">As for the pairwise TI calculations, the effect of the applied distance restraints on the conformational sampling in the RE-EDS simulations was evaluated. Both the translational and rotational fluctuations of the COGs of the central rings are comparable to those observed in the TI calculations (Figs. S10 and S11 in the Supporting Information). Similarly, the reweighted torsional angle distributions of the substituents of molecules <bold>1</bold>, <bold>6</bold> and <bold>9</bold> agree well with those from plain MD simulations (Fig. S12 in the Supporting Information).</p>
        <p id="Par57">RE-EDS simulations were also performed with the second subset B, consisting of ten molecules (Fig. <xref rid="Fig7" ref-type="fig">7</xref>b). For comparison, the results calculated from the minimal number of nine molecule pairs were taken from the previous TI calculations (i.e., with molecule <bold>12</bold> at the center). The results were used to estimate the remaining 36 <inline-formula id="IEq121"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta \Delta G_\text {hyd}^\text {TI,indirect}$$\end{document}</tex-math><mml:math id="M260"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:mtext>hyd</mml:mtext><mml:mtext>TI,indirect</mml:mtext></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq121.gif"/></alternatives></inline-formula> values. As for subset A, the results with RE-EDS and TI agree very well with each other and also with experiment (Fig. <xref rid="Fig14" ref-type="fig">14</xref>), with an RMSE of 3.4 kJ/mol and a MAE of 2.8 kJ/mol for TI, and an RMSE of 3.3 kJ/mol and a MAE of 2.7 kJ/mol for RE-EDS. The Spearman correlation coefficient with experiment is 0.96 for both methods. The highest deviations from experiment are observed for the molecule pairs <bold>14</bold>–<bold>9</bold>, <bold>14</bold>–<bold>10</bold>, <bold>15</bold> - <bold>10</bold>, and <bold>16</bold> - <bold>14</bold> for both methods, with absolute deviations between 6.1 and 6.9 kJ/mol. For comparison, the <inline-formula id="IEq122"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta \Delta G_\text {hyd}^\text {TI,direct}$$\end{document}</tex-math><mml:math id="M262"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:mtext>hyd</mml:mtext><mml:mtext>TI,direct</mml:mtext></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq122.gif"/></alternatives></inline-formula> values were again derived from the absolute hydration free energies reported in the ATB server [<xref ref-type="bibr" rid="CR76">76</xref>], giving an RMSE of 5.8 kJ/mol and a MAE of 4.8 kJ/mol. The Spearman correlation coefficient is almost identical with a value of 0.93. In this case, the highest deviations from experiment are observed for the molecule pairs <bold>10</bold>–<bold>1</bold>, <bold>10</bold>–<bold>3</bold>, <bold>10</bold>–<bold>6</bold>, <bold>14</bold>–<bold>10</bold>, <bold>14</bold> - <bold>12</bold>, and <bold>15</bold>–<bold>10</bold>, with absolute deviations between 9.1 and 10.7 kJ/mol.<fig id="Fig14"><label>Fig. 14</label><caption><p>Comparison of the relative hydration free energies <inline-formula id="IEq123"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta \Delta G_\text {hyd}$$\end{document}</tex-math><mml:math id="M264"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mtext>hyd</mml:mtext></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq123.gif"/></alternatives></inline-formula> for the six molecules in subset B between experiment (exp), the multi-state relative free-energy calculations with RE-EDS and linked dual topology (RE-EDS, indirect), the pairwise relative calculations with TI and linked dual topology (TI, indirect), and the absolute free-energy calculations with TI taken from the ATB server [<xref ref-type="bibr" rid="CR76">76</xref>] (TI, direct).</p></caption><graphic xlink:href="10822_2022_445_Fig14_HTML" id="MO23"/></fig></p>
        <p id="Par58">For the RE-EDS simulations, a total simulation time of about 630 ns was used for subset B, yielding all 45 <inline-formula id="IEq124"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta \Delta G_{hyd}$$\end{document}</tex-math><mml:math id="M266"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="italic">hyd</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq124.gif"/></alternatives></inline-formula> values simultaneously (Table <xref rid="Tab1" ref-type="table">1</xref>). When simulating the minimal number of nine molecule pairs with TI, the total simulation time was about 2000 ns (or about 1100 ns with 3 ns production runs). The convergence for both methods is shown in Figs. S7 and S13 in the Supporting Information.</p>
        <p id="Par59">The analyses of the conformational sampling effect of the applied distance restraints in the RE-EDS simulations of subset B are shown in Figs. S14 and S15 in the Supporting Information. Again the effect is negligible. The reweighted distributions of the three pseudo torsional angles of the cyclohexane ring of molecule <bold>3</bold> agree very well with the distributions from plain MD simulations (Fig. <xref rid="Fig15" ref-type="fig">15</xref>). The second peak visible in the raw RE-EDS simulations (i.e. not reweighted) comes from the frames where molecule <bold>3</bold> is in the dummy state (Fig. S16 in the Supporting Information).<fig id="Fig15"><label>Fig. 15</label><caption><p>Comparison of the normalized torsional angle distributions of the three pseudo torsional angles of the cyclohexane ring of molecule <bold>3</bold> in the RE-EDS simulation at <inline-formula id="IEq125"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s=1.0$$\end{document}</tex-math><mml:math id="M268"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1.0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq125.gif"/></alternatives></inline-formula> (filled) and in plain MD simulations (dark red line) in vacuum (top) and in water (bottom). Both the raw (yellow) and the reweighted (with <inline-formula id="IEq126"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e^{\beta (V_R - V_i)}$$\end{document}</tex-math><mml:math id="M270"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>β</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq126.gif"/></alternatives></inline-formula>, cyan) distributions are shown for RE-EDS.</p></caption><graphic xlink:href="10822_2022_445_Fig15_HTML" id="MO24"/></fig></p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec25">
    <title>Conclusions</title>
    <p id="Par60">In this work, we presented an efficient greedy algorithm for the (locally) optimal placement of distance restraints in free-energy calculations performed with the linked dual topology approach. Linked dual topologies have the advantage that larger transformations can be simulated in a straightforward manner (e.g. no soft bonds are required), while reducing the sampling complexity. With the developed RestraintMaker Python package, distance restraint sets can be selected from a script or at GUI level, and written out in the GROMOS and GROMACS formats or in JSON format. The greedy algorithm is a graph-based approach and can be straightforwardly applied to molecules with (semi)rigid cores (typically aromatic or aliphatic rings). The cores do not necessarily have to be the same for all molecules, allowing for more complex transformations between ligands. The only required user inputs are the number of restraints <inline-formula id="IEq127"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_\text {res}$$\end{document}</tex-math><mml:math id="M272"><mml:msub><mml:mi>n</mml:mi><mml:mtext>res</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq127.gif"/></alternatives></inline-formula> to be selected and the maximum distance between the restrained atoms (<inline-formula id="IEq128"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_\text {res}$$\end{document}</tex-math><mml:math id="M274"><mml:msub><mml:mi>d</mml:mi><mml:mtext>res</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="10822_2022_445_Article_IEq128.gif"/></alternatives></inline-formula>) . The performance of the algorithm was evaluated using toy systems (particle clouds) and compared to two brute-force approaches. In view of the results, the greedy algorithm represents a good trade-off between computing time and accuracy.</p>
    <p id="Par61">RestraintMaker was used to select optimal distance restraints for the calculation of relative hydration free energies with both TI (pairwise) and RE-EDS (multi-state). In all cases, good agreement between the different free-energy methods and with experiment was observed. Detailed analysis of the conformational sampling also indicated that the effect of the possible distortions induced by the distance restraints on the conformations is negligible. Even when restraining the benzene core and the cyclohexane core of two molecules together, accurate free-energy differences were obtained and the distributions of the pseudo torsional angles of the cyclohexane ring were nearly identical with those from plain MD simulations. The results obtained with RE-EDS highlight the superior sampling efficiency of the method. The application of RestraintMaker to estimate binding free energies with RE-EDS is currently ongoing and will be presented in future work.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec01">
      <p>Below is the link to the electronic supplementary material.<supplementary-material content-type="local-data" id="MOESM1"><media xlink:href="10822_2022_445_MOESM1_ESM.pdf"><caption><p>Supplementary file1 (PDF 2849 kb)</p></caption></media></supplementary-material></p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Benjamin Ries and Salomé Rieder have contributed equally to this paper.</p>
    </fn>
    <fn>
      <p>
        <bold>Change history</bold>
      </p>
      <p>4/28/2022</p>
      <p>Supplementary material has been included.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank Carmen Esposito and Dominik Sidler for helpful discussions of the theoretical aspects. Financial support by the Swiss National Science Foundation (Grant No. 200021-178762 and No. 200021-175944) is gratefully acknowledged.</p>
  </ack>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Open access funding provided by Swiss Federal Institute of Technology Zurich.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data Availability Statement</title>
    <p>The RestraintMaker code can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/rinikerlab/restraintmaker">https://github.com/rinikerlab/restraintmaker</ext-link>. The Python code for the RE-EDS workflow is provided on Github <ext-link ext-link-type="uri" xlink:href="https://github.com/rinikerlab/reeds">https://github.com/rinikerlab/reeds</ext-link> and can be used with the current version of GROMOS, freely available from <ext-link ext-link-type="uri" xlink:href="http://www.gromos.net">http://www.gromos.net</ext-link>. The input files for the simulations can be retrieved from <ext-link ext-link-type="uri" xlink:href="https://github.com/rinikerlab/restraintmaker/tree/main/examples/publication">https://github.com/rinikerlab/restraintmaker/tree/main/examples/publication</ext-link>.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cournia</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Allen</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Sherman</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <source>J. Chem. Inf. Model.</source>
        <year>2017</year>
        <volume>57</volume>
        <fpage>2911</fpage>
        <pub-id pub-id-type="doi">10.1021/acs.jcim.7b00564</pub-id>
        <?supplied-pmid 29243483?>
        <pub-id pub-id-type="pmid">29243483</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cournia</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Allen</surname>
            <given-names>BK</given-names>
          </name>
          <name>
            <surname>Beuming</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Pearlman</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Radak</surname>
            <given-names>BK</given-names>
          </name>
          <name>
            <surname>Sherman</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <source>J. Chem. Inf. Model.</source>
        <year>2020</year>
        <volume>60</volume>
        <fpage>4153</fpage>
        <pub-id pub-id-type="doi">10.1021/acs.jcim.0c00116</pub-id>
        <?supplied-pmid 32539386?>
        <pub-id pub-id-type="pmid">32539386</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <mixed-citation publication-type="other">Meier K, Bluck JP, Christ CD (2021) Use of free energy methods in the drug discovery industry. J Am Chem Soc ACS Symposium Series, vol 1397, pp 39–66</mixed-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Armacost</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Riniker</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cournia</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <source>J. Chem. Inf. Model.</source>
        <year>2020</year>
        <volume>60</volume>
        <fpage>1</fpage>
        <pub-id pub-id-type="doi">10.1021/acs.jcim.9b01174</pub-id>
        <?supplied-pmid 31983210?>
        <pub-id pub-id-type="pmid">31983210</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barros</surname>
            <given-names>EP</given-names>
          </name>
          <name>
            <surname>Ries</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Böselt</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Champion</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Riniker</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <source>Curr. Opin. Struct. Biol.</source>
        <year>2022</year>
        <volume>72</volume>
        <fpage>55</fpage>
        <pub-id pub-id-type="doi">10.1016/j.sbi.2021.08.003</pub-id>
        <?supplied-pmid 34534706?>
        <pub-id pub-id-type="pmid">34534706</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heinzelmann</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gilson</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <source>Sci. Rep.</source>
        <year>2021</year>
        <volume>11</volume>
        <fpage>1116</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-020-80769-1</pub-id>
        <?supplied-pmid 33441879?>
        <pub-id pub-id-type="pmid">33441879</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gapsys</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Pérez-Benito</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Aldeghi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Seeliger</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>van Vlijmen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Tresadern</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>de Groot</surname>
            <given-names>BL</given-names>
          </name>
        </person-group>
        <source>Chem. Sci.</source>
        <year>2020</year>
        <volume>11</volume>
        <fpage>1140</fpage>
        <pub-id pub-id-type="doi">10.1039/C9SC03754C</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jespers</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Esguerra</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Åqvist</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gutiérrez-De-Terán</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <source>J. Cheminf.</source>
        <year>2019</year>
        <volume>11</volume>
        <fpage>26</fpage>
        <pub-id pub-id-type="doi">10.1186/s13321-019-0348-5</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Raman</surname>
            <given-names>EP</given-names>
          </name>
          <name>
            <surname>Paul</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Hayes</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Brooks</surname>
            <given-names>CL</given-names>
          </name>
        </person-group>
        <source>J. Chem. Theory Comput.</source>
        <year>2020</year>
        <volume>16</volume>
        <fpage>7895</fpage>
        <pub-id pub-id-type="doi">10.1021/acs.jctc.0c00830</pub-id>
        <?supplied-pmid 33201701?>
        <pub-id pub-id-type="pmid">33201701</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Christ</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Fox</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <source>J. Chem. Inf. Model.</source>
        <year>2014</year>
        <volume>54</volume>
        <fpage>108</fpage>
        <pub-id pub-id-type="doi">10.1021/ci4004199</pub-id>
        <?supplied-pmid 24256082?>
        <pub-id pub-id-type="pmid">24256082</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gao</surname>
            <given-names>YD</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Crespo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Armacost</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Fells</surname>
            <given-names>JI</given-names>
          </name>
          <name>
            <surname>Fradera</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Sherborne</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Verras</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <source>J. Comput. Aided Mol. Des.</source>
        <year>2018</year>
        <volume>32</volume>
        <fpage>129</fpage>
        <pub-id pub-id-type="doi">10.1007/s10822-017-0072-z</pub-id>
        <?supplied-pmid 28986733?>
        <pub-id pub-id-type="pmid">28986733</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Tielker N, Eberlein L, Beckstein O, Güssregen S, Iorga BI, Kast SM, Liu S (2021) Perspective on the SAMPL and D3R blind prediction challenges for physics-based free energy methods, Chap. 3, pp 67–107</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Loeffler</surname>
            <given-names>HH</given-names>
          </name>
          <name>
            <surname>Bosisio</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Duarte Ramos Matos</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Suh</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Roux</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Mobley</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Michel</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <source>Chem J Theory Comput</source>
        <year>2018</year>
        <volume>14</volume>
        <fpage>5567</fpage>
        <pub-id pub-id-type="doi">10.1021/acs.jctc.8b00544</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Christ</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Mark</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>van Gunsteren</surname>
            <given-names>WF</given-names>
          </name>
        </person-group>
        <source>J Comput Chem</source>
        <year>2009</year>
        <volume>31</volume>
        <fpage>1569</fpage>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Riniker</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Christ</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Hansen</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Mark</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Nair</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Van Gunsteren</surname>
            <given-names>WF</given-names>
          </name>
        </person-group>
        <source>J Chem Phys</source>
        <year>2011</year>
        <volume>135</volume>
        <fpage>24105</fpage>
        <pub-id pub-id-type="doi">10.1063/1.3604534</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Pierce</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Krilov</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Lupyan</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dahlgren</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Greenwood</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Romero</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Masse</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Steinbrecher</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Beuming</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Damm</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Harder</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Sherman</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Brewer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wester</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Murcko</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Frye</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Farid</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Mobley</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Jorgensen</surname>
            <given-names>WL</given-names>
          </name>
          <name>
            <surname>Berne</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Friesner</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Abel</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <source>J Am Chem Soc</source>
        <year>2015</year>
        <volume>137</volume>
        <fpage>2695</fpage>
        <pub-id pub-id-type="doi">10.1021/ja512751q</pub-id>
        <?supplied-pmid 25625324?>
        <pub-id pub-id-type="pmid">25625324</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>LeBard</surname>
            <given-names>DN</given-names>
          </name>
          <name>
            <surname>Wandschneider</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Beachy</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Friesner</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Abel</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <source>J Chem Theory Comput</source>
        <year>2017</year>
        <volume>13</volume>
        <fpage>42</fpage>
        <pub-id pub-id-type="doi">10.1021/acs.jctc.6b00991</pub-id>
        <?supplied-pmid 27933808?>
        <pub-id pub-id-type="pmid">27933808</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aldeghi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Heifetz</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bodkin</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Knapp</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Biggin</surname>
            <given-names>PC</given-names>
          </name>
        </person-group>
        <source>Chem Sci</source>
        <year>2016</year>
        <volume>7</volume>
        <fpage>207</fpage>
        <pub-id pub-id-type="doi">10.1039/C5SC02678D</pub-id>
        <?supplied-pmid 26798447?>
        <pub-id pub-id-type="pmid">26798447</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sidler</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Schwaninger</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Riniker</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <source>J Chem Phys</source>
        <year>2016</year>
        <volume>145</volume>
        <fpage>154114</fpage>
        <pub-id pub-id-type="doi">10.1063/1.4964781</pub-id>
        <?supplied-pmid 27782485?>
        <pub-id pub-id-type="pmid">27782485</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>HS</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Sindhikara</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Rask</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Kimura</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Abel</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <source>J Chem Theory Comput</source>
        <year>2017</year>
        <volume>13</volume>
        <fpage>6290</fpage>
        <pub-id pub-id-type="doi">10.1021/acs.jctc.7b00885</pub-id>
        <?supplied-pmid 29120625?>
        <pub-id pub-id-type="pmid">29120625</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wei</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Chipot</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Roux</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <source>J Chem Inf Model</source>
        <year>2019</year>
        <volume>59</volume>
        <fpage>3794</fpage>
        <pub-id pub-id-type="doi">10.1021/acs.jcim.9b00362</pub-id>
        <pub-id pub-id-type="pmid">31411473</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paulsen</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>HS</given-names>
          </name>
          <name>
            <surname>Sindhikara</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Appleby</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Villasenor</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Schmitz</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Shivakumar</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <source>J Chem Inf Model</source>
        <year>2020</year>
        <volume>60</volume>
        <fpage>3489</fpage>
        <pub-id pub-id-type="doi">10.1021/acs.jcim.0c00132</pub-id>
        <?supplied-pmid 32539379?>
        <pub-id pub-id-type="pmid">32539379</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shobana</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Roux</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Andersen</surname>
            <given-names>OS</given-names>
          </name>
        </person-group>
        <source>J Phys Chem B</source>
        <year>2000</year>
        <volume>104</volume>
        <fpage>5179</fpage>
        <pub-id pub-id-type="doi">10.1021/jp994193s</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bieler</surname>
            <given-names>NS</given-names>
          </name>
          <name>
            <surname>Hünenberger</surname>
            <given-names>PH</given-names>
          </name>
        </person-group>
        <source>J Chem Theory Comput</source>
        <year>2015</year>
        <volume>36</volume>
        <fpage>1686</fpage>
        <pub-id pub-id-type="doi">10.1002/jcc.23984</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <mixed-citation publication-type="other">W. Jespers, G.V. Isaksen, T.A. Andberg, S. Vasile, A. van Veen, J. Aqvist, B.O. Brandsdal, H. Gutiérrez-de Terán (2019) J Chem Theory Comput 15:5461</mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kirkwood</surname>
            <given-names>JG</given-names>
          </name>
        </person-group>
        <source>J Chem Phys</source>
        <year>1935</year>
        <volume>3</volume>
        <fpage>300</fpage>
        <pub-id pub-id-type="doi">10.1063/1.1749657</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zwanzig</surname>
            <given-names>RW</given-names>
          </name>
        </person-group>
        <source>J Chem Phys</source>
        <year>1954</year>
        <volume>22</volume>
        <fpage>1420</fpage>
        <pub-id pub-id-type="doi">10.1063/1.1740409</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bennett</surname>
            <given-names>CH</given-names>
          </name>
        </person-group>
        <source>J Comput Phys</source>
        <year>1976</year>
        <volume>22</volume>
        <fpage>245</fpage>
        <pub-id pub-id-type="doi">10.1016/0021-9991(76)90078-4</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pearlman</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Kollman</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <source>J Chem Phys</source>
        <year>1991</year>
        <volume>94</volume>
        <fpage>4532</fpage>
        <pub-id pub-id-type="doi">10.1063/1.460608</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pearlman</surname>
            <given-names>DA</given-names>
          </name>
        </person-group>
        <source>J Phys Chem</source>
        <year>1994</year>
        <volume>98</volume>
        <fpage>1487</fpage>
        <pub-id pub-id-type="doi">10.1021/j100056a020</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gao</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kuczera</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Tidor</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Karplus</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <source>Science</source>
        <year>1989</year>
        <volume>244</volume>
        <fpage>1069</fpage>
        <pub-id pub-id-type="doi">10.1126/science.2727695</pub-id>
        <?supplied-pmid 2727695?>
        <pub-id pub-id-type="pmid">2727695</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boresch</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Karplus</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <source>J Phys Chem A</source>
        <year>1999</year>
        <volume>103</volume>
        <fpage>119</fpage>
        <pub-id pub-id-type="doi">10.1021/jp981629f</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rocklin</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Mobley</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Dill</surname>
            <given-names>KA</given-names>
          </name>
        </person-group>
        <source>J Chem Phys</source>
        <year>2013</year>
        <volume>138</volume>
        <fpage>085104</fpage>
        <pub-id pub-id-type="doi">10.1063/1.4792251</pub-id>
        <?supplied-pmid 23464180?>
        <pub-id pub-id-type="pmid">23464180</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fleck</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wieder</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Boresch</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <source>J Chem Theory Comput</source>
        <year>2021</year>
        <volume>17</volume>
        <fpage>4403</fpage>
        <pub-id pub-id-type="doi">10.1021/acs.jctc.0c01328</pub-id>
        <?supplied-pmid 34125525?>
        <pub-id pub-id-type="pmid">34125525</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Loeffler</surname>
            <given-names>HH</given-names>
          </name>
          <name>
            <surname>Michel</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Woods</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <source>J Chem Inf Model</source>
        <year>2015</year>
        <volume>55</volume>
        <fpage>2485</fpage>
        <pub-id pub-id-type="doi">10.1021/acs.jcim.5b00368</pub-id>
        <?supplied-pmid 26544598?>
        <pub-id pub-id-type="pmid">26544598</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Suruzhon</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Senapathi</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Bodnarchuk</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Viner</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wall</surname>
            <given-names>ID</given-names>
          </name>
          <name>
            <surname>Barnett</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Naidoo</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Essex</surname>
            <given-names>JW</given-names>
          </name>
        </person-group>
        <source>J Chem Inf Model</source>
        <year>2020</year>
        <volume>60</volume>
        <fpage>1917</fpage>
        <pub-id pub-id-type="doi">10.1021/acs.jcim.9b01158</pub-id>
        <?supplied-pmid 32092258?>
        <pub-id pub-id-type="pmid">32092258</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Petrov</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <source>J Chem Inf Model</source>
        <year>2021</year>
        <volume>61</volume>
        <fpage>4382</fpage>
        <pub-id pub-id-type="doi">10.1021/acs.jcim.1c00428</pub-id>
        <?supplied-pmid 34415755?>
        <pub-id pub-id-type="pmid">34415755</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Abel</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Redmann</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Summa</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Jaber</surname>
            <given-names>VR</given-names>
          </name>
          <name>
            <surname>Lim</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Mobley</surname>
            <given-names>DL</given-names>
          </name>
        </person-group>
        <source>J Comput Aided Mol Des</source>
        <year>2013</year>
        <volume>27</volume>
        <fpage>755</fpage>
        <pub-id pub-id-type="doi">10.1007/s10822-013-9678-y</pub-id>
        <?supplied-pmid 24072356?>
        <pub-id pub-id-type="pmid">24072356</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>CarvalhoMartins</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Cino</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Ferreira</surname>
            <given-names>RS</given-names>
          </name>
        </person-group>
        <source>Chem J Theory Comput</source>
        <year>2021</year>
        <volume>17</volume>
        <fpage>4262</fpage>
        <pub-id pub-id-type="doi">10.1021/acs.jctc.1c00194</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Homeyer</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Gohlke</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <source>J Comput Chem</source>
        <year>2013</year>
        <volume>34</volume>
        <fpage>965</fpage>
        <pub-id pub-id-type="doi">10.1002/jcc.23218</pub-id>
        <?supplied-pmid 23288722?>
        <pub-id pub-id-type="pmid">23288722</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Christ</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>van Gunsteren</surname>
            <given-names>WF</given-names>
          </name>
        </person-group>
        <source>J Chem Phys</source>
        <year>2007</year>
        <volume>126</volume>
        <fpage>184110</fpage>
        <pub-id pub-id-type="doi">10.1063/1.2730508</pub-id>
        <?supplied-pmid 17508795?>
        <pub-id pub-id-type="pmid">17508795</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Christ</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>van Gunsteren</surname>
            <given-names>WF</given-names>
          </name>
        </person-group>
        <source>J Chem Phys</source>
        <year>2008</year>
        <volume>128</volume>
        <fpage>174112</fpage>
        <pub-id pub-id-type="doi">10.1063/1.2913050</pub-id>
        <?supplied-pmid 18465915?>
        <pub-id pub-id-type="pmid">18465915</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Knight</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Brooks</surname>
            <given-names>CL</given-names>
            <suffix>III</suffix>
          </name>
        </person-group>
        <source>J Chem Theory Comput</source>
        <year>2011</year>
        <volume>7</volume>
        <fpage>2728</fpage>
        <pub-id pub-id-type="doi">10.1021/ct200444f</pub-id>
        <?supplied-pmid 22125476?>
        <pub-id pub-id-type="pmid">22125476</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <mixed-citation publication-type="other">Schrodinger L, DeLano W (2020) Pymol. <ext-link ext-link-type="uri" xlink:href="http://www.pymol.org/pymol">http://www.pymol.org/pymol</ext-link></mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jorgensen</surname>
            <given-names>WL</given-names>
          </name>
          <name>
            <surname>Ravimohan</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <source>J Chem Phys</source>
        <year>1985</year>
        <volume>83</volume>
        <fpage>3050</fpage>
        <pub-id pub-id-type="doi">10.1063/1.449208</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boresch</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Karplus</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <source>J Phys Chem A</source>
        <year>1999</year>
        <volume>103</volume>
        <fpage>103</fpage>
        <pub-id pub-id-type="doi">10.1021/jp981628n</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Donnini</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tegeler</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Groenhof</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Grubmüller</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <source>J Chem Theory Comput</source>
        <year>2011</year>
        <volume>7</volume>
        <fpage>1962</fpage>
        <pub-id pub-id-type="doi">10.1021/ct200061r</pub-id>
        <?supplied-pmid 21687785?>
        <pub-id pub-id-type="pmid">21687785</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Donnini</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ullmann</surname>
            <given-names>RT</given-names>
          </name>
          <name>
            <surname>Groenhof</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Grubmüller</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <source>J Chem Theory Comput</source>
        <year>2016</year>
        <volume>12</volume>
        <fpage>1040</fpage>
        <pub-id pub-id-type="doi">10.1021/acs.jctc.5b01160</pub-id>
        <?supplied-pmid 26881315?>
        <pub-id pub-id-type="pmid">26881315</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Mobley</surname>
            <given-names>DL</given-names>
          </name>
        </person-group>
        <source>J Chem Inf Model</source>
        <year>2015</year>
        <volume>55</volume>
        <fpage>727</fpage>
        <pub-id pub-id-type="doi">10.1021/acs.jcim.5b00057</pub-id>
        <?supplied-pmid 25835054?>
        <pub-id pub-id-type="pmid">25835054</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Damodaran</surname>
            <given-names>KV</given-names>
          </name>
          <name>
            <surname>Banba</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Brooks</surname>
            <given-names>CL</given-names>
          </name>
        </person-group>
        <source>J Phys Chem</source>
        <year>2001</year>
        <volume>105</volume>
        <fpage>9316</fpage>
        <pub-id pub-id-type="doi">10.1021/jp010361g</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eriksson</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Nilsson</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <source>J Mol Biol</source>
        <year>1995</year>
        <volume>253</volume>
        <fpage>453</fpage>
        <pub-id pub-id-type="doi">10.1006/jmbi.1995.0566</pub-id>
        <?supplied-pmid 7473727?>
        <pub-id pub-id-type="pmid">7473727</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gapsys</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Michielssens</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Seeliger</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>de Groot</surname>
            <given-names>BL</given-names>
          </name>
        </person-group>
        <source>J Comput Chem</source>
        <year>2015</year>
        <volume>36</volume>
        <fpage>348</fpage>
        <pub-id pub-id-type="doi">10.1002/jcc.23804</pub-id>
        <?supplied-pmid 25487359?>
        <pub-id pub-id-type="pmid">25487359</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Seeliger</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>de Groot</surname>
            <given-names>BL</given-names>
          </name>
        </person-group>
        <source>Biophys J</source>
        <year>2010</year>
        <volume>98</volume>
        <fpage>2309</fpage>
        <pub-id pub-id-type="doi">10.1016/j.bpj.2010.01.051</pub-id>
        <?supplied-pmid 20483340?>
        <pub-id pub-id-type="pmid">20483340</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Michel</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Essex</surname>
            <given-names>JW</given-names>
          </name>
        </person-group>
        <source>J Comput Aided Mol Des</source>
        <year>2010</year>
        <volume>24</volume>
        <fpage>639</fpage>
        <pub-id pub-id-type="doi">10.1007/s10822-010-9363-3</pub-id>
        <?supplied-pmid 20509041?>
        <pub-id pub-id-type="pmid">20509041</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Christ</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>van Gunsteren</surname>
            <given-names>WF</given-names>
          </name>
        </person-group>
        <source>J Chem Theory Comput</source>
        <year>2009</year>
        <volume>5</volume>
        <fpage>276</fpage>
        <pub-id pub-id-type="doi">10.1021/ct800424v</pub-id>
        <?supplied-pmid 26610104?>
        <pub-id pub-id-type="pmid">26610104</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mobley</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Chodera</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Dill</surname>
            <given-names>KA</given-names>
          </name>
        </person-group>
        <source>J Chem Phys</source>
        <year>2006</year>
        <volume>125</volume>
        <fpage>084902</fpage>
        <pub-id pub-id-type="doi">10.1063/1.2221683</pub-id>
        <?supplied-pmid 16965052?>
        <pub-id pub-id-type="pmid">16965052</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hénin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Chipot</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <source>J Chem Phys</source>
        <year>2004</year>
        <volume>121</volume>
        <fpage>2904</fpage>
        <pub-id pub-id-type="doi">10.1063/1.1773132</pub-id>
        <?supplied-pmid 15291601?>
        <pub-id pub-id-type="pmid">15291601</pub-id>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <mixed-citation publication-type="other">Landrum G, Tosco P, Kelley B, Riniker S, Ric, Gedeck, Vianello R, Schneider N, Dalke A, Cole DNB, Swain M, Turk S, Cosgrove D, Savelyev A, Vaucher A, Wójcikowski M, Jones G, Probst D, Scalfani VF, Godin G, Pahl A, Berenger F, Varjo JL, strets123, JP, DoliathGavid, Sforna G, Jensen JH (2021) RDKit Release 2020_09_5 (Q3 2020)</mixed-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>von Neumann</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <source>Math Ann</source>
        <year>1928</year>
        <volume>100</volume>
        <fpage>295</fpage>
        <pub-id pub-id-type="doi">10.1007/BF01448847</pub-id>
      </element-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Prim</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <source>Bell Syst Tech J</source>
        <year>1957</year>
        <volume>36</volume>
        <fpage>1389</fpage>
        <pub-id pub-id-type="doi">10.1002/j.1538-7305.1957.tb01515.x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schmid</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Christ</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Christen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Eichenberger</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>van Gunsteren</surname>
            <given-names>WF</given-names>
          </name>
        </person-group>
        <source>Comput Phys Commun</source>
        <year>2012</year>
        <volume>183</volume>
        <fpage>890</fpage>
        <pub-id pub-id-type="doi">10.1016/j.cpc.2011.12.014</pub-id>
      </element-citation>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abraham</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Murtola</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Schulz</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Pall</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Hess</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Lindahl</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <source>SoftwareX</source>
        <year>2015</year>
        <volume>1–2</volume>
        <fpage>19</fpage>
        <pub-id pub-id-type="doi">10.1016/j.softx.2015.06.001</pub-id>
      </element-citation>
    </ref>
    <ref id="CR63">
      <label>63.</label>
      <mixed-citation publication-type="other">Pezoa F, Reutter JL, Suarez F, Ugarte M, Vrgoč D (2016) Proceedings of the 25th international conference on world wide web (international world wide web conferences steering committee, 2016), pp 263–273</mixed-citation>
    </ref>
    <ref id="CR64">
      <label>64.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sidler</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Cristòfol-Clough</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Riniker</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <source>J Chem Theory Comput</source>
        <year>2017</year>
        <volume>13</volume>
        <fpage>3020</fpage>
        <pub-id pub-id-type="doi">10.1021/acs.jctc.7b00286</pub-id>
        <?supplied-pmid 28510459?>
        <pub-id pub-id-type="pmid">28510459</pub-id>
      </element-citation>
    </ref>
    <ref id="CR65">
      <label>65.</label>
      <mixed-citation publication-type="other">Ries B, Normak K, Weiss RG, Rieder S, Barros EP, Champion C, König G, Riniker S (2022) J Comput-Aided Mol Des 36:117</mixed-citation>
    </ref>
    <ref id="CR66">
      <label>66.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bieler</surname>
            <given-names>NS</given-names>
          </name>
          <name>
            <surname>Tschopp</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Hünenberger</surname>
            <given-names>PH</given-names>
          </name>
        </person-group>
        <source>J Chem Theory Comput</source>
        <year>2015</year>
        <volume>11</volume>
        <fpage>2575</fpage>
        <pub-id pub-id-type="doi">10.1021/acs.jctc.5b00118</pub-id>
        <?supplied-pmid 26575556?>
        <pub-id pub-id-type="pmid">26575556</pub-id>
      </element-citation>
    </ref>
    <ref id="CR67">
      <label>67.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kruskal</surname>
            <given-names>JB</given-names>
          </name>
        </person-group>
        <source>Proc Am Math Soc</source>
        <year>1956</year>
        <volume>7</volume>
        <fpage>48</fpage>
        <pub-id pub-id-type="doi">10.1090/S0002-9939-1956-0078686-7</pub-id>
      </element-citation>
    </ref>
    <ref id="CR68">
      <label>68.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hansmann</surname>
            <given-names>UHE</given-names>
          </name>
        </person-group>
        <source>Chem Phys Lett</source>
        <year>1997</year>
        <volume>281</volume>
        <fpage>140</fpage>
        <pub-id pub-id-type="doi">10.1016/S0009-2614(97)01198-6</pub-id>
      </element-citation>
    </ref>
    <ref id="CR69">
      <label>69.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sugita</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kitao</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Okamoto</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <source>J Chem Phys</source>
        <year>2000</year>
        <volume>113</volume>
        <fpage>6042</fpage>
        <pub-id pub-id-type="doi">10.1063/1.1308516</pub-id>
      </element-citation>
    </ref>
    <ref id="CR70">
      <label>70.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wolfenden</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>YL</given-names>
          </name>
          <name>
            <surname>Matthews</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <source>J Am Chem Soc</source>
        <year>1987</year>
        <volume>109</volume>
        <fpage>463</fpage>
        <pub-id pub-id-type="doi">10.1021/ja00236a026</pub-id>
      </element-citation>
    </ref>
    <ref id="CR71">
      <label>71.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rizzo</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Aynechi</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Case</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Kuntz</surname>
            <given-names>ID</given-names>
          </name>
        </person-group>
        <source>J Chem Theory Comput</source>
        <year>2006</year>
        <volume>2</volume>
        <fpage>128</fpage>
        <pub-id pub-id-type="doi">10.1021/ct050097l</pub-id>
        <?supplied-pmid 26626387?>
        <pub-id pub-id-type="pmid">26626387</pub-id>
      </element-citation>
    </ref>
    <ref id="CR72">
      <label>72.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nicholls</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mobley</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Guthrie</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Chodera</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Bayly</surname>
            <given-names>CI</given-names>
          </name>
          <name>
            <surname>Cooper</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Pande</surname>
            <given-names>VS</given-names>
          </name>
        </person-group>
        <source>J Med Chem</source>
        <year>2008</year>
        <volume>51</volume>
        <fpage>769</fpage>
        <pub-id pub-id-type="doi">10.1021/jm070549+</pub-id>
        <?supplied-pmid 18215013?>
        <pub-id pub-id-type="pmid">18215013</pub-id>
      </element-citation>
    </ref>
    <ref id="CR73">
      <label>73.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guthrie</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <source>J Phys Chem B</source>
        <year>2009</year>
        <volume>113</volume>
        <fpage>4501</fpage>
        <pub-id pub-id-type="doi">10.1021/jp806724u</pub-id>
        <?supplied-pmid 19338360?>
        <pub-id pub-id-type="pmid">19338360</pub-id>
      </element-citation>
    </ref>
    <ref id="CR74">
      <label>74.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guthrie</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <source>J Comput Aided</source>
        <year>2014</year>
        <volume>28</volume>
        <fpage>151</fpage>
        <pub-id pub-id-type="doi">10.1007/s10822-014-9738-y</pub-id>
      </element-citation>
    </ref>
    <ref id="CR75">
      <label>75.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mobley</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Guthrie</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <source>J Comput Aided Mol Des</source>
        <year>2014</year>
        <volume>28</volume>
        <fpage>711</fpage>
        <pub-id pub-id-type="doi">10.1007/s10822-014-9747-x</pub-id>
        <?supplied-pmid 24928188?>
        <pub-id pub-id-type="pmid">24928188</pub-id>
      </element-citation>
    </ref>
    <ref id="CR76">
      <label>76.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stroet</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Caron</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Visscher</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Geerke</surname>
            <given-names>DP</given-names>
          </name>
          <name>
            <surname>Malde</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Mark</surname>
            <given-names>AE</given-names>
          </name>
        </person-group>
        <source>J Chem Theory Comput</source>
        <year>2018</year>
        <volume>14</volume>
        <fpage>5834</fpage>
        <pub-id pub-id-type="doi">10.1021/acs.jctc.8b00768</pub-id>
        <?supplied-pmid 30289710?>
        <pub-id pub-id-type="pmid">30289710</pub-id>
      </element-citation>
    </ref>
    <ref id="CR77">
      <label>77.</label>
      <mixed-citation publication-type="other">Lehner MT, Ries B, Rieder S, Riniker S (2021) PyGromosTools v2.0, 10.5281/zenodo.4621710</mixed-citation>
    </ref>
    <ref id="CR78">
      <label>78.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Berendsen</surname>
            <given-names>HJC</given-names>
          </name>
          <name>
            <surname>Postma</surname>
            <given-names>JPM</given-names>
          </name>
          <name>
            <surname>van Gunsteren</surname>
            <given-names>WF</given-names>
          </name>
          <name>
            <surname>Hermans</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <source>Interaction models for water in relation to protein hydration</source>
        <year>1981</year>
        <publisher-loc>Dordrecht</publisher-loc>
        <publisher-name>Reidel</publisher-name>
        <fpage>331</fpage>
        <lpage>342</lpage>
      </element-citation>
    </ref>
    <ref id="CR79">
      <label>79.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tironi</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Sperb</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>PE</given-names>
          </name>
          <name>
            <surname>van Gunsteren</surname>
            <given-names>WF</given-names>
          </name>
        </person-group>
        <source>J Chem Phys</source>
        <year>1995</year>
        <volume>102</volume>
        <fpage>5451</fpage>
        <pub-id pub-id-type="doi">10.1063/1.469273</pub-id>
      </element-citation>
    </ref>
    <ref id="CR80">
      <label>80.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heinz</surname>
            <given-names>TN</given-names>
          </name>
          <name>
            <surname>van Gunsteren</surname>
            <given-names>WF</given-names>
          </name>
          <name>
            <surname>Hünenberger</surname>
            <given-names>PH</given-names>
          </name>
        </person-group>
        <source>J Chem Phys</source>
        <year>2001</year>
        <volume>115</volume>
        <fpage>1125</fpage>
        <pub-id pub-id-type="doi">10.1063/1.1379764</pub-id>
      </element-citation>
    </ref>
    <ref id="CR81">
      <label>81.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eichenberger</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Allison</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Dolenc</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Geerke</surname>
            <given-names>DP</given-names>
          </name>
          <name>
            <surname>Horta</surname>
            <given-names>BAC</given-names>
          </name>
          <name>
            <surname>Meier</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Oostenbrink</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Schmid</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Steiner</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>van Gunsteren</surname>
            <given-names>WF</given-names>
          </name>
        </person-group>
        <source>J Chem Theory Comput</source>
        <year>2011</year>
        <volume>7</volume>
        <fpage>3379</fpage>
        <pub-id pub-id-type="doi">10.1021/ct2003622</pub-id>
        <?supplied-pmid 26598168?>
        <pub-id pub-id-type="pmid">26598168</pub-id>
      </element-citation>
    </ref>
    <ref id="CR82">
      <label>82.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Virtanen</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gommers</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Oliphant</surname>
            <given-names>TE</given-names>
          </name>
          <name>
            <surname>Haberland</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Reddy</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Cournapeau</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Burovski</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Peterson</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Weckesser</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Bright</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>van der Walt</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Brett</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Millman</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Mayorov</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Nelson</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Kern</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Larson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Carey</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Polat</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Moore</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>VanderPlas</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Laxalde</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Perktold</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cimrman</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Henriksen</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Quintero</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>CR</given-names>
          </name>
          <name>
            <surname>Archibald</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Ribeiro</surname>
            <given-names>AH</given-names>
          </name>
          <name>
            <surname>Pedregosa</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>van Mulbregt</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Vijaykumar</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bardelli</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Rothberg</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hilboll</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kloeckner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Scopatz</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rokem</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Woods</surname>
            <given-names>CN</given-names>
          </name>
          <name>
            <surname>Fulton</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Masson</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Häggström</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Fitzgerald</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Nicholson</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Hagen</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Pasechnik</surname>
            <given-names>DV</given-names>
          </name>
          <name>
            <surname>Olivetti</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Wieser</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Silva</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Lenders</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Wilhelm</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Price</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Ingold</surname>
            <given-names>GL</given-names>
          </name>
          <name>
            <surname>Allen</surname>
            <given-names>GE</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Audren</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Probst</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Dietrich</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Silterra</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Webber</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Slavič</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Nothman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Buchner</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kulick</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Schönberger</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>de Miranda Cardoso</surname>
            <given-names>JV</given-names>
          </name>
          <name>
            <surname>Reimer</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Harrington</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rodríguez</surname>
            <given-names>JLC</given-names>
          </name>
          <name>
            <surname>Nunez-Iglesias</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kuczynski</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tritz</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Thoma</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Newville</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kümmerer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bolingbroke</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tartre</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pak</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Nowaczyk</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Shebanov</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Pavlyk</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Brodtkorb</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>McGibbon</surname>
            <given-names>RT</given-names>
          </name>
          <name>
            <surname>Feldbauer</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lewis</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tygier</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sievert</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Vigna</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Peterson</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>More</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pudlik</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Oshima</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Pingel</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Robitaille</surname>
            <given-names>TP</given-names>
          </name>
          <name>
            <surname>Spura</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Cera</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Leslie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Zito</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Krauss</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Upadhyay</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Halchenko</surname>
            <given-names>YO</given-names>
          </name>
          <name>
            <surname>Vázquez-Baeza</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <source>Nature Methods</source>
        <year>2020</year>
        <volume>17</volume>
        <fpage>261</fpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0686-2</pub-id>
        <?supplied-pmid 32015543?>
        <pub-id pub-id-type="pmid">32015543</pub-id>
      </element-citation>
    </ref>
    <ref id="CR83">
      <label>83.</label>
      <mixed-citation publication-type="other">McKinney W (2010) Proc. of the 9th Python in Science Conf. 445, 51</mixed-citation>
    </ref>
    <ref id="CR84">
      <label>84.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hunter</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <source>Comput Sci Eng</source>
        <year>2007</year>
        <volume>9</volume>
        <fpage>99</fpage>
        <pub-id pub-id-type="doi">10.1109/MCSE.2007.55</pub-id>
      </element-citation>
    </ref>
    <ref id="CR85">
      <label>85.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van Der Walt</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Colbert</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Varoquaux</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <source>Comput Sci Eng</source>
        <year>2011</year>
        <volume>13</volume>
        <fpage>22</fpage>
        <pub-id pub-id-type="doi">10.1109/MCSE.2011.37</pub-id>
      </element-citation>
    </ref>
    <ref id="CR86">
      <label>86.</label>
      <mixed-citation publication-type="other">F.J. et al (2013) mpmath: a Python library for arbitrary-precision floating-point arithmetic (version 0.18). http://mpmath.org/</mixed-citation>
    </ref>
    <ref id="CR87">
      <label>87.</label>
      <mixed-citation publication-type="other">Kluyver T, Ragan-kelley B, Pérez F, Granger B, Bussonnier M, Frederic J, Kelley K, Hamrick J, Grout J, Corlay S, Ivanov P, Avila D, Abdalla S, Willing C (2016) J Dev Team ELPUB, pp pp 87–90</mixed-citation>
    </ref>
    <ref id="CR88">
      <label>88.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Strauss</surname>
            <given-names>HL</given-names>
          </name>
          <name>
            <surname>Pickett</surname>
            <given-names>HM</given-names>
          </name>
        </person-group>
        <source>J Am Chem Soc</source>
        <year>1970</year>
        <volume>92</volume>
        <fpage>7281</fpage>
        <pub-id pub-id-type="doi">10.1021/ja00728a009</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
