<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d1 20130915//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">J Biol Rhythms</journal-id>
    <journal-id journal-id-type="iso-abbrev">J. Biol. Rhythms</journal-id>
    <journal-id journal-id-type="publisher-id">JBR</journal-id>
    <journal-id journal-id-type="hwp">spjbr</journal-id>
    <journal-title-group>
      <journal-title>Journal of Biological Rhythms</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0748-7304</issn>
    <issn pub-type="epub">1552-4531</issn>
    <publisher>
      <publisher-name>SAGE Publications</publisher-name>
      <publisher-loc>Sage CA: Los Angeles, CA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4266694</article-id>
    <article-id pub-id-type="doi">10.1177/0748730414553029</article-id>
    <article-id pub-id-type="publisher-id">10.1177_0748730414553029</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Articles</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Detecting Rhythms in Time Series with RAIN</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Thaben</surname>
          <given-names>Paul F.</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Westermark</surname>
          <given-names>Pål O.</given-names>
        </name>
        <xref ref-type="corresp" rid="corresp1-0748730414553029">1</xref>
      </contrib>
      <aff id="aff1-0748730414553029">Institute for Theoretical Biology, Charité – Universitätsmedizin Berlin, Berlin, Germany</aff>
    </contrib-group>
    <author-notes>
      <corresp id="corresp1-0748730414553029"><label>1.</label>Pål O. Westermark, Institute for Theoretical Biology, Charité –Universitätsmedizin Berlin, Invalidenstrasse 43, 10115 Berlin, Germany; e-mail: <email>pal-olof.westermark@charite.de</email>.</corresp>
    </author-notes>
    <pub-date pub-type="epub-ppub">
      <month>12</month>
      <year>2014</year>
    </pub-date>
    <!--Fake ppub date generated by PMC from publisher
							pub-date/@pub-type='epub-ppub' -->
    <pub-date pub-type="ppub">
      <month>12</month>
      <year>2014</year>
    </pub-date>
    <volume>29</volume>
    <issue>6</issue>
    <fpage>391</fpage>
    <lpage>400</lpage>
    <permissions>
      <copyright-statement>© 2014 The Author(s)</copyright-statement>
      <copyright-year>2014</copyright-year>
      <copyright-holder content-type="sage">SAGE Publications</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by-nc/3.0/">
        <license-p>This article is distributed under the terms of the Creative Commons Attribution-NonCommercial 3.0 License (<ext-link ext-link-type="uri" xlink:href="http://www.creativecommons.org/licenses/by-nc/3.0/">http://www.creativecommons.org/licenses/by-nc/3.0/</ext-link>) which permits non-commercial use, reproduction and distribution of the work without further permission provided the original work is attributed as specified on the SAGE and Open Access page (<ext-link ext-link-type="uri" xlink:href="http://www.uk.sagepub.com/aboutus/openaccess.htm">http://www.uk.sagepub.com/aboutus/openaccess.htm</ext-link>).</license-p>
      </license>
    </permissions>
    <abstract>
      <p>A fundamental problem in research on biological rhythms is that of detecting and assessing the significance of rhythms in large sets of data. Classic methods based on Fourier theory are often hampered by the complex and unpredictable characteristics of experimental and biological noise. Robust nonparametric methods are available but are limited to specific wave forms. We present RAIN, a robust nonparametric method for the detection of rhythms of prespecified periods in biological data that can detect arbitrary wave forms. When applied to measurements of the circadian transcriptome and proteome of mouse liver, the sets of transcripts and proteins with rhythmic abundances were significantly expanded due to the increased detection power, when we controlled for false discovery. Validation against independent data confirmed the quality of these results. The large expansion of the circadian mouse liver transcriptomes and proteomes reflected the prevalence of nonsymmetric wave forms and led to new conclusions about function. RAIN was implemented as a freely available software package for R/Bioconductor and is presently also available as a web interface.</p>
    </abstract>
    <kwd-group>
      <kwd>circadian</kwd>
      <kwd>statistics</kwd>
      <kwd>data analysis</kwd>
      <kwd>gene expression</kwd>
      <kwd>biological oscillations</kwd>
      <kwd>algorithm</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <p>At the core of research on biological rhythms lies the methodological problem of how to detect periodicities in measured data. This is reflected in the richness of the literature on this subject as well as in the wealth of methods and algorithms devoted to this task. Our group investigates circadian rhythms, and in this field the demand for rigorous and efficient methods for periodicity detection is only increasing as more genome- and proteome-wide data accumulate. The accuracy of the detection of rhythmic messages and proteins is crucial in modern circadian high-throughput cell biology, since it greatly affects the validity of subsequent conclusions about function.</p>
  <p>Most available methods for periodicity detection can be traced back to Fourier methods in some form (<xref rid="bibr5-0748730414553029" ref-type="bibr">Halberg et al., 1967</xref>; <xref rid="bibr16-0748730414553029" ref-type="bibr">Straume, 2004</xref>; <xref rid="bibr19-0748730414553029" ref-type="bibr">Wichert et al., 2004</xref>; <xref rid="bibr20-0748730414553029" ref-type="bibr">Wijnen et al., 2005</xref>). These methods generally assume an underlying rhythm in the form of one or more sine waves. Further, they are often so-called parametric methods that make certain assumptions about the deviations from the biological signal: These deviations are the measurement noise and biological noise. One general assumption is that the noise variance is both Gaussian (normally) distributed and independent of measurement magnitude, which, however, sometimes is not even close to reality for biological data, regardless of, for example, log-transformation. In such cases, it is worthwhile to explore nonparametric statistical methods, which then can perform much better than parametric methods. It is therefore not surprising that a nonparametric method implemented as the program “JTK_CYCLE” (<xref rid="bibr8-0748730414553029" ref-type="bibr">Hughes et al., 2010</xref>) has had a large impact and has been widely adopted in the field.</p>
  <p>Another property of biological data that presents a problem for classic Fourier-based methods is the prevalence of spiky or sawtooth-shaped wave forms deviating significantly from sine waves. This also highlights a shortcoming of JTK_CYCLE: It assumes that any underlying rhythms have symmetric wave forms. This means, for example, that (as we demonstrate later here) sawtooth-shaped rhythms often go undetected by this algorithm. The HAYSTACK method (<xref rid="bibr14-0748730414553029" ref-type="bibr">Michael et al., 2008</xref>) addresses this problem but relies on a small set of predefined wave form alternatives and is thus not really general.</p>
  <p>JTK_CYCLE builds on the nonparametric Jonckheere-Terpstra test (<xref rid="bibr10-0748730414553029" ref-type="bibr">Jonckheere, 1954</xref>; <xref rid="bibr18-0748730414553029" ref-type="bibr">Terpstra, 1952</xref>), which detects monotonous trends in data consisting of a dependent variable (e.g., mRNA expression levels) and an independent variable (e.g., time). What about instead aiming to detect the case of an initial increase and a subsequent decrease in the dependent variable? This problem, which is a generalization of the Jonckheere-Terpstra test, was addressed and solved by <xref rid="bibr12-0748730414553029" ref-type="bibr">Mack and Wolfe (1981)</xref>, resulting in the so-called rank test for umbrella alternatives (the name due to the rising and falling shape of the pattern to be detected). The test also allows for asymmetry (a variable umbrella peak, in the authors’ terminology), for example, a steep rise and slow decay or vice versa.</p>
  <p>We have leveraged and extended available umbrella methods to allow for nonparametric detection of both symmetric and nonsymmetric rhythms. We present here the resulting method, which we have dubbed RAIN (Rhythmicity Analysis Incorporating Nonparametric methods). This method can detect rhythms of any period and makes few assumptions about wave forms. We demonstrate the usefulness of RAIN for detecting circadian rhythms in gene expression data, which is our primary research interest. In particular, we demonstrate that RAIN detects strong but asymmetric circadian rhythms in many genes in mouse liver, often obvious to the human eye, that go unnoticed by JTK_CYCLE. Furthermore, RAIN significantly enlarged the circadian mouse liver proteome compared with the studies that first charted it (<xref rid="bibr13-0748730414553029" ref-type="bibr">Mauvoisin et al., 2014</xref>; <xref rid="bibr15-0748730414553029" ref-type="bibr">Robles et al., 2014</xref>), which led us to note a functional enrichment for circadian proteins involved in protein folding and unfolded protein binding. This functional enrichment had gone unnoticed in the original studies. RAIN is available as an R/Bioconductor package at <ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org">www.bioconductor.org</ext-link> and through a web service (<ext-link ext-link-type="uri" xlink:href="http://rain.biologie.hu-berlin.de/rain">rain.biologie.hu-berlin.de/rain</ext-link>) that provides an easy-to-use interface to the algorithm.</p>
  <sec sec-type="methods" id="section1-0748730414553029">
    <title>Methods</title>
    <sec id="section2-0748730414553029">
      <title>RAIN</title>
      <p>Nonparametric methods avoid many assumptions regarding the experimental noise and the underlying model for the generation of rhythms by concentrating on the ranks of the measured values, rather than the measured values themselves. The program JTK_CYCLE uses such a method for rhythm detection, and it works by comparing the ranks of measured values to those of an assumed underlying curve shape (a sine curve by default). However, this method is not suitable for detecting various nonsymmetric wave forms.</p>
      <p>The purpose of RAIN was to build on the strengths of JTK_CYCLE but to significantly expand the territory of detectable rhythms to include nonsymmetric wave forms, such as sawtooth-like shapes. The aim was to accomplish this in a general way, specifically not requiring a library of guessed wave forms to match to (which is the case for previous methods such as JTK_CYCLE or HAYSTACK). Still, we sought to continue the robust nonparametric approach that is often necessary when analyzing RNA or protein abundances, since these kinds of measurements are subject to experimental uncertainties often resulting in outliers. The core idea behind RAIN was the realization that a rhythmic time series consists of alternating rising and falling patterns but that the rising pattern may be unrelated in shape to the falling pattern: These shapes should not be tested against each other. Given an oscillation period to test against, RAIN works by organizing the data into groups belonging to either the rising part or the falling part of an oscillation period (<xref ref-type="fig" rid="fig1-0748730414553029">Fig. 1</xref>). The rising and falling parts are then tested separately using the test against umbrella alternatives (<xref rid="bibr12-0748730414553029" ref-type="bibr">Mack and Wolfe, 1981</xref>). This is a main point of departure of RAIN compared with JTK_CYCLE: RAIN does not care about the rising part having a particular shape compared with the falling part (<xref ref-type="fig" rid="fig1-0748730414553029">Fig. 1</xref>), whereas JTK_CYCLE by design tests measurements in both rising and falling parts against each other. In addition, JTK_CYCLE by default assumes a perfectly symmetric wave form, where the falling part has the mirror-image shape of the rising part. Although the user may define any one waveform from within the code base of JTK_CYCLE, the rising and falling parts of the curve shape are by JTK_CYCLE always locked into the particular relationship defined by the one chosen waveform (such as one of the triangular or “shark fin” shaped examples in the lower part of <xref ref-type="fig" rid="fig1-0748730414553029">Fig. 1</xref>). This limitation is overcome by RAIN, which thus has the potential to discover a broader spectrum of rhythmic waveforms.</p>
      <fig id="fig1-0748730414553029" orientation="portrait" position="float">
        <label>Figure 1.</label>
        <caption>
          <p>Description of RAIN. RAIN works by grouping measurements by time point (such as circadian or zeitgeber time). The ranks rather than the values are used, and groups are compared with each other against the alternative hypothesis of a rising pattern followed by a falling pattern. Only groups belonging to the same pattern (either rising or falling) are compared with each other. This releases many constraints on shape, allowing detection of, for example, “shark fin” wave forms. By cyclically reordering groups, and by further varying the umbrella peak location, further asymmetries and phases are tested against.</p>
        </caption>
        <graphic xlink:href="10.1177_0748730414553029-fig1"/>
      </fig>
      <p>As in the original formulation of the test against umbrella alternatives, the umbrella peak is allowed to vary so that different steepnesses of the rising and falling parts are allowed for (<xref ref-type="fig" rid="fig1-0748730414553029">Fig. 1</xref>). This allows RAIN to test against skewed (e.g., sawtooth-like) waveforms. Finally, as in JTK_CYCLE, a set of periods prespecified by the user, as well as all possible phases, are tested, and <italic>p</italic>-values are adjusted for these multiple tests of peak shape, period, and phase, to obtain a final <italic>p</italic>-value.</p>
      <p>We have implemented RAIN as a freely available package for the (also free) statistical software R/Bioconductor. A web interface for RAIN is also currently available at rain.biologie.hu-berlin.de/rain. The run time of the software for typical data sets is relatively short, comparable to JTK_CYCLE. Missing values and non-even sampling intervals are accommodated for. The user chooses periods to test for, steepness of rising and falling parts of the time series (umbrella peak locations) to consider, and the method for correction for multiple testing due to varying umbrella peaks and phases; the default, also used for the result of the present report, is the adaptive Benjamini-Hochberg method (<xref rid="bibr1-0748730414553029" ref-type="bibr">Benjamini and Hochberg, 2000</xref>). RAIN computes the null distribution against umbrella alternatives exactly (<xref rid="bibr6-0748730414553029" ref-type="bibr">Harding, 1984</xref>; <xref rid="bibr17-0748730414553029" ref-type="bibr">Streitberg and Röhmel, 1988</xref>), leveraging the R package “gmp” to achieve arbitrary precision integer arithmetic. The run time of RAIN is comparable to that of JTK_CYCLE (on the order of 1-2 min for 25,000 samples and 24 time points). The exact derivation of the particular null distribution assumed by RAIN and details regarding the implementation are given in the Supplementary online material.</p>
    </sec>
    <sec id="section3-0748730414553029">
      <title>Synthetic Data for Rigorous Benchmarking</title>
      <p>One part of assessing the performance of RAIN was running the algorithm on synthetic computer-generated data that include realistic artificial experimental noise but where we know the underlying rhythmic wave form. We chose to study and simulate the experimental noise of microarray mRNA expression; specifically, the mouse liver microarray experiment by <xref rid="bibr9-0748730414553029" ref-type="bibr">Hughes et al. (2012)</xref>. These data encompass 25,817 genes and 24 time points spanning CT0 to CT46, where CT stands for circadian time. To the time series <italic>y<sub>g</sub>(t)</italic> measured for each gene <italic>g</italic> in this data set, a first Fourier harmonic <inline-formula id="inline-formula1-0748730414553029"><mml:math id="math1-0748730414553029"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>a</mml:mi><mml:mi>cos</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>ω</mml:mtext><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mi>sin</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>ω</mml:mtext><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> was fitted, and errors were calculated as
<inline-formula id="inline-formula2-0748730414553029"><mml:math id="math2-0748730414553029"><mml:mrow><mml:msub><mml:mtext>ε</mml:mtext><mml:mi>g</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>g</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>; noise variances were estimated from the sum of the errors squared. We found that the noise standard deviation (SD) scales almost linearly with the average magnitude of measured signal; the coefficient of variation (SD divided by mean) is constant and ~0.10 (Suppl. Fig. S1). This motivated us to formulate the following model for the synthetic data, with a normalized mean magnitude of 1:</p>
      <p>
        <disp-formula id="disp-formula1-0748730414553029">
          <alternatives>
            <mml:math id="math3-0748730414553029">
              <mml:mrow>
                <mml:mi>y</mml:mi>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mi>t</mml:mi>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mo>=</mml:mo>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:mn>1</mml:mn>
                    <mml:mo>+</mml:mo>
                    <mml:mi>f</mml:mi>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mtext>ω</mml:mtext>
                        <mml:mi>t</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mtext>φ</mml:mtext>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:mn>1</mml:mn>
                    <mml:mo>+</mml:mo>
                    <mml:mtext>η</mml:mtext>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mo>,</mml:mo>
              </mml:mrow>
            </mml:math>
            <graphic xlink:href="10.1177_0748730414553029-eq1.jpg" position="float" orientation="portrait"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>where <inline-formula id="inline-formula3-0748730414553029"><mml:math id="math4-0748730414553029"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>ω</mml:mtext><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mtext>φ</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is either a cosine function with amplitude <italic>a</italic>, frequency
<inline-formula id="inline-formula4-0748730414553029"><mml:math id="math5-0748730414553029"><mml:mrow><mml:mtext>ω</mml:mtext><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>24</mml:mn></mml:mrow></mml:math></inline-formula> h<sup>−1</sup>, and phase <italic>ϕ</italic>:
<inline-formula id="inline-formula5-0748730414553029"><mml:math id="math6-0748730414553029"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>ω</mml:mtext><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mtext>φ</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mi>cos</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>ω</mml:mtext><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mtext>φ</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, or it is a sawtooth function of the same frequency (for which <italic>a</italic> is half the peak-to-trough distance and <italic>ϕ</italic> determines the position of the maximum), and where
<inline-formula id="inline-formula6-0748730414553029"><mml:math id="math7-0748730414553029"><mml:mrow><mml:mtext>η</mml:mtext><mml:mo>~</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is a Gaussian noise term with SD
<inline-formula id="inline-formula7-0748730414553029"><mml:math id="math8-0748730414553029"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> for all cases in the present study (which for all practical purposes rules out negative values of <italic>y(t)</italic>). The amplitudes of the normalized oscillatory functions necessarily lie between
<inline-formula id="inline-formula8-0748730414553029"><mml:math id="math9-0748730414553029"><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and
<inline-formula id="inline-formula9-0748730414553029"><mml:math id="math10-0748730414553029"><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, and in one setting, we considered amplitudes of 0, 0.1, 0.2, and 0.3—the latter amplitude being 3 times the noise SD in the microarray experiment, as described above. In another setting, amplitude-to-noise ratios were sampled from an estimated distribution based on the mouse liver microarray data (<xref rid="bibr9-0748730414553029" ref-type="bibr">Hughes et al., 2012</xref>), with amplitudes and noise levels estimated as described above. For synthetic data with outliers, an additional large positive deviation of 20 was added to one randomly chosen time point of each time series, as done by <xref rid="bibr8-0748730414553029" ref-type="bibr">Hughes et al. (2010)</xref>.</p>
    </sec>
    <sec id="section4-0748730414553029">
      <title>ROC Curves and False Discovery Rates</title>
      <p>We assessed the quality and performance of the different algorithms using ROC (receiver operator characteristic) analysis, which assays the true positive rate (TPR) and false positive rate (FPR) of a classification method (our case concerns classification of time series as rhythmic or nonrhythmic). The TPR is the fraction of truly rhythmic time series also classified as such (true positive rate), while the FPR is the fraction of truly nonrhythmic time series misclassified as rhythmic by the algorithm. An increasing TPR comes at a cost of an increasing FPR, but a good algorithm reaches a high TPR already at low FPRs. ROC curves—plots of TPR on the <italic>y</italic>-axis versus FPR on the <italic>x</italic>-axis—visualize the quality of an algorithm: Random choices (“monkey pushing a button”) produce a straight-line ROC curve
<inline-formula id="inline-formula10-0748730414553029"><mml:math id="math11-0748730414553029"><mml:mrow><mml:mo>(</mml:mo><mml:mtext>TPR</mml:mtext><mml:mo>=</mml:mo><mml:mtext>FPR</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>, while the curves are pushed toward the upper left corner
<inline-formula id="inline-formula11-0748730414553029"><mml:math id="math12-0748730414553029"><mml:mrow><mml:mo>(</mml:mo><mml:mtext>TPR</mml:mtext><mml:mo>≫</mml:mo><mml:mtext>FPR</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> as algorithms improve. A perfect algorithm would yield a constant
<inline-formula id="inline-formula12-0748730414553029"><mml:math id="math13-0748730414553029"><mml:mrow><mml:mtext>TPR</mml:mtext><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> for all FPRs. In this way, the performance of algorithms can be ranked. ROC curves are independent of the prevalence, defined as the proportion of actual rhythmic time series, and thus give a picture valid for any real-world scenario. This comes at the cost of not being able to reflect the fraction of truly nonrhythmic time series among all those classified as rhythmic. This is the false discovery rate (FDR; Suppl. Fig. S2), and it is highly dependent on the prevalence—that is, the fraction of truly rhythmic time series in the data set (between 0 and 1): If a data set consists of only a small percentage of truly rhythmic time series, a high TPR and low FPR can still result in a high FDR (Suppl. Fig. S2). In biological data analysis, it is usually the FDR that is controlled for, often using Benjamini-Hochberg adjusted <italic>p</italic>-values as conservative estimates. Fortunately, some algebraic work result in the equation</p>
      <p>
        <disp-formula id="disp-formula2-0748730414553029">
          <alternatives>
            <mml:math id="math14-0748730414553029">
              <mml:mrow>
                <mml:mtext>TPR</mml:mtext>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                        <mml:mo>−</mml:mo>
                        <mml:msub>
                          <mml:mi>f</mml:mi>
                          <mml:mrow>
                            <mml:mtext>rhythmic</mml:mtext>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                    <mml:mo>×</mml:mo>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                        <mml:mo>−</mml:mo>
                        <mml:mtext>FDR</mml:mtext>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>f</mml:mi>
                      <mml:mrow>
                        <mml:mtext>rhythmic</mml:mtext>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>×</mml:mo>
                    <mml:mtext>FDR</mml:mtext>
                  </mml:mrow>
                </mml:mfrac>
                <mml:mo>×</mml:mo>
                <mml:mtext>FPR</mml:mtext>
                <mml:mo>,</mml:mo>
              </mml:mrow>
            </mml:math>
            <graphic xlink:href="10.1177_0748730414553029-eq2.jpg" position="float" orientation="portrait"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>where <inline-formula id="inline-formula13-0748730414553029"><mml:math id="math15-0748730414553029"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mtext>rhythmic</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the prevalence. This means that a given FDR threshold and prevalence are manifested as a straight line in the ROC diagram, in which the TPR is plotted against the FPR. Where this straight line crosses the ROC curve of an algorithm, the TPR achieved by the algorithm can be read off the <italic>y</italic>-axis (<xref ref-type="fig" rid="fig2-0748730414553029">Fig. 2</xref>). This combination of ROC curves and straight lines gives a complete bird’s-eye view of the quality of algorithms as well as their detection power at different FDR thresholds. To obtain the ROC curves in <xref ref-type="fig" rid="fig2-0748730414553029">Figure 2</xref>, 100,000 synthetic time series were generated for each wave form and amplitude-to-noise ratio; any irregularities in the ROC curve shapes were due to the intrinsic granularities of the null distributions rather than the effects of small sample sizes.</p>
      <fig id="fig2-0748730414553029" orientation="portrait" position="float">
        <label>Figure 2.</label>
        <caption>
          <p>RAIN benchmarking. Synthetic data and ROC curves were used to assess the power and accuracy of RAIN compared with those of JTK_CYCLE. (A) ROC curve showing results for 100,000 sine curves and sawtooth-shaped curves, respectively, with an amplitude-to-noise ratio of 0.2 and sampled every 3 h for two full 24-h periods. The straight lines correspond to an FDR of 0.1 with (from steepest to least steep slope) prevalences of 5%, 10%, and 25%, or equivalently due to the symmetry of Equation 2, a prevalence of 10% and FDRs of 0.05, 0.1, and 0.25, respectively. True positive rates (TPRs) for these criteria can be read off the diagrams at the intersections between the straight lines and the ROC curves. (B) TPRs for
<inline-formula id="inline-formula14-0748730414553029"><mml:math id="math16-0748730414553029"><mml:mrow><mml:mtext>FDR</mml:mtext><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and a prevalence of 25% (or vice versa). (C) Effect of different sampling rates. Here, amplitude-to-noise ratios were sampled from estimates coming from mouse liver microarray experiments (Methods and Suppl. Fig. S3). Thus, the result for a 3-h sampling interval is different from that depicted in panel A. Many more such panels are provided in Supplementary Figure S4.</p>
        </caption>
        <graphic xlink:href="10.1177_0748730414553029-fig2"/>
      </fig>
    </sec>
    <sec id="section5-0748730414553029">
      <title>Analysis of Microarray and Mass Spectrometry Data</title>
      <p>Microarray data were obtained from the Gene Expression Omnibus, accession numbers GSE30411 (<xref rid="bibr9-0748730414553029" ref-type="bibr">Hughes et al., 2012</xref>) and GSE11923 (<xref rid="bibr7-0748730414553029" ref-type="bibr">Hughes et al., 2009</xref>), and were normalized using RMA and GCRMA, respectively, grouping transcripts using ENSEMBL gene annotations (<xref rid="bibr3-0748730414553029" ref-type="bibr">Dai et al., 2005</xref>). Amplitudes and SDs of the noise (residuals) were estimated as described above using harmonic regression (<xref rid="bibr2-0748730414553029" ref-type="bibr">Cornelissen, 2014</xref>); amplitudes of transcript groups with a Benjamini-Hochberg-adjusted <italic>p</italic> ≤ 0.05 were used to sample amplitudes for the synthetic data (described above). The amplitude-to-noise distribution of these estimations is shown in Supplementary Figure S3.</p>
      <p>Present/absent calls were possible for the older microarray data due to the earlier platform used in that study (<xref rid="bibr7-0748730414553029" ref-type="bibr">Hughes et al., 2009</xref>); transcript groups were considered present if more than half of the samples produced an MAS5 present call. Harmonic regression <italic>p</italic>-value correction was performed for present transcripts only.</p>
      <p>Protein mass spectrometry data were obtained from the supplementary material of the original publications (<xref rid="bibr13-0748730414553029" ref-type="bibr">Mauvoisin et al., 2014</xref>; <xref rid="bibr15-0748730414553029" ref-type="bibr">Robles et al., 2014</xref>).</p>
      <p>RAIN and JTK_CYCLE (version 2) were in all cases run to detect oscillations of a period of 24 h. RAIN was further set to allow an umbrella peak between 30% and 70% of a whole period when analyzing microarray and mass spectrometry data and between 10% and 90% when analyzing the synthetic data.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="section6-0748730414553029">
    <title>Results</title>
    <sec id="section7-0748730414553029">
      <title>RAIN Detects Both Sawtooth-shaped and Sinusoidal Wave Forms</title>
      <p>We first aimed to rigorously study the power of RAIN for rhythm detection. For this, we applied the algorithm to synthetic data. The synthetic data were designed to have a random error component that is representative of the biological data that RAIN is supposed to analyze. To achieve this, we carefully studied the noise characteristics of 2 microarray studies of mouse liver and were able to extract a good noise model from those data (Methods). With this model, we generated synthetic time series of 3 types. The first one consisted of noise only; the second type was noise plus sine curves with amplitudes 1, 2, and 3 times as large as the noise SD, respectively, or with amplitude-to-noise ratios sampled from mouse liver microarray data (Methods); the third type consisted of noise plus sawtooth-shaped curves with amplitudes 1, 2, and 3 times as large as the noise SD, respectively, or with amplitudes sampled from microarray data. We then ran both RAIN and JTK_CYCLE with the synthetic data as inputs and used ROC curves (Methods) of the results to investigate the power of RAIN to detect rhythms. These curves allow an assessment of the power for rhythm detection of RAIN versus JTK_CYCLE while controlling for the FDR. The expectation was that RAIN, due to its design, should show a clear advantage when the rhythms are sawtooth-like, while both methods should readily be able to detect rhythms shaped as sine curves.</p>
      <p>This expectation turned out to be valid in all cases. <xref ref-type="fig" rid="fig2-0748730414553029">Figure 2</xref> shows representative ROC curves for RAIN and JTK_CYCLE applied to computer-generated sine and sawtooth-shaped time series, respectively. The null background consisted of pure noise (Methods). <xref ref-type="fig" rid="fig2-0748730414553029">Figure 2A</xref> gives results for synthetic data consisting of 16 samples taken every 3 h with an amplitude-to-noise ratio of 2. RAIN was able to detect a significant fraction of sawtooth-shaped wave forms that largely went undetected by JTK_CYCLE: For a prevalence for true positives of 25% and with an FDR of 0.1, RAIN recovered almost 60% of the sawtooth wave forms compared with less than 10% for JTK_CYCLE (<xref ref-type="fig" rid="fig2-0748730414553029">Fig. 2B</xref>). For the sine curves, the difference between the methods was very small. This is the pattern of other sampling rates and amplitudes as well—examples are shown in <xref ref-type="fig" rid="fig2-0748730414553029">Figure 2C</xref> also for cases where samples were taken every 2, 3, and 4 h, with a distribution of the oscillation amplitude-to-noise ratio sampled from estimates based on mouse liver microarray data (Methods). A complete survey of different sampling rates and amplitude-to-noise ratios is given as Supplementary Figure S4, including results for a set of synthetic time series with outliers.</p>
      <p>In summary, RAIN was able to recover significant fractions of asymmetric sawtooth-shaped wave forms, in contrast to the previous comparable method, without losing power to detect symmetric sine waves.</p>
    </sec>
    <sec id="section8-0748730414553029">
      <title>The Circadian Transcriptome of Mouse Liver Exhibits a Wealth of Sawtooth-shaped Wave Forms</title>
      <p>Considering the design and benchmarking of RAIN, we expected the method to discover hitherto undetected rhythms in biological data, in particular rhythms with nonsymmetric waveforms. The mouse liver microarray study by <xref rid="bibr9-0748730414553029" ref-type="bibr">Hughes et al. (2012)</xref>, consisting of 24 samples taken every 2 h, served to put this expectation to the test. Under a strict Benjamini-Hochberg corrected <italic>p</italic>-value cutoff of 0.01, RAIN detected 2014 rhythmically transcribed genes, compared with 810 genes detected by JTK_CYCLE. All genes detected by JTK_CYCLE were also detected by RAIN, whereas, in contrast, RAIN exclusively identified 1204 rhythmic transcripts (<xref ref-type="fig" rid="fig3-0748730414553029">Fig. 3</xref>). Using a more liberal cutoff of 0.05 for JTK_CYCLE, while staying with the strict cutoff for RAIN, still resulted in 564 rhythmically transcribed genes that were exclusively detected by RAIN (with no genes exclusively detected by JTK_CYCLE under the same criteria). A visual inspection of the top hits (<xref ref-type="fig" rid="fig3-0748730414553029">Fig. 3</xref>) confirms strong circadian rhythmicity and, indeed, markedly nonsymmetric and often sawtooth-like wave forms.</p>
      <fig id="fig3-0748730414553029" orientation="portrait" position="float">
        <label>Figure 3.</label>
        <caption>
          <p>Significantly expanded circadian transcriptomes and proteomes. With an FDR of 0.01, RAIN detects more than twice as many circadian transcripts in a mouse liver microarray data set (<xref rid="bibr9-0748730414553029" ref-type="bibr">Hughes et al., 2012</xref>) as does JTK_CYCLE. Rhythms only detected by RAIN were validated using a control data set (<xref rid="bibr7-0748730414553029" ref-type="bibr">Hughes et al., 2009</xref>) and an independent method (harmonic regression). The 12 transcripts with the lowest (adjusted) <italic>p</italic>-values that were only detected by RAIN under the FDR cutoff are shown and exhibit clear oscillations with asymmetric wave forms. Data from 2 studies using mass spectrometry to chart the mouse liver circadian proteome (<xref rid="bibr13-0748730414553029" ref-type="bibr">Mauvoisin et al., 2014</xref>; <xref rid="bibr15-0748730414553029" ref-type="bibr">Robles et al., 2014</xref>) were similarly analyzed, resulting in more than twice as many circadian proteins compared with the original studies.</p>
        </caption>
        <graphic xlink:href="10.1177_0748730414553029-fig3"/>
      </fig>
      <p>We next sought to systematically assess the general quality of the time series exclusively detected by RAIN: Are these time series really rhythmic? To this end, we analyzed a control study: an earlier mouse liver microarray study consisting of 48 samples taken every hour (<xref rid="bibr7-0748730414553029" ref-type="bibr">Hughes et al., 2009</xref>). We assessed rhythmicity in these control data using an unrelated method (harmonic regression with an adjusted <italic>p</italic>-value cutoff 0.01), which due to the much higher sampling rate used in this earlier study should be able to detect nonsinusoidal wave forms. We reasoned that if those transcripts of the primary study (<xref rid="bibr9-0748730414553029" ref-type="bibr">Hughes et al., 2012</xref>) that were detected exclusively by RAIN are truly rhythmic, many of these should also be detected by harmonic regression in the control data. Our results confirmed this conjecture: of the 1204 rhythmic transcripts that only RAIN detected in the primary data set (<xref ref-type="fig" rid="fig3-0748730414553029">Fig. 3</xref>), 946 were present in the control data set. It turned out that 65% of these 946 transcripts were flagged by the harmonic regression method as being rhythmic in the control data. For comparison, only 40% of expressed genes in that study were classified as rhythmic by the same method and criteria. This indicates that rhythms detected exclusively by RAIN are indeed reproducible biological phenomena rather than computational or measurement artifacts.</p>
      <p>To further gauge the performance of RAIN with time series sampled every 4 h (a common experimental design), we down-sampled the primary microarray time series (<xref rid="bibr9-0748730414553029" ref-type="bibr">Hughes et al., 2012</xref>) to comprise 12 measurements every 4 h. Also in this case, even when we used a stringent adjusted <italic>p</italic>-value cutoff for RAIN (0.1) and a less stringent cutoff for JTK_CYCLE (0.25), RAIN detected significantly more rhythmically transcribed genes than did JTK_CYCLE (1590 vs. 701 genes). Among those transcripts uniquely detected by RAIN that were also present in the control study, 66% were independently classified as rhythmic in the control study using harmonic regression, compared with the overall 40% rhythmic transcripts.</p>
      <p>In summary, RAIN was able to detect much more rhythmically transcribed genes than was JTK_CYCLE. Detected rhythms exhibited nonsymmetric waveforms and were confirmed using a control data set and an independent method.</p>
    </sec>
    <sec id="section9-0748730414553029">
      <title>An Expanded Circadian Proteome</title>
      <p>Mass spectrometry (MS) approaches have been used to quantify circadian rhythmicity in protein abundances on a proteome-wide scale (<xref rid="bibr13-0748730414553029" ref-type="bibr">Mauvoisin et al., 2014</xref>; <xref rid="bibr15-0748730414553029" ref-type="bibr">Robles et al., 2014</xref>). However, MS cannot presently quantify the entire mouse liver proteome but is biased in its detection capability to abundant, long-lived proteins. Since amplitudes of rhythms inevitably decrease with increasing protein lifetimes (<xref rid="bibr11-0748730414553029" ref-type="bibr">Lück et al., Forthcoming</xref>), oscillations in protein abundances observed in these studies tend to have small amplitudes. In addition to this, significant non-Gaussian experimental noise is inherent to MS measurements. Rhythm detection is thus challenging for these data, and it is therefore not surprising that only 195 and 186 proteins were flagged for rhythmic abundances in the <xref rid="bibr13-0748730414553029" ref-type="bibr">Mauvoisin et al. (2014)</xref> and <xref rid="bibr15-0748730414553029" ref-type="bibr">Robles et al. (2014)</xref> studies, respectively (both with an experimental design of 16 tissue samples pooled from several mice and taken every 3 h). These calls were made using methods based on harmonic regression and with quite high Benjamini-Hochberg adjusted <italic>p</italic>-value cutoffs: 0.25 and 0.33, respectively (serving as FDR estimates).</p>
      <p>We applied RAIN to these data and detected 316 and 384 proteins with circadian rhythms in their abundance, respectively, using an adjusted <italic>p</italic>-value cutoff of 0.25. This represents a significant expansion on previous results, with the caveat of having the same relatively high FDR as in the original studies. Instead using a lower adjusted <italic>p</italic>-value cutoff of 0.15, we detected 181 and 196 circadian proteins—almost the same numbers as in the original studies but with much improved FDRs. One should note, however, that these numbers must not be used as estimates for the total number of circadian proteins; rather, for this, methods such as the lowest slope estimator are appropriate (<xref rid="bibr1-0748730414553029" ref-type="bibr">Benjamini and Hochberg, 2000</xref>).</p>
      <p>Time series of the top 12 rhythmic proteins (lowest Benjamini-Hochberg adjusted <italic>p</italic>-values) that were not detected in the original studies are plotted in <xref ref-type="fig" rid="fig3-0748730414553029">Figure 3</xref>, and circadian patterns are obvious by visual inspection. Noteworthy also are the peculiar experimental noise characteristics of these data, manifested as missing values and outliers, which particularly call for robust nonparametric methods such as RAIN and JTK_CYCLE. The latter method, however, was only able to detect 35 and 25 proteins from the <xref rid="bibr13-0748730414553029" ref-type="bibr">Mauvoisin et al. (2014)</xref> and <xref rid="bibr15-0748730414553029" ref-type="bibr">Robles et al. (2014)</xref> studies, respectively, with a high FDR of 0.25.</p>
      <p>Further analysis of the functions of proteins whose abundances were classified as rhythmic illustrates that the method of rhythm detection matters for conclusions about biological function. The proteins classified as rhythmic in the original study (<xref rid="bibr13-0748730414553029" ref-type="bibr">Mauvoisin et al., 2014</xref>) are highly enriched for secreted proteins, according to the functional annotation service DAVID. We recovered this result also with the proteins that RAIN classified as rhythmic, but additionally we found previously unnoticed functional characteristics of the circadian proteome. This includes enrichment for proteins associated with the mitochondrion, as well as chaperones and binding to unfolded proteins, lysosomal proteins, and proteins involved in iron and drug metabolism. If we expand the analysis to the proteins with abundances classified as rhythmic in both studies, a different picture emerges. Cofactor and vitamin binding are enriched functions in the smaller set of proteins resulting from the detection methods in the original studies (31 proteins). In contrast, RAIN detects a considerably larger overlap of rhythmic proteins between the studies (61 proteins, FDR 0.25), and here again, protein folding and unfolded protein binding are overrepresented functions. The DAVID results for these 61 circadian proteins are given in Supplementary Table S1. These protein numbers could be compared with the mere 5 common proteins detected by JTK_CYCLE, FDR 0.25.</p>
      <p>Thus, with RAIN, the circadian proteome was significantly expanded. Studying this expanded group of proteins, we recovered previous results but also discovered previously unidentified functions of proteins with rhythmic abundances.</p>
    </sec>
  </sec>
  <sec id="section10-0748730414553029">
    <title>Discussion and Outlook</title>
    <p>We have presented RAIN, a robust nonparametric method for detection of rhythms in time series, that makes few assumptions about wave form shape. We have shown rigorously that the method has a sensitivity that is superior to previous methods while controlling the false discovery rate. This largely stemmed from an ability to detect nonsymmetric wave forms, such as sawtooth-like shapes, while preserving a robust sensitivity for symmetric wave forms. Consequently, a result of RAIN when applied to mouse liver transcriptome- and proteome-wide data was significantly expanded sets of transcripts and proteins with circadian rhythms in abundance, compared with previous studies.</p>
    <p>Although RAIN was designed for research on circadian rhythms, the method is applicable for rhythm detection in any time series. We do, however, recommend sampling over more than one period in order to readily discriminate between sawtooth-shaped waveforms and linear trends. A practical limitation could be time series length: The algorithm was developed and tested for time series with moderate numbers of time points (on the order of 10-100), for which rhythm detection is challenging when the experimental noise characteristics are complex. We point out that the run time of the algorithm can be significant for very long time series (the same is true for JTK_CYCLE). Fortunately, for these cases, classic parametric methods, such as harmonic regression or periodogram-based methods, often perform very well also when the noise is non-Gaussian. Another limitation to RAIN and JTK_CYCLE, but also to harmonic regression, is the assumption of uncorrelated or at least only weakly correlated noise. This assumption is certainly justified for data coming from experimental designs where different animals are sacrificed at each time points, such as those data analyzed here. However, for certain types of experiments, for example where all samples are taken from one cell culture that in addition exhibits strongly correlated fluctuations in the readout, simulations of more realistic null models may be required (<xref rid="bibr4-0748730414553029" ref-type="bibr">Futschik and Herzel, 2008</xref>).</p>
    <p>RAIN readily detects symmetric wave forms (<xref ref-type="fig" rid="fig2-0748730414553029">Fig. 2</xref>), but there is still a small but measurable advantage of using JTK_CYCLE if the underlying wave form is perfectly symmetric. This is because RAIN does not make comparisons between measurements in the rising and falling parts of the time series. Thus, when the goal is to explicitly detect symmetric rhythms only, JTK_CYCLE will still be the method of choice. The same is true if the goal is to detect one known particular curve shape, since this can be implemented as a minor modification of the JTK_CYCLE code base.</p>
    <p>RAIN does not measure periods, amplitudes, and phases, although naive estimates would be easy to obtain. The reason for this is that such so-called point estimation should preferably fulfill the criteria of consistency (estimates converging to the true values as the number of time points sampled goes to infinity) and unbiasedness (the expected estimate for a finite number of time points sampled should be equal to the true value). These criteria are not met when one is using the results of RAIN to estimate periods, amplitudes, and phases. The algorithm was designed for hypothesis testing rather than for point estimation. For this reason, we also recommend against using the period and phase estimates provided by JTK_CYCLE, which are not consistent or unbiased. However, JTK_CYCLE does implement an interesting and promising amplitude estimation method. We furthermore recommend complementing hypothesis testing with amplitude estimation when selecting genes or proteins of interest, since it is safe to assume that biological function of rhythms requires reasonable amplitudes. Classic harmonic regression is still well suited for this, although there is also a need in the field for new point estimation methods more robust to outliers.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="SD1">
      <caption>
        <title>Supplementary material</title>
      </caption>
      <media mimetype="application" mime-subtype="pdf" xlink:href="Figure_S4.pdf" orientation="portrait" id="d35e909" position="anchor"/>
    </supplementary-material>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="SD2">
      <caption>
        <title>Supplementary material</title>
      </caption>
      <media mimetype="application" mime-subtype="pdf" xlink:href="thaben-jbr_supp.pdf" orientation="portrait" id="d35e917" position="anchor"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We thank S. Hertel for a critical reading of the manuscript and A. Kramer, B. Maier, H. Herzel, E. Herzog, A. Granada, C. Romualdi, R. Costa, E. Farre, and M. S. Robles for discussions and testing of the software. Funding from BMBF (FKZ 0315899, Circage/GerontoSys) is gratefully acknowledged.</p>
  </ack>
  <fn-group>
    <fn fn-type="conflict">
      <p><bold>Conflict of Interest Statement:</bold> The author(s) have no potential conflicts of interest with respect to the research, authorship, and/or publication of this article.</p>
    </fn>
  </fn-group>
  <notes>
    <fn-group>
      <fn fn-type="supplementary-material">
        <p>Supplementary material is available on the journal’s website at http:// jbr. sagepub. com/ supplemental.</p>
      </fn>
    </fn-group>
  </notes>
  <ref-list>
    <title>References</title>
    <ref id="bibr1-0748730414553029">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Benjamini</surname><given-names>Y</given-names></name><name><surname>Hochberg</surname><given-names>Y</given-names></name></person-group> (<year>2000</year>) <article-title>On the adaptive control of the false discovery rate in multiple testing with independent statistics</article-title>. <source>J Educ Behav Stat</source>
<volume>25</volume>:<fpage>60</fpage>-<lpage>83</lpage>.</mixed-citation>
    </ref>
    <ref id="bibr2-0748730414553029">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cornelissen</surname><given-names>G</given-names></name></person-group> (<year>2014</year>) <article-title>Cosinor-based rhythmometry</article-title>. <source>Theor Biol Med Model</source>
<volume>11</volume>:<fpage>16</fpage>.<pub-id pub-id-type="pmid">24725531</pub-id></mixed-citation>
    </ref>
    <ref id="bibr3-0748730414553029">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dai</surname><given-names>M</given-names></name><name><surname>Wang</surname><given-names>P</given-names></name><name><surname>Boyd</surname><given-names>AD</given-names></name><name><surname>Kostov</surname><given-names>G</given-names></name><name><surname>Athey</surname><given-names>B</given-names></name><name><surname>Jones</surname><given-names>EG</given-names></name><name><surname>Bunney</surname><given-names>WE</given-names></name><name><surname>Myers</surname><given-names>RM</given-names></name><name><surname>Speed</surname><given-names>TP</given-names></name><name><surname>Akil</surname><given-names>H</given-names></name><etal/></person-group> (<year>2005</year>) <article-title>Evolving gene/transcript definitions significantly alter the interpretation of GeneChip data</article-title>. <source>Nucleic Acids Res</source>
<volume>33</volume>:<fpage>e175</fpage>.<pub-id pub-id-type="pmid">16284200</pub-id></mixed-citation>
    </ref>
    <ref id="bibr4-0748730414553029">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Futschik</surname><given-names>ME</given-names></name><name><surname>Herzel</surname><given-names>H</given-names></name></person-group> (<year>2008</year>) <article-title>Are we overestimating the number of cell-cycling genes? The impact of background models on time-series analysis</article-title>. <source>Bioinformatics</source>
<volume>24</volume>:<fpage>1063</fpage>-<lpage>1069</lpage>.<pub-id pub-id-type="pmid">18310054</pub-id></mixed-citation>
    </ref>
    <ref id="bibr5-0748730414553029">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Halberg</surname><given-names>F</given-names></name><name><surname>Tong</surname><given-names>YL</given-names></name><name><surname>Johnson</surname><given-names>EA</given-names></name></person-group> (<year>1967</year>) <article-title>Circadian system phase—an aspect of temporal morphology; procedures and illustrative examples</article-title>. In <source>The Cellular Aspects of Biorhythms</source>, <person-group person-group-type="editor"><name><surname>von Mayersbach</surname><given-names>H</given-names></name></person-group>, ed, pp <fpage>20</fpage>-<lpage>48</lpage>. <publisher-loc>Berlin and Heidelberg</publisher-loc>: <publisher-name>Springer</publisher-name>.</mixed-citation>
    </ref>
    <ref id="bibr6-0748730414553029">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harding</surname><given-names>EF</given-names></name></person-group> (<year>1984</year>) <article-title>An efficient, minimal-storage procedure for calculating the Mann-Whitney U, generalized U and similar distributions</article-title>. <source>J R Stat Soc Ser C Appl Stat</source>
<volume>33</volume>:<fpage>1</fpage>-<lpage>6</lpage>.</mixed-citation>
    </ref>
    <ref id="bibr7-0748730414553029">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hughes</surname><given-names>ME</given-names></name><name><surname>DiTacchio</surname><given-names>L</given-names></name><name><surname>Hayes</surname><given-names>KR</given-names></name><name><surname>Vollmers</surname><given-names>C</given-names></name><name><surname>Pulivarthy</surname><given-names>S</given-names></name><name><surname>Baggs</surname><given-names>JE</given-names></name><name><surname>Panda</surname><given-names>S</given-names></name><name><surname>Hogenesch</surname><given-names>JB</given-names></name></person-group> (<year>2009</year>) <article-title>Harmonics of circadian gene transcription in mammals</article-title>. <source>PLoS Genet</source>
<volume>5</volume>:<fpage>e1000442</fpage>.<pub-id pub-id-type="pmid">19343201</pub-id></mixed-citation>
    </ref>
    <ref id="bibr8-0748730414553029">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hughes</surname><given-names>ME</given-names></name><name><surname>Hogenesch</surname><given-names>JB</given-names></name><name><surname>Kornacker</surname><given-names>K</given-names></name></person-group> (<year>2010</year>) <article-title>JTK_CYCLE: an efficient nonparametric algorithm for detecting rhythmic components in genome-scale data sets</article-title>. <source>J Biol Rhythms</source>
<volume>25</volume>:<fpage>372</fpage>-<lpage>380</lpage>.<pub-id pub-id-type="pmid">20876817</pub-id></mixed-citation>
    </ref>
    <ref id="bibr9-0748730414553029">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hughes</surname><given-names>ME</given-names></name><name><surname>Hong</surname><given-names>HK</given-names></name><name><surname>Chong</surname><given-names>JL</given-names></name><name><surname>Indacochea</surname><given-names>AA</given-names></name><name><surname>Lee</surname><given-names>SS</given-names></name><name><surname>Han</surname><given-names>M</given-names></name><name><surname>Takahashi</surname><given-names>JS</given-names></name><name><surname>Hogenesch</surname><given-names>JB</given-names></name></person-group> (<year>2012</year>) <article-title>Brain-specific rescue of Clock reveals system-driven transcriptional rhythms in peripheral tissue</article-title>. <source>PLoS Genet</source>
<volume>8</volume>:<fpage>e1002835</fpage>.<pub-id pub-id-type="pmid">22844252</pub-id></mixed-citation>
    </ref>
    <ref id="bibr10-0748730414553029">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jonckheere</surname><given-names>AR</given-names></name></person-group> (<year>1954</year>) <article-title>A distribution-free k-sample test against ordered alternatives</article-title>. <source>Biometrika</source>
<volume>41</volume>:<fpage>133</fpage>-<lpage>145</lpage>.</mixed-citation>
    </ref>
    <ref id="bibr11-0748730414553029">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lück</surname><given-names>S</given-names></name><name><surname>Thurley</surname><given-names>K</given-names></name><name><surname>Thaben</surname><given-names>PF</given-names></name><name><surname>Westermark</surname><given-names>PO</given-names></name></person-group> (<year>Forthcoming</year>) <article-title>Rhythmic degradation explains and unifies circadian transcriptome and proteome data</article-title>. <source>Cell Rep</source>.</mixed-citation>
    </ref>
    <ref id="bibr12-0748730414553029">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mack</surname><given-names>GA</given-names></name><name><surname>Wolfe</surname><given-names>DA</given-names></name></person-group> (<year>1981</year>) <article-title>K-sample rank tests for umbrella alternatives</article-title>. <source>J Am Stat Assoc</source>
<volume>76</volume>:<fpage>175</fpage>-<lpage>181</lpage>.</mixed-citation>
    </ref>
    <ref id="bibr13-0748730414553029">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mauvoisin</surname><given-names>D</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name><name><surname>Jouffe</surname><given-names>C</given-names></name><name><surname>Martin</surname><given-names>E</given-names></name><name><surname>Atger</surname><given-names>F</given-names></name><name><surname>Waridel</surname><given-names>P</given-names></name><name><surname>Quadroni</surname><given-names>M</given-names></name><name><surname>Gachon</surname><given-names>F</given-names></name><name><surname>Naef</surname><given-names>F</given-names></name></person-group> (<year>2014</year>) <article-title>Circadian clock-dependent and -independent rhythmic proteomes implement distinct diurnal functions in mouse liver</article-title>. <source>Proc Natl Acad Sci U S A</source>
<volume>111</volume>:<fpage>167</fpage>-<lpage>172</lpage>.<pub-id pub-id-type="pmid">24344304</pub-id></mixed-citation>
    </ref>
    <ref id="bibr14-0748730414553029">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Michael</surname><given-names>TP</given-names></name><name><surname>Mockler</surname><given-names>TC</given-names></name><name><surname>Breton</surname><given-names>G</given-names></name><name><surname>McEntee</surname><given-names>C</given-names></name><name><surname>Byer</surname><given-names>A</given-names></name><name><surname>Trout</surname><given-names>JD</given-names></name><name><surname>Hazen</surname><given-names>SP</given-names></name><name><surname>Shen</surname><given-names>R</given-names></name><name><surname>Priest</surname><given-names>HD</given-names></name><name><surname>Sullivan</surname><given-names>CM</given-names></name><etal/></person-group> (<year>2008</year>) <article-title>Network discovery pipeline elucidates conserved time-of-day–specific cis-regulatory modules</article-title>. <source>PLoS Genet</source>
<volume>4</volume>:<fpage>e14</fpage>.<pub-id pub-id-type="pmid">18248097</pub-id></mixed-citation>
    </ref>
    <ref id="bibr15-0748730414553029">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robles</surname><given-names>MS</given-names></name><name><surname>Cox</surname><given-names>J</given-names></name><name><surname>Mann</surname><given-names>M</given-names></name></person-group> (<year>2014</year>) <article-title>In-vivo quantitative proteomics reveals a key contribution of post-transcriptional mechanisms to the circadian regulation of liver metabolism</article-title>. <source>PLoS Genet</source>
<volume>10</volume>:<fpage>e1004047</fpage>.<pub-id pub-id-type="pmid">24391516</pub-id></mixed-citation>
    </ref>
    <ref id="bibr16-0748730414553029">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Straume</surname><given-names>M</given-names></name></person-group> (<year>2004</year>) <article-title>DNA microarray time series analysis: automated statistical assessment of circadian rhythms in gene expression patterning</article-title>. <source>Methods Enzymol</source>
<volume>383</volume>:<fpage>149</fpage>-<lpage>166</lpage>.<pub-id pub-id-type="pmid">15063650</pub-id></mixed-citation>
    </ref>
    <ref id="bibr17-0748730414553029">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Streitberg</surname><given-names>B</given-names></name><name><surname>Röhmel</surname><given-names>J</given-names></name></person-group> (<year>1988</year>) <article-title>Exact nonparametrics for partial order tests</article-title>. <source>Comput Stat Q</source>
<volume>1</volume>:<fpage>23</fpage>-<lpage>41</lpage>.</mixed-citation>
    </ref>
    <ref id="bibr18-0748730414553029">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Terpstra</surname><given-names>T</given-names></name></person-group> (<year>1952</year>) <article-title>The asymptotic normality and consistency of Kendall’s test against trend, when ties are present in one ranking</article-title>. <source>Indagationes Mathematicae</source>
<volume>14</volume>:<fpage>327</fpage>-<lpage>333</lpage>.</mixed-citation>
    </ref>
    <ref id="bibr19-0748730414553029">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wichert</surname><given-names>S</given-names></name><name><surname>Fokianos</surname><given-names>K</given-names></name><name><surname>Strimmer</surname><given-names>K</given-names></name></person-group> (<year>2004</year>) <article-title>Identifying periodically expressed transcripts in microarray time series data</article-title>. <source>Bioinformatics</source>
<volume>20</volume>:<fpage>5</fpage>-<lpage>20</lpage>.<pub-id pub-id-type="pmid">14693803</pub-id></mixed-citation>
    </ref>
    <ref id="bibr20-0748730414553029">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wijnen</surname><given-names>H</given-names></name><name><surname>Naef</surname><given-names>F</given-names></name><name><surname>Young</surname><given-names>MW</given-names></name></person-group> (<year>2005</year>) <article-title>Molecular and statistical tools for circadian transcript profiling</article-title>. <source>Methods Enzymol</source>
<volume>393</volume>:<fpage>341</fpage>-<lpage>365</lpage>.<pub-id pub-id-type="pmid">15817298</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
