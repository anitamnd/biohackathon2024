<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <?epub April-12-2013?>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-id journal-id-type="hwp">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3675459</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkt187</article-id>
    <article-id pub-id-type="publisher-id">gkt187</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methods Online</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>RNA global alignment in the joint sequence–structure space using elastic shape analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Laborde</surname>
          <given-names>Jose</given-names>
        </name>
        <xref ref-type="aff" rid="gkt187-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Robinson</surname>
          <given-names>Daniel</given-names>
        </name>
        <xref ref-type="aff" rid="gkt187-AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Srivastava</surname>
          <given-names>Anuj</given-names>
        </name>
        <xref ref-type="aff" rid="gkt187-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Klassen</surname>
          <given-names>Eric</given-names>
        </name>
        <xref ref-type="aff" rid="gkt187-AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Jinfeng</given-names>
        </name>
        <xref ref-type="aff" rid="gkt187-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="gkt187-COR1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="gkt187-AFF1"><sup>1</sup>Department of Statistics, Florida State University, FL, USA and <sup>2</sup>Department of Mathematics, Florida State University, FL, USA</aff>
    <author-notes>
      <corresp id="gkt187-COR1">*To whom correspondence should be addressed. Tel: <phone>+1 850 644 3218</phone>; Fax: <fax>+1 850 644 5271</fax>; Email: <email>jinfeng@stat.fsu.edu</email></corresp>
      <corresp id="gkt187-COR2">Correspondence may also be addressed to Anuj Srivastava. Tel: <phone>+1 850 644 3218</phone>; Fax: <fax>+1 850 644 5271</fax>; Email: <email>anuj@stat.fsu.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>6</month>
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>12</day>
      <month>4</month>
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>12</day>
      <month>4</month>
      <year>2013</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>41</volume>
    <issue>11</issue>
    <fpage>e114</fpage>
    <lpage>e114</lpage>
    <history>
      <date date-type="received">
        <day>9</day>
        <month>8</month>
        <year>2012</year>
      </date>
      <date date-type="rev-recd">
        <day>26</day>
        <month>2</month>
        <year>2013</year>
      </date>
      <date date-type="accepted">
        <day>27</day>
        <month>2</month>
        <year>2013</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2013. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2013</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/3.0/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/3.0/">http://creativecommons.org/licenses/by-nc/3.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <abstract>
      <p>The functions of RNAs, like proteins, are determined by their structures, which, in turn, are determined by their sequences. Comparison/alignment of RNA molecules provides an effective means to predict their functions and understand their evolutionary relationships. For RNA sequence alignment, most methods developed for protein and DNA sequence alignment can be directly applied. RNA 3-dimensional structure alignment, on the other hand, tends to be more difficult than protein structure alignment due to the lack of regular secondary structures as observed in proteins. Most of the existing RNA 3D structure alignment methods use only the backbone geometry and ignore the sequence information. Using both the sequence and backbone geometry information in RNA alignment may not only produce more accurate classification, but also deepen our understanding of the sequence–structure–function relationship of RNA molecules. In this study, we developed a new RNA alignment method based on elastic shape analysis (ESA). ESA treats RNA structures as three dimensional curves with sequence information encoded on additional dimensions so that the alignment can be performed in the joint sequence–structure space. The similarity between two RNA molecules is quantified by a formal distance, geodesic distance. Based on ESA, a rigorous mathematical framework can be built for RNA structure comparison. Means and covariances of full structures can be defined and computed, and probability distributions on spaces of such structures can be constructed for a group of RNAs. Our method was further applied to predict functions of RNA molecules and showed superior performance compared with previous methods when tested on benchmark datasets. The programs are available at <ext-link ext-link-type="uri" xlink:href="http://stat.fsu.edu/">http://stat.fsu.edu/</ext-link> ∼jinfeng/ESA.html.</p>
    </abstract>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>INTRODUCTION</title>
    <p>Recent discoveries have shown that RNA molecules play important roles in many biological processes such as enzymatic activity, protein synthesis and transport, gene transcriptional regulation, RNA processing and splicing and chromosome replication (<xref ref-type="bibr" rid="gkt187-B1 gkt187-B2 gkt187-B3 gkt187-B4 gkt187-B5">1–5</xref>). This changed the traditional view of RNA being solely a carrier of genetic information (<xref ref-type="bibr" rid="gkt187-B1">1</xref>,<xref ref-type="bibr" rid="gkt187-B6">6</xref>,<xref ref-type="bibr" rid="gkt187-B7">7</xref>). Comparison of RNAs, including both sequence alignment and structure alignment, can reveal the conserved motifs important for RNA functions, the evolutionary relationships of RNAs and the sequence–structure–function relationship of RNAs in general (<xref ref-type="bibr" rid="gkt187-B6">6</xref>).</p>
    <p>Compared with protein alignments, the comparison/alignment of RNAs is much less studied (<xref ref-type="bibr" rid="gkt187-B8 gkt187-B9 gkt187-B10 gkt187-B11 gkt187-B12 gkt187-B13 gkt187-B14 gkt187-B15 gkt187-B16 gkt187-B17 gkt187-B18">8–18</xref>). Although the alignment of RNA sequences can borrow directly those methods developed for protein or DNA sequence alignment, many methods designed for protein structure alignment cannot be readily used for alignment of RNA structures. This is partially due to the difference between the secondary structures of proteins and RNAs.</p>
    <p>In the rest of the Introduction, current methods for RNA structure alignment will be briefly reviewed, followed by a conceptual description of our own method. Since local structural motifs of RNAs often have specific functions, instead of comparing the overall structures, some studies focus on detection of local structural motifs [such as NASSAM (<xref ref-type="bibr" rid="gkt187-B17">17</xref>), COMPADRES (<xref ref-type="bibr" rid="gkt187-B16">16</xref>), RNAMotifScan (<xref ref-type="bibr" rid="gkt187-B19">19</xref>) and FR3D (<xref ref-type="bibr" rid="gkt187-B15">15</xref>)]. This is analogous to the identification of functional domains in proteins. Methods that compare 3D RNA structures at scales larger than motifs can be divided largely into two types. The first type of methods represents nucleotide residues by some local structure features, which allow them to reduce the 3D structures to 1D sequences. The resulting 1D sequences can then be aligned using traditional sequence alignment methods. The second type of methods start from alignment of similar local structures and then aims to obtain larger scale alignment by extending the initial local alignment. Among the first type of methods, SARA uses a set of unit vectors derived from consecutive nucleotides to represent each nucleotide. The difference of nucleotides can be compared via the unit vectors using unit-vector root mean square (URMS) as distance (<xref ref-type="bibr" rid="gkt187-B8">8</xref>,<xref ref-type="bibr" rid="gkt187-B9">9</xref>); iPARTS uses structural alphabet (SA) derived from backbone torsion angles, which are discretized into 23 states. A substitution matrix is then derived for the alphabet of 23 letters and used in the sequence alignment (<xref ref-type="bibr" rid="gkt187-B10">10</xref>). LaJolla uses a n-gram model for analysing the sequences derived from the torsion angles of nucleotides (<xref ref-type="bibr" rid="gkt187-B12">12</xref>). Similarly, PRIMOS/AMIGOS (<xref ref-type="bibr" rid="gkt187-B13">13</xref>) and DIAL (<xref ref-type="bibr" rid="gkt187-B14">14</xref>) also use torsion angles to represent nucleotides and align RNA on a sequence space encoded by the torsion angle representation. The above approaches do not necessarily produce globally similar alignment between two RNA structures [i.e. with small RMSDs (root mean square deviations)]. To achieve smaller RMSD for the aligned parts, extra steps need to be taken after the sequence alignment.</p>
    <p>Among the second type of RNA structure alignment methods, ARTS used P (phosphor) atoms of two consecutive base pairs as seeds and aligned the overall structures based on the alignment of structurally similar seed quadrants between the two RNA molecules (<xref ref-type="bibr" rid="gkt187-B11">11</xref>). In R3D Align, local alignments are merged to form a global alignment by using a maximum clique algorithm on a specially defined graph called a local alignment graph (<xref ref-type="bibr" rid="gkt187-B18">18</xref>).</p>
    <p>Sequence alignment uses information of side chains, which are reduced to single letters, and structure alignment uses information of the backbone geometry. Both methods have their advantages and disadvantages. Sequence alignment can be used to compare any two or multiple RNA molecules with sequence information, which is readily available. But such methods often perform poorly for remotely related sequences, and will not work for related structures without detectable sequence similarities. Structure alignment, on the other hand, fills in that gap by using structure information directly. Structure alignment also allows for detection of common functional motifs/domains in a set of structures. However, structure information is far more difficult to obtain than sequences. Even though the nucleotide sequences are available, most structure alignment methods do not use this information. A valid question is, can sequences provide additional useful information for structure alignment? Combining both structure and sequence information in RNA comparison may also provide more insight on the sequence–structure–function relationships of these molecules.</p>
    <p>In this study, we address this problem using a novel approach, called elastic shape analysis (ESA). Recently, ESA has been successfully applied to protein structure comparison (<xref ref-type="bibr" rid="gkt187-B20">20</xref>,<xref ref-type="bibr" rid="gkt187-B21">21</xref>). ESA treats protein/RNA structures as three dimensional curves and uses a geometric framework that has been developed originally in image analysis and computer vision for shape analysis of parameterized curves and surfaces (<xref ref-type="bibr" rid="gkt187-B22 gkt187-B23 gkt187-B24 gkt187-B25">22–25</xref>). The basic idea in this framework is to design an infinite-dimensional manifold of curves, endow it with a metric structure and compare any two objects by computing the distances between them on this manifold. Under this framework, we will be able to (i) quantify the similarity between any two protein/RNA structures by a formal distance, geodesic distance, computed on their respective shape manifolds. These geodesics can be seen as optimal deformations of objects into each other; (ii) compute intrinsic statistics of the shapes of a collection of protein/RNA conformations. For instance, one can compute their means and variances to study the statistical variability of shapes within the same group; and (iii) use the moments computed above to impose a full probability model on a shape group using a wrapped Gaussian density. This type of probability density can be used for statistical analysis and hypothesis testing of future structures. A nice property of ESA is that additional information can be readily added and the resulting distance can still be a formal one. In this study, we apply ESA to RNA structure alignment and extend the original framework to compare RNA molecules in the joint sequence-structure space.</p>
    <p>In the following sections, we will first present the ESA method for RNA structure and sequence comparison. We then apply the method on benchmark datasets for RNA function prediction and compare its performance with that of previous methods. Finally, we provide a discussion and our conclusions.</p>
  </sec>
  <sec sec-type="methods">
    <title>METHODOLOGY</title>
    <sec>
      <title>Elastic shape analysis in the joint sequence–structure space</title>
      <p>A mathematical and statistical framework based on ESA has been recently developed for protein and RNA structure alignment where only the backbone geometric information was used in distance calculations (<xref ref-type="bibr" rid="gkt187-B20">20</xref>, <xref ref-type="bibr" rid="gkt187-B21">21</xref>, <xref ref-type="bibr" rid="gkt187-B26">26</xref>). In this study, we extend the framework by incorporating additional dimensions containing sequence information so that the comparison can be done in the joint sequence–structure space. For the sake of completeness, we describe the key points of the original framework while focusing more on the new development.</p>
      <p>For RNA structure comparison, ESA treats the backbone structures of RNA molecules as parameterized curves in <italic>R</italic><sup>3</sup>. Since the comparisons involve shapes, the resulting quantifications should not depend on the rigid motions and parameterizations of these curves. When incorporating additional information, such as sequences, we add extra coordinates resulting in curves in higher dimensions. Since the structure dimensions and sequence dimensions represent different types of information, they are treated differently at certain steps of the ESA procedure. We represent each parameterized curve with a special function called the square root velocity function (SRVF) and restrict to the manifold of such functions under the desired constraints. To compare shapes of curves, we remove all shape-preserving transformations from this representation. This is done using an algebraic technique—we form a quotient space of the original manifold with respect to these shape-preserving transformation groups. In the resulting quotient space, called the shape space of elastic curves, one can perform statistical analysis of curves as if they are random variables. One can compare, match and deform one curve into another, or compute averages and covariances of curve populations, and perform hypothesis testing and classification of curves according to their shapes.</p>
      <p>When incorporating sequence information as additional dimensions, nucleotides need to be converted to numerical values while the distances among them should still be sensible. A distance matrix or substitution matrix need to be used to derive the conversion rule. Here we use the Jukes and Cantor substitution matrix (<xref ref-type="bibr" rid="gkt187-B27">27</xref>), a commonly used and also the simplest substitution model (JC model). JC model assumes equal base frequency and equal mutation rates, suggesting that the four nucleotides must have equal distance from one another. Consequently, we use a regular tetrahedron to represent the four nucleotides, where the numerical values of the four nucleotides are set to be the coordinates of the four vertices of the tetrahedron. Specifically, we have <inline-formula><inline-graphic xlink:href="gkt187i1.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="gkt187i2.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="gkt187i3.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="gkt187i4.jpg"/></inline-formula>. The distance between any pair of these points is <inline-formula><inline-graphic xlink:href="gkt187i5.jpg"/></inline-formula>. Note that it is impossible to embed four equidistant points in two dimensions and doing this in four dimensions is unnecessary. It is also possible to adopt other substitution matrices in a similar fashion.</p>
      <p>Now suppose we have a sequence of <italic>n</italic> P (phosphor) atoms with coordinates <inline-formula><inline-graphic xlink:href="gkt187i6.jpg"/></inline-formula><inline-formula><inline-graphic xlink:href="gkt187i6a.jpg"/></inline-formula>, taken from the PDB (<xref ref-type="bibr" rid="gkt187-B28">28</xref>, <xref ref-type="bibr" rid="gkt187-B29">29</xref>) file of an RNA molecule. The corresponding sequence coordinates according to the representation above are <inline-formula><inline-graphic xlink:href="gkt187i7.jpg"/></inline-formula>. The RNA molecule is represented as a curve in <italic>R</italic><sup>6</sup> going through the points
<disp-formula><graphic xlink:href="gkt187um1"/></disp-formula>
where <italic>λ</italic> is a weight that controls the contribution of the sequence information in the alignment. The greater the value of <italic>λ</italic>, the more influential the sequence information will be, and for a very large <italic>λ</italic>, only sequence information will be relevant. Conversely, if <inline-formula><inline-graphic xlink:href="gkt187i8.jpg"/></inline-formula>, the alignment is done only in the structure space.</p>
      <p>Using the representation above, given an RNA structure, we construct a continuous parameterized curve that interpolates the points <inline-formula><inline-graphic xlink:href="gkt187i9.jpg"/></inline-formula>, which will map the interval [0,1] to <italic>R</italic><sup>6</sup>. We will denote this parameterizing variable as <italic>t</italic>. We assign the <inline-formula><inline-graphic xlink:href="gkt187i10.jpg"/></inline-formula> values corresponding to <inline-formula><inline-graphic xlink:href="gkt187i11.jpg"/></inline-formula> as follows:
<disp-formula><graphic xlink:href="gkt187um2"/></disp-formula>
<disp-formula><graphic xlink:href="gkt187um3"/></disp-formula>
<disp-formula><graphic xlink:href="gkt187um4"/></disp-formula>
where <italic>L</italic> is the total length of the backbone. Note that the sequence information is ignored when selecting parameter values, and also that these are not necessarily uniformly spaced. Once parameter values have been assigned, we define our curve <inline-formula><inline-graphic xlink:href="gkt187i12.jpg"/></inline-formula> to be the piecewise-linear interpolating function mapping <inline-formula><inline-graphic xlink:href="gkt187i13.jpg"/></inline-formula> for <inline-formula><inline-graphic xlink:href="gkt187i14.jpg"/></inline-formula>. Since the β functions are absolutely continuous curves in <italic>R</italic><sup>6</sup>, all of the ESA techniques for <italic>R<sup>n</sup></italic>, described in (<xref ref-type="bibr" rid="gkt187-B22">22</xref>, <xref ref-type="bibr" rid="gkt187-B23">23</xref>), can be readily applied to them. Since β is linear on each subinterval <inline-formula><inline-graphic xlink:href="gkt187i15.jpg"/></inline-formula>, the corresponding SRVF (which we discuss next) will be constant on each of these subintervals.</p>
      <p>To analyse the (sequence-annotated) shape of a curve β, we represent β by its square-root velocity function: <inline-formula><inline-graphic xlink:href="gkt187i16.jpg"/></inline-formula> in <italic>R</italic><sup>6</sup>, where <inline-formula><inline-graphic xlink:href="gkt187i17.jpg"/></inline-formula> is the standard Euclidean norm in <italic>R</italic><sup>6</sup>, and <inline-formula><inline-graphic xlink:href="gkt187i18.jpg"/></inline-formula>. In order for the shape analysis to be invariant to scales, we rescale each curve to length 1. This treatment is optional, but gave (surprisingly) better performance for protein structure alignment (<xref ref-type="bibr" rid="gkt187-B20">20</xref>, <xref ref-type="bibr" rid="gkt187-B21">21</xref>). Restricting to the curves of interest, represented by their SRVFs, we obtain the set
<disp-formula id="gkt187-M1"><label>(1)</label><graphic xlink:href="gkt187m1"/></disp-formula>
<italic>C</italic> is called the pre-shape space and is the set of all SRVFs representing parameterized curves in <italic>R</italic><sup>6</sup> of length one. It is actually a unit sphere in the Hilbert space Ł<sup>2</sup>.</p>
      <p>Among four shape-preserving transformations, we have removed translation and scale (optional); the rotation and reparameterization are removed algebraically as follows. When analysing these curves in <italic>R</italic><sup>6</sup>, the sequence information is relevant only for the parameterization step, but not for the rotation step: when optimizing over rotations, we only use information of backbone structures. Since the nucleotide sequence is not considered geometric information, when dealing with rotation, we modify the original algorithm by letting <italic>SO</italic>(3) be the group of <inline-formula><inline-graphic xlink:href="gkt187i20.jpg"/></inline-formula> rotation matrices and Γ be the group of all re-parameterizations (they are actually positive diffeomorphisms of the interval [0,1]). Let <inline-formula><inline-graphic xlink:href="gkt187i21.jpg"/></inline-formula> be the embedding of <italic>SO</italic>(3) in <italic>GL</italic><sub>6</sub> (general linear group of <inline-formula><inline-graphic xlink:href="gkt187i22.jpg"/></inline-formula> invertible matrices) by letting all elements <inline-formula><inline-graphic xlink:href="gkt187i23.jpg"/></inline-formula> in <italic>GL</italic><sub>6</sub> through <inline-formula><inline-graphic xlink:href="gkt187i24.jpg"/></inline-formula>. It is easy to show that <inline-formula><inline-graphic xlink:href="gkt187i25.jpg"/></inline-formula> is a subgroup of <italic>GL</italic><sub>6</sub> or <italic>SO</italic>(6).</p>
      <p>For a curve β, an (embedded) rotation <inline-formula><inline-graphic xlink:href="gkt187i26.jpg"/></inline-formula> and a re-parameterization <inline-formula><inline-graphic xlink:href="gkt187i27.jpg"/></inline-formula>, the transformed curve is given by <inline-formula><inline-graphic xlink:href="gkt187i28.jpg"/></inline-formula>. The SRVF of the transformed curve is given by <inline-formula><inline-graphic xlink:href="gkt187i29.jpg"/></inline-formula>. To unify all elements that denote the same shape in <italic>C</italic>, we define equivalence classes of the type: <inline-formula><inline-graphic xlink:href="gkt187i30.jpg"/></inline-formula>. Each such class <inline-formula><inline-graphic xlink:href="gkt187i31.jpg"/></inline-formula> is uniquely associated with a shape and vice versa. The set of all these equivalence classes is called the shape space <italic>S</italic>. Mathematically, it is a quotient space of the pre-shape space: <inline-formula><inline-graphic xlink:href="gkt187i32.jpg"/></inline-formula>.</p>
      <p>With the above modifications of the original framework, we can obtain geodesic paths and distances between two RNA structures, represented by 3D curves <inline-formula><inline-graphic xlink:href="gkt187i33.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="gkt187i34.jpg"/></inline-formula>, as done in (<xref ref-type="bibr" rid="gkt187-B20">20</xref>, <xref ref-type="bibr" rid="gkt187-B21">21</xref>, <xref ref-type="bibr" rid="gkt187-B26">26</xref>). Details of the mathematical framework can be found in the appendix.</p>
    </sec>
    <sec>
      <title>Obtaining a sequence alignment from the elastic matching</title>
      <p>Now suppose that <inline-formula><inline-graphic xlink:href="gkt187i35.jpg"/></inline-formula> are two curves obtained as above. Let <inline-formula><inline-graphic xlink:href="gkt187i36.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="gkt187i37.jpg"/></inline-formula> be the parameter values assigned to the original sample points for <inline-formula><inline-graphic xlink:href="gkt187i38.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="gkt187i39.jpg"/></inline-formula>, respectively, and let <italic>q</italic><sub>1</sub> and <italic>q</italic><sub>2</sub> be the corresponding SRVFs. Our approach to finding an optimal re-parameterization <inline-formula><inline-graphic xlink:href="gkt187i40.jpg"/></inline-formula> as done in (<xref ref-type="bibr" rid="gkt187-B20">20</xref>,<xref ref-type="bibr" rid="gkt187-B21">21</xref>,<xref ref-type="bibr" rid="gkt187-B26">26</xref>) is basically the same as the dynamic programming algorithm used in (<xref ref-type="bibr" rid="gkt187-B25">25</xref>), but in our case the nucleotide sequence information gives rise to a few considerations which we briefly discuss here.</p>
      <p>In the original ESA framework for RNA/protein alignment (<xref ref-type="bibr" rid="gkt187-B21">21</xref>,<xref ref-type="bibr" rid="gkt187-B26">26</xref>), we added a pre-processing step: any two RNAs/proteins to be compared had to have their 3D coordinates re-sampled using interpolations, and we obtained smooth curves with equal number of points on each structure. That treatment was convenient since it facilitated the use of a uniform grid that evenly partitions <inline-formula><inline-graphic xlink:href="gkt187i41.jpg"/></inline-formula> to search for the optimal <inline-formula><inline-graphic xlink:href="gkt187i42.jpg"/></inline-formula>. In the new framework, each point is mapped to a nucleotide and re-sampling of points is not necessary. With this modification, sequence alignments are obtained together with structure alignments, like most of the other structure alignment methods do. As in the original algorithm, we create a grid on the unit square <inline-formula><inline-graphic xlink:href="gkt187i43.jpg"/></inline-formula> and search for an optimal path through the grid from (0,0) to (1,1). However, our grid is non-uniform: the vertical lines are placed at <italic>x</italic>-coordinates <inline-formula><inline-graphic xlink:href="gkt187i44.jpg"/></inline-formula> and the horizontal lines are placed at <italic>y</italic>-coordinates <inline-formula><inline-graphic xlink:href="gkt187i45.jpg"/></inline-formula> (see <xref ref-type="fig" rid="gkt187-F1">Figure 1</xref>). In our case, the gridpoints have special significance: each gridpoint <inline-formula><inline-graphic xlink:href="gkt187i47.jpg"/></inline-formula> represents a match between one of the P atoms on the backbone of the molecule represented by <inline-formula><inline-graphic xlink:href="gkt187i48.jpg"/></inline-formula> and a P atom on the backbone of the molecule represented by <inline-formula><inline-graphic xlink:href="gkt187i49.jpg"/></inline-formula>. As in the original algorithm, a list of gridpoints <inline-formula><inline-graphic xlink:href="gkt187i50.jpg"/></inline-formula> which starts at (0,0), ends at (1,1), and is strictly increasing in both the <italic>x</italic> and <italic>y</italic> components can be thought of as the graph of an increasing piecewise-linear re-parameterization <inline-formula><inline-graphic xlink:href="gkt187i51.jpg"/></inline-formula>. In our case, such a list also gives us an alignment between the two nucleotide sequences. Here, parameter values <inline-formula><inline-graphic xlink:href="gkt187i52.jpg"/></inline-formula> which do not appear in the list of gridpoints correspond to alignment gaps (elements in the nucleotide sequence which are unmatched). Dynamic programming is used as in the original algorithm to search over the space of all such lists for one which minimizes the energy in <xref ref-type="disp-formula" rid="gkt187-M3">equation A.1</xref>, and the result gives us both a full elastic matching between <inline-formula><inline-graphic xlink:href="gkt187i53.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="gkt187i54.jpg"/></inline-formula>, as well as a nucleotide sequence alignment. <xref ref-type="fig" rid="gkt187-F2">Figure 2</xref> shows an example of a sequence alignment obtained in this way.
<fig id="gkt187-F1" position="float"><label>Figure 1.</label><caption><p>Piecewise-linear re-parameterization <inline-formula><inline-graphic xlink:href="gkt187i46.jpg"/></inline-formula> yielding an optimal matching between 1h3e chain B and 1gtr chain B. The matching grid has 82 columns, corresponding to the 80 points on the backbone of 1h3eB plus the dummy points at each end. Similarly, the grid has 76 rows, corresponding to the 74 points on the backbone of 1gtrB plus the dummy points at each end.</p></caption><graphic xlink:href="gkt187f1p"/></fig>
<fig id="gkt187-F2" position="float"><label>Figure 2.</label><caption><p>The nucleotide sequence alignment between 1h3eB and 1gtrB obtained from the matching shown above. The black lines represent the matching between nucleotides of each structure which are labelled and colour coded.</p></caption><graphic xlink:href="gkt187f2p"/></fig></p>
      <p>Since paths in the grid are required to start at (0,0) and end at (1,1), the alignments produced by our method always match the first nucleotide in <inline-formula><inline-graphic xlink:href="gkt187i55.jpg"/></inline-formula> to the first nucleotide in <inline-formula><inline-graphic xlink:href="gkt187i56.jpg"/></inline-formula>; similarly, the last nucleotides are always matched together. To work around this restriction, we add a preprocessing step in which a dummy point is added to the beginning and ending of each curve in <italic>R</italic><sup>6</sup>. The 3D coordinates <inline-formula><inline-graphic xlink:href="gkt187i57.jpg"/></inline-formula> of these points are obtained by linear extrapolation, and the sequence coordinates, <inline-formula><inline-graphic xlink:href="gkt187i58.jpg"/></inline-formula>, are duplicates of the sequence coordinates of the first (or last) real point. For the example in <xref ref-type="fig" rid="gkt187-F1">Figure 1</xref>, we used one dummy point at the beginning and ending of each curve. The first row and column and the last row and column in the grid correspond to these extra points. In <xref ref-type="fig" rid="gkt187-F2">Figure 2</xref>, the extra points have been removed for display, along with any matches involving them. The number of added dummy points is arbitrary and quite easy to change, but one or two should be enough to get around the ‘endpoints’ matching restriction. In this example, we scale the structures to unit length, let the sequence weight in the matching be <inline-formula><inline-graphic xlink:href="gkt187i59.jpg"/></inline-formula> and the resulting geodesic distance between both structures is 0.8966.</p>
      <p>The range of ESA distances for any two unscaled-length RNAs is <inline-formula><inline-graphic xlink:href="gkt187i60.jpg"/></inline-formula>. The geodesic distance of a structure to itself is zero. In many applications of shape analysis, the lengths of objects are often scaled to unit length. In such cases, distances have an upper bound of <inline-formula><inline-graphic xlink:href="gkt187i61.jpg"/></inline-formula>.</p>
    </sec>
    <sec>
      <title>Statistics of tertiary structures using 3D shape and sequence</title>
      <p>With a formal way to measure the distances between RNA structures, we can compute some important statistics for these shapes. Note that we can only do statistics of shapes if there is a true notion of shape distance. In particular, we would like to calculate mean and covariance and even impose probability distributions for a given set of RNA structures and, if desired, their nucleotide sequences, as well.</p>
      <p>Computing mean and covariance in non-linear (in this case, spherical) manifolds is not straightforward, as the shapes are not in a vector space. To get around this limitation, we use the linear properties of the tangent space at each point of <italic>S</italic>. Specifically, let <inline-formula><inline-graphic xlink:href="gkt187i62.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="gkt187i63.jpg"/></inline-formula>, … , <inline-formula><inline-graphic xlink:href="gkt187i64.jpg"/></inline-formula> be a given set of RNA structures, represented by their SRVFs <inline-formula><inline-graphic xlink:href="gkt187i65.jpg"/></inline-formula>. The sample mean is defined as the Karcher mean, and the covariance structure is obtained using the differential geometry of the <italic>q</italic>-function space. For mathematical details, see the appendix.</p>
      <p>Mean shapes and probability distributions of RNA structure families/classes can be very useful in automatic classifications of new structures. For example, mean shapes can serve as filters to quickly narrow down the list of more likely RNA families, which can then be studied in more detail. We can also obtain confidence regions in the directions of main variability and apply likelihood ratio tests in structure classifications. Moreover, random RNA structures can be generated for a given class of structures. As an example of the latter application, <xref ref-type="fig" rid="gkt187-F3">Figure 3</xref>a shows the set of RNA structures in tRNA synthetase complexes family; <xref ref-type="fig" rid="gkt187-F3">Figure 3</xref>b is the mean shape calculated from the structures in 3a; <xref ref-type="fig" rid="gkt187-F3">Figure 3</xref>c shows five sampled structures on each of the top three variance components; and <xref ref-type="fig" rid="gkt187-F3">Figure 3</xref>d shows some randomly sampled structures from the distribution derived from the set of structures shown in <xref ref-type="fig" rid="gkt187-F3">Figure 3</xref>a.
<fig id="gkt187-F3" position="float"><label>Figure 3.</label><caption><p>Structures, mean, variability and random Gaussian samples of a group of tRNA synthetase complexes. (<bold>a</bold>) RNA structures in <italic>tRNA synthetase complex</italic> class. (<bold>b</bold>) The mean structure of the structures in (a), which is the sample Karcher mean. (<bold>c</bold>) Samples from the directions of the three main variance components <italic>U</italic><sub>1</sub>, <italic>U</italic><sub>2</sub> and <italic>U</italic><sub>3</sub>. They represent the amount of variation in the set of structures. (<bold>d</bold>) Randomly sampled structures from Gaussian distributions with mean and variance estimated from the set of structures in (a).</p></caption><graphic xlink:href="gkt187f3p"/></fig></p>
      <p>In this study, the calculated statistics are on the shapes only, and the sequences are used to refine the overall registration of the structures to their sample mean. In principle, these statistics can also be calculated using a combination of nucleotide sequences and structures, if desired.</p>
    </sec>
  </sec>
  <sec sec-type="results">
    <title>RESULTS</title>
    <sec>
      <title>Benchmark dataset</title>
      <p>To test the performance of ESA and compare it with previous methods, we use a benchmark dataset, FSCOR (<xref ref-type="bibr" rid="gkt187-B8">8</xref>, <xref ref-type="bibr" rid="gkt187-B9">9</xref>), compiled from the SCOR database (<xref ref-type="bibr" rid="gkt187-B30">30</xref>). FSCOR contains 419 RNA structures in 168 functional classes. The histograms of chain lengths for the 419 RNA molecules are plotted in <xref ref-type="fig" rid="gkt187-F4">Figure 4</xref>a, and the histogram of number of members in each class is plotted in <xref ref-type="fig" rid="gkt187-F4">Figure 4</xref>b. We can see that most of the RNA molecules have fairly small sizes, with &lt;200 residues, and the class frequencies are very unbalanced, with many classes containing only one member.
<fig id="gkt187-F4" position="float"><label>Figure 4.</label><caption><p>(<bold>a</bold>) Distribution of the lengths of RNAs in FSCOR dataset; and (<bold>b</bold>) Number of members in each of the classes in the FSCOR dataset.</p></caption><graphic xlink:href="gkt187f4p"/></fig></p>
    </sec>
    <sec>
      <title>Parameter optimization</title>
      <p>When we combine sequence and structure information, we introduce a weight parameter, λ, controlling the relative influence of sequence information, which is subject to tuning. To search for the range of plausible values of λ, we randomly sample 80% of RNA structures with &lt;200 residues in FSCOR dataset and use leave-one-out cross validation (LOOCV) to find the optimal λ among some selected values between zero and 70. Specifically, there are 369 out of 419 structures with &lt;200 residues. This subset was selected mainly to save computational time, since some of the remaining structures are very large. In LOOCV, we compute the area under ROC curve (AUC) and use this criterion for performance evaluation throughout this article. This randomization was performed 10 times to assess the robustness of estimated optimal λ values for different sets of RNA structures. AUC values obtained with different λ from this experiment were plotted in <xref ref-type="fig" rid="gkt187-F5">Figure 5</xref>. In addition to this set of λ values, we also performed RNA comparison using sequence information alone, denoted as <inline-formula><inline-graphic xlink:href="gkt187i67.jpg"/></inline-formula>. When using only sequence information in alignment, <xref ref-type="disp-formula" rid="gkt187-M3">equation A.1</xref> is replaced by:
<disp-formula id="gkt187-M2"><label>(2)</label><graphic xlink:href="gkt187m2"/></disp-formula>
The AUCs for different λ for the full FSCOR dataset are shown in <xref ref-type="fig" rid="gkt187-F6">Figure 6</xref>. Both results show that λs around 5 tend to give the best AUCs, which is the value we use for subsequent performance evaluation on the whole FSCOR dataset. It is worth noting that both <inline-formula><inline-graphic xlink:href="gkt187i69.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="gkt187i70.jpg"/></inline-formula> give worse classification performances, showing that alignment in the joint sequence–structure space indeed performs better than using either sequence or structure information alone.
<fig id="gkt187-F5" position="float"><label>Figure 5.</label><caption><p>AUC versus lambda values obtained from the randomization experiment. Error bars are also shown together for each lambda values. λ values are from 0 to 70 with a step size of 1. The last value on x-axis corresponds to the <inline-formula><inline-graphic xlink:href="gkt187i66.jpg"/></inline-formula> case, which is the case of alignment using pure nucleotide sequence.</p></caption><graphic xlink:href="gkt187f5p"/></fig>
<fig id="gkt187-F6" position="float"><label>Figure 6.</label><caption><p>AUC for selected values of λ using the full FSCOR dataset. The selected λ values are 0, 1, 2 … , 10, 20, 30 … , 70, <inline-formula><inline-graphic xlink:href="gkt187i68.jpg"/></inline-formula> (0 to 10 with a step-size of 1, 10 to 70 with a step-size of 10, and sequence only alignment).</p></caption><graphic xlink:href="gkt187f6p"/></fig></p>
      <p>To study the effect of scaling of SRVFs, we also computed the geodesic distances without scaling by replacing equations of the great circle 4 and distance 5 (see appendix) by the equations of the straight line and <italic>L</italic><sup>2</sup> distance, respectively. The performance without scaling turns out to be worse, with AUCs ranging from 84% to 87%, for different λ values. This observation is consistent with what we have found in protein structure comparison using ESA (<xref ref-type="bibr" rid="gkt187-B21">21</xref>).</p>
    </sec>
    <sec sec-type="methods">
      <title>RNA function classification and comparison with existing methods</title>
      <p>We performed RNA function classification on the whole FSCOR dataset with optimal parameter setting and compared its AUC [following the same procedure as in (<xref ref-type="bibr" rid="gkt187-B10">10</xref>)] performance with several existing methods, including SARA (<xref ref-type="bibr" rid="gkt187-B8">8</xref>, <xref ref-type="bibr" rid="gkt187-B9">9</xref>), iPARTS (<xref ref-type="bibr" rid="gkt187-B10">10</xref>), LaJolla (<xref ref-type="bibr" rid="gkt187-B12">12</xref>) and ARTS (<xref ref-type="bibr" rid="gkt187-B11">11</xref>). The functional classes were obtained from SCOR database (<xref ref-type="bibr" rid="gkt187-B30">30</xref>). We ran the executable programs locally when possible. Otherwise we obtained the results directly from the authors. SARA’s original score is the mean log <italic>P</italic>-value (MLP), which combines <italic>P</italic>-values for percentage identity of primary, secondary and tertiary structure in their alignments. iPARTS’ original score is the structural alignment score (SAS), which is based on their native alignment score and geometric match measure. The score used for ARTS is their top alignment score chosen from their <italic>k</italic> non-redundant top-ranking matches. LaJolla’s score is their TM-Score, which is based on lengths of the target and aligned structures along with their euclidean residue distances. In the case of ARTS and LaJolla, if the scores were non-existing due to their limitations discussed in (<xref ref-type="bibr" rid="gkt187-B9">9</xref>) and (<xref ref-type="bibr" rid="gkt187-B10">10</xref>), we assigned a low similarity score.</p>
      <p>The all-against-all distance matrices calculated from the above methods are shown in <xref ref-type="fig" rid="gkt187-F7">Figure 7</xref>, where RNAs in the same classes are placed adjacent to one another.
<fig id="gkt187-F7" position="float"><label>Figure 7.</label><caption><p>(<bold>a–e</bold>) Distance matrices for all methods. Darker colour means smaller distances. (a) ESA (λ = 5), (b) SARA, (c) iPARTS, (d) ARTS, and (e) LaJolla.</p></caption><graphic xlink:href="gkt187f7p"/></fig></p>
      <p>In an ideal clustering, one should expect to see small distances (darker rectangles) only along the diagonal of each matrix. We can see from the matrices that some of the classes can be accurately clustered by all methods, and ESA appears to generate better clustering overall. To quantitatively evaluate clustering performance we used the <italic>F-measure</italic> criterion described in (<xref ref-type="bibr" rid="gkt187-B26">26</xref>). <xref ref-type="table" rid="gkt187-T1">Table 1</xref> contains <italic>F-measure</italic> results for all methods, which shows that ESA has the best performance among all the methods.
<table-wrap id="gkt187-T1" position="float"><label>Table 1.</label><caption><p>Comparison of F-Measure for all methods</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">ESA</th><th rowspan="1" colspan="1">SARA</th><th rowspan="1" colspan="1">iPARTS</th><th rowspan="1" colspan="1">ARTS</th><th rowspan="1" colspan="1">LaJolla</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">56.38</td><td rowspan="1" colspan="1">46.65</td><td rowspan="1" colspan="1">27.37</td><td rowspan="1" colspan="1">5.09</td><td rowspan="1" colspan="1">7.50</td></tr></tbody></table><table-wrap-foot><fn id="gkt187-TF1"><p>The values are given in (%).</p></fn></table-wrap-foot></table-wrap></p>
      <p>The ROC curves for function prediction for all the methods are plotted in <xref ref-type="fig" rid="gkt187-F8">Figure 8</xref> and the corresponding AUC values are shown in <xref ref-type="table" rid="gkt187-T2">Table 2</xref>. Among all the methods, ESA has the highest AUC value of 94.33.
<fig id="gkt187-F8" position="float"><label>Figure 8.</label><caption><p>Comparison of ROC curves between different methods. ESA shown here uses <inline-formula><inline-graphic xlink:href="gkt187i73.jpg"/></inline-formula>.</p></caption><graphic xlink:href="gkt187f8p"/></fig>
<table-wrap id="gkt187-T2" position="float"><label>Table 2.</label><caption><p>Comparison of AUC for all methods</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">ESA</th><th rowspan="1" colspan="1">SARA</th><th rowspan="1" colspan="1">iPARTS</th><th rowspan="1" colspan="1">ARTS</th><th rowspan="1" colspan="1">LaJolla</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">94.33</td><td rowspan="1" colspan="1">85.78</td><td rowspan="1" colspan="1">81.43</td><td rowspan="1" colspan="1">73.21</td><td rowspan="1" colspan="1">78.04</td></tr></tbody></table><table-wrap-foot><fn id="gkt187-TF2"><p>The values are given in (%).</p></fn></table-wrap-foot></table-wrap></p>
      <p>We also compared the average CPU running time for all methods using only the structures that are &lt;200 nucleotides long. These are given in <xref ref-type="table" rid="gkt187-T3">Table 3</xref>. SARA, ARTS and LaJolla were run on a standard computer with Linux OS and Intel® Pentium 4™ 3.0 GHz CPU. ESA was run using MATLAB™ on a standard computer with Windows 7™ OS and Intel® Core 2™ 2.3 GHz CPU. In the case of iPARTS, we obtained the pairwise comparison results and the running time information from the authors (Intel® Xeon™ 2.5 GHz CPU). On average, it takes less time for ESA to perform an alignment than the other methods.
<table-wrap id="gkt187-T3" position="float"><label>Table 3.</label><caption><p>Comparison of running time<xref ref-type="table-fn" rid="gkt187-TF1"><sup>a</sup></xref> for all methods</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">ESA</th><th rowspan="1" colspan="1">SARA</th><th rowspan="1" colspan="1">iPARTS</th><th rowspan="1" colspan="1">ARTS</th><th rowspan="1" colspan="1">LaJolla</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">0.0106</td><td rowspan="1" colspan="1">1.0805</td><td rowspan="1" colspan="1">0.3281</td><td rowspan="1" colspan="1">0.0745</td><td rowspan="1" colspan="1">1.4285</td></tr></tbody></table><table-wrap-foot><fn id="gkt187-TF3"><p><sup>a</sup>Times are measured in average seconds per comparison.</p></fn></table-wrap-foot></table-wrap></p>
    </sec>
  </sec>
  <sec>
    <title>CONCLUSION AND DISCUSSION</title>
    <p>In this study, we developed a more general ESA framework for RNA structure alignment, which allows us to add new information in addition to the backbone geometric information of RNA molecules. We applied the method to RNA structure comparison and function classification. Tested on a benchmark dataset, our method achieved better accuracy and higher computational efficiency than several previous methods.</p>
    <p>As mentioned earlier, ESA offers several unique advantages compared with other methods. Firstly, it calculates a formal distance, geodesic distance, between two RNA structures; secondly, the method is able to use both sequence and structure information in RNA comparison, which is, in principle, more desirable than using only sequence or structure information alone; thirdly, under the mathematical framework, one can calculate the mean and covariances for a group of structures, which allows for the construction of probability distributions for a group of RNA structures. This unique feature will be further investigated in our future studies. Finally, ESA performs global alignment and computes the global similarity for a given pair of RNA structures. To the best of our knowledge, there has been no global structure alignment methods for RNAs developed in the previous literature.</p>
    <p>It is a common practice in most previous studies to evaluate alignment quality in terms of structural similarity of the aligned parts. We did not provide such evaluation in this study due to the following reasons. Firstly, the ESA method is a global alignment procedure that measures the global similarity between RNA or protein structures. Most of the current metrics for evaluating alignment quality are designed for local alignments, which are not appropriate for global alignment. Secondly, it is well acknowledged that there is no universal measure for structure similarity, which works for all purposes. Finally, the evaluation we currently use, although not based on structural similarity, is an objective criterion based on the similarity of the functions of RNAs, which are determined experimentally. One of the most important applications of structure/sequence alignment is function inference.</p>
    <p>We have demonstrated in this study that one can achieve better classification performance in RNA function prediction by combining sequence and structure (backbone geometry) information than using either sequence or structure information alone. In principle, one can infer functions given complete structure information, which can be decomposed into three parts: the backbone geometry, the type of side chains (the same as sequence information) and side chain conformations. The last two types of information are strongly correlated, as one cannot talk about side chain conformations without knowing the identities of the side chains. All the three types of information are determining factors of RNA functions. Traditional structure alignments use only backbone geometry information, which limits the accuracy they can achieve. By incorporating sequences, we add the second type of information, which explains the superior performance our method has achieved. One can probably further improve classification performance by incorporating the information of side chain conformations. An alternative approach for function inference is through comparing molecular surfaces, which uses side chain conformations (and some information from backbone as well).</p>
    <p>Local structure alignments can be conducted using the algorithms outlined in this article. However, under the current framework of ESA, the distances generated will not be formal distances. To maintain formal distances while performing local alignments is an interesting topic for future studies.</p>
    <p>As shown in an earlier study (<xref ref-type="bibr" rid="gkt187-B26">26</xref>), the distance distribution of RNA structure alignments by ESA shows a clear bi-modal pattern. A cut-off can be easily obtained using Expectation Maximization algorithm to distinguish similar RNA structures and non-similar RNA structures. This cut-off value can be used to discover new RNA structure classes if a new RNA structure with unknown class has distances larger than the cut-off to all the existing RNA structures. A similar approach can be used when aligning RNAs in the joint sequence–structure space.</p>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>The authors will like to thank Dr. Sebastian Kurtek (FSU-Statistics) for his valuable discussions.</p>
  </ack>
  <sec>
    <title>FUNDING</title>
    <p><funding-source>National Institutes of Health (NIH)</funding-source> [<award-id>1R21GM101552</award-id> to J.Z. and A.S.]. Funding for open access charge: <funding-source>NIH</funding-source> in part.</p>
    <p><italic>Conflict of interest statement</italic>. None declared.</p>
  </sec>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="gkt187-B1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bartel</surname>
            <given-names>DP</given-names>
          </name>
        </person-group>
        <article-title>MicroRNAs: Genomics, biogenesis, mechanism, and function</article-title>
        <source>Cell</source>
        <year>2004</year>
        <volume>116</volume>
        <fpage>281</fpage>
        <lpage>297</lpage>
        <pub-id pub-id-type="pmid">14744438</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt187-B2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Non-coding RNA genes and the modern RNA world</article-title>
        <source>Nature Reviews Gen.</source>
        <year>2001</year>
        <volume>2</volume>
        <fpage>919</fpage>
        <lpage>929</lpage>
      </element-citation>
    </ref>
    <ref id="gkt187-B3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dorsett</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Tuschl</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>siRNAs: applications in functional genomics and potential as therapeutics</article-title>
        <source>Nat. Rev. Drug Discov.</source>
        <year>2004</year>
        <volume>3</volume>
        <fpage>318</fpage>
        <lpage>329</lpage>
        <pub-id pub-id-type="pmid">15060527</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt187-B4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Doudna</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cech</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>The chemical repertoire of natural ribozymes</article-title>
        <source>Nature</source>
        <year>2002</year>
        <volume>418</volume>
        <fpage>222</fpage>
        <lpage>228</lpage>
        <pub-id pub-id-type="pmid">12110898</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt187-B5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Staple</surname>
            <given-names>DW</given-names>
          </name>
          <name>
            <surname>Butcher</surname>
            <given-names>SE</given-names>
          </name>
        </person-group>
        <article-title>Pseudoknots: RNA structures with diverse functions</article-title>
        <source>PLoS Biol.</source>
        <year>2005</year>
        <volume>3</volume>
        <fpage>956</fpage>
        <lpage>959</lpage>
      </element-citation>
    </ref>
    <ref id="gkt187-B6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Doudna</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Structural genomics of RNA</article-title>
        <source>Nat. Struc. Biol.</source>
        <year>2000</year>
        <volume>7</volume>
        <issue>Suppl. S</issue>
        <fpage>954</fpage>
        <lpage>956</lpage>
      </element-citation>
    </ref>
    <ref id="gkt187-B7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Storz</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>An expanding universe of noncoding RNAs</article-title>
        <source>Science</source>
        <year>2002</year>
        <volume>296</volume>
        <fpage>1260</fpage>
        <lpage>1263</lpage>
        <pub-id pub-id-type="pmid">12016301</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt187-B8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Capriotti</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Marti-Renom</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>RNA structure alignment by a unit-vector approach</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>I112</fpage>
        <lpage>I118</lpage>
        <comment>Joint Meeting of the 7th European Conference on Computational Biology/5th Meeting of the Bioinformatics-Italian-Society, Cagliari, ITALY, SEP 22–26, 2008</comment>
        <pub-id pub-id-type="pmid">18689811</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt187-B9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Capriotti</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Marti-Renom</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>SARA: a server for function annotation of RNA structures</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2009</year>
        <volume>37</volume>
        <fpage>W260</fpage>
        <lpage>W265</lpage>
        <pub-id pub-id-type="pmid">19483098</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt187-B10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>iPARTS: an improved tool of pairwise alignment of RNA tertiary structures</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2010</year>
        <volume>38</volume>
        <fpage>W340</fpage>
        <lpage>W347</lpage>
        <pub-id pub-id-type="pmid">20507908</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt187-B11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dror</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Nussinov</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wolfson</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>ARTS: alignment of RNA tertiary structures</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <issue>Suppl. 2</issue>
        <fpage>47</fpage>
        <lpage>53</lpage>
      </element-citation>
    </ref>
    <ref id="gkt187-B12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bauer</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Rother</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Moor</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Reinert</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Steinke</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Bujnicki</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Preissner</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Fast structural alignment of biomolecules using a hash table, n-Grams and string descriptors</article-title>
        <source>Algorithms</source>
        <year>2009</year>
        <volume>2</volume>
        <fpage>692</fpage>
        <lpage>709</lpage>
      </element-citation>
    </ref>
    <ref id="gkt187-B13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Duarte</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Wadley</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Pyle</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>RNA structure comparison, motif search and discovery using a reduced representation of RNA conformational space</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2003</year>
        <volume>31</volume>
        <fpage>4755</fpage>
        <lpage>4761</lpage>
        <pub-id pub-id-type="pmid">12907716</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt187-B14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ferre</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Ponty</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lorenz</surname>
            <given-names>WA</given-names>
          </name>
          <name>
            <surname>Clote</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>DIAL: a web server for the pairwise alignment of two RNA three-dimensional structures using nucleotide, dihedral angle and base-pairing similarities</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2007</year>
        <volume>35</volume>
        <fpage>W659</fpage>
        <lpage>W668</lpage>
        <pub-id pub-id-type="pmid">17567620</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt187-B15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sarver</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zirbel</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Stombaugh</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Mokdad</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Leontis</surname>
            <given-names>NB</given-names>
          </name>
        </person-group>
        <article-title>FR3D: finding local and composite recurrent structural motifs in RNA 3D structures</article-title>
        <source>J. Math. Biol.</source>
        <year>2008</year>
        <volume>56</volume>
        <fpage>215</fpage>
        <lpage>252</lpage>
        <pub-id pub-id-type="pmid">17694311</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt187-B16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wadley</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Pyle</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>The identification of novel RNA structural motifs using COMPADRES: an automated approach to structural discovery</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2004</year>
        <volume>32</volume>
        <fpage>6650</fpage>
        <lpage>6659</lpage>
        <pub-id pub-id-type="pmid">15608296</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt187-B17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harrison</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>South</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Willett</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Artymiuk</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>Representation, searching and discovery of patterns of bases in complex RNA structures</article-title>
        <source>J. Comput. Aided Mol. Design</source>
        <year>2003</year>
        <volume>17</volume>
        <fpage>537</fpage>
        <lpage>549</lpage>
      </element-citation>
    </ref>
    <ref id="gkt187-B18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rahrig</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Leontis</surname>
            <given-names>NB</given-names>
          </name>
          <name>
            <surname>Zirbel</surname>
            <given-names>CL</given-names>
          </name>
        </person-group>
        <article-title>R3D Align: global pairwise alignment of RNA 3D structures using local superpositions</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>2689</fpage>
        <lpage>2697</lpage>
        <pub-id pub-id-type="pmid">20929913</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt187-B19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhong</surname>
            <given-names>CTH</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>RNAMotifScan: automatic identification of RNA structural motifs using secondary structural alignment</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2010</year>
        <volume>38</volume>
        <fpage>e176</fpage>
        <pub-id pub-id-type="pmid">20696653</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt187-B20">
      <label>20</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Srivastava</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Protein structure alignment using elastic shape analysis</article-title>
        <source>Proceedings of the First ACM International Conference on Bioinformatics and Computational Biology, 2010</source>
        <year>2010</year>
        <publisher-loc>Niagara Falls, New York</publisher-loc>
        <publisher-name>ACM</publisher-name>
        <fpage>62</fpage>
        <lpage>70</lpage>
      </element-citation>
    </ref>
    <ref id="gkt187-B21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Srivastava</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A mathematical framework for protein structure comparison</article-title>
        <source>PLoS Comp. Biol.</source>
        <year>2011</year>
        <volume>7</volume>
        <fpage>e1001075</fpage>
      </element-citation>
    </ref>
    <ref id="gkt187-B22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Srivastava</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Klassen</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Joshi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Jermyn</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Shape analysis of elastic curves in euclidean spaces</article-title>
        <source>IEEE Trans. Pattern Anal. Mach. Intell.</source>
        <year>2011</year>
        <volume>33</volume>
        <fpage>1415</fpage>
        <lpage>1428</lpage>
      </element-citation>
    </ref>
    <ref id="gkt187-B23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Joshi</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Klassen</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Srivastava</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Jermyn</surname>
            <given-names>IH</given-names>
          </name>
        </person-group>
        <article-title>A novel representation for Riemannian analysis of elastic curves in R</article-title>
        <source>Proc. IEEE Comput. Soc. Conf. Comput. Vis. Pattern Recognit.</source>
        <year>2007</year>
        <volume>2007</volume>
        <fpage>1</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="pmid">21311729</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt187-B24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Klassen</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Srivastava</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mio</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Joshi</surname>
            <given-names>SH</given-names>
          </name>
        </person-group>
        <article-title>Analysis of planar shapes using geodesic paths on shape spaces</article-title>
        <source>IEEE Trans. Pattern Anal. Mach. Intell.</source>
        <year>2004</year>
        <volume>26</volume>
        <fpage>372</fpage>
        <lpage>383</lpage>
        <pub-id pub-id-type="pmid">15376883</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt187-B25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mio</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Srivastava</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Joshi</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>On shape of plane elastic curves</article-title>
        <source>Int. J. Comput. Vis.</source>
        <year>2007</year>
        <volume>73</volume>
        <fpage>307</fpage>
        <lpage>324</lpage>
      </element-citation>
    </ref>
    <ref id="gkt187-B26">
      <label>26</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Laborde</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Srivastava</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Structure-based RNA function prediction using elastic shape analysis</article-title>
        <source>2011 IEEE International Conference on Bioinformatics and Biomedicine</source>
        <year>2011</year>
        <publisher-loc>Atlanta, GA</publisher-loc>
        <fpage>16</fpage>
        <lpage>21</lpage>
      </element-citation>
    </ref>
    <ref id="gkt187-B27">
      <label>27</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Jukes</surname>
            <given-names>TH</given-names>
          </name>
          <name>
            <surname>Cantor</surname>
            <given-names>CR</given-names>
          </name>
        </person-group>
        <source>Mammalian Protein Metabolism</source>
        <year>1969</year>
        <edition>3rd edn</edition>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Academic Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="gkt187-B28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bernstein</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Koetzle</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>E</given-names>
            <suffix>Jr</suffix>
          </name>
          <name>
            <surname>Brice</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rodgers</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kennard</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Shimanouchi</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tasumi</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The protein data bank: a computer-based archival file for macromolecular structures</article-title>
        <source>J. Mol. Biol.</source>
        <year>1977</year>
        <volume>112</volume>
        <fpage>535</fpage>
        <pub-id pub-id-type="pmid">875032</pub-id>
      </element-citation>
    </ref>
    <ref id="gkt187-B29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Berman</surname>
            <given-names>HM</given-names>
          </name>
          <name>
            <surname>Battistuz</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Bhat</surname>
            <given-names>TN</given-names>
          </name>
          <name>
            <surname>Bluhm</surname>
            <given-names>WF</given-names>
          </name>
          <name>
            <surname>Bourne</surname>
            <given-names>PE</given-names>
          </name>
          <name>
            <surname>Burkhardt</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Iype</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Jain</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Fagan</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Marvin</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The protein data bank</article-title>
        <source>Acta. Crystallographica.</source>
        <year>2002</year>
        <volume>58</volume>
        <issue>Part 6</issue>
        <fpage>899</fpage>
        <lpage>907</lpage>
      </element-citation>
    </ref>
    <ref id="gkt187-B30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tamura</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hendrix</surname>
            <given-names>DK</given-names>
          </name>
          <name>
            <surname>Klosterman</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Schimmelman</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Brenner</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Holbrook</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>SCOR: structural classification of RNA, version 2.0</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2004</year>
        <volume>32</volume>
        <fpage>D182</fpage>
        <lpage>D184</lpage>
        <pub-id pub-id-type="pmid">14681389</pub-id>
      </element-citation>
    </ref>
  </ref-list>
  <app-group>
    <app id="gkt187-APP1">
      <title>APPENDIX</title>
      <sec>
        <title>ESA framework</title>
        <p>For any two points in <italic>S</italic>, the distance between them is given by the length of the shortest path (called a geodesic) connecting them in that manifold. An interesting feature of this framework is that it not only provides a distance between two RNA structures, thus quantifying differences between their shapes, but also a geodesic path between them in <italic>S</italic>. This path has the interpretation that it provides the optimal deformation of one shape into another. The geodesics are actually computed using the differential geometry of the underlying space <italic>S</italic>. Consider two curves <inline-formula><inline-graphic xlink:href="gkt187i74.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="gkt187i75.jpg"/></inline-formula>, represented by their SRVFs <italic>q</italic><sub>1</sub> and <italic>q</italic><sub>2</sub>. To compute geodesics between their equivalence classes <inline-formula><inline-graphic xlink:href="gkt187i76.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="gkt187i77.jpg"/></inline-formula>, we fix <italic>q</italic><sub>1</sub> and find the optimal rotation and re-parameterization of <italic>q</italic><sub>2</sub> to solve:
<disp-formula id="gkt187-M3"><label>(A.1)</label><graphic xlink:href="gkt187m3"/></disp-formula>
</p>
        <p>The optimization over rotation is done using singular value decomposition (SVD) on the <italic>O</italic> component of Ω, but the optimization over the re-parameterization requires a dynamic programming algorithm. The optimal <inline-formula><inline-graphic xlink:href="gkt187i78.jpg"/></inline-formula> is the matching function between the two backbones. Define <inline-formula><inline-graphic xlink:href="gkt187i79.jpg"/></inline-formula> and compute a geodesic path between <italic>q</italic><sub>1</sub> and <inline-formula><inline-graphic xlink:href="gkt187i80.jpg"/></inline-formula> in <italic>C</italic>. Since <italic>C</italic> is a sphere, the geodesic between any two points is given by a great circle whose equation is:
<disp-formula id="gkt187-M4"><label>(A.2)</label><graphic xlink:href="gkt187m4"/></disp-formula>
where α is a geodesic path between the given two shapes such that it is in <inline-formula><inline-graphic xlink:href="gkt187i81.jpg"/></inline-formula> at <inline-formula><inline-graphic xlink:href="gkt187i82.jpg"/></inline-formula> and in <inline-formula><inline-graphic xlink:href="gkt187i83.jpg"/></inline-formula> at <inline-formula><inline-graphic xlink:href="gkt187i84.jpg"/></inline-formula>. Here
<disp-formula id="gkt187-M5"><label>(A.3)</label><graphic xlink:href="gkt187m5"/></disp-formula>
is the distance between the two equivalence classes in <italic>S</italic>, i.e. <inline-formula><inline-graphic xlink:href="gkt187i85.jpg"/></inline-formula>. This θ is a <bold>proper distance</bold> in the shape space, as it satisfies all three properties of a distance function, including the triangle inequality.</p>
      </sec>
      <sec>
        <title>Statistics under the SRVF representation</title>
        <p>Given a set of SRVFs <inline-formula><inline-graphic xlink:href="gkt187i86.jpg"/></inline-formula>, their Sample Karcher Mean is given by:
<disp-formula id="gkt187-M6"><label>(A.4)</label><graphic xlink:href="gkt187m6"/></disp-formula>
where <inline-formula><inline-graphic xlink:href="gkt187i87.jpg"/></inline-formula> in <xref ref-type="disp-formula" rid="gkt187-M6">equation A.4</xref> is the geodesic distance between <italic>q</italic>, and <italic>q<sub>i</sub></italic>. This definition is equivalent to the sample mean <inline-formula><inline-graphic xlink:href="gkt187i88.jpg"/></inline-formula> in a Euclidean vector space. The actual minimizer is found using an iterated gradient-approach (<xref ref-type="bibr" rid="gkt187-B23">23</xref>). To get an average shape <inline-formula><inline-graphic xlink:href="gkt187i89.jpg"/></inline-formula> we simply use integration:
<disp-formula id="gkt187-M7"><label>(A.5)</label><graphic xlink:href="gkt187m7"/></disp-formula>
</p>
        <p>To define sample covariance, we approximate the shape space <italic>S</italic> in a neighbourhood of <inline-formula><inline-graphic xlink:href="gkt187i90.jpg"/></inline-formula> by a flat space <inline-formula><inline-graphic xlink:href="gkt187i91.jpg"/></inline-formula>. Each of the observed SRVFs are then projected to the flat space <inline-formula><inline-graphic xlink:href="gkt187i92.jpg"/></inline-formula> using the <italic>inverse exponential mapping</italic>:
<fig id="gkt187-F9" position="anchor"><label>Figure A1.</label><caption><p><italic>q</italic> functions, their Karcher mean <inline-formula><inline-graphic xlink:href="gkt187i71.jpg"/></inline-formula> and their projection onto <inline-formula><inline-graphic xlink:href="gkt187i72.jpg"/></inline-formula>’s tangent space.</p></caption><graphic xlink:href="gkt187f9p"/></fig>
<disp-formula id="gkt187-M8"><label>(A.6)</label><graphic xlink:href="gkt187m8"/></disp-formula>
where <inline-formula><inline-graphic xlink:href="gkt187i93.jpg"/></inline-formula>. Intuitively, <italic>v<sub>i</sub></italic>'s are simply the directions of the geodesics from the mean <inline-formula><inline-graphic xlink:href="gkt187i94.jpg"/></inline-formula> to <italic>q<sub>i</sub></italic>’s. <xref ref-type="fig" rid="gkt187-F9">Figure A1</xref> shows a depiction of this using a sphere. We can compute the standard sample covariance matrix <inline-formula><inline-graphic xlink:href="gkt187i95.jpg"/></inline-formula> of <italic>v<sub>i</sub></italic>s and take its SVD <inline-formula><inline-graphic xlink:href="gkt187i96.jpg"/></inline-formula>. Here Σ is a diagonal matrix of singular values (which for convenience, we can denote and arrange as <inline-formula><inline-graphic xlink:href="gkt187i97.jpg"/></inline-formula>), and <italic>U</italic> contains the corresponding singular vectors. Since the singular values are arranged in decreasing order, the first few, say <italic>k</italic>, columns of <italic>U</italic> represent the directions of major variation, or the principal components, of the underlying population. If we let <italic>z</italic><sub>1</sub>, <italic>z</italic><sub>2</sub>, … <italic>z<sub>k</sub></italic> be independent standard normal random variables, we can define a multivariate normal density on the direction <italic>v</italic> according to: <inline-formula><inline-graphic xlink:href="gkt187i98.jpg"/></inline-formula>. Then, this random direction can be converted into the SRVF of a random shape using the <italic>exponential mapping</italic>:
<disp-formula id="gkt187-M9"><label>(A.7)</label><graphic xlink:href="gkt187m9"/></disp-formula>
which can be further converted into a shape using integration: <inline-formula><inline-graphic xlink:href="gkt187i99.jpg"/></inline-formula>. This defines a formal Gaussian probability model on the shape space <italic>S</italic> and one can sample random structures from it using the steps outlined above.</p>
      </sec>
    </app>
  </app-group>
</back>
