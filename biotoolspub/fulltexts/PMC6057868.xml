<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">J Cheminform</journal-id>
    <journal-id journal-id-type="iso-abbrev">J Cheminform</journal-id>
    <journal-title-group>
      <journal-title>Journal of Cheminformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1758-2946</issn>
    <publisher>
      <publisher-name>Springer International Publishing</publisher-name>
      <publisher-loc>Cham</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6057868</article-id>
    <article-id pub-id-type="publisher-id">287</article-id>
    <article-id pub-id-type="doi">10.1186/s13321-018-0287-6</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Multi-objective de novo drug design with conditional graph generative model</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Yibo</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Zhang</surname>
          <given-names>Liangren</given-names>
        </name>
        <address>
          <email>liangren@bjmu.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Liu</surname>
          <given-names>Zhenming</given-names>
        </name>
        <address>
          <email>zmliu@bjmu.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2256 9319</institution-id><institution-id institution-id-type="GRID">grid.11135.37</institution-id><institution>State Key Laboratory of Natural and Biomimetic Drugs, School of Pharmaceutical Sciences, </institution><institution>Peking University, </institution></institution-wrap>Xueyuan Road 38, Haidian District, Beijing, 100191 China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>24</day>
      <month>7</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>24</day>
      <month>7</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2018</year>
    </pub-date>
    <volume>10</volume>
    <elocation-id>33</elocation-id>
    <history>
      <date date-type="received">
        <day>22</day>
        <month>2</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>7</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2018</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Recently, deep generative models have revealed itself as a promising way of performing de novo molecule design. However, previous research has focused mainly on generating SMILES strings instead of molecular graphs. Although available, current graph generative models are are often too general and computationally expensive. In this work, a new de novo molecular design framework is proposed based on a type of sequential graph generators that do not use atom level recurrent units. Compared with previous graph generative models, the proposed method is much more tuned for molecule generation and has been scaled up to cover significantly larger molecules in the ChEMBL database. It is shown that the graph-based model outperforms SMILES based models in a variety of metrics, especially in the rate of valid outputs. For the application of drug design tasks, conditional graph generative model is employed. This method offers highe flexibility and is suitable for generation based on multiple objectives. The results have demonstrated that this approach can be effectively applied to solve several drug design problems, including the generation of compounds containing a given scaffold, compounds with specific drug-likeness and synthetic accessibility requirements, as well as dual inhibitors against JNK3 and GSK-3<italic>β</italic>.<graphic position="anchor" xlink:href="13321_2018_287_Figa_HTML" id="MO1"/>
</p>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (10.1186/s13321-018-0287-6) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Deep learning</kwd>
      <kwd>De novo drug design</kwd>
      <kwd>Graph generative model</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001809</institution-id>
            <institution>National Natural Science Foundation of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>21572010</award-id>
        <award-id>21772005</award-id>
        <award-id>81573273</award-id>
        <award-id>81673279</award-id>
        <principal-award-recipient>
          <name>
            <surname>Zhang</surname>
            <given-names>Liangren</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Zhenming</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>National Major Scientific and Technological Special Project for “Significant New Drugs Development”</institution>
        </funding-source>
        <award-id>2018ZX09735001-003</award-id>
        <principal-award-recipient>
          <name>
            <surname>Zhang</surname>
            <given-names>Liangren</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2018</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par19">The ultimate goal of drug design is the discovery of new chemical entities with desirable pharmacological properties. Achieving this goal requires medicinal chemists to explore the chemical space for new molecules, which is proved to be extremely difficult, mainly due to the size and complexity of the chemical space. It is estimated that there are around <inline-formula id="IEq5"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10^{60}{-}10^{100}$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mn>60</mml:mn></mml:msup><mml:mo>-</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>100</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq5.gif"/></alternatives></inline-formula> synthetically available molecules [<xref ref-type="bibr" rid="CR1">1</xref>]. Meanwhile, the space of chemical compounds exhibits a discontinues structure, making searching difficult to perform [<xref ref-type="bibr" rid="CR2">2</xref>].</p>
    <p id="Par20">De novo molecular design aims at assisting this processes with computer-based methods. Early works have developed various algorithms to produce new molecular structures, such as atom based elongation or fragment based combination [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>]. Those algorithms are often coupled with global optimization techniques such as ant colony optimization [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>], genetic algorithms [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>] or particle swam optimization [<xref ref-type="bibr" rid="CR9">9</xref>] for the generation of molecules with desired properties.</p>
    <p id="Par21">Recent developments in deep learning [<xref ref-type="bibr" rid="CR10">10</xref>] have shed new light on the area of de novo molecule generation. Previous works have shown that deep generative models are very effective in modeling the SMILES representation of molecules using recurrent neural networks (RNN), an architecture that has been extensively applied to tasks related sequential data [<xref ref-type="bibr" rid="CR11">11</xref>]. Segler et al. [<xref ref-type="bibr" rid="CR12">12</xref>] applied SMILES language model (LM) on the task of generating focused molecule libraries by fine-tuning the trained network with a smaller set of molecules with desirable properties. Olivecrona et al. [<xref ref-type="bibr" rid="CR13">13</xref>] used a GRU [<xref ref-type="bibr" rid="CR14">14</xref>] based LM trained on the ChEMBL [<xref ref-type="bibr" rid="CR15">15</xref>] dataset to generate SMILES string. The mode is then fine-tuned using reinforcement learning for the generation of molecules with specific requirements. Popova et al. [<xref ref-type="bibr" rid="CR16">16</xref>] proposed to integrate the generative and predictive network together in the generation phase. Beside language model, Gómez–Bombarelli et al. [<xref ref-type="bibr" rid="CR13">13</xref>] used variational autoencoder (VAE) [<xref ref-type="bibr" rid="CR17">17</xref>] to generate drug-like compounds from ZINC database [<xref ref-type="bibr" rid="CR18">18</xref>]. This work aimed at obtaining a bi-directional mapping between molecule space and a continuous latent space so that operations on molecules can be achieved by manipulating the latent representation. Blaschke et al. [<xref ref-type="bibr" rid="CR19">19</xref>] compared different architectures for VAE and applied it to the task of designing active compounds against DRD2.</p>
    <p id="Par22">The researches described above demonstrated the effectiveness of SMILES based model regarding molecule generation. However, producing valid SMILES strings requires the model to learn rules that are irrelevant to molecular structures, such as the SMILES grammar and atom ordering, which increases the burden of the model and makes the SMILES string a less preferable representation compared with molecular graphs. Research in deep learning has recently enabled the direct generation of molecular graphs. Johnson et al. [<xref ref-type="bibr" rid="CR20">20</xref>] proposed a sequential generation approach for graphs. Though their implementation is mainly for reasoning tasks, this framework is potentially applicable to molecule generation. A more recent method [<xref ref-type="bibr" rid="CR21">21</xref>] was proposed for generating the entire graph all at once. This model has been successfully applied to the generation of small molecular graphs. The implementation that is most similar to ours is by the recent work by Li et al. [<xref ref-type="bibr" rid="CR22">22</xref>] using a sequential decoding scheme similar to that by Johnson et al. Decoding invariance is introduced by sampling different atom ordering from a predefined distribution. This method has been applied to the generation of molecules with less than 20 heavy atoms from ChEMBL dataset. Though inspiring, the methods discussed above have a few common problems. First of all, the generators proposed are relatively general. This design allows those techniques to be applied to various scenarios but requires further optimization for application in molecule generation. Secondly, many of those models suffer from scalability issue, which restricts the application to molecules with small sizes.</p>
    <p id="Par23">In this work, we propose a graph-based generator that is more suited for molecules. The model is scaled to cover compounds containing up to 50 heavy atoms in the ChEMBL dataset. Results show the graph-based model proposed is able to outperform SMILES based methods in a variety metrics, including the rate of valid outputs, KL and JS divergence of molecular properties, as well as NLL loss. A conditional version of the model is employed to solve various drug design related tasks with multiple objectives, and results have demonstrated promising performance.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Molecular graph</title>
      <p id="Par24">Molecular graph is a way of representating the structural information of molecules using graphs (<inline-formula id="IEq39"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G=(V, E)$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq39.gif"/></alternatives></inline-formula>). Atoms and bonds in the molecule are viewed as graph nodes (<inline-formula id="IEq40"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v \in V$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mi>v</mml:mi><mml:mo>∈</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq40.gif"/></alternatives></inline-formula>) and edges (<inline-formula id="IEq41"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e \in E$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mi>e</mml:mi><mml:mo>∈</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq41.gif"/></alternatives></inline-formula>). Each node is labeled with its corresponding atom type, while each edge is labeled with its corresponding bond type. We refer the set of all atom types and bond types as <italic>A</italic> and <italic>B</italic> respectively. In this work, the atom type is specified using three variables: the atomic symbol (or equally the atomic number), the number of explicit hydrogens attached, and the number of formal charges. For example, the nitrogen atom in pyrrole can be represented as the triple (“N”, 1, 0). The set of all atom types (<italic>A</italic>) is extracted from molecules in the ChEMBL dataset (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary Text 1), and contains 33 members in total. For bonds, we only consider the following four bond types: single, double, triple and aromatic. A visualized demonstration of molecular graph is given in Fig. <xref rid="Fig1" ref-type="fig">1</xref>.<fig id="Fig1"><label>Fig. 1</label><caption><p>Cimetidine and its graph based representation. In the graph based generative models, molecules (see <bold>a</bold>) are represented as graphs <inline-formula id="IEq6"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G = (V, E)$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq6.gif"/></alternatives></inline-formula> (see <bold>b</bold>), where atoms are bonds are viewed as nodes and edges respectively. Atom types are specified by three parameters: the atomic symbol (or equally the atomic number), the number of explicit hydrogens attached, and the number of formal charges (see <bold>c</bold>). For bond types, only single, double, triple and aromatic bonds are considered in this work (see <bold>d</bold>)</p></caption><graphic xlink:href="13321_2018_287_Fig1_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Graph generative model</title>
      <p id="Par25">We now consider the deep generative models that can directly output molecular graphs. In this work, we mainly focus on sequential graph generators, which build graph by iteratively refining its intermediate structure. The process starts from the empty graph <inline-formula id="IEq42"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_0=(\emptyset ,\emptyset)$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">∅</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">∅</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq42.gif"/></alternatives></inline-formula>. At step <italic>i</italic>, a graph transition <inline-formula id="IEq43"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_i$$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq43.gif"/></alternatives></inline-formula> is selected from the set of all available transition actions <inline-formula id="IEq44"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T(G_i)$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mi>T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq44.gif"/></alternatives></inline-formula> based on the generation history <inline-formula id="IEq45"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(G_0 , \ldots, G_i)$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq45.gif"/></alternatives></inline-formula>. The selection is done by sampling <inline-formula id="IEq46"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_i$$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq46.gif"/></alternatives></inline-formula> from a probability distribution <inline-formula id="IEq47"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_i \sim p_{\varvec{\theta }}(t_i | G_i, \ldots, G_0)$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq47.gif"/></alternatives></inline-formula>, which is parametrized by a deep network. Then, <inline-formula id="IEq48"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_i$$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq48.gif"/></alternatives></inline-formula> is performed on <inline-formula id="IEq49"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_i$$\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq49.gif"/></alternatives></inline-formula> to get the graph structure for the next step <inline-formula id="IEq50"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_{i+1}=t_i (G_i)$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq50.gif"/></alternatives></inline-formula>. At the final step <italic>n</italic>, termination operation <inline-formula id="IEq51"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t^*$$\end{document}</tex-math><mml:math id="M30"><mml:msup><mml:mi>t</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq51.gif"/></alternatives></inline-formula> is performed and the model outputs <inline-formula id="IEq52"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G=G_n$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq52.gif"/></alternatives></inline-formula> as the final result.</p>
      <p id="Par26">The entire process is illustrated in Fig. <xref rid="Fig2" ref-type="fig">2</xref>.<fig id="Fig2"><label>Fig. 2</label><caption><p>A schematic representation of molecule generation process. Starting with the empty graph <inline-formula id="IEq7"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_0$$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mi>G</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq7.gif"/></alternatives></inline-formula>, initialization is performed to add the first atom. At each step, a graph transition (append, connect or terminate) is sampled and performed on the intermediate molecule structure. The probability for sampling each transition is given by <inline-formula id="IEq8"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{\varvec{\theta }}(t|G_i,\ldots, G_0)$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq8.gif"/></alternatives></inline-formula>, which is parametrized using deep neural network. Finally, termination operation is performed to end the generation</p></caption><graphic xlink:href="13321_2018_287_Fig2_HTML" id="MO3"/></fig> We call the mapping <italic>T</italic>, which determines all available graph transitions at each step, a <italic>decoding scheme</italic>. The sequence <inline-formula id="IEq53"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r=((G_0,t_0),(G_1,t_1),\ldots,(G_n,t_n))$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq53.gif"/></alternatives></inline-formula> is called a <italic>decoding route</italic> of <italic>G</italic>, and the distribution <inline-formula id="IEq54"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{\varvec{\theta }} (t_i | G_i, \ldots, G_0)$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq54.gif"/></alternatives></inline-formula> is called a <italic>decoding policy</italic>.</p>
      <p id="Par27">Previous graph generative models are usually too general and less optimized for the generation of molecular graphs. Here we offer the following optimizations:<list list-type="order"><list-item><p id="Par28">A much simpler decoding scheme <italic>T</italic> is used to decrease the number of steps required for generation.</p></list-item><list-item><p id="Par29">No atom level recurrent unit is used in the decoding policy. Instead, we explored two other options: (1) parametrizing the decoding policy as a Markov process and (2) using only molecule level recurrent unit. Those modifications helps to increase the scalability of the model.</p></list-item><list-item><p id="Par30">During the calculation of log-likelihood loss, we sample <italic>r</italic> from a parametrized distribution <inline-formula id="IEq55"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_\alpha (r | G)$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq55.gif"/></alternatives></inline-formula>. The parameter <inline-formula id="IEq56"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M44"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq56.gif"/></alternatives></inline-formula> controls the degree of randomness of <inline-formula id="IEq57"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_\alpha$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mi>q</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq57.gif"/></alternatives></inline-formula>, offering higher flexibility for the model.</p></list-item></list>The following three sections are devoted to the detailed discussions of the optimizations above.</p>
    </sec>
    <sec id="Sec5">
      <title>Decoding scheme</title>
      <p id="Par31">The transitions in <inline-formula id="IEq58"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T(G_i)$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:mi>T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq58.gif"/></alternatives></inline-formula> given the intermediate state <inline-formula id="IEq59"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_i$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq59.gif"/></alternatives></inline-formula> is restricted to the following four types:<list list-type="order"><list-item><p id="Par32"><italic>Initialization</italic> At the beginning of the generation, the only allowed transition is to add the first atom to the empty graph <inline-formula id="IEq60"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_0$$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mi>G</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq60.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par33"><italic>Append</italic> This action adds a new atom to <inline-formula id="IEq61"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_i$$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq61.gif"/></alternatives></inline-formula> and connect it to an existing atom with a new bond.</p></list-item><list-item><p id="Par34"><italic>Connect</italic> This action connects two existing atoms <inline-formula id="IEq62"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_1,v_2 \in V_i$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq62.gif"/></alternatives></inline-formula> with a new bond. For simplicity, we only allow connections to start from the latest appended atom <inline-formula id="IEq63"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v^*$$\end{document}</tex-math><mml:math id="M58"><mml:msup><mml:mi>v</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq63.gif"/></alternatives></inline-formula>, which means that <inline-formula id="IEq64"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_1=v^*$$\end{document}</tex-math><mml:math id="M60"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq64.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par35"><italic>Termination</italic> (<inline-formula id="IEq65"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t^*$$\end{document}</tex-math><mml:math id="M62"><mml:msup><mml:mi>t</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq65.gif"/></alternatives></inline-formula>) End the generation process.</p></list-item></list>The entire process is shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>, and a more detailed illustration is provided in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S1 and S2. In theory, <italic>T</italic>(<italic>G</italic>) should not contain actions that violate the chemical validity of molecules. However, in order to test the ability for the model to learn those constraints, we do not explicity exclude those actions from <italic>T</italic>(<italic>G</italic>) during training.</p>
      <p id="Par36">Note that compared with the implementation in [<xref ref-type="bibr" rid="CR22">22</xref>], the action of adding new atom and the action of connecting it to the molecule is merged into a single “append” step. This helps to reduce the number of steps during generation. It is easy to show that the number of steps required for generating graph <inline-formula id="IEq66"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G=(V, E)$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq66.gif"/></alternatives></inline-formula> equals exactly to <inline-formula id="IEq67"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|E|+2$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq67.gif"/></alternatives></inline-formula>, which is generally much smaller than the length of the corresponding SMILES string (as shown in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S3).</p>
    </sec>
    <sec id="Sec6">
      <title>Decoding policy</title>
      <p id="Par37">During generation, the decoding policy <inline-formula id="IEq68"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{\varvec{\theta }}$$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq68.gif"/></alternatives></inline-formula> need to specify the probability value for each graph transition in <inline-formula id="IEq69"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T(G_i)$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:mi>T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq69.gif"/></alternatives></inline-formula>. More specifically, <inline-formula id="IEq70"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{\varvec{\theta }}$$\end{document}</tex-math><mml:math id="M72"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq70.gif"/></alternatives></inline-formula> need to output the following probability values:<list list-type="order"><list-item><p id="Par38"><inline-formula id="IEq71"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{p}}_v^\text{A}$$\end{document}</tex-math><mml:math id="M74"><mml:msubsup><mml:mi mathvariant="bold">p</mml:mi><mml:mi>v</mml:mi><mml:mtext>A</mml:mtext></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq71.gif"/></alternatives></inline-formula><italic>for each</italic><inline-formula id="IEq72"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v \in V_i$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:mi>v</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq72.gif"/></alternatives></inline-formula> A matrix with size <inline-formula id="IEq73"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|A|\times |B|$$\end{document}</tex-math><mml:math id="M78"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>×</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq73.gif"/></alternatives></inline-formula>, whose element <inline-formula id="IEq74"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$({\mathbf{p}}_v)_{ab}$$\end{document}</tex-math><mml:math id="M80"><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">p</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ab</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq74.gif"/></alternatives></inline-formula> represents the probability of appending a new atom of type <inline-formula id="IEq75"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a \in A$$\end{document}</tex-math><mml:math id="M82"><mml:mrow><mml:mi>a</mml:mi><mml:mo>∈</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq75.gif"/></alternatives></inline-formula> to atom <italic>v</italic> with a new bond of type <inline-formula id="IEq76"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b \in B$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:mi>b</mml:mi><mml:mo>∈</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq76.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par39"><inline-formula id="IEq77"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{p}}_v^\text{C}$$\end{document}</tex-math><mml:math id="M86"><mml:msubsup><mml:mi mathvariant="bold">p</mml:mi><mml:mi>v</mml:mi><mml:mtext>C</mml:mtext></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq77.gif"/></alternatives></inline-formula><italic>for each</italic><inline-formula id="IEq78"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v \in V_i$$\end{document}</tex-math><mml:math id="M88"><mml:mrow><mml:mi>v</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq78.gif"/></alternatives></inline-formula> A vector with size |<italic>B</italic>|, whose element <inline-formula id="IEq79"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$({\mathbf{p}}_v^\text{C})_{b}$$\end{document}</tex-math><mml:math id="M90"><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="bold">p</mml:mi><mml:mi>v</mml:mi><mml:mtext>C</mml:mtext></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>b</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq79.gif"/></alternatives></inline-formula> represents the probability of connecting the latest added atom <inline-formula id="IEq80"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v^*$$\end{document}</tex-math><mml:math id="M92"><mml:msup><mml:mi>v</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq80.gif"/></alternatives></inline-formula> with <italic>v</italic> using a new bond of type <inline-formula id="IEq81"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b\in B$$\end{document}</tex-math><mml:math id="M94"><mml:mrow><mml:mi>b</mml:mi><mml:mo>∈</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq81.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par40"><inline-formula id="IEq82"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p^*$$\end{document}</tex-math><mml:math id="M96"><mml:msup><mml:mi>p</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq82.gif"/></alternatives></inline-formula> A scalar value indicating the probability of terminating the generation.</p></list-item></list>A visualized depiction of <inline-formula id="IEq83"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{p}}_v^\text{A}$$\end{document}</tex-math><mml:math id="M98"><mml:msubsup><mml:mi mathvariant="bold">p</mml:mi><mml:mi>v</mml:mi><mml:mtext>A</mml:mtext></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq83.gif"/></alternatives></inline-formula>, <inline-formula id="IEq84"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{p}}_v^\text{C}$$\end{document}</tex-math><mml:math id="M100"><mml:msubsup><mml:mi mathvariant="bold">p</mml:mi><mml:mi>v</mml:mi><mml:mtext>C</mml:mtext></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq84.gif"/></alternatives></inline-formula> and <inline-formula id="IEq85"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p^*$$\end{document}</tex-math><mml:math id="M102"><mml:msup><mml:mi>p</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq85.gif"/></alternatives></inline-formula> is shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. The decoding policy <inline-formula id="IEq86"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{\varvec{\theta }}$$\end{document}</tex-math><mml:math id="M104"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq86.gif"/></alternatives></inline-formula> is parameterized using neural network. At each step, the network accepts the the decoding history <inline-formula id="IEq87"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(G_0, \ldots, G_i)$$\end{document}</tex-math><mml:math id="M106"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq87.gif"/></alternatives></inline-formula> as input and calculates the probability values (<inline-formula id="IEq88"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{p}}_v^\text{A}$$\end{document}</tex-math><mml:math id="M108"><mml:msubsup><mml:mi mathvariant="bold">p</mml:mi><mml:mi>v</mml:mi><mml:mtext>A</mml:mtext></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq88.gif"/></alternatives></inline-formula>, <inline-formula id="IEq89"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{p}}_v^\text{C}$$\end{document}</tex-math><mml:math id="M110"><mml:msubsup><mml:mi mathvariant="bold">p</mml:mi><mml:mi>v</mml:mi><mml:mtext>C</mml:mtext></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq89.gif"/></alternatives></inline-formula>, <inline-formula id="IEq90"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p^*$$\end{document}</tex-math><mml:math id="M112"><mml:msup><mml:mi>p</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq90.gif"/></alternatives></inline-formula>) as output. In this work, we explored two novel graph generation architectures, namely MolMP and MolRNN. Unlike the methods proposed in [<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR22">22</xref>], the two architectures do not involve atom level recurrency, which helps to increase the scalability of the model.</p>
      <sec id="Sec7">
        <title>MolMP</title>
        <p id="Par41">MolMP models graph generation as a Markov process, where the transition of <inline-formula id="IEq91"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_i$$\end{document}</tex-math><mml:math id="M114"><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq91.gif"/></alternatives></inline-formula> only depends on the current state of the graph, not on the history (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a).<fig id="Fig3"><label>Fig. 3</label><caption><p>The two type of graph generative architectures explored in this work: <bold>a</bold> MolMP: this architecture treats graph generation as a Markov process, in which the transition of <inline-formula id="IEq9"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_i$$\end{document}</tex-math><mml:math id="M116"><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq9.gif"/></alternatives></inline-formula> only depends on the current state of the graph, not on the history. <bold>b</bold> MolRNN: this architecture adds a single molecule level recurrent unit to MolMP</p></caption><graphic xlink:href="13321_2018_287_Fig3_HTML" id="MO4"/></fig> This means that <inline-formula id="IEq92"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{\varvec{\theta }}(t|G_i, \ldots, G_0)=p_{\varvec{\theta }}(t|G_i)$$\end{document}</tex-math><mml:math id="M118"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq92.gif"/></alternatives></inline-formula>. Since this type of architecture does not include any recurrent units, it will be less expensive compared with RNN based models. Moreover, the computation at different steps can be easily parallelized during training. The detailed architecture of MolMP is given as follows:<list list-type="order"><list-item><p id="Par42">An initial atom embedding <inline-formula id="IEq93"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{h}}^0_v$$\end{document}</tex-math><mml:math id="M120"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">h</mml:mi></mml:mrow><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq93.gif"/></alternatives></inline-formula> is first generated for each atom <italic>v</italic>: <disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\mathbf{h}}^0_v = \text{Embedding}_{\varvec{\theta }}(v) \end{aligned}$$\end{document}</tex-math><mml:math id="M122" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">h</mml:mi></mml:mrow><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mtext>Embedding</mml:mtext><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2018_287_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula><inline-formula id="IEq94"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{h}}^0_v$$\end{document}</tex-math><mml:math id="M124"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">h</mml:mi></mml:mrow><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq94.gif"/></alternatives></inline-formula> is determined based on the following information: (1) the atom type of <italic>v</italic> and (2) whether <italic>v</italic> is the latest appended atom. The dimension of <inline-formula id="IEq95"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{h}}^0_v$$\end{document}</tex-math><mml:math id="M126"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">h</mml:mi></mml:mrow><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq95.gif"/></alternatives></inline-formula> is set to 16.</p></list-item><list-item><p id="Par43"><inline-formula id="IEq96"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{h}}^0_v$$\end{document}</tex-math><mml:math id="M128"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">h</mml:mi></mml:mrow><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq96.gif"/></alternatives></inline-formula> is passed to a sequence of <italic>L</italic> graph convolutional layers: <disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\mathbf{h}}^l_v = \text{GraphConv}^l_{\varvec{\theta }}({\mathbf{h}}^{l-1}_v, G_i) \end{aligned}$$\end{document}</tex-math><mml:math id="M130" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">h</mml:mi></mml:mrow><mml:mi>v</mml:mi><mml:mi>l</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mtext>GraphConv</mml:mtext><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">h</mml:mi></mml:mrow><mml:mi>v</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2018_287_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq97"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l=1, \ldots, L$$\end{document}</tex-math><mml:math id="M132"><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq97.gif"/></alternatives></inline-formula>. Except the first layer, each convolutional layer <inline-formula id="IEq98"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{GraphConv}^l_{\varvec{\theta }}$$\end{document}</tex-math><mml:math id="M134"><mml:msubsup><mml:mtext>GraphConv</mml:mtext><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq98.gif"/></alternatives></inline-formula> adopts a “BN-ReLU-Conv” structure as suggested in [<xref ref-type="bibr" rid="CR23">23</xref>]. The detailed architecture of graph convolution is described in “Graph Convolution”. We use six convolution layers in this work (<inline-formula id="IEq99"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L=6$$\end{document}</tex-math><mml:math id="M136"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq99.gif"/></alternatives></inline-formula>), each with 32, 64, 128, 128, 256, 256 output units.</p><p id="Par44">The outputs from all graph convolutional layers are then concatenated together, followed by batch normalization and ReLU: <disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\mathbf{h}}_v^\text{skip} = relu\left(bn(\text{Concat}({\mathbf{h}}^1_v, \ldots, {\mathbf{h}}^L_v))\right) \end{aligned}$$\end{document}</tex-math><mml:math id="M138" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">h</mml:mi><mml:mi>v</mml:mi><mml:mtext>skip</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mi>b</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext>Concat</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">h</mml:mi></mml:mrow><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">h</mml:mi></mml:mrow><mml:mi>v</mml:mi><mml:mi>L</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2018_287_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>
</p></list-item><list-item><p id="Par45"><inline-formula id="IEq100"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{h}}_v^\text{skip}$$\end{document}</tex-math><mml:math id="M140"><mml:msubsup><mml:mi mathvariant="bold">h</mml:mi><mml:mi>v</mml:mi><mml:mtext>skip</mml:mtext></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq100.gif"/></alternatives></inline-formula> is passed to the fully connected network <inline-formula id="IEq101"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{MLP}^\text{FC}_{\varvec{\theta }}$$\end{document}</tex-math><mml:math id="M142"><mml:msubsup><mml:mtext>MLP</mml:mtext><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mtext>FC</mml:mtext></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq101.gif"/></alternatives></inline-formula> to obtain the final atom level representation <inline-formula id="IEq102"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{h}}_v$$\end{document}</tex-math><mml:math id="M144"><mml:msub><mml:mi mathvariant="bold">h</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq102.gif"/></alternatives></inline-formula>. <disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\mathbf{h}}_v = \text{MLP}^\text{FC}_{\varvec{\theta }}({\mathbf{h}}_v^\text{skip}) \end{aligned}$$\end{document}</tex-math><mml:math id="M146" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">h</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mtext>MLP</mml:mtext><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mtext>FC</mml:mtext></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="bold">h</mml:mi><mml:mi>v</mml:mi><mml:mtext>skip</mml:mtext></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2018_287_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula><inline-formula id="IEq103"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{MLP}^\text{FC}_{\varvec{\theta }}$$\end{document}</tex-math><mml:math id="M148"><mml:msubsup><mml:mtext>MLP</mml:mtext><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mtext>FC</mml:mtext></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq103.gif"/></alternatives></inline-formula> consists of two linear layers, with 256 and 512 output units each. Batch normalization and ReLU are applied after each layer.</p></list-item><list-item><p id="Par46">Average pooling is applied at graph level to obtain the molecule representation <inline-formula id="IEq104"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{h}}_{G_i}$$\end{document}</tex-math><mml:math id="M150"><mml:msub><mml:mi mathvariant="bold">h</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq104.gif"/></alternatives></inline-formula>: <disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\mathbf{h}}_{G_i}=AvgPool([{\mathbf{h}}_v]_{v\in V_i}) \end{aligned}$$\end{document}</tex-math><mml:math id="M152" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">h</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mi>v</mml:mi><mml:mi>g</mml:mi><mml:mi>P</mml:mi><mml:mi>o</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi mathvariant="bold">h</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2018_287_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>
</p></list-item><list-item><p id="Par47">The probability value for each action is produced by first calculate the unnormalized values (<inline-formula id="IEq105"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{{\mathbf{p}}}_v^A$$\end{document}</tex-math><mml:math id="M154"><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>v</mml:mi><mml:mi>A</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq105.gif"/></alternatives></inline-formula>, <inline-formula id="IEq106"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{{\mathbf{p}}}_v^C$$\end{document}</tex-math><mml:math id="M156"><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>v</mml:mi><mml:mi>C</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq106.gif"/></alternatives></inline-formula> and <inline-formula id="IEq107"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{p}^*$$\end{document}</tex-math><mml:math id="M158"><mml:msup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq107.gif"/></alternatives></inline-formula>) as follows: <disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\left[\hat{\mathbf{p}}_v^A, \hat{\mathbf{p}}_v^C\right]=\text{MLP}_{\varvec{\theta }}({\mathbf{h}}_v, {\mathbf{h}}_{G_i}) \end{aligned}$$\end{document}</tex-math><mml:math id="M160" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mfenced close="]" open="[" separators=""><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>v</mml:mi><mml:mi>A</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>v</mml:mi><mml:mi>C</mml:mi></mml:msubsup></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mtext>MLP</mml:mtext><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">h</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">h</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2018_287_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>
<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\hat{p}^*=\text{MLP}^*_{\varvec{\theta }}({\mathbf{h}}_{G_i}) \end{aligned}$$\end{document}</tex-math><mml:math id="M162" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>∗</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:msubsup><mml:mtext>MLP</mml:mtext><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mo>∗</mml:mo></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">h</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2018_287_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>Those values are then normalized to get the final result: <disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;{\mathbf{p}}^\text{A}_v = \hat{{\mathbf{p}}}_v^A/P \end{aligned}$$\end{document}</tex-math><mml:math id="M164" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mi>v</mml:mi><mml:mtext>A</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>v</mml:mi><mml:mi>A</mml:mi></mml:msubsup><mml:mo stretchy="false">/</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2018_287_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>
<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;{\mathbf{p}}^\text{C}_v = \hat{{\mathbf{p}}}_v^C/P \end{aligned}$$\end{document}</tex-math><mml:math id="M166" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mi>v</mml:mi><mml:mtext>C</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>v</mml:mi><mml:mi>C</mml:mi></mml:msubsup><mml:mo stretchy="false">/</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2018_287_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula>
<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;p^* =\hat{p}^*/P \end{aligned}$$\end{document}</tex-math><mml:math id="M168" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2018_287_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula> where <inline-formula id="IEq108"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P=\sum _{vab}(\hat{{\mathbf{p}}}^\text{A}_v)_{ab}+\sum _{vb}(\hat{{\mathbf{p}}}^\text{C}_v)_b + \hat{p}^*$$\end{document}</tex-math><mml:math id="M170"><mml:mrow><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="italic">vab</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>v</mml:mi><mml:mtext>A</mml:mtext></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ab</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="italic">vb</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>v</mml:mi><mml:mtext>C</mml:mtext></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>b</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq108.gif"/></alternatives></inline-formula></p><p id="Par48"><inline-formula id="IEq109"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{MLP}_{\varvec{\theta }}$$\end{document}</tex-math><mml:math id="M172"><mml:msub><mml:mtext>MLP</mml:mtext><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq109.gif"/></alternatives></inline-formula>is a two layer fully connected network with hidden size 128 and output size <inline-formula id="IEq110"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|A| \times |B| + |B|$$\end{document}</tex-math><mml:math id="M174"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>×</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq110.gif"/></alternatives></inline-formula>. This output is then split into the matrix <inline-formula id="IEq111"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{{\mathbf{p}}}_v^A$$\end{document}</tex-math><mml:math id="M176"><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>v</mml:mi><mml:mi>A</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq111.gif"/></alternatives></inline-formula> of size <inline-formula id="IEq112"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|A| \times |B|$$\end{document}</tex-math><mml:math id="M178"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>×</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq112.gif"/></alternatives></inline-formula> and the vector <inline-formula id="IEq113"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{\mathbf{p}}_v^C$$\end{document}</tex-math><mml:math id="M180"><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold">p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>v</mml:mi><mml:mi>C</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq113.gif"/></alternatives></inline-formula> of length |<italic>B</italic>|. <inline-formula id="IEq114"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{MLP}^*$$\end{document}</tex-math><mml:math id="M182"><mml:msup><mml:mtext>MLP</mml:mtext><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq114.gif"/></alternatives></inline-formula> is a one layer fully connected network. Both <inline-formula id="IEq115"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{MLP}_{\varvec{\theta }}$$\end{document}</tex-math><mml:math id="M184"><mml:msub><mml:mtext>MLP</mml:mtext><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq115.gif"/></alternatives></inline-formula> and <inline-formula id="IEq116"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{MLP}^*$$\end{document}</tex-math><mml:math id="M186"><mml:msup><mml:mtext>MLP</mml:mtext><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq116.gif"/></alternatives></inline-formula> uses exponential activiaton in the output layer.</p></list-item></list>The architecture of the entire network is shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>.<fig id="Fig4"><label>Fig. 4</label><caption><p>Network architecture for MolMP. This figure shows the detailed model architecture for MolMP. MolRNN adopts a structure highly similar to that of MolMP, except the inclusion of a molecule level recurrent unit</p></caption><graphic xlink:href="13321_2018_287_Fig4_HTML" id="MO5"/></fig></p>
      </sec>
      <sec id="Sec8">
        <title>MolRNN</title>
        <p id="Par49">The second architecture adds a single molecule level recurrent unit to MolMP, as shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. We refer to this method as MolRNN. The model architecture is specified as follows:<list list-type="order"><list-item><p id="Par50">First of all, the model generates the atom level (<inline-formula id="IEq117"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{h}}_v, v \in V_i$$\end{document}</tex-math><mml:math id="M188"><mml:mrow><mml:msub><mml:mi mathvariant="bold">h</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq117.gif"/></alternatives></inline-formula>) and molecule level (<inline-formula id="IEq118"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{h}}_{G_i}$$\end{document}</tex-math><mml:math id="M190"><mml:msub><mml:mi mathvariant="bold">h</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq118.gif"/></alternatives></inline-formula>) representation for the graph state <inline-formula id="IEq119"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_i$$\end{document}</tex-math><mml:math id="M192"><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq119.gif"/></alternatives></inline-formula>. This part of the network uses the same architecture as that in MolMP.</p></list-item><list-item><p id="Par51">Given <inline-formula id="IEq120"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{h}}_v$$\end{document}</tex-math><mml:math id="M194"><mml:msub><mml:mi mathvariant="bold">h</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq120.gif"/></alternatives></inline-formula> and <inline-formula id="IEq121"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{h}}_{G_i}$$\end{document}</tex-math><mml:math id="M196"><mml:msub><mml:mi mathvariant="bold">h</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq121.gif"/></alternatives></inline-formula>, the hidden state of the molecule level recurrent unit (<inline-formula id="IEq122"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{h}}_i^{RNN}$$\end{document}</tex-math><mml:math id="M198"><mml:msubsup><mml:mi mathvariant="bold">h</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="italic">RNN</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq122.gif"/></alternatives></inline-formula>) is updated as: <disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\mathbf{h}}_{i+1}^\text{RNN}=\text{RNN}_{\varvec{\theta }}({\mathbf{h}}_i^\text{RNN}, {\mathbf{h}}_{v*}, {\mathbf{h}}_{G_i}) \end{aligned}$$\end{document}</tex-math><mml:math id="M200" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">h</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mtext>RNN</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mtext>RNN</mml:mtext><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="bold">h</mml:mi><mml:mi>i</mml:mi><mml:mtext>RNN</mml:mtext></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">h</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">h</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2018_287_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq123"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{h}}_{v*}$$\end{document}</tex-math><mml:math id="M202"><mml:msub><mml:mi mathvariant="bold">h</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq123.gif"/></alternatives></inline-formula> is the representation of the latest appended atom <inline-formula id="IEq124"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v^*$$\end{document}</tex-math><mml:math id="M204"><mml:msup><mml:mi>v</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq124.gif"/></alternatives></inline-formula>. The recurrent network <inline-formula id="IEq125"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{RNN}_{\varvec{\theta }}$$\end{document}</tex-math><mml:math id="M206"><mml:msub><mml:mtext>RNN</mml:mtext><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq125.gif"/></alternatives></inline-formula> is employed using three GRU layers with a hidden size of 512.</p></list-item><list-item><p id="Par52">The probability values <inline-formula id="IEq126"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{p}}_v^\text{A}$$\end{document}</tex-math><mml:math id="M208"><mml:msubsup><mml:mi mathvariant="bold">p</mml:mi><mml:mi>v</mml:mi><mml:mtext>A</mml:mtext></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq126.gif"/></alternatives></inline-formula>, <inline-formula id="IEq127"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{p}}_v^\text{C}$$\end{document}</tex-math><mml:math id="M210"><mml:msubsup><mml:mi mathvariant="bold">p</mml:mi><mml:mi>v</mml:mi><mml:mtext>C</mml:mtext></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq127.gif"/></alternatives></inline-formula>, <inline-formula id="IEq128"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p^*$$\end{document}</tex-math><mml:math id="M212"><mml:msup><mml:mi>p</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq128.gif"/></alternatives></inline-formula> are calculated in the same manner as MolMP by replacing <inline-formula id="IEq129"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{h}}_{G_i}$$\end{document}</tex-math><mml:math id="M214"><mml:msub><mml:mi mathvariant="bold">h</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq129.gif"/></alternatives></inline-formula> in Eqs. <xref rid="Equ6" ref-type="">6</xref> and <xref rid="Equ7" ref-type="">7</xref> with <inline-formula id="IEq130"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{h}}_{i+1}^\text{RNN}$$\end{document}</tex-math><mml:math id="M216"><mml:msubsup><mml:mi mathvariant="bold">h</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mtext>RNN</mml:mtext></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq130.gif"/></alternatives></inline-formula>.</p></list-item></list>The overall architecture of MolRNN is highly similar to that of MolMP. However, it is found that the molecule level recurrent unit in MolRNN provides significant improvements to the model performance (see “<xref rid="Sec25" ref-type="sec">Model performance and sample quality</xref>”), while inducing little extra computational cost compared with MolMP.</p>
      </sec>
      <sec id="Sec9">
        <title>Graph convolution</title>
        <p id="Par53">In this work, we rely on graph convolutional network (GCN) [<xref ref-type="bibr" rid="CR24">24</xref>] to extract information from intermediate graph states <inline-formula id="IEq131"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_i$$\end{document}</tex-math><mml:math id="M218"><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq131.gif"/></alternatives></inline-formula>. Each graph convolutional layer adopts the “BN-ReLU-Conv” structure as described before. In terms of the convolution part, the architecture is structured as follows:<disp-formula id="Equ12"><label>12</label><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned} {\mathbf{h}}_v^l &amp;={\mathbf{W}}^l{\mathbf{h}}_v^{l-1} \\&amp;\quad+\sum _{b\in B}{\Theta _b^l \sum _{u\in N_b^{bond}(v)}{{\mathbf{h}}_u^{l-1}}} \\&amp;\quad+\sum _{1 &lt; d \le D}{\Phi _d^l \sum _{u\in N_d^{path}(v)}{{\mathbf{h}}_u^{l-1}}} \end{aligned} \end{aligned}$$\end{document}</tex-math><mml:math id="M220" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi mathvariant="bold">h</mml:mi><mml:mi>v</mml:mi><mml:mi>l</mml:mi></mml:msubsup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msup><mml:msubsup><mml:mi mathvariant="bold">h</mml:mi><mml:mi>v</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>∈</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Θ</mml:mi><mml:mi>b</mml:mi><mml:mi>l</mml:mi></mml:msubsup><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mi>b</mml:mi><mml:mrow><mml:mi mathvariant="italic">bond</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:msubsup><mml:mi mathvariant="bold">h</mml:mi><mml:mi>u</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>d</mml:mi><mml:mo>≤</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mi>d</mml:mi><mml:mi>l</mml:mi></mml:msubsup><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mi>d</mml:mi><mml:mrow><mml:mi mathvariant="italic">path</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:msubsup><mml:mi mathvariant="bold">h</mml:mi><mml:mi>u</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2018_287_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq132"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{h}}_v^l$$\end{document}</tex-math><mml:math id="M222"><mml:msubsup><mml:mi mathvariant="bold">h</mml:mi><mml:mi>v</mml:mi><mml:mi>l</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq132.gif"/></alternatives></inline-formula> is the output representation of atom <italic>v</italic> at layer <italic>l</italic>, and <inline-formula id="IEq133"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{h}}_v^{l-1}$$\end{document}</tex-math><mml:math id="M224"><mml:msubsup><mml:mi mathvariant="bold">h</mml:mi><mml:mi>v</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq133.gif"/></alternatives></inline-formula> is the input representation. <inline-formula id="IEq134"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_b^{bond} (v)$$\end{document}</tex-math><mml:math id="M226"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>b</mml:mi><mml:mrow><mml:mi mathvariant="italic">bond</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq134.gif"/></alternatives></inline-formula> is the set of all atoms directly connected to atom <italic>v</italic> with bond of type <italic>b</italic>, and <inline-formula id="IEq135"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_d^{path} (v)$$\end{document}</tex-math><mml:math id="M228"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>d</mml:mi><mml:mrow><mml:mi mathvariant="italic">path</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq135.gif"/></alternatives></inline-formula> is the set of all atoms whose distance to atom <italic>v</italic> equals to <italic>d</italic>. <italic>D</italic> represents the receptive field size, which is set to 3 in this work. <inline-formula id="IEq136"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W^l$$\end{document}</tex-math><mml:math id="M230"><mml:msup><mml:mi>W</mml:mi><mml:mi>l</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq136.gif"/></alternatives></inline-formula>, <inline-formula id="IEq137"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Theta _b^l$$\end{document}</tex-math><mml:math id="M232"><mml:msubsup><mml:mi mathvariant="normal">Θ</mml:mi><mml:mi>b</mml:mi><mml:mi>l</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq137.gif"/></alternatives></inline-formula> and <inline-formula id="IEq138"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Phi _d^l$$\end{document}</tex-math><mml:math id="M234"><mml:msubsup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mi>d</mml:mi><mml:mi>l</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq138.gif"/></alternatives></inline-formula> are weight parameters of layer <italic>l</italic>.</p>
        <p id="Par54">In brief, the output representation of atom <italic>v</italic> at each layer <italic>l</italic> (<inline-formula id="IEq139"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{h}}_v^l$$\end{document}</tex-math><mml:math id="M236"><mml:msubsup><mml:mi mathvariant="bold">h</mml:mi><mml:mi>v</mml:mi><mml:mi>l</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq139.gif"/></alternatives></inline-formula>) is calculated according to the following information:<list list-type="order"><list-item><p id="Par55">The input representation of <italic>v</italic> (<inline-formula id="IEq140"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{h}}_v^{l-1}$$\end{document}</tex-math><mml:math id="M238"><mml:msubsup><mml:mi mathvariant="bold">h</mml:mi><mml:mi>v</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq140.gif"/></alternatives></inline-formula>),</p></list-item><list-item><p id="Par56">Information of local neighbors, which is given by <inline-formula id="IEq141"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sum _{b\in B}{\Theta _b^l \sum _{u\in N_b^{bond}(v)}{{\mathbf{h}}_u^{l-1}}}$$\end{document}</tex-math><mml:math id="M240"><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>∈</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Θ</mml:mi><mml:mi>b</mml:mi><mml:mi>l</mml:mi></mml:msubsup><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mi>b</mml:mi><mml:mrow><mml:mi mathvariant="italic">bond</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:msubsup><mml:mi mathvariant="bold">h</mml:mi><mml:mi>u</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq141.gif"/></alternatives></inline-formula>. Note that this part of information is conditioned on the bond type <italic>b</italic> between <italic>v</italic> and its neighborhood atom <italic>u</italic>.</p></list-item><list-item><p id="Par57">Information of remote neighbors, given by <inline-formula id="IEq142"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sum _{1 &lt; d \le D}{\Phi _d^l \sum _{u\in N_d^{path}(v)}{{\mathbf{h}}_u^{l-1}}}$$\end{document}</tex-math><mml:math id="M242"><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>d</mml:mi><mml:mo>≤</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mi>d</mml:mi><mml:mi>l</mml:mi></mml:msubsup><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mi>d</mml:mi><mml:mrow><mml:mi mathvariant="italic">path</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:msubsup><mml:mi mathvariant="bold">h</mml:mi><mml:mi>u</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq142.gif"/></alternatives></inline-formula>. This part of information is conditioned on the distance <italic>d</italic> between <italic>v</italic> and its remote neighbor <italic>u</italic>.</p></list-item></list>The architecture is illustrated in Fig. <xref rid="Fig5" ref-type="fig">5</xref>.<fig id="Fig5"><label>Fig. 5</label><caption><p>Architecture of graph convolutional layer. At each layer, the output representation for atom <italic>v</italic> is given by: (1) the input representation of <italic>v</italic> from previous layers, (2) information of local neighbors and (3) information of distant neighbors</p></caption><graphic xlink:href="13321_2018_287_Fig5_HTML" id="MO6"/></fig> Our implementation of graph convolution is similar to the edge conditioned convolution by Simonovsky et al. [<xref ref-type="bibr" rid="CR25">25</xref>], except that we directly include the information of remote neighbors of <italic>v</italic> in order to achieve a larger receptive field with fewer layers.
</p>
      </sec>
    </sec>
    <sec id="Sec10">
      <title>Likelihood function</title>
      <p id="Par58">To train the generative model, we need to maximize the log-likelihood <inline-formula id="IEq143"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{\varvec{\theta }} (G)$$\end{document}</tex-math><mml:math id="M244"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq143.gif"/></alternatives></inline-formula> for the training samples. However, for the step-wise generative models discussed above, the likelihood is only tractable for a given decoding route <inline-formula id="IEq144"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r=((G_0,t_0),(G_1,t_1),\ldots,(G_n,t_n))$$\end{document}</tex-math><mml:math id="M246"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq144.gif"/></alternatives></inline-formula>:<disp-formula id="Equ13"><label>13</label><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \log {p_{\varvec{\theta }}(G, r)} = \sum _{i=0}^{n}{\log {p_{\varvec{\theta }}(t_i|G_i, \ldots, G_0)}} \end{aligned}$$\end{document}</tex-math><mml:math id="M248" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2018_287_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula>While the marginal likelihood can be computed as:<disp-formula id="Equ14"><label>14</label><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \log {p_{\varvec{\theta }}(G)=\log {\sum _{r \in R(G)}{p_{\varvec{\theta }}(G, r)}}} \end{aligned}$$\end{document}</tex-math><mml:math id="M250" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>log</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2018_287_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula>where <italic>R</italic>(<italic>G</italic>) is the set of all possible decoding route for <italic>G</italic>. The marginal likelihood function is intractable for most molecules encountered in drug design. One way to resolve this problem is to use importance sampling as proposed in [<xref ref-type="bibr" rid="CR22">22</xref>]:<disp-formula id="Equ15"><label>15</label><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \log {p_{\varvec{\theta }}(G)} = \log {{\mathbb{E}}_{r\sim q(r|G)}\left[\frac{p_{\varvec{\theta }}(G, r)}{q(r|G)}\right]} \end{aligned}$$\end{document}</tex-math><mml:math id="M252" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mo>log</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>∼</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mfenced close="]" open="[" separators=""><mml:mfrac><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2018_287_Article_Equ15.gif" position="anchor"/></alternatives></disp-formula>where <italic>q</italic>(<italic>r</italic>|<italic>G</italic>) is a predefined distribution on <italic>R</italic>(<italic>G</italic>). Both the deterministic and the fully randomized <italic>q</italic>(<italic>r</italic>|<italic>G</italic>) were explored in the previous work [<xref ref-type="bibr" rid="CR22">22</xref>]. However, a more desirable solution would lie in somewhere between deterministic decoding and fully randomized decoding. In this work, instead of sample from the distribution <italic>q</italic>(<italic>r</italic>|<italic>G</italic>), we sample r from distribution <inline-formula id="IEq145"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_\alpha (r|G)$$\end{document}</tex-math><mml:math id="M254"><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq145.gif"/></alternatives></inline-formula> that is parameterized by <inline-formula id="IEq146"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0 \le \alpha \le 1$$\end{document}</tex-math><mml:math id="M256"><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi>α</mml:mi><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq146.gif"/></alternatives></inline-formula>. <inline-formula id="IEq147"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_\alpha (r|G)$$\end{document}</tex-math><mml:math id="M258"><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq147.gif"/></alternatives></inline-formula> is designed such that the decoding will largely follow depth first decoding with canonical ordering, but at each step, there is a small possibility <inline-formula id="IEq148"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1-\alpha$$\end{document}</tex-math><mml:math id="M260"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq148.gif"/></alternatives></inline-formula> that the model will make a random mistake. In this way, the parameter <inline-formula id="IEq149"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M262"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq149.gif"/></alternatives></inline-formula> measures can be used to control the randomness of the distribution <inline-formula id="IEq150"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_\alpha$$\end{document}</tex-math><mml:math id="M264"><mml:msub><mml:mi>q</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq150.gif"/></alternatives></inline-formula>. The algorithm is shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary Text 4.<disp-formula id="Equ16"><label>16</label><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned} \log {p_{\varvec{\theta }}(G)}&amp;= \log {{\mathbb{E}}_{r\sim q_\alpha (r|G)}\left[\frac{p_{\varvec{\theta }}(G, r)}{q_\alpha (r|G)}\right]} \\&amp;\ge \log {\frac{1}{k}\sum _{i=1}^k{\frac{p_{\varvec{\theta }}(G, r_i)}{q_\alpha (r_i|G)}}} \end{aligned} \end{aligned}$$\end{document}</tex-math><mml:math id="M266" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo>log</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>∼</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mfenced close="]" open="[" separators=""><mml:mfrac><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>≥</mml:mo><mml:mo>log</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>k</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mfrac><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2018_287_Article_Equ16.gif" position="anchor"/></alternatives></disp-formula>For <inline-formula id="IEq151"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha =1$$\end{document}</tex-math><mml:math id="M268"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq151.gif"/></alternatives></inline-formula>, the distribution falls back to the deterministic decoding. The parameter <inline-formula id="IEq152"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M270"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq152.gif"/></alternatives></inline-formula> is treated as a hyperparameter which is optimized for model performance. We tried <inline-formula id="IEq153"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha \in \{1.0,0.8,0.6\}$$\end{document}</tex-math><mml:math id="M272"><mml:mrow><mml:mi>α</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1.0</mml:mn><mml:mo>,</mml:mo><mml:mn>0.8</mml:mn><mml:mo>,</mml:mo><mml:mn>0.6</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq153.gif"/></alternatives></inline-formula> on both MolMP and MolRNN.</p>
    </sec>
    <sec id="Sec11">
      <title>Conditional generative model</title>
      <p id="Par59">Most molecule design tasks require to produce compounds satisfying certain criteria, such as being synthetically available or having a high affinity for a certain target. Previous researches have developed various methods to achieve objective directed molecule generation. Segler et al. [<xref ref-type="bibr" rid="CR12">12</xref>] used transfer learning in the design of focused compound libraries. Olivecrona et al. [<xref ref-type="bibr" rid="CR13">13</xref>] applied reinforcement learning (RL) in the objective based chemical design and have reported promising performance in various tasks. Guimaraes et al. [<xref ref-type="bibr" rid="CR26">26</xref>] proposed ORGAN, which combines SeqGAN with an domain-specific objective term, and showed that ORGAN is effective in the optimization of different molecular properties. Neil et al. [<xref ref-type="bibr" rid="CR27">27</xref>] created a benchmark analysis of various RL based method in different tasks of molecule design. In this work, we explored another way to achieve requirement based molecule design using conditional generative model. We first convert the given requirement to the numerial representation called conditional code (<inline-formula id="IEq154"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}$$\end{document}</tex-math><mml:math id="M274"><mml:mi mathvariant="bold">c</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq154.gif"/></alternatives></inline-formula>), and the generative model is then modified to be conditioned on <inline-formula id="IEq155"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}$$\end{document}</tex-math><mml:math id="M276"><mml:mi mathvariant="bold">c</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq155.gif"/></alternatives></inline-formula>. For graph generative model, this means that the decoding policy is now <inline-formula id="IEq156"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{\varvec{\theta }} (t_i|G_i, \ldots, G_0, {\mathbf{c}})$$\end{document}</tex-math><mml:math id="M278"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq156.gif"/></alternatives></inline-formula> (see Fig. <xref rid="Fig6" ref-type="fig">6</xref>).<fig id="Fig6"><label>Fig. 6</label><caption><p>Conditonal generative models: <bold>a</bold> For the generation of molecules based on a given requriement, the requriement (query) is first converted to the numerical representation called conditoinal code, the generative model is then modified to be conditioned on the conditonal code. <bold>b</bold> Scaffold based molecule generation: The model is required to generate molecules based on a given scaffold. This requriement is first converted to the conditional code called scaffold fingerprint. Then the molecule containing the query scaffold is generated based on the fingerprint. <bold>c</bold> Generation based on drug-likeness and synthetic accessibility: Drug-likeness and synthetic accessibility are first quantized using QED and SAscore. Then model then generates molecules based on the two properties. <bold>d</bold> Designing of dual inhibitors of JNK3 and GSK-3<inline-formula id="IEq10"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M280"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq10.gif"/></alternatives></inline-formula>: the generation process is based on the bioactivity fingerprint containing the activity requirement of each target</p></caption><graphic xlink:href="13321_2018_287_Fig6_HTML" id="MO7"/></fig> Compared with previous approaches by Olivecrona et al. and Guimaraes et al., conditional generative model does not require reinforcement learning, and provides the following flexibilities:<list list-type="order"><list-item><p id="Par60">The conditional code can incorporate both discrete and continuous objectives, and can easily scale to multiple objective.</p></list-item><list-item><p id="Par61">When changing the generation objective, previous methods usually require the model to be retained on the new condition. But for conditional generative models, this can be achieve simply by changing the conditional code input c.</p></list-item></list>Both graph based and SMILES based conditional generators are implemented in this work. For graph based model, the graph convolution is modified to include <inline-formula id="IEq157"><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}$$\end{document}</tex-math><mml:math id="M282"><mml:mi mathvariant="bold">c</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq157.gif"/></alternatives></inline-formula> as input:<disp-formula id="Equ17"><label>17</label><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned} {\mathbf{h}}_v^l &amp;={\mathbf{W}}^l{\mathbf{h}}_v^{l-1} \\&amp;\quad+\sum _{b\in B}{\Theta _b^l \sum _{u\in N_b^{bond}(v)}{{\mathbf{h}}_u^{l-1}}} \\&amp;\quad+\sum _{1 &lt; d \le D}{\Phi _d^l \sum _{u\in N_d^{path}(v)}{{\mathbf{h}}_u^{l-1}}} + \Psi ^l{\mathbf{c}} \end{aligned} \end{aligned}$$\end{document}</tex-math><mml:math id="M284" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi mathvariant="bold">h</mml:mi><mml:mi>v</mml:mi><mml:mi>l</mml:mi></mml:msubsup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msup><mml:msubsup><mml:mi mathvariant="bold">h</mml:mi><mml:mi>v</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>∈</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Θ</mml:mi><mml:mi>b</mml:mi><mml:mi>l</mml:mi></mml:msubsup><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mi>b</mml:mi><mml:mrow><mml:mi mathvariant="italic">bond</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:msubsup><mml:mi mathvariant="bold">h</mml:mi><mml:mi>u</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>d</mml:mi><mml:mo>≤</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mi>d</mml:mi><mml:mi>l</mml:mi></mml:msubsup><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mi>d</mml:mi><mml:mrow><mml:mi mathvariant="italic">path</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:msubsup><mml:mi mathvariant="bold">h</mml:mi><mml:mi>u</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mi>l</mml:mi></mml:msup><mml:mi mathvariant="bold">c</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2018_287_Article_Equ17.gif" position="anchor"/></alternatives></disp-formula>Simply state, <inline-formula id="IEq158"><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}$$\end{document}</tex-math><mml:math id="M286"><mml:mi mathvariant="bold">c</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq158.gif"/></alternatives></inline-formula> is included in the graph convoludion architecture by adding an additional term <inline-formula id="IEq159"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Psi ^l{\mathbf{c}}$$\end{document}</tex-math><mml:math id="M288"><mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mi>l</mml:mi></mml:msup><mml:mi mathvariant="bold">c</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq159.gif"/></alternatives></inline-formula> to the unconditional implementation in Eq. <xref rid="Equ12" ref-type="">12</xref>. For SMILELS based model, the conditional code is included by concatenating it with the input at each step: <inline-formula id="IEq160"><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{x}}_i^\prime =\text{Concat}({\mathbf{x}}_i, {\mathbf{c}})$$\end{document}</tex-math><mml:math id="M290"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">x</mml:mi><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mtext>Concat</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq160.gif"/></alternatives></inline-formula>. where <inline-formula id="IEq161"><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{x}}_i$$\end{document}</tex-math><mml:math id="M292"><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq161.gif"/></alternatives></inline-formula> is the one-hot representation of the SMILES charactor input at step <italic>i</italic>.</p>
      <p id="Par62">Conditional models have already been used by the previous work [<xref ref-type="bibr" rid="CR21">21</xref>] for molecule generation, but was restricted to simple properties such as the number of heavy atoms as conditional codes. Also, the method have not yet applied to multi-objective molecule generation. Here, we apply this method to other more complexed drug design tasks, including scaffold-based generation, property-based generation and the design of dual inhibitor of JNK3 and GSK-3<inline-formula id="IEq162"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M294"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq162.gif"/></alternatives></inline-formula> (see <xref rid="Fig6" ref-type="fig">6</xref>). The best performing graph and SMILES based generator (see “<xref rid="Sec25" ref-type="sec">Model performance and sample quality</xref>”) are implemented in conditionalized version and applied to those tasks.</p>
    </sec>
    <sec id="Sec12">
      <title>Scaffold-based generation</title>
      <p id="Par63">The concept of molecular scaffold has long been of significant importance in medicinal chemistry [<xref ref-type="bibr" rid="CR28">28</xref>]. Though various definitions are available, the most widely accepted definition is given by Bemis and Murcko [<xref ref-type="bibr" rid="CR29">29</xref>], who proposed derive the scaffold of a given molecule by removing all side chain atoms. Studies have found various scaffolds that have privileged characteristics in terms of the activity of certain target [<xref ref-type="bibr" rid="CR30">30</xref>–<xref ref-type="bibr" rid="CR32">32</xref>]. Once such privileged structure is found, a related task is to produce compound libraries containing such scaffolds for subsequent screening.</p>
      <p id="Par64">Here, conditional graph generative model is applied to generate compounds containing scaffold <italic>s</italic>, which is drawn from the pre-defined scaffold set <inline-formula id="IEq163"><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S=\{s_i \}_{i=1}^{N_S}$$\end{document}</tex-math><mml:math id="M296"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq163.gif"/></alternatives></inline-formula>. The set <italic>S</italic> is extracted from the list of approved drugs in DrugBank [<xref ref-type="bibr" rid="CR33">33</xref>]. Two types of structures are extracted from the molecules to construct <italic>S</italic>: (1) the Bemis–Murcko scaffolds, and (2) ring assemblies. Ring assemblies are included in <italic>S</italic> since we found that including extra structural information beside Bemis–Murcko scaffolds helps to improve the conditional generation performance. Detailed scaffold extraction workflow is shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary Text 2. For each molecule <italic>G</italic>, the conditional code <inline-formula id="IEq164"><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}=(c_1, c_2, \ldots, c_{N_S})$$\end{document}</tex-math><mml:math id="M298"><mml:mrow><mml:mi mathvariant="bold">c</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq164.gif"/></alternatives></inline-formula> is set to be the binary vector such that <inline-formula id="IEq165"><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_i=1$$\end{document}</tex-math><mml:math id="M300"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq165.gif"/></alternatives></inline-formula> if <italic>G</italic> contains <inline-formula id="IEq166"><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_i$$\end{document}</tex-math><mml:math id="M302"><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq166.gif"/></alternatives></inline-formula> as substructure, and <inline-formula id="IEq167"><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_i=0$$\end{document}</tex-math><mml:math id="M304"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq167.gif"/></alternatives></inline-formula> otherwise. We refer <inline-formula id="IEq168"><alternatives><tex-math id="M305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}$$\end{document}</tex-math><mml:math id="M306"><mml:mi mathvariant="bold">c</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq168.gif"/></alternatives></inline-formula> as the scaffold fingerprint of <italic>G</italic>, as it can in fact be viewed as a substructure fingerprint based on scaffold set <italic>S</italic>. To generate molecule containing substructure <inline-formula id="IEq169"><alternatives><tex-math id="M307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s \in S$$\end{document}</tex-math><mml:math id="M308"><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq169.gif"/></alternatives></inline-formula>, the fingerprint <inline-formula id="IEq170"><alternatives><tex-math id="M309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}_s$$\end{document}</tex-math><mml:math id="M310"><mml:msub><mml:mi mathvariant="bold">c</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq170.gif"/></alternatives></inline-formula> for <italic>s</italic> is used as conditional code. The output should contain two type of molecules:<list list-type="order"><list-item><p id="Par65">Molecules containing <italic>s</italic> as its Bemis–Murcko scaffold.</p></list-item><list-item><p id="Par66">Molecules whose Bemis–Murcko scaffold contains <italic>s</italic> but does not reside inside <italic>S</italic>.</p></list-item></list>The procedure is better demonstrated in Fig. <xref rid="Fig7" ref-type="fig">7</xref>.<fig id="Fig7"><label>Fig. 7</label><caption><p>Workflow for scaffold based molecule generation. Scaffold set <italic>S</italic> is first extracted from compounds in DrugBank. The conditional code <inline-formula id="IEq11"><alternatives><tex-math id="M311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}$$\end{document}</tex-math><mml:math id="M312"><mml:mi mathvariant="bold">c</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq11.gif"/></alternatives></inline-formula> is set to be the substructure fingerprint based on <italic>S</italic>. Training is performed with the training samples labeled with <inline-formula id="IEq12"><alternatives><tex-math id="M313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}_G$$\end{document}</tex-math><mml:math id="M314"><mml:msub><mml:mi mathvariant="bold">c</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq12.gif"/></alternatives></inline-formula>. After training, scaffold based generation is performed using the fingerprint <inline-formula id="IEq13"><alternatives><tex-math id="M315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}_s$$\end{document}</tex-math><mml:math id="M316"><mml:msub><mml:mi mathvariant="bold">c</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq13.gif"/></alternatives></inline-formula> of the query scaffold <inline-formula id="IEq14"><alternatives><tex-math id="M317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s \in S$$\end{document}</tex-math><mml:math id="M318"><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq14.gif"/></alternatives></inline-formula></p></caption><graphic xlink:href="13321_2018_287_Fig7_HTML" id="MO8"/></fig>
Using this method, detailed control can be performed on the scaffold of the output structure.</p>
    </sec>
    <sec id="Sec13">
      <title>Generation based on synthetic accessibility and drug-likeness</title>
      <p id="Par67">Drug-likeness and synthetic accessibility are two properties that have significant importance in the development of novel drug candidate. Drug-likeness measures the consistency of a given compound with the currently known drugs in terms of the structural or physical properties, and is frequently used to filter out obvious non-drug like compounds in the early phase of screening [<xref ref-type="bibr" rid="CR34">34</xref>, <xref ref-type="bibr" rid="CR35">35</xref>]. Synthetic accessibility is also an important property for de novo drug design since subsequent experimental validation requires synthesis of the given compound [<xref ref-type="bibr" rid="CR36">36</xref>]. In this task, the model is required to generate molecules according to a given level of drug-likeness and synthetic accessibility. The drug-likeness is measured using the Quantitative Estimate of Drug-likeness (QED) [<xref ref-type="bibr" rid="CR37">37</xref>], and synthetic accessibility is evaluated using the SA score [<xref ref-type="bibr" rid="CR36">36</xref>]. The conditional code <inline-formula id="IEq171"><alternatives><tex-math id="M319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}$$\end{document}</tex-math><mml:math id="M320"><mml:mi mathvariant="bold">c</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq171.gif"/></alternatives></inline-formula> is defined as <inline-formula id="IEq172"><alternatives><tex-math id="M321">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}=(QED,SA)$$\end{document}</tex-math><mml:math id="M322"><mml:mrow><mml:mi mathvariant="bold">c</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mi>E</mml:mi><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq172.gif"/></alternatives></inline-formula>, where the QED and SA score is all calculated using RDKit [<xref ref-type="bibr" rid="CR38">38</xref>].</p>
      <p id="Par68">In practice, instead of specifying a single value of QED and SA score, we often use intervals to express the requirements for desired output molecules. This means that we are required to sample molecules from the distribution <inline-formula id="IEq173"><alternatives><tex-math id="M323">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{\varvec{\theta }} (G|{\mathbf{c}}\in C)$$\end{document}</tex-math><mml:math id="M324"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">c</mml:mi><mml:mo>∈</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq173.gif"/></alternatives></inline-formula>, where the generation requirement is described as a set <italic>C</italic> instead of a single point <inline-formula id="IEq174"><alternatives><tex-math id="M325">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}$$\end{document}</tex-math><mml:math id="M326"><mml:mi mathvariant="bold">c</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq174.gif"/></alternatives></inline-formula>. Here, we samples from <inline-formula id="IEq175"><alternatives><tex-math id="M327">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{\varvec{\theta }}(G|{\mathbf{c}} \in C)$$\end{document}</tex-math><mml:math id="M328"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">c</mml:mi><mml:mo>∈</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq175.gif"/></alternatives></inline-formula> by first drawing <bold>c</bold> from <inline-formula id="IEq176"><alternatives><tex-math id="M329">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p({\mathbf{c}}|{\mathbf{c}}\in C)$$\end{document}</tex-math><mml:math id="M330"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">c</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">c</mml:mi><mml:mo>∈</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq176.gif"/></alternatives></inline-formula>, and then drawing <italic>G</italic> from <inline-formula id="IEq177"><alternatives><tex-math id="M331">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{\varvec{\theta }} (G|{\mathbf{c}})$$\end{document}</tex-math><mml:math id="M332"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq177.gif"/></alternatives></inline-formula>. Sampling from <inline-formula id="IEq178"><alternatives><tex-math id="M333">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p({\mathbf{c}}|{\mathbf{c}}\in C)$$\end{document}</tex-math><mml:math id="M334"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">c</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">c</mml:mi><mml:mo>∈</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq178.gif"/></alternatives></inline-formula> can be achieved by first sample <inline-formula id="IEq179"><alternatives><tex-math id="M335">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}$$\end{document}</tex-math><mml:math id="M336"><mml:mi mathvariant="bold">c</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq179.gif"/></alternatives></inline-formula> from <inline-formula id="IEq180"><alternatives><tex-math id="M337">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p({\mathbf{c}})$$\end{document}</tex-math><mml:math id="M338"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq180.gif"/></alternatives></inline-formula> using molecules from the test set, then filter <inline-formula id="IEq181"><alternatives><tex-math id="M339">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}$$\end{document}</tex-math><mml:math id="M340"><mml:mi mathvariant="bold">c</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq181.gif"/></alternatives></inline-formula> according to the requirement <inline-formula id="IEq182"><alternatives><tex-math id="M341">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}\in C$$\end{document}</tex-math><mml:math id="M342"><mml:mrow><mml:mi mathvariant="bold">c</mml:mi><mml:mo>∈</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq182.gif"/></alternatives></inline-formula>.</p>
    </sec>
    <sec id="Sec14">
      <title>Designing dual inhibitor against JNK3 and GSK-3<inline-formula id="IEq183"><alternatives><tex-math id="M343">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M344"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq183.gif"/></alternatives></inline-formula></title>
      <p id="Par69">With the ability to model multiple requirements at once, conditional generative models can be used to design compounds with specific activity profiles for multiple targets. Here, we consider the task of designing dual inhibitors against both c-Jun N-terminal kinase 3 (JNK3) and glycogen synthase kinase-3 beta (GSK-3<inline-formula id="IEq184"><alternatives><tex-math id="M345">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M346"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq184.gif"/></alternatives></inline-formula>). Both of the two targets are serine/threonine (S/T) kinases, and have shown to be related to the pathogenesis of various types of diseases [<xref ref-type="bibr" rid="CR39">39</xref>, <xref ref-type="bibr" rid="CR40">40</xref>]. Notably, both JNK3 and GSK-3<inline-formula id="IEq185"><alternatives><tex-math id="M347">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M348"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq185.gif"/></alternatives></inline-formula> are shown to be potential target in the treatment of Alzheimer’s disease (AD). Jointly inhibiting JNK3 and GSK-3<inline-formula id="IEq186"><alternatives><tex-math id="M349">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M350"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq186.gif"/></alternatives></inline-formula> may provide potential benefit for the treatment of AD.</p>
      <p id="Par70">The conditional code is set to be <inline-formula id="IEq187"><alternatives><tex-math id="M351">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}=(c_{JNK3},c_{GSK-3\beta })$$\end{document}</tex-math><mml:math id="M352"><mml:mrow><mml:mi mathvariant="bold">c</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mi>N</mml:mi><mml:mi>K</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mi>S</mml:mi><mml:mi>K</mml:mi><mml:mo>-</mml:mo><mml:mn>3</mml:mn><mml:mi>β</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq187.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq188"><alternatives><tex-math id="M353">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_{JNK3}$$\end{document}</tex-math><mml:math id="M354"><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mi>N</mml:mi><mml:mi>K</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq188.gif"/></alternatives></inline-formula>, <inline-formula id="IEq189"><alternatives><tex-math id="M355">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_{GSK-3\beta }$$\end{document}</tex-math><mml:math id="M356"><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mi>S</mml:mi><mml:mi>K</mml:mi><mml:mo>-</mml:mo><mml:mn>3</mml:mn><mml:mi>β</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq189.gif"/></alternatives></inline-formula> are binary values indicating whether the compound is active against JNK3 and GSK-3<inline-formula id="IEq190"><alternatives><tex-math id="M357">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M358"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq190.gif"/></alternatives></inline-formula>. For compounds in the ChEMBL dataset, <inline-formula id="IEq191"><alternatives><tex-math id="M359">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_{JNK3}$$\end{document}</tex-math><mml:math id="M360"><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mi>N</mml:mi><mml:mi>K</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq191.gif"/></alternatives></inline-formula> and <inline-formula id="IEq192"><alternatives><tex-math id="M361">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_{GSK-3\beta }$$\end{document}</tex-math><mml:math id="M362"><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mi>S</mml:mi><mml:mi>K</mml:mi><mml:mo>-</mml:mo><mml:mn>3</mml:mn><mml:mi>β</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq192.gif"/></alternatives></inline-formula> are labeled using a separately trained predictor. Random forest (RF) classifier, which has been demonstrated to provide good performance for kinase activity prediction [<xref ref-type="bibr" rid="CR41">41</xref>], is used as the predictor for GSK-3<inline-formula id="IEq193"><alternatives><tex-math id="M363">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M364"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq193.gif"/></alternatives></inline-formula> and JNK3 activity. Here, we use ECFP6 [<xref ref-type="bibr" rid="CR42">42</xref>] as the descriptor. The predictive model is trained using activity data from ExCAPE-DB [<xref ref-type="bibr" rid="CR43">43</xref>], which is an integrated database with activity values from ChEMBL and PubChem [<xref ref-type="bibr" rid="CR44">44</xref>]. Workflow for data extraction and predictor training is provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary Text 3. It is found that there is only 1.2% of molecules in ChEMBL that is predicted to be active against JNK3 or GSK-3<inline-formula id="IEq194"><alternatives><tex-math id="M365">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M366"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq194.gif"/></alternatives></inline-formula>. This imbalance results in low enrichment rate during conditioned generation. For better result, the model is first trained under the unconditioned setting, and then fine-tuned based on the 1.2% molecules mentioned above.</p>
    </sec>
    <sec id="Sec15">
      <title>Training details</title>
      <p id="Par71">The graph generative models are trained using the ChEMBL dataset. The data processing workflow largely follows Olivecrona et al. [<xref ref-type="bibr" rid="CR13">13</xref>], as described in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary Text 1. MXNet [<xref ref-type="bibr" rid="CR45">45</xref>] is used to implement the networks, and Adam optimizer [<xref ref-type="bibr" rid="CR46">46</xref>] is used for network training. An initial learning rate of 0.001 is used together with a decay rate of 0.001 for every 100 iterations. Other parameters of the optimizer are set to be the default values suggested in [<xref ref-type="bibr" rid="CR46">46</xref>] (that is, <inline-formula id="IEq195"><alternatives><tex-math id="M367">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _1=0.9,\,\beta _2=0.999$$\end{document}</tex-math><mml:math id="M368"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.9</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.999</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq195.gif"/></alternatives></inline-formula> and <inline-formula id="IEq196"><alternatives><tex-math id="M369">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon =10^{-8}$$\end{document}</tex-math><mml:math id="M370"><mml:mrow><mml:mi>ϵ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq196.gif"/></alternatives></inline-formula>). The training lasts for 5 epochs, and the size of each mini-batch is set to 200 during the training.</p>
      <p id="Par72">During training, the decoding route is drawn from the distribution <inline-formula id="IEq197"><alternatives><tex-math id="M371">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_\alpha (r|G)$$\end{document}</tex-math><mml:math id="M372"><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq197.gif"/></alternatives></inline-formula>. We tried three <inline-formula id="IEq198"><alternatives><tex-math id="M373">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M374"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq198.gif"/></alternatives></inline-formula> values: 1.0, 0.8 and 0.6, as discussed previously. For <inline-formula id="IEq199"><alternatives><tex-math id="M375">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha = 1.0$$\end{document}</tex-math><mml:math id="M376"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>1.0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq199.gif"/></alternatives></inline-formula>, <italic>k</italic> is set to 1 and the training can be performed on a single Nvidia GeForce GTX 1080Ti GPU for both MolMP and MolRNN. The training lasts for 14h for MolMP and 16h for MolRNN. For <inline-formula id="IEq200"><alternatives><tex-math id="M377">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha =0.8$$\end{document}</tex-math><mml:math id="M378"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq200.gif"/></alternatives></inline-formula> and <inline-formula id="IEq201"><alternatives><tex-math id="M379">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha =0.6$$\end{document}</tex-math><mml:math id="M380"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.6</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq201.gif"/></alternatives></inline-formula>, <italic>k</italic> is set to 5 and the training is performed synchronously on 4 GPUs. The training lasts for 30h for MolMP and 35h for MolRNN.</p>
      <p id="Par73">For scaffold based and property based generation tasks, the conditonal graph generator is trained using the same setting as unconditional model. For the generation of GSK-3<inline-formula id="IEq202"><alternatives><tex-math id="M381">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M382"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq202.gif"/></alternatives></inline-formula> and JNK3 inhibitors, the model is first trained using the full dataset, and the fine tuned on the subset that is predicted to be active against GSK-3<inline-formula id="IEq203"><alternatives><tex-math id="M383">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M384"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq203.gif"/></alternatives></inline-formula> or JNK3. The fine-tuning uses a learning rate of 0.0001 and a decay rate of 0.002 for every 100 iterations. The fine-tuning lasts for 10 epochs, and takes 1h to finish.</p>
      <p id="Par74">In theory, the hyperparameters for the models mentioned above, including the training condition (batch size, learning rate, decay rate, <inline-formula id="IEq204"><alternatives><tex-math id="M385">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _1$$\end{document}</tex-math><mml:math id="M386"><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq204.gif"/></alternatives></inline-formula>, <inline-formula id="IEq205"><alternatives><tex-math id="M387">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _2$$\end{document}</tex-math><mml:math id="M388"><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq205.gif"/></alternatives></inline-formula>), model architectures(the number of convolutional layers, the hidden size in each layer) as well as <inline-formula id="IEq206"><alternatives><tex-math id="M389">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M390"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq206.gif"/></alternatives></inline-formula>, should be optimized to achieve the best performance. However, due to the computational cost of both MolMP and MolRNN, we are unable to systematically optimize the hyperparameters. A througout discussion is only given for <inline-formula id="IEq207"><alternatives><tex-math id="M391">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M392"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq207.gif"/></alternatives></inline-formula>, which determines the degree of randomness of <inline-formula id="IEq208"><alternatives><tex-math id="M393">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q_\alpha$$\end{document}</tex-math><mml:math id="M394"><mml:msub><mml:mi>q</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq208.gif"/></alternatives></inline-formula>. No optimization is performed on model architecture except fitting it into the memory.</p>
    </sec>
    <sec id="Sec16">
      <title>Comparison with SMILES based methods</title>
      <p id="Par75">The proposed graph-based model is compared with several SMILES based models. Two type of methods, variational autoencoder (VAE) and language model (LM), are considered in this comparison. The implementation of SMILES VAE follows Gómez-Bombarelli et al. [<xref ref-type="bibr" rid="CR2">2</xref>]. The encoder contains three 1D convolutional layers, with 9, 9, 10 filters and 9, 9, 11 kernels each, and a fully connected layer with 435 hidden units. The model uses 196 latent variables and a decoder with three GRU layers with 488 hidden units. VAE for sequential data faces from the issue of “optimization challenge” [<xref ref-type="bibr" rid="CR47">47</xref>, <xref ref-type="bibr" rid="CR48">48</xref>]. While the original implementation uses KL-annealing to tackle this problem, we follow the method provided by Kingma et al. [<xref ref-type="bibr" rid="CR49">49</xref>] by controlling the level of free bits. This offers higher flexibility and stability compared with KL-annealing. We restrict the minimal level of free bits to 0.03 for each latent variable.</p>
      <p id="Par76">For LM, two types recurrent units are adopted. The first type uses GRU, and includes two architectures: the first architecture (SMILES GRU1) consists of three GRU layers with 512 hidden units each, and the second (SMILES GRU2), uses a wider GRU architecture with 1024 units, following the implementation by Olivecrona et al. [<xref ref-type="bibr" rid="CR13">13</xref>]. Beside GRU, we also included a LSTM based SMILES language model following Segler et al. [<xref ref-type="bibr" rid="CR12">12</xref>]. This architecture uses three LSTM layers, each with 1024 units.</p>
    </sec>
    <sec id="Sec17">
      <title>Comparison with reinforcement learning (RL) based methods</title>
      <p id="Par77">We also compared the performance of conditional generative model with three RL based method. The first method, which is proposed by Olivecrona et al., maximizes following objective during model optimization:<disp-formula id="Equ18"><label>18</label><alternatives><tex-math id="M395">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} G({\mathbf{x}}) = - \left[\log {p({\mathbf{x}})} + \sigma S({\mathbf{x}}) - \log {q_{\theta }({\mathbf{x}})}\right]^2 \end{aligned}$$\end{document}</tex-math><mml:math id="M396" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>G</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msup><mml:mfenced close="]" open="[" separators=""><mml:mo>log</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>σ</mml:mi><mml:mi>S</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mo>log</mml:mo><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2018_287_Article_Equ18.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq209"><alternatives><tex-math id="M397">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p({\mathbf{x}})$$\end{document}</tex-math><mml:math id="M398"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq209.gif"/></alternatives></inline-formula> is the <italic>Prior</italic> network pre-trained using ChEMBL dataset, and <inline-formula id="IEq210"><alternatives><tex-math id="M399">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q({\mathbf{x}})$$\end{document}</tex-math><mml:math id="M400"><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq210.gif"/></alternatives></inline-formula> is the <italic>Agent</italic> network for task-specific molecule generation. SMILES GRU2 is used as the architecture for <italic>Prior</italic> and <italic>Agent</italic>.</p>
      <p id="Par78">This method is refered to as “REINVENT” [<xref ref-type="bibr" rid="CR13">13</xref>]. We also include the following two baselines in the comparison. The first is a non-regularized RL method with the following objective:<disp-formula id="Equ19"><label>19</label><alternatives><tex-math id="M401">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} G({\mathbf{x}}) = \sigma S({\mathbf{x}}) \end{aligned}$$\end{document}</tex-math><mml:math id="M402" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>σ</mml:mi><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2018_287_Article_Equ19.gif" position="anchor"/></alternatives></disp-formula>We refer to this method as “Naive RL”. The second method includes a prior term in addition to <xref rid="Equ19" ref-type="">19</xref>:<disp-formula id="Equ20"><label>20</label><alternatives><tex-math id="M403">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} G({\mathbf{x}}) = \sigma S({\mathbf{x}}) + \log {p({\mathbf{x}})} \end{aligned}$$\end{document}</tex-math><mml:math id="M404" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>σ</mml:mi><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo>log</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2018_287_Article_Equ20.gif" position="anchor"/></alternatives></disp-formula>We refer to this method as “RL + Prior”.</p>
    </sec>
    <sec id="Sec18">
      <title>Evaluation metrics</title>
      <p id="Par79">Several metrics have been employed to evaluate the performance of generative models:</p>
      <sec id="Sec19">
        <title>Sample validity</title>
        <p id="Par80">To test whether the generative models are capable of producing chemically correct outputs, 300,000 structures are generated for each model, and subsequently evalulated by RDKit for the rate of valid outputs. We also evaluate the ability of each model to produce novel structures. This is done by accessing the rate of generated compounds that do not occure inside the training set.</p>
      </sec>
      <sec id="Sec20">
        <title><inline-formula id="IEq211"><alternatives><tex-math id="M405">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{KL}$$\end{document}</tex-math><mml:math id="M406"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">KL</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq211.gif"/></alternatives></inline-formula> and <inline-formula id="IEq212"><alternatives><tex-math id="M407">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{JS}$$\end{document}</tex-math><mml:math id="M408"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">JS</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq212.gif"/></alternatives></inline-formula> for molecular properties</title>
        <p id="Par81">A good molecule generator should correctly model the distribution of important molecular properties. Therefore, the distribution of molecular weight (MW), log-partition coefficient (LogP) and QED between the generated dataset (<inline-formula id="IEq213"><alternatives><tex-math id="M409">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_g$$\end{document}</tex-math><mml:math id="M410"><mml:msub><mml:mi>p</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq213.gif"/></alternatives></inline-formula>) and the test set (<inline-formula id="IEq214"><alternatives><tex-math id="M411">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{data}$$\end{document}</tex-math><mml:math id="M412"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="italic">data</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq214.gif"/></alternatives></inline-formula>) is compared for each method using Kullback–Leibler divergence (<inline-formula id="IEq215"><alternatives><tex-math id="M413">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{KL}$$\end{document}</tex-math><mml:math id="M414"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">KL</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq215.gif"/></alternatives></inline-formula>) and Jensen–Shannon divergence(<inline-formula id="IEq216"><alternatives><tex-math id="M415">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{JS}$$\end{document}</tex-math><mml:math id="M416"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">JS</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq216.gif"/></alternatives></inline-formula>):<disp-formula id="Equ21"><label>21</label><alternatives><tex-math id="M417">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;D_{KL}(p_g||p_{data}) = \int _{{\mathbb{R}}}{p_g(x)\log {\frac{p_g(x)}{p_{data}(x)}}dx} \end{aligned}$$\end{document}</tex-math><mml:math id="M418" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">KL</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="italic">data</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mrow><mml:msub><mml:mo>∫</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>log</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="italic">data</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2018_287_Article_Equ21.gif" position="anchor"/></alternatives></disp-formula>
<disp-formula id="Equ22"><label>22</label><alternatives><tex-math id="M419">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}D_{JS}(p_g||p_{data}) &amp;= \frac{1}{2}D_{KL}\left(p_g||\frac{p_g +p_{data}}{2}\right) \\ &amp;\quad+ \frac{1}{2}D_{KL}\left(p_{data}||\frac{p_g + p_{data}}{2}\right) \end{aligned}$$\end{document}</tex-math><mml:math id="M420" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">JS</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="italic">data</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">KL</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>p</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="italic">data</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">KL</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="italic">data</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="italic">data</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2018_287_Article_Equ22.gif" position="anchor"/></alternatives></disp-formula><inline-formula id="IEq217"><alternatives><tex-math id="M421">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{KL}$$\end{document}</tex-math><mml:math id="M422"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">KL</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq217.gif"/></alternatives></inline-formula> and <inline-formula id="IEq218"><alternatives><tex-math id="M423">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{JS}$$\end{document}</tex-math><mml:math id="M424"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">JS</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq218.gif"/></alternatives></inline-formula> are widely used in deep generated models for both training [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR50">50</xref>] and evaluation [<xref ref-type="bibr" rid="CR51">51</xref>]. Here, the two values are determined using kernel density method implemented in SciPy [<xref ref-type="bibr" rid="CR52">52</xref>]. We used a gaussian kernel with bandwidth selected based on Scott’s Rule [<xref ref-type="bibr" rid="CR53">53</xref>].</p>
      </sec>
      <sec id="Sec21">
        <title>Performance metrics (<inline-formula id="IEq219"><alternatives><tex-math id="M425">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\mathbf{c}}$$\end{document}</tex-math><mml:math id="M426"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq219.gif"/></alternatives></inline-formula>, <inline-formula id="IEq220"><alternatives><tex-math id="M427">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_{\mathbf{cc}^{\prime}}$$\end{document}</tex-math><mml:math id="M428"><mml:msub><mml:mi>K</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold">cc</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq220.gif"/></alternatives></inline-formula> and <inline-formula id="IEq221"><alternatives><tex-math id="M429">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$EOR_{\mathbf{c}}$$\end{document}</tex-math><mml:math id="M430"><mml:mrow><mml:mi>E</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq221.gif"/></alternatives></inline-formula>) for task specific molecule design</title>
        <p id="Par82">For discrete conditional codes <inline-formula id="IEq222"><alternatives><tex-math id="M431">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}$$\end{document}</tex-math><mml:math id="M432"><mml:mi mathvariant="bold">c</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq222.gif"/></alternatives></inline-formula>, let <inline-formula id="IEq223"><alternatives><tex-math id="M433">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_{\mathbf{c}}$$\end{document}</tex-math><mml:math id="M434"><mml:msub><mml:mi>M</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq223.gif"/></alternatives></inline-formula> be the set containing molecules sampled from distribution <inline-formula id="IEq224"><alternatives><tex-math id="M435">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{\varvec{\theta }} (G|{\mathbf{c}})$$\end{document}</tex-math><mml:math id="M436"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq224.gif"/></alternatives></inline-formula>. <inline-formula id="IEq225"><alternatives><tex-math id="M437">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_{\mathbf{c}}$$\end{document}</tex-math><mml:math id="M438"><mml:msub><mml:mi>M</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq225.gif"/></alternatives></inline-formula> is obtained by first sampling molecule graphs conditioned on <inline-formula id="IEq226"><alternatives><tex-math id="M439">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}$$\end{document}</tex-math><mml:math id="M440"><mml:mi mathvariant="bold">c</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq226.gif"/></alternatives></inline-formula> and then removing invalid molecules. The size of <inline-formula id="IEq227"><alternatives><tex-math id="M441">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|M_{\mathbf{c}}|$$\end{document}</tex-math><mml:math id="M442"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq227.gif"/></alternatives></inline-formula> is set to 1000. Let <inline-formula id="IEq228"><alternatives><tex-math id="M443">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{{\mathbf{c}} {\mathbf{c}}^{\prime}}$$\end{document}</tex-math><mml:math id="M444"><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="bold">c</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq228.gif"/></alternatives></inline-formula> be the set of molecules in <inline-formula id="IEq229"><alternatives><tex-math id="M445">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_{\mathbf{c}}$$\end{document}</tex-math><mml:math id="M446"><mml:msub><mml:mi>M</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq229.gif"/></alternatives></inline-formula> that satisfy the condition <inline-formula id="IEq230"><alternatives><tex-math id="M447">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}^{\prime}$$\end{document}</tex-math><mml:math id="M448"><mml:msup><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq230.gif"/></alternatives></inline-formula> (<inline-formula id="IEq231"><alternatives><tex-math id="M449">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}^{\prime}$$\end{document}</tex-math><mml:math id="M450"><mml:msup><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq231.gif"/></alternatives></inline-formula> may be different from <inline-formula id="IEq232"><alternatives><tex-math id="M451">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}$$\end{document}</tex-math><mml:math id="M452"><mml:mi mathvariant="bold">c</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq232.gif"/></alternatives></inline-formula>). The ratio <inline-formula id="IEq233"><alternatives><tex-math id="M453">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_{{\mathbf{c}} {\mathbf{c}}^{\prime}}$$\end{document}</tex-math><mml:math id="M454"><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="bold">c</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq233.gif"/></alternatives></inline-formula> is defined as:<disp-formula id="Equ23"><label>23</label><alternatives><tex-math id="M455">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} K_{{\mathbf{c}} {\mathbf{c}}^{\prime}} = \frac{|N_{{\mathbf{c}} {\mathbf{c}}^{\prime}}|}{|M_{\mathbf{c}}|} \end{aligned}$$\end{document}</tex-math><mml:math id="M456" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="bold">c</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="bold">c</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2018_287_Article_Equ23.gif" position="anchor"/></alternatives></disp-formula>The matrix <inline-formula id="IEq234"><alternatives><tex-math id="M457">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_{{\mathbf{c}} {\mathbf{c}}^{\prime}}$$\end{document}</tex-math><mml:math id="M458"><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="bold">c</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq234.gif"/></alternatives></inline-formula> can be used to evaluate the ability of the model to control the output based on conditional code <inline-formula id="IEq235"><alternatives><tex-math id="M459">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}$$\end{document}</tex-math><mml:math id="M460"><mml:mi mathvariant="bold">c</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq235.gif"/></alternatives></inline-formula>. When <inline-formula id="IEq236"><alternatives><tex-math id="M461">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}={\mathbf{c}}^{\prime}$$\end{document}</tex-math><mml:math id="M462"><mml:mrow><mml:mi mathvariant="bold">c</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq236.gif"/></alternatives></inline-formula>, this value gives the rate of correctly generated outputs, denoted by <inline-formula id="IEq237"><alternatives><tex-math id="M463">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\mathbf{c}}$$\end{document}</tex-math><mml:math id="M464"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq237.gif"/></alternatives></inline-formula>. High quality conditional models should have a high value of <inline-formula id="IEq238"><alternatives><tex-math id="M465">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\mathbf{c}}$$\end{document}</tex-math><mml:math id="M466"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq238.gif"/></alternatives></inline-formula> and low values of <inline-formula id="IEq239"><alternatives><tex-math id="M467">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\rm{K}}_{{\mathbf{cc}}^\prime }}$$\end{document}</tex-math><mml:math id="M468"><mml:msub><mml:mi mathvariant="normal">K</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold">cc</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq239.gif"/></alternatives></inline-formula> for <inline-formula id="IEq240"><alternatives><tex-math id="M469">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}} \ne {\mathbf{c}}^{\prime}$$\end{document}</tex-math><mml:math id="M470"><mml:mrow><mml:mi mathvariant="bold">c</mml:mi><mml:mo>≠</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq240.gif"/></alternatives></inline-formula>. In paractice, we find that the value of <inline-formula id="IEq241"><alternatives><tex-math id="M471">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_{{\mathbf{c}} {\mathbf{c}}^{\prime}}$$\end{document}</tex-math><mml:math id="M472"><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="bold">c</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq241.gif"/></alternatives></inline-formula> for scaffold and property based generation is significantly samller than <inline-formula id="IEq242"><alternatives><tex-math id="M473">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\mathbf{c}}$$\end{document}</tex-math><mml:math id="M474"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq242.gif"/></alternatives></inline-formula> and have relatively low influence on the model’s performance. Therefore, the result of <inline-formula id="IEq243"><alternatives><tex-math id="M475">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_{{\mathbf{c}} {\mathbf{c}}^{\prime}}$$\end{document}</tex-math><mml:math id="M476"><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="bold">c</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq243.gif"/></alternatives></inline-formula> is omitted for scaffold and property based task, and is only reported for the task of kinase inhibitor design.</p>
        <p id="Par83">Let <inline-formula id="IEq244"><alternatives><tex-math id="M477">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\mathbf{c}}^0$$\end{document}</tex-math><mml:math id="M478"><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq244.gif"/></alternatives></inline-formula> be the rate of molecules in the training data that satisfy condition <inline-formula id="IEq245"><alternatives><tex-math id="M479">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}$$\end{document}</tex-math><mml:math id="M480"><mml:mi mathvariant="bold">c</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq245.gif"/></alternatives></inline-formula>. The enrichment over random <inline-formula id="IEq246"><alternatives><tex-math id="M481">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$EOR_{\mathbf{c}}$$\end{document}</tex-math><mml:math id="M482"><mml:mrow><mml:mi>E</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq246.gif"/></alternatives></inline-formula> is defined as:<disp-formula id="Equ24"><label>24</label><alternatives><tex-math id="M483">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} EOR_{\mathbf{c}} = \frac{R_{\mathbf{c}}}{R_{\mathbf{c}}^0} \end{aligned}$$\end{document}</tex-math><mml:math id="M484" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>E</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2018_287_Article_Equ24.gif" position="anchor"/></alternatives></disp-formula>The definition is similar to that used in previous work [<xref ref-type="bibr" rid="CR12">12</xref>], except that in their implementation <inline-formula id="IEq247"><alternatives><tex-math id="M485">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\mathbf{c}}^0$$\end{document}</tex-math><mml:math id="M486"><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq247.gif"/></alternatives></inline-formula> is calculated using the generated samples from the unconditioned model <inline-formula id="IEq248"><alternatives><tex-math id="M487">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{\varvec{\theta }} (G)$$\end{document}</tex-math><mml:math id="M488"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq248.gif"/></alternatives></inline-formula>. For continuous codes, a subset <italic>C</italic> of the conditional code space is used to describe the generation requirements. <inline-formula id="IEq249"><alternatives><tex-math id="M489">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_C$$\end{document}</tex-math><mml:math id="M490"><mml:msub><mml:mi>M</mml:mi><mml:mi>C</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq249.gif"/></alternatives></inline-formula> is sampled from <inline-formula id="IEq250"><alternatives><tex-math id="M491">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{\varvec{\theta }} (G|{\mathbf{c}}\in C)$$\end{document}</tex-math><mml:math id="M492"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">c</mml:mi><mml:mo>∈</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq250.gif"/></alternatives></inline-formula>, and values for <inline-formula id="IEq251"><alternatives><tex-math id="M493">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_{CC^{\prime}}$$\end{document}</tex-math><mml:math id="M494"><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:msup><mml:mi>C</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq251.gif"/></alternatives></inline-formula>, <inline-formula id="IEq252"><alternatives><tex-math id="M495">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_C$$\end{document}</tex-math><mml:math id="M496"><mml:msub><mml:mi>R</mml:mi><mml:mi>C</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq252.gif"/></alternatives></inline-formula> and <inline-formula id="IEq253"><alternatives><tex-math id="M497">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$EOR_C$$\end{document}</tex-math><mml:math id="M498"><mml:mrow><mml:mi>E</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mi>C</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq253.gif"/></alternatives></inline-formula> can be calculated in a similar manner.</p>
      </sec>
      <sec id="Sec22">
        <title>Rate of reproduced active compounds</title>
        <p id="Par84">For target based generation tasks, the rate of reproduced molecules is also reported following previous works [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR13">13</xref>]. Take JNK3 as an example. During the evaluation, two sets of outputs are generated using two conditions: JNK3(+), GSK-3<inline-formula id="IEq254"><alternatives><tex-math id="M499">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M500"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq254.gif"/></alternatives></inline-formula> (−) and JNK3(+), GSK-3<inline-formula id="IEq255"><alternatives><tex-math id="M501">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M502"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq255.gif"/></alternatives></inline-formula>(+). The two set of outputs are denoted <inline-formula id="IEq256"><alternatives><tex-math id="M503">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_{{\mathbf{c}}_1}$$\end{document}</tex-math><mml:math id="M504"><mml:msub><mml:mi>M</mml:mi><mml:msub><mml:mi mathvariant="bold">c</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq256.gif"/></alternatives></inline-formula>and <inline-formula id="IEq257"><alternatives><tex-math id="M505">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_{{\mathbf{c}}_2}$$\end{document}</tex-math><mml:math id="M506"><mml:msub><mml:mi>M</mml:mi><mml:msub><mml:mi mathvariant="bold">c</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq257.gif"/></alternatives></inline-formula>respectively. Here, the size of <inline-formula id="IEq258"><alternatives><tex-math id="M507">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|M_{{\mathbf{c}}_1}|$$\end{document}</tex-math><mml:math id="M508"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:msub><mml:mi mathvariant="bold">c</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq258.gif"/></alternatives></inline-formula> and <inline-formula id="IEq259"><alternatives><tex-math id="M509">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|M_{{\mathbf{c}}_2}|$$\end{document}</tex-math><mml:math id="M510"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:msub><mml:mi mathvariant="bold">c</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq259.gif"/></alternatives></inline-formula> are both set to 50,000. Let <italic>T</italic> be the set containing the active molecules within the test set of JNK3. The rate of reproduced molecules (<italic>reprod</italic>) is calculated as:<disp-formula id="Equ25"><label>25</label><alternatives><tex-math id="M511">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} reprod = \frac{|(M_{{\mathbf{c}}_1} \cup M_{{\mathbf{c}}_2})\cap T|}{|T|} \end{aligned}$$\end{document}</tex-math><mml:math id="M512" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:msub><mml:mi mathvariant="bold">c</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo>∪</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:msub><mml:mi mathvariant="bold">c</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>∩</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2018_287_Article_Equ25.gif" position="anchor"/></alternatives></disp-formula>For GSK-3<inline-formula id="IEq260"><alternatives><tex-math id="M513">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M514"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq260.gif"/></alternatives></inline-formula>, the calculation can be done in a similar manner.</p>
      </sec>
      <sec id="Sec23">
        <title>Sample diversity</title>
        <p id="Par85">For a good objective based molecule generator, the outputs are not only required to satisfy the given condition <inline-formula id="IEq261"><alternatives><tex-math id="M515">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}$$\end{document}</tex-math><mml:math id="M516"><mml:mi mathvariant="bold">c</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq261.gif"/></alternatives></inline-formula>, but also required to be structurally diverse. Benhenda [<xref ref-type="bibr" rid="CR54">54</xref>] have suggested that the diversity of the model outputs should be consistent with the natural diversity of molecules satisfying the <inline-formula id="IEq262"><alternatives><tex-math id="M517">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}$$\end{document}</tex-math><mml:math id="M518"><mml:mi mathvariant="bold">c</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq262.gif"/></alternatives></inline-formula>. Also, Benhenda proposed to use the following statistics to evaluate the structural diversity of a given set of compounds:<disp-formula id="Equ26"><label>26</label><alternatives><tex-math id="M519">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} I(M) = \frac{1}{|M|^2}\sum _{(x, y)\in M\times M}T_d(x, y) \end{aligned}$$\end{document}</tex-math><mml:math id="M520" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>I</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mi>M</mml:mi><mml:mo>×</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>T</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2018_287_Article_Equ26.gif" position="anchor"/></alternatives></disp-formula>where <italic>M</italic> is the set of sampled molecules, and <inline-formula id="IEq263"><alternatives><tex-math id="M521">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_d(x, y)$$\end{document}</tex-math><mml:math id="M522"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq263.gif"/></alternatives></inline-formula> is the Tanimoto-distance between the two molecules <italic>x</italic> and <italic>y</italic>. <inline-formula id="IEq264"><alternatives><tex-math id="M523">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_d(x, y)$$\end{document}</tex-math><mml:math id="M524"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq264.gif"/></alternatives></inline-formula> is defined using the Tanimoto-similarity <inline-formula id="IEq265"><alternatives><tex-math id="M525">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_s$$\end{document}</tex-math><mml:math id="M526"><mml:msub><mml:mi>T</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq265.gif"/></alternatives></inline-formula>: <inline-formula id="IEq266"><alternatives><tex-math id="M527">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_d(x, y) = 1 - T_s(x, y)$$\end{document}</tex-math><mml:math id="M528"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq266.gif"/></alternatives></inline-formula>. This metric is called the internal diversity of the molecule set M.</p>
        <p id="Par86">For each condition <inline-formula id="IEq267"><alternatives><tex-math id="M529">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}$$\end{document}</tex-math><mml:math id="M530"><mml:mi mathvariant="bold">c</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq267.gif"/></alternatives></inline-formula>, the natural diversity <inline-formula id="IEq268"><alternatives><tex-math id="M531">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{\mathbf{c}}^0$$\end{document}</tex-math><mml:math id="M532"><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq268.gif"/></alternatives></inline-formula> is first calculated using molecules in ChEMBL. The diversity of conditional outputs <inline-formula id="IEq269"><alternatives><tex-math id="M533">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{\mathbf{c}}$$\end{document}</tex-math><mml:math id="M534"><mml:msub><mml:mi>I</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq269.gif"/></alternatives></inline-formula> is then calculated for each model. Note that when calculating <inline-formula id="IEq270"><alternatives><tex-math id="M535">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{\mathbf{c}}^0$$\end{document}</tex-math><mml:math id="M536"><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq270.gif"/></alternatives></inline-formula> and <inline-formula id="IEq271"><alternatives><tex-math id="M537">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{\mathbf{c}}$$\end{document}</tex-math><mml:math id="M538"><mml:msub><mml:mi>I</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq271.gif"/></alternatives></inline-formula>, we only include molecules that satisfy the condition <inline-formula id="IEq272"><alternatives><tex-math id="M539">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}$$\end{document}</tex-math><mml:math id="M540"><mml:mi mathvariant="bold">c</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq272.gif"/></alternatives></inline-formula>. Finally, the value <inline-formula id="IEq273"><alternatives><tex-math id="M541">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|I_{\mathbf{c}}-I_{\mathbf{c}}^0|$$\end{document}</tex-math><mml:math id="M542"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq273.gif"/></alternatives></inline-formula> is compared among different models for their ability to reconstruct the natural compound diversity.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec24">
    <title>Results and discussion</title>
    <sec id="Sec25">
      <title>Model performance and sample quality</title>
      <p id="Par87">Several randomly generated samples by MolRNN are grouped by molecular weight and shown in Fig. <xref rid="Fig8" ref-type="fig">8</xref>a–c.<fig id="Fig8"><label>Fig. 8</label><caption><p>A visualized demonstration of model outputs. <bold>a</bold>–<bold>c</bold>. Output samples by MolRNN. Results are grouped by molecular weight (<bold>a</bold> MW &lt; 300, <bold>b</bold> 300 <inline-formula id="IEq15"><alternatives><tex-math id="M543">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\le$$\end{document}</tex-math><mml:math id="M544"><mml:mo>≤</mml:mo></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq15.gif"/></alternatives></inline-formula> MW &lt; 500, <bold>c</bold> MW <inline-formula id="IEq16"><alternatives><tex-math id="M545">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ge$$\end{document}</tex-math><mml:math id="M546"><mml:mo>≥</mml:mo></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq16.gif"/></alternatives></inline-formula> 500); <bold>d</bold>, <bold>e</bold> Common mistakes made by SMILES based model and graph based model respectively; <bold>f</bold> Examples of broken aromaticity occurred during graph generation</p></caption><graphic xlink:href="13321_2018_287_Fig8_HTML" id="MO9"/></fig>
The qauntitative comparison between SMILES based and graph based models (MolMP and MolRNN) has been performed, and the results are summarized in Tables <xref rid="Tab1" ref-type="table">1</xref> and <xref rid="Tab2" ref-type="table">2</xref>. We first analysed the model performance in terms of the rate of valid outputs and the rate of valid and novel outputs. It can be seen from the results that both MolRNN and MolMP outperform all SMILES based methods. It is also noted that changing <inline-formula id="IEq274"><alternatives><tex-math id="M547">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M548"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq274.gif"/></alternatives></inline-formula> from 1.0 to 0.8 can significantly increase the rate of valid outputs for both MolMP and MolRNN. Further decreasing <inline-formula id="IEq275"><alternatives><tex-math id="M549">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M550"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq275.gif"/></alternatives></inline-formula> produces only marginal effect. The high validity of output structures by graph-based model is not surprising as the generation of SMILES poses much stricter rules to the output compared with the generation of molecular graphs.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Comparison between SMILES based and graph-based generators in output validity</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Model</th><th align="left">% valid</th><th align="left">% novel</th><th align="left">% valid and novel</th></tr></thead><tbody><tr><td align="left">SMILES VAE</td><td char="±" align="char">0.804 ± 0.016</td><td char="±" align="char">0.986 ± 0.000</td><td char="±" align="char">0.793 ± 0.016</td></tr><tr><td align="left">SMILES GRU1</td><td char="±" align="char">0.886 ± 0.002</td><td char="±" align="char">0.984 ± 0.000</td><td char="±" align="char">0.872 ± 0.002</td></tr><tr><td align="left">SMILES GRU2</td><td char="±" align="char">0.932 ± 0.002</td><td char="±" align="char">0.965 ± 0.001</td><td char="±" align="char">0.899 ± 0.002</td></tr><tr><td align="left">SMILES LSTM</td><td char="±" align="char">0.935 ± 0.006</td><td char="±" align="char">0.975 ± 0.001</td><td char="±" align="char">0.912 ± 0.006</td></tr><tr><td align="left">MolMP (<inline-formula id="IEq292"><alternatives><tex-math id="M551">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha =1.0$$\end{document}</tex-math><mml:math id="M552"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>1.0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq292.gif"/></alternatives></inline-formula>)</td><td char="±" align="char">0.952 ± 0.002</td><td char="±" align="char">0.98 ± 0.001</td><td char="±" align="char">0.933 ± 0.001</td></tr><tr><td align="left">MolMP (<inline-formula id="IEq296"><alternatives><tex-math id="M553">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha =0.8$$\end{document}</tex-math><mml:math id="M554"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq296.gif"/></alternatives></inline-formula>)</td><td char="±" align="char">0.962 ± 0.002</td><td char="±" align="char">0.984 ± 0.001</td><td char="±" align="char">0.946 ± 0.001</td></tr><tr><td align="left">MolMP (<inline-formula id="IEq300"><alternatives><tex-math id="M555">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha =0.6$$\end{document}</tex-math><mml:math id="M556"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.6</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq300.gif"/></alternatives></inline-formula>)</td><td char="±" align="char">0.963 ± 0.001</td><td char="±" align="char"><italic>0.988 ± 0.001**</italic></td><td char="±" align="char">0.951 ± 0.001</td></tr><tr><td align="left">MolRNN (<inline-formula id="IEq304"><alternatives><tex-math id="M557">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha =1.0$$\end{document}</tex-math><mml:math id="M558"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>1.0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq304.gif"/></alternatives></inline-formula>)</td><td char="±" align="char">0.967 ± 0.001</td><td char="±" align="char">0.959 ± 0.000</td><td char="±" align="char">0.928 ± 0.001</td></tr><tr><td align="left">MolRNN (<inline-formula id="IEq308"><alternatives><tex-math id="M559">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha =0.8$$\end{document}</tex-math><mml:math id="M560"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq308.gif"/></alternatives></inline-formula>)</td><td char="±" align="char"><italic>0.970 ± 0.001</italic></td><td char="±" align="char">0.976 ± 0.001</td><td char="±" align="char">0.947 ± 0.001</td></tr><tr><td align="left">MolRNN (<inline-formula id="IEq312"><alternatives><tex-math id="M561">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha =0.6$$\end{document}</tex-math><mml:math id="M562"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.6</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq312.gif"/></alternatives></inline-formula>)</td><td char="±" align="char"><italic>0.970 ± 0.001</italic></td><td char="±" align="char">0.985 ± 0.000</td><td char="±" align="char"><italic>0.955 ± 0.001***</italic></td></tr></tbody></table><table-wrap-foot><p>Results are reported as <inline-formula id="IEq276"><alternatives><tex-math id="M563">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Mean \pm SD$$\end{document}</tex-math><mml:math id="M564"><mml:mrow><mml:mi>M</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mo>±</mml:mo><mml:mi>S</mml:mi><mml:mi>D</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq276.gif"/></alternatives></inline-formula>. The best performance in each metric is highlighted in italics face. Also, for each metric, paired <italic>t</italic>-test is carried out for the difference between the best and second performing methods (*** for <inline-formula id="IEq277"><alternatives><tex-math id="M565">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\le 0.001$$\end{document}</tex-math><mml:math id="M566"><mml:mrow><mml:mi>p</mml:mi><mml:mo>≤</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq277.gif"/></alternatives></inline-formula>, ** for <inline-formula id="IEq278"><alternatives><tex-math id="M567">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\le 0.01$$\end{document}</tex-math><mml:math id="M568"><mml:mrow><mml:mi>p</mml:mi><mml:mo>≤</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq278.gif"/></alternatives></inline-formula> and * for <inline-formula id="IEq279"><alternatives><tex-math id="M569">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\le 0.05$$\end{document}</tex-math><mml:math id="M570"><mml:mrow><mml:mi>p</mml:mi><mml:mo>≤</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq279.gif"/></alternatives></inline-formula>). Multiple models are highlighted if the difference is not significant</p></table-wrap-foot></table-wrap>
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Comparison between SMILES based and graph-based generators in <inline-formula id="IEq316"><alternatives><tex-math id="M571">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{KL}$$\end{document}</tex-math><mml:math id="M572"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">KL</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq316.gif"/></alternatives></inline-formula>(<inline-formula id="IEq317"><alternatives><tex-math id="M573">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times\,10^{-3}$$\end{document}</tex-math><mml:math id="M574"><mml:mrow><mml:mo>×</mml:mo><mml:mspace width="0.166667em"/><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq317.gif"/></alternatives></inline-formula>) and <inline-formula id="IEq318"><alternatives><tex-math id="M575">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{JS}$$\end{document}</tex-math><mml:math id="M576"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">JS</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq318.gif"/></alternatives></inline-formula>(<inline-formula id="IEq319"><alternatives><tex-math id="M577">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times\,10^{-3}$$\end{document}</tex-math><mml:math id="M578"><mml:mrow><mml:mo>×</mml:mo><mml:mspace width="0.166667em"/><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq319.gif"/></alternatives></inline-formula>)</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">Model</th><th align="left" colspan="2">MW</th><th align="left" colspan="2">LogP</th><th align="left" colspan="2">QED</th></tr><tr><th align="left"><inline-formula id="IEq324"><alternatives><tex-math id="M579">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{KL}$$\end{document}</tex-math><mml:math id="M580"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">KL</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq324.gif"/></alternatives></inline-formula></th><th align="left"><inline-formula id="IEq325"><alternatives><tex-math id="M581">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{JS}$$\end{document}</tex-math><mml:math id="M582"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">JS</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq325.gif"/></alternatives></inline-formula></th><th align="left"><inline-formula id="IEq326"><alternatives><tex-math id="M583">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{KL}$$\end{document}</tex-math><mml:math id="M584"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">KL</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq326.gif"/></alternatives></inline-formula></th><th align="left"><inline-formula id="IEq327"><alternatives><tex-math id="M585">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{JS}$$\end{document}</tex-math><mml:math id="M586"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">JS</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq327.gif"/></alternatives></inline-formula></th><th align="left"><inline-formula id="IEq328"><alternatives><tex-math id="M587">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{KL}$$\end{document}</tex-math><mml:math id="M588"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">KL</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq328.gif"/></alternatives></inline-formula></th><th align="left"><inline-formula id="IEq329"><alternatives><tex-math id="M589">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{JS}$$\end{document}</tex-math><mml:math id="M590"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">JS</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq329.gif"/></alternatives></inline-formula></th></tr></thead><tbody><tr><td align="left">SMILES VAE</td><td char="±" align="char">13.5 ± 0.6</td><td char="±" align="char">3.6 ± 0.2</td><td char="±" align="char">3.9 ± 0.4</td><td char="±" align="char">0.9 ± 0.1</td><td char="±" align="char">2.6 ± 0.4</td><td char="±" align="char">0.6 ± 0.1</td></tr><tr><td align="left">SMILES GRU1</td><td char="±" align="char">8.6 ± 0.4</td><td char="±" align="char">2.3 ± 0.1</td><td char="±" align="char">3.1 ± 0.3</td><td char="±" align="char">0.7 ± 0.0</td><td char="±" align="char">1.5 ± 0.3</td><td char="±" align="char">0.3 ± 0.1</td></tr><tr><td align="left">SMILES GRU2</td><td char="±" align="char">7.8 ± 0:3</td><td char="±" align="char">2:0 ± 0.1</td><td char="±" align="char"><italic>1.4 ± 0.2</italic></td><td char="±" align="char"><italic>0.3 ± 0.0</italic></td><td char="±" align="char">2.2 ± 0.3</td><td char="±" align="char">0.5 ± 0.1</td></tr><tr><td align="left">SMILES LSTM</td><td char="±" align="char">6.5 ± 0.7</td><td char="±" align="char">1.8 ± 0.2</td><td char="±" align="char">3.4 ± 1.2</td><td char="±" align="char">0.8 ± 0.3</td><td char="±" align="char">1.9 ± 1.3</td><td char="±" align="char">0.4 ± 0.3</td></tr><tr><td align="left">MolMP (<inline-formula id="IEq354"><alternatives><tex-math id="M591">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha =1.0$$\end{document}</tex-math><mml:math id="M592"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>1.0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq354.gif"/></alternatives></inline-formula>)</td><td char="±" align="char">11.5 ± 1.3</td><td char="±" align="char">3.4 ± 0.4</td><td char="±" align="char">7.0 ± 1.8</td><td char="±" align="char">1.7 ± 0.4</td><td char="±" align="char">5.3 ± 1.2</td><td char="±" align="char">1.3 ± 0.3</td></tr><tr><td align="left">MolMP (<inline-formula id="IEq361"><alternatives><tex-math id="M593">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha =0.8$$\end{document}</tex-math><mml:math id="M594"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq361.gif"/></alternatives></inline-formula>)</td><td char="±" align="char">8.3 ± 1.6</td><td char="±" align="char">2.4 ± 0.5</td><td char="±" align="char">4.3 ± 1.2</td><td char="±" align="char">0.9 ± 0.2</td><td char="±" align="char">2.7 ± 0.8</td><td char="±" align="char">0.6 ± 0.2</td></tr><tr><td align="left">MolMP (<inline-formula id="IEq368"><alternatives><tex-math id="M595">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha =0.6$$\end{document}</tex-math><mml:math id="M596"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.6</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq368.gif"/></alternatives></inline-formula>)</td><td char="±" align="char">8.4 ± 1.0</td><td char="±" align="char">2.4 ± 0.3</td><td char="±" align="char">5.0 ± 1.3</td><td char="±" align="char">1.1 ± 0.4</td><td char="±" align="char">3.0 ± 0.9</td><td char="±" align="char">0.7 ± 0.2</td></tr><tr><td align="left">MolRNN (<inline-formula id="IEq375"><alternatives><tex-math id="M597">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha =1.0$$\end{document}</tex-math><mml:math id="M598"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>1.0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq375.gif"/></alternatives></inline-formula>)</td><td char="±" align="char">5.0 ± 0.6</td><td char="±" align="char">1.4 ± 0.2</td><td char="±" align="char">2.8 ± 0.5</td><td char="±" align="char">0.7 ± 0.1</td><td char="±" align="char">2.0 ± 0.6</td><td char="±" align="char">0.5 ± 0.1</td></tr><tr><td align="left">MolRNN (<inline-formula id="IEq382"><alternatives><tex-math id="M599">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha =0.8$$\end{document}</tex-math><mml:math id="M600"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq382.gif"/></alternatives></inline-formula>)</td><td char="±" align="char">4.1 ± 0.7</td><td char="±" align="char">1.1 ± 0.2</td><td char="±" align="char"><italic>1.6 ± 0.3</italic></td><td char="±" align="char"><italic>0.3 ± 0.1</italic></td><td char="±" align="char"><italic>1.0 ± 0.2</italic></td><td char="±" align="char"><italic>0.2 ± 0.0</italic></td></tr><tr><td align="left">MolRNN (<inline-formula id="IEq389"><alternatives><tex-math id="M601">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha =0.6$$\end{document}</tex-math><mml:math id="M602"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.6</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq389.gif"/></alternatives></inline-formula>)</td><td char="±" align="char"><italic>3.3 ± 0.2*</italic></td><td char="±" align="char"><italic>0.9 ± 0.1**</italic></td><td char="±" align="char">3.0 ± 0.4</td><td char="±" align="char">0.5 ± 0.1</td><td char="±" align="char"><italic>1.1 ± 0.4</italic></td><td char="±" align="char"><italic>0.2 ± 0.1</italic></td></tr></tbody></table><table-wrap-foot><p>Results are reported as <inline-formula id="IEq320"><alternatives><tex-math id="M603">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Mean \pm SD$$\end{document}</tex-math><mml:math id="M604"><mml:mrow><mml:mi>M</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mo>±</mml:mo><mml:mi>S</mml:mi><mml:mi>D</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq320.gif"/></alternatives></inline-formula>. The best performance in each metric is highlighted in italics face. Paired <italic>t</italic>-tests are carried out for the difference between the best and second performing methods (*** for <inline-formula id="IEq321"><alternatives><tex-math id="M605">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\le 0.001$$\end{document}</tex-math><mml:math id="M606"><mml:mrow><mml:mi>p</mml:mi><mml:mo>≤</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq321.gif"/></alternatives></inline-formula>, ** for <inline-formula id="IEq322"><alternatives><tex-math id="M607">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\le 0.01$$\end{document}</tex-math><mml:math id="M608"><mml:mrow><mml:mi>p</mml:mi><mml:mo>≤</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq322.gif"/></alternatives></inline-formula> and * for <inline-formula id="IEq323"><alternatives><tex-math id="M609">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\le 0.05$$\end{document}</tex-math><mml:math id="M610"><mml:mrow><mml:mi>p</mml:mi><mml:mo>≤</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq323.gif"/></alternatives></inline-formula>). Multiple models are highlighted if the difference is not significant</p></table-wrap-foot></table-wrap>
</p>
      <p id="Par88">Figure <xref rid="Fig8" ref-type="fig">8</xref>d, e summarize respectively the common mistakes made by SMILES-based and graph-based model during generation. Results in Fig. <xref rid="Fig8" ref-type="fig">8</xref>d show that the most common cause of invalid output for SMILES based models is grammar mistakes, such as unclosed parentheses or unpaired ring numberings. But for the graph-based model, the majority of invalid output is caused by broken aromaticity, as demonstrated in Fig. <xref rid="Fig8" ref-type="fig">8</xref>f. This is likely a result of stepwise decoding pattern of graph-based models, as the decoder can only see part of the aromatic structure during generation, while the determination of aromaticity requires the information of the entire ring. It is also observed that mistakes related to atom valance are relatively minor, meaning that those rules are easy to learn using graph convolution.</p>
      <p id="Par89">Graph-based methods also have the advantage of giving highly interpretable outputs compared with SMILES. This means that a large portion of invalid outputs can be easily corrected if necessary. For example, broken aromaticity can be restored by literately refining the number explicit hydrogens of aromatic atoms, and unclosed aromatic rings can be corrected simply by connecting the two ends using a new aromatic bond. Though possible, those corrections may introduce additional bias to the output samples depending on the implementation, thus not adopted in the subsequent tasks.</p>
      <p id="Par90">Next, we investigate the ability for the generators to learn the distribution of molecular properties, as demonstrated in Table <xref rid="Tab2" ref-type="table">2</xref>. Results have shown that MolRNN gives the best performance in <inline-formula id="IEq583"><alternatives><tex-math id="M611">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{KL}$$\end{document}</tex-math><mml:math id="M612"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">KL</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq583.gif"/></alternatives></inline-formula> and <inline-formula id="IEq584"><alternatives><tex-math id="M613">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{JS}$$\end{document}</tex-math><mml:math id="M614"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">JS</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq584.gif"/></alternatives></inline-formula> for molecular weight (MW) and QED, while SMILES GRU2 gives the best performance for LogP. For MolMP, although it is able to outperform SMILES GRU1 in the rate of valid outputs, it fails to give better performance in <inline-formula id="IEq585"><alternatives><tex-math id="M615">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{KL}$$\end{document}</tex-math><mml:math id="M616"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">KL</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq585.gif"/></alternatives></inline-formula> and <inline-formula id="IEq586"><alternatives><tex-math id="M617">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{JS}$$\end{document}</tex-math><mml:math id="M618"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">JS</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq586.gif"/></alternatives></inline-formula>. This observation suggest that the molecule level recurrent unit in MolRNN can significantly imporved the ability for the model to learn information about the data distribution.</p>
      <p id="Par91">When it comes to the influence of <inline-formula id="IEq587"><alternatives><tex-math id="M619">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M620"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq587.gif"/></alternatives></inline-formula> to <inline-formula id="IEq588"><alternatives><tex-math id="M621">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{KL}$$\end{document}</tex-math><mml:math id="M622"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">KL</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq588.gif"/></alternatives></inline-formula> and <inline-formula id="IEq589"><alternatives><tex-math id="M623">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{JS}$$\end{document}</tex-math><mml:math id="M624"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">JS</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq589.gif"/></alternatives></inline-formula>, it is found that changing <inline-formula id="IEq590"><alternatives><tex-math id="M625">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M626"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq590.gif"/></alternatives></inline-formula> from 1.0 to 0.8 can significantly improve the perforamnce of MolMP and MolRNN for all molecular properties. Further decreasing <inline-formula id="IEq591"><alternatives><tex-math id="M627">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M628"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq591.gif"/></alternatives></inline-formula> to 0.6 will have different effect for MolMP and MolRNN. For MolMP, this will hurt the overall performance of <inline-formula id="IEq592"><alternatives><tex-math id="M629">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{KL}$$\end{document}</tex-math><mml:math id="M630"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">KL</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq592.gif"/></alternatives></inline-formula> and <inline-formula id="IEq593"><alternatives><tex-math id="M631">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{JS}$$\end{document}</tex-math><mml:math id="M632"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">JS</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq593.gif"/></alternatives></inline-formula>, while for MolRNN, this will inprove the performance for molecular weight, but will significantly decrease the performance of LogP. Overall, <inline-formula id="IEq594"><alternatives><tex-math id="M633">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha =0.8$$\end{document}</tex-math><mml:math id="M634"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq594.gif"/></alternatives></inline-formula> will be a better choise for MolMP, and <inline-formula id="IEq595"><alternatives><tex-math id="M635">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha =0.6$$\end{document}</tex-math><mml:math id="M636"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.6</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq595.gif"/></alternatives></inline-formula> will be more suited for MolRNN.</p>
      <p id="Par92">Generally, MolRNN have showed significant advantages among all generative mdoels considered. In the subsequent evaluation of conditonal generative models, the best performing graph based model (MolRNN) and the best performing SMILES based model (SMILES GRU2) are implemented as conditonal models and are compared among all tasks.</p>
    </sec>
    <sec id="Sec26">
      <title>Scaffold-based generation</title>
      <p id="Par93">In the first task, conditional generative models are trained to produce molecules based on given scaffolds. To illustrate the result, scaffold <bold>1</bold>, extracted from the antihypertensive drug Candesartan (see Fig. <xref rid="Fig9" ref-type="fig">9</xref>a), is used as an example, along with several related scaffolds (scaffold <bold>2–4</bold>) derived from scaffold <bold>1</bold> (Fig. <xref rid="Fig9" ref-type="fig">9</xref>a).<fig id="Fig9"><label>Fig. 9</label><caption><p>Results of scaffold based generation. <bold>a</bold> Candesartan and the extracted scaffolds (scaffold <bold>1–4</bold>); <bold>b</bold> Output samples based on scaffold <bold>1–4</bold></p></caption><graphic xlink:href="13321_2018_287_Fig9_HTML" id="MO10"/></fig>
Conditional codes <inline-formula id="IEq596"><alternatives><tex-math id="M637">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}$$\end{document}</tex-math><mml:math id="M638"><mml:mi mathvariant="bold">c</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq596.gif"/></alternatives></inline-formula> are constructed for each type of scaffold, and output structures are produced according to the corresponding code.</p>
      <p id="Par94">Results for both the SMILES based and graph based conditional generator are given in Table <xref rid="Tab3" ref-type="table">3</xref>.<table-wrap id="Tab3"><label>Table 3</label><caption><p>Performance of graph based and SMILES based model on scaffold diversification tasks</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Condition (<inline-formula id="IEq400"><alternatives><tex-math id="M639">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}$$\end{document}</tex-math><mml:math id="M640"><mml:mi mathvariant="bold">c</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq400.gif"/></alternatives></inline-formula>)</th><th align="left"><inline-formula id="IEq401"><alternatives><tex-math id="M641">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_0$$\end{document}</tex-math><mml:math id="M642"><mml:msub><mml:mi>R</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq401.gif"/></alternatives></inline-formula></th><th align="left"><inline-formula id="IEq402"><alternatives><tex-math id="M643">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_0$$\end{document}</tex-math><mml:math id="M644"><mml:msub><mml:mi>I</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq402.gif"/></alternatives></inline-formula></th><th align="left">Model</th><th align="left">% valid</th><th align="left"><inline-formula id="IEq403"><alternatives><tex-math id="M645">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\mathbf{c}}$$\end{document}</tex-math><mml:math id="M646"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq403.gif"/></alternatives></inline-formula></th><th align="left"><inline-formula id="IEq404"><alternatives><tex-math id="M647">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$EOR_{\mathbf{c}}$$\end{document}</tex-math><mml:math id="M648"><mml:mrow><mml:mi>E</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq404.gif"/></alternatives></inline-formula></th><th align="left">Diversity (<inline-formula id="IEq405"><alternatives><tex-math id="M649">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{\mathbf{c}}$$\end{document}</tex-math><mml:math id="M650"><mml:msub><mml:mi>I</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq405.gif"/></alternatives></inline-formula>)</th></tr></thead><tbody><tr><td align="left" rowspan="2">scaffold <bold>1</bold></td><td align="left" rowspan="2"><inline-formula id="IEq406"><alternatives><tex-math id="M651">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$7.9\times 10^{-5}$$\end{document}</tex-math><mml:math id="M652"><mml:mrow><mml:mn>7.9</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq406.gif"/></alternatives></inline-formula></td><td align="left" rowspan="2">0.46</td><td align="left">Graph</td><td char="±" align="char"><italic>0.931 ± 0.008</italic></td><td char="±" align="char">0.86 ± 0.03</td><td char="/" align="char">10865</td><td char="±" align="char">0.45 ± 0.01</td></tr><tr><td align="left">SMILES</td><td char="±" align="char">0.924 ± 0.005</td><td char="±" align="char"><italic>0.87 ± 0.01</italic></td><td char="/" align="char"><italic>10976</italic></td><td char="±" align="char"><italic>0.46 ± 0.01</italic></td></tr><tr><td align="left" rowspan="2">scaffold <bold>2</bold></td><td align="left" rowspan="2"><inline-formula id="IEq413"><alternatives><tex-math id="M653">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1.1\times 10^{-4}$$\end{document}</tex-math><mml:math id="M654"><mml:mrow><mml:mn>1.1</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq413.gif"/></alternatives></inline-formula></td><td align="left" rowspan="2">0.50</td><td align="left">Graph</td><td char="±" align="char"><italic>0.900 ± 0.016</italic></td><td char="±" align="char">0.77 ± 0.04</td><td char="/" align="char">6972</td><td char="±" align="char">0.47 ± 0.02*</td></tr><tr><td align="left">SMILES</td><td char="±" align="char">0.896 ± 0:011</td><td char="±" align="char"><italic>0.84 ± 0.01*</italic></td><td char="/" align="char"><italic>7607</italic></td><td char="±" align="char"><italic>0.44 ± 0.01</italic></td></tr><tr><td align="left" rowspan="2">scaffold <bold>3</bold></td><td align="left" rowspan="2"><inline-formula id="IEq420"><alternatives><tex-math id="M655">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$7.9\times 10^{-5}$$\end{document}</tex-math><mml:math id="M656"><mml:mrow><mml:mn>7.9</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq420.gif"/></alternatives></inline-formula></td><td align="left" rowspan="2">0.56</td><td align="left">Graph</td><td char="±" align="char"><italic>0.940 ± 0.019*</italic></td><td char="±" align="char"><italic>0.56 ± 0.08**</italic></td><td char="/" align="char"><italic>7086</italic></td><td char="±" align="char"><italic>0.60 ± 0.02</italic></td></tr><tr><td align="left">SMILES</td><td char="±" align="char">0.898 ± 0.024</td><td char="±" align="char">0.37 ± 0.07</td><td char="/" align="char">4623</td><td char="±" align="char">0.59 ± 0.03</td></tr><tr><td align="left" rowspan="2">scaffold <bold>4</bold></td><td align="left" rowspan="2"><inline-formula id="IEq427"><alternatives><tex-math id="M657">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5.8\times 10^{-3}$$\end{document}</tex-math><mml:math id="M658"><mml:mrow><mml:mn>5.8</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq427.gif"/></alternatives></inline-formula></td><td align="left" rowspan="2">0.82</td><td align="left">Graph</td><td char="±" align="char"><italic>0.982 ± 0.001***</italic></td><td char="±" align="char">0.88 ± 0.01</td><td char="/" align="char">151</td><td char="±" align="char">0.815 ± 0.001</td></tr><tr><td align="left">SMILES</td><td char="±" align="char">0.969 ± 0.002</td><td char="±" align="char">0.88 ± 0.00</td><td char="/" align="char">151</td><td char="±" align="char"><italic>0.819 ± 0.00***</italic></td></tr></tbody></table><table-wrap-foot><p>Results are reported as <inline-formula id="IEq396"><alternatives><tex-math id="M659">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Mean \pm SD$$\end{document}</tex-math><mml:math id="M660"><mml:mrow><mml:mi>M</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mo>±</mml:mo><mml:mi>S</mml:mi><mml:mi>D</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq396.gif"/></alternatives></inline-formula>. The best performance in each metric is highlighted in italics face. Paired <italic>t</italic>-tests are carried out for the difference between the graph and SMILES based method (*** for <inline-formula id="IEq397"><alternatives><tex-math id="M661">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\le 0.001$$\end{document}</tex-math><mml:math id="M662"><mml:mrow><mml:mi>p</mml:mi><mml:mo>≤</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq397.gif"/></alternatives></inline-formula>, ** for <inline-formula id="IEq398"><alternatives><tex-math id="M663">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\le 0.01$$\end{document}</tex-math><mml:math id="M664"><mml:mrow><mml:mi>p</mml:mi><mml:mo>≤</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq398.gif"/></alternatives></inline-formula> and * for <inline-formula id="IEq399"><alternatives><tex-math id="M665">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\le 0.05$$\end{document}</tex-math><mml:math id="M666"><mml:mrow><mml:mi>p</mml:mi><mml:mo>≤</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq399.gif"/></alternatives></inline-formula>)</p></table-wrap-foot></table-wrap> In terms of output validity, graph based model is able to produce a higher fraction of valid outputs for scaffolds <bold>1–4</bold>, compared with SMILES based methods, which is similar to the results of unconditional models</p>
      <p id="Par95">In terms of the rate of correctly generated outputs (<inline-formula id="IEq597"><alternatives><tex-math id="M667">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\mathbf{c}}$$\end{document}</tex-math><mml:math id="M668"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq597.gif"/></alternatives></inline-formula>), although the models are unable to achieve 100% correctness, the <inline-formula id="IEq598"><alternatives><tex-math id="M669">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\mathbf{c}}$$\end{document}</tex-math><mml:math id="M670"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq598.gif"/></alternatives></inline-formula> results are significantly higher than <inline-formula id="IEq599"><alternatives><tex-math id="M671">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\mathbf{c}}^0$$\end{document}</tex-math><mml:math id="M672"><mml:msubsup><mml:mi>R</mml:mi><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq599.gif"/></alternatives></inline-formula>, offering high enrichment rate over random. Both graph based and SMILES based model are able to achieve <inline-formula id="IEq600"><alternatives><tex-math id="M673">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$EOR_{\mathbf{c}} &gt; 1000$$\end{document}</tex-math><mml:math id="M674"><mml:mrow><mml:mi>E</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq600.gif"/></alternatives></inline-formula> for scaffold <bold>1–3</bold> as well as <inline-formula id="IEq601"><alternatives><tex-math id="M675">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$EOR_{\mathbf{c}} &gt; 100$$\end{document}</tex-math><mml:math id="M676"><mml:mrow><mml:mi>E</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq601.gif"/></alternatives></inline-formula> for scaffold <bold>4</bold>, showing promising ability for the model to produce enriched output according to the given scaffold query. By comparing the result of <inline-formula id="IEq602"><alternatives><tex-math id="M677">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\mathbf{c}}$$\end{document}</tex-math><mml:math id="M678"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq602.gif"/></alternatives></inline-formula> between the two type of architectures, it is found that graph based model have a higher performance for scaffold <bold>3</bold>, while SMILES based method have a higher performance for scaffold <bold>2</bold>. The two model have similar performance for scaffold <bold>1</bold> and scaffold <bold>4</bold>.</p>
      <p id="Par96">The structural diversity of the output samples is also evaluated for each model. Both graph based and SMILES based methods have resulted in a slightly lower output diversity <inline-formula id="IEq603"><alternatives><tex-math id="M679">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{\mathbf{c}}$$\end{document}</tex-math><mml:math id="M680"><mml:msub><mml:mi>I</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq603.gif"/></alternatives></inline-formula> compared with the natural diversity <inline-formula id="IEq604"><alternatives><tex-math id="M681">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{\mathbf{c}}^0$$\end{document}</tex-math><mml:math id="M682"><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq604.gif"/></alternatives></inline-formula>. For scaffold <bold>2</bold>, the graph based method have better performance compared with SMILES based method, while for scaffold <bold>4</bold>, the SMILES based methods yields better result. For scaffold <bold>1</bold> and <bold>3</bold>, the difference is not significant between graph based and SMILES based method.</p>
      <p id="Par97">A comparison between conditional generative model and RL based approach is performed, using scaffold 4 as example. We set <inline-formula id="IEq605"><alternatives><tex-math id="M683">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma =20$$\end{document}</tex-math><mml:math id="M684"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq605.gif"/></alternatives></inline-formula>, and formulate the score function <inline-formula id="IEq606"><alternatives><tex-math id="M685">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_{\mathbf{c}}({\mathbf{x}})$$\end{document}</tex-math><mml:math id="M686"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq606.gif"/></alternatives></inline-formula> as follows:<disp-formula id="Equ27"><label>27</label><alternatives><tex-math id="M687">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} S_{\mathbf{c}}({\mathbf{x}}) = {\left\{ \begin{array}{ll} 1, &amp;\quad {} \text{if } {\mathbf{x}}\,\text{is\,valid\,and\,satisfies\,} {\mathbf{c}}\,\\ 0, &amp;\quad \text{otherwise} \end{array}\right. } \end{aligned}$$\end{document}</tex-math><mml:math id="M688" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mrow/><mml:mtext>if</mml:mtext><mml:mspace width="0.333333em"/><mml:mi mathvariant="bold">x</mml:mi><mml:mspace width="0.166667em"/><mml:mtext>is\,valid\,and\,satisfies\,</mml:mtext><mml:mi mathvariant="bold">c</mml:mi><mml:mspace width="0.166667em"/></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mtext>otherwise</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2018_287_Article_Equ27.gif" position="anchor"/></alternatives></disp-formula>The result is summarized in Table <xref rid="Tab4" ref-type="table">4</xref>.<table-wrap id="Tab4"><label>Table 4</label><caption><p>The comparison between condtional generative models RL based models in the task of generating molecules containing scaffold <bold>4</bold></p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Model</th><th align="left">% valid</th><th align="left"><inline-formula id="IEq435"><alternatives><tex-math id="M689">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\mathbf{c}}$$\end{document}</tex-math><mml:math id="M690"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq435.gif"/></alternatives></inline-formula></th><th align="left"><inline-formula id="IEq436"><alternatives><tex-math id="M691">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$EOR_{\mathbf{c}}$$\end{document}</tex-math><mml:math id="M692"><mml:mrow><mml:mi>E</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq436.gif"/></alternatives></inline-formula></th><th align="left">Diversity (<inline-formula id="IEq437"><alternatives><tex-math id="M693">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{\mathbf{c}}$$\end{document}</tex-math><mml:math id="M694"><mml:msub><mml:mi>I</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq437.gif"/></alternatives></inline-formula>)</th></tr></thead><tbody><tr><td align="left">REINVENT</td><td char="±" align="char">0.998 ± 0.000</td><td char="±" align="char"><italic>1.000 ± 0.000</italic></td><td char="." align="char">172</td><td char="±" align="char">0.75 ± 0.01</td></tr><tr><td align="left">Naive RL</td><td char="±" align="char">0.984 ± 0.015</td><td char="±" align="char">0.999 ± 0.001</td><td char="." align="char">172</td><td char="±" align="char">0.48 ± 0.08</td></tr><tr><td align="left">RL + Prior</td><td char="±" align="char"><italic>0.999 ± 0.001</italic></td><td char="±" align="char"><italic>1.000 ± 0.000</italic></td><td char="." align="char">172</td><td char="±" align="char">0.55 ± 0.09</td></tr><tr><td align="left">Graph</td><td char="±" align="char">0.982 ± 0.001</td><td char="±" align="char">0.88 ± 0.01</td><td char="." align="char">151</td><td char="±" align="char">0.815 ± 0.001</td></tr><tr><td align="left">SMILES</td><td char="±" align="char">0.969 ± 0.002</td><td char="±" align="char">0.88 ± 0.00</td><td char="." align="char">151</td><td char="±" align="char"><italic>0.819 ± 0.000</italic></td></tr></tbody></table><table-wrap-foot><p>Results are reported as <inline-formula id="IEq434"><alternatives><tex-math id="M695">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Mean \pm SD$$\end{document}</tex-math><mml:math id="M696"><mml:mrow><mml:mi>M</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mo>±</mml:mo><mml:mi>S</mml:mi><mml:mi>D</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq434.gif"/></alternatives></inline-formula></p><p>The best performance in each metric is highlighted in italics face</p></table-wrap-foot></table-wrap> It is easily observed that all RL based approaches, including Naive RL, RL + Prior and REINVENT, are capable of achieving near perfect result on <inline-formula id="IEq607"><alternatives><tex-math id="M697">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\mathbf{c}}$$\end{document}</tex-math><mml:math id="M698"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq607.gif"/></alternatives></inline-formula>. However, in terms of output diversity, the RL based methods yields worse performance compared with conditional generative models. Among them, Naive RL result in the lowest output diversity of 0.468, followed by the RL + Prior, whose output diversity is 0.55. REINVENT results in a much higher output diversity of 0.750, but is still lower than that of conditional generative models.</p>
      <p id="Par98">The results above shows that conditional generators and RL based methods have opposite performance on <inline-formula id="IEq608"><alternatives><tex-math id="M699">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\mathbf{c}}$$\end{document}</tex-math><mml:math id="M700"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq608.gif"/></alternatives></inline-formula> and <inline-formula id="IEq609"><alternatives><tex-math id="M701">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{\mathbf{c}}$$\end{document}</tex-math><mml:math id="M702"><mml:msub><mml:mi>I</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq609.gif"/></alternatives></inline-formula>. This is mainly caused by the fact that the two methods actually operate on different objectives. The former, which is trained under maximum likelihood estimation (MLE), optimizes <inline-formula id="IEq610"><alternatives><tex-math id="M703">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{KL}(p({\mathbf{x}}|{\mathbf{c}})||q_{\theta })$$\end{document}</tex-math><mml:math id="M704"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">KL</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq610.gif"/></alternatives></inline-formula> (the proof is given in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary Text 5). During training, conditional generative model are encouraged to cover all modes in the data distribution, but are not punish for malicious modes, and therefore result in lower <inline-formula id="IEq611"><alternatives><tex-math id="M705">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\mathbf{c}}$$\end{document}</tex-math><mml:math id="M706"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq611.gif"/></alternatives></inline-formula>.</p>
      <p id="Par99">The RL based approach, however, optimizes a completely different objective. It can be proved that maximizing Eq. <xref rid="Equ18" ref-type="">18</xref> is equivalent to minimizing the reviersed KL divergence <inline-formula id="IEq612"><alternatives><tex-math id="M707">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{KL}(q_{\theta }||p({\mathbf{x}}|{\mathbf{c}}))$$\end{document}</tex-math><mml:math id="M708"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">KL</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo></mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq612.gif"/></alternatives></inline-formula>. In fact, if the score <inline-formula id="IEq613"><alternatives><tex-math id="M709">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma S({\mathbf{x}})$$\end{document}</tex-math><mml:math id="M710"><mml:mrow><mml:mi>σ</mml:mi><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq613.gif"/></alternatives></inline-formula> is formulated as <inline-formula id="IEq614"><alternatives><tex-math id="M711">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\log {p({\mathbf{c}}|{\mathbf{x}})}$$\end{document}</tex-math><mml:math id="M712"><mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">c</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq614.gif"/></alternatives></inline-formula>, which is the log-likelihood for the molecule <inline-formula id="IEq615"><alternatives><tex-math id="M713">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{x}}$$\end{document}</tex-math><mml:math id="M714"><mml:mi mathvariant="bold">x</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq615.gif"/></alternatives></inline-formula> to satisfy the requirement <inline-formula id="IEq616"><alternatives><tex-math id="M715">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}$$\end{document}</tex-math><mml:math id="M716"><mml:mi mathvariant="bold">c</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq616.gif"/></alternatives></inline-formula>, we can obtain the following relationship between <inline-formula id="IEq617"><alternatives><tex-math id="M717">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G({\mathbf{x}})$$\end{document}</tex-math><mml:math id="M718"><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq617.gif"/></alternatives></inline-formula> ans <inline-formula id="IEq618"><alternatives><tex-math id="M719">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{KL}$$\end{document}</tex-math><mml:math id="M720"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">KL</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq618.gif"/></alternatives></inline-formula>:<disp-formula id="Equ28"><label>28</label><alternatives><tex-math id="M721">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \nabla _{\varvec{\theta }} D_{KL}(q_{\varvec{\theta }}||p({\mathbf{x}}|{\mathbf{c}})) = - {\mathbb{E}}_{{\mathbf{x}} \sim q_{\varvec{\theta }}}[\nabla _{\varvec{\theta }} G({\mathbf{x}})] \end{aligned}$$\end{document}</tex-math><mml:math id="M722" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="normal">∇</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="italic">KL</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo></mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>∼</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi mathvariant="normal">∇</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13321_2018_287_Article_Equ28.gif" position="anchor"/></alternatives></disp-formula>The derivation is given in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary Text 6. This objective will force the model to comply with the given condition <inline-formula id="IEq619"><alternatives><tex-math id="M723">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}$$\end{document}</tex-math><mml:math id="M724"><mml:mi mathvariant="bold">c</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq619.gif"/></alternatives></inline-formula>, but may result in potential mode collapse, and therefore lower output diversity. In short, conditonal generative model and RL based methods each emphasizes different aspect of the molecule distribution, and future research may explore the possibility to combine those methods.</p>
      <p id="Par100">Several generated samples by graph based model are given for each scaffold in Fig. <xref rid="Fig9" ref-type="fig">9</xref>b. Recall that the outputs given scaffold <italic>s</italic> should contain two type of molecules: (1) molecules with <italic>s</italic> as its Bemis–Murcko scaffold and (2) molecule whose Bemis–Murcko scaffold contains <italic>s</italic> but does not reside inside <italic>S</italic>. Both types are observed for scaffold <bold>1–4</bold> as shown in Fig. <xref rid="Fig9" ref-type="fig">9</xref>b. By further investigating the generated samples, it is observed that the model seems to have learnt about the side chains characteristics each scaffold. For example, samples generated from scaffold <bold>1–3</bold> usually have their substitutions occur at restricted positions, and frequently contains a long aliphatic side chain. Interestingly, this actually reflects the structural activity relationship (SAR) for angiotensin II (Ang II) receptor antagonists [<xref ref-type="bibr" rid="CR55">55</xref>]. In fact, scaffold <bold>1–3</bold> have long been treated as a privileged structure against Ang II receptors [<xref ref-type="bibr" rid="CR28">28</xref>], and as a result, molecules with scaffold <bold>1–3</bold> are largely biased to those who matches the SAR rules for the target. When trained with the biased dataset, the model can memorize the underlying structural activity relationship as a byproduct of scaffold based learning. This characteristic is beneficial for the generation of libraries containing specified privileged structures.</p>
    </sec>
    <sec id="Sec27">
      <title>Generation based on drug-likeness and synthetic accessibility</title>
      <p id="Par101">In this task, the generative model is used to produce molecules according to the requirement on drug-likeness and synthetic accessibility. The conditional code is specified as <inline-formula id="IEq620"><alternatives><tex-math id="M725">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}=(QED,SA)$$\end{document}</tex-math><mml:math id="M726"><mml:mrow><mml:mi mathvariant="bold">c</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>Q</mml:mi><mml:mi>E</mml:mi><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq620.gif"/></alternatives></inline-formula>. In the first experiments, the models are required to generate molecules based on the following requirements expressed as subsets of conditional code space: <inline-formula id="IEq621"><alternatives><tex-math id="M727">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_1=(0.84,1)\times (0,1.9)$$\end{document}</tex-math><mml:math id="M728"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0.84</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1.9</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq621.gif"/></alternatives></inline-formula>, <inline-formula id="IEq622"><alternatives><tex-math id="M729">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_2=(0,0.27)\times (0,2.5)$$\end{document}</tex-math><mml:math id="M730"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0.27</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>2.5</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq622.gif"/></alternatives></inline-formula>, <inline-formula id="IEq623"><alternatives><tex-math id="M731">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_3=(0.84,1)\times (3.4,+\infty)$$\end{document}</tex-math><mml:math id="M732"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0.84</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>3.4</mml:mn><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:mi>∞</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq623.gif"/></alternatives></inline-formula> and <inline-formula id="IEq624"><alternatives><tex-math id="M733">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_4=(0,0.27)\times (4.8,+\infty)$$\end{document}</tex-math><mml:math id="M734"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0.27</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>4.8</mml:mn><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:mi>∞</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq624.gif"/></alternatives></inline-formula>.</p>
      <p id="Par102">The values are determined from the distribution of QED and SA in ChEMBL dataset (see Fig. <xref rid="Fig10" ref-type="fig">10</xref>a) using the 90 and 10% quantile.<fig id="Fig10"><label>Fig. 10</label><caption><p>Location of <inline-formula id="IEq17"><alternatives><tex-math id="M735">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${C}_{1}\sim {C}_{4}$$\end{document}</tex-math><mml:math id="M736"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq17.gif"/></alternatives></inline-formula> and <inline-formula id="IEq18"><alternatives><tex-math id="M737">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${c}_{1}\sim {c}_{4}$$\end{document}</tex-math><mml:math id="M738"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq18.gif"/></alternatives></inline-formula>. <bold>a</bold> Distribution of QED and SAscore in the ChEMBL dataset; <bold>b</bold> Location of input conditions (<inline-formula id="IEq19"><alternatives><tex-math id="M739">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_1\sim C_4$$\end{document}</tex-math><mml:math id="M740"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq19.gif"/></alternatives></inline-formula> and <inline-formula id="IEq20"><alternatives><tex-math id="M741">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${c}_{1}\sim {c}_{4}$$\end{document}</tex-math><mml:math id="M742"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq20.gif"/></alternatives></inline-formula>)</p></caption><graphic xlink:href="13321_2018_287_Fig10_HTML" id="MO11"/></fig>
The conditions are illustrated in Fig. <xref rid="Fig10" ref-type="fig">10</xref>d. The four sets represent four classes of molecules respectively and the first class <inline-formula id="IEq625"><alternatives><tex-math id="M743">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_1$$\end{document}</tex-math><mml:math id="M744"><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq625.gif"/></alternatives></inline-formula>, which contains structures with high drug-likeness and high synthetic accessibility, defines the set of compounds that are most important for drug design.</p>
      <p id="Par103">Quantitative evaluations of graph based and SMILES based models are demonstrated in Table <xref rid="Tab5" ref-type="table">5</xref>. <table-wrap id="Tab5"><label>Table 5</label><caption><p>Performance of graph based and SMILES based model on property based generation tasks</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Condition (<italic>C</italic>)</th><th align="left"><inline-formula id="IEq457"><alternatives><tex-math id="M745">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_0$$\end{document}</tex-math><mml:math id="M746"><mml:msub><mml:mi>R</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq457.gif"/></alternatives></inline-formula></th><th align="left"><inline-formula id="IEq458"><alternatives><tex-math id="M747">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_0$$\end{document}</tex-math><mml:math id="M748"><mml:msub><mml:mi>I</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq458.gif"/></alternatives></inline-formula></th><th align="left">Model</th><th align="left">% valid</th><th align="left"><inline-formula id="IEq459"><alternatives><tex-math id="M749">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_C$$\end{document}</tex-math><mml:math id="M750"><mml:msub><mml:mi>R</mml:mi><mml:mi>C</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq459.gif"/></alternatives></inline-formula></th><th align="left"><inline-formula id="IEq460"><alternatives><tex-math id="M751">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$EOR_C$$\end{document}</tex-math><mml:math id="M752"><mml:mrow><mml:mi>E</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mi>C</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq460.gif"/></alternatives></inline-formula></th><th align="left">Diversity (<inline-formula id="IEq461"><alternatives><tex-math id="M753">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{\mathbf{c}}$$\end{document}</tex-math><mml:math id="M754"><mml:msub><mml:mi>I</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq461.gif"/></alternatives></inline-formula>)</th></tr></thead><tbody><tr><td align="left" rowspan="2"><inline-formula id="IEq462"><alternatives><tex-math id="M755">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_1$$\end{document}</tex-math><mml:math id="M756"><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq462.gif"/></alternatives></inline-formula></td><td align="left" rowspan="2">0.009</td><td align="left" rowspan="2">0.810</td><td align="left">Graph</td><td char="±" align="char"><italic>0.997 ± 0.000***</italic></td><td char="±" align="char"><italic>0.55 ± 0.01***</italic></td><td char="." align="char"><italic>61</italic></td><td char="±" align="char">0.798 ± 0.002</td></tr><tr><td align="left">SMILES</td><td char="±" align="char">0.995 ± 0.001</td><td char="±" align="char">0.51 ± 0.00</td><td char="." align="char">57</td><td char="±" align="char"><italic>0.806 ± 0.000***</italic></td></tr><tr><td align="left" rowspan="2"><inline-formula id="IEq469"><alternatives><tex-math id="M757">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_2$$\end{document}</tex-math><mml:math id="M758"><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq469.gif"/></alternatives></inline-formula></td><td align="left" rowspan="2">0.012</td><td align="left" rowspan="2">0.850</td><td align="left">Graph</td><td char="±" align="char"><italic>0.970 ± 0.002***</italic></td><td char="±" align="char">0<italic>.55 ± 0.01**</italic></td><td char="." align="char"><italic>46</italic></td><td char="±" align="char">0.841 ± 0.001</td></tr><tr><td align="left">SMILES</td><td char="±" align="char">0.944 ± 0.001</td><td char="±" align="char">0.52 ± 0.00</td><td char="." align="char">43</td><td char="±" align="char">0.841 ± 0.001</td></tr><tr><td align="left" rowspan="2"><inline-formula id="IEq476"><alternatives><tex-math id="M759">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_3$$\end{document}</tex-math><mml:math id="M760"><mml:msub><mml:mi>C</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq476.gif"/></alternatives></inline-formula></td><td align="left" rowspan="2">0.011</td><td align="left" rowspan="2">0.868</td><td align="left">Graph</td><td char="±" align="char"><italic>0.957 ± 0.001***</italic></td><td char="±" align="char"><italic>0.35 ± 0.01**</italic></td><td char="." align="char"><italic>32</italic></td><td char="±" align="char">0.864 ± 0.001</td></tr><tr><td align="left">SMILES</td><td char="±" align="char">0.894 ± 0.007</td><td char="±" align="char">0.31 ± 0.00</td><td char="." align="char">28</td><td char="±" align="char"><italic>0.866 ± 0.001**</italic></td></tr><tr><td align="left" rowspan="2"><inline-formula id="IEq483"><alternatives><tex-math id="M761">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_4$$\end{document}</tex-math><mml:math id="M762"><mml:msub><mml:mi>C</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq483.gif"/></alternatives></inline-formula></td><td align="left" rowspan="2">0.008</td><td align="left" rowspan="2">0.867</td><td align="left">Graph</td><td char="±" align="char"><italic>0.929 ± 0.003***</italic></td><td char="±" align="char"><italic>0.73 ± 0.01**</italic></td><td char="." align="char"><italic>91</italic></td><td char="±" align="char">0.863 ± 0.001</td></tr><tr><td align="left">SMILES</td><td char="±" align="char">0.613 ± 0.015</td><td char="±" align="char">0.66 ± 0.00</td><td char="." align="char">82</td><td char="±" align="char">0.863 ± 0.000</td></tr></tbody></table><table-wrap-foot><p>Results are reported as <inline-formula id="IEq453"><alternatives><tex-math id="M763">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Mean \pm SD$$\end{document}</tex-math><mml:math id="M764"><mml:mrow><mml:mi>M</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mo>±</mml:mo><mml:mi>S</mml:mi><mml:mi>D</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq453.gif"/></alternatives></inline-formula>. The best performance in each metric is highlighted in italics face. Paired <italic>t</italic>-tests are carried out for the difference between the graph and SMILES based method (*** for <inline-formula id="IEq454"><alternatives><tex-math id="M765">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\le 0.001$$\end{document}</tex-math><mml:math id="M766"><mml:mrow><mml:mi>p</mml:mi><mml:mo>≤</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq454.gif"/></alternatives></inline-formula>, ** for <inline-formula id="IEq455"><alternatives><tex-math id="M767">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\le 0.01$$\end{document}</tex-math><mml:math id="M768"><mml:mrow><mml:mi>p</mml:mi><mml:mo>≤</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq455.gif"/></alternatives></inline-formula> and * for <inline-formula id="IEq456"><alternatives><tex-math id="M769">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\le 0.05$$\end{document}</tex-math><mml:math id="M770"><mml:mrow><mml:mi>p</mml:mi><mml:mo>≤</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq456.gif"/></alternatives></inline-formula>)</p></table-wrap-foot></table-wrap>
Again, under all conditions (<inline-formula id="IEq626"><alternatives><tex-math id="M771">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_1 \sim C_4$$\end{document}</tex-math><mml:math id="M772"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq626.gif"/></alternatives></inline-formula>), the graph based model is able to outperform SMILES based model on the rate of valid outputs. The difference is most significant for conditions specifying low synthetic accessibility (that is, high SAscore, which is given by <inline-formula id="IEq627"><alternatives><tex-math id="M773">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_3$$\end{document}</tex-math><mml:math id="M774"><mml:msub><mml:mi>C</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq627.gif"/></alternatives></inline-formula> and <inline-formula id="IEq628"><alternatives><tex-math id="M775">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_4$$\end{document}</tex-math><mml:math id="M776"><mml:msub><mml:mi>C</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq628.gif"/></alternatives></inline-formula>). This observation suggests that SMILES based model have difficulty in generating complex structures while maintaining the structural validity.</p>
      <p id="Par104">The graph based model also provides better performance in terms of <inline-formula id="IEq629"><alternatives><tex-math id="M777">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_C$$\end{document}</tex-math><mml:math id="M778"><mml:msub><mml:mi>R</mml:mi><mml:mi>C</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq629.gif"/></alternatives></inline-formula> and <inline-formula id="IEq630"><alternatives><tex-math id="M779">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$EOR_C$$\end{document}</tex-math><mml:math id="M780"><mml:mrow><mml:mi>E</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mi>C</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq630.gif"/></alternatives></inline-formula> as shown in Table <xref rid="Tab5" ref-type="table">5</xref>. It is noted that both graph and SMILES based models result in comparatively low <inline-formula id="IEq631"><alternatives><tex-math id="M781">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_C$$\end{document}</tex-math><mml:math id="M782"><mml:msub><mml:mi>R</mml:mi><mml:mi>C</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq631.gif"/></alternatives></inline-formula> and <inline-formula id="IEq632"><alternatives><tex-math id="M783">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$EOR_C$$\end{document}</tex-math><mml:math id="M784"><mml:mrow><mml:mi>E</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mi>C</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq632.gif"/></alternatives></inline-formula> on condition <inline-formula id="IEq633"><alternatives><tex-math id="M785">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_3$$\end{document}</tex-math><mml:math id="M786"><mml:msub><mml:mi>C</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq633.gif"/></alternatives></inline-formula>, which corresponds to molecules with high drug-likeness and low synthetic accessibility. However, this result is relatively easy to understand. Since the definition of drug-likeness contains the requriement for high synthetic accessibility, therefore finding molecules with high QED score and high SAscore is in itself a difficult task. For other conditions, the <inline-formula id="IEq634"><alternatives><tex-math id="M787">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_C$$\end{document}</tex-math><mml:math id="M788"><mml:msub><mml:mi>R</mml:mi><mml:mi>C</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq634.gif"/></alternatives></inline-formula> results for both models varies from 50 to 70%. Those values are lower compared with scaffold based task, but nonetheless showing enrichments for all conditions over the distribution from ChEMBL. The diversity of generated samples are also reported.Different from the performance in %valid and <inline-formula id="IEq635"><alternatives><tex-math id="M789">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\mathbf{c}}$$\end{document}</tex-math><mml:math id="M790"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq635.gif"/></alternatives></inline-formula>, SMILES based method is able to produce outputs with slighly higher diversity compared with graph based method. The different is statistically significant for tasks <inline-formula id="IEq636"><alternatives><tex-math id="M791">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_1$$\end{document}</tex-math><mml:math id="M792"><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq636.gif"/></alternatives></inline-formula> and <inline-formula id="IEq637"><alternatives><tex-math id="M793">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_3$$\end{document}</tex-math><mml:math id="M794"><mml:msub><mml:mi>C</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq637.gif"/></alternatives></inline-formula>.</p>
      <p id="Par105">We compared conditional generative model with RL based methods using <inline-formula id="IEq638"><alternatives><tex-math id="M795">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_1$$\end{document}</tex-math><mml:math id="M796"><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq638.gif"/></alternatives></inline-formula> as example. Similar to “Scaffold-Based Generation”, we set <inline-formula id="IEq639"><alternatives><tex-math id="M797">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma$$\end{document}</tex-math><mml:math id="M798"><mml:mi>σ</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq639.gif"/></alternatives></inline-formula> to 20, and use the discrete score function <inline-formula id="IEq640"><alternatives><tex-math id="M799">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_C({\mathbf{x}})$$\end{document}</tex-math><mml:math id="M800"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>C</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq640.gif"/></alternatives></inline-formula> defined in Eq. <xref rid="Equ27" ref-type="">27</xref>. The results are summarized in Table <xref rid="Tab6" ref-type="table">6</xref>. Overall, the performance of RL based methods are similar to that in the scaffold-based task. All RL methods are able to achieve high level of <inline-formula id="IEq641"><alternatives><tex-math id="M801">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\mathbf{c}}$$\end{document}</tex-math><mml:math id="M802"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq641.gif"/></alternatives></inline-formula>, but with lower output diversity.<table-wrap id="Tab6"><label>Table 6</label><caption><p>The comparison between condtional generative models RL based models in the task of generating molecules satisfying condition <inline-formula id="IEq490"><alternatives><tex-math id="M803">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_1$$\end{document}</tex-math><mml:math id="M804"><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq490.gif"/></alternatives></inline-formula> (that is, QED &gt; 0.84 and SA score &lt; 1.9)</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Model</th><th align="left">% valid</th><th align="left"><inline-formula id="IEq492"><alternatives><tex-math id="M805">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\mathbf{c}}$$\end{document}</tex-math><mml:math id="M806"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq492.gif"/></alternatives></inline-formula></th><th align="left"><inline-formula id="IEq493"><alternatives><tex-math id="M807">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$EOR_{\mathbf{c}}$$\end{document}</tex-math><mml:math id="M808"><mml:mrow><mml:mi>E</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq493.gif"/></alternatives></inline-formula></th><th align="left">Diversity (<inline-formula id="IEq494"><alternatives><tex-math id="M809">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{\mathbf{c}}$$\end{document}</tex-math><mml:math id="M810"><mml:msub><mml:mi>I</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq494.gif"/></alternatives></inline-formula>)</th></tr></thead><tbody><tr><td align="left">REINVENT</td><td char="±" align="char">0.999 ± 0.001</td><td char="±" align="char">0.986 ± 0.004</td><td char="." align="char">110</td><td char="±" align="char">0.73 ± 0.07</td></tr><tr><td align="left">Naive RL</td><td char="±" align="char">0.993 ± 0.006</td><td char="±" align="char">0.948 ± 0.052</td><td char="." align="char">105</td><td char="±" align="char">0.64 ± 0.05</td></tr><tr><td align="left">RL + Prior</td><td char="±" align="char"><italic>1.000 ± 0.000</italic></td><td char="±" align="char"><italic>0.999 ± 0.000</italic></td><td char="." align="char"><italic>111</italic></td><td char="±" align="char">0.44 ± 0.16</td></tr><tr><td align="left">Graph</td><td char="±" align="char">0.929 ± 0.003</td><td char="±" align="char">0.73 ± 0.01</td><td char="." align="char">91</td><td char="±" align="char"><italic>0.863 ± 0.001</italic></td></tr><tr><td align="left">SMILES</td><td char="±" align="char">0.613 ± 0.015</td><td char="±" align="char">0.66 ± 0.00</td><td char="." align="char">82</td><td char="±" align="char"><italic>0.863 ± 0.000</italic></td></tr></tbody></table><table-wrap-foot><p>Results are reported as <inline-formula id="IEq491"><alternatives><tex-math id="M811">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Mean \pm SD$$\end{document}</tex-math><mml:math id="M812"><mml:mrow><mml:mi>M</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mo>±</mml:mo><mml:mi>S</mml:mi><mml:mi>D</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq491.gif"/></alternatives></inline-formula></p><p>The best performance in each metric is highlighted in italics face</p></table-wrap-foot></table-wrap></p>
      <p id="Par106">For a visualized demonstration, the distributions of QED and SA score for the output samples from graph based generator are shown in Fig. <xref rid="Fig11" ref-type="fig">11</xref>.<fig id="Fig11"><label>Fig. 11</label><caption><p>Distribution of QED and SAscore for generated results: the upper row indicates distribution of QED and SAscore of molecules generated under conditions <inline-formula id="IEq21"><alternatives><tex-math id="M813">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_1$$\end{document}</tex-math><mml:math id="M814"><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq21.gif"/></alternatives></inline-formula>, <inline-formula id="IEq22"><alternatives><tex-math id="M815">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_2$$\end{document}</tex-math><mml:math id="M816"><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq22.gif"/></alternatives></inline-formula> , <inline-formula id="IEq23"><alternatives><tex-math id="M817">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_3$$\end{document}</tex-math><mml:math id="M818"><mml:msub><mml:mi>C</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq23.gif"/></alternatives></inline-formula> and <inline-formula id="IEq24"><alternatives><tex-math id="M819">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_4$$\end{document}</tex-math><mml:math id="M820"><mml:msub><mml:mi>C</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq24.gif"/></alternatives></inline-formula>. The conditions <inline-formula id="IEq25"><alternatives><tex-math id="M821">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_1\sim C_4$$\end{document}</tex-math><mml:math id="M822"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq25.gif"/></alternatives></inline-formula> are shown as intervals represented by error bar. The lower row indicates distribution of QED and SAscore of molecules generated using single point conditions (<inline-formula id="IEq26"><alternatives><tex-math id="M823">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}_{\mathbf{1}}$$\end{document}</tex-math><mml:math id="M824"><mml:msub><mml:mi mathvariant="bold">c</mml:mi><mml:mn mathvariant="bold">1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq26.gif"/></alternatives></inline-formula>, <inline-formula id="IEq27"><alternatives><tex-math id="M825">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}_{\mathbf{2}}$$\end{document}</tex-math><mml:math id="M826"><mml:msub><mml:mi mathvariant="bold">c</mml:mi><mml:mn mathvariant="bold">2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq27.gif"/></alternatives></inline-formula>, <inline-formula id="IEq28"><alternatives><tex-math id="M827">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}_{\mathbf{3}}$$\end{document}</tex-math><mml:math id="M828"><mml:msub><mml:mi mathvariant="bold">c</mml:mi><mml:mn mathvariant="bold">3</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq28.gif"/></alternatives></inline-formula> and <inline-formula id="IEq29"><alternatives><tex-math id="M829">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}_{\mathbf{4}}$$\end{document}</tex-math><mml:math id="M830"><mml:msub><mml:mi mathvariant="bold">c</mml:mi><mml:mn mathvariant="bold">4</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq29.gif"/></alternatives></inline-formula>). The conditions <inline-formula id="IEq30"><alternatives><tex-math id="M831">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}_{\mathbf{1}}\sim {\mathbf{c}}_{\mathbf{4}}$$\end{document}</tex-math><mml:math id="M832"><mml:mrow><mml:msub><mml:mi mathvariant="bold">c</mml:mi><mml:mn mathvariant="bold">1</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:msub><mml:mi mathvariant="bold">c</mml:mi><mml:mn mathvariant="bold">4</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq30.gif"/></alternatives></inline-formula> are represented as dots in the plot</p></caption><graphic xlink:href="13321_2018_287_Fig11_HTML" id="MO12"/></fig>
Random samples are also chosen for each class and are visualization in Fig. <xref rid="Fig12" ref-type="fig">12</xref>.<fig id="Fig12"><label>Fig. 12</label><caption><p>Samples generated under the four predefined conditions on drug-likeness and synthetic accessibility score</p></caption><graphic xlink:href="13321_2018_287_Fig12_HTML" id="MO13"/></fig>
The structural features for the output samples are mostly consistent with the predefined conditions, with small and simple molecules for <inline-formula id="IEq642"><alternatives><tex-math id="M833">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_1$$\end{document}</tex-math><mml:math id="M834"><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq642.gif"/></alternatives></inline-formula> and highly complex molecules for <inline-formula id="IEq643"><alternatives><tex-math id="M835">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_4$$\end{document}</tex-math><mml:math id="M836"><mml:msub><mml:mi>C</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq643.gif"/></alternatives></inline-formula>.</p>
      <p id="Par107">Note that conditional models also support generation based on a given point of QED and SAscore. This is demonstrated visually using graph based conditional model. Now, the molecule generation process is conditioned on a single points of conditional code <inline-formula id="IEq644"><alternatives><tex-math id="M837">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}$$\end{document}</tex-math><mml:math id="M838"><mml:mi mathvariant="bold">c</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq644.gif"/></alternatives></inline-formula>. Here, we use four different conditions as specified as follows: <inline-formula id="IEq645"><alternatives><tex-math id="M839">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}_1=(0.84,1.9)$$\end{document}</tex-math><mml:math id="M840"><mml:mrow><mml:msub><mml:mi mathvariant="bold">c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0.84</mml:mn><mml:mo>,</mml:mo><mml:mn>1.9</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq645.gif"/></alternatives></inline-formula>, <inline-formula id="IEq646"><alternatives><tex-math id="M841">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}_2=(0.27,2.5)$$\end{document}</tex-math><mml:math id="M842"><mml:mrow><mml:msub><mml:mi mathvariant="bold">c</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0.27</mml:mn><mml:mo>,</mml:mo><mml:mn>2.5</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq646.gif"/></alternatives></inline-formula>, <inline-formula id="IEq647"><alternatives><tex-math id="M843">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}_3=(0.84,3.8)$$\end{document}</tex-math><mml:math id="M844"><mml:mrow><mml:msub><mml:mi mathvariant="bold">c</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0.84</mml:mn><mml:mo>,</mml:mo><mml:mn>3.8</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq647.gif"/></alternatives></inline-formula> and <inline-formula id="IEq648"><alternatives><tex-math id="M845">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}_4=(0.27,4.8)$$\end{document}</tex-math><mml:math id="M846"><mml:mrow><mml:msub><mml:mi mathvariant="bold">c</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0.27</mml:mn><mml:mo>,</mml:mo><mml:mn>4.8</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq648.gif"/></alternatives></inline-formula>. Those conditons are also demonstrated in Fig. <xref rid="Fig10" ref-type="fig">10</xref>.</p>
      <p id="Par108">The distributions of QED and SAscore for the output molecules by graph based model are shown in Fig. <xref rid="Fig10" ref-type="fig">10</xref>e–h. Results show that, although the requirement is specified using a single value of QED and SAscore, the distribution of the two properties for output samples are relatively dispersed. This result is not surprising since the QED and SAscore score are relatively abstract descriptions of structural features of molecules, and a small modification of molecule structure may lead to significant changes in QED and SA scores. Nonetheless, it can be found that the generated samples are enriched around the corresponding code <inline-formula id="IEq649"><alternatives><tex-math id="M847">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}$$\end{document}</tex-math><mml:math id="M848"><mml:mi mathvariant="bold">c</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq649.gif"/></alternatives></inline-formula>. It is also observed that the distribution of SAscore is more concentrated than that of QED. This is probably because that SAscore is direct measurement of molecular graph complexity, which may be easier to model for the graph based generator. In contrast, QED is a more abstract descriptor related to various molecular properties.</p>
    </sec>
    <sec id="Sec28">
      <title>Generating dual inhibitors for JNK3 and GSK-3<inline-formula id="IEq650"><alternatives><tex-math id="M849">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M850"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq650.gif"/></alternatives></inline-formula></title>
      <p id="Par109">In this task, the models are used to generate dual inhibitor for JNK3 and GSK-3<inline-formula id="IEq651"><alternatives><tex-math id="M851">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M852"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq651.gif"/></alternatives></inline-formula>. A predictive model is first used to label the conditional code for ChEMBL dataset, and the conditional graph generator is trained on the labeled training set. The two predictors yield good results in general, with AUC = 0.983 for JNK3 and AUC = 0.984 for GSK-3<inline-formula id="IEq652"><alternatives><tex-math id="M853">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M854"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq652.gif"/></alternatives></inline-formula>. The ROC curves for the two models are show in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S4.</p>
      <p id="Par110">Results for both the SMILES based and graph based conditional generator are given in Table <xref rid="Tab7" ref-type="table">7</xref>.<table-wrap id="Tab7"><label>Table 7</label><caption><p>Performance of graph based and SMILES based model on inhibitor generation, results are reported as <inline-formula id="IEq510"><alternatives><tex-math id="M855">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Mean \pm SD$$\end{document}</tex-math><mml:math id="M856"><mml:mrow><mml:mi>M</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mo>±</mml:mo><mml:mi>S</mml:mi><mml:mi>D</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq510.gif"/></alternatives></inline-formula></p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Condition (<inline-formula id="IEq514"><alternatives><tex-math id="M857">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}$$\end{document}</tex-math><mml:math id="M858"><mml:mi mathvariant="bold">c</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq514.gif"/></alternatives></inline-formula>)</th><th align="left"><inline-formula id="IEq515"><alternatives><tex-math id="M859">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_0$$\end{document}</tex-math><mml:math id="M860"><mml:msub><mml:mi>R</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq515.gif"/></alternatives></inline-formula></th><th align="left"><inline-formula id="IEq516"><alternatives><tex-math id="M861">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_0$$\end{document}</tex-math><mml:math id="M862"><mml:msub><mml:mi>I</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq516.gif"/></alternatives></inline-formula></th><th align="left">Model</th><th align="left">% valid</th><th align="left"><inline-formula id="IEq517"><alternatives><tex-math id="M863">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\mathbf{c}}$$\end{document}</tex-math><mml:math id="M864"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq517.gif"/></alternatives></inline-formula></th><th align="left"><inline-formula id="IEq518"><alternatives><tex-math id="M865">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$EOR_{\mathbf{c}}$$\end{document}</tex-math><mml:math id="M866"><mml:mrow><mml:mi>E</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq518.gif"/></alternatives></inline-formula></th><th align="left">Diversity</th></tr></thead><tbody><tr><td align="left">GSK-3<inline-formula id="IEq519"><alternatives><tex-math id="M867">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M868"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq519.gif"/></alternatives></inline-formula>(+)</td><td align="left" rowspan="2">0.0008</td><td align="left" rowspan="2">0.806</td><td align="left">Graph</td><td char="±" align="char">0.939 ± 0.007</td><td char="±" align="char">0.53 ± 0.01</td><td char="±" align="char">666</td><td char="±" align="char">0.783 ± 0.006</td></tr><tr><td align="left">JNK3(+)</td><td align="left">SMILES</td><td char="±" align="char"><italic>0.959 ± 0.003**</italic></td><td char="±" align="char"><italic>0.56 ± 0.01***</italic></td><td char="±" align="char"><italic>697</italic></td><td char="±" align="char"><italic>0.784 ± 0.003</italic></td></tr><tr><td align="left">GSK-3<inline-formula id="IEq526"><alternatives><tex-math id="M869">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M870"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq526.gif"/></alternatives></inline-formula>(+)</td><td align="left" rowspan="2">0.01</td><td align="left" rowspan="2">0.860</td><td align="left">Graph</td><td char="±" align="char"><italic>0.932 ± 0.007</italic></td><td char="±" align="char">0.42 ± 0.01</td><td char="±" align="char">42</td><td char="±" align="char">0.851 ± 0.001</td></tr><tr><td align="left">JNK3(−)</td><td align="left">SMILES</td><td char="±" align="char">0.928 ± 0.003*</td><td char="±" align="char"><italic>0.47 ± 0.01***</italic></td><td char="±" align="char"><italic>47</italic></td><td char="±" align="char">0.854 ± 0.001**</td></tr><tr><td align="left">GSK-3<inline-formula id="IEq533"><alternatives><tex-math id="M871">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M872"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq533.gif"/></alternatives></inline-formula>(−)</td><td align="left" rowspan="2">0.0008</td><td align="left" rowspan="2">0.829</td><td align="left">Graph</td><td char="±" align="char"><italic>0.955 ± 0.003**</italic></td><td char="±" align="char"><italic>0.61 ± 0.00***</italic></td><td char="±" align="char"><italic>759</italic></td><td char="±" align="char">0.814 ± 0.002</td></tr><tr><td align="left">JNK3(+)</td><td align="left">SMILES</td><td char="±" align="char">0.944 ± 0.003</td><td char="±" align="char">0.56 ± 0.01</td><td char="±" align="char">698</td><td char="±" align="char"><italic>0.821 ± 0.001***</italic></td></tr></tbody></table><table-wrap-foot><p>The best performance in each metric is highlighted in italics face. Paired <italic>t</italic>-tests are carried out for the difference between the graph and SMILES based method (*** for <inline-formula id="IEq511"><alternatives><tex-math id="M873">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\le 0.001$$\end{document}</tex-math><mml:math id="M874"><mml:mrow><mml:mi>p</mml:mi><mml:mo>≤</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq511.gif"/></alternatives></inline-formula>, ** for <inline-formula id="IEq512"><alternatives><tex-math id="M875">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\le 0.01$$\end{document}</tex-math><mml:math id="M876"><mml:mrow><mml:mi>p</mml:mi><mml:mo>≤</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq512.gif"/></alternatives></inline-formula> and * for <inline-formula id="IEq513"><alternatives><tex-math id="M877">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\le 0.05$$\end{document}</tex-math><mml:math id="M878"><mml:mrow><mml:mi>p</mml:mi><mml:mo>≤</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq513.gif"/></alternatives></inline-formula>)</p></table-wrap-foot></table-wrap> In terms of output validity, graph based model outperforms SMILES based model in generating GSK-3<inline-formula id="IEq653"><alternatives><tex-math id="M879">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M880"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq653.gif"/></alternatives></inline-formula> selective and JNK3 selective compounds, but for the generation of dual inhibitors, SMILES based model achieves better performance. In terms of <inline-formula id="IEq654"><alternatives><tex-math id="M881">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\mathbf{c}}$$\end{document}</tex-math><mml:math id="M882"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq654.gif"/></alternatives></inline-formula> and <inline-formula id="IEq655"><alternatives><tex-math id="M883">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$EOR_{\mathbf{c}}$$\end{document}</tex-math><mml:math id="M884"><mml:mrow><mml:mi>E</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq655.gif"/></alternatives></inline-formula>, SMILES based model is able to obtain better performance in generating dual inhibitors and selective inhibitors against GSK-3<inline-formula id="IEq656"><alternatives><tex-math id="M885">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M886"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq656.gif"/></alternatives></inline-formula>, while the graph based model performs better in the task of generating JNK3 selective inhibitors.The <inline-formula id="IEq657"><alternatives><tex-math id="M887">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_{{\mathbf{c}}{\mathbf{c}}^{\prime}}$$\end{document}</tex-math><mml:math id="M888"><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="bold">c</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq657.gif"/></alternatives></inline-formula> matrices for graph based and SMILES based model are shown in Table <xref rid="Tab8" ref-type="table">8</xref>.<table-wrap id="Tab8"><label>Table 8</label><caption><p>The <inline-formula id="IEq540"><alternatives><tex-math id="M889">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_{\mathbf{c}{} \mathbf{c}^\prime }$$\end{document}</tex-math><mml:math id="M890"><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="bold">c</mml:mi><mml:mrow/><mml:msup><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq540.gif"/></alternatives></inline-formula> matrix for kinase inhibitor generation task, the diagnal elements <inline-formula id="IEq541"><alternatives><tex-math id="M891">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_{\mathbf{c}{} \mathbf{c}}=R_\mathbf{c}$$\end{document}</tex-math><mml:math id="M892"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="bold">c</mml:mi><mml:mrow/><mml:mi mathvariant="bold">c</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq541.gif"/></alternatives></inline-formula> are omitted since they have been reported in Table <xref rid="Tab7" ref-type="table">7</xref></p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">Condition (<inline-formula id="IEq547"><alternatives><tex-math id="M893">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}$$\end{document}</tex-math><mml:math id="M894"><mml:mi mathvariant="bold">c</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq547.gif"/></alternatives></inline-formula>)</th><th align="left" rowspan="2">Model</th><th align="left" colspan="3">Results(<inline-formula id="IEq546"><alternatives><tex-math id="M895">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf{c}}^\prime$$\end{document}</tex-math><mml:math id="M896"><mml:msup><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq546.gif"/></alternatives></inline-formula>)</th></tr><tr><th align="left">GSK-3<inline-formula id="IEq548"><alternatives><tex-math id="M897">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M898"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq548.gif"/></alternatives></inline-formula>(+),<break/>JNK3(+)</th><th align="left">GSK-3<inline-formula id="IEq549"><alternatives><tex-math id="M899">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M900"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq549.gif"/></alternatives></inline-formula>(+),<break/>JNK3(−)</th><th align="left">GSK-3<inline-formula id="IEq550"><alternatives><tex-math id="M901">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M902"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq550.gif"/></alternatives></inline-formula>(−),<break/>JNK3(+)</th></tr></thead><tbody><tr><td align="left">GSK-3<inline-formula id="IEq551"><alternatives><tex-math id="M903">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M904"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq551.gif"/></alternatives></inline-formula>(+)</td><td align="left">Graph</td><td align="left">–</td><td align="left"><inline-formula id="IEq552"><alternatives><tex-math id="M905">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.178\pm 0.007$$\end{document}</tex-math><mml:math id="M906"><mml:mrow><mml:mn>0.178</mml:mn><mml:mo>±</mml:mo><mml:mn>0.007</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq552.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq553"><alternatives><tex-math id="M907">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\it 0.018}\pm {\it 0.001}$$\end{document}</tex-math><mml:math id="M908"><mml:mrow><mml:mrow><mml:mn mathvariant="italic">0.018</mml:mn></mml:mrow><mml:mo>±</mml:mo><mml:mrow><mml:mn mathvariant="italic">0.001</mml:mn></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq553.gif"/></alternatives></inline-formula></td></tr><tr><td align="left">JNK3(+)</td><td align="left">SMILES</td><td align="left">–</td><td align="left"><inline-formula id="IEq554"><alternatives><tex-math id="M909">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\it 0.167}\pm {\it 0.010}$$\end{document}</tex-math><mml:math id="M910"><mml:mrow><mml:mrow><mml:mn mathvariant="italic">0.167</mml:mn></mml:mrow><mml:mo>±</mml:mo><mml:mrow><mml:mn mathvariant="italic">0.010</mml:mn></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq554.gif"/></alternatives></inline-formula>*</td><td align="left"><inline-formula id="IEq555"><alternatives><tex-math id="M911">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.063\pm 0.006$$\end{document}</tex-math><mml:math id="M912"><mml:mrow><mml:mn>0.063</mml:mn><mml:mo>±</mml:mo><mml:mn>0.006</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq555.gif"/></alternatives></inline-formula></td></tr><tr><td align="left">GSK-3<inline-formula id="IEq556"><alternatives><tex-math id="M913">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M914"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq556.gif"/></alternatives></inline-formula>(+)</td><td align="left">Graph</td><td align="left"><inline-formula id="IEq557"><alternatives><tex-math id="M915">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\it 0.034}\pm {\it 0.001}$$\end{document}</tex-math><mml:math id="M916"><mml:mrow><mml:mrow><mml:mn mathvariant="italic">0.034</mml:mn></mml:mrow><mml:mo>±</mml:mo><mml:mrow><mml:mn mathvariant="italic">0.001</mml:mn></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq557.gif"/></alternatives></inline-formula>***</td><td align="left">–</td><td align="left"><inline-formula id="IEq558"><alternatives><tex-math id="M917">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\it 0.003}\pm {\it 0.000}$$\end{document}</tex-math><mml:math id="M918"><mml:mrow><mml:mrow><mml:mn mathvariant="italic">0.003</mml:mn></mml:mrow><mml:mo>±</mml:mo><mml:mrow><mml:mn mathvariant="italic">0.000</mml:mn></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq558.gif"/></alternatives></inline-formula>***</td></tr><tr><td align="left">JNK3(−)</td><td align="left">SMILES</td><td align="left"><inline-formula id="IEq559"><alternatives><tex-math id="M919">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.082\pm 0.007$$\end{document}</tex-math><mml:math id="M920"><mml:mrow><mml:mn>0.082</mml:mn><mml:mo>±</mml:mo><mml:mn>0.007</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq559.gif"/></alternatives></inline-formula></td><td align="left">–</td><td align="left"><inline-formula id="IEq560"><alternatives><tex-math id="M921">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.023\pm 0.002$$\end{document}</tex-math><mml:math id="M922"><mml:mrow><mml:mn>0.023</mml:mn><mml:mo>±</mml:mo><mml:mn>0.002</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq560.gif"/></alternatives></inline-formula></td></tr><tr><td align="left">GSK-3<inline-formula id="IEq561"><alternatives><tex-math id="M923">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M924"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq561.gif"/></alternatives></inline-formula>(−)</td><td align="left">Graph</td><td align="left"><inline-formula id="IEq562"><alternatives><tex-math id="M925">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\it 0.024}\pm {\it 0.004}$$\end{document}</tex-math><mml:math id="M926"><mml:mrow><mml:mrow><mml:mn mathvariant="italic">0.024</mml:mn></mml:mrow><mml:mo>±</mml:mo><mml:mrow><mml:mn mathvariant="italic">0.004</mml:mn></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq562.gif"/></alternatives></inline-formula>***</td><td align="left"><inline-formula id="IEq563"><alternatives><tex-math id="M927">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\it 0.022}\pm {\it 0.002}$$\end{document}</tex-math><mml:math id="M928"><mml:mrow><mml:mrow><mml:mn mathvariant="italic">0.022</mml:mn></mml:mrow><mml:mo>±</mml:mo><mml:mrow><mml:mn mathvariant="italic">0.002</mml:mn></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq563.gif"/></alternatives></inline-formula>***</td><td align="left">–</td></tr><tr><td align="left">JNK3(+)</td><td align="left">SMILES</td><td align="left"><inline-formula id="IEq564"><alternatives><tex-math id="M929">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.083\pm 0.007$$\end{document}</tex-math><mml:math id="M930"><mml:mrow><mml:mn>0.083</mml:mn><mml:mo>±</mml:mo><mml:mn>0.007</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq564.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq565"><alternatives><tex-math id="M931">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.057\pm 0.002$$\end{document}</tex-math><mml:math id="M932"><mml:mrow><mml:mn>0.057</mml:mn><mml:mo>±</mml:mo><mml:mn>0.002</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq565.gif"/></alternatives></inline-formula></td><td align="left">–</td></tr></tbody></table><table-wrap-foot><p>Results are reported as <inline-formula id="IEq542"><alternatives><tex-math id="M933">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Mean \pm SD$$\end{document}</tex-math><mml:math id="M934"><mml:mrow><mml:mi>M</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mo>±</mml:mo><mml:mi>S</mml:mi><mml:mi>D</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq542.gif"/></alternatives></inline-formula>. The best performance in each metric is highlighted in italics face.Paired <italic>t</italic>-tests are carried out for the difference between the graph and SMILES based method (*** for <inline-formula id="IEq543"><alternatives><tex-math id="M935">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\le 0.001$$\end{document}</tex-math><mml:math id="M936"><mml:mrow><mml:mi>p</mml:mi><mml:mo>≤</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq543.gif"/></alternatives></inline-formula>, ** for <inline-formula id="IEq544"><alternatives><tex-math id="M937">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\le 0.01$$\end{document}</tex-math><mml:math id="M938"><mml:mrow><mml:mi>p</mml:mi><mml:mo>≤</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq544.gif"/></alternatives></inline-formula> and * for <inline-formula id="IEq545"><alternatives><tex-math id="M939">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p\le 0.05$$\end{document}</tex-math><mml:math id="M940"><mml:mrow><mml:mi>p</mml:mi><mml:mo>≤</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq545.gif"/></alternatives></inline-formula>)</p></table-wrap-foot></table-wrap> For both graph based and SMILES based model, it is noted that when generating compounds that is active to both JNK3 and GSK-3<inline-formula id="IEq658"><alternatives><tex-math id="M941">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M942"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq658.gif"/></alternatives></inline-formula>, there is a significant amount of outputs falling into the category of GSK-3<inline-formula id="IEq659"><alternatives><tex-math id="M943">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M944"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq659.gif"/></alternatives></inline-formula> positive and JNK3 negative. Nonetheless, in terms of the enrichment over random <inline-formula id="IEq660"><alternatives><tex-math id="M945">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$EOR_\mathbf{c}$$\end{document}</tex-math><mml:math id="M946"><mml:mrow><mml:mi>E</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq660.gif"/></alternatives></inline-formula>, the two models are able to achieve high performance for all selectivity combinations. Note that selective inhibitors for GSK-3<inline-formula id="IEq661"><alternatives><tex-math id="M947">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M948"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq661.gif"/></alternatives></inline-formula> are relatively enriched in ChEMBL database, according to the result of the predictor. In comparison, the selective inhibitors against JNK3 and the dual inhibitor for both JNK3 and GSK-3<inline-formula id="IEq662"><alternatives><tex-math id="M949">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M950"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq662.gif"/></alternatives></inline-formula> are much rarer. However, the model is still able to achieve significant enrichment for the two types of selectivity. The result shows potential application for target combinations that have low data enrichment rate.</p>
      <p id="Par111">Similar to previous tasks, a comparison with RL based methods is performed. Here, we mainly focus on the task to generate joint inhibitors to JNK3 and GSK-3<inline-formula id="IEq663"><alternatives><tex-math id="M951">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M952"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq663.gif"/></alternatives></inline-formula>. In terms of the design of score function, we have employed <inline-formula id="IEq664"><alternatives><tex-math id="M953">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_\mathbf{c}(\mathbf{x})$$\end{document}</tex-math><mml:math id="M954"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq664.gif"/></alternatives></inline-formula> similar to that used in previous tasks (Eq. <xref rid="Equ27" ref-type="">27</xref>). The value of <inline-formula id="IEq665"><alternatives><tex-math id="M955">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma$$\end{document}</tex-math><mml:math id="M956"><mml:mi>σ</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq665.gif"/></alternatives></inline-formula> is set to 20 for <inline-formula id="IEq666"><alternatives><tex-math id="M957">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_d$$\end{document}</tex-math><mml:math id="M958"><mml:msub><mml:mi>S</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq666.gif"/></alternatives></inline-formula>. The results are summarized in Table <xref rid="Tab9" ref-type="table">9</xref>.<table-wrap id="Tab9"><label>Table 9</label><caption><p>The comparison between condtional generative models RL based models in the task of generating dual inhibitors against GSK-3<inline-formula id="IEq566"><alternatives><tex-math id="M959">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M960"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq566.gif"/></alternatives></inline-formula> and JNK3</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Model</th><th align="left">% valid</th><th align="left"><inline-formula id="IEq568"><alternatives><tex-math id="M961">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{\mathbf{c}}$$\end{document}</tex-math><mml:math id="M962"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq568.gif"/></alternatives></inline-formula></th><th align="left"><inline-formula id="IEq569"><alternatives><tex-math id="M963">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$EOR_{\mathbf{c}}$$\end{document}</tex-math><mml:math id="M964"><mml:mrow><mml:mi>E</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq569.gif"/></alternatives></inline-formula></th><th align="left">Diversity (<inline-formula id="IEq570"><alternatives><tex-math id="M965">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{\mathbf{c}}$$\end{document}</tex-math><mml:math id="M966"><mml:msub><mml:mi>I</mml:mi><mml:mi mathvariant="bold">c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq570.gif"/></alternatives></inline-formula>)</th></tr></thead><tbody><tr><td align="left">REINVENT</td><td char="±" align="char"><italic>0.999 ± 0.001</italic></td><td char="±" align="char"><italic>0.996 ± 0.005</italic></td><td char="." align="char"><italic>1245</italic></td><td char="±" align="char">0.3 ± 0.2</td></tr><tr><td align="left">Naive RL</td><td char="±" align="char">0.987 ± 0.007</td><td char="±" align="char">0.969 ± 0.022</td><td char="." align="char">1211</td><td char="±" align="char">0.4 ± 0.1</td></tr><tr><td align="left">Graph</td><td char="±" align="char">0.955 ± 0.003</td><td char="±" align="char">0.61 ± 0.00</td><td char="." align="char">759</td><td char="±" align="char">0.814 ± 0.002</td></tr><tr><td align="left">SMILES</td><td char="±" align="char">0.944 ± 0.003</td><td char="±" align="char">0.56 ± 0.01</td><td char="." align="char">698</td><td char="±" align="char"><italic>0.821 ± 0.001</italic></td></tr></tbody></table><table-wrap-foot><p>Results are reported as <inline-formula id="IEq567"><alternatives><tex-math id="M967">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Mean \pm SD$$\end{document}</tex-math><mml:math id="M968"><mml:mrow><mml:mi>M</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mo>±</mml:mo><mml:mi>S</mml:mi><mml:mi>D</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq567.gif"/></alternatives></inline-formula></p><p>The best performance in each metric is highlighted in italics face</p></table-wrap-foot></table-wrap> Note that result for RL + Prior is omited, since in this task, we found that it tends to collapse quickly to a single molecule that could not provide meaningful result. The performance of Naive RL and REINVENT is similar to that reported in previous sections. Both RL based methods achieves high value of <inline-formula id="IEq667"><alternatives><tex-math id="M969">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_c$$\end{document}</tex-math><mml:math id="M970"><mml:msub><mml:mi>R</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq667.gif"/></alternatives></inline-formula>, but have much lower output diversity.</p>
      <p id="Par112">To better demonstrate the structural distribution of the generated samples, visualization based on t-SNE [<xref ref-type="bibr" rid="CR56">56</xref>]is performed using the ECFP6 fingerprint. The generated samples under different selectivity specifications and molecules in the test set for each target are projected into two-dimensional embeddings and are shown in Fig. <xref rid="Fig13" ref-type="fig">13</xref>a–d. According to the result, it is shown that the conditional generator tends to produce molecules near the test set samples, which is consistent with observations based on other methods [<xref ref-type="bibr" rid="CR12">12</xref>]. It is also observed that molecules generated under different selectivity condition occupy distinct region of chemical space.</p>
      <p id="Par113">For each selectivity condition, several molecules are sampled using the model and are demonstrated in Fig. <xref rid="Fig14" ref-type="fig">14</xref>a–c. By investigating the generated structures in detail, it can be observed that the model tends to generate samples containing well-established scaffold for the corresponding target. For JNK3, structures such as diaminopurines [<xref ref-type="bibr" rid="CR57">57</xref>] and triazolones [<xref ref-type="bibr" rid="CR58">58</xref>], which have been frequently used in the design of JNK inhibitors, show high occurrence in the generated samples. The observation is the same for GSK-3<inline-formula id="IEq668"><alternatives><tex-math id="M971">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M972"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq668.gif"/></alternatives></inline-formula>, with example like 2,3-bis-arylmaleimides, a class of widely studied inhibitors of GSK-3 [<xref ref-type="bibr" rid="CR59">59</xref>]. On the other hand, aminopyrimidines are frequently shown in the outputs of all selectivity conditions, but they are more enriched in generated dual inhibitors. Those observations show good interpretability of the outputs, and indicate that the structural features of generated samples are in line with the existing knowledge about the two targets.<fig id="Fig13"><label>Fig. 13</label><caption><p>Visualizing the distribution of generated samples for each target. The figure shows the t-SNE visualization of: <bold>a</bold> molecules form test set of GSK-3<inline-formula id="IEq31"><alternatives><tex-math id="M973">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M974"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq31.gif"/></alternatives></inline-formula> and samples conditioned on JNK3(−), GSK-3<inline-formula id="IEq32"><alternatives><tex-math id="M975">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M976"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq32.gif"/></alternatives></inline-formula>(+), <bold>b</bold> molecules from test set of GSK-3<inline-formula id="IEq33"><alternatives><tex-math id="M977">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M978"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq33.gif"/></alternatives></inline-formula> and samples conditioned on JNK3(+), GSK-3<inline-formula id="IEq34"><alternatives><tex-math id="M979">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M980"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq34.gif"/></alternatives></inline-formula>(+). <bold>c</bold> Molecules from test set of JNK3 and samples conditioned on JNK3(+), GSK-3<inline-formula id="IEq35"><alternatives><tex-math id="M981">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M982"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq35.gif"/></alternatives></inline-formula>(−), <bold>d</bold> molecules from test set of JNK3 and samples conditioned on JNK3(+), GSK-3<inline-formula id="IEq36"><alternatives><tex-math id="M983">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M984"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq36.gif"/></alternatives></inline-formula>(+)</p></caption><graphic xlink:href="13321_2018_287_Fig13_HTML" id="MO14"/></fig>
<fig id="Fig14"><label>Fig. 14</label><caption><p>Samples conditioned on different selectivity conditions. <bold>a–c</bold> Generated samples under different condition of selectivity (<bold>a</bold> for dual inhibitors, <bold>b</bold> for GSK-3<inline-formula id="IEq37"><alternatives><tex-math id="M985">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M986"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq37.gif"/></alternatives></inline-formula> selective inhibitors, and <bold>c</bold> for JNK3 selective inhibitors); <bold>d, e</bold> Some recovered actives of JNK3 and GSK-3<inline-formula id="IEq38"><alternatives><tex-math id="M987">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M988"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq38.gif"/></alternatives></inline-formula> respectively. <bold>a</bold> Generated dual inhibitors. <bold>b</bold> Generated GSK-3β selective inhibiors. <bold>c</bold> Generated JNK3 selective inhibiors. <bold>d</bold> Recovered JNK3 inhibitors. <bold>e</bold> Recovered GSK-3β inhibitors</p></caption><graphic xlink:href="13321_2018_287_Fig14_HTML" id="MO15"/></fig></p>
      <p id="Par114">Finally, we report the percentage of reproduced samples from the test set for each target. From the result, 10.3% of molecules are reproduced for JNK3 and, 6.0% of molecules are reproduced for GSK-3<inline-formula id="IEq669"><alternatives><tex-math id="M989">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M990"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq669.gif"/></alternatives></inline-formula>. Note that molecules in the test sets for each targets have been excluded from the ChEMBL training set in this task, which means that the method is capable of generating molecules that have been confirmed to be positive, without seeing them in the training set of predictive model and conditional generative model.</p>
      <p id="Par115">Several recovered actives are shown in Fig. <xref rid="Fig14" ref-type="fig">14</xref>d–e. Those molecules show relatively high diversity in structure, indicating that the model does not collapse to a subgroup of active compounds. A quantitative evaluation is performed using the internal diversity, and the result shows that the recovered GSK-3<inline-formula id="IEq670"><alternatives><tex-math id="M991">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M992"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq670.gif"/></alternatives></inline-formula> inhibitors have a internal diversity of 0.819, while the recovered JNK3 inhibitors have a internal diversity of 0.761. Those values, although slighly lower, are relatively close to the diversity of test set molecules, which are 0.867 for GSK-3<inline-formula id="IEq671"><alternatives><tex-math id="M993">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M994"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq671.gif"/></alternatives></inline-formula> and 0.852 for JNK3.</p>
    </sec>
  </sec>
  <sec id="Sec29">
    <title>Conclusions</title>
    <p id="Par116">In this work, a new framework for de novo molecular design is proposed based on graph generative model and is applied to solve different drug design problems. The graph generator is designed to be more fitted to the tasks of molecule generation using a simple decoding scheme and a graph convolutional architecture that is less computationally expensive. Furthermore, a more flexible way of introducing decoding invariance is also suggested. The method is trained using molecules in ChEMBL dataset and has demonstrated better performance compared with SMILES based methods, especially in terms of the rate of valid outputs.</p>
    <p id="Par117">To generate molecules with specific requirements, we propose to use conditional generative model, which offers high flexibility and do not require reinforcement learning. The model is applied to solve problems that is highly related to drug design, such as generating molecules based on a given scaffold, generating molecules with good drug-likeness and synthetic accessibility and the generation of molecules with specific profile against multiple targets. Results have showed that the conditional generative model can effectively produce enriched outputs based on the given requirements. A comparison with RL based method is performed, and results shows that although conditional generative model yields lower output accuracy, but it is capable of achieving higher output diversity.</p>
    <p id="Par118">This work can be extended in various aspects. First of all, the models used in this work completely ignores the stereochemistry information for molecules. In fact, stereochemistry is extremely important in the process of drug development, and introducing this information helps to improve the applicability of existing models. Secondly, for the target based generation, it will be much more helpful to jointly train the generator and the decoder, utilizing strategies such as semi-supervised learning [<xref ref-type="bibr" rid="CR60">60</xref>, <xref ref-type="bibr" rid="CR61">61</xref>]. Finally, besides the three tasks experimented in this work, conditional graph generator can be used in many other scenarios. To summarize, the graph generative architecture proposed in this work gives promising result in various drug design tasks, and it is worthwhile to explore other potential applications using this method.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional files</title>
    <sec id="Sec31">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13321_2018_287_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1.</bold> Containing additional information about the implementation details of experiments.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13321_2018_287_MOESM2_ESM.pdf">
            <caption>
              <p><bold>Additional file 2.</bold> Contianing supplementary figures.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>SMILES</term>
        <def>
          <p id="Par3">simplified molecular-input line-entry system</p>
        </def>
      </def-item>
      <def-item>
        <term>RNN</term>
        <def>
          <p id="Par4">recurrent neural network</p>
        </def>
      </def-item>
      <def-item>
        <term>LM</term>
        <def>
          <p id="Par5">language model</p>
        </def>
      </def-item>
      <def-item>
        <term>RF</term>
        <def>
          <p id="Par6">random forest</p>
        </def>
      </def-item>
      <def-item>
        <term>RL</term>
        <def>
          <p id="Par7">reinforcement learning</p>
        </def>
      </def-item>
      <def-item>
        <term>VAE</term>
        <def>
          <p id="Par8">variational autoencoder</p>
        </def>
      </def-item>
      <def-item>
        <term>GRU</term>
        <def>
          <p id="Par9">gated recurrent unit</p>
        </def>
      </def-item>
      <def-item>
        <term>DRD2</term>
        <def>
          <p id="Par10">dopamine receptor D2</p>
        </def>
      </def-item>
      <def-item>
        <term>JNK3</term>
        <def>
          <p id="Par11">c-Jun N-terminal kinase 3</p>
        </def>
      </def-item>
      <def-item>
        <term>GSK3<inline-formula id="IEq2"><alternatives><tex-math id="M995">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M996"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_287_Article_IEq2.gif"/></alternatives></inline-formula></term>
        <def>
          <p id="Par12">glycogen synthase kinase-3 beta</p>
        </def>
      </def-item>
      <def-item>
        <term>QED</term>
        <def>
          <p id="Par13">quantitative estimate of drug-likeness</p>
        </def>
      </def-item>
      <def-item>
        <term>SA</term>
        <def>
          <p id="Par14">synthetic accessibility</p>
        </def>
      </def-item>
      <def-item>
        <term>ECFP</term>
        <def>
          <p id="Par15">extended connectivity fingerprint</p>
        </def>
      </def-item>
      <def-item>
        <term>t-SNE</term>
        <def>
          <p id="Par16">t-distributed stochastic neighbor embedding</p>
        </def>
      </def-item>
      <def-item>
        <term>
          <inline-formula id="IEq3">
            <alternatives>
              <tex-math id="M997">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{KL}$$\end{document}</tex-math>
              <mml:math id="M998">
                <mml:msub>
                  <mml:mi>D</mml:mi>
                  <mml:mrow>
                    <mml:mi mathvariant="italic">KL</mml:mi>
                  </mml:mrow>
                </mml:msub>
              </mml:math>
              <inline-graphic xlink:href="13321_2018_287_Article_IEq3.gif"/>
            </alternatives>
          </inline-formula>
        </term>
        <def>
          <p id="Par17">Kullback–Leibler divergence</p>
        </def>
      </def-item>
      <def-item>
        <term>
          <inline-formula id="IEq4">
            <alternatives>
              <tex-math id="M999">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{JS}$$\end{document}</tex-math>
              <mml:math id="M1000">
                <mml:msub>
                  <mml:mi>D</mml:mi>
                  <mml:mrow>
                    <mml:mi mathvariant="italic">JS</mml:mi>
                  </mml:mrow>
                </mml:msub>
              </mml:math>
              <inline-graphic xlink:href="13321_2018_287_Article_IEq4.gif"/>
            </alternatives>
          </inline-formula>
        </term>
        <def>
          <p id="Par18">Jensen–Shannon divergence</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Electronic supplementary material</bold>
      </p>
      <p>The online version of this article (10.1186/s13321-018-0287-6) contains supplementary material, which is available to authorized users.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Author's contributions</title>
    <p>YL formulated the concept and contributed to the implementation. YL wrote the manuscript, LZ and ZL reviewed and edited the manuscript. All authors read and approved the final manuscript.</p>
    <sec id="FPar1">
      <title>Acknowledgements</title>
      <p id="Par121">We would like to thank Xiaodong Dou for his help on the discussion of generated inhibitors of JNK3 and GSK3<italic>β</italic>. Thanks to Bo Yang who helped with the profiling of Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary Text 8.</p>
    </sec>
    <sec id="FPar2">
      <title>Competing interests</title>
      <p id="Par122">The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="d29e13754">
      <title>Availability of data and materials</title>
      <p>The materials supporing this article, including the source code, sampled molecules and pretrained models, are available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/kevinid/molecule_generator">https://github.com/kevinid/molecule_generator</ext-link>.</p>
    </sec>
    <sec id="FPar3">
      <title>Funding</title>
      <p id="Par123">This research was supported by the National Natural Science Foundation of China (Grant Nos. 81573273, 81673279 21572010 and 21772005), the National Major Scientific and Technological Special Project for “Significant New Drugs Development” (2018ZX09735001-003) and Beijing Natural Science Foundation (7172118).</p>
    </sec>
    <sec id="FPar4">
      <title>Ethics approval and consent to participate</title>
      <p id="Par124">Not applicable.</p>
    </sec>
    <sec id="FPar5">
      <title>Consent for publication</title>
      <p id="Par125">The authors declare no competing fnancial interests.</p>
    </sec>
    <sec id="d29e13779">
      <title>Publisher’s Note</title>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </sec>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schneider</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Fechner</surname>
            <given-names>U</given-names>
          </name>
        </person-group>
        <article-title>Computer-based de novo design of drug-like molecules</article-title>
        <source>Nat Rev Drug Discov</source>
        <year>2005</year>
        <volume>4</volume>
        <issue>8</issue>
        <fpage>649</fpage>
        <lpage>663</lpage>
        <pub-id pub-id-type="doi">10.1038/nrd1799</pub-id>
        <pub-id pub-id-type="pmid">16056391</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <mixed-citation publication-type="other">Gómez-Bombarelli R, Duvenaud D, Hernández-Lobato JM, Aguilera-Iparraguirre J, Hirzel TD, Adams RP, Aspuru-Guzik A (2016) Automatic chemical design using a data-driven continuous representation of molecules. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1610.02415v1">arXiv:1610.02415v1</ext-link></mixed-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Böhm</surname>
            <given-names>H-J</given-names>
          </name>
        </person-group>
        <article-title>The computer program ludi: a new method for the de novo design of enzyme inhibitors</article-title>
        <source>J Comput Aided Mol Des</source>
        <year>1992</year>
        <volume>6</volume>
        <issue>1</issue>
        <fpage>61</fpage>
        <lpage>78</lpage>
        <pub-id pub-id-type="doi">10.1007/BF00124387</pub-id>
        <pub-id pub-id-type="pmid">1583540</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mauser</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Stahl</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Chemical fragment spaces for de novo design</article-title>
        <source>J Chem Inf Model</source>
        <year>2007</year>
        <volume>47</volume>
        <issue>2</issue>
        <fpage>318</fpage>
        <lpage>324</lpage>
        <pub-id pub-id-type="doi">10.1021/ci6003652</pub-id>
        <pub-id pub-id-type="pmid">17300171</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reutlinger</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rodrigues</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Schneider</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Schneider</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Multi-objective molecular de novo design by adaptive fragment prioritization</article-title>
        <source>Angew Chem Int Ed</source>
        <year>2014</year>
        <volume>53</volume>
        <issue>16</issue>
        <fpage>4244</fpage>
        <lpage>4248</lpage>
        <pub-id pub-id-type="doi">10.1002/anie.201310864</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hiss</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Reutlinger</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Koch</surname>
            <given-names>CP</given-names>
          </name>
          <name>
            <surname>Perna</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Schneider</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Rodrigues</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Haller</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Folkers</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Weber</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Baleeiro</surname>
            <given-names>RB</given-names>
          </name>
        </person-group>
        <article-title>Combinatorial chemistry by ant colony optimization</article-title>
        <source>Future Med Chem</source>
        <year>2014</year>
        <volume>6</volume>
        <issue>3</issue>
        <fpage>267</fpage>
        <lpage>280</lpage>
        <pub-id pub-id-type="doi">10.4155/fmc.13.203</pub-id>
        <pub-id pub-id-type="pmid">24575965</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dey</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Caflisch</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Fragment-based de novo ligand design by multiobjective evolutionary optimization</article-title>
        <source>J Chem Inf Model</source>
        <year>2008</year>
        <volume>48</volume>
        <issue>3</issue>
        <fpage>679</fpage>
        <lpage>690</lpage>
        <pub-id pub-id-type="doi">10.1021/ci700424b</pub-id>
        <pub-id pub-id-type="pmid">18307332</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yuan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Pei</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lai</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Ligbuilder 2: a practical de novo drug design approach</article-title>
        <source>J Chem Inf Model</source>
        <year>2011</year>
        <volume>51</volume>
        <issue>5</issue>
        <fpage>1083</fpage>
        <lpage>1091</lpage>
        <pub-id pub-id-type="doi">10.1021/ci100350u</pub-id>
        <pub-id pub-id-type="pmid">21513346</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hartenfeller</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Proschak</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Schüller</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schneider</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Concept of combinatorial de novo design of drug-like molecules by particle swarm optimization</article-title>
        <source>Chem Biol Drug Des</source>
        <year>2008</year>
        <volume>72</volume>
        <issue>1</issue>
        <fpage>16</fpage>
        <lpage>26</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1747-0285.2008.00672.x</pub-id>
        <pub-id pub-id-type="pmid">18564216</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Goodfellow</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Bengio</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Courville</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <source>Deep learning</source>
        <year>2016</year>
        <publisher-loc>Massachusetts</publisher-loc>
        <publisher-name>MIT Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <mixed-citation publication-type="other">Lipton ZC, Berkowitz J, Elkan C (2015) A critical review of recurrent neural networks for sequence learning. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1506.00019">arXiv:1506.00019</ext-link></mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Segler</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Kogej</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tyrchan</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Waller</surname>
            <given-names>MP</given-names>
          </name>
        </person-group>
        <article-title>Generating focussed molecule libraries for drug discovery with recurrent neural networks</article-title>
        <source>ACS Cent Sci</source>
        <year>2018</year>
        <volume>4</volume>
        <issue>1</issue>
        <fpage>120</fpage>
        <lpage>130</lpage>
        <pub-id pub-id-type="doi">10.1021/acscentsci.7b00512</pub-id>
        <pub-id pub-id-type="pmid">29392184</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Olivecrona</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Blaschke</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Engkvist</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Molecular de-novo design through deep reinforcement learning</article-title>
        <source>J Cheminform</source>
        <year>2017</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>48</fpage>
        <pub-id pub-id-type="doi">10.1186/s13321-017-0235-x</pub-id>
        <pub-id pub-id-type="pmid">29086083</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">Cho K, Van Merrienboer B, Gulcehre C, Bahdanau D, Bougares F, Schwenk H, Bengio Y (2014) Learning phrase representations using RNN encoder–decoder for statistical machine translation. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1406.1078">arXiv:1406.1078</ext-link></mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gaulton</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bellis</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Bento</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Chambers</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Davies</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hersey</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Light</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>McGlinchey</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Michalovich</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Al-Lazikani</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Chembl: a large-scale bioactivity database for drug discovery</article-title>
        <source>Nucleic Acids Res</source>
        <year>2011</year>
        <volume>40</volume>
        <issue>D1</issue>
        <fpage>1100</fpage>
        <lpage>1107</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkr777</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Popova M, Isayev O, Tropsha A (2017) Deep reinforcement learning for de-novo drug design. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1711.10907">arXiv:1711.10907</ext-link></mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Kingma DP, Welling M (2013) Auto-encoding variational bayes. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1312.6114">arXiv:1312.6114</ext-link></mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>And</surname>
            <given-names>JJI</given-names>
          </name>
          <name>
            <surname>Shoichet</surname>
            <given-names>BK</given-names>
          </name>
        </person-group>
        <article-title>Zinc: a free database of commercially available compounds for virtual screening</article-title>
        <source>J Chem Inf Model</source>
        <year>2005</year>
        <volume>45</volume>
        <issue>1</issue>
        <fpage>177</fpage>
        <pub-id pub-id-type="doi">10.1021/ci049714+</pub-id>
        <pub-id pub-id-type="pmid">15667143</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blaschke</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Olivecrona</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Engkvist</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Bajorath</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Application of generative autoencoder in de novo molecular design</article-title>
        <source>Mol Inform</source>
        <year>2018</year>
        <volume>37</volume>
        <issue>1–2</issue>
        <fpage>1700123</fpage>
        <pub-id pub-id-type="doi">10.1002/minf.201700123</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <mixed-citation publication-type="other">Johnson DD (2017) Learning graphical state transitions. In: International conference on learning representations</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <mixed-citation publication-type="other">Simonovsky M, Komodakis N (2018) Graphvae: towards generation of small graphs using variational autoencoders. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1802.03480">arXiv:1802.03480</ext-link></mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Li Y, Vinyals O, Dyer C, Pascanu R, Battaglia P (2018) Learning deep generative models of graphs. In: International conference on learning representations</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">He K, Zhang X, Ren S, Sun J (2016) Identity mappings in deep residual networks. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1603.05027">arXiv:1603.05027</ext-link></mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Wu Z, Ramsundar B, Feinberg EN, Gomes J, Geniesse C, Pappu AS, Leswing K, Pande V (2018) Moleculenet: a benchmark for molecular machine learning. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1703.00564">arXiv:1703.00564</ext-link></mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <mixed-citation publication-type="other">Simonovsky M, Komodakis N (2017) Dynamic edge-conditioned filters in convolutional neural networks on graphs. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1704.02901">arXiv:1704.02901</ext-link></mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">Lima Guimaraes G, Sanchez-Lengeling B, Outeiral C, Cunha Farias PL, Aspuru-Guzik A (2017) Objective-reinforced generative adversarial networks (ORGAN) for sequence generation models. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1705.10843">arXiv:1705.10843</ext-link></mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Neil D, Segler M, Guasch L, Ahmed M, Plumbley D, Sellwood M, Brown N (2018) Exploring deep recurrent models with reinforcement learning for molecule design. In: International conference on learning representations</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Braese</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <source>Privileged scaffolds in medicinal chemistry:design, synthesis, evaluation</source>
        <year>2015</year>
        <publisher-loc>London</publisher-loc>
        <publisher-name>RSC Publishing</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bemis</surname>
            <given-names>GW</given-names>
          </name>
          <name>
            <surname>Murcko</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>The properties of known drugs. 1. Molecular frameworks</article-title>
        <source>J Med Chem</source>
        <year>1996</year>
        <volume>39</volume>
        <issue>15</issue>
        <fpage>2887</fpage>
        <lpage>2893</lpage>
        <pub-id pub-id-type="doi">10.1021/jm9602928</pub-id>
        <pub-id pub-id-type="pmid">8709122</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reis</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gaspar</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Milhazes</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Borges</surname>
            <given-names>FM</given-names>
          </name>
        </person-group>
        <article-title>Chromone as a privileged scaffold in drug discovery: recent advances</article-title>
        <source>J Med Chem</source>
        <year>2017</year>
        <volume>60</volume>
        <issue>19</issue>
        <fpage>7941</fpage>
        <lpage>7957</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jmedchem.6b01720</pub-id>
        <pub-id pub-id-type="pmid">28537720</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schuffenhauer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ertl</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Roggo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wetzel</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Koch</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Waldmann</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>The scaffold tree: visualization of the scaffold universe by hierarchical scaffold classification</article-title>
        <source>J Chem Inf Model</source>
        <year>2007</year>
        <volume>47</volume>
        <issue>1</issue>
        <fpage>47</fpage>
        <lpage>58</lpage>
        <pub-id pub-id-type="doi">10.1021/ci600338x</pub-id>
        <pub-id pub-id-type="pmid">17238248</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Varin</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Schuffenhauer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ertl</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Renner</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Mining for bioactive scaffolds with scaffold networks: improved compound set enrichment from primary screening data</article-title>
        <source>J Chem Inf Model</source>
        <year>2011</year>
        <volume>51</volume>
        <issue>7</issue>
        <fpage>1528</fpage>
        <lpage>1538</lpage>
        <pub-id pub-id-type="doi">10.1021/ci2000924</pub-id>
        <pub-id pub-id-type="pmid">21615076</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wishart</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Knox</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Shrivastava</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hassanali</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Stothard</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Woolsey</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Drugbank: a comprehensive resource for in silico drug discovery and exploration</article-title>
        <source>Nucleic Acids Res</source>
        <year>2006</year>
        <volume>34</volume>
        <issue>Database issue</issue>
        <fpage>668</fpage>
        <lpage>672</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkj067</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kadam</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Roy</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Recent trends in drug-likeness prediction: a comprehensive review of in silico methods</article-title>
        <source>Indian J Pharm Sci</source>
        <year>2007</year>
        <volume>69</volume>
        <issue>5</issue>
        <fpage>609</fpage>
        <pub-id pub-id-type="doi">10.4103/0250-474X.38464</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tian</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hou</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>The application of in silico drug-likeness predictions in pharmaceutical research</article-title>
        <source>Adv Drug Deliv Rev</source>
        <year>2015</year>
        <volume>86</volume>
        <fpage>2</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1016/j.addr.2015.01.009</pub-id>
        <pub-id pub-id-type="pmid">25666163</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ertl</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Schuffenhauer</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Estimation of synthetic accessibility score of drug-like molecules based on molecular complexity and fragment contributions</article-title>
        <source>J Cheminform</source>
        <year>2009</year>
        <volume>1</volume>
        <issue>1</issue>
        <fpage>8</fpage>
        <pub-id pub-id-type="doi">10.1186/1758-2946-1-8</pub-id>
        <pub-id pub-id-type="pmid">20298526</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bickerton</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Paolini</surname>
            <given-names>GV</given-names>
          </name>
          <name>
            <surname>Besnard</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Muresan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hopkins</surname>
            <given-names>AL</given-names>
          </name>
        </person-group>
        <article-title>Quantifying the chemical beauty of drugs</article-title>
        <source>Nat Chem</source>
        <year>2012</year>
        <volume>4</volume>
        <issue>2</issue>
        <fpage>90</fpage>
        <lpage>98</lpage>
        <pub-id pub-id-type="doi">10.1038/nchem.1243</pub-id>
        <pub-id pub-id-type="pmid">22270643</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <mixed-citation publication-type="other">RDKit: Open Source Cheminformatics. <ext-link ext-link-type="uri" xlink:href="http://www.rdkit.org/">http://www.rdkit.org/</ext-link></mixed-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koch</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gehringer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Laufer</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>Inhibitors of c-jun N-terminal kinases: an update</article-title>
        <source>J Med Chem</source>
        <year>2014</year>
        <volume>58</volume>
        <issue>1</issue>
        <fpage>72</fpage>
        <lpage>95</lpage>
        <pub-id pub-id-type="doi">10.1021/jm501212r</pub-id>
        <pub-id pub-id-type="pmid">25415535</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McCubrey</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Abrams</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Montalto</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Cervello</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Basecke</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Libra</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nicoletti</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Cocco</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Martelli</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>Diverse roles of gsk-3: tumor promoter-tumor suppressor, target in cancer therapy</article-title>
        <source>Adv Biol Regul</source>
        <year>2014</year>
        <volume>54</volume>
        <fpage>176</fpage>
        <pub-id pub-id-type="doi">10.1016/j.jbior.2013.09.013</pub-id>
        <pub-id pub-id-type="pmid">24169510</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Merget</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Turk</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Eid</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rippmann</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Fulle</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Profiling prediction of kinase inhibitors: toward the virtual assay</article-title>
        <source>J Med Chem</source>
        <year>2016</year>
        <volume>60</volume>
        <issue>1</issue>
        <fpage>474</fpage>
        <lpage>485</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jmedchem.6b01611</pub-id>
        <pub-id pub-id-type="pmid">27966949</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rogers</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hahn</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Extended-connectivity fingerprints</article-title>
        <source>J Chem Inf Model</source>
        <year>2010</year>
        <volume>50</volume>
        <issue>5</issue>
        <fpage>742</fpage>
        <lpage>754</lpage>
        <pub-id pub-id-type="doi">10.1021/ci100050t</pub-id>
        <pub-id pub-id-type="pmid">20426451</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sun</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jeliazkova</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Chupakhin</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Golib-Dzib</surname>
            <given-names>J-F</given-names>
          </name>
          <name>
            <surname>Engkvist</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Carlsson</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wegner</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ceulemans</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Georgiev</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Jeliazkov</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Excape-db: an integrated large scale dataset facilitating big data analysis in chemogenomics</article-title>
        <source>J Cheminform</source>
        <year>2017</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>17</fpage>
        <pub-id pub-id-type="doi">10.1186/s13321-017-0203-5</pub-id>
        <pub-id pub-id-type="pmid">28316655</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bolton</surname>
            <given-names>EE</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Thiessen</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Bryant</surname>
            <given-names>SH</given-names>
          </name>
        </person-group>
        <article-title>Pubchem: integrated platform of small molecules and biological activities</article-title>
        <source>Annu Rep Comput Chem</source>
        <year>2008</year>
        <volume>4</volume>
        <fpage>217</fpage>
        <lpage>241</lpage>
        <pub-id pub-id-type="doi">10.1016/S1574-1400(08)00012-1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <mixed-citation publication-type="other">Chen T, Li M, Li Y, Lin M, Wang N, Wang M, Xiao T, Xu B, Zhang C, Zhang Z (2015) Mxnet: A flexible and efficient machine learning library for heterogeneous distributed systems. CoRR abs/1512.01274</mixed-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <mixed-citation publication-type="other">Kingma D, Ba J (2014) Adam: a method for stochastic optimization. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1412.6980">arXiv:1412.6980</ext-link></mixed-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <mixed-citation publication-type="other">Bowman SR, Vilnis L, Vinyals O, Dai AM, Jozefowicz R, Bengio S (2015) Generating sentences from a continuous space. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1511.06349">arXiv:1511.06349</ext-link></mixed-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <mixed-citation publication-type="other">Chen X, Kingma DP, Salimans T, Duan Y, Dhariwal P, Schulman J, Sutskever I, Abbeel P (2016) Variational lossy autoencoder. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1611.02731">arXiv:1611.02731</ext-link></mixed-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <mixed-citation publication-type="other">Kingma DP, Salimans T, Jozefowicz R, Chen X, Sutskever I, Welling M Improved variational inference with inverse autoregressive flow. In: Advances in neural information processing systems, pp 4743–4751</mixed-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <mixed-citation publication-type="other">Goodfellow IJ, Pouget-Abadie J, Mirza M, Xu B, Warde-Farley D, Ozair S, Courville A, Bengio Y (2014) Generative adversarial networks. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1406.2661">arXiv:1406.2661</ext-link></mixed-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <mixed-citation publication-type="other">Im DJ, Ma AH, Taylor GW, Branson K (2018) Quantitatively evaluating GANs with divergences proposed for training. In: International conference on learning representations</mixed-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <mixed-citation publication-type="other">Jones E, Oliphant T, Peterson P et al (2001) SciPy: open source scientific tools for Python. <ext-link ext-link-type="uri" xlink:href="http://www.scipy.org/">http://www.scipy.org/</ext-link></mixed-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Scott</surname>
            <given-names>DW</given-names>
          </name>
        </person-group>
        <source>Multivariate density estimation: theory, practice, and visualization</source>
        <year>2008</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Wiley</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <mixed-citation publication-type="other">Benhenda M (2017) ChemGAN challenge for drug discovery: can AI reproduce natural chemical diversity? arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1708.08227">arXiv:1708.08227</ext-link></mixed-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Almansa</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gómez</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Cavalcanti</surname>
            <given-names>FL</given-names>
          </name>
          <name>
            <surname>de Arriba</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>García-Rafanell</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Forn</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Synthesis and structure: activity relationship of a new series of potent at1 selective angiotensin ii receptor antagonists: 5-(biphenyl-4-ylmethyl) pyrazoles</article-title>
        <source>J Med Chem</source>
        <year>1997</year>
        <volume>40</volume>
        <issue>4</issue>
        <fpage>547</fpage>
        <lpage>558</lpage>
        <pub-id pub-id-type="doi">10.1021/jm9604383</pub-id>
        <pub-id pub-id-type="pmid">9046346</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van der Maaten</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hinton</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Visualizing data using t-SNE</article-title>
        <source>J Mach Learn Res</source>
        <year>2008</year>
        <volume>9</volume>
        <issue>Nov</issue>
        <fpage>2579</fpage>
        <lpage>2605</lpage>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krenitsky</surname>
            <given-names>VP</given-names>
          </name>
          <name>
            <surname>Nadolny</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Delgado</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ayala</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Clareen</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Hilgraf</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Albers</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hegde</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>D’Sidocky</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Sapienza</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Discovery of cc-930, an orally active anti-fibrotic JNK inhibitor</article-title>
        <source>Bioorg Med Chem Lett</source>
        <year>2012</year>
        <volume>22</volume>
        <issue>3</issue>
        <fpage>1433</fpage>
        <lpage>1438</lpage>
        <pub-id pub-id-type="doi">10.1016/j.bmcl.2011.12.027</pub-id>
        <pub-id pub-id-type="pmid">22244937</pub-id>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Probst</surname>
            <given-names>GD</given-names>
          </name>
          <name>
            <surname>Bowers</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sealy</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Truong</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Hom</surname>
            <given-names>RK</given-names>
          </name>
          <name>
            <surname>Galemmo</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Konradi</surname>
            <given-names>AW</given-names>
          </name>
          <name>
            <surname>Sham</surname>
            <given-names>HL</given-names>
          </name>
          <name>
            <surname>Quincy</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Pan</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Highly selective c-jun N-terminal kinase (JNK) 2 and 3 inhibitors with in vitro CNS-like pharmacokinetic properties prevent neurodegeneration</article-title>
        <source>Bioorg Med Chem Lett</source>
        <year>2011</year>
        <volume>21</volume>
        <issue>1</issue>
        <fpage>315</fpage>
        <lpage>319</lpage>
        <pub-id pub-id-type="doi">10.1016/j.bmcl.2010.11.010</pub-id>
        <pub-id pub-id-type="pmid">21112785</pub-id>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Osolodkin</surname>
            <given-names>DI</given-names>
          </name>
          <name>
            <surname>Palyulin</surname>
            <given-names>VA</given-names>
          </name>
          <name>
            <surname>Zefirov</surname>
            <given-names>NS</given-names>
          </name>
        </person-group>
        <article-title>Glycogen synthase kinase 3 as an anticancer drug target: novel experimental findings and trends in the design of inhibitors</article-title>
        <source>Curr Pharm Des</source>
        <year>2013</year>
        <volume>19</volume>
        <issue>4</issue>
        <fpage>665</fpage>
        <lpage>679</lpage>
        <pub-id pub-id-type="doi">10.2174/138161213804581972</pub-id>
        <pub-id pub-id-type="pmid">23016861</pub-id>
      </element-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <mixed-citation publication-type="other">Kingma DP, Mohamed S, Rezende DJ, Welling M Semi-supervised learning with deep generative models. In: Advances in neural information processing systems, pp 3581–3589</mixed-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <mixed-citation publication-type="other">Siddharth N, Paige B, de Meent V, Desmaison A, Wood F, Goodman ND, Kohli P, Torr PH (2017) Learning disentangled representations with semi-supervised deep generative models. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1706.00400">arXiv:1706.00400</ext-link></mixed-citation>
    </ref>
  </ref-list>
</back>
