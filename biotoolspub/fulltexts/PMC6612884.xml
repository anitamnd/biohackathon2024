<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6612884</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btz315</article-id>
    <article-id pub-id-type="publisher-id">btz315</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Ismb/Eccb 2019 Conference Proceedings</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Systems Biology and Networks</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Bayesian metabolic flux analysis reveals intracellular flux couplings</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Heinonen</surname>
          <given-names>Markus</given-names>
        </name>
        <xref ref-type="aff" rid="btz315-aff1">1</xref>
        <xref ref-type="aff" rid="btz315-aff2">2</xref>
        <xref ref-type="corresp" rid="btz315-cor1"/>
        <xref ref-type="author-notes" rid="btz315-FM2"/>
        <!--<email>markus.o.heinonen@aalto.fi</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Osmala</surname>
          <given-names>Maria</given-names>
        </name>
        <xref ref-type="aff" rid="btz315-aff1">1</xref>
        <xref ref-type="author-notes" rid="btz315-FM2"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mannerström</surname>
          <given-names>Henrik</given-names>
        </name>
        <xref ref-type="aff" rid="btz315-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wallenius</surname>
          <given-names>Janne</given-names>
        </name>
        <xref ref-type="aff" rid="btz315-aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kaski</surname>
          <given-names>Samuel</given-names>
        </name>
        <xref ref-type="aff" rid="btz315-aff1">1</xref>
        <xref ref-type="aff" rid="btz315-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rousu</surname>
          <given-names>Juho</given-names>
        </name>
        <xref ref-type="aff" rid="btz315-aff1">1</xref>
        <xref ref-type="aff" rid="btz315-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lähdesmäki</surname>
          <given-names>Harri</given-names>
        </name>
        <xref ref-type="aff" rid="btz315-aff1">1</xref>
      </contrib>
    </contrib-group>
    <aff id="btz315-aff1"><label>1</label>Department of Computer Science, Aalto University, Espoo, Finland</aff>
    <aff id="btz315-aff2"><label>2</label>Helsinki Institute for Information Technology, Espoo, Finland</aff>
    <aff id="btz315-aff3"><label>3</label>Institute for Molecular Medicine Finland, Helsinki, Finland</aff>
    <author-notes>
      <corresp id="btz315-cor1">To whom correspondence should be addressed. <email>markus.o.heinonen@aalto.fi</email></corresp>
      <fn id="btz315-FM2">
        <p>The authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>7</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2019-07-05">
      <day>05</day>
      <month>7</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>05</day>
      <month>7</month>
      <year>2019</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>35</volume>
    <issue>14</issue>
    <fpage>i548</fpage>
    <lpage>i557</lpage>
    <permissions>
      <copyright-statement>© The Author(s) 2019. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btz315.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Metabolic flux balance analysis (FBA) is a standard tool in analyzing metabolic reaction rates compatible with measurements, steady-state and the metabolic reaction network stoichiometry. Flux analysis methods commonly place model assumptions on fluxes due to the convenience of formulating the problem as a linear programing model, while many methods do not consider the inherent uncertainty in flux estimates.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We introduce a novel paradigm of Bayesian metabolic flux analysis that models the reactions of the whole genome-scale cellular system in probabilistic terms, and can infer the full flux vector distribution of genome-scale metabolic systems based on exchange and intracellular (e.g. 13C) flux measurements, steady-state assumptions, and objective function assumptions. The Bayesian model couples all fluxes jointly together in a simple truncated multivariate posterior distribution, which reveals informative flux couplings. Our model is a plug-in replacement to conventional metabolic balance methods, such as FBA. Our experiments indicate that we can characterize the genome-scale flux covariances, reveal flux couplings, and determine more intracellular unobserved fluxes in <italic>Clostridium acetobutylicum</italic> from 13C data than flux variability analysis.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The COBRA compatible software is available at <ext-link ext-link-type="uri" xlink:href="http://github.com/markusheinonen/bamfa">github.com/markusheinonen/bamfa</ext-link>.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Academy of Finland Center of Excellence in Systems Immunology and Physiology, the Academy of Finland</named-content>
        </funding-source>
        <award-id>299915</award-id>
        <award-id>313271</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Innovation Tekes</named-content>
        </funding-source>
        <award-id>40128/14</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Finnish Cultural Foundation</named-content>
          <named-content content-type="funder-identifier">10.13039/501100003125</named-content>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Metabolic modeling considers networks of up to thousands of chemical reactions that transform metabolite molecules within cellular organisms (<xref rid="btz315-B35" ref-type="bibr">Palsson, 2015</xref>). The key problem of metabolism is estimation of the reaction rates, or fluxes, of the system of the highly interdependent intracellular fluxes from measurements of few exchange fluxes that transfer nutrients or products between the external medium and the cell.</p>
    <p>The dominant approach to flux estimation is the celebrated flux balance analysis (FBA) framework that finds reaction rates that maximize pre-specified cellular growth or other target objective function (<xref rid="btz315-B12" ref-type="bibr">Feist and Palsson, 2010</xref>), while assuming the cell is in a steady-state, where concentrations of intracellular metabolites do not change (<xref rid="btz315-B1" ref-type="bibr">Almaas <italic>et al.</italic>, 2004</xref>). Such FBA problem can be casted as a convenient and computationally efficient linear programing problem of solving a system of linear steady-state constraints while maximizing a linear target objective (<xref rid="btz315-B32" ref-type="bibr">Orth <italic>et al.</italic>, 2010</xref>), and where flux measurements can be encoded as constraints to the fluxes (<xref rid="btz315-B8" ref-type="bibr">Carreira <italic>et al.</italic>, 2014</xref>). FBA is commonly used to characterize intra-cellular fluxes in various simulated objective conditions (<xref rid="btz315-B30" ref-type="bibr">Mo <italic>et al.</italic>, 2010</xref>). In metabolic flux analysis (MFA) values of unknown fluxes are directly estimated based on measurements of some determined fluxes without explicit maximal growth or other objective assumption (<xref rid="btz315-B23" ref-type="bibr">Kim <italic>et al.</italic>, 2008</xref>). In both approaches a point estimate for up to thousands of highly interdependent fluxes are determined (<xref rid="btz315-B5" ref-type="bibr">Bordbar <italic>et al.</italic>, 2014</xref>).</p>
    <p>The standard metabolic analyses contain three major model assumptions that warrant careful methodological protocol to achieve biologically meaningful results. First, the exact steady-state constraint can be an unrealistic assumption since metabolites can accumulate or deplete to adapt to dynamic situations, such as during responses to changing nutrient conditions (<xref rid="btz315-B27" ref-type="bibr">MacGillivray <italic>et al.</italic>, 2017</xref>; <xref rid="btz315-B34" ref-type="bibr">Pakula <italic>et al.</italic>, 2016</xref>). Second, in FBA maximal growth (or other target objective) is often assumed as a constraint, while it only holds at the highest growth phase in practise. Third, due to a large number of metabolic reactions and limited number of experimental data, flux point estimates commonly used in the field ignore the notable uncertainty involved in FBA and MFA solutions. The flux variances are key in characterizing metabolic systems and uncertainties emerging from the use of insufficient and noisy data.</p>
    <p>Numerous separate extensions to flux analysis have been introduced to alleviate these three assumptions. The robust FBA framework considers the effect of measurement uncertainties to the maximal growth (<xref rid="btz315-B43" ref-type="bibr">Zavlanos and Julius, 2011</xref>). The steady-state assumption was recently relaxed by the robust analysis of metabolic pathways (RAMP) model (<xref rid="btz315-B27" ref-type="bibr">MacGillivray <italic>et al.</italic>, 2017</xref>). In contrast to point flux estimates of FBA and MFA, the flux variability analysis (FVA) characterizes the sensitivity of the objective function to independent flux perturbations, resulting in upper and lower bounds around the FBA solution (<xref rid="btz315-B16" ref-type="bibr">Gudmundsson and Thiele, 2010</xref>; <xref rid="btz315-B28" ref-type="bibr">Mahadevan and Schilling, 2003</xref>). In principal flux mode analysis, the eigenvectors of steady-state flux cone characterize the flux variability (<xref rid="btz315-B4" ref-type="bibr">Bhadra <italic>et al.</italic>, 2018</xref>). Alternatively the solution space of the fluxes can be sampled (<xref rid="btz315-B38" ref-type="bibr">Schellenberger <italic>et al.</italic>, 2010</xref>) by considering only optimal fluxes from border of the flux hypercone (<xref rid="btz315-B6" ref-type="bibr">Bordel <italic>et al.</italic>, 2010</xref>) or by sampling also inoptimal fluxes from the inside the hypercone (<xref rid="btz315-B30" ref-type="bibr">Mo <italic>et al.</italic>, 2010</xref>; <xref rid="btz315-B36" ref-type="bibr">Saa and Nielsen, 2016a</xref>). The sampling methods use the hit-and-run formalism (<xref rid="btz315-B40" ref-type="bibr">Smith, 1984</xref>) as either the artificially centered hit-and-run (ACHR) (<xref rid="btz315-B22" ref-type="bibr">Kaufman and Smith, 1998</xref>; <xref rid="btz315-B29" ref-type="bibr">Megchelenbrink <italic>et al.</italic>, 2014</xref>) or the coordinate hit-and-run with rounding (CCHR) (<xref rid="btz315-B17" ref-type="bibr">Haraldsdóttir <italic>et al.</italic>, 2017</xref>) sampling algorithms to cope with the large flux space. A related approach uses possibility calculus (<xref rid="btz315-B10" ref-type="bibr">Dubois <italic>et al.</italic>, 1996</xref>) to iteratively refine the estimate of possible and impossible flux states (<xref rid="btz315-B26" ref-type="bibr">Llaneras <italic>et al.</italic>, 2009</xref>).</p>
    <p>Bayesian methods have been scarcely applied in flux analysis. Small-scale Bayesian construction of kinetics was proposed by <xref rid="btz315-B37" ref-type="bibr">Saa and Nielsen (2016b</xref>). The Metabolica method proposed modeling distributions of fluxes of skeletal muscle metabolism (<xref rid="btz315-B18" ref-type="bibr">Heino <italic>et al.</italic>, 2007</xref>, <xref rid="btz315-B19" ref-type="bibr">2010</xref>), but did not include modeling of target objectives or genome-scale metabolic models. Bayesian methods have also been developed for 13C labeling data (<xref rid="btz315-B21" ref-type="bibr">Kadirkamanathan <italic>et al.</italic>, 2006</xref>; <xref rid="btz315-B41" ref-type="bibr">Theorell <italic>et al.</italic>, 2017</xref>) by assuming fixed steady-state and without incorporating any target objectives.</p>
    <p>In this article, we treat all three model assumptions simultaneously by introducing a novel paradigm of Bayesian MFA where the genome-scale, interdependent flux vector distributions are estimated. Our model allows probabilistic relaxation of steady-state and target objective constraints. In contrast to earlier uniform sampling approaches, we place priors on flux distributions, and estimate posterior distributions that characterize and quantify the probability of all flux states that are compatible with flux measurements, steady-state assumption and stoichiometry. Our model reveals flux dependencies in explicit form and characterizes the full space of flux states in principled fashion. The Bayesian flux analysis can be used as a drop-in replacement to standard FBA, MFA, FVA and sampling methods. We provide public implementation of the Bayesian flux analysis using the standard COBRA framework (<xref rid="btz315-B3" ref-type="bibr">Becker <italic>et al.</italic>, 2007</xref>; <xref rid="btz315-B39" ref-type="bibr">Schellenberger <italic>et al.</italic>, 2011</xref>).</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>The goal of this article is a probabilistic formulation of static steady-state metabolic systems that can be applied to whole genome MFA, FBA and FVA. We propose the Bayesian method as a direct replacement to these classic FBA, MFA and FVA tools. We start by assuming a metabolic system of M metabolites and N reactions has been characterized by a constant stoichiometric matrix <inline-formula id="IE1"><mml:math id="IM1"><mml:mrow><mml:mi>S</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">Z</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, where the rows denote metabolite participations in all reactions, while the columns denote reactants and products of metabolites by individual reactions. The flux vector <inline-formula id="IE2"><mml:math id="IM2"><mml:mrow><mml:mi mathvariant="bold">v</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> denotes the reaction rates of the system. The steady-state equation can be stated as
<disp-formula id="E1"><mml:math id="M1"><mml:mrow><mml:mi>S</mml:mi><mml:mi mathvariant="bold">v</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
which encodes that metabolite concentration changes <inline-formula id="IE3"><mml:math id="IM3"><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:mover></mml:mstyle><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mi>M</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> are zero and hence the metabolite concentrations <inline-formula id="IE4"><mml:math id="IM4"><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mi>M</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> do not change. Throughout the article, we assume a subset of fluxes have been observed or determined (for instance, some of the exchange fluxes), while the remaining fluxes are unknown. Our goal is to infer the distribution of all unknown fluxes given the observed fluxes, the steady-state constraints and the flux lower and upper bounds.</p>
    <sec>
      <title>2.1 Bayesian metabolic model</title>
      <p>We formulate a Bayesian flux model (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> for a graphical model), which starts by assuming multivariate Gaussian priors for fluxes as
<disp-formula id="E2"><mml:math id="M2"><mml:mrow><mml:mi mathvariant="bold">v</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow><mml:mi>v</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow><mml:mi>v</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>Σ</mml:mo></mml:mrow><mml:mi>v</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
with means <inline-formula id="IE5"><mml:math id="IM5"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow><mml:mi>v</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> and diagonal covariances <inline-formula id="IE6"><mml:math id="IM6"><mml:mrow><mml:msub><mml:mrow><mml:mo>Σ</mml:mo></mml:mrow><mml:mi>v</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="italic">diag</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mi mathvariant="italic">v</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="italic">diag</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:mrow><mml:mi mathvariant="italic">N</mml:mi></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. The prior means are set to zero, or to the closest value to zero considering the flux upper and lower bounds. The variances <inline-formula id="IE7"><mml:math id="IM7"><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are hyperparameters that characterize the a priori values the flux can take. The prior distribution converges towards an uninformative uniform prior as the prior variances increase.</p>
      <p>We assume a Gaussian prior also for the metabolite changes
<disp-formula id="E3"><mml:math id="M3"><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:mover><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow><mml:mrow><mml:mstyle><mml:mover><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:mover></mml:mstyle></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mrow><mml:mstyle><mml:mover><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:mover></mml:mstyle></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>Σ</mml:mo></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE8"><mml:math id="IM8"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mi>M</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> are the a priori mean accumulations or depletions of metabolite species. The diagonal covariances <inline-formula id="IE9"><mml:math id="IM9"><mml:mrow><mml:msub><mml:mrow><mml:mo>Σ</mml:mo></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="italic">diag</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mrow><mml:mstyle><mml:mover><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="italic">diag</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mstyle><mml:mover><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mstyle><mml:mover><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mi>M</mml:mi></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> encode the variances around prior metabolite changes. In strict steady-state, the prior for metabolite change becomes Dirac’s delta function at zero. By increasing the variances <inline-formula id="IE10"><mml:math id="IM10"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mrow><mml:mstyle><mml:mover><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> we can relax the steady-state assumption on individual metabolites, and encode allowance for accumulations or depletions of them.</p>
      <p>The joint distribution of fluxes <inline-formula id="IE11"><mml:math id="IM11"><mml:mi mathvariant="bold">v</mml:mi></mml:math></inline-formula> and metabolite changes <inline-formula id="IE12"><mml:math id="IM12"><mml:mrow><mml:mstyle><mml:mover><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:mover></mml:mstyle></mml:mrow></mml:math></inline-formula> can now be stated as a joint multivariate Gaussian distribution
<disp-formula id="E4"><mml:math id="M4"><mml:mrow><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi mathvariant="bold">v</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mstyle><mml:mover><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:mover></mml:mstyle></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi mathvariant="bold">v</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>S</mml:mi><mml:mi mathvariant="bold">v</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow><mml:mi>v</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow><mml:mi>v</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mo>Σ</mml:mo></mml:mrow><mml:mi>v</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mo>Σ</mml:mo></mml:mrow><mml:mi>v</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mrow><mml:mo>Σ</mml:mo></mml:mrow><mml:mi>v</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mrow><mml:mo>Σ</mml:mo></mml:mrow><mml:mi>v</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
that encodes the exact (We add small numerical tolerance κI within the inverse to ensure invertibility of the matrix.) relation <inline-formula id="IE13"><mml:math id="IM13"><mml:mrow><mml:mi>S</mml:mi><mml:mi mathvariant="bold">v</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mstyle><mml:mover><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:mover></mml:mstyle></mml:mrow></mml:mrow></mml:math></inline-formula>. The conditional distribution of fluxes given a specific realization of metabolite changes <inline-formula id="IE14"><mml:math id="IM14"><mml:mrow><mml:mstyle><mml:mover><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:mover></mml:mstyle></mml:mrow></mml:math></inline-formula> (e.g. <inline-formula id="IE15"><mml:math id="IM15"><mml:mn>0</mml:mn></mml:math></inline-formula>) is then from standard Gaussian identities
<disp-formula id="E5"><mml:math id="M5"><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="bold">v</mml:mi><mml:mo>|</mml:mo><mml:mrow><mml:mstyle><mml:mover><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:mover></mml:mstyle></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow><mml:mi>v</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo>Σ</mml:mo></mml:mrow><mml:mi>v</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:msub><mml:mrow><mml:mo>Σ</mml:mo></mml:mrow><mml:mi>v</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mstyle><mml:mover><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mo>−</mml:mo><mml:mi>S</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow><mml:mi>v</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>Σ</mml:mo></mml:mrow><mml:mi>v</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>Σ</mml:mo></mml:mrow><mml:mi>v</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:msub><mml:mrow><mml:mo>Σ</mml:mo></mml:mrow><mml:mi>v</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>S</mml:mi><mml:msub><mml:mrow><mml:mo>Σ</mml:mo></mml:mrow><mml:mi>v</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"/><mml:mtd columnalign="left"><mml:mrow><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow><mml:mi>v</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mstyle><mml:mover><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mo>−</mml:mo><mml:mi>S</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow><mml:mi>v</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>Σ</mml:mo></mml:mrow><mml:mi>v</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi mathvariant="italic">AS</mml:mi><mml:msub><mml:mrow><mml:mo>Σ</mml:mo></mml:mrow><mml:mi>v</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE16"><mml:math id="IM16"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>Σ</mml:mo></mml:mrow><mml:mi>v</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:msub><mml:mrow><mml:mo>Σ</mml:mo></mml:mrow><mml:mi>v</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. Since we do not in general have access to exact metabolite change values <inline-formula id="IE17"><mml:math id="IM17"><mml:mrow><mml:mstyle><mml:mover><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:mover></mml:mstyle></mml:mrow></mml:math></inline-formula>, we marginalize the conditional flux distribution over the change prior distribution <inline-formula id="IE18"><mml:math id="IM18"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mstyle><mml:mover><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> resulting in
<disp-formula id="E6"><label>(1)</label><mml:math id="M6"><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">v</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mrow><mml:mstyle><mml:mover><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:mover></mml:mstyle></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>∫</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">v</mml:mi><mml:mo>|</mml:mo><mml:mrow><mml:mstyle><mml:mover><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mstyle><mml:mover><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mrow><mml:mstyle><mml:mover><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:mover></mml:mstyle></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">v</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE19"><mml:math id="IM19"><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow><mml:mrow><mml:mstyle><mml:mover><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:mover></mml:mstyle></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi mathvariant="italic">S</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow><mml:mi mathvariant="italic">v</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE20"><mml:math id="IM20"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>Σ</mml:mo></mml:mrow><mml:mi>v</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi mathvariant="italic">AS</mml:mi><mml:msub><mml:mrow><mml:mo>Σ</mml:mo></mml:mrow><mml:mi>v</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>A</mml:mi><mml:msub><mml:mrow><mml:mo>Σ</mml:mo></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>.</p>
    </sec>
    <sec>
      <title>2.2 Conditioning the model with observations</title>
      <p>Assume we have access to noisy observations <inline-formula id="IE21"><mml:math id="IM21"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mi>o</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mi>o</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mo>ε</mml:mo></mml:mrow></mml:math></inline-formula> from a subset of observed fluxes <inline-formula id="IE22"><mml:math id="IM22"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mi>o</mml:mi></mml:msub><mml:mo>⊂</mml:mo><mml:mi mathvariant="bold">v</mml:mi></mml:mrow></mml:math></inline-formula>. The observations can be empirical measurements, 13C flux estimations, or flux hypotheses determined by the user. We assume independent additive Gaussian noise <inline-formula id="IE23"><mml:math id="IM23"><mml:mrow><mml:msub><mml:mrow><mml:mo>ε</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mo>ω</mml:mo></mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> with variances collected in a matrix <inline-formula id="IE24"><mml:math id="IM24"><mml:mrow><mml:msub><mml:mrow><mml:mo>Ω</mml:mo></mml:mrow><mml:mi>o</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="italic">diag</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mo>ω</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mo>ω</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">obs</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, and hence the likelihood of observed fluxes is
<disp-formula id="E7"><mml:math id="M7"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mi>o</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mi>o</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">ω</mml:mi></mml:mrow><mml:mi>o</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mi>o</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mi>o</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>Ω</mml:mo></mml:mrow><mml:mi>o</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p>The joint distribution of all fluxes <inline-formula id="IE25"><mml:math id="IM25"><mml:mi mathvariant="bold">v</mml:mi></mml:math></inline-formula> and noisy flux observations <inline-formula id="IE26"><mml:math id="IM26"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mi>o</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is now
<disp-formula id="E8"><mml:math id="M8"><mml:mrow><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi mathvariant="bold">v</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mi>o</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mo>ε</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi mathvariant="bold">v</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mi>o</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mo mathvariant="bold">μ</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mo mathvariant="bold">μ</mml:mo></mml:mrow><mml:mi>o</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">NN</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">No</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">oN</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">oo</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo>Ω</mml:mo></mml:mrow><mml:mi>o</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
which gives a conditional distribution of all fluxes given the observations as
<disp-formula id="E9"><label>(2)</label><mml:math id="M9"><mml:mrow><mml:mi mathvariant="bold">v</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mi>o</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">No</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>y</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mi>o</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mi>o</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">No</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>y</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">oN</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE27"><mml:math id="IM27"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">oo</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo>Ω</mml:mo></mml:mrow><mml:mi>o</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the noisy covariance, CNN is the full <inline-formula id="IE28"><mml:math id="IM28"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> covariance matrix, <inline-formula id="IE29"><mml:math id="IM29"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">No</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">oN</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> is the <inline-formula id="IE30"><mml:math id="IM30"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">obs</mml:mtext></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> covariance matrix between observed fluxes and all fluxes, and Coo is the <inline-formula id="IE31"><mml:math id="IM31"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">obs</mml:mtext></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">obs</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> covariance matrix between observed fluxes. Note that observed fluxes are in both <inline-formula id="IE32"><mml:math id="IM32"><mml:mi mathvariant="bold">v</mml:mi></mml:math></inline-formula> and in <inline-formula id="IE33"><mml:math id="IM33"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mi>o</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. Note also that the model works with no observations at all as the conditional distribution in <xref ref-type="disp-formula" rid="E9">Equation (2)</xref> reduces back to the prior in <xref ref-type="disp-formula" rid="E6">Equation (1)</xref>.</p>
      <p>Finally, we add the flux upper and lower bounds by truncating the distribution with the known flux lower lb and upper ub bounds resulting in the final truncated normal flux posterior
<disp-formula id="E10"><mml:math id="M10"><mml:mrow><mml:mi mathvariant="bold">v</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mi>o</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">T</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">No</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>y</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mi>o</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mi>o</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">No</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>y</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">oN</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="italic">lb</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">ub</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p>The posterior encodes the distribution of bounded fluxes that are compatible with the flux observations, flux priors, and where steady-state applies according to the tolerances determined by the steady-state prior means <inline-formula id="IE34"><mml:math id="IM34"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and variances <inline-formula id="IE35"><mml:math id="IM35"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mrow><mml:mstyle><mml:mover><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>.</p>
      <p>The derived flux posterior is an unimodal truncated multivariate normal (TMVN) distribution where flux dependencies are represented through the covariance matrix <italic>C</italic>, which encodes all flux relationships with high rank. The flux posterior as a whole characterizes the distribution of all valid flux vectors. The main characterizations of interest are the individual flux distributions (the marginals) and flux combination distributions (multi-variate marginals). Marginals of TMVN’s are not analytically tractable, nor are they TMVN distributions (<xref rid="btz315-B20" ref-type="bibr">Horrace, 2005</xref>). We resort to Markov Chain Monte Carlo (MCMC) sampling from the TMVN flux distribution to reveal individual flux, flux pair or flux group distributions.</p>
    </sec>
    <sec>
      <title>2.3 Gibbs sampling truncated MVN’s</title>
      <p>A recent review summarizes sampling approaches for TMVNca (<xref rid="btz315-B2" ref-type="bibr">Altmann <italic>et al.</italic>, 2014</xref>). The conditionals of TMVNhe are still TMVNs (<xref rid="btz315-B20" ref-type="bibr">Horrace, 2005</xref>), which has led to many Gibbs-based samplers (<xref rid="btz315-B11" ref-type="bibr">Emery <italic>et al.</italic>, 2014</xref>; <xref rid="btz315-B15" ref-type="bibr">Geweke, 1991</xref>; <xref rid="btz315-B20" ref-type="bibr">Horrace, 2005</xref>; <xref rid="btz315-B24" ref-type="bibr">Kotecha and Djuric, 1999</xref>; <xref rid="btz315-B25" ref-type="bibr">Li and Ghosh, 2015</xref>). In addition, Hamiltonian Monte Carlo samplers (<xref rid="btz315-B33" ref-type="bibr">Pakman and Paninski, 2014</xref>) have been proposed, while elliptical slice samplers would also fit well to the problem (<xref rid="btz315-B31" ref-type="bibr">Murray <italic>et al.</italic>, 2010</xref>). We experimented with the three main approaches, and found out that Gibbs sampling has consistently the best performance in genome-scale metabolic models up to 4000 fluxes (data not shown). In the remainder of the article we apply Gibbs sampling.</p>
      <p>To sample the distribution <inline-formula id="IE36"><mml:math id="IM36"><mml:mrow><mml:mi mathvariant="bold">v</mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="script">T</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">lb</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">ub</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> we begin by transforming it into whitened domain by Cholesky decomposition <inline-formula id="IE37"><mml:math id="IM37"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mi>L</mml:mi><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> with transformed fluxes <inline-formula id="IE38"><mml:math id="IM38"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">v</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">v</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> with white distribution <inline-formula id="IE39"><mml:math id="IM39"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">v</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover><mml:mo>∼</mml:mo><mml:mi mathvariant="script">T</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>I</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">a</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE40"><mml:math id="IM40"><mml:mrow><mml:mi mathvariant="bold">a</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="italic">lb</mml:mi><mml:mo>−</mml:mo><mml:mi>L</mml:mi><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE41"><mml:math id="IM41"><mml:mrow><mml:mi mathvariant="bold">b</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="italic">ub</mml:mi><mml:mo>−</mml:mo><mml:mi>L</mml:mi><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow></mml:math></inline-formula>. We sample from the univariate conditional distributions
<disp-formula id="E11"><label>(3)</label><mml:math id="M11"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">v</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">T</mml:mi><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">v</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">v</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
which is a standard Normal with bounds in the white domain are (We refer to <xref rid="btz315-B25" ref-type="bibr">Li and Ghosh, 2015</xref>; for detailed explanation):
<disp-formula id="E12"><mml:math id="M12"><mml:mtable><mml:mtr><mml:mtd><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">v</mml:mi><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>max</mml:mi><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:munder><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ji</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">v</mml:mi><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ji</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:munder><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ji</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">l</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">v</mml:mi><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ji</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>b</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">v</mml:mi><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>max</mml:mi><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:munder><mml:mrow><mml:mi>min</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ji</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">l</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">v</mml:mi><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ji</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:munder><mml:mrow><mml:mi>min</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ji</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">l</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">v</mml:mi><mml:mo stretchy="true">˜</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ji</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
      <p>The bounds are functions of the remaining (whitened) fluxes <inline-formula id="IE42"><mml:math id="IM42"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">v</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and need to be updated after each change to flux values. We iteratively update each whitened flux <inline-formula id="IE43"><mml:math id="IM43"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> by sampling a new value from the conditional distribution <inline-formula id="IE44"><mml:math id="IM44"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">v</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> with the minimax tilting method (<xref rid="btz315-B7" ref-type="bibr">Botev, 2016</xref>), which we found out to outperform the alternative Chopin’s algorithm (<xref rid="btz315-B9" ref-type="bibr">Chopin, 2011</xref>). Finally, we transform the whitened variables back into original domain by <inline-formula id="IE45"><mml:math id="IM45"><mml:mrow><mml:mi mathvariant="bold">v</mml:mi><mml:mo>=</mml:mo><mml:mi>L</mml:mi><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">v</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow></mml:math></inline-formula>.</p>
      <p>We notice that the method of <xref rid="btz315-B25" ref-type="bibr">Li and Ghosh (2015)</xref> can be further optimized by running multiple chains in parallel by considering a flux sample matrix <inline-formula id="IE46"><mml:math id="IM46"><mml:mrow><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">v</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mn>1</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">v</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> containing whitened flux vector chains <inline-formula id="IE47"><mml:math id="IM47"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">v</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mi>c</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>. The bound function is then represented as
<disp-formula id="E13"><mml:math id="M13"><mml:mtable><mml:mtr><mml:mtd><mml:mi mathvariant="bold">a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>max</mml:mi><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:munder><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ji</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:mi mathvariant="bold">a</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ji</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:munder><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ji</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:mi mathvariant="bold">b</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ji</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi mathvariant="bold">b</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>max</mml:mi><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:munder><mml:mrow><mml:mi>min</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ji</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:mi mathvariant="bold">b</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ji</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:munder><mml:mrow><mml:mi>min</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ji</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:mi mathvariant="bold">a</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ji</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
where <inline-formula id="IE48"><mml:math id="IM48"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the sample matrix <inline-formula id="IE49"><mml:math id="IM49"><mml:mrow><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> without the ith row, <inline-formula id="IE50"><mml:math id="IM50"><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mo>:</mml:mo><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the Cholesky matrix without the ith column. By sampling several chains in parallel with one CPU node we can utilize the full bandwidth of the CPU. This is especially useful for Gibbs sampling.</p>
    </sec>
    <sec>
      <title>2.4 Sampling the flux posterior</title>
      <p>We set the initial flux vector <inline-formula id="IE51"><mml:math id="IM51"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mrow><mml:mtext>MAP</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>arg</mml:mtext><mml:msub><mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mtext>max</mml:mtext></mml:mrow></mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:msub><mml:mi mathvariant="italic">p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> to the maximum a posteriori of the truncated normal distribution, which we compute using quadratic programing. The truncated normal distribution is unimodal, and hence we begin sampling from the mode of the distribution providing efficient optimization.</p>
      <p>The fluxes can be arranged into distinct bounded fluxes <inline-formula id="IE52"><mml:math id="IM52"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and unbounded fluxes <inline-formula id="IE53"><mml:math id="IM53"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mi>u</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE54"><mml:math id="IM54"><mml:mrow><mml:mi mathvariant="bold">v</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mi>u</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>. The conditional distribution of a truncated normal is still a truncated normal (<xref rid="btz315-B20" ref-type="bibr">Horrace, 2005</xref>). We only need to sample the bounded fluxes <inline-formula id="IE55"><mml:math id="IM55"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> with Gibbs MCMC, and afterwards the distribution of unbounded fluxes <inline-formula id="IE56"><mml:math id="IM56"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mi>u</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> conditioned on the bounded flux samples <inline-formula id="IE57"><mml:math id="IM57"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> can be drawn from untruncated normal as
<disp-formula id="E14"><mml:math id="M14"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mi>u</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mi mathvariant="italic">u</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ub</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">bb</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">uu</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ub</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">bb</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">bu</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where we arrange <inline-formula id="IE58"><mml:math id="IM58"><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mi mathvariant="italic">b</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mi mathvariant="italic">u</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mi mathvariant="italic">T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE59"><mml:math id="IM59"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">bb</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">bu</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ub</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">uu</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. </p>
      <p>We implement the MCMC sampling in Matlab. We run multiple independent Markov chains in a vectorized form. By default we run Nc = 10 chains of Ns = 500 flux samples for a total of 5000 flux vector samples. We use thinning and only accept every Nt = 100th flux sample. The MCMC chains have converged if successive samples are uncorrelated; chains are indistinguishable and have effectively forgotten the initial value. Convergent chains indicate that the MCMC sampler has characterized the whole flux posterior. We use potential scale reduction factor <inline-formula id="IE60"><mml:math id="IM60"><mml:mrow><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> to approximate convergence (<xref rid="btz315-B13" ref-type="bibr">Gelman and Rubin, 1992</xref>). An optimal value of <inline-formula id="IE61"><mml:math id="IM61"><mml:mrow><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> indicates convergence, while values <inline-formula id="IE62"><mml:math id="IM62"><mml:mrow><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>&lt;</mml:mo><mml:mn>1.1</mml:mn></mml:mrow></mml:math></inline-formula> are considered sufficient for convergence. We also compute the effective number of samples <inline-formula id="IE63"><mml:math id="IM63"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext>eff</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> per flux (<xref rid="btz315-B14" ref-type="bibr">Gelman <italic>et al.</italic>, 2013</xref>).</p>
      <p>We assume that flux means <inline-formula id="IE64"><mml:math id="IM64"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">m</mml:mi></mml:mrow><mml:mi>v</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> are fixed to either zero or the lower bound of each respective flux. The model has then two main hyperparameters <inline-formula id="IE65"><mml:math id="IM65"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mi>v</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE66"><mml:math id="IM66"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mrow><mml:mstyle><mml:mover><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:mover></mml:mstyle></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> that affect the posterior. The <inline-formula id="IE67"><mml:math id="IM67"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mrow><mml:mstyle><mml:mover><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:mover></mml:mstyle></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> determines how much the mass balance can be relaxed, and can be set according to the prior knowledge of the modeler. To enforce mass balance, a small value such as <inline-formula id="IE68"><mml:math id="IM68"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mrow><mml:mstyle><mml:mover><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:mover></mml:mstyle></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula> should be chosen. The prior flux variance <inline-formula id="IE69"><mml:math id="IM69"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> determines how much fluxes are driven towards zero a priori, but also should be set to sufficiently high value not to exclude possibly high fluxes. In practise we set the variance <inline-formula id="IE70"><mml:math id="IM70"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>100</mml:mn></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> for all fluxes <italic>v<sub>i</sub></italic>.</p>
    </sec>
    <sec>
      <title>2.5 Sampling FBA solutions</title>
      <p>The presented Bayesian model is a MFA model designed to characterize the global flux configurations <inline-formula id="IE71"><mml:math id="IM71"><mml:mrow><mml:mi mathvariant="bold">v</mml:mi><mml:mo>∼</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">v</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">obs</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> compatible with mass balance assumption, observations, and bounds. The method can as well be applied as a FBA method, where an objective function—such as biomass reaction—is maximized. For FBA mode we first find the standard FBA solution objective flux <inline-formula id="IE72"><mml:math id="IM72"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mrow><mml:mtext>obj</mml:mtext></mml:mrow><mml:mrow><mml:mtext>FBA</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> with linear programing, and encode it as a flux observation <inline-formula id="IE73"><mml:math id="IM73"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mrow><mml:mtext>obj</mml:mtext></mml:mrow></mml:msub><mml:mo>±</mml:mo><mml:msubsup><mml:mrow><mml:mo>ω</mml:mo></mml:mrow><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>, where the variance determines how closely we sample from the maximal objective. By default, we set the standard deviation to 0.1% of the objective flux. To run maximum growth Bayesian FBA we would set an observation for the biomass pseudoreaction to the classical FBA maximum growth value and condition the model with the pseudo-measurement as in Section 2.2.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>We first perform <italic>in silico</italic> experiments to highlight the capabilities of the Bayesian FBA and MFA models in Sections 3.1–3.3. Our goal is to compare the computational approach against the conventional FBA and FVA methods, and to showcase the method’s <italic>in silico</italic> performance in various metabolic models. We also compare Bayesian FBA solutions with the uniform samples obtained by ACHR and CHRR, two popular tools implemented in Cobra Toolbox to explore and infer properties of metabolic networks. The main experiment of this article is application of the Bayesian flux analysis to the 13C analysis of the <italic>Clostridium acetobutylicum</italic> in Section 3.5, where we can elucidate fluxes on a genome-scale from a small set of intracellular flux measurements.</p>
    <sec>
      <title>3.1 <italic>In silico</italic> metabolic models</title>
      <p><xref rid="btz315-T1" ref-type="table">Table 1</xref> indicates the stoichiometric models that were considered. We considered four organisms, seven genome-scale metabolic models and one core model. All models were downloaded from the BiGG database (<ext-link ext-link-type="uri" xlink:href="http://bigg.ucsd.edu">http://bigg.ucsd.edu</ext-link>). For all models we run the Bayesian model in FBA mode—by specifying a growth objective—with standard exchange flux measurements included as bounds. We sampled 10 chains of 500 flux vector samples from the full space containing all intracellular and extracellular fluxes. These 5000 flux vectors represent possible flux configurations compatible with the experimental setting. The sampling thinning parameter determines how uncorrelated successive MCMC samples are. We applied thinning values of 100 and 1000, with linear effect on the running time.</p>
      <table-wrap id="btz315-T1" orientation="portrait" position="float">
        <label>Table 1.</label>
        <caption>
          <p>Metabolic models analyzed by Bayesian flux analysis by sampling 500 samples from the flux posteriors</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="2" colspan="1">Organism</th>
              <th rowspan="2" colspan="1">Model</th>
              <th rowspan="2" colspan="1">
                <italic>n</italic>
              </th>
              <th rowspan="2" colspan="1">
                <italic>M</italic>
              </th>
              <th rowspan="1" colspan="1">Runtime</th>
              <th rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <th rowspan="1" colspan="1">thin 100</th>
              <th rowspan="1" colspan="1">thin 1000</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">
                <italic>E.coli</italic>
              </td>
              <td rowspan="1" colspan="1">core</td>
              <td rowspan="1" colspan="1">95</td>
              <td rowspan="1" colspan="1">72</td>
              <td rowspan="1" colspan="1">2 min</td>
              <td rowspan="1" colspan="1">20 min</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <italic>E.coli</italic>
              </td>
              <td rowspan="1" colspan="1">iJR904</td>
              <td rowspan="1" colspan="1">1075</td>
              <td rowspan="1" colspan="1">761</td>
              <td rowspan="1" colspan="1">2 hr</td>
              <td rowspan="1" colspan="1">1 day 9 h</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <italic>E.coli</italic>
              </td>
              <td rowspan="1" colspan="1">iAF1260</td>
              <td rowspan="1" colspan="1">2382</td>
              <td rowspan="1" colspan="1">1668</td>
              <td rowspan="1" colspan="1">7 hr</td>
              <td rowspan="1" colspan="1">4 days 12 h</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <italic>E.coli</italic>
              </td>
              <td rowspan="1" colspan="1">iJO1366</td>
              <td rowspan="1" colspan="1">2583</td>
              <td rowspan="1" colspan="1">1805</td>
              <td rowspan="1" colspan="1">9 hr</td>
              <td rowspan="1" colspan="1">4 days 16 h</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <italic>Bacillus subtilis</italic>
              </td>
              <td rowspan="1" colspan="1">iYO844</td>
              <td rowspan="1" colspan="1">1250</td>
              <td rowspan="1" colspan="1">992</td>
              <td rowspan="1" colspan="1">3 hr</td>
              <td rowspan="1" colspan="1">1 day 11 h</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <italic>C.acetobutylicum</italic>
              </td>
              <td rowspan="1" colspan="1">Wallenius (2013)</td>
              <td rowspan="1" colspan="1">592</td>
              <td rowspan="1" colspan="1">444</td>
              <td rowspan="1" colspan="1">23 min</td>
              <td rowspan="1" colspan="1">3 h</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <italic>Saccharomyces cerevisiae</italic>
              </td>
              <td rowspan="1" colspan="1">iMM904</td>
              <td rowspan="1" colspan="1">1577</td>
              <td rowspan="1" colspan="1">1226</td>
              <td rowspan="1" colspan="1">3 hr</td>
              <td rowspan="1" colspan="1">2 days</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <italic>S.cerevisiae</italic>
              </td>
              <td rowspan="1" colspan="1">7.6</td>
              <td rowspan="1" colspan="1">3493</td>
              <td rowspan="1" colspan="1">2220</td>
              <td rowspan="1" colspan="1">10 hr</td>
              <td rowspan="1" colspan="1">5 days 15 h</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <italic>Trichoderma reesei</italic>
              </td>
              <td rowspan="1" colspan="1">CORECO</td>
              <td rowspan="1" colspan="1">4008</td>
              <td rowspan="1" colspan="1">3292</td>
              <td rowspan="1" colspan="1">8 hr</td>
              <td rowspan="1" colspan="1">4 days 15 h</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p><italic>Note</italic>: The runtime is shown for thinning rate 100 and 1000. <italic>n</italic> denotes the number of reactions and <italic>M</italic> the number of metabolites in the model.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>The effective number of independent simulation draws for all models from Bayesian flux analysis with different thinning parameter are shown in <xref ref-type="fig" rid="btz315-F1">Figure 1</xref> using the potential scale reduction factor. The x-axis corresponds to individual fluxes sorted based on the effective number of samples. The number of reactions is different for different models. In all cases majority of the fluxes have over 100 effective number of independent samples, which indicates that the samples represent the flux posterior well. A minority of the fluxes have low effective sample sizes. These are usually central branching fluxes that are highly dependent across the genome-scale metabolism, and hence converge slowly. The thinning parameter has a large effect on some models (core, iJR904, iAF1260 and iJO1366) whereas for some other models there are not much change (CORECO, iYO844, iMM904, 7.6).
</p>
      <fig id="btz315-F1" orientation="portrait" position="float">
        <label>Fig. 1.</label>
        <caption>
          <p>The effective number of independent simulation draws for individual fluxes for a subset of models from Bayesian flux analysis with different thinning parameters. The x-axis corresponds to individual fluxes sorted based on the effective number of samples</p>
        </caption>
        <graphic xlink:href="btz315f1"/>
      </fig>
    </sec>
    <sec>
      <title>3.2 Bayesian FBA and MFA</title>
      <p>We illustrate the characteristics of the Bayesian model using <italic>Escherichiacoli</italic> central carbon metabolism model (BiGG model e_coli_core). The model contains 95 fluxes and 72 metabolites. It should be noted that the model was not further constrained and do not represent the native <italic>E.coli</italic> strain as such, while it allows, e.g. carbon fixation. The model was rather used to theoretically compare our modeling approach to conventional FBA methodology. The conventional FBA solution achieves a growth flux <inline-formula id="IE74"><mml:math id="IM74"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mtext>growth</mml:mtext></mml:mrow><mml:mrow><mml:mtext>FBA</mml:mtext></mml:mrow></mml:msubsup><mml:mo>≈</mml:mo><mml:mn>0.873</mml:mn></mml:mrow></mml:math></inline-formula> by limiting the glucose exchange flux with a <inline-formula id="IE75"><mml:math id="IM75"><mml:mrow><mml:mi>l</mml:mi><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mtext>glc</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula>. We consider three cases of Bayesian analysis: (i) 50% growth by defining only the biomass flux observation 0.436 ± 0.0043, (ii) maximal growth scenario by defining the biomass flux observation 0.873 ± 0.0087, and (iii) maximal growth with additional observations for nine key exchange fluxes: glucose (GLC), O<sub>2</sub>, CO<sub>2</sub>, H<sub>2</sub>O, H+, HPO<sub>4</sub>, SO<sub>4</sub>, NH<sub>4</sub> and ethanol that were all set to their conventional FBA solutions with a SDs of 0.01. In all three experiments the remaining fluxes were free with only a prior distribution with a SD of 100 specified. We defined a nearly strict steady-state by defining <inline-formula id="IE76"><mml:math id="IM76"><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula>. We sample a total of 5000 flux vectors with the Gibbs sampler using 10 chains and 500 samples each. We use 1D kernel density estimates as proxies of marginal flux posterior distributions. The small jaggedness of the distributions is an artifact from the MCMC sampling. By considering longer chains these would eventually smoothen out.</p>
      <p><xref ref-type="fig" rid="btz315-F2">Figure 2</xref> shows the flux distributions of 30 fluxes. The blue color indicates the 50% growth flux distributions, the green color the maximal growth distributions, the red color maximal growth with exchange fluxes specified, and the conventional FBA is shown with a black line. The Bayesian distributions represent the space of all allowed steady-state flux configurations given the observations and objective function. <xref ref-type="fig" rid="btz315-F2">Figure 2</xref> shows that maximal growth can still support a large variance in many fluxes, with the FBA point estimate misleading by only considering one flux configuration. Similarly to conventional FVA our approach elucidates directly the possible variance in a given flux. For instance, the pentose-phosphate pathway flux G6PDH2r: D-Glucose 6-phosphate + NADP <inline-formula id="IE77"><mml:math id="IM77"><mml:mo>⇔</mml:mo></mml:math></inline-formula> 6-Phosphogluconolactone + H<sup>+</sup> + NADPH can vary between −8 and −2 in maximal growth. The conventional FBA yields zero flux for glyoxylate cycle flux malate synhase (MALS): Acetyl-CoA + Glyoxylate + H2O <inline-formula id="IE79"><mml:math id="IM78"><mml:mo>⇒</mml:mo></mml:math></inline-formula> CoA + H<sup>+</sup> + Malate, while the flux space indicates that values up to four are possible.
</p>
      <fig id="btz315-F2" orientation="portrait" position="float">
        <label>Fig. 2.</label>
        <caption>
          <p>Posterior flux distributions of <italic>E.coli</italic> core model. The blue color indicates fluxes in 50% growth, the green color maximal growth, the red color maximal growth with nine exchange fluxes specified, and the conventional FBA solution is a black line. Reaction abbreviations and names are listed in <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref></p>
        </caption>
        <graphic xlink:href="btz315f2"/>
      </fig>
      <p>The red distributions indicate how the intracellular fluxes get more and more specified as the model is better specified by inclusion of exchange measurements. Variance of almost all fluxes reduces by more than half. For instance, the flux FUM: Fumarate + H<sub>2</sub>O <inline-formula id="IE81"><mml:math id="IM79"><mml:mo>⇔</mml:mo></mml:math></inline-formula> Malate is specified to a range of <inline-formula id="IE82"><mml:math id="IM80"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:mn>5.1</mml:mn><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mn>4.9</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> from a range of <inline-formula id="IE83"><mml:math id="IM81"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:mn>6.5</mml:mn><mml:mo>,</mml:mo><mml:mn>4.4</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> without exchange measurements.</p>
      <p>The blue color indicates the cellular flux state when the cell is only growing at 50% of the maximum growth rate. Most fluxes have a higher variance in this scenario. Interestingly the glucose intake is still kept at a relatively high rate. Instead of biomass production, the excess carbon from glucose can be diverted to other carbon sinks, such as formate and ethanol production. The ethanol and formate effluxes can grow up to 3 and 15, respectively. The carbon dioxide exchange decreases by over half into a range of <inline-formula id="IE84"><mml:math id="IM82"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:mn>15</mml:mn><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> from maximal growth exchange range of <inline-formula id="IE85"><mml:math id="IM83"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:mn>25</mml:mn><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mn>23</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
    </sec>
    <sec>
      <title>3.3 Flux couplings</title>
      <p>The flux variations are in general not independent from each other. To understand the intracellular flux space, we need to consider higher-order flux dependencies. The flux sample covariances indicate flux couplings, where the variation in one flux is constrained by other fluxes. <xref ref-type="fig" rid="btz315-F3">Figure 3</xref> highlights nine example flux pair patterns out of the total of <inline-formula id="IE86"><mml:math id="IM84"><mml:mrow><mml:mfrac><mml:mrow><mml:mn>95</mml:mn><mml:mo>·</mml:mo><mml:mn>94</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>=</mml:mo><mml:mn>4465</mml:mn></mml:mrow></mml:math></inline-formula> in the core model. Blue points represent 50% growth, green points maximal growth, red points maximal growth with nine exchange fluxes specified, and the conventional FBA solution is a black dot.
</p>
      <fig id="btz315-F3" orientation="portrait" position="float">
        <label>Fig. 3.</label>
        <caption>
          <p>Examples of flux covariance distributions of E. coli core network. Blue points represent 50% growth, green points maximal growth, red points maximal growth with nine exchange fluxes specified and the conventional FBA solution is a black dot. Scatter plots represent pair-wise (2D) marginal posterior distributions as obtained from the MCMC samples. Reaction abbreviations and names are listed in <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref></p>
        </caption>
        <graphic xlink:href="btz315f3"/>
      </fig>
      <p>The flux covariations become consistently more constrained while traversing from the loose 50% growth model (blue) towards 100% maximal growth (green). By measuring the exchange fluxes (red), we can already pinpoint most flux patterns very closely around the theoretically optimal flux pattern as defined by the conventional FBA (black).</p>
      <p>Multiple patterns of covariation can be immediately identified. There is an exact coupling between pentose-phosphate pathway reactions GND: 6-Phospho-D-gluconate + NADP <inline-formula id="IE87"><mml:math id="IM85"><mml:mo>⇒</mml:mo></mml:math></inline-formula> CO<sub>2</sub> + NADPH + D-Ribulose 5-phosphate and TALA: Glyceraldehyde 3-phosphate + Sedoheptulose 7-phosphate <inline-formula id="IE88"><mml:math id="IM86"><mml:mo>⇔</mml:mo></mml:math></inline-formula> D-Erythrose 4-phosphate + D-Fructose 6-phosphate, as expected from the stoichiometry. Glycolysis related FBA: D-Fructose 1, 6-bisphosphate <inline-formula id="IE89"><mml:math id="IM87"><mml:mo>⇔</mml:mo></mml:math></inline-formula> Dihydroxyacetone phosphate + Glyceraldehyde 3-phosphate and pentose-phosphate pathway related G6PDH2r have also a strong, but not exact, negative correlation. The flux PGI: D-Glucose 6-phosphate <inline-formula id="IE90"><mml:math id="IM88"><mml:mo>⇔</mml:mo></mml:math></inline-formula> D-Fructose 6-phosphate and carbon dioxide exchange have no correlation, but the maximal growth still pinpoints to a carbon dioxide exchange value of approximately −21. The dependency of glyoxylate cycle related MALS and citric acid cycle (TCA) cycle related SUCOAS: ATP + CoA + Succinate <inline-formula id="IE91"><mml:math id="IM89"><mml:mrow><mml:mo>⇔</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mtext>HPO</mml:mtext></mml:mrow></mml:mrow><mml:mn>4</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> + ADP + Succinyl-CoA on maximal growth requirement can be observed in <xref ref-type="fig" rid="btz315-F3">Figure 3</xref>. Under maximal growth a negative correlation between the two fluxes emerges. The conventional FBA solution pinpoints optimal values as zero MALS with SUCOAS around 5, while the Bayesian model reveals that MALS can still have a flux value of around 4 as long as SUCOAS tends towards 1.5 simultaneously.</p>
      <p>The patterns of G6PDH2r and FBA and FUM indicate a linear inequality for these fluxes. Especially with FUM this is natural since the pentose-phosphate pathway flux G6PDH2r limits the TCA cycle flux FUM. The same effect is also seen with G6PDH2r and ICDHyr: Isocitrate + NADP <inline-formula id="IE93"><mml:math id="IM90"><mml:mo>⇔</mml:mo></mml:math></inline-formula> 2-Oxoglutarate + CO<sub>2</sub> + NADPH, another TCA cycle flux.</p>
      <p>To get more insight into the biology behind the flux couplings, the flux pair patterns can also be illustrated in the metabolic network (<xref ref-type="fig" rid="btz315-F4">Fig. 4</xref>). <xref ref-type="fig" rid="btz315-F4">Figure 4</xref> shows the samples of the flux distributions for several example pairs of reactions. These scatter plots indicate the dependency of the flux configurations between two reactions across the reaction. There is natural correlation between adjacent or subsequent fluxes but also correlation between fluxes in different pathways, such as glycolysis and TCA cycle (See the SUCOAS and TKT1 pair).
</p>
      <fig id="btz315-F4" orientation="portrait" position="float">
        <label>Fig. 4.</label>
        <caption>
          <p>Pair-wise marginal posterior fluxes presented together in the metabolic network map. The visualized fluxes are highlighted. Blue points represent flux values in 50% growth, green points in maximal growth, red points in maximal growth with nine exchange fluxes specified and the conventional FBA solution is a black dot. Reaction abbreviations and names are listed in <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref></p>
        </caption>
        <graphic xlink:href="btz315f4"/>
      </fig>
    </sec>
    <sec>
      <title>3.4 Comparison to hit-and-run samplers</title>
      <p>We compare our Bayesian model and the Gibbs sampler to the competing flux sampling methods of ACHR and CCHR. The CCHR sampler has the ability to sample uniformly from the optimal flux solution space, while both samplers have the ability to relax the optimality. The CCHR draws hard FVA bounds around all fluxes, while ACHR can deviate softly from the optimal flux solution. We run ACHR and CCHR methods on the <italic>E.coli</italic> core model around the conventional FBA solution. For Bayesian FBA, the biomass flux observation distribution has its mean in the center point of FVA solution that gives at least 95% of the optimal growth. The distribution has mean 0.852 and variance 0.01. For ACHR experiments, the lower and upper bounds for biomass flux were set as the 95% FVA bounds. In CHRR experiments, random draws were obtained from FVA solution that gives at least 95 or 99% of the optimal growth. ACHR and CHRR were run with their default parameters, 10 independent chains were drawn for all samplers, thinning was 10 and the number of samples per chain was 1000.</p>
      <p><xref ref-type="fig" rid="btz315-F5">Figure 5</xref> compares the flux distributions of BayesFBA, ACHR and CCHR with 95% FVA bounds, and CHRR with 99% FVA bounds. The samples obtained by ACHR and CHRR for the Biomass flux concentrate near the lower bound of the 95 or 99% FVA solution, whereas BayesFBA gives wide Normal-like distribution with mean 0.83. Similar effect is also seen on the scatter plots with both ACHR and CCHR inducing hard bounds on the phosphate exchange EX_pi(e). BayesFBA is not constrained on FVA bounds of relaxed growth, thus we avoid specifying the growth relaxation. Instead, BayesFBA uses the uncertainty in the measured biomass production. The variances of distributions obtained by BayesFBA are larger than for the samples obtained by ACHR and CHRR; ACHR and CHRR likely underestimate the variance. We do not find significant differences in the samples obtained by ACHR and CHRR. Moreover, the dependencies between reactions obtained by different sampling methods are similar, for example, as seen in <xref ref-type="fig" rid="btz315-F5">Figure 5b</xref> for reactions ICDHyr and G6PDH2r.
</p>
      <fig id="btz315-F5" orientation="portrait" position="float">
        <label>Fig. 5.</label>
        <caption>
          <p>Sampler comparison on the <italic>E.coli</italic> core model around the FBA solution (black). The ACHR (green), CCHR 95% (red), CCHR 99% (purple) and BayesFBA (blue) distributions are shown for six example flux distributions (a), and for four example pairwise flux distributions (b). The green and red overlap heavily</p>
        </caption>
        <graphic xlink:href="btz315f5"/>
      </fig>
    </sec>
    <sec>
      <title>3.5 Intracellular flux elucidation of <italic>C.acetobutylicum</italic></title>
      <p>We consider the results obtained from <sup>13C</sup>MFA of <italic>C.acetobutylicum</italic> grown in chemostat, i.e. in continuous cultivation maintaining steady-state, with reference condition, glucose limited condition and butanol stimulus with the goal of inferring the internal fluxes. We effectively repeat the study of <xref rid="btz315-B42" ref-type="bibr">Wallenius <italic>et al.</italic> (2016)</xref>, where FBA and FVA were performed and constrained on 12 intracellular fluxes determined by <sup>13C</sup>MFA and 7 exchange fluxes. The model for <italic>C.acetobutylicum</italic> consists of 451 metabolites and 604 reactions, and is given as an.xml file in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> of <xref rid="btz315-B42" ref-type="bibr">Wallenius <italic>et al.</italic> (2016)</xref>.</p>
      <p>The data of measured fluxes in glucose limited condition are shown in <xref rid="btz315-T2" ref-type="table">Table 2</xref>. For the reference and the butanol stimulated conditions, see <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S2</xref>. The internal fluxes are obtained from <sup>13C</sup>MFA analysis, whereas the exchange fluxes were measured by chromatographical methods or transferred from the <sup>13C</sup>MFA results. Flux values were normalized to the specific growth rate which was given the value of 1, except for the reference condition, the measured growth is 0.95. Exchange fluxes measured from the cultivations were given to Bayesian MFA as mean <inline-formula id="IE94"><mml:math id="IM91"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mi>o</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and standard deviations <inline-formula id="IE95"><mml:math id="IM92"><mml:mrow><mml:msub><mml:mrow><mml:mo>Ω</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mi>o</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and fluxes obtained from <sup>13C</sup>MFA were given as ranges. In all Bayesian MFA experiments, the steady-state relaxation was <inline-formula id="IE96"><mml:math id="IM93"><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula>. Finally, 500 samples were drawn from the posterior with thinning 1000.</p>
      <table-wrap id="btz315-T2" orientation="portrait" position="float">
        <label>Table 2.</label>
        <caption>
          <p>The 6 exchange flux, the growth and exopolysaccharide (EPS) production and the 12 internal flux measurements</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Reaction</th>
              <th rowspan="1" colspan="1">KEGG ID</th>
              <th rowspan="1" colspan="1">Bounds</th>
              <th rowspan="1" colspan="1">Glucose limited</th>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1"/>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Exchange fluxes</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Glucose exchange<xref ref-type="table-fn" rid="tblfn3"><sup>a</sup></xref></td>
              <td rowspan="1" colspan="1">C00031</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE97">
                  <mml:math id="IM94">
                    <mml:mrow>
                      <mml:mo>≤</mml:mo>
                      <mml:mn>0</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1"><inline-formula id="IE98"><mml:math id="IM95"><mml:mrow><mml:mo>−</mml:mo><mml:mn>73.3</mml:mn></mml:mrow></mml:math></inline-formula> ± 3.7</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Acetate exchange<xref ref-type="table-fn" rid="tblfn4"><sup>b</sup></xref></td>
              <td rowspan="1" colspan="1">C00033</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE99">
                  <mml:math id="IM96">
                    <mml:mrow>
                      <mml:mn>0</mml:mn>
                      <mml:mo>≤</mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE100">
                  <mml:math id="IM97">
                    <mml:mrow>
                      <mml:mo stretchy="false">[</mml:mo>
                      <mml:mn>12.96</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
                <inline-formula id="IE101">
                  <mml:math id="IM98">
                    <mml:mrow>
                      <mml:mo> .</mml:mo>
                      <mml:mo>. </mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
                <inline-formula id="IE102">
                  <mml:math id="IM99">
                    <mml:mrow>
                      <mml:mn>13.016</mml:mn>
                      <mml:mo stretchy="false">]</mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Acetone exchange<xref ref-type="table-fn" rid="tblfn3"><sup>a</sup></xref></td>
              <td rowspan="1" colspan="1">C00207</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE103">
                  <mml:math id="IM100">
                    <mml:mrow>
                      <mml:mn>0</mml:mn>
                      <mml:mo>≤</mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">12.5 ± 0.06</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Butanol exchange<xref ref-type="table-fn" rid="tblfn4"><sup>b</sup></xref></td>
              <td rowspan="1" colspan="1">C06142</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE104">
                  <mml:math id="IM101">
                    <mml:mrow>
                      <mml:mn>0</mml:mn>
                      <mml:mo>≤</mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE105">
                  <mml:math id="IM102">
                    <mml:mrow>
                      <mml:mo stretchy="false">[</mml:mo>
                      <mml:mn>29.62</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
                <inline-formula id="IE106">
                  <mml:math id="IM103">
                    <mml:mrow>
                      <mml:mo> .. </mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
                <inline-formula id="IE107">
                  <mml:math id="IM104">
                    <mml:mrow>
                      <mml:mn>30.67</mml:mn>
                      <mml:mo stretchy="false">]</mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Butyrate exchange<xref ref-type="table-fn" rid="tblfn4"><sup>b</sup></xref></td>
              <td rowspan="1" colspan="1">C00246</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE108">
                  <mml:math id="IM105">
                    <mml:mrow>
                      <mml:mn>0</mml:mn>
                      <mml:mo>≤</mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE109">
                  <mml:math id="IM106">
                    <mml:mrow>
                      <mml:mo stretchy="false">[</mml:mo>
                      <mml:mn>0</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
                <inline-formula id="IE110">
                  <mml:math id="IM107">
                    <mml:mrow>
                      <mml:mo> .. </mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
                <inline-formula id="IE111">
                  <mml:math id="IM108">
                    <mml:mrow>
                      <mml:mn>3.23</mml:mn>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mo stretchy="false">]</mml:mo>
                        </mml:mrow>
                        <mml:mo> </mml:mo>
                      </mml:msup>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Ethanol exchange<xref ref-type="table-fn" rid="tblfn3"><sup>a</sup></xref></td>
              <td rowspan="1" colspan="1">C00469</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE112">
                  <mml:math id="IM109">
                    <mml:mrow>
                      <mml:mn>0</mml:mn>
                      <mml:mo>≤</mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">6.13 ± 0.31</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">EPS production<xref ref-type="table-fn" rid="tblfn4"><sup>b</sup></xref></td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE113">
                  <mml:math id="IM110">
                    <mml:mrow>
                      <mml:mn>0</mml:mn>
                      <mml:mo>≤</mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE114">
                  <mml:math id="IM111">
                    <mml:mrow>
                      <mml:mo stretchy="false">[</mml:mo>
                      <mml:mn>10.01</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
                <inline-formula id="IE115">
                  <mml:math id="IM112">
                    <mml:mrow>
                      <mml:mo> .. </mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
                <inline-formula id="IE116">
                  <mml:math id="IM113">
                    <mml:mrow>
                      <mml:mn>10.26</mml:mn>
                      <mml:mo stretchy="false">]</mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Growth<xref ref-type="table-fn" rid="tblfn3"><sup>a</sup></xref></td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE117">
                  <mml:math id="IM114">
                    <mml:mrow>
                      <mml:mn>0</mml:mn>
                      <mml:mo>≤</mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">1.00 ± 0.05</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td colspan="10" rowspan="1">
                <hr/>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td colspan="6" align="center" rowspan="1">F1 scores %</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td colspan="2" align="center" rowspan="1">ex only<hr/></td>
              <td colspan="2" align="center" rowspan="1">LOO<hr/></td>
              <td colspan="2" align="center" rowspan="1">ex + 13C<hr/></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">FVA</td>
              <td rowspan="1" colspan="1">BMFA</td>
              <td rowspan="1" colspan="1">FVA</td>
              <td rowspan="1" colspan="1">BMFA</td>
              <td rowspan="1" colspan="1">FVA</td>
              <td rowspan="1" colspan="1">BMFA</td>
            </tr>
            <tr>
              <td colspan="10" rowspan="1">
                <hr/>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Malate DHase</td>
              <td rowspan="1" colspan="1">R00342</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE118">
                  <mml:math id="IM115">
                    <mml:mrow>
                      <mml:mo stretchy="false">[</mml:mo>
                      <mml:mo>−</mml:mo>
                      <mml:mn>112</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
                <inline-formula id="IE119">
                  <mml:math id="IM116">
                    <mml:mrow>
                      <mml:mo> .. </mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
                <inline-formula id="IE120">
                  <mml:math id="IM117">
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mn>5.94</mml:mn>
                      <mml:mo stretchy="false">]</mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">19</td>
              <td rowspan="1" colspan="1">7</td>
              <td rowspan="1" colspan="1">65</td>
              <td rowspan="1" colspan="1">19</td>
              <td rowspan="1" colspan="1">68</td>
              <td rowspan="1" colspan="1">23</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">3P-glycerate DHase</td>
              <td rowspan="1" colspan="1">R01513</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE121">
                  <mml:math id="IM118">
                    <mml:mrow>
                      <mml:mn>0</mml:mn>
                      <mml:mo>≤</mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE122">
                  <mml:math id="IM119">
                    <mml:mrow>
                      <mml:mo stretchy="false">[</mml:mo>
                      <mml:mn>1.53</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
                <inline-formula id="IE123">
                  <mml:math id="IM120">
                    <mml:mrow>
                      <mml:mo>.</mml:mo>
                      <mml:mo>.</mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
                <inline-formula id="IE124">
                  <mml:math id="IM121">
                    <mml:mrow>
                      <mml:mn>4.85</mml:mn>
                      <mml:mo stretchy="false">]</mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">53</td>
              <td rowspan="1" colspan="1">12</td>
              <td rowspan="1" colspan="1">59</td>
              <td rowspan="1" colspan="1">100</td>
              <td rowspan="1" colspan="1">100</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Acetaldehyde DHase</td>
              <td rowspan="1" colspan="1">R00228</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE125">
                  <mml:math id="IM122">
                    <mml:mrow>
                      <mml:mo stretchy="false">[</mml:mo>
                      <mml:mo>−</mml:mo>
                      <mml:mn>27.4</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
                <inline-formula id="IE126">
                  <mml:math id="IM123">
                    <mml:mrow>
                      <mml:mo> .. </mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
                <inline-formula id="IE127">
                  <mml:math id="IM124">
                    <mml:mrow>
                      <mml:mn>50.3</mml:mn>
                      <mml:mo stretchy="false">]</mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">8</td>
              <td rowspan="1" colspan="1">56</td>
              <td rowspan="1" colspan="1">12</td>
              <td rowspan="1" colspan="1">73</td>
              <td rowspan="1" colspan="1">95</td>
              <td rowspan="1" colspan="1">92</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Triosephosphate DHase</td>
              <td rowspan="1" colspan="1">R01061</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE128">
                  <mml:math id="IM125">
                    <mml:mrow>
                      <mml:mn>0</mml:mn>
                      <mml:mo>≤</mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE129">
                  <mml:math id="IM126">
                    <mml:mrow>
                      <mml:mo stretchy="false">[</mml:mo>
                      <mml:mn>77.2</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
                <inline-formula id="IE130">
                  <mml:math id="IM127">
                    <mml:mrow>
                      <mml:mo> .. </mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
                <inline-formula id="IE131">
                  <mml:math id="IM128">
                    <mml:mrow>
                      <mml:mn>132</mml:mn>
                      <mml:mo stretchy="false">]</mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">10</td>
              <td rowspan="1" colspan="1">95</td>
              <td rowspan="1" colspan="1">5</td>
              <td rowspan="1" colspan="1">75</td>
              <td rowspan="1" colspan="1">63</td>
              <td rowspan="1" colspan="1">85</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Acetolactate synthase</td>
              <td rowspan="1" colspan="1">R04672</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE132">
                  <mml:math id="IM129">
                    <mml:mrow>
                      <mml:mo stretchy="false">[</mml:mo>
                      <mml:mo>−</mml:mo>
                      <mml:mn>95.2</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
                <inline-formula id="IE133">
                  <mml:math id="IM130">
                    <mml:mrow>
                      <mml:mo> .. </mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
                <inline-formula id="IE134">
                  <mml:math id="IM131">
                    <mml:mrow>
                      <mml:mn>99.4</mml:mn>
                      <mml:mo stretchy="false">]</mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">17</td>
              <td rowspan="1" colspan="1">67</td>
              <td rowspan="1" colspan="1">17</td>
              <td rowspan="1" colspan="1">68</td>
              <td rowspan="1" colspan="1">68</td>
              <td rowspan="1" colspan="1">68</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Aspartate transaminase</td>
              <td rowspan="1" colspan="1">R00355</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE135">
                  <mml:math id="IM132">
                    <mml:mrow>
                      <mml:mo>≤</mml:mo>
                      <mml:mn>0</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE136">
                  <mml:math id="IM133">
                    <mml:mrow>
                      <mml:mo stretchy="false">[</mml:mo>
                      <mml:mo>−</mml:mo>
                      <mml:mn>8.95</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
                <inline-formula id="IE137">
                  <mml:math id="IM134">
                    <mml:mrow>
                      <mml:mo> .. </mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
                <inline-formula id="IE138">
                  <mml:math id="IM135">
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mn>0.80</mml:mn>
                      <mml:mo stretchy="false">]</mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">32</td>
              <td rowspan="1" colspan="1">14</td>
              <td rowspan="1" colspan="1">29</td>
              <td rowspan="1" colspan="1">69</td>
              <td rowspan="1" colspan="1">69</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">5, 10-CH=THF hydrolyase</td>
              <td rowspan="1" colspan="1">R01655</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE139">
                  <mml:math id="IM136">
                    <mml:mrow>
                      <mml:mo stretchy="false">[</mml:mo>
                      <mml:mo>−</mml:mo>
                      <mml:mn>2.24</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
                <inline-formula id="IE140">
                  <mml:math id="IM137">
                    <mml:mrow>
                      <mml:mo> .. </mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
                <inline-formula id="IE141">
                  <mml:math id="IM138">
                    <mml:mrow>
                      <mml:mn>0.05</mml:mn>
                      <mml:mo stretchy="false">]</mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">0</td>
              <td rowspan="1" colspan="1">3</td>
              <td rowspan="1" colspan="1">0</td>
              <td rowspan="1" colspan="1">3</td>
              <td rowspan="1" colspan="1">100</td>
              <td rowspan="1" colspan="1">100</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Malate hydrolyase</td>
              <td rowspan="1" colspan="1">R01082</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE142">
                  <mml:math id="IM139">
                    <mml:mrow>
                      <mml:mo>≤</mml:mo>
                      <mml:mn>0</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE143">
                  <mml:math id="IM140">
                    <mml:mrow>
                      <mml:mo stretchy="false">[</mml:mo>
                      <mml:mo>−</mml:mo>
                      <mml:mn>10.2</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
                <inline-formula id="IE144">
                  <mml:math id="IM141">
                    <mml:mrow>
                      <mml:mo> .. </mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
                <inline-formula id="IE145">
                  <mml:math id="IM142">
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mn>0.78</mml:mn>
                      <mml:mo stretchy="false">]</mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">2</td>
              <td rowspan="1" colspan="1">83</td>
              <td rowspan="1" colspan="1">59</td>
              <td rowspan="1" colspan="1">54</td>
              <td rowspan="1" colspan="1">62</td>
              <td rowspan="1" colspan="1">67</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Ribulose-5P epimerase</td>
              <td rowspan="1" colspan="1">R01529</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE146">
                  <mml:math id="IM143">
                    <mml:mrow>
                      <mml:mo stretchy="false">[</mml:mo>
                      <mml:mo>−</mml:mo>
                      <mml:mn>4.39</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
                <inline-formula id="IE147">
                  <mml:math id="IM144">
                    <mml:mrow>
                      <mml:mo> .. </mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
                <inline-formula id="IE148">
                  <mml:math id="IM145">
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mn>1.27</mml:mn>
                      <mml:mo stretchy="false">]</mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">0</td>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">0</td>
              <td rowspan="1" colspan="1">100</td>
              <td rowspan="1" colspan="1">100</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Pyruvate carboxylase</td>
              <td rowspan="1" colspan="1">R00344</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE149">
                  <mml:math id="IM146">
                    <mml:mrow>
                      <mml:mn>0</mml:mn>
                      <mml:mo>≤</mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE150">
                  <mml:math id="IM147">
                    <mml:mrow>
                      <mml:mo stretchy="false">[</mml:mo>
                      <mml:mn>13.6</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
                <inline-formula id="IE151">
                  <mml:math id="IM148">
                    <mml:mrow>
                      <mml:mo> .. </mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
                <inline-formula id="IE152">
                  <mml:math id="IM149">
                    <mml:mrow>
                      <mml:mn>119</mml:mn>
                      <mml:mo stretchy="false">]</mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">19</td>
              <td rowspan="1" colspan="1">36</td>
              <td rowspan="1" colspan="1">65</td>
              <td rowspan="1" colspan="1">33</td>
              <td rowspan="1" colspan="1">66</td>
              <td rowspan="1" colspan="1">26</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Carbonate hydrolyase</td>
              <td rowspan="1" colspan="1">R10092</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE153">
                  <mml:math id="IM150">
                    <mml:mrow>
                      <mml:mo stretchy="false">[</mml:mo>
                      <mml:mn>26.2</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
                <inline-formula id="IE154">
                  <mml:math id="IM151">
                    <mml:mrow>
                      <mml:mo> .. </mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
                <inline-formula id="IE155">
                  <mml:math id="IM152">
                    <mml:mrow>
                      <mml:mn>75.7</mml:mn>
                      <mml:mo stretchy="false">]</mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">10</td>
              <td rowspan="1" colspan="1">57</td>
              <td rowspan="1" colspan="1">97</td>
              <td rowspan="1" colspan="1">31</td>
              <td rowspan="1" colspan="1">100</td>
              <td rowspan="1" colspan="1">53</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">C-acetyl transferase</td>
              <td rowspan="1" colspan="1">R00212</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE156">
                  <mml:math id="IM153">
                    <mml:mrow>
                      <mml:mn>0</mml:mn>
                      <mml:mo>≤</mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE157">
                  <mml:math id="IM154">
                    <mml:mrow>
                      <mml:mo stretchy="false">[</mml:mo>
                      <mml:mn>66.3</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
                <inline-formula id="IE158">
                  <mml:math id="IM155">
                    <mml:mrow>
                      <mml:mo> .. </mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
                <inline-formula id="IE159">
                  <mml:math id="IM156">
                    <mml:mrow>
                      <mml:mn>154</mml:mn>
                      <mml:mo stretchy="false">]</mml:mo>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">16</td>
              <td rowspan="1" colspan="1">2</td>
              <td rowspan="1" colspan="1">84</td>
              <td rowspan="1" colspan="1">13</td>
              <td rowspan="1" colspan="1">100</td>
              <td rowspan="1" colspan="1">81</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Average</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">9</td>
              <td rowspan="1" colspan="1">41</td>
              <td rowspan="1" colspan="1">36</td>
              <td rowspan="1" colspan="1">38</td>
              <td rowspan="1" colspan="1">83</td>
              <td rowspan="1" colspan="1">72</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn2">
            <p><italic>Note</italic>: Measurements from the cultivations include SDs, while fluxes determined by <sup>13C</sup>MFA are given as a range. The unit for flux ranges, flux means and flux SD is: g<sup>−1</sup>(CDW).</p>
          </fn>
          <fn id="tblfn3">
            <label>a</label>
            <p>Measured by chromatographic methods.</p>
          </fn>
          <fn id="tblfn4">
            <label>b</label>
            <p>Obtained from <sup>13C</sup>MFA.</p>
          </fn>
          <fn id="tblfn5">
            <p>EPS, exopolysaccharide.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>To study the FBA’s FVA’s and BMFA’s performance in predicting the measured ranges for 12 internal fluxes obtained by <sup>13C</sup>MFA, three sets of models were generated: (A) a model with reaction directions for the 12 <sup>13C</sup>MFA determined internal fluxes set according to the data (bounds in <xref rid="btz315-T2" ref-type="table">Table 2</xref>), (B) a set of 12 models, each model defined as unconstraining 1 of 12 <sup>13C</sup>MFA determined internal flux at a time, (the reaction direction is still constrained) while the rest 11 fluxes are constrained according to the measurements, this is the leave-one-out (LOO) setting. Finally, we define model (C) with all 12 <sup>13C</sup>MFA determined internal fluxes constrained to their measured values. Model (A) is the most relaxed with only reaction directions specified, and for model set (B) we tested how well we can estimate the true flux value for 1 internal reaction while the rest 11 reactions specified (LOO setting). In all three cases, we constrain the model with measured values for the six exchange reactions and the measured growth. For each set of models, the standard MFA with Taxicab penalty, FVA, and Bayesian MFA were performed. The MFA and FVA were performed by The Cobra Toolbox’s <monospace>optimizeCbModel</monospace> and <monospace>fluxVariability</monospace> functions by maximizing growth with the growth lower and upper bounds set to the measured value 1.</p>
      <p>We study how the flux variances from Bayesian MFA results decrease when adding <sup>13C</sup>MFA constraints. The <xref ref-type="fig" rid="btz315-F6">Figure 6</xref> shows the reduction of standard deviations of flux distributions of all fluxes of <italic>C.acetobutylicum</italic> in glucose limited condition when all 12 <sup>13C</sup>MFA constraints are added to the model (model set C). When adding the <sup>13C</sup>MFA constraints, the variance of most unmeasured internal fluxes decreases, demonstrating how Bayesian MFA propagates the information about 12 measured fluxes to several tens of other internal fluxes. The reduction of standard deviations of flux distributions for the reference and butanol stimulated conditions are shown in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figures S2 and S3</xref>.
</p>
      <fig id="btz315-F6" orientation="portrait" position="float">
        <label>Fig. 6.</label>
        <caption>
          <p>Global flux standard deviation reduction due to addition of twelve <sup>13C</sup>MFA internal flux measurements in glucose limited condition. The green points indicate the standard deviation of fluxes given only exchange measurements. The red points indicate the corresponding standard deviations after inclusion of twelve <sup>13C</sup>MFA intracellular flux measurements. The blue circles highlight the <sup>13C</sup>MFA measured fluxes</p>
        </caption>
        <graphic xlink:href="btz315f6"/>
      </fig>
      <p>To quantify the performance of FVA and Bayesian MFA to predict the <sup>13C</sup>MFA measured range of flux values, precision, recall and the F1 score were computed for each reaction and model set (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Methods</xref>). The F1 score values are shown in <xref rid="btz315-T2" ref-type="table">Table 2</xref> as percentage and the precision and recall values are shown in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S3</xref>. From <xref rid="btz315-T2" ref-type="table">Table 2</xref> and <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S3</xref>, it can be concluded that in the glucose limited condition, the Bayesian MFA outperforms FVA, as for model (A) 9 of 12 reactions has higher precision and F1 score, and for both models (A) and model set (B), the average precision and F1 score is higher for BMFA than for FVA. Similar results are obtained for butanol stimulated (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S4</xref>) and reference condition (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S5</xref>). In butanol stimulated condition, BMFA has for 8 out of 12 reactions higher precision, and for 7 out of 12 reactions higher F1 score for model set (A), for 10 out of 12 reactions higher precision and for 7 out of 12 reactions higher F1 score for model set (B). For reference condition, BMFA has for 8 out of 12 reactions higher precision and F1 score for model set (A), and for half of the reactions higher precision for model set B). The average F1 score and precision over all 12 reactions are always higher for BMFA than FVA.</p>
      <p>The <sup>13C</sup>MFA measured ranges, together with FVA, FBA and BMFA predictions for model sets (A), (B) and (C) are shown for the 12 <sup>13C</sup>MFA determined reactions in <xref ref-type="fig" rid="btz315-F7">Figure 7</xref>. In <xref ref-type="fig" rid="btz315-F7">Figure 7</xref>, for the model sets (A) and (B), the FVA gives a wide range of solutions as it doesn’t take into account the flux couplings, whereas the distribution from BMFA is narrower, and closer to the range of true fluxes; this is also seen in the higher precision and F1 scores for BMFA compared with FVA (see <xref rid="btz315-T2" ref-type="table">Table 2</xref>). For example, <xref ref-type="fig" rid="btz315-F7">Figure 7b</xref> shows the results for the model set (B): for reactions 3P-glycerate dehydrogenase, Acetaldehyde dehydrogenase, Triosephosphate dehydrogenase and Acetolactate synthase the posterior distribution obtained by BMFA resembles more the range obtained by <sup>13C</sup>MFA, whereas the FVA gives wider ranges. In <xref ref-type="fig" rid="btz315-F7">Figure 7c</xref>, the resulting flux ranges for FVA and BMFA distributions are always within the true measured range, but the Bayesian MFA captures the probability in the flux values. Similar results are obtained for the butanol stimulated and reference conditions (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Tables S4 and S5</xref> and <xref ref-type="supplementary-material" rid="sup1">Supplementary Figs S4 and S5</xref>).
</p>
      <fig id="btz315-F7" orientation="portrait" position="float">
        <label>Fig. 7.</label>
        <caption>
          <p>For the glucose limited condition, flux distributions of the 12 internal fluxes predicted solely from exchange fluxes (<bold>a</bold>), and distributions after seeing <sup>13C</sup>MFA data in LOO experiment (<bold>b</bold>) and after seeing all 12 internal reactions (<bold>c</bold>)</p>
        </caption>
        <graphic xlink:href="btz315f7"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>The conventional FBA formalism is a powerful framework for flux analysis that however assumes several unrealistic simplifying model approximations. Several approaches from robust flux analysis and sampling to flux variability analyses indicate the need to alleviate the approximations towards a more principled model.</p>
    <p>We proposed the Bayesian flux analysis formalism that considers fluxes as distributions instead of point estimates. The model learns a posterior distribution of fluxes given prior information, flux measurements, upper and lower bounds and steady-state assumptions into account. The degree of belief in the measurements and steady-state can be adjusted via measurement noise variances and biological knowledge as encoded in (subjective) priors. The model characterizes the complete space of possible flux configurations by modeling the uncertainties of fluxes and flux combinations. The Bayesian formalism can be seen as a drop-in replacement for deterministic flux analysis tools—such as FBA and FVA—at the cost of added running time necessary to properly characterize the flux distributions. The runtime can be effectively alleviated by only considering the core parts of the metabolic model or by running multiple MCMC chains in parallel.</p>
    <p>Our results show that the conventional FBA and FVA tools provides an overly simplistic view of the flux capabilities of the cellular system under study, while the Bayesian model expresses the full variance in the flux configurations. The Bayesian model of metabolism opens doors for building flux analysis models in a Bayesian way. We will leave experimental design, knock-outs and strain design using the Bayesian modeling basis for future work. In future we expect the Bayesian formalism to provide an alternative statistical approach for majority of current FBA- and MFA-based tools with the benefit of rigorous uncertainty modeling and improved interpretation.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>btz315_Supplementary_Data</label>
      <media xlink:href="btz315_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Funding</title>
    <p>This work has been supported by the Academy of Finland Center of Excellence in Systems Immunology and Physiology, the Academy of Finland [grant numbers 299915 and 313271], the Finnish Funding Agency for Innovation Tekes [grant number 40128/14, Living Factories] and the Finnish Cultural Foundation.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btz315-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Almaas</surname><given-names>E.</given-names></name></person-group><etal>et al</etal> (<year>2004</year>) 
<article-title>Global organization of metabolic fluxes in the bacterium <italic>Escherichia coli</italic></article-title>. <source>Nature</source>, <volume>427</volume>, <fpage>839</fpage>–<lpage>843</lpage>.<pub-id pub-id-type="pmid">14985762</pub-id></mixed-citation>
    </ref>
    <ref id="btz315-B2">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Altmann</surname><given-names>Y.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) Sampling from a multivariate gaussian distribution truncated on a simplex: a review. In: <italic>Statistical Signal Processing</italic>.</mixed-citation>
    </ref>
    <ref id="btz315-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Becker</surname><given-names>S.A.</given-names></name></person-group><etal>et al</etal> (<year>2007</year>) 
<article-title>Quantitative prediction of cellular metabolism with constraint-based models: the cobra toolbox</article-title>. <source>Nat. Protoc</source>., <volume>2</volume>, <fpage>727.</fpage><pub-id pub-id-type="pmid">17406635</pub-id></mixed-citation>
    </ref>
    <ref id="btz315-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bhadra</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Principal metabolic flux mode analysis</article-title>. <source>Bioinformatics</source>, <volume>34</volume>, <fpage>2409</fpage>–<lpage>2417</lpage>.<pub-id pub-id-type="pmid">29420676</pub-id></mixed-citation>
    </ref>
    <ref id="btz315-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bordbar</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Constraint-based models predict metabolic and associated cellular functions</article-title>. <source>Nat. Rev. Genet</source>., <volume>15</volume>, <fpage>107</fpage>–<lpage>120</lpage>.<pub-id pub-id-type="pmid">24430943</pub-id></mixed-citation>
    </ref>
    <ref id="btz315-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bordel</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>Sampling the solution space in genome-scale metabolic networks reveals transcriptional regulation in key enzymes</article-title>. <source>PLoS Comput. Biol</source>., <volume>6</volume>, e1000859. doi: 10.1371/journal.pcbi.1000859.</mixed-citation>
    </ref>
    <ref id="btz315-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Botev</surname><given-names>Z.</given-names></name></person-group> (<year>2016</year>) 
<article-title>The normal law under linear restrictions: Simulation and estimation via minimax tilting</article-title>. <source>J. R. Stat. Soc. B</source>. <volume>79</volume>, <fpage>125</fpage>–<lpage>148</lpage>.</mixed-citation>
    </ref>
    <ref id="btz315-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Carreira</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>CBFA: phenotype prediction integrating metabolic models with constraints derived from experimental data</article-title>. <source>BMC Syst. Biol</source>., <volume>8</volume>, <fpage>123</fpage>.<pub-id pub-id-type="pmid">25466481</pub-id></mixed-citation>
    </ref>
    <ref id="btz315-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Chopin</surname><given-names>N.</given-names></name></person-group> (<year>2011</year>) 
<article-title>Fast simulation of truncated Gaussian distributions</article-title>. <source>Stat. Comput</source>., <volume>21</volume>, <fpage>275</fpage>–<lpage>288</lpage>.</mixed-citation>
    </ref>
    <ref id="btz315-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Dubois</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>1996</year>) 
<article-title>Possibility theory in constraint satisfaction problems: handling priority, preference and uncertainty</article-title>. <source>Appl. Intell</source>., <volume>6</volume>, <fpage>287</fpage>–<lpage>309</lpage>.</mixed-citation>
    </ref>
    <ref id="btz315-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Emery</surname><given-names>X.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Simulating large Gaussian random vectors subject to inequality constraints by Gibbs sampling</article-title>. <source>Math. Geosci</source>., <volume>46</volume>, <fpage>265</fpage>–<lpage>283</lpage>.</mixed-citation>
    </ref>
    <ref id="btz315-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Feist</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Palsson</surname><given-names>B.</given-names></name></person-group> (<year>2010</year>) 
<article-title>The biomass objective function</article-title>. <source>Curr. Opin. Microbiol</source>., <volume>13</volume>, <fpage>344</fpage>–<lpage>349</lpage>.<pub-id pub-id-type="pmid">20430689</pub-id></mixed-citation>
    </ref>
    <ref id="btz315-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gelman</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Rubin</surname><given-names>D.</given-names></name></person-group> (<year>1992</year>) 
<article-title>Inference from iterative simulation using multiple sequences</article-title>. <source>Stat. Sci</source>., <volume>7</volume>, <fpage>457</fpage>–<lpage>511</lpage>.</mixed-citation>
    </ref>
    <ref id="btz315-B14">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Gelman</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) <source>Bayesian Data Analysis, Chapter 11.4–11.5</source>, <edition>3</edition>rd edn. 
<publisher-name>CRC Press</publisher-name>, Boca Raton, Florida.</mixed-citation>
    </ref>
    <ref id="btz315-B15">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Geweke</surname><given-names>J.</given-names></name></person-group> (<year>1991</year>) Efficient simulation from the multivariate normal and student-t distributions subject to linear constraints and the evaluation of constraint probabilities. In: <italic>Computing Science and Statistics</italic>, pp. <fpage>571</fpage>–<lpage>578</lpage>.</mixed-citation>
    </ref>
    <ref id="btz315-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gudmundsson</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Thiele</surname><given-names>I.</given-names></name></person-group> (<year>2010</year>) 
<article-title>Computationally efficient flux variability analysis</article-title>. <source>BMC Bioinformatics</source>, <volume>11</volume>, <fpage>489.</fpage><pub-id pub-id-type="pmid">20920235</pub-id></mixed-citation>
    </ref>
    <ref id="btz315-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Haraldsdóttir</surname><given-names>H.S.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>CHRR: coordinate hit-and-run with rounding for uniform sampling of constraint-based models</article-title>. <source>Bioinformatics</source>, <volume>33</volume>, <fpage>1741</fpage>–<lpage>1743</lpage>.<pub-id pub-id-type="pmid">28158334</pub-id></mixed-citation>
    </ref>
    <ref id="btz315-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Heino</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2007</year>) 
<article-title>Bayesian flux balance analysis applied to a skeletal muscle metabolic model</article-title>. <source>J. Theor. Biol</source>., <volume>248</volume>, <fpage>91</fpage>–<lpage>110</lpage>.<pub-id pub-id-type="pmid">17568615</pub-id></mixed-citation>
    </ref>
    <ref id="btz315-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Heino</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>Metabolica: a statistical research tool for analyzing metabolic networks</article-title>. <source>Comput. Methods Programs Biomed</source>., <volume>97</volume>, <fpage>151</fpage>–<lpage>167</lpage>.<pub-id pub-id-type="pmid">19748150</pub-id></mixed-citation>
    </ref>
    <ref id="btz315-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Horrace</surname><given-names>W.</given-names></name></person-group> (<year>2005</year>) 
<article-title>Some results on the multivariate truncated Normal distribution</article-title>. <source>J. Multivariate Anal</source>., <volume>94</volume>, <fpage>209</fpage>–<lpage>221</lpage>.</mixed-citation>
    </ref>
    <ref id="btz315-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kadirkamanathan</surname><given-names>V.</given-names></name></person-group><etal>et al</etal> (<year>2006</year>) 
<article-title>Markov chain Monte Carlo algorithm based metabolic flux distribution analysis on <italic>Corynebacterium glutamicum</italic></article-title>. <source>Bioinformatics</source>, <volume>22</volume>, <fpage>2681</fpage>–<lpage>2687</lpage>.<pub-id pub-id-type="pmid">16940326</pub-id></mixed-citation>
    </ref>
    <ref id="btz315-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kaufman</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Smith</surname><given-names>R.</given-names></name></person-group> (<year>1998</year>) 
<article-title>Direction choice for accelerated convergence in hit-and-run sampling</article-title>. <source>Oper. Res</source>., <volume>46</volume>, <fpage>84</fpage>–<lpage>95</lpage>.</mixed-citation>
    </ref>
    <ref id="btz315-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kim</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> (<year>2008</year>) 
<article-title>Metabolic flux analysis and metabolic engineering of microorganisms</article-title>. <source>Mol. Biosyst</source>., <volume>4</volume>, <fpage>113</fpage>–<lpage>120</lpage>.<pub-id pub-id-type="pmid">18213404</pub-id></mixed-citation>
    </ref>
    <ref id="btz315-B24">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Kotecha</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Djuric</surname><given-names>P.</given-names></name></person-group> (<year>1999</year>) Gibbs sampling approach for generation of truncated multivariate gaussian random variables. In: <italic>Acoustics, Speech, and Signal Processing</italic>.</mixed-citation>
    </ref>
    <ref id="btz315-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>Y.</given-names></name>, <name name-style="western"><surname>Ghosh</surname><given-names>S.</given-names></name></person-group> (<year>2015</year>) 
<article-title>Efficient sampling methods for truncated multivariate normal and student-t distributions subject to linear inequality constraints</article-title>. <source>J. Stat. Theory Pract</source>., <volume>9</volume>, <fpage>712</fpage>–<lpage>732</lpage>.</mixed-citation>
    </ref>
    <ref id="btz315-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Llaneras</surname><given-names>F.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>A possibilistic framework for constraint-based metabolic flux analysis</article-title>. <source>BMC Syst. Biol</source>., <volume>3</volume>, <fpage>79</fpage>.<pub-id pub-id-type="pmid">19646223</pub-id></mixed-citation>
    </ref>
    <ref id="btz315-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>MacGillivray</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Robust analysis of fluxes in genome-scale metabolic pathways</article-title>. <source>Sci. Rep</source>., <volume>7</volume>, <fpage>268</fpage>. doi: 10.1038/s41598-017-00170-3.<pub-id pub-id-type="pmid">28325918</pub-id></mixed-citation>
    </ref>
    <ref id="btz315-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Mahadevan</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Schilling</surname><given-names>C.</given-names></name></person-group> (<year>2003</year>) 
<article-title>The effects of alternate optimal solutions in constraint-based genome-scale metabolic models</article-title>. <source>Metab. Eng</source>., <volume>5</volume>, <fpage>264</fpage>–<lpage>276</lpage>.<pub-id pub-id-type="pmid">14642354</pub-id></mixed-citation>
    </ref>
    <ref id="btz315-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Megchelenbrink</surname><given-names>W.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>optGPSampler: an improved tool for uniformly sampling the solution-space of genome-scale metabolic networks</article-title>. <source>PLoS One</source>, <volume>9</volume>, <fpage>1</fpage>–<lpage>8</lpage>.</mixed-citation>
    </ref>
    <ref id="btz315-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Mo</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>Connecting extracellular metabolomic measurements to intracellular flux states in yeast</article-title>. <source>BMC Syst. Biol</source>., <volume>3</volume>, <fpage>37</fpage>. doi: 10.1186/1752-0509-3-37.</mixed-citation>
    </ref>
    <ref id="btz315-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Murray</surname><given-names>I.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) Elliptical slice sampling. <italic>J. Mach. Learn. Res.</italic>, <volume>9</volume>, <fpage>541</fpage>–<lpage>548</lpage>.</mixed-citation>
    </ref>
    <ref id="btz315-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Orth</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>What is flux balance analysis</article-title>. <source>Nat. Biotechnol</source>., <volume>28</volume>, <fpage>245</fpage>–<lpage>248</lpage>.<pub-id pub-id-type="pmid">20212490</pub-id></mixed-citation>
    </ref>
    <ref id="btz315-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pakman</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Paninski</surname><given-names>L.</given-names></name></person-group> (<year>2014</year>) 
<article-title>Exact hamiltonian Monte Carlo for truncated multivariate Gaussians</article-title>. <source>J. Comput. Graph. Stat</source>., <volume>23</volume>, <fpage>518</fpage>–<lpage>542</lpage>.</mixed-citation>
    </ref>
    <ref id="btz315-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pakula</surname><given-names>T.M.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Genome wide analysis of protein production load in <italic>Trichoderma reesei</italic></article-title>. <source>Biotechnol. Biofuels</source>, <volume>9</volume>, <fpage>132.</fpage><pub-id pub-id-type="pmid">27354857</pub-id></mixed-citation>
    </ref>
    <ref id="btz315-B35">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Palsson</surname><given-names>B.</given-names></name></person-group> (<year>2015</year>) <source>Systems Biology: Constraint-Based Reconstruction and Analysis</source>. 
<publisher-name>Cambridge University Press</publisher-name>, 
<publisher-loc>Cambridge, UK</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btz315-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Saa</surname><given-names>P.</given-names></name>, <name name-style="western"><surname>Nielsen</surname><given-names>L.</given-names></name></person-group> (<year>2016a</year>) 
<article-title>ll-ACHRB: a scalable algorithm for sampling the feasible solution space of metabolic networks</article-title>. <source>Bioinformatics</source>, <volume>32</volume>, <fpage>2330</fpage>–<lpage>2337</lpage>.<pub-id pub-id-type="pmid">27153696</pub-id></mixed-citation>
    </ref>
    <ref id="btz315-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Saa</surname><given-names>P.A.</given-names></name>, <name name-style="western"><surname>Nielsen</surname><given-names>L.K.</given-names></name></person-group> (<year>2016b</year>) 
<article-title>Construction of feasible and accurate kinetic models of metabolism: a Bayesian approach</article-title>. <source>Sci. Rep</source>., <volume>6</volume>, <fpage>29635</fpage>.<pub-id pub-id-type="pmid">27417285</pub-id></mixed-citation>
    </ref>
    <ref id="btz315-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Schellenberger</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>BiGG: a biochemical genetic and genomic knowledgebase of large scale metabolic reconstructions</article-title>. <source>BMC Bioinformatics</source>, <volume>11</volume>,</mixed-citation>
    </ref>
    <ref id="btz315-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Schellenberger</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>Quantitative prediction of cellular metabolism with constraint-based models: the cobra toolbox v2. 0</article-title>. <source>Nat. Protoc</source>., <volume>6</volume>, <fpage>1290.</fpage><pub-id pub-id-type="pmid">21886097</pub-id></mixed-citation>
    </ref>
    <ref id="btz315-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Smith</surname><given-names>R.</given-names></name></person-group> (<year>1984</year>) 
<article-title>Efficient Monte-Carlo procedures for generating points uniformly distributed over bounded regions</article-title>. <source>Oper. Res</source>., <volume>32</volume>, <fpage>1296</fpage>–<lpage>1308</lpage>.</mixed-citation>
    </ref>
    <ref id="btz315-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Theorell</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>To be certain about the uncertainty: Bayesian statistics for <sup>13</sup>C metabolic flux analysis</article-title>. <source>Biotechnol. Bioeng</source>., <volume>114</volume>, <fpage>2668</fpage>–<lpage>2684</lpage>.<pub-id pub-id-type="pmid">28695999</pub-id></mixed-citation>
    </ref>
    <ref id="btz315-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wallenius</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Carbon 13-metabolic flux analysis derived constraint-based metabolic modelling of <italic>Clostridium acetobutylicum</italic> in stressed chemostat conditions</article-title>. <source>Bioresource Technol</source>., <volume>219</volume>, <fpage>378</fpage>–<lpage>386</lpage>.</mixed-citation>
    </ref>
    <ref id="btz315-B43">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Zavlanos</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Julius</surname><given-names>A.</given-names></name></person-group> (<year>2011</year>) Robust flux balance analysis of metabolic networks. In: <italic>American Control Conference (ACC)</italic>, 2011. IEEE, pp. <fpage>2915</fpage>–<lpage>2920</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
