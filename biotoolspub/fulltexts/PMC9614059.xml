<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinform Adv</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinform Adv</journal-id>
    <journal-id journal-id-type="publisher-id">bioadv</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics Advances</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2635-0041</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9614059</article-id>
    <article-id pub-id-type="pmid">36330358</article-id>
    <article-id pub-id-type="doi">10.1093/bioadv/vbac076</article-id>
    <article-id pub-id-type="publisher-id">vbac076</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Application Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Data and Text Mining</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Cosbin: cosine score-based iterative normalization of biologically diverse samples</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Wu</surname>
          <given-names>Chiung-Ting</given-names>
        </name>
        <aff><institution>Department of Electrical and Computer Engineering, Virginia Polytechnic Institute and State University</institution>, Arlington, VA 22203, <country country="US">USA</country></aff>
        <xref rid="vbac076-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Shen</surname>
          <given-names>Minjie</given-names>
        </name>
        <aff><institution>Department of Electrical and Computer Engineering, Virginia Polytechnic Institute and State University</institution>, Arlington, VA 22203, <country country="US">USA</country></aff>
        <xref rid="vbac076-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Du</surname>
          <given-names>Dongping</given-names>
        </name>
        <aff><institution>Department of Electrical and Computer Engineering, Virginia Polytechnic Institute and State University</institution>, Arlington, VA 22203, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cheng</surname>
          <given-names>Zuolin</given-names>
        </name>
        <aff><institution>Department of Electrical and Computer Engineering, Virginia Polytechnic Institute and State University</institution>, Arlington, VA 22203, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Parker</surname>
          <given-names>Sarah J</given-names>
        </name>
        <aff><institution>Advanced Clinical Biosystems Research Institute, Cedars Sinai Medical Center</institution>, Los Angeles, CA 90048, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lu</surname>
          <given-names>Yingzhou</given-names>
        </name>
        <aff><institution>Department of Electrical and Computer Engineering, Virginia Polytechnic Institute and State University</institution>, Arlington, VA 22203, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Van Eyk</surname>
          <given-names>Jennifer E</given-names>
        </name>
        <aff><institution>Advanced Clinical Biosystems Research Institute, Cedars Sinai Medical Center</institution>, Los Angeles, CA 90048, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6743-7413</contrib-id>
        <name>
          <surname>Yu</surname>
          <given-names>Guoqiang</given-names>
        </name>
        <aff><institution>Department of Electrical and Computer Engineering, Virginia Polytechnic Institute and State University</institution>, Arlington, VA 22203, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Clarke</surname>
          <given-names>Robert</given-names>
        </name>
        <aff><institution>The Hormel Institute, University of Minnesota</institution>, Austin, MN 55912, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Herrington</surname>
          <given-names>David M</given-names>
        </name>
        <aff><institution>Department of Internal Medicine, Wake Forest University</institution>, Winston-Salem, NC 27157, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-5197-5874</contrib-id>
        <name>
          <surname>Wang</surname>
          <given-names>Yue</given-names>
        </name>
        <aff><institution>Department of Electrical and Computer Engineering, Virginia Polytechnic Institute and State University</institution>, Arlington, VA 22203, <country country="US">USA</country></aff>
        <xref rid="vbac076-cor1" ref-type="corresp"/>
        <!--yuewang@vt.edu-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Rattray</surname>
          <given-names>Magnus</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <fn id="vbac076-FM1">
        <p>The authors wish it to be known that, in their opinion, Chiung-Ting Wu and Minjie Shen should be regarded as Joint First Authors.</p>
      </fn>
      <corresp id="vbac076-cor1">To whom correspondence should be addressed. <email>yuewang@vt.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-10-20">
      <day>20</day>
      <month>10</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>20</day>
      <month>10</month>
      <year>2022</year>
    </pub-date>
    <volume>2</volume>
    <issue>1</issue>
    <elocation-id>vbac076</elocation-id>
    <history>
      <date date-type="received">
        <day>04</day>
        <month>4</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>02</day>
        <month>10</month>
        <year>2022</year>
      </date>
      <date date-type="editorial-decision">
        <day>04</day>
        <month>10</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>10</month>
        <year>2022</year>
      </date>
      <date date-type="corrected-typeset">
        <day>28</day>
        <month>10</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="vbac076.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Data normalization is essential to ensure accurate inference and comparability of gene expression measures across samples or conditions. Ideally, gene expression data should be rescaled based on consistently expressed reference genes. However, to normalize biologically diverse samples, the most commonly used reference genes exhibit striking expression variability and size-factor or distribution-based normalization methods can be problematic when the amount of asymmetry in differential expression is significant.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We report an efficient and accurate data-driven method—Cosine score-based iterative normalization (Cosbin)—to normalize biologically diverse samples. Based on the Cosine scores of cross-condition expression patterns, the Cosbin pipeline iteratively eliminates asymmetric differentially expressed genes, identifies consistently expressed genes, and calculates sample-wise normalization factors. We demonstrate the superior performance and enhanced utility of Cosbin compared with six representative peer methods using both simulation and real multi-omics expression datasets. Implemented in open-source R scripts and specifically designed to address normalization bias due to significant asymmetry in differential expression across multiple conditions, the Cosbin tool complements rather than replaces the existing methods and will allow biologists to more accurately detect true molecular signals among diverse phenotypic groups.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The R scripts of Cosbin pipeline are freely available at <ext-link xlink:href="https://github.com/MinjieSh/Cosbin" ext-link-type="uri">https://github.com/MinjieSh/Cosbin</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics Advances</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>HL111362-05A1</award-id>
        <award-id>HL133932</award-id>
        <award-id>NS115658-01</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Department of Defence</institution>
          </institution-wrap>
        </funding-source>
        <award-id>W81XWH-18-1-0723</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="6"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>High-throughput gene expression profiling provides the ability to study many genes in an organism under different biological conditions (<xref rid="vbac076-B1" ref-type="bibr">Clarke <italic toggle="yes">et al.</italic>, 2008</xref>). Between-sample normalization is essential to ensure accurate inference and comparability of gene expression measurements across samples or conditions. Ideally, such normalization should be based on a subset of consistently expressed reference genes (CEGs) to correct for technical differences (non-biological) among samples (<xref rid="vbac076-B2" ref-type="bibr">Evans <italic toggle="yes">et al.</italic>, 2018</xref>). Inaccurate normalization can significantly bias downstream analysis, potentially rendering the choice of test statistics for hypothesis testing (<xref rid="vbac076-B15" ref-type="bibr">Zhao <italic toggle="yes">et al.</italic>, 2020</xref>).</p>
    <p>We and others have recognized that the direct application of size-factor-based or distribution-based normalization methods to biologically diverse samples can be problematic due to two major as-yet unresolved problems. First, the most commonly used reference genes are unreliable as internal controls for normalization because of their striking expression variability in both experimental and bioinformatic analyses (<xref rid="vbac076-B6" ref-type="bibr">Jo <italic toggle="yes">et al.</italic>, 2019</xref>). Second, while it is conceptually logical to determine scaling factors or global transformations based on the global distribution of many expressed genes when the amount of asymmetry in the differential expression is high, this global adjustment (scaling or transformation) strategy may bias true differential expression toward the null (<xref rid="vbac076-F1" ref-type="fig">Fig. 1a</xref>) (<xref rid="vbac076-B2" ref-type="bibr">Evans <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="vbac076-B4" ref-type="bibr">Hicks and Irizarry 2015</xref>; <xref rid="vbac076-B7" ref-type="bibr">Johnson and Krishnan 2022</xref>). The data-driven assessment tool quantro was developed to guide the choice of an appropriate normalization method using global transformations (<xref rid="vbac076-B4" ref-type="bibr">Hicks and Irizarry 2015</xref>). A few normalization-by-testing strategies have also been proposed to mitigate the impact of asymmetrically and differentially expressed genes (aDEGs) with limited success (<xref rid="vbac076-B2" ref-type="bibr">Evans <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="vbac076-B13" ref-type="bibr">Sun <italic toggle="yes">et al.</italic>, 2013</xref>; <xref rid="vbac076-B14" ref-type="bibr">Wang <italic toggle="yes">et al.</italic>, 2002</xref>).</p>
    <fig position="float" id="vbac076-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>Cosbin concept and framework. (<bold>a</bold>) Toy illustration of asymmetric differential expression and resulting biased individual readouts: Genes 1 and 2 (green) are iCEGs, Gene 3 (orange) is aDEG, while common total readout count produces biased between-sample normalization where two iCEGs become differentially expressed and one aDEG becomes less differentially expressed. (<bold>b</bold>) Geometrical locations of significant aDEGs (red, corners), iCEGs (green, center) and general DEGs (blue, the rest), in the scatter simplex of data matrix. (<bold>c</bold>) Overall workflow of Cosbin algorithm with two major consecutive iterative loops</p>
      </caption>
      <graphic xlink:href="vbac076f1" position="float"/>
    </fig>
    <p>To specifically address the impact of significant asymmetry in the differential expression on normalizing biologically diverse samples, we report here a Cosine score-based iterative normalization (Cosbin) method that eliminates aDEGs, identifies ideal CEGs (iCEGs) and calculates sample-wise normalization factors by equilibrating expression levels of iCEGs (<xref rid="vbac076-F1" ref-type="fig">Fig. 1</xref>). The Cosbin tool performs reference-free multiple normalizations across different biological conditions and is applicable to multi-omics data. As a novel normalization-by-testing strategy (<xref rid="vbac076-B2" ref-type="bibr">Evans <italic toggle="yes">et al.</italic>, 2018</xref>), the Cosbin framework makes no assumption that the total expression is the same or that differential expression across differential experimental conditions is approximately symmetrical and thus complements rather than replaces existing methods (<xref rid="vbac076-B2" ref-type="bibr">Evans <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="vbac076-B7" ref-type="bibr">Johnson and Krishnan 2022</xref>). One additional benefit of the Cosbin tool is the concurrent detection of marker genes (MGs) and iCEGs (<xref rid="vbac076-B9" ref-type="bibr">Lu <italic toggle="yes">et al.</italic>, 2022</xref>) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Information</xref>).</p>
    <p>The Cosbin software is implemented in open-source R scripts (<xref rid="vbac076-F1" ref-type="fig">Fig. 1</xref>). We demonstrate the effectiveness of the Cosbin strategy, in comparison with six representative peer methods (three size-factor-based, two global-adjustment and one normalization-by-testing) (<xref rid="vbac076-B2" ref-type="bibr">Evans <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="vbac076-B7" ref-type="bibr">Johnson and Krishnan 2022</xref>), using realistic mixture simulations and quantitative accuracy measures against ground truth. We also report biomedical case studies where Cosbin is used to normalize gene expression and proteomics data from biologically diverse samples (<xref rid="vbac076-B3" ref-type="bibr">Herrington <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="vbac076-B10" ref-type="bibr">Parker <italic toggle="yes">et al.</italic>, 2020</xref>). The Cosbin tool will allow biologists to more accurately detect true molecular signals among diverse phenotypic groups.</p>
  </sec>
  <sec>
    <title>2 Methods</title>
    <sec>
      <title>2.1 Eliminating asymmetric DEG and interim normalization</title>
      <p>Because a few highly expressed genes can account for a large share of total expression, overall differential expression is asymmetric across conditions (e.g. grouped or diverse samples) when the number or magnitude of up/down-regulated expressions in each condition is unequal (<xref rid="vbac076-F1" ref-type="fig">Fig. 1a</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>) (<xref rid="vbac076-B2" ref-type="bibr">Evans <italic toggle="yes">et al.</italic>, 2018</xref>). In the problem formulation, for simplicity, we focus our discussions on the basic yet challenging case of multiple grouped samples. However, our results hold for diverse individual samples.</p>
      <p>Mathematically, an aDEG <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>aDEG</mml:mtext><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> associated with group <italic toggle="yes">k</italic> is defined as a gene expressed significantly high in group <italic toggle="yes">k</italic> while universally low in any other groups (expressed in group <italic toggle="yes">k</italic> as exclusively as possible), approximately
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mfenced open="{" close="" separators="|"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>aDEG</mml:mtext><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>≫</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>≠</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>aDEG</mml:mtext><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>≈</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math></disp-formula>
where, <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>aDEG</mml:mtext><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula> and <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>≠</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>aDEG</mml:mtext><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula> are the averaged expressions of gene <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>aDEG</mml:mtext><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> in groups <italic toggle="yes">k</italic> and <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mi>l</mml:mi></mml:math></inline-formula>, respectively (<xref rid="vbac076-F1" ref-type="fig">Fig. 1</xref>). Accordingly, the cross-group expression pattern of an aDEG can be represented concisely by the Cartesian unit vectors <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">e</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, readily serving as the ground reference for scoring <italic toggle="yes">de novo</italic> aDEGs (<xref rid="vbac076-F1" ref-type="fig">Fig. 1b</xref>). Fundamental to the efficiency of Cosbin is the newly proposed score <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">cos</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">e</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula> that measures directly the similarity between the cross-group expression pattern <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math></inline-formula> of gene <italic toggle="yes">i</italic> and the reference aDEG expression patterns of constituent groups in scatter space, where <italic toggle="yes">K</italic> is the number of constituent groups. Specifically, for gene <italic toggle="yes">i</italic> and group <italic toggle="yes">k</italic>, the aDEG score is given by
<disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mtext>aDEG</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mi mathvariant="normal">argmax</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:munder></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">cos</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">e</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi mathvariant="normal">argmax</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msup><mml:mrow><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math></disp-formula>
where the ‘max’ operation in (2) is applied to address significantly asymmetric differential expressions among multiple groups. Because <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> is confined within the first quadrant where the central vector is the ‘all-ones’ vector <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>, we have <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msqrt><mml:mi>K</mml:mi></mml:msqrt></mml:mrow></mml:mrow><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mtext>aDEG</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>.</p>
      <p>Impactful aDEGs with higher scores are sequentially identified and removed then interim normalization is performed by equilibrating expression levels for the remaining genes, and Cosbin iterates to the next round of aDEG identification and interim normalization (<xref rid="vbac076-B14" ref-type="bibr">Wang <italic toggle="yes">et al.</italic>, 2002</xref>). Sequential elimination of impactful aDEGs should ease the asymmetry in differential expression across groups, reduce normalization bias and improve the efficiency of identifying the next aDEG. Iterations continue until aDEG identification or interim normalization converges at a stable point.</p>
    </sec>
    <sec>
      <title>2.2 Identifying ideal CEGs and final normalization</title>
      <p>We finalize normalization by identifying iCEGs and determining normalization factors across groups and individual samples. Mathematically, the cross-group expression pattern of an iCEG can be represented concisely by the ‘all-ones’ vector <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> (<xref rid="vbac076-B2" ref-type="bibr">Evans <italic toggle="yes">et al.</italic>, 2018</xref>), serving as the ground reference for scoring CEGs (<xref rid="vbac076-F1" ref-type="fig">Fig. 1b</xref>). Accordingly, the iCEG score is given by
<disp-formula id="E3"><label>(3)</label><mml:math id="M3" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mtext>iCEG</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">cos</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mi mathvariant="normal"> </mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:msqrt><mml:mi>K</mml:mi><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msup><mml:mrow><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math></disp-formula>
where <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msqrt><mml:mi>K</mml:mi></mml:msqrt></mml:mrow></mml:mrow><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mtext>iCEG</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>. Once iCEGs are identified, normalization is refined by equilibrating expression levels for iCEGs and the algorithm iterates to the next round of iCEG identification (<xref rid="vbac076-B2" ref-type="bibr">Evans <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="vbac076-B14" ref-type="bibr">Wang <italic toggle="yes">et al.</italic>, 2002</xref>). The iterations between iCEG identification and re-normalization continue until iCEG identification or re-normalization converges at a stable point.</p>
    </sec>
    <sec>
      <title>2.3 Cosbin workflow and software</title>
      <p>The Cosbin workflow consists of six major analytic steps (<xref rid="vbac076-F1" ref-type="fig">Fig. 1c</xref>):
</p>
      <list list-type="order">
        <list-item>
          <p>Initial normalization. An initial between-sample normalization is performed using total count (<xref rid="vbac076-B2" ref-type="bibr">Evans <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="vbac076-B14" ref-type="bibr">Wang <italic toggle="yes">et al.</italic>, 2002</xref>).</p>
        </list-item>
        <list-item>
          <p>Data cleaning. Genes whose norms <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mfenced open="‖" close="‖" separators="|"><mml:mrow><mml:mi>x</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math></inline-formula> are lower or higher than pre-fixed thresholds are removed as noise or outliers.</p>
        </list-item>
        <list-item>
          <p>aDEG score and removal. For each remaining gene, score <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="normal">argmax</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo> </mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">cos</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">e</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula> is calculated and the top ranked aDEG is iteratively eliminated.</p>
        </list-item>
        <list-item>
          <p>Interim normalization. The rescaling factor per condition/sample is determined by the total count of non-aDEGs and used to normalize the remaining genes.</p>
        </list-item>
        <list-item>
          <p>iCEG score and selection. For each remaining gene, score <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">cos</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula> is calculated and the top iCEGs are selected.</p>
        </list-item>
        <list-item>
          <p>Final normalization. The rescaling factor per sample is determined by the total count of iCEGs and used to normalize all individual genes. Within the loop comprising Steps 5 and 6, a sequence of increasing score thresholds may be applied to stabilize normalization.</p>
        </list-item>
      </list>
      <p>We implemented the Cosbin workflow in R script and performed a community-trial software testing (<xref rid="sup1" ref-type="supplementary-material">Supplementary Information</xref>). The R script is open-source at GitHub and is distributed under the MIT license. The Cosbin software tool is easy to use and applicable to multi-omics data. Importantly, a group label on each sample is required in the input, and the output file contains the scores for individual genes belonging to either aDEGs or iCEGs.</p>
    </sec>
    <sec>
      <title>2.4 Performance index</title>
      <p>We emphasize that the Cosbin strategy aims to address normalization bias due to the impact of significant aDEGs. In simulation studies, we proposed four quantitative criteria to comparatively evaluate the performance of Cosbin and peer methods against the ground truth embedded in realistic simulations (<xref rid="sup1" ref-type="supplementary-material">Supplementary Information</xref>). To determine the location correctness of iCEGs against ground truth, we used the (i) average Cosine score in degree and (ii) average mean-squared-error of log-fold-change (LFC-MSE), which measure the dislocation of iCEGs from the ground truth after normalization by Cosbin and peer methods (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S8</xref>) (<xref rid="vbac076-B2" ref-type="bibr">Evans <italic toggle="yes">et al.</italic>, 2018</xref>). As these genes are iCEGs, if normalization is performed correctly then both the average Cosine score in degrees and LFC-MSE between samples of different conditions should be close to 0. For studying the impact of various normalization strategies on downstream differential analysis, we used (iii) the whole or partial receiver operating characteristics (ROC/pROC) curve and (iv) the area under ROC curve (AUC/pAUC) in order to assess the sensitivity and specificity of detecting general DEGs after normalization by Cosbin and peer methods (<xref rid="vbac076-B2" ref-type="bibr">Evans <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="vbac076-B6" ref-type="bibr">Jo <italic toggle="yes">et al.</italic>, 2019</xref>). In our benchmarking studies, we proposed two quantitative criteria to evaluate the impact of different normalization methods on downstream marker gene (MG) detection among biologically diverse samples (<xref rid="vbac076-B10" ref-type="bibr">Parker <italic toggle="yes">et al.</italic>, 2020</xref>), namely (v) P1 index and (vi) average deviation degree (ADD).</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>We conducted three phased experiments to evaluate the performance of Cosbin and its R software tool, Specifically, we performed comparisons between Cosbin and six peer methods using realistic simulation data, assessment of the impact of Cosbin on detecting MGs among many groups using benchmark gene expression data, and a biomedical case study applying Cosbin to real proteomics data.</p>
    <sec>
      <title>3.1 Comparative evaluation of Cosbin and peer methods using simulation data</title>
      <p>We conducted extensive experiments to evaluate the performance of Cosbin and six peer methods using simulation data (<xref rid="vbac076-B2" ref-type="bibr">Evans <italic toggle="yes">et al.</italic>, 2018</xref>) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Information</xref>). As is widely recognized, the evaluation of biased normalization due to aDEGs in real data is very difficult in practice (<xref rid="vbac076-B15" ref-type="bibr">Zhao <italic toggle="yes">et al.</italic>, 2020</xref>). Thus, the performance of methods addressing the impact of aDEGs must be quantitatively evaluated using simulation data embedded with ground truth (<xref rid="vbac076-B13" ref-type="bibr">Sun <italic toggle="yes">et al.</italic>, 2013</xref>). The six peer methods in our comparison consisted of three size-factor-based approaches (i) Total Count (<xref rid="vbac076-B2" ref-type="bibr">Evans <italic toggle="yes">et al.</italic>, 2018</xref>), (ii) Trimmed Mean of the M-values in edge R (TMM/edgeR) (<xref rid="vbac076-B12" ref-type="bibr">Robinson and Oshlack 2010</xref>), (iii) Differential Expression analysis of RNA-Seq (DESeq2) (<xref rid="vbac076-B8" ref-type="bibr">Love <italic toggle="yes">et al.</italic>, 2014</xref>); one normalization-by-testing approach, (iv) Differentially Expressed Gene Elimination Strategy (DEGES) (<xref rid="vbac076-B13" ref-type="bibr">Sun <italic toggle="yes">et al.</italic>, 2013</xref>); and two global-adjustment or transformation approaches, (v) Cumulative-Sum Scaling (CSS) (<xref rid="vbac076-B11" ref-type="bibr">Paulson <italic toggle="yes">et al.</italic>, 2013</xref>) and (vi) smooth quantile normalization (qsmooth) (<xref rid="vbac076-B5" ref-type="bibr">Hicks <italic toggle="yes">et al.</italic>, 2018</xref>). DEGES is not a self-contained normalization method but an add-on preprocessing step to improve the TMM/edgeR method (<xref rid="vbac076-B13" ref-type="bibr">Sun <italic toggle="yes">et al.</italic>, 2013</xref>).</p>
      <p>Simulation data were generated either from a mixture of Dirichlet and truncated normal distributions (mixture simulation) or by using the simulateReadCounts function in Tag Count Comparison (TCC) R package (TCC simulation) (<xref rid="vbac076-B13" ref-type="bibr">Sun <italic toggle="yes">et al.</italic>, 2013</xref>). Each simulated data matrix contained 1000 genes with 168 iCEGs (green, 16.8%), 232 general DEGs (blue, 23.2%) and 600 aDEGs (red/orange/pink, 60%), across 3 groups with 10 replicates per group. The iCEGs are determined by <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">cos</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mi mathvariant="normal"> </mml:mi></mml:mrow></mml:mfenced><mml:mo>≥</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, and the percentages of upregulated aDEGs were 10%, 30% and 60% for each of the three groups, respectively. The aDEGs are generated from a truncated normal distribution centered at <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">e</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> in the mixture simulation (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>) and are generated with a pairwise fold-change of 10 in TCC simulation (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5</xref>) (<xref rid="vbac076-B13" ref-type="bibr">Sun <italic toggle="yes">et al.</italic>, 2013</xref>).</p>
      <p>The average deviation-in-degree of <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">cos</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mo> </mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula> values were used to evaluate the accuracy of iCEG restoration and discriminative accuracy was evaluated using both ROC/pROC curves and AUC/pAUC values to assess ability to distinguish between general DEGs and iCEGs (e.g. blue versus green) after normalization by Cosbin and six alternative and previously published (peer) methods (<xref rid="sup1" ref-type="supplementary-material">Supplementary Information</xref>). The experimental results are summarized in <xref rid="vbac076-T1" ref-type="table">Table 1</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1 and S2</xref>, <xref rid="vbac076-F2" ref-type="fig">Figure 2</xref>, and <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S4</xref>. In both mixture and TCC simulation studies, Cosbin consistently outperforms all six peer methods in terms of lower average dislocation of iCEGs (<xref rid="vbac076-T1" ref-type="table">Table 1</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S1 and S2</xref>) and higher AUC/pAUC of detecting DEGs (<xref rid="vbac076-T1" ref-type="table">Table 1</xref>, <xref rid="vbac076-F2" ref-type="fig">Fig. 2h</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). Note that the relative performances of the six peer methods assessed in our experimental comparisons are consistent with previous reports in similar comparison studies (<xref rid="vbac076-B2" ref-type="bibr">Evans <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="vbac076-B7" ref-type="bibr">Johnson and Krishnan 2022</xref>; <xref rid="vbac076-B13" ref-type="bibr">Sun <italic toggle="yes">et al.</italic>, 2013</xref>). Notably, in terms of addressing the significant asymmetry in differential expression across multiple conditions, three popular size-factor-based methods (Total count, TMM/edgeR and DESeq2) perform relatively well, while two popular distribution-based methods (CSS and qsmooth) do not perform well. The poor performance of CSS is expected because CSS was designed specifically to normalize ‘sparse’ expression profiles (marker-gene survey data) (<xref rid="vbac076-B11" ref-type="bibr">Paulson <italic toggle="yes">et al.</italic>, 2013</xref>) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Information</xref>).</p>
      <fig position="float" id="vbac076-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>Comparative evaluation of Cosbin and six peer methods using mixture simulation data. (<bold>a–g</bold>) The location of iCEGs (green, # iCEGs = 168), significant aDEGs (red/orange/pink, # aDEGs = 600), and general DEGs (blue, # DEGs = 232), restored by Cosbin and six peer methods after normalization. (<bold>h</bold>) The ROC curves of detecting general DEGs against iCEGs by Cosbin and six peer methods</p>
        </caption>
        <graphic xlink:href="vbac076f2" position="float"/>
      </fig>
      <table-wrap position="float" id="vbac076-T1">
        <label>Table 1.</label>
        <caption>
          <p>Average dislocation of iCEGs (no. of iCEGs = 168) in degree and AUC of detecting general DEGs (no. of DEGs = 232) after normalization by Cosbin and six peer methods, summarized from mixture simulation studies</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Methods</th>
              <th align="center" rowspan="1" colspan="1">Average dislocation<break/>of iCEGs in degree<break/>(mixture simulation)</th>
              <th align="center" rowspan="1" colspan="1">AUC of detecting<break/>general DEGs<break/>(mixture simulation)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Total count</td>
              <td rowspan="1" colspan="1">18.29°</td>
              <td rowspan="1" colspan="1">0.75</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> TMM/edgeR</td>
              <td rowspan="1" colspan="1">17.46°</td>
              <td rowspan="1" colspan="1">0.81</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> DESeq2</td>
              <td rowspan="1" colspan="1">15.28°</td>
              <td rowspan="1" colspan="1">0.82</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> DEGES/TCC</td>
              <td rowspan="1" colspan="1">17.63°</td>
              <td rowspan="1" colspan="1">0.80</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> CSS</td>
              <td rowspan="1" colspan="1">28.81°</td>
              <td rowspan="1" colspan="1">0.65</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> qsmooth</td>
              <td rowspan="1" colspan="1">18.91°</td>
              <td rowspan="1" colspan="1">0.73</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> Cosbin</td>
              <td rowspan="1" colspan="1">1.42°</td>
              <td rowspan="1" colspan="1">0.99</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p><italic toggle="yes">Note</italic>: Note that the maximum possible iCEG dislocation in this case is about 55°.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>While DEGES performed comparatively well in the TCC simulation study (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>), it performed poorly in the mixture simulation study (<xref rid="vbac076-F2" ref-type="fig">Fig. 2d and h</xref>, <xref rid="vbac076-T1" ref-type="table">Table 1</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). This outcome was expected because TCC simulation may not represent a typical case of biologically diverse samples, see <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1</xref> (more blue-DEGs in mixture simulation) versus <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S5</xref> (fewer blue-DEGs in TCC simulation). However, TCC simulation may not represent a mature simulation tool for analyzing multiple conditions, as acknowledged previously by its authors (<xref rid="vbac076-B13" ref-type="bibr">Sun <italic toggle="yes">et al.</italic>, 2013</xref>). Additional experimental results and discussion are presented in <xref rid="sup1" ref-type="supplementary-material">Supplementary Information</xref> (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S3, S6 and S7</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S1 and S2</xref>).</p>
      <p>We next assessed how the performance of Cosbin changes as the number of iCEGs changes, such as when the iCEG subset is very small in either total number or as a proportion. To this end, we have conducted additional experiments using different numbers (50, 100 and 150) and proportions (5%, 10% and 15%) of iCEGs identified and used for determining normalization factors in the Cosbin pipeline applied to our simulation studies. The experimental results are summarized mainly in <xref rid="sup1" ref-type="supplementary-material">Figure S4</xref>, and additionally in <xref rid="vbac076-F2" ref-type="fig">Figure 2</xref> and <xref rid="vbac076-T1" ref-type="table">Table 1</xref> (# iCEGs = 168, the fixed number of simulated iCEGs). These results show that the performance of Cosbin remains robust even when using a small number of iCEGs, as was quantitatively measured by both the accuracy of iCEG restoration (average dislocation) and AUC values of DEG detection. To evaluate how the performance of global adjustment methods changes with different amounts of asymmetry in differential expression, we conducted simulation studies with varying level of aDEG imbalance. The experimental results on CSS and qsmooth are summarized in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figures S11 and S12</xref>.</p>
    </sec>
    <sec>
      <title>3.2 Assessment of Cosbin impact on marker gene quality using benchmark dataset</title>
      <p>We assessed the impact of between-sample normalization by Cosbin and two peer methods (Total Count and DEGES/TCC) on MG quality using a benchmark gene expression dataset (GSE28490 comprised of <italic toggle="yes">K </italic>=<italic toggle="yes"> </italic>5 groups). Total Count represents the baseline method and DEGES/TCC represents the most competitive peer method (<xref rid="vbac076-B2" ref-type="bibr">Evans <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="vbac076-B15" ref-type="bibr">Zhao <italic toggle="yes">et al.</italic>, 2020</xref>). The definition of MG and related discussion are given in <xref rid="sup1" ref-type="supplementary-material">Supplementary Information</xref>. The quality of MGs is evaluated quantitatively by:
<disp-formula id="E4"><label>(4)</label><mml:math id="M4" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>(</mml:mo><mml:mi>K</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>MG</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>MG</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></disp-formula>
where, <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mi>M</mml:mi></mml:math></inline-formula> is the number of MGs, and <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>. By the definition of MG (<xref rid="vbac076-B10" ref-type="bibr">Parker <italic toggle="yes">et al.</italic>, 2020</xref>), an ideal MG expression matrix corresponds to a row-permutation matrix with its minimum zero value attained using the <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> index. The larger the <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> value, the poorer the quality of MGs.</p>
      <p>The top 144 MGs were detected after normalization by total count, TCC and Cosbin; the geometric proximity of these MGs to the vertices of the scatter simplex is shown in <xref rid="vbac076-F3" ref-type="fig">Figure 3a</xref> (color-coded). Results show that Cosbin outperforms the Total Count and DEGES/TCC in terms of higher MG quality. Notably, Cosbin achieves a lower <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="normal">Cosbin</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1.566</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> when compared with <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="normal">TCC</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1.929</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="normal">total</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="normal">count</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1.925</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>. These improvements by Cosbin correspond to a relative reduction of 18.8% over TCC and 18.6% over total count in terms of <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> index. We further calculated the ADD of the top 144 MGs in relation to the ideal reference, which is summarized in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S4</xref>. Again, Cosbin achieves a much lower <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="italic">ADD</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="normal">Cosbin</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2.4210</mml:mn></mml:math></inline-formula> when compared with <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="italic">ADD</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="normal">TCC</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2.7330</mml:mn></mml:math></inline-formula> and <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="italic">ADD</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="normal">total</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="normal">count</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2.6980</mml:mn></mml:math></inline-formula>. These improvements by Cosbin correspond to a relative reduction of 11.4% over TCC and 10.3% over total count in terms of the ADD.</p>
      <fig position="float" id="vbac076-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Case study of Cosbin impact on the quality of MGs and SSGs using gene expression and proteomics data. (<bold>a</bold>) Scatter simplex of GSE28490 superimposed by the top 144 MGs (color-coded) detected after normalization by total count, DEGES/TCC and Cosbin, respectively; where black triangle indicates the ideal MG references. (<bold>b</bold>) Anatomic description of the specimens. (<bold>c</bold>) Heatmap of top 72 SSGs detected after normalization by Cosbin on vascular proteomics data</p>
        </caption>
        <graphic xlink:href="vbac076f3" position="float"/>
      </fig>
      <p>This benchmarking study also indirectly shows consistent relative performances of these methods, as was also observed in the mixture simulation study, and that DEGES/TCC appears to be less effective for normalizing biologically diverse samples. Additional experimental results and discussion are presented in <xref rid="sup1" ref-type="supplementary-material">Supplementary Information</xref> (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S9</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S4</xref>).</p>
    </sec>
    <sec>
      <title>3.3 Case study of Cosbin on subtype signature genes using vascular proteomics data</title>
      <p>We further demonstrated the utility of Cosbin on normalizing experimentally acquired proteomics data from biologically diverse samples for the purpose of detecting subtype signature genes (SSGs). The dataset was obtained from a cohort of ‘pure’ fibrous plaque (FP, <italic toggle="yes">n</italic> = 4), fatty streak (FS, <italic toggle="yes">n</italic> = 3), and normal (<italic toggle="yes">n</italic> = 3) vascular specimens (<xref rid="vbac076-F3" ref-type="fig">Fig. 3b</xref>) (<xref rid="vbac076-B10" ref-type="bibr">Parker <italic toggle="yes">et al.</italic>, 2020</xref>). After normalization over 824 proteins by Cosbin, 31 SSGFP, 23 SSGFS and 18 SSGNL, are detected. The corresponding heatmap is shown in <xref rid="vbac076-F3" ref-type="fig">Figure 3c</xref>, the scatter simplex with color-coded SSG is given in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S10</xref>, and the protein names are listed in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref>.</p>
      <p>Closer interrogation of the functions associated with the 72 SSG linked to each subtype underscores the biological validity of this analysis. Excitingly, this analysis allowed us to find some very interesting hits in FS with a convincing link to Nuclear Factor of kappa B (NFκB), an established mediator of early atherogenesis. The 14 of 23 SSGFS could be associated with NFκB signaling, including regulators of NFκB activation such as MCAM, CAST, KTN1 and NDRG1; coactivators of NFκB transcriptional activity DHX9 and DDX1; and numerous known NFκB response genes UGDH, CPNE3, ACAN, TMOD1, GNB2, CYBRD1, SND1 and TUBB6. The NFκB pathway is implicated in early atherogenesis as a mediator of proinflammatory signaling due to the retention of oxidized lipid species. Of particular note, MCAM/CD146 is known to be a major NFκB coactivator and has been identified as a key molecule in the promotion and retention of foam cells, which are the definitive feature of the FS tissue samples. The FP stage of the disease has been well characterized by our group (<xref rid="vbac076-B3" ref-type="bibr">Herrington <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="vbac076-B10" ref-type="bibr">Parker <italic toggle="yes">et al.</italic>, 2020</xref>), to be upregulated in expression of proteins associated with the acute phase (e.g. C7, A2M and SAA4), immune (e.g. immunoglobulin genes), and apolipoprotein accumulation (e.g. APOB, APOD, APOE, APOA1/2 and APOC3). The SSGNL have functions related to cell adhesion (LIMS1, ITGA7, SPARCL1, SPON1 and TLN2), muscle cell biology (KRT8, MYL9 and SLMAP) and cytoskeletal organization (PDLIM1, SYNM, VASP and NEXN).</p>
      <p>Overall, the SSGs identified here reflect the established biological distinctions between a quiescent contractile healthy normal artery, the early stages of inflammatory response observed in FSs and the late-stage inflammatory and immunogenic biology of later-stage FPs. Furthermore, these data support prior contentions that early intervention at the level of FS accumulation by the use of NFκB modulating drugs may be a viable strategy for slowing atherosclerotic progression.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>The Cosbin R package provides an efficient and accurate tool for normalizing biologically diverse samples, specifically addressing the challenge of bias due to significant asymmetry in differential expression across multiple conditions (<xref rid="vbac076-B2" ref-type="bibr">Evans <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="vbac076-B7" ref-type="bibr">Johnson and Krishnan 2022</xref>). Our study demonstrated that the elimination of significantly aDEGs is essential for obtaining good normalized data across biologically diverse samples. The proposed cosine-based test scores <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">cos</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">e</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula> or <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">cos</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mo> </mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula> matched exactly the definition of significantly aDEGs or iCEGs. The experimental results show that Cosbin outperforms existing peer methods, particularly for addressing biased normalization due to significant asymmetry in differential expressions. While the case studies here involve only transcripts and proteins, the Cosbin method and software tool are readily applicable to other omics data types.</p>
    <p>Biologically diverse samples may be defined by two subtly different factors: a large portion of symmetric differential expression or a large portion of asymmetry in differential expressions (<xref rid="vbac076-B2" ref-type="bibr">Evans <italic toggle="yes">et al.</italic>, 2018</xref>). Global adjustment methods have been developed specifically for use when there are many symmetrically and differentially expressed genes. We thus recommend that users apply the quantro tool in a first attempt prior to Cosbin in order to readily assess whether some existing global adjustment methods designed for normalizing biologically diverse samples (containing many general DEGs but not aDEGs) are readily applicable (<xref rid="vbac076-B4" ref-type="bibr">Hicks and Irizarry 2015</xref>; <xref rid="vbac076-B5" ref-type="bibr">Hicks <italic toggle="yes">et al.</italic>, 2018</xref>).</p>
    <p>In relation to previous work, our goal of eliminating significant DEGs from determining normalization factors has also been addressed in prior work (<xref rid="vbac076-B13" ref-type="bibr">Sun <italic toggle="yes">et al.</italic>, 2013</xref>; <xref rid="vbac076-B14" ref-type="bibr">Wang <italic toggle="yes">et al.</italic>, 2002</xref>). For example, pairwise fold change has been used to detect and eliminate DEGs, and an iterative total count on remaining genes is calculated to normalize samples between two groups (<xref rid="vbac076-B14" ref-type="bibr">Wang <italic toggle="yes">et al.</italic>, 2002</xref>). Similarly, in DEGES, conventional statistical testing is first applied to detect and eliminate DEGs; various size-factor-based methods are then used to perform normalization (<xref rid="vbac076-B13" ref-type="bibr">Sun <italic toggle="yes">et al.</italic>, 2013</xref>). The unique property of Cosbin is that two cosine scores are specifically designed and used, one to detect and eliminate aDEGs and another to detect iCEGs, across multiple conditions and the final sample-wise normalization factors are determined only by the total count of iCEGs. Furthermore, Cosbin is readily applicable to datasets containing missing values, with the assumption that a sufficient number of iCEGs contain no missing value, where normalization factors are calculated by Cosbin using a complete data matrix and then used to normalize the full data matrix in both interim and final normalizations.</p>
    <p>Potential limitations associated with the assumptions made by the current Cosbin design include that no excessive global shift in expression occurs (<xref rid="vbac076-B2" ref-type="bibr">Evans <italic toggle="yes">et al.</italic>, 2018</xref>), the distribution of remaining general DEGs is approximately ‘symmetric’, a sufficient number of iCEGs exist and technical effects impact iCEGs and general DEGs alike across all biologically diverse samples. As a follow-up step, batch effect adjustment may be performed when needed (<xref rid="vbac076-B1" ref-type="bibr">Clarke <italic toggle="yes">et al.</italic>, 2008</xref>). For normalizing samples across multiple conditions, a two-stage phased normalization strategy is recommended in which within-condition samples (biologically similar) are firstly normalized using Total Count and then between-condition samples (biologically diverse) are then normalized using Cosbin (<xref rid="vbac076-B15" ref-type="bibr">Zhao <italic toggle="yes">et al.</italic>, 2020</xref>). For evaluating normalization performance, while PCR data are often used as a ‘gold standard’ to determine ‘true’ differential expression, we note that the practice of treating PCR as the ‘ground truth’ may not always be justified: there has been concern over possible errors in PCR data (<xref rid="vbac076-B2" ref-type="bibr">Evans <italic toggle="yes">et al.</italic>, 2018</xref>).</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the National Institutes of Health [HL111362-05A1, HL133932 and NS115658-01]; and the Department of Defence [W81XWH-18-1-0723 (BC171885P1)].</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>vbac076_Supplementary_Data</label>
      <media xlink:href="vbac076_supplementary_data.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec sec-type="data-availability">
    <title>Data Availability</title>
    <p>Benchmark dataset used in this paper can be downloaded from Gene Expression Omnibus (<ext-link xlink:href="https://www.ncbi.nlm.nih.gov/geo/" ext-link-type="uri">https://www.ncbi.nlm.nih.gov/geo/</ext-link>) under the accession number: GSE28490.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="vbac076-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Clarke</surname><given-names>R.</given-names></string-name></person-group><etal>et al</etal> (<year>2008</year>) <article-title>The properties of high-dimensional data spaces: implications for exploring gene and protein expression data</article-title>. <source>Nat. Rev. Cancer</source>, <volume>8</volume>, <fpage>37</fpage>–<lpage>49</lpage>.<pub-id pub-id-type="pmid">18097463</pub-id></mixed-citation>
    </ref>
    <ref id="vbac076-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Evans</surname><given-names>C.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>Selecting between-sample RNA-Seq normalization methods from the perspective of their assumptions</article-title>. <source>Brief. Bioinformatics</source>, <volume>19</volume>, <fpage>776</fpage>–<lpage>792</lpage>.<pub-id pub-id-type="pmid">28334202</pub-id></mixed-citation>
    </ref>
    <ref id="vbac076-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Herrington</surname><given-names>D.M.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>Proteomic architecture of human coronary and aortic atherosclerosis</article-title>. <source>Circulation</source>, <volume>137</volume>, <fpage>2741</fpage>–<lpage>2756</lpage>.<pub-id pub-id-type="pmid">29915101</pub-id></mixed-citation>
    </ref>
    <ref id="vbac076-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hicks</surname><given-names>S.C.</given-names></string-name>, <string-name><surname>Irizarry</surname><given-names>R.A.</given-names></string-name></person-group> (<year>2015</year>) <article-title>quantro: a data-driven approach to guide the choice of an appropriate normalization method</article-title>. <source>Genome Biol</source>., <volume>16</volume>, <fpage>117</fpage>.<pub-id pub-id-type="pmid">26040460</pub-id></mixed-citation>
    </ref>
    <ref id="vbac076-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hicks</surname><given-names>S.C.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>Smooth quantile normalization</article-title>. <source>Biostatistics</source>, <volume>19</volume>, <fpage>185</fpage>–<lpage>198</lpage>.<pub-id pub-id-type="pmid">29036413</pub-id></mixed-citation>
    </ref>
    <ref id="vbac076-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jo</surname><given-names>J.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Conventionally used reference genes are not outstanding for normalization of gene expression in human cancer research</article-title>. <source>BMC Bioinformatics</source>, <volume>20</volume>, <fpage>245</fpage>.<pub-id pub-id-type="pmid">31138119</pub-id></mixed-citation>
    </ref>
    <ref id="vbac076-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Johnson</surname><given-names>K.A.</given-names></string-name>, <string-name><surname>Krishnan</surname><given-names>A.</given-names></string-name></person-group> (<year>2022</year>) <article-title>Robust normalization and transformation techniques for constructing gene coexpression networks from RNA-seq data</article-title>. <source>Genome Biol</source>., <volume>23</volume>, <fpage>1</fpage>.<pub-id pub-id-type="pmid">34980209</pub-id></mixed-citation>
    </ref>
    <ref id="vbac076-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Love</surname><given-names>M.I.</given-names></string-name></person-group><etal>et al</etal> (<year>2014</year>) <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>. <source>Genome Biol</source>., <volume>15</volume>, <fpage>550</fpage>.<pub-id pub-id-type="pmid">25516281</pub-id></mixed-citation>
    </ref>
    <ref id="vbac076-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lu</surname><given-names>Y.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>COT: an efficient and accurate method for detecting marker genes among many subtypes</article-title>. <source>Bioinform. Adv</source>., <volume>2</volume>, <fpage>vbac037</fpage>.<pub-id pub-id-type="pmid">35673616</pub-id></mixed-citation>
    </ref>
    <ref id="vbac076-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Parker</surname><given-names>S.J.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Identification of putative early atherosclerosis biomarkers by unsupervised deconvolution of heterogeneous vascular proteomes</article-title>. <source>J. Proteome Res</source>., <volume>19</volume>, <fpage>2794</fpage>–<lpage>2806</lpage>.<pub-id pub-id-type="pmid">32202800</pub-id></mixed-citation>
    </ref>
    <ref id="vbac076-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Paulson</surname><given-names>J.N.</given-names></string-name></person-group><etal>et al</etal> (<year>2013</year>) <article-title>Differential abundance analysis for microbial marker-gene surveys</article-title>. <source>Nat. Methods</source>., <volume>10</volume>, <fpage>1200</fpage>–<lpage>1202</lpage>.<pub-id pub-id-type="pmid">24076764</pub-id></mixed-citation>
    </ref>
    <ref id="vbac076-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Robinson</surname><given-names>M.D.</given-names></string-name>, <string-name><surname>Oshlack</surname><given-names>A.</given-names></string-name></person-group> (<year>2010</year>) <article-title>A scaling normalization method for differential expression analysis of RNA-seq data</article-title>. <source>Genome Biol</source>., <volume>11</volume>, <fpage>R25</fpage>.<pub-id pub-id-type="pmid">20196867</pub-id></mixed-citation>
    </ref>
    <ref id="vbac076-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sun</surname><given-names>J.</given-names></string-name></person-group><etal>et al</etal> (<year>2013</year>) <article-title>TCC: an R package for comparing tag count data with robust normalization strategies</article-title>. <source>BMC Bioinformatics</source>, <volume>14</volume>, <fpage>219</fpage>.<pub-id pub-id-type="pmid">23837715</pub-id></mixed-citation>
    </ref>
    <ref id="vbac076-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>Y.</given-names></string-name></person-group><etal>et al</etal> (<year>2002</year>) <article-title>Iterative normalization of cDNA microarray data</article-title>. <source>IEEE Trans. Inf. Technol. Biomed</source>., <volume>6</volume>, <fpage>29</fpage>–<lpage>37</lpage>.<pub-id pub-id-type="pmid">11936594</pub-id></mixed-citation>
    </ref>
    <ref id="vbac076-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhao</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Misuse of RPKM or TPM normalization when comparing across samples and sequencing protocols</article-title>. <source>RNA</source>, <volume>26</volume>, <fpage>903</fpage>–<lpage>909</lpage>.<pub-id pub-id-type="pmid">32284352</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
