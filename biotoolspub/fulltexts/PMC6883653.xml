<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6883653</article-id>
    <article-id pub-id-type="publisher-id">1884</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-019-1884-z</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ReorientExpress: reference-free orientation of nanopore cDNA reads with deep learning</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Ruiz-Reche</surname>
          <given-names>Angel</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Srivastava</surname>
          <given-names>Akanksha</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Indi</surname>
          <given-names>Joel A.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>de la Rubia</surname>
          <given-names>Ivan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0793-6218</contrib-id>
        <name>
          <surname>Eyras</surname>
          <given-names>Eduardo</given-names>
        </name>
        <address>
          <email>eduardo.eyras@anu.edu.au</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2172 2676</institution-id><institution-id institution-id-type="GRID">grid.5612.0</institution-id><institution>Pompeu Fabra University, </institution></institution-wrap>E08003 Barcelona, Spain </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2180 7477</institution-id><institution-id institution-id-type="GRID">grid.1001.0</institution-id><institution>The John Curtin School of Medical, </institution><institution>Australian National University, </institution></institution-wrap>Acton ACT, Canberra, 2601 Australia </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2180 7477</institution-id><institution-id institution-id-type="GRID">grid.1001.0</institution-id><institution>EMBL Australia Partner Laboratory Network and the Australian National University, </institution></institution-wrap>Acton ACT, Canberra, 2601 Australia </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2181 4263</institution-id><institution-id institution-id-type="GRID">grid.9983.b</institution-id><institution>Instituto de Medicina Molecular, Faculdade de Medicina, </institution><institution>Universidade de Lisboa, </institution></institution-wrap>Lisbon, Portugal </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1767 9005</institution-id><institution-id institution-id-type="GRID">grid.20522.37</institution-id><institution>IMIM - Hospital del Mar Medical Research Institute, </institution></institution-wrap>E08003 Barcelona, Spain </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>29</day>
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>260</elocation-id>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>4</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>7</day>
        <month>11</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">We describe ReorientExpress, a method to perform reference-free orientation of transcriptomic long sequencing reads. ReorientExpress uses deep learning to correctly predict the orientation of the majority of reads, and in particular when trained on a closely related species or in combination with read clustering. ReorientExpress enables long-read transcriptomics in non-model organisms and samples without a genome reference without using additional technologies and is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/comprna/reorientexpress">https://github.com/comprna/reorientexpress</ext-link>.</p>
    </abstract>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100011033</institution-id>
            <institution>Agencia Estatal de Investigación</institution>
          </institution-wrap>
        </funding-source>
        <award-id>BIO2017-85364-R</award-id>
        <award-id>MDM-2014-0370</award-id>
        <award-id>PRE2018-083413</award-id>
        <principal-award-recipient>
          <name>
            <surname>Eyras</surname>
            <given-names>Eduardo</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003030</institution-id>
            <institution>Agència de Gestió d’Ajuts Universitaris i de Recerca</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2017 SGR 1020</award-id>
        <principal-award-recipient>
          <name>
            <surname>Eyras</surname>
            <given-names>Eduardo</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Fundação para a Ciência e a Tecnologia</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par2">Long-read sequencing technologies allow the systematic interrogation of transcriptomes from any species. However, functional characterization requires knowledge of the correct 5′-to-3′ orientation of reads. Oxford Nanopore Technologies (ONT) allows the direct measurement of RNA molecules in the native orientation [<xref ref-type="bibr" rid="CR1">1</xref>], but the sequencing of complementary-DNA (cDNA) libraries yields generally a larger number of reads [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. Although strand-specific adapters can be used, error rates hinder their correct detection. Current methods to analyze nanopore transcriptomic reads rely on the comparison to a genome or transcriptome reference [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>] or on the use of additional technologies such as in “hybrid sequencing” that employs long- and short-read data [<xref ref-type="bibr" rid="CR4">4</xref>], which limits the applicability of rapid and cost-effective long-read sequencing for transcriptomics beyond model species. To facilitate the de novo interrogation of transcriptomes in species or samples for which a genome or transcriptome reference is not available, we have developed ReorientExpress, a new tool to perform reference-free orientation of ONT reads from a cDNA library. ReorientExpress uses deep neural networks (DNNs) to predict the orientation of cDNA long reads independently of adapters and without using a reference. ReorientExpress predicts correctly the orientation of the majority of cDNA reads, and in particular when trained on a related species or in combination with read clustering, thereby enabling the reference-free characterization of transcriptomes.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>Sequence-based prediction of read orientation</title>
      <p id="Par3">ReorientExpress approach builds on the hypothesis that RNA molecules present sequence biases and motifs relevant to their metabolism, generally related to protein binding sites [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>]. Despite potential sequencing errors, these signals may still be largely present in a long read and therefore should enable the identification of the right orientation of a cDNA read. ReorientExpress implements two types of deep neural network (DNN) models to classify long reads as being in the forward (5′-to-3′) orientation or in the reverse (3′-to-5′) orientation (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a, b). The first DNN model is a multilayer perceptron (MLP) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). In this model, an input sequence is represented in terms of the frequency of short motifs (<italic>k</italic>-mers). This ensures a fixed-size input for molecules of different lengths and accounts for the fact that sequencing errors may not allow to correctly capture longer sequence patterns. Furthermore, neural networks work better with input values between 0 and 1. Accordingly, the input of the MLP model is a matrix of normalized <italic>k</italic>-mer counts from the input sequences, with <italic>k</italic> from 1 to any length specified as parameter (default = 5) as shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>a. Although MLPs are simpler and faster to train and run, they do not capture the sequence context dependencies. For this reason, ReorientExpress also implements a convolutional neural network (CNN) that can capture the spatial information (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2). As input for the CNN model, sequences were divided into overlapping windows of fixed size, which were then transformed using one-hot encoding. The orientation of a read is based on the mean of the posterior probabilities for all windows in a read for forward and reverse orientation and thereafter by selecting the one with the highest value (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). Regardless of the DNN model, ReorientExpress can be trained from any set of sequences with known orientations, like a transcriptome annotation or ONT direct RNA sequencing (DRS) reads.
<fig id="Fig1"><label>Fig. 1</label><caption><p>ReorientExpress deep learning models. ReorientExpress implements two deep neural networks (DNNs) to predict the orientation of cDNA long reads. <bold>a</bold> A multilayer perceptron (MLP) is trained on <italic>k</italic>-mer frequencies extracted from sequences of known orientation. For each test read, the orientation is predicted using the <italic>k</italic>-mer frequencies of the read as input. <bold>b</bold> A convolutional neural network (CNN) is trained on 500-nt sliding windows from sequences of known orientation, using one-hot encoding for each window. Prediction is performed by scoring all windows in a test read and calculating the mean score independently for each orientation</p></caption><graphic xlink:href="13059_2019_1884_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par4">To test ReorientExpress, we first trained the MLP model on 50,000 random transcripts from the human annotation using <italic>k</italic>-mers from <italic>k</italic> = 1 to <italic>k</italic> = 5. To enable the accuracy evaluation with ONT cDNA reads with unknown orientation, we first mapped human ONT cDNA reads to their respective transcriptomes using minimap2 [<xref ref-type="bibr" rid="CR7">7</xref>]. Thereafter, we selected only uniquely mapped reads with maximum quality (MAPQ = 60), and assigned to each read the strand from the matched annotated transcript. Using these orientations as ground truth, the MLP model trained on human transcriptome yielded an average precision of 0.84 and a recall of 0.83 in human cDNA reads (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3). The CNN model trained on the human transcriptome showed slightly better results on the human cDNA reads (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3). We proceeded in a similar way with <italic>S. cerevisiae</italic> cDNA reads [<xref ref-type="bibr" rid="CR1">1</xref>], as described above for human cDNA reads. ReorientExpress trained on the <italic>S. cerevisiae</italic> annotation yielded an average precision and recall of 0.93 in ONT cDNA reads from <italic>S. cerevisiae</italic> (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3). Similar to the above observation in human cDNA, the accuracy of the CNN model on the <italic>S. cerevisiae</italic> reads was slightly better than the MLP model (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3). Application of the MLP or CNN models trained on human transcriptome to direct RNA sequencing (DRS) reads yielded better accuracy for human DRS reads compared to human cDNA reads. However, the accuracy decreased for both MLP and CNN model trained on <italic>S. cerevisiae</italic> transcriptome and tested on <italic>S. cerevisiae</italic> DRS reads compared to <italic>S. cerevisiae</italic> cDNA reads (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3).
<fig id="Fig2"><label>Fig. 2</label><caption><p>ReorientExpress accuracy analysis. <bold>a</bold> Receiving operating characteristic (ROC) curves, representing the false positive rate (<italic>x</italic> axis) versus the true positive rate (<italic>y</italic> axis) for the prediction of the orientation of human ONT cDNA reads with the multilayer perceptron (MLP) and convolutional neural network (CNN) models trained on either the human (Hs) or the mouse (Mm) transcripts. <bold>b</bold> ROC curves for the prediction of the orientation of yeast ONT cDNA reads with the MLP and CNN models trained on either the <italic>S. cerevisiae</italic> (Sc) or <italic>C. glabrata</italic> (Cg) transcripts. <bold>c</bold> Number of clusters (<italic>y</italic> axis) according to the proportion of human ONT cDNA reads in the cluster with orientation correctly predicted by ReorientExpress (<italic>x</italic> axis) with the MLP model trained on the human transcriptome (left panel) (Hs-MLP) or the <italic>S. cerevisiae</italic> transcriptome (right panel) (Sc-MLP). Clusters with &gt; 2 reads are shown. Similar plots for all clusters (&gt; 1 read) and for the CNN model are given in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1. <bold>d</bold> Comparison of the proportion of human (Hs) or <italic>S. cerevisiae</italic> (Sc) cDNA reads correctly oriented in three cases: taking the default orientation from the FASTQ file (Default) in blue, using the CNN and MLP ReorientExpress models in green, and using a majority vote in clusters to predict the orientation of all reads in each cluster (ReorientExpress and clustering) in yellow. Clustering and predictions in (<bold>c</bold>) and (<bold>d</bold>) were performed with all labeled cDNA reads (see the “<xref rid="Sec7" ref-type="sec">Methods</xref>” section). Models used to on the total set of labeled cDNA reads in this figure were trained on 50,000 randomly selected transcript sequences from the annotation, or all of them if there were less (<italic>S. cerevisiae</italic> and <italic>C. glabrata</italic>)</p></caption><graphic xlink:href="13059_2019_1884_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par5">To demonstrate the suitability of ReorientExpress to predict the orientation of cDNA reads from samples without a genome or transcriptome reference available, we mimicked this situation by building DNN models in one species and testing them on a related species. We thus trained an MLP model (<italic>k</italic> = 1,…,5) with the mouse transcriptome. This model tested on human ONT cDNA reads showed a precision of 0.79 and recall of 0.71, which is comparable to the MLP model trained on human data (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4). Interestingly, this model showed a higher accuracy (precision and recall = 0.87) when tested on human DRS reads as compared to human cDNA reads (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4). We also trained an MLP model (<italic>k</italic> = 1,…,5) with the transcriptome annotation for <italic>Candida glabrata</italic> and tested it on <italic>S. cerevisiae</italic> ONT cDNA reads. This model yielded accuracy values as high as for the previous <italic>S. cerevisiae</italic> model (precision and recall = 0.94) (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4). As observed before for <italic>S. cerevisiae</italic> DRS reads, the model accuracy dropped when tested on DRS reads (precision and recall = 0.87) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4). We obtained similar results for the cross-species comparisons with the CNN model, with an improvement in accuracy for the mouse model applied to human DRS reads, and a drop for the <italic>C. glabrata</italic> model applied to <italic>S. cerevisiae</italic> DRS reads (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4).</p>
      <p id="Par6">Reference-free interpretation of long-read transcriptome data generally involves some form of clustering [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>]. Thus, to further demonstrate the utility of ReorientExpress for reference-free interrogation of transcriptomes with long-reads, we performed clustering of the cDNA reads (see the “<xref rid="Sec7" ref-type="sec">Methods</xref>” section). For the majority of clusters in human (&gt; 81%) and <italic>S. cerevisiae</italic> (&gt; 85%), ReorientExpress predicted correctly more than 50% of the reads in the cluster (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1) (the proportion of clusters for each model can be found in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5). That is, for most clusters, more than half the reads in those clusters can be correctly oriented. Accordingly, by taking the orientation of the cluster to be determined by that of the majority of reads, we could improve the overall orientation. To test this, we applied a majority vote per cluster to set the orientation of all reads in the cluster to be the majority label predicted by ReorientExpress. With this, ReorientExpress established the right orientation for the majority of cDNA reads for human and yeast, with up to 96.2% of human reads and up to 98% of <italic>S. cerevisiae</italic> reads correctly oriented (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S6).</p>
    </sec>
    <sec id="Sec4">
      <title>Comparisons with other models and inputs</title>
      <p id="Par7">Interestingly, inverting the procedure and training with ONT cDNA reads yields good accuracy when testing on annotated transcripts, but when training on ONT DRS reads the accuracy decreases (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S7). This could be a consequence of a higher proportion of base-calling errors in DRS reads due to the presence of RNA modifications, leading to a decrease in the identification of relevant sequence motifs learned by the model. To test this, we trained the MLP model with DRS reads from in vitro transcribed (IVT) RNA [<xref ref-type="bibr" rid="CR2">2</xref>] and obtained slightly better accuracy than with DRS reads when testing on cDNA reads (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S7). Additionally, we observed no dependency with the base-caller used to obtain the sequence of reads. In particular, using Guppy-rapid or Guppy-high accuracy to base-call the IVT RNA reads did not show any differences in the accuracy of the MLP model (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S8). This indicates that DRS errors may prevent accurate training of sequence-based models.</p>
      <p id="Par8">We also observed dependency of the accuracy with the length of the reads. The prediction accuracy decreased for shorter reads (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S8), which suggests that either short molecules or partial reads may pose a limitation for the accurate prediction of orientation. To further test the effect of read length on the prediction accuracy, we trimmed a number of nucleotides from both ends of the cDNA reads in the test set. The accuracy was not significantly impacted performing trimming up to 200 nt (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S9). Similarly, when we trimmed the training set by different amounts up to 200 nt, leaving fixed the test set, the accuracy did not change significantly (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S10). Thus, incomplete annotations can still be valid to train a model, and complete annotations can yield accurate results on partial reads. This is relevant for the application to cDNA reads, which may be fragmented due to internal priming [<xref ref-type="bibr" rid="CR10">10</xref>]. These results also indicate that DNN models are able to capture predictive features beyond the presence of adapters or poly-A tails to predict the 5′-to-3′ orientation of RNA molecules.</p>
      <p id="Par9">For comparison, we run pychopper (<ext-link ext-link-type="uri" xlink:href="https://github.com/nanoporetech/pychopper">https://github.com/nanoporetech/pychopper</ext-link>), which can identify the orientation of cDNA reads by virtue of detecting the sequencing adapters (see the “<xref rid="Sec7" ref-type="sec">Methods</xref>” section). We analyzed all cDNA reads whose orientation was labeled previously. For the human cDNA reads, only ~ 23.5% were classified accurately by pychopper. We also compared the accuracy of ReorientExpress with primer-chop (<ext-link ext-link-type="uri" xlink:href="https://gitlab.com/mcfrith/primer-chop">https://gitlab.com/mcfrith/primer-chop</ext-link>), which produced the correct orientation for ~ 54% of all reads tested. These results justify the use of more sophisticated models to predict orientation. Additionally, we trained and tested a support vector machine (SVM) and a Random Forest (RF), using as inputs the same <italic>k</italic>-mer frequencies. Both methods showed worse accuracy compared to the MLP model for the same test data. However, for <italic>S. cerevisiae</italic> the accuracy of both models trained with the <italic>S. cerevisiae</italic> annotation was high (precision and recall 0.86 for the RF, and 0.95 for the SVM) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S10). Finally, we also tested ReorientExpress with PacBio cDNA reads from sorghum [<xref ref-type="bibr" rid="CR11">11</xref>]. We trained two MLP models, one with the Ensembl cDNA annotations from sorghum and another with maize. Both models showed high accuracy when tested against Sorghum PacBio reads (precision and recall ~ 0.95) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S12).</p>
    </sec>
    <sec id="Sec5">
      <title>Association of RNA types and sequence motifs with read orientation prediction</title>
      <p id="Par10">Since we mapped long reads unambiguously to the transcriptome annotation for the purpose of benchmarking, we can use this information to investigate the accuracy of ReorientExpress according to the transcript type as provided by the Gencode annotation: protein-coding, processed transcript, lincRNA, etc. Applying the human CNN and MLP models to all labeled human cDNA reads, we observed that reads assigned to protein-coding transcripts, including transcripts from immunoglobulin-related genes, showed the highest accuracy with more than 85% correctly predicted (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a, b). In general, both models showed similar results, except for long non-coding RNAs (lncRNAs). Reads associated with lncRNAs from bidirectional promoters presented the same accuracy of the intergenic lncRNAs for the CNN model, but this was higher for the MLP model. Interestingly, even though “sense overlapping” and “sense intronic” transcripts were not used for training, reads assigned to them were correctly predicted in high proportion. In contrast, reads unambiguously associated with antisense or TEC (To be Experimentally Confirmed) transcripts showed smaller accuracies compared with the rest of annotation types. TEC transcripts are based on EST clusters and may lack the sequence properties from other transcript types. Finally, antisense transcripts appear difficult to predict correctly as they share sequence with transcripts annotated in the opposite strand. Nonetheless, inspection of the built clusters showed that the majority of clusters with antisense reads had all reads of type antisense. Indeed, 201 (78%) of clusters with at least one antisense read had 100% reads of type antisense, which corresponded to 90% (882) of the total of 976 antisense reads (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2).
<fig id="Fig3"><label>Fig. 3</label><caption><p>Read types and sequence motifs. The proportion of cDNA reads that were unambiguously mapped to each transcript type (<italic>y</italic> axis) and classified as correct (True) or incorrect (False) (<italic>x</italic> axis) by the CNN model (<bold>a</bold>) and the MLP model (<bold>b</bold>). All transcript type annotations from the autosomes and sex chromosomes with more than 10 reads mapped are represented in the plot. <bold>c</bold> The motifs derived from three CNN filters with significant matches to previously described RNA-binding motifs (Additional file <xref rid="MOESM3" ref-type="media">3</xref>): filter M24 (RBM42, <italic>q</italic>-value = 0.0165997), filter M17 (HuR, <italic>q</italic>-value = 0.0312701), and filter M9 (PCBP1, <italic>q</italic>-value = 0.0426708). As information content (<italic>y</italic> axis) is low, the axis scale is shown between 0 and 1</p></caption><graphic xlink:href="13059_2019_1884_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par11">To investigate whether ReorientExpress captures recognizable RNA motifs, we took advantage of the possibility to use the convolutional filters of the CNN to identify sequence motifs captured by the model as done previously [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR13">13</xref>] (see the “<xref rid="Sec7" ref-type="sec">Methods</xref>” section). From these filters, we found 32 candidate motifs (Additional file <xref rid="MOESM2" ref-type="media">2</xref>), which we compared with known protein-RNA binding motifs [<xref ref-type="bibr" rid="CR14">14</xref>]. This method detected motifs similar to those described for the RNA binding proteins PCBP1, ELAVL1 (HuR), and RBM42 (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c), among others (Additional file <xref rid="MOESM3" ref-type="media">3</xref>). Thus, sequence motifs that are relevant to predict molecule orientation recapitulate some of the binding specificities of proteins that control the metabolism of the RNA.</p>
    </sec>
  </sec>
  <sec id="Sec6">
    <title>Discussion</title>
    <p id="Par12">Here, we have shown that deep neural network (DNN) models trained on transcript sequences are able to provide an accurate orientation of cDNA long reads. We hypothesized that sequence motifs that are specific to RNA metabolism would be identifiable in long sequencing reads despite the presence of errors, and found that some of the sequences relevant to predict molecule orientation are similar to known motifs involved in RNA-protein binding. We described how DNN models maintained good accuracy despite using trimmed reads, and worked well on nanopore as well as on PacBio reads. ReorientExpress provides a crucial aid in the interpretation of transcripts using cDNA long reads in samples for which the genome reference is unavailable, as it is the case for many non-model organisms. In this context, identifying the right strand of cDNA reads helps in the accurate detection of open reading frames as well as sequence motifs relevant for RNA metabolism, thereby enabling gene regulation studies despite not having a genome reference available.</p>
    <p id="Par13">ReorientExpress can also be relevant in general for the study of human and model organisms beyond the available references. Direct analysis of the long reads from unstranded libraries is not only cost- and time-effective but also can accurately identify antisense transcripts that are known to play important regulatory roles. Accurate identification of read orientation can provide better estimates of expression levels of sense and antisense genes, which in turn will improve our understanding of the transcriptome and of gene evolution [<xref ref-type="bibr" rid="CR15">15</xref>]. Establishing the orientation of cDNA long reads without relying on a particular genome reference is also relevant to determine gene sequence variability between individuals at different genomic scales, for instance in terms of short variations in exons [<xref ref-type="bibr" rid="CR16">16</xref>] or differences in gene content [<xref ref-type="bibr" rid="CR17">17</xref>].</p>
    <p id="Par14">Our analyses show that ReorientExpress can be very valuable in combination with long read clustering [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>] to facilitate more accurate downstream analyses of transcriptomes. The ability to predict the 5′-to-3′ orientation of cDNA long reads using models trained on related species makes ReorientExpress a key processing tool for the study of transcriptomes from non-model organisms with long-reads.</p>
  </sec>
  <sec id="Sec7">
    <title>Methods</title>
    <sec id="Sec8">
      <title>Training and testing ReorientExpress</title>
      <p id="Par15">ReorientExpress (<ext-link ext-link-type="uri" xlink:href="https://github.com/comprna/reorientexpress">https://github.com/comprna/reorientexpress</ext-link>) implements deep neural network (DNN) models using keras (<ext-link ext-link-type="uri" xlink:href="https://github.com/keras-team/keras">https://github.com/keras-team/keras</ext-link>) and Tensorflow (<ext-link ext-link-type="uri" xlink:href="https://github.com/tensorflow">https://github.com/tensorflow</ext-link>) [<xref ref-type="bibr" rid="CR18">18</xref>]. All input data is preprocessed to discard reads that contain N’s. For reads from direct RNA-seq experiments, uracil (U) is transformed into thymine (T). Input reads can be optionally trimmed, and this is done for the same length on both sides of each input sequence. For training purposes, a random selection of half the sequences is reverse-complemented to obtain a balanced training set. Optionally, all sequences can be reverse-complemented to double up the training input. ReorientExpress implements two different DNN models, a multi-layer perceptron (MLP) and a convolutional neural network (CNN). The MLP model has 5 hidden layers, with the last layer providing the probability that a read is not in the correct orientation, and with dropout layers to reduce overfitting (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). In the MLP model, sequences are processed to build a matrix of <italic>k</italic>-mer frequencies, from <italic>k</italic> = 1 up to a specified <italic>k</italic>-mer length (default <italic>k</italic> = 1,...,5). The normalization is performed per input sequence and per <italic>k</italic>-mer length. That is, for a fixed <italic>k</italic>, each <italic>k</italic>-mer count is divided by the total number of <italic>k</italic>-mers in the sequence of length <italic>L</italic>, so that frequency(<italic>k</italic>-mer) = count(<italic>k</italic>-mer)/(<italic>L</italic>-k + 1). Using the <italic>k</italic>-mer frequencies ensures that the input size is the same for all transcripts regardless of the transcript length. MLPs are simpler than CNNs, so they are faster to train and run. On the other hand, CNNs can model relative spatial relationships; hence, they can take sequence context into account. For this reason, we also included a CNN model in ReorientExpress. For the CNN model, we used an architecture similar to <italic>lenet</italic> [<xref ref-type="bibr" rid="CR19">19</xref>], with 3 convolutional layers, 3 pooling layers, and 3 dense layers, with different filter sizes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2). For the CNN model, each input sequence was divided into overlapping sequences of 500 nt, overlapping by 250 nt. For transcripts of length between 250 and 500, we added Ns at the end of the sequence. We used one hot encoding as input for each one of the 500-nt windows.</p>
      <p id="Par16">Once a model is trained, or given an already available model, ReorientExpress can predict the orientation of a set of unlabeled reads in <italic>prediction</italic> mode. ReorientExpress feeds the normalized <italic>k</italic>-mer counts for each read for the MLP model, or the sliding windows for the CNN model to predict the orientation. In the MLP model, the last layer has only one node, which applies a sigmoid function to approximate a probability from the score it receives. The probability can be interpreted as the certainty that the input read is not in the correct orientation. So, a read with a score greater than 0.5 is predicted to be in the wrong orientation and is reverse-complemented. For the CNN model, for each window tested, the output is a posterior of the orientation given that window. To provide a prediction for each input read, ReorientExpress takes the mean value for both orientations independently and outputs the orientation with the greatest mean.</p>
      <p id="Par17">The <italic>test</italic> mode is aimed at evaluating the accuracy of a model using as input sequences with known orientation. The program generates predictions for the input reads and compares them with the provided labels, returning a precision (proportion of the predictions that are correct), a recall (true positive rate, proportion of labeled cases that are correctly predicted), an F1-score (harmonic mean of precision and recall), and the total number of input reads. As input for any of the three modes, <italic>train</italic>, <italic>predict</italic>, and <italic>test</italic>, one can use three types of datasets: <italic>experimental</italic>, <italic>annotation</italic>, or <italic>mapped</italic>. Experimental data refers to any kind of long-read data for which the orientation is known, such as direct RNA-seq, and reads are considered to be given in the 5′-to-3′ orientation. Annotation data refers to the transcript sequences from a reference annotation, such as the human transcriptome reference. Annotation is considered to be in the right 5′-to-3′ orientation and can include the transcript type, such as protein coding and processed transcript. Mapped data refers to sequencing data, usually cDNA, whose orientation has been annotated by an independent method, e.g., by mapping the reads to a reference. In this case, a PAF file for the mapping, together with the FASTA/FASTQ file, is required. The labeled data is used for training or testing. In <italic>predict</italic> mode, the data does not require labeling and ReorientExpress provides a prediction. More details are provided at <ext-link ext-link-type="uri" xlink:href="https://github.com/comprna/reorientexpress">https://github.com/comprna/reorientexpress</ext-link>.</p>
    </sec>
    <sec id="Sec9">
      <title>Deep neural network (DNN) models tested</title>
      <p id="Par18">Models used for the analyses described in the manuscript are provided at <ext-link ext-link-type="uri" xlink:href="https://github.com/comprna/reorientexpress">https://github.com/comprna/reorientexpress</ext-link>. The human model was trained using the Gencode annotation release 28, and the mouse model was built using the mouse Gencode release M19. The Ensembl annotation (<ext-link ext-link-type="uri" xlink:href="https://fungi.ensembl.org/index.html">https://fungi.ensembl.org/</ext-link>) was used to train the <italic>Saccharomyces cerevisiae</italic> (R64-1-1) and the <italic>Candida glabrata</italic> (ASM254v2) models. Ensembl annotations (<ext-link ext-link-type="uri" xlink:href="http://plants.ensembl.org/Sorghum_bicolor/Info/Index">http://plants.ensembl.org</ext-link>) were used from sorghum (<italic>Sorghum bicolor</italic> NCBIv3) and from maize (<italic>Zea mays</italic> B73_RefGen_v4) to build models to test on PacBio data. From the annotation files, we only used the most frequent transcript annotation types: protein coding, lincRNA, processed transcripts, antisense, and retained intron. We trained the models using 50,000 randomly selected transcript sequences from the annotation, or all of them if there were less than 50,000 (<italic>S. cerevisiae</italic> and <italic>C. glabrata</italic>). The results did not change when running the analysis with different sets of 50,000 transcripts.</p>
    </sec>
    <sec id="Sec10">
      <title>Test datasets</title>
      <p id="Par19">To test ReorientExpress on cDNA reads, we first calculated a set of cDNA reads for which orientation could be determined unambiguously in an independent way. We used human cDNA from the Nanopore consortium (cDNA 1D pass reads from JHU run 1) [<xref ref-type="bibr" rid="CR2">2</xref>] (available from <ext-link ext-link-type="uri" xlink:href="https://github.com/nanopore-wgs-consortium/NA12878/blob/master/nanopore-human-transcriptome/fastq_fast5_bulk.md">https://github.com/nanopore-wgs-consortium/NA12878/blob/master/nanopore-human-transcriptome/fastq_fast5_bulk.md</ext-link>) and <italic>S. cerevisiae</italic> cDNA reads [<xref ref-type="bibr" rid="CR1">1</xref>] from SRA (SRR6059708). We mapped the cDNA reads to the corresponding transcriptome annotation using minimap2 [<xref ref-type="bibr" rid="CR7">7</xref>] without secondary alignments (minimap2 -cx map-ont -t7 --secondary=no). We kept only reads with maximum mapping quality (MAPQ = 60) and that were uniquely mapping. For human, 899,431 out of 962,598 reads were mapped in this way, 282,444 of which had MAPQ = 60. After removing the ~ 4% multimapping cases, we finally obtained 270,296 reads with orientation unambiguously assigned. For <italic>S. cerevisiae</italic>, 4,000,698 out of a total of 5,045,243 reads were mapped, 3,089,543 of which had MAPQ = 60. After removing the ~ 3% multimapping cases, we finally obtained 2,984,873 reads with orientation unambiguously assigned. Additionally, we used direct RNA sequencing (DRS) for human (JHU Run 1 available from <ext-link ext-link-type="uri" xlink:href="https://github.com/nanopore-wgs-consortium/NA12878/blob/master/nanopore-human-transcriptome/fastq_fast5_bulk.md">https://github.com/nanopore-wgs-consortium/NA12878/blob/master/nanopore-human-transcriptome/fastq_fast5_bulk.md</ext-link>) and for <italic>S. cerevisiae</italic> from SRA (SRR6059706) [<xref ref-type="bibr" rid="CR1">1</xref>]. We also tested ReorientExpress with PacBio cDNA reads from sorghum [<xref ref-type="bibr" rid="CR11">11</xref>] (data available at <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/49944#.XCkXQC-ZN24">https://zenodo.org/record/49944#.XCkXQC-ZN24</ext-link>). We trained two MLP models with the Ensembl cDNA annotations (<ext-link ext-link-type="uri" xlink:href="http://plants.ensembl.org/Sorghum_bicolor/Info/Index">http://plants.ensembl.org</ext-link>) from sorghum (<italic>Sorghum bicolor</italic> NCBIv3) and maize (<italic>Zea mays</italic> B73_RefGen_v4).</p>
    </sec>
    <sec id="Sec11">
      <title>Other models for comparison</title>
      <p id="Par20">We tested a Random Forest model and an SVM model using Scikit-learn [<xref ref-type="bibr" rid="CR20">20</xref>]. The models were trained using 50,000 random annotated transcripts. The features used as training input were the normalized <italic>k</italic>-mer frequencies for each sequence and the orientation as classification label. Further details are provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>. We also run pychopper (<ext-link ext-link-type="uri" xlink:href="https://github.com/nanoporetech/pychopper">https://github.com/nanoporetech/pychopper</ext-link>) (cdna_classifier.py command), and primer-chop (<ext-link ext-link-type="uri" xlink:href="https://gitlab.com/mcfrith/primer-chop">https://gitlab.com/mcfrith/primer-chop</ext-link>) on the 270,296 human cDNA reads that we had labeled previously and using the full list of barcodes provided by pychopper. Pychopper made predictions for 24% of the reads, from which 98% were correctly classified, i.e., ~ 23.5% (63520) of the total reads. Primer-chop made predictions for 175,539 (65%) reads, from which 83% were correctly classified, i.e., ~ 54% of all reads tested.</p>
    </sec>
    <sec id="Sec12">
      <title>Testing the dependency with base-callers</title>
      <p id="Par21">We used Guppy rapid and Guppy high accuracy (v2.2.3) with the signal files from the in vitro transcript RNA sequenced with MinION by the Nanopore Consortium (available from <ext-link ext-link-type="uri" xlink:href="https://github.com/nanopore-wgs-consortium/NA12878/blob/master/nanopore-human-transcriptome/fastq_fast5_bulk.md">https://github.com/nanopore-wgs-consortium/NA12878/blob/master/nanopore-human-transcriptome/fastq_fast5_bulk.md</ext-link>). As this is direct RNA sequencing, the orientation of the reads can be readily used to test the accuracy of our models.</p>
    </sec>
    <sec id="Sec13">
      <title>Clustering and majority vote</title>
      <p id="Par22">We performed clustering of the human and <italic>S. cerevisiae</italic> cDNA reads using IsONclust [<xref ref-type="bibr" rid="CR9">9</xref>]. Only cDNA reads that had been assigned an orientation by mapping as described above were used for clustering. We predicted the read 5′-to-3′ orientation for the same reads with ReorientExpress and calculated for each cluster the proportion of reads that were correctly orientated. As IsONclust does not give clusters with oriented reads, the orientation of all cDNA reads was taken from the mapping described above. In each cluster, we then predicted the read orientation with ReorientExpress and selected the majority label to assign all reads in the cluster: if the majority (&gt; 50%) of reads were predicted to be already in 5′-to-3′ orientation (forward), we set all reads to forward. Otherwise, all reads were reverse-complemented. The accuracy of all reads was then calculated by comparing our predictions with the predetermined orientations.</p>
    </sec>
    <sec id="Sec14">
      <title>Motif analysis</title>
      <p id="Par23">We studied the 32 filters from the first layer of the CNN to obtain the sequences that are most informative for predicting the orientation, using an approach similar to [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR13">13</xref>]. To explore exhaustively all potential motifs, we used activations above 0 and converted the associated sequences to position weight matrices (PWMs). The derived 32 motif matrices (Additional file <xref rid="MOESM2" ref-type="media">2</xref>) were then compared against the CISBP-RNA database (<ext-link ext-link-type="uri" xlink:href="http://cisbp-rna.ccbr.utoronto.ca/">http://cisbp-rna.ccbr.utoronto.ca/</ext-link>) [<xref ref-type="bibr" rid="CR14">14</xref>] using the TOMTOM algorithm (<ext-link ext-link-type="uri" xlink:href="http://meme-suite.org/doc/tomtom.html">http://meme-suite.org/doc/tomtom.html</ext-link>) [<xref ref-type="bibr" rid="CR21">21</xref>] for the comparison of PWM-based motifs and selecting matches with <italic>p</italic> value &lt; 0.05 (Additional file <xref rid="MOESM3" ref-type="media">3</xref>).</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec15">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2019_1884_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1.</bold> Additional figures and tables referenced in the article.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2019_1884_MOESM2_ESM.txt">
            <caption>
              <p><bold>Additional file 2.</bold> Motif file for the 32 filters from the CNN model.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="13059_2019_1884_MOESM3_ESM.tsv">
            <caption>
              <p><bold>Additional file 3.</bold> Matches of the 32 motifs from Additional file <xref rid="MOESM2" ref-type="media">2</xref> to RBP motifs from CISBP-RNA database.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="13059_2019_1884_MOESM4_ESM.docx">
            <caption>
              <p><bold>Additional file 4.</bold> Review history.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Angel Ruiz-Reche and Akanksha Srivastava contributed equally to this work.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s13059-019-1884-z.</p>
  </sec>
  <ack>
    <sec id="FPar1">
      <title>Peer review information</title>
      <p id="Par24">Barbara Cheifet was the primary editor on this article and managed its editorial process and peer review in collaboration with the rest of the editorial team.</p>
    </sec>
    <sec id="FPar2">
      <title>Review history</title>
      <p id="Par25">The review history is available as Additional file <xref rid="MOESM4" ref-type="media">4</xref>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>ARR implemented the MLP model, and AS implemented the CNN model. ARR and AS performed the data analysis and benchmarking experiments with the input from JAI and IDLR. The project was devised and coordinated by EE. EE, ARR, and AS drafted the manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Part of this work was funded by the Spanish Government and FEDER with grants BIO2017-85364-R and MDM-2014-0370 and by Catalan Government (AGAUR) with grant SGR2017-1020. JI was supported by a PhD grant from FCT (Fundação para a Ciência e a Tecnologia) Portugal. IdlR had funding from an FPI grant from the Spanish Government (PRE2018-083413).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>All datasets on which the conclusions of the paper rely are accessible from publicly available repositories and referenced accordingly. The code generated for this article is available under the MIT license at <ext-link ext-link-type="uri" xlink:href="https://github.com/comprna/reorientexpress">https://github.com/comprna/reorientexpress</ext-link> [<xref ref-type="bibr" rid="CR22">22</xref>] and zenodo at 10.5281/zenodo.3528433 [<xref ref-type="bibr" rid="CR23">23</xref>]. The <italic>S. cerevisiae</italic> nanopore cDNA (SRR6059708) and direct RNA sequencing (DRS) (SRR6059706) reads were obtained from [<xref ref-type="bibr" rid="CR1">1</xref>]. The human cDNA (1D cDNA - JHU run 1) and DRS (JHU run 1) reads were downloaded from the nanopore consortium (https://github.com/nanopore-wgs-consortium/NA12878/blob/master/nanopore-human-transcriptome/fastq_fast5_bulk.md) [<xref ref-type="bibr" rid="CR2">2</xref>]. In vitro transcript RNA sequencing reads were also obtained from the Nanopore Consortium (https://github.com/nanopore-wgs-consortium/NA12878/blob/master/nanopore-human-transcriptome/fastq_fast5_bulk.md) [<xref ref-type="bibr" rid="CR2">2</xref>]. PacBio cDNA reads for sorghum were obtained from Zenodo (https://zenodo.org/record/49944#.XcNqCnUzYUF) [<xref ref-type="bibr" rid="CR11">11</xref>].</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p id="Par26">Ethics approval is not applicable for this study.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par27">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Garalde</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Snell</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Jachimowicz</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Sipos</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Lloyd</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Bruce</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Highly parallel direct RNA sequencing on an array of nanopores</article-title>
        <source>Nat Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>201</fpage>
        <lpage>206</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4577</pub-id>
        <pub-id pub-id-type="pmid">29334379</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Workman</surname>
            <given-names>Rachael E.</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>Alison D.</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>Paul S.</given-names>
          </name>
          <name>
            <surname>Jain</surname>
            <given-names>Miten</given-names>
          </name>
          <name>
            <surname>Tyson</surname>
            <given-names>John R.</given-names>
          </name>
          <name>
            <surname>Razaghi</surname>
            <given-names>Roham</given-names>
          </name>
          <name>
            <surname>Zuzarte</surname>
            <given-names>Philip C.</given-names>
          </name>
          <name>
            <surname>Gilpatrick</surname>
            <given-names>Timothy</given-names>
          </name>
          <name>
            <surname>Payne</surname>
            <given-names>Alexander</given-names>
          </name>
          <name>
            <surname>Quick</surname>
            <given-names>Joshua</given-names>
          </name>
          <name>
            <surname>Sadowski</surname>
            <given-names>Norah</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>Nadine</given-names>
          </name>
          <name>
            <surname>de Jesus</surname>
            <given-names>Jaqueline Goes</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>Karen L.</given-names>
          </name>
          <name>
            <surname>Soulette</surname>
            <given-names>Cameron M.</given-names>
          </name>
          <name>
            <surname>Snutch</surname>
            <given-names>Terrance P.</given-names>
          </name>
          <name>
            <surname>Loman</surname>
            <given-names>Nicholas</given-names>
          </name>
          <name>
            <surname>Paten</surname>
            <given-names>Benedict</given-names>
          </name>
          <name>
            <surname>Loose</surname>
            <given-names>Matthew</given-names>
          </name>
          <name>
            <surname>Simpson</surname>
            <given-names>Jared T.</given-names>
          </name>
          <name>
            <surname>Olsen</surname>
            <given-names>Hugh E.</given-names>
          </name>
          <name>
            <surname>Brooks</surname>
            <given-names>Angela N.</given-names>
          </name>
          <name>
            <surname>Akeson</surname>
            <given-names>Mark</given-names>
          </name>
          <name>
            <surname>Timp</surname>
            <given-names>Winston</given-names>
          </name>
        </person-group>
        <article-title>Nanopore native RNA sequencing of a human poly(A) transcriptome</article-title>
        <source>Nature Methods</source>
        <year>2019</year>
        <volume>16</volume>
        <issue>12</issue>
        <fpage>1297</fpage>
        <lpage>1305</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0617-2</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wyman</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Mortazavi</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>TranscriptClean: variant-aware correction of indels, mismatches and splice junctions in long-read transcripts</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <fpage>340</fpage>
        <lpage>342</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty483</pub-id>
        <pub-id pub-id-type="pmid">29912287</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yao</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>IDP-denovo: de novo transcriptome assembly and isoform annotation by hybrid sequencing</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>2168</fpage>
        <lpage>2176</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty098</pub-id>
        <pub-id pub-id-type="pmid">29905763</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rissland</surname>
            <given-names>Olivia S.</given-names>
          </name>
        </person-group>
        <article-title>The organization and regulation of mRNA-protein complexes</article-title>
        <source>Wiley Interdisciplinary Reviews: RNA</source>
        <year>2016</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>e1369</fpage>
        <pub-id pub-id-type="doi">10.1002/wrna.1369</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hentze</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Castello</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schwarzl</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Preiss</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>A brave new world of RNA-binding proteins</article-title>
        <source>Nat Rev Mol Cell Biol</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>327</fpage>
        <lpage>341</lpage>
        <pub-id pub-id-type="doi">10.1038/nrm.2017.130</pub-id>
        <pub-id pub-id-type="pmid">29339797</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Minimap2: pairwise alignment for nucleotide sequences</article-title>
        <source>Bioinformatics.</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>3094</fpage>
        <lpage>3100</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty191</pub-id>
        <pub-id pub-id-type="pmid">29750242</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <mixed-citation publication-type="other">Marchet C, Lecompte L, Da Silva C, Cruaud C, Aury J-M, Nicolas J, et al. De novo clustering of long reads by gene from transcriptomics data. Nucleic Acids Res. 2018; Available from: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/30260405">http://www.ncbi.nlm.nih.gov/pubmed/30260405</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">​Sahlin K, Medvedev P. De novo clustering of long-read transcriptome data using a greedy, quality-value based algorithm. In International Conference on Research in Computational Molecular Biology. Springer, Cham. 2019. pp. 227-42. Available from: <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/early/2018/11/06/463463">https://www.biorxiv.org/content/early/2018/11/06/463463</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">Sessegolo C, Cruaud C, Da Silva C, Cologne A, Dubarry M, Derrien T, Lacroix V, Aury JM. Transcriptome profiling of mouse samples using nanopore sequencing of cDNA and RNA molecules. Sci Rep. 2019;9(1):14908. 10.1038/s41598-019-51470-9. PubMed PMID: 31624302. Available from: <ext-link ext-link-type="uri" xlink:href="http://biorxiv.org/content/early/2019/07/16/575142.abstract">http://biorxiv.org/content/early/2019/07/16/575142.abstract</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abdel-Ghany</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Hamilton</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Jacobi</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Ngam</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Devitt</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Schilkey</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A survey of the sorghum transcriptome using single-molecule long reads</article-title>
        <source>Nat Commun</source>
        <year>2016</year>
        <volume>7</volume>
        <fpage>11706</fpage>
        <pub-id pub-id-type="doi">10.1038/ncomms11706</pub-id>
        <pub-id pub-id-type="pmid">27339290</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pan</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Rijnbeek</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>H-B</given-names>
          </name>
        </person-group>
        <article-title>Prediction of RNA-protein sequence and structure binding preferences using deep convolutional and recurrent neural networks</article-title>
        <source>BMC Genomics</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>511</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-018-4889-1</pub-id>
        <pub-id pub-id-type="pmid">29970003</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alipanahi</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Delong</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Weirauch</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Frey</surname>
            <given-names>BJ</given-names>
          </name>
        </person-group>
        <article-title>Predicting the sequence specificities of DNA- and RNA-binding proteins by deep learning</article-title>
        <source>Nat Biotechnol</source>
        <year>2015</year>
        <volume>33</volume>
        <fpage>831</fpage>
        <lpage>838</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3300</pub-id>
        <pub-id pub-id-type="pmid">26213851</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ray</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Kazan</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Cook</surname>
            <given-names>KB</given-names>
          </name>
          <name>
            <surname>Weirauch</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Najafabadi</surname>
            <given-names>HS</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A compendium of RNA-binding motifs for decoding gene regulation</article-title>
        <source>Nature</source>
        <year>2013</year>
        <volume>499</volume>
        <fpage>172</fpage>
        <lpage>177</lpage>
        <pub-id pub-id-type="doi">10.1038/nature12311</pub-id>
        <pub-id pub-id-type="pmid">23846655</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Blevins WR, Ruiz-Orera J, Messeguer X, Blasco-Moreno B, Villanueva-Cañas JL, Espinar L, et al. Frequent birth of de novo genes in the compact yeast genome. bioRxiv. 2019:575837 Available from: <ext-link ext-link-type="uri" xlink:href="http://biorxiv.org/content/early/2019/03/13/575837.abstract">http://biorxiv.org/content/early/2019/03/13/575837.abstract</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stein</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>Z-X</given-names>
          </name>
          <name>
            <surname>Bahrami-Samani</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Xing</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Discover hidden splicing variations by mapping personal transcriptomes to personal genomes</article-title>
        <source>Nucleic Acids Res</source>
        <year>2015</year>
        <volume>43</volume>
        <fpage>10612</fpage>
        <lpage>10622</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv1099</pub-id>
        <pub-id pub-id-type="pmid">26578562</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sherman</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Forman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Antonescu</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Puiu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Daya</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rafaels</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Assembly of a pan-genome from deep sequencing of 910 humans of African descent</article-title>
        <source>Nat Genet</source>
        <year>2019</year>
        <volume>51</volume>
        <fpage>30</fpage>
        <lpage>35</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-018-0273-y</pub-id>
        <pub-id pub-id-type="pmid">30455414</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Abadi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Agarwal</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Barham</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Brevdo</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Citro</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <source>TensorFlow: large-scale machine learning on heterogeneous distributed systems</source>
        <year>2016</year>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lecun</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Bottou</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Bengio</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Haffner</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Gradient-based learning applied to document recognition</article-title>
        <source>Proc IEEE</source>
        <year>1998</year>
        <volume>86</volume>
        <fpage>2278</fpage>
        <lpage>2324</lpage>
        <pub-id pub-id-type="doi">10.1109/5.726791</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pedregosa</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Varoquaux</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gramfort</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Michel</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Thirion</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Grisel</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Scikit-learn: machine learning in Python</article-title>
        <source>J Mach Learn Res</source>
        <year>2012</year>
        <volume>12</volume>
        <fpage>2825</fpage>
        <lpage>2830</lpage>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gupta</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Stamatoyannopoulos</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Bailey</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Noble</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>Quantifying similarity between motifs</article-title>
        <source>Genome Biol</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>R24</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2007-8-2-r24</pub-id>
        <pub-id pub-id-type="pmid">17324271</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Ruiz-Reche A, Srivastava A, Eyras E. ReorientExpress. Github. Available from: <ext-link ext-link-type="uri" xlink:href="https://github.com/comprna/reorientexpress">https://github.com/comprna/reorientexpress</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Ruiz-Reche A, Srivastava A, Eyras E. ReorientExpress. source code. Available from: 10.5281/zenodo.3528433</mixed-citation>
    </ref>
  </ref-list>
</back>
