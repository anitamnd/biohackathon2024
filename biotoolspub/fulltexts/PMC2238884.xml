<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <?epub October-11-2007?>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-id journal-id-type="hwp">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2238884</article-id>
    <article-id pub-id-type="pmid">17932061</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkm779</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Articles</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>X:Map: annotation and visualization of genome structure for Affymetrix exon array analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Yates</surname>
          <given-names>Tim</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Okoniewski</surname>
          <given-names>Michał J.</given-names>
        </name>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Miller</surname>
          <given-names>Crispin J.</given-names>
        </name>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
    </contrib-group>
    <aff>Cancer Research UK, Bioinformatics Group, Paterson Institute for Cancer Research, The University of Manchester, Christie Hospital Site, Wilmslow Road, Withington, Manchester, M20 4BX, UK</aff>
    <author-notes>
      <corresp id="COR1">* To whom correspondence should be addressed.+44 161 446 3156 +44 161 446 3109 <email>cmiller@picr.man.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>1</month>
      <year>2008</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>11</day>
      <month>10</month>
      <year>2007</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>11</day>
      <month>10</month>
      <year>2007</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>36</volume>
    <issue>Database issue</issue>
    <issue-title>Database issue</issue-title>
    <fpage>D780</fpage>
    <lpage>D786</lpage>
    <history>
      <date date-type="received">
        <day>1</day>
        <month>8</month>
        <year>2007</year>
      </date>
      <date date-type="rev-recd">
        <day>14</day>
        <month>9</month>
        <year>2007</year>
      </date>
      <date date-type="accepted">
        <day>17</day>
        <month>9</month>
        <year>2007</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2007 The Author(s)</copyright-statement>
      <copyright-year>2007</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Affymetrix exon arrays aim to target every known and predicted exon in the human, mouse or rat genomes, and have reporters that extend beyond protein coding regions to other areas of the transcribed genome. This combination of increased coverage and precision is important because a substantial proportion of protein coding genes are predicted to be alternatively spliced, and because many non-coding genes are known also to be of biological significance. In order to fully exploit these arrays, it is necessary to associate each reporter on the array with the features of the genome it is targeting, and to relate these to gene and genome structure. X:Map is a genome annotation database that provides this information. Data can be browsed using a novel Google-maps based interface, and analysed and further visualized through an associated BioConductor package. The database can be found at <ext-link ext-link-type="uri" xlink:href="http://xmap.picr.man.ac.uk">http://xmap.picr.man.ac.uk</ext-link>.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>INTRODUCTION</title>
    <p>Approximately 50% of human genes are predicted to be alternately spliced (<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B2">2</xref>), and up to 90% of the entire genome to be transcribed (<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B4">4</xref>). Recent work has shown that many non-coding genes are of direct functional significance, that there is strong conservation in regions once characterized as simply ‘junk’ DNA, and that there are many putative novel exons and transcripts in relatively well-characterized protein coding regions (<xref ref-type="bibr" rid="B4">4</xref>,<xref ref-type="bibr" rid="B5">5</xref>). Many loci also contain multiple interwoven and overlapping genes, possibly translated in different reading frames, adding additional layers of complexity (<xref ref-type="bibr" rid="B5">5</xref>). Together, these issues raise a number of challenges for gene expression studies. In particular, it is desirable both to use multiple reporters for individual genes in order to pursue splicing events and to increase coverage to explore the less well-characterized regions of the genome. As knowledge of the complexities of gene expression increases, so does the demand for increasingly feature-dense arrays.</p>
    <p>Advances in microarray technology are beginning to address these issues by offering significantly increased feature densities and a concomitant rise in the number of available reporters. The Affymetrix Human Exon 1.0ST array, for example uses ∼6.5 million probes, comprising ∼1.4 million probesets, to target ∼1.2 million individual exons, and similar arrays exist for mouse and rat. The aim is to target every known and predicted exon in the genome (<xref ref-type="bibr" rid="B6 B7 B8">6–8</xref>). These arrays offer a number of opportunities, but place significant challenges on the bioinformatics tools necessary to exploit them. In particular, sufficient annotation must be provided, for example to identify which exons, transcripts and genes are targeted by each probeset, and the levels of evidence used to define each of these features within the genome (<xref ref-type="bibr" rid="B7">7</xref>).</p>
    <p>X:Map is a database designed to provide this information. It offers detailed annotation of the intron–exon structure of each gene, their mappings to known transcripts, and their location relative to Affymetrix exon array target sequences. Data can be explored using a fully interactive real-time scrollable browser, built using the Google Maps API (<xref ref-type="fig" rid="F1">Figure 1</xref>). Other groups have also considered AJAX-based approaches to this problem, most notably GBrowse-AJAX (available on sourceforge.net). However, these are currently at the proof of concept/prototype stage.
<fig id="F1" position="float"><label>Figure 1.</label><caption><p>The X:Map genome browser. (<bold>a</bold>) Scrollable genome map. (<bold>b</bold>) Toolbar. (<bold>c</bold>) Hierarchical annotation of map features. (<bold>d</bold>) Context-dependent annotation.</p></caption><graphic xlink:href="gkm779f1"/></fig></p>
    <p>An associated BioConductor (<xref ref-type="bibr" rid="B9">9</xref>) package, ‘exonmap’ (<xref ref-type="bibr" rid="B7">7</xref>), provides an interface between the database and R, a popular programming language for data analysis. X:Map is unique because although some of these data are provided by, for example, Affymetrix through their NetAffx (<xref ref-type="bibr" rid="B10">10</xref>) database, comprehensive mappings to the genome, filtering for match specificity and provision of the data in a form that supports both high-throughput and gene-centric analysis, are not available in an integrated form elsewhere.</p>
  </sec>
  <sec>
    <title>DATA GENERATION AND DATABASE BUILDS</title>
    <p>X:Map is built by searching, <italic>in silico</italic>, every 25-mer probe sequence represented on the microarray against the entire genome [downloaded from Ensembl (<xref ref-type="bibr" rid="B11">11</xref>)] and recording the location of each exact match in a relational database. The search strategy is discussed in ref. (<xref ref-type="bibr" rid="B12">12</xref>). Genome searches are performed because many of the probesets on the array target less well-characterized regions [e.g. GenScan (<xref ref-type="bibr" rid="B13">13</xref>) predictions], and because the large amount of ‘intergenic’ transcription observed means that it is necessary to consider each probe's potential to hybridize outside annotated genes. This is discussed further below. An additional search is also performed against a database of known transcript sequences (Ensembl cDNA data) to identify probes that cross exon boundaries; these would not be found at the genome level. This is all done via a series of Groovy (groovy.codehause.org) scripts initiated from a master Java process. Groovy was used because it allowed a much faster turnaround during prototyping and testing, while maintaining reasonable performance (Groovy scripts are compiled to Java before they are executed).</p>
    <p>These data are used to populate a set of new tables in a local copy of Ensembl (<xref ref-type="bibr" rid="B11">11</xref>), indexed for speed of querying. An additional set of stored procedures are imported to provide a well-defined API for both the website and the BioConductor package. The Ensembl database does not support foreign keys, but these new tables link to the existing ones using the same unique identifiers as those used by Ensembl. The overall architecture of X:Map is shown in <xref ref-type="fig" rid="F2">Figure 2</xref>a. In total, this phase of the build process takes ∼3 h for Ensembl v45 (human, mouse and rat combined) on a twin-Xeon 64 bit machine with 16 GB RAM running Red Hat Enterprise Linux.
<fig id="F2" position="float"><label>Figure 2.</label><caption><p>The X:Map build process. (<bold>a</bold>) Overview. The entire human genome is searched against the array's 25-mer probe sequences by the Java Matching engine. Results are stored in a relational database as a set of additional tables accompanying a local installation of Ensembl. The database is used both by an R client that supports analysis using BioConductor and a webserver that supports a Web 2.0/AJAX Genome Browser. The browser serves a set of pre-computed images generated offline by a coarse-grained parallel task (b). (<bold>b</bold>) Distributed computation of image tiles using JavaSpaces. Tile generation jobs are placed in a JavaSpace by a master process (Main Java Process). These are consumed by a series of worker processes distributed across a variety of Linux machines. All image data are written to a shared network drive.</p></caption><graphic xlink:href="gkm779f2"/></fig></p>
    <p>The X:Map genome browser makes use of pre-drawn tiled images in order to improve run-time speed. These are generated in a second phase, managed as a coarse-grained parallel task distributed across a number of Linux servers and workstations (<xref ref-type="fig" rid="F2">Figure 2</xref>b) using a producer/consumer model. In this way, spare cycles available within existing hardware are exploited. During this phase of the build, images are generated using a disparate set of 11 Linux servers and workstations in ∼3 days. Tiles are then processed to generate three alternate levels of magnification (∼5 days). In the end, for all three species, layers and zoom levels, this process generates 52 GB of image data, comprising 10.27 million individual image tiles.</p>
  </sec>
  <sec>
    <title>THE DATA</title>
    <p>The original Exon array annotation supplied by Affymetrix grouped probesets into three sets based on the reliability of the annotation used to define the putative genomic regions of interest. X:Map groups probesets based on Ensembl annotations, and currently provides data for Ensembl Genes, Ensembl ESTs (predictions based on EST data) and GenScan predictions (<xref ref-type="bibr" rid="B11">11</xref>). In this way, a direct mapping is formed between the probesets and the data sources used to provide the annotations found at the location the probeset matches the genome.</p>
    <p>The arrays use a set of short 25-mer probes to target each feature of interest, together referred to as a ‘probeset’. The majority of exon array probesets contain four probes. Each vertical line in the background of <xref ref-type="fig" rid="F1">Figure 1</xref>a represents a probe. It is coloured green if that sequence can match the genome in only one location, grey if it matches at more than one site. X:Map considers a probeset to be ‘multi-targeting’ if one or more of its probes matches at multiple genomic locations. X:Map also categorizes probesets according to whether they hit within an exon (‘exonic’), within a gene but outside an exon (‘intronic’) or between genes (‘intergenic’).</p>
    <p>The relative proportions of probesets in each of these categories are summarized for human mouse and rat arrays in <xref ref-type="table" rid="T1">Table 1</xref>. It can be seen, therefore, that a substantial number of probesets on the array target outside known Ensembl genes, or within genes, but outside known exons, and that many of these match instead to EST or GenScan predictions. Data analysis is best performed with knowledge of these distinctions (<xref ref-type="bibr" rid="B7">7</xref>). Even though relatively few probesets (&lt;10%) contain one or more probes capable of hybridizing to multiple sites, their identification is important because many are highly promiscuous and each may match multiple regions of interest (<xref ref-type="bibr" rid="B7">7</xref>).
<table-wrap id="T1" position="float"><label>Table 1.</label><caption><p>Relative proportions of probesets in different categories for Human, Mouse and Exon arrays</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">Human</th><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">Mouse</th><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">Rat</th><th rowspan="1" colspan="1"/></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">Ensembl version</td><td rowspan="1" colspan="1">45_36 g</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">45_36 f</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">45_34o</td><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1">Total probeset hits</td><td rowspan="1" colspan="1">1432150</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">1235873</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">1044729</td><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1">Multitarget</td><td rowspan="1" colspan="1">129404</td><td rowspan="1" colspan="1">9%</td><td rowspan="1" colspan="1">87181</td><td rowspan="1" colspan="1">7%</td><td rowspan="1" colspan="1">71163</td><td rowspan="1" colspan="1">7%</td></tr><tr><td rowspan="1" colspan="1">Exonic</td><td rowspan="1" colspan="1">301030</td><td rowspan="1" colspan="1">21%</td><td rowspan="1" colspan="1">257421</td><td rowspan="1" colspan="1">21%</td><td rowspan="1" colspan="1">222876</td><td rowspan="1" colspan="1">21%</td></tr><tr><td rowspan="1" colspan="1">Intronic probesets</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1">    all</td><td rowspan="1" colspan="1">329007</td><td rowspan="1" colspan="1">23%</td><td rowspan="1" colspan="1">284182</td><td rowspan="1" colspan="1">23%</td><td rowspan="1" colspan="1">194941</td><td rowspan="1" colspan="1">19%</td></tr><tr><td rowspan="1" colspan="1">    within EST exons</td><td rowspan="1" colspan="1">18851</td><td rowspan="1" colspan="1">1%</td><td rowspan="1" colspan="1">25303</td><td rowspan="1" colspan="1">2%</td><td rowspan="1" colspan="1">5057</td><td rowspan="1" colspan="1">&lt;1%</td></tr><tr><td rowspan="1" colspan="1">    within genscan</td><td rowspan="1" colspan="1">16852</td><td rowspan="1" colspan="1">1%</td><td rowspan="1" colspan="1">15683</td><td rowspan="1" colspan="1">1%</td><td rowspan="1" colspan="1">15848</td><td rowspan="1" colspan="1">2%</td></tr><tr><td rowspan="1" colspan="1">Intergenic probesets</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1">    all</td><td rowspan="1" colspan="1">650196</td><td rowspan="1" colspan="1">45%</td><td rowspan="1" colspan="1">591475</td><td rowspan="1" colspan="1">48%</td><td rowspan="1" colspan="1">537732</td><td rowspan="1" colspan="1">51%</td></tr><tr><td rowspan="1" colspan="1">    within EST exons</td><td rowspan="1" colspan="1">31913</td><td rowspan="1" colspan="1">2%</td><td rowspan="1" colspan="1">37691</td><td rowspan="1" colspan="1">3%</td><td rowspan="1" colspan="1">12653</td><td rowspan="1" colspan="1">1%</td></tr><tr><td rowspan="1" colspan="1">    within genscan</td><td rowspan="1" colspan="1">49236</td><td rowspan="1" colspan="1">3%</td><td rowspan="1" colspan="1">48842</td><td rowspan="1" colspan="1">4%</td><td rowspan="1" colspan="1">52031</td><td rowspan="1" colspan="1">5%</td></tr></tbody></table><table-wrap-foot><fn><p>Data were filtered to remove multi-target probesets and then matched against Ensembl genes. Intronic and intergenic probesets were then searched against Ensembl ESTs and Genscan predictions to assign matches to putative exons.</p></fn></table-wrap-foot></table-wrap></p>
  </sec>
  <sec>
    <title>THE BROWSER</title>
    <p>X:Map supports a novel genome browser (<xref ref-type="fig" rid="F1">Figure 1</xref>). One of the issues of presenting genomic data is the need to represent structures such as genes that are many thousands of residues long, while being able also to represent other features, such as a probe hybridization location that are a few (25 bp) residues in length. This requires a browser that can not only offer a variety of different zoom levels but can also support swift navigation up- and downstream of the current location. Other important considerations are the need to maximize the amount of screen real estate available to present data, the potential for clutter if too many features are presented at the same time and a simple but capable search interface. X:Map, which is designed specifically for high-density microarrays was required to show for each gene, transcript and exon the probesets that match it, their specificity and for each probe, their locations of potential hybridization, and for each individual exon, its sequence. These requirements were addressed by using a visual map with multiple levels of zoom. In order to maximize the responsiveness of the browser this is implemented by generating a set of pre-drawn images (for the entire genome) at various levels of magnification. These are then stored on the server as a series of small, tiled, image files, which are managed by the client using the Google Maps API, which handles the task of requesting the appropriate tiles from the server, of assembling them into a larger contiguous image, as well as the scrolling and zooming of the map. Consequently, no computation is required to generate images at run-time. The result is a fully interactive map that can be scrolled dynamically, and with a user interface that, through the use of the Google Maps API, will be already familiar to many users. In order to maximize the amount of data that can be displayed, the genome is drawn horizontally (most monitors are wider than they are tall) and extends the full width of the browser window.</p>
    <p>Data are presented as a set of transparent layers that can be added or removed from the image. By default, only the Ensembl Gene layer is shown; EST and GenScan predictions can be overlaid as required. Clearly, since the Ensembl annotation pipeline also makes use of ESTs and <italic>in silico</italic> predictions, there is a significant degree of overlap between these data, and statistical analyses using exonmap (see below) should take this non-independence into account. The tools menu (<xref ref-type="fig" rid="F1">Figure 1</xref>b) can be hidden or shown by clicking on its tab. When a region of the map is selected, neighbouring features are listed in a selection box; selection from which causes information pertaining to that item to be displayed as a tree (<xref ref-type="fig" rid="F1">Figure 1</xref>c). If the menu is hidden, the tab is animated (it briefly moves left and right a few pixels) providing a visual cue to draw attention to the fact that its state has changed. The hierarchy (<xref ref-type="fig" rid="F1">Figure 1</xref>c) shows the nested relationships between genes, transcripts, exons, probesets, probes and their match locations. Selecting an item in the hierarchy causes contextual annotation to be displayed (<xref ref-type="fig" rid="F1">Figure 1</xref>d) along with hyperlinks to external databases. Thus genes and transcripts are annotated with HUGO symbols, descriptions and hyperlinks to external databases such as Ensembl and GeneCards (<xref ref-type="bibr" rid="B14">14</xref>), exons with their reading frame and the appropriate fragment of genomic sequence, and probes and probesets with probe sequences and links to NetAffx (<xref ref-type="bibr" rid="B10">10</xref>). Icons are used to identify probesets that are annotated as non-specific, exonic, intronic and intergenic, both in the hierarchy and the annotation view. Detailed descriptions of the different icons and visual cues used within the browser can be found on the help pages accompanying the web site.</p>
  </sec>
  <sec>
    <title>DATA ANALYSIS</title>
    <p>A BioConductor package, ‘exonmap’, can connect to the database (via the Rdbi package) in order to extract annotation data for use within a full statistical analysis environment. The package provides a series of functions allowing mappings to be made between probeset, exon, transcript and gene identifiers, and filterings to be performed to include/exclude exon, intron and intergenic probesets and those that are non-specific to the genome. Additional functions allow genome features to be retrieved according to physical location. Finally, a set of visualization functions can be used to map expression data onto genomic features (<xref ref-type="fig" rid="F3">Figures 3</xref> and <xref ref-type="fig" rid="F4">4</xref>).
<fig id="F3" position="float"><label>Figure 3.</label><caption><p>Genes selected as alternatively spliced between MCF7 and MCF10A cell lines, coloured by fold change. Each row corresponds to a gene, each rectangle, an exon. Exons are arranged in position order. Exons targeted by multiple probesets are drawn with these stacked horizontally within the exon. White rectangles correspond to exons with missing data. Fold change colouring ranges from 2<sup>−5</sup> (intense blue; up in MCF7) to 2<sup>5</sup> (intense red; up in MCF10A).</p></caption><graphic xlink:href="gkm779f3"/></fig>
<fig id="F4" position="float"><label>Figure 4.</label><caption><p>Microarray expression data mapped to the gene structure for LAMA3. (<bold>a</bold>) Two known isoforms are represented in Ensembl. Expression data are mapped onto these and coloured according to fold change between MCF7 and MCF10A. The pattern of expression across the length of the gene clearly corresponds to the known gene structure. (<bold>b</bold>) Line plot for the same data.</p></caption><graphic xlink:href="gkm779f4"/></fig></p>
    <p>A possible workflow for data analysis using X:Map and exonmap is to first identify a set of differentially expressed probesets. This can be done using standard techniques developed for conventional microarrays. These are then mapped, using X:Map, to their target genes, and filtered for non-specificity due to multiple targeting. The result is a list of genes for which at least one probeset is differentially expressed.</p>
    <p>Then, for each of these genes, it is possible to retrieve expression data for every targeting probeset. Fold change (e.g. splicing index), ANOVA (e.g. MIDAS) or variance-based approaches can then be used to characterize genes according to consistency in differential expression across their length (<xref ref-type="bibr" rid="B15">15</xref>,<xref ref-type="bibr" rid="B16">16</xref>). <xref ref-type="fig" rid="F3">Figure 3</xref>, for example, was generated by using limma (<xref ref-type="bibr" rid="B17">17</xref>) to identify all probesets with statistically significant differential expression in a triplicate comparison between two cell lines, the human breast cancer cell line MCF7, and the non-tumorigenic breast epithelial cell line, MCF10A (<italic>N</italic> = 90 051; fold change threshold &gt;2; adjusted <italic>P</italic> value = 0.05, Benjamini and Hochberg correction). This list was then filtered to remove multi-target probesets and those that did not map cleanly to exons (<italic>N</italic> = 49 326). Variance was calculated for each gene, and used to select the 200 most varying up- and downregulated genes. The dataset is described in detail in ref. (<xref ref-type="bibr" rid="B6">6</xref>). Gene expression can also be mapped to the transcript structure of individual genes. <xref ref-type="fig" rid="F4">Figure 4</xref>a shows, for example, the gene LAMA3, with expression mapped to its transcript structure. A set of exons at the 3′ end of the gene appear differentially expressed with respect to the rest of the gene. This corresponds in location to a known short isoform. <xref ref-type="fig" rid="F4">Figure 4</xref>b shows mean intensity for MCF7 and MCF10A plotted for the same gene against sequence position. It can be seen that the expression levels for both cell lines are similar at the 5′ end, but that expression levels increase in MCF10A at the 3′ end (rather than decreasing for MCF7). This provides strong evidence that the changes observed are due to over-expression of the known short isoform in MCF10A, rather than ‘under-expression’ of the 5′ end of the gene in MCF7.</p>
  </sec>
  <sec>
    <title>FUTURE CHALLENGES</title>
    <p>Currently, X:Map focuses on Affymetrix Exon arrays, however, many of the approaches can be generalized to other array types, and in particular, to tiling and SNP arrays. We intend to add these array types to X:Map, and also to extend the types of annotation represented within the database to include data types more pertinent for these arrays. An advantage of the approach taken by X:Map is that, since all visualization data are pre-computed, making more annotation available via the web-interface will not result in a loss of run-time performance. We are also exploring the possibility of adding an additional client-rendered layer to allow dynamic presentation of users’ own expression data alongside the existing map annotation.</p>
  </sec>
  <sec>
    <title>AVAILABILITY</title>
    <p>All database data can be downloaded from the X:Map website, exonmap from the BioConductor website and the MCF7 and MCF10A sample data from ref. (<xref ref-type="bibr" rid="B6">6</xref>).</p>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>This work was funded by Cancer Research UK. We are grateful to the BioConductor community for their considerable efforts and to David James for his help and encouragement with RMySQL. Exon array data were generated by the Cancer Research UK Affymetrix Service; we are also grateful to Siân Dibben for extensive testing and feedback using X:Map and exonmap. Funding to pay the Open Access publication charges for this article was provided by Cancer Research UK.</p>
    <p><italic>Conflict of interest statement</italic>. None declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Modrek</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>A genomic view of alternative splicing</article-title>
        <source>Nat. Genet</source>
        <year>2002</year>
        <volume>30</volume>
        <fpage>13</fpage>
        <lpage>19</lpage>
        <pub-id pub-id-type="pmid">11753382</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Johnson</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Castle</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Garrett-Engele</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kan</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Loerch</surname>
            <given-names>PM</given-names>
          </name>
          <name>
            <surname>Armour</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Santos</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Schadt</surname>
            <given-names>EE</given-names>
          </name>
          <name>
            <surname>Stoughton</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide survey of human alternative pre-mRNA splicing with exon junction microarrays</article-title>
        <source>Science</source>
        <year>2003</year>
        <volume>302</volume>
        <fpage>2141</fpage>
        <lpage>2144</lpage>
        <pub-id pub-id-type="pmid">14684825</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Johnson</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Edwards</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Shoemaker</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Schadt</surname>
            <given-names>EE</given-names>
          </name>
        </person-group>
        <article-title>Dark matter in the genome: evidence of widespread transcription detected by microarray tiling experiments</article-title>
        <source>Trends Genet</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>93</fpage>
        <lpage>102</lpage>
        <pub-id pub-id-type="pmid">15661355</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <label>4</label>
      <element-citation publication-type="journal">
        <collab>ENCODE consortium</collab>
        <article-title>Identification and analysis of functional elements in 1% of the human genome by the ENCODE pilot project</article-title>
        <source>Nature</source>
        <year>2007</year>
        <volume>447</volume>
        <fpage>799</fpage>
        <lpage>816</lpage>
        <pub-id pub-id-type="pmid">17571346</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gerstein</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Bruce</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Rozowsky</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Du</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Korbel</surname>
            <given-names>JO</given-names>
          </name>
          <name>
            <surname>Emanuelsson</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>ZD</given-names>
          </name>
          <name>
            <surname>Weissman</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>What is a gene, post-ENCODE? History and updated definition</article-title>
        <source>Genome Res</source>
        <year>2007</year>
        <volume>17</volume>
        <fpage>669</fpage>
        <lpage>681</lpage>
        <pub-id pub-id-type="pmid">17567988</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Okoniewski</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Hey</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Pepper</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>High correspondence between Affymetrix exon and standard expression arrays</article-title>
        <source>Biotechniques</source>
        <year>2007</year>
        <volume>42</volume>
        <fpage>181</fpage>
        <lpage>185</lpage>
        <pub-id pub-id-type="pmid">17373482</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Okoniewski</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Yates</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Dibben</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>CJ</given-names>
          </name>
        </person-group>
        <article-title>An annotation infrastructure for the analysis and interpretation of Affymetrix exon array data</article-title>
        <source>Genome Biol</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>R79</fpage>
        <comment>
          <ext-link ext-link-type="uri" xlink:href="http://genomebiology.com/2007/8/5/R79">http://genomebiology.com/2007/8/5/R79</ext-link>
        </comment>
        <pub-id pub-id-type="pmid">17498294</pub-id>
      </element-citation>
    </ref>
    <ref id="B8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gardina</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Shimada</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Staples</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Veitch</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Schweitzer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Awad</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Sugnet</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Alternative splicing and differential gene expression in colon cancer detected by a whole genome exon array</article-title>
        <source>BMC Genomics</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>325</fpage>
        <pub-id pub-id-type="pmid">17192196</pub-id>
      </element-citation>
    </ref>
    <ref id="B9">
      <label>9</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Gentleman</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Carey</surname>
            <given-names>VJ</given-names>
          </name>
          <name>
            <surname>Bates</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Bolstad</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Dettling</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dudoit</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ellis</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Gautier</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Bioconductor: open software development for computational biology and bioinformatics</article-title>
        <source><italic>Bioconductor Project Working Papers</italic>, Working Paper 1</source>
        <year>2004</year>
        <comment><ext-link ext-link-type="uri" xlink:href="http://www.bepress.com/bioconductor/paper1">http://www.bepress.com/bioconductor/paper1</ext-link>.</comment>
      </element-citation>
    </ref>
    <ref id="B10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Loraine</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Shigeta</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Cline</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Valmeekam</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kulp</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Siani-Rose</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>NetAffx: Affymetrix probesets and annotations</article-title>
        <source>Nucleic Acids Res</source>
        <year>2003</year>
        <volume>31</volume>
        <fpage>82</fpage>
        <lpage>86</lpage>
        <pub-id pub-id-type="pmid">12519953</pub-id>
      </element-citation>
    </ref>
    <ref id="B11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hubbard</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Aken</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Beal</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ballester</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Caccamo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Clarke</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Coates</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Cunningham</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ensembl 2007</article-title>
        <source>Nucleic Acids Res</source>
        <year>2007</year>
        <volume>35</volume>
        <fpage>D610</fpage>
        <lpage>D617</lpage>
        <pub-id pub-id-type="pmid">17148474</pub-id>
      </element-citation>
    </ref>
    <ref id="B12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leong</surname>
            <given-names>HS</given-names>
          </name>
          <name>
            <surname>Yates</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>CJ</given-names>
          </name>
        </person-group>
        <article-title>ADAPT: a database of Affymetrix probesets and transcripts</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>2552</fpage>
        <lpage>2553</lpage>
        <pub-id pub-id-type="pmid">15746287</pub-id>
      </element-citation>
    </ref>
    <ref id="B13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benson</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Karsch-Mizrachi</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Lipman</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Ostell</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wheeler</surname>
            <given-names>DL</given-names>
          </name>
        </person-group>
        <article-title>GenBank</article-title>
        <source>Nucleic Acids Res</source>
        <year>2007</year>
        <volume>35</volume>
        <fpage>D21</fpage>
        <lpage>D25</lpage>
        <pub-id pub-id-type="pmid">17202161</pub-id>
      </element-citation>
    </ref>
    <ref id="B14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rebhan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Chalifa-Caspi</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Prilusky</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lancet</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>GeneCards: a novel functional genomics compendium with automated data mining and query reformulation support</article-title>
        <source>Bioinformatics</source>
        <year>1998</year>
        <volume>14</volume>
        <fpage>656</fpage>
        <lpage>664</lpage>
        <pub-id pub-id-type="pmid">9789091</pub-id>
      </element-citation>
    </ref>
    <ref id="B15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Clark</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Schweitzer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Staples</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Blume</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Discovery of tissue-specific exons using comprehensive human exon microarrays</article-title>
        <source>Genome Biol</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>R64</fpage>
        <pub-id pub-id-type="pmid">17456239</pub-id>
      </element-citation>
    </ref>
    <ref id="B16">
      <label>16</label>
      <element-citation publication-type="book">
        <collab>Affymetrix</collab>
        <article-title>Alternative transcript analysis methods for exon arrays</article-title>
        <source>
          <italic>Affymetrix Whitepaper</italic>
        </source>
        <year>2005</year>
        <comment><ext-link ext-link-type="uri" xlink:href="www.affymetrix.com.">www.affymetrix.com</ext-link>.</comment>
      </element-citation>
    </ref>
    <ref id="B17">
      <label>17</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Smyth</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Gentleman</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Carey</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Dudoit</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <source>Bioinformatics and Computational Biology Solutions Using R and Bioconductor</source>
        <year>2005</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
        <fpage>397</fpage>
        <lpage>420</lpage>
      </element-citation>
    </ref>
  </ref-list>
</back>
