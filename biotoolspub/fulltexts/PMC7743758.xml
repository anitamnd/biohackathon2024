<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Mol Biol Evol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Mol Biol Evol</journal-id>
    <journal-id journal-id-type="publisher-id">molbev</journal-id>
    <journal-title-group>
      <journal-title>Molecular Biology and Evolution</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0737-4038</issn>
    <issn pub-type="epub">1537-1719</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7743758</article-id>
    <article-id pub-id-type="pmid">32877529</article-id>
    <article-id pub-id-type="doi">10.1093/molbev/msaa145</article-id>
    <article-id pub-id-type="publisher-id">msaa145</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methods</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01130</subject>
        <subject>AcademicSubjects/SCI01180</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Scalable Empirical Mixture Models That Account for Across-Site Compositional Heterogeneity</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-9973-7760</contrib-id>
        <name>
          <surname>Schrempf</surname>
          <given-names>Dominik</given-names>
        </name>
        <xref ref-type="corresp" rid="msaa145-cor1"/>
        <xref ref-type="aff" rid="msaa145-aff1">1</xref>
        <!--<email>dschrempf@caesar.elte.hu</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lartillot</surname>
          <given-names>Nicolas</given-names>
        </name>
        <xref ref-type="aff" rid="msaa145-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Szöllősi</surname>
          <given-names>Gergely</given-names>
        </name>
        <xref ref-type="aff" rid="msaa145-aff1">1</xref>
        <xref ref-type="aff" rid="msaa145-aff3">3</xref>
        <xref ref-type="aff" rid="msaa145-aff4">4</xref>
      </contrib>
    </contrib-group>
    <aff id="msaa145-aff1"><label>1</label><institution>Department of Biological Physics, Eötvös University</institution>, Budapest, <country country="HU">Hungary</country></aff>
    <aff id="msaa145-aff2"><label>2</label><institution>Laboratoire de Biométrie et Biologie Evolutive UMR 5558, CNRS, Université de Lyon</institution>, Villeurbanne, <country country="FR">France</country></aff>
    <aff id="msaa145-aff3"><label>3</label><institution>ELTE-MTA “Lendület” Evolutionary Genomics Research Group</institution>, Budapest, <country country="HU">Hungary</country></aff>
    <aff id="msaa145-aff4"><label>4</label><institution>Evolutionary Systems Research Group, Centre for Ecological Research, Hungarian Academy of Sciences</institution>, Tihany, <country country="HU">Hungary</country></aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Pupko</surname>
          <given-names>Tal</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="msaa145-cor1"><bold>Corresponding author:</bold> E-mail: <email>dschrempf@caesar.elte.hu</email>.</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>12</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2020-09-08">
      <day>08</day>
      <month>9</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>08</day>
      <month>9</month>
      <year>2020</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>37</volume>
    <issue>12</issue>
    <fpage>3616</fpage>
    <lpage>3631</lpage>
    <permissions>
      <copyright-statement>© The Author(s) 2020. Published by Oxford University Press on behalf of the Society for Molecular Biology and Evolution.</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="msaa145.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Biochemical demands constrain the range of amino acids acceptable at specific sites resulting in across-site compositional heterogeneity of the amino acid replacement process. Phylogenetic models that disregard this heterogeneity are prone to systematic errors, which can lead to severe long-branch attraction artifacts. State-of-the-art models accounting for across-site compositional heterogeneity include the CAT model, which is computationally expensive, and empirical distribution mixture models estimated via maximum likelihood (C10–C60 models). Here, we present a new, scalable method EDCluster for finding empirical distribution mixture models involving a simple cluster analysis. The cluster analysis utilizes specific coordinate transformations which allow the detection of specialized amino acid distributions either from curated databases or from the alignment at hand. We apply EDCluster to the HOGENOM and HSSP databases in order to provide universal distribution mixture (UDM) models comprising up to 4,096 components. Detailed analyses of the UDM models demonstrate the removal of various long-branch attraction artifacts and improved performance compared with the C10–C60 models. Ready-to-use implementations of the UDM models are provided for three established software packages (IQ-TREE, Phylobayes, and RevBayes).</p>
    </abstract>
    <kwd-group>
      <kwd>phylogenetics</kwd>
      <kwd>long-branch attraction</kwd>
      <kwd>empirical distribution mixture models</kwd>
      <kwd>empirical profile mixture models</kwd>
      <kwd>microsporidia</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Research Council under the European Union’s Horizon 2020 Research and Innovation Program</institution>
          </institution-wrap>
        </funding-source>
        <award-id>714774</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Austrian government</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>GINOP-2.3.2.–15–2016–00057</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="16"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>Statistical uncertainty of phylogenetic analyses can be arbitrarily reduced by including more sequence data, which is today readily available given modern sequencing technologies. As a result, phylogenomic analyses based on complete genomes routinely provide very strong statistical support even for deep phylogenetic relationships. Statistical support, however, measures uncertainty in estimates assuming a specific evolutionary model and not accuracy of inferred phylogenetic inferences. Analyzing more sequence data alone cannot mitigate systematic biases that result from model misspecification or model inadequacy. In fact, more data can lead to arbitrary strong support for erroneous relationships under the wrong model (<xref rid="msaa145-B38" ref-type="bibr">Philippe et al. 2011</xref>).</p>
    <p>Long-branch attraction (LBA) is a systematic bias in phylogenetic inference where branches are estimated to be shorter than they actually are (<xref rid="msaa145-B7" ref-type="bibr">Felsenstein 1978</xref>; <xref rid="msaa145-B39" ref-type="bibr">Philippe and Laurent 1998</xref>). LBA may result in topological errors, and distantly related species may appear to be closer related. LBA artifacts are especially abundant, when inferring phylogenies using maximum parsimony, where multiple character changes are disregarded. The development of substitution models (<xref rid="msaa145-B21" ref-type="bibr">Jukes and Cantor 1969</xref>) accounting for the possibility of multiple character changes has decreased the severity of LBA artifacts, especially when accounting for rate heterogeneity, for example, with a discrete Gamma probability distribution (<xref rid="msaa145-B61" ref-type="bibr">Yang 1994b</xref>). In the following, the term <italic>distribution</italic> is used to refer to probability distributions.</p>
    <p>Classical substitution models assume that sites in the sequence alignment of interest evolve according to a continuous-time Markov process with a transition rate matrix describing the rates of change between different pairs of characters. As the number of characters is finite, and all characters are connected (i.e., the Markov process is irreducible and has only one communicating class), the transition rate matrix can be parametrized by a set of exchangeabilities between the characters and a stationary distribution of the characters. Additionally, the most-used transition rate matrices are reversible in that they are agnostic to the direction of evolution in time. Reversible transition rate matrices are also used in this study, although the presented method is not limited to the use of reversible transition rate matrices.</p>
    <p>In a typical phylogenetic analysis, a single transition rate matrix is used for the entire alignment; and hence, the exchangeabilities and the stationary distribution are shared across all sites. Most often, the stationary distribution is set to the distribution of observed characters in the analyzed alignment. For alignments of amino acid sequences of real-life proteins, however, a shared stationary distribution across sites is clearly not adequate, because biochemical constraints limit the range of amino acids acceptable at specific sites reducing amino acid diversity in a site-specific manner (<xref rid="msaa145-B36" ref-type="bibr">Pál et al. 2006</xref>; <xref rid="msaa145-B10" ref-type="bibr">Franzosa and Xia 2008</xref>; <xref rid="msaa145-B14" ref-type="bibr">Goldstein 2008</xref>). For example, at a specific site, an amino acid with a specific hydrophobicity, size, or mass may be required.</p>
    <p>Phylogenetic inferences with models that disregard heterogeneity in the stationary distribution across sites (across-site compositional heterogeneity) have led to strongly supported LBA artifacts (<xref rid="msaa145-B59" ref-type="bibr">Williams et al. 2013</xref>; <xref rid="msaa145-B9" ref-type="bibr">Feuda et al. 2017</xref>; <xref rid="msaa145-B48" ref-type="bibr">Simion et al. 2017</xref>). One reason for the underestimation of the lengths of long branches is that when only a reduced set of amino acids is used, the substitution process becomes saturated earlier than when the full set of amino acids is employed. This happens because the probability of observing the same amino acid increases if the stationary distribution is constrained to a strict subset of all amino acids. Models that ignore a variation in the stationary distribution across sites, and instead use an averaged stationary distribution, will systematically underestimate the probability of observing the same amino acid and consequently underestimate the branch length between two evolutionary distant observations. In phylogenetic terms, this corresponds to a systematic underestimation of the probability of homoplasy (independent substitution events leading to the same amino acid) which can result in long branches being attracted because identical amino acid characters are erroneously interpreted as synapomorphies (i.e., resulting from a single substitution on an ancestral branch).</p>
    <p>Across-site compositional heterogeneity has been modeled using partition models (<xref rid="msaa145-B27" ref-type="bibr">Lanfear et al. 2017</xref>), and mixture models, the focal point of this contribution. In addition, mixture models of full transition rate matrices have been examined (<xref rid="msaa145-B34" ref-type="bibr">Le et al. 2008</xref>, <xref rid="msaa145-B33" ref-type="bibr">2012</xref>; <xref rid="msaa145-B32" ref-type="bibr">Le and Gascuel 2010</xref>). Mixtures of full transition rate matrices allow different sites not only to exhibit specific amino acid compositions but also to evolve with different exchangeabilities according to solvent exposure, protein structure or protein function.</p>
    <p>In contrast to the above, the CAT model (<xref rid="msaa145-B28" ref-type="bibr">Lartillot and Philippe 2004</xref>) uses one set of exchangeabilities for all mixture model components and a Dirichlet process prior over the stationary distributions and their weights in a Bayesian Markov chain Monte Carlo framework. The CAT model is widely used and greatly improves model fit. However, computational requirements are high, such that convergence times are long, and convergence may be beyond reach, especially for larger data sets (<xref rid="msaa145-B56" ref-type="bibr">Whelan and Halanych 2016</xref>).</p>
    <p>Inspired by the CAT model, and consistent with the derivation of widely used empirical transition rate matrices from curated databases, empirical stationary distribution mixture (EDM) models, which use a fixed set of stationary distributions, have been developed. The rationale is that site-specific amino acid constraints may be caused by universal biochemical constraints (<xref rid="msaa145-B19" ref-type="bibr">Jimenez et al. 2018</xref>). In particular, composition heterogeneity and site-specific amino acid constraints have already been used to estimate protein structure (<xref rid="msaa145-B12" ref-type="bibr">Goldman et al. 1996</xref>) and the association of protein structure with evolution (<xref rid="msaa145-B13" ref-type="bibr">Goldman et al. 1998</xref>).</p>
    <p>Previously, <xref rid="msaa145-B43" ref-type="bibr">Quang et al. (2008)</xref> used an expectation–maximization algorithm to find EDM models with 10, 20, up to 60 components, which we collectively call CXX models, from alignments of the HSSP database (<xref rid="msaa145-B46" ref-type="bibr">Schneider et al. 1997</xref>). Each mixture model component is defined by the used stationary distribution and weight. Accordingly, we use the term <italic>component</italic> to refer to a stationary distribution with corresponding weight. For computational reasons, the Poisson model (<xref rid="msaa145-B8" ref-type="bibr">Felsenstein 1981</xref>), which exhibits uniform exchangeabilities, was used when searching for the components. The phylogeny for each alignment was estimated beforehand using the WAG (Whelan and Goldman) model. In contrast, <xref rid="msaa145-B54" ref-type="bibr">Wang et al. (2008)</xref> use principal component analysis to detect four stationary distributions of amino acids from alignments of the Pfam database (<xref rid="msaa145-B49" ref-type="bibr">Sonnhammer et al. 1997</xref>). Inferences with EDM models such as the CXX models are much less computationally expansive than with the CAT model because they can be used in a maximum likelihood framework, where they exhibit good statistical fit.</p>
    <p>Recently, a composite likelihood approach was developed that estimates stationary distributions of amino acids directly from the data at hand (<xref rid="msaa145-B50" ref-type="bibr">Susko et al. 2018</xref>). Special strategies to estimate the stationary distributions need to be used, because if species are closely related, the observed amino acids are expected to be more similar. These strategies include 1) restricting the analysis to sites with high rate, 2) penalizing low frequencies of amino acids, 3) down-weighing contributions from species-rich clades, and 4) phylogeny-based estimation.</p>
    <p>Here, we describe EDCluster, a new method for obtaining stationary distributions that can be used to construct EDM models. EDCluster can be used on any set of alignments ranging from large databases of homologous genes to more specific data sets. We employ the CAT model implemented in Phylobayes (<xref rid="msaa145-B30" ref-type="bibr">Lartillot et al. 2013</xref>) to estimate site-specific posterior distributions of the stationary distributions of amino acids. In this way, specialized treatment of the expected variation in the divergence between the sequences is not required. The site distributions are analyzed as is or transformed using linear transformations developed specifically for compositional data. The transformations aid the clustering method in finding stationary distributions of amino acids with different specialized features. The use of a clustering algorithm seemed natural because clustering is a simple machine learning approach for feature discovery. Although EDCluster does not directly use biochemical information, the inferred components are found to correspond to specific biochemical traits of amino acids, such as hydrophobicity, size, or mass.</p>
    <p>Using EDCluster, we provide sets of <inline-formula id="IE1"><mml:math id="IM1"><mml:mrow><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>8</mml:mn><mml:mo>,</mml:mo><mml:mn>16</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>096</mml:mn></mml:mrow></mml:math></inline-formula> components estimated from subsets of the HOGENOM database (<xref rid="msaa145-B5" ref-type="bibr">Dufayard et al. 2005</xref>), the HSSP database, and the union of both. We present extensive analyses of EDM models based on these sets of components which we collectively call universal distribution mixture (UDM) models. For the same number of components, we demonstrate that the UDM models outperform the CXX models not only in terms of likelihood but also in parametric bootstrap analyses, where they exhibit improved amino acid compositions and branch lengths. Moreover, EDCluster allows construction of EDM models with a large number of components. In particular, the UDM models with more components show even further increases in accuracy. However, the number of components is still limited by the associated linear increase of computational requirements during inference. In conclusion, the UDM models minimize systematic errors caused by constraints in amino acid usage in a fraction of the run time of CAT. We provide ready-to-use implementations for several established phylogenetic software packages, such as IQ-TREE (<xref rid="msaa145-B35" ref-type="bibr">Nguyen et al. 2015</xref>), Phylobayes, or RevBayes (<xref rid="msaa145-B18" ref-type="bibr">Höhna et al. 2016</xref>). Further, we provide user-friendly scripts implementing EDCluster to construct EDM models specific to the data set at hand. Finally, we employ a simulation study to reproduce a well-known LBA artifact of classical substitution models, and show that application of EDM models successfully recovers the correct topology.</p>
  </sec>
  <sec>
    <title>New Approaches</title>
    <p>EDM models assume that evolution occurs along a phylogeny according to a mixture of <italic>N</italic> amino acid substitution models. The transition rate matrices of the different components share a single set of exchangeabilities. In this contribution, Poisson exchangeabilities were used exclusively although the method could in principle be generalized directly to any other set of exchangeabilities. In contrast, the stationary distributions (or equilibrium frequencies over the 20 amino acids) differ between each component of the mixture model. Here, the stationary distributions are inferred from alignments obtained from curated databases. Each alignment was analyzed with Phylobayes under the CAT model with Poisson exchangeabilities. For each alignment and each site, the expectation of the posterior distribution of the stationary distribution of amino acids (site distribution) was calculated. Each site distribution is a point in 20D space with elements summing up to 1.0. For each database, the site distributions of all sites were used as is or transformed before further analysis. Application of linear transformations is a standard procedure in analyses of compositional data. The two employed transformations were 1) the centered log-ratio transformation (CLR; <xref rid="msaa145-B1" ref-type="bibr">Aitchison 1982</xref>) and 2) the log centered log-ratio transformation (LCLR; <xref rid="msaa145-B11" ref-type="bibr">Godichon-Baggioni et al. 2019</xref>). In our case, the transformations ensure that site distributions exhibiting specific different features are moved further apart from each other, so that they fall into different groups in the subsequent analysis. <italic>K</italic>-means clustering was used to group the prepared site distributions into <inline-formula id="IE2"><mml:math id="IM2"><mml:mrow><mml:mi>N</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>8</mml:mn><mml:mo>,</mml:mo><mml:mn>16</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>096</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> clusters. The stationary distributions and weights of the different components to be used in the UDM models were set to the determined cluster centers and their relative weights, respectively.</p>
    <p>We combine the components obtained from a subset of the HOGENOM database with Poisson exchangeabilities and refer to the mixture model resulting from a specific set of components as UDM-XXX-Trans, where XXX is the number of components, and Trans is the used transformation (None, CLR, or LCLR). The usage of Poisson exchangeabilities is implicitly assumed and not mentioned specifically. For example, the UDM model with four components obtained from the LCLR-transformed site distributions is referred to as UDM-004-LCLR model. Although the presented analyses exclusively focus on components estimated from the HOGENOM database, components estimated from the HSSP database and the union of both databases are provided for further reference.</p>
  </sec>
  <sec sec-type="results">
    <title>Results</title>
    <sec>
      <title>Analysis of UDM Model Components</title>
      <p>EDM models differ by their used set of stationary distributions and weights (components). The effective number of amino acids (<italic>K</italic><sub>eff</sub>, see Materials and Methods) measures the diversity of discrete distributions. For stationary distributions of amino acids, <italic>K</italic><sub>eff</sub> values range from 1 for highly constrained stationary distributions with only one used amino acid to 20 for the uniform stationary distribution of amino acids which is used by the Poisson model. Most often, the empirical distribution of amino acids observed in the analyzed alignment is used for inference. Usually, these empirical stationary distributions exhibit a high effective number of amino acids of <inline-formula id="IE3"><mml:math id="IM3"><mml:mrow><mml:mn>15</mml:mn><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mtext>eff</mml:mtext></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula>. In particular, the default stationary distribution of the LG model (<xref rid="msaa145-B31" ref-type="bibr">Le and Gascuel 2008</xref>) has <inline-formula id="IE4"><mml:math id="IM4"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mtext>eff</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>18.04</mml:mn></mml:mrow></mml:math></inline-formula>.</p>
      <p>The performance of an EDM model is strongly characterized by the composition of effective number of amino acids of the used stationary distributions together with their weights. In general, UDM models with more components employ more specialized, constrained stationary distributions with lower <italic>K</italic><sub>eff</sub> values, and also put more weight on these constrained distributions (<xref ref-type="fig" rid="msaa145-F1">fig. 1</xref>). Accordingly, the mean <italic>K</italic><sub>eff</sub> value decreases with the number of components. In particular, a general, “catch-all” stationary distribution exhibiting <inline-formula id="IE5"><mml:math id="IM5"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mtext>eff</mml:mtext></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:mn>17</mml:mn></mml:mrow></mml:math></inline-formula> is retained. The weight of the most general stationary distribution decreases with the number of components. Additional components exhibit stationary distributions with <italic>K</italic><sub>eff</sub> values usually well below 10. UDM models with more than 128 components tend to include more than one general stationary distribution with <inline-formula id="IE6"><mml:math id="IM6"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mtext>eff</mml:mtext></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula>. The results for the stationary distributions obtained from untransformed and CLR-transformed site distributions are almost identical (<xref ref-type="supplementary-material" rid="sup1">supplementary figs. S1 and S3</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online).
</p>
      <fig id="msaa145-F1" orientation="portrait" position="float">
        <label>Fig. 1.</label>
        <caption>
          <p>Distributions of effective number of amino acids of the stationary distributions used by UDM models with different numbers of components. Violin plots of the effective number of amino acids of the stationary distributions obtained from the LCLR-transformed site distributions (<xref rid="msaa145-B11" ref-type="bibr">Godichon-Baggioni et al. 2019</xref>) of the HOGENOM database (<xref rid="msaa145-B5" ref-type="bibr">Dufayard et al. 2005</xref>) are shown. On the far right, the distribution of the effective number of amino acids of the site distributions obtained with the CAT model (<xref rid="msaa145-B28" ref-type="bibr">Lartillot and Philippe 2004</xref>) using Poisson exchangeabilities (<xref rid="msaa145-B8" ref-type="bibr">Felsenstein 1981</xref>) is displayed. The width of the violin plots was normalized such that all areas are equal. Horizontal bars display the means of the distributions.</p>
        </caption>
        <graphic xlink:href="msaa145f1"/>
      </fig>
      <p>Further, the distribution of <italic>K</italic><sub>eff</sub> values of the site distributions inferred from the HOGENOM database using the CAT model with Poisson exchangeabilities and the corresponding mean value are shown. As expected, the more components are used, the closer the distribution of <italic>K</italic><sub>eff</sub> values of the stationary distributions of the UDM components to the distribution estimated directly from the HOGENOM database (see also <xref ref-type="supplementary-material" rid="sup1">supplementary figs. S2, S4, and S5</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online). The mean <italic>K</italic><sub>eff</sub> values exhibit the same tendency. Exact <italic>K</italic><sub>eff</sub> values for UDM models up to 16 components including all three transformations are available in <xref ref-type="supplementary-material" rid="sup1">supplementary section S3</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online. Strikingly, in most cases components with higher weight also have higher <italic>K</italic><sub>eff</sub> values.</p>
      <p>Further, the <italic>K</italic><sub>eff</sub> values of the site distributions associated with the components with the most general stationary distributions are usually much lower than the <italic>K</italic><sub>eff</sub> value of the stationary distribution of the respective component. In particular, the first component sorted by weight of the UDM-016-LCLR model exhibits a stationary distribution with <inline-formula id="IE7"><mml:math id="IM7"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mtext>eff</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>17.1</mml:mn></mml:mrow></mml:math></inline-formula>, but the median of the <italic>K</italic><sub>eff</sub> values of the associated site distributions is 12.2 (<xref ref-type="fig" rid="msaa145-F2">fig. 2</xref>, left; see <xref ref-type="supplementary-material" rid="sup1">supplementary fig. S6</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online, for more details). Even for the UDM-256-LCLR model the first components exhibit a striking discrepancy between <italic>K</italic><sub>eff</sub> values (<xref ref-type="supplementary-material" rid="sup1">supplementary figs. S7 and S8</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online). The substantial difference between the <italic>K</italic><sub>eff</sub> values of the site distributions and the stationary distribution of the corresponding component is only apparent for the first few components when sorting them according to weight. For example, the <italic>K</italic><sub>eff</sub> value of the stationary distribution of the fourth component (purple in <xref ref-type="fig" rid="msaa145-F2">fig. 2</xref>) is already very close to the median of the <italic>K</italic><sub>eff</sub> values of the site distributions. The components with lower weight show even higher agreement between the median <italic>K</italic><sub>eff</sub> value and the <italic>K</italic><sub>eff</sub> value of the cluster center. A more detailed analysis shows that the mean of the differences between the <italic>K</italic><sub>eff</sub> values of the site distributions and their associated cluster centers, which represents the loss in amino acid specificity resulting from using a finite mixture of a given number of components, decreases monotonically with the number of components (<xref ref-type="supplementary-material" rid="sup1">supplementary fig. S9</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online).
</p>
      <fig id="msaa145-F2" orientation="portrait" position="float">
        <label>Fig. 2.</label>
        <caption>
          <p>Analysis of the components of a UDM model. (Left) Violin plot of the effective number of amino acids of the site distributions associated with the first six components sorted by weight of the UDM model with a total number of 16 components obtained from clustering the LCLR (<xref rid="msaa145-B11" ref-type="bibr">Godichon-Baggioni et al. 2019</xref>)-transformed site distributions (UDM-016-LCLR model). The effective numbers of amino acids of the stationary distribution of the components themselves are shown by vertical lines. The respective differences to the medians of the associated site distributions are also given (Δ values). (Right) Customized WebLogos (<xref rid="msaa145-B4" ref-type="bibr">Crooks 2004</xref>) visualize general features of the amino acid distributions of the components. The heights of the amino acid letter codes correspond to their probabilities; the total height of each logo is 0.5. The amino acids are colored according to their hydrophobicity. Hydrophilic amino acids D, E, H, K, N, Q, and R with hydrophobicity indices below -1.9 are colored in red. Hydrophobic amino acids C, F, I, L, M, and V with hydrophobicity indices above 1.9 are colored in blue. Finally, amino acids A, G, P, S, T, W, and Y with hydrophobicity indices between -1.9 and 1.9 are colored in green. The weights of the components are shown to the right of the logos.</p>
        </caption>
        <graphic xlink:href="msaa145f2"/>
      </fig>
      <p>Observe that the stationary distribution of the component with highest weight is very general (<xref ref-type="fig" rid="msaa145-F2">fig. 2</xref>), the second component is enriched for neutral amino acids with hydrophobicity indices close to zero, and the third and fourth components select for hydrophobic and hydrophilic amino acids, respectively. Also note that the weight of the first component differs significantly from the weight of the other five shown components. Altogether, the stationary distributions of the different first components of the UDM-016-LCLR model exhibit limited overlap and no apparent redundancy.</p>
    </sec>
    <sec>
      <title>Performance of UDM Models</title>
      <p>The performance of the UDM models was assayed on three empirical data sets that exhibit well-characterized LBA artifacts when applying classical substitution models such as the LG model. The first data set encompasses eukaryotes including the fast-evolving microsporidia and a distant archaeal outgroup. Microsporidia are a group of spore-forming unicellular parasites, which notably lack mitochondria (<xref rid="msaa145-B3" ref-type="bibr">Cavalier-Smith 1987</xref>). The lack of mitochondria and phylogenetic placement as the first emerging eukaryotic group (<xref rid="msaa145-B53" ref-type="bibr">Vossbrinck et al. 1987</xref>; <xref rid="msaa145-B22" ref-type="bibr">Kamaishi et al. 1996</xref>) marked them as a candidate for an ancient eukaryotic lineage predating the acquisition of mitochondria. However, more sophisticated phylogenetic analyses have recovered microsporidia being relatives of fungi, rather than being basal eukaryotes (<xref rid="msaa145-B16" ref-type="bibr">Hirt et al. 1999</xref>; <xref rid="msaa145-B24" ref-type="bibr">Keeling et al. 2000</xref>; <xref rid="msaa145-B52" ref-type="bibr">Van de Peer et al. 2000</xref>; <xref rid="msaa145-B23" ref-type="bibr">Keeling and Fast 2002</xref>) and subsequently remnants of mitochondria were found experimentally (<xref rid="msaa145-B58" ref-type="bibr">Williams et al. 2002</xref>). Here, as an illustration, we consider the data set of <xref rid="msaa145-B2" ref-type="bibr">Brinkmann et al. (2005</xref>, referred to as microsporidia data set), which spans 40 sequences and comprises 133 genes corresponding to 24,294 amino acid sites. We show analyses of the concatenated alignment, as well as of the separate genes. For the concatenated alignment of the microsporidia data set, site-homogeneous substitution models such as the LG model favor the former topology in terms of likelihood. Models accounting for across-site compositional heterogeneity such as the CAT model exhibit higher posterior probabilities for the latter topology, which is now widely accepted. Note that we use the term topology when referring to the order of branching events, and the term phylogeny when referring to the topology together with branch lengths.</p>
      <p>Further two data sets involving the positioning of nematodes and platyhelminths were analyzed (referred to as the nematode data set and the platyhelminth data set, respectively; <xref rid="msaa145-B40" ref-type="bibr">Philippe et al. 2005)</xref>. These data sets contain a total of 37 and 32 taxa with 35,371 amino acid sites, respectively. The LBA artifacts, observed when using classical substitution models such as the LG model, are nematodes and platyhelminths branching with a clade containing both deuterostomes and arthropodes. Current phylogenetic consensus has nematodes and platyhelminths branching with arthropodes—a result strongly supported by the CAT model. In the following, we refer to the three topologies most likely exhibiting LBA artifacts as T1, and to the topologies in agreement with current phylogenetic consensus as T2 (<xref ref-type="fig" rid="msaa145-F3">fig. 3</xref>).
</p>
      <fig id="msaa145-F3" orientation="portrait" position="float">
        <label>Fig. 3.</label>
        <caption>
          <p>Performance of UDM models (blue), and CXX models (orange; <xref rid="msaa145-B43" ref-type="bibr">Quang et al. 2008</xref>) for an increasing number of components for the three empirical data sets. Results for UDM models are shown for the untransformed (None), CLR-transformed (<xref rid="msaa145-B1" ref-type="bibr">Aitchison 1982</xref>), and LCLR-transformed (<xref rid="msaa145-B11" ref-type="bibr">Godichon-Baggioni et al. 2019</xref>) site distributions. Results for WAG (purple;<xref rid="msaa145-B57" ref-type="bibr"> Whelan and Goldman 2001</xref>) and LG (red; <xref rid="msaa145-B34" ref-type="bibr">Le et al. 2008</xref>) models are indicated by dashed horizontal lines. The rows from top to bottom show: 1) the maximum log-likelihoods, 2) the sum of all branch lengths (total branch length) of the maximum-likelihood phylogenies measured in average number of substitutions, 3) the log-likelihood differences between the two topologies presented below with a positive value indicating support for topology T2, 4) historical topology T1 affected by LBA artifacts, and 5) currently accepted topology T2. In the topologies, outgroup, clade of interest, and ingroups are colored gray, red, and in shades of blue, respectively.</p>
        </caption>
        <graphic xlink:href="msaa145f3"/>
      </fig>
      <p>Maximum likelihood analyses were performed with IQ-TREE using UDM and CXX models with Poisson exchangeabilities, as well as the WAG and the LG model (<xref ref-type="fig" rid="msaa145-F3">fig. 3</xref>). Indeed, traditional substitution models favor the topologies T1 exhibiting the discussed LBA artifacts, whereas sufficiently component-rich UDM models reject T1 in favor of the currently accepted topologies T2 (<xref ref-type="supplementary-material" rid="sup1">supplementary figs. S10, S18, and S20</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online). In general, the results agree very well across the three data sets. In terms of maximum log-likelihood, the WAG model performs slightly worse than the LG model. When using the same number of components, the maximum log-likelihood under the UDM and CXX models are similar. Eight and 16 components are needed to approximately achieve maximum log-likelihood values equivalent to the ones of the WAG and LG models, respectively. Usage of more components further improves the maximum log-likelihood of the UDM and CXX models to the extent that they outperform classical substitution models, even though they use Poisson exchangeabilities. The UDM models outperform the CXX models when using 64 components or more, because CXX models are not available with more than 60 components. Bayesian information criterion (BIC; <xref rid="msaa145-B47" ref-type="bibr">Schwarz 1978</xref>) scores are monotonically decreasing with the number of components, and component-rich models are clearly favored (<xref ref-type="supplementary-material" rid="sup1">supplementary figs. S11, S19, and S21</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online).</p>
      <p>For the UDM and CXX models, the total branch length of the maximum-likelihood phylogenies increases with the number of used components. When increasing the number of components, the total branch lengths do not approach a limit but exhibit logarithmic increase. The total branch lengths of the maximum-likelihood phylogenies of the WAG model are lower than the ones of the UDM model with four components. The total branch lengths of the phylogenies obtained by the LG model are surpassed when using 8–16 components, approximately. The total branch lengths of the maximum-likelihood phylogenies of the UDM models tend to be larger than the ones of the CXX models. The transformation affects total branch lengths more than the other presented results. Components obtained from the LCLR-transformed site distributions exhibit highest total branch lengths.</p>
      <p>Next, the power to discriminate between topologies T1 and T2 was examined. To this end, the maximum log-likelihoods of analyses constrained to the two different topologies T1 and T2 were compared. The topologies were fixed during the analyses, but the branch lengths and other model parameters were inferred. The difference of the maximum log-likelihood values acquired from topologies T2 and T1 indicates whether the LBA artifacts are supported (negative values) or rejected (positive values). The WAG and LG models both strongly support the topology exhibiting the LBA artifacts in all three cases with large differences in maximum log-likelihood. In contrast, the UDM (CXX) models reject the topology exhibiting the LBA artifacts in the microsporidia, nematode, and platyhelminth data sets when at least 64 (50), 8 (10), or 16 (20) components are used, respectively. For the data set involving microsporidia, the UDM models require a higher number of components to reject the topology with LBA artifacts compared with the CXX models. For the data sets involving nematodes and platyhelminths, the situation is reversed in that the differences of the maximum log-likelihoods of the UDM models are more positive than the ones of the CXX models. Also, the difference in maximum log-likelihood does not increase substantially for the CXX models when applied to the data set involving nematodes.</p>
      <p>The performance of the UDM models on shorter alignments compared with the LG model and the CAT model with Poisson exchangeabilities was tested on the separate genes of the microsporidia data set. The inferred trees were compared with the historical topology T1 (<xref ref-type="supplementary-material" rid="sup1">supplementary figs. S12–S14</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online) and the more recent topology T2 (<xref ref-type="supplementary-material" rid="sup1">supplementary figs. S15–S17</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online). The lengths of the alignments range from 40 to 600 amino acid columns. Consequently, we observe high variance between the results from different genes. The means of the symmetric (<xref rid="msaa145-B44" ref-type="bibr">Robinson and Foulds 1981</xref>) and branch score (<xref rid="msaa145-B26" ref-type="bibr">Kuhner and Felsenstein 1994</xref>) distances to the T1 topology do not improve when using models accounting for across-site composition heterogeneity compared with the LG model. However, the means of the symmetric and branch score distances do decrease with the number of components for the T2 topology. The branch score distance of the CAT model is larger than for the UDM-128-LCLR. We stress that there is no strong consensus of the current phylogenetic literature about the branch lengths of the discussed tree. In general, the difference between the results of the UDM models and the CAT model decreases with the number of components. The results of the UDM-128-LCLR model and the CAT model are nearly identical. The incompatible split distance, which is a distance measure accounting for the uncertainty in the inferred topology, shows a consistent decrease of the distance with the number of components.</p>
    </sec>
    <sec>
      <title>Model Adequacy in Recovering Across-Site Compositional Heterogeneity</title>
      <p>Finally, we assayed the potential of the UDM, and CXX models, as well as of the WAG and the LG models to reproduce the across-site compositional heterogeneity of empirical alignments. For this reason, we preformed parametric bootstrap in a manner similar to posterior predictive analyses in Bayesian statistics. We estimated model parameters using maximum likelihood for the microsporidia, nematode, and platyhelminth data sets and used these to simulate alignments comprising 25,000 sites, which is a round number close to the length of the microsporidia data set which has 24,294 sites. Subsequently, summary statistics for the original alignments and the simulated alignments were compared. It is desirable that the simulated alignments reproduce characteristics of the original alignments.</p>
      <p>Here, we compared the distribution of effective number of amino acids observed at each site of the alignment. It is difficult to judge differences in the actual distributions of effective number of amino acids by eye (<xref ref-type="supplementary-material" rid="sup1">supplementary figs. S22–S24</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online). Therefore, we present the Wasserstein distance (also known as earth mover’s distance) between the distributions of effective number of amino acids of the original and the simulated alignments.</p>
      <p>For all three data sets, the WAG and LG models with a single amino acid transition rate matrix produce alignments with inflated diversity measured in effective number of amino acids (<xref ref-type="fig" rid="msaa145-F4">fig. 4</xref> for the microsporidia data set; <xref ref-type="supplementary-material" rid="sup1">supplementary figs. S25 and S26</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online, for the nematode and platyhelminth data sets, respectively). Numeric values of the average effective number of amino acids per site in the alignment as well as the Wasserstein distances are given in <xref ref-type="supplementary-material" rid="sup1">supplementary table S1</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online. Component-rich UDM and CXX models typically exhibit lower Wasserstein distances than UDM or CXX models with fewer components. The UDM models consistently outperform the CXX models. The C50 model exhibits large deviations in all three data sets. UDM models with 256 components sometimes exhibit higher Wasserstein distances than their equivalents with 128 components. For example, compare the UDM-256-LCLR model with the UDM-128-LCLR model in the microsporidia data set (<xref ref-type="fig" rid="msaa145-F4">fig. 4</xref>). The reason for the increase of the Wasserstein distance is that the average number of used amino acids of the UDM-256-LCLR model is actually lower than the one of the original data.
</p>
      <fig id="msaa145-F4" orientation="portrait" position="float">
        <label>Fig. 4.</label>
        <caption>
          <p>Across-site compositional heterogeneity of classical substitution models and empirical distribution mixture models. Similarity between the across-site compositional heterogeneity of the microsporidia data set (<xref rid="msaa145-B2" ref-type="bibr">Brinkmann et al. 2005</xref>) and simulated alignments for the maximum likelihood parameter estimates of the WAG (<xref rid="msaa145-B57" ref-type="bibr">Whelan and Goldman 2001</xref>), LG (<xref rid="msaa145-B31" ref-type="bibr">Le and Gascuel 2008</xref>), CXX (<xref rid="msaa145-B43" ref-type="bibr">Quang et al. 2008</xref>), and UDM models. Results of UDM models obtained from untransformed (None), CLR-transformed (<xref rid="msaa145-B1" ref-type="bibr">Aitchison 1982</xref>), and LCLR-transformed (<xref rid="msaa145-B11" ref-type="bibr">Godichon-Baggioni et al. 2019</xref>) site distributions are shown. Similarity is measured by the Wasserstein distance between the distributions of effective number of amino acids per site between empirical data and the sequences simulated using parametric bootstrap.</p>
        </caption>
        <graphic xlink:href="msaa145f4"/>
      </fig>
    </sec>
    <sec>
      <title>Phylogenetic Artifact Can Be Reproduced in Simulation Study</title>
      <p>The results presented above rely on assumptions about the correct topology (<xref rid="msaa145-B56" ref-type="bibr">Whelan and Halanych 2016</xref>). As an alternative, we can experiment with simulations, for which we know the true phylogeny. Interestingly, the LBA artifact observed in the microsporidia data set could be reproduced in a simple simulation study. We used the 175,330 site distributions obtained from the HOGENOM database to simulate an alignment along a phylogeny exhibiting the currently accepted topology T2 where microsporidia branch within fungi (left phylogeny in <xref ref-type="fig" rid="msaa145-F5">fig. 5</xref>). Then, maximum-likelihood phylogenies were inferred with the Poisson model, and the LG model, as well as the CXX models, and the UDM models which account for across-site compositional heterogeneity. The maximum-likelihood phylogenies of the Poisson and LG models exhibit the incorrect topology T1 where microsporidia are positioned at the eukaryotic root (<xref ref-type="fig" rid="msaa145-F5">fig. 5</xref> and <xref ref-type="supplementary-material" rid="sup1">supplementary fig. S27</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online). In addition, the ciliates are also moved outside their clade. All branches are supported with bootstrap values of 100%.
</p>
      <fig id="msaa145-F5" orientation="portrait" position="float">
        <label>Fig. 5.</label>
        <caption>
          <p>Reproduction of microsporidia LBA artifact in simulation study. (Left) Phylogeny used for simulation using Poisson exchangeabilities (<xref rid="msaa145-B8" ref-type="bibr">Felsenstein 1981</xref>) and stationary distributions of amino acids obtained from analyses of the HOGENOM database (<xref rid="msaa145-B5" ref-type="bibr">Dufayard et al. 2005</xref>). (Middle) Maximum-likelihood phylogeny of the Poisson model. (Right) Maximum-likelihood phylogeny of the UDM model with 32 components obtained from LCLR-transformed (<xref rid="msaa145-B11" ref-type="bibr">Godichon-Baggioni et al. 2019</xref>) site distributions (UDM-032-LCLR model). For both inferred phylogenies, bootstrap values below 100% are shown.</p>
        </caption>
        <graphic xlink:href="msaa145f5"/>
      </fig>
      <p>The maximum-likelihood phylogenies inferred by UDM models with 4, 8, and 16 components still exhibit the LBA artifact involving microsporidia (<xref ref-type="supplementary-material" rid="sup1">supplementary fig. S28</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online). In contrast, the UDM-032-LCLR model correctly supports microsporidia branching from within fungi. The correct phylogeny has much higher statistical support with an improvement in BIC score of 2,591,445 units compared with the results of the Poisson model. The position of microsporidia, holozoa, and conosa still has poor branch support in form of a bootstrap value of 50%. However, when using the UDM-064-LCLR model, the mentioned bootstrap values rise to 100% (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online). Also, the C10, C20, to C50 models infer the incorrect topology T1, albeit with decreasing branch support values. Only the maximum likelihood topology of the C60 model is in agreement with the original topology used for simulating the alignment (<xref ref-type="supplementary-material" rid="sup1">supplementary fig. S28</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online) and has high branch support with bootstrap values of 100% (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online).</p>
      <p>The improvement in model fit with increasing number of components can also be seen when examining the branch lengths. First, the sum of all branch lengths (total branch length) of the original phylogeny used for the simulation is 15.6 average number of substitutions per site. The total branch lengths of the phylogenies estimated by the Poisson, the LG, the UDM-032-LCLR, and the UDM-064-LCLR models are 11.98, 14.14, 14.38, and 14.72 units, respectively. Second, the branch score distance between the original phylogeny used to simulate the alignment and the inferred phylogenies was calculated (<xref ref-type="supplementary-material" rid="sup1">supplementary fig. S29</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online). The branch score distances of the Poisson and LG models are highest, and the branch score distances of the EDM models decrease with the number of components. For the same number of components, the UDM models exhibit lower branch score distances than the CXX models. Ignoring across-site compositional heterogeneity, therefore, leads to a substantial underestimation of branch lengths because multiple substitution events occurring among a restricted subset of amino acids are missed by site-homogeneous models.</p>
      <p>Also for the simulated data, performance of the UDM models on individual genes was assayed and compared with results of the Poisson and LG models. To this aim, trees were inferred from simulated alignments ranging from 100 to 1,000 amino acid columns (see Materials and Methods). In general, we observe a decrease of symmetric as well as branch score distance with alignment length (<xref ref-type="supplementary-material" rid="sup1">supplementary figs. S30 and S31</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online). For short alignments with 100–200 columns, an increase of the number of components does not improve the symmetric distance. However, the branch score distance decreases with the number of components, even for such short alignments. For longer alignments, the UDM models with many components consistently outperform the Poisson and LG models, as well as UDM models with fewer components. This trend continues even for UDM models with as many as 1,024 components. The reason is that the component weights obtained during the clustering procedure were used for this part of the analysis (see Materials and Methods). Consequently, component-rich models are closer to the model used for simulation which employs the stationary distributions obtained from the HOGENOM database. Interestingly, the log-likelihood values for models with 1,024 components are slightly lower than the corresponding log-likelihood values for models with 512 components (<xref ref-type="supplementary-material" rid="sup1">supplementary table S2</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online) suggesting that the LCLR transformation is overfavoring specialized stationary distributions when so many components are used.</p>
    </sec>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <p>The importance of accounting for across-site compositional heterogeneity has been demonstrated by a series of phylogenetic studies where models accounting for across-site compositional heterogeneity, such as the CAT model, were able to overcome artifacts caused by LBA (<xref rid="msaa145-B2" ref-type="bibr">Brinkmann et al. 2005</xref>; <xref rid="msaa145-B40" ref-type="bibr">Philippe et al. 2005</xref>; <xref rid="msaa145-B29" ref-type="bibr">Lartillot et al. 2007</xref>; <xref rid="msaa145-B42" ref-type="bibr">Pisani et al. 2015</xref>). The reproduction of an LBA artifact and its resolution in a simulation study (<xref ref-type="fig" rid="msaa145-F5">fig. 5</xref>) provides further evidence for the claim that across-site compositional heterogeneity is a fundamental cause of the phylogenetic artifact observed in the microsporidia data set, and potentially many others.</p>
    <p>The simulation study on the microsporidia phylogeny demonstrates that accounting for across-site compositional heterogeneity affects not only the topology (<xref ref-type="fig" rid="msaa145-F5">fig. 5</xref> and <xref ref-type="supplementary-material" rid="sup1">supplementary fig. S28</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online) but also the branch lengths of the inferred phylogeny. In the simulation study, we observe a remarkable downward bias of the total branch length of the phylogeny estimated by the classical Poisson and LG models. The length of long branches, in particular, is severely underestimated. Additionally, the branch score distance between the inferred phylogenies and the original phylogeny used for simulating the alignments improves significantly with the number of EDM model components (<xref ref-type="supplementary-material" rid="sup1">supplementary fig. S29</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online). Also, we observe superior branch score distances for the UDM models obtained from LCLR-transformed site distributions when comparing them with the CXX models. This effect of inadequate modeling of across-site compositional heterogeneity has been overlooked in most previous analyses. With respect to the simulation study, the downward bias of the branch lengths estimated by the Poisson model causes a wrong topology to have higher likelihood than the original topology. This classic LBA attraction artifact is eliminated when accounting for across-site compositional heterogeneity.</p>
    <p>In order to provide robust and accurate models that account for across-site compositional heterogeneity, we developed a new method EDCluster to find empirical stationary distributions of amino acids with corresponding weights. EDCluster was used to not only provide universal stationary distributions estimated from curated databases but also allow construction of EDM models with a large number of components directly from the data set at hand. The CAT model is employed to infer site distributions, that is, the expectations of the posterior distributions of the stationary distributions of amino acids per site. Subsequently, we use a clustering algorithm to explore the structure of the hundred thousands of site distributions. The choice of using a cluster algorithm seemed natural because clustering is a simple machine learning approach for feature discovery. Additionally, to enhance the ability to resolve specialized site distributions we employ coordinate transformations developed specifically for analysis of compositional data. The inference of site distributions with CAT enables our method to deal with the fact that the amino acids of closely related species are expected to be more similar than the ones of distantly related species. Hence, when using our method on an alignment of closely related species the inferred stationary distributions will not necessarily have a low effective number of amino acids. In contrast, methods inferring stationary distributions and weights directly from the alignment (<xref rid="msaa145-B50" ref-type="bibr">Susko et al. 2018</xref>) require other means to compensate for the expected variation of divergence between the sequences.</p>
    <p>From the perspective of potential phylogenetic artifacts caused by inadequate modeling of across-site heterogeneity, the effective number of amino acids <italic>K</italic><sub>eff</sub> and its distribution provide useful summary statistics for analyzing different models and their stationary distributions. The lower <italic>K</italic><sub>eff</sub> is, the higher the potential to underestimate the frequency of multiple substitutions and the probability of homoplasy, with corresponding negative effects on phylogenetic inferences, in terms of recovering accurate branch lengths and avoiding LBA. Consequently, a clustering preceded by a transformation separating stationary distributions with low <italic>K</italic><sub>eff</sub>, such as the LCLR transformation, can be expected to lead to mixture models less prone to biases in branch length estimation and LBA artifacts. In order to provide sets of universal stationary distributions and weights available for general use we have applied our method, which implements the transformation and clustering to subsets of databases spanning the whole tree of life. Analysis of the distributions of <italic>K</italic><sub>eff</sub> for these universal stationary distributions indicates that a large number of stationary distributions is necessary to adequately model the diversity of site distributions present in empirical alignments. For example, a set of 16 stationary distributions of amino acids is by far not sufficient to describe the observed variety of site distributions (<xref ref-type="fig" rid="msaa145-F1">fig. 1</xref>). When the number of clusters is too low, we notice that many site distributions are assigned to overly general stationary distributions, because they do not fit in any particular stationary distribution, and not because they are general themselves (<xref ref-type="fig" rid="msaa145-F2">fig. 2</xref>).</p>
    <p>In spite of the apparent need for many stationary distributions, analysis of the WebLogos of the sets of stationary distributions with more than 64 elements reveals an unexpected level of redundancy (see <xref ref-type="supplementary-material" rid="sup1">supplementary section S4</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online). It seems reasonable that the number of needed stationary distributions could be reduced by conglomerating stationary distributions exhibiting a certain level of similarity. We attempted to reduce the redundancy within sets comprising many stationary distributions by employing different clustering methods. For example, we tried a form of divisive clustering, where the cluster with the center exhibiting the highest effective number of amino acids is repeatedly divided (<xref ref-type="supplementary-material" rid="sup1">supplementary figs. S32 and S33</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online), and also density-based clustering with DBSCAN (<xref rid="msaa145-B6" ref-type="bibr">Ester et al. 1996</xref>). Both clustering methods failed to improve the redundancy compared with standard <italic>K</italic>-means clustering. However, sets of stationary distributions with a moderate number of elements do not exhibit significant redundancy. For example, the first six elements of the set of 16 stationary distributions obtained from the LCLR-transformed site distributions exhibit very little, if any, overlap (<xref ref-type="fig" rid="msaa145-F2">fig. 2</xref>). Finally, stationary distributions with similar WebLogos may still exhibit specialized features that are not apparent by visual inspection.</p>
    <p>A set of stationary distributions and weights together with Poisson exchangeabilities composes an EDM model. We refer to the models composed of the universal stationary distributions and weights discussed above as UDM models. Using the UDM models, we demonstrate the removal of several known LBA-associated phylogenetic artifacts from three example analyses: 1) the branching of microsporidia from within fungi and 2) the branching of nematodes and (3) flatworms with arthropodes (<xref ref-type="fig" rid="msaa145-F3">fig. 3</xref>). For the analysis of the microsporidia data set, the performance of the UDM models was comparable to that of CXX models when using the same number of components. The UDM models outperformed the CXX models in analyses of the data sets including nematodes and platyhelminths. Assaying the ability of different EDM models to adequately recover across-site heterogeneity, we found that UDM models outperform CXX models. In fact, the maximum number of components of the CXX models is currently limited to 60 due to the computational cost of the expectation–maximization algorithm. In contrast, our method allows for mixture models with many more components. As a proof of concept, we show results for UDM models with 128 and 256 components. All presented analyses support that these component-rich UDM models outperform the C60 model. Another issue with the CXX models is the lack of reproducibility of the expectation–maximization estimations in a context characterized by a rugged likelihood surface with a very large number of local maxima (<xref rid="msaa145-B43" ref-type="bibr">Quang et al. 2008</xref>). In particular, the large deviations in the parametric bootstrap results of the C50 model (<xref ref-type="fig" rid="msaa145-F4">fig. 4</xref>) reiterate that there may be a problem with respect to local maxima during estimation of the components. The EDCluster approach presented here, however, returns reproducible results, even for rich mixtures.</p>
    <p>When examining the total branch lengths of the maximum-likelihood phylogenies, we observe that the UDM models obtained from LCLR-transformed site distributions exhibit highest total branch lengths. As discussed above, the LCLR transformation facilitates the discovery of more specialized stationary distributions that exhibit lower effective numbers of amino acids. In turn, the lower effective numbers of amino acids lead to inferences exhibiting longer branches. The logarithmic increase of the total branch length with the number of components is striking because it demonstrates that a high number of components may be required. In contrast, the results of the parametric bootstrap analysis indicate that inferences with the UDM-256-LCLR model already overshoot in terms of effective number of amino acids (<xref ref-type="fig" rid="msaa145-F4">fig. 4</xref>). This observation can be attributed to the LCLR transformation which favors low <italic>K</italic><sub>eff</sub> values. In this sense, the LCLR transformation is more eager to catch specific site distributions for moderate numbers of components than the other two transformations but may be too eager for large mixtures of 256 components or more.</p>
    <p>The optimal number of components can be determined by established statistical tests, for example, using the AIC (Akaike information criterion) or BIC (Bayesian information criterion) scores. In fact, the maximum log-likelihood as well as the difference in log-likelihood between the tested hypotheses still seem to be far from saturation (<xref ref-type="fig" rid="msaa145-F3">fig. 3</xref>) for all three transformations. Accordingly, the BIC or AIC scores favor component-rich UDM models, because adding a component only increases the number of model parameters by one (if the weights are inferred). For example, UDM models with 256 components were favored when analyzing the three empirical data sets. Furthermore, the analyses of the simulated alignments with 100 to 1,000 columns show reduced symmetric and branch score distances for component-rich UDM models (<xref ref-type="supplementary-material" rid="sup1">supplementary figs. S30 and S31</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online). These results suggest that the complexity of the composition of site distributions exceeds what can be captured by even the richest mixtures considered here. In fact, it seems very plausible that hundreds of points (components) are required to adequately model 20D space. Consequently, especially for challenging cases, the alleviation of LBA due to site-specific amino acid preferences may require richer mixtures than the currently available ones such as the CXX models. In summary, for long alignments with thousands of columns, we recommend using UDM models with as many components as permitted by the available computational resources. If the tractable number of components is 256 or lower, we recommend using stationary distributions obtained from the LCLR-transformed data; otherwise, stationary distributions directly obtained from the data without transformation.</p>
    <p>For alignments with 1,000 columns or fewer, maximum likelihood estimation of the component weights may be unstable for component-rich mixture models, and we recommend Bayesian estimation with UDM models having up to 128 components (<xref ref-type="supplementary-material" rid="sup1">supplementary figs. S12–S17</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online). If the distribution of component weights is known—for example, from an analysis of the concatenated alignment—maximum likelihood analyses employing component-rich UDM models are recommended as they showed high accuracy in our simulation study (<xref ref-type="supplementary-material" rid="sup1">supplementary figs. S30 and S31</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online).</p>
    <p>The results presented above use sets of stationary distributions and weights estimated from a subset of the HOGENOM database. A parallel analysis of a subset of the HSSP database was performed and corresponding components were collected. However, the stationary distributions obtained from the HSSP database were mostly outperformed by the ones obtained from the HOGENOM database. Analysis of the taxonomic composition of the databases (see Materials and Methods) revealed that the taxonomic composition of the subset of the HOGENOM database is enriched for eukaryotes with an approximate value of 70%, which is in agreement with the taxonomic compositions of the three analyzed data sets. For completeness, the stationary distributions obtained from the HSSP database as well as universal stationary distributions obtained from the union of both databases are also provided, and may exhibit better performance on data sets enriched for bacteria or with a balanced distribution of eukaryotes, archaea, and bacteria, respectively.</p>
    <p>We used Poisson exchangeabilities for this first presentation of the UDM models in order to allow comparison with existing models, in particular the CXX models, which were also estimated using Poisson exchangeabilities. In practice, the CXX models are now widely used together with nonuniform exchangeabilities, for example, with the ones of the LG model (a Google Scholar search for phylogenetics “LG+C60” returned 59 results on August 22, 2019). However, the use of different exchangeabilities for estimating stationary distributions and for using these estimated stationary distributions to infer a phylogeny may have unexpected, possibly adverse effects. The reason for this is that the exchangeabilities may capture effects originally caused by across-site compositional heterogeneity, especially when they are estimated in a site-homogeneous context, such as the exchangeabilities of the LG model. Our method allows estimation of UDM models suitable for any specific set of exchangeabilities, by using these exchangeabilities during the inference of the site distributions with the CAT model. A more principled alternative would be to use the present clustering approach in the context of mutation–selection models (<xref rid="msaa145-B45" ref-type="bibr">Rodrigue et al. 2010</xref>) to estimate universal mixtures of amino acid fitness profiles.</p>
    <p>Although in this contribution we seek to provide a set of models available for universal use, data set-specific stationary distributions and weights can be estimated. First, the alignment has to be analyzed with CAT. For this purpose, it is sufficient to fix the topology; a measure greatly reducing computational requirements. If the alignment is still too computationally demanding, it is possibly to split the alignment, or randomly subsample a given number of shorter alignments which can be analyzed appropriately (jackknifing). Overall, the computational requirements are much less than a complete analysis with CAT. Second, the site distributions can be analyzed using the provided script (<xref ref-type="supplementary-material" rid="sup1">supplementary section S2</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online). Finally, phylogenetic inference can be performed using an EDM model specific to the data set. We tested this procedure on the three discussed data sets and the LBA artifacts were removed in all three cases (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online).</p>
    <p>Before closing the discussion, we would like to examine the relation of EDM models with other available methods. For example, transition rate matrix recoding methods split the amino acids into separate groups representing different physicochemical properties (<xref rid="msaa145-B25" ref-type="bibr">Kosiol et al. 2004</xref>; <xref rid="msaa145-B51" ref-type="bibr">Susko and Roger 2007</xref>). Amino acids within the same group are frequently exchanged, whereas there is hardly any exchange between amino acids of different groups. In our opinion, EDM models are very similar in that they differentiate between amino acids exhibiting frequent exchange and amino acids exhibiting no or very limited exchange. However, EDM models seem to be more flexible, because they allow specific amino acids to be member of more than one group, such that the final estimations are superpositions of the individual groupings.</p>
    <p>Next, phylogenetic mixture models require a significant amount of computational resources, in particular computer memory. For this reason, the posterior mean site frequency (PMSF, <xref rid="msaa145-B55" ref-type="bibr">Wang et al. 2018</xref>) method has been developed. For each site in the alignment, the PMSF method condenses the stationary distributions of the mixture model components into a single stationary distribution. The single stationary distribution is a weighted superposition of the stationary distributions of all mixture model components. The weights are the posterior probabilities of the site belonging to the respective mixture model components. These posterior probabilities are calculated using a so-called guide tree, which has to be given. The PMSF method speeds up calculations with EDM models and, as such, can be perfectly used with the UDM models.</p>
    <p>Similarly, EDM models can be combined with partition models. Although there might be significant evidence justifying the use of specific phylogenetic models for different partitions of the data, this is not in general the case. A canonical way of performing phylogenetic analysis could be: the same EDM model is used across all partitions of the data but a separate set of parameters is inferred for each partition. When using CXX or UDM models, one could only infer a separate set of mixture weights per partition, whereas all other parameters are shared across all partitions.</p>
    <p>Finally, usage of an additional mixture model component representing invariable sites (usually +I flag) is possible but not recommended. First, we did not analyze the effect of this measure. Second, highly constrained stationary distributions with an effective number of amino acids close to 1.0 may already imitate this feature because a very limited availability of amino acids increases the probability of a constant site in the alignment when compared with more general stationary distributions. Additionally, slowly evolving sites are modeled when accounting for across-site rate heterogeneity, for example, by a discrete Gamma distribution, which is highly recommended.</p>
    <p>Finally, the EDM models may help resolve open phylogenetic problems involving large data sets and distantly related species (<xref rid="msaa145-B48" ref-type="bibr">Simion et al. 2017</xref>; <xref rid="msaa145-B41" ref-type="bibr">Philippe et al. 2019</xref>). Further, dissimilarities in compositional heterogeneity may be detected by applying EDCluster to specific species groups. Also, the ideal number of EDM model components is still an open question. Statistical tests may not be the best guidance in developing appropriate methods because they favor component-rich EDM models. Albeit, parametric bootstrap analyses and posterior predictive analyses with Bayesian methods can be used. For EDCluster, automatic clustering algorithms could be used. In conclusion, the presented UDM models constitute a valuable alternative to the widely used CXX models and can be used for comparisons against the CAT or the CXX models. EDCluster allows estimation of stationary distributions that are specific to the data set at hand and suitable for use with nonuniform exchangeabilities.</p>
  </sec>
  <sec>
    <title>Materials and Methods</title>
    <sec>
      <title>Empirical Distribution Mixture Models</title>
      <p>Evolution of hereditary characters is assumed to occur according to a mixture of <italic>N</italic> stationary, irreducible, time-continuous Markov processes along a phylogeny <inline-formula id="IE8"><mml:math id="IM8"><mml:mi mathvariant="script">T</mml:mi></mml:math></inline-formula>. We solely use the state space of amino acids, but the concept of EDM models can be applied to arbitrary state spaces of finite cardinality. Let <italic>Q<sup>n</sup></italic> be the 20 × 20 transition rate matrix of component <italic>n</italic> with weight <italic>w<sup>n</sup></italic>. Nondiagonal entries <inline-formula id="IE9"><mml:math id="IM9"><mml:mrow><mml:msubsup><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> (<inline-formula id="IE10"><mml:math id="IM10"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mn>20</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula>) of <italic>Q<sup>n</sup></italic> can be decomposed into <inline-formula id="IE11"><mml:math id="IM11"><mml:mrow><mml:msubsup><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mo>π</mml:mo><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>. The <italic>r<sub>ij</sub></italic> are the exchangeabilities which are shared across all components, and <italic>π<sup>n</sup></italic> is the stationary distribution of component <italic>n</italic>. In this contribution, the Poisson model (<xref rid="msaa145-B8" ref-type="bibr">Felsenstein 1981</xref>) which exhibits uniform exchangeabilities was used exclusively. The stationary distributions, which differ between each component, are obtained from curated databases (see below). The diagonal entries <inline-formula id="IE12"><mml:math id="IM12"><mml:mrow><mml:msubsup><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> are set such that the row sums are zero. The transition rate matrices are normalized to ensure that one transition of the Markov process is expected to happen per unit length. Additionally, across-site rate heterogeneity can be modeled, for example, by using a discretized Gamma distribution (<xref rid="msaa145-B60" ref-type="bibr">Yang 1994a</xref>) with parameter <italic>α</italic>. Then, the complete set of EDM model parameters is <inline-formula id="IE13"><mml:math id="IM13"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">T</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>w</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:mo>α</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Excluding the phylogeny, EDM models with <italic>N</italic> components have <italic>N</italic> parameters, because <inline-formula id="IE14"><mml:math id="IM14"><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>n</mml:mi></mml:munder><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow><mml:mo>=</mml:mo><mml:mn>1.0</mml:mn></mml:mrow></mml:math></inline-formula>.</p>
    </sec>
    <sec>
      <title>HOGENOM and HSSP Databases</title>
      <p>Subsets of the HOGENOM (<xref rid="msaa145-B5" ref-type="bibr">Dufayard et al. 2005</xref>) and HSSP (<xref rid="msaa145-B46" ref-type="bibr">Schneider et al. 1997</xref>) databases consisting of 1,005 and 1,236 randomly selected alignments were obtained (<xref rid="msaa145-B43" ref-type="bibr">Quang et al. 2008</xref>). For the HOGENOM database, the 1,005 alignments contain 15–50 sequences and a total number of 175,330 amino acid sites. For the HSSP database, the 1,236 alignments contain 10–100 sequences and a total number of 260,961 amino acid sites. <xref rid="msaa145-T1" ref-type="table">Table 1</xref> shows summary statistics of both databases. The summary statistics include the number of sequences and the number sites of the complete databases, and of the analyzed subsets. Further, the percentage of analyzed sites falling into each domain of life provides a rough idea about the taxonomic composition of the analyzed data. First, the analyzed number of sites is slightly larger in the HSSP database compared with the HOGENOM database. Second, and more importantly, the proportion of eukaryotes and bacteria differs largely. The analyzed subset of the HOGENOM database contains a substantially higher proportion of eukaryotes compared with the HSSP database, which comprises a higher proportion of bacteria.
</p>
      <table-wrap id="msaa145-T1" orientation="portrait" position="float">
        <label>Table 1.</label>
        <caption>
          <p>Size of the HOGENOM and HSSP Databases and the Analyzed Subsets.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1">HOGENOM</th>
              <th rowspan="1" colspan="1">HSSP</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Number of sequences</td>
              <td rowspan="1" colspan="1">153,818</td>
              <td rowspan="1" colspan="1">42,999</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Number of sites</td>
              <td rowspan="1" colspan="1">40,835,577</td>
              <td rowspan="1" colspan="1">9,305,643</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Number of analyzed sequences</td>
              <td rowspan="1" colspan="1">1,005</td>
              <td rowspan="1" colspan="1">1,236</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Number of analyzed sites</td>
              <td rowspan="1" colspan="1">175,330</td>
              <td rowspan="1" colspan="1">260,961</td>
            </tr>
            <tr>
              <td colspan="3" rowspan="1">Distribution across domains in analyzed subsets</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Archaea</td>
              <td rowspan="1" colspan="1">1.6%</td>
              <td rowspan="1" colspan="1">1.8%</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Bacteria</td>
              <td rowspan="1" colspan="1">27.4%</td>
              <td rowspan="1" colspan="1">59.3%</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Eukaryotes</td>
              <td rowspan="1" colspan="1">71.0%</td>
              <td rowspan="1" colspan="1">35.1%</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Viridiae</td>
              <td rowspan="1" colspan="1">0.0%</td>
              <td rowspan="1" colspan="1">3.8%</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p>A rough measure of the taxonomic composition is given in the form of the percentage of analyzed sites falling into each domain of life.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>Site Distributions</title>
      <p>For each alignment, a separate Bayesian analysis was conducted using the CAT model (<xref rid="msaa145-B28" ref-type="bibr">Lartillot and Philippe 2004</xref>) with Poisson exchangeabilities. Phylobayes (<xref rid="msaa145-B30" ref-type="bibr">Lartillot et al. 2013</xref>) was used for the Bayesian analyses. The phylogenies were fixed to the ones estimated by <xref rid="msaa145-B43" ref-type="bibr">Quang et al. (2008)</xref> who had used the WAG model (<xref rid="msaa145-B57" ref-type="bibr">Whelan and Goldman 2001</xref>) and PhyML (<xref rid="msaa145-B15" ref-type="bibr">Guindon et al. 2010</xref>). Command lines are stated in <xref ref-type="supplementary-material" rid="sup1">supplementary section S1</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online. For each alignment and each site, the posterior distribution of the stationary distribution of amino acids is a mapping from the 20D simplex to the unit interval <inline-formula id="IE15"><mml:math id="IM15"><mml:mrow><mml:mi>p</mml:mi><mml:mo>:</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mn>20</mml:mn></mml:mrow></mml:msup><mml:mo>→</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. The corresponding site distribution, which is the expectation E(<italic>p</italic>), is a point on the 20D simplex <italic>S</italic><sup>20</sup>. The site distributions of all sites were collected and used as a basis for all further analysis.</p>
    </sec>
    <sec>
      <title>Transformations of Site Distributions</title>
      <p>The site distributions were analyzed as is, or after transformation from the <xref rid="msaa145-B1" ref-type="bibr">Aitchison (1982)</xref> simplex to real space, which is a standard procedure when analyzing compositional data. First, the well-characterized centered log-ratio transformation <inline-formula id="IE16"><mml:math id="IM16"><mml:mrow><mml:mtext>CLR</mml:mtext><mml:mo>:</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mi>d</mml:mi></mml:msup><mml:mo>→</mml:mo><mml:msup><mml:mo>ℝ</mml:mo><mml:mi>d</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> (<xref rid="msaa145-B1" ref-type="bibr">Aitchison 1982</xref>) was used. The CLR transformation of a point <inline-formula id="IE17"><mml:math id="IM17"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is defined as
<disp-formula id="E1"><label>(1)</label><mml:math id="M1"><mml:mrow><mml:mtext>CLR</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>ln</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo stretchy="true">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE18"><mml:math id="IM18"><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>:</mml:mo><mml:msubsup><mml:mo>ℝ</mml:mo><mml:mo>+</mml:mo><mml:mi>d</mml:mi></mml:msubsup><mml:mo>→</mml:mo><mml:msub><mml:mo>ℝ</mml:mo><mml:mo>+</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> is the geometric mean. Basically, the coordinates of <italic>x</italic> are fanned out from [0, 1]<sup><italic>d</italic></sup> to <inline-formula id="IE19"><mml:math id="IM19"><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mo>∞</mml:mo><mml:mo>,</mml:mo><mml:mo>∞</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>d</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, with the origin <inline-formula id="IE20"><mml:math id="IM20"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> being <inline-formula id="IE21"><mml:math id="IM21"><mml:mrow><mml:mtext>CLR</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Recently, <xref rid="msaa145-B11" ref-type="bibr">Godichon-Baggioni et al. (2019)</xref> reported a novel log centered log-ratio transformation <inline-formula id="IE22"><mml:math id="IM22"><mml:mrow><mml:mtext>LCLR</mml:mtext><mml:mo>:</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mi>d</mml:mi></mml:msup><mml:mo>→</mml:mo><mml:msup><mml:mo>ℝ</mml:mo><mml:mi>d</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> derived from the CLR transformation
<disp-formula id="E3"><label>(2)</label><mml:math id="M2"><mml:mrow><mml:mtext>LCLR</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>ln</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ln</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo stretchy="true">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>ln</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>otherwise</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p>
      <p>The LCLR transformation moves points that are close to the boundary of the simplex even further away from points that are more in the interior than the CLR transformation. Hence, after the LCLR transformation, points with a low effective number of amino acids (see below) have high Euclidean distances to points with high effective number of amino acids, which is a desired feature.</p>
    </sec>
    <sec>
      <title>Clustering Procedure</title>
      <p><italic>K</italic>-means clustering with <inline-formula id="IE23"><mml:math id="IM23"><mml:mrow><mml:mi>K</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>8</mml:mn><mml:mo>,</mml:mo><mml:mn>16</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>256</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> was performed on untransformed, CLR-transformed, and LCLR-transformed site distributions with scikit-learn (<xref rid="msaa145-B37" ref-type="bibr">Pedregosa et al. 2011</xref>). A maximum number of 500 iterations and a tolerance of 5<italic>e</italic>–5 were used. The stationary distributions of the components of the UDM models are assigned to the obtained cluster centers. The weight of each component is set to the proportion of sites belonging to the respective cluster. During phylogenetic inference, the proposed mixture model weights can be employed without change or estimated during maximization of the likelihood. In fact, all analyses presented in this manuscript use variable weights estimated during maximization of the likelihood. For details on the EDCluster script used for transforming and clustering the site distributions, please refer to <xref ref-type="supplementary-material" rid="sup1">supplementary section S2</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online. In total, we distinguish UDM models with seven different numbers of components, three different types of transformations, and three different databases (HOGENOM, HSSP, and their union). EDCluster, and the obtained stationary distributions and weights are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/dschrempf/edcluster">s://github.com/dschrempf/edcluster (last accessed July 8, 2020)</ext-link>. <xref ref-type="supplementary-material" rid="sup1">Supplementary sections S3 and S4</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online, present additional analyses of the stationary distributions and weights, and usage instructions for IQ-TREE (<xref rid="msaa145-B35" ref-type="bibr">Nguyen et al. 2015</xref>), Phylobayes, and RevBayes (<xref rid="msaa145-B18" ref-type="bibr">Höhna et al. 2016</xref>), respectively.</p>
    </sec>
    <sec>
      <title>Effective Number of Amino Acids</title>
      <p>Metaphorically speaking, entropy is a measure of disorder of a probability distribution. The entropy of a given site distribution <italic>π</italic> is defined as
<disp-formula id="E5"><label>(3)</label><mml:math id="M3"><mml:mrow><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>π</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mo>π</mml:mo><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:msub><mml:mo>π</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p>Here, we use the entropy to measure the diversity of a site distribution in the following way:
<disp-formula id="E7"><label>(4)</label><mml:math id="M4"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mtext>eff</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>π</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="normal">e</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>π</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>20</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p>For readability, the explicit dependency on <italic>π</italic> is mostly omitted. We term <italic>K</italic><sub>eff</sub> the <italic>effective number of amino acids</italic>, and stationary distributions with high (low) <italic>K</italic><sub>eff</sub><italic>general</italic> (<italic>constrained</italic>). An effective number of amino acids of <italic>K</italic><sub>eff</sub> = 1 corresponds to a highly constrained stationary distribution where a single amino acid has probability 1.0, whereas all other amino acids have zero probability. The uniform stationary distribution with <italic>K</italic><sub>eff</sub> = 20 is the most general.</p>
    </sec>
    <sec>
      <title>Analyses of Data Sets</title>
      <p>The alignments of the microsporidia, nematode and platyhelminth data sets were obtained from <xref rid="msaa145-B2" ref-type="bibr">Brinkmann et al. (2005)</xref> and <xref rid="msaa145-B40" ref-type="bibr">Philippe et al. (2005)</xref>, respectively. The microsporidia data set contains 40 sequences with a length of 24,294 sites. The percentage of gaps is 24.1% and the average effective number of amino acids is 2.569. The nematode data set contains 37 sequences with a length of 35,371 sites. The percentage of gaps is 28.7% and the average effective number of amino acids is 2.116. The platyhelminth data set contains 32 sequences with a length of 35,371 sites. The percentage of gaps is 30.7% and the average effective number of amino acids is 2.069. The IQ-TREE software package was used for all analyses of the three data sets.</p>
      <p>Phylogenetic inference was performed using the WAG, and the LG (<xref rid="msaa145-B31" ref-type="bibr">Le and Gascuel 2008</xref>) substitution models, the C10–C60 models (collectively called CXX models; <xref rid="msaa145-B43" ref-type="bibr">Quang et al. 2008</xref>), and the UDM models with 4, 8, 16, <italic>A</italic>…, 256 components. For all analyses, a discrete Gamma distribution with four bins was used to deal with across-site rate heterogeneity (+G4 model string). For the WAG and LG models, the stationary distribution of amino acids was set to the one observed in the respective alignment. We refrained from adding the stationary distribution of amino acids observed in the data as an additional component to the CXX and UDM models. The weights of the mixture model components of the CXX and UDM models were inferred during maximization of the likelihood. Detailed instruction about how to perform phylogenetic inference with UDM models in IQ-TREE is given in <xref ref-type="supplementary-material" rid="sup1">supplementary section S4</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online. For each data set and model, three maximum likelihood analyses were conducted: first, a maximum likelihood analysis inferring the model parameters as well as the topology and the branch lengths of the phylogeny. Further, two analyses with fixed topologies (T1, and T2, see <xref ref-type="fig" rid="msaa145-F3">fig. 3</xref>) were conducted (-t option in IQ-TREE). The branch lengths were inferred without exception.</p>
      <p>The analyses of the separated microsporidia genes were performed with Phylobayes. Results for the LG model, the CAT model with Poisson exchangeabilities, and UDM models with four, up to 128 components also with Poisson exchangeabilities were obtained. A burn-in of 100 steps and a total of 1,100 steps were used. Rate heterogeneity was accounted for with a discrete gamma distribution with four categories. The inferred trees were compared with two trees T1 and T2 (<xref rid="msaa145-B2" ref-type="bibr">Brinkmann et al. 2005</xref>). If a gene only contained a subset of all species, the trees T1 and T2 were pruned before comparison such that they contained the same set of species as the respective gene. The symmetric distance (<xref rid="msaa145-B44" ref-type="bibr">Robinson and Foulds 1981</xref>), the branch score distance (<xref rid="msaa145-B26" ref-type="bibr">Kuhner and Felsenstein 1994</xref>), and the incompatible split distance were computed. The incompatible split distance is similar to the symmetric distance in that it only accounts for topological differences. However, topological uncertainties do not contribute to the incompatible split distance. Briefly, let us compare two topologies <inline-formula id="IE24"><mml:math id="IM24"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE25"><mml:math id="IM25"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, and let <italic>B</italic><sub>1</sub> be the only bipartition induced by <inline-formula id="IE26"><mml:math id="IM26"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> not induced by <inline-formula id="IE27"><mml:math id="IM27"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. Then, the symmetric distance between <inline-formula id="IE28"><mml:math id="IM28"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE29"><mml:math id="IM29"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is strictly larger than zero. For the incompatible split distance, however, additionally all multifurcations of <inline-formula id="IE30"><mml:math id="IM30"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> have to be examined. If a multifurcation of <inline-formula id="IE31"><mml:math id="IM31"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> can be resolved such that the resolved order of splits induces <italic>B</italic><sub>1</sub>, the incompatible split distance is zero.</p>
    </sec>
    <sec>
      <title>Parametric Bootstrap Analyses</title>
      <p>For each data set and phylogenetic model, the maximum-likelihood phylogeny and model parameters were used to simulate an alignment with 25,000 sites. For the CXX and UDM models, the stationary distribution at each site is determined randomly from the stationary distributions of the mixture model components using the weights from the respective maximum likelihood inferences. A custom simulator written in Haskell (elynx; <xref ref-type="supplementary-material" rid="sup1">supplementary section S8</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online) was used for this purpose. Subsequently, the effective number of amino acids <italic>K</italic><sub>eff</sub> was calculated per site in the alignment. The obtained distribution of <italic>K</italic><sub>eff</sub> values was compared with the one of the original data set using the Wasserstein distance as it is implemented in SciPy (<xref rid="msaa145-B20" ref-type="bibr">Jones et al. 2001</xref>).</p>
    </sec>
    <sec>
      <title>Phylogenetic Artifact Can Be Reproduced in Simulation Study</title>
      <p>The phylogeny used to simulate the alignment was chosen from an analysis of the microsporidia data set (<xref rid="msaa145-B2" ref-type="bibr">Brinkmann et al. 2005</xref>) with the UDM model with 64 components obtained from clustering the LCLR-transformed site distributions. elynx (<xref ref-type="supplementary-material" rid="sup1">supplementary section S8</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref> online) was used to simulate 25,000 sites using Poisson exchangeabilities. Each site was randomly assigned a stationary distribution sampled with replacement from the site distributions of the HOGENOM database which had been obtained by the Bayesian CAT analyses described above. The simulated alignment was analyzed with IQ-TREE using the Poisson model with the empirical distribution observed in the alignment (Poisson+F model string), and the UDM models with four up to 64 components obtained from clustering the LCLR-transformed site distributions. Ultrafast bootstrap (<xref rid="msaa145-B17" ref-type="bibr">Hoang et al. 2018</xref>) with 1,000 samples was used with all models (-bb 1000 option).</p>
      <p>The simulated alignment with 25,000 columns was used to randomly subsample short alignments of length 100, 200, 400, 800, and 1,000 columns with replacement. For each length, 25 replicate alignments were subsampled. Trees were inferred with IQ-TREE using the Poisson model, the LG model, and UDM models with up to 256 components with fixed component weights. Symmetric and the branch score distances were calculated between the inferred trees and the original tree used for the simulation.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Molecular Biology and Evolution</italic> online.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>msaa145_supplementary_data</label>
      <media xlink:href="msaa145_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgments</title>
    <p>D.S. and G.S. received funding from the European Research Council under the European Union’s Horizon 2020 Research and Innovation Program (Grant Agreement No. 714774). D.S. was also supported by a stipend of excellency of the Austrian government. G.S. was also supported by the Grant GINOP-2.3.2.–15–2016–00057. Some computations were performed on the LBBE/PRABI cluster and on the HPC resources of CINES under the allocation A0040310449 made by GENCI.</p>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="msaa145-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Aitchison</surname><given-names>J.</given-names></name></person-group><year>1982</year><article-title>The statistical analysis of compositional data</article-title>. <source>J R Stat Soc B</source>. <volume>44</volume>(<issue>2</issue>):<fpage>139</fpage>–<lpage>177</lpage>.</mixed-citation>
    </ref>
    <ref id="msaa145-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Brinkmann</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Van Der Giezen</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Zhou</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>De Raucourt</surname><given-names>GP</given-names></name>, <name name-style="western"><surname>Philippe</surname><given-names>H.</given-names></name></person-group><year>2005</year><article-title>An empirical assessment of long-branch attraction artefacts in deep eukaryotic phylogenomics</article-title>. <source>Syst Biol</source>. <volume>54</volume>(<issue>5</issue>):<fpage>743</fpage>–<lpage>757</lpage>.<pub-id pub-id-type="pmid">16243762</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cavalier-Smith</surname><given-names>T.</given-names></name></person-group><year>1987</year><article-title>Eukaryotes with no mitochondria</article-title>. <source>Nature</source><volume>326</volume>(<issue>6111</issue>):<fpage>332</fpage>–<lpage>333</lpage>.<pub-id pub-id-type="pmid">3561476</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Crooks</surname><given-names>GE.</given-names></name></person-group><year>2004</year><article-title>WebLogo: a sequence logo generator</article-title>. <source>Genome Res</source>. <volume>14</volume>(<issue>6</issue>):<fpage>1188</fpage>–<lpage>1190</lpage>.<pub-id pub-id-type="pmid">15173120</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Dufayard</surname><given-names>J-F</given-names></name>, <name name-style="western"><surname>Duret</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Penel</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Gouy</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Rechenmann</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Perrière</surname><given-names>G.</given-names></name></person-group><year>2005</year><article-title>Tree pattern matching in phylogenetic trees: automatic search for orthologs or paralogs in homologous gene sequence databases</article-title>. <source>Bioinformatics</source><volume>21</volume>(<issue>11</issue>):<fpage>2596</fpage>–<lpage>2603</lpage>.<pub-id pub-id-type="pmid">15713731</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B6">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Ester</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Kriegel</surname><given-names>H-P</given-names></name>, <name name-style="western"><surname>Sander</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Xu</surname><given-names>X.</given-names></name></person-group><year>1996</year> A density-based algorithm for discovering clusters in large spatial databases with noise. In: Simoudis E, Han J, Fayyad U, editors. Proceedings of 2nd International Conference on Knowledge Discovery and Data Mining. Menlo Park (CA): The AAAI Press. p. <fpage>226</fpage>–<lpage>231</lpage>.</mixed-citation>
    </ref>
    <ref id="msaa145-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Felsenstein</surname><given-names>J.</given-names></name></person-group><year>1978</year><article-title>Cases in which parsimony or compatibility methods will be positively misleading</article-title>. <source>Syst Biol</source>. <volume>27</volume>(<issue>4</issue>):<fpage>401</fpage>–<lpage>410</lpage>.</mixed-citation>
    </ref>
    <ref id="msaa145-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Felsenstein</surname><given-names>J.</given-names></name></person-group><year>1981</year><article-title>Evolutionary trees from DNA sequences: a maximum likelihood approach</article-title>. <source>J Mol Evol</source>. <volume>17</volume>(<issue>6</issue>):<fpage>368</fpage>–<lpage>376</lpage>.<pub-id pub-id-type="pmid">7288891</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Feuda</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Dohrmann</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Pett</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Philippe</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Rota-Stabelli</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Lartillot</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Wörheide</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Pisani</surname><given-names>D.</given-names></name></person-group><year>2017</year><article-title>Improved modeling of compositional heterogeneity supports sponges as sister to all other animals</article-title>. <source>Curr Biol</source>. <volume>27</volume>(<issue>24</issue>):<fpage>3864</fpage>–<lpage>3870</lpage>.<pub-id pub-id-type="pmid">29199080</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B10">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Franzosa</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Xia</surname><given-names>Y.</given-names></name></person-group><year>2008</year><chapter-title>Structural perspectives on protein evolution.</chapter-title> In: <person-group person-group-type="editor"><name name-style="western"><surname>Wheeler</surname><given-names>RA</given-names></name>, <name name-style="western"><surname>Spellmeyer</surname><given-names>DC</given-names></name></person-group>, editors. <source>Annual reports in computational chemistry</source>. New York: Elsevier. p. <fpage>3</fpage>–<lpage>21</lpage>.</mixed-citation>
    </ref>
    <ref id="msaa145-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Godichon-Baggioni</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Maugis-Rabusseau</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Rau</surname><given-names>A.</given-names></name></person-group><year>2019</year><article-title>Clustering transformed compositional data using k-means, with applications in gene expression and bicycle sharing system data</article-title>. <source>J Appl Stat</source>. <volume>46</volume>(<issue>1</issue>):<fpage>47</fpage>–<lpage>65</lpage>.</mixed-citation>
    </ref>
    <ref id="msaa145-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Goldman</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Thorne</surname><given-names>JL</given-names></name>, <name name-style="western"><surname>Jones</surname><given-names>DT.</given-names></name></person-group><year>1996</year><article-title>Using evolutionary trees in protein secondary structure prediction and other comparative sequence analyses</article-title>. <source>J Mol Biol</source>. <volume>263</volume>(<issue>2</issue>):<fpage>196</fpage>–<lpage>208</lpage>.<pub-id pub-id-type="pmid">8913301</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Goldman</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Thorne</surname><given-names>JL</given-names></name>, <name name-style="western"><surname>Jones</surname><given-names>DT.</given-names></name></person-group><year>1998</year><article-title>Assessing the impact of secondary structure and solvent accessibility on protein evolution</article-title>. <source>Genetics</source><volume>149</volume>(<issue>1</issue>):<fpage>445</fpage>–<lpage>458</lpage>.<pub-id pub-id-type="pmid">9584116</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Goldstein</surname><given-names>RA.</given-names></name></person-group><year>2008</year><article-title>The structure of protein evolution and the evolution of protein structure</article-title>. <source>Curr Opin Struct Biol</source>. <volume>18</volume>(<issue>2</issue>):<fpage>170</fpage>–<lpage>177</lpage>.<pub-id pub-id-type="pmid">18328690</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Guindon</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Dufayard</surname><given-names>J-F</given-names></name>, <name name-style="western"><surname>Lefort</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Anisimova</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Hordijk</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Gascuel</surname><given-names>O.</given-names></name></person-group><year>2010</year><article-title>New algorithms and methods to estimate maximum-likelihood phylogenies: assessing the performance of PhyML 3.0</article-title>. <source>Syst Biol</source>. <volume>59</volume>(<issue>3</issue>):<fpage>307</fpage>–<lpage>321</lpage>.<pub-id pub-id-type="pmid">20525638</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hirt</surname><given-names>RP</given-names></name>, <name name-style="western"><surname>Logsdon</surname><given-names>JM</given-names></name>, <name name-style="western"><surname>Healy</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Dorey</surname><given-names>MW</given-names></name>, <name name-style="western"><surname>Doolittle</surname><given-names>WF</given-names></name>, <name name-style="western"><surname>Embley</surname><given-names>TM.</given-names></name></person-group><year>1999</year><article-title>Microsporidia are related to fungi: evidence from the largest subunit of RNA polymerase II and other proteins</article-title>. <source>Proc Natl Acad Sci U S A</source>. <volume>96</volume>(<issue>2</issue>):<fpage>580</fpage>–<lpage>585</lpage>.<pub-id pub-id-type="pmid">9892676</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hoang</surname><given-names>DT</given-names></name>, <name name-style="western"><surname>Chernomor</surname><given-names>O</given-names></name>, <name name-style="western"><surname>von Haeseler</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Minh</surname><given-names>BQ</given-names></name>, <name name-style="western"><surname>Le</surname><given-names>SV.</given-names></name></person-group><year>2018</year><article-title>Ufboot2: improving the ultrafast bootstrap approximation</article-title>. <source>Mol Biol Evol</source>. <volume>35</volume>(<issue>2</issue>):<fpage>518</fpage>–<lpage>522</lpage>.<pub-id pub-id-type="pmid">29077904</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Höhna</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Landis</surname><given-names>MJ</given-names></name>, <name name-style="western"><surname>Heath</surname><given-names>TA</given-names></name>, <name name-style="western"><surname>Boussau</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Lartillot</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Moore</surname><given-names>BR</given-names></name>, <name name-style="western"><surname>Huelsenbeck</surname><given-names>JP</given-names></name>, <name name-style="western"><surname>Ronquist</surname><given-names>F.</given-names></name></person-group><year>2016</year><article-title>RevBayes: Bayesian phylogenetic inference using graphical models and an interactive model-specification language</article-title>. <source>Syst Biol</source>. <volume>65</volume>(<issue>4</issue>):<fpage>726</fpage>–<lpage>736</lpage>.<pub-id pub-id-type="pmid">27235697</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jimenez</surname><given-names>MJ</given-names></name>, <name name-style="western"><surname>Arenas</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Bastolla</surname><given-names>U.</given-names></name></person-group><year>2018</year><article-title>Substitution rates predicted by stability-constrained models of protein evolution are not consistent with empirical data</article-title>. <source>Mol Biol Evol</source>. <volume>35</volume>(<issue>3</issue>):<fpage>743</fpage>–<lpage>755</lpage>.<pub-id pub-id-type="pmid">29294047</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B20">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Jones</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Oliphant</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Peterson</surname><given-names>P.</given-names></name></person-group><year>2001</year>. Scipy: open source scientific tools for python.</mixed-citation>
    </ref>
    <ref id="msaa145-B21">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Jukes</surname><given-names>TH</given-names></name>, <name name-style="western"><surname>Cantor</surname><given-names>CR.</given-names></name></person-group><year>1969</year><chapter-title>Evolution of protein molecules.</chapter-title> In: <person-group person-group-type="editor"><name name-style="western"><surname>Munro</surname><given-names>HN</given-names></name></person-group>, editor. <source>Mammalian protein metabolism</source>. p. <fpage>21</fpage>–<lpage>132</lpage>.</mixed-citation>
    </ref>
    <ref id="msaa145-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kamaishi</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Hashimoto</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Nakamura</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Masuda</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Nakamura</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Okamoto</surname><given-names>K-I</given-names></name>, <name name-style="western"><surname>Shimizu</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Hasegawa</surname><given-names>M.</given-names></name></person-group><year>1996</year><article-title>Complete nucleotide sequences of the genes encoding translation elongation factors 1 and 2 from a microsporidian parasite, <italic>Glugea plecoglossi</italic>: implications for the deepest branching of eukaryotes</article-title>. <source>J Biochem</source>. <volume>120</volume>(<issue>6</issue>):<fpage>1095</fpage>–<lpage>1103</lpage>.<pub-id pub-id-type="pmid">9010756</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Keeling</surname><given-names>PJ</given-names></name>, <name name-style="western"><surname>Fast</surname><given-names>NM.</given-names></name></person-group><year>2002</year><article-title>Microsporidia: biology and evolution of highly reduced intracellular parasites</article-title>. <source>Annu Rev Microbiol</source>. <volume>56</volume>(<issue>1</issue>):<fpage>93</fpage>–<lpage>116</lpage>.<pub-id pub-id-type="pmid">12142484</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Keeling</surname><given-names>PJ</given-names></name>, <name name-style="western"><surname>Luker</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Palmer</surname><given-names>JD.</given-names></name></person-group><year>2000</year><article-title>Evidence from beta-tubulin phylogeny that microsporidia evolved from within the fungi</article-title>. <source>Mol Biol Evol</source>. <volume>17</volume>(<issue>1</issue>):<fpage>23</fpage>–<lpage>31</lpage>.<pub-id pub-id-type="pmid">10666703</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kosiol</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Goldman</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Buttimore</surname><given-names>NH.</given-names></name></person-group><year>2004</year><article-title>A new criterion and method for amino acid classification</article-title>. <source>J Theor Biol</source>. <volume>228</volume>(<issue>1</issue>):<fpage>97</fpage>–<lpage>106</lpage>.<pub-id pub-id-type="pmid">15064085</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kuhner</surname><given-names>MK</given-names></name>, <name name-style="western"><surname>Felsenstein</surname><given-names>J.</given-names></name></person-group><year>1994</year><article-title>A simulation comparison of phylogeny algorithms under equal and unequal evolutionary rates</article-title>. <source>Mol Biol Evol</source>. <volume>11</volume>(<issue>3</issue>):<fpage>459</fpage>–<lpage>468</lpage>.<pub-id pub-id-type="pmid">8015439</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lanfear</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Frandsen</surname><given-names>PB</given-names></name>, <name name-style="western"><surname>Wright</surname><given-names>AM</given-names></name>, <name name-style="western"><surname>Senfeld</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Calcott</surname><given-names>B.</given-names></name></person-group><year>2017</year><article-title>PartitionFinder 2: new methods for selecting partitioned models of evolution for molecular and morphological phylogenetic analyses</article-title>. <source>Mol Biol Evol</source>. <volume>34</volume>(<issue>3</issue>):<fpage>772</fpage>–<lpage>773</lpage>.<pub-id pub-id-type="pmid">28013191</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lartillot</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Philippe</surname><given-names>H.</given-names></name></person-group><year>2004</year><article-title>A Bayesian mixture model for across-site heterogeneities in the amino-acid replacement process</article-title>. <source>Mol Biol Evol</source>. <volume>21</volume>(<issue>6</issue>):<fpage>1095</fpage>–<lpage>1109</lpage>.<pub-id pub-id-type="pmid">15014145</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lartillot</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Brinkmann</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Philippe</surname><given-names>H.</given-names></name></person-group><year>2007</year><article-title>Suppression of long-branch attraction artefacts in the animal phylogeny using a site-heterogeneous model</article-title>. <source>BMC Evol Biol</source>. <volume>7(Suppl 1</volume>):<fpage>S4</fpage>–<lpage>S14</lpage>.</mixed-citation>
    </ref>
    <ref id="msaa145-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lartillot</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Rodrigue</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Stubbs</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Richer</surname><given-names>J.</given-names></name></person-group><year>2013</year><article-title>PhyloBayes MPI: phylogenetic reconstruction with infinite mixtures of profiles in a parallel environment</article-title>. <source>Syst Biol</source>. <volume>62</volume>(<issue>4</issue>):<fpage>611</fpage>–<lpage>615</lpage>.<pub-id pub-id-type="pmid">23564032</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Le</surname><given-names>SQ</given-names></name>, <name name-style="western"><surname>Gascuel</surname><given-names>O.</given-names></name></person-group><year>2008</year><article-title>An improved general amino acid replacement matrix</article-title>. <source>Mol Biol Evol</source>. <volume>25</volume>(<issue>7</issue>):<fpage>1307</fpage>–<lpage>1320</lpage>.<pub-id pub-id-type="pmid">18367465</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Le</surname><given-names>SQ</given-names></name>, <name name-style="western"><surname>Gascuel</surname><given-names>O.</given-names></name></person-group><year>2010</year><article-title>Accounting for solvent accessibility and secondary structure in protein phylogenetics is clearly beneficial</article-title>. <source>Syst Biol</source>. <volume>59</volume>(<issue>3</issue>):<fpage>277</fpage>–<lpage>287</lpage>.<pub-id pub-id-type="pmid">20525635</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Le</surname><given-names>SQ</given-names></name>, <name name-style="western"><surname>Dang</surname><given-names>CC</given-names></name>, <name name-style="western"><surname>Gascuel</surname><given-names>O.</given-names></name></person-group><year>2012</year><article-title>Modeling protein evolution with several amino acid replacement matrices depending on site rates</article-title>. <source>Mol Biol Evol</source>. <volume>29</volume>(<issue>10</issue>):<fpage>2921</fpage>–<lpage>2936</lpage>.<pub-id pub-id-type="pmid">22491036</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Le</surname><given-names>SQ</given-names></name>, <name name-style="western"><surname>Lartillot</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Gascuel</surname><given-names>O.</given-names></name></person-group><year>2008</year><article-title>Phylogenetic mixture models for proteins</article-title>. <source>Philos Trans R Soc Lond B Biol Sci</source>. <volume>363</volume>(<issue>1512</issue>):<fpage>3965</fpage>–<lpage>3976</lpage>.<pub-id pub-id-type="pmid">18852096</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Nguyen</surname><given-names>L-T</given-names></name>, <name name-style="western"><surname>Schmidt</surname><given-names>HA</given-names></name>, <name name-style="western"><surname>von Haeseler</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Minh</surname><given-names>BQ.</given-names></name></person-group><year>2015</year><article-title>IQ-TREE: a fast and effective stochastic algorithm for estimating maximum-likelihood phylogenies</article-title>. <source>Mol Biol Evol</source>. <volume>32</volume>(<issue>1</issue>):<fpage>268</fpage>–<lpage>274</lpage>.<pub-id pub-id-type="pmid">25371430</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pál</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Papp</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Lercher</surname><given-names>MJ.</given-names></name></person-group><year>2006</year><article-title>An integrated view of protein evolution</article-title>. <source>Nat Rev Genet</source>. <volume>7</volume>(<issue>5</issue>):<fpage>337</fpage>–<lpage>348</lpage>.<pub-id pub-id-type="pmid">16619049</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pedregosa</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Varoquaux</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Gramfort</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Michel</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Thirion</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Grisel</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Blondel</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Prettenhofer</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Weiss</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Dubourg</surname><given-names>V</given-names></name></person-group>, <etal>et al</etal><year>2011</year><article-title>Scikit-learn: machine learning in Python</article-title>. <source>J Mach Learn Res</source>. <volume>12</volume>:<fpage>2825</fpage>–<lpage>2830</lpage>.</mixed-citation>
    </ref>
    <ref id="msaa145-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Philippe</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Brinkmann</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Lavrov</surname><given-names>DV</given-names></name>, <name name-style="western"><surname>Littlewood</surname><given-names>DTJ</given-names></name>, <name name-style="western"><surname>Manuel</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Wörheide</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Baurain</surname><given-names>D.</given-names></name></person-group><year>2011</year><article-title>Resolving difficult phylogenetic questions: why more sequences are not enough</article-title>. <source>PLoS Biol</source>. <volume>9</volume>(<issue>3</issue>):<fpage>e1000602</fpage>.<pub-id pub-id-type="pmid">21423652</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Philippe</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Laurent</surname><given-names>J.</given-names></name></person-group><year>1998</year><article-title>How good are deep phylogenetic trees?</article-title><source>Curr Opin Genet Dev</source>. <volume>8</volume>(<issue>6</issue>):<fpage>616</fpage>–<lpage>623</lpage>.<pub-id pub-id-type="pmid">9914208</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Philippe</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Lartillot</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Brinkmann</surname><given-names>H.</given-names></name></person-group><year>2005</year><article-title>Multigene analyses of bilaterian animals corroborate the monophyly of Ecdysozoa, Lophotrochozoa, and Protostomia</article-title>. <source>Mol Biol Evol</source>. <volume>22</volume>(<issue>5</issue>):<fpage>1246</fpage>–<lpage>1253</lpage>.<pub-id pub-id-type="pmid">15703236</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Philippe</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Poustka</surname><given-names>AJ</given-names></name>, <name name-style="western"><surname>Chiodin</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Hoff</surname><given-names>KJ</given-names></name>, <name name-style="western"><surname>Dessimoz</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Tomiczek</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Schiffer</surname><given-names>PH</given-names></name>, <name name-style="western"><surname>Müller</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Domman</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Horn</surname><given-names>M</given-names></name></person-group>, <etal>et al</etal><year>2019</year><article-title>Mitigating anticipated effects of systematic errors supports sister-group relationship between Xenacoelomorpha and Ambulacraria</article-title>. <source>Curr Biol</source>. <volume>29</volume>(<issue>11</issue>):<fpage>1818</fpage>–<lpage>1826.e6</lpage>.<pub-id pub-id-type="pmid">31104936</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pisani</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Pett</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Dohrmann</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Feuda</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Rota-Stabelli</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Philippe</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Lartillot</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Wörheide</surname><given-names>G.</given-names></name></person-group><year>2015</year><article-title>Genomic data do not support comb jellies as the sister group to all other animals</article-title>. <source>Proc Natl Acad Sci U S A</source>. <volume>112</volume>(<issue>50</issue>):<fpage>15402</fpage>–<lpage>15407</lpage>.<pub-id pub-id-type="pmid">26621703</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Quang</surname><given-names>LS</given-names></name>, <name name-style="western"><surname>Gascuel</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Lartillot</surname><given-names>N.</given-names></name></person-group><year>2008</year><article-title>Empirical profile mixture models for phylogenetic reconstruction</article-title>. <source>Bioinformatics</source><volume>24</volume>(<issue>20</issue>):<fpage>2317</fpage>–<lpage>2323</lpage>.<pub-id pub-id-type="pmid">18718941</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Robinson</surname><given-names>DF</given-names></name>, <name name-style="western"><surname>Foulds</surname><given-names>LR.</given-names></name></person-group><year>1981</year><article-title>Comparison of phylogenetic trees</article-title>. <source>Math Biosci</source>. <volume>53</volume>(<issue>1–2</issue>):<fpage>131</fpage>–<lpage>147</lpage>.</mixed-citation>
    </ref>
    <ref id="msaa145-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rodrigue</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Philippe</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Lartillot</surname><given-names>N.</given-names></name></person-group><year>2010</year><article-title>Mutation-selection models of coding sequence evolution with site-heterogeneous amino acid fitness profiles</article-title>. <source>Proc Natl Acad Sci U S A</source>. <volume>107</volume>(<issue>10</issue>):<fpage>4629</fpage>–<lpage>4634</lpage>.<pub-id pub-id-type="pmid">20176949</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Schneider</surname><given-names>R</given-names></name>, <name name-style="western"><surname>de Daruvar</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Sander</surname><given-names>C.</given-names></name></person-group><year>1997</year><article-title>The HSSP database of protein structure-sequence alignments</article-title>. <source>Nucleic Acids Res</source>. <volume>25</volume>(<issue>1</issue>):<fpage>226</fpage>–<lpage>230</lpage>.<pub-id pub-id-type="pmid">9016541</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Schwarz</surname><given-names>GE.</given-names></name></person-group><year>1978</year><article-title>Estimating the dimension of a model</article-title>. <source>Ann Stat</source>. <volume>6</volume>(<issue>2</issue>):<fpage>461</fpage>–<lpage>464</lpage>.</mixed-citation>
    </ref>
    <ref id="msaa145-B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Simion</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Philippe</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Baurain</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Jager</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Richter</surname><given-names>DJ</given-names></name>, <name name-style="western"><surname>Di Franco</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Roure</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Satoh</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Quéinnec</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Ereskovsky</surname><given-names>A</given-names></name></person-group>, <etal>et al</etal><year>2017</year><article-title>A large and consistent phylogenomic dataset supports sponges as the sister group to all other animals</article-title>. <source>Curr Biol</source>. <volume>27</volume>(<issue>7</issue>):<fpage>958</fpage>–<lpage>967</lpage>.<pub-id pub-id-type="pmid">28318975</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B49">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sonnhammer</surname><given-names>EL</given-names></name>, <name name-style="western"><surname>Eddy</surname><given-names>SR</given-names></name>, <name name-style="western"><surname>Durbin</surname><given-names>R.</given-names></name></person-group><year>1997</year><article-title>Pfam: a comprehensive database of protein domain families based on seed alignments</article-title>. <source>Proteins</source><volume>28</volume>(<issue>3</issue>):<fpage>405</fpage>–<lpage>420</lpage>.<pub-id pub-id-type="pmid">9223186</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B50">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Susko</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Lincker</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Roger</surname><given-names>AJ.</given-names></name></person-group><year>2018</year><article-title>Accelerated estimation of frequency classes in site-heterogeneous profile mixture models</article-title>. <source>Mol Biol Evol</source>. <volume>35</volume>(<issue>5</issue>):<fpage>1266</fpage>–<lpage>1253</lpage>.<pub-id pub-id-type="pmid">29688541</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B51">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Susko</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Roger</surname><given-names>AJ.</given-names></name></person-group><year>2007</year><article-title>On reduced amino acid alphabets for phylogenetic inference</article-title>. <source>Mol Biol Evol</source>. <volume>24</volume>(<issue>9</issue>):<fpage>2139</fpage>–<lpage>2150</lpage>.<pub-id pub-id-type="pmid">17652333</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B52">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Van de Peer</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Ben Ali</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Meyer</surname><given-names>A.</given-names></name></person-group><year>2000</year><article-title>Microsporidia: accumulating molecular evidence that a group of amitochondriate and suspectedly primitive eukaryotes are just curious fungi</article-title>. <source>Gene</source><volume>246</volume>(<issue>1–2</issue>):<fpage>1</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">10767522</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B53">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Vossbrinck</surname><given-names>CR</given-names></name>, <name name-style="western"><surname>Maddox</surname><given-names>JV</given-names></name>, <name name-style="western"><surname>Friedman</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Debrunner-Vossbrinck</surname><given-names>BA</given-names></name>, <name name-style="western"><surname>Woese</surname><given-names>CR.</given-names></name></person-group><year>1987</year><article-title>Ribosomal RNA sequence suggests microsporidia are extremely ancient eukaryotes</article-title>. <source>Nature</source><volume>326</volume>(<issue>6111</issue>):<fpage>411</fpage>–<lpage>414</lpage>.<pub-id pub-id-type="pmid">3550472</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B54">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wang</surname><given-names>HC</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Susko</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Roger</surname><given-names>AJ.</given-names></name></person-group><year>2008</year><article-title>A class frequency mixture model that adjusts for site-specific amino acid frequencies and improves inference of protein phylogeny</article-title>. <source>BMC Evol Biol</source>. <volume>8</volume>(<issue>1</issue>):<fpage>331</fpage>–<lpage>313</lpage>.<pub-id pub-id-type="pmid">19087270</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B55">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wang</surname><given-names>HC</given-names></name>, <name name-style="western"><surname>Minh</surname><given-names>BQ</given-names></name>, <name name-style="western"><surname>Susko</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Roger</surname><given-names>AJ.</given-names></name></person-group><year>2018</year><article-title>Modeling site heterogeneity with posterior mean site frequency profiles accelerates accurate phylogenomic estimation</article-title>. <source>Syst Biol</source>. <volume>67</volume>(<issue>2</issue>):<fpage>216</fpage>–<lpage>235</lpage>.<pub-id pub-id-type="pmid">28950365</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B56">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Whelan</surname><given-names>NV</given-names></name>, <name name-style="western"><surname>Halanych</surname><given-names>KM.</given-names></name></person-group><year>2016</year><article-title>Who let the cat out of the bag? Accurately dealing with substitutional heterogeneity in phylogenomic analyses</article-title>. <source>Syst Biol</source>. <volume>66</volume>(<issue>2</issue>):<fpage>232</fpage>–<lpage>255</lpage>.</mixed-citation>
    </ref>
    <ref id="msaa145-B57">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Whelan</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Goldman</surname><given-names>N.</given-names></name></person-group><year>2001</year><article-title>A general empirical model of protein evolution derived from multiple protein families using a maximum-likelihood approach</article-title>. <source>Mol Biol Evol</source>. <volume>18</volume>(<issue>5</issue>):<fpage>691</fpage>–<lpage>699</lpage>.<pub-id pub-id-type="pmid">11319253</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B58">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Williams</surname><given-names>BAP</given-names></name>, <name name-style="western"><surname>Hirt</surname><given-names>RP</given-names></name>, <name name-style="western"><surname>Lucocq</surname><given-names>JM</given-names></name>, <name name-style="western"><surname>Embley</surname><given-names>TM.</given-names></name></person-group><year>2002</year><article-title>A mitochondrial remnant in the microsporidian <italic>Trachipleistophora hominis</italic></article-title>. <source>Nature</source><volume>418</volume>(<issue>6900</issue>):<fpage>865</fpage>–<lpage>869</lpage>.<pub-id pub-id-type="pmid">12192407</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B59">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Williams</surname><given-names>TA</given-names></name>, <name name-style="western"><surname>Foster</surname><given-names>PG</given-names></name>, <name name-style="western"><surname>Cox</surname><given-names>CJ</given-names></name>, <name name-style="western"><surname>Embley</surname><given-names>TM.</given-names></name></person-group><year>2013</year><article-title>An archaeal origin of eukaryotes supports only two primary domains of life</article-title>. <source>Nature</source><volume>504</volume>(<issue>7479</issue>):<fpage>231</fpage>–<lpage>236</lpage>.<pub-id pub-id-type="pmid">24336283</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B60">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yang</surname><given-names>Z.</given-names></name></person-group><year>1994</year>a. 
<article-title>Estimating the pattern of nucleotide substitution</article-title>. <source>J Mol Evol</source>. <volume>39</volume>(<issue>1</issue>):<fpage>105</fpage>–<lpage>111</lpage>.<pub-id pub-id-type="pmid">8064867</pub-id></mixed-citation>
    </ref>
    <ref id="msaa145-B61">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yang</surname><given-names>Z.</given-names></name></person-group><year>1994</year>b. 
<article-title>Maximum likelihood phylogenetic estimation from DNA sequences with variable rates over sites: approximate methods</article-title>. <source>J Mol Evol</source>. <volume>39</volume>(<issue>3</issue>):<fpage>306</fpage>–<lpage>314</lpage>.<pub-id pub-id-type="pmid">7932792</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
