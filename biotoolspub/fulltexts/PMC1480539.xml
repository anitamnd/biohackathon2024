<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20031101//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput. Biol</journal-id>
    <journal-id journal-id-type="publisher-id">pcbi</journal-id>
    <journal-id journal-id-type="publisher-id">plcb</journal-id>
    <journal-id journal-id-type="pmc">ploscomp</journal-id>
    <journal-title-group>
      <journal-title>PLoS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">1480539</article-id>
    <article-id pub-id-type="pmid">16789815</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.0020073</article-id>
    <article-id pub-id-type="publisher-id">05-PLCB-RA-0348R2</article-id>
    <article-id pub-id-type="sici">plcb-02-06-15</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline">
        <subject>Bioinformatics - Computational Biology</subject>
        <subject>Evolution</subject>
        <subject>Statistics</subject>
      </subj-group>
      <subj-group subj-group-type="System Taxonomy">
        <subject>Drosophila</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Parametric Alignment of <named-content content-type="genus-species">Drosophila</named-content> Genomes</article-title>
      <alt-title alt-title-type="running-head">Parametric Alignment of Drosophila Genomes</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Dewey</surname>
          <given-names>Colin N</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Huggins</surname>
          <given-names>Peter M</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Woods</surname>
          <given-names>Kevin</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sturmfels</surname>
          <given-names>Bernd</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pachter</surname>
          <given-names>Lior</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">2</xref>
        <xref ref-type="corresp" rid="cor1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff1"><label>1</label> Department of Electrical Engineering and Computer Sciences, University of California Berkeley, Berkeley, California, United States of America
</aff>
    <aff id="aff2"><label>2</label> Department of Mathematics, University of California Berkeley, Berkeley, California, United States of America
</aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Gusfield</surname>
          <given-names>Dan</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">University of California Davis, United States of America</aff>
    <author-notes>
      <corresp id="cor1">* To whom correspondence should be addressed. E-mail: <email>lpachter@Math.Berkeley.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>6</month>
      <year>2006</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>23</day>
      <month>6</month>
      <year>2006</year>
    </pub-date>
    <pub-date pub-type="epreprint">
      <day>10</day>
      <month>5</month>
      <year>2006</year>
    </pub-date>
    <volume>2</volume>
    <issue>6</issue>
    <elocation-id>e73</elocation-id>
    <history>
      <date date-type="received">
        <day>7</day>
        <month>12</month>
        <year>2005</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>5</month>
        <year>2006</year>
      </date>
    </history>
    <permissions>
      <copyright-statement> © 2006 Dewey et al.</copyright-statement>
      <copyright-year>2006</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <!--<related-article preprintresearch10.1371/journal.pcbi.0020073.eorsimple>Parametric Alignment of Drosophila Genomes</related-article>-->
    <abstract>
      <p>The classic algorithms of Needleman–Wunsch and Smith–Waterman find a maximum a posteriori probability alignment for a pair hidden Markov model (PHMM). To process large genomes that have undergone complex genome rearrangements, almost all existing whole genome alignment methods apply fast heuristics to divide genomes into small pieces that are suitable for Needleman–Wunsch alignment. In these alignment methods, it is standard practice to fix the parameters and to produce a single alignment for subsequent analysis by biologists. As the number of alignment programs applied on a whole genome scale continues to increase, so does the disagreement in their results. The alignments produced by different programs vary greatly, especially in non-coding regions of eukaryotic genomes where the biologically correct alignment is hard to find. Parametric alignment is one possible remedy. This methodology resolves the issue of robustness to changes in parameters by finding all optimal alignments for all possible parameters in a PHMM. Our main result is the construction of a whole genome parametric alignment of <named-content content-type="genus-species">Drosophila melanogaster</named-content> and <named-content content-type="genus-species">Drosophila pseudoobscura</named-content>. This alignment draws on existing heuristics for dividing whole genomes into small pieces for alignment, and it relies on advances we have made in computing convex polytopes that allow us to parametrically align non-coding regions using biologically realistic models. We demonstrate the utility of our parametric alignment for biological inference by showing that cis-regulatory elements are more conserved between <named-content content-type="genus-species">Drosophila melanogaster</named-content> and <named-content content-type="genus-species">Drosophila pseudoobscura</named-content> than previously thought. We also show how whole genome parametric alignment can be used to quantitatively assess the dependence of branch length estimates on alignment parameters.</p>
    </abstract>
    <abstract abstract-type="synopsis">
      <title>Synopsis</title>
      <p>Dewey and colleagues describe a parametric alignment of the genomes of <named-content content-type="genus-species">Drosophila melanogaster</named-content> and <named-content content-type="genus-species">Drosophila pseudoobscura</named-content>. The parametric alignment consists of all optimal alignments of the two <italic>Drosophila</italic> genomes for all choices of parameters for some widely used scoring schemes. Computation and analysis of the parametric alignment requires the integration of ideas from mathematics, algorithms, and biology. Mathematically, the parametric analysis rests on the geometric principle of convexity. In particular, the alignment polytope, which organizes the alignments according to the optimal alignments, is introduced and described. Algorithmically, efficient procedures are developed for computing alignment polytopes on a large scale and for models with more parameters than had previously been practical. Biologically, the utility of parametric analysis is demonstrated by showing that the degree of conservation between cis-regulatory elements in <named-content content-type="genus-species">Drosophila melanogaster</named-content> and <named-content content-type="genus-species">Drosophila pseudoobscura</named-content> is higher than previously thought, and by assessing the dependence of branch length estimates on alignment parameters.</p>
    </abstract>
    <counts>
      <page-count count="9"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>citation</meta-name>
        <meta-value>Dewey CN, Huggins PM, Woods K, Sturmfels B, Pachter L (2006) Parametric alignment of <named-content content-type="genus-species">Drosophila</named-content> genomes. PLoS Comput Biol 2(6): e73. DOI: <ext-link ext-link-type="doi" xlink:href="10.1371/journal.pcbi.0020073">10.1371/journal.pcbi.0020073</ext-link></meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>Needleman–Wunsch pairwise sequence alignment [<xref rid="pcbi-0020073-b001" ref-type="bibr">1</xref>] is known to be sensitive to parameter choices. To illustrate the problem, consider the eighth intron of the <italic>Drosophila melanogaster CG9935-RA</italic> gene (as annotated by FlyBase [<xref rid="pcbi-0020073-b002" ref-type="bibr">2</xref>]) located on chr4:660,462–660,522 (April 2004 BDGP release 4). This intron, which is 61 base pairs long, has a 60 base pair–ortholog in <named-content content-type="genus-species">Drosophila pseudoobscura</named-content>. The ortholog is located at Contig8094_Contig5509:4,876–4,935 in the August 2003 freeze 1 assembly, as produced by the Baylor Genome Sequencing Center.</p>
    <p>Using the basic 3-parameter scoring scheme (match <italic>M,</italic> mismatch <italic>X,</italic> and space penalty <italic>S</italic>), these two orthologous introns have the following optimal alignment when the parameters are set to <italic>M = 5, X = −5, S = −5:</italic>
</p>
    <disp-formula id="pcbi-0020073-ex001">
      <graphic xlink:href="pcbi.0020073.ex001.jpg" mimetype="image" position="float"/>
    </disp-formula>
    <p>However, if we change the parameters to <italic>M =</italic> 5, <italic>X =</italic> −6, and <italic>S =</italic> −4, then the following alignment is optimal:</p>
    <disp-formula id="pcbi-0020073-ex002">
      <graphic xlink:href="pcbi.0020073.ex002.jpg" mimetype="image" position="float"/>
    </disp-formula>
    <p>Note that a relatively small change in the parameters produces a very different alignment of the introns. This problem is exacerbated with more complex scoring schemes, and is a central issue with whole genome alignments produced by programs such as MAVID [<xref rid="pcbi-0020073-b003" ref-type="bibr">3</xref>] or BLASTZ/MULTIZ [<xref rid="pcbi-0020073-b004" ref-type="bibr">4</xref>]. Indeed, although whole genome alignment systems use many heuristics for rapidly identifying alignable regions and subsequently aligning them, they all rely on the Needleman–Wunsch algorithm at some level. Dependence on parameters becomes an even more crucial issue in the multiple alignment of more than two sequences.</p>
    <p><named-content content-type="genus-species">Parametric alignment</named-content> was introduced by Waterman, Eggert, and Lander [<xref rid="pcbi-0020073-b005" ref-type="bibr">5</xref>] and further developed by Gusfield et al. [<xref rid="pcbi-0020073-b006" ref-type="bibr">6</xref>,<xref rid="pcbi-0020073-b007" ref-type="bibr">7</xref>] and Fernandez-Baca et al. [<xref rid="pcbi-0020073-b008" ref-type="bibr">8</xref>] as an approach for overcoming the difficulties in selecting parameters for Needleman–Wunsch alignment. See [<xref rid="pcbi-0020073-b009" ref-type="bibr">9</xref>] for a review and [<xref rid="pcbi-0020073-b010" ref-type="bibr">10</xref>,<xref rid="pcbi-0020073-b011" ref-type="bibr">11</xref>] for an algebraic perspective. Parametric alignment amounts to partitioning the space of parameters into regions. Parameters in the same region lead to the same optimal alignments. Enumerating all regions is a non-trivial problem of computational geometry. We solve this problem on a whole genome scale for up to five free parameters.</p>
    <p>Our approach to parametric alignment rests on the idea that the score of an alignment is specified by a short list of numbers derived from the alignment. For instance, given the standard three-parameter scoring scheme, we summarize each alignment by the number <italic>m</italic> of matches, the number <italic>x</italic> of mismatches, and the number <italic>s</italic> of spaces in the alignment. The triple (<italic>m</italic>,<italic>x</italic>,<italic>s</italic>) is called the <italic>alignment summary</italic>. As an example, consider the above pair of orthologous <italic>Drosophila</italic> introns. The first (shorter) alignment has the alignment summary (33,23,9) while the second (longer) alignment has the alignment summary (36,10,29).</p>
    <p>Remarkably, even though the number of all alignments of two sequences is very large, the number of alignment summaries that arise from Needleman–Wunsch alignment is very small. Specifically, in the example above, where the two sequences have lengths 61 and 60, the total number of alignments is 1,511,912,317,060,120,757,519,610,968,109,962,170,434,175,129 ≈ 1.5×10<sup>46</sup>.</p>
    <p>There are only 13 alignment summaries that have the highest score for some choice of parameters <italic>M</italic>,<italic>X</italic>,<italic>S</italic>. For biologically reasonable choices, i.e., when we require <italic>M</italic> &gt; <italic>X</italic> and 2<italic>S</italic> &lt; <italic>X,</italic> only six of the 13 summaries are optimal. These six summaries account for a total of 8,362 optimal alignments (<xref ref-type="table" rid="pcbi-0020073-t001">Table 1</xref>).</p>
    <table-wrap id="pcbi-0020073-t001" content-type="1col" position="float">
      <label>Table 1</label>
      <caption>
        <p>The 8,362 Optimal Alignments for Two <italic>Drosophila</italic> Intron Sequences</p>
      </caption>
      <graphic xlink:href="pcbi.0020073.t001"/>
    </table-wrap>
    <p>Note that the basic model discussed above has only <italic>d</italic> = 2 free parameters, because for a pair of sequences of lengths <italic>l</italic>,<italic>l</italic> all the summaries (<italic>m</italic>,<italic>x</italic>,<italic>s</italic>) satisfy</p>
    <disp-formula id="pcbi-0020073-e001">
      <graphic xlink:href="pcbi.0020073.e001.jpg" position="anchor" mimetype="image"/>
    </disp-formula>
    <p>This relation holds with <italic>l + l′</italic> for the six summaries in <xref ref-type="table" rid="pcbi-0020073-t001">Table 1</xref>. <xref ref-type="fig" rid="pcbi-0020073-g001">Figure 1</xref> shows the alignment polygon, as defined in the section “Alignment polytopes,” in the coordinates (<italic>x</italic>,<italic>s</italic>).</p>
    <fig id="pcbi-0020073-g001" position="float">
      <label>Figure 1</label>
      <caption>
        <title>The Alignment Polygon for Our Two Introns Is Shown on the Left</title>
        <p>For each of the alignment summaries <italic>A,B, . . . F</italic> in <xref ref-type="table" rid="pcbi-0020073-t001">Table 1</xref>, the corresponding cone in the alignment fan is shown on the right. If the parameters (<italic>S,X</italic>) stay inside a particular cone, every optimal alignment has the same alignment summary.</p>
      </caption>
      <graphic xlink:href="pcbi.0020073.g001"/>
    </fig>
    <p>In general, for two DNA sequences of lengths <italic>l</italic> and <italic>l′,</italic> the number of optimal alignment summaries is bounded from above by a polynomial in <italic>l</italic> and <italic>l′</italic> of degree <italic>d</italic>(<italic>d</italic> − 1)/(<italic>d</italic> + 1), where <italic>d</italic> is the number of <italic>free parameters</italic> in the model [<xref rid="pcbi-0020073-b009" ref-type="bibr">9</xref>,<xref rid="pcbi-0020073-b010" ref-type="bibr">10</xref>]. For <italic>d</italic> = 2, this degree is 0.667, and so the number of optimal alignment summaries has <italic>sublinear growth</italic> relative to the sequence lengths. Even for <italic>d</italic> = 5, the growth exponent <italic>d</italic>(<italic>d</italic> − 1)/(<italic>d</italic> + 1) is only 3.333. This means that <italic>all</italic> optimal alignment summaries can be computed on a large scale for models with few parameters.</p>
    <p>The growth exponent <italic>d</italic>(<italic>d</italic> − 1)/(<italic>d</italic> + 1) was derived by Gusfield et al. [<xref rid="pcbi-0020073-b006" ref-type="bibr">6</xref>] for <italic>d</italic> = 2 and by Fernandez-Baca at al. [<xref rid="pcbi-0020073-b008" ref-type="bibr">8</xref>] and Pachter-Sturmfels [<xref rid="pcbi-0020073-b010" ref-type="bibr">10</xref>] for general <italic>d</italic>. <xref ref-type="table" rid="pcbi-0020073-t001">Table 1</xref> can be computed using the software XPARAL [<xref rid="pcbi-0020073-b007" ref-type="bibr">7</xref>]. This software works for <italic>d</italic> = 2 and <italic>d</italic> = 3, and it generates a representation of all optimal alignments with respect to all reasonable choices of parameters. Although XPARAL has a convenient graphical interface, it seems that this program has not been widely used by biologists, perhaps because it is not designed for high throughput data analysis and the number of free parameters is restricted to <italic>d</italic> ≤ 3.</p>
    <p>In this paper, we demonstrate that parametric sequence alignment can be made practical on the whole-genome scale, and we argue that computing output such as <xref ref-type="table" rid="pcbi-0020073-t001">Table 1</xref> can be very useful for comparative genomics applications where reliable alignments are essential. To this end, we introduce a mathematical point of view, based on the organizing principle of <italic>convexity,</italic> which was absent in the earlier studies [<xref rid="pcbi-0020073-b005" ref-type="bibr">5</xref>,<xref rid="pcbi-0020073-b006" ref-type="bibr">6</xref>,<xref rid="pcbi-0020073-b009" ref-type="bibr">9</xref>]. Our advances rely on new algorithms, which are quite different from what is implemented in XPARAL, and which perform well in practice, even if the number <italic>d</italic> of free parameters is greater than three.</p>
    <p>Convexity is the organizing principle that reveals the needles in the haystack. In our example, the “haystack” consists of more than 10<sup>46</sup> alignments, and the “needles” are the 8,362 optimal alignments. The summaries of the optimal alignments are the vertices of the <italic>alignment polytope</italic>. The alignment polytope is the <italic>convex hull</italic> of the summaries of all (exponentially many) alignments. Background on convex hulls and how to compute the alignment polytopes are provided in the section From Genomes to Polytopes (see also [<xref rid="pcbi-0020073-b011" ref-type="bibr">11</xref>]). Thus, parametric alignment of two DNA sequences relative to some chosen pair hidden Markov model (PHMM) means constructing the alignment polytope of the two sequences. The dimension of the alignment polytope is <italic>d,</italic> the number of free model parameters. For <italic>d</italic> = 2 (the basic model), the polytope is a convex polygon, as shown in <xref ref-type="fig" rid="pcbi-0020073-g001">Figure 1</xref> for the pair of introns above.</p>
    <p>The basic model is insufficient for genomics applications. More realistic PHMMs for sequence alignment include gap penalties. We consider three such models. The symmetries of the scoring matrices for these models are derived from those of the evolutionary models known as Jukes–Cantor (<italic>d</italic> = 3), Kimura-2 (<italic>d</italic> = 4), and Kimura-3 (<italic>d</italic> = 5). The models are reviewed in the section “Models, alignment summaries, and robustness cones.”</p>
    <p>Our contribution is the construction of a whole genome parametric alignment in all four models for <named-content content-type="genus-species">D. melanogaster</named-content> and <named-content content-type="genus-species">D. pseudoobscura</named-content>. Our methods and computational results are described in the next section. Three biological applications are presented in the section From Polytopes to Biology. A discussion follows in the Discussion section.</p>
    <sec id="s1a">
      <title>From Genomes to Polytopes</title>
      <p>Our main computational result is the construction of a whole genome parametric alignment for two <italic>Drosophila</italic> genomes. This result depended on a number of innovations. By adapting existing orthology mapping methods, we were able to divide the genomes into 1,999,817 pairs of reliably orthologous segments, and among these we identified 877,982 pairs for which the alignment is uncertain. We computed the alignment polytopes of dimensions two, three, and four for each of these 877,982 sequence pairs, and of dimension five for a subset of them. The methods are explained in the section “Alignment polytopes.” The vertices of these polytopes represent the optimal alignment summaries and the robustness cones. These concepts are introduced in the section “Models, alignment summaries, and robustness cones.” Computational results are presented in the section “Computational results.”</p>
      <sec id="s1a1">
        <title>Orthology mapping.</title>
        <p>The <italic>orthology mapping problem</italic> for a pair of genomes is to identify all orthologous segments between the two genomes. These orthologous segments, if selected so as not to contain genome rearrangements, can then be globally aligned to each other. This strategy is frequently used for whole genome alignment [<xref rid="pcbi-0020073-b012" ref-type="bibr">12</xref>,<xref rid="pcbi-0020073-b013" ref-type="bibr">13</xref>], and we adapted it for our parametric alignment computation.</p>
        <p>MERCATOR is an orthology mapping program suitable for multiple genomes that was developed by Dewey et al. [<xref rid="pcbi-0020073-b014" ref-type="bibr">14</xref>]. We applied this program to the <named-content content-type="genus-species">D. melanogaster</named-content> and <named-content content-type="genus-species">D. pseudoobscura</named-content> genomes to identify pieces for parametric alignment. The MERCATOR strategy for identifying orthologous segments is as follows. Exon annotations in each genome are translated into amino acid sequences and then compared with each other using BLAT [<xref rid="pcbi-0020073-b015" ref-type="bibr">15</xref>]. The annotations are based on reference gene sets, and on ab initio predictions (see <xref ref-type="sec" rid="s3">Materials and Methods</xref>). The resulting exon hits are then used to build a graph whose vertices correspond to exons, and with an edge between two exons if there is a good hit. A greedy algorithm is then used to select edges in the graph that correspond to runs of exons that are consistent in order and orientation.</p>
        <p>The MERCATOR orthology map for <named-content content-type="genus-species">D. melanogaster</named-content> and <named-content content-type="genus-species">D. pseudoobscura</named-content> has 2,731 segments. However, in order to obtain a map suitable for parametric alignment, further subdivision of the segments was necessary. This subdivision was accomplished by the additional step of identifying and fixing exact matches of length at least 10 bp (see <xref ref-type="sec" rid="s3">Materials and Methods</xref>).</p>
        <p>We derived 1,116,792 constraints, which are of four possible types: 1) exact matching non-coding sequences, 2) ungapped high scoring aligned coding sequences, 3) segment pairs between two other constraints where one of the segments has length zero, so the non-trivial segment must be gapped, and 4) single nucleotide mismatches that are squeezed between other constraints.</p>
        <p>We then removed all segments where the sequences contained the letter N (which means the actual sequence is uncertain). This process resulted in 877,982 pairs of segments for parametric alignment. The lengths of the <named-content content-type="genus-species">D. melanogaster</named-content> segments range from one to 80,676 base pairs. The median length is 42 bp and the mean length is 99 bp. In all, 90.4% of the <named-content content-type="genus-species">D. melanogaster</named-content> genome and 88.7% of the <named-content content-type="genus-species">D. pseudoobscura</named-content> genome were aligned by our method.</p>
      </sec>
      <sec id="s1a2">
        <title>Models, alignment summaries, and robustness cones.</title>
        <p>For each of the 877,982 pairs of orthologous segments, we constructed all optimal Needleman–Wunsch alignments, with respect to various scoring schemes that are derived from PHMMs. We considered models with two, three, four, and five parameters. See [<xref rid="pcbi-0020073-b016" ref-type="bibr">16</xref>] for a review of PHMMs and their relationship to the scoring schemes typically used for aligning DNA sequences. In what follows, we only refer to the scores, which are the logarithms of certain ratios of the parameters of the PHMM. Our four models are specializations of the general 33-parameter model [<xref rid="pcbi-0020073-b011" ref-type="bibr">11</xref>] that incorporates mutations, insertions, and deletions of DNA sequences. It is customary to reduce the dimension by assuming that many of the 33 parameters are equal to each other.</p>
        <p>The <italic>basic model,</italic> discussed in the Introduction, has three natural parameters, namely, <italic>M</italic> for match, <italic>X</italic> for mismatch, and <italic>S</italic> for space. If the numbers <italic>M, X,</italic> and <italic>S</italic> are fixed, then we seek to maximize <italic>M</italic> · <italic>m</italic> + <italic>X</italic> · <italic>x</italic> + <italic>S</italic> · <italic>s,</italic> where (<italic>m</italic>,<italic>x</italic>,<italic>s</italic>) runs over the summaries of all alignments. In light of Equation 1, this model has only two free parameters and there is no loss of generality in assuming that the match score <italic>M</italic> is zero. From now on we set <italic>M</italic> = 0 and take <italic>X</italic> and <italic>S</italic> as the free parameters. We define the <italic>alignment summary</italic> to be the pair (<italic>x</italic>,<italic>s</italic>).</p>
        <p>Following the convention of Pachter and Sturmfels [<xref rid="pcbi-0020073-b011" ref-type="bibr">11</xref>], we summarize a scoring scheme with a 5 × 5 matrix <italic>w</italic> whose rows and columns are both indexed by A, C, G, T, and -. The matrix <italic>w</italic> for the basic model is the leftmost matrix in <xref ref-type="fig" rid="pcbi-0020073-g002">Figure 2</xref>, and it corresponds to the Jukes–Cantor model of DNA sequence evolution.</p>
        <fig id="pcbi-0020073-g002" position="float">
          <label>Figure 2</label>
          <caption>
            <title>The Jukes–Cantor Matrix, Kimura-2 Matrix, and Kimura-3 Matrix</title>
            <p>These three matrices correspond to JC69, K80, and K81 in the <named-content content-type="genus-species">Felsenstein hierarchy</named-content> [<xref rid="pcbi-0020073-b011" ref-type="bibr">11</xref>] of probabilistic models for DNA sequence evolution.</p>
          </caption>
          <graphic xlink:href="pcbi.0020073.g002"/>
        </fig>
        <p>Our <italic>3d model</italic> is the most commonly used scoring scheme for computing alignments. This model includes the number g of gaps. A <italic>gap</italic> is a complete block of spaces in one of the aligned sequences; it either begins at the start of the sequence or is immediately preceded by a nucleotide, and it either follows the end of the sequence or is succeeded by a nucleotide. The <italic>3d alignment summary</italic> is the triple (<italic>x</italic>,<italic>s</italic>,<italic>g</italic>). The score for a gap, <italic>G,</italic> is known as the <italic>affine gap penalty</italic>. If <italic>X, S,</italic> and <italic>G</italic> are fixed, then the alignment problem is to maximize <italic>X</italic> · <italic>x</italic> + <italic>S</italic> · <italic>s</italic> + <italic>G</italic> · <italic>g</italic> where (<italic>x</italic>,<italic>s</italic>,<italic>g</italic>) runs over all 3d alignment summaries. The parametric version is implemented in XPARAL. Introducing the gap score <italic>G</italic> does not affect the matrix <italic>w,</italic> which is still the leftmost matrix in <xref ref-type="fig" rid="pcbi-0020073-g002">Figure 2</xref>.</p>
        <p>Our <italic>4d model</italic> is derived from the <italic>Kimura-2 model</italic> of sequence evolution. The <italic>4d alignment summary</italic> is the vector (<italic>x</italic>,<italic>y</italic>,<italic>s</italic>,<italic>g</italic>) where <italic>s</italic> and <italic>g</italic> are as above, <italic>x</italic> is the number of <italic>transversion mismatches</italic> (between a purine and a pyrimidine or vice versa) and <italic>y</italic> is the number of <italic>transition mismatches</italic> (between purines or between pyrimidines). The four parameters are X, Y, S, and <italic>G</italic>. The matrix <italic>w</italic> of scores, as specified in [<xref rid="pcbi-0020073-b011" ref-type="bibr">11</xref>], is now the middle matrix in <xref ref-type="fig" rid="pcbi-0020073-g002">Figure 2</xref>.</p>
        <p>Our <italic>5d scoring scheme</italic> is derived from the <italic>Kimura-3 model</italic>. Here the matrix <italic>w</italic> is the rightmost matrix in <xref ref-type="fig" rid="pcbi-0020073-g002">Figure 2</xref>. The <italic>5d alignment summary</italic> is the vector (<italic>x</italic>,<italic>y</italic>,<italic>z</italic>,<italic>s</italic>,<italic>g</italic>), where <italic>s</italic> counts spaces, <italic>g</italic> counts gaps, <italic>x</italic> is the number of mismatches <inline-formula id="pcbi-0020073-ex003"><inline-graphic xlink:href="pcbi.0020073.ex003.jpg" mimetype="image"/></inline-formula>
<italic>y</italic> is the number of mismatches <inline-formula id="pcbi-0020073-ex004"><inline-graphic xlink:href="pcbi.0020073.ex004.jpg" mimetype="image"/></inline-formula> and <italic>z</italic> is the number of mismatches <inline-formula id="pcbi-0020073-ex005"><inline-graphic xlink:href="pcbi.0020073.ex005.jpg" mimetype="image"/></inline-formula>. Thus, the 5d alignment summaries of the two <italic>Drosophila</italic> intron alignments at the beginning of the Introduction are (4,10,9,9,8) and (3,3,4,29,17). Even the 5d model does not encompass all scoring schemes that are used in practice. See the section “Assessment of the BLASTZ alignment” for a discussion of the BLASTZ scoring matrix [<xref rid="pcbi-0020073-b017" ref-type="bibr">17</xref>] and its proximity to the Kimura-2 model.
</p>
        <p>Suppose we are given a specific alignment of two DNA sequences. Then the <italic>robustness cone</italic> of that alignment is the set of all parameter vectors that have the following property: any other alignment that has a different alignment summary is given a lower score. As a mathematical object, the robustness cone is an open convex polyhedral cone in the space <italic>R<sup>d</sup></italic> of free parameters.</p>
        <p>An alignment summary is said to be <italic>optimal,</italic> relative to one of our four models, if its robustness cone is not empty. Equivalently, an alignment summary is optimal if there exists a choice of parameters such that the Needleman–Wunsch algorithm produces <italic>only</italic> that alignment summary. Such a parameter choice will be robust, in the sense that if we make a small enough change in the parameters then the optimal alignment summary will remain unchanged. Each robustness cone is specified by a finite list of linear inequalities in the model parameters.</p>
        <p>For example, consider the first alignment in the Introduction. Its 2d alignment summary is the pair (<italic>x</italic>,<italic>s</italic>) = (23,9), labeled <bold>D</bold> in <xref ref-type="table" rid="pcbi-0020073-t001">Table 1</xref>. The robustness cone of this summary is the set of all points (<italic>X</italic>,<italic>S</italic>) such that the score 23<italic>X</italic> + 9<italic>S</italic> is larger than the score of all other alignments summaries other than (23,9). This cone is specified by the two linear inequalities <italic>S</italic> &gt; <italic>X</italic> and 4<italic>S</italic> &lt; 3<italic>X</italic>.</p>
        <p>If we fix two DNA sequences, then the robustness cones of all the optimal alignments define a partition of the parameter space, <italic>R<sup>d</sup></italic>. That partition is called the <italic>alignment fan</italic> of the two DNA sequences. <xref ref-type="fig" rid="pcbi-0020073-g001">Figure 1</xref> shows the (biologically relevant part of the) alignment fan of two <italic>Drosophila</italic> introns in the 2d model. While this alignment fan has only 13 robustness cones, the alignment fan of the same introns has 76 cones for the 3d model, 932 cones for the 4d model, and 10,009 cones for the 5d model. These are the vertex numbers in <xref ref-type="table" rid="pcbi-0020073-t002">Table 2</xref>.</p>
        <table-wrap id="pcbi-0020073-t002" content-type="1col" position="float">
          <label>Table 2</label>
          <caption>
            <p>Face Numbers of the Alignment Polytopes for the Intron Sequences from the Beginning of the Introduction</p>
          </caption>
          <graphic xlink:href="pcbi.0020073.t002"/>
        </table-wrap>
      </sec>
      <sec id="s1a3">
        <title>Alignment polytopes.</title>
        <p>The <italic>convex hull</italic> of a finite set <italic>S</italic> of points in <italic>R<sup>d</sup></italic> is the smallest convex set containing these points. It is denoted conv(<italic>S</italic>) and called a <italic>convex polytope</italic>. There exists a unique smallest subset <italic>V</italic> ⊆ <italic>S</italic> for which conv(<italic>S</italic>) = conv(<italic>V</italic>). The points in <italic>V</italic> are called the <italic>vertices</italic> of the convex polytope. The vertices lie in higher-dimensional <italic>faces</italic> on the boundary of the polytope. Faces include <italic>edges,</italic> which are one-dimensional, and <italic>facets,</italic> which are (<italic>d</italic> − 1)-dimensional. Introductions to these concepts can be found in the textbooks [<xref rid="pcbi-0020073-b018" ref-type="bibr">18</xref>,<xref rid="pcbi-0020073-b019" ref-type="bibr">19</xref>]. By <italic>computing the convex hull</italic> of a finite set S ⊂ <italic>R<sup>d</sup>,</italic> we mean identifying the vertices and the facets of conv(<italic>S</italic>), and, if possible, all faces of all dimensions.</p>
        <p>Consider one of the four models discussed in the previous section. The <italic>alignment polytope</italic> of two DNA sequences is the convex polytope conv(<italic>S</italic>) ⊂ <italic>R<sup>d</sup>,</italic> where <italic>S</italic> is the set of alignment summaries of all alignments of these two sequences. For instance, the 3d alignment polytope of two DNA sequences is the convex polytope in <italic>R</italic>
<sup>3</sup> that is formed by taking the convex hull of all alignment summaries (<italic>x</italic>,<italic>s</italic>,<italic>g</italic>). <xref ref-type="fig" rid="pcbi-0020073-g003">Figure 3</xref> shows the 3d alignment polytope for the two sequences in the Introduction. Its projection onto the (<italic>x</italic>,<italic>s</italic>)-plane is the polygon depicted in <xref ref-type="fig" rid="pcbi-0020073-g001">Figure 1</xref>.</p>
        <fig id="pcbi-0020073-g003" position="float">
          <label>Figure 3</label>
          <caption>
            <title>The Third Alignment Polytope of Our Two <italic>Drosophila</italic> Introns Has 76 Vertices</title>
            <p>The marked vertex (<italic>x,s,g</italic>) = (30,5,2) represents the BLASTZ alignment.</p>
          </caption>
          <graphic xlink:href="pcbi.0020073.g003"/>
        </fig>
        <p>It is a basic fact of convexity that the maximum of a linear function over a polytope is attained at a vertex. Thus, an alignment of two DNA sequences is optimal if and only if its summary is in the set <italic>V</italic> of vertices of the alignment polytope. The Needleman–Wunsch algorithm efficiently solves the linear programming problem over this polytope. For instance, for the 3d model with fixed parameters, the alignment problem is the linear programming problem</p>
        <disp-formula id="pcbi-0020073-e002">
          <graphic xlink:href="pcbi.0020073.e002.jpg" position="anchor" mimetype="image"/>
        </disp-formula>
        <p>For a numerical example, consider the parameter values <italic>X</italic> = −200, <italic>S</italic> = −80, and <italic>G</italic> = −400, which represent an approximation of the BLASTZ scoring scheme (see the “Assessment of the BLASTZ alignment” section). The solution to Equation 2 is attained at the vertex (<italic>x</italic>,<italic>s</italic>,<italic>g</italic>) = (30,5,2), which is the 3d summary of the following alignment of our two <italic>Drosophila</italic> introns</p>
        <disp-formula id="pcbi-0020073-ex006">
          <graphic xlink:href="pcbi.0020073.ex006.jpg" mimetype="image" position="float"/>
        </disp-formula>
        <p>The 3d summary of this alignment is the marked vertex in <xref ref-type="fig" rid="pcbi-0020073-g003">Figure 3</xref>.</p>
        <p>The problem of computing a parametric alignment is now specified precisely. The input consists of two DNA sequences. The output is the set of vertices and the set of facets of the alignment polytope conv(<italic>S</italic>). See also [<xref rid="pcbi-0020073-b011" ref-type="bibr">11</xref>]. We note that the robustness cone of an optimal alignment summary is the <italic>normal cone</italic> of the polytope at that vertex. The alignment fan is the <italic>normal fan</italic> of the alignment polytope. See [<xref rid="pcbi-0020073-b011" ref-type="bibr">11</xref>] for definitions of these concepts.</p>
        <p>We considered two different methods for constructing all alignment polytopes for the two <italic>Drosophila</italic> genomes: <italic>polytope propagation</italic> and <italic>incremental convex hull</italic>. In our study we found that polytope propagation was outperformed by the incremental convex hull algorithm, especially for the higher dimensional models.</p>
        <p>We now briefly outline the two methods. Polytope propagation for sequence alignment is the Needleman–Wunsch algorithm with the standard operations of plus and max replaced by Minkowski sum and polytope merge (convex hull of union). The polytope propagation algorithm was introduced in [<xref rid="pcbi-0020073-b010" ref-type="bibr">10</xref>,<xref rid="pcbi-0020073-b011" ref-type="bibr">11</xref>].</p>
        <p>The incremental convex hull algorithm, on the other hand, gradually builds the alignment polytope by successively finding new optimal alignment summaries, the vertices of the polytope. To find the new optimal summaries, the algorithm repeatedly calls a <italic>Needleman–Wunsch (NW) subroutine</italic> that is an efficient implementation of the classical Needleman–Wunsch algorithm. For fixed values of the parameters, this subroutine returns an optimal alignment summary. For instance, for the 3d model, the input to the NW subroutine is a parameter vector (<italic>X</italic>,<italic>S</italic>,<italic>G</italic>) and the output is an optimal summary (<italic>x</italic>,<italic>s</italic>,<italic>g</italic>).</p>
        <p>Suppose we have already found a few optimal alignment summaries, by running the NW subroutine with various parameter values. We let <italic>P</italic> be the convex hull of the summaries in <italic>R<sup>d</sup>,</italic> and we assume that <italic>P</italic> is already <italic>d</italic>-dimensional. We maintain a list of all vertices and facets of <italic>P</italic>. Each facet is either <italic>tentative</italic> or <italic>confirmed,</italic> where being confirmed means that its affine span is already known to be a facet-defining hyperplane of the final alignment polytope. In each iteration, we pick a tentative facet of <italic>P</italic> and an outer normal vector <bold>U</bold> of that facet. We then call the NW subroutine with <bold>U</bold> as the input parameter. The output of the NW subroutine is an optimal summary <bold>v</bold>. If the optimal score <bold>U</bold> · <bold>v</bold> equals the maximum of the linear function <bold>U</bold> · <bold>w</bold> over all <bold>w</bold> in <italic>P,</italic> then we declare the facet to be confirmed. Otherwise, the score <bold>U</bold> · <bold>v</bold> is greater than the maximum and we replace <italic>P</italic> by the convex hull of <italic>P</italic> and <italic>v</italic>. This convex hull computation utilizes the <italic>beneath–beyond construction</italic> [<xref rid="pcbi-0020073-b019" ref-type="bibr">19</xref>], which erases some of the tentative facets of the old polytope and replaces them with new tentative facets.</p>
        <p>The algorithm terminates when all facets are confirmed. The current polytope <italic>P</italic> at that iteration is the final alignment polytope. The number of iterations of this incremental convex hull algorithm equals the number of vertices plus the number of facets of the final polytope <italic>P</italic>. So for a given model, the running time of the incremental convex hull algorithm scales linearly in the size of the output. This was confirmed in practice by our computations (<xref ref-type="table" rid="pcbi-0020073-t003">Table 3</xref>).</p>
        <table-wrap id="pcbi-0020073-t003" content-type="1col" position="float">
          <label>Table 3</label>
          <caption>
            <p>Observed Running Times of the Incremental Convex Hull Algorithm for Computing Alignment Polytopes</p>
          </caption>
          <graphic xlink:href="pcbi.0020073.t003"/>
        </table-wrap>
        <p>Our software, together with more details about our incremental convex hull implementation, is available for download at <ext-link ext-link-type="uri" xlink:href="http://bio.math.berkeley.edu/parametric/">http://bio.math.berkeley.edu/parametric/</ext-link>.</p>
        <p>Given an alignment polytope, there are various subsequent computations one may wish to perform. For instance, we may be interested in the robustness cones at the vertices. To get an irredundant inequality representation of a robustness cone, it suffices to know the edges emanating from the corresponding vertex. Thus it is useful to also compute the edge graph of each of our polytopes.</p>
      </sec>
      <sec id="s1a4">
        <title>Computational results.</title>
        <p>Using our implementation of the incremental convex hull algorithm described above, we computed the 2d, 3d, and 4d polytopes for each of the 877,982 segment pairs. We also computed 5d polytopes in many cases. These polytopes are available for downloading and viewing at <ext-link ext-link-type="uri" xlink:href="http://bio.math.berkeley.edu/parametric/">http://bio.math.berkeley.edu/parametric/</ext-link>.</p>
        <p>We empirically determined the expected CPU time to construct alignment polytopes. The results are reported in <xref ref-type="table" rid="pcbi-0020073-t003">Table 3</xref>. As expected, the running time of the incremental convex hull algorithm scales linearly with the number of vertices plus facets. The running time of a single Needleman–Wunsch subroutine call scales linearly with the product <italic>ll′</italic> of the sequence lengths <italic>l</italic> and <italic>l′</italic>.</p>
        <p>To effectively compute these polytopes, not only must we have an algorithm that runs quickly as a function of the number of vertices and facets, but also the number of vertices and facets must themselves be small. The theoretical bounds discussed in the Introduction ensure that these numbers grow polynomially, for any fixed <italic>d</italic>. In our computations we found that the numbers of vertices and facets of alignment polytopes are quite manageable even in dimensions 4 and 5. Averages of the numbers we actually observed are reported in <xref ref-type="table" rid="pcbi-0020073-t004">Table 4</xref>.</p>
        <table-wrap id="pcbi-0020073-t004" content-type="1col" position="float">
          <label>Table 4</label>
          <caption>
            <p>Averages of the Number <italic>V</italic> of Vertices and the Number <italic>F</italic> of Facets of Alignment Polytopes</p>
          </caption>
          <graphic xlink:href="pcbi.0020073.t004"/>
        </table-wrap>
        <p>We conclude our summary of computational results with a look at the alignment polytopes of the orthologous pair of introns in the Introduction. The sequence lengths are <italic>l</italic> = 60 and <italic>l′</italic> = 61. The 2d alignment polytope is shown in <xref ref-type="fig" rid="pcbi-0020073-g001">Figure 1</xref>. The 3d alignment polytope is shown in <xref ref-type="fig" rid="pcbi-0020073-g003">Figure 3</xref>. <xref ref-type="table" rid="pcbi-0020073-t002">Table 2</xref> reports statistics for the 2d, 3d, 4d, and 5d alignment polytopes for this sequence pair.</p>
      </sec>
    </sec>
    <sec id="s1b">
      <title>From Polytopes to Biology</title>
      <p>We describe three applications of our whole genome parametric alignment. First, we discuss how alignment polytopes are useful for parameter selection, and we assess the BLASTZ alignment of <named-content content-type="genus-species">D. melanogaster</named-content> and <named-content content-type="genus-species">D. pseudoobscura</named-content>. We then revisit the cis-regulatory element study in [<xref rid="pcbi-0020073-b020" ref-type="bibr">20</xref>], and we determine alignments that identify previously missed conserved binding sites. Finally, we examine the problem of branch length estimation and provide a quantitative analysis of the dependence of branch length estimates on alignment parameters.</p>
      <sec id="s1b1">
        <title>Assessment of the BLASTZ alignment.</title>
        <p>A key problem in sequence alignment is to determine appropriate parameters for a scoring scheme. The standard approach is to select a model and then to identify parameter values that are effective in producing alignments that correctly align certain features. For example, the BLASTZ scoring matrix [<xref rid="pcbi-0020073-b017" ref-type="bibr">17</xref>] was optimized for human–mouse alignment by finding parameters that were effective in aligning genes in the <italic>HOXD</italic> region. The BLASTZ scoring scheme is given by a scoring matrix called HOXD70 [<xref rid="pcbi-0020073-b017" ref-type="bibr">17</xref>],</p>
        <disp-formula id="pcbi-0020073-e003">
          <graphic xlink:href="pcbi.0020073.e003.jpg" position="anchor" mimetype="image"/>
        </disp-formula>
        <p>together with a space score of −30, and a gap score of −400. Although the HOXD70 matrix has six distinct entries, it can be approximated by a Kimura-2 matrix (<xref ref-type="fig" rid="pcbi-0020073-g002">Figure 2</xref>), since 91 is close to 100, and 114 is close to 123 and 125.</p>
        <p>The alignment polytope of a pair of DNA sequences is a representation of all possible alignments organized according to a scoring scheme. Thus, our results and methodology make it possible, for the first time, to identify parameters that are guaranteed to optimize the alignment according to desired criteria. Moreover, our results offer biologists a mathematical tool for systematically assessing whether a proposed single alignment is suitable for its intended purpose.</p>
        <p>We initiated such a study for the BLASTZ alignment [<xref rid="pcbi-0020073-b004" ref-type="bibr">4</xref>] of <named-content content-type="genus-species">D. melanogaster</named-content> and <italic>D. pseudoobscura,</italic> which is available at <ext-link ext-link-type="uri" xlink:href="http://genome.ucsc.edu">http://genome.ucsc.edu</ext-link>. This alignment is widely used by biologists who study <italic>Drosophila</italic>. Although the BLASTZ alignment procedure is based on an initial “seeding” procedure (similar to our identification of constrained segment pairs), the alignments are then constructed using the Needleman–Wunsch algorithm with the HOXD70 matrix.</p>
        <p>Recall that our orthology map consisted of 1,999,817 segment pairs: 1,116,792 consisted of segments for which we fixed the alignment (constrained segment pairs), and 883,025 were unconstrained segment pairs for which we constructed alignment polytopes. We found that the BLASTZ alignment agreed with 623,710 of our unconstrained segment pairs, of which 622,173 did not contain Ns. For each of these 622,173 segment pairs, we computed the 2d, 3d, and 4d alignment summaries for the BLASTZ alignments, and we determined whether or not they are optimal for some choice of model parameters.</p>
        <p>We found that 269,186 (43.3%) of the BLASTZ alignments are vertices of the 3d polytope, but not the 2d polytope, and 201,982 (32.5%) are vertices of both the 2d and 3d polytopes. Only 151,004 (24.3%) of the BLASTZ alignments are not vertices of either the 2d or 3d alignment polytopes. In summary, our computations show that 32.5% of the BLASTZ alignments correspond to vertices of the 2d polytope and 75.7% correspond to vertices of the 3d polytope. These numbers are even higher for the 4d and 5d alignment polytopes.</p>
        <p>Curiously, there is precisely one sequence pair where the BLASTZ alignment is a vertex of the 2d polytope but not the 3d polytope. This alignment is</p>
        <disp-formula id="pcbi-0020073-ex007">
          <graphic xlink:href="pcbi.0020073.ex007.jpg" mimetype="image" position="float"/>
        </disp-formula>
        <p>The 3d summary of this alignment is (11,3,2), which is the midpoint of the edge with vertices (11,3,1) and (11,3,3) on the 3d polytope. Hence this alignment is not optimal for any choice of parameters (<italic>X</italic>,<italic>S</italic>,<italic>G</italic>). However, it is optimal for the 2d model since the edge maps onto the vertex (11,3) of the 2d polygon.</p>
        <p>Our results show that not only does the BLASTZ alignment agree well with our constrained segment pairs, but also the BLASTZ alignments are mostly vertices of the three dimensional polytopes, even on the unconstrained segment pairs. This suggests that there may be a statistical advantage to working with one of the lower dimensional models, and also indicates that the polytopes may be useful for finding parameters. We illustrate this point of view in the next section, where we identify vertices in the alignment polytope (and therefore parameter robustness cones) that are suitable for the alignment of cis-regulatory elements. Any user of the BLASTZ alignments may now use the alignment polytopes we provide to assess whether or not the fixed choice of the HOXD70 matrix is the right one for their particular biological application.</p>
      </sec>
      <sec id="s1b2">
        <title>Conservation of cis-regulatory elements.</title>
        <p>A central question in comparative genomics is the extent of conservation of cis-regulatory elements and the implications for genome function and evolution. Using our parametric alignment, we discovered that cis-regulatory elements may be more conserved between <named-content content-type="genus-species">D. melanogaster</named-content> and <named-content content-type="genus-species">D. pseudoobscura</named-content> than previously thought. Specifically, we used our alignment polytopes to examine the degree of conservation for 1,346 transcription factor binding sites [<xref rid="pcbi-0020073-b021" ref-type="bibr">21</xref>] available at <ext-link ext-link-type="uri" xlink:href="http://www.flyreg.org">http://www.flyreg.org</ext-link> (we excluded 16 sites that were located in segment pairs containing <italic>N</italic>s). The 1,346 sites include the 142 sites examined by Richards et al. [<xref rid="pcbi-0020073-b020" ref-type="bibr">20</xref>] in their comparison of <named-content content-type="genus-species">D. pseudoobscura</named-content> and <named-content content-type="genus-species">D. melanogaster</named-content>.</p>
        <p>Specifically, for each of the 1,346 elements, we identified the orthologous segment pairs from our orthology map that contained the elements. We then extracted the polytopes from our whole genome parametric alignment. For each polytope, we determined an optimal alignment for which the number of matching bases of the corresponding element was maximized.</p>
        <p>As an example, consider the transcription factor Adf1. It binds to a cis-regulatory element at chr3R:2,825,118–2,825,144 in <named-content content-type="genus-species">D. melanogaster</named-content> (Adf1-&gt; Antp:06447 in the flyreg database). The BLASTZ alignment for this element is</p>
        <disp-formula id="pcbi-0020073-ex008">
          <graphic xlink:href="pcbi.0020073.ex008.jpg" mimetype="image" position="float"/>
        </disp-formula>
        <p>This alignment suggests that the <named-content content-type="genus-species">D. melanogaster</named-content> cis-regulatory element is not conserved in <named-content content-type="genus-species">D. pseudoobscura</named-content>. However, there are many optimal alignments that indicate that this element is conserved. Examining our constrained segment pairs, we found that the prefix TGTG was at the end of a 13-bp exact match. The remaining <named-content content-type="genus-species">D. melanogaster</named-content> element was part of a segment pair which has 813 distinct optimal alignments in the 3d model. Among these, we found the following alignment with parameters <italic>G</italic> = −3, <italic>S</italic> = −8, <italic>X</italic> = −18:</p>
        <disp-formula id="pcbi-0020073-ex009">
          <graphic xlink:href="pcbi.0020073.ex009.jpg" mimetype="image" position="float"/>
        </disp-formula>
        <p>Note that we include the TGTG prefix to show a complete alignment of the cis-regulatory element. The second alignment has 24 matches instead of the BLASTZ alignment with eight. The number of matches can be used to calculate the <italic>percent identity</italic> for an element as follows:</p>
        <disp-formula id="pcbi-0020073-e004">
          <graphic xlink:href="pcbi.0020073.e004.jpg" position="anchor" mimetype="image"/>
        </disp-formula>
        <p>Percent identity was used in [<xref rid="pcbi-0020073-b020" ref-type="bibr">20</xref>] as a criterion to determine whether binding sites are conserved. The BLASTZ alignment has 30% identity and the alignment with 24 matches has 89% identity. It is an optimal alignment with the highest possible percent identity. After examining all 813 optimal alignments, it appeared to us that the following alignment (obtained with <italic>G</italic> = −882, <italic>S</italic> = −87, <italic>X</italic> = −226) is more reasonable, even though it has a lower percent identity (67%):</p>
        <disp-formula id="pcbi-0020073-ex010">
          <graphic xlink:href="pcbi.0020073.ex010.jpg" mimetype="image" position="float"/>
        </disp-formula>
        <p>This alternative alignment suggests that the percent identity criterion may not be the best way to judge the conservation of elements. Regardless, we believe our parametric alignment indicates that in this particular case, the <named-content content-type="genus-species">D. melanogaster</named-content> cis-regulatory element is likely to have been conserved in <named-content content-type="genus-species">D. pseudoobscura</named-content>.</p>
        <p>Our overall results are summarized in <xref ref-type="table" rid="pcbi-0020073-t005">Table 5</xref>. We found that parameters can be chosen so as to significantly increase the number of matches for cis-regulatory elements. The “optimal parameters” row in the table shows results for the case where parameters were chosen separately for each segment pair so as to maximize the percent identity of the cis-regulatory elements. The “fixed parameters” row shows results when one parameter was selected (optimally) for all segment pairs simultaneously (this was only computed for the 2d model). Note that the mean per-site percent identity reported in [<xref rid="pcbi-0020073-b020" ref-type="bibr">20</xref>] was 51.3%, considerably lower than what we found using the whole genome parametric alignment (even for the 2d model).</p>
        <table-wrap id="pcbi-0020073-t005" content-type="1col" position="float">
          <label>Table 5</label>
          <caption>
            <p>Cis-Regulatory Element Conservation</p>
          </caption>
          <graphic xlink:href="pcbi.0020073.t005"/>
        </table-wrap>
        <p>Our results seem to indicate that cis-regulatory elements are more conserved between <named-content content-type="genus-species">D. melanogaster</named-content> and <named-content content-type="genus-species">D. pseudoobscura</named-content> than previously thought. The alignment polytopes should be a useful tool for further investigation of the extent of conservation of cis-regulatory elements among the <italic>Drosophila</italic> genomes.</p>
      </sec>
      <sec id="s1b3">
        <title>The Jukes–Cantor distance function.</title>
        <p>An important problem in molecular evolution is the estimation of branch lengths from aligned genome sequences. A widely used method for estimating branch lengths is based on the Jukes–Cantor model of evolution [<xref rid="pcbi-0020073-b022" ref-type="bibr">22</xref>]. Given an alignment of two sequences of lengths <italic>l,l′,</italic> with 2d alignment summary (<italic>x</italic>,<italic>s</italic>), one computes the <italic>Jukes–Cantor distance</italic> of the two genomes as follows:</p>
        <disp-formula id="pcbi-0020073-e005">
          <graphic xlink:href="pcbi.0020073.e005.jpg" position="anchor" mimetype="image"/>
        </disp-formula>
        <p>See [<xref rid="pcbi-0020073-b011" ref-type="bibr">11</xref>] for a derivation of this expression, which is also known as the <italic>Jukes–Cantor correction</italic> of the two aligned sequences. The Jukes–Cantor distance can be interpreted as the expected number of mutations per site.</p>
        <p>Because the Jukes–Cantor distance <italic>d<sub>JC</sub></italic>(<italic>x</italic>,<italic>s</italic>) depends on the underlying pairwise sequence alignment summary, which in turn depends on the alignment parameters, it is natural to ask how the branch length estimate depends on the parameters in a 2d-scoring scheme. We therefore introduce the <italic>Jukes–Cantor distance function</italic> which is the function <italic>JC</italic>: <italic>R<sup>2</sup></italic> → [0,∞) given by (<italic>X</italic>,<italic>S</italic>) <inline-formula id="pcbi-0020073-ex011"><inline-graphic xlink:href="pcbi.0020073.ex011.jpg" mimetype="image"/></inline-formula>
where <inline-formula id="pcbi-0020073-ex012"><inline-graphic xlink:href="pcbi.0020073.ex012.jpg" mimetype="image"/></inline-formula>
is the alignment summary maximizing <italic>X</italic> · <italic>x</italic> + <italic>S</italic> · <italic>s</italic>.
</p>
        <p>We computed the Jukes–Cantor distance function <italic>JC</italic> for the entire genomes of <named-content content-type="genus-species">D. melanogaster</named-content> and <named-content content-type="genus-species">D. pseudoobscura</named-content>. As the result of this computation, we now know the Jukes–Cantor distances for all whole genome alignments that are optimal for some choice of biologically reasonable parameters (<italic>X</italic>,<italic>S</italic>).</p>
        <p>The notion of “optimal” used here rests on the following precise definitions. Given parameters (<italic>X</italic>,<italic>S</italic>), the optimal 2d alignment summary (<italic>x</italic>,<italic>s</italic>) for the two genomes is the sum of the optimal summaries of all 877,982 unconstrained segment pairs plus the sum of the alignment summaries of the non-coding constrained segment pairs (which do not depend on the parameters). We determined that the constrained segment pairs contained 91,355 mismatches and 16,339,305 matches. The <italic>genome alignment polytope</italic> is the Minkowski sum of the 877,982 alignment polytopes. The vertices of the genome alignment polytope correspond to optimal summaries of whole genome alignments.</p>
        <p>We computed the genome alignment polytope for the 2d model. Remarkably, this convex polygon, which is the Minkowski sum of close to one million small polygons as in <xref ref-type="fig" rid="pcbi-0020073-g001">Figure 1</xref>, was found to have only 1,183 vertices. Moreover, of the 1,183 vertices of the genome alignment polytope, only 838 correspond to biologically reasonable parameters (<italic>X</italic> &lt; 0, 2<italic>S</italic> &lt; <italic>X</italic>). The finding that there are so few vertices constitutes a striking experimental validation of Elizalde's Few Inference Functions Theorem [<xref rid="pcbi-0020073-b011" ref-type="bibr">11</xref>] in the context of real biological data.</p>
        <p>The Jukes–Cantor distance function <italic>JC</italic> of <named-content content-type="genus-species">D. melanogaster</named-content> and <named-content content-type="genus-species">D. pseudoobscura</named-content> is a piecewise constant function on the (<italic>X</italic>,<italic>S</italic>)-plane. Indeed, <italic>JC</italic> is constant on the cones in the normal fan of the genome alignment polygon. Note that <italic>JC</italic> is undefined when (<italic>X</italic>,<italic>S</italic>) is perpendicular to one of the 1,183 edges of the genome alignment polygon. For such (<italic>X,S)</italic>, the Jukes–Cantor distance function jumps between its values on the two adjacent cones in the normal fan.</p>
        <p>The graph of the Jukes–Cantor distance function is shown in <xref ref-type="fig" rid="pcbi-0020073-g004">Figure 4</xref>. The function ranges in value from 0.1253 to 0.2853, is monotonically decreasing as a function of <italic>S,</italic> and monotonically increasing as a function of <italic>X</italic>. We found it interesting that at the line <italic>X = S,</italic> there is a large “Jukes–Cantor jump” where the value of the function increases from 0.1683 to 0.2225.</p>
        <fig id="pcbi-0020073-g004" position="float">
          <label>Figure 4</label>
          <caption>
            <title>The Jukes–Cantor Distance Function of Two <italic>Drosophila</italic> Genomes</title>
          </caption>
          <graphic xlink:href="pcbi.0020073.g004"/>
        </fig>
        <p>The Jukes–Cantor distance function is a new tool for parametric reconstruction of phylogenetic trees. Instead of estimating a single distance between each pair of genomes in a multiple species phylogenetic reconstruction, one can now evaluate the Jukes–Cantor function at vertices of the Minkowski sum of the whole genome alignment polytopes. These can be used for parametric phylogenetic reconstruction using distance-based methods such as neighbor joining.</p>
      </sec>
    </sec>
  </sec>
  <sec id="s2">
    <title>Discussion</title>
    <p>The summary of a pair of aligned sequences is a list of numbers that determine the score for a scoring scheme. The alignment polytope is a geometric representation of the summaries of all alignments. It is an organizing tool for working with all alignments through their summaries. We view the Needleman–Wunsch algorithm as a fast subroutine for finding vertices of the alignment polytope. The construction of alignment polytopes is useful for biological studies based on sequence alignments where the conclusions depend on parameter choices.</p>
    <p>We have highlighted three biological applications of our parametric alignments, namely the problem of parameter selection for sequence alignment, functional element conservation, and estimation of evolutionary rate parameters. In each case, our perspective suggests new directions for further research.</p>
    <p>Alignment polytopes offer a systematic approach to solving the parameter selection problem. Although this paper did not address statistical aspects of parameter selection, we wish to emphasize that the vertices of the polytopes represent maximum a posteriori estimates of alignments for PHMMs. Our polytopes provide a setting for developing statistically sound methods for parameter selection that are not dependent on pre-existing alignments.</p>
    <p>Our results on cis-regulatory elements show that they may be significantly more conserved than previously thought, and suggest that, in contrast to the analysis of ultra-conserved elements, sequence alignment procedures can be crucial in the analysis of certain functional elements. The ongoing <italic>Drosophila</italic> genome projects (consisting of sequencing 12 genomes of related species) offer an extraordinary opportunity for extending our study and further exploring cis-regulatory element conservation. This leads to the question of multiple alignment, which we have not addressed in this paper, but which we believe presents a formidable and important challenge in biological sequence analysis. In particular, it will be interesting to explore the geometric point of view we have proposed and to develop parametric algorithms for multiple sequence alignment.</p>
    <p>The Jukes–Cantor distance function, computed here for the first time, will be important for determining the robustness of evolutionary studies based on sequence alignments. Estimates of the neutral rate of evolution, which are crucial for comparative genomics studies, can hopefully be improved and further developed using our mathematical tools. The Jukes–Cantor distance function opens up the possibility of parametric distance–based phylogenetic reconstruction. An immediate next step is the extension of our results to other phylogenetic models.</p>
    <p>The construction of millions of alignment polytopes from two <italic>Drosophila</italic> genomes has revealed mathematical insights that should be explored further. For example, we observed empirically that alignment polytopes have few facets. Although we have not explored the combinatorial structure of alignment polytopes in this paper, this offers a promising direction for improving our parametric alignment algorithms and is an interesting direction for future research.</p>
  </sec>
  <sec id="s3">
    <title>Materials and Methods</title>
    <p>The data analyzed are the genome sequences of <named-content content-type="genus-species">D. melanogaster</named-content> (April 2004 BDGP release 4) and <named-content content-type="genus-species">D. pseudoobscura</named-content> (August 2003 freeze 1).</p>
    <p>Gene annotations for identifying exons were based on reference gene sets and <italic>ab initio</italic> predictions. For <italic>D. melanogaster,</italic> we used Flybase [<xref rid="pcbi-0020073-b002" ref-type="bibr">2</xref>], SNAP, genscan, geneid, and RefSeq. Twinscan, SNAP, genscan, geneid, and xenoRefSeq (mRNAs from other species) were used for <named-content content-type="genus-species">D. pseudoobscura</named-content>. Annotations were obtained from the UCSC genome browser, except for SNAP which we ran ourselves.</p>
    <p>MUMmer version 3.18 [<xref rid="pcbi-0020073-b023" ref-type="bibr">23</xref>] was used to obtain potential non-coding anchors (20 bp exact matches). MUMmer was also run on orthologous segments determined by MERCATOR to identify ≥10 bp exact matches to refine the orthology map.</p>
    <p>The Beneath–Beyond and polytope propagation algorithms were implemented in C++. Source code and binaries are available at <ext-link ext-link-type="uri" xlink:href="http://bio.math.berkeley.edu/parametric/">http://bio.math.berkeley.edu/parametric/</ext-link>.</p>
    <p>The BLASTZ alignment was obtained from the UCSC genome browser. The “net” and “chain” tracks were used to determine the best alignment for each interval in <named-content content-type="genus-species">D. melanogaster</named-content>. The resulting alignment blocks were compared with our constraints.</p>
    <p>The transcription factor binding sites used in the cis-regulatory element study were obtained at <ext-link ext-link-type="uri" xlink:href="http://www.flyreg.org">http://www.flyreg.org</ext-link>. 16 sites were excluded because of segment pairs containing Ns.</p>
    <p>Computations were carried out on an 18-node (36 CPU at 2.3 GhZ each) cluster. Each node had 2 Gb RAM.</p>
    <p>The alignment polytopes, software, and supplementary material can be downloaded at <ext-link ext-link-type="uri" xlink:href="http://bio.math.berkeley.edu/parametric/">http://bio.math.berkeley.edu/parametric/</ext-link>.</p>
  </sec>
</body>
<back>
  <fn-group>
    <fn id="ack1" fn-type="con">
      <p><bold>Author contributions.</bold> CND, PMH, KW, BS, and LP conceived and designed the experiments. CND and PMH performed the experiments. CND, PMH, KW, BS, and LP analyzed the data. CND, PMH, KW, BS, and LP wrote the paper.</p>
    </fn>
    <fn id="ack2" fn-type="financial-disclosure">
      <p><bold>Funding.</bold> CND was supported by the NIH (HG003150), PMH was supported by an ARCS Foundation fellowship, and KW was supported by the NSF (DMS-040214). BS was supported by the NSF (DMS-0456960), and LP was supported by the NIH (R01-HG2362-3 and HG003150) and an NSF CAREER award (CCF-0347992).</p>
    </fn>
    <fn id="ack3" fn-type="COI-statement">
      <p><bold>Competing interests.</bold> The authors have declared that no competing interests exist.</p>
    </fn>
    <fn id="n102" fn-type="previously-at">
      <p>A previous version of this article appeared as an Early Online Release on May 10, 2006 (DOI: <ext-link ext-link-type="doi" xlink:href="10.1371/journal.pcbi.0020073.eor">10.1371/journal.pcbi.0020073.eor</ext-link>).</p>
    </fn>
  </fn-group>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>PHMM</term>
        <def>
          <p>pair hidden Markov model</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <ref-list>
    <title>References</title>
    <ref id="pcbi-0020073-b001">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Needleman</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wunsch</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <year>1970</year>
        <article-title>A general method applicable to the search for similarities in the amino acid sequence of two proteins</article-title>
        <source>J Mol Biol</source>
        <volume>48</volume>
        <fpage>443</fpage>
        <lpage>445</lpage>
        <pub-id pub-id-type="pmid">5420325</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi-0020073-b002">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Drysdale</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Crosby</surname>
            <given-names>M</given-names>
          </name>
          <collab>The Flybase Consortium</collab>
        </person-group>
        <year>2005</year>
        <article-title>Flybase: Genes and gene models</article-title>
        <source>Nucleic Acids Res</source>
        <volume>33</volume>
        <fpage>D390</fpage>
        <lpage>D395</lpage>
        <pub-id pub-id-type="pmid">15608223</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi-0020073-b003">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bray</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <year>2003</year>
        <article-title>MAVID multiple alignment server</article-title>
        <source>Nucleic Acids Res</source>
        <volume>31</volume>
        <fpage>3525</fpage>
        <lpage>3526</lpage>
        <pub-id pub-id-type="pmid">12824358</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi-0020073-b004">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schwartz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kent</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Smit</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Baertsch</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2003</year>
        <article-title>Human–mouse alignments with BLASTZ</article-title>
        <source>Genome Res</source>
        <volume>13</volume>
        <fpage>103</fpage>
        <lpage>107</lpage>
        <pub-id pub-id-type="pmid">12529312</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi-0020073-b005">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Waterman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Eggert</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <year>1992</year>
        <article-title>Parametric sequence comparisons</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <volume>89</volume>
        <fpage>6090</fpage>
        <lpage>6093</lpage>
        <pub-id pub-id-type="pmid">1631095</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi-0020073-b006">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gusfield</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Balasubramanian</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Naor</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <year>1994</year>
        <article-title>Parametric optimization of sequence alignment</article-title>
        <source>Algorithmica</source>
        <volume>12</volume>
        <fpage>312</fpage>
        <lpage>326</lpage>
      </element-citation>
    </ref>
    <ref id="pcbi-0020073-b007">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gusfield</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Stelling</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <year>1996</year>
        <article-title>Parametric and inverse–parametric sequence alignment with XPARAL</article-title>
        <source>Methods Enzymol</source>
        <volume>266</volume>
        <fpage>481</fpage>
        <lpage>494</lpage>
        <pub-id pub-id-type="pmid">8743701</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi-0020073-b008">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fernández-Baca</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Seppäläinen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Slutzki</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <year>2004</year>
        <article-title>Parametric multiple sequence alignment and phylogeny construction</article-title>
        <source>J Discrete Algorithms</source>
        <volume>2</volume>
        <fpage>271</fpage>
        <lpage>287</lpage>
      </element-citation>
    </ref>
    <ref id="pcbi-0020073-b009">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Fernández-Baca</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Venkatachalam</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <article-title>Parametric sequence alignment</article-title>
        <comment>In:</comment>
        <person-group person-group-type="editor">
          <name>
            <surname>Aluru</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <source>Handbook of computational molecular biology</source>
        <series>Computer and Information Science Series</series>
        <volume>(Volume 2)</volume>
        <publisher-name>Chapman and Hall/CRC Press</publisher-name>
        <comment>pp.</comment>
        <fpage>271</fpage>
        <lpage>287</lpage>
      </element-citation>
    </ref>
    <ref id="pcbi-0020073-b010">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Sturmfels</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <year>2004</year>
        <article-title>Parametric inference for biological sequence analysis</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <volume>101</volume>
        <fpage>16138</fpage>
        <lpage>16143</lpage>
        <pub-id pub-id-type="pmid">15534223</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi-0020073-b011">
      <element-citation publication-type="book">
        <person-group person-group-type="editor">
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Sturmfels</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <source>Algebraic statistics for computational biology</source>
        <publisher-loc>Cambridge</publisher-loc>
        <publisher-name>Cambridge University Press</publisher-name>
        <size units="page">420</size>
        <comment>p.</comment>
      </element-citation>
    </ref>
    <ref id="pcbi-0020073-b012">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gibbs</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Weinstock</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Metzker</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Muzny</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Sodergren</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2004</year>
        <article-title>Genome sequence of the Brown Norway rat yields insights into mammalian evolution</article-title>
        <source>Nature</source>
        <volume>428</volume>
        <fpage>493</fpage>
        <lpage>521</lpage>
        <pub-id pub-id-type="pmid">15057822</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi-0020073-b013">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Waterston</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lindblad-Toh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Birney</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Rogers</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Abril</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2002</year>
        <article-title>Initial sequencing and comparative analysis of the mouse genome</article-title>
        <source>Nature</source>
        <volume>420</volume>
        <fpage>520</fpage>
        <lpage>562</lpage>
        <pub-id pub-id-type="pmid">12466850</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi-0020073-b014">
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Dewey</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <year>2006</year>
        <source>Mercator: Multiple whole-genome orthology map construction</source>
        <comment>Available: <ext-link ext-link-type="uri" xlink:href="http://bio.math.berkeley.edu/mercator/">http://bio.math.berkeley.edu/mercator/</ext-link>. Accessed 22 May 2006.</comment>
      </element-citation>
    </ref>
    <ref id="pcbi-0020073-b015">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <year>2002</year>
        <article-title>BLAT—The BLAST like alignment tool</article-title>
        <source>Genome Biol</source>
        <volume>12</volume>
        <fpage>656</fpage>
        <lpage>664</lpage>
      </element-citation>
    </ref>
    <ref id="pcbi-0020073-b016">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Korgh</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mitchison</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <year>1998</year>
        <source>Biological sequence analysis: Probabilistic models of proteins and nucleic acids</source>
        <publisher-loc>Cambridge</publisher-loc>
        <publisher-name>Cambridge University Press</publisher-name>
        <size units="page">356</size>
        <comment>p.</comment>
      </element-citation>
    </ref>
    <ref id="pcbi-0020073-b017">
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Chiaromonte</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Yap</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <year>2002</year>
        <article-title>Scoring pairwise genomic sequence alignments</article-title>
        <source>Proceedings of the Pacific Symposium on Biocomputing</source>
        <fpage>115</fpage>
        <lpage>126</lpage>
      </element-citation>
    </ref>
    <ref id="pcbi-0020073-b018">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Grünbaum</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <year>2003</year>
        <article-title>Convex polytopes</article-title>
        <person-group person-group-type="author">
          <name>
            <surname>Kaibel</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Klee</surname>
            <given-names> V</given-names>
          </name>
          <name>
            <surname>Ziegler</surname>
            <given-names>GM</given-names>
          </name>
        </person-group>
        <source>Graduate texts in mathematics</source>
        <volume>(Volume 221)</volume>
        <edition>2nd edition.</edition>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer-Verlag</publisher-name>
        <size units="page">468</size>
        <comment>p.</comment>
      </element-citation>
    </ref>
    <ref id="pcbi-0020073-b019">
      <element-citation publication-type="book">
        <collab>Preparata F, Shamos M</collab>
        <year>1985</year>
        <article-title>Computational geometry: An introduction</article-title>
        <source>Texts and monographs in computer science</source>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
        <size units="page">390</size>
        <comment> p.</comment>
      </element-citation>
    </ref>
    <ref id="pcbi-0020073-b020">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Richards</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Bettencourt </surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Hradecky</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Letovsky</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2005</year>
        <article-title>Comparative genome sequencing of Drosophila pseudoobscura: Chromosomal, gene, and cis-element evolution</article-title>
        <source>Genome Res</source>
        <volume>15</volume>
        <fpage>1</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="pmid">15632085</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi-0020073-b021">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bergman</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Carlson </surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Celniker</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <year>2005</year>
        <article-title>Drosophila DNase I footprint database: A systematic genome annotation of transcription factor binding sites in the fruitfly, D. melanogaster</article-title>
        <source>Bioinformatics</source>
        <volume>21</volume>
        <fpage>1747</fpage>
        <lpage>1749</lpage>
        <pub-id pub-id-type="pmid">15572468</pub-id>
      </element-citation>
    </ref>
    <ref id="pcbi-0020073-b022">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Jukes</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Cantor</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <year>1969</year>
        <article-title>Evolution of protein molecules</article-title>
        <person-group person-group-type="editor">
          <name>
            <surname>Munro</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <source>Mammalian protein metabolism</source>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Academic Press</publisher-name>
        <fpage>21</fpage>
        <lpage>32</lpage>
      </element-citation>
    </ref>
    <ref id="pcbi-0020073-b023">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Delcher</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kasif</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Fleischmann</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Peterson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <year>1999</year>
        <article-title>Alignment of whole genomes</article-title>
        <source>Nucleic Acids Res</source>
        <volume>27</volume>
        <fpage>2369</fpage>
        <lpage>2376</lpage>
        <pub-id pub-id-type="pmid">10325427</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
