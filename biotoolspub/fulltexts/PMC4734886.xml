<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4734886</article-id>
    <article-id pub-id-type="publisher-id">865</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-015-0865-0</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CIDANE: comprehensive isoform discovery and abundance estimation</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Canzar</surname>
          <given-names>Stefan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
        <xref ref-type="aff" rid="Aff4"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Andreotti</surname>
          <given-names>Sandro</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Weese</surname>
          <given-names>David</given-names>
        </name>
        <address>
          <email>david.weese@fu-berlin.de</email>
        </address>
        <xref ref-type="aff" rid="Aff2"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Reinert</surname>
          <given-names>Knut</given-names>
        </name>
        <address>
          <email>knut.reinert@fu-berlin.de</email>
        </address>
        <xref ref-type="aff" rid="Aff2"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Klau</surname>
          <given-names>Gunnar W.</given-names>
        </name>
        <address>
          <email>gunnar.klau@cwi.nl</email>
        </address>
        <xref ref-type="aff" rid="Aff3"/>
      </contrib>
      <aff id="Aff1"><label/>Center for Computational Biology, McKusick-Nathans Institute of Genetic Medicine, Johns Hopkins University School of Medicine, Baltimore, MD 21205 USA </aff>
      <aff id="Aff2"><label/>Department of Mathematics and Computer Science, Institute of Computer Science, Freie Universität Berlin, Arnimallee 14, Berlin, 14195 Germany </aff>
      <aff id="Aff3"><label/>Life Sciences, Centrum Wiskunde &amp; Informatica (CWI), Science Park 123, Amsterdam, 1098 XG The Netherlands </aff>
      <aff id="Aff4"><label/>Toyota Technological Institute at Chicago, 6045 S. Kennwood Avenue, Chicago, IL 60637 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>30</day>
      <month>1</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>30</day>
      <month>1</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <year>2016</year>
    </pub-date>
    <volume>17</volume>
    <elocation-id>16</elocation-id>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>10</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>29</day>
        <month>12</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Canzar et al. 2016</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p>We present CIDANE, a novel framework for genome-based transcript reconstruction and quantification from RNA-seq reads. CIDANE assembles transcripts efficiently with significantly higher sensitivity and precision than existing tools. Its algorithmic core not only reconstructs transcripts ab initio, but also allows the use of the growing annotation of known splice sites, transcription start and end sites, or full-length transcripts, which are available for most model organisms. CIDANE supports the integrated analysis of RNA-seq and additional gene-boundary data and recovers splice junctions that are invisible to other methods. CIDANE is available at <ext-link ext-link-type="uri" xlink:href="http://ccb.jhu.edu/software/cidane/">http://ccb.jhu.edu/software/cidane/</ext-link>.</p>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s13059-015-0865-0) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2016</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>High-throughput sequencing of cellular RNA (RNA-seq) aims at identifying and quantifying the set of all RNA molecules, the transcriptome, produced by a cell. Despite having largely identical genomes, the RNA content of cells differs among tissues, developmental stages, and between disease and normal condition. For eukaryotes, differences are determined by the set of genes being expressed, but also by the different mRNA isoforms each gene may produce; alternative splicing, alternative transcription and polyadenylation define and combine exons in distinct ways.</p>
    <p>RNA-seq technology can generate hundreds of millions of short (50–250 bp) strings of bases, called reads, from expressed transcripts at a fraction of the time and cost required by conventional Sanger sequencing. The wealth of RNA-seq data produced recently has revealed novel isoforms [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>] and new classes of RNA [<xref ref-type="bibr" rid="CR4">4</xref>], allowed a better characterization of cancer transcriptomes [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>], and led to the discovery of splicing aberrations in disease [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>].</p>
    <p>However, the step from sequencing to profiling the cellular transcriptome involves solving a high-dimensional complex puzzle, which poses major challenges to bioinformatics tools as every single short read carries little information by itself. In particular, repeat and paralogous sequences, as well as low-expressed regions and minor isoforms, are difficult to assemble. Notice that transcripts that are moderately expressed only in a subpopulation of cells manifest an overall low expression level, as might be the case for long noncoding RNAs (lncRNAs) [<xref ref-type="bibr" rid="CR4">4</xref>].</p>
    <p>Unlike de novo transcript assembly approaches, which assemble reads solely based on the overlap of their sequences, genome-based methods employ a high-quality reference genome to resolve better ambiguities imposed by highly similar regions of the genome and to recover lower expressed transcripts. Genome-based methods first align reads to the genome to determine where each of the reads originated and then assemble the alignments into transcript models. This in turn introduces a critical dependence on the accuracy of the read alignment, which is affected by sequencing errors, polymorphisms, splicing, and ambiguous reads that belong to repeats. Reads spanning splice junctions between exons are particularly informative since they provide an explicit signal for the detection of splice donor and acceptor sites. At the same time, the spliced alignment of such reads is computationally challenging and error prone.</p>
    <p>For an unbalanced split, the prefix or suffix of a read that spans one of the two consecutive exons may be short and thus aligns equally well to a large number of genomic positions. Guessing the true origin can be further hampered by polymorphisms near the splice site. Besides <italic>incorrect</italic> spliced alignments, this can also lead to <italic>missed</italic> splice junctions, i.e., exon–exon junctions that are not supported (covered) by any spliced alignment. Missed junctions can also result from read coverage fluctuations (biases) or a generally low transcript abundance. While some of the existing methods do take into account incorrect alignments by applying ad hoc filters (Scripture [<xref ref-type="bibr" rid="CR9">9</xref>] and CLIIQ [<xref ref-type="bibr" rid="CR10">10</xref>]) or by not requiring the isoform selection model to explain all input alignments (MITIE [<xref ref-type="bibr" rid="CR11">11</xref>]), none of the existing approaches is able to deal with missed junctions. In this work we present a novel framework CIDANE (comprehensive isoform discovery and abundance estimation), which, for the first time, allows us to recover isoforms with uncovered splice junctions that are invisible to all existing approaches.</p>
    <p>On a high level, existing methods for genome-based transcript assembly adhere to the following scheme: First, a set of candidate isoforms is defined as paths in a graph representing the base or exon connectivity as indicated by the aligned reads. Then, a <italic>small</italic> subset of isoforms is selected that explains the read alignments <italic>well</italic>. Since only a small number of transcripts is typically expressed in a given cell type (compared to the number of candidates), the restriction to few isoforms prevents fitting noise in the data.</p>
    <p>Current methods mostly differ in the trade-offs they apply between the complexity of the model and the tractability of the resulting optimization problem, which largely determines the quality of the prediction: 
<list list-type="order"><list-item><p>Since the number of potential isoforms grows exponentially with the number of exons of the locus, all existing methods restrict either implicitly or explicitly the number of candidates they consider. Methods that do not enumerate isoforms explicitly either employ a simplified model with transcript-independent coefficients (e.g., MITIE and Traph [<xref ref-type="bibr" rid="CR12">12</xref>]) or separate the intrinsically interdependent minimality and accuracy objectives (Cufflinks [<xref ref-type="bibr" rid="CR2">2</xref>]).</p></list-item><list-item><p>A second crucial algorithmic design decision is how to <italic>balance</italic> the two concurrent objectives. In an extreme case, the two objectives are treated independently (e.g., Cufflinks, CLASS [<xref ref-type="bibr" rid="CR13">13</xref>], CLIIQ, Traph, and IsoInfer [<xref ref-type="bibr" rid="CR14">14</xref>]). More recent state-of-the-art methods (e.g., MITIE, iReckon [<xref ref-type="bibr" rid="CR15">15</xref>], SLIDE [<xref ref-type="bibr" rid="CR16">16</xref>], IsoLasso [<xref ref-type="bibr" rid="CR17">17</xref>], and StringTie [<xref ref-type="bibr" rid="CR18">18</xref>]) have recognized the importance of optimizing both objectives simultaneously and balance minimality and accuracy heuristically.</p></list-item><list-item><p>Among methods that simultaneously optimize for both objectives, the measure of minimality has an enormous impact on the tractability of the resulting problem. The most immediate measure, the number of predicted transcripts (<italic>L</italic><sup>0</sup> norm), leads to non-convex objectives and a computationally intractable optimization problem. Methods like MITIE, StringTie, Montebello [<xref ref-type="bibr" rid="CR19">19</xref>], and iReckon, which employs a novel non-convex minimality measure, therefore resort to a forward stepwise regression strategy, a Monte Carlo simulation, or numerical optimization combined with random restarts, that generally do not find the best solution in this model. Methods like SLIDE and IsoLasso thus replace the <italic>L</italic><sup>0</sup> norm by the convex <italic>L</italic><sup>1</sup> norm, i.e., the sum of transcript abundances.</p></list-item><list-item><p>Concerning the measure of accuracy, methods apply a least-squares loss function (e.g., IsoLasso, SLIDE, or TRAPH), least absolute deviation (not explicitly modeled in StringTie), or compute more generally a maximum likelihood assignment of reads to candidate isoforms. The latter typically requires a preselection of transcripts (Cufflinks) or leads to the intractability of the resulting problem (iReckon and Montebello).</p></list-item></list></p>
    <p>Here we present CIDANE, a comprehensive tool for genome-based assembly and quantification of transcripts from RNA-seq experiments. The central idea of CIDANE is to trade the ability to determine the provably best transcript prediction in the underlying model for a slight approximation of the loss function. Intuitively, the accuracy and minimality measure (see (3) and (4)) fit noisy observations (read alignments) and thus, the impact of their (adjustable) approximation on the overall prediction performance is expected to be rather limited. CIDANE therefore minimizes a least-squares loss function based on full-length transcripts and replaces the <italic>L</italic><sup>0</sup> minimality measure by the convex <italic>L</italic><sup>1</sup> norm, which, in fact, <italic>selects</italic> a subset of transcripts with non-zero expression levels that is predicted to be expressed in a given cell type. A formulation based on full-length isoforms enables us to develop a comprehensive linear model (like SLIDE), which, among other things, takes into account the dependence of the distribution of read pairs along a given transcript on the estimated fragment length distribution. In contrast to previous methods, we employ a state-of-the-art machine-learning algorithm to compute the optimal balance (according to a strict mathematical measure) between accuracy and minimality at essentially no additional computational cost. In a second phase, CIDANE linearizes the least-squares loss function with bounded error, which allows us to formulate our model based on all possible candidate transcripts, including transcripts with uncovered splice junctions, without having to enumerate them explicitly. Following the principle of <italic>delayed column generation</italic> [<xref ref-type="bibr" rid="CR20">20</xref>], we only add isoforms to our model on demand, i.e., if they help to strictly improve the overall prediction.</p>
    <p>CIDANE implements a design that separates the assembly of full-length transcripts from the identification of elementary components, i.e., exons or retained introns. This separation facilitates the incorporation of novel methods for splice site detection as well as additional sources of information to yield transcript assemblies that are more accurate. Not only a growing annotation of known splice sites, exon junctions, transcription start and end sites (TSSs and TESs) or even full-length isoforms can guide the assembly for most model organisms, but also additional gene boundary data can aid the interpretation of RNA-seq data. Our experiments demonstrate the superior performance of CIDANE in all these different scenarios of optionally available levels of annotation as well as in the interpretation of additionally available gene boundary data. The general work flow of CIDANE is illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref>.
<fig id="Fig1"><label>Fig. 1</label><caption><p>General work flow of CIDANE. Mandatory inputs (mapped RNA-seq reads and exon boundaries) and optional inputs (TSS, TES, and known transcripts) are used to summarize read alignments into segment covers, which count reads falling into non-ambiguously spliced segments of genes. From the corresponding splicing graph representation [<xref ref-type="bibr" rid="CR37">37</xref>], an initial set of candidate isoforms is derived and a subset of expressed isoforms with estimated abundances is predicted by a regularized regression method during phase I. This set forms the input to the optional phase II, where improving isoforms are built on demand by a delayed column generation approach. New candidates inferred in phase II are then added to the initial candidate set to achieve a better fit of the model. After re-estimation of abundances and filtering (post-processing), a list of isoforms with abundance estimates is returned in gtf format</p></caption><graphic xlink:href="13059_2015_865_Fig1_HTML" id="MO1"/></fig></p>
  </sec>
  <sec id="Sec2">
    <title>Results and discussion</title>
    <p>We compared the performance of CIDANE in reconstructing transcripts from RNA-seq data to existing state-of-the-art methods. We evaluated the prediction quality on the transcript level based on both simulated and real data. While simulated data capture the characteristics of real data only to the extent that we understand the specifics of the experimental protocol, the performance analysis based on real RNA-seq data today still lacks a gold standard RNA-seq library along with annotated expressed transcripts. Therefore, the results of both types of experiments together provide a more meaningful picture of the true performance of a transcript assembly method.</p>
    <p>Using simulated data, we investigated the impact of transcript abundance on the prediction quality and considered the scenario where a partial annotation of the (human) transcriptome is available to guide the reconstruction. We assessed both the mere absence or presence of a (true) transcript in the prediction as well as the accuracy of the estimation of their abundances. Generating <italic>perfect mapping files</italic>, we make an attempt to quantify the dependence of current genome-based transcript assembly tools on the accuracy of the read mapping (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S1 and S2). We demonstrate the superiority of CIDANE in the ab initio analysis of two human RNA-seq data sets from the ENCODE project [<xref ref-type="bibr" rid="CR21">21</xref>], and through an integrated analysis of modENCODE RNA data, including RNA-seq, cap analysis of gene expression (CAGE), and poly(A) site sequencing (PAS-seq), obtained from the heads of 20-day-old adult <italic>Drosophila melanogaster</italic>. CAGE and PAS-seq data facilitate the mapping of TSSs and TESs, which are very difficult to infer from RNA-seq data alone. Furthermore, we illustrate CIDANE’s ability to (i) incorporate prior knowledge to improve substantially the prediction in various realistic scenarios and (ii) recover (<italic>invisible</italic>) transcripts with uncovered splice junctions.</p>
    <p>We compared the prediction to a reference transcriptome, referred to as <italic>ground truth</italic>, containing the <italic>true transcripts</italic>. Where not specified otherwise, we consider a true transcript as <italic>recovered</italic> by a predicted transcript if their sequences of introns (intron chains) are identical. A true single-exon transcript is scored as recovered if it overlaps a predicted single-exon transcript. Every predicted transcript is matched to at most one true transcript and vice versa. If rec, true, and pred denote the number of recovered, true, and predicted transcripts, respectively, we applied recall (rec/true), precision (rec/pred), and <italic>F</italic> score, the harmonic mean of recall and precision ((2×precision×recall)/(precision+recall)), as a measure of prediction quality. Not to penalize potential novel discoveries, the calculation of precision ignores predicted transcripts that do not overlap any of the true transcripts. The version number of each tool and the parameters used in our experiments are specified in Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p>
    <sec id="Sec3">
      <title>Isoform reconstruction from simulated data</title>
      <p>To obtain data as realistic as possible, we used FluxSimulator [<xref ref-type="bibr" rid="CR22">22</xref>] to generate RNA-seq data sets based on ∼ 78,000 UCSC-known (February, GRCh37/hg19) human transcripts [<xref ref-type="bibr" rid="CR23">23</xref>]. After assigning randomized expression levels to all annotated transcripts following a distribution observed in real data, FluxSimulator simulates the individual steps of an RNA-seq experiment, including reverse transcription, fragmentation, size selection, and sequencing. For all simulated data sets used in this section, the parameter files specifying the model of the RNA-seq experiment and the alignments are available from [<xref ref-type="bibr" rid="CR24">24</xref>].</p>
      <sec id="Sec4">
        <title>Ab initio transcript assembly</title>
        <p>Mimicking the characteristics of real RNA-seq data, we generated four data sets comprising 40 and 80 million read pairs (i.e., 80 and 160 million reads) of length 75 and 100 bp, respectively. The fragment lengths observed after gel electrophoresis are modeled by a normal distribution <italic>N</italic>(250,25) for the 75-bp reads and <italic>N</italic>(300,30) for the 100-bp reads. We mapped each set of paired-end reads to the set of known transcripts using TopHat2 [<xref ref-type="bibr" rid="CR25">25</xref>]. We defined the ground truth as the set of all annotated transcripts (UCSC) for which at least one paired-end read has been produced.</p>
        <p>We compared the performance of CIDANE to the transcriptome reconstruction quality of StringTie [<xref ref-type="bibr" rid="CR18">18</xref>], Cufflinks [<xref ref-type="bibr" rid="CR2">2</xref>], CLASS [<xref ref-type="bibr" rid="CR13">13</xref>], IsoLasso [<xref ref-type="bibr" rid="CR17">17</xref>], SLIDE [<xref ref-type="bibr" rid="CR16">16</xref>], and MITIE [<xref ref-type="bibr" rid="CR11">11</xref>]. All recall and precision values achieved by CIDANE include transcripts with uncovered splice junctions predicted in phase II. We did not include iReckon and GRIT [<xref ref-type="bibr" rid="CR26">26</xref>] in this first benchmark as both methods require TSSs and TESs to be provided, which, as shown by the experiments in Sections “<xref rid="Sec12" ref-type="sec">Annotation-guided assembly</xref>” and “<xref rid="Sec14" ref-type="sec">Integrating real RNA-seq, CAGE, and PAS-seq</xref>”, provides valuable guidance in transcript reconstruction. While IsoLasso, SLIDE, and CIDANE employ known exon–intron boundaries, Cufflinks, CLASS, and StringTie do not allow for the incorporation of pre-computed or annotated splice sites. Cufflinks and StringTie do accept annotated full-length transcripts [<xref ref-type="bibr" rid="CR27">27</xref>], a scenario that we will investigate in Section “<xref rid="Sec6" ref-type="sec">Transcript assembly with partial annotation</xref>”. In this experiment, we disable the ability of CIDANE to recombine acceptor and donor sites to form novel exons. Since exon boundary information could be used to infer the originating strand, in the following we apply strand-unspecific evaluation criteria. To eliminate a potential source of inaccuracy prior to the reconstruction algorithm, we provided IsoLasso and SLIDE with the fragment length distribution parameters as estimated by Cufflinks.</p>
        <p>For the data set comprising 40 million 75-bp read pairs (Fig. <xref rid="Fig2" ref-type="fig">2</xref><xref rid="Fig2" ref-type="fig">a</xref>), CIDANE reconstructed transcripts with a recall value of 54.4 <italic>%</italic>, a more than 14 <italic>%</italic> increase over the recall achieved by StringTie (47.7 <italic>%</italic>), Cufflinks (45.9 <italic>%</italic>), or CLASS (43.7 <italic>%</italic>), and a ∼ 30 <italic>%</italic> improvement over IsoLasso (41.7 <italic>%</italic>). At the same time, CIDANE predicts transcripts with a precision like that of Cufflinks (71.6 <italic>%</italic>), and only 4 <italic>%</italic> lower than StringTie (74.9 <italic>%</italic>). When the same number of 100-bp reads is generated (Fig. <xref rid="Fig2" ref-type="fig">2</xref><xref rid="Fig2" ref-type="fig">b</xref>), the precision of StringTie and Cufflinks decreases significantly and is then lower than CIDANE’s precision by 13.6 <italic>%</italic> and 9.9 <italic>%</italic>, respectively.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Each tool <italic>X</italic>∈{Cufflinks, IsoLasso, CLASS, CIDANE, MITIE, StringTie } is represented by a point with coordinates (precision of <italic>X</italic>, recall of <italic>X</italic>). <italic>F</italic> score isolines are shown in <italic>light gray</italic>. Simulated data sets comprise 40 million 75-bp (<bold>a</bold>) and 100-bp read pairs (<bold>b</bold>). <bold>c</bold> and <bold>d</bold> Precision and recall achieved by each tool when provided with a partial annotation</p></caption><graphic xlink:href="13059_2015_865_Fig2_HTML" id="MO2"/></fig></p>
        <p>IsoLasso seems to suffer from a heuristic determination of the regularization penalty. SLIDE showed the lowest <italic>F</italic> score on all four data sets and was not included in the plots. Note that Cufflinks and CLASS model the transcript reconstruction problem as a <italic>covering</italic> problem minimizing the number of transcripts required to explain the input read alignments qualitatively. Neglecting quantitative information at this stage, it is not surprising that the two methods yield rather conservative predictions. Sections “<xref rid="Sec6" ref-type="sec">Transcript assembly with partial annotation</xref>”, “<xref rid="Sec11" ref-type="sec">Ab initio prediction</xref>”, and “<xref rid="Sec14" ref-type="sec">Integrating real RNA-seq, CAGE, and PAS-seq</xref>” show that the superior performance of CIDANE compared to StringTie and Cufflinks cannot be attributed (only) to the additional exon boundary information. When provided with the exact same partial annotation of transcripts (Section “<xref rid="Sec6" ref-type="sec">Transcript assembly with partial annotation</xref>”) or when exon boundaries are inferred from the read data alone (Sections “<xref rid="Sec14" ref-type="sec">Integrating real RNA-seq, CAGE, and PAS-seq</xref>” and “<xref rid="Sec11" ref-type="sec">Ab initio prediction</xref>”), CIDANE still outperforms all existing methods.</p>
        <p>The relative performance of the tools is similar on the larger data sets (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3). Cufflinks, however, seems to have difficulties assembling the 80 million 100-bp read pairs. Recall and precision achieved by the tools for the four different experimental designs are listed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S1, S2, S3, and S4.</p>
        <sec id="Sec5">
          <title>Dependence on transcript abundance</title>
          <p>Further, we analyzed the influence of transcript abundance on the reconstruction capability of the different methods. We removed all transcripts that have many of their bases uncovered (&lt;0.1 fragments per kilobase of transcript per million fragments sequenced or FPKM) from the ground truth and split the remaining isoforms into three groups: <italic>low</italic> comprises the 20 <italic>%</italic> fraction of transcripts with lowest simulated expression, <italic>high</italic> the highest 5 <italic>%</italic> fraction, and <italic>med</italic> contains the remaining 75 <italic>%</italic> of true transcripts. This subdivision corresponds to cutoffs in relative expression of ∼ 1.5×10<sup>−6</sup> and ∼ 2.5×10<sup>−4</sup> molecules, respectively. As expected, a higher abundance facilitates the reconstruction of isoforms (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). From the 75-bp reads, however, CIDANE and SLIDE recover almost twice as many lowly expressed isoforms (recall ∼ 31 <italic>%</italic> and ∼ 30 <italic>%</italic>, respectively) as Cufflinks (recall ∼ 6.1 <italic>%</italic>), the next best method, whereas StringTie, CLASS, and IsoLasso recover only ∼ 8 <italic>%</italic>, ∼ 6 <italic>%</italic>, and ∼ 3 <italic>%</italic>, respectively. We observe similar results for the 100-bp data set. Not surprisingly, a higher number of reads facilitates the recovery of low-expressed transcripts (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4).
<fig id="Fig3"><label>Fig. 3</label><caption><p>Recall achieved by the different methods vs the expression level of true transcripts in the two 40-million read-pair data sets. Transcripts with simulated FPKM &gt;0.1 (<italic>total</italic>) are grouped into sets <italic>low</italic>, <italic>high</italic>, and <italic>med</italic> that contain the lowest expressed 20 <italic>%</italic> of the transcripts, the highest expressed 5 <italic>%</italic>, and all remaining transcripts, respectively. <bold>a</bold> 75-bp data set. <bold>b</bold> 100-bp data set</p></caption><graphic xlink:href="13059_2015_865_Fig3_HTML" id="MO3"/></fig></p>
          <p>The ability of CIDANE to reconstruct, to some extent, even lowly expressed isoforms is likely due to its two core algorithmic improvements: First, CIDANE computes the entire regularization path in phase I (see Section “<xref rid="Sec19" ref-type="sec">Model fitting</xref>”) to find the right balance between prediction accuracy and sparsity. An objective that is skewed towards sparsity typically yields predictions that miss low-expressed transcripts. Second, our approach considers a wider range of candidate transcripts than existing methods in phase II (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). These include isoforms whose low abundance might cause splice junctions to be uncovered by reads rendering them invisible to other approaches. We investigate this effect in Sections “<xref rid="Sec8" ref-type="sec">Delayed recovery of transcripts</xref>” and “<xref rid="Sec13" ref-type="sec">Recovering invisible transcripts</xref>”. Note that for the two 40-million read-pair data sets, SLIDE achieves a similar recall on low-expressed isoforms only at the cost of a significantly lower precision and incurs a several orders of magnitude higher computational cost than CIDANE (see Section “<xref rid="Sec9" ref-type="sec">Running times</xref>”). From the two 80-million read-pair data sets, CIDANE reconstructs low-expressed transcripts with a ∼ 13 <italic>%</italic> to 17 <italic>%</italic> higher recall compared to SLIDE. All expression-level dependent recall values can be found in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S1, S2, S3, and S4.</p>
        </sec>
      </sec>
      <sec id="Sec6">
        <title>Transcript assembly with partial annotation</title>
        <p>We investigated the ability of Cufflinks, using the RABT approach presented in [<xref ref-type="bibr" rid="CR27">27</xref>], iReckon [<xref ref-type="bibr" rid="CR15">15</xref>], MITIE, StringTie, GRIT [<xref ref-type="bibr" rid="CR26">26</xref>], and CIDANE to exploit an existing but incomplete annotation of transcripts. No other assembly tool allowed us to provide annotated transcripts. Such a partial annotation, available for the human transcriptome and many other studied organisms, can provide valuable guidance for the reconstruction of known isoforms, but algorithms must properly balance the preferential prediction of known transcripts and the detection of novel unknown isoforms.</p>
        <p>Our algorithmic scheme allows the incorporation of annotated TSSs and TESs during the isoform inference (see Sections “<xref rid="Sec18" ref-type="sec">Candidate isoforms</xref>” and “<xref rid="Sec23" ref-type="sec">Transcription start and end sites</xref>”). CIDANE accounts for a higher confidence in annotated vs novel transcripts by adjusting model parameters (see Sections “<xref rid="Sec19" ref-type="sec">Model fitting</xref>” and “<xref rid="Sec25" ref-type="sec">Phase III: fine-tuning and post-processing</xref>”).</p>
        <p>From 1440 genes on chromosomes 1 and 2 for which between two and eight isoforms have been annotated, we randomly removed, while preserving all exons, at least one and at most 50 <italic>%</italic> of the known isoforms and provided each tool with the remaining ∼ 65 <italic>%</italic> (<italic>Annot</italic>) of the originally ∼ 6300 known transcripts. The hidden ∼ 35 <italic>%</italic> of annotated transcripts (<italic>Novel</italic>) constitutes the reference set (ground truth) in evaluating the ability of each method to infer novel isoforms in the presence of an incomplete annotation. Among the original ∼ 6300 transcripts, FluxSimulator generated 4 million read pairs (75 bp) from a randomly selected subset of 70 <italic>%</italic> expressed transcripts, which were mapped back by TopHat2. All recall and precision values are listed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5.</p>
        <p>Overall, CIDANE achieves the best trade-off between recognizing known and predicting novel transcripts. With respect to the complete set of expressed transcripts (Fig. <xref rid="Fig2" ref-type="fig">2</xref><xref rid="Fig2" ref-type="fig">c</xref>), CIDANE correctly assembles 20 <italic>%</italic> more transcripts than Cufflinks (77.2 <italic>%</italic> vs 64.1 <italic>%</italic>), combined with a 12 <italic>%</italic> higher precision than StringTie (85.4 <italic>%</italic> vs 76.3 <italic>%</italic>). StringTie’s slightly higher recall (5 <italic>%</italic>) is entirely based on set <italic>Annot</italic> of transcripts known to each tool. StringTie assigns non-zero expression levels to the vast majority of provided transcripts and therefore, not surprisingly achieves a recall of 99 <italic>%</italic> with respect to known transcripts, but only 49 <italic>%</italic> with respect to novel transcripts (Fig. <xref rid="Fig2" ref-type="fig">2</xref><xref rid="Fig2" ref-type="fig">d</xref>). CIDANE discovers more than 14 <italic>%</italic> and 39 <italic>%</italic> more novel transcripts than StringTie and Cufflinks, respectively, combined with a 34.6 <italic>%</italic> higher precision than StringTie. Only GRIT and iReckon find a greater number of novel transcripts than CIDANE, but at the cost of a very low precision of 40– 42 <italic>%</italic> (vs 70 <italic>%</italic> for CIDANE) and a low sensitivity with respect to known transcripts (68 <italic>%</italic> GRIT vs 89 <italic>%</italic> CIDANE).</p>
      </sec>
      <sec id="Sec7">
        <title>Abundance estimation accuracy</title>
        <p>In addition to evaluating the absence and presence of true transcripts in the prediction, we compared the accuracy of the abundance estimation of CIDANE to existing methods. We restrict this analysis to set <italic>Annot</italic> (see previous section) to reduce the impact of the performance of isoform inference on the measure of abundance estimation quality. For every transcript in set <italic>Annot</italic>, we compared the predicted FPKM to the true FPKM calculated from the number of simulated paired-end reads. True transcripts that were not predicted by a method were considered as reconstructed with zero abundance. To reduce side effects on the abundance estimation due to very short transcripts, we limit the analysis to transcripts of length at least 500 bp (∼ 98.5 <italic>%</italic>).</p>
        <p>We observe similar Pearson correlation coefficients between true and predicted abundances for Cufflinks (0.96), GRIT (0.97), iReckon (0.98), and CIDANE (0.99), a slightly lower value of 0.91 for StringTie, and a much lower value of 0.31 for MITIE (see correlation plots in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5). To obtain a more detailed picture of the abundance estimation accuracy, we evaluated the relative error of predicted transcript abundances. Adopting the definition in [<xref ref-type="bibr" rid="CR28">28</xref>], the relative error for a transcript <italic>t</italic> with non-zero true abundance <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\theta _{t}^{*}$\end{document}</tex-math><mml:math id="M2"><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq1.gif"/></alternatives></inline-formula> and predicted abundance <italic>θ</italic><italic>t</italic>′ is defined as <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$|\theta _{t}^{*} - \theta _{t}'| / \theta _{t}^{*}$\end{document}</tex-math><mml:math id="M4"><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:mo>/</mml:mo><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq2.gif"/></alternatives></inline-formula>. For <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\theta _{t}^{*} = \theta _{t}' = 0$\end{document}</tex-math><mml:math id="M6"><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq3.gif"/></alternatives></inline-formula>, the relative error is zero and for <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\theta _{t}^{'} &gt; \theta _{t}^{*} = 0$\end{document}</tex-math><mml:math id="M8"><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo>&gt;</mml:mo><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq4.gif"/></alternatives></inline-formula>, the relative erroris <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\infty $\end{document}</tex-math><mml:math id="M10"><mml:mi>∞</mml:mi></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq5.gif"/></alternatives></inline-formula>.</p>
        <p>Figure <xref rid="Fig4" ref-type="fig">4</xref> displays the fraction of annotated transcripts (<italic>Annot</italic>) for which the predicted abundance has a relative error below a certain threshold. Besides iReckon with its very small error rates, CIDANE computes the most accurate estimates of expression levels. By running a tool developed specifically for the statistical estimation of abundances on the set of transcripts assembled by CIDANE, we expect a further improvement in accuracy. A known (or reconstructed) set of expressed transcripts allows for more involved statistical models that often operate, like iReckon’s expectation-maximization algorithm, at single-read resolution.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Fraction of correctly predicted expression of known isoforms (<italic>Annot</italic>) at different error thresholds</p></caption><graphic xlink:href="13059_2015_865_Fig4_HTML" id="MO4"/></fig></p>
      </sec>
      <sec id="Sec8">
        <title>Delayed recovery of transcripts</title>
        <p>In this benchmark, we demonstrate the capability of CIDANE to recover in phase II (see Fig. <xref rid="Fig1" ref-type="fig">1</xref>) isoforms containing splice junctions that are not supported by any read. Note that a junction between neighboring exons can also be supported (“covered”) by a read pair that maps to the two exons, even if none of the reads span the junction. From the ∼ 6300 transcripts expressed by the genes selected in the previous benchmark set, we simulated 2 million 75-bp read pairs. In all, 118 transcripts had at least one splice junction uncovered and are, therefore, invisible to any method that derives candidate transcripts from a splicing graph representation of the read alignments (see Section “<xref rid="Sec18" ref-type="sec">Candidate isoforms</xref>”). We note that this simulation neglects sequencing errors and any sequence-specific or positional fragment biases. Furthermore, the mapping of reads to known transcripts is less error-prone than the spliced mapping to a reference genome and, thus, the number of such invisible isoforms is expected to be larger in practice. As before, CIDANE is given only the known exon boundaries and the mapped reads as input. For performance reasons, the delayed generation of transcripts was applied only to genes containing at most 50 exons, covering more than 99 <italic>%</italic> of the genes. For larger genes, CIDANE outputs the initial solution returned by our regularized linear regression approach (phase I in Fig. <xref rid="Fig1" ref-type="fig">1</xref>).</p>
        <p>CIDANE successfully recovered ∼24.6 <italic>%</italic> of the invisible transcripts expressed in our simulated cellular transcriptome. StringTie, Cufflinks, MITIE, and IsoLasso (provided with exon boundaries) did not predict a single invisible isoform (as expected), while SLIDE recovered ∼ 5 <italic>%</italic>. In rare cases, SLIDE in fact considers candidates with uncovered junctions if otherwise only short candidates with at most two exons exist [<xref ref-type="bibr" rid="CR29">29</xref>]. We suspect that this strategy is one of the main causes for the very slow running time of SLIDE (see the next section).</p>
        <p>When provided with a partial annotation (<italic>Annot</italic>) as in the previous benchmark, iReckon and Cufflinks recovered only one and two isoforms, respectively, whereas CIDANE recovered 17 (∼ 40 <italic>%</italic>) out of 42 invisible transcripts not contained in set <italic>Annot</italic>. StringTie and MITIE again did not predict any invisible transcripts. For each of the three invisible isoforms recovered by iReckon and Cufflinks, the provided annotation (<italic>Annot</italic>) reveals the uncovered splice junction within an alternative isoform. Neither of the methods was able to reconstruct any uncovered novel splice junction.</p>
      </sec>
      <sec id="Sec9">
        <title>Running times</title>
        <p>CIDANE in basic mode (omitting phase II) took 29 min to assemble 80 million read pairs (75 bp), compared to 23 min and 42 min required by StringTie and IsoLasso, respectively. Considering the 2.5 hours TopHat2 took to align the reads, these methods do not constitute the bottleneck of this analysis pipeline. The remaining tools required between 1 hour (Cufflinks) and slightly more than 2 hours (CLASS and MITIE), except for SLIDE, which took more than 62 hours. CIDANE’s optional search for invisible transcripts in phase II requires an additional 42 min of computation. In contrast to methods like StringTie and Cufflinks, the current implementation of CIDANE’s optimization algorithm applied in phase I uses only one thread and can be further enhanced by multi-threading support. The running times of all tools on all five simulated data sets are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S6.</p>
      </sec>
    </sec>
    <sec id="Sec10">
      <title>Real human RNA-seq</title>
      <p>We illustrate key features of CIDANE on two human RNA-seq data sets from the ENCODE project [<xref ref-type="bibr" rid="CR21">21</xref>]. Besides the overall performance in terms of recall and precision, we demonstrate CIDANE’s capability to recover transcripts invisible to existing methods and its ability to exploit different levels of annotation to improve the assembly.</p>
      <p>The two strand-specific samples obtained from whole B cells in blood (GEO accession GSM981256) and CD14-positive monocytes (GSM984609) comprise 90 million and 120 million 76-bp paired-end reads, respectively, and were aligned using TopHat2. The same data sets were used in [<xref ref-type="bibr" rid="CR18">18</xref>] to assess StringTie’s performance and we apply, consistently with our other benchmarks, the same evaluation criteria as [<xref ref-type="bibr" rid="CR18">18</xref>]. We compared transcript predictions to a collection <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {H}$\end{document}</tex-math><mml:math id="M12"><mml:mi mathvariant="script">ℋ</mml:mi></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq6.gif"/></alternatives></inline-formula> of well-curated 171,904 transcripts in 41,409 protein-coding and noncoding genes that was created by the authors in [<xref ref-type="bibr" rid="CR18">18</xref>] by merging all annotated genes from databases RefSeq [<xref ref-type="bibr" rid="CR30">30</xref>], Ensembl [<xref ref-type="bibr" rid="CR31">31</xref>], and the UCSC Browser [<xref ref-type="bibr" rid="CR32">32</xref>]. Consistent with [<xref ref-type="bibr" rid="CR18">18</xref>], we included in the reference set (ground truth) all transcripts in <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {H}$\end{document}</tex-math><mml:math id="M14"><mml:mi mathvariant="script">ℋ</mml:mi></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq7.gif"/></alternatives></inline-formula> that had all internal exons and introns covered by (spliced) alignments. As in our other experiments, we considered a (presumably) expressed transcript in the reference set as successfully recovered if the sequence of introns matches perfectly. The precision is defined with respect to all annotated transcripts in <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {H}$\end{document}</tex-math><mml:math id="M16"><mml:mi mathvariant="script">ℋ</mml:mi></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq8.gif"/></alternatives></inline-formula>.</p>
      <sec id="Sec11">
        <title>Ab initio prediction</title>
        <p>In our ab initio experiment, only the TopHat2 alignments were provided to CIDANE, StringTie, Cufflinks, IsoLasso, MITIE, and CLASS. SLIDE’s excessive running time did not allow us to include it in the results below. CIDANE’s assembly algorithm was preceded by the algorithm developed in [<xref ref-type="bibr" rid="CR26">26</xref>] to detect exon boundaries from (spliced) alignments (for more details see Section “<xref rid="Sec14" ref-type="sec">Integrating real RNA-seq, CAGE, and PAS-seq</xref>”). GRIT and iReckon were not included in this benchmark since they both require TSSs and TESs to be provided.</p>
        <p>On both data sets, CIDANE reconstructed transcripts with significantly higher sensitivity than all competing methods, while at the same time producing the lowest number of false positive predictions (Fig. <xref rid="Fig5" ref-type="fig">5</xref><xref rid="Fig5" ref-type="fig">a</xref>, <xref rid="Fig5" ref-type="fig">b</xref>) and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S7). Compared to StringTie and Cufflinks, the two next most sensitive assemblers, CIDANE recovered 28.2 <italic>%</italic> and 81.1 <italic>%</italic> more transcripts expressed in the monocyte sample, and 29.7 <italic>%</italic> and 92.9 <italic>%</italic> more transcripts expressed in the blood sample. CIDANE’s improvement in recall over StringTie translates into an increase of 3412 (14,885 vs 11,473) and 3137 (14,254 vs 11,117) correctly predicted transcripts in the blood and monocyte samples, respectively. The generally low values in sensitivity and precision are due to alignments contributing to the coverage of multiple alternatively spliced isoforms in the definition of our reference set and an incomplete annotation of human transcripts. CIDANE (single-threaded) took 2 and 3.5 hours to assemble the blood and monocyte reads (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S6). Only StringTie (using up to 16 threads) was considerably faster. Again, following the analysis pipeline in [<xref ref-type="bibr" rid="CR18">18</xref>], the preceding alignment of 180 million (blood) and 240 million (monocyte) reads by TopHat2 required 14 and 20 hours, respectively, and constitutes the (computational) bottleneck in this analysis. Nevertheless, multi-threading support will further scale CIDANE’s performance since its core algorithms operate on each locus independently. Cufflinks, for example, achieved a tenfold speedup by using up to 16 threads. Experiments (not shown) on a more sparse formulation of our optimization model (“<xref rid="Sec16" ref-type="sec">Methods</xref>”, Eq. <xref rid="Equ1" ref-type="">1</xref>) did improve the running time, but only at the cost of accuracy.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Recall and precision on real human data. <bold>a</bold>, <bold>b</bold> Ab initio transcript predictions. Isolasso and MITIE with recall values of 5–8 % are omitted (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S7). <bold>c</bold>, <bold>d</bold> Recall and precision of annotation-guided assemblies by CIDANE. Ab initio predictions of CIDANE and StringTie shown as reference. In addition to read alignments, CIDANE employs information on exon boundary (<italic>E</italic>), gene boundary (<italic>G</italic>), TSS/TES (<italic>T</italic>), and exon junction (<italic>J</italic>). Same color of symbols indicates same number of augmentary information types</p></caption><graphic xlink:href="13059_2015_865_Fig5_HTML" id="MO5"/></fig></p>
      </sec>
      <sec id="Sec12">
        <title>Annotation-guided assembly</title>
        <p>Any ab initio prediction has to cope with the highly under-determined nature of the RNA-seq puzzle. Depending on the studied species and the specific biological question addressed by the RNA-seq experiment, additional information is often available that can guide the assembly and potentially improve the prediction. As for many well-studied model organisms, well-curated annotations describe the experimentally validated exon–intron structure of human genes. Known splice junctions, for example, are routinely used in the preceding alignment step to facilitate the spliced alignment across introns. Our experiments demonstrate (Fig. <xref rid="Fig5" ref-type="fig">5</xref><xref rid="Fig5" ref-type="fig">c</xref>, <xref rid="Fig5" ref-type="fig">d</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S8) that the transcript assembly itself can benefit from such an additional input too. Combined with a small gain in sensitivity, CIDANE’s precision increased by more than 40 <italic>%</italic> and 44 <italic>%</italic> in the blood and monocyte samples, respectively. Even employing exon boundary information alone without the donor–acceptor pairing can reduce the number of false positive transcript predictions considerably.</p>
        <p>However, not only an annotation can provide such valuable guidance. Native elongating transcript sequencing (NET-seq), for example, contains an explicit signal on the location of exon boundaries [<xref ref-type="bibr" rid="CR33">33</xref>]. Strong RNA polymerase II pausing at exon borders manifests in sharp peaks in NET-seq read coverage. Similarly, CAGE and PAS-seq can help to identify TSSs and TESs (see Section “<xref rid="Sec14" ref-type="sec">Integrating real RNA-seq, CAGE, and PAS-seq</xref>”). Consistent with our observations in Section “<xref rid="Sec14" ref-type="sec">Integrating real RNA-seq, CAGE, and PAS-seq</xref>”, information available on TSSs and TESs also significantly enhances CIDANE’s assembly of transcripts. If the biological question involves a known set of genes, for example, then gene boundary information prevents fragmentation and fusion of genes caused by missing and ambiguous read alignments, respectively, and thus, helps to improve significantly both the sensitivity and precision of CIDANE’s prediction. Not surprisingly, combining exon boundary, splice junction, gene boundary, or TSS and TES information yields even more accurate transcript reconstructions. At the extreme end of the spectrum, allowing CIDANE to exploit the full information content of the annotated transcriptome yields assemblies of the blood and monocyte reads that contain 10,883 (25,769 vs 14,886) and 14,724 (25,970 vs 14,246) more correctly discovered transcripts than CIDANE’s ab initio prediction, combined with a precision of around 80 <italic>%</italic>. Note that the latter mode of CIDANE does not only estimate the abundance of annotated transcripts. As in Section “<xref rid="Sec6" ref-type="sec">Transcript assembly with partial annotation</xref>”, CIDANE selects a subset of these transcripts that it believes are expressed and at the same time constructs novel isoforms not yet annotated.</p>
      </sec>
      <sec id="Sec13">
        <title>Recovering invisible transcripts</title>
        <p>In a real data set, it is impossible to distinguish invisible transcripts from transcripts in the curated set <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {H}$\end{document}</tex-math><mml:math id="M18"><mml:mi mathvariant="script">ℋ</mml:mi></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq9.gif"/></alternatives></inline-formula> that are simply not expressed. On the other hand, expressed transcripts that can be correctly identified in a given RNA-seq data set might be invisible in a lower coverage experiment. We, thus, design the experimental evaluation in this section in the reverse way. Starting from a set of (correctly) assembled transcripts <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {T}$\end{document}</tex-math><mml:math id="M20"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq10.gif"/></alternatives></inline-formula>, we uniformly subsample the set of all concordant read-pair alignments (genome-wide) using <italic>samtools</italic>, which renders a subset of transcripts in <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {T}$\end{document}</tex-math><mml:math id="M22"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq11.gif"/></alternatives></inline-formula> invisible. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S9 and S10 show the number of invisible transcripts for different fractions of sampled reads when the four initial sets of transcripts <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {T}$\end{document}</tex-math><mml:math id="M24"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq12.gif"/></alternatives></inline-formula> contain all transcripts that were correctly assembled by one of the four most accurate methods based on the full set of 180 million (blood) and 240 million (monocyte) read alignments, respectively. The numbers shown are conservative estimates of the true numbers of invisible transcripts. They do not include transcripts invisible in the full set of alignments and most methods filter the lowest-expressed transcripts for each gene, which would become invisible even if large fractions are sampled. Furthermore, invisible transcripts among false negative predictions are not taken into account either. Nevertheless, even in real RNA-seq data sets containing 54 million (blood) and 72 million (monocyte) reads, between 656 and 949 transcripts that were correctly assembled by StringTie or CIDANE from the full set of reads are invisible (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S9 and S10). More sensitive methods provide a more comprehensive set of transcripts <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {T}$\end{document}</tex-math><mml:math id="M26"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq13.gif"/></alternatives></inline-formula>, yielding a higher number of invisible transcripts <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {I}$\end{document}</tex-math><mml:math id="M28"><mml:mi mathvariant="script">I</mml:mi></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq14.gif"/></alternatives></inline-formula> as reads are removed.</p>
        <p>To investigate the utility of CIDANE’s delayed recovery of invisible transcripts, we do not rely on the prediction of any single method, but start from a high-confidence set of transcripts <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {T}$\end{document}</tex-math><mml:math id="M30"><mml:mi mathvariant="script">T</mml:mi></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq15.gif"/></alternatives></inline-formula> that contains all transcripts in the curated set <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {H}$\end{document}</tex-math><mml:math id="M32"><mml:mi mathvariant="script">ℋ</mml:mi></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq16.gif"/></alternatives></inline-formula> that were predicted by both StringTie and CIDANE, the two best-performing methods. As CIDANE and StringTie will agree mostly on highly expressed transcripts, we have to sample randomly fewer read alignments to obtain a reasonable number of invisible transcripts (last columns in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S9 and S10). Among loci that express transcripts with at least one splice junction uncovered by the 54 million (blood) and 72 million (monocyte) read alignments, CIDANE successfully recovers 21.4 <italic>%</italic> and 21.1 <italic>%</italic> of invisible transcripts, at a precision of 34.1 <italic>%</italic> and 31.6 <italic>%</italic>, respectively. CIDANE’s recall is just slightly lower than the one it achieves on the simulated data (see Section “<xref rid="Sec8" ref-type="sec">Delayed recovery of transcripts</xref>”), despite additional error sources in the real data sets. CIDANE recovers invisible transcripts (phase II) in the blood sample with a precision that is less than 3 percentage points lower than its precision in predicting visible transcripts (phase I) but even higher than the precision achieved by all competing methods on this less-challenging set of transcripts (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S7). Transcripts in the monocyte sample generally seem to be more difficult to reconstruct than in the blood sample. Invisible transcripts in the monocyte data set have a lower read coverage than in the blood data set (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S6).</p>
        <p>In Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S11 and S12, we show the results for the recovery of invisible transcripts for samples of size <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$20~\%, 30~\%, \dots,90~\%$\end{document}</tex-math><mml:math id="M34"><mml:mn>20</mml:mn><mml:mspace width="1em"/><mml:mi>%</mml:mi><mml:mo>,</mml:mo><mml:mn>30</mml:mn><mml:mspace width="1em"/><mml:mi>%</mml:mi><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>90</mml:mn><mml:mspace width="1em"/><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq17.gif"/></alternatives></inline-formula>. Overall, CIDANE performs better on larger samples. The smaller the fraction of sampled alignments, the lower the read coverage of invisible transcripts (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S6), which makes their recovery even harder. Similarly, relative expression has an impact on CIDANE’s ability to detect invisible transcripts. Among the 5 <italic>%</italic> highest expressed invisible transcripts in the monocyte sample, CIDANE recovered 39 <italic>%</italic>, while it reconstructed 10 <italic>%</italic> among the 20 <italic>%</italic> lowest expressed invisible transcripts (Fig. <xref rid="Fig6" ref-type="fig">6</xref><xref rid="Fig6" ref-type="fig">a</xref>). A similar pattern can be observed for different sampling fractions, except for large samples (≥70 <italic>%</italic>) of the monocyte fragments. There, the left tail of the distribution of their expression levels drops less sharply towards transcripts with extremely low read coverage (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S6b), and the small number of invisible transcripts (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S10) with estimated reference expression is prone to a higher variance.
<fig id="Fig6"><label>Fig. 6</label><caption><p>Performance of CIDANE’s delayed detection of invisible transcripts (phase II). <bold>a</bold> Fraction of invisible transcripts recovered among highest expressed 5 <italic>%</italic> (high), lowest expressed 20 <italic>%</italic> (low), and all remaining transcripts (med). <bold>b</bold> Recall/precision trade-off. The precision increases significantly for larger regularization penalties (option -rl), at the cost of a small decrease in recall</p></caption><graphic xlink:href="13059_2015_865_Fig6_HTML" id="MO6"/></fig></p>
        <p>Finally, we demonstrate the effect an adjusted regularization penalty in phase II (“<xref rid="Sec16" ref-type="sec">Methods</xref>”, threshold <italic>λ</italic> in Eq. <xref rid="Equ4" ref-type="">4</xref>) has on the recall/precision trade-off of CIDANE’s invisible transcript recovery (Fig. <xref rid="Fig6" ref-type="fig">6</xref><xref rid="Fig6" ref-type="fig">b</xref>). When increasing (in steps of 5 units) the multiplicative factor that controls the cost of transcripts generated in phase II (option -rl), the precision increases to up to 39 <italic>%</italic> (blood) and 36 <italic>%</italic> (monocyte), combined with a decrease in recall by less than 2 percentage points. Again, similar behavior can be observed for other sample sizes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S11 and S12).</p>
      </sec>
    </sec>
    <sec id="Sec14">
      <title>Integrating real RNA-seq, CAGE, and PAS-seq</title>
      <p>RNA-seq data provide an explicit signal for the detection of introns that is more informative than mere read coverage. Spliced alignments span splice junctions between exons and can be leveraged to infer splice donor and splice acceptor sites and thus, the boundary of internal exons. In contrast, the reconstruction of transcript boundaries, i.e., the TSS at the <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$5^{\prime }$\end{document}</tex-math><mml:math id="M36"><mml:msup><mml:mrow><mml:mn>5</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq18.gif"/></alternatives></inline-formula> end and the TES at the <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$3^{\prime }$\end{document}</tex-math><mml:math id="M38"><mml:msup><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq19.gif"/></alternatives></inline-formula> end, relies on a read coverage drop that is blurred by biases in the RNA-seq assay and is thus error-prone.</p>
      <p>The conceptual separation of (i) the discovery of exons and (ii) the assembly of exons into transcripts allows CIDANE to employ additional sources of information in both modules. Not only a comprehensive (yet incomplete) annotation available for most model organisms can guide tasks (i) and (ii) (see Sections “<xref rid="Sec6" ref-type="sec">Transcript assembly with partial annotation</xref>” and “<xref rid="Sec12" ref-type="sec">Annotation-guided assembly</xref>”), but additional gene boundary data can aid the interpretation of RNA-seq data [<xref ref-type="bibr" rid="CR26">26</xref>].</p>
      <p>By integrating <italic>Drosophila melanogaster</italic> RNA-seq, CAGE, and PAS-seq data, GRIT [<xref ref-type="bibr" rid="CR26">26</xref>] assembled transcripts with a considerably higher recall and precision than Cufflinks. CAGE and PAS-seq produce reads from the <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$5^{\prime }$\end{document}</tex-math><mml:math id="M40"><mml:msup><mml:mrow><mml:mn>5</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq20.gif"/></alternatives></inline-formula> ends and polyadenylation sites of mRNAs, respectively, and thus facilitate the mapping of TSSs and TESs. Since reconstructing transcripts from RNA-seq data alone is intrinsically underdetermined [<xref ref-type="bibr" rid="CR34">34</xref>], a mapped TSS/TES can reduce the search space significantly, particularly for complex loci, and this is, thus, expected to yield more accurate transcriptome predictions. In fact, experiments on simulated data performed in [<xref ref-type="bibr" rid="CR14">14</xref>] suggest the importance of TSS/TES information in transcript assembly.</p>
      <p>In this section, we demonstrate the superiority of our comprehensive transcript assembly approach on the integrated analysis of modENCODE RNA data, comprising stranded RNA-seq, CAGE, and PAS-seq data obtained from 20-day-old adult <italic>D. melanogaster</italic> heads [<xref ref-type="bibr" rid="CR26">26</xref>]. We reconstruct transcripts ab initio without relying on any elements of the annotation of the <italic>D. melanogaster</italic> genome. Instead, we compute exon and transcript boundaries using the boundary discovery procedure of GRIT. Exons and introns are identified by read coverage and spliced alignments, respectively. Gene regions then contain exons that are connected by introns. In addition to splice donor and splice acceptor sites, the TSS and TES are identified from read coverage peaks in the CAGE and PAS-seq data. For details, we refer the interested reader to the original description of the procedure in [<xref ref-type="bibr" rid="CR26">26</xref>].</p>
      <p>Candidate transcripts considered by CIDANE correspond to paths in the splicing graph (see Section “<xref rid="Sec18" ref-type="sec">Candidate isoforms</xref>”). Only paths from exons whose <inline-formula id="IEq21"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$5^{\prime }$\end{document}</tex-math><mml:math id="M42"><mml:msup><mml:mrow><mml:mn>5</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq21.gif"/></alternatives></inline-formula> boundary coincides with an identified TSS (and ends with a splice donor site) to exons whose <inline-formula id="IEq22"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$3^{\prime }$\end{document}</tex-math><mml:math id="M44"><mml:msup><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq22.gif"/></alternatives></inline-formula> boundary coincides with an identified TES (and begins with a splice acceptor site) are considered. Single-exon transcripts are bounded by an identified TSS and TES on the <inline-formula id="IEq23"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$5^{\prime }$\end{document}</tex-math><mml:math id="M46"><mml:msup><mml:mrow><mml:mn>5</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq23.gif"/></alternatives></inline-formula> and <inline-formula id="IEq24"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$3^{\prime }$\end{document}</tex-math><mml:math id="M48"><mml:msup><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq24.gif"/></alternatives></inline-formula> ends, respectively.</p>
      <p>We compared the performance of CIDANE, GRIT (latest version 1.1.2c), StringTie, and Cufflinks on four replicates, two male and two female (see [<xref ref-type="bibr" rid="CR26">26</xref>] or Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S13). In the experiments performed in [<xref ref-type="bibr" rid="CR26">26</xref>] on the same data sets, GRIT drastically outperformed annotation tools Scripture [<xref ref-type="bibr" rid="CR9">9</xref>] and Trinity+Rsem [<xref ref-type="bibr" rid="CR35">35</xref>] in terms of recall and precision. Here we apply the same evaluation criteria as in [<xref ref-type="bibr" rid="CR26">26</xref>] and thus, refrain from benchmarking CIDANE against tools Scripture and Trinity+Rsem. Like [<xref ref-type="bibr" rid="CR26">26</xref>], we assumed a FlyBase 5.45 [<xref ref-type="bibr" rid="CR36">36</xref>] transcript to be expressed in our sample if it is composed of a single exon or if otherwise every splice junction is supported by at least one read. Since transcripts contained in the resulting ground truth by definition had no uncovered splice junctions, we disabled the delayed transcript recovery mode (phase II in Fig. <xref rid="Fig1" ref-type="fig">1</xref>) of CIDANE. Applying the above criteria, between ∼ 8200 and ∼10,000 transcripts were expressed in each of the four <italic>D. melanogaster</italic> head samples.</p>
      <p>We considered an expressed transcript in the resulting ground truth as successfully recovered if the sequence of introns (intron chain) matches perfectly (same criteria as in Sections “<xref rid="Sec3" ref-type="sec">Isoform reconstruction from simulated data</xref>” and “<xref rid="Sec10" ref-type="sec">Real human RNA-seq</xref>”) and if optionally the transcript boundaries, i.e., TSS and TES, lie within 50 or 200 bp of each other. The precision is defined with respect to the set of all transcripts annotated in FlyBase.</p>
      <p>Figure <xref rid="Fig7" ref-type="fig">7</xref> depicts recall, precision, and <italic>F</italic> score achieved by Cufflinks, StringTie, GRIT, and CIDANE on the identically colored four replicates. Their precise coordinates are listed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S14, S15, and S16. As was done in [<xref ref-type="bibr" rid="CR26">26</xref>], we filtered transcripts predicted by GRIT with expression score lower bounds less than 1×10<sup>−6</sup> estimated FPKM at a marginal 99 <italic>%</italic> significance level.
<fig id="Fig7"><label>Fig. 7</label><caption><p>Recall and precision of transcript prediction by Cufflinks, StringTie, GRIT, and CIDANE from integrated RNA data. Different thresholds in TSS/TES accuracy are applied in the true positive definition. <bold>a</bold> 50-bp TSS/TES tolerance. <bold>b</bold> 200-bp TSS/TES tolerance. <bold>c</bold> Intron chain prediction</p></caption><graphic xlink:href="13059_2015_865_Fig7_HTML" id="MO7"/></fig></p>
      <p>Figure <xref rid="Fig7" ref-type="fig">7</xref><xref rid="Fig7" ref-type="fig">a</xref>, <xref rid="Fig7" ref-type="fig">b</xref> takes into account the accuracy of transcript boundaries with different tolerances. If the predicted and annotated TSS/TES are required to lie within 50 bp of each other (Fig. <xref rid="Fig7" ref-type="fig">7</xref><xref rid="Fig7" ref-type="fig">a</xref>), the lack of read data on the <inline-formula id="IEq25"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$5^{\prime }$\end{document}</tex-math><mml:math id="M50"><mml:msup><mml:mrow><mml:mn>5</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq25.gif"/></alternatives></inline-formula> ends and polyadenylation sites of mRNAs results in a significantly poorer performance of StringTie and Cufflinks compared to GRIT. Employing the same amount of data as GRIT, however, CIDANE achieves a recall of ∼ 29– 31 <italic>%</italic>, compared to ∼ 15– 21 <italic>%</italic> for GRIT, combined with a slightly higher precision. Utilizing the additional CAGE and PAS-seq data, CIDANE reconstructs transcripts with around threefold to eightfold higher precision than StringTie and fourfold to 12-fold higher precision than Cufflinks. If we relax the TSS/TES tolerance to 200 bp (Fig. <xref rid="Fig7" ref-type="fig">7</xref><xref rid="Fig7" ref-type="fig">b</xref>), GRIT’s prediction profits from the additional CAGE and PAS-seq data mostly in terms of precision. Again, CIDANE manages to reconstruct substantially more transcripts than GRIT, combined with a slightly higher precision. CIDANE’s gain in precision over StringTie and Cufflinks ranges from about twofold to sixfold.</p>
      <p>Figure <xref rid="Fig7" ref-type="fig">7</xref><xref rid="Fig7" ref-type="fig">c</xref> neglects the accuracy of transcript boundaries. CIDANE (<italic>f</italic>≥0.51) combines the superior precision of GRIT (<italic>f</italic>≥0.33) with the superior recall of Cufflinks (<italic>f</italic>≥0.27) and StringTie (<italic>f</italic>≥0.29) and achieves overall the highest <italic>F</italic> score. Note that the recall values of StringTie and Cufflinks shown in Fig. <xref rid="Fig7" ref-type="fig">7</xref><xref rid="Fig7" ref-type="fig">c</xref> count annotated transcripts as true positive hits even if there is no evidence for their expression in the CAGE and PAS-seq data. In each analysis, the transcriptome predictions of GRIT and CIDANE are based on the exact same mapping of exons, introns, TSS, and TES. The superiority of our approach results entirely from a more coherent assembly of exons into transcripts.</p>
      <p>Concerning the efficiency, CIDANE and StringTie ran for less than 12 and 6 minutes per sample, respectively, while GRIT (allowing up to 16 threads) took ∼ 3 h of computation, including the discovery of exon and transcript boundaries. Cufflinks required slightly more than 1 h of computation per sample.</p>
    </sec>
  </sec>
  <sec id="Sec15" sec-type="conclusion">
    <title>Conclusion</title>
    <p>We present CIDANE, which provides major improvements in cellular transcriptome reconstruction from RNA-seq over existing assembly tools. Through a carefully chosen trade-off between model complexity and tractability of the resulting optimization problem, and by applying state-of-the-art algorithmic techniques, CIDANE builds full-length transcript models from short sequencing reads with higher recall and precision than was possible before. CIDANE is engineered not only to assemble RNA-seq reads ab initio, but also to make use of the growing annotation of known splice sites, TSSs and TESs, or even full-length transcripts, available for most model organisms. Our experiments show that CIDANE’s core algorithmic engine yields more accurate transcriptome reconstructions than competing tools, in all these different scenarios and under various realistic experimental designs. Along the same lines, CIDANE can employ additional gene boundary data to guide the assembly, thereby improving the precision of the reconstruction significantly.</p>
    <p>To some extent, phase II of CIDANE allows us to recover splice junctions that are invisible to all existing approaches. Such junctions are not supported by any read alignment and can be observed predominantly among low-expressed transcripts. While CIDANE in basic mode (phase II omitted) reconstructs a human cellular transcriptome from 80 million aligned read pairs in 29 min, the recovery of invisible junctions is a more complex task. For genes larger than 50 exons, the iterative determination of invisible transcripts might become too expensive in practice and is disabled by default in our current implementation. Future work on the fixed-parameter tractability of the heaviest isoform problem might allow us to push the limits even further.</p>
    <p>We expect that CIDANE will provide biologists with accurate transcript predictions from the very large, complex data sets that currently emerge from RNA-seq experiments. Such a high-resolution RNA-seq data interpretation is essential for any type of downstream analysis and will help to expand the catalog of genes and their splice variants.</p>
    <p>CIDANE is free open-source software released under the GNU GPL license, and has been developed and tested on a Linux x86_64 system. CIDANE’s source is available from <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/canzar/cidane">https://bitbucket.org/canzar/cidane</ext-link>.</p>
  </sec>
  <sec id="Sec16">
    <title>Methods</title>
    <p>In this work, we assume mRNA fragments to be sequenced from both ends, yielding <italic>paired-end reads</italic>. Nonetheless, all results trivially apply to single-end reads. For each locus, identified as connected components of read mappings, CIDANE reconstructs isoforms from RNA-seq data in three phases (Fig. <xref rid="Fig8" ref-type="fig">8</xref>). First (Section “<xref rid="Sec17" ref-type="sec">Phase I: regularized linear regression</xref>”), a linear model is fitted (Fig. <xref rid="Fig8" ref-type="fig">8</xref><xref rid="Fig8" ref-type="fig">c</xref>) to a compact representation of the observed read mappings (Fig. <xref rid="Fig8" ref-type="fig">8</xref><xref rid="Fig8" ref-type="fig">a</xref>) using a set of fully supported candidate transcripts (Fig. <xref rid="Fig8" ref-type="fig">8</xref><xref rid="Fig8" ref-type="fig">b</xref>). Here, our approach differs from existing methods mainly in (i) carefully designed regression coefficients that model (like SLIDE) the distribution of reads along a transcript and in (ii) applying a state-of-the-art machine-learning algorithm to balance the accuracy of the prediction and the number of isoforms assigned a non-zero expression level.
<fig id="Fig8"><label>Fig. 8</label><caption><p>Schematic diagram illustrating CIDANE’s work flow. In the first phase, a linear model is fitted (<italic>black line</italic> in <bold>c</bold>) to a compact representation of the observed read mappings (<bold>a</bold>) using an initial set <italic>T</italic>
<sub>init</sub> of candidate transcripts (<bold>b</bold>). Second, transcripts not in <italic>T</italic>
<sub>init</sub> that can help to improve the prediction are iteratively identified as optimal solutions to the heaviest isoform problem (<bold>d</bold>). The newly constructed isoform (<bold>e</bold>) is used to adjust the fitting (<italic>orange line</italic> in <bold>c</bold>)</p></caption><graphic xlink:href="13059_2015_865_Fig8_HTML" id="MO8"/></fig></p>
    <p>In a second phase (Section “<xref rid="Sec20" ref-type="sec">Phase II: delayed generation of improving isoforms</xref>”), CIDANE explores the space of transcripts that is neglected by existing methods due to computational challenges. To identify iteratively such a transcript that can help to improve the current prediction, we have to solve a problem (Fig. <xref rid="Fig8" ref-type="fig">8</xref><xref rid="Fig8" ref-type="fig">d</xref>) that we formalize as the heaviest isoform problem. If the heaviest isoform does not improve the current prediction, CIDANE is guaranteed to have found the best possible set of isoforms without having explicitly enumerated all potential isoforms in the exponentially large space. Otherwise, the newly constructed isoform (Fig. <xref rid="Fig8" ref-type="fig">8</xref><xref rid="Fig8" ref-type="fig">e</xref>) can be used to adjust our fitting.</p>
    <p>Although we show that heaviest isoform problem is NP-complete, we propose an integer linear programming (ILP) formulation that exploits certain properties of RNA-seq data and (optionally) known splicing characteristics that allow for the efficient solution of the ILP. For example, only a few combinations of exons enclosed by two mapped read mates are typically consistent with an estimated fragment length distribution, yielding a small number of variables in our formulation. Furthermore, we (optionally) disregard transcripts whose alternative promoter and polyadenylation sites coincide with acceptor and donor sites of internal exons, since signals read by the transcription and splicing mechanism to identify start (end) sites and acceptor (donor) sites differ significantly. Note that this restriction is conceptually equivalent to considering only <italic>maximal</italic> paths in the splicing graph as candidates, as is done by current methods. CIDANE, however, tries to restore maximal paths that are broken due to uncovered splice junctions. At the same time, the flexibility of an ILP formulation allows CIDANE to incorporate additional data or knowledge concerning, for instance, exon boundaries, intron retentions, TSSs, and TESs.</p>
    <p>The prediction is fine-tuned (Section “<xref rid="Sec25" ref-type="sec">Phase III: fine-tuning and post-processing</xref>”) by refitting the linear model using the initial set of candidate transcripts augmented by all improving transcripts identified in the second phase of CIDANE. Finally, the expression levels of the reconstructed transcripts are re-estimated and converted into FPKM in a post-processing phase (Section “<xref rid="Sec25" ref-type="sec">Phase III: fine-tuning and post-processing</xref>”).</p>
    <sec id="Sec17">
      <title>Phase I: regularized linear regression</title>
      <p>Like count-based methods such as SLIDE and IsoLasso, we summarize the observed read mappings into <italic>segment covers</italic> (Fig. <xref rid="Fig8" ref-type="fig">8</xref><xref rid="Fig8" ref-type="fig">a</xref>). Instead of trying to explain each read mapping with its precise genomic coordinates, we count the number of reads that fall into non-ambiguously connected segments of the genome. <italic>Segments</italic> in <inline-formula id="IEq26"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {S}$\end{document}</tex-math><mml:math id="M52"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq26.gif"/></alternatives></inline-formula> represent minimal exon fragments that are covered by reads and bounded by splice sites, TSSs, or TESs (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S7), derived from spliced alignments, extracted from a set of gene annotations, or supported by additional data. For sequences of segments <inline-formula id="IEq27"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {s}_{i}$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq27.gif"/></alternatives></inline-formula> and <inline-formula id="IEq28"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {s}'_{i}$\end{document}</tex-math><mml:math id="M56"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq28.gif"/></alternatives></inline-formula>, a <italic>segment cover</italic><inline-formula id="IEq29"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$c_{i}=(\bar {s}_{i},\bar {s}'_{i},b_{i})$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq29.gif"/></alternatives></inline-formula> then counts the number <italic>b</italic><sub><italic>i</italic></sub> of read pairs <italic>r</italic>=(<italic>r</italic><sub>1</sub>,<italic>r</italic><sub>2</sub>) where <italic>r</italic><sub>1</sub> and <italic>r</italic><sub>2</sub> map with a <italic>signature</italic> consistent with <inline-formula id="IEq30"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {s}_{i}$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq30.gif"/></alternatives></inline-formula> and <inline-formula id="IEq31"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {s}'_{i}$\end{document}</tex-math><mml:math id="M62"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq31.gif"/></alternatives></inline-formula>, respectively; i.e., the mapping of <italic>r</italic><sub>1</sub> (<italic>r</italic><sub>2</sub>) spans precisely the set of segment boundaries that are implied by <inline-formula id="IEq32"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {s}_{i}$\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq32.gif"/></alternatives></inline-formula> (<inline-formula id="IEq33"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {s}'_{i}$\end{document}</tex-math><mml:math id="M66"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq33.gif"/></alternatives></inline-formula>) (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S8). <italic>Faux segment covers</italic><inline-formula id="IEq34"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$(\bar {s}_{j},\bar {s}'_{j},0)$\end{document}</tex-math><mml:math id="M68"><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq34.gif"/></alternatives></inline-formula> indicate that the corresponding combination of segments was <italic>not</italic> observed in the read data and can help to identify false positive predictions. We denote the set of segment covers, including faux covers (see Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Section 1), by <inline-formula id="IEq35"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {C}$\end{document}</tex-math><mml:math id="M70"><mml:mi mathvariant="script">C</mml:mi></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq35.gif"/></alternatives></inline-formula>.</p>
      <sec id="Sec18">
        <title>Candidate isoforms</title>
        <p>We derive the initial set of candidate isoforms <italic>T</italic> (Fig. <xref rid="Fig8" ref-type="fig">8</xref><xref rid="Fig8" ref-type="fig">b</xref>) used to explain the observations (segment covers) as paths in a <italic>splicing graph</italic> [<xref ref-type="bibr" rid="CR37">37</xref>]. Nodes in a splicing graph correspond to segments <inline-formula id="IEq36"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {S}$\end{document}</tex-math><mml:math id="M72"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq36.gif"/></alternatives></inline-formula> and edges connect exon fragments whose consecutivity is indicated by (spliced) alignments. Under the assumption that every splice junction of every expressed isoform is covered by at least one mapped read, every expressed (true) transcript is among the paths in the splicing graph. For a formal specification of a splicing graph as employed in CIDANE, see Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Section 2.</p>
        <p>We further define sets <inline-formula id="IEq37"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {TSS}$\end{document}</tex-math><mml:math id="M74"><mml:mi mathvariant="script">T</mml:mi><mml:mi mathvariant="script">S</mml:mi><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq37.gif"/></alternatives></inline-formula> and <inline-formula id="IEq38"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {PAS}$\end{document}</tex-math><mml:math id="M76"><mml:mi mathvariant="script">P</mml:mi><mml:mi mathvariant="script">A</mml:mi><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq38.gif"/></alternatives></inline-formula>, which contain potential TSSs and TESs, respectively. These sets can be compiled from annotated TSSs and polyadenylation sites, additional read data from the <inline-formula id="IEq39"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$5^{\prime }$\end{document}</tex-math><mml:math id="M78"><mml:msup><mml:mrow><mml:mn>5</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq39.gif"/></alternatives></inline-formula> ends and polyadenylation sites of mRNAs (see Section “<xref rid="Sec14" ref-type="sec">Integrating real RNA-seq, CAGE, and PAS-seq</xref>”), or purely from read mapping data. The latter is based on an exclusion principle. We do not allow for transcripts whose alternative promoter or polyadenylation sites coincide with acceptor and donor sites of internal exons and thus, exclude all segments with spliced alignments supporting their <inline-formula id="IEq40"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$5^{\prime }$\end{document}</tex-math><mml:math id="M80"><mml:msup><mml:mrow><mml:mn>5</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq40.gif"/></alternatives></inline-formula> or <inline-formula id="IEq41"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$3^{\prime }$\end{document}</tex-math><mml:math id="M82"><mml:msup><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq41.gif"/></alternatives></inline-formula> end from <inline-formula id="IEq42"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {TSS}$\end{document}</tex-math><mml:math id="M84"><mml:mi mathvariant="script">T</mml:mi><mml:mi mathvariant="script">S</mml:mi><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq42.gif"/></alternatives></inline-formula> and <inline-formula id="IEq43"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {PAS}$\end{document}</tex-math><mml:math id="M86"><mml:mi mathvariant="script">P</mml:mi><mml:mi mathvariant="script">A</mml:mi><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq43.gif"/></alternatives></inline-formula>, respectively. This exclusion strategy is equivalent to considering only <italic>maximal</italic> paths in the graph, as is done by current methods, and can easily be relaxed in CIDANE by setting <inline-formula id="IEq44"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {TSS}:=\mathcal {S}$\end{document}</tex-math><mml:math id="M88"><mml:mi mathvariant="script">T</mml:mi><mml:mi mathvariant="script">S</mml:mi><mml:mi mathvariant="script">S</mml:mi><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq44.gif"/></alternatives></inline-formula> and <inline-formula id="IEq45"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {PAS}:=\mathcal {S}$\end{document}</tex-math><mml:math id="M90"><mml:mi mathvariant="script">P</mml:mi><mml:mi mathvariant="script">A</mml:mi><mml:mi mathvariant="script">S</mml:mi><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq45.gif"/></alternatives></inline-formula>.</p>
        <p>The set of candidate isoforms among which we select our initial prediction is then obtained by enumerating all (or a preselected set of) paths in the splicing graph that start at a segment in <inline-formula id="IEq46"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {TSS}$\end{document}</tex-math><mml:math id="M92"><mml:mi mathvariant="script">T</mml:mi><mml:mi mathvariant="script">S</mml:mi><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq46.gif"/></alternatives></inline-formula> and end at a segment in <inline-formula id="IEq47"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {PAS}$\end{document}</tex-math><mml:math id="M94"><mml:mi mathvariant="script">P</mml:mi><mml:mi mathvariant="script">A</mml:mi><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq47.gif"/></alternatives></inline-formula>.</p>
      </sec>
      <sec id="Sec19">
        <title>Model fitting</title>
        <p>We apply a linear model (Fig. <xref rid="Fig8" ref-type="fig">8</xref><xref rid="Fig8" ref-type="fig">c</xref>) to estimate the number of reads originating from segments of the genome. Assuming that every position of an expressed transcript is equally likely chosen as a starting position of a sequenced RNA fragment, we model the expected number of fragments mapping to segment cover <italic>c</italic>=(<italic>s</italic>,<italic>s</italic><sup>′</sup>,<italic>b</italic>) as <inline-formula id="IEq48"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sum _{t\in T} \ell _{t,c} \theta _{t}$\end{document}</tex-math><mml:math id="M96"><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq48.gif"/></alternatives></inline-formula>, where <italic>ℓ</italic><sub><italic>t</italic>,<italic>c</italic></sub> is the expected number of starting positions of fragments obtained from transcript <italic>t</italic> that show a mapping signature consistent with <italic>c</italic>. The expression level <italic>θ</italic><sub><italic>t</italic></sub> of transcript <italic>t</italic> counts the expected number of mapped fragments per transcript base, which is converted to FPKM at a later stage (Section “<xref rid="Sec25" ref-type="sec">Phase III: fine-tuning and post-processing</xref>”). <italic>ℓ</italic><sub><italic>t</italic>,<italic>c</italic></sub> depends on the length of segments in <inline-formula id="IEq49"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {s}$\end{document}</tex-math><mml:math id="M98"><mml:mover accent="true"><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq49.gif"/></alternatives></inline-formula> and <inline-formula id="IEq50"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {s}'$\end{document}</tex-math><mml:math id="M100"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq50.gif"/></alternatives></inline-formula>, the length of segments in <italic>t</italic> enclosed by <italic>s</italic> and <italic>s</italic><sup>′</sup>, the read length, and the cDNA fragment length distribution. Equations defining <italic>ℓ</italic><sub><italic>t</italic>,<italic>c</italic></sub> as used in our model are given in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Section 3. In contrast, methods like TRAPH [<xref ref-type="bibr" rid="CR12">12</xref>], MITIE, and IsoInfer/IsoLasso define coefficients <italic>ℓ</italic><sub><italic>c</italic></sub> that neglect the dependence on transcripts <italic>t</italic>. Note that the distribution of reads along a transcript is generally not uniform, but typically unknown. The same applies to all the experimental data used in this study. Any prior knowledge concerning the likelihood of starting positions can be incorporated into our model through adjusted <italic>ℓ</italic><sub><italic>t</italic>,<italic>c</italic></sub> coefficients.</p>
        <p>We employ the sum of squared errors (i.e., differences between estimated and observed number of reads) as a measure of accuracy of our prediction, weighted by an estimator for the variance of observations <italic>b</italic> [<xref ref-type="bibr" rid="CR14">14</xref>]. Fitting our model using all candidate transcripts would allow us to fit noise in the data by predicting a large number of isoforms with low but non-zero expression levels. Since in a given cell type really only a small subset of candidate transcripts is expressed, our approach seeks a sparse set of expressed isoforms by augmenting, like SLIDE and IsoLasso, the objective by the <italic>L</italic><sup>1</sup> norm of the isoform abundances. Our (initial) prediction <italic>θ</italic>≥0 comprises all transcripts with non-zero expression level in the optimal solution to 
<disp-formula id="Equ1"><label>(1)</label><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \min_{\theta\geq 0} \sum_{\substack{c=(\bar{s},\bar{s}',b): \\ c \in \mathcal{C}}} \left(\frac{b-\sum_{t\in T}{\ell_{t,c}\theta_{t}}}{\sqrt{\max\{\epsilon,b\}}}\right)^{2} + \lambda \sum_{t \in T} \theta_{t}  $$ \end{document}</tex-math><mml:math id="M102"><mml:munder><mml:mrow><mml:mo>min</mml:mo></mml:mrow><mml:mrow><mml:mi>θ</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mtable rowspacing="0"><mml:mtr><mml:mtd><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>)</mml:mo><mml:mo>:</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>c</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">C</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mo>max</mml:mo><mml:mo>{</mml:mo><mml:mi>ε</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="13059_2015_865_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>For faux covers, we replace <italic>b</italic>=0 by <italic>ε</italic> (default <italic>ε</italic>=1). This so-called <italic>Lasso</italic> regression <italic>selects</italic> isoforms by setting the expression levels of all other transcripts to zero one at a time with increasing penalty terms <italic>λ</italic>.</p>
        <p>The overall quality of the prediction crucially depends on the right choice of the regularization parameter <italic>λ</italic>. In contrast to previous methods, we balance the relative importance of the accuracy of the prediction and its simplicity (number of transcripts with non-zero expression level) based on the entire path of values for <italic>λ</italic>. As the coefficient path is piecewise linear, the entire regularization path can be computed at the cost of a single least-squares fit [<xref ref-type="bibr" rid="CR38">38</xref>]. We apply a coordinate descent algorithm implemented in the glmnet Fortran code [<xref ref-type="bibr" rid="CR39">39</xref>], that cyclically optimizes, for a given <italic>λ</italic>, each isoform abundance separately, holding all other abundances fixed. Update operations (inner products) directly profit from our sparse matrix of <italic>ℓ</italic><sub><italic>t</italic>,<italic>c</italic></sub> values (see Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Section 3). Furthermore, considering a sequence of decreasing values for <italic>λ</italic> exploits estimates at previous <italic>λ</italic>’s as a warm start. After having computed the entire path of values for <italic>λ</italic>, our initial prediction is obtained from the optimal solution to Eq. <xref rid="Equ1" ref-type="">1</xref> for the value of <italic>λ</italic> that yields the best <italic>adjusted</italic><italic>R</italic><sup>2</sup> score. The adjusted <italic>R</italic><sup>2</sup> adjusts the goodness of fit (<italic>R</italic><sup>2</sup>) for the number of isoforms used. If CIDANE is provided with a partial annotation of the transcriptome of an organism, the higher confidence in annotated transcripts is modeled by scaling the regularization penalties <italic>λ</italic> assigned to unknown transcripts by a factor of <italic>γ</italic> (default <italic>γ</italic>=2).</p>
      </sec>
    </sec>
    <sec id="Sec20">
      <title>Phase II: delayed generation of improving isoforms</title>
      <p>The aim of the second phase of CIDANE is to recover isoforms with uncovered splice junctions (invisible transcripts) that are not included in the candidate set of the regularized least-squares regression due to their possibly very large number. We employ a delayed column generation technique [<xref ref-type="bibr" rid="CR20">20</xref>] to identify new candidate isoforms that improve the optimal solution of the regularized least-squares regression without exhaustive enumeration of all possible candidates. Particularly suited for large-scale linear programs, we formulate a piecewise-linear approximation (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Section 4) of the following quadratic program that is equivalent to the regularized least-squares objective function, Eq. <xref rid="Equ1" ref-type="">1</xref>: 
<disp-formula id="Equ2"><label>(2)</label><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \min&amp;&amp;\sum_{c_{i}\in \mathcal{C}} \left(\frac{e_{i}}{\sqrt{\max\{\epsilon,b_{i}\}}}\right)^{2}&amp; + \lambda \sum_{t \in T} \theta_{t}  \end{array} $$ \end{document}</tex-math><mml:math id="M104"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mo>min</mml:mo></mml:mtd><mml:mtd><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="script">C</mml:mi></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mo>max</mml:mo><mml:mo>{</mml:mo><mml:mi>ε</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2015_865_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>
        <disp-formula id="Equ3">
          <label>(3)</label>
          <alternatives>
            <tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \text{s.t.}&amp;&amp;\sum_{t\in T}{\ell_{t,c_{i}}\theta_{t}}+ e_{i} &amp;= b_{i}, &amp;&amp;\forall c_{i}\in \mathcal{C} \end{array} $$ \end{document}</tex-math>
            <mml:math id="M106">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:mtext>s.t.</mml:mtext>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:munder>
                      <mml:mrow>
                        <mml:mo mathsize="big">∑</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>t</mml:mi>
                        <mml:mo>∈</mml:mo>
                        <mml:mi>T</mml:mi>
                      </mml:mrow>
                    </mml:munder>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>ℓ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>t</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>c</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:msub>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>θ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>t</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>+</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>e</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mo>=</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>b</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="-13.99652pt"/>
                    <mml:mo>∀</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>c</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>∈</mml:mo>
                    <mml:mi mathvariant="script">C</mml:mi>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
            <graphic xlink:href="13059_2015_865_Article_Equ3.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p><inline-formula id="IEq51"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\theta \in \mathbb R^{|T|}_{+}$\end{document}</tex-math><mml:math id="M108"><mml:mi>θ</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>T</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq51.gif"/></alternatives></inline-formula> is the vector of transcript abundances, and <inline-formula id="IEq52"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$e\in \mathbb R^{|\mathcal {C}|}$\end{document}</tex-math><mml:math id="M110"><mml:mi>e</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi mathvariant="script">C</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq52.gif"/></alternatives></inline-formula> denotes the vector of errors, i.e., differences between estimated and observed read counts per segment cover. The generation of columns (i.e., variables <italic>θ</italic><sub><italic>t</italic></sub>) is then accomplished by means of an ILP formulation presented below. In the following, we let <inline-formula id="IEq53"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$m:=|\mathcal {C}|$\end{document}</tex-math><mml:math id="M112"><mml:mi>m</mml:mi><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="script">C</mml:mi><mml:mo>|</mml:mo></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq53.gif"/></alternatives></inline-formula> be the number of segment covers falling into the considered locus and we let <bold>A</bold> be the corresponding coefficient matrix of constraints, Eq. <xref rid="Equ3" ref-type="">3</xref>. Since the number of transcripts a gene can potentially encode grows exponentially with the number of its exons, constructing matrix <bold>A</bold> in full is impractical, even for comparatively small genes. Rather, we consider a restricted problem that contains only a small subset of all possible transcripts, represented by the <italic>θ</italic> variables, and generate novel isoforms, i.e., columns of <italic>A</italic>, as needed to improve the overall prediction.</p>
      <p>To identify an isoform that can help to improve the prediction in terms of objective Eq. <xref rid="Equ2" ref-type="">2</xref>, Dantzig’s simplex method [<xref ref-type="bibr" rid="CR20">20</xref>] requires the determination of a variable (transcript) <inline-formula id="IEq54"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\theta _{t_{j}}$\end{document}</tex-math><mml:math id="M114"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq54.gif"/></alternatives></inline-formula> with negative reduced cost <inline-formula id="IEq55"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {c}_{j}=\lambda -\mathbf {p}^{T}\mathbf {A}_{j}$\end{document}</tex-math><mml:math id="M116"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>λ</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq55.gif"/></alternatives></inline-formula>, where <bold>p</bold> is the vector of simplex multipliers and <bold>A</bold><sub><italic>j</italic></sub> is the column of <bold>A</bold> representing transcript <italic>t</italic><sub><italic>j</italic></sub>.</p>
      <p>Instead of computing the reduced cost associated with every possible transcript <italic>t</italic><sub><italic>j</italic></sub>, we consider the problem of minimizing <inline-formula id="IEq56"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$(\lambda -\mathbf {p}^{T}\mathbf {A}_{j})$\end{document}</tex-math><mml:math id="M118"><mml:mo>(</mml:mo><mml:mi>λ</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq56.gif"/></alternatives></inline-formula> over all <italic>t</italic><sub><italic>j</italic></sub>, or equivalently, the problem of maximizing <inline-formula id="IEq57"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathbf {p}^{T}\mathbf {A}_{j}$\end{document}</tex-math><mml:math id="M120"><mml:msup><mml:mrow><mml:mi mathvariant="bold">p</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq57.gif"/></alternatives></inline-formula> over all transcripts <italic>t</italic><sub><italic>j</italic></sub>. According to constraint Eq. <xref rid="Equ3" ref-type="">3</xref>, for every 1≤<italic>i</italic>≤<italic>m</italic>, entry <italic>i</italic> of column <bold>A</bold><sub><italic>j</italic></sub> has value <inline-formula id="IEq58"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$ \ell _{t_{j},c_{i}}$\end{document}</tex-math><mml:math id="M122"><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq58.gif"/></alternatives></inline-formula>. The task is, therefore, to find a transcript <italic>t</italic><sub><italic>j</italic></sub> such that 
<disp-formula id="Equ4"><label>(4)</label><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \sum_{c_{i} \in \mathcal{C}}(p_{i} \ell_{t_{j},c_{i}})&gt;\lambda.  $$ \end{document}</tex-math><mml:math id="M124"><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="script">C</mml:mi></mml:mrow></mml:munder><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>&gt;</mml:mo><mml:mi>λ.</mml:mi></mml:math><graphic xlink:href="13059_2015_865_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>If no such transcript exists, all reduced costs are nonnegative and the current solution is optimal. Next, we model this optimization problem as a variant of the heaviest induced subgraph problem [<xref ref-type="bibr" rid="CR40">40</xref>] and propose an ILP formulation. For ease of notation, here we only consider the case where reads span single exons. For the general case of reads spanning an arbitrary number of exons, we refer the reader to Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Section 5. Consider graph <italic>G</italic>=(<italic>V</italic>,<italic>E</italic>) that contains one vertex for each exon of a locus. We assume that the exons are numbered from left to right from 1 to <italic>n</italic> and identify each vertex by the corresponding exon number. We identify each segment cover <inline-formula id="IEq59"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$(\bar {s},\bar {s}',b)$\end{document}</tex-math><mml:math id="M126"><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq59.gif"/></alternatives></inline-formula> with single-exon sequences <inline-formula id="IEq60"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {s}=\langle i \rangle $\end{document}</tex-math><mml:math id="M128"><mml:mover accent="true"><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mo>〈</mml:mo><mml:mi>i</mml:mi><mml:mo>〉</mml:mo></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq60.gif"/></alternatives></inline-formula>, <inline-formula id="IEq61"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {s}'=\langle j \rangle $\end{document}</tex-math><mml:math id="M130"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>〈</mml:mo><mml:mi>j</mml:mi><mml:mo>〉</mml:mo></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq61.gif"/></alternatives></inline-formula> by (<italic>i</italic>,<italic>j</italic>,<italic>b</italic>) and include an edge <italic>e</italic>=(<italic>i</italic>,<italic>j</italic>) in <italic>E</italic>. For each edge <italic>e</italic>∈<italic>E</italic> we denote by <inline-formula id="IEq62"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {V}(e)$\end{document}</tex-math><mml:math id="M132"><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mi>e</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq62.gif"/></alternatives></inline-formula> the set of vertices whose associated exons lie between the exons given by segments <italic>i</italic> and <italic>j</italic>, i.e., <inline-formula id="IEq63"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {V}(e):=\{k\in V: i&lt; k &lt; j\}$\end{document}</tex-math><mml:math id="M134"><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mi>e</mml:mi><mml:mo>)</mml:mo><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mi>V</mml:mi><mml:mo>:</mml:mo><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq63.gif"/></alternatives></inline-formula>. We assign to each edge <italic>e</italic>∈<italic>E</italic> a weight function <inline-formula id="IEq64"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$w_{e}: \mathcal {P}(\bar {V}(e))\mapsto \mathbb {R}$\end{document}</tex-math><mml:math id="M136"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mi mathvariant="script">P</mml:mi><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mi>e</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>↦</mml:mo><mml:mi>ℝ</mml:mi></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq64.gif"/></alternatives></inline-formula>. Then, finding an improving transcript is equivalent to the following variant of the heaviest induced subgraph problem:</p>
      <sec id="d30e3779">
        <title><bold>Definition</bold><bold>1</bold> (Heaviest isoform problem).</title>
        <p>Given graph <italic>G</italic>=(<italic>V</italic>,<italic>E</italic>) and edge weight functions <italic>w</italic><sub><italic>e</italic></sub>, find <inline-formula id="IEq65"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$T\subseteq V$\end{document}</tex-math><mml:math id="M138"><mml:mi>T</mml:mi><mml:mo>⊆</mml:mo><mml:mi>V</mml:mi></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq65.gif"/></alternatives></inline-formula> such that the induced subgraph has maximal total edge weight, where each induced edge <italic>e</italic> contributes weight <inline-formula id="IEq66"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$w_{e}(T\cap \bar {V}(e))$\end{document}</tex-math><mml:math id="M140"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>∩</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mi>e</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq66.gif"/></alternatives></inline-formula>.</p>
        <p>Edge weights <italic>w</italic><sub><italic>e</italic></sub> model the corresponding summands on the left-hand side of Eq. <xref rid="Equ4" ref-type="">4</xref> and, thus, depend on the selection of exons between the mates of a cover (see Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Section 3). In Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Section 6, we show that the heaviest isoform problem is NP-complete. For single-end reads that span at most two exons, the weight function is no longer dependent on <inline-formula id="IEq67"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$T\cap \bar {V}(e)$\end{document}</tex-math><mml:math id="M142"><mml:mi>T</mml:mi><mml:mo>∩</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mi>e</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq67.gif"/></alternatives></inline-formula> and the heaviest isoform problem becomes polynomial-time solvable by a dynamic program.</p>
        <p>This problem can be captured by the following integer linear program. For each vertex <italic>i</italic> in <italic>G</italic>, a binary variable <italic>x</italic><sub><italic>i</italic></sub> indicates whether vertex <italic>i</italic> is contained in the solution. For every edge <italic>e</italic>∈<italic>E</italic> and every set <inline-formula id="IEq68"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {V}_{j}\subseteq \bar {V}(e)$\end{document}</tex-math><mml:math id="M144"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⊆</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mi>e</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq68.gif"/></alternatives></inline-formula>, we have a binary variable <italic>y</italic><sub><italic>e</italic>,<italic>j</italic></sub>, which is 1 if and only if vertices selected by the <italic>x</italic> variables are consistent with <inline-formula id="IEq69"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {V}_{j}$\end{document}</tex-math><mml:math id="M146"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq69.gif"/></alternatives></inline-formula> and induce <italic>e</italic>, enforced by the constraints below. In the objective function, we let <inline-formula id="IEq70"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$w_{e,j}:=w_{e}(\bar {V}_{j})$\end{document}</tex-math><mml:math id="M148"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq70.gif"/></alternatives></inline-formula>: 
<disp-formula id="Equa"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $${\fontsize{8.1}{6}\begin{aligned} \max&amp;&amp; \sum_{e\in E}&amp;\sum_{\bar{V}_{j}\subseteq \bar{V}(e)} w_{e, j}y_{e, j}\\ \text{s.t.}&amp;&amp; y_{e,j}&amp;\geq \sum_{v_{i}\in e\cup \bar{V}_{j}}x_{i}+ \sum_{v_{i}\in\bar{V}(e)\setminus \bar{V}_{j}}(1-x_{i}) &amp;&amp;\!\!\!\!\!-|\bar{V}(e)|-1,\\ &amp;&amp;&amp;&amp;&amp; e\in E,\ \bar{V}_{j}\subseteq \bar{V}(e)\\ &amp;&amp; y_{e,j}&amp;\leq x_{i}, &amp;&amp; e\in E,\ \bar{V}_{j}\subseteq \bar{V}(e),\ v_{i}\in e\cup \bar{V}_{j} \\ &amp;&amp; y_{e,j}&amp;\leq 1-x_{i}, &amp;&amp;e\in E,\ \bar{V}_{j}\subseteq \bar{V}(e),\ v_{i}\in\bar{V}(e)\setminus \bar{V}_{j} \end{aligned}} $$ \end{document}</tex-math><mml:math id="M150"><mml:mrow><mml:mspace width="-16.0pt"/><mml:mtable><mml:mtr><mml:mtd><mml:mo>max</mml:mo></mml:mtd><mml:mtd><mml:mspace width="-9.99756pt"/><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mo>∈</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:munder></mml:mtd><mml:mtd><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⊆</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mi>e</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>s.t.</mml:mtext></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>≥</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi>e</mml:mi><mml:mo>∪</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mspace width="-0.9998pt"/><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mi>e</mml:mi><mml:mo>)</mml:mo><mml:mo>∖</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:mo>−</mml:mo><mml:mo>|</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mi>e</mml:mi><mml:mo>)</mml:mo><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="-23.0pt"/><mml:mi>e</mml:mi><mml:mo>∈</mml:mo><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⊆</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mi>e</mml:mi><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mspace width="-23.0pt"/><mml:mi>e</mml:mi><mml:mo>∈</mml:mo><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⊆</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mi>e</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi>e</mml:mi><mml:mo>∪</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>≤</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mspace width="-23.0pt"/><mml:mi>e</mml:mi><mml:mo>∈</mml:mo><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⊆</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mi>e</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mi>e</mml:mi><mml:mo>)</mml:mo><mml:mo>∖</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2015_865_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>Depending on the quality of the data (determined by, e.g., sequence-specific or positional biases and read mapping accuracy), an isoform that is built by our ILP formulation might improve the prediction with respect to objective Eq. <xref rid="Equ1" ref-type="">1</xref> by balancing, for instance, read coverage fluctuations. To prevent fitting noise in the data, we require novel isoforms to explain segment covers <italic>c</italic> that are not supported by any transcript in the initial solution <italic>T</italic><sup>∗</sup> returned by the regularized least-squares regression Eq. <xref rid="Equ1" ref-type="">1</xref>; i.e., ∀<italic>t</italic>∈<italic>T</italic><sup>∗</sup>:<italic>ℓ</italic><sub><italic>t</italic>,<italic>c</italic></sub>=0. We refer to this set of initially unsupported segment covers as <inline-formula id="IEq71"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {\mathcal {C}} \subseteq \mathcal {C}$\end{document}</tex-math><mml:math id="M152"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover><mml:mo>⊆</mml:mo><mml:mi mathvariant="script">C</mml:mi></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq71.gif"/></alternatives></inline-formula>. To reduce the impact of spurious read mappings, we require a certain number <italic>k</italic><sub><italic>c</italic></sub> of read counts to be observed on the set of newly supported segment covers: 
<disp-formula id="Equ5"><label>(5)</label><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \sum_{c_{i} \in \tilde{\mathcal{C}}} b_{i} \sum_{\bar{V}_{j}\subseteq \bar{V}(e_{i})} y_{e_{i},j} \geq k_{c}  $$ \end{document}</tex-math><mml:math id="M154"><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⊆</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="13059_2015_865_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>Intuitively, variables <italic>y</italic><sub><italic>e</italic>,<italic>l</italic></sub> associated with an edge <italic>e</italic>=(<italic>i</italic>,<italic>j</italic>) guess the selection of exons between exons <italic>i</italic> and <italic>j</italic>. Since for large <italic>j</italic>−<italic>i</italic> their exponential number would render our ILP approach infeasible, we neglect sets <inline-formula id="IEq72"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {V}_{j}$\end{document}</tex-math><mml:math id="M156"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq72.gif"/></alternatives></inline-formula> that would imply fragments of very unlikely length. More precisely, we apply lower and upper bounds <inline-formula id="IEq73"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\check {\ell }$\end{document}</tex-math><mml:math id="M158"><mml:mover accent="true"><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mo>ˇ</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq73.gif"/></alternatives></inline-formula> and <inline-formula id="IEq74"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\ell }$\end{document}</tex-math><mml:math id="M160"><mml:mover accent="true"><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq74.gif"/></alternatives></inline-formula> in the computation of <italic>ℓ</italic><sub><italic>t</italic>,<italic>c</italic></sub> (see Eq. (<xref rid="Equ1" ref-type="">1</xref>) in Additional file <xref rid="MOESM2" ref-type="media">2</xref>) that limit the lower and upper 5 <italic>%</italic> quantiles, respectively, of the estimated fragment length distribution. In Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Section 7, we translate this fragment length restriction into lower and upper limits on the total length of exons in <inline-formula id="IEq75"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {V}_{j}$\end{document}</tex-math><mml:math id="M162"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq75.gif"/></alternatives></inline-formula>, which allow us to enumerate feasible exon combinations in <inline-formula id="IEq76"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {V}_{j}$\end{document}</tex-math><mml:math id="M164"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq76.gif"/></alternatives></inline-formula> by an efficient splicing-graph-based backtracking scheme.</p>
        <p>The construction of improving transcripts can be further guided by additional information such as exon–intron boundaries, TSSs, TESs, or exon connectivity. In the following, we introduce constraints that we optionally add to our ILP formulation, depending on the type of data available, to ensure that the <italic>x</italic> variables encode a transcript that exhibits the desired structure.</p>
      </sec>
      <sec id="Sec21">
        <title>Exon compatibility</title>
        <p>Splice acceptor and splice donor sites can be derived from spliced alignments or extracted from a set of gene annotations. Here we consider the case of a set of known exons <inline-formula id="IEq77"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {E}$\end{document}</tex-math><mml:math id="M166"><mml:mi mathvariant="script">E</mml:mi></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq77.gif"/></alternatives></inline-formula>. The more general case where the pairing of alternative acceptor and donor sites is unknown can be reduced to this case by simply including all possible combinations of acceptor and donor sites of an exon in <inline-formula id="IEq78"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {E}$\end{document}</tex-math><mml:math id="M168"><mml:mi mathvariant="script">E</mml:mi></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq78.gif"/></alternatives></inline-formula>. Alternatively, the structure of a splicing graph along with the individual mapping of acceptor and donor sites can be enforced through exon connectivity constraints as shown in the next section.</p>
        <p>To ensure that the segments in <inline-formula id="IEq79"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {S}$\end{document}</tex-math><mml:math id="M170"><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq79.gif"/></alternatives></inline-formula> selected by the <italic>x</italic> variables form only valid exons in <inline-formula id="IEq80"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {E}$\end{document}</tex-math><mml:math id="M172"><mml:mi mathvariant="script">E</mml:mi></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq80.gif"/></alternatives></inline-formula>, we link the segments of each exon <inline-formula id="IEq81"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$E_{j}\in \mathcal {E}$\end{document}</tex-math><mml:math id="M174"><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="script">E</mml:mi></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq81.gif"/></alternatives></inline-formula> by an indicator variable <italic>z</italic><sub><italic>j</italic></sub>: 
<disp-formula id="Equ6"><label>(6)</label><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ x_{i} = \sum_{E_{j} \ni s_{i}} z_{j}, \quad 1 \leq i \leq |\mathcal{S}|   $$ \end{document}</tex-math><mml:math id="M176"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∋</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>|</mml:mo></mml:math><graphic xlink:href="13059_2015_865_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>This constraint implies that (i) every selected segment <italic>s</italic><sub><italic>i</italic></sub> (i.e., <italic>x</italic><sub><italic>i</italic></sub>=1) must be part of exactly one selected exon <italic>E</italic><sub><italic>j</italic></sub> (i.e., <italic>z</italic><sub><italic>j</italic></sub>=1), (ii) all segments of a selected exon must be included, and (iii) no pair of overlapping, and hence incompatible, exons can be selected simultaneously.</p>
      </sec>
      <sec id="Sec22">
        <title>Exon connectivity</title>
        <p>For some complex genes, it is computationally infeasible to enumerate all paths in the splicing graph to obtain the set of candidate isoforms. For such genes, our delayed isoform generation approach allows the exploration of all candidate isoforms without explicitly enumerating them. Constraint Eq. <xref rid="Equ7" ref-type="">7</xref> with <italic>u</italic><sub><italic>i</italic>,<italic>j</italic></sub>:=0, therefore, captures the splicing graph structure in a way that the path induced by the selected set of segments agrees with the set of edges <italic>E</italic> in the splicing graph. A simultaneous selection of two segments <italic>s</italic><sub><italic>i</italic></sub> and <italic>s</italic><sub><italic>j</italic></sub>, <italic>i</italic>&lt;<italic>j</italic>, without selecting any segment <italic>s</italic><sub><italic>k</italic></sub> with <italic>i</italic>&lt;<italic>k</italic>&lt;<italic>j</italic> is not feasible if the splicing graph does not contain edge (<italic>v</italic><sub><italic>i</italic></sub>,<italic>v</italic><sub><italic>j</italic></sub>). Notice that this scheme allows us to assemble novel exons by selecting acceptor sites (incoming edge) and donor sites (outgoing edge) independently.</p>
        <p>Alternatively, we can allow up to <italic>k</italic> (default <italic>k</italic>=2) new edges to be selected from a set of “valuable” edges <italic>E</italic><sup>′</sup> missing in the splicing graph. At most <italic>k</italic> binary variables <italic>u</italic><sub><italic>i</italic>,<italic>j</italic></sub>, <inline-formula id="IEq82"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$1\leq i &lt; j \leq |\mathcal {S}|$\end{document}</tex-math><mml:math id="M178"><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>|</mml:mo></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq82.gif"/></alternatives></inline-formula>, can be set to 1 for (<italic>v</italic><sub><italic>i</italic></sub>,<italic>v</italic><sub><italic>j</italic></sub>)∉<italic>E</italic> to relax the corresponding constraint Eq. <xref rid="Equ7" ref-type="">7</xref>. We experimented with valuable sets of edges <italic>E</italic><sup>′</sup> that allow the explanation of observed covers that cannot be explained solely using edges in <italic>E</italic>. In general, however, any novel intron can be simply modeled by a corresponding edge in <italic>E</italic><sup>′</sup>: 
<disp-formula id="Equ7"><label>(7)</label><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $${\kern8pt} {\fontsize{9.2pt}{9.6pt}{\begin{aligned} {}1+u_{i,j} &amp;\geq x_{i} + x_{j}- \sum_{i&lt;k&lt;j} x_{k}, &amp;&amp;\!\! 1\leq i &lt; j \leq |\mathcal{S}|,\ (v_{i},v_{j})\notin E  \end{aligned}}}  $$ \end{document}</tex-math><mml:math id="M180"><mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>≥</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>∉</mml:mo><mml:mi>E</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2015_865_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>
          <disp-formula id="Equ8">
            <label>(8)</label>
            <alternatives>
              <tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ {}\sum_{(i,j)\in E'} u_{i,j} \leq k   $$ \end{document}</tex-math>
              <mml:math id="M182">
                <mml:munder>
                  <mml:mrow>
                    <mml:mo>∑</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mi>i</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>j</mml:mi>
                    <mml:mo>)</mml:mo>
                    <mml:mo>∈</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>E</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>′</mml:mo>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                </mml:munder>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>u</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>≤</mml:mo>
                <mml:mi>k</mml:mi>
              </mml:math>
              <graphic xlink:href="13059_2015_865_Article_Equ8.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
        <p>
          <disp-formula id="Equ9">
            <label>(9)</label>
            <alternatives>
              <tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $${\kern8pt} {\fontsize{8.8pt}{9.6pt}{\begin{aligned} u_{i,j} &amp;= 0, &amp;&amp; \qquad\qquad\qquad \!\!1\leq i &lt; j \leq |\mathcal{S}|,\ (v_{i},v_{j})\notin E \cup E' \end{aligned}}}  $$ \end{document}</tex-math>
              <mml:math id="M184">
                <mml:mtable>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>u</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mo>=</mml:mo>
                      <mml:mn>0</mml:mn>
                      <mml:mo>,</mml:mo>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mspace width="2em"/>
                      <mml:mspace width="2em"/>
                      <mml:mspace width="2em"/>
                      <mml:mspace width="0.3em"/>
                      <mml:mspace width="0.3em"/>
                      <mml:mn>1</mml:mn>
                      <mml:mo>≤</mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo>&lt;</mml:mo>
                      <mml:mi>j</mml:mi>
                      <mml:mo>≤</mml:mo>
                      <mml:mo>|</mml:mo>
                      <mml:mi mathvariant="script">S</mml:mi>
                      <mml:mo>|</mml:mo>
                      <mml:mo>,</mml:mo>
                      <mml:mspace width="1em"/>
                      <mml:mo>(</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>v</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>v</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>)</mml:mo>
                      <mml:mo>∉</mml:mo>
                      <mml:mi>E</mml:mi>
                      <mml:mo>∪</mml:mo>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mi>E</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mo>′</mml:mo>
                        </mml:mrow>
                      </mml:msup>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:math>
              <graphic xlink:href="13059_2015_865_Article_Equ9.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
      </sec>
      <sec id="Sec23">
        <title>Transcription start and end sites</title>
        <p>We also have to ensure that improving transcripts built by our ILP start at segments in <inline-formula id="IEq83"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {TSS}$\end{document}</tex-math><mml:math id="M186"><mml:mi mathvariant="script">T</mml:mi><mml:mi mathvariant="script">S</mml:mi><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq83.gif"/></alternatives></inline-formula> and end at segments in <inline-formula id="IEq84"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {PAS}$\end{document}</tex-math><mml:math id="M188"><mml:mi mathvariant="script">P</mml:mi><mml:mi mathvariant="script">A</mml:mi><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq84.gif"/></alternatives></inline-formula>. Our model captures both the <italic>exclusion</italic> of potential TSSs and TESs from spliced alignments (see Section “<xref rid="Sec18" ref-type="sec">Candidate isoforms</xref>”), and the <italic>inclusion</italic> of transcript boundaries, from, e.g., a RNA-seq read coverage drop or from additional reads from the <inline-formula id="IEq85"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$5^{\prime }$\end{document}</tex-math><mml:math id="M190"><mml:msup><mml:mrow><mml:mn>5</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq85.gif"/></alternatives></inline-formula> ends and polyadenylation sites of mRNAs (see Section “<xref rid="Sec14" ref-type="sec">Integrating real RNA-seq, CAGE, and PAS-seq</xref>”).</p>
        <p>Variables <italic>s</italic><italic>s</italic><sub><italic>i</italic></sub> and <italic>e</italic><italic>s</italic><sub><italic>i</italic></sub> indicate the start and terminal segment of the generated isoform, respectively. We must select precisely one TSS and one TES (constraints Eqs. <xref rid="Equ10" ref-type="">10</xref> and <xref rid="Equ11" ref-type="">11</xref>) from sets <inline-formula id="IEq86"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {TSS}$\end{document}</tex-math><mml:math id="M192"><mml:mi mathvariant="script">T</mml:mi><mml:mi mathvariant="script">S</mml:mi><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq86.gif"/></alternatives></inline-formula> and <inline-formula id="IEq87"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {PAS}$\end{document}</tex-math><mml:math id="M194"><mml:mi mathvariant="script">P</mml:mi><mml:mi mathvariant="script">A</mml:mi><mml:mi mathvariant="script">S</mml:mi></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq87.gif"/></alternatives></inline-formula>, respectively (constraints Eqs. <xref rid="Equ12" ref-type="">12</xref> and <xref rid="Equ13" ref-type="">13</xref>). Designated start and end sites must be part of the predicted transcript (constraints Eqs. <xref rid="Equ14" ref-type="">14</xref> and <xref rid="Equ15" ref-type="">15</xref>). Finally, no segment upstream of the start segment Eq. <xref rid="Equ16" ref-type="">16</xref> and no segment downstream of the end segment Eq. <xref rid="Equ17" ref-type="">17</xref> can be part of the predicted isoform: 
<disp-formula id="Equ10"><label>(10)</label><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \sum_{v_{i}\in V} \mathit{ss}_{i} &amp;= 1  \end{array} $$ \end{document}</tex-math><mml:math id="M196"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi mathvariant="italic">ss</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2015_865_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>
          <disp-formula id="Equ11">
            <label>(11)</label>
            <alternatives>
              <tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l}[-2pt] \sum_{v_{i}\in V} \mathit{es}_{i} &amp;= 1  \end{array} $$ \end{document}</tex-math>
              <mml:math id="M198">
                <mml:mtable class="align" columnalign="left">
                  <mml:mtr>
                    <mml:mtd class="align-1">
                      <mml:mo>[</mml:mo>
                      <mml:mo>−</mml:mo>
                      <mml:mn>2</mml:mn>
                      <mml:mtext mathvariant="italic">pt</mml:mtext>
                      <mml:mo>]</mml:mo>
                      <mml:munder>
                        <mml:mrow>
                          <mml:mo mathsize="big">∑</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>v</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>∈</mml:mo>
                          <mml:mi>V</mml:mi>
                        </mml:mrow>
                      </mml:munder>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi mathvariant="italic">es</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mtd>
                    <mml:mtd class="align-2">
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mspace width="2em"/>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:math>
              <graphic xlink:href="13059_2015_865_Article_Equ11.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
        <p>
          <disp-formula id="Equ12">
            <label>(12)</label>
            <alternatives>
              <tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l}[-2pt] \mathit{ss}_{i} &amp;= 0, &amp; v_{i}\notin \mathcal{TSS}  \end{array} $$ \end{document}</tex-math>
              <mml:math id="M200">
                <mml:mtable class="align" columnalign="left">
                  <mml:mtr>
                    <mml:mtd class="align-1">
                      <mml:mo>[</mml:mo>
                      <mml:mo>−</mml:mo>
                      <mml:mn>2</mml:mn>
                      <mml:mtext mathvariant="italic">pt</mml:mtext>
                      <mml:mo>]</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi mathvariant="italic">ss</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mtd>
                    <mml:mtd class="align-2">
                      <mml:mo>=</mml:mo>
                      <mml:mn>0</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:mspace width="2em"/>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>v</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>∉</mml:mo>
                      <mml:mi mathvariant="script">T</mml:mi>
                      <mml:mi mathvariant="script">S</mml:mi>
                      <mml:mi mathvariant="script">S</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mspace width="2em"/>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:math>
              <graphic xlink:href="13059_2015_865_Article_Equ12.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
        <p>
          <disp-formula id="Equ13">
            <label>(13)</label>
            <alternatives>
              <tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l}[-2pt] \mathit{es}_{i} &amp;= 0, &amp; v_{i}\notin \mathcal{PAS}  \end{array} $$ \end{document}</tex-math>
              <mml:math id="M202">
                <mml:mtable class="align" columnalign="left">
                  <mml:mtr>
                    <mml:mtd class="align-1">
                      <mml:mo>[</mml:mo>
                      <mml:mo>−</mml:mo>
                      <mml:mn>2</mml:mn>
                      <mml:mtext mathvariant="italic">pt</mml:mtext>
                      <mml:mo>]</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi mathvariant="italic">es</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mtd>
                    <mml:mtd class="align-2">
                      <mml:mo>=</mml:mo>
                      <mml:mn>0</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:mspace width="2em"/>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>v</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>∉</mml:mo>
                      <mml:mi mathvariant="script">P</mml:mi>
                      <mml:mi mathvariant="script">A</mml:mi>
                      <mml:mi mathvariant="script">S</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mspace width="2em"/>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:math>
              <graphic xlink:href="13059_2015_865_Article_Equ13.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
        <p>
          <disp-formula id="Equ14">
            <label>(14)</label>
            <alternatives>
              <tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l}[-2pt] x_{i} &amp;\geq ss_{i}, &amp; v_{i}\in V  \end{array} $$ \end{document}</tex-math>
              <mml:math id="M204">
                <mml:mtable class="align" columnalign="left">
                  <mml:mtr>
                    <mml:mtd class="align-1">
                      <mml:mo>[</mml:mo>
                      <mml:mo>−</mml:mo>
                      <mml:mn>2</mml:mn>
                      <mml:mtext mathvariant="italic">pt</mml:mtext>
                      <mml:mo>]</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>x</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mtd>
                    <mml:mtd class="align-2">
                      <mml:mo>≥</mml:mo>
                      <mml:mi>s</mml:mi>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>s</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:mspace width="2em"/>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>v</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>∈</mml:mo>
                      <mml:mi>V</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mspace width="2em"/>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:math>
              <graphic xlink:href="13059_2015_865_Article_Equ14.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
        <p>
          <disp-formula id="Equ15">
            <label>(15)</label>
            <alternatives>
              <tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l}[-2pt] x_{i} &amp;\geq \mathit{es}_{i}, &amp; v_{i}\in V  \end{array} $$ \end{document}</tex-math>
              <mml:math id="M206">
                <mml:mtable class="align" columnalign="left">
                  <mml:mtr>
                    <mml:mtd class="align-1">
                      <mml:mo>[</mml:mo>
                      <mml:mo>−</mml:mo>
                      <mml:mn>2</mml:mn>
                      <mml:mtext mathvariant="italic">pt</mml:mtext>
                      <mml:mo>]</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>x</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mtd>
                    <mml:mtd class="align-2">
                      <mml:mo>≥</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi mathvariant="italic">es</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:mspace width="2em"/>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>v</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>∈</mml:mo>
                      <mml:mi>V</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mspace width="2em"/>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:math>
              <graphic xlink:href="13059_2015_865_Article_Equ15.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
        <p>
          <disp-formula id="Equ16">
            <label>(16)</label>
            <alternatives>
              <tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l}[-2pt] x_{i} &amp;\leq 1 - \sum_{j=i+1}^{|V|} ss_{j}, &amp; v_{i}\in V  \end{array} $$ \end{document}</tex-math>
              <mml:math id="M208">
                <mml:mtable class="align" columnalign="left">
                  <mml:mtr>
                    <mml:mtd class="align-1">
                      <mml:mo>[</mml:mo>
                      <mml:mo>−</mml:mo>
                      <mml:mn>2</mml:mn>
                      <mml:mtext mathvariant="italic">pt</mml:mtext>
                      <mml:mo>]</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>x</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mtd>
                    <mml:mtd class="align-2">
                      <mml:mo>≤</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>−</mml:mo>
                      <mml:munderover accent="false" accentunder="false">
                        <mml:mrow>
                          <mml:mo mathsize="big">∑</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mi>i</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mo>|</mml:mo>
                          <mml:mi>V</mml:mi>
                          <mml:mo>|</mml:mo>
                        </mml:mrow>
                      </mml:munderover>
                      <mml:mi>s</mml:mi>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>s</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:mspace width="2em"/>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>v</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>∈</mml:mo>
                      <mml:mi>V</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mspace width="2em"/>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:math>
              <graphic xlink:href="13059_2015_865_Article_Equ16.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
        <p>
          <disp-formula id="Equ17">
            <label>(17)</label>
            <alternatives>
              <tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l}[-2pt] x_{i} &amp;\leq 1 - \sum_{j=1}^{i-1} es_{j}, &amp; v_{i}\in V  \end{array} $$ \end{document}</tex-math>
              <mml:math id="M210">
                <mml:mtable class="align" columnalign="left">
                  <mml:mtr>
                    <mml:mtd class="align-1">
                      <mml:mo>[</mml:mo>
                      <mml:mo>−</mml:mo>
                      <mml:mn>2</mml:mn>
                      <mml:mtext mathvariant="italic">pt</mml:mtext>
                      <mml:mo>]</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>x</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mtd>
                    <mml:mtd class="align-2">
                      <mml:mo>≤</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>−</mml:mo>
                      <mml:munderover accent="false" accentunder="false">
                        <mml:mrow>
                          <mml:mo mathsize="big">∑</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:munderover>
                      <mml:mi>e</mml:mi>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>s</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:mspace width="2em"/>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>v</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>∈</mml:mo>
                      <mml:mi>V</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mspace width="2em"/>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:math>
              <graphic xlink:href="13059_2015_865_Article_Equ17.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
      </sec>
      <sec id="Sec24">
        <title>Intron retentions</title>
        <p>The explicit exon model described in Section “<xref rid="Sec21" ref-type="sec">Exon compatibility</xref>” captures intron retentions by simply merging the flanking exons and the retained intron into one virtual exon that is added to set <inline-formula id="IEq88"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {E}$\end{document}</tex-math><mml:math id="M212"><mml:mi mathvariant="script">E</mml:mi></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq88.gif"/></alternatives></inline-formula>. Similarly, the more general exon connectivity formulation that is based on individual splice sites rather than assembled exons trivially includes the connectivity of intron retentions.</p>
      </sec>
    </sec>
    <sec id="Sec25">
      <title>Phase III: fine-tuning and post-processing</title>
      <p>To adjust the regularization penalty <italic>λ</italic> to the increased set of candidate transcripts implicitly considered by the delayed isoform generation approach and to reduce the effect of the piecewise-linear approximation of the loss function, CIDANE re-solves Eq. <xref rid="Equ1" ref-type="">1</xref> with the candidate set <italic>T</italic> containing additionally all transcripts generated in the course of the delayed isoform generation phase. We express a higher confidence in fully supported isoforms by selectively increasing <italic>λ</italic><sup>′</sup>=<italic>α</italic>·<italic>λ</italic> (default <italic>α</italic>=1.3) for delayed generated transcripts.</p>
      <p>Let transcripts <inline-formula id="IEq89"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$T^{*}=\{t_{1},\dots,t_{m}\}$\end{document}</tex-math><mml:math id="M214"><mml:msup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq89.gif"/></alternatives></inline-formula> with non-zero abundance <inline-formula id="IEq90"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\theta ^{*}_{t_{1}},\dots,\theta ^{*}_{t_{m}}$\end{document}</tex-math><mml:math id="M216"><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq90.gif"/></alternatives></inline-formula> be returned by the regularized regression Eq. <xref rid="Equ1" ref-type="">1</xref> solved in phase I, optionally including the additional isoforms provided by our delayed isoform generation approach (phase II). CIDANE determines the final prediction by post-processing <italic>T</italic><sup>∗</sup> as follows. First, to avoid biases introduced by the regularization penalties <italic>λ</italic>, we re-solve Eqs. <xref rid="Equ2" ref-type="">2</xref> and <xref rid="Equ3" ref-type="">3</xref> for <italic>λ</italic>:=0 using set <italic>T</italic><sup>∗</sup> instead of <italic>T</italic> to obtain expression levels <inline-formula id="IEq91"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\theta _{t_{i}}'$\end{document}</tex-math><mml:math id="M218"><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq91.gif"/></alternatives></inline-formula>. Second, we re-estimate the expression levels by computing a final assignment of mapped reads to isoforms that is guided by the relative abundances <inline-formula id="IEq92"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\theta _{t_{i}}'$\end{document}</tex-math><mml:math id="M220"><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2015_865_Article_IEq92.gif"/></alternatives></inline-formula>: 
<disp-formula id="Equb"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$r(t_{j}) = \sum_{c_{i}\in\mathcal{C}:\ell_{t_{j},c_{i}}&gt;0} \quad b_{i} \cdot \frac{{\ell}_{t_{j},c_{i}} \theta_{t_{j}}'}{\sum \limits_{t_{k} \in T^{*}}{\ell}_{t_{k},c_{i}} \theta_{t_{k}}'}, $$ \end{document}</tex-math><mml:math id="M222"><mml:mrow><mml:mi>r</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="script">C</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2015_865_Article_Equb.gif" position="anchor"/></alternatives></disp-formula> where <italic>r</italic>(<italic>t</italic><sub><italic>j</italic></sub>) is the number of reads assigned to isoform <italic>t</italic><sub><italic>j</italic></sub>. This assignment of reads to isoforms corrects overestimation or underestimation of the total number of reads within a gene due to non-uniform read mapping coverage. For all isoforms <italic>t</italic><sub><italic>j</italic></sub>∈<italic>T</italic><sup>∗</sup> with <italic>r</italic>(<italic>t</italic><sub><italic>j</italic></sub>)≥<italic>α</italic> (default <italic>α</italic>=10), we compute transcript expression levels in FPKM and finally return all isoforms whose predicted expression in FPKM is at least <italic>β</italic> percent (default <italic>β</italic>=10) of the expression of the most abundant transcript for the same gene. When run with a partial annotation of the transcriptome of an organism, we increase the expression threshold <italic>β</italic> to 20 <italic>%</italic> for novel transcripts.</p>
    </sec>
    <sec id="Sec26">
      <title>Ethics approval</title>
      <p>Not applicable.</p>
    </sec>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec27">
        <title>Additional files</title>
        <p>
          <media position="anchor" xlink:href="13059_2015_865_MOESM1_ESM.pdf" id="MOESM1">
            <label>Additional file 1</label>
            <caption>
              <p><bold>Additional figures and tables.</bold> (PDF 578 kb)</p>
            </caption>
          </media>
        </p>
        <p>
          <media position="anchor" xlink:href="13059_2015_865_MOESM2_ESM.pdf" id="MOESM2">
            <label>Additional file 2</label>
            <caption>
              <p><bold>Algorithmic details.</bold> (PDF 238 kb)</p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <fn-group>
    <fn>
      <p>
        <bold>Competing interests</bold>
      </p>
      <p>The authors declare that they have no competing interests.</p>
    </fn>
    <fn>
      <p>
        <bold>Authors’ contributions</bold>
      </p>
      <p>SC and SA developed the algorithms and implemented CIDANE. DW implemented the read counting and segment refinement, with help from SA. KR and GK contributed to discussions on algorithms. SC and SA wrote the manuscript. All authors read and approved the final manuscript.</p>
    </fn>
    <fn>
      <p>
        <bold>Funding</bold>
      </p>
      <p>SC was supported in part by US National Institutes of Health grant R01-HG006677.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Nathan Boley for providing the data and support necessary for the integrated analysis of modENCODE RNA data. We thank Veronica Lee for her help in generating the perfect read mappings. We thank Sören Laue for helpful discussions on the computation of regularization paths.</p>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pan</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Shai</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Frey</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Blencowe</surname>
            <given-names>BJ</given-names>
          </name>
        </person-group>
        <article-title>Deep surveying of alternative splicing complexity in the human transcriptome by high-throughput sequencing</article-title>
        <source>Nat Genet</source>
        <year>2008</year>
        <volume>40</volume>
        <issue>12</issue>
        <fpage>1413</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.259</pub-id>
        <?supplied-pmid 18978789?>
        <pub-id pub-id-type="pmid">18978789</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Pertea</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Mortazavi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kwan</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>van Baren</surname>
            <given-names>MJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcript assembly and quantification by RNA-seq reveals unannotated transcripts and isoform switching during cell differentiation</article-title>
        <source>Nat Biotechnol</source>
        <year>2010</year>
        <volume>28</volume>
        <issue>5</issue>
        <fpage>511</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1621</pub-id>
        <?supplied-pmid 20436464?>
        <pub-id pub-id-type="pmid">20436464</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>ET</given-names>
          </name>
          <name>
            <surname>Sandberg</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Khrebtukova</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Mayr</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Alternative isoform regulation in human tissue transcriptomes</article-title>
        <source>Nature</source>
        <year>2008</year>
        <volume>456</volume>
        <issue>7221</issue>
        <fpage>470</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1038/nature07509</pub-id>
        <?supplied-pmid 18978772?>
        <pub-id pub-id-type="pmid">18978772</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Djebali</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Merkel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Dobin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lassmann</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Mortazavi</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Landscape of transcription in human cells</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>489</volume>
        <issue>7414</issue>
        <fpage>101</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11233</pub-id>
        <?supplied-pmid 22955620?>
        <pub-id pub-id-type="pmid">22955620</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eswaran</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cyanam</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Mudvari</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Reddy</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Pakala</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Nair</surname>
            <given-names>SS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcriptomic landscape of breast cancers through mRNA sequencing</article-title>
        <source>Sci Rep</source>
        <year>2012</year>
        <volume>2</volume>
        <fpage>264</fpage>
        <pub-id pub-id-type="doi">10.1038/srep00264</pub-id>
        <?supplied-pmid 22355776?>
        <pub-id pub-id-type="pmid">22355776</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Seo</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Ju</surname>
            <given-names>YS</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>WC</given-names>
          </name>
          <name>
            <surname>Shin</surname>
            <given-names>JY</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Bleazard</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The transcriptional landscape and mutational profile of lung adenocarcinoma</article-title>
        <source>Genome Res.</source>
        <year>2012</year>
        <volume>22</volume>
        <issue>11</issue>
        <fpage>2109</fpage>
        <lpage>19</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.145144.112</pub-id>
        <?supplied-pmid 22975805?>
        <pub-id pub-id-type="pmid">22975805</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Berger</surname>
            <given-names>MF</given-names>
          </name>
          <name>
            <surname>Levin</surname>
            <given-names>JZ</given-names>
          </name>
          <name>
            <surname>Vijayendran</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Sivachenko</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Adiconis</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Maguire</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrative analysis of the melanoma transcriptome</article-title>
        <source>Genome Res</source>
        <year>2010</year>
        <volume>20</volume>
        <issue>4</issue>
        <fpage>413</fpage>
        <lpage>27</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.103697.109</pub-id>
        <?supplied-pmid 20179022?>
        <pub-id pub-id-type="pmid">20179022</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Twine</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Janitz</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wilkins</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Janitz</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Whole transcriptome sequencing reveals gene expression and splicing differences in brain regions affected by Alzheimer’s disease</article-title>
        <source>PLoS ONE</source>
        <year>2011</year>
        <volume>6</volume>
        <issue>1</issue>
        <fpage>16266</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0016266</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guttman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Garber</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Levin</surname>
            <given-names>JZ</given-names>
          </name>
          <name>
            <surname>Donaghey</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Adiconis</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ab initio reconstruction of cell type-specific transcriptomes in mouse reveals the conserved multi-exonic structure of lincRNAs</article-title>
        <source>Nat Biotechnol</source>
        <year>2010</year>
        <volume>28</volume>
        <issue>5</issue>
        <fpage>503</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1633</pub-id>
        <?supplied-pmid 20436462?>
        <pub-id pub-id-type="pmid">20436462</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>YY</given-names>
          </name>
          <name>
            <surname>Dao</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hach</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Bakhshi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mo</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Lapuk</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Raphael</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CLIIQ: accurate comparative detection and quantification of expressed isoforms in a population</article-title>
        <source>Algorithms in bioinformatics. Lecture notes in computer science</source>
        <year>2012</year>
        <publisher-loc>Berlin, Heidelberg</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Behr</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kahles</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zhong</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Sreedharan</surname>
            <given-names>VT</given-names>
          </name>
          <name>
            <surname>Drewe</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Rätsch</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>MITIE: simultaneous RNA-seq-based transcript identification and quantification in multiple samples</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <issue>20</issue>
        <fpage>2529</fpage>
        <lpage>38</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt442</pub-id>
        <?supplied-pmid 23980025?>
        <pub-id pub-id-type="pmid">23980025</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tomescu</surname>
            <given-names>AI</given-names>
          </name>
          <name>
            <surname>Kuosmanen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rizzi</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Mäkinen</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>A novel min-cost flow method for estimating transcript expression with RNA-seq</article-title>
        <source>BMC Bioinforma</source>
        <year>2013</year>
        <volume>14 (suppl 5)</volume>
        <fpage>15</fpage>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Song</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Florea</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>CLASS: constrained transcript assembly of RNA-seq reads</article-title>
        <source>BMC Bioinforma</source>
        <year>2013</year>
        <volume>14 (suppl 5)</volume>
        <fpage>14</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-14-S5-S14</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Feng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Inference of isoforms from short sequence reads</article-title>
        <source>J Comput Biol</source>
        <year>2011</year>
        <volume>18</volume>
        <issue>3</issue>
        <fpage>305</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2010.0243</pub-id>
        <?supplied-pmid 21385036?>
        <pub-id pub-id-type="pmid">21385036</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mezlini</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Fiume</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Buske</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Savich</surname>
            <given-names>GL</given-names>
          </name>
          <name>
            <surname>Shah</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>iReckon: simultaneous isoform discovery and abundance estimation from RNA-seq data</article-title>
        <source>Genome Res</source>
        <year>2013</year>
        <volume>23</volume>
        <issue>3</issue>
        <fpage>519</fpage>
        <lpage>29</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.142232.112</pub-id>
        <?supplied-pmid 23204306?>
        <pub-id pub-id-type="pmid">23204306</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>CR</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bickel</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>Sparse linear modeling of next-generation mRNA sequencing (RNA-seq) data for isoform discovery and abundance estimation</article-title>
        <source>Proc Nat Acad Sci</source>
        <year>2011</year>
        <volume>108</volume>
        <issue>50</issue>
        <fpage>19867</fpage>
        <lpage>72</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1113972108</pub-id>
        <?supplied-pmid 22135461?>
        <pub-id pub-id-type="pmid">22135461</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>IsoLasso: a LASSO regression approach to RNA-seq based transcriptome assembly</article-title>
        <source>J Comput Biol</source>
        <year>2011</year>
        <volume>18</volume>
        <issue>11</issue>
        <fpage>1693</fpage>
        <lpage>707</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2011.0171</pub-id>
        <?supplied-pmid 21951053?>
        <pub-id pub-id-type="pmid">21951053</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pertea</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pertea</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Antonescu</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>TC</given-names>
          </name>
          <name>
            <surname>Mendell</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>StringTie enables improved reconstruction of a transcriptome from RNA-seq reads</article-title>
        <source>Nat Biotech</source>
        <year>2015</year>
        <volume>33</volume>
        <issue>3</issue>
        <fpage>290</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3122</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hiller</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>WH</given-names>
          </name>
        </person-group>
        <article-title>Simultaneous isoform discovery and quantification from RNA-seq</article-title>
        <source>Stat Biosci</source>
        <year>2013</year>
        <volume>5</volume>
        <issue>1</issue>
        <fpage>100</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="doi">10.1007/s12561-012-9069-2</pub-id>
        <?supplied-pmid 23888185?>
        <pub-id pub-id-type="pmid">23888185</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Bertsimas</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Tsitsiklis</surname>
            <given-names>JN</given-names>
          </name>
        </person-group>
        <source>Introduction to linear optimization</source>
        <year>1997</year>
        <publisher-loc>Belmont (MA)</publisher-loc>
        <publisher-name>Athena Scientific</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>ENCODE Project Consortium</collab>
        </person-group>
        <article-title>An integrated encyclopedia of DNA elements in the human genome</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>489</volume>
        <issue>7414</issue>
        <fpage>57</fpage>
        <lpage>74</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11247</pub-id>
        <pub-id pub-id-type="pmid">22955616</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Griebel</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Zacher</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Ribeca</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Raineri</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lacroix</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Guigó</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Modelling and simulating generic RNA-seq experiments with the flux simulator</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <issue>20</issue>
        <fpage>10073</fpage>
        <lpage>83</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks666</pub-id>
        <?supplied-pmid 22962361?>
        <pub-id pub-id-type="pmid">22962361</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hsu</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Kent</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Clawson</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kuhn</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Diekhans</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Haussler</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>The UCSC known genes</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <issue>9</issue>
        <fpage>1036</fpage>
        <lpage>46</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl048</pub-id>
        <?supplied-pmid 16500937?>
        <pub-id pub-id-type="pmid">16500937</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <mixed-citation publication-type="other">CIDANE. Software. <ext-link ext-link-type="uri" xlink:href="http://ccb.jhu.edu/software/cidane/">http://ccb.jhu.edu/software/cidane/</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Pertea</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pimentel</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kelley</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>TopHat2: accurate alignment of transcriptomes in the presence of insertions, deletions and gene fusions</article-title>
        <source>Genome Biol</source>
        <year>2013</year>
        <volume>14</volume>
        <issue>4</issue>
        <fpage>36</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2013-14-4-r36</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boley</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Stoiber</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Booth</surname>
            <given-names>BW</given-names>
          </name>
          <name>
            <surname>Wan</surname>
            <given-names>KH</given-names>
          </name>
          <name>
            <surname>Hoskins</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Bickel</surname>
            <given-names>PJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-guided transcript assembly by integrative analysis of RNA sequence data</article-title>
        <source>Nat Biotech</source>
        <year>2014</year>
        <volume>32</volume>
        <issue>4</issue>
        <fpage>341</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2850</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roberts</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pimentel</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Identification of novel transcripts in annotated genomes using RNA-seq</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <issue>17</issue>
        <fpage>2325</fpage>
        <lpage>2329</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr355</pub-id>
        <?supplied-pmid 21697122?>
        <pub-id pub-id-type="pmid">21697122</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nicolae</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mangul</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mandoiu</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Zelikovsky</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Estimation of alternative splicing isoform frequencies from RNA-seq data</article-title>
        <source>Algorithms Mol Biol</source>
        <year>2011</year>
        <volume>6</volume>
        <issue>1</issue>
        <fpage>9</fpage>
        <pub-id pub-id-type="doi">10.1186/1748-7188-6-9</pub-id>
        <?supplied-pmid 21504602?>
        <pub-id pub-id-type="pmid">21504602</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <mixed-citation publication-type="other">Li JJ. Personal communication. 2014.</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pruitt</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Tatusova</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Klimke</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Maglott</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>NCBI reference sequences: current status, policy and new initiatives</article-title>
        <source>Nucleic Acids Res</source>
        <year>2009</year>
        <volume>37</volume>
        <issue>Database-Issue</issue>
        <fpage>32</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkn721</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Flicek</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Amode</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Barrell</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Beal</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Billis</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Brent</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ensembl 2014</article-title>
        <source>Nucleic Acids Res</source>
        <year>2014</year>
        <volume>42</volume>
        <issue>D1</issue>
        <fpage>749</fpage>
        <lpage>55</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkt1196</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Karolchik</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Barber</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Casper</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Clawson</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Cline</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Diekhans</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The UCSC Genome Browser database, 2014 update</article-title>
        <source>Nucleic Acids Res</source>
        <year>2014</year>
        <volume>42</volume>
        <issue>D1</issue>
        <fpage>D764</fpage>
        <lpage>D770</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkt1168</pub-id>
        <?supplied-pmid 24270787?>
        <pub-id pub-id-type="pmid">24270787</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mayer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>di Iulio</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Maleri</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Eser</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Vierstra</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Reynolds</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Native elongating transcript sequencing reveals human transcriptional activity at nucleotide resolution</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>161</volume>
        <issue>3</issue>
        <fpage>541</fpage>
        <lpage>54</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.03.010</pub-id>
        <?supplied-pmid 25910208?>
        <pub-id pub-id-type="pmid">25910208</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Lacroix</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Sammeth</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Guigo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bergeron</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Crandall</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Lagergren</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Exact transcriptome reconstruction from short sequence reads</article-title>
        <source>Algorithms in bioinformatics. Lecture notes in computer science</source>
        <year>2008</year>
        <publisher-loc>Berlin, Heidelberg</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grabherr</surname>
            <given-names>MGO</given-names>
          </name>
        </person-group>
        <article-title>Full-length transcriptome assembly from RNA-seq data without a reference genome</article-title>
        <source>Nat Biotechnol</source>
        <year>2011</year>
        <volume>29</volume>
        <issue>7</issue>
        <fpage>644</fpage>
        <lpage>52</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1883</pub-id>
        <?supplied-pmid 21572440?>
        <pub-id pub-id-type="pmid">21572440</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marygold</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Leyland</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Seal</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Goodman</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Thurmond</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Strelets</surname>
            <given-names>VB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Flybase: improvements to the bibliography</article-title>
        <source>Nucleic Acids Res</source>
        <year>2013</year>
        <volume>41</volume>
        <issue>D1</issue>
        <fpage>751</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks1024</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heber</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Alekseyev</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sze</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>Splicing graphs and EST assembly problem</article-title>
        <source>Bioinformatics</source>
        <year>2002</year>
        <volume>18 Suppl 1</volume>
        <fpage>181</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/18.suppl_1.S181</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Efron</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Hastie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Johnstone</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Least angle regression</article-title>
        <source>Ann Stat</source>
        <year>2004</year>
        <volume>32</volume>
        <issue>2</issue>
        <fpage>407</fpage>
        <lpage>99</lpage>
        <pub-id pub-id-type="doi">10.1214/009053604000000067</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Friedman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hastie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Regularization paths for generalized linear models via coordinate descent</article-title>
        <source>J Stat Softw</source>
        <year>2010</year>
        <volume>33</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>22</lpage>
        <pub-id pub-id-type="doi">10.18637/jss.v033.i01</pub-id>
        <?supplied-pmid 20808728?>
        <pub-id pub-id-type="pmid">20808728</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Kortsarz</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Peleg</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>On choosing a dense subgraph</article-title>
        <source>Proceedings of the 34th Annual Symposium on Foundations of Computer Science</source>
        <year>1993</year>
        <publisher-loc>Washington, DC, USA</publisher-loc>
        <publisher-name>IEEE Computer Society</publisher-name>
      </element-citation>
    </ref>
  </ref-list>
</back>
