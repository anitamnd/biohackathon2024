<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">J Cheminform</journal-id>
    <journal-id journal-id-type="iso-abbrev">J Cheminform</journal-id>
    <journal-title-group>
      <journal-title>Journal of Cheminformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1758-2946</issn>
    <publisher>
      <publisher-name>Springer International Publishing</publisher-name>
      <publisher-loc>Cham</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5966370</article-id>
    <article-id pub-id-type="publisher-id">282</article-id>
    <article-id pub-id-type="doi">10.1186/s13321-018-0282-y</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Sachem: a chemical cartridge for high-performance substructure search</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Kratochvíl</surname>
          <given-names>Miroslav</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Vondrášek</surname>
          <given-names>Jiří</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Galgonek</surname>
          <given-names>Jakub</given-names>
        </name>
        <address>
          <email>galgonek@iocb.cas.cz</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2188 4245</institution-id><institution-id institution-id-type="GRID">grid.418892.e</institution-id><institution>Institute of Organic Chemistry and Biochemistry of the CAS, </institution></institution-wrap>Flemingovo náměstí 2, Prague 6, 166 10 Czech Republic </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1937 116X</institution-id><institution-id institution-id-type="GRID">grid.4491.8</institution-id><institution>Department of Software Engineering, Faculty of Mathematics and Physics, </institution><institution>Charles University, </institution></institution-wrap>Malostranské náměstí 25, Prague 1, 118 00 Czech Republic </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>23</day>
      <month>5</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>23</day>
      <month>5</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2018</year>
    </pub-date>
    <volume>10</volume>
    <elocation-id>27</elocation-id>
    <history>
      <date date-type="received">
        <day>27</day>
        <month>11</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>16</day>
        <month>5</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2018</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Structure search is one of the valuable capabilities of small-molecule databases. Fingerprint-based screening methods are usually employed to enhance the search performance by reducing the number of calls to the verification procedure. In substructure search, fingerprints are designed to capture important structural aspects of the molecule to aid the decision about whether the molecule contains a given substructure. Currently available cartridges typically provide acceptable search performance for processing user queries, but do not scale satisfactorily with dataset size.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We present Sachem, a new open-source chemical cartridge that implements two substructure search methods: The first is a performance-oriented reimplementation of substructure indexing based on the OrChem fingerprint, and the second is a novel method that employs newly designed fingerprints stored in inverted indices. We assessed the performance of both methods on small, medium, and large datasets containing 1, 10, and 94 million compounds, respectively. Comparison of Sachem with other freely available cartridges revealed improvements in overall performance, scaling potential and screen-out efficiency.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">The Sachem cartridge allows efficient substructure searches in databases of all sizes. The sublinear performance scaling of the second method and the ability to efficiently query large amounts of pre-extracted information may together open the door to new applications for substructure searches.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Substructure search</kwd>
      <kwd>Small molecule databases</kwd>
      <kwd>Molecule cartridges</kwd>
      <kwd>Inverted indices</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001823</institution-id>
            <institution>Ministerstvo Školství, Mládeže a Tělovýchovy</institution>
          </institution-wrap>
        </funding-source>
        <award-id>LM2015047</award-id>
        <principal-award-recipient>
          <name>
            <surname>Vondrášek</surname>
            <given-names>Jiří</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Institute of Organic Chemistry and Biochemistry of the CAS (RVO)</institution>
        </funding-source>
        <award-id>61388963</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2018</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par4">Compound retrieval is one of the most common purposes of chemical database cartridges. The ability of database cartridges to process queries accurately and efficiently has helped them become powerful tools to perform functions such as virtual screening, novelty checks, and compound activity predictions [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. Substructure search, in which the user inputs a part of a molecular structure and receives a set of all molecules that contain the given fragment as a substructure, can be valuable for searching through chemical databases.</p>
    <p id="Par5">The time required to deliver a substructure search result depends on the speed of the substructure matching algorithm that determines whether the given molecular fragment is a subgraph of a compound, and on the ability of the cartridge to quickly screen out compounds that can be identified as unable to match the query, so that they are not unnecessarily fetched from storage and verified by costly substructure matching. Because subgraph matching is an instance of a relatively hard subgraph isomorphism problem that is inherently exponential, improvements in screening are usually the major factor in expediting the search procedure. Screening is typically guided by substructural fingerprints that are stored in database indices for rapid processing [<xref ref-type="bibr" rid="CR3">3</xref>].</p>
    <p id="Par6">Here, we present Sachem, a new open-source chemical cartridge that aims to run substructure search queries on the largest publicly available datasets (specifically on more than 90 million compounds in the PubChem database) in an insignificant amount of time. In addition, the performance of the cartridge is potentially scalable to much larger database sizes. Although the scalability of cartridges is a crucial concern for long-term deployment<xref ref-type="fn" rid="Fn1">1</xref>, it is seldom discussed in the literature, and not sufficiently assured by available open-source software.</p>
    <p id="Par8">Development of Sachem was motivated by two major factors: First, substructure search is sometimes used as a frequently-called subroutine of other algorithms or analyses (e. g., complex virtual screening schemes [<xref ref-type="bibr" rid="CR4">4</xref>] or novel interfaces for substructure search [<xref ref-type="bibr" rid="CR2">2</xref>]); improvements of its performance are therefore directly reflected in the performance of the entire algorithms. Second, researchers usually benefit from the ability to interactively run and refine substructure queries using a platform such as a web service to quickly access available information about the compounds; the performance and efficiency of the cartridge implementation directly lower the running cost of such a web service.</p>
    <sec id="Sec2">
      <title>Fingerprint-based screening</title>
      <p id="Par9">The typical abstraction that guides the screening phase of the search is substructural fingerprints [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>]. These differ from other forms of fingerprints (e.g. similarity fingerprints) by specifying an extra requirement: a feature present in a structure must also be present in all its structural extensions (i.e. the set of fingerprints with a sub-fingerprint relation must form a partially ordered set that is homomorphic to the set of chemical structures partially ordered by subgraph relation). Further we discuss only the substructural fingerprints.</p>
      <p id="Par10">The fingerprints used in currently available cartridges were either designed manually or generated by automatically identifying and collecting features from molecule graphs. Manual design of fingerprints usually results in a compact feature set that captures the available domain-specific knowledge of search-related substructures; these include the substructural fingerprints from the CDK library, OrChem fingerprints, CACTVS and MACCS descriptors [<xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR10">10</xref>], and many others [<xref ref-type="bibr" rid="CR6">6</xref>]. Fixed fingerprint content is not future-proof—new features or statistical changes in the data require the fingerprint to be re-designed. This drives the need to generate fingerprints automatically, using only general assumptions. Typical auto-generated fingerprints include descriptors based on atom-count, atom-pairs, atom-paths, sub-graphs, wildcard patterns, and ring-connectivity [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>].</p>
      <p id="Par11">Technically, fingerprints are representable either as bit vectors, in which each bit marks the presence of a feature; or numeric vectors that also encode repetitions of each feature, which can also be encoded as bit vectors [<xref ref-type="bibr" rid="CR13">13</xref>]. The optimal method of storage and indexing depends on the fingerprint properties. Vectors of hand-designed fingerprints (typically identifying at most thousands of features) can be stored as simple relational-database columns and indexed by B-trees [<xref ref-type="bibr" rid="CR8">8</xref>], stored as arrays and indexed by generalized inverted search-tree indices [<xref ref-type="bibr" rid="CR14">14</xref>], or stored as inverted feature vectors or bitmap indices to allow rapid processing [<xref ref-type="bibr" rid="CR15">15</xref>].</p>
      <p id="Par12">Auto-generated fingerprints typically produce vectors with large numbers of descriptors: for example, in the ChEBI compound database [<xref ref-type="bibr" rid="CR16">16</xref>] (which currently contains cca. <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10^5$$\end{document}</tex-math><mml:math id="M2"><mml:msup><mml:mn>10</mml:mn><mml:mn>5</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2018_282_Article_IEq1.gif"/></alternatives></inline-formula> compounds), we can identify hundreds of different atom variants (atomic numbers, isotopes, and charges), approximately <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10^3$$\end{document}</tex-math><mml:math id="M4"><mml:msup><mml:mn>10</mml:mn><mml:mn>3</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2018_282_Article_IEq2.gif"/></alternatives></inline-formula> different ring structures, <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$8\cdot 10^5$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mn>8</mml:mn><mml:mo>·</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>5</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_282_Article_IEq3.gif"/></alternatives></inline-formula> different radial structures<xref ref-type="fn" rid="Fn2">2</xref> of radius 4, and <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1.5\cdot 10^6$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mn>1.5</mml:mn><mml:mo>·</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>6</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_282_Article_IEq4.gif"/></alternatives></inline-formula> different graph substructures with a maximum of 6 bonds. Cartridges usually exploit the sparsity of the resulting vectors to store them efficiently and represent each vector as a list of feature indices, or more generally, index-count pairs.</p>
      <p id="Par14">There are two common approaches for storing sparse fingerprints. The indices may be folded down by hashing feature indices to smaller integers, possibly using techniques similar to Bloom filters [<xref ref-type="bibr" rid="CR18">18</xref>, sec. 5.3]. The resulting reduction in dimensionality makes it possible to store the folded vectors using the same methods as for short feature vectors [<xref ref-type="bibr" rid="CR6">6</xref>]. Alternatively, the unfolded feature lists can be stored in inverted indices as is, without information loss caused by possible hash collisions in folding [<xref ref-type="bibr" rid="CR13">13</xref>, discussion on p.12]. Indexing methods available in text-search databases (e. g. Apache Lucene, Lucy, Solr [<xref ref-type="bibr" rid="CR19">19</xref>–<xref ref-type="bibr" rid="CR21">21</xref>], and ElasticSearch [<xref ref-type="bibr" rid="CR22">22</xref>]) scale well to the required count of distinct features and molecules. Inverted indices usually exploit statistical properties of the data to reduce the consumption of storage: posting lists of text-search databases typically contain small delta-encoded integers; similar encodings have been used for chemical databases [<xref ref-type="bibr" rid="CR23">23</xref>].</p>
      <p id="Par15">Sometimes a mixed approach for reducing the dimensionality of the fingerprints is taken. Machine learning methods can be used to simulate expert decisions about the viability of individual fingerprint keys, and the resulting fingerprint may be as good and compact as a hand-designed one [<xref ref-type="bibr" rid="CR24">24</xref>–<xref ref-type="bibr" rid="CR26">26</xref>].</p>
    </sec>
    <sec id="Sec3">
      <title>Available open-source cartridges</title>
      <p id="Par16">There are several available open-source cartridges that support molecule storage in a database retrieval using a substructure search query. These currently include OrChem [<xref ref-type="bibr" rid="CR8">8</xref>], RDKit [<xref ref-type="bibr" rid="CR27">27</xref>], Bingo [<xref ref-type="bibr" rid="CR15">15</xref>], pgchem [<xref ref-type="bibr" rid="CR14">14</xref>] and Mychem [<xref ref-type="bibr" rid="CR28">28</xref>].</p>
      <p id="Par17"><italic>OrChem</italic> uses Oracle as the back-end database. Its 789-bit fingerprint contains hashes of three-atom SMILES substructures in the first 95 bits; the rest of the bits is specified manually, in many cases using structural patterns. OrChem also stores 15 integer values for each molecule that describe counts of specific atoms and bond types. Each fingerprint bit and integer value is stored in a separate table column, and these columns are then indexed using a B-tree index.</p>
      <p id="Par18"><italic>RDKit</italic> provides a cartridge functionality with the PostgreSQL database. Fingerprints used for screening are pattern fingerprints, which hash several common structural features defined by SMARTS patterns. The size of the fingerprint can be customized, by default the hashes are folded to a 2048-bit array. Substructural fingerprints are indexed in a custom GiST index.</p>
      <p id="Par19"><italic>Bingo</italic> uses a 2584-bit substructural fingerprint based on hashed cyclic subgraphs (up to 8 atoms) and hashed sub-trees (up to 7 atoms). A small part of the fingerprint is reserved to count atom types, charges, and isotopes. Bingo can use Oracle, PostgreSQL, or SQL Server as a back-end. Fingerprints are indexed using a custom index type.</p>
      <p id="Par20"><italic>pgchem</italic> uses slightly modified FP2 and FP3 fingerprints from OpenBabel [<xref ref-type="bibr" rid="CR29">29</xref>] concatenated to one 1536-bit fingerprint. FP2 is a path fingerprint that indexes linear subgraphs with a maximal length of 7 atoms, FP3 is based on manually defined SMARTS patterns. Fingerprints are stored as a custom data type with a GiST index.</p>
      <p id="Par21"><italic>Mychem</italic> is a chemical cartridge for MySQL. It allows computation of FP2, FP3, and FP4 fingerprints from OpenBabel. Mychem does not provide any direct way to index the fingerprints to allow substructure screening.</p>
    </sec>
  </sec>
  <sec id="Sec4">
    <title>Implementation</title>
    <p id="Par22">In this paper, we describe the implementation of <italic>Sachem</italic>, a new cheminformatic cartridge. Two different fingerprints and corresponding indexing and searching methods implemented in Sachem can be used.</p>
    <p id="Par23">The first method, called <italic>Sachem/OrChem</italic>, is a major performance-oriented modification of the substructure-search part of the OrChem database cartridge [<xref ref-type="bibr" rid="CR8">8</xref>]. The second method, <italic>Sachem/Lucy</italic>, is an extension of the previous, designed to maximize the search screen-out rate by indexing a large number of automatically specified substructural fingerprint bits in a text-search database.</p>
    <sec id="Sec5">
      <title>Subgraph matching</title>
      <p id="Par24">Sachem was originally intended as a port of OrChem to the PostgreSQL database, which was motivated by licensing considerations. The subgraph matching functionality is therefore based on the original OrChem approach. However, we made multiple optimizations, which led to a complete rewrite of the matching part.</p>
      <p id="Par25">The text-based molecule storage format of OrChem was replaced with a compact binary format that allows faster fetching and processing of the molecular data in the substructure matching algorithm (many other cartridges take a similar approach for preparing the data). The compacted molecules are automatically stored in a static memory-mapped index file, so that the required data can be accessed without substantial overhead. The VF2 algorithm implementation was ported to C language and optimized for performance, resulting in a total speedup of more than <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10^3$$\end{document}</tex-math><mml:math id="M10"><mml:msup><mml:mn>10</mml:mn><mml:mn>3</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2018_282_Article_IEq5.gif"/></alternatives></inline-formula>. Two major speed-ups were achieved by avoiding all memory allocations in the performance-critical part of substructure matching, and by precomputing and caching all data required by the matching algorithm. In the original OrChem, some frequently accessed properties of atoms and molecules, such as implicit hydrogen counts, were unnecessarily recomputed several times during each substructure match.</p>
    </sec>
    <sec id="Sec6">
      <title>Fingerprint structure</title>
      <p id="Par26">Sachem/OrChem uses the fingerprints that were defined in the original OrChem but modified to support CDK 2.0 and use the aromaticity detection algorithm that was newly added to CDK to allow contributions from exocyclic <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi$$\end{document}</tex-math><mml:math id="M12"><mml:mi>π</mml:mi></mml:math><inline-graphic xlink:href="13321_2018_282_Article_IEq6.gif"/></alternatives></inline-formula>-bonds.</p>
      <p id="Par27">The fingerprints used in Sachem/Lucy are defined as follows:<list list-type="bullet"><list-item><p id="Par28">The occurrence of each distinct atom type found in a compound is considered as a distinct fingerprint bit.</p></list-item><list-item><p id="Par29">Using the SSSR algorithm [<xref ref-type="bibr" rid="CR30">30</xref>], we retrieved all smallest rings of all compounds in the ChEBI [<xref ref-type="bibr" rid="CR16">16</xref>] database. Each distinct discovered ring is considered a substructural pattern for a fingerprint bit.</p></list-item><list-item><p id="Par30">All connected subgraphs of non-hydrogen atoms with a maximum of one ring and a limited number of bonds were also considered a fingerprint bit. The bond limit is parameterized as the <sc>GraphSize</sc> parameter, set to 7 by default. The single ring condition was selected to efficiently solve canonization problems with multi-ring structures. For the fingerprint, the subgraph is converted to a number using a tree-hashing algorithm that consecutively removes leaves until only the ring remains; the ring is then hashed in its lexically minimal rotation.</p></list-item><list-item><p id="Par31">Multiplicity of features was encoded by creating a new fingerprint bit for each power of 2 of the repetitions. Other systems (including OrChem [<xref ref-type="bibr" rid="CR8">8</xref>] and RDKit [<xref ref-type="bibr" rid="CR27">27</xref>]) use a similar encoding of multiplicity.</p></list-item></list>The resulting fingerprints are suitable for storage in text-search databases. In the PubChem database, the Sachem/Lucy method identified 18.7 million distinct feature descriptors with approximately 860 identified features per compound on average, which is comparable to natural-language data at which text-search databases are targeted.<xref ref-type="fn" rid="Fn3">3</xref></p>
    </sec>
    <sec id="Sec7">
      <title>Storage, indexing, and processing details</title>
      <p id="Par33">In addition to using a different database back-end and matching algorithm, Sachem/OrChem differs from the original OrChem in the indexing method used. Instead of B-tree based indices, Sachem/OrChem uses a memory-mapped inverted bitmap index to speed up searching in fixed-size fingerprints.</p>
      <p id="Par34">Sachem/Lucy uses fingerprints as defined in "<xref rid="Sec6" ref-type="sec">Fingerprint structure</xref>" section instead of OrChem fingerprints, and indexes them in the Apache Lucy database [<xref ref-type="bibr" rid="CR20">20</xref>] (hence the name). Apache Lucy is a port of the well-established Apache Lucene [<xref ref-type="bibr" rid="CR19">19</xref>] text-search database to C. Our choice of Apache Lucy was motivated by the relative efficiency of C implementation compared to alternatives.</p>
      <p id="Par35">The fingerprints were adapted for storage in Apache Lucy as follows: identification of each fingerprint bit is encoded to a 36-bit integer and converted into a corresponding 6-byte base64 word suitable for being stored as a term in text documents. The resulting keywords are concatenated to a space-separated string and indexed as documents using a simple whitespace analyzer. The overall process is shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>.</p>
      <p id="Par36">From the user’s point of view, this adaptation to external indexing is called transparently from the PostgreSQL interface, which is common to both implementations.<fig id="Fig1"><label>Fig. 1</label><caption><p>Fingerprint processing in Sachem/Lucy. The left box shows a molecule from the compound database being broken into distinct substructural features by fingerprinting (only 4 are shown for demonstration); these are converted to keyword-like descriptors by hashing and stored in Apache Lucy. The right box shows the querying process. The query is broken into substructural features. These are then filtered to only include features with reasonable filtering power; the result is converted to keyword descriptors to build a text query, which is in turn run on Apache Lucy</p></caption><graphic xlink:href="13321_2018_282_Fig1_HTML" id="MO1"/></fig>
</p>
    </sec>
    <sec id="Sec8">
      <title>Screening performance optimization by bit selection</title>
      <p id="Par37">In text-search databases, the presence of a keyword in the query forces the database to traverse the corresponding part of the inverted index, which is particularly costly for long lists associated with frequently occurring keywords. This introduces a tradeoff—in our setting, specifying a more precise query by including more fingerprint bits may improve the screen-out rate, but at the cost of increased overhead to process more data.</p>
      <p id="Par38">To balance the factors in this tradeoff and accelerate the querying process, our method simply discards the bits from the query fingerprint that are not significant in terms of filtering power. Using the resulting <italic>filtered query</italic> dramatically reduces the overhead needed to traverse the indices, and causes only a small increase in false positives. The query fingerprint bit-reduction algorithm performs the discarding in two steps: 1) it uses the information about subsumption to discard redundant bits and 2) it decides whether to discard less relevant bits based on their statistical relevance for search.</p>
      <p id="Par39">The first step of discarding is implemented in the query fingerprinting procedure, and is performed separately for all fingerprint types and repetition encoding. The procedures discard fingerprint bits if their presence is directly subsumed by others. This step does not lead to any additional false positives.</p>
      <p id="Par40">The second step attempts to discard bits that are expected not to contribute significantly to screen-out. The decision about discarding individual bits uses a pre-computed table with the relative filtering power of each distinct bit and extra information that connects query bits to corresponding “covered” query atoms. We considered an atom to be covered by a fingerprint bit if it is contained in part of the molecule that has caused the bit to be non-zero. From this information, the algorithm finds a small set of fingerprint bits that is expected to cover the query well and have sufficiently high filtering power to keep the resulting decrease in screen-out ratio relatively low. The <italic>bit-selection algorithm</italic> for the second step of fingerprint bit-reduction is detailed in Fig. <xref rid="Fig2" ref-type="fig">2</xref>.<fig id="Fig2"><label>Fig. 2</label><caption><p>Algorithm to select fingerprint bits most relevant to the given query. Upon input, it receives set <italic>q</italic> of fingerprint bits from the first step of the fingerprint reduction algorithm, set <italic>A</italic> of atoms that are in the query, and mapping <italic>M</italic> from the query fingerprint bits to corresponding covered atoms. The algorithm is parameterized by the positive integers <sc>MaxBits</sc> and <sc>MinCover</sc>. The <sc>MaxBits</sc> parameter is a hard limit on the count of bits in the reduced fingerprint, and the <sc>MinCover</sc> parameter sets the minimal count of distinct fingerprint bits in the reduced fingerprint that cover each atom present in the query molecule. The algorithm assigns a covering counter (initially set to zero) to each atom of the query molecule. The query fingerprint bits are then traversed in descending order of filtering power. For each bit, it is determined whether there exists a query atom that is covered by the bit information. If its associated counter is less than <sc>MinCover</sc>, all counters of atoms covered by the bit are increased, and the bit is added to the resulting reduced query fingerprint; otherwise, the bit is discarded. During the development, we experimentally determined that 2 and 32 are suitable values for <sc>MinCover</sc> and <sc>MaxBits</sc>, respectively. The filtering power of distinct bits (function <italic>F</italic>) is obtained by counting the relative occurrences of the bits in the dataset. The resulting <italic>F</italic> is portable to other datasets; re-computation is needed only after substantial statistical changes in data</p></caption><graphic xlink:href="13321_2018_282_Fig2_HTML" id="MO2"/></fig>
</p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Results and discussion</title>
    <p id="Par41">We performed a comprehensive benchmark to assess the performance and scaling advantages of Sachem and compare it with other available cartridges.</p>
    <sec id="Sec10">
      <title>Benchmark setup</title>
      <p id="Par42">We ran the same benchmark—storing a dataset in a cartridge and running a set of substructure queries on it—on all combinations of cartridges and datasets.</p>
      <p id="Par43">We recorded the time needed for overall query processing and for the screening phase. We counted the compounds that passed the screening and verification phases to compute screening precision and selectivity.</p>
      <sec id="Sec11">
        <title>Benchmarked cartridges</title>
        <p id="Par44">We benchmarked three variants of Sachem: the two versions described in this work, Sachem/OrChem and Sachem/Lucy, as well as <italic>Sachem/eCDK</italic>, which is a modification of Sachem/OrChem that differs only in fingerprinting procedure—it uses the ExtendedFingerprinter from the CDK library instead of OrChem fingerprints.</p>
        <p id="Par45">For our comparison, we focused on methods that are available in the form of cartridges with a SQL-based front-end. We included OrChem [<xref ref-type="bibr" rid="CR8">8</xref>] (version 1.3.1), RDKit [<xref ref-type="bibr" rid="CR27">27</xref>] (the PostgreSQL-based cartridge implementation with 2048-bit fingerprint, version 2017.09.1), Bingo [<xref ref-type="bibr" rid="CR15">15</xref>] (the PostgreSQL-based cartridge variant, version 1.8.0-beta) and pgchem [<xref ref-type="bibr" rid="CR14">14</xref>] (version 1.3-GiST).</p>
        <p id="Par46">All these cartridges use PostgreSQL, version 9.6, as a back-end database, except for OrChem, which we ran on Oracle database, version 12c.</p>
        <p id="Par47">Thorough comparisons of many other cartridges are available elsewhere [<xref ref-type="bibr" rid="CR31">31</xref>–<xref ref-type="bibr" rid="CR34">34</xref>], and these can be used to relate the performance of Sachem to cartridges not included in our benchmark.</p>
      </sec>
      <sec id="Sec12">
        <title>Datasets</title>
        <p id="Par48">To assess the performance scaling behavior of the cartridges, we ran the benchmarks on three datasets of different size. The <italic>94M</italic> dataset consists of all compounds in the PubChem database snapshot from August 2017 (PubChem contained just under 94 million molecules at the time). We randomly selected 10 million compounds from the 94M dataset to form the <italic>10M</italic> dataset, which was further randomly reduced to 1 million compounds in the <italic>1M</italic> dataset.</p>
        <p id="Par49">We chose to select the 1M dataset as a subset of 10M to avoid the effect of outliers (described in more detail in "<xref rid="Sec16" ref-type="sec">Performance outliers</xref>" section). Because some queries take much longer than average to be processed on certain molecules (e. g. cases in Fig. <xref rid="Fig4" ref-type="fig">4</xref>a, b), an unfortunate selection of molecules in the 1M dataset could make cartridges perform worse on it than on the 10M dataset. Selection as a subset ensures that the 10M dataset is at least as hard to process as the 1M dataset.</p>
        <p id="Par50">Some cartridges failed to index several molecules from the datasets; these errors are briefly summarized in Table <xref rid="Tab1" ref-type="table">1</xref>.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Overview of indexing and searching errors</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">Cartridge</th><th align="left" colspan="3">Indexing failures</th><th align="left" colspan="2">Rejected queries</th></tr><tr><th align="left">1M</th><th align="left">10M</th><th align="left">94M</th><th align="left"><italic>n</italic></th><th align="left">reason</th></tr></thead><tbody><tr><td align="left">Bingo</td><td align="left">105</td><td align="left">1024</td><td align="left">9754</td><td align="left">0</td><td align="left"/></tr><tr><td align="left">OrChem</td><td align="left">2</td><td align="left">4</td><td align="left">–</td><td align="left">12</td><td align="left">Unsupported aromatic bond in SMILES</td></tr><tr><td align="left">pgchem</td><td align="left">30</td><td align="left">255</td><td align="left">2527</td><td align="left">146</td><td align="left">Fragmented SMILES, queries with [*]</td></tr><tr><td align="left">RDKit</td><td align="left">72</td><td align="left">707</td><td align="left">6911</td><td align="left">4</td><td align="left">Chemical structure considered invalid</td></tr><tr><td align="left">Sachem</td><td align="left">0</td><td align="left">0</td><td align="left">0</td><td align="left">0</td><td align="left"/></tr></tbody></table><table-wrap-foot><p>Measurements are slightly influenced by errors that some cartridges exhibited during benchmarking, due to both indexing and searching errors. Indexing errors are primarily reported as unacceptable data in the SDF files from PubChem, most frequently as invalid atom valences or stereochemistry. Note that Bingo beta version can lower the number of indexing errors by using algorithms that work with ‘incorrect’ structures (this feature is disabled by default)</p></table-wrap-foot></table-wrap>
</p>
      </sec>
      <sec id="Sec13">
        <title>Query set</title>
        <p id="Par51">Design of a good, unbiased query set for benchmarks is complicated. It is not possible to derive such a set from a pre-existing statistic of common user queries, which favors popular queries viable for recently conducted research, or from identified features in the database, which favors queries based on the feature identification method and produces a bias towards database content.</p>
        <p id="Par52">To more easily draw comparisons with our systems, we re-used queries that have been benchmarked by other researchers available in Substructure Query Collection (SQC) [<xref ref-type="bibr" rid="CR35">35</xref>]. SQC includes queries used by Ehrlich and Matthias [<xref ref-type="bibr" rid="CR36">36</xref>] for a systematic benchmark for substructure search algorithms, and user queries collected from live software testing.</p>
        <p id="Par53">The collected queries are slightly biased toward simpler ‘explorative’ queries, but still represent a valid sample of queries in a publicly accessible database.</p>
        <p id="Par54">Of the 3488 queries present in the SQC query set, we removed 159 that are not supported by some of the cartridges; details can be found in Table <xref rid="Tab1" ref-type="table">1</xref>.</p>
      </sec>
      <sec id="Sec14">
        <title>Benchmarking hardware</title>
        <p id="Par55">All benchmarks were performed on CentOS Linux 7.4 running on virtualized Intel Haswell CPUs clocked at 2.6 GHz with 512 GB RAM; benchmarked software parts were run single-threaded. Results from the first runs of the benchmarks were discarded to allow the programs to cache hot data.<fig id="Fig3"><label>Fig. 3</label><caption><p>Overall performance comparison. Log-times in milliseconds are plotted on the <italic>x</italic> axis and log-percent of queries that took more than the plotted time are plotted on the <italic>y</italic> axis. Plots <bold>a</bold>–<bold>c</bold> show the performance comparison of Sachem/Lucy and Sachem/OrChem to other benchmarked cartridges on all datasets. The original OrChem was not benchmarked on the largest dataset due to the lengthy time that would be required to finish the benchmark. Plot <bold>d</bold> is a comparison of timings for Sachem/Lucy and Sachem/OrChem on all datasets that shows the scaling advantage of Sachem/Lucy</p></caption><graphic xlink:href="13321_2018_282_Fig3_HTML" id="MO3"/></fig>
</p>
      </sec>
    </sec>
    <sec id="Sec15">
      <title>Overall query performance</title>
      <p id="Par56">The overall timing results are summarized in plots in Fig. <xref rid="Fig3" ref-type="fig">3</xref>.</p>
      <p id="Par57">OrChem-based variants of Sachem outperformed all cartridges except Sachem/Lucy on all datasets. Sachem/OrChem was faster by an average factor <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$8\times$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mn>8</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_282_Article_IEq7.gif"/></alternatives></inline-formula> than Bingo, which slightly outperformed the RDKit and pgchem cartridges. The ordering of cartridges by performance was often mixed—RDKit clearly performed better than Bingo on faster queries, but the performance advantage was lost on complicated queries.</p>
      <p id="Par58">Thanks to improvements in screening (measured separately as described in "<xref rid="Sec17" ref-type="sec">Screening efficiency</xref>" section), Sachem/Lucy outperformed all other cartridges on the largest dataset by a wide margin. This advantage was partially lost on smaller datasets on fast queries, for which the Sachem/Lucy processing time was dominated by preparing the complicated fingerprint (less than 10 ms in most cases) and by increased overhead for the inverted index processing. However, as the performance disadvantage of Sachem/Lucy is at most approximately 10 ms for the majority of queries, we do not consider it to be a significant drawback. See Fig. <xref rid="Fig3" ref-type="fig">3</xref>d for a side-by-side comparison on all dataset sizes.</p>
      <p id="Par59">The same plot also illustrates the scalability improvement in Sachem/Lucy. While the time required by Sachem/OrChem to answer all queries was roughly linear with increasing dataset size, Sachem/Lucy behaved more efficiently. The query processing time in Sachem/Lucy scaled sub-linearly with dataset size, showing only around <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2\times$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_282_Article_IEq8.gif"/></alternatives></inline-formula> slowdown on a <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10\times$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:mn>10</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_282_Article_IEq9.gif"/></alternatives></inline-formula> larger dataset on median queries.<fig id="Fig4"><label>Fig. 4</label><caption><p>Noteworthy samples from three main classes of performance outliers identified during development: <bold>a</bold> PubChem compound CID20652954 (together with many similar compounds) is likely not a real molecule. Nevertheless, since there is no general method to identify a non-existent compound, it is not possible to reliably filter them out from the database. Trying to find an odd-length carbon cycle substructure in CID20652954 causes a complexity explosion; for example, matching the cycloheptadecane structure in it takes tens of minutes in all available cartridges before failing. <bold>b</bold> Matching a query that contains <italic>n</italic> benzene rings (above) in a compound that contains <italic>n</italic> or more benzene rings, but can only accommodate <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n-1$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_282_Article_IEq10.gif"/></alternatives></inline-formula> non-overlapping benzene rings (below) backtracks 12 times for each possible individual benzene position in the target molecule. In total, <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}((12n)^n)$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>12</mml:mn><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>n</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_282_Article_IEq11.gif"/></alternatives></inline-formula> different atom permutations must be examined before the query fails. <bold>c</bold> A multi-fragment query that is too simple to produce any fingerprint information with enough filtering power for efficient screening. The performance of evaluating such queries mainly depends on the efficiency of data serialization and deserialization at the software interfaces between the back-end database and user</p></caption><graphic xlink:href="13321_2018_282_Fig4_HTML" id="MO4"/></fig>
</p>
      <sec id="Sec16">
        <title>Performance outliers</title>
        <p id="Par60">Despite the performance improvements in the cartridges, there are several types of slow queries that are unlikely to be made more efficient by further development. Examples from the three main classes of such outliers are displayed in Fig. <xref rid="Fig4" ref-type="fig">4</xref>:<list list-type="alpha-lower"><list-item><p id="Par61">Matching long cycles in dense structure graphs may cause an unavoidable complexity explosion, which is a problem inherent to graph substructure matching. Several examples of such dense graphs appear in the datasets.</p></list-item><list-item><p id="Par62">Matching multi-fragment queries in which each fragment may fit into multiple positions in the target causes a backtracking explosion, which takes <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {O}(m^n)$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_282_Article_IEq12.gif"/></alternatives></inline-formula> time, where <italic>n</italic> is the number of fragments and <italic>m</italic> is the number of different embeddings of each fragment in the target.</p></list-item><list-item><p id="Par63">Screening can not reach the desired efficiency on queries that do not contain substructures with enough filtering power. These queries cause the cartridges to fetch large amounts of data from storage and run the verification algorithm on each of many identified positives.</p></list-item></list>
</p>
      </sec>
    </sec>
    <sec id="Sec17">
      <title>Screening efficiency</title>
      <p id="Par64">We compared the efficiencies of fingerprint-based screening processes in all cartridges in terms of precision (defined as the ratio of true positives to all identified positives identified by screening) and false positive rate (FPR, also known as fallout, defined as the ratio of false positives identified by screening to all negatives). Note that because the results from all cartridges differ slightly due to factors such as different perception of aromaticity and charges, the exact counts of positives and negatives are specific to each cartridge.<fig id="Fig5"><label>Fig. 5</label><caption><p>Screening efficiencies of different cartridges plotted as false positive rate and precision. OrChem values are not plotted because they are the same as those of Sachem/OrChem, which uses the same fingerprint. <bold>a</bold> Comparison of screening FPR for all queries in all cartridges; lower is better. Plotted values are the percent of queries from the query set that have a higher FPR when executed in given cartridge. For example, in Sachem/Lucy only <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5\%$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:mn>5</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_282_Article_IEq13.gif"/></alternatives></inline-formula> of the queries have FPR worse than <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10^{-3}$$\end{document}</tex-math><mml:math id="M28"><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13321_2018_282_Article_IEq14.gif"/></alternatives></inline-formula>, and just under <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$80\%$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:mn>80</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_282_Article_IEq15.gif"/></alternatives></inline-formula> of the queries have negligible FPR (less than <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10^{-5}$$\end{document}</tex-math><mml:math id="M32"><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13321_2018_282_Article_IEq16.gif"/></alternatives></inline-formula>). <bold>b</bold> Same comparison for different parameters of Sachem/Lucy. The solid red line indicates the default parameters of Sachem/Lucy. <bold>c</bold> Comparison of the screening precision of all cartridges; higher is better. Plotted values are the percent of queries in the corresponding cartridge that have at least the given precision. <bold>d</bold> Same comparison for different variants of Sachem/Lucy</p></caption><graphic xlink:href="13321_2018_282_Fig5_HTML" id="MO5"/></fig>
</p>
      <p id="Par65">Plots for FPR and precision of all measured cartridges, displayed in Fig. <xref rid="Fig5" ref-type="fig">5</xref>, show the advantage of the screening method used in Sachem/Lucy over all other cartridges. Sachem/Lucy is followed by Bingo in terms of both precision and FPR. The remaining cartridges perform similarly, except for minor advantages of Sachem/eCDK and pgchem in precision.</p>
      <sec id="Sec18">
        <title>Parameters of Sachem/Lucy</title>
        <p id="Par66">
          <fig id="Fig6">
            <label>Fig. 6</label>
            <caption>
              <p>Effect of different choices of <sc>GraphSize</sc> and <sc>MinCover</sc> parameters on screening performance in Sachem/Lucy. <bold>a</bold> Increasing the fingerprint parameter <sc>GraphSize</sc> produces a larger fingerprint and larger indices, but overall performance is improved, thanks to the ability to choose a better set of fingerprints for screening. Note the log-time is plotted. <bold>b</bold> The same plot illustrating different choices of the <sc>MinCover</sc> parameter for the query filtering parameter. Unfiltered queries lose performance due to the overhead of storage access. Query filtering reduces this overhead while increasing the rate of false positives, thus increasing verification time. While <sc>MinCover</sc> = 1 might seem optimal, a larger value is beneficial for processing more complicated queries</p>
            </caption>
            <graphic xlink:href="13321_2018_282_Fig6_HTML" id="MO6"/>
          </fig>
        </p>
        <p id="Par67">We focused specifically on how varying the Sachem/Lucy parameters affects screening efficiency.</p>
        <p id="Par68">Reducing the <sc>GraphSize</sc> fingerprint parameter caused an expected increase in false positives, which projected to an increased query processing time (Fig. <xref rid="Fig6" ref-type="fig">6</xref>a). The default value <sc>GraphSize</sc> = 7 allows the implementation to pick fewer, more precise fingerprint bits. Specific deployments of Sachem might benefit from lowering the the graph size parameter to save storage space.</p>
        <p id="Par69">Query filtering had a considerable effect on query processing time. Although it caused a minor increase in false positives (as seen in Fig. <xref rid="Fig5" ref-type="fig">5</xref>b, d), it increased overall query performance. Because the processing time of unfiltered queries is, in most cases, clearly dominated by screening time, trading off some screening precision is beneficial. Setting the <sc>MinCover</sc> parameter to values as low as 1 can induce <inline-formula id="IEq19"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10\times$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:mn>10</mml:mn><mml:mo>×</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2018_282_Article_IEq19.gif"/></alternatives></inline-formula> median speedup over unfiltered queries (see Fig. <xref rid="Fig6" ref-type="fig">6</xref>b). Screening time increases when the parameter is increased, but the overall query time does not seem seriously affected for values <sc>MinCover</sc> ≤ 5.</p>
        <p id="Par70">Although setting <sc>MinCover</sc> = 1 might seem optimal based on the results from the used query set, we use <sc>MinCover</sc> = 2 in Sachem/Lucy by default. This is substantiated by benchmarks on query sets that include larger queries, where the tradeoff is balanced differently. For example, finding a random subset of PubChem compounds in the 94M dataset runs optimally with parameter <sc>MinCover</sc> = 3, which is closely followed by <sc>MinCover</sc> = 2 (roughly 4% slower) and <sc>MinCover</sc> = 4 and 5 (9% and 15% slower). Setting <sc>MinCover</sc> = 1 is, in this case, almost 25% slower.</p>
      </sec>
    </sec>
    <sec id="Sec19">
      <title>Possible extensions and future goals</title>
      <p id="Par71">Sachem could easily be extended to similarity searches. The used text-search databases already recognize several notions of similarity measures, thresholds and top-N queries; after plugging in a matching similarity fingerprint, this functionality could be easily applied to high-performance similarity queries.</p>
      <p id="Par72">The ability to store and efficiently query fingerprints with a large number of keys is beneficial for several applications. For example, possible complications of substructure searches that arise from tautomerism or different perceptions of aromaticity could be resolved without significant impact on search performance. Simply indexing all possible tautomers or aromaticity variants is possible, at the cost of some storage space. An upper bound on the additional storage requirements can be estimated from the results of Sitzmann et al. [<xref ref-type="bibr" rid="CR37">37</xref>].</p>
      <p id="Par73">Similarly, many non-structural and quantitative measures of molecules can be encoded to bit fingerprints, which can greatly simplify the processing of queries with heterogeneous parameters (sometimes called hybrid queries [<xref ref-type="bibr" rid="CR38">38</xref>, section 2.4]). Consider a realistic query in which a researcher asks for a slightly alkaline compound with several substructures, available results in bioassays with high activity, limited molecular weight, and known binding with a protein. As this information is available in public databases, it could be easily converted to bit fingerprints and aggregated in a modified version of Sachem/Lucy. The resulting cartridge could answer any such query with similar performance as on the queries benchmarked in this paper. Alternative approaches to efficient querying of heterogeneous datasets in RDBMS include e. g. planner optimizations using cost estimation [<xref ref-type="bibr" rid="CR39">39</xref>].</p>
      <p id="Par74">A simple adaptation to arbitrary fingerprints may also benefit drug discovery. Given the results of a bioassay, it is not known which feature of the molecule causes the desired activity, nor whether the activity is caused by anything relatable to an extant molecular fingerprint that could in turn be used to screen new candidates from molecule databases. Not being restricted by fingerprint size allows the researcher to easily define better fingerprints, in which individual bits may a have better chance to match the cause of the activity. Sachem can index compounds using even very large fingerprints, making such results of screening and analyses quickly available to the researcher.</p>
      <p id="Par75">Finally, the horizontal scaling potential of text-search databases like ElasticSearch or Solr [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR22">22</xref>] could be easily exploited to provide a Google-like experience on a full-scale chemical substructure and similarity search. This is further supported by the fact that the software already supports Top-N queries and optimizations that are usually required to efficiently handle internet traffic.</p>
    </sec>
  </sec>
  <sec id="Sec20">
    <title>Conclusions</title>
    <p id="Par76">We have introduced Sachem, a new open-source cheminformatic cartridge oriented toward substructure search that improves the performance and scalability of substructural query processing.</p>
    <p id="Par77">Improvements in the OrChem-based indexing method enable Sachem/OrChem to process queries more than 50-fold faster than the original OrChem implementation. However, our results indicate that the original OrChem fingerprint design is still a viable choice for substructure screening.</p>
    <p id="Par78">The Sachem/Lucy variant, which is based on inverted indices, scales to very large datasets with similar or better performance than Sachem/OrChem on most dataset sizes. Compared to OrChem and other benchmarked methods, the Sachem/Lucy approach improves the precision of fingerprint-based screening. This variant stores a large fingerprint that identifies more than <inline-formula id="IEq27"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10^7$$\end{document}</tex-math><mml:math id="M36"><mml:msup><mml:mn>10</mml:mn><mml:mn>7</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13321_2018_282_Article_IEq27.gif"/></alternatives></inline-formula> distinct features. The ability to store and efficiently query fingerprints of this size may benefit potential future applications of this method to more complicated datasets.</p>
    <p id="Par79">Both Sachem variants were benchmarked against other currently available open-source cartridges, using the PubChem database as a dataset and the SQC query set as queries. Sachem variants clearly outperformed other cartridges on most queries. Moreover, the performance of Sachem/Lucy was less affected by dataset size and fingerprint complexity, which is a required property to efficiently handle extremely large compound databases.</p>
    <p id="Par80">We expect that improvements in the performance and applicable size of screening fingerprints will simplify the deployment of substructure searches in new contexts, especially in prediction systems and heterogeneous databases .</p>
  </sec>
  <sec id="Sec21">
    <title>Availability and requirements</title>
    <p id="Par81"><bold>Project name</bold>: sachem</p>
    <p id="Par82"><bold>Project home page</bold>: <ext-link ext-link-type="uri" xlink:href="http://bioinfo.uochb.cas.cz/sachem/">http://bioinfo.uochb.cas.cz/sachem/</ext-link></p>
    <p id="Par83"><bold>Operating system(s)</bold>: Linux</p>
    <p id="Par84"><bold>Programming language</bold>: C, C++, Java, SQL</p>
    <p id="Par85"><bold>Other requirements</bold>: Java 8 or higher, PostgreSQL 9.6 or higher.</p>
    <p id="Par86"><bold>License</bold>: GNU GPLv2</p>
    <p id="Par87"><bold>Any restrictions to use by non-academics</bold>: none other than those specified by the license.</p>
  </sec>
</body>
<back>
  <fn-group>
    <fn id="Fn1">
      <label>1</label>
      <p id="Par7">The growing demand for cartridge capacity is illustrated by the molecule count in PubChem, which has been doubling in size every 3 years. The growth is not expected to halt.</p>
    </fn>
    <fn id="Fn2">
      <label>2</label>
      <p id="Par13">Radial and ECFP-like fingerprints [<xref ref-type="bibr" rid="CR17">17</xref>] implicitly encode atom valences and thus are not generally applicable for substructure screening; a minor modification allows them to be used for queries in which the exact valence of atoms is requested.</p>
    </fn>
    <fn id="Fn3">
      <label>3</label>
      <p id="Par32">For comparison, Webster’s Third New International Dictionary reports around a half million keywords in English language alone.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Authors' contributions</title>
    <p>JG and JV designed the study. JG implemented the Sachem cartridge and Sachem/OrChem indexing method. MK implemented the Sachem/Lucy indexing method. JG performed the programming optimizations of Sachem code. JG implemented the benchmarking suite and processed the benchmarks. MK wrote the manuscript. All authors participated in preparing the manuscript. JG and JV supervised the project and revised the manuscript. All authors read and approved the final manuscript.</p>
    <sec id="FPar1">
      <title>Acknowledgements</title>
      <p id="Par89">This work was supported by ELIXIR CZ research infrastructure project (MEYS Grant No: LM2015047) including access to computing and storage facilities.</p>
    </sec>
    <sec id="FPar2">
      <title>Availability of data and materials</title>
      <p id="Par90">Molecular data used in the benchmarks are publicly available from the PubChem database; exact query sets, datasets and CIDs of the molecules that were randomly selected for the benchmarks described in the paper are published on the project web site.</p>
    </sec>
    <sec id="FPar3">
      <title>Competing interests</title>
      <p id="Par91">The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="d29e1395">
      <title>Ethics approval and consent to participate</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="FPar4">
      <title>Funding</title>
      <p id="Par92">This project was supported by ELIXIR CZ (MEYS), Grant number LM2015047. Funding for open access publication was provided by the Institute of Organic Chemistry and Biochemistry of the CAS (RVO), project number 61388963.</p>
    </sec>
    <sec id="FPar5">
      <title>Publisher’s Note</title>
      <p id="Par93">Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </sec>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Venkatraman</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Pérez-Nueno</surname>
            <given-names>VI</given-names>
          </name>
          <name>
            <surname>Mavridis</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ritchie</surname>
            <given-names>DW</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive comparison of ligand-based virtual screening tools against the DUD data set reveals limitations of current 3D methods</article-title>
        <source>J Chem Inf Model</source>
        <year>2010</year>
        <volume>50</volume>
        <issue>12</issue>
        <fpage>2079</fpage>
        <lpage>2093</lpage>
        <pub-id pub-id-type="doi">10.1021/ci100263p</pub-id>
        <pub-id pub-id-type="pmid">21090728</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weskamp</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Guided iterative substructure search (GI-SSS)-a new trick for an old dog</article-title>
        <source>Mol Inform</source>
        <year>2016</year>
        <volume>35</volume>
        <issue>6–7</issue>
        <fpage>286</fpage>
        <lpage>292</lpage>
        <pub-id pub-id-type="doi">10.1002/minf.201600063</pub-id>
        <pub-id pub-id-type="pmid">27492243</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barnard</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>Substructure searching methods: old and new</article-title>
        <source>J Chem Inf Comput Sci</source>
        <year>1993</year>
        <volume>33</volume>
        <issue>4</issue>
        <fpage>532</fpage>
        <lpage>538</lpage>
        <pub-id pub-id-type="doi">10.1021/ci00014a001</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhuang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Narayanapillai</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Sham</surname>
            <given-names>YY</given-names>
          </name>
          <name>
            <surname>Xing</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Rapid identification of Keap1-Nrf2 small-molecule inhibitors through structure-based virtual screening and hit-based substructure search</article-title>
        <source>J Med Chem</source>
        <year>2014</year>
        <volume>57</volume>
        <issue>3</issue>
        <fpage>1121</fpage>
        <lpage>1126</lpage>
        <pub-id pub-id-type="doi">10.1021/jm4017174</pub-id>
        <pub-id pub-id-type="pmid">24417449</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sheridan</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Kearsley</surname>
            <given-names>SK</given-names>
          </name>
        </person-group>
        <article-title>Why do we need so many chemical similarity search methods?</article-title>
        <source>Drug Discov Today</source>
        <year>2002</year>
        <volume>7</volume>
        <issue>17</issue>
        <fpage>903</fpage>
        <lpage>911</lpage>
        <pub-id pub-id-type="doi">10.1016/S1359-6446(02)02411-X</pub-id>
        <pub-id pub-id-type="pmid">12546933</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cereto-Massagué</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ojeda</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Valls</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Mulero</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Garcia-Vallvé</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pujadas</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Molecular fingerprint similarity search in virtual screening</article-title>
        <source>Methods</source>
        <year>2015</year>
        <volume>71</volume>
        <fpage>58</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ymeth.2014.08.005</pub-id>
        <pub-id pub-id-type="pmid">25132639</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Steinbeck</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hoppe</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kuhn</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Floris</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Guha</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Willighagen</surname>
            <given-names>EL</given-names>
          </name>
        </person-group>
        <article-title>Recent developments of the chemistry development kit (CDK)-an open-source java library for chemo-and bioinformatics</article-title>
        <source>Curr Pharm Des</source>
        <year>2006</year>
        <volume>12</volume>
        <issue>17</issue>
        <fpage>2111</fpage>
        <lpage>2120</lpage>
        <pub-id pub-id-type="doi">10.2174/138161206777585274</pub-id>
        <pub-id pub-id-type="pmid">16796559</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rijnbeek</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Steinbeck</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>OrChem—an open source chemistry search engine for Oracle®</article-title>
        <source>J Cheminform</source>
        <year>2009</year>
        <volume>1</volume>
        <issue>1</issue>
        <fpage>17</fpage>
        <pub-id pub-id-type="doi">10.1186/1758-2946-1-17</pub-id>
        <pub-id pub-id-type="pmid">20298521</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ihlenfeldt</surname>
            <given-names>WD</given-names>
          </name>
          <name>
            <surname>Takahashi</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Abe</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Sasaki</surname>
            <given-names>Si</given-names>
          </name>
        </person-group>
        <article-title>Computation and management of chemical properties in CACTVS: an extensible networked approach toward modularity and compatibility</article-title>
        <source>J Chem Inf Comput Sci</source>
        <year>1994</year>
        <volume>34</volume>
        <issue>1</issue>
        <fpage>109</fpage>
        <lpage>116</lpage>
        <pub-id pub-id-type="doi">10.1021/ci00017a013</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brown</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>YC</given-names>
          </name>
        </person-group>
        <article-title>Use of structure- activity data to compare structure-based clustering methods and descriptors for use in compound selection</article-title>
        <source>J Chem Inf Comput Sci</source>
        <year>1996</year>
        <volume>36</volume>
        <issue>3</issue>
        <fpage>572</fpage>
        <lpage>584</lpage>
        <pub-id pub-id-type="doi">10.1021/ci9501047</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yap</surname>
            <given-names>CW</given-names>
          </name>
        </person-group>
        <article-title>PaDEL-descriptor: an open source software to calculate molecular descriptors and fingerprints</article-title>
        <source>J Comput Chem</source>
        <year>2011</year>
        <volume>32</volume>
        <issue>7</issue>
        <fpage>1466</fpage>
        <lpage>1474</lpage>
        <pub-id pub-id-type="doi">10.1002/jcc.21707</pub-id>
        <pub-id pub-id-type="pmid">21425294</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Agrafiotis</surname>
            <given-names>DK</given-names>
          </name>
          <name>
            <surname>Rassokhin</surname>
            <given-names>DN</given-names>
          </name>
        </person-group>
        <article-title>Power Keys: a novel class of topological descriptors based on exhaustive subgraph enumeration and their application in substructure searching</article-title>
        <source>J Chem Inf Model</source>
        <year>2011</year>
        <volume>51</volume>
        <issue>11</issue>
        <fpage>2843</fpage>
        <lpage>2851</lpage>
        <pub-id pub-id-type="doi">10.1021/ci200282z</pub-id>
        <pub-id pub-id-type="pmid">21955134</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’Boyle</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Sayle</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Comparing structural fingerprints using a literature-based similarity benchmark</article-title>
        <source>J Cheminform</source>
        <year>2016</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>36</fpage>
        <pub-id pub-id-type="doi">10.1186/s13321-016-0148-0</pub-id>
        <pub-id pub-id-type="pmid">27382417</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">pgFoundry::pgChem::Tigress [Web page] (2011) <ext-link ext-link-type="uri" xlink:href="http://pgfoundry.org/projects/pgchem/">http://pgfoundry.org/projects/pgchem/</ext-link>. Accessed 9 Apr 2018</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pavlov</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Rybalkin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Karulin</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Bingo from SciTouch LLC: chemistry cartridge for Oracle database</article-title>
        <source>J Cheminform</source>
        <year>2010</year>
        <volume>2</volume>
        <fpage>1</fpage>
        <lpage>1</lpage>
        <pub-id pub-id-type="doi">10.1186/1758-2946-2-S1-F1</pub-id>
        <pub-id pub-id-type="pmid">20298528</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Degtyarenko</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>De Matos</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ennis</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hastings</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zbinden</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>McNaught</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ChEBI: a database and ontology for chemical entities of biological interest</article-title>
        <source>Nucleic Acids Res</source>
        <year>2007</year>
        <volume>36</volume>
        <issue>suppl-1</issue>
        <fpage>D344</fpage>
        <lpage>D350</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkm791</pub-id>
        <pub-id pub-id-type="pmid">17932057</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rogers</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hahn</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Extended-connectivity fingerprints</article-title>
        <source>J Chem Inf Model</source>
        <year>2010</year>
        <volume>50</volume>
        <issue>5</issue>
        <fpage>742</fpage>
        <lpage>754</lpage>
        <pub-id pub-id-type="doi">10.1021/ci100050t</pub-id>
        <pub-id pub-id-type="pmid">20426451</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Broder</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mitzenmacher</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Network applications of Bloom filters: a survey</article-title>
        <source>Internet Math</source>
        <year>2004</year>
        <volume>1</volume>
        <issue>4</issue>
        <fpage>485</fpage>
        <lpage>509</lpage>
        <pub-id pub-id-type="doi">10.1080/15427951.2004.10129096</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Białecki A, Muir R, Ingersoll G (2012) Lucid Imagination. Apache lucene 4. In: SIGIR 2012 workshop on open source information retrieval, p 17</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <mixed-citation publication-type="other">Apache Lucy [Web page] (2017) <ext-link ext-link-type="uri" xlink:href="https://lucy.apache.org/">https://lucy.apache.org/</ext-link>. Accessed 9 Apr 2018</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Smiley</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Pugh</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Parisa</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Mitchell</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <source>Apache Solr enterprise search server</source>
        <year>2015</year>
        <publisher-loc>Birmingham</publisher-loc>
        <publisher-name>Packt Publishing Ltd</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Kuc</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Rogozinski</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <source>Elasticsearch server</source>
        <year>2013</year>
        <publisher-loc>Birmingham</publisher-loc>
        <publisher-name>Packt Publishing Ltd</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Agrafiotis</surname>
            <given-names>DK</given-names>
          </name>
          <name>
            <surname>Rassokhin</surname>
            <given-names>DN</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Accelerating chemical database searching using graphics processing units</article-title>
        <source>J Cem Inf Model</source>
        <year>2011</year>
        <volume>51</volume>
        <issue>8</issue>
        <fpage>1807</fpage>
        <lpage>1816</lpage>
        <pub-id pub-id-type="doi">10.1021/ci200164g</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tao</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Qin</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Recent progresses in the exploration of machine learning methods as in-silico ADME prediction tools</article-title>
        <source>Adv Ddrug Deliv Rev</source>
        <year>2015</year>
        <volume>86</volume>
        <fpage>83</fpage>
        <lpage>100</lpage>
        <pub-id pub-id-type="doi">10.1016/j.addr.2015.03.014</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <mixed-citation publication-type="other">Duvenaud DK, Maclaurin D, Iparraguirre J, Bombarell R, Hirzel T, Aspuru-Guzik A et al. (2015) Convolutional networks on graphs for learning molecular fingerprints. In: Advances in neural information processing systems, pp 2224–2232</mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lavecchia</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Machine-learning approaches in drug discovery: methods and applications</article-title>
        <source>Drug Discov Today</source>
        <year>2015</year>
        <volume>20</volume>
        <issue>3</issue>
        <fpage>318</fpage>
        <lpage>331</lpage>
        <pub-id pub-id-type="doi">10.1016/j.drudis.2014.10.012</pub-id>
        <pub-id pub-id-type="pmid">25448759</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Landrum G et al. (2006) RDKit: open-source cheminformatics</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">MyChem [Web page] (2015) <ext-link ext-link-type="uri" xlink:href="http://mychem.sourceforge.net/">http://mychem.sourceforge.net/</ext-link>. Accessed 9 Apr 2018</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’Boyle</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Banck</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>James</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Morley</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Vandermeersch</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hutchison</surname>
            <given-names>GR</given-names>
          </name>
        </person-group>
        <article-title>Open Babel: an open chemical toolbox</article-title>
        <source>J Cheminform</source>
        <year>2011</year>
        <volume>3</volume>
        <issue>1</issue>
        <fpage>33</fpage>
        <pub-id pub-id-type="doi">10.1186/1758-2946-3-33</pub-id>
        <pub-id pub-id-type="pmid">21982300</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zamora</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>An algorithm for finding the smallest set of smallest rings</article-title>
        <source>J Chem Inf Comput Sci</source>
        <year>1976</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>40</fpage>
        <lpage>43</lpage>
        <pub-id pub-id-type="doi">10.1021/ci60005a013</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’Boyle</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Guha</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Willighagen</surname>
            <given-names>EL</given-names>
          </name>
          <name>
            <surname>Adams</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Alvarsson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bradley</surname>
            <given-names>JC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Open data, open source and open standards in chemistry: the blue obelisk five years on</article-title>
        <source>J Cheminform</source>
        <year>2011</year>
        <volume>3</volume>
        <issue>1</issue>
        <fpage>37</fpage>
        <pub-id pub-id-type="doi">10.1186/1758-2946-3-37</pub-id>
        <pub-id pub-id-type="pmid">21999342</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martin</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Monge</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Duret</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Gualandi</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Peitsch</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Pospisil</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Building an R&amp;D chemical registration system</article-title>
        <source>J Cheminform</source>
        <year>2012</year>
        <volume>4</volume>
        <issue>1</issue>
        <fpage>11</fpage>
        <pub-id pub-id-type="doi">10.1186/1758-2946-4-11</pub-id>
        <pub-id pub-id-type="pmid">22650418</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guilloux</surname>
            <given-names>VL</given-names>
          </name>
          <name>
            <surname>Arrault</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Colliandre</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Bourg</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Vayer</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Morin-Allory</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Mining collections of compounds with screening assistant 2</article-title>
        <source>J Cheminform</source>
        <year>2012</year>
        <volume>4</volume>
        <issue>1</issue>
        <fpage>20</fpage>
        <pub-id pub-id-type="doi">10.1186/1758-2946-4-20</pub-id>
        <pub-id pub-id-type="pmid">23327565</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <mixed-citation publication-type="other">May J, Sayle R (2015) Substructure search faceoff; 2015. Cambridge cheminformatics network meeting. <ext-link ext-link-type="uri" xlink:href="https://www.slideshare.net/NextMoveSoftware/substructure-search-faceoff">https://www.slideshare.net/NextMoveSoftware/substructure-search-faceoff</ext-link>. Accessed 9 Apr 2018</mixed-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <mixed-citation publication-type="other">Dalke A (2014) Substructural query collection; 2014. <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/dalke/sqc">https://bitbucket.org/dalke/sqc</ext-link>. Accessed 09 Apr 2018</mixed-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ehrlich</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Rarey</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Systematic benchmark of substructure search in molecular graphs-from Ullmann to VF2</article-title>
        <source>J Cheminform</source>
        <year>2012</year>
        <volume>4</volume>
        <issue>1</issue>
        <fpage>13</fpage>
        <pub-id pub-id-type="doi">10.1186/1758-2946-4-13</pub-id>
        <pub-id pub-id-type="pmid">22849361</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sitzmann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ihlenfeldt</surname>
            <given-names>WD</given-names>
          </name>
          <name>
            <surname>Nicklaus</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <article-title>Tautomerism in large databases</article-title>
        <source>J Comput-Aid Mol Des</source>
        <year>2010</year>
        <volume>24</volume>
        <issue>6–7</issue>
        <fpage>521</fpage>
        <lpage>551</lpage>
        <pub-id pub-id-type="doi">10.1007/s10822-010-9346-4</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krallinger</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rabal</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Lourenço</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Oyarzabal</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Valencia</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Information retrieval and text mining technologies for chemistry</article-title>
        <source>Chem Rev</source>
        <year>2017</year>
        <volume>117</volume>
        <issue>12</issue>
        <fpage>7673</fpage>
        <lpage>7761</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.chemrev.6b00851</pub-id>
        <pub-id pub-id-type="pmid">28475312</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Agrafiotis</surname>
            <given-names>DK</given-names>
          </name>
          <name>
            <surname>Lobanov</surname>
            <given-names>VS</given-names>
          </name>
          <name>
            <surname>Shemanarev</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rassokhin</surname>
            <given-names>DN</given-names>
          </name>
          <name>
            <surname>Izrailev</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Jaeger</surname>
            <given-names>EP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Efficient substructure searching of large chemical libraries: the ABCD chemical cartridge</article-title>
        <source>J Chem Inf Model</source>
        <year>2011</year>
        <volume>51</volume>
        <issue>12</issue>
        <fpage>3113</fpage>
        <lpage>3130</lpage>
        <pub-id pub-id-type="doi">10.1021/ci200413e</pub-id>
        <pub-id pub-id-type="pmid">22035187</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
