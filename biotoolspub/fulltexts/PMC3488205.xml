<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-id journal-id-type="hwp">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3488205</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gks666</article-id>
    <article-id pub-id-type="publisher-id">gks666</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Computational Biology</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Modelling and simulating generic RNA-Seq experiments with the flux simulator</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Griebel</surname>
          <given-names>Thasso</given-names>
        </name>
        <xref ref-type="aff" rid="gks666-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="gks666-AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zacher</surname>
          <given-names>Benedikt</given-names>
        </name>
        <xref ref-type="aff" rid="gks666-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="gks666-AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ribeca</surname>
          <given-names>Paolo</given-names>
        </name>
        <xref ref-type="aff" rid="gks666-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="gks666-AFF1">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Raineri</surname>
          <given-names>Emanuele</given-names>
        </name>
        <xref ref-type="aff" rid="gks666-AFF1">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lacroix</surname>
          <given-names>Vincent</given-names>
        </name>
        <xref ref-type="aff" rid="gks666-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="gks666-AFF1">
          <sup>6</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Guigó</surname>
          <given-names>Roderic</given-names>
        </name>
        <xref ref-type="aff" rid="gks666-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sammeth</surname>
          <given-names>Michael</given-names>
        </name>
        <xref ref-type="aff" rid="gks666-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="gks666-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="gks666-COR1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="gks666-AFF1"><sup>1</sup>Bioinformatics and Genomics Program, Centre de Regulació Genòmica (CRG), 08003 Barcelona, Spain, <sup>2</sup>Functional Bioinformatics Group, Centre Nacional d'Anàlisi Genòmica (CNAG), 08028 Barcelona, <sup>3</sup>Computational Biology and Regulatory Networks Group, Gene Center Munich, 81377 Munich, Germany, <sup>4</sup>Algorithm Development Group, <sup>5</sup>Statistical Genomics Group, Centre Nacional d'Anàlisi Genòmica (CNAG), 08028 Barcelona, Spain and <sup>6</sup>Biométrie et Biologie Évolutive, Université Lyon 1, 69622 Villeurbanne, France</aff>
    <author-notes>
      <corresp id="gks666-COR1">*To whom correspondence should be addressed. Tel: <phone>+34 696 635 659</phone>; Fax: <fax>+34 931 761 537</fax>; Email: <email>micha@sammeth.net</email></corresp>
      <fn>
        <p>The authors wish it to be known that, in their opinion, the first two authors should be regarded as joint First Authors.</p>
      </fn>
    </author-notes>
    <!--For NAR both ppub and collection dates generated for PMC processing 1/27/05 beck-->
    <pub-date pub-type="collection">
      <month>11</month>
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <month>11</month>
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>7</day>
      <month>9</month>
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>7</day>
      <month>9</month>
      <year>2012</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>40</volume>
    <issue>20</issue>
    <fpage>10073</fpage>
    <lpage>10083</lpage>
    <history>
      <date date-type="received">
        <day>23</day>
        <month>10</month>
        <year>2011</year>
      </date>
      <date date-type="rev-recd">
        <day>25</day>
        <month>5</month>
        <year>2012</year>
      </date>
      <date date-type="accepted">
        <day>16</day>
        <month>6</month>
        <year>2012</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2012. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2012</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/3.0">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/3.0">http://creativecommons.org/licenses/by-nc/3.0</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>High-throughput sequencing of cDNA libraries constructed from cellular RNA complements (RNA-Seq) naturally provides a digital quantitative measurement for every expressed RNA molecule. Nature, impact and mutual interference of biases in different experimental setups are, however, still poorly understood—mostly due to the lack of data from intermediate protocol steps. We analysed multiple RNA-Seq experiments, involving different sample preparation protocols and sequencing platforms: we broke them down into their common—and currently indispensable—technical components (reverse transcription, fragmentation, adapter ligation, PCR amplification, gel segregation and sequencing), investigating how such different steps influence abundance and distribution of the sequenced reads. For each of those steps, we developed universally applicable models, which can be parameterised by empirical attributes of any experimental protocol. Our models are implemented in a computer simulation pipeline called the Flux Simulator, and we show that read distributions generated by different combinations of these models reproduce well corresponding evidence obtained from the corresponding experimental setups. We further demonstrate that our <italic>in silico</italic> RNA-Seq provides insights about hidden precursors that determine the final configuration of reads along gene bodies; enhancing or compensatory effects that explain apparently controversial observations can be observed. Moreover, our simulations identify hitherto unreported sources of systematic bias from RNA hydrolysis, a fragmentation technique currently employed by most RNA-Seq protocols.</p>
    </abstract>
    <counts>
      <page-count count="11"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>INTRODUCTION</title>
    <p>Read abundances from RNA-Seq experiments reflect the quantities of different RNA molecules in the interrogated transcriptome (<xref ref-type="bibr" rid="gks666-B1">1</xref>). It is commonly accepted that gene expression profiles exhibit a similar shape across evolutionary distant organisms and functionally diverse cell types. Observations based on expressed sequence tags (<xref ref-type="bibr" rid="gks666-B2">2</xref>) show that most transcripts are rare, some are moderately abundant and only a small portion is very abundant. Such unbalanced distribution can be modelled using Zipf’s Law (<xref ref-type="bibr" rid="gks666-B3">3</xref>) which exhibits a characteristic linear behaviour in log–log (<xref ref-type="bibr" rid="gks666-B4">4</xref>). Furusawa and Kaneko (<xref ref-type="bibr" rid="gks666-B2">2</xref>) link the reason behind this observation to general thermodynamic diffusion constants that determine power law distributions in a large spectrum of biomolecules, whereas Ogasawara <italic>et al.</italic> (<xref ref-type="bibr" rid="gks666-B5">5</xref>) propose an evolutionary model.</p>
    <p>However, experimental protocols are increasingly reported to generate deviations from the expected read distributions (<xref ref-type="bibr" rid="gks666-B6 gks666-B7 gks666-B8">6–8</xref>). Since the first ultra sequencing experiments on cellular transcriptomes (<xref ref-type="bibr" rid="gks666-B9">9</xref>,<xref ref-type="bibr" rid="gks666-B10">10</xref>), sample preparations for so-called RNA-Seq have evolved in multiple respects and generated a considerable repertoire of protocols, which however all stem from a common set of elementary components. First and foremost, because all current sequencing technologies can only handle DNA substrates, reverse transcription (RT) of RNA into cDNA has to be accomplished. In the first protocols to be proposed for library preparation, RT constituted the initial step, involving either poly-<italic>d</italic>T (for poly-A+ transcriptomes) or random primers (usually hexamers) to initiate first-strand synthesis. Poly-<italic>d</italic>T oligomers primarily bind in the region of the poly-A tail, which—especially for long transcripts—can result in template loss during RT of the entire molecule and thereby cause a loss of 5′-end information (<xref ref-type="bibr" rid="gks666-B9">9</xref>). Randomly primed first-strand synthesis of full-length RNA molecules, in contrast, can lead to a relative over-representation of the 5′-end information (<xref ref-type="bibr" rid="gks666-B11">11</xref>). To diminish RT-related biases, RNA-Seq concepts have changed towards protocols that postpone RT after fragmentation, which seems to prevent a strong bias of read abundances towards the 3′-end (<xref ref-type="bibr" rid="gks666-B1">1</xref>).</p>
    <p>Second, fragmentation of transcripts is necessary because current sequencing platforms produce relatively short tags from the ends of much longer DNA molecules. Therefore, any attempt to sequence non-fragmented RNA populations would result in reads that exclusively reproduce the ends of transcripts. First RNA-Seq protocols relied on fragmentation by restriction enzymes (e.g. NlaIII or DpnII) to cleave reversely transcribed cDNA (<xref ref-type="bibr" rid="gks666-B9">9</xref>,<xref ref-type="bibr" rid="gks666-B12">12</xref>). Due to the sequence specificity of each restriction enzyme, however, the number of fragments produced by enzymatic digestion is not directly comparable between transcripts of different sequence compositions; for instance, ∼4% of known <italic>Drosophila melanogaster</italic> genes do not exhibit a NlaIII-recognition site (<xref ref-type="bibr" rid="gks666-B13">13</xref>), and even degradation by the endonuclease DNAseI—so far considered as unspecific—has recently been reported to exhibit strong sequence-selective characteristics (<xref ref-type="bibr" rid="gks666-B7">7</xref>). Therefore, efforts were soon directed towards the development of sequence-independent ‘random’ fragmentation protocols (<xref ref-type="bibr" rid="gks666-B13">13</xref>), at first by employing nebulisation, the physical shearing of cDNA molecules in a liquid medium (<xref ref-type="bibr" rid="gks666-B14">14</xref>). Although being cost-efficient and effective, nebulisation has been criticised for its inability to fragment DNA chains shorter than ∼700–800 nt and for producing suboptimal fragment size distributions when subsequent size selection steps are present (<xref ref-type="bibr" rid="gks666-B15">15</xref>). Consequently, current RNA-Seq protocols implement fragmentation by the controlled hydrolysis of RNA—usually catalysed by heat and acetate-complexed Mg<sup>2+</sup> or Zn<sup>2+</sup> ions (<xref ref-type="bibr" rid="gks666-B11">11</xref>)—which is generally considered to produce uniformly distributed fragments (<xref ref-type="bibr" rid="gks666-B1">1</xref>).</p>
    <p>After RT, during the ‘final library preparation’, adapter sequences are ligated to both sides of the double-stranded DNA molecules, which mediate the binding of fragments to beads and harbour primer-binding sites for amplification. Randomly primed RT (<xref ref-type="bibr" rid="gks666-B7">7</xref>) and/or the adapter ligation process (<xref ref-type="bibr" rid="gks666-B16">16</xref>,<xref ref-type="bibr" rid="gks666-B17">17</xref>) promote sequence-selective biases which manifest as motifs at the fragment ends (<xref ref-type="bibr" rid="gks666-B7">7</xref>,<xref ref-type="bibr" rid="gks666-B8">8</xref>); promising RNA-ligation based protocols avoiding both steps have been demonstrated (<xref ref-type="bibr" rid="gks666-B17">17</xref>,<xref ref-type="bibr" rid="gks666-B18">18</xref>). Before sequencing, fragments of the primary library are often amplified by a polymerase chain reaction (PCR), because the most cost-efficient sequencing platforms to date do not accept single molecule substrates. Amplification efficiency is known to depend on the GC content of the respective molecule (<xref ref-type="bibr" rid="gks666-B17">17</xref>), although controversial reports on the correlation between GC content and RNA-Seq coverage have been published (<xref ref-type="bibr" rid="gks666-B6">6</xref>,<xref ref-type="bibr" rid="gks666-B17">17</xref>,<xref ref-type="bibr" rid="gks666-B19">19</xref>). Leading high-throughput technology providers therefore suggest a size selection step in order to keep amplification biases under control by making fragment lengths homogeneous: e.g. 300–1000 nt long fragments are recommended for the Roche’s pyrosequencer (<xref ref-type="bibr" rid="gks666-B20">20</xref>), and 200 nt ± 25 nt are usually suggested for Illumina sequencing experiments. Size selection in general is implemented by gel electrophoresis, which suffers from artefacts like molecule aggregates (<xref ref-type="bibr" rid="gks666-B21">21</xref>).</p>
    <p>Finally, the ‘sequencing’ step obtains one arbitrary end (single reads) or both ends (paired-end reads) of the cDNA fragments in the library. Read sequences undergo modifications according to the technical limitations of the corresponding platform, e.g. insertions/deletions (indels) typically occur in reads produced by Roche pyrosequencing (<xref ref-type="bibr" rid="gks666-B22">22</xref>), whereas Illumina sequencing platforms mainly exhibit read sequences with an increased rate of nucleotide substitutions—and a correspondingly decreased quality—towards the read end (<xref ref-type="bibr" rid="gks666-B6">6</xref>). Additionally, the interplay between sequencing chemistry, sequencer machine calibration and the base calling algorithm employed during the downstream analysis of raw data determine subtle preferences in the so-called ‘crosstalk’, i.e. the misrecognition of chromophore-marked nucleotides (<xref ref-type="bibr" rid="gks666-B23">23</xref>).</p>
  </sec>
  <sec sec-type="materials|methods">
    <title>MATERIALS AND METHODS</title>
    <sec>
      <title>Simulation of different fragmentation processes</title>
      <sec>
        <title>Enzymatic digestion</title>
        <p>In our implementation of <italic>in silico</italic> enzymatic digestion, position weight matrices are employed to capture the sequence selectivity of the corresponding enzyme (e.g. NlaIII or DpnII) and fragmentation points of cDNA molecules are determined by importance sampling.</p>
      </sec>
      <sec>
        <title>Nebulisation</title>
        <p>According to preliminary modelling attempts (<xref ref-type="bibr" rid="gks666-B24">24</xref>), potential breakpoints are distribtuted as a Gaussian function around the molecules’ midpoints and the breaking probability is drawn from an exponential of the ratio between the fragment size and the limiting size below which molecules are unlikely to be broken any further (λ = 700 nt for cDNA, <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks666/DC1">Supplementary Methods</ext-link>).</p>
      </sec>
      <sec>
        <title>Hydrolysis</title>
        <p>Previously published models of hydrolysis are based on the assumption that fragment sizes produced by uniformly random fragmentation of molecules with the same length fall along a characteristic Weibull distribution, if the decay rate depends on molecule size (<xref ref-type="bibr" rid="gks666-B25">25</xref>). Here we propose a model for transcript populations of heterogeneous lengths, where we empirically derive a logarithmic dependence of the Weibull shape-parameter on the molecule’s length (see <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks666/DC1">Supplementary Methods</ext-link> and Results section).</p>
      </sec>
    </sec>
    <sec>
      <title>Simulation of reverse transcription</title>
      <p>We model RT separately for first- and second-strand synthesis. The start point depends on the priming strategy (i.e. parameters Poly-<italic>d</italic>T or random) and optionally by a position weight matrix (PWM) describing the sequence bias. The primer extension length is parameterised by the minimum (<italic>RT</italic><sub>min</sub>) and maximum length (<italic>RT</italic><sub>max</sub>) of the expected cDNA molecules (<ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks666/DC1">Supplementary Methods</ext-link>).</p>
    </sec>
    <sec>
      <title>Simulated size selection</title>
      <p>As for the fragment sizes observed after gel electrophoresis, the Flux Simulator accepts parameterised normal distributions or empirical distributions. Fragments are subsampled according to such distributions, either by acceptance–rejection sampling or by the Metropolis–Hastings algorithm (<xref ref-type="bibr" rid="gks666-B26">26</xref>,<xref ref-type="bibr" rid="gks666-B27">27</xref>).</p>
    </sec>
    <sec>
      <title>Simulated adapter ligation and PCR amplification</title>
      <p>We simulate the reaction kinetics of the adapter ligation process—reflected by motifs of sequences that are preferred by the involved enzymes—as Bernoulli trials parameterised by a PWM representing the sequence bias. PCR-amplification is sensitive to the GC content of the amplified DNA stretches and in agreement with previous observations (<xref ref-type="bibr" rid="gks666-B17">17</xref>), we model PCR-efficiency as a quantity distributed normally about a GC-optimum (<ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks666/DC1">Supplementary Methods</ext-link>).</p>
    </sec>
    <sec>
      <title>Simulated sequencing</title>
      <p>During <italic>in silico</italic> sequencing, the fragments in the library are subsampled and the sequence of either an arbitrary end for single reads, or of both ends for paired mates, is obtained. The number of reads and their length may be specified; however, there cannot be more reads than the number of fragments in the library, nor can any read be longer than the fragment it comes from. The orientation of the reads is characteristic in sequencing-by-synthesis protocols (<xref ref-type="bibr" rid="gks666-B13">13</xref>,<xref ref-type="bibr" rid="gks666-B17">17</xref>) due to an intrinsic attribute of polymerases progressing strictly from 3′ to 5′ along the template (<ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks666/DC1">Supplementary Figure S1</ext-link>). For Illumina chemistry, we additionally implemented a quality-based error model (<ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks666/DC1">Supplementary Figure S2</ext-link>).</p>
    </sec>
    <sec>
      <title>Simulated gene expression</title>
      <p>In agreement with preliminary observations (<xref ref-type="bibr" rid="gks666-B2">2</xref>,<xref ref-type="bibr" rid="gks666-B5">5</xref>), our analysis of the reference data sets demonstrates that gene expression profiles estimated from RNA-Seq data exhibit an about linear shape in log–log space up to the first thousands of gene expression ranks (<ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks666/DC1">Supplementary Figure S3</ext-link>). By non-linear fitting to the experimental data, we deduced a modified Zipf’s Law, which we employ to assign randomised expression levels to genes and transcripts in our simulations (<ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks666/DC1">Supplementary Methods</ext-link>).</p>
      <p>In the Flux Simulator, we also include the simulation of two biologically relevant modifications of annotated transcripts: transcripts with the same splicing structure, i.e. identical configuration of introns that are removed during the processing of nascent RNA, still may vary in their precise transcription start site and in the length of their poly-A tail (<ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks666/DC1">Supplementary Methods</ext-link>). These features can have a significant impact on the physical attributes of the corresponding molecules, playing an important role during library preparation.</p>
    </sec>
    <sec>
      <title>Data source and basic processing</title>
      <p>For our analysis, we employed publicly available read data (<ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks666/DC1">Supplementary Methods</ext-link>) from: <italic>Saccharomyces cerevisiae</italic> (<xref ref-type="bibr" rid="gks666-B9">9</xref>), <italic>Arabidopsis thaliana</italic> (<xref ref-type="bibr" rid="gks666-B28">28</xref>), <italic>Mus musculus</italic> (<xref ref-type="bibr" rid="gks666-B11">11</xref>), the same <italic>Homo sapiens</italic> sample sequenced with two different RNA-Seq protocols, i.e. flowcell RT-Seq (FRT) and standard hydrolysis (STD) protocol (17), and RNA control sequences spiked-in in high concentrations (<xref ref-type="bibr" rid="gks666-B29">29</xref>). In a first step, we mapped and split-mapped non-redundantly all the reads to the respective reference genome sequence using the GEM library (<ext-link ext-link-type="uri" xlink:href="http://sourceforge.net/projects/gemlibrary">http://sourceforge.net/projects/gemlibrary</ext-link>); in the case of the cress data set, which is comparatively small, we also considered additional read mappings with long indels obtained with BLAT (<xref ref-type="bibr" rid="gks666-B30">30</xref>).</p>
      <p>Subsequently, we focused on the distribution of reads that map to transcripts without alternatively processed forms. To define such transcripts, we considered a standard reference annotation of the transcriptome, i.e. the SGD annotation for yeast (<xref ref-type="bibr" rid="gks666-B31">31</xref>), the TAIR annotation for cress (<xref ref-type="bibr" rid="gks666-B32">32</xref>) and the murine as well as the human RefSeq annotation (<xref ref-type="bibr" rid="gks666-B33">33</xref>). This procedure provided us with mappings for 6 606 768 reads (47%) from yeast, 351 336 reads (65%) from cress and for 21 359 481 reads (68%) from mouse, and with 530 996 reads that map in proper pairs to the spike-in control sequences. Due to substantially different data set sizes (90 million versus 13 million reads), in the case of the human FRT- and the STD-Seq experiments, we extracted subsets of reads of suitable size before mapping to ensure comparability (<ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks666/DC1">Supplementary Table S1</ext-link>).</p>
    </sec>
  </sec>
  <sec sec-type="results">
    <title>RESULTS</title>
    <sec sec-type="intro">
      <title>Overview of the Flux Simulator RNA-Seq pipeline</title>
      <p>We implemented a computer pipeline for simulating RNA-Seq experiments—which we call the Flux Simulator—comprising explicit models for the processes that determine abundance and distribution of read tags according to the specified experimental protocol (see <xref ref-type="fig" rid="gks666-F1">Figure 1</xref> and Methods section). Starting from a genomic sequence for a certain species and a corresponding annotation of gene structures, the first step of this pipeline is, in fact, a transcriptome simulation (<xref ref-type="fig" rid="gks666-F1">Figure 1</xref>A) where—if no pre-defined cell expression profile is available—annotated genes and transcripts are assigned randomised expression levels according to the general laws of gene expression (<ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks666/DC1">Supplementary Figure S3</ext-link>).
<fig id="gks666-F1" position="float"><label>Figure 1.</label><caption><p>Outline of the Flux Simulator pipeline. Provided the genomic sequence of an organism and a representative gene annotation as input, the initial step is a transcriptome simulation (<bold>A</bold>) to assign each transcript a randomised expression level according to general laws of gene expression. Subsequently, fragmentation (<bold>B</bold>) and RT (<bold>C</bold>) are carried out, either by first hydrolysing RNA and then transcribing the fragments into cDNA molecules (B and C, right) or by nebulisation respectively enzymatic digestion after reversely transcribing the entire RNA molecules (B and C, left). The simulated molecules of the primary library then get amplified by <italic>in silico</italic> PCR (<bold>D</bold>)—optionally after selecting a certain size range—and the final library then is subjected to simulated sequencing (<bold>E</bold>), including potential platform and sequencing chemistry specific error models. Finally, read sequences along with their genomic mappings are obtained.</p></caption><graphic xlink:href="gks666f1p"/></fig></p>
      <p>Next, the <italic>in silico</italic> transcriptome undergoes RT/fragmentation (<xref ref-type="fig" rid="gks666-F1">Figure 1</xref>B and C) according to the established experimental techniques: in one possible scenario, RNA molecules are first reversely transcribed into cDNA—adopting poly-<italic>d</italic>T or random primers—and afterwards fragmented by nebulisation or enzymatic digestion (<xref ref-type="fig" rid="gks666-F1">Figure 1</xref>B and C, left); alternatively, fragmentation is carried out by RNA hydrolysis before fragments are transcribed into cDNA molecules by random priming (<xref ref-type="fig" rid="gks666-F1">Figure 1</xref>B and C, right).</p>
      <p>The Flux Simulator pipeline also provides optional steps to model the final library preparation, involving <italic>in silico</italic> ligation of adapter sequences, fragment size selection and PCR amplification (<xref ref-type="fig" rid="gks666-F1">Figure 1</xref>D). Eventually high-throughput sequencing is simulated at the level of the single DNA molecule, offering the possibility to include platform-specific base calling errors (<xref ref-type="fig" rid="gks666-F1">Figure 1</xref>E). The output comprises the read sequences and their genomic locations.</p>
    </sec>
    <sec>
      <title>Physical properties of fragments produced by RNA-hydrolysis</title>
      <p>By ‘uniform fragmentation’ we refer to the sequence-independent selection of breakpoints, as implemented for instance by DNA nebulisation or RNA hydrolysis, which is not to be confused with uniform breakpoint distributions along each transcript. In contrast to reports on the unequal representation of transcripts by nebulisation, fragmentation from RNA hydrolysis is considered to produce fragments of comparable lengths (<xref ref-type="bibr" rid="gks666-B11">11</xref>) without positional preferences (<xref ref-type="bibr" rid="gks666-B1">1</xref>). In this section, we study both hypotheses by simulating with our pipeline the experimental distributions observed for the so-called spike-in controls of known sequences (<xref ref-type="bibr" rid="gks666-B29">29</xref>). To this end, we extend a model proposed for uniform random fragmentation processes when the breaking probability depends on molecule size (<xref ref-type="bibr" rid="gks666-B25">25</xref>).</p>
      <p>Paired-end reads generated from spike-in control sequences are particularly well suited to assess differences in fragment size distributions, as biases from incomplete transcript annotation can safely be excluded, and fragment sizes can be estimated straightforwardly by the distance between mapped read mates. <xref ref-type="fig" rid="gks666-F2">Figure 2</xref>A demonstrates that fragments originating from three highly covered control sequences having substantially different lengths (i.e. 35 838 hydrolysis fragments from the 11 934 nt long Lambdaclone1-1, 472 364 fragments from the 1429 nt long OBF5, and 21 264 fragments from the 376 nt VATG sequence) also exhibit markedly different size distributions: when an arbitrary size of 150 nt is chosen as the threshold between short and long forms, we observe 36% fragments &lt;150 nt for the short RNA control VATG (<xref ref-type="fig" rid="gks666-F2">Figure 2</xref>A, green curve), whereas short fragments account for only 22% of the molecules in the case of the typical messenger-sized control OBF5 (<xref ref-type="fig" rid="gks666-F2">Figure 2</xref>A, red curve), and their proportion drops to 15% for the long control sequence Lambdaclone1-1 (<xref ref-type="fig" rid="gks666-F2">Figure 2</xref>A, blue curve).
<fig id="gks666-F2" position="float"><label>Figure 2.</label><caption><p>The size of an RNA molecule determines the hydrolysed fragments’ size distribution. (<bold>A</bold>) Theoretical and experimentally measured probability distributions of three control sequences with significantly distinct lengths: VATG (376 nt long, green lines), OBF5 (1429 nt, red lines) and Lambdaclone1-1 (11 934 nt, blue lines). The solid lines represent frequencies observed by the reads of an experiment, whereas the dashed lines are simulated results, obtained by the procedure depicted in B and C. Lambdaclone1-1—the longest control sequence—exhibits relatively less short fragments (blue curve), whereas VATG—the shortest control sequence—shows a comparatively lower fraction of long fragments (green curve). (<bold>B</bold>) The distribution used for simulated size filtering (solid line) is obtained by adjusting the insert size distribution observed across all sequences of the experiment (dashed-dotted line) with the combined distribution of insert sizes before filtering (dashed line), as estimated by simulated hydrolysis of the three spike-ins. During simulated size selection, weighted subsampling according to the filter distribution (solid line) is applied to the fragment size distributions (C) to derive the distributions predicted by the simulation after size filtering (A). (<bold>C</bold>) Computational prediction of fragment size distributions obtained from either control sequence after simulated hydrolysis, i.e. before size selection. According to the employed model, fragment sizes fall along Weibull distribution of same scale (= 200 nt) but different shapes (δ = 2.6, 3.2 and 4.1 for VATG, OBF5 and Lambdaclone1-1, respectively). Subjecting these simulated fragments to <italic>in silico</italic> size selection (B) can reproduce the differences observed in experimental results for the investigated controls (A).</p></caption><graphic xlink:href="gks666f2p"/></fig></p>
      <p>The analysed experiment employs a gel segregation step in which exclusively fragments with the overall size attributes shown in <xref ref-type="fig" rid="gks666-F2">Figure 2</xref>B are selected. Therefore, one cannot computationally cast back to the intermediate size distribution of fragments after fragmentation and before size selection. However, a previously published model for uniformly random fragmentation processes in molecules having the same length predicts that the sizes of the produced fragments follow a Weibull distribution—which is specified by two characteristic parameters, the shape (δ) and the scale (η). According to <xref ref-type="fig" rid="gks666-F2">Figure 2</xref>B we conducted an exhaustive search within the relevant parameter space followed by simulated size selection (<ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks666/DC1">Supplementary Materials and Methods</ext-link>) and we found that the differences observed for fragment sizes can be qualitatively reproduced employing a constant decay rate (η = 200 nt), with the further prescription that the shape parameters depend logarithmically on the molecule length (<ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks666/DC1">Supplementary Figure S4</ext-link>).</p>
      <p>With our parameterised hydrolysis model (η = 200 nt, δ∼2.6 for VATG, δ∼3.2 for OBF5 and δ∼4.1 for Lambdaclone1-1) we then investigated the abundance distribution of fragments observed along transcript bodies. To avoid biases that have been demonstrated to impact on the ends of fragments in the considered experimental protocol (<xref ref-type="bibr" rid="gks666-B7">7</xref>,<xref ref-type="bibr" rid="gks666-B8">8</xref>), we focused during our analysis on the distribution of fragment midpoints along the RNA molecule they have been derived from. The top panels of <xref ref-type="fig" rid="gks666-F3">Figure 3</xref> show the density of such fragment centres produced by <italic>in silico</italic> hydrolysis along the three transcript bodies of Lambdaclone1-1, OBF5 and VATG (primary axis), segregated by the respective fragment size (secondary axis). The corresponding bottom panels depict the experimental outcome, which is sensitive to additional influences from other steps (e.g. size selection).
<fig id="gks666-F3" position="float"><label>Figure 3.</label><caption><p>RNA hydrolysis produces characteristic patterns of fragment accumulations. Distribution of fragment midpoints along RNA control sequences added to an RNA-Seq experiment that involves fragmentation by hydrolysis. The <italic>x</italic>-axis resolves the positions of fragment centres along the RNA control molecules VATG (right, 376 nt), OBF5 (centre, 1429 nt) and Lambdaclone1-1 (left, 11 934 nt long), whereas the <italic>y</italic>-axis segregates the obtained fragments according to their lengths. Data are shown as density scatter plots, with observed frequencies increasing from blue to red to yellow. The top panels show the distributions predicted by simulation employing the hydrolysis model implemented in the Flux Simulator, whereas the corresponding experimental outcome is shown in the bottom panels. Distinct points of fragment accumulations are notable in the short reference VATG and in the mRNA-sized control OBF5.</p></caption><graphic xlink:href="gks666f3p"/></fig></p>
      <p>Albeit there are differences, the positional biases predicted by the hydrolysis simulation reproduce qualitatively the patterns of fragment concentrations observed in the experiment: the short VATG control exhibits three such distinct points (<xref ref-type="fig" rid="gks666-F3">Figure 3</xref>, left), whereas the mRNA-sized OBF5 control shows seven fragment accumulations (<xref ref-type="fig" rid="gks666-F3">Figure 3</xref>, centre)—and in both cases such points are located with remarkable symmetry about the centre of the reference molecule. Density fluctuations of Lambdaclone1-1 (<xref ref-type="fig" rid="gks666-F3">Figure 3</xref>, right), the longest of the spike-in sequences considered, fall below the resolution limit of the diagram (<ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks666/DC1">Supplementary Figure S5</ext-link>).</p>
    </sec>
    <sec>
      <title>Convolution of physical with chemical biases</title>
      <p>After elucidating positional preferences caused by physical attributes of RNA molecules, we set off to establish computational models for capturing biases caused by a molecule’s sequence composition. Some sensitivity of RNA-Seq coverage to the GC content had already been noted earlier (<xref ref-type="bibr" rid="gks666-B6">6</xref>), especially in protocols involving PCR-amplification (<xref ref-type="bibr" rid="gks666-B17">17</xref>). In agreement with these previous studies we found that empirical PCR amplification efficiency can be appropriately modelled by a Gaussian distribution centred around a GC content of 50% (mean = 0.5, SD 0.1; <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks666/DC1">Supplementary Figure S6</ext-link>).</p>
      <p>In the case studies of spike-in sequences described in the previous section, we assessed the correlation between the number of fragments covering a certain position and the GC content in a window of 192 nt (the mean fragment size) centred at that position (<xref ref-type="fig" rid="gks666-F4">Figure 4</xref>, top panels): for the Lambdaclone1-1 and the OBF5 controls we found a high correlation (Pearson coefficient of 0.91 and 0.97, respectively) between binned GC fraction and the respective fragment coverage, whereas in the VATG control both attributes strongly anti-correlated (Pearson coefficient −0.88). These apparently contradictory observations cannot be satisfactorily explained just by a significantly larger range of GC content in the former two controls (ranging from ∼30% to &gt;50% GC) as opposed to a quite tight spectrum (39–45% GC) in the latter case.
<fig id="gks666-F4" position="float"><label>Figure 4.</label><caption><p>Convolution of hydrolysis biases with sensitivity to GC content. The GC content of the three spike-in controls has been measured per position considering a surrounding window corresponding to the mean observed insert size (192 nt). To estimate coverage, the number of fragments that include a respective position is taken into account. Top panels: for each of 20 equally sized GC bins (<italic>x</italic>-axis), a box plot summarizes the distribution of fragment coverage (<italic>y</italic>-axis). Within their specific spectrum of GC content, Lambdaclone1-1 and OBF5 show a positive correlation of coverage with GC content, whereas for the VATG control, GC content and coverage anti-correlate. Bottom panels: the GC content (blue curve, normalised to [0;1] for each transcript) along the molecules (<italic>x</italic>-axis) is shown in comparison with the relative fragment coverage (red curve). Lambdaclone1-1 and OBF5 exhibit synchrone variations in GC content and coverage, whereas the relative GC content of VATG scores minimal around the molecule’s centre, where the mutual overlap of hydrolysis products provokes a peak in coverage (<xref ref-type="fig" rid="gks666-F3">Figure 3</xref>).</p></caption><graphic xlink:href="gks666f4p"/></fig></p>
      <p>The reasons behind this seemingly paradoxical dependence on GC content become clearer when considering GC-biases together with positional biases caused by fragmentation (<xref ref-type="fig" rid="gks666-F4">Figure 4</xref>, bottom panels): in Lambdaclone1-1 and OBF5 fragments, coverage (red curve) declines where GC content (blue curve) drops; in VATG (<xref ref-type="fig" rid="gks666-F4">Figure 4</xref>, right bottom panel), on the other hand, GC content shows a drop about the centre of the molecule where—consistent with our hydrolysis model (<xref ref-type="fig" rid="gks666-F3">Figure 3</xref>)—the mutual overlap of fragment accumulations causes a coverage peak (<xref ref-type="fig" rid="gks666-F4">Figure 4</xref>, left bottom panel). Similar observations hold for other control sequences from the same experiment. Interestingly, the transcript AGP, which has a length similar to that of VATG (325 nt versus 376 nt), exhibits—in contrast to VATG—a pronounced dependency of fragment coverage on GC: this is due to the fact that in the case of AGP, GC-distribution along the molecule and positional preferences of hydrolysis mutually amplify about the molecule’s centre (<ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks666/DC1">Supplementary Figure S7</ext-link>).</p>
    </sec>
    <sec>
      <title>Sequence-selectivity at the ends of sequenced fragments</title>
      <p>RNA-Seq is known to introduce biases not only in relation to the fraction of G and C nucleotides present in a sequence, but also for certain nucleotides towards the ends of a sequenced fragment, manifesting in motifs of bases preferred at specific positions (<xref ref-type="bibr" rid="gks666-B7">7</xref>). In agreement with earlier reports that predict fragment end positions by employing correspondingly observed motifs modelled as position weight matrices (PWMs), we found only moderate correlations between the observed fluctuations and the predictions based on PWMs (<xref ref-type="bibr" rid="gks666-B8">8</xref>). <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks666/DC1">Supplementary Figure S8</ext-link> depicts the effect of sequence-selectivity—which has been attributed to the enzyme–subtrate kinetics of randomly-primed reverse transcription process (<xref ref-type="bibr" rid="gks666-B7">7</xref>) and/or adapter ligation to cDNA molecules (<xref ref-type="bibr" rid="gks666-B16">16</xref>).</p>
      <p>To alleviate such biases, a modified hydrolysis protocol is sometimes performed, where the ligation of adapter sequences to the RNA molecule comes before RT and the latter is carried out with primers specifically targeting anchor sequences in the adapters. Variants of such ‘RNA-ligation’ based methods differ in the way adapter sequences are attached to the respective 5′- and 3′-ends of RNA fragments, e.g. by the use of standard RNA ligase (<xref ref-type="bibr" rid="gks666-B17">17</xref>) or by poly-A polymerase and special circular ligase (<xref ref-type="bibr" rid="gks666-B18">18</xref>).</p>
      <p>Both methods have been reported to improve the uniformity of read coverage along transcripts. Here we evaluate our computational models by analysing the difference between simulations with PWMs (derived from RNA-Seq data sets produced by the standard hydrolysis protocol) and the experimental results of the RNA-ligation method called FRT-Seq (as RT is performed on an Illumina flowcell), in the case of a human placental sample. In addition to the difference in substrate when ligating adapters, the FRT-protocol is PCR-free and employs no specific size selection step (<xref ref-type="bibr" rid="gks666-B17">17</xref>).</p>
      <p><xref ref-type="fig" rid="gks666-F5">Figure 5</xref> shows that the PWMs derived from read sequences differ substantially in the two cases. The information content, a logarithmic measure of the deviation from uniformly distributed nucleotide frequencies that correspond in the depicted sequence logos to the height of a stack of letters at every position, describes less severe biases in the FRT-Seq protocol (<xref ref-type="fig" rid="gks666-F5">Figure 5</xref>A) than in the standard hydrolysis protocol (<xref ref-type="fig" rid="gks666-F5">Figure 5</xref>B). Consequently, we observe a higher degree of transcript coverage in the FRT experiment (<xref ref-type="fig" rid="gks666-F5">Figure 5</xref>A versus B, black bars). The trend can be reproduced <italic>in silico</italic> when providing the corresponding PWM and de-activating simulated PCR and size selection (<xref ref-type="fig" rid="gks666-F5">Figure 5</xref>A and B, grey bars). Differences between the simulated and the experimental data set are mainly due to different mapping redundancies: on average ∼1.82 mappings per read are found for the experimental data set, whereas in the simulated data to every read exactly one mapping can be assigned.
<fig id="gks666-F5" position="float"><label>Figure 5.</label><caption><p>Correlation of sequence biases with transcript coverage in a standard hydrolysis experiment (<bold>A</bold>) and an RNA-ligation method (<bold>B</bold>). The panels above the bar plots depict sequence logos that capture biases as observed in the first six bases of sequenced reads, where the height of the letters are scaled according to the information content (IC), a logarithmic measurement that captures the divergence from equally distributed bases. The bar histogram in (A) and (B) show the corresponding transcript coverage by experimentally obtained reads (black bars), respectively, by correspondingly simulated reads (grey bars). The standard hydrolysis protocol exhibits stronger sequence selectivity that produces read stacks at specific positions and thereby reduces the overall transcript coverage.</p></caption><graphic xlink:href="gks666f5p"/></fig></p>
    </sec>
    <sec>
      <title>Simulation of generic RNA-Seq experiments</title>
      <p>We then employed the entire Flux Simulator pipeline to assess how well the models described so far—when combined—can mimic the overall distribution of reads along RNA molecules in populations of cellular transcripts. To allow the simulation of realistic transcript expression levels, we developed a transcriptome simulator: it is based on Zipf’s Law—which governs gene expression— and modified according to further empirical observations from RNA-Seq experiments (<ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks666/DC1">Supplementary Figure S3</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks666/DC1">Supplementary Table S2</ext-link>).</p>
      <p>Since sequencing-by-synthesis protocols produce reads whose first nucleotide identifies the fragment edge (i.e. the breakpoint) and whose mapping directionality further reveals the nature of the fragment edge (i.e. whether it constitutes a 5′- or 3′-end, <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks666/DC1">Supplementary Figures S1</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks666/DC1">S9</ext-link>), we separately focused on breakpoint distributions for reads mapping in sense and in antisense directions, thus preventing influences on sequence coverage by different read lengths. In our benchmark, we investigated four different experiments (i.e. the last four rows in <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks666/DC1">Supplementary Table S1</ext-link>) that differ in species/tissue of the sequenced RNA, sample preparation and sequencing platform (<xref ref-type="bibr" rid="gks666-B9">9</xref>,<xref ref-type="bibr" rid="gks666-B11">11</xref>,<xref ref-type="bibr" rid="gks666-B28">28</xref>). For each data set, we provide a parameterised <italic>in silico</italic> model (<ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks666/DC1">Supplementary Table S3</ext-link>), and we compare the experimental observation with the simulation.</p>
      <p>The results of our comparisons are summarized in <xref ref-type="fig" rid="gks666-F6">Figure 6</xref>. As a general trend, they reproduce earlier observations (<xref ref-type="bibr" rid="gks666-B28">28</xref>) that reads from 5′-ends of fragments (sense mappings) generally increase close to the 5′-end of transcripts and decrease close to the 3′-end, whereas the 3′-ends of fragments (antisense mappings) exhibit an inverse effect (<xref ref-type="fig" rid="gks666-F6">Figure 6</xref>). Our simulation reveals that the phenomenon is due to the fragmentation step, given that 5′/3′-ends of transcripts are also naturally included as 5′/3′-ends of some of the fragments produced from them; therefore, the fraction of transcription start sites preserved in the fragment population is higher for short transcripts that exhibit a comparatively lower number of breakpoints (<xref ref-type="fig" rid="gks666-F6">Figure 6</xref>, left panels). A corresponding increase of antisense mappings is predicted by our simulations at the 3′-end of the transcripts, however, corresponding reads fall into the poly-A tail not included in <xref ref-type="fig" rid="gks666-F6">Figure 6</xref>.
<fig id="gks666-F6" position="float"><label>Figure 6.</label><caption><p>Comparison of simulated reads with experimental evidence in different sequencing protocols. For each experiment, transcripts from a reference annotation of the corresponding species have been classified into short (&lt;1000 nt, left panels), intermediate (1000–2000 nt, centre panels), and long forms (&gt;2000 nt, right panels). Red and orange bars show reads from the experiment that align in sense and antisense, respectively, to the directionality of transcription, the corresponding <italic>in silico</italic> results are shown as dark and light blue bars, respectively. (<bold>A</bold>) Read tag distributions from an RNA hydrolysis protocol in <italic>M. musculus</italic> sequenced on the Illumina GA2 platform. (<bold>B</bold>) A different hydrolysis experiment carried out with the recent HiSeq2000 technology (Illumina), producing longer reads that exclusively map in sense orientation, so called ‘dir RNA-Seq’). (<bold>C</bold>) A complementary Illumina experiment employing poly-<italic>d</italic>T primed RT and subsequent DNAse digestion of the (poly-A<sup>+</sup>) transcriptome of <italic>S. cerevisisae</italic>. (<bold>D)</bold> Results from an experiment in <italic>A. thaliana</italic> where poly-<italic>d</italic>T primed RT products are fragmented by nebulisation.</p></caption><graphic xlink:href="gks666f6p"/></fig></p>
      <p>In <xref ref-type="fig" rid="gks666-F6">Figure 6</xref>A, we assessed the distribution of reads for the hydrolysis protocol investigated in detail in a previous section. In agreement with earlier reports (<xref ref-type="bibr" rid="gks666-B1">1</xref>), the transcript-specific biases we pinpoint are not identifiable when sufficiently heterogeneous molecule groups are considered together (<xref ref-type="bibr" rid="gks666-B11">11</xref>). Only the small reduction of reads next to the 5′-bin in transcripts with &lt;2000 nt reflects a cumulative effect of fragments that fall along sufficiently similar Weibull distribution (left and centre panel of <xref ref-type="fig" rid="gks666-F6">Figure 6</xref>A).</p>
      <p>In <xref ref-type="fig" rid="gks666-F6">Figure 6</xref>B, we compare these results with a recent adaptation of the hydrolysis protocol that has been employed to produce the Illumina Body Map 2 (accession number ERP000546 in the European Nucleotide Archive). The experiment produced reads exclusively from the sense strand of RNAs obtained from a mixture of 16 tissues (libraries HCT20170 and HCT20173). Therefore, only spurious amounts of antisense mappings can be observed which, in agreement with previous reports about antisense transcription, can be found especially at the 5′-/3′-ends of long transcripts (<xref ref-type="fig" rid="gks666-F6">Figure 6</xref>B, right panel).</p>
      <p>In this protocol, the longer reads (100 nt)—and therefore also larger fragments—cause a more accentuated drop of read density towards the 5′-end. Moreover, the use of a so-called ‘ribofree’ technology allows extracting RNA species without relying on the presence of a poly-A tail. We therefore expect the downstream ends of 3′-most fragments—which would be represented by antisense mappings absent from this experiment—are at (or close to) the respective cleavage sites. Consequently, we observe the frequency of sense mappings to decrease at positions closer than the average fragment size to 3′-end of the transcribed sequence. The effect is marginally stronger in experimental data than when reproduced <italic>in silico</italic>, indicating that additional mechanisms might play a role here. However, our simulations are able to qualitatively reproduce that 3′-regions which suffer from such read under-representation are comparatively larger in short and medium-sized transcripts (<xref ref-type="fig" rid="gks666-F6">Figure 6</xref>B, left and centre panel).</p>
      <p>To simulate the experiment depicted in <xref ref-type="fig" rid="gks666-F6">Figure 6</xref>C, we replaced the uniformly random fragmentation model by enzymatic digestion with DNAseI (<xref ref-type="bibr" rid="gks666-B9">9</xref>) and moved it after RT, which in this protocol has been realised by poly-<italic>d</italic>T priming on the original transcript templates. Our models correctly predict the under-representation of 5′-end information in poly-<italic>d</italic>T primed RT due to the simulated template loss of the reverse transcriptase during first-strand synthesis (<xref ref-type="bibr" rid="gks666-B1">1</xref>)—and an increasing impact of the bias from short to long transcripts (<xref ref-type="fig" rid="gks666-F6">Figure 6</xref>B, left versus centre versus right panel).</p>
      <p>In <xref ref-type="fig" rid="gks666-F6">Figure 6</xref>D, we compared simulation results to with an experiment employing cDNA nebulisation in contrast to fragmentation by DNAseI (<xref ref-type="bibr" rid="gks666-B28">28</xref>). Our model of mechanical breakage is able to reproduce the known bias of read distribution towards the centres of the transcripts (<xref ref-type="bibr" rid="gks666-B28">28</xref>), especially in shorter transcripts that break few times (<xref ref-type="fig" rid="gks666-F6">Figure 6</xref>D, left and centre panels); multiple recursive breaks along the body of long transcripts thin out these points of sharp breakpoint accumulation (<xref ref-type="fig" rid="gks666-F6">Figure 6</xref>D, right panel).</p>
    </sec>
  </sec>
  <sec sec-type="discussion">
    <title>DISCUSSION</title>
    <p>We present the Flux Simulator, a framework for simulating RNA-Seq experiments <italic>in silico</italic> that breaks down heterogeneous sample preparation protocols into their atomic steps (<xref ref-type="fig" rid="gks666-F1">Figure 1</xref>). For each step, we provide tunable computational models with a minimal set of free parameters, whose values can be estimated by corresponding quantities observed in real experiments. The Flux Simulator pipeline implements these steps as modules that can be flexibly joined: this structure allows simulation of arbitrary protocols. In the present article we focus on several protocols employed for the currently popular Illumina and Roche 454 sequencing platforms, but the modularity of our simulation platform allows analysis of arbitrary sequencing technologies, as those announced for the future by the manufacturers Ion Torrent (<xref ref-type="bibr" rid="gks666-B34">34</xref>) and Pacific Biosciences (<xref ref-type="bibr" rid="gks666-B35">35</xref>). Although our models are largely of approximate nature and describe in a simplified way the underlying complex chemistry, we show that our simulations reproduce fairly well the read distributions observed in practice (<xref ref-type="fig" rid="gks666-F6">Figure 6</xref>).</p>
    <p>If we accept that our bioinformatics models capture the main origins of the experimental biases, our simulation enables us to investigate intermediate stages of sequencing protocols—usually hidden layers of RNA-Seq (<xref ref-type="fig" rid="gks666-F2 gks666-F3 gks666-F4">Figures 2–4</xref>). Specifically, we give computational and experimental evidence as to why insert size distributions obtained by hydrolysis differ substantially between transcripts of different lengths (<xref ref-type="fig" rid="gks666-F2">Figure 2</xref>). In the light of the uniform random fragmentation model we developed, the dependence of the RNA molecules’ geometry on their length can be interpreted as shorter molecules being more linearised when hydrolysed, whereas longer RNA polymers—in spite of strongly denaturing conditions—still tend to form higher order structures. Therefore, size filtering alters the way transcripts are represented in the library as a function of the length of the original RNA molecule.</p>
    <p>In addition, our models show why fragments obtained by sequence-independent fragmentation processes, as for instance cDNA nebulisation or RNA hydrolysis, are not uniformly distributed along the fragmented molecule, but occur more frequently at rather specific points: the ends of nebulised fragments accumulate at the midpoints of recursively split molecules (<xref ref-type="fig" rid="gks666-F6">Figure 6</xref>D), whereas fragment density obtained by RNA hydrolysis propagates from a transcript’s ends towards its centre in patterns produced by characteristic Weibull distribution of the obtained insert sizes (<xref ref-type="fig" rid="gks666-F3">Figure 3</xref>). Onto these patterns one has to superimpose sequence-specific biases (<xref ref-type="fig" rid="gks666-F4">Figures 4</xref> and <xref ref-type="fig" rid="gks666-F5">5</xref>). If heterogeneous transcripts are considered together, however, the recognition of these biases on large scale is complicated (<xref ref-type="fig" rid="gks666-F6">Figure 6</xref>).</p>
    <p>As for the computational analysis of RNA-Seq experiments, we consider our simulation-based studies as a serious motivation to debunk the widespread belief that all biases should affect the interpretation of data negatively: in fact, well-understood biases of systematic nature are valuable as additional sources of information. Therefore, we are convinced that the critical evaluation of experiments mimicked <italic>in silico</italic> will have an increasing impact on design and evaluation of bioinformatics approaches to RNA-Seq.</p>
  </sec>
  <sec>
    <title>SUPPLEMENTARY DATA</title>
    <p><ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks666/DC1">Supplementary Data</ext-link> are available at NAR Online: Supplementary Tables 1–3, Supplementary Figures 1–9, Supplementary Methods and Supplementary References [36–42].</p>
  </sec>
  <sec>
    <title>AVAILABILITY</title>
    <p>The Flux Simulator is implemented in platform-portable Java code (JDK compliance 1.6), source code and binaries are freely available via the webpage <ext-link ext-link-type="uri" xlink:href="http://flux.sammeth.net">http://flux.sammeth.net</ext-link>.</p>
  </sec>
  <sec>
    <title>FUNDING</title>
    <p><funding-source>European Science Foundation (to T.G.)</funding-source>; <funding-source>Erasmus exchange grant of the European Community</funding-source> (to B.Z.); Post-doctoral fellowship of the <funding-source>Spanish Ministry of Science and Open Source license of Atlassian for their products Jira, Confluence and Fisheye (to M.S.); Spanish Ministry of Science</funding-source> (to R.G.) [<award-id>BIO2006-03380</award-id> and <award-id>CONSOLIDER CSD2007-00050</award-id>]. Funding for open access charge: <funding-source>Bioinformatics and Genomics Program, Centre de Regulació Genòmica (CRG)</funding-source>, <funding-source>08003 Barcelona, Catalunya, Spain</funding-source>.</p>
    <p><italic>Conflict of interest statement</italic>. None declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_40_20_10073__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_gks666_nar-02667-n-2011-File002.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>M.S. initiated and developed the Flux Simulator, designed and performed the data analyses and wrote the manuscript. T.G. implemented the position-based error models and contributed to multiple analyses. B.Z. assessed biases of multiple data sets and developed scripts for the automatic classification of RNA-Seq experiments. P.R., E.R., V.L. and R.G. contributed with fruitful discussions. All authors approved the manuscript.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="gks666-B1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Gerstein</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>RNA-Seq: a revolutionary tool for transcriptomics</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>57</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="pmid">19015660</pub-id>
      </element-citation>
    </ref>
    <ref id="gks666-B2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Furusawa</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kaneko</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Zipf's law in gene expression</article-title>
        <source>Phys. Rev. Lett.</source>
        <year>2003</year>
        <volume>90</volume>
        <fpage>088102</fpage>
        <pub-id pub-id-type="pmid">12633463</pub-id>
      </element-citation>
    </ref>
    <ref id="gks666-B3">
      <label>3</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Zipf</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <source>Human Behavior and the Principle of Least Effort</source>
        <year>1949</year>
        <publisher-loc>Cambridge</publisher-loc>
        <publisher-name>Addison–Wesley</publisher-name>
      </element-citation>
    </ref>
    <ref id="gks666-B4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brakman</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Garretsen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Van Marrewijk</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>van den Berg</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The return of Zipf: towards a further understanding of the rank-size distribution</article-title>
        <source>J. Regional Sci.</source>
        <year>1999</year>
        <volume>39</volume>
        <fpage>739</fpage>
        <lpage>767</lpage>
      </element-citation>
    </ref>
    <ref id="gks666-B5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ogasawara</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Kawamoto</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Okubo</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Zipf's law and human transcriptomes: an explanation with an evolutionary model</article-title>
        <source>C. R. Biol.</source>
        <year>2003</year>
        <volume>326</volume>
        <fpage>1097</fpage>
        <lpage>1101</lpage>
        <pub-id pub-id-type="pmid">14744119</pub-id>
      </element-citation>
    </ref>
    <ref id="gks666-B6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dohm</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Lottaz</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Borodina</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Himmelbauer</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Substantial biases in ultra-short read data sets from high-throughput DNA sequencing</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2008</year>
        <volume>36</volume>
        <fpage>e105</fpage>
        <pub-id pub-id-type="pmid">18660515</pub-id>
      </element-citation>
    </ref>
    <ref id="gks666-B7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hansen</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Brenner</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Dudoit</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Biases in Illumina transcriptome sequencing caused by random hexamer priming</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2010</year>
        <volume>38</volume>
        <fpage>e131</fpage>
        <pub-id pub-id-type="pmid">20395217</pub-id>
      </element-citation>
    </ref>
    <ref id="gks666-B8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schwartz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Oren</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ast</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Detection and removal of biases in the analysis of next-generation sequencing reads</article-title>
        <source>PLoS One</source>
        <year>2011</year>
        <volume>6</volume>
        <fpage>e16685</fpage>
        <pub-id pub-id-type="pmid">21304912</pub-id>
      </element-citation>
    </ref>
    <ref id="gks666-B9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nagalakshmi</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Waern</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Shou</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Raha</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gerstein</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The transcriptional landscape of the yeast genome defined by RNA sequencing</article-title>
        <source>Science</source>
        <year>2008</year>
        <volume>320</volume>
        <fpage>1344</fpage>
        <lpage>1349</lpage>
        <pub-id pub-id-type="pmid">18451266</pub-id>
      </element-citation>
    </ref>
    <ref id="gks666-B10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sultan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schulz</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Richard</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Magen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Klingenhoff</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Scherf</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Seifert</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Borodina</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Soldatov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Parkhomchuk</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A global view of gene activity and alternative splicing by deep sequencing of the human transcriptome</article-title>
        <source>Science</source>
        <year>2008</year>
        <volume>321</volume>
        <fpage>956</fpage>
        <lpage>960</lpage>
        <pub-id pub-id-type="pmid">18599741</pub-id>
      </element-citation>
    </ref>
    <ref id="gks666-B11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mortazavi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>McCue</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Schaeffer</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wold</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Mapping and quantifying mammalian transcriptomes by RNA-Seq</article-title>
        <source>Nat. Methods</source>
        <year>2008</year>
        <volume>5</volume>
        <fpage>621</fpage>
        <lpage>628</lpage>
        <pub-id pub-id-type="pmid">18516045</pub-id>
      </element-citation>
    </ref>
    <ref id="gks666-B12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hansen</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Lareau</surname>
            <given-names>LF</given-names>
          </name>
          <name>
            <surname>Blanchette</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Meng</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Rehwinkel</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gallusser</surname>
            <given-names>FL</given-names>
          </name>
          <name>
            <surname>Izaurralde</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Rio</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Dudoit</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide identification of alternative splice forms down-regulated by nonsense-mediated mRNA decay in Drosophila</article-title>
        <source>PLoS Genet.</source>
        <year>2009</year>
        <volume>5</volume>
        <fpage>e1000525</fpage>
        <pub-id pub-id-type="pmid">19543372</pub-id>
      </element-citation>
    </ref>
    <ref id="gks666-B13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Torres</surname>
            <given-names>TT</given-names>
          </name>
          <name>
            <surname>Metta</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ottenwalder</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Schlotterer</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Gene expression profiling by massively parallel sequencing</article-title>
        <source>Genome Res.</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>172</fpage>
        <lpage>177</lpage>
        <pub-id pub-id-type="pmid">18032722</pub-id>
      </element-citation>
    </ref>
    <ref id="gks666-B14">
      <label>14</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Surzycki</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <source>Basic Techniques in Molecular Biology</source>
        <year>2000</year>
        <publisher-loc>Berlin</publisher-loc>
        <publisher-name>Springer</publisher-name>
        <fpage>377</fpage>
        <lpage>380</lpage>
      </element-citation>
    </ref>
    <ref id="gks666-B15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quail</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Kozarewa</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Scally</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Swerdlow</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Turner</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>A large genome center's improvements to the Illumina sequencing system</article-title>
        <source>Nat. Methods</source>
        <year>2008</year>
        <volume>5</volume>
        <fpage>1005</fpage>
        <lpage>1010</lpage>
        <pub-id pub-id-type="pmid">19034268</pub-id>
      </element-citation>
    </ref>
    <ref id="gks666-B16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alon</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Vigneault</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Eminaga</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Christodoulou</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Seidman</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Church</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Eisenberg</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Bar-coding bias in high-throughput multiplex sequencing of miRNA</article-title>
        <source>Genome Res</source>
        <year>2011</year>
        <volume>21</volume>
        <fpage>1506</fpage>
        <lpage>1511</lpage>
        <pub-id pub-id-type="pmid">21750102</pub-id>
      </element-citation>
    </ref>
    <ref id="gks666-B17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mamanova</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Andrews</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>James</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Sheridan</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Ellis</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Langford</surname>
            <given-names>CF</given-names>
          </name>
          <name>
            <surname>Ost</surname>
            <given-names>TW</given-names>
          </name>
          <name>
            <surname>Collins</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Turner</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>FRT-seq: amplification-free, strand-specific transcriptome sequencing</article-title>
        <source>Nat. Methods</source>
        <year>2010</year>
        <volume>7</volume>
        <fpage>130</fpage>
        <lpage>132</lpage>
        <pub-id pub-id-type="pmid">20081834</pub-id>
      </element-citation>
    </ref>
    <ref id="gks666-B18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ingolia</surname>
            <given-names>NT</given-names>
          </name>
          <name>
            <surname>Ghaemmaghami</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Newman</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Weissman</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide analysis in vivo of translation with nucleotide resolution using ribosome profiling</article-title>
        <source>Science</source>
        <year>2009</year>
        <volume>324</volume>
        <fpage>218</fpage>
        <lpage>223</lpage>
        <pub-id pub-id-type="pmid">19213877</pub-id>
      </element-citation>
    </ref>
    <ref id="gks666-B19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roberts</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Donaghey</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rinn</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Improving RNA-Seq expression estimates by correcting for fragment bias</article-title>
        <source>Genome Biol.</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>R22</fpage>
        <pub-id pub-id-type="pmid">21410973</pub-id>
      </element-citation>
    </ref>
    <ref id="gks666-B20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lennon</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Lintner</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Anderson</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Alvarez</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Barry</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Brockman</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Daza</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Erlich</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Giannoukos</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A scalable, fully automated process for construction of sequence-ready barcoded libraries for 454</article-title>
        <source>Genome Biol.</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>R15</fpage>
        <pub-id pub-id-type="pmid">20137071</pub-id>
      </element-citation>
    </ref>
    <ref id="gks666-B21">
      <label>21</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Maniatis</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Fritsch</surname>
            <given-names>EF</given-names>
          </name>
          <name>
            <surname>Sambrook</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <source>Molecular Cloning: A Laboratory manual</source>
        <year>1982</year>
        <publisher-loc>NY</publisher-loc>
        <publisher-name>Cold Spring Harbor Laboratory, Cold Spring Harbor</publisher-name>
      </element-citation>
    </ref>
    <ref id="gks666-B22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Richter</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Ott</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Auch</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Schmid</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Huson</surname>
            <given-names>DH</given-names>
          </name>
        </person-group>
        <article-title>MetaSim: a sequencing simulator for genomics and metagenomics</article-title>
        <source>PLoS One</source>
        <year>2008</year>
        <volume>3</volume>
        <fpage>e3373</fpage>
        <pub-id pub-id-type="pmid">18841204</pub-id>
      </element-citation>
    </ref>
    <ref id="gks666-B23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Sanders</surname>
            <given-names>JZ</given-names>
          </name>
          <name>
            <surname>Kaiser</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Hughes</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Dodd</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Connell</surname>
            <given-names>CR</given-names>
          </name>
          <name>
            <surname>Heiner</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kent</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Hood</surname>
            <given-names>LE</given-names>
          </name>
        </person-group>
        <article-title>Fluorescence detection in automated DNA sequence analysis</article-title>
        <source>Nature</source>
        <year>1986</year>
        <volume>321</volume>
        <fpage>674</fpage>
        <lpage>679</lpage>
        <pub-id pub-id-type="pmid">3713851</pub-id>
      </element-citation>
    </ref>
    <ref id="gks666-B24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Iyengar</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Quave</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>A computer model for hydrodynamic shearing of DNA</article-title>
        <source>Comput. Prog. Biomed.</source>
        <year>1979</year>
        <volume>9</volume>
        <fpage>160</fpage>
        <lpage>168</lpage>
      </element-citation>
    </ref>
    <ref id="gks666-B25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tenchov</surname>
            <given-names>BG</given-names>
          </name>
          <name>
            <surname>Yanev</surname>
            <given-names>TK</given-names>
          </name>
          <name>
            <surname>Tihova</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>Koynova</surname>
            <given-names>RD</given-names>
          </name>
        </person-group>
        <article-title>A probability concept about size distributions of sonicated lipid vesicles</article-title>
        <source>Biochim. Biophys. Acta.</source>
        <year>1985</year>
        <volume>816</volume>
        <fpage>122</fpage>
        <lpage>130</lpage>
        <pub-id pub-id-type="pmid">4005231</pub-id>
      </element-citation>
    </ref>
    <ref id="gks666-B26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hastings</surname>
            <given-names>WK</given-names>
          </name>
        </person-group>
        <article-title>Monte Carlo sampling methods using Markov chains and their applications</article-title>
        <source>Biometrika</source>
        <year>1970</year>
        <volume>57</volume>
        <fpage>97</fpage>
        <lpage>109</lpage>
      </element-citation>
    </ref>
    <ref id="gks666-B27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Metropolis</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Rosenbluth</surname>
            <given-names>AW</given-names>
          </name>
          <name>
            <surname>Rosenbluth</surname>
            <given-names>MN</given-names>
          </name>
        </person-group>
        <article-title>Equations of state calculations by fast computing machines</article-title>
        <source>J. Chem. Phys.</source>
        <year>1953</year>
        <volume>21</volume>
        <fpage>1087</fpage>
        <lpage>1092</lpage>
      </element-citation>
    </ref>
    <ref id="gks666-B28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weber</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Weber</surname>
            <given-names>KL</given-names>
          </name>
          <name>
            <surname>Carr</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wilkerson</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ohlrogge</surname>
            <given-names>JB</given-names>
          </name>
        </person-group>
        <article-title>Sampling the arabidopsis transcriptome with massively parallel pyrosequencing</article-title>
        <source>Plant Physiol.</source>
        <year>2007</year>
        <volume>144</volume>
        <fpage>32</fpage>
        <lpage>42</lpage>
        <pub-id pub-id-type="pmid">17351049</pub-id>
      </element-citation>
    </ref>
    <ref id="gks666-B29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Pertea</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Mortazavi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kwan</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>van Baren</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Wold</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Transcript assembly and quantification by RNA-Seq reveals unannotated transcripts and isoform switching during cell differentiation</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2010</year>
        <volume>28</volume>
        <fpage>511</fpage>
        <lpage>515</lpage>
        <pub-id pub-id-type="pmid">20436464</pub-id>
      </element-citation>
    </ref>
    <ref id="gks666-B30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hsu</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Kent</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Clawson</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kuhn</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Diekhans</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Haussler</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>The UCSC known genes</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>1036</fpage>
        <lpage>1046</lpage>
        <pub-id pub-id-type="pmid">16500937</pub-id>
      </element-citation>
    </ref>
    <ref id="gks666-B31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Christie</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Weng</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Balakrishnan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Costanzo</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Dolinski</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Dwight</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Engel</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Feierbach</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Fisk</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Hirschman</surname>
            <given-names>JE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Saccharomyces genome database (SGD) provides tools to identify and analyze sequences from Saccharomyces cerevisiae and related sequences from other organisms</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2004</year>
        <volume>32</volume>
        <fpage>D311</fpage>
        <lpage>D314</lpage>
        <pub-id pub-id-type="pmid">14681421</pub-id>
      </element-citation>
    </ref>
    <ref id="gks666-B32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Swarbreck</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wilks</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lamesch</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Berardini</surname>
            <given-names>TZ</given-names>
          </name>
          <name>
            <surname>Garcia-Hernandez</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Foerster</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Muller</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ploetz</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Arabidopsis information resource (TAIR): gene structure and function annotation</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2008</year>
        <volume>36</volume>
        <fpage>D1009</fpage>
        <lpage>D1014</lpage>
        <pub-id pub-id-type="pmid">17986450</pub-id>
      </element-citation>
    </ref>
    <ref id="gks666-B33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pruitt</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Tatusova</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Maglott</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>NCBI reference sequences (RefSeq): a curated non-redundant sequence database of genomes, transcripts and proteins</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2007</year>
        <volume>35</volume>
        <fpage>D61</fpage>
        <lpage>D65</lpage>
        <pub-id pub-id-type="pmid">17130148</pub-id>
      </element-citation>
    </ref>
    <ref id="gks666-B34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rothberg</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Hinz</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Rearick</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Schultz</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Mileski</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Davey</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Leamon</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Milgrew</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Edwards</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An integrated semiconductor device enabling non-optical genome sequencing</article-title>
        <source>Nature</source>
        <year>2011</year>
        <volume>475</volume>
        <fpage>348</fpage>
        <lpage>352</lpage>
        <pub-id pub-id-type="pmid">21776081</pub-id>
      </element-citation>
    </ref>
    <ref id="gks666-B35">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Korlach</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Marks</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Cicero</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Gray</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Roitman</surname>
            <given-names>DB</given-names>
          </name>
          <name>
            <surname>Pham</surname>
            <given-names>TT</given-names>
          </name>
          <name>
            <surname>Otto</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Foquet</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Turner</surname>
            <given-names>SW</given-names>
          </name>
        </person-group>
        <article-title>Selective aluminum passivation for targeted immobilization of single DNA polymerase molecules in zero-mode waveguide nanostructures</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2008</year>
        <volume>105</volume>
        <fpage>1176</fpage>
        <lpage>1181</lpage>
        <pub-id pub-id-type="pmid">18216253</pub-id>
      </element-citation>
    </ref>
    <ref id="gks666-B36">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carninci</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Shibata</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hayatsu</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Sugahara</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Shibata</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Itoh</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Konno</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Okazaki</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Muramatsu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hayashizaki</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Normalization and subtraction of cap-trapper-selected cDNAs to prepare full-length cDNA libraries for rapid discovery of new genes</article-title>
        <source>Genome Res.</source>
        <year>2000</year>
        <volume>10</volume>
        <fpage>1617</fpage>
        <lpage>1630</lpage>
        <pub-id pub-id-type="pmid">11042159</pub-id>
      </element-citation>
    </ref>
    <ref id="gks666-B37">
      <label>37</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Davidson</surname>
            <given-names>EH</given-names>
          </name>
        </person-group>
        <source>Gene Activity in Early Development</source>
        <year>1976</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Academic Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="gks666-B38">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martin</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Pardee</surname>
            <given-names>AB</given-names>
          </name>
        </person-group>
        <article-title>Identifying expressed genes</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2000</year>
        <volume>97</volume>
        <fpage>3789</fpage>
        <lpage>3791</lpage>
        <pub-id pub-id-type="pmid">10760250</pub-id>
      </element-citation>
    </ref>
    <ref id="gks666-B39">
      <label>39</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carninci</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Sandelin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lenhard</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Katayama</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Shimokawa</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ponjavic</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Semple</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Engstrom</surname>
            <given-names>PG</given-names>
          </name>
          <name>
            <surname>Frith</surname>
            <given-names>MC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide analysis of mammalian promoter architecture and evolution</article-title>
        <source>Nat. Genet.</source>
        <year>2006</year>
        <volume>38</volume>
        <fpage>626</fpage>
        <lpage>635</lpage>
        <pub-id pub-id-type="pmid">16645617</pub-id>
      </element-citation>
    </ref>
    <ref id="gks666-B40">
      <label>40</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Mason</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Mane</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gilad</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>RNA-seq: an assessment of technical reproducibility and comparison with gene expression arrays</article-title>
        <source>Genome Res.</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>1509</fpage>
        <lpage>1517</lpage>
        <pub-id pub-id-type="pmid">18550803</pub-id>
      </element-citation>
    </ref>
    <ref id="gks666-B41">
      <label>41</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bienroth</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Keller</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Wahle</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Assembly of a processive messenger RNA polyadenylation complex</article-title>
        <source>EMBO J.</source>
        <year>1993</year>
        <volume>12</volume>
        <fpage>585</fpage>
        <lpage>594</lpage>
        <pub-id pub-id-type="pmid">8440247</pub-id>
      </element-citation>
    </ref>
    <ref id="gks666-B42">
      <label>42</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Williams</surname>
            <given-names>JG</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Williamson</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <source>Genetic Engineering</source>
        <year>1981</year>
        <volume>Vol. 1</volume>
        <publisher-name>Academic Press, New York</publisher-name>
        <fpage>2</fpage>
      </element-citation>
    </ref>
  </ref-list>
</back>
