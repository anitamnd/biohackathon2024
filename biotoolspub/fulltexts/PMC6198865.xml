<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6198865</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/bty389</article-id>
    <article-id pub-id-type="publisher-id">bty389</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Phylogenetics</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>RecPhyloXML: a format for reconciled gene trees</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-8854-7235</contrib-id>
        <name>
          <surname>Duchemin</surname>
          <given-names>Wandrille</given-names>
        </name>
        <xref ref-type="aff" rid="bty389-aff1">1</xref>
        <xref ref-type="aff" rid="bty389-aff2">2</xref>
        <xref ref-type="aff" rid="bty389-aff3">3</xref>
        <xref ref-type="aff" rid="bty389-aff4">4</xref>
        <xref ref-type="corresp" rid="bty389-cor1"/>
        <!--<email>wandrille.duchemin@univ-lyon1.fr</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gence</surname>
          <given-names>Guillaume</given-names>
        </name>
        <xref ref-type="aff" rid="bty389-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Arigon Chifolleau</surname>
          <given-names>Anne-Muriel</given-names>
        </name>
        <xref ref-type="aff" rid="bty389-aff5">5</xref>
        <xref ref-type="aff" rid="bty389-aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Arvestad</surname>
          <given-names>Lars</given-names>
        </name>
        <xref ref-type="aff" rid="bty389-aff7">7</xref>
        <xref ref-type="aff" rid="bty389-aff8">8</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bansal</surname>
          <given-names>Mukul S</given-names>
        </name>
        <xref ref-type="aff" rid="bty389-aff9">9</xref>
        <xref ref-type="aff" rid="bty389-aff10">10</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Berry</surname>
          <given-names>Vincent</given-names>
        </name>
        <xref ref-type="aff" rid="bty389-aff5">5</xref>
        <xref ref-type="aff" rid="bty389-aff6">6</xref>
        <xref ref-type="aff" rid="bty389-aff11">11</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Boussau</surname>
          <given-names>Bastien</given-names>
        </name>
        <xref ref-type="aff" rid="bty389-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chevenet</surname>
          <given-names>François</given-names>
        </name>
        <xref ref-type="aff" rid="bty389-aff5">5</xref>
        <xref ref-type="aff" rid="bty389-aff12">12</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Comte</surname>
          <given-names>Nicolas</given-names>
        </name>
        <xref ref-type="aff" rid="bty389-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Davín</surname>
          <given-names>Adrián A</given-names>
        </name>
        <xref ref-type="aff" rid="bty389-aff1">1</xref>
        <xref ref-type="aff" rid="bty389-aff3">3</xref>
        <xref ref-type="aff" rid="bty389-aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-2170-853X</contrib-id>
        <name>
          <surname>Dessimoz</surname>
          <given-names>Christophe</given-names>
        </name>
        <xref ref-type="aff" rid="bty389-aff13">13</xref>
        <xref ref-type="aff" rid="bty389-aff14">14</xref>
        <xref ref-type="aff" rid="bty389-aff15">15</xref>
        <xref ref-type="aff" rid="bty389-aff16">16</xref>
        <xref ref-type="aff" rid="bty389-aff17">17</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dylus</surname>
          <given-names>David</given-names>
        </name>
        <xref ref-type="aff" rid="bty389-aff13">13</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hasic</surname>
          <given-names>Damir</given-names>
        </name>
        <xref ref-type="aff" rid="bty389-aff18">18</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mallo</surname>
          <given-names>Diego</given-names>
        </name>
        <xref ref-type="aff" rid="bty389-aff19">19</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Planel</surname>
          <given-names>Rémi</given-names>
        </name>
        <xref ref-type="aff" rid="bty389-aff20">20</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Posada</surname>
          <given-names>David</given-names>
        </name>
        <xref ref-type="aff" rid="bty389-aff21">21</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Scornavacca</surname>
          <given-names>Celine</given-names>
        </name>
        <xref ref-type="aff" rid="bty389-aff6">6</xref>
        <xref ref-type="aff" rid="bty389-aff11">11</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Szöllősi</surname>
          <given-names>Gergely</given-names>
        </name>
        <xref ref-type="aff" rid="bty389-aff3">3</xref>
        <xref ref-type="aff" rid="bty389-aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Louxin</given-names>
        </name>
        <xref ref-type="aff" rid="bty389-aff22">22</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tannier</surname>
          <given-names>Éric</given-names>
        </name>
        <xref ref-type="aff" rid="bty389-aff1">1</xref>
        <xref ref-type="aff" rid="bty389-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Daubin</surname>
          <given-names>Vincent</given-names>
        </name>
        <xref ref-type="aff" rid="bty389-aff1">1</xref>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Schwartz</surname>
          <given-names>Russell</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="bty389-aff1"><label>1</label>Univ Lyon, Université Lyon 1, CNRS, Laboratoire de Biométrie et Biologie Évolutive UMR5558, F-69622 Villeurbanne, France</aff>
    <aff id="bty389-aff2"><label>2</label>INRIA Grenoble Rhône-Alpes, F-38334 Montbonnot, France</aff>
    <aff id="bty389-aff3"><label>3</label>MTA-ELTE Lendület Evolutionary Genomics Research Group, Budapest, Hungary</aff>
    <aff id="bty389-aff4"><label>4</label>Department of Biological Physics, Eötvös Loránd University, Budapest, Hungary</aff>
    <aff id="bty389-aff5"><label>5</label>LIRMM, Université de Montpellier, CNRS, Montpellier, France</aff>
    <aff id="bty389-aff6"><label>6</label>Institut de Biologie Computationnelle (IBC), Montpellier, France</aff>
    <aff id="bty389-aff7"><label>7</label>Department of Mathematics, Stockholm University, Stockholm, Sweden</aff>
    <aff id="bty389-aff8"><label>8</label>Swedish e-Science Research Centre (SeRC), Stockholm, Sweden</aff>
    <aff id="bty389-aff9"><label>9</label>Department of Computer Science and Engineering, University of Connecticut, Storrs, CT, USA</aff>
    <aff id="bty389-aff10"><label>10</label>Institute for Systems Genomics, University of Connecticut, Storrs, CT, USA</aff>
    <aff id="bty389-aff11"><label>11</label>ISEM, CNRS, Université de Montpellier, IRD, EPHE, Montpellier, France</aff>
    <aff id="bty389-aff12"><label>12</label>MIVEGEC, CNRS 5290, IRD 224, Université de Montpellier, Montpellier, France</aff>
    <aff id="bty389-aff13"><label>13</label>Department of Computational Biology, University of Lausanne, Lausanne, Switzerland</aff>
    <aff id="bty389-aff14"><label>14</label>Center for Integrative Genomics, University of Lausanne, Lausanne, Switzerland</aff>
    <aff id="bty389-aff15"><label>15</label>Department of Genetics, Evolution and Environment, University College London, London, UK</aff>
    <aff id="bty389-aff16"><label>16</label>Department of Computer Science, University College London, London, UK</aff>
    <aff id="bty389-aff17"><label>17</label>Swiss Institute of Bioinformatics, Lausanne, Switzerland</aff>
    <aff id="bty389-aff18"><label>18</label>Department of Mathematics, Faculty of Science, University of Sarajevo, Sarajevo, Bosnia and Herzegovina</aff>
    <aff id="bty389-aff19"><label>19</label>Virginia G. Piper Center for Personalized Diagnostics, Biodesign Institute, Arizona State University, Tempe, AZ, USA</aff>
    <aff id="bty389-aff20"><label>20</label>Laboratoire d’Analyse Bio-informatique en Génomique et Métabolisme CNRS-UMR 8030, Commissariat à l’Énergie Atomique (CEA), Institut de Génomique, Genoscope, Evry, France</aff>
    <aff id="bty389-aff21"><label>21</label>Department of Biochemistry, Genetics and Immunology, University of Vigo, Vigo, Spain</aff>
    <aff id="bty389-aff22"><label>22</label>Department of Mathematics, National University of Singapore, Singapore, Singapore</aff>
    <author-notes>
      <corresp id="bty389-cor1">To whom correspondence should be addressed. E-mail: <email>wandrille.duchemin@univ-lyon1.fr</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>11</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2018-05-14">
      <day>14</day>
      <month>5</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>14</day>
      <month>5</month>
      <year>2018</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>34</volume>
    <issue>21</issue>
    <fpage>3646</fpage>
    <lpage>3652</lpage>
    <history>
      <date date-type="received">
        <day>20</day>
        <month>10</month>
        <year>2017</year>
      </date>
      <date date-type="rev-recd">
        <day>04</day>
        <month>5</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>09</day>
        <month>5</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2018. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2018</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="bty389.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>A reconciliation is an annotation of the nodes of a gene tree with evolutionary events—for example, speciation, gene duplication, transfer, loss, etc.—along with a mapping onto a species tree. Many algorithms and software produce or use reconciliations but often using different reconciliation formats, regarding the type of events considered or whether the species tree is dated or not. This complicates the comparison and communication between different programs.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Here, we gather a consortium of software developers in gene tree species tree reconciliation to propose and endorse a format that aims to promote an integrative—albeit flexible—specification of phylogenetic reconciliations. This format, named recPhyloXML, is accompanied by several tools such as a reconciled tree visualizer and conversion utilities.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p><ext-link ext-link-type="uri" xlink:href="http://phylariane.univ-lyon1.fr/recphyloxml/">http://phylariane.univ-lyon1.fr/recphyloxml/</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Agence Nationale pour la Recherche</named-content>
        </funding-source>
        <award-id>ANR-10-BINF-01-01</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Institut de Biologie Computationnelle</named-content>
        </funding-source>
        <award-id>ANR-11-BINF-0002</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">European Research Council</named-content>
          <named-content content-type="funder-identifier">10.13039/100010663</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">European Union’s Horizon 2020</named-content>
        </funding-source>
        <award-id>714774</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Swiss National Science Foundation</named-content>
          <named-content content-type="funder-identifier">10.13039/501100001711</named-content>
        </funding-source>
        <award-id>150654</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The relationships between the history of genomes or species and the history of their constituent genes are often described through reconciliation. A reconciliation consists of an association between the nodes of a gene tree and the nodes or branches of a species tree, along with different evolutionary events undergone by the gene. For comprehensive reviews on the subject of reconciliations and their inference, see for example <xref rid="bty389-B20" ref-type="bibr">Nakhleh (2013)</xref> or <xref rid="bty389-B29" ref-type="bibr">Szöllősi <italic>et al.</italic> (2015)</xref>.</p>
    <p>Reconciliations can be used to understand the history of a specific gene family, and to study the evolutionary and functional relationships between several families. They can also be used to infer genome-wide parameters such as rates of gene duplication, loss, or lateral gene transfers (<xref rid="bty389-B25" ref-type="bibr">Sjöstrand <italic>et al.</italic>, 2014</xref>; <xref rid="bty389-B27" ref-type="bibr">Szöllősi <italic>et al.</italic>, 2013a</xref>), or population parameters such as divergence time and ancestral population size (<xref rid="bty389-B11" ref-type="bibr">Dutheil <italic>et al.</italic>, 2009</xref>). Furthermore, reconciliation based metrics can be used as a criterion to construct better gene trees (<xref rid="bty389-B10" ref-type="bibr">Durand <italic>et al.</italic>, 2006</xref>; <xref rid="bty389-B24" ref-type="bibr">Scornavacca <italic>et al.</italic>, 2013</xref>; <xref rid="bty389-B25" ref-type="bibr">Sjöstrand <italic>et al.</italic>, 2014</xref>; <xref rid="bty389-B27" ref-type="bibr">Szöllősi <italic>et al.</italic>, 2013a</xref>; <xref rid="bty389-B31" ref-type="bibr">Wu <italic>et al.</italic>, 2013</xref>) or better species tree (<xref rid="bty389-B4" ref-type="bibr">Boussau <italic>et al.</italic>, 2013</xref>; <xref rid="bty389-B20" ref-type="bibr">Nakhleh, 2013</xref>).</p>
    <p>There are many algorithms and software to infer reconciliations (<xref rid="bty389-B20" ref-type="bibr">Nakhleh, 2013</xref>; <xref rid="bty389-B29" ref-type="bibr">Szöllősi <italic>et al.</italic>, 2015</xref>), and while they share many features, each has some unique characteristics.</p>
    <p>Some methods work according to a parsimony principle [see for instance <xref rid="bty389-B10" ref-type="bibr">Durand <italic>et al.</italic> (2006</xref>), <xref rid="bty389-B2" ref-type="bibr">Bansal <italic>et al.</italic> (2012)</xref> and <xref rid="bty389-B5" ref-type="bibr">Chan <italic>et al.</italic> (2017)</xref>] while others rely on a probabilistic approach (<xref rid="bty389-B1" ref-type="bibr">Åkerborg <italic>et al.</italic>, 2009</xref>; <xref rid="bty389-B25" ref-type="bibr">Sjöstrand <italic>et al.</italic>, 2014</xref>; <xref rid="bty389-B27" ref-type="bibr">Szöllősi <italic>et al.</italic>, 2013a</xref>). Reconciliation methods may differ in the type of events they consider. Some methods also require a dated species tree (i.e. a species tree where the relative timing of internal speciations is known) while others do not.</p>
    <p>The fact that reconciliation programs (or rather each program family) use different formats to represent reconciliations makes it difficult to compare, switch between or use together reconciliations inferred from different pieces of software, which can hamper proper comparison and validation studies. This also means that any post-analysis or visualization software will either have limited scope (it will only be able to take as input the reconciliations of specific pieces of software) or be burdened by the implementation of readers for several formats.</p>
    <p>In this paper, we aim to propose a generic reconciliation format encompassing the specificities of different reconciliation programs. This will make reconciliation based analysis more accessible to scientists without the need to develop or use multiple format conversion scripts.</p>
    <p>In order to include all properties described in the scientific literature about gene tree species tree reconciliation, we should first be able to annotate gene tree nodes with events related to species tree nodes, such as speciations, and events associated to species tree branches, such as gene duplication (D), gene loss (L), lateral gene transfer (T), transfer with replacement (TR), gene conversion (C) and incomplete lineage sorting (ILS) (<xref rid="bty389-B18" ref-type="bibr">Mallo <italic>et al.</italic>, 2014</xref>; <xref rid="bty389-B23" ref-type="bibr">Rasmussen and Kellis, 2012</xref>; <xref rid="bty389-B30" ref-type="bibr">Than <italic>et al.</italic>, 2008</xref>). Reconciliations can be carried out with dated or undated species trees. In a dated species tree, the relative order of speciations is known and it would be desirable to be able to include information about the relative time at which the different events occurred in the reconciliation.</p>
    <p>Transfers are written with two separate events: a gene lineage leaving a species tree branch (branching out) and then entering another species tree branch (transfer reception). As noted in <xref rid="bty389-B28" ref-type="bibr">Szöllősi <italic>et al.</italic> (2013b</xref>), most transfers originate from extinct or unsampled lineages (i.e. branches absent from the species tree). This implies that the bifurcation in the gene tree when a lineage leaves the species tree is not the transfer itself but actually a speciation toward an unsampled/extinct lineage. Our format nevertheless reflects the generality of this event by adopting a neutral label compatible with the different representations of transfers.</p>
    <p>Moreover, this notion of evolution in unsampled lineages implies the possibility of a bifurcation in the gene tree in such a lineage. The children of the bifurcation can undergo transfers back to the sampled lineages. The unseen bifurcation might be a duplication, a speciation or a transfer between two unsampled lineage. Existing models are yet unable to discriminate these events. This idea is reflected in our format thanks to a specific way to specify a bifurcation in an unsampled lineage.</p>
    <p>There have been previous attempts to develop formats able to represent evolutionary events along a phylogeny. The PhyloXML format (<xref rid="bty389-B14" ref-type="bibr">Han and Zmasek, 2009</xref>) is able to depict various annotations along a tree. It already has some way of representing evolutionary events along a phylogeny, but with limitations. For example PhyloXML lacks a mean to specify the species associated with the different events and only includes a rudimentary representation of transfers.</p>
    <p>Adapting the already existing tags for evolutionary event in PhyloXML would require a near complete overhaul; rather, we propose a new format (recPhyloXML) with entirely new tags, ensuring no confusion with PhyloXML.</p>
    <sec>
      <title>1.1 State of the art</title>
      <p>Existing reconciliation formats can be broadly categorized in two groups.</p>
      <p>The first group describes reconciliation events as labels in a Newick or NHX tree, in place of the nodal support (e.g. bootstrap) information or in a devoted NHX comment field. Programs like ALE (<xref rid="bty389-B27" ref-type="bibr">Szöllősi <italic>et al.</italic>, 2013a</xref>), NOTUNG (<xref rid="bty389-B10" ref-type="bibr">Durand <italic>et al.</italic>, 2006</xref>; <xref rid="bty389-B26" ref-type="bibr">Stolzer <italic>et al.</italic>, 2012</xref>), DrML (<xref rid="bty389-B12" ref-type="bibr">Górecki and Eulenstein, 2014</xref>), phylotoo2 (<xref rid="bty389-B32" ref-type="bibr">Zheng and Zhang, 2017</xref>) or PrIME (<xref rid="bty389-B1" ref-type="bibr">Åkerborg <italic>et al.</italic>, 2009</xref>; <xref rid="bty389-B25" ref-type="bibr">Sjöstrand <italic>et al.</italic>, 2014</xref>) adhere to this group. The Newick-based reconciliation formats have the advantage of representing the phylogeny. However the reconciliation information often takes the space of other measures like bootstrap values [as in <xref rid="bty389-B27" ref-type="bibr">Szöllősi <italic>et al.</italic> (2013a</xref>), or <xref rid="bty389-B12" ref-type="bibr">Górecki and Eulenstein (2014</xref>)]. The NHX-based format solves this by allocating a specific space for the reconciliation. A common problem with NHX and Newick-based formats is that some characters are forbidden in the leaf names and annotations (These forbidden characters are : , : () ; [] in Newick and NHX.), while sometimes species or gene annotations contain these characters (whereas they rarely contain whole XML tags). In addition, there is no formal format for information contained in NHX comment fields; thus, this information may not be accessible across software platforms.</p>
      <p>The second group represents reconciliations as lists of gene tree nodes mapping to species tree nodes, making references to an implicit or external gene tree (meaning that the gene tree structure might not be included in the reconciliation). Examples of such output formats are used by ranger-DTL (<xref rid="bty389-B2" ref-type="bibr">Bansal <italic>et al.</italic>, 2012</xref>), ecceTERA (<xref rid="bty389-B16" ref-type="bibr">Jacox <italic>et al.</italic>, 2016</xref>), DLcoalRecon (<xref rid="bty389-B23" ref-type="bibr">Rasmussen and Kellis, 2012</xref>), Mowgli (<xref rid="bty389-B8" ref-type="bibr">Doyon <italic>et al.</italic>, 2010</xref>), the visualization software SylvX (<xref rid="bty389-B6" ref-type="bibr">Chevenet <italic>et al.</italic>, 2016</xref>) or the simulation software SimPhy (<xref rid="bty389-B19" ref-type="bibr">Mallo <italic>et al.</italic>, 2016</xref>).</p>
    </sec>
  </sec>
  <sec>
    <title>2 Format presentation</title>
    <p>To describe reconciliations, we present recPhyloXML, recGeneTreeXML, recSpeciesTreeXML, three grammars extending the PhyloXML format. We also introduce recGeoXML, a grammar to annotate reconciliations with geographic information.</p>
    <p>They both rely on an XML structure composed of hierarchical tags. A specific tag may have different attributes which can be obligatory or optional.</p>
    <p>In this section we briefly detail the structure of the PhyloXML used in our format. We then expand on the tags that are specific to reconciliations.</p>
    <sec>
      <title>2.1 Elements in common with PhyloXML</title>
      <p>In PhyloXML, a tree is delimited by the tag <monospace>&lt;phylogeny&gt; &lt;/phylogeny&gt;</monospace>, which is included in a <monospace>&lt;phyloxml&gt; &lt;/phyloxml&gt; </monospace>root tag that specifies that the file follows the PhyloXML format. Inside the <monospace>&lt;phylogeny&gt; &lt;/phylogeny&gt;</monospace> tag, each clade is recursively inscribed in a <monospace>&lt;clade&gt; &lt;/clade&gt;</monospace> tag. This clade tag possesses a facultative attribute to describe branch length. The name or identifier of the node is given in the <monospace>&lt;name&gt; &lt;/name&gt;</monospace> tag. Further information can be included such as support value (<monospace>&lt;confidence&gt;&lt;/confidence&gt;</monospace>) or miscellaneous information (<monospace>&lt;description&gt;&lt;/description&gt;</monospace>).</p>
    </sec>
    <sec>
      <title>2.2 New elements</title>
      <p>In our format, a reconciliation (<monospace>&lt;recPhylo&gt;</monospace> tag) is defined as a set comprised of one or more reconciled gene trees (<monospace>&lt;recGeneTree&gt;</monospace> tag), and a species tree (<monospace>&lt;spTree&gt;</monospace> tag). These tags are described in the next section. Also, reconciled gene trees are always rooted and this is specified by using the tag</p>
      <p><monospace>&lt;phylogeny rooted=“true”&gt;&lt;/phylogeny&gt;</monospace>.</p>
      <p>A recPhyloXML file allows you to store and share one or more reconciled genes trees and the associated species tree. A recGeneTreeXML file allows you to add a list of evolutionary events to the description of gene tree nodes (otherwise referred to as clades in PhyloXML), possibly also containing detailed geographic information thanks to the recGeoXML grammar (<monospace>&lt;geography&gt;</monospace> tag). This tag can also be used in a recSpeciesTreeXML file that currently differs from PhyloXML file only in this point.</p>
    </sec>
    <sec>
      <title>2.3 recGeneTreeXML</title>
      <p>recGeneTreeXML enriches the PhyloXML vocabulary by adding the complex tag <monospace>&lt;eventsRec&gt;</monospace> that must be included inside a <monospace>&lt;clade&gt;</monospace> tag.</p>
      <p>The <monospace>&lt;eventsRec&gt;</monospace> tag contains the sequence of evolutionary events that occur along a gene tree branch.</p>
      <p>Each type of evolutionary event is represented by a specific tag. These can be of two types, according to whether they concern a branch or a node of the gene tree:
<list list-type="bullet"><list-item><p><bold>Non terminal event:</bold><monospace>&lt;transferBack&gt;</monospace>. This tag can be used as many times as necessary. This event does not cause any bifurcation in the gene tree.</p></list-item><list-item><p><bold>Terminal events:</bold><monospace>&lt;speciation&gt;</monospace>, <monospace>&lt;branchingOut&gt;</monospace>, <monospace>&lt;bifurcationOut&gt;</monospace>, <monospace>&lt;duplication&gt;</monospace>, <monospace>&lt;loss&gt;</monospace> and <monospace>&lt;leaf&gt;</monospace>. There is exactly one of these tags at the end of the sequence of events contained in the <monospace>&lt;eventsRec&gt;</monospace> tag.</p></list-item></list></p>
      <p>Terminal events cause either a bifurcation in the gene tree (<monospace>&lt;speciation&gt;</monospace>, <monospace>&lt;branchingOut&gt;</monospace>, <monospace>&lt;bifurcationOut&gt;</monospace>, <monospace>&lt;duplication&gt;</monospace>) or the end of a lineage (<monospace>&lt;leaf&gt;</monospace>, <monospace>&lt;loss&gt;</monospace>).</p>
      <p>Aside from the <monospace>&lt;bifurcationOut&gt;</monospace> and <monospace>&lt;transferBack&gt;</monospace> tags, all tags have an obligatory <monospace>speciesLocation</monospace> attribute that specifies in which species the event takes place. For <monospace>&lt;bifurcationOut&gt;</monospace>, the event always takes place in an unsampled/extinct lineage. <monospace>&lt;transferBack&gt;</monospace> events have instead a destinationSpecies attribute that specifies the species that receives the transfer. All event tags also have a facultative <monospace>confidence</monospace> attribute that is intended to store a support value for this event (<xref rid="bty389-B21" ref-type="bibr">Nguyen <italic>et al.</italic>, 2013</xref>). Additionally, all event tags have a facultative <monospace>timeSlice</monospace> attribute that can, in models where the species tree is dated and subdivided for instance [as done for example in <xref rid="bty389-B8" ref-type="bibr">Doyon <italic>et al.</italic> (2010)</xref>], provide information on the timing of the event. Finally, the <monospace>&lt;leaf&gt;</monospace> tag has a facultative <monospace>geneName</monospace> attribute that can specify to which extant gene it corresponds. We now describe each event tag in details.</p>
      <p>
        <bold><monospace><bold>&lt;leaf&gt;</bold></monospace> tag:</bold>
      </p>
      <p>The <monospace>&lt;leaf&gt;</monospace> tag indicates that the branch ends on a gene tree leaf; see <xref ref-type="fig" rid="bty389-F1">Figure 1A</xref>. Note that the <monospace>&lt;leaf&gt;</monospace> tag also has a facultative <monospace>geneName</monospace> attribute that can specify to which extant gene it corresponds.
</p>
      <fig id="bty389-F1" orientation="portrait" position="float">
        <label>Fig. 1.</label>
        <caption>
          <p>A. Representation of the <monospace>&lt;leaf&gt;</monospace> tag. B. Representation of the <monospace>&lt;speciation&gt;</monospace> tag. C. Representation of the <monospace>&lt;loss&gt;</monospace> tag. D. Representation of the <monospace>&lt;duplication&gt;</monospace> tag. The species tree is figured using black tube-like branches. The part of the gene tree the event occurs in is represented using plain lines. Additional parts of the gene tree are represented as dotted lines. Stars, squares and crosses respectively represent the beginning of a gene lineage, a gene duplication and a gene loss</p>
        </caption>
        <graphic xlink:href="bty389f1"/>
      </fig>
      <p>Associated recGeneTreeXML code:</p>
      <p>
        <monospace>&lt;clade&gt;</monospace>
      </p>
      <p>
        <monospace>  &lt;name&gt;gene_seq_1&lt;/name&gt;</monospace>
      </p>
      <p>
        <monospace>  &lt;eventsRec&gt;</monospace>
      </p>
      <p>
        <monospace>    &lt;leaf speciesLocation=“C”&gt;&lt;/leaf&gt;</monospace>
      </p>
      <p>
        <monospace>  &lt;/eventsRec&gt;</monospace>
      </p>
      <p>
        <monospace>&lt;/clade&gt;</monospace>
      </p>
      <p>
        <bold>&lt;speciation&gt; tag:</bold>
      </p>
      <p>The <monospace>&lt;speciation&gt; </monospace>tag describes a gene lineage undergoing a bifurcation due to a speciation; see <xref ref-type="fig" rid="bty389-F1">Figure 1B</xref>.</p>
      <p>Associated recGeneTreeXML code:</p>
      <p>
        <monospace>&lt;clade&gt;</monospace>
      </p>
      <p>
        <monospace> &lt;name&gt;n1&lt;/name&gt;</monospace>
      </p>
      <p>
        <monospace> &lt;eventsRec&gt;</monospace>
      </p>
      <p>
        <monospace> &lt;speciation speciesLocation=“A”&gt;&lt;/speciation&gt;</monospace>
      </p>
      <p>
        <monospace> &lt;/eventsRec&gt;</monospace>
      </p>
      <p>
        <monospace>&lt;/clade&gt;</monospace>
      </p>
      <p>
        <bold><monospace><bold>&lt;loss&gt;</bold></monospace> tag:</bold>
      </p>
      <p>The <monospace>&lt;loss&gt;</monospace> tag describes the loss of a gene copy and is a terminal tag (as with the <monospace>&lt;leaf&gt;</monospace> tag, there can be no tag following this one). Typically, it can follow a speciation event. See <xref ref-type="fig" rid="bty389-F1">Figure 1C</xref> for an example.</p>
      <p>Associated recGeneTreeXML code:</p>
      <p>
        <monospace>&lt;!–Example with end tag &lt;leaf&gt;–&gt;</monospace>
      </p>
      <p>
        <monospace>&lt;clade&gt;</monospace>
      </p>
      <p>
        <monospace>  &lt;name&gt;n1&lt;/name&gt;</monospace>
      </p>
      <p>
        <monospace>  &lt;eventsRec&gt;</monospace>
      </p>
      <p>
        <monospace>    &lt;speciation&gt;speciesLocation=“A”&gt; &lt;/speciation&gt;</monospace>
      </p>
      <p>
        <monospace>  &lt;/eventsRec&gt;</monospace>
      </p>
      <p>
        <monospace>  &lt;clade&gt;</monospace>
      </p>
      <p>
        <monospace>    &lt;name&gt;gene_seq_1&lt;/name&gt;</monospace>
      </p>
      <p>
        <monospace>    &lt;eventsRec&gt;</monospace>
      </p>
      <p>
        <monospace>      &lt;leaf speciesLocation=“C”&gt;&lt;/leaf&gt;</monospace>
      </p>
      <p>
        <monospace>    &lt;/eventsRec&gt;</monospace>
      </p>
      <p>
        <monospace>  &lt;/clade&gt;</monospace>
      </p>
      <p>
        <monospace>  &lt;clade&gt;</monospace>
      </p>
      <p>
        <monospace>    &lt;name&gt;LOST&lt;/name&gt;</monospace>
      </p>
      <p>
        <monospace>    &lt;eventsRec&gt;</monospace>
      </p>
      <p>
        <monospace>      &lt;loss speciesLocation=“B”&gt;&lt;/loss&gt;</monospace>
      </p>
      <p>
        <monospace>    &lt;/eventsRec&gt;</monospace>
      </p>
      <p>
        <monospace>  &lt;/clade&gt;</monospace>
      </p>
      <p>
        <monospace>&lt;/clade&gt;</monospace>
      </p>
      <p>
        <bold><monospace><bold>&lt;duplication&gt;</bold></monospace> tag:</bold>
      </p>
      <p>The <monospace>&lt;duplication&gt;</monospace> tag represents a gene duplication inside a species tree branch; see <xref ref-type="fig" rid="bty389-F1">Figure 1D</xref>.</p>
      <p>Associated recGeneTreeXML code:</p>
      <p>
        <monospace>&lt;clade&gt;</monospace>
      </p>
      <p>
        <monospace>  &lt;name&gt;n1&lt;/name&gt;</monospace>
      </p>
      <p>
        <monospace>  &lt;eventsRec&gt;</monospace>
      </p>
      <p>
        <monospace>    &lt;duplication speciesLocation=“C”&gt;</monospace>
      </p>
      <p>
        <monospace>              &lt;/duplication&gt;</monospace>
      </p>
      <p>
        <monospace>  &lt;/eventsRec&gt;</monospace>
      </p>
      <p>
        <monospace>&lt;/clade&gt;</monospace>
      </p>
      <p>
        <bold><monospace><bold>&lt;branchingOut&gt;</bold></monospace> tag:</bold>
      </p>
      <p>The <monospace>&lt;branchingOut&gt;</monospace> tag represents an event where a gene lineage splits and one gene copy exits the species tree branch while the other gene copy remains in the species branch. It actually is the first step of an horizontal gene transfer event: a gene lineage leaving a species tree branch; see <xref ref-type="fig" rid="bty389-F2">Figure 2A</xref>. <xref ref-type="fig" rid="bty389-F2">Figure 2C</xref> also represents the case of a <monospace>&lt;branchingOut&gt;</monospace> where the child that remained in the same species was lost (<monospace>&lt;loss&gt;</monospace> tag).
</p>
      <fig id="bty389-F2" orientation="portrait" position="float">
        <label>Fig. 2.</label>
        <caption>
          <p><bold>A</bold>. Representation of the <monospace>&lt;branchingOut&gt;</monospace> tag. <bold>B</bold>. Representation of the <monospace>&lt;transferBack&gt;</monospace> tag. <bold>C</bold>. Representation of a <monospace>&lt;branchingOut&gt;</monospace> tag followed by a <monospace>&lt;loss&gt;</monospace> tag. <bold>D</bold>. Representation of the <monospace>&lt;bifurcationOut&gt;</monospace> tag. These figure uses the same conventions as <xref ref-type="fig" rid="bty389-F1">Figure 1</xref> with the following additions. For the <monospace>&lt;bifurcationOut&gt;</monospace> tag (D.), which is specific of the model of <xref rid="bty389-B28" ref-type="bibr">Szöllősi <italic>et al.</italic> (2013b</xref>), extinct/unsampled lineages are represented as branches of the species tree that do not extend all the way to the right. Diamonds and triangles respectively represent a transfer leaving and entering a branch of the species tree (note that the transfers leave a branch of the species tree that corresponds to an extinct/unsampled lineage)</p>
        </caption>
        <graphic xlink:href="bty389f2"/>
      </fig>
      <p>Associated recGeneTreeXML code:</p>
      <p>
        <monospace>&lt;clade&gt;</monospace>
      </p>
      <p>
        <monospace>  &lt;name&gt;n1&lt;/name&gt;</monospace>
      </p>
      <p>
        <monospace>  &lt;eventsRec&gt;</monospace>
      </p>
      <p>
        <monospace>    &lt;branchingOut speciesLocation=“C”&gt;</monospace>
      </p>
      <p>
        <monospace>               &lt;/branchingOut&gt;</monospace>
      </p>
      <p>
        <monospace>  &lt;/eventsRec&gt;</monospace>
      </p>
      <p>
        <monospace>&lt;/clade&gt;</monospace>
      </p>
      <p>
        <bold><monospace><bold>&lt;transferBack&gt;</bold></monospace> tag:</bold>
      </p>
      <p>The <monospace>&lt;transferBack&gt;</monospace> tag represents an horizontal gene transfer toward a branch of the species tree; see <xref ref-type="fig" rid="bty389-F2">Figure 2B</xref>.</p>
      <p>Associated recGeneTreeXML code:</p>
      <p>
        <monospace>&lt;!–Example with end tag &lt;leaf&gt; –&gt;</monospace>
      </p>
      <p>
        <monospace>&lt;clade&gt;</monospace>
      </p>
      <p>
        <monospace>  &lt;name&gt;gene_seq_2&lt;/name&gt;</monospace>
      </p>
      <p>
        <monospace>  &lt;eventsRec&gt;</monospace>
      </p>
      <p>
        <monospace>    &lt;transferBack destinationSpecies=“B”&gt;</monospace>
      </p>
      <p>
        <monospace>               &lt;/transferBack&gt;</monospace>
      </p>
      <p>
        <monospace>    &lt;leaf speciesLocation=“B”&gt;&lt;/leaf&gt;</monospace>
      </p>
      <p>
        <monospace>  &lt;/eventsRec&gt;</monospace>
      </p>
      <p>
        <monospace>&lt;/clade&gt;</monospace>
      </p>
      <p>
        <bold><monospace><bold>&lt;bifurcationOut&gt;</bold></monospace> tag:</bold>
      </p>
      <p>The <monospace>&lt;bifurcationOut&gt;</monospace> tag represents a bifurcation in the species tree that would happen while the gene evolves along an unsampled/extinct species (i.e. one that is not represented in the species tree, see the <monospace>&lt;branchingOut&gt;</monospace> and <monospace>&lt;transferBack&gt;</monospace> tags above); see <xref ref-type="fig" rid="bty389-F2">Figure 2D</xref>.</p>
      <p>Associated recGeneTreeXML code:</p>
      <p>
        <monospace>&lt;clade&gt;</monospace>
      </p>
      <p>
        <monospace>  &lt;name&gt;n1&lt;/name&gt;</monospace>
      </p>
      <p>
        <monospace>  &lt;eventsRec&gt;</monospace>
      </p>
      <p>
        <monospace>    &lt;bifurcationOut&gt;&lt;/bifurcationOut&gt;</monospace>
      </p>
      <p>
        <monospace>  &lt;/eventsRec&gt;</monospace>
      </p>
      <p>
        <monospace>&lt;/clade&gt;</monospace>
      </p>
    </sec>
    <sec>
      <title>2.4 Note on the lateral gene transfer representation</title>
      <p>A lateral gene transfer is represented in two steps: one that specifies the species where the transfer originates, and the other that specifies the species receiving the transfer. These two successive steps are respectively represented by the <monospace>&lt;branchingOut&gt;</monospace> and <monospace>&lt;transferBack&gt;</monospace> tags. See the different parts of <xref ref-type="fig" rid="bty389-F2">Figure 2</xref>, along with <xref ref-type="fig" rid="bty389-F3">Figures 3</xref> and <xref ref-type="fig" rid="bty389-F4">4</xref> for illustrations of these concepts.
</p>
      <fig id="bty389-F3" orientation="portrait" position="float">
        <label>Fig. 3.</label>
        <caption>
          <p>A <monospace>&lt;recPhylo&gt;</monospace> object containing a species tree and one reconciled gene tree</p>
        </caption>
        <graphic xlink:href="bty389f3"/>
      </fig>
      <fig id="bty389-F4" orientation="portrait" position="float">
        <label>Fig. 4.</label>
        <caption>
          <p>A visualization of the reconciled gene tree of <xref ref-type="fig" rid="bty389-F3">Figure 3</xref></p>
        </caption>
        <graphic xlink:href="bty389f4"/>
      </fig>
    </sec>
    <sec>
      <title>2.5 recGeoXML</title>
      <p>Geographical annotations can be indicated for gene and species tree nodes thanks to the <monospace>&lt;geography&gt;</monospace> tag. Such an annotation mainly consists in an area, KML information for displaying areas in GIS software and geographic information as defined in the usual PhyloXML grammar. An area (<monospace>&lt;area&gt;</monospace>) is specified by a name, a description, a value such as a support and a source (e.g. ‘observed’ or ‘inferred by Beast’).</p>
    </sec>
    <sec>
      <title>2.6 recPhyloXML</title>
      <p>recPhyloXML facilitates the packaging of several gene families reconciled to the same species tree. Its structure is fairly simple. A <monospace>&lt;recPhylo&gt;</monospace> root tag contains the following sequence:
<list list-type="bullet"><list-item><p>0 to 1 species tree in recSpeciesTreeXML format, contained in the <monospace>&lt;spTree&gt;</monospace> tag.</p></list-item><list-item><p>1 to <italic>n</italic> gene family trees in recGeneTreeXML format, each defined in a separate <monospace>&lt;recGeneTree&gt;</monospace> tag.</p></list-item></list></p>
      <p>
        <monospace>&lt;!– skeleton of a recphylo object with a species tree and two reconciled gene trees –&gt;</monospace>
      </p>
      <p>
        <monospace>&lt;recPhylo&gt;</monospace>
      </p>
      <p>
        <monospace>  &lt;spTree&gt;</monospace>
      </p>
      <p>
        <monospace>    &lt;!– recSpeciesTreeXML species tree –&gt;</monospace>
      </p>
      <p>
        <monospace>    …</monospace>
      </p>
      <p>
        <monospace>  &lt;/spTree&gt;</monospace>
      </p>
      <p>
        <monospace>  &lt;recGeneTree&gt;</monospace>
      </p>
      <p>
        <monospace>    &lt;!– first reconciled gene tree –&gt;</monospace>
      </p>
      <p>
        <monospace>    …</monospace>
      </p>
      <p>
        <monospace>  &lt;/recGeneTree&gt;</monospace>
      </p>
      <p>
        <monospace>  &lt;recGeneTree&gt;</monospace>
      </p>
      <p>
        <monospace>    &lt;!– second reconciled gene tree –&gt;</monospace>
      </p>
      <p>
        <monospace>    …</monospace>
      </p>
      <p>
        <monospace>  &lt;/recGeneTree&gt;</monospace>
      </p>
      <p>
        <monospace>&lt;/recPhylo&gt;</monospace>
      </p>
      <p>A complete example of a <monospace>&lt;recPhylo&gt;</monospace> object containing a species tree and a reconciled gene tree can be seen in <xref ref-type="fig" rid="bty389-F3">Figure 3</xref> and a visualization of this reconciled gene tree can be seen in <xref ref-type="fig" rid="bty389-F4">Figure 4</xref>.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Availability</title>
    <p>A detailed description of the recPhyloXML format, as well as a schema definition file (This is a file formally describing the format, used by many XML tools.), is available at <ext-link ext-link-type="uri" xlink:href="http://phylariane.univ-lyon1.fr/recphyloxml/">http://phylariane.univ-lyon1.fr/recphyloxml/</ext-link>. This website also presents a tool that can generate a visual representation of any reconciled tree or group of reconciled trees in the recPhyloXML format. The generated file is a.<italic>svg</italic> file, which easily allows for further manipulation, like changing the color scheme. This tool has been used to generate the basis for the figures showing reconciled gene trees in this manuscript.</p>
    <p>The recPhyloXML format has already been implemented as an output option in the reconciliation software ALE (<xref rid="bty389-B27" ref-type="bibr">Szöllősi <italic>et al.</italic>, 2013a</xref>), in the Treerecs software [<ext-link ext-link-type="uri" xlink:href="https://gitlab.inria.fr/Phylophile/Treerecs">https://gitlab.inria.fr/Phylophile/Treerecs</ext-link>, this program corrects gene trees with a species tree using principles described in <xref rid="bty389-B22" ref-type="bibr">Noutahi <italic>et al.</italic> (2016)</xref> and <xref rid="bty389-B17" ref-type="bibr">Lafond <italic>et al.</italic> (2012)</xref>], in the reconciliation web server <ext-link ext-link-type="uri" xlink:href="http://phylotoo2.appspot.com">http://phylotoo2.appspot.com</ext-link><bold>/</bold> (<xref rid="bty389-B32" ref-type="bibr">Zheng and Zhang, 2017</xref>), in the genome simulation software Zombi (<ext-link ext-link-type="uri" xlink:href="https://github.com/AADavin/ZOMBI">https://github.com/AADavin/ZOMBI</ext-link><bold>)</bold>, both as input and output options in the adjacency history computing software DeCoSTAR (<xref rid="bty389-B9" ref-type="bibr">Duchemin <italic>et al.</italic>, 2017</xref>).</p>
    <p>Furthermore, scripts have been developed to convert the reconciliations produced by ecceTERA (<xref rid="bty389-B16" ref-type="bibr">Jacox <italic>et al.</italic>, 2016</xref>), NOTUNG (<xref rid="bty389-B10" ref-type="bibr">Durand <italic>et al.</italic>, 2006</xref>) and PrIME (<xref rid="bty389-B1" ref-type="bibr">Åkerborg <italic>et al.</italic>, 2009</xref>) into recPhyloXML, and a script for converting reconciliations produced by RANGER-DTL (<xref rid="bty389-B3" ref-type="bibr">Bansal <italic>et al.</italic>, 2018</xref>) is currently under development. Additional scripts are also available to convert a recPhyloXML reconciled tree in the Newick format, count the different events represented in a recPhyloXML file, combine different files into one or extract specific trees from a file. APIs have been written to import and export in recPhyloXML for the C++ library Bio++ (<xref rid="bty389-B13" ref-type="bibr">Gueguen <italic>et al.</italic>, 2013</xref>), for the python libraries ETE3 (<xref rid="bty389-B15" ref-type="bibr">Huerta-Cepas <italic>et al.</italic>, 2016</xref>) and Biopython (<xref rid="bty389-B7" ref-type="bibr">Cock <italic>et al.</italic>, 2009</xref>). All these scripts and APIs are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/WandrilleD/recPhyloXML">https://github.com/WandrilleD/recPhyloXML</ext-link>.</p>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>With the growing number of available reconciliation models and pieces of software, it becomes crucial to be able to exchange and compare their results. recPhyloXML is a format that can accommodate many reconciliation features (dated/undated; with or without lateral gene transfers). It relies on an XML structure which is a standard format for nested data that already has multiple API libraries in various programming languages. We provide a detailed description of the recPhyloXML format on a website, along with a tool to visualize it.</p>
    <p>We designed the format to be flexible in order to be able to create extensions that allow the representation of different forms of reconciliations. We are planning for future extensions for the format that would include a representation of the coalescent process that underlies ILS. recPhyloXML could also be extended to support gene conversion by a paralog or horizontal gene transfer with replacement.</p>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors would like to thank Dannie Durand, Han Lai and Maureen Stolzer for their advice on both the format and the manuscript.</p>
    <sec>
      <title>Funding</title>
      <p>This work was funded by the Agence Nationale pour la Recherche, Ancestrome project ANR-10-BINF-01-01 and by the Institut de Biologie Computationnelle ANR-11-BINF-0002. G.J.Sz., W.D. and A.A.D. received funding from the European Research Council under the European Union’s Horizon 2020 research and innovation programme under grant agreement no. 714774. C.D and D.D. were funded by Swiss National Science Foundation grant 150654.</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="bty389-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Åkerborg</surname><given-names>Ö.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>Simultaneous Bayesian gene tree reconstruction and reconciliation analysis</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>106</volume>, <fpage>5714</fpage>–<lpage>5719</lpage>.<pub-id pub-id-type="pmid">19299507</pub-id></mixed-citation>
    </ref>
    <ref id="bty389-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bansal</surname><given-names>M.S.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Efficient algorithms for the reconciliation problem with gene duplication, horizontal transfer and loss</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>i283</fpage>–<lpage>i291</lpage>.<pub-id pub-id-type="pmid">22689773</pub-id></mixed-citation>
    </ref>
    <ref id="bty389-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bansal</surname><given-names>M.S.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) Ranger-dtl 2.0: Rigorous reconstruction of gene-family evolution by duplication, transfer, and loss. <italic>Bioinformatics</italic>, <volume>34</volume>, <fpage>3214</fpage>–<lpage>3216</lpage>.</mixed-citation>
    </ref>
    <ref id="bty389-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Boussau</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Genome-scale coestimation of species and gene trees</article-title>. <source>Genome Res</source>., <volume>23</volume>, <fpage>323</fpage>–<lpage>330</lpage>.<pub-id pub-id-type="pmid">23132911</pub-id></mixed-citation>
    </ref>
    <ref id="bty389-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Chan</surname><given-names>Y-b.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Inferring incomplete lineage sorting, duplications, transfers and losses with reconciliations</article-title>. <source>J. Theor. Biol</source>., <volume>432</volume>, <fpage>1</fpage>–<lpage>13</lpage>.<pub-id pub-id-type="pmid">28801222</pub-id></mixed-citation>
    </ref>
    <ref id="bty389-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Chevenet</surname><given-names>F.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>SylvX: a viewer for phylogenetic tree reconciliations</article-title>. <source>Bioinformatics</source>, <volume>32</volume>, <fpage>608</fpage>–<lpage>610</lpage>.<pub-id pub-id-type="pmid">26515823</pub-id></mixed-citation>
    </ref>
    <ref id="bty389-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cock</surname><given-names>P.J.A.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>Biopython: freely available Python tools for computational molecular biology and bioinformatics</article-title>. <source>Bioinformatics</source>, <volume>25</volume>, <fpage>1422</fpage>–<lpage>1423</lpage>.<pub-id pub-id-type="pmid">19304878</pub-id></mixed-citation>
    </ref>
    <ref id="bty389-B8">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Doyon</surname><given-names>J.P.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) An efficient algorithm for gene/species trees parsimonious reconciliation with losses, duplications, and transfers. In: <italic>Proceedings of the 2010 International Conference on Comparative Genomics, RECOMB-CG’10</italic>, pp. <fpage>93</fpage>–<lpage>108</lpage>.</mixed-citation>
    </ref>
    <ref id="bty389-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Duchemin</surname><given-names>W.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) Decostar: reconstructing the ancestral organization of genes or genomes using reconciled phylogenies. <italic>Genome Biol. Evol</italic>, <volume>9</volume>, <fpage>1312</fpage>–<lpage>1319</lpage>.</mixed-citation>
    </ref>
    <ref id="bty389-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Durand</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2006</year>) 
<article-title>A hybrid micro-macroevolutionary approach to gene tree reconstruction</article-title>. <source>J. Comput. Biol</source>., <volume>13</volume>, <fpage>320</fpage>–<lpage>335</lpage>.<pub-id pub-id-type="pmid">16597243</pub-id></mixed-citation>
    </ref>
    <ref id="bty389-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Dutheil</surname><given-names>J.Y.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>Ancestral population genomics: the coalescent hidden Markov Model Approach</article-title>. <source>Genetics</source>, <volume>183</volume>, <fpage>259</fpage>–<lpage>274</lpage>.<pub-id pub-id-type="pmid">19581452</pub-id></mixed-citation>
    </ref>
    <ref id="bty389-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Górecki</surname><given-names>P.</given-names></name>, <name name-style="western"><surname>Eulenstein</surname><given-names>O.</given-names></name></person-group> (<year>2014</year>) 
<article-title>DrML: probabilistic modeling of gene duplications</article-title>. <source>J. Comput. Biol</source>., <volume>21</volume>, <fpage>89</fpage>–<lpage>98</lpage>.<pub-id pub-id-type="pmid">24073895</pub-id></mixed-citation>
    </ref>
    <ref id="bty389-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gueguen</surname><given-names>L.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Bio++: efficient extensible libraries and tools for computational molecular evolution</article-title>. <source>Mol. Biol. Evol</source>., <volume>30</volume>, <fpage>1745</fpage>–<lpage>1750</lpage>.<pub-id pub-id-type="pmid">23699471</pub-id></mixed-citation>
    </ref>
    <ref id="bty389-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Han</surname><given-names>M.V.</given-names></name>, <name name-style="western"><surname>Zmasek</surname><given-names>C.M.</given-names></name></person-group> (<year>2009</year>) 
<article-title>phyloXML: XML for evolutionary biology and comparative genomics</article-title>. <source>BMC Bioinformatics</source>, <volume>10</volume>, <fpage>356.</fpage><pub-id pub-id-type="pmid">19860910</pub-id></mixed-citation>
    </ref>
    <ref id="bty389-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Huerta-Cepas</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>ETE 3: reconstruction, analysis, and visualization of phylogenomic data</article-title>. <source>Mol. Biol. Evol</source>., <volume>33</volume>, <fpage>1635</fpage>–<lpage>1638</lpage>.<pub-id pub-id-type="pmid">26921390</pub-id></mixed-citation>
    </ref>
    <ref id="bty389-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jacox</surname><given-names>E.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) ecceTERA: comprehensive gene tree-species tree reconciliation using parsimony. <italic>Bioinformatics</italic><volume>32</volume>, <fpage>2056</fpage>–<lpage>2058</lpage>.</mixed-citation>
    </ref>
    <ref id="bty389-B17">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Lafond</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>). An optimal reconciliation algorithm for gene trees with polytomies. In: <italic>WABI</italic>, pp. <fpage>106</fpage>–<lpage>122</lpage>.</mixed-citation>
    </ref>
    <ref id="bty389-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Mallo</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Unsorted homology within locus and species trees</article-title>. <source>Syst. Biol</source>., <volume>63</volume>, <fpage>988</fpage>–<lpage>992</lpage>.<pub-id pub-id-type="pmid">25077514</pub-id></mixed-citation>
    </ref>
    <ref id="bty389-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Mallo</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>SimPhy: phylogenomic simulation of gene, locus and species trees</article-title>. <source>Syst. Biol</source>., <volume>65</volume>, <fpage>334</fpage>–<lpage>344</lpage>.<pub-id pub-id-type="pmid">26526427</pub-id></mixed-citation>
    </ref>
    <ref id="bty389-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Nakhleh</surname><given-names>L.</given-names></name></person-group> (<year>2013</year>) 
<article-title>Computational approaches to species phylogeny inference and gene tree reconciliation</article-title>. <source>Trends Ecol. Evol</source>., <volume>28</volume>, <fpage>719</fpage>–<lpage>728</lpage>.<pub-id pub-id-type="pmid">24094331</pub-id></mixed-citation>
    </ref>
    <ref id="bty389-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Nguyen</surname><given-names>T.H.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Support measures to estimate the reliability of evolutionary events predicted by reconciliation methods</article-title>. <source>PLoS One</source>, <volume>8</volume>, <fpage>e73667</fpage>–<lpage>e73614</lpage>.<pub-id pub-id-type="pmid">24124449</pub-id></mixed-citation>
    </ref>
    <ref id="bty389-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Noutahi</surname><given-names>E.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Efficient gene tree correction guided by genome evolution</article-title>. <source>PLoS One</source>, <volume>11</volume>, <fpage>e0159559.</fpage><pub-id pub-id-type="pmid">27513924</pub-id></mixed-citation>
    </ref>
    <ref id="bty389-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rasmussen</surname><given-names>M.D.</given-names></name>, <name name-style="western"><surname>Kellis</surname><given-names>M.</given-names></name></person-group> (<year>2012</year>) 
<article-title>Unified modeling of gene duplication, loss, and coalescence using a locus tree</article-title>. <source>Genome Res</source>., <volume>22</volume>, <fpage>755</fpage>–<lpage>765</lpage>.<pub-id pub-id-type="pmid">22271778</pub-id></mixed-citation>
    </ref>
    <ref id="bty389-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Scornavacca</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Representing a set of reconciliations in a compact way</article-title>. <source>J. Bioinf. Comput. Biol</source>., <volume>11</volume>, <fpage>1250025.</fpage></mixed-citation>
    </ref>
    <ref id="bty389-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sjöstrand</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>A bayesian method for analyzing lateral gene transfer</article-title>. <source>Syst. Biol</source>., <volume>63</volume>, <fpage>409</fpage>–<lpage>420</lpage>.<pub-id pub-id-type="pmid">24562812</pub-id></mixed-citation>
    </ref>
    <ref id="bty389-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Stolzer</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Inferring duplications, losses, transfers and incomplete lineage sorting with nonbinary species trees</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>i409</fpage>–<lpage>i415</lpage>.<pub-id pub-id-type="pmid">22962460</pub-id></mixed-citation>
    </ref>
    <ref id="bty389-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Szöllősi</surname><given-names>G.J.</given-names></name></person-group><etal>et al</etal> (<year>2013a</year>) 
<article-title>Efficient exploration of the space of reconciled gene trees</article-title>. <source>Syst. Biol</source>., <volume>62</volume>, <fpage>901</fpage>–<lpage>912</lpage>.<pub-id pub-id-type="pmid">23925510</pub-id></mixed-citation>
    </ref>
    <ref id="bty389-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Szöllősi</surname><given-names>G.J.</given-names></name></person-group><etal>et al</etal> (<year>2013b</year>) 
<article-title>Lateral gene transfer from the dead</article-title>. <source>Syst. Biol</source>., <volume>62</volume>, <fpage>386</fpage>–<lpage>397</lpage>.<pub-id pub-id-type="pmid">23355531</pub-id></mixed-citation>
    </ref>
    <ref id="bty389-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Szöllősi</surname><given-names>G.J.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>The inference of gene trees with species trees</article-title>. <source>Syst. Biol</source>., <volume>64</volume>, <fpage>e42</fpage>–<lpage>e62</lpage>.<pub-id pub-id-type="pmid">25070970</pub-id></mixed-citation>
    </ref>
    <ref id="bty389-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Than</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>2008</year>) 
<article-title>Phylonet: a software package for analyzing and reconstructing reticulate evolutionary relationships</article-title>. <source>BMC Bioinformatics</source>, <volume>9</volume>, <fpage>322.</fpage><pub-id pub-id-type="pmid">18662388</pub-id></mixed-citation>
    </ref>
    <ref id="bty389-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wu</surname><given-names>Y.-C.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>TreeFix: statistically informed gene tree error correction using species trees</article-title>. <source>Syst. Biol</source>., <volume>62</volume>, <fpage>110</fpage>–<lpage>120</lpage>.<pub-id pub-id-type="pmid">22949484</pub-id></mixed-citation>
    </ref>
    <ref id="bty389-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zheng</surname><given-names>Y.</given-names></name>, <name name-style="western"><surname>Zhang</surname><given-names>L.</given-names></name></person-group> (<year>2017</year>) 
<article-title>Reconciliation with non-binary gene trees revisited</article-title>. <source>J. ACM</source>, <volume>64</volume>, <fpage>1</fpage>–<lpage>28</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
