<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6980424</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-18-23651</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0227177</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
            <subj-group>
              <subject>Sequence Analysis</subject>
              <subj-group>
                <subject>Sequence Alignment</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Computational Techniques</subject>
          <subj-group>
            <subject>Split-Decomposition Method</subject>
            <subj-group>
              <subject>Multiple Alignment Calculation</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Molecular biology</subject>
          <subj-group>
            <subject>Macromolecular structure analysis</subject>
            <subj-group>
              <subject>RNA structure</subject>
              <subj-group>
                <subject>RNA alignment</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleic acids</subject>
            <subj-group>
              <subject>RNA</subject>
              <subj-group>
                <subject>RNA structure</subject>
                <subj-group>
                  <subject>RNA alignment</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Biological Databases</subject>
            <subj-group>
              <subject>Sequence Databases</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
            <subj-group>
              <subject>Sequence Analysis</subject>
              <subj-group>
                <subject>Sequence Databases</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Molecular biology</subject>
          <subj-group>
            <subject>Macromolecular structure analysis</subject>
            <subj-group>
              <subject>RNA structure</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleic acids</subject>
            <subj-group>
              <subject>RNA</subject>
              <subj-group>
                <subject>RNA structure</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Molecular biology</subject>
          <subj-group>
            <subject>Macromolecular structure analysis</subject>
            <subj-group>
              <subject>RNA structure</subject>
              <subj-group>
                <subject>RNA folding</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleic acids</subject>
            <subj-group>
              <subject>RNA</subject>
              <subj-group>
                <subject>RNA structure</subject>
                <subj-group>
                  <subject>RNA folding</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleic acids</subject>
            <subj-group>
              <subject>RNA</subject>
              <subj-group>
                <subject>Non-coding RNA</subject>
                <subj-group>
                  <subject>Transfer RNA</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Nucleic acids</subject>
            <subj-group>
              <subject>RNA</subject>
              <subj-group>
                <subject>RNA sequences</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>RNAmountAlign: Efficient software for local, global, semiglobal pairwise and multiple RNA sequence/structure alignment</article-title>
      <alt-title alt-title-type="running-head">RNAmountAlign: Local, global, semiglobal pairwise and multiple RNA sequence/structure alignment</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Bayegan</surname>
          <given-names>Amir H.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-3628-2874</contrib-id>
        <name>
          <surname>Clote</surname>
          <given-names>Peter</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Project administration</role>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001"/>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <addr-line>Biology Department, Boston College, Chestnut Hill, MA, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Zhang</surname>
          <given-names>Yang</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of Michigan, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>clote@bc.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>24</day>
      <month>1</month>
      <year>2020</year>
    </pub-date>
    <volume>15</volume>
    <issue>1</issue>
    <elocation-id>e0227177</elocation-id>
    <history>
      <date date-type="received">
        <day>10</day>
        <month>8</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>12</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2020 Bayegan, Clote</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Bayegan, Clote</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pone.0227177.pdf"/>
    <abstract>
      <p>Alignment of structural RNAs is an important problem with a wide range of applications. Since function is often determined by molecular structure, RNA alignment programs should take into account both sequence and base-pairing information for structural homology identification. This paper describes <monospace>C++</monospace> software, <monospace>RNAmountAlign</monospace>, for RNA sequence/structure alignment that runs in <italic>O</italic>(<italic>n</italic><sup>3</sup>) time and <italic>O</italic>(<italic>n</italic><sup>2</sup>) space for two sequences of length <italic>n</italic>; moreover, our software returns a <italic>p</italic>-value (transformable to expect value <italic>E</italic>) based on Karlin-Altschul statistics for local alignment, as well as parameter fitting for local and global alignment. Using incremental mountain height, a representation of structural information computable in cubic time, <monospace>RNAmountAlign</monospace> implements quadratic time pairwise local, global and global/semiglobal (query search) alignment using a weighted combination of sequence and structural similarity. <monospace>RNAmountAlign</monospace> is capable of performing progressive multiple alignment as well. Benchmarking of <monospace>RNAmountAlign</monospace> against <monospace>LocARNA</monospace>, <monospace>LARA</monospace>, <monospace>FOLDALIGN</monospace>, <monospace>DYNALIGN</monospace>, <monospace>STRAL</monospace>, <monospace>MXSCARNA</monospace>, and <monospace>MUSCLE</monospace> shows that <monospace>RNAmountAlign</monospace> has reasonably good accuracy and faster run time supporting all alignment types. Additionally, our extension of <monospace>RNAmountAlign</monospace>, called <monospace>RNAmountAlignScan</monospace>, which scans a target genome sequence to find hits having high sequence and structural similarity to a given query sequence, outperforms <monospace>RSEARCH</monospace> and sequence-only query scans and runs faster than <monospace>FOLDALIGN</monospace> query scan.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000001</institution-id>
            <institution>National Science Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>DBI-126243</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-3628-2874</contrib-id>
          <name>
            <surname>Clote</surname>
            <given-names>Peter</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>PC received NSF grant DBI-1262439, National Science Foundation (<ext-link ext-link-type="uri" xlink:href="https://www.nsf.gov">www.nsf.gov</ext-link>). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="10"/>
      <table-count count="5"/>
      <page-count count="34"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>Source code and all data are uploaded on Github: (<ext-link ext-link-type="uri" xlink:href="https://github.com/clotelab/RNAmountAlign">https://github.com/clotelab/RNAmountAlign</ext-link>) with DOI: (<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.3595547">https://doi.org/10.5281/zenodo.3595547</ext-link>).</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>Source code and all data are uploaded on Github: (<ext-link ext-link-type="uri" xlink:href="https://github.com/clotelab/RNAmountAlign">https://github.com/clotelab/RNAmountAlign</ext-link>) with DOI: (<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.3595547">https://doi.org/10.5281/zenodo.3595547</ext-link>).</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>A number of different metrics exist for comparison of RNA secondary structures, including base pair distance (BP), string edit distance (SE) [<xref rid="pone.0227177.ref001" ref-type="bibr">1</xref>], mountain distance (MD) [<xref rid="pone.0227177.ref002" ref-type="bibr">2</xref>], tree edit distance (TE) [<xref rid="pone.0227177.ref003" ref-type="bibr">3</xref>], coarse tree edit distance (HTE) [<xref rid="pone.0227177.ref004" ref-type="bibr">4</xref>], morphological distance [<xref rid="pone.0227177.ref005" ref-type="bibr">5</xref>] and a few other metrics. In what appears to be the most comprehensive published comparison of various secondary structure metrics [<xref rid="pone.0227177.ref006" ref-type="bibr">6</xref>], it was shown that all of these distance measures are highly correlated with respect to Pearson correlation when computing distances between structures taken from the Boltzmann low-energy ensemble of secondary structures [<xref rid="pone.0227177.ref007" ref-type="bibr">7</xref>] for the same RNA sequence—so-called <italic>intra-ensemble</italic> correlation. In contrast, these distance measures have low Pearson correlation when computing distances between structures taken from Boltzmann ensembles of different RNA sequences of the same length—so-called <italic>inter-ensemble</italic> correlation. For instance, the intra-ensemble correlation between base pair distance (BP) and mountain distance (MD) is 0.822, while the corresponding inter-ensemble correlation drops to 0.210. Intra-ensemble correlation between string edit distance (SE) and the computationally more expensive tree edit distance (TE) is 0.975, while the corresponding intra-ensemble correlation drops to 0.590—see <xref rid="pone.0227177.t001" ref-type="table">Table 1</xref>.</p>
    <table-wrap id="pone.0227177.t001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0227177.t001</object-id>
      <label>Table 1</label>
      <caption>
        <title>Pearson correlation between various secondary structure metrics.</title>
      </caption>
      <alternatives>
        <graphic id="pone.0227177.t001g" xlink:href="pone.0227177.t001"/>
        <table frame="box" rules="all" border="0">
          <colgroup span="1">
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
          </colgroup>
          <tbody>
            <tr>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1">BP</td>
              <td align="center" rowspan="1" colspan="1">MD</td>
              <td align="center" rowspan="1" colspan="1">SE</td>
              <td align="center" rowspan="1" colspan="1">TE</td>
              <td align="center" rowspan="1" colspan="1">HTE</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1">BP</td>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1">0.210</td>
              <td align="center" rowspan="1" colspan="1">0.134</td>
              <td align="center" rowspan="1" colspan="1">0.133</td>
              <td align="center" rowspan="1" colspan="1">0.230</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1">MD</td>
              <td align="center" rowspan="1" colspan="1">0.822</td>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1">0.519</td>
              <td align="center" rowspan="1" colspan="1">0.607</td>
              <td align="center" rowspan="1" colspan="1">0.515</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1">SE</td>
              <td align="center" rowspan="1" colspan="1">0.960</td>
              <td align="center" rowspan="1" colspan="1">0.853</td>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1">0.590</td>
              <td align="center" rowspan="1" colspan="1">0.310</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1">TE</td>
              <td align="center" rowspan="1" colspan="1">0.943</td>
              <td align="center" rowspan="1" colspan="1">0.879</td>
              <td align="center" rowspan="1" colspan="1">0.975</td>
              <td align="center" rowspan="1" colspan="1"/>
              <td align="center" rowspan="1" colspan="1">0.597</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1">HTE</td>
              <td align="center" rowspan="1" colspan="1">0.852</td>
              <td align="center" rowspan="1" colspan="1">0.844</td>
              <td align="center" rowspan="1" colspan="1">0.879</td>
              <td align="center" rowspan="1" colspan="1">0.913</td>
              <td align="center" rowspan="1" colspan="1"/>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="t001fn001">
          <p>Pearson correlation between various secondary structure metrics, as computed in [<xref rid="pone.0227177.ref006" ref-type="bibr">6</xref>]: base pair distance (BP), string edit distance (SE) [<xref rid="pone.0227177.ref001" ref-type="bibr">1</xref>], mountain distance (MD) [<xref rid="pone.0227177.ref002" ref-type="bibr">2</xref>], tree edit distance (TE) [<xref rid="pone.0227177.ref003" ref-type="bibr">3</xref>] and coarse tree edit distance (HTE) [<xref rid="pone.0227177.ref004" ref-type="bibr">4</xref>]. Lower triangular values indicate intra-ensemble correlations; upper triangular values indicate inter-ensemble correlations. Table values are taken from [<xref rid="pone.0227177.ref006" ref-type="bibr">6</xref>].</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>Due to poor inter-ensemble correlation of RNA secondary structure metrics, and the fact that most secondary structure pairwise alignment algorithms depend essentially on some form of base pair distance, string edit distance, or free energy of common secondary structure, we have developed the first RNA sequence/structure pairwise alignment algorithm that is based on (incremental ensemble) mountain distance. Our software, <monospace>RNAmountAlign</monospace>, uses this distance measure, since the Boltzmann ensemble of all secondary structures of a given RNA of length <italic>n</italic> can represented as a length <italic>n</italic> vector of real numbers, thus allowing an adaptation of fast sequence alignment methods. Depending on the command-line flag given, our software, <monospace>RNAmountAlign</monospace> can perform pairwise alignment, (Needleman-Wunsch global [<xref rid="pone.0227177.ref008" ref-type="bibr">8</xref>], Smith-Waterman local [<xref rid="pone.0227177.ref009" ref-type="bibr">9</xref>] or semiglobal [<xref rid="pone.0227177.ref010" ref-type="bibr">10</xref>] alignment) as well as progressive multiple alignment (global and local), computed using a guide tree as in <monospace>CLUSTAL</monospace> [<xref rid="pone.0227177.ref011" ref-type="bibr">11</xref>]. Expect values <italic>E</italic> for local alignments are computed using Karlin-Altschul extreme-value statistics [<xref rid="pone.0227177.ref012" ref-type="bibr">12</xref>, <xref rid="pone.0227177.ref013" ref-type="bibr">13</xref>], suitably modified to account for our new sequence/structure similarity measure. Additionally, <monospace>RNAmountAlign</monospace> can determine <italic>p</italic>-values (hence <italic>E</italic>-values) by parameter fitting for the normal (ND), extreme value (EVD) and gamma (GD) distributions.</p>
    <p>We benchmark the performance of <monospace>RNAmountAlign</monospace> on pairwise and multiple global sequence/structure alignment of RNAs against the widely used programs <monospace>LARA</monospace>, <monospace>FOLDALIGN</monospace>, <monospace>DYNALIGN</monospace>, <monospace>LocARNA</monospace>, <monospace>STRAL</monospace> and <monospace>MXSCARNA</monospace>. <monospace>LARA</monospace> (Lagrangian relaxed structural alignment) [<xref rid="pone.0227177.ref014" ref-type="bibr">14</xref>] formulates the problem of RNA (multiple) sequence/structure alignment as a problem in integer linear programming (ILP), then computes optimal or near-optimal solutions to this problem. The software <monospace>FOLDALIGN</monospace> [<xref rid="pone.0227177.ref015" ref-type="bibr">15</xref>–<xref rid="pone.0227177.ref017" ref-type="bibr">17</xref>], and <monospace>DYNALIGN</monospace> [<xref rid="pone.0227177.ref018" ref-type="bibr">18</xref>] are different <italic>O</italic>(<italic>n</italic><sup>4</sup>) approximate implementations of Sankoff’s <italic>O</italic>(<italic>n</italic><sup>6</sup>) optimal RNA sequence/structure alignment algorithm. <monospace>FOLDALIGN</monospace> sets limits on the maximum length of the alignment as well as the maximum distance between subsequences being aligned in order to reduce the time complexity of the Sankoff algorithm. <monospace>DYNALIGN</monospace> [<xref rid="pone.0227177.ref018" ref-type="bibr">18</xref>] implements pairwise RNA secondary structural alignment by determining the common structure to both sequences that has lowest free energy, using a positive (destabilizing) energy heuristic for gaps introduced, in addition to setting bounds on the distance between subsequences being aligned. In particular, the only contribution from nucleotide information in <monospace>Dynalign</monospace> is from the nucleotide-dependent free energy parameters for base stacking, dangles, etc. <monospace>LocARNA</monospace> (local alignment of RNA) [<xref rid="pone.0227177.ref019" ref-type="bibr">19</xref>, <xref rid="pone.0227177.ref020" ref-type="bibr">20</xref>] is a heuristic implementation of <monospace>PMcomp</monospace> [<xref rid="pone.0227177.ref021" ref-type="bibr">21</xref>] which compares the base pairing probability matrices computed by McCaskill’s algorithm. Although the software is not maintained, <monospace>STRAL</monospace> [<xref rid="pone.0227177.ref022" ref-type="bibr">22</xref>] which is similar to our approach, uses up- and downstream base pairing probabilities as the structural information and combines them with sequence similarity in a weighted fashion. <monospace>MXSCARNA</monospace> [<xref rid="pone.0227177.ref023" ref-type="bibr">23</xref>] is a progressive multiple alignment algorithm based on the pairwise alignment algorithm of <monospace>SCARNA</monospace> [<xref rid="pone.0227177.ref024" ref-type="bibr">24</xref>]. In contrast to Sankoff-type methods, <monospace>SCARNA</monospace> is a heuristic algorithm that performs alignment based on the detection of fixed-length stem candidates that belong to the consensus secondary structure of given sequences.</p>
    <p><monospace>LARA</monospace>, <monospace>mLocARNA</monospace> (extension of <monospace>LocARNA</monospace>), <monospace>FOLDALIGNM</monospace> [<xref rid="pone.0227177.ref016" ref-type="bibr">16</xref>, <xref rid="pone.0227177.ref025" ref-type="bibr">25</xref>] (extension of <monospace>FOLDALIGN</monospace>), <monospace>Multilign</monospace> [<xref rid="pone.0227177.ref026" ref-type="bibr">26</xref>, <xref rid="pone.0227177.ref027" ref-type="bibr">27</xref>] (extension of <monospace>DYNALIGN</monospace>), <monospace>STRAL</monospace> and <monospace>MXSCARNA</monospace> support multiple alignment. <monospace>LARA</monospace> computes all pairwise sequence alignments and subsequently uses the <monospace>T-Coffee</monospace> package [<xref rid="pone.0227177.ref028" ref-type="bibr">28</xref>] to construct multiple alignments. Both <monospace>FOLDALIGNM</monospace> and <monospace>mLocARNA</monospace> implement progressive alignment of consensus base pairing probability matrices using a guide tree similar to the approach of <monospace>PMmulti</monospace> [<xref rid="pone.0227177.ref021" ref-type="bibr">21</xref>]. For a set of given sequences, <monospace>Multilign</monospace> uses <monospace>DYNALIGN</monospace> to compute the pairwise alignment of a single fixed index sequence to each other sequence in the set, and computes a consensus structure. In each pairwise alignment, only the index sequence base pairs found in previous computations are used. More iterations in the same manner with the same index sequence are then used to improve the structure prediction of other sequences. The number of pairwise alignments in <monospace>Multilign</monospace> is linear with respect to the number of sequences. <monospace>STRAL</monospace> and <monospace>MXSCARNA</monospace> perform multiple alignment in a fashion similar to <monospace>CLASTALW</monospace> [<xref rid="pone.0227177.ref029" ref-type="bibr">29</xref>]. <xref rid="pone.0227177.t002" ref-type="table">Table 2</xref> provides an overview of various features, to the best of our knowledge, supported by the software benchmarked in this paper.</p>
    <table-wrap id="pone.0227177.t002" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0227177.t002</object-id>
      <label>Table 2</label>
      <caption>
        <title>Software features.</title>
      </caption>
      <alternatives>
        <graphic id="pone.0227177.t002g" xlink:href="pone.0227177.t002"/>
        <table frame="box" rules="all" border="0">
          <colgroup span="1">
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Software</th>
              <th align="center" rowspan="1" colspan="1">Local</th>
              <th align="center" rowspan="1" colspan="1">Global</th>
              <th align="center" rowspan="1" colspan="1">Semiglobal</th>
              <th align="center" rowspan="1" colspan="1">E-value</th>
              <th align="center" rowspan="1" colspan="1">F1(Pairwise)</th>
              <th align="center" rowspan="1" colspan="1">SPS(Multiple)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">RNAmountAlign</td>
              <td align="center" rowspan="1" colspan="1">✓</td>
              <td align="center" rowspan="1" colspan="1">✓</td>
              <td align="center" rowspan="1" colspan="1">✓</td>
              <td align="center" rowspan="1" colspan="1">✓</td>
              <td align="char" char="." rowspan="1" colspan="1">0.84</td>
              <td align="char" char="." rowspan="1" colspan="1">0.81</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">LocARNA</td>
              <td align="center" rowspan="1" colspan="1">✓</td>
              <td align="center" rowspan="1" colspan="1">✓</td>
              <td align="center" rowspan="1" colspan="1">—</td>
              <td align="center" rowspan="1" colspan="1">—</td>
              <td align="char" char="." rowspan="1" colspan="1">0.81</td>
              <td align="char" char="." rowspan="1" colspan="1">0.86</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">LARA</td>
              <td align="center" rowspan="1" colspan="1">—</td>
              <td align="center" rowspan="1" colspan="1">✓</td>
              <td align="center" rowspan="1" colspan="1">—</td>
              <td align="center" rowspan="1" colspan="1">—</td>
              <td align="char" char="." rowspan="1" colspan="1">0.84</td>
              <td align="char" char="." rowspan="1" colspan="1">0.85</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">FOLDALIGN</td>
              <td align="center" rowspan="1" colspan="1">✓</td>
              <td align="center" rowspan="1" colspan="1">✓</td>
              <td align="center" rowspan="1" colspan="1">—</td>
              <td align="center" rowspan="1" colspan="1">✓</td>
              <td align="char" char="." rowspan="1" colspan="1">0.80</td>
              <td align="char" char="." rowspan="1" colspan="1">0.74</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">DYNALIGN</td>
              <td align="center" rowspan="1" colspan="1">—</td>
              <td align="center" rowspan="1" colspan="1">✓</td>
              <td align="center" rowspan="1" colspan="1">—</td>
              <td align="center" rowspan="1" colspan="1">—</td>
              <td align="char" char="." rowspan="1" colspan="1">0.68</td>
              <td align="char" char="." rowspan="1" colspan="1">0.63</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">STRAL</td>
              <td align="center" rowspan="1" colspan="1">—</td>
              <td align="center" rowspan="1" colspan="1">✓</td>
              <td align="center" rowspan="1" colspan="1">—</td>
              <td align="center" rowspan="1" colspan="1">—</td>
              <td align="char" char="." rowspan="1" colspan="1">0.82</td>
              <td align="center" rowspan="1" colspan="1">—</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">MXSCARNA</td>
              <td align="center" rowspan="1" colspan="1">✓</td>
              <td align="center" rowspan="1" colspan="1">✓</td>
              <td align="center" rowspan="1" colspan="1">—</td>
              <td align="center" rowspan="1" colspan="1">—</td>
              <td align="char" char="." rowspan="1" colspan="1">0.84</td>
              <td align="char" char="." rowspan="1" colspan="1">0.84</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="t002fn001">
          <p>Overview of features in software used in benchmarking tests, where ✓ [resp. —] indicates the presence [resp. absence] of said feature, to the best of our knowledge. Average F1 [resp. SPS] scores for the pairwise [resp. multiple] global alignment are given, computed as explained in the text. F1 score is defined as the harmonic mean of the sensitivity (Sen) and positive predictive value (PPV). SPS is defined as the number of correctly nucleotide pairs in the alignment produced by a given algorithm, divided by the total number of aligned nucleotide pairs in the reference alignment.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>In this paper we provide a very fast, comprehensive software package capable of pairwise/multiple local/global/semiglobal alignment with <italic>p</italic>-values and <italic>E</italic>-values for statistical significance. Moreover, due to its speed and relatively good accuracy, the software can be used for whole-genome scans for homologues of an RNA as query, a similar modality as in the software <monospace>RSEARCH</monospace> [<xref rid="pone.0227177.ref030" ref-type="bibr">30</xref>]. This type of whole-genome scan is in contrast to <monospace>Infernal</monospace> [<xref rid="pone.0227177.ref031" ref-type="bibr">31</xref>], which requires a multiple alignment of distinct RNAs to construct a covariance model for whole-genome searches. Searching for homologues from only a single sequence is potentially useful in the case of <italic>orphan</italic> RNAs, very recently discovered RNAs that do not belong to any known RNA family.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Materials and methods</title>
    <p>Quadratic time alignment using affine gap cost is implemented in <monospace>RNAmountAlign</monospace> using the Gotoh method [<xref rid="pone.0227177.ref032" ref-type="bibr">32</xref>] with the following pseudocode, shown for the case of semiglobal alignment. In our query scan form of semiglobal alignment, if <bold>a</bold> = <italic>a</italic><sub>1</sub>, …, <italic>a<sub>n</sub></italic> is the query sequence and <bold>b</bold> = <italic>b</italic><sub>1</sub>, …, <italic>b<sub>m</sub></italic> is the current genomic window being searched for an occurrence of <bold>a</bold>, then there is no penalty for gaps occurring to the left of the nucleotide of <bold>b</bold> aligned with <italic>a</italic><sub>1</sub> nor for gaps occurring to the right of the nucleotide of <bold>b</bold> aligned with <italic>a</italic><sub><italic>m</italic></sub>, although internal gaps are penalized. This is obtained by the following pseudocode, as also found in [<xref rid="pone.0227177.ref033" ref-type="bibr">33</xref>]. Let <italic>g</italic>(<italic>k</italic>) denote an affine cost for size <italic>k</italic> gap, defined by <italic>g</italic>(0) = 0 and <italic>g</italic>(<italic>k</italic>) = <italic>g</italic><sub><italic>i</italic></sub> + (<italic>k</italic> − 1) ⋅ <italic>g</italic><sub><italic>e</italic></sub> for positive gap initiation [resp. extension] costs <italic>g</italic><sub><italic>i</italic></sub> [resp. <italic>g</italic><sub><italic>e</italic></sub>]. For query <bold>a</bold> = <italic>a</italic><sub>1</sub>, …, <italic>a<sub>n</sub></italic> and target <bold>b</bold> = <italic>b</italic><sub>1</sub>, …, <italic>b<sub>m</sub></italic>, define (<italic>n</italic> + 1) × (<italic>m</italic> + 1) matrices <italic>M</italic>, <italic>P</italic>, <italic>Q</italic> as follows: <italic>M</italic><sub><italic>i</italic>,0</sub> = <italic>g</italic>(<italic>i</italic>) for all 1 ≤ <italic>i</italic> ≤ <italic>n</italic>, <italic>M</italic><sub>0,<italic>j</italic></sub> = 0 for all 1 ≤ <italic>j</italic> ≤ <italic>m</italic>, while for positive <italic>i</italic>, <italic>j</italic> we have <italic>M</italic><sub><italic>i</italic>,<italic>j</italic></sub> = max (<italic>M</italic><sub><italic>i</italic>−1,<italic>j</italic>−1</sub> + <italic>sim</italic> (<italic>a</italic><sub><italic>i</italic></sub>, <italic>b</italic><sub><italic>j</italic></sub>), <italic>P</italic><sub><italic>i</italic>,<italic>j</italic></sub>, <italic>Q</italic><sub><italic>i</italic>,<italic>j</italic></sub>), where <italic>sim</italic> is a similarity measure formally defined later in <xref ref-type="disp-formula" rid="pone.0227177.e035">Eq (17)</xref>. For 1 ≤ <italic>i</italic> ≤ <italic>n</italic>, 1 ≤ <italic>j</italic> ≤ <italic>m</italic>, let <italic>P</italic><sub>0,<italic>j</italic></sub> = 0 and <italic>P</italic><sub><italic>i</italic>,<italic>j</italic></sub> = max(<italic>M</italic><sub><italic>i</italic>−1,<italic>j</italic></sub> + <italic>g</italic><sub><italic>i</italic></sub>, <italic>P</italic><sub><italic>i</italic>−1,<italic>j</italic></sub> + <italic>g</italic><sub><italic>e</italic></sub>), and define <italic>Q</italic><sub><italic>i</italic>,0</sub> = 0 and <italic>Q</italic><sub><italic>i</italic>,<italic>j</italic></sub> = max(<italic>M</italic><sub><italic>i</italic>,<italic>j</italic>−1</sub> + <italic>g</italic><sub><italic>i</italic></sub>, <italic>Q</italic><sub><italic>i</italic>,<italic>j</italic>−1</sub> + <italic>g</italic><sub><italic>e</italic></sub>, 0). Determine the maximum semiglobal alignment score in row <italic>n</italic>, then perform backtracking to obtain an optimal semiglobal alignment.</p>
    <sec id="sec003">
      <title>Incremental ensemble mountain height</title>
      <p>A secondary structure for a given RNA nucleotide sequence <bold>a</bold> = <italic>a</italic><sub>1</sub>, …, <italic>a<sub>n</sub></italic> is a set <italic>s</italic> of base pairs (<italic>i</italic>, <italic>j</italic>), where 1 ≤ <italic>i</italic> &lt; <italic>j</italic> ≤ <italic>n</italic>, such that:
<list list-type="order"><list-item><p>if (<italic>i</italic>, <italic>j</italic>) ∈ <italic>s</italic> then <italic>a</italic><sub><italic>i</italic></sub>, <italic>a</italic><sub><italic>j</italic></sub> form either a Watson-Crick (AU,UA,CG,GC) or wobble (GU,UG) base pair,</p></list-item><list-item><p>if (<italic>i</italic>, <italic>j</italic>) ∈ <italic>s</italic> then <italic>j</italic> − <italic>i</italic> &gt; <italic>θ</italic> = 3 (a steric constraint requiring that there be at least <italic>θ</italic> = 3 unpaired bases between any two positions that are paired),</p></list-item><list-item><p>if (<italic>i</italic>, <italic>j</italic>) ∈ <italic>s</italic> then for all <italic>i</italic>′ ≠ <italic>i</italic> and <italic>j</italic>′ ≠ <italic>j</italic>, (<italic>i</italic>′, <italic>j</italic>) ∉ <italic>s</italic> and (<italic>i</italic>, <italic>j</italic>′) ∉ <italic>s</italic> (nonexistence of base triples),</p></list-item><list-item><p>if (<italic>i</italic>, <italic>j</italic>) ∈ <italic>s</italic> and (<italic>k</italic>, <italic>ℓ</italic>) ∈ <italic>s</italic>, then it is not the case that <italic>i</italic> &lt; <italic>k</italic> &lt; <italic>j</italic> &lt; <italic>ℓ</italic> (nonexistence of pseudoknots).</p></list-item></list></p>
      <p>Secondary structures can be depicted in several equivalent manners, but in this paper, we use the dot-bracket notation in which matching left and right parenthesis positions indicate base-paired nucleotides. For instance, the EMBL accession code, sequence and secondary structure of a 53 nt type III hammerhead ribozyme from peach latent mosaic viroid (PLMVd), obtained from the Rfam database [<xref rid="pone.0227177.ref034" ref-type="bibr">34</xref>], is given as follows</p>
      <p>
        <monospace>&gt; AJ550901.1/282-334</monospace>
      </p>
      <p>
        <monospace>12345678901234567890123456789012345678901234567890123</monospace>
      </p>
      <p>
        <monospace>GAAGAGUCGCGCUAAGCGCACUGAUGAGUCUUUGAGAUAAGACGAAACUCUUC</monospace>
      </p>
      <p>
        <monospace>.((((((.((((…))))……‥((((……‥))))…)))))).</monospace>
      </p>
      <p>Positions 1 and 53 (for instance) are unpaired, as indicated by a dot, while positions 2 and 52 are paired and form the outermost base pair (2, 52), positions 12, 16 are paired and base pair (12, 16) constitutes one of the two apical (hairpin) loops, while the other apical (hairpin) loop is closed by the base pair (31, 40), etc.</p>
      <p>Given an RNA sequence <bold>a</bold> = <italic>a</italic><sub>1</sub>, …, <italic>a<sub>n</sub></italic>, the base pairing probabilities <inline-formula id="pone.0227177.e001"><alternatives><graphic xlink:href="pone.0227177.e001.jpg" id="pone.0227177.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> are defined by
<disp-formula id="pone.0227177.e002"><alternatives><graphic xlink:href="pone.0227177.e002.jpg" id="pone.0227177.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:msubsup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi mathvariant="bold">a</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:mtext>exp</mml:mtext><mml:mo>(</mml:mo><mml:mo>−</mml:mo><mml:mi>E</mml:mi><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mi>R</mml:mi><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>Z</mml:mi></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mi>Z</mml:mi></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi mathvariant="bold">a</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mo>−</mml:mo><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mi>R</mml:mi><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula>
where <italic>Z</italic> is the <italic>partition function</italic>, <inline-formula id="pone.0227177.e003"><alternatives><graphic xlink:href="pone.0227177.e003.jpg" id="pone.0227177.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi mathvariant="bold">a</mml:mi></mml:msub></mml:math></alternatives></inline-formula> denotes the set of secondary structures of <bold>a</bold>, <italic>E</italic>(<italic>s</italic>) is the free energy of secondary structure <italic>s</italic> using energy parameters from [<xref rid="pone.0227177.ref035" ref-type="bibr">35</xref>]. Given <bold>a</bold> = <italic>a</italic><sub>1</sub>, …, <italic>a<sub>n</sub></italic> of length <italic>n</italic>, the <italic>mountain height</italic> [<xref rid="pone.0227177.ref036" ref-type="bibr">36</xref>] <italic>h</italic><sub><italic>s</italic></sub>(<italic>k</italic>) of a secondary structure <italic>s</italic> of <bold>a</bold> at position <italic>k</italic> is defined as the number of base pairs in <italic>s</italic> that lie between an external loop and <italic>k</italic>, formally given by
<disp-formula id="pone.0227177.e004"><alternatives><graphic xlink:href="pone.0227177.e004.jpg" id="pone.0227177.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:mo>{</mml:mo><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>∈</mml:mo><mml:mi>s</mml:mi><mml:mo>:</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>}</mml:mo><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mo>|</mml:mo><mml:mo>{</mml:mo><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>∈</mml:mo><mml:mi>s</mml:mi><mml:mo>:</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>}</mml:mo><mml:mo>|</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula>
We follow [<xref rid="pone.0227177.ref002" ref-type="bibr">2</xref>, <xref rid="pone.0227177.ref036" ref-type="bibr">36</xref>] in our definition of mountain height, and related notions of ensemble mountain height and distance, while [<xref rid="pone.0227177.ref037" ref-type="bibr">37</xref>] and Vienna RNA package [<xref rid="pone.0227177.ref004" ref-type="bibr">4</xref>] differ in an inessential manner by defining <italic>h</italic><sub><italic>s</italic></sub>(<italic>k</italic>) = |{(<italic>i</italic>, <italic>j</italic>) ∈ <italic>s</italic>: <italic>i</italic> &lt; <italic>k</italic>}| − |{(<italic>i</italic>, <italic>j</italic>) ∈ <italic>s</italic>: <italic>j</italic> ≤ <italic>k</italic>}|. If we consider the secondary structure <italic>s</italic>, defined as a <italic>set</italic> of base pairs (<italic>i</italic>, <italic>j</italic>) where 1 ≤ <italic>i</italic> &lt; <italic>j</italic> ≤ <italic>n</italic>, as a dot-bracket notation, then <italic>h</italic><sub><italic>s</italic></sub>(<italic>k</italic>) is simply the running count, where in scanning from left-to-right we add 1 to the count for each open parenthesis <monospace>(</monospace>, and subtract 1 from the count for each closed parenthesis <monospace>)</monospace>, encountered between 1, …, <italic>k</italic>.</p>
      <p>The <italic>ensemble mountain height</italic> 〈<italic>h</italic>(<italic>k</italic>)〉 [<xref rid="pone.0227177.ref037" ref-type="bibr">37</xref>] for RNA sequence <bold>a</bold> = <italic>a</italic><sub>1</sub>, …, <italic>a<sub>n</sub></italic> at position <italic>k</italic> is defined as the average mountain height, where the average is taken over the Boltzmann ensemble of all low-energy structures <italic>s</italic> of sequence <bold>a</bold>. If base pairing probabilities <italic>p</italic><sub><italic>i</italic>,<italic>j</italic></sub> have been computed, then it follows that
<disp-formula id="pone.0227177.e005"><alternatives><graphic xlink:href="pone.0227177.e005.jpg" id="pone.0227177.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>⟨</mml:mo><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mo>⟩</mml:mo></mml:mrow><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(3)</label></disp-formula>
and hence the <italic>incremental ensemble mountain height</italic>, which for values 1 &lt; <italic>k</italic> ≤ <italic>n</italic> is defined by <italic>m</italic><sub><bold>a</bold></sub>(<italic>k</italic>) = 〈<italic>h</italic>(<italic>k</italic>)〉 − 〈<italic>h</italic>(<italic>k</italic> − 1)〉 can be computed by
<disp-formula id="pone.0227177.e006"><alternatives><graphic xlink:href="pone.0227177.e006.jpg" id="pone.0227177.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi mathvariant="bold">a</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(4)</label></disp-formula>
It is clear that −1 ≤ <italic>m</italic><sub><bold>a</bold></sub>(<italic>k</italic>) ≤ 1, and that both ensemble mountain height and incremental ensemble mountain height can be computed in time that is quadratic in sequence length <italic>n</italic>, provided that base pairing probabilities <italic>p</italic><sub><italic>i</italic>,<italic>j</italic></sub> have been computed. Except for the cubic time taken by a C-library function call of <monospace>export_bppm()</monospace> from from Vienna RNA package [<xref rid="pone.0227177.ref004" ref-type="bibr">4</xref>], the software <monospace>RNAmountAlign</monospace> has quadratic time and space requirements. The following pairwise alignment of 72 nt tRNA AL671879.2 and 69 nt tRNA D16387.1, both taken from the <monospace>BRAliBase 2.1 K2</monospace> database [<xref rid="pone.0227177.ref038" ref-type="bibr">38</xref>], was generated by the <monospace>RNAmountAlign</monospace> web server, with default parameters of gap initiation −3, gap extension −1 and structural weight <italic>γ</italic> = 1/2, which latter equally weights the contributions from sequence and structural similarity. The alignment produced by <monospace>RNAmountAlign</monospace> is identical to the reference alignment from <monospace>BRAliBase 2.1 K2</monospace>, although sequence identity is only 28% (twilight zone). The consensus structure, shown in <xref ref-type="supplementary-material" rid="pone.0227177.s009">S1 Fig</xref>, is produced by a call of <monospace>RNAalifold</monospace> from Vienna RNA Package, given the alignment produced by <monospace>RNAmountAlign</monospace>; <xref ref-type="fig" rid="pone.0227177.g001">Fig 1</xref> is an alternative display of this alignment as a superimposition of the (gapped) ensemble mountain heights of tRNA AL671879.2 and tRNA D16387.1.</p>
      <fig id="pone.0227177.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0227177.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Ensemble mountain height display of the alignment computed by <monospace>RNAmountAlign</monospace> for 72 nt tRNA AL671879.2 and 69 nt tRNA D16387.1, both taken from <monospace>BRAliBase 2.1 K2</monospace>, using default gap parameters of −3 for gap initiation and −1 for gap extension, and structural weight <italic>γ</italic> = 1/2.</title>
          <p>The alignment produced by <monospace>RNAmountAlign</monospace> is identical to the reference alignment from <monospace>BRAliBase 2.1 K2</monospace>, although sequence identity is only 28% (twilight zone). The gap in the D16387.1 curve above corresponds to the size 3 gap in the alignment described in the text.</p>
        </caption>
        <graphic xlink:href="pone.0227177.g001"/>
      </fig>
      <p>
        <monospace>&gt; AL671879.2</monospace>
      </p>
      <p>
        <monospace>GGGGAUGUAGCUCAGUGGUAGAGCGCAUGCUUCGCAUGUAUGAGGCCCCGGGUUCGAUCCCCGGCAUCUCCA</monospace>
      </p>
      <p>
        <monospace>&gt; D16387.1</monospace>
      </p>
      <p>
        <monospace>GUUUCAUGAGUAUAGC---AGUACAUUCGGCUUCCAACCGAAAGGUUUUUGUAAACAACCAAAAAUGAAAUA</monospace>
      </p>
      <p>
        <monospace>&gt; RNAalifold consensus structure</monospace>
      </p>
      <p>
        <monospace>(((((((‥((((…….)))).(((((…….)))))….((((((……))))))))))))).</monospace>
      </p>
    </sec>
    <sec id="sec004">
      <title>Transforming distance into similarity</title>
      <p>In [<xref rid="pone.0227177.ref039" ref-type="bibr">39</xref>], Seller’s (distance-based) global pairwise alignment algorithm [<xref rid="pone.0227177.ref040" ref-type="bibr">40</xref>] was rigorously shown to be equivalent to Needleman and Wunsch’s (similarity-based) global pairwise alignment algorithm [<xref rid="pone.0227177.ref008" ref-type="bibr">8</xref>]. Recalling that Seller’s alignment distance is defined as the minimum, taken over all alignments of the sum of distances <italic>d</italic>(<italic>x</italic>, <italic>y</italic>) between aligned nucleotides <italic>x</italic>, <italic>y</italic> plus the sum of (positive) weights <italic>w</italic>(<italic>k</italic>) for size <italic>k</italic> gaps, while Needleman-Wunsch alignment similarity is defined as the maximum, taken over all alignments of the sum of similarities <italic>s</italic>(<italic>x</italic>, <italic>y</italic>) between aligned nucleotides <italic>x</italic>, <italic>y</italic> plus the sum of (negative) gap weights <italic>g</italic>(<italic>k</italic>) for size <italic>k</italic> gaps, Smith and Waterman [<xref rid="pone.0227177.ref039" ref-type="bibr">39</xref>] show that by defining
<disp-formula id="pone.0227177.e007"><alternatives><graphic xlink:href="pone.0227177.e007.jpg" id="pone.0227177.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:mrow><mml:mi>d</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mtext>max</mml:mtext><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>U</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(5)</label></disp-formula>
<disp-formula id="pone.0227177.e008"><alternatives><graphic xlink:href="pone.0227177.e008.jpg" id="pone.0227177.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:mrow><mml:mi>w</mml:mi><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo>·</mml:mo><mml:munder><mml:mtext>max</mml:mtext><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>U</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(6)</label></disp-formula>
and by taking the minimum distance, rather than maximum similarity, the Needleman-Wunsch algorithm is transformed into Seller’s algorithm. Though formulated here for RNA nucleotides, equivalence holds over arbitrary alphabets and similarity measures (e.g. BLOSUM62).</p>
      <p>To improve the intuitive understanding of our structural distance measure <italic>STRSIM</italic>, we initially define a simple distance measure <italic>d</italic><sub>0</sub> between dot-bracket symbols. For dot-bracket symbol <italic>x</italic> ∈ { <monospace>(</monospace>, •, <monospace>)</monospace> }, define the sign function by
<disp-formula id="pone.0227177.e009"><alternatives><graphic xlink:href="pone.0227177.e009.jpg" id="pone.0227177.e009g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M9"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>sign</mml:mtext><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="4.pt"/><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mspace width="0.166667em"/><mml:mtext mathvariant="monospace">(</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="4.pt"/><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mo>•</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="4.pt"/><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mspace width="0.166667em"/><mml:mtext mathvariant="monospace">)</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(7)</label></disp-formula>
Now define the distance <italic>d</italic><sub>0</sub>(<italic>x</italic>, <italic>y</italic>) = |<italic>sign</italic>(<italic>x</italic>) − <italic>sign</italic>(<italic>y</italic>)| between dot-bracket symbols <italic>x</italic>, <italic>y</italic> ∈ { <monospace>(</monospace>, •, <monospace>)</monospace> } by
<disp-formula id="pone.0227177.e010"><alternatives><graphic xlink:href="pone.0227177.e010.jpg" id="pone.0227177.e010g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M10"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="4.pt"/><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>[</mml:mtext><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mo>•</mml:mo><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mspace width="0.166667em"/><mml:mtext mathvariant="monospace">(</mml:mtext><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mtext mathvariant="monospace">)</mml:mtext><mml:mspace width="0.166667em"/><mml:mo>}</mml:mo></mml:mrow><mml:mtext>]</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>or</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>[</mml:mtext><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mspace width="0.166667em"/><mml:mtext mathvariant="monospace">(</mml:mtext><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mtext mathvariant="monospace">)</mml:mtext><mml:mspace width="0.166667em"/><mml:mo>}</mml:mo><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mo>•</mml:mo></mml:mrow><mml:mtext>]</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mn>2</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>[</mml:mtext><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mspace width="0.166667em"/><mml:mtext mathvariant="monospace">(</mml:mtext><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mspace width="0.166667em"/><mml:mtext mathvariant="monospace">)</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mtext>]</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>or</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>[</mml:mtext><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mspace width="0.166667em"/><mml:mtext mathvariant="monospace">)</mml:mtext><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mspace width="0.166667em"/><mml:mtext mathvariant="monospace">(</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mtext>]</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(8)</label></disp-formula></p>
      <p>Let <inline-formula id="pone.0227177.e011"><alternatives><graphic xlink:href="pone.0227177.e011.jpg" id="pone.0227177.e011g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M11"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>⋯</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>N</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>t</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>⋯</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mi>N</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> denote a fixed alignment between two arbitrary secondary structures <italic>s</italic>, <italic>t</italic> of (possibly different) lengths <italic>n</italic>, <italic>m</italic>, where <inline-formula id="pone.0227177.e012"><alternatives><graphic xlink:href="pone.0227177.e012.jpg" id="pone.0227177.e012g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M12"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mspace width="0.166667em"/><mml:mtext mathvariant="monospace">(</mml:mtext><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo><mml:mo>•</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mtext mathvariant="monospace">)</mml:mtext><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, the dash − denotes the gap symbol, and where a gap is never aligned above another gap—this follows the notational convention for representation of alignments in [<xref rid="pone.0227177.ref041" ref-type="bibr">41</xref>]. We define the <italic>structural alignment distance</italic> for <italic>A</italic> by summing <inline-formula id="pone.0227177.e013"><alternatives><graphic xlink:href="pone.0227177.e013.jpg" id="pone.0227177.e013g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M13"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> over those positions <italic>i</italic> where neither character <inline-formula id="pone.0227177.e014"><alternatives><graphic xlink:href="pone.0227177.e014.jpg" id="pone.0227177.e014g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M14"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is a gap symbol, then adding <italic>w</italic>(<italic>k</italic>) for all size <italic>k</italic> gaps in <italic>A</italic>.</p>
      <p>Using incremental ensemble mountain height from <xref ref-type="disp-formula" rid="pone.0227177.e006">Eq (4)</xref>, we can generalize structural alignment distance from the simple case of comparing two dot-bracket representations of secondary structures to the more representative case of comparing the low-energy Boltzmann ensemble of secondary structures for RNA sequence <bold>a</bold> to that of RNA sequence <bold>b</bold>. Given RNA sequences <bold>a</bold> = <italic>a</italic><sub>1</sub>, …, <italic>a<sub>n</sub></italic> and <bold>b</bold> = <italic>b</italic><sub>1</sub>, …, <italic>b<sub>m</sub></italic>, and given a fixed sequence alignment <inline-formula id="pone.0227177.e015"><alternatives><graphic xlink:href="pone.0227177.e015.jpg" id="pone.0227177.e015g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M15"><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>a</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>⋯</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mi>N</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>b</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>⋯</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mi>N</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> let <inline-formula id="pone.0227177.e016"><alternatives><graphic xlink:href="pone.0227177.e016.jpg" id="pone.0227177.e016g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M16"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi mathvariant="bold">a</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>*</mml:mo></mml:msup><mml:mo>⋯</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi mathvariant="bold">a</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>N</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi mathvariant="bold">b</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>*</mml:mo></mml:msup><mml:mo>⋯</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi mathvariant="bold">b</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>N</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> denote the corresponding alignment between the incremental ensemble mountain heights <italic>m</italic><sub><bold>a</bold></sub>(1) ⋯ <italic>m</italic><sub><bold>a</bold></sub>(<italic>n</italic>) of <bold>a</bold> and and the incremental ensemble mountain heights <italic>m</italic><sub><bold>b</bold></sub>(1) ⋯ <italic>m</italic><sub><bold>b</bold></sub>(<italic>m</italic>) of <bold>b</bold>. Generalize structural distance <italic>d</italic><sub>0</sub> defined in <xref ref-type="disp-formula" rid="pone.0227177.e010">Eq (8)</xref> to <italic>d</italic><sub>1</sub> defined by <italic>d</italic><sub>1</sub>(<italic>a</italic><sub><italic>i</italic></sub>, <italic>b</italic><sub><italic>j</italic></sub>) = |<italic>m</italic><sub><italic>a</italic></sub>(<italic>i</italic>) − <italic>m</italic><sub><italic>b</italic></sub>(<italic>j</italic>)|, where <italic>m</italic><sub><italic>a</italic></sub>(<italic>i</italic>) and <italic>m</italic><sub><italic>b</italic></sub>(<italic>j</italic>) are real numbers in the interval [−1, 1], defined by <xref ref-type="disp-formula" rid="pone.0227177.e006">Eq 4</xref>. Define <italic>ensemble structural alignment distance</italic> for <italic>A</italic> by summing <italic>d</italic><sub>1</sub>(<italic>a</italic><sub><italic>i</italic></sub>, <italic>b</italic><sub><italic>j</italic></sub>) over all aligned positions <italic>i</italic>, <italic>j</italic> for which neither character is a gap symbol, then adding positive weight <italic>w</italic>(<italic>k</italic>) for all size <italic>k</italic> gaps. By Eqs (<xref ref-type="disp-formula" rid="pone.0227177.e007">5</xref>) and (<xref ref-type="disp-formula" rid="pone.0227177.e008">6</xref>), it follows that an equivalent <italic>ensemble structural similarity</italic> measure between two positions <italic>a</italic><sub><italic>i</italic></sub>, <italic>b</italic><sub><italic>j</italic></sub>, denoted <italic>STRSIM</italic>(<italic>a</italic><sub><italic>i</italic></sub>, <italic>b</italic><sub><italic>j</italic></sub>), is obtained by multiplying <italic>d</italic><sub>1</sub> and <italic>w</italic>(<italic>k</italic>) by −1:
<disp-formula id="pone.0227177.e017"><alternatives><graphic xlink:href="pone.0227177.e017.jpg" id="pone.0227177.e017g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M17"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>R</mml:mi><mml:mi>S</mml:mi><mml:mi>I</mml:mi><mml:mi>M</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(9)</label></disp-formula>
This equation will be used later, since our algorithm <monospace>RNAmountAlign</monospace> combines both sequence and ensemble structural similarity. Indeed, −|<italic>m</italic><sub><italic>a</italic></sub>(<italic>i</italic>) − <italic>m</italic><sub><italic>b</italic></sub>(<italic>j</italic>)| ∈ [−2, 0] with maximum value of 0 while RIBOSUM85-60, shown in <xref rid="pone.0227177.t003" ref-type="table">Table 3</xref>, has similarity values in the interval [−1.86, 2.22]. In order to combine sequence with structural similarity, both ranges should be rendered comparable as shown in the next section.</p>
      <table-wrap id="pone.0227177.t003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0227177.t003</object-id>
        <label>Table 3</label>
        <caption>
          <title>RIBOSUM85-60 similarity scores.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0227177.t003g" xlink:href="pone.0227177.t003"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1"/>
                <td align="center" rowspan="1" colspan="1">A</td>
                <td align="center" rowspan="1" colspan="1">C</td>
                <td align="center" rowspan="1" colspan="1">G</td>
                <td align="center" rowspan="1" colspan="1">U</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">A</td>
                <td align="center" rowspan="1" colspan="1">+2.22</td>
                <td align="center" rowspan="1" colspan="1">-1.86</td>
                <td align="center" rowspan="1" colspan="1">-1.46</td>
                <td align="center" rowspan="1" colspan="1">-1.39</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">C</td>
                <td align="center" rowspan="1" colspan="1">-1.86</td>
                <td align="center" rowspan="1" colspan="1">+1.16</td>
                <td align="center" rowspan="1" colspan="1">-2.48</td>
                <td align="center" rowspan="1" colspan="1">-1.05</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">G</td>
                <td align="center" rowspan="1" colspan="1">-1.46</td>
                <td align="center" rowspan="1" colspan="1">-2.48</td>
                <td align="center" rowspan="1" colspan="1">+1.03</td>
                <td align="center" rowspan="1" colspan="1">-1.74</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">U</td>
                <td align="center" rowspan="1" colspan="1">-1.39</td>
                <td align="center" rowspan="1" colspan="1">-1.05</td>
                <td align="center" rowspan="1" colspan="1">-1.74</td>
                <td align="center" rowspan="1" colspan="1">+1.65</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="t003fn001">
            <p>Initial portion of RIBOSUM85-60 similarity matrix for RNA nucleotides from [<xref rid="pone.0227177.ref030" ref-type="bibr">30</xref>]. RIBOSUM matrices also contain base pairing substitution scores, currently unused by <monospace>RNAmountAlign</monospace>.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec id="sec005">
      <title>Pairwise alignment</title>
      <p>In order to combine sequence and ensemble structural similarity, we determine a multiplicative scaling factor <italic>α</italic><sub>seq</sub> and an additive shift factor <italic>α</italic><sub>str</sub> such that the mean and standard deviation for the distribution of sequence similarity values from a RIBOSUM matrix [<xref rid="pone.0227177.ref030" ref-type="bibr">30</xref>] (after being multiplied by <italic>α</italic><sub>seq</sub>) are equal to the mean and standard deviation for the distribution of structural similarity values from STRSIM (after additive shift of <italic>α</italic><sub>str</sub>). The RIBOSUM85-60 nucleotide similarity matrix used in this paper is given in <xref rid="pone.0227177.t003" ref-type="table">Table 3</xref>, and the distributions for RIBOSUM and STRSIM values are shown in <xref ref-type="fig" rid="pone.0227177.g002">Fig 2</xref> for the 72 nt transfer RNA AL671879.2. Given query <bold>a</bold> = <italic>a</italic><sub>1</sub>, …, <italic>a<sub>n</sub></italic> [resp. target <bold>b</bold> = <italic>b</italic><sub>1</sub>, …, <italic>b<sub>n</sub></italic>], let <italic>p</italic><sub><italic>A</italic></sub>, <italic>p</italic><sub><italic>C</italic></sub>, <italic>p</italic><sub><italic>G</italic></sub>, <italic>p</italic><sub><italic>U</italic></sub> [resp. <inline-formula id="pone.0227177.e018"><alternatives><graphic xlink:href="pone.0227177.e018.jpg" id="pone.0227177.e018g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M18"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>A</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>C</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>G</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>U</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>] denote the nucleotide relative frequencies for <bold>a</bold> [resp. <bold>b</bold>], i.e. the proportion of occurrences of each nucleotide A,C,G,U in query <bold>a</bold> [resp. target <bold>b</bold>]. Define the mean <italic>μ</italic><sub>seq</sub> and standard deviation <italic>σ</italic><sub>seq</sub> of RIBOSUM nucleotide similarities by
<disp-formula id="pone.0227177.e019"><alternatives><graphic xlink:href="pone.0227177.e019.jpg" id="pone.0227177.e019g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M19"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:msub><mml:mi>μ</mml:mi><mml:mtext>seq</mml:mtext></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>U</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:msub><mml:mi>p</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:msubsup><mml:mi>p</mml:mi><mml:mi>y</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>·</mml:mo><mml:mi>R</mml:mi><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:mi>O</mml:mi><mml:mi>S</mml:mi><mml:mi>U</mml:mi><mml:mi>M</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(10)</label></disp-formula>
<disp-formula id="pone.0227177.e020"><alternatives><graphic xlink:href="pone.0227177.e020.jpg" id="pone.0227177.e020g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M20"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:msub><mml:mi>σ</mml:mi><mml:mtext>seq</mml:mtext></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>U</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:msub><mml:mi>p</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:msubsup><mml:mi>p</mml:mi><mml:mi>y</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>·</mml:mo><mml:mi>R</mml:mi><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:mi>O</mml:mi><mml:mi>S</mml:mi><mml:mi>U</mml:mi><mml:mi>M</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mtext>seq</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(11)</label></disp-formula></p>
      <fig id="pone.0227177.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0227177.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>For 72 nt tRNA query sequence AL671879.2, there are 12 A’s, 20 C’s, 24 G’s, and 16 U’s so nucleotide relative frequencies are approximately <italic>p</italic><sub><italic>A</italic></sub> ≈ 0.167, <italic>p</italic><sub><italic>C</italic></sub> ≈ 0.278, <italic>p</italic><sub><italic>G</italic></sub> ≈ 0.333, <italic>p</italic><sub><italic>U</italic></sub> ≈ 0.222, and for 69 nt tRNA target sequence D16498.1, there are 26 A’s, 12 C’s, 12 G’s, and 19 U’s so nucleotide relative frequencies are approximately <italic>p</italic><sub><italic>A</italic></sub> ≈ 0.377, <italic>p</italic><sub><italic>C</italic></sub> ≈ 0.174, <italic>p</italic><sub><italic>G</italic></sub> ≈ 0.174, <italic>p</italic><sub><italic>U</italic></sub> ≈ 0.275.</title>
          <p>From the base pairing probabilities computed by <monospace>RNAfold -p</monospace>, we have query frequencies <italic>p</italic><sub><monospace>(</monospace></sub> = 0.3035, <italic>p</italic><sub>•</sub> = 0.3930, <italic>p</italic><sub><monospace>)</monospace></sub> = 0.3035 and target frequencies <italic>p</italic><sub><monospace>(</monospace></sub> = 0.2835, <italic>p</italic><sub>•</sub> = 0.433, <italic>p</italic><sub><monospace>)</monospace></sub> = 0.2835, so by Eqs (<xref ref-type="disp-formula" rid="pone.0227177.e019">10</xref>), (<xref ref-type="disp-formula" rid="pone.0227177.e020">11</xref>), (<xref ref-type="disp-formula" rid="pone.0227177.e031">13</xref>) and (<xref ref-type="disp-formula" rid="pone.0227177.e032">14</xref>), we have <italic>μ</italic><sub>seq</sub> = −0.9098, <italic>σ</italic><sub>seq</sub> = 1.5871 and <italic>μ</italic><sub>str</sub> = −0.8298, <italic>σ</italic><sub>str</sub> = 0.6967. By Eqs (<xref ref-type="disp-formula" rid="pone.0227177.e033">15</xref>) and (<xref ref-type="disp-formula" rid="pone.0227177.e034">16</xref>), we determine that RIBOSUM scaling factor <italic>α</italic><sub>seq</sub> = 0.4390 and <italic>α</italic><sub>str</sub> = 0.4305 (all values shown rounded to 4-decimal places). Using these values, the scaled RIBOSUM mean is now −0.39936, now equal to the shifted STRSIM mean, and both the scaled RIBOSUM standard deviation and shifted STRSIM standard deviation equal 0.6967. Panels (a) resp. (b) show the distribution of RIBOSUM resp. STRSIM values for the nucleotide and base pairing probabilities determined from query and target, while panel (c) shows the distribution of <italic>α</italic><sub>seq</sub>-scaled RIBOSUM and <italic>α</italic><sub>str</sub>-shifted STRSIM values. It follows that the distributions in panel (c) have the same (negative) mean and same standard deviation.</p>
        </caption>
        <graphic xlink:href="pone.0227177.g002"/>
      </fig>
      <p>Compute the base pairing probabilities <inline-formula id="pone.0227177.e021"><alternatives><graphic xlink:href="pone.0227177.e021.jpg" id="pone.0227177.e021g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M21"><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> of query sequence <bold>a</bold> for 1 ≤ <italic>i</italic> ≤ <italic>j</italic> ≤ <italic>n</italic>, and <inline-formula id="pone.0227177.e022"><alternatives><graphic xlink:href="pone.0227177.e022.jpg" id="pone.0227177.e022g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M22"><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mi mathvariant="bold">b</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> of target sequence <bold>b</bold> for 1 ≤ <italic>i</italic> ≤ <italic>j</italic> ≤ <italic>m</italic> by a call to the matrix <monospace>bppm</monospace>, using the Vienna RNA Package C-library.</p>
      <p>Define the <italic>expected</italic> left <inline-formula id="pone.0227177.e023"><alternatives><graphic xlink:href="pone.0227177.e023.jpg" id="pone.0227177.e023g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M23"><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext mathvariant="monospace">(</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> and right <inline-formula id="pone.0227177.e024"><alternatives><graphic xlink:href="pone.0227177.e024.jpg" id="pone.0227177.e024g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M24"><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext mathvariant="monospace">)</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> base pairing probabilities, and the <italic>expected</italic> unpaired probability <inline-formula id="pone.0227177.e025"><alternatives><graphic xlink:href="pone.0227177.e025.jpg" id="pone.0227177.e025g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M25"><mml:msubsup><mml:mi>p</mml:mi><mml:mo>•</mml:mo><mml:mi mathvariant="bold">a</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> of query sequence <bold>a</bold> by the following
<disp-formula id="pone.0227177.e026"><alternatives><graphic xlink:href="pone.0227177.e026.jpg" id="pone.0227177.e026g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M26"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext mathvariant="monospace">(</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:msubsup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:mo>·</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext mathvariant="monospace">)</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:msubsup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:mo>·</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>p</mml:mi><mml:mo>•</mml:mo><mml:mi mathvariant="bold">a</mml:mi></mml:msubsup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext mathvariant="monospace">(</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext mathvariant="monospace">)</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(12)</label></disp-formula>
Analogously define the corresponding probabilities <inline-formula id="pone.0227177.e027"><alternatives><graphic xlink:href="pone.0227177.e027.jpg" id="pone.0227177.e027g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M27"><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext mathvariant="monospace">(</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mi mathvariant="bold">b</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, <inline-formula id="pone.0227177.e028"><alternatives><graphic xlink:href="pone.0227177.e028.jpg" id="pone.0227177.e028g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M28"><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext mathvariant="monospace">)</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mi mathvariant="bold">b</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, <inline-formula id="pone.0227177.e029"><alternatives><graphic xlink:href="pone.0227177.e029.jpg" id="pone.0227177.e029g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M29"><mml:msubsup><mml:mi>p</mml:mi><mml:mo>•</mml:mo><mml:mi mathvariant="bold">b</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> for the target sequence <bold>b</bold>.</p>
      <p>Setting <italic>s</italic><sub>0</sub>(<italic>x</italic>, <italic>y</italic>) = −<italic>d</italic><sub>0</sub>(<italic>x</italic>, <italic>y</italic>), where <italic>d</italic><sub>0</sub>(<italic>x</italic>, <italic>y</italic>) is defined in <xref ref-type="disp-formula" rid="pone.0227177.e010">Eq (8)</xref>, for given query [resp. target] base pairing probabilities <italic>p</italic><sub><monospace>(</monospace></sub>, <italic>p</italic><sub>•</sub>, <italic>p</italic><sub><monospace>)</monospace></sub> [resp. <inline-formula id="pone.0227177.e030"><alternatives><graphic xlink:href="pone.0227177.e030.jpg" id="pone.0227177.e030g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M30"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext mathvariant="monospace">(</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mo>•</mml:mo><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext mathvariant="monospace">)</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>] of dot-bracket characters, it follows that the mean <italic>μ</italic><sub>str</sub> and standard deviation <italic>σ</italic><sub>str</sub> of structural similarities can be computed by
<disp-formula id="pone.0227177.e031"><alternatives><graphic xlink:href="pone.0227177.e031.jpg" id="pone.0227177.e031g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M31"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:msub><mml:mi>μ</mml:mi><mml:mtext>str</mml:mtext></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mspace width="0.166667em"/><mml:mtext mathvariant="monospace">(</mml:mtext><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo><mml:mo>•</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mtext mathvariant="monospace">)</mml:mtext><mml:mspace width="0.166667em"/><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:msub><mml:mi>p</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:msubsup><mml:mi>p</mml:mi><mml:mi>y</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>·</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(13)</label></disp-formula>
<disp-formula id="pone.0227177.e032"><alternatives><graphic xlink:href="pone.0227177.e032.jpg" id="pone.0227177.e032g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M32"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:msub><mml:mi>σ</mml:mi><mml:mtext>str</mml:mtext></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mspace width="0.166667em"/><mml:mtext mathvariant="monospace">(</mml:mtext><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo><mml:mo>•</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mtext mathvariant="monospace">)</mml:mtext><mml:mspace width="0.166667em"/><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:msub><mml:mi>p</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:msubsup><mml:mi>p</mml:mi><mml:mi>y</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>·</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mtext>str</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(14)</label></disp-formula>
Now we compute a multiplicative factor <italic>α</italic><sub>seq</sub> and an additive shift term <italic>α</italic><sub>str</sub>, both dependent on frequencies <italic>p</italic><sub><italic>A</italic></sub>, <italic>p</italic><sub><italic>C</italic></sub>, <italic>p</italic><sub><italic>G</italic></sub>, <italic>p</italic><sub><italic>U</italic></sub> and <italic>p</italic><sub><monospace>(</monospace></sub>, <italic>p</italic><sub>•</sub>, <italic>p</italic><sub><monospace>)</monospace></sub>, such that the mean [resp. standard deviation] of nucleotide similarity multiplied by <italic>α</italic><sub>seq</sub> is equal to the mean [resp. standard deviation] of structural similarity after addition of shift term <italic>α</italic><sub>str</sub>:
<disp-formula id="pone.0227177.e033"><alternatives><graphic xlink:href="pone.0227177.e033.jpg" id="pone.0227177.e033g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M33"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>α</mml:mi><mml:mtext>seq</mml:mtext></mml:msub></mml:mtd><mml:mtd columnalign="right"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mtext>str</mml:mtext></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mtext>seq</mml:mtext></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(15)</label></disp-formula>
<disp-formula id="pone.0227177.e034"><alternatives><graphic xlink:href="pone.0227177.e034.jpg" id="pone.0227177.e034g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M34"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:msub><mml:mi>α</mml:mi><mml:mtext>str</mml:mtext></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mtext>seq</mml:mtext></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mtext>seq</mml:mtext></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mtext>str</mml:mtext></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(16)</label></disp-formula></p>
      <p>Given the query RNA <bold>a</bold> = <italic>a</italic><sub>1</sub>, …, <italic>a<sub>n</sub></italic> and target RNA <bold>b</bold> = <italic>b</italic><sub>1</sub>, …, <italic>b<sub>m</sub></italic> with incremental ensemble mountain heights <italic>m</italic><sub><bold>a</bold></sub>(1) ⋯ <italic>m</italic><sub><bold>a</bold></sub>(<italic>m</italic>) of <bold>a</bold>, <italic>m</italic><sub><bold>b</bold></sub>(1) ⋯ <italic>m</italic><sub><bold>b</bold></sub>(<italic>m</italic>) of <bold>b</bold>, and user-defined weight 0 ≤ <italic>γ</italic> ≤ 1, our final similarity measure is defined by
<disp-formula id="pone.0227177.e035"><alternatives><graphic xlink:href="pone.0227177.e035.jpg" id="pone.0227177.e035g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M35"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mtext>sim</mml:mtext><mml:mi>γ</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>γ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>·</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mtext>seq</mml:mtext></mml:msub><mml:mo>·</mml:mo><mml:mi>R</mml:mi><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:mi>O</mml:mi><mml:mi>S</mml:mi><mml:mi>U</mml:mi><mml:mi>M</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd><mml:mrow><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:mo>·</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mtext>str</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>R</mml:mi><mml:mi>S</mml:mi><mml:mi>I</mml:mi><mml:mi>M</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(17)</label></disp-formula>
where <italic>α</italic><sub>seq</sub>, <italic>α</italic><sub>str</sub> are computed by Eqs (<xref ref-type="disp-formula" rid="pone.0227177.e033">15</xref>) and (<xref ref-type="disp-formula" rid="pone.0227177.e034">16</xref>) depending on probabilities <italic>p</italic><sub><italic>A</italic></sub>, <italic>p</italic><sub><italic>C</italic></sub>, <italic>p</italic><sub><italic>G</italic></sub>, <italic>p</italic><sub><italic>U</italic></sub> [resp. <inline-formula id="pone.0227177.e036"><alternatives><graphic xlink:href="pone.0227177.e036.jpg" id="pone.0227177.e036g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M36"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>A</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>C</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>G</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>U</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>] and <italic>p</italic><sub><monospace>(</monospace></sub>, <italic>p</italic><sub>•</sub>, <italic>p</italic><sub><monospace>)</monospace></sub> [resp. <inline-formula id="pone.0227177.e037"><alternatives><graphic xlink:href="pone.0227177.e037.jpg" id="pone.0227177.e037g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M37"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext mathvariant="monospace">(</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mo>•</mml:mo><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext mathvariant="monospace">)</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>] of the query [resp. target]. All benchmarking computations were carried out using <italic>γ</italic> = 1/2, although it is possible to use position-specific weight <italic>γ</italic><sub><italic>i</italic>,<italic>j</italic></sub> defined as the average probability that <italic>i</italic> is paired in <bold>a</bold> and <italic>j</italic> is paired in <bold>b</bold>.</p>
      <p>Our structural similarity measure is closely related to that of <monospace>STRAL</monospace>, which we discovered only after completing a preliminary version of this paper. Let <inline-formula id="pone.0227177.e038"><alternatives><graphic xlink:href="pone.0227177.e038.jpg" id="pone.0227177.e038g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M38"><mml:mrow><mml:mi>p</mml:mi><mml:msubsup><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0227177.e039"><alternatives><graphic xlink:href="pone.0227177.e039.jpg" id="pone.0227177.e039g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M39"><mml:mrow><mml:mi>p</mml:mi><mml:msubsup><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> be the probability that position <italic>i</italic> of sequence <bold>a</bold> is paired to a position on the left or right, respectively. The similarity measure used in <monospace>STRAL</monospace> is defined by
<disp-formula id="pone.0227177.e040"><alternatives><graphic xlink:href="pone.0227177.e040.jpg" id="pone.0227177.e040g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M40"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mtext>sim</mml:mtext><mml:mi>γ</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>R</mml:mi><mml:mi>A</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>γ</mml:mi><mml:mo>·</mml:mo><mml:mo>(</mml:mo><mml:msqrt><mml:mrow><mml:mi>p</mml:mi><mml:msubsup><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:mo>·</mml:mo><mml:mi>p</mml:mi><mml:msubsup><mml:mi>l</mml:mi><mml:mi>j</mml:mi><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:msqrt><mml:mo>+</mml:mo><mml:msqrt><mml:mrow><mml:mi>p</mml:mi><mml:msubsup><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:mo>·</mml:mo><mml:mi>p</mml:mi><mml:msubsup><mml:mi>r</mml:mi><mml:mi>j</mml:mi><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:msqrt><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:msqrt><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:msubsup><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:msubsup><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>·</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:msubsup><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:msubsup><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msqrt><mml:mo>·</mml:mo><mml:mi>R</mml:mi><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:mi>O</mml:mi><mml:mi>S</mml:mi><mml:mi>U</mml:mi><mml:mi>M</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(18)</label></disp-formula></p>
      <p>From Eqs (<xref ref-type="disp-formula" rid="pone.0227177.e035">17</xref>) and (<xref ref-type="disp-formula" rid="pone.0227177.e006">4</xref>) our measure can be defined as
<disp-formula id="pone.0227177.e041"><alternatives><graphic xlink:href="pone.0227177.e041.jpg" id="pone.0227177.e041g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M41"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mtext>sim</mml:mtext><mml:mi>γ</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>γ</mml:mi><mml:mo>·</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mtext>str</mml:mtext></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:msubsup><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:msubsup><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:msubsup><mml:mi>r</mml:mi><mml:mi>j</mml:mi><mml:mi>b</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:msubsup><mml:mi>l</mml:mi><mml:mi>j</mml:mi><mml:mi>b</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>γ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>·</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mtext>seq</mml:mtext></mml:msub><mml:mo>·</mml:mo><mml:mi>R</mml:mi><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:mi>O</mml:mi><mml:mi>S</mml:mi><mml:mi>U</mml:mi><mml:mi>M</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(19)</label></disp-formula>
Though clearly very related, <monospace>RNAmountAlign</monospace> was developed independently, without knowledge of <monospace>STRAL</monospace>, and offers a number of functionalities unavailable in <monospace>STRAL</monospace>, which latter appears to be no longer maintained. For instance, <monospace>RNAmountAlign</monospace> supports local and semiglobal alignment, and reports <italic>p</italic>-values and E-values; these features are not available in <monospace>STRAL</monospace>. Since we were unable to compile <monospace>STRAL</monospace>, our benchmarking results for <monospace>STRAL</monospace> use an adaptation of our code to support <xref ref-type="disp-formula" rid="pone.0227177.e040">Eq (18)</xref>. There are nevertheless some differences in how progressive alignment is implemented in <monospace>STRAL</monospace> that could affect run time.</p>
      <p>To illustrate the method, suppose that the query [resp. target] sequence is the 72 nt tRNA AL671879.2 [resp. 69 nt tRNA D16498.1] with sequence GGGGAUGUAG CUCAGUGGUA GAGCGCAUGC UUCGCAUGUA UGAGGCCCCG GGUUCGAUCC CCGGCAUCUC CA. Then nucleotide query [resp. target] probabilities are (approximately) <italic>p</italic><sub><italic>A</italic></sub> ≈ 0.167, <italic>p</italic><sub><italic>C</italic></sub> ≈ 0.278, <italic>p</italic><sub><italic>G</italic></sub> ≈ 0.333, <italic>p</italic><sub><italic>U</italic></sub> ≈ 0.222. For the 69 nt tRNA target sequence D16498.1 with sequence GUUUCAUGAG UAUAGCAGUA CAUUCGGCUU CCAACCGAAA GGUUUUUGUA AACAACCAAA AAUGAAAUA the nucleotide relative frequencies are approximately <inline-formula id="pone.0227177.e042"><alternatives><graphic xlink:href="pone.0227177.e042.jpg" id="pone.0227177.e042g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M42"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>A</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>≈</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>377</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pone.0227177.e043"><alternatives><graphic xlink:href="pone.0227177.e043.jpg" id="pone.0227177.e043g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M43"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>C</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>≈</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>174</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pone.0227177.e044"><alternatives><graphic xlink:href="pone.0227177.e044.jpg" id="pone.0227177.e044g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M44"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>G</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>≈</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>174</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pone.0227177.e045"><alternatives><graphic xlink:href="pone.0227177.e045.jpg" id="pone.0227177.e045g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M45"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>U</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>≈</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>275</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. From the base pairing probabilities returned by <monospace>RNAfold -p</monospace> [<xref rid="pone.0227177.ref004" ref-type="bibr">4</xref>], we determine that <italic>p</italic><sub><monospace>(</monospace></sub> = 0.3035, <italic>p</italic><sub>•</sub> = 0.3930, <italic>p</italic><sub><monospace>)</monospace></sub> = 0.3035 [resp. <inline-formula id="pone.0227177.e046"><alternatives><graphic xlink:href="pone.0227177.e046.jpg" id="pone.0227177.e046g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M46"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext mathvariant="monospace">(</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>2835</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pone.0227177.e047"><alternatives><graphic xlink:href="pone.0227177.e047.jpg" id="pone.0227177.e047g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M47"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mo>•</mml:mo><mml:mo>′</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>433</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pone.0227177.e048"><alternatives><graphic xlink:href="pone.0227177.e048.jpg" id="pone.0227177.e048g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M48"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext mathvariant="monospace">)</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>2835</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>]. Using these probabilities in Eqs (<xref ref-type="disp-formula" rid="pone.0227177.e019">10</xref>)–(<xref ref-type="disp-formula" rid="pone.0227177.e032">14</xref>), we determine that <italic>μ</italic><sub>seq</sub> = −0.9098, <italic>σ</italic><sub>seq</sub> = 1.5871 and <italic>μ</italic><sub>str</sub> = −0.8298, <italic>σ</italic><sub>str</sub> = 0.6967. By Eqs (<xref ref-type="disp-formula" rid="pone.0227177.e033">15</xref>) and (<xref ref-type="disp-formula" rid="pone.0227177.e034">16</xref>), we determine that RIBOSUM scaling factor <italic>α</italic><sub>seq</sub> = 0.4390 and <italic>α</italic><sub>str</sub> = 0.4305 (all values shown rounded to 4-decimal places). Using these values, the scaled RIBOSUM mean is now −0.39936, now equal to the shifted STRSIM mean, and both the scaled RIBOSUM standard deviation and shifted STRSIM standard deviation equal 0.6967. Since the mean and standard deviation of <italic>α</italic><sub>seq</sub>-scaled RIBOSUM values are identical with that of <italic>α</italic><sub>str</sub>-shifted STRSIM values, hence can be combined in <xref ref-type="disp-formula" rid="pone.0227177.e035">Eq (17)</xref>. Although sequence identity of the reference alignment of these tRNAs from <monospace>BRAliBase 2.1 K2</monospace> is only 28%, the global alignment produced by <monospace>RNAmountAlign</monospace> is identical to that the reference alignment, using default parameters of gap initiation −3, gap extension −1, and structural weight <italic>γ</italic> = 1/2 in <xref ref-type="disp-formula" rid="pone.0227177.e035">Eq (17)</xref>.</p>
      <p><xref ref-type="fig" rid="pone.0227177.g002">Fig 2</xref> depicts the distribution of RIBOSUM85-60 [resp. STRSIM] values in this case, both before and after application of scaling factor <italic>α</italic><sub>seq</sub> [resp. shift <italic>α</italic><sub>str</sub>]—recall that <italic>α</italic><sub>seq</sub> and <italic>α</italic><sub>str</sub>] depend on <italic>p<sub>A</sub></italic>, <italic>p<sub>C</sub></italic>, <italic>p<sub>G</sub></italic>, <italic>p<sub>U</sub></italic>, <italic>p</italic><sub><monospace>(</monospace></sub>, <italic>p</italic><sub>•</sub>, <italic>p</italic><sub><monospace>)</monospace></sub> of tRNA AL671879.2 and <inline-formula id="pone.0227177.e049"><alternatives><graphic xlink:href="pone.0227177.e049.jpg" id="pone.0227177.e049g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M49"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>A</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>C</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>G</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>U</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext mathvariant="monospace">(</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mo>•</mml:mo><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext mathvariant="monospace">)</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> of tRNA D16498.1.</p>
    </sec>
    <sec id="sec006">
      <title>Statistics for pairwise alignment</title>
      <sec id="sec007">
        <title>Karlin-Altschul statistics for local pairwise alignment</title>
        <p>For a finite alphabet <italic>A</italic> and similarity measure <italic>s</italic>, suppose that the expected similarity <inline-formula id="pone.0227177.e050"><alternatives><graphic xlink:href="pone.0227177.e050.jpg" id="pone.0227177.e050g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M50"><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>∈</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:munder></mml:mstyle><mml:msub><mml:mi>p</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is negative and that <italic>s</italic>(<italic>x</italic>, <italic>y</italic>) is positive for at least one choice of <italic>x</italic>, <italic>y</italic>. In the case of <monospace>BLAST</monospace>, amino acid and nucleotide similarity scores are integers, for which the Karlin-Altschul algorithm was developed [<xref rid="pone.0227177.ref012" ref-type="bibr">12</xref>]. In contrast, <monospace>RNAmountAlign</monospace> similarity scores are not integers (or more generally values in a lattice), because <xref ref-type="disp-formula" rid="pone.0227177.e035">Eq (17)</xref> combines real-valued <italic>α</italic><sub>seq</sub>-scaled RIBOSUM nucleotide similarities with real-valued <italic>α</italic><sub>str</sub>-shifted STRSIM structural similarities, which depend on query [resp. target] probabilities <italic>p<sub>A</sub></italic>, <italic>p<sub>C</sub></italic>, <italic>p<sub>G</sub></italic>, <italic>p<sub>U</sub></italic>, <italic>p</italic><sub><monospace>(</monospace></sub>, <italic>p</italic><sub>•</sub>, <italic>p</italic><sub><monospace>)</monospace></sub> [resp. <inline-formula id="pone.0227177.e051"><alternatives><graphic xlink:href="pone.0227177.e051.jpg" id="pone.0227177.e051g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M51"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>A</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>C</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>G</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mi>U</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext mathvariant="monospace">(</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mo>•</mml:mo><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext mathvariant="monospace">)</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>]. For that reason, we use Theorem 1 of Karlin, Dembo and Kawabata [<xref rid="pone.0227177.ref013" ref-type="bibr">13</xref>], reformulated using the notation of this paper, where the similarity score <italic>s</italic>(<italic>x</italic>, <italic>y</italic>) for RNA nucleotides <italic>x</italic>, <italic>y</italic> is defined by <xref ref-type="disp-formula" rid="pone.0227177.e035">Eq (17)</xref>.</p>
        <p><bold>Theorem 1 (Karlin, Dembo, Kawabata</bold> [<xref rid="pone.0227177.ref013" ref-type="bibr">13</xref>]<bold>)</bold></p>
        <p><italic>Given similarity measure s between nucleotides in alphabet A</italic> = {<italic>A</italic>, <italic>C</italic>, <italic>G</italic>, <italic>U</italic>}, <italic>let</italic> λ* <italic>be the unique positive root of</italic>
<inline-formula id="pone.0227177.e052"><alternatives><graphic xlink:href="pone.0227177.e052.jpg" id="pone.0227177.e052g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M52"><mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>∈</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:munder></mml:mstyle><mml:msub><mml:mi>p</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:msubsup><mml:mi>p</mml:mi><mml:mi>y</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>·</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>λ</mml:mo><mml:mi>s</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, <italic>and let random variable S</italic><sub><italic>k</italic></sub>
<italic>denote the score of a length k gapless alignment</italic>. <italic>For large local alignment score z</italic>,
<disp-formula id="pone.0227177.e053"><alternatives><graphic xlink:href="pone.0227177.e053.jpg" id="pone.0227177.e053g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M53"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>M</mml:mi><mml:mo>&gt;</mml:mo><mml:mfrac><mml:mrow><mml:mtext>ln</mml:mtext><mml:mspace width="4pt"/><mml:mi>n</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:msup><mml:mo>λ</mml:mo><mml:mo>*</mml:mo></mml:msup></mml:mfrac><mml:mo>+</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>≤</mml:mo><mml:mtext>exp</mml:mtext><mml:mo>(</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mi>K</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mo>λ</mml:mo><mml:mo>*</mml:mo></mml:msup><mml:mi>z</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(20)</label></disp-formula>
<italic>where M denotes maximal segment scores for local alignment of random RNA sequences a</italic><sub>1</sub>, …, <italic>a</italic><sub><italic>n</italic></sub>
<italic>and b</italic><sub>1</sub>, …, <italic>b</italic><sub><italic>m</italic></sub>, <italic>and where</italic>
<disp-formula id="pone.0227177.e054"><alternatives><graphic xlink:href="pone.0227177.e054.jpg" id="pone.0227177.e054g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M54"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:msup><mml:mi>K</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>exp</mml:mtext><mml:mo>(</mml:mo><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>∞</mml:mi></mml:msubsup><mml:mfrac><mml:mn>1</mml:mn><mml:mi>k</mml:mi></mml:mfrac><mml:mrow><mml:mo>·</mml:mo><mml:mo>(</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msup><mml:mo>λ</mml:mo><mml:mo>*</mml:mo></mml:msup><mml:msub><mml:mi>S</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msup><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mo>λ</mml:mo><mml:mo>*</mml:mo></mml:msup><mml:mi>E</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msup><mml:mo>λ</mml:mo><mml:mo>*</mml:mo></mml:msup><mml:mo>·</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(21)</label></disp-formula></p>
      </sec>
      <sec id="sec008">
        <title>Fitting data to probability distributions</title>
        <p>Data were fit to the normal distribution (ND) by the method of moments (i.e. mean and standard deviation were taken from data analysis). Data were fit to the extreme value distribution (EVD)
<disp-formula id="pone.0227177.e055"><alternatives><graphic xlink:href="pone.0227177.e055.jpg" id="pone.0227177.e055g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M55"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mtext>exp</mml:mtext><mml:mo>(</mml:mo><mml:mo>−</mml:mo><mml:mi>K</mml:mi><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>λ</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(22)</label></disp-formula>
by an in-house implementation of maximum likelihood to determine λ, <italic>K</italic>, as described in supplementary information to [<xref rid="pone.0227177.ref030" ref-type="bibr">30</xref>]. Data were fit to the gamma distribution by using the function <monospace>fitdistr(x, ‘gamma’)</monospace> from the package <monospace>MASS</monospace> in the <monospace>R</monospace> programming language, which determines rate and shape parameters for the density function
<disp-formula id="pone.0227177.e056"><alternatives><graphic xlink:href="pone.0227177.e056.jpg" id="pone.0227177.e056g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M56"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:mrow><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mo>λ</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mo>λ</mml:mo><mml:mi>α</mml:mi></mml:msup><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo>λ</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mo>Γ</mml:mo><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(23)</label></disp-formula>
with where <italic>α</italic> is the shape parameter, the rate is 1/λ, where λ is known as the scale parameter.</p>
      </sec>
    </sec>
    <sec id="sec009">
      <title>Multiple alignment</title>
      <p>Suppose <italic>p</italic><sub><italic>A</italic></sub>, <italic>p</italic><sub><italic>C</italic></sub>, <italic>p</italic><sub><italic>G</italic></sub>, <italic>p</italic><sub><italic>U</italic></sub> are the nucleotide probabilities obtained after the concatenation of all sequences. Let <italic>p</italic><sub><monospace>(</monospace></sub>, <italic>p</italic><sub>•</sub>, <italic>p</italic><sub><monospace>)</monospace></sub> be computed by individually folding each sequence and taking the arithmetic average of probabilities of <monospace>(</monospace>, • and <monospace>)</monospace> over all sequences. The mean and standard deviation of sequence and structure similarity are computed similar to Eqs (<xref ref-type="disp-formula" rid="pone.0227177.e019">10</xref>)–(<xref ref-type="disp-formula" rid="pone.0227177.e032">14</xref>).
<disp-formula id="pone.0227177.e057"><alternatives><graphic xlink:href="pone.0227177.e057.jpg" id="pone.0227177.e057g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M57"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:msub><mml:mi>μ</mml:mi><mml:mtext>seq</mml:mtext></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>U</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:msub><mml:mi>p</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:mi>R</mml:mi><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:mi>O</mml:mi><mml:mi>S</mml:mi><mml:mi>U</mml:mi><mml:mi>M</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(24)</label></disp-formula>
<disp-formula id="pone.0227177.e058"><alternatives><graphic xlink:href="pone.0227177.e058.jpg" id="pone.0227177.e058g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M58"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:msub><mml:mi>σ</mml:mi><mml:mtext>seq</mml:mtext></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>U</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:msub><mml:mi>p</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:mi>R</mml:mi><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:mi>O</mml:mi><mml:mi>S</mml:mi><mml:mi>U</mml:mi><mml:mi>M</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mtext>seq</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(25)</label></disp-formula>
<disp-formula id="pone.0227177.e059"><alternatives><graphic xlink:href="pone.0227177.e059.jpg" id="pone.0227177.e059g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M59"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:msub><mml:mi>μ</mml:mi><mml:mtext>str</mml:mtext></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mspace width="0.166667em"/><mml:mtext mathvariant="monospace">(</mml:mtext><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo><mml:mo>•</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mtext mathvariant="monospace">)</mml:mtext><mml:mspace width="0.166667em"/><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:msub><mml:mi>p</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(26)</label></disp-formula>
<disp-formula id="pone.0227177.e060"><alternatives><graphic xlink:href="pone.0227177.e060.jpg" id="pone.0227177.e060g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M60"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:msub><mml:mi>σ</mml:mi><mml:mtext>str</mml:mtext></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mspace width="0.166667em"/><mml:mtext mathvariant="monospace">(</mml:mtext><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo><mml:mo>•</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mtext mathvariant="monospace">)</mml:mtext><mml:mspace width="0.166667em"/><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:msub><mml:mi>p</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mtext>str</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(27)</label></disp-formula>
Sequence multiplicative scaling factor <italic>α</italic><sub>seq</sub> and the structure additive shift factor <italic>α</italic><sub>str</sub> are computed from these values using Eqs (<xref ref-type="disp-formula" rid="pone.0227177.e033">15</xref>) and (<xref ref-type="disp-formula" rid="pone.0227177.e034">16</xref>).</p>
      <p>As in <monospace>CLUSTAL</monospace> [<xref rid="pone.0227177.ref042" ref-type="bibr">42</xref>] and the <monospace>CLUSTAL Omega</monospace> [<xref rid="pone.0227177.ref043" ref-type="bibr">43</xref>], our software <monospace>RNAmountAlign</monospace> implements progressive multiple alignment using the <italic>Unweighted Pair Group Method with Arithmetic Mean</italic> (<monospace>UPGMA</monospace>) [<xref rid="pone.0227177.ref044" ref-type="bibr">44</xref>] and p. 360 of [<xref rid="pone.0227177.ref041" ref-type="bibr">41</xref>]. In <monospace>UPGMA</monospace>, one first defines a similarity matrix <italic>S</italic>, where <italic>S</italic>[<italic>i</italic>, <italic>j</italic>] is equal to (maximum) pairwise sequence similarity of sequences <italic>i</italic> and <italic>j</italic>. A rooted tree is then constructed by progressively creating a parent node of the two closest siblings. Parent nodes are profiles (PSSMs) that represent alignments of two or more sequences, hence can be treated as pseudo-sequences in a straightforward adaptation of pairwise alignment to the alignment of profiles. Let’s consider an alignment of <italic>N</italic> sequences <inline-formula id="pone.0227177.e061"><alternatives><graphic xlink:href="pone.0227177.e061.jpg" id="pone.0227177.e061g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M61"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>⋯</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>M</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>⋯</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> composed of <italic>M</italic> columns. Let <inline-formula id="pone.0227177.e062"><alternatives><graphic xlink:href="pone.0227177.e062.jpg" id="pone.0227177.e062g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M62"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> denote column <italic>i</italic> of the alignment (for 1 ≤ <italic>i</italic> ≤ <italic>M</italic>). Suppose <italic>p</italic>(<italic>i</italic>, <italic>x</italic>), for <italic>x</italic> ∈ {<italic>A</italic>, <italic>C</italic>, <italic>G</italic>, <italic>U</italic>, −}, indicates the probability of occurrence of a nucleotide or gap at column <italic>i</italic> of alignment <italic>A</italic>. Then sequence similarity SEQSIM between two columns is defined by
<disp-formula id="pone.0227177.e063"><alternatives><graphic xlink:href="pone.0227177.e063.jpg" id="pone.0227177.e063g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M63"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:mrow><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mi>Q</mml:mi><mml:mi>S</mml:mi><mml:mi>I</mml:mi><mml:mi>M</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>U</mml:mi><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>U</mml:mi><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>·</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>·</mml:mo><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(28)</label></disp-formula>
where
<disp-formula id="pone.0227177.e064"><alternatives><graphic xlink:href="pone.0227177.e064.jpg" id="pone.0227177.e064g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M64"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:mrow><mml:mi>R</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="4.pt"/><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo></mml:mrow><mml:mspace width="4.pt"/><mml:mtext>or</mml:mtext><mml:mspace width="4.pt"/><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>R</mml:mi><mml:mi>I</mml:mi><mml:mi>B</mml:mi><mml:mi>O</mml:mi><mml:mi>S</mml:mi><mml:mi>U</mml:mi><mml:mi>M</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mtext>otherwise</mml:mtext></mml:mtd></mml:mtr></mml:mtable><mml:mo/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(29)</label></disp-formula></p>
      <p>The structural measure for a profile is computed from the incremental ensemble heights averaged over each column. Let <italic>m</italic><sub><italic>A</italic></sub>(<italic>i</italic>) denote the arithmetic average of incremental ensemble mountain height at column <italic>A</italic><sub><italic>i</italic></sub>
<disp-formula id="pone.0227177.e065"><alternatives><graphic xlink:href="pone.0227177.e065.jpg" id="pone.0227177.e065g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M65"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>m</mml:mi><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mi>j</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>N</mml:mi></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(30)</label></disp-formula>
where <inline-formula id="pone.0227177.e066"><alternatives><graphic xlink:href="pone.0227177.e066.jpg" id="pone.0227177.e066g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M66"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mi>j</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the incremental ensemble mountain height at position <italic>i</italic> of sequence <inline-formula id="pone.0227177.e067"><alternatives><graphic xlink:href="pone.0227177.e067.jpg" id="pone.0227177.e067g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M67"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mi>j</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> obtained from <xref ref-type="disp-formula" rid="pone.0227177.e006">Eq (4)</xref>. Here, let <inline-formula id="pone.0227177.e068"><alternatives><graphic xlink:href="pone.0227177.e068.jpg" id="pone.0227177.e068g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M68"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mi>j</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> if <inline-formula id="pone.0227177.e069"><alternatives><graphic xlink:href="pone.0227177.e069.jpg" id="pone.0227177.e069g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M69"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> is a gap. Structural similarity between two columns is defined by
<disp-formula id="pone.0227177.e070"><alternatives><graphic xlink:href="pone.0227177.e070.jpg" id="pone.0227177.e070g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M70"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:mrow><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>R</mml:mi><mml:mi>S</mml:mi><mml:mi>I</mml:mi><mml:mi>M</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(31)</label></disp-formula>
Finally, the combined sequence/structure similarity is computed from
<disp-formula id="pone.0227177.e071"><alternatives><graphic xlink:href="pone.0227177.e071.jpg" id="pone.0227177.e071g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M71"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mtext>sim</mml:mtext><mml:mi>γ</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>γ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>·</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mtext>seq</mml:mtext></mml:msub><mml:mo>·</mml:mo><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mi>Q</mml:mi><mml:mi>S</mml:mi><mml:mi>I</mml:mi><mml:mi>M</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd><mml:mrow><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:mo>·</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mtext>str</mml:mtext></mml:msub><mml:mo>+</mml:mo><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>R</mml:mi><mml:mi>S</mml:mi><mml:mi>I</mml:mi><mml:mi>M</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(32)</label></disp-formula></p>
    </sec>
  </sec>
  <sec id="sec010">
    <title>Benchmarking</title>
    <sec id="sec011">
      <title>Accuracy measures</title>
      <p>Sensitivity, positive predictive value, and F1 score for pairwise alignments were computed as follows. Let <inline-formula id="pone.0227177.e072"><alternatives><graphic xlink:href="pone.0227177.e072.jpg" id="pone.0227177.e072g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M72"><mml:mrow><mml:mi mathvariant="script">A</mml:mi><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>a</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>⋯</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mi>N</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>b</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>⋯</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mi>N</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> denote an alignment, where <italic>a</italic><sub><italic>i</italic></sub>, <italic>b</italic><sub><italic>i</italic></sub> ∈ {<italic>A</italic>, <italic>C</italic>, <italic>G</italic>, <italic>U</italic>, −}, and the aligned sequences include may contain occurrences of the gap symbol ‘−’, provided that not both <inline-formula id="pone.0227177.e073"><alternatives><graphic xlink:href="pone.0227177.e073.jpg" id="pone.0227177.e073g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M73"><mml:msubsup><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0227177.e074"><alternatives><graphic xlink:href="pone.0227177.e074.jpg" id="pone.0227177.e074g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M74"><mml:msubsup><mml:mi>b</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> are gap symbols. The number TP of true positives [resp. FP of false positives] is the number of alignment pairs <inline-formula id="pone.0227177.e075"><alternatives><graphic xlink:href="pone.0227177.e075.jpg" id="pone.0227177.e075g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M75"><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> in the predicted alignment that belong to [resp. do not belong to] the reference alignment. The sensitivity (<italic>Sen</italic>) [resp. positive predictive value (<italic>PPV</italic>)] of a predicted alignment is TP divided by reference alignment length [resp. TP divided by predicted alignment length]. The <italic>F</italic>1 score is the harmonic mean of sensitivity and PPV, so <inline-formula id="pone.0227177.e076"><alternatives><graphic xlink:href="pone.0227177.e076.jpg" id="pone.0227177.e076g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M76"><mml:mrow><mml:mi>F</mml:mi><mml:mn>1</mml:mn><mml:mo>=</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>S</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>P</mml:mi><mml:mi>P</mml:mi><mml:mi>V</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>. For the computation of <italic>Sen</italic>, <italic>PPV</italic>, and <italic>F</italic>1, we consider not only nucleotide pairs (<italic>a</italic><sub><italic>i</italic></sub>, <italic>b</italic><sub><italic>j</italic></sub>), but also include pairs of the form (<italic>a<sub>i</sub></italic>, —) [resp. (—, <italic>b<sub>j</sub></italic>)], which represent an insertion in the top sequence of alignment <inline-formula id="pone.0227177.e077"><alternatives><graphic xlink:href="pone.0227177.e077.jpg" id="pone.0227177.e077g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M77"><mml:mi mathvariant="script">A</mml:mi></mml:math></alternatives></inline-formula> (equivalently a deletion from the bottom sequence of <inline-formula id="pone.0227177.e078"><alternatives><graphic xlink:href="pone.0227177.e078.jpg" id="pone.0227177.e078g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M78"><mml:mi mathvariant="script">A</mml:mi></mml:math></alternatives></inline-formula>) [resp. deletion from the top sequence of <inline-formula id="pone.0227177.e079"><alternatives><graphic xlink:href="pone.0227177.e079.jpg" id="pone.0227177.e079g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M79"><mml:mi mathvariant="script">A</mml:mi></mml:math></alternatives></inline-formula> (equivalently an insertion in the bottom sequence of <inline-formula id="pone.0227177.e080"><alternatives><graphic xlink:href="pone.0227177.e080.jpg" id="pone.0227177.e080g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M80"><mml:mi mathvariant="script">A</mml:mi></mml:math></alternatives></inline-formula>)]. Suppose that the (toy) alignment <inline-formula id="pone.0227177.e081"><alternatives><graphic xlink:href="pone.0227177.e081.jpg" id="pone.0227177.e081g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M81"><mml:mi mathvariant="script">A</mml:mi></mml:math></alternatives></inline-formula>
<disp-formula id="pone.0227177.e082"><alternatives><graphic xlink:href="pone.0227177.e082.jpg" id="pone.0227177.e082g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M82"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable><mml:mtr><mml:mtd/><mml:mtd><mml:msubsup><mml:mi>a</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mtd><mml:mtd><mml:msubsup><mml:mi>a</mml:mi><mml:mn>2</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mtd><mml:mtd><mml:msubsup><mml:mi>a</mml:mi><mml:mn>3</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mtd><mml:mtd><mml:msubsup><mml:mi>a</mml:mi><mml:mn>4</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mtd><mml:mtd><mml:msubsup><mml:mi>a</mml:mi><mml:mn>5</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mtd><mml:mtd><mml:msubsup><mml:mi>a</mml:mi><mml:mn>6</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:mo>−</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mi>a</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="bold">a</mml:mi><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mi>A</mml:mi></mml:mtd><mml:mtd><mml:mi>C</mml:mi></mml:mtd><mml:mtd><mml:mi>G</mml:mi></mml:mtd><mml:mtd><mml:mo>−</mml:mo></mml:mtd><mml:mtd><mml:mi>U</mml:mi></mml:mtd><mml:mtd><mml:mi>A</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="bold">b</mml:mi><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mi>A</mml:mi></mml:mtd><mml:mtd><mml:mo>−</mml:mo></mml:mtd><mml:mtd><mml:mo>−</mml:mo></mml:mtd><mml:mtd><mml:mi>C</mml:mi></mml:mtd><mml:mtd><mml:mi>U</mml:mi></mml:mtd><mml:mtd><mml:mi>A</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:mo>−</mml:mo></mml:mtd><mml:mtd><mml:mo>−</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mi>b</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mi>b</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:msubsup><mml:mi>b</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mtd><mml:mtd><mml:msubsup><mml:mi>b</mml:mi><mml:mn>2</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mtd><mml:mtd><mml:msubsup><mml:mi>b</mml:mi><mml:mn>3</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mtd><mml:mtd><mml:msubsup><mml:mi>b</mml:mi><mml:mn>4</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mtd><mml:mtd><mml:msubsup><mml:mi>b</mml:mi><mml:mn>5</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mtd><mml:mtd><mml:msubsup><mml:mi>b</mml:mi><mml:mn>6</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
is produced by an algorithm (such as <monospace>RNAmountAlign</monospace>, <monospace>FOLDALIGN</monospace>, <monospace>MXSCARNA</monospace>, etc.). Then <bold>a</bold> = <italic>a</italic><sub>1</sub><italic>a</italic><sub>2</sub><italic>a</italic><sub>3</sub><italic>a</italic><sub>4</sub><italic>a</italic><sub>5</sub>, <bold>a</bold> = <italic>ACGUA</italic>, <bold>b</bold> = <italic>b</italic><sub>1</sub><italic>b</italic><sub>2</sub><italic>b</italic><sub>3</sub><italic>b</italic><sub>4</sub>, <bold>b</bold> = <italic>ACUA</italic>. The length of alignment <inline-formula id="pone.0227177.e083"><alternatives><graphic xlink:href="pone.0227177.e083.jpg" id="pone.0227177.e083g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M83"><mml:mi mathvariant="script">A</mml:mi></mml:math></alternatives></inline-formula> is <italic>N</italic> = 6, while <inline-formula id="pone.0227177.e084"><alternatives><graphic xlink:href="pone.0227177.e084.jpg" id="pone.0227177.e084g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M84"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>a</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>⋯</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mn>6</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mtext mathvariant="monospace">ACG</mml:mtext><mml:mo>−</mml:mo><mml:mtext mathvariant="monospace">UA</mml:mtext></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0227177.e085"><alternatives><graphic xlink:href="pone.0227177.e085.jpg" id="pone.0227177.e085g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M85"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>b</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>⋯</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mn>6</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="monospace">A</mml:mi><mml:mo>−</mml:mo><mml:mo>−</mml:mo><mml:mtext mathvariant="monospace">CUA</mml:mtext></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. If <inline-formula id="pone.0227177.e086"><alternatives><graphic xlink:href="pone.0227177.e086.jpg" id="pone.0227177.e086g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M86"><mml:mi mathvariant="script">B</mml:mi></mml:math></alternatives></inline-formula> is the (toy) alignment of the same sequences
<disp-formula id="pone.0227177.e087"><alternatives><graphic xlink:href="pone.0227177.e087.jpg" id="pone.0227177.e087g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M87"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable><mml:mtr><mml:mtd/><mml:mtd><mml:msubsup><mml:mi>c</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mtd><mml:mtd><mml:msubsup><mml:mi>c</mml:mi><mml:mn>2</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mtd><mml:mtd><mml:msubsup><mml:mi>c</mml:mi><mml:mn>3</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mtd><mml:mtd><mml:msubsup><mml:mi>c</mml:mi><mml:mn>4</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mtd><mml:mtd><mml:msubsup><mml:mi>c</mml:mi><mml:mn>5</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mi>a</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="bold">a</mml:mi><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mi>A</mml:mi></mml:mtd><mml:mtd><mml:mi>C</mml:mi></mml:mtd><mml:mtd><mml:mi>G</mml:mi></mml:mtd><mml:mtd><mml:mi>U</mml:mi></mml:mtd><mml:mtd><mml:mi>A</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="bold">b</mml:mi><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mi>A</mml:mi></mml:mtd><mml:mtd><mml:mi>C</mml:mi></mml:mtd><mml:mtd><mml:mo>−</mml:mo></mml:mtd><mml:mtd><mml:mi>U</mml:mi></mml:mtd><mml:mtd><mml:mi>A</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:mo>−</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mi>b</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mi>b</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:msubsup><mml:mi>d</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mtd><mml:mtd><mml:msubsup><mml:mi>d</mml:mi><mml:mn>2</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mtd><mml:mtd><mml:msubsup><mml:mi>d</mml:mi><mml:mn>3</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mtd><mml:mtd><mml:msubsup><mml:mi>d</mml:mi><mml:mn>4</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mtd><mml:mtd><mml:msubsup><mml:mi>d</mml:mi><mml:mn>5</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
taken from a reference database (such as <monospace>BRAliBase 2.1</monospace>), then sequences <bold>a</bold>, <bold>b</bold> are as above, the length of alignment <inline-formula id="pone.0227177.e088"><alternatives><graphic xlink:href="pone.0227177.e088.jpg" id="pone.0227177.e088g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M88"><mml:mi mathvariant="script">B</mml:mi></mml:math></alternatives></inline-formula> is <italic>M</italic> = 5, while <inline-formula id="pone.0227177.e089"><alternatives><graphic xlink:href="pone.0227177.e089.jpg" id="pone.0227177.e089g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M89"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>⋯</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mn>5</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:mo>=</mml:mo><mml:mtext mathvariant="monospace">ACGUA</mml:mtext></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0227177.e090"><alternatives><graphic xlink:href="pone.0227177.e090.jpg" id="pone.0227177.e090g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M90"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>d</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>⋯</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mn>5</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mtext mathvariant="monospace">AC</mml:mtext><mml:mo>−</mml:mo><mml:mtext mathvariant="monospace">UA</mml:mtext></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. The number TP of correctly aligned pairs is 4, since
<disp-formula id="pone.0227177.e091"><alternatives><graphic xlink:href="pone.0227177.e091.jpg" id="pone.0227177.e091g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M91"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mn>5</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mn>5</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>U</mml:mi><mml:mo>,</mml:mo><mml:mi>U</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mn>4</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mn>4</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mn>6</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mn>6</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mn>5</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mn>5</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mn>3</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mn>3</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mn>3</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mn>3</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Because TP = 4, rather than 3 (if we had instead counted only aligned nucleotide pairs), the computations of <italic>F</italic>1 score, <italic>Sen</italic>, and <italic>PPV</italic> are duly affected.</p>
      <p>To compare predicted structures with consensus Rfam structures, we computed the Matthews correlation coefficient (MCC) [<xref rid="pone.0227177.ref045" ref-type="bibr">45</xref>] as follows:
<disp-formula id="pone.0227177.e092"><alternatives><graphic xlink:href="pone.0227177.e092.jpg" id="pone.0227177.e092g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M92"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>M</mml:mi><mml:mi>C</mml:mi><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:mi>T</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>F</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:mi>F</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msqrt><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(33)</label></disp-formula>
where <italic>TP</italic><sub><italic>str</italic></sub> is the number of correctly predicted base pairs, <italic>FP</italic><sub><italic>str</italic></sub> is the number of incorrectly predicted base pairs, <italic>TN</italic><sub><italic>str</italic></sub> is the number of potential base pairs absent in both predicted and reference structures and <italic>FN</italic><sub><italic>str</italic></sub> is the number of base pairs in the reference structure that were not predicted.</p>
      <p>In the case of local alignment, since the size of the reference alignment is unknown, only the predicted alignment length and PPV are reported. To compute the accuracy of multiple alignment, we used <italic>sum-of-pair-scores</italic> (SPS) [<xref rid="pone.0227177.ref011" ref-type="bibr">11</xref>], defined as the number of correctly nucleotide pairs in the alignment produced by a given algorithm, divided by the total number of aligned nucleotide pairs in the reference alignment. For completeness, and to contrast this with our definition of sensitivity, PPV and F1 score, we formally define SPS as follows. Suppose that <italic>A</italic> denotes a multiple alignment of the form <inline-formula id="pone.0227177.e093"><alternatives><graphic xlink:href="pone.0227177.e093.jpg" id="pone.0227177.e093g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M93"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>⋯</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>⋯</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. For 1 ≤ <italic>i</italic>, <italic>j</italic> ≤ <italic>M</italic>, 1 ≤ <italic>k</italic> ≤ <italic>N</italic> define <italic>p</italic><sub><italic>i</italic>,<italic>j</italic>,<italic>k</italic></sub> = 1 if the nucleotide <inline-formula id="pone.0227177.e094"><alternatives><graphic xlink:href="pone.0227177.e094.jpg" id="pone.0227177.e094g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M94"><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> is aligned with the nucleotide <inline-formula id="pone.0227177.e095"><alternatives><graphic xlink:href="pone.0227177.e095.jpg" id="pone.0227177.e095g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M95"><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> in both the reference and predicted alignments, and <italic>p</italic><sub><italic>i</italic>,<italic>j</italic>,<italic>k</italic></sub> = 0 otherwise. Sum-of-pairs score SPS is then the sum, taken over all <italic>i</italic>, <italic>j</italic>, <italic>k</italic>, of the <italic>p</italic><sub><italic>i</italic>,<italic>j</italic>,<italic>k</italic></sub>. Though SPS can be considered as the average sensitivity, taken over all sequence pairs in the alignment, this is not technically correct in our case, since our definition of sensitivity also counts pairs of the form (<italic>X</italic>, —) and (—, <italic>X</italic>), where <italic>X</italic> ∈ {<italic>A</italic>, <italic>C</italic>, <italic>G</italic>, <italic>U</italic>}, from the reference alignment.</p>
      <p>To measure the conservation of secondary structures in alignments, structural conservation index (SCI) was computed using <monospace>RNAalifold</monospace> [<xref rid="pone.0227177.ref046" ref-type="bibr">46</xref>]. <monospace>RNAalifold</monospace> computes SCI as the ratio of the free energy of the alignment, computed by <monospace>RNAalifold</monospace>, with the average minimum free energy of individual structures in the alignment. SCI values close to 1 [resp. 0] indicate high [resp. low] structural conservation. All computations made with Vienna RNA Package used version 2.1.7 [<xref rid="pone.0227177.ref004" ref-type="bibr">4</xref>] using default Turner 2004 energy parameters [<xref rid="pone.0227177.ref035" ref-type="bibr">35</xref>]).</p>
    </sec>
    <sec id="sec012">
      <title>Dataset for global and local alignment comparison</title>
      <p>For <italic>pairwise global</italic> alignment benchmarking in <xref rid="pone.0227177.t004" ref-type="table">Table 4</xref>, Figs <xref ref-type="fig" rid="pone.0227177.g003">3</xref> and <xref ref-type="fig" rid="pone.0227177.g004">4</xref>, and <xref ref-type="supplementary-material" rid="pone.0227177.s010">S2</xref>–<xref ref-type="supplementary-material" rid="pone.0227177.s012">S4</xref> Figs all 8, 976 pairwise alignments in k2 from <monospace>BRAliBase 2.1</monospace> database [<xref rid="pone.0227177.ref038" ref-type="bibr">38</xref>] were used. Note that <monospace>BRAliBase 2.1</monospace> does not include consensus secondary structures for the reference alignments, which are required in the computation of MCC. However, since <monospace>BRAliBase 2.1</monospace> alignments are obtained from Rfam 7.0, we searched for the exact occurrences <monospace>BRAliBase 2.1</monospace> sequences in Rfam 7.0 and computed their Rfam consensus structure. Some <monospace>BRAliBase</monospace> alignments are manually curated and thus different from Rfam alignments for which consensus structure could not be obtained. This produced 7, 154 pairwise <monospace>BRAliBase</monospace> alignments with their consensus structures. For the computation of MCC in <xref ref-type="supplementary-material" rid="pone.0227177.s013">S5 Fig</xref>, this subset of reference alignments were used.</p>
      <table-wrap id="pone.0227177.t004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0227177.t004</object-id>
        <label>Table 4</label>
        <caption>
          <title>F1 scores for pairwise global alignment.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0227177.t004g" xlink:href="pone.0227177.t004"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Type</th>
                <th align="right" rowspan="1" colspan="1">NumAln</th>
                <th align="right" rowspan="1" colspan="1">SeqId</th>
                <th align="right" rowspan="1" colspan="1">MA(F)</th>
                <th align="right" rowspan="1" colspan="1">LocARNA(F)</th>
                <th align="right" rowspan="1" colspan="1">LARA(F)</th>
                <th align="right" rowspan="1" colspan="1">FA(F)</th>
                <th align="right" rowspan="1" colspan="1">DA(F)</th>
                <th align="right" rowspan="1" colspan="1">STRAL(F)</th>
                <th align="right" rowspan="1" colspan="1">MXSCARNA(F)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">5.8S rRNA</td>
                <td align="right" rowspan="1" colspan="1">76</td>
                <td align="right" rowspan="1" colspan="1">0.72 ± 0.13</td>
                <td align="right" rowspan="1" colspan="1">0.90 ± 0.09</td>
                <td align="right" rowspan="1" colspan="1">0.82 ± 0.07</td>
                <td align="right" rowspan="1" colspan="1">0.87 ± 0.15</td>
                <td align="right" rowspan="1" colspan="1">0.89 ± 0.11</td>
                <td align="right" rowspan="1" colspan="1">0.66 ± 0.22</td>
                <td align="right" rowspan="1" colspan="1">0.88 ± 0.12</td>
                <td align="right" rowspan="1" colspan="1">0.91 ± 0.09</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">5S rRNA</td>
                <td align="right" rowspan="1" colspan="1">1162</td>
                <td align="right" rowspan="1" colspan="1">0.60 ± 0.14</td>
                <td align="right" rowspan="1" colspan="1">0.84 ± 0.16</td>
                <td align="right" rowspan="1" colspan="1">0.87 ± 0.13</td>
                <td align="right" rowspan="1" colspan="1">0.85 ± 0.16</td>
                <td align="right" rowspan="1" colspan="1">0.86 ± 0.14</td>
                <td align="right" rowspan="1" colspan="1">0.69 ± 0.17</td>
                <td align="right" rowspan="1" colspan="1">0.82 ± 0.20</td>
                <td align="right" rowspan="1" colspan="1">0.85 ± 0.14</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Cobalamin</td>
                <td align="right" rowspan="1" colspan="1">188</td>
                <td align="right" rowspan="1" colspan="1">0.43 ± 0.10</td>
                <td align="right" rowspan="1" colspan="1">0.56 ± 0.16</td>
                <td align="right" rowspan="1" colspan="1">0.38 ± 0.17</td>
                <td align="right" rowspan="1" colspan="1">0.49 ± 0.20</td>
                <td align="right" rowspan="1" colspan="1">0.43 ± 0.24</td>
                <td align="right" rowspan="1" colspan="1">0.36 ± 0.19</td>
                <td align="right" rowspan="1" colspan="1">0.54 ± 0.17</td>
                <td align="right" rowspan="1" colspan="1">0.57 ± 0.14</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Entero 5 CRE</td>
                <td align="right" rowspan="1" colspan="1">48</td>
                <td align="right" rowspan="1" colspan="1">0.88 ± 0.06</td>
                <td align="right" rowspan="1" colspan="1">0.98 ± 0.04</td>
                <td align="right" rowspan="1" colspan="1">0.99 ± 0.04</td>
                <td align="right" rowspan="1" colspan="1">0.99 ± 0.05</td>
                <td align="right" rowspan="1" colspan="1">0.99 ± 0.02</td>
                <td align="right" rowspan="1" colspan="1">0.87 ± 0.13</td>
                <td align="right" rowspan="1" colspan="1">0.97 ± 0.06</td>
                <td align="right" rowspan="1" colspan="1">0.98 ± 0.04</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Entero CRE</td>
                <td align="right" rowspan="1" colspan="1">65</td>
                <td align="right" rowspan="1" colspan="1">0.80 ± 0.07</td>
                <td align="right" rowspan="1" colspan="1">1.00 ± 0.00</td>
                <td align="right" rowspan="1" colspan="1">0.99 ± 0.03</td>
                <td align="right" rowspan="1" colspan="1">0.96 ± 0.07</td>
                <td align="right" rowspan="1" colspan="1">0.99 ± 0.04</td>
                <td align="right" rowspan="1" colspan="1">0.76 ± 0.17</td>
                <td align="right" rowspan="1" colspan="1">1.00 ± 0.03</td>
                <td align="right" rowspan="1" colspan="1">0.99 ± 0.02</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Entero OriR</td>
                <td align="right" rowspan="1" colspan="1">49</td>
                <td align="right" rowspan="1" colspan="1">0.84 ± 0.06</td>
                <td align="right" rowspan="1" colspan="1">0.95 ± 0.07</td>
                <td align="right" rowspan="1" colspan="1">0.92 ± 0.09</td>
                <td align="right" rowspan="1" colspan="1">0.94 ± 0.08</td>
                <td align="right" rowspan="1" colspan="1">0.94 ± 0.07</td>
                <td align="right" rowspan="1" colspan="1">0.84 ± 0.15</td>
                <td align="right" rowspan="1" colspan="1">0.95 ± 0.07</td>
                <td align="right" rowspan="1" colspan="1">0.96 ± 0.04</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">gcvT</td>
                <td align="right" rowspan="1" colspan="1">167</td>
                <td align="right" rowspan="1" colspan="1">0.44 ± 0.13</td>
                <td align="right" rowspan="1" colspan="1">0.61 ± 0.19</td>
                <td align="right" rowspan="1" colspan="1">0.61 ± 0.24</td>
                <td align="right" rowspan="1" colspan="1">0.57 ± 0.25</td>
                <td align="right" rowspan="1" colspan="1">0.40 ± 0.33</td>
                <td align="right" rowspan="1" colspan="1">0.44 ± 0.19</td>
                <td align="right" rowspan="1" colspan="1">0.62 ± 0.20</td>
                <td align="right" rowspan="1" colspan="1">0.62 ± 0.18</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Hammerhead 1</td>
                <td align="right" rowspan="1" colspan="1">53</td>
                <td align="right" rowspan="1" colspan="1">0.71 ± 0.17</td>
                <td align="right" rowspan="1" colspan="1">0.89 ± 0.13</td>
                <td align="right" rowspan="1" colspan="1">0.90 ± 0.11</td>
                <td align="right" rowspan="1" colspan="1">0.87 ± 0.16</td>
                <td align="right" rowspan="1" colspan="1">0.83 ± 0.25</td>
                <td align="right" rowspan="1" colspan="1">0.52 ± 0.27</td>
                <td align="right" rowspan="1" colspan="1">0.88 ± 0.16</td>
                <td align="right" rowspan="1" colspan="1">0.87 ± 0.14</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Hammerhead 3</td>
                <td align="right" rowspan="1" colspan="1">126</td>
                <td align="right" rowspan="1" colspan="1">0.66 ± 0.21</td>
                <td align="right" rowspan="1" colspan="1">0.86 ± 0.20</td>
                <td align="right" rowspan="1" colspan="1">0.88 ± 0.21</td>
                <td align="right" rowspan="1" colspan="1">0.88 ± 0.20</td>
                <td align="right" rowspan="1" colspan="1">0.80 ± 0.31</td>
                <td align="right" rowspan="1" colspan="1">0.71 ± 0.31</td>
                <td align="right" rowspan="1" colspan="1">0.90 ± 0.16</td>
                <td align="right" rowspan="1" colspan="1">0.89 ± 0.16</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">HCV SLIV</td>
                <td align="right" rowspan="1" colspan="1">98</td>
                <td align="right" rowspan="1" colspan="1">0.85 ± 0.05</td>
                <td align="right" rowspan="1" colspan="1">0.99 ± 0.03</td>
                <td align="right" rowspan="1" colspan="1">0.98 ± 0.04</td>
                <td align="right" rowspan="1" colspan="1">0.98 ± 0.03</td>
                <td align="right" rowspan="1" colspan="1">0.99 ± 0.03</td>
                <td align="right" rowspan="1" colspan="1">0.81 ± 0.34</td>
                <td align="right" rowspan="1" colspan="1">0.99 ± 0.03</td>
                <td align="right" rowspan="1" colspan="1">0.98 ± 0.03</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">HCV SLVII</td>
                <td align="right" rowspan="1" colspan="1">51</td>
                <td align="right" rowspan="1" colspan="1">0.83 ± 0.09</td>
                <td align="right" rowspan="1" colspan="1">0.97 ± 0.06</td>
                <td align="right" rowspan="1" colspan="1">0.96 ± 0.06</td>
                <td align="right" rowspan="1" colspan="1">0.93 ± 0.10</td>
                <td align="right" rowspan="1" colspan="1">0.95 ± 0.07</td>
                <td align="right" rowspan="1" colspan="1">0.71 ± 0.22</td>
                <td align="right" rowspan="1" colspan="1">0.95 ± 0.07</td>
                <td align="right" rowspan="1" colspan="1">0.96 ± 0.06</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">HepC CRE</td>
                <td align="right" rowspan="1" colspan="1">45</td>
                <td align="right" rowspan="1" colspan="1">0.86 ± 0.06</td>
                <td align="right" rowspan="1" colspan="1">1.00 ± 0.00</td>
                <td align="right" rowspan="1" colspan="1">1.00 ± 0.00</td>
                <td align="right" rowspan="1" colspan="1">1.00 ± 0.00</td>
                <td align="right" rowspan="1" colspan="1">1.00 ± 0.00</td>
                <td align="right" rowspan="1" colspan="1">0.77 ± 0.29</td>
                <td align="right" rowspan="1" colspan="1">1.00 ± 0.00</td>
                <td align="right" rowspan="1" colspan="1">1.00 ± 0.00</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Histone3</td>
                <td align="right" rowspan="1" colspan="1">84</td>
                <td align="right" rowspan="1" colspan="1">0.78 ± 0.09</td>
                <td align="right" rowspan="1" colspan="1">1.00 ± 0.00</td>
                <td align="right" rowspan="1" colspan="1">1.00 ± 0.00</td>
                <td align="right" rowspan="1" colspan="1">1.00 ± 0.00</td>
                <td align="right" rowspan="1" colspan="1">1.00 ± 0.00</td>
                <td align="right" rowspan="1" colspan="1">1.00 ± 0.00</td>
                <td align="right" rowspan="1" colspan="1">1.00 ± 0.00</td>
                <td align="right" rowspan="1" colspan="1">1.00 ± 0.00</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">HIV FE</td>
                <td align="right" rowspan="1" colspan="1">733</td>
                <td align="right" rowspan="1" colspan="1">0.87 ± 0.04</td>
                <td align="right" rowspan="1" colspan="1">1.00 ± 0.02</td>
                <td align="right" rowspan="1" colspan="1">1.00 ± 0.02</td>
                <td align="right" rowspan="1" colspan="1">0.98 ± 0.05</td>
                <td align="right" rowspan="1" colspan="1">0.99 ± 0.05</td>
                <td align="right" rowspan="1" colspan="1">0.64 ± 0.29</td>
                <td align="right" rowspan="1" colspan="1">1.00 ± 0.02</td>
                <td align="right" rowspan="1" colspan="1">1.00 ± 0.02</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">HIV GSL3</td>
                <td align="right" rowspan="1" colspan="1">786</td>
                <td align="right" rowspan="1" colspan="1">0.86 ± 0.04</td>
                <td align="right" rowspan="1" colspan="1">0.99 ± 0.02</td>
                <td align="right" rowspan="1" colspan="1">0.99 ± 0.02</td>
                <td align="right" rowspan="1" colspan="1">0.98 ± 0.05</td>
                <td align="right" rowspan="1" colspan="1">0.99 ± 0.02</td>
                <td align="right" rowspan="1" colspan="1">0.80 ± 0.19</td>
                <td align="right" rowspan="1" colspan="1">0.99 ± 0.02</td>
                <td align="right" rowspan="1" colspan="1">0.99 ± 0.02</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">HIV PBS</td>
                <td align="right" rowspan="1" colspan="1">188</td>
                <td align="right" rowspan="1" colspan="1">0.92 ± 0.02</td>
                <td align="right" rowspan="1" colspan="1">1.00 ± 0.01</td>
                <td align="right" rowspan="1" colspan="1">1.00 ± 0.01</td>
                <td align="right" rowspan="1" colspan="1">1.00 ± 0.02</td>
                <td align="right" rowspan="1" colspan="1">0.99 ± 0.03</td>
                <td align="right" rowspan="1" colspan="1">0.91 ± 0.11</td>
                <td align="right" rowspan="1" colspan="1">1.00 ± 0.01</td>
                <td align="right" rowspan="1" colspan="1">0.99 ± 0.02</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Intron gpII</td>
                <td align="right" rowspan="1" colspan="1">181</td>
                <td align="right" rowspan="1" colspan="1">0.46 ± 0.13</td>
                <td align="right" rowspan="1" colspan="1">0.64 ± 0.17</td>
                <td align="right" rowspan="1" colspan="1">0.64 ± 0.17</td>
                <td align="right" rowspan="1" colspan="1">0.63 ± 0.17</td>
                <td align="right" rowspan="1" colspan="1">0.50 ± 0.28</td>
                <td align="right" rowspan="1" colspan="1">0.49 ± 0.18</td>
                <td align="right" rowspan="1" colspan="1">0.65 ± 0.15</td>
                <td align="right" rowspan="1" colspan="1">0.65 ± 0.15</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">IRES HCV</td>
                <td align="right" rowspan="1" colspan="1">764</td>
                <td align="right" rowspan="1" colspan="1">0.65 ± 0.11</td>
                <td align="right" rowspan="1" colspan="1">0.88 ± 0.16</td>
                <td align="right" rowspan="1" colspan="1">0.45 ± 0.19</td>
                <td align="right" rowspan="1" colspan="1">0.86 ± 0.17</td>
                <td align="right" rowspan="1" colspan="1">0.68 ± 0.38</td>
                <td align="right" rowspan="1" colspan="1">0.85 ± 0.08</td>
                <td align="right" rowspan="1" colspan="1">0.88 ± 0.08</td>
                <td align="right" rowspan="1" colspan="1">0.89 ± 0.11</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">IRES Picorna</td>
                <td align="right" rowspan="1" colspan="1">181</td>
                <td align="right" rowspan="1" colspan="1">0.84 ± 0.07</td>
                <td align="right" rowspan="1" colspan="1">0.97 ± 0.03</td>
                <td align="right" rowspan="1" colspan="1">0.61 ± 0.04</td>
                <td align="right" rowspan="1" colspan="1">0.96 ± 0.04</td>
                <td align="right" rowspan="1" colspan="1">0.95 ± 0.04</td>
                <td align="right" rowspan="1" colspan="1">0.85 ± 0.11</td>
                <td align="right" rowspan="1" colspan="1">0.96 ± 0.04</td>
                <td align="right" rowspan="1" colspan="1">0.96 ± 0.04</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">K chan RES</td>
                <td align="right" rowspan="1" colspan="1">124</td>
                <td align="right" rowspan="1" colspan="1">0.74 ± 0.10</td>
                <td align="right" rowspan="1" colspan="1">0.99 ± 0.02</td>
                <td align="right" rowspan="1" colspan="1">0.98 ± 0.05</td>
                <td align="right" rowspan="1" colspan="1">0.89 ± 0.19</td>
                <td align="right" rowspan="1" colspan="1">0.95 ± 0.08</td>
                <td align="right" rowspan="1" colspan="1">0.58 ± 0.26</td>
                <td align="right" rowspan="1" colspan="1">0.95 ± 0.11</td>
                <td align="right" rowspan="1" colspan="1">0.96 ± 0.05</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Lysine</td>
                <td align="right" rowspan="1" colspan="1">80</td>
                <td align="right" rowspan="1" colspan="1">0.50 ± 0.13</td>
                <td align="right" rowspan="1" colspan="1">0.72 ± 0.13</td>
                <td align="right" rowspan="1" colspan="1">0.54 ± 0.15</td>
                <td align="right" rowspan="1" colspan="1">0.71 ± 0.18</td>
                <td align="right" rowspan="1" colspan="1">0.66 ± 0.16</td>
                <td align="right" rowspan="1" colspan="1">0.50 ± 0.16</td>
                <td align="right" rowspan="1" colspan="1">0.72 ± 0.15</td>
                <td align="right" rowspan="1" colspan="1">0.71 ± 0.15</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Retroviral psi</td>
                <td align="right" rowspan="1" colspan="1">89</td>
                <td align="right" rowspan="1" colspan="1">0.88 ± 0.03</td>
                <td align="right" rowspan="1" colspan="1">0.93 ± 0.03</td>
                <td align="right" rowspan="1" colspan="1">0.93 ± 0.03</td>
                <td align="right" rowspan="1" colspan="1">0.93 ± 0.03</td>
                <td align="right" rowspan="1" colspan="1">0.92 ± 0.04</td>
                <td align="right" rowspan="1" colspan="1">0.74 ± 0.12</td>
                <td align="right" rowspan="1" colspan="1">0.93 ± 0.04</td>
                <td align="right" rowspan="1" colspan="1">0.93 ± 0.03</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">S box</td>
                <td align="right" rowspan="1" colspan="1">91</td>
                <td align="right" rowspan="1" colspan="1">0.60 ± 0.10</td>
                <td align="right" rowspan="1" colspan="1">0.75 ± 0.13</td>
                <td align="right" rowspan="1" colspan="1">0.76 ± 0.16</td>
                <td align="right" rowspan="1" colspan="1">0.79 ± 0.14</td>
                <td align="right" rowspan="1" colspan="1">0.67 ± 0.24</td>
                <td align="right" rowspan="1" colspan="1">0.54 ± 0.16</td>
                <td align="right" rowspan="1" colspan="1">0.77 ± 0.12</td>
                <td align="right" rowspan="1" colspan="1">0.80 ± 0.10</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SECIS</td>
                <td align="right" rowspan="1" colspan="1">114</td>
                <td align="right" rowspan="1" colspan="1">0.44 ± 0.16</td>
                <td align="right" rowspan="1" colspan="1">0.59 ± 0.21</td>
                <td align="right" rowspan="1" colspan="1">0.62 ± 0.21</td>
                <td align="right" rowspan="1" colspan="1">0.57 ± 0.25</td>
                <td align="right" rowspan="1" colspan="1">0.54 ± 0.25</td>
                <td align="right" rowspan="1" colspan="1">0.39 ± 0.24</td>
                <td align="right" rowspan="1" colspan="1">0.61 ± 0.20</td>
                <td align="right" rowspan="1" colspan="1">0.61 ± 0.19</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">sno 14q I II</td>
                <td align="right" rowspan="1" colspan="1">44</td>
                <td align="right" rowspan="1" colspan="1">0.75 ± 0.10</td>
                <td align="right" rowspan="1" colspan="1">0.92 ± 0.10</td>
                <td align="right" rowspan="1" colspan="1">0.89 ± 0.16</td>
                <td align="right" rowspan="1" colspan="1">0.85 ± 0.20</td>
                <td align="right" rowspan="1" colspan="1">0.89 ± 0.19</td>
                <td align="right" rowspan="1" colspan="1">0.58 ± 0.27</td>
                <td align="right" rowspan="1" colspan="1">0.91 ± 0.13</td>
                <td align="right" rowspan="1" colspan="1">0.92 ± 0.10</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SRP bact</td>
                <td align="right" rowspan="1" colspan="1">114</td>
                <td align="right" rowspan="1" colspan="1">0.48 ± 0.16</td>
                <td align="right" rowspan="1" colspan="1">0.65 ± 0.21</td>
                <td align="right" rowspan="1" colspan="1">0.66 ± 0.21</td>
                <td align="right" rowspan="1" colspan="1">0.63 ± 0.25</td>
                <td align="right" rowspan="1" colspan="1">0.65 ± 0.21</td>
                <td align="right" rowspan="1" colspan="1">0.51 ± 0.22</td>
                <td align="right" rowspan="1" colspan="1">0.61 ± 0.25</td>
                <td align="right" rowspan="1" colspan="1">0.66 ± 0.21</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SRP euk arch</td>
                <td align="right" rowspan="1" colspan="1">122</td>
                <td align="right" rowspan="1" colspan="1">0.51 ± 0.20</td>
                <td align="right" rowspan="1" colspan="1">0.62 ± 0.29</td>
                <td align="right" rowspan="1" colspan="1">0.35 ± 0.17</td>
                <td align="right" rowspan="1" colspan="1">0.64 ± 0.28</td>
                <td align="right" rowspan="1" colspan="1">0.64 ± 0.26</td>
                <td align="right" rowspan="1" colspan="1">0.50 ± 0.26</td>
                <td align="right" rowspan="1" colspan="1">0.61 ± 0.29</td>
                <td align="right" rowspan="1" colspan="1">0.64 ± 0.27</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">T-box</td>
                <td align="right" rowspan="1" colspan="1">18</td>
                <td align="right" rowspan="1" colspan="1">0.68 ± 0.15</td>
                <td align="right" rowspan="1" colspan="1">0.77 ± 0.17</td>
                <td align="right" rowspan="1" colspan="1">0.49 ± 0.17</td>
                <td align="right" rowspan="1" colspan="1">0.68 ± 0.25</td>
                <td align="right" rowspan="1" colspan="1">0.70 ± 0.17</td>
                <td align="right" rowspan="1" colspan="1">0.59 ± 0.21</td>
                <td align="right" rowspan="1" colspan="1">0.74 ± 0.15</td>
                <td align="right" rowspan="1" colspan="1">0.74 ± 0.14</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">TAR</td>
                <td align="right" rowspan="1" colspan="1">286</td>
                <td align="right" rowspan="1" colspan="1">0.87 ± 0.04</td>
                <td align="right" rowspan="1" colspan="1">0.99 ± 0.03</td>
                <td align="right" rowspan="1" colspan="1">0.99 ± 0.02</td>
                <td align="right" rowspan="1" colspan="1">0.99 ± 0.03</td>
                <td align="right" rowspan="1" colspan="1">0.98 ± 0.04</td>
                <td align="right" rowspan="1" colspan="1">0.83 ± 0.19</td>
                <td align="right" rowspan="1" colspan="1">0.99 ± 0.04</td>
                <td align="right" rowspan="1" colspan="1">0.99 ± 0.02</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">THI</td>
                <td align="right" rowspan="1" colspan="1">321</td>
                <td align="right" rowspan="1" colspan="1">0.45 ± 0.10</td>
                <td align="right" rowspan="1" colspan="1">0.68 ± 0.16</td>
                <td align="right" rowspan="1" colspan="1">0.66 ± 0.20</td>
                <td align="right" rowspan="1" colspan="1">0.68 ± 0.18</td>
                <td align="right" rowspan="1" colspan="1">0.50 ± 0.29</td>
                <td align="right" rowspan="1" colspan="1">0.48 ± 0.18</td>
                <td align="right" rowspan="1" colspan="1">0.65 ± 0.20</td>
                <td align="right" rowspan="1" colspan="1">0.69 ± 0.15</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">tRNA</td>
                <td align="right" rowspan="1" colspan="1">2039</td>
                <td align="right" rowspan="1" colspan="1">0.43 ± 0.12</td>
                <td align="right" rowspan="1" colspan="1">0.75 ± 0.21</td>
                <td align="right" rowspan="1" colspan="1">0.85 ± 0.16</td>
                <td align="right" rowspan="1" colspan="1">0.82 ± 0.19</td>
                <td align="right" rowspan="1" colspan="1">0.76 ± 0.27</td>
                <td align="right" rowspan="1" colspan="1">0.66 ± 0.23</td>
                <td align="right" rowspan="1" colspan="1">0.72 ± 0.22</td>
                <td align="right" rowspan="1" colspan="1">0.75 ± 0.20</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">U1</td>
                <td align="right" rowspan="1" colspan="1">82</td>
                <td align="right" rowspan="1" colspan="1">0.63 ± 0.17</td>
                <td align="right" rowspan="1" colspan="1">0.79 ± 0.17</td>
                <td align="right" rowspan="1" colspan="1">0.70 ± 0.13</td>
                <td align="right" rowspan="1" colspan="1">0.79 ± 0.19</td>
                <td align="right" rowspan="1" colspan="1">0.80 ± 0.14</td>
                <td align="right" rowspan="1" colspan="1">0.67 ± 0.20</td>
                <td align="right" rowspan="1" colspan="1">0.77 ± 0.17</td>
                <td align="right" rowspan="1" colspan="1">0.80 ± 0.17</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">U2</td>
                <td align="right" rowspan="1" colspan="1">112</td>
                <td align="right" rowspan="1" colspan="1">0.64 ± 0.16</td>
                <td align="right" rowspan="1" colspan="1">0.75 ± 0.17</td>
                <td align="right" rowspan="1" colspan="1">0.63 ± 0.13</td>
                <td align="right" rowspan="1" colspan="1">0.76 ± 0.19</td>
                <td align="right" rowspan="1" colspan="1">0.73 ± 0.22</td>
                <td align="right" rowspan="1" colspan="1">0.59 ± 0.19</td>
                <td align="right" rowspan="1" colspan="1">0.75 ± 0.18</td>
                <td align="right" rowspan="1" colspan="1">0.76 ± 0.17</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">U6</td>
                <td align="right" rowspan="1" colspan="1">30</td>
                <td align="right" rowspan="1" colspan="1">0.83 ± 0.06</td>
                <td align="right" rowspan="1" colspan="1">0.93 ± 0.05</td>
                <td align="right" rowspan="1" colspan="1">0.89 ± 0.09</td>
                <td align="right" rowspan="1" colspan="1">0.90 ± 0.08</td>
                <td align="right" rowspan="1" colspan="1">0.88 ± 0.10</td>
                <td align="right" rowspan="1" colspan="1">0.72 ± 0.14</td>
                <td align="right" rowspan="1" colspan="1">0.93 ± 0.06</td>
                <td align="right" rowspan="1" colspan="1">0.92 ± 0.07</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">UnaL2</td>
                <td align="right" rowspan="1" colspan="1">138</td>
                <td align="right" rowspan="1" colspan="1">0.77 ± 0.08</td>
                <td align="right" rowspan="1" colspan="1">0.93 ± 0.08</td>
                <td align="right" rowspan="1" colspan="1">0.92 ± 0.09</td>
                <td align="right" rowspan="1" colspan="1">0.89 ± 0.15</td>
                <td align="right" rowspan="1" colspan="1">0.91 ± 0.10</td>
                <td align="right" rowspan="1" colspan="1">0.65 ± 0.29</td>
                <td align="right" rowspan="1" colspan="1">0.94 ± 0.08</td>
                <td align="right" rowspan="1" colspan="1">0.92 ± 0.06</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">yybP-ykoY</td>
                <td align="right" rowspan="1" colspan="1">127</td>
                <td align="right" rowspan="1" colspan="1">0.39 ± 0.14</td>
                <td align="right" rowspan="1" colspan="1">0.58 ± 0.20</td>
                <td align="right" rowspan="1" colspan="1">0.54 ± 0.23</td>
                <td align="right" rowspan="1" colspan="1">0.57 ± 0.25</td>
                <td align="right" rowspan="1" colspan="1">0.40 ± 0.33</td>
                <td align="right" rowspan="1" colspan="1">0.46 ± 0.22</td>
                <td align="right" rowspan="1" colspan="1">0.56 ± 0.20</td>
                <td align="right" rowspan="1" colspan="1">0.55 ± 0.21</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Pooled Average</td>
                <td align="right" rowspan="1" colspan="1">249.33</td>
                <td align="right" rowspan="1" colspan="1">0.63</td>
                <td align="right" rowspan="1" colspan="1">0.84</td>
                <td align="right" rowspan="1" colspan="1">0.81</td>
                <td align="right" rowspan="1" colspan="1">0.84</td>
                <td align="right" rowspan="1" colspan="1">0.80</td>
                <td align="right" rowspan="1" colspan="1">0.68</td>
                <td align="right" rowspan="1" colspan="1">0.82</td>
                <td align="right" rowspan="1" colspan="1">0.84</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="t004fn001">
            <p>Average F1 scores (± one standard deviation) for <italic>pairwise global alignment</italic> of <monospace>RNAmountAlign</monospace> and four widely used RNA sequence/structure alignment algorithms on the benchmarking set of 8,976 pairwise alignments from the <monospace>BRaliBase K2</monospace> database [<xref rid="pone.0227177.ref038" ref-type="bibr">38</xref>]. For each indicated Rfam family, the the number of alignments (NumAln), sequence identity (SeqId), and F1 scores for <monospace>RNAmountAlign</monospace>, <monospace>LocARNA</monospace>, <monospace>LARA</monospace>, <monospace>FOLDALIGN</monospace>, and <monospace>DYNALIGN</monospace> are listed, along with pooled averages over all 8,976 pairwise alignments. Parameters used in <xref ref-type="disp-formula" rid="pone.0227177.e035">Eq (17)</xref> for <monospace>RNAmountAlign</monospace> were similarity matrix RIBOSUM85-60, structural similarity weight <italic>γ</italic> = 1/2, gap initiation <italic>g</italic><sub><italic>i</italic></sub> = −3, gap extension <italic>g</italic><sub><italic>e</italic></sub> = −1.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <fig id="pone.0227177.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0227177.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>(Left) F1 score and (Right) structural conservation index (SCI) for <italic>pairwise global alignments</italic> using <monospace>RNAmountAlign</monospace>, <monospace>LocARNA</monospace>, <monospace>LARA</monospace>, <monospace>FOLDALIGN</monospace>, <monospace>DYNALIGN</monospace>, <monospace>STRAL</monospace>, <monospace>MXSCARNA</monospace>, and sequence-only(<italic>γ</italic> = 0).</title>
          <p>F1 score and SCI are shown as a function of reference alignment sequence identity for pairwise alignments in the <monospace>BRAliBase 2.1</monospace> database used for benchmarking. Moving averages taken for centered, symmetric windows of size 11.</p>
        </caption>
        <graphic xlink:href="pone.0227177.g003"/>
      </fig>
      <fig id="pone.0227177.g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0227177.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Run time of <italic>pairwise global alignment</italic> for <monospace>RNAmountAlign</monospace>, <monospace>LocARNA</monospace>, <monospace>LARA</monospace>, <monospace>FOLDALIGN</monospace>, <monospace>DYNALIGN</monospace>, and <monospace>MXSCARNA</monospace>.</title>
          <p>(Left) The log base 10 run time is shown as a function of reference alignment length for pairwise alignments in the <monospace>BRAliBase 2.1 K2</monospace> database used for benchmarking. Moving averages taken for centered, symmetric windows of size 51. (Right) Actual run time for <monospace>RNAmountAlign</monospace>, <monospace>LARA</monospace> and <monospace>MXSCARNA</monospace> on the same data. Unlike the left panel the actual run time is shown, rather than log run time, without any moving average taken.</p>
        </caption>
        <graphic xlink:href="pone.0227177.g004"/>
      </fig>
      <p>For each pairwise alignment, a consensus structure was determined from the Rfam family consensus structure by removing gaps, removing base pairs (<italic>i</italic>, <italic>j</italic>) which are noncanonical or for which <italic>j</italic> − <italic>i</italic> ≤ <italic>θ</italic> = 3. These derived consensus structures were used as the reference structures in the computation of MCC. To be explicit, consider the following toy example of multiple alignment in Stockholm format—for illustrative purposes, pretend that this is an Rfam seed alignment of a small RNA family (recall that additional requirements must be met concerning number of sequences and average nucleotide length for an Rfam family to be selected).</p>
      <p>
        <monospace># STOCKHOLM 1.0</monospace>
      </p>
      <p><monospace>positions</monospace>   <monospace>123456789012345678</monospace></p>
      <p><monospace>Eg1</monospace>      <monospace>GGACAAGCAAUGCUUGCC</monospace></p>
      <p><monospace>Eg2</monospace>      <monospace>GG-CAAGCA-UGCUUGAC</monospace></p>
      <p><monospace>Eg3</monospace>      <monospace>GGACAAGCAAUGCUUGCC</monospace></p>
      <p>
        <monospace>#=GC SS_cons</monospace>
        <monospace>≪-⋘≪___⋙⋙&gt;</monospace>
      </p>
      <p><monospace>#=GC RF</monospace>    <monospace>GGACAAGCAAUGCUUGCC</monospace></p>
      <p>This multiple alignment would then produce the following consensus structures for the <italic>pairwise</italic> alignment of Eg1 with Eg2.</p>
      <p>
        <monospace>&gt; Eg1</monospace>
      </p>
      <p>
        <monospace>123456789012345678</monospace>
      </p>
      <p>
        <monospace>GGACAAGCAAUGCUUGCC</monospace>
      </p>
      <p>
        <monospace>((.(((((…)))))))</monospace>
      </p>
      <p>
        <monospace>&gt; Eg2</monospace>
      </p>
      <p>
        <monospace>1234567890123456</monospace>
      </p>
      <p>
        <monospace>GGCAAGCAUGCUUGAC</monospace>
      </p>
      <p>
        <monospace>(.((((….)))).)</monospace>
      </p>
      <p>Note that the Rfam consensus indicates that positions 2 and 17 are paired in the multiple sequence alignment, hence the reference structure for Eg1 has the GC base pair (2, 17) as expected. However, the the corresponding positions in Eg2 are G,A. To avoid violating the requirement (1) in the definition of secondary structure, the reference structure for Eg2 has dots at positions 2 and 15. Note that the Rfam consensus indicates a hairpin loop at positions 8 and 12 of the multiple sequence alignment, so the consensus structure for Eg1 contains the base pair (8, 12). However, since Eg2 contains <monospace>A-U</monospace>, this hairpin would contain only two nucleotides A,U, which would violate condition (2) of the definition of secondary structure. For that reason, there is no base pair (7, 10) in the reference structure of Eg2.</p>
      <p>For <italic>multiple global</italic> alignment benchmarking, we used k5 <monospace>BRAliBase 2.1</monospace>, which includes 2,405 reference alignments, each composed of 5 sequences. For <italic>pairwise local alignment</italic> benchmarking, 75 pairwise alignments having sequence identity ≤ 70% were randomly selected from each of 20 well-known families from the Rfam 12.0 database [<xref rid="pone.0227177.ref034" ref-type="bibr">34</xref>], many of which were considered in a previous study [<xref rid="pone.0227177.ref047" ref-type="bibr">47</xref>], yielding a total of 1500 alignments. Following [<xref rid="pone.0227177.ref048" ref-type="bibr">48</xref>], these alignments were trimmed on the left and right, so that both first and last aligned pairs of the alignment do not contain a gap symbol. For sequences <bold>a</bold> = <italic>a</italic><sub>1</sub>, …, <italic>a<sub>n</sub></italic> [resp. <bold>b</bold> = <italic>b</italic><sub>1</sub>, …, <italic>b<sub>m</sub></italic>] from each alignment, random sequences <bold>a</bold>′ [resp. <bold>b</bold>′] were generated with the same nucleotide frequencies, then a random position was chosen in <bold>a</bold>′ [resp. <bold>b</bold>′] in which to insert <bold>a</bold> [resp. <bold>b</bold>], thus resulting in a pair of sequences of lengths 4<italic>n</italic> and 4<italic>m</italic>. Finally, since sequence identity was at most 70%, the RIBOSUM70-25 similarity matrix was used in <monospace>RNAmountAlign</monospace>. Preparation of the benchmarking dataset for local alignment was analogous to the method used in <italic>multiple</italic> local alignment of [<xref rid="pone.0227177.ref048" ref-type="bibr">48</xref>].</p>
    </sec>
    <sec id="sec013">
      <title>Dataset for correlation of <italic>p</italic>-values for different distribution fits</title>
      <p>A pool of 2220 sequences from the Rfam 12.0 database [<xref rid="pone.0227177.ref034" ref-type="bibr">34</xref>] was created as follows. One sequence was selected from each Rfam family having average sequence length at most 200 nt, with the property that the base pair distance between its minimum free energy (MFE) structure and the Rfam consensus structure was a minimum. For example, the 102 nt sequence with EMBL accession code AAOX01000028.142464-42565 was selected from family RF00167 since its MFE structure was identical to its Rfam consensus structure, while the 178 nt sequence with EMBL accession code AE016827.11325416-1325239 was selected from RF00168 since the base pair distance between its MFE structure and its Rfam consensus structure was 11—the base pair distance between MFE and consensus structure for all other sequences from RF00168 was greater than or equal to 11. Subsequently, for each of 500 randomly selected <italic>query</italic> sequences from the pool of 2220 sequences, 1000 random <italic>target</italic> sequences of length 400 nt were generated to have the same expected nucleotide frequency as that of the query. For each query and random target, five semiglobal alignments were created using gap initiation costs of <italic>g</italic><sub><italic>i</italic></sub> ∈ {−1, −2, −3, −4, −5} with gap extension cost <italic>g</italic><sub><italic>e</italic></sub> equal to one-third the gap initiation cost. For each alignment score <italic>x</italic> for query and random target, the <italic>p</italic>-value was computed as 1 − <italic>CDF</italic>(<italic>x</italic>) for ND, EVD and GD, where <italic>CDF</italic>(<italic>x</italic>) is the cumulative density function evaluated at <italic>x</italic>. Additionally, a heuristic <italic>p</italic>-value was determined by calculating the proportion of alignment scores for given query that exceed <italic>x</italic>.</p>
    </sec>
    <sec id="sec014">
      <title>Software version and hardware specs</title>
      <p>For benchmarking, we used <monospace>LocARNA</monospace> (version 1.8.7), <monospace>FOLDALIGN</monospace> (version 2.5), <monospace>FOLDALIGNM</monospace> (version 1.0.1), <monospace>LARA</monospace> (version 1.3.2), <monospace>DYNALIGN</monospace> (from version 5.7 of <monospace>RNAstructure</monospace>), the sequence alignment algorithm <monospace>MUSCLE</monospace> (version 3.8.31), <monospace>STRAL</monospace> (in-house implementation due to unavailability of the software [<xref rid="pone.0227177.ref022" ref-type="bibr">22</xref>], and <monospace>MXSCARNA</monospace> (version 2.1). For genome query scan benchmarking, we used <monospace>RSEARCH 1.1</monospace>, <monospace>FOLDALIGN</monospace> (version 2.5), and <monospace>RNAmountAlignScan</monospace>. Recommended default parameters were used for each software, including <monospace>RNAmountAlign</monospace> from this paper. The commands used to run the software are given in <xref ref-type="supplementary-material" rid="pone.0227177.s001">S1</xref>, <xref ref-type="supplementary-material" rid="pone.0227177.s002">S2</xref> and <xref ref-type="supplementary-material" rid="pone.0227177.s003">S3</xref> Tables. Each software package was run on a cluster of identically configured Intel Xeon 2.66 GHz 4-core nodes with 16GB of memory, running CentOS Linux release 6.10.</p>
      <p>In contrast to all other benchmarking work described in this paper, benchmarking tests for <monospace>RNAmountAlignScan</monospace>, <monospace>RSEARCH</monospace>, and <monospace>FOLDALIGN</monospace> in genome scanning mode, as described in Section <italic>Query Scan</italic>, were conducted on a 24-processor Intel Xeon CPU E5-2440 2.40 GHz system with 198GB memory.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec015">
    <title>Results</title>
    <p>We benchmarked <monospace>RNAmountAlign</monospace>’s performance for pairwise and multiple alignments on <monospace>BRAliBase</monospace> K2 and K5 datasets, respectively.</p>
    <sec id="sec016">
      <title>Pairwise alignment</title>
      <p><xref ref-type="fig" rid="pone.0227177.g003">Fig 3</xref>, <xref ref-type="supplementary-material" rid="pone.0227177.s010">S2</xref> and <xref ref-type="supplementary-material" rid="pone.0227177.s011">S3</xref> Figs depict moving averages of <italic>pairwise global alignment</italic> sensitivity, positive predictive value (PPV) and F1-score for the software described in this paper, as well as for <monospace>LocARNA</monospace>, <monospace>FOLDALIGN</monospace>, <monospace>LARA</monospace>, <monospace>DYNALIGN</monospace>, <monospace>STRAL</monospace>, and <monospace>MXSCARNA</monospace>. For pairwise benchmarking, reference alignments of size 2, a.k.a. K2, were taken from the <monospace>BRAliBase 2.1</monospace> database [<xref rid="pone.0227177.ref038" ref-type="bibr">38</xref>]. <monospace>BRAliBase 2.1 K2</monospace> data are based on seed alignments of the Rfam 7.0 database, and consist of 8,976 alignments of RNA sequences from 36 Rfam families.</p>
      <p>Moving averages (window size 11) of sensitivity, positive predictive value, and F1 score were computed as a function of sequence identity, where it should be noted that the number of pairwise alignments for different values of sequence identity can vary for the <monospace>BRAliBase 2.1</monospace> data (e.g. there are only 35 pairwise alignments having sequence identity &lt; 20%). In computing moving averages, each value represents the average over a symmetric window (<italic>k</italic> − 5, <italic>k</italic> + 5) of size 11 nt centered at the value from the <italic>x</italic>-axis. For 504 pairwise global alignments, <monospace>FOLDALIGN</monospace> produced “No global alignment was found. This can either be due to the pruning, or because no structural alignment exists” and for 29, <monospace>DYNALIGN</monospace> yielded no alignments. The only <monospace>BRAliBase</monospace> alignment that both tools failed was Hammerhead_1.apsi36.sci72.no1. In our benchmarking the sensitivity, PPV and F1 values for such failures of <monospace>FOLDALIGN</monospace> and <monospace>DYNALIGN</monospace> were all assigned the value of 0, which explains the weaker performance of these two methods in <xref ref-type="fig" rid="pone.0227177.g003">Fig 3</xref> compared to [<xref rid="pone.0227177.ref014" ref-type="bibr">14</xref>], where such failures are simply excluded from the analysis. Moreover, we observed a larger number of failed alignments in <monospace>FOLDALIGN</monospace> 2.5 than in the previous work of [<xref rid="pone.0227177.ref014" ref-type="bibr">14</xref>]. Default parameters were used for all software. For our software <monospace>RNAmountAlign</monospace>, gap initiation cost was -3, gap extension -1, and sequence/structure weighting parameter <italic>γ</italic> was 0.5 (value obtained by optimizing on a small set of 300 random alignments from Rfam 12.0, not considered in training or testing set). The sequence-only alignment is computed from <monospace>RNAmountAlign</monospace> with the same gap penalties, but for <italic>γ</italic> = 0. While its accuracy is high, <monospace>RNAmountAlign</monospace> is faster by an order of magnitude than <monospace>LocARNA</monospace>, <monospace>LARA</monospace>, <monospace>FOLDALIGN</monospace>, and <monospace>DYNALIGN</monospace>—indeed, algorithmic time complexity of our method is <italic>O</italic>(<italic>n</italic><sup>3</sup>) for two sequences of length <italic>n</italic>. Since <monospace>STRAL</monospace> could not be compiled on any of our systems, we implemented its algorithm by modifying <monospace>RNAmountAlign</monospace> and obtained results for <monospace>STRAL</monospace>’s default parameter settings. Therefore, the run time of <monospace>STRAL</monospace> is identical to <monospace>RNAmountAlign</monospace> but <monospace>RNAmountAlign</monospace> achieves higher F1 score, sensitivity and PPV. <monospace>MXSCARNA</monospace> and <monospace>RNAmountAlign</monospace> have similar average F1 scores. Indeed, a paired 2-tailed Wilcoxson signed-rank test of the difference between F1 scores, as computed by <monospace>MXSCARNA</monospace> and <monospace>RNAmountAlign</monospace>, for the 8,976 pairwise global alignments mentioned in <xref rid="pone.0227177.t004" ref-type="table">Table 4</xref>. It follows that the (null) hypothesis <italic>H</italic><sub>0</sub> cannot be rejected, where <italic>H</italic><sub>0</sub> asserts that the difference is 0 between F1 scores of <monospace>MXSCARNA</monospace> and <monospace>RNAmountAlign</monospace>—see <xref ref-type="supplementary-material" rid="pone.0227177.s004">S4 Table</xref>. Note however that the software <monospace>MXSCARNA</monospace> has slower run time than <monospace>RNAmountAlign</monospace>. Both <monospace>MXSCARNA</monospace> and <monospace>RNAmountAlign</monospace> support global and local alignment; however, unlike <monospace>MXSCARNA</monospace>, <monospace>RNAmountAlign</monospace> also supports semiglobal alignment and reports <italic>p</italic>-values. The right panel of <xref ref-type="fig" rid="pone.0227177.g004">Fig 4</xref> depicts actual run times of the fastest software, <monospace>RNAmountAlign</monospace>, with the next fastest software, <monospace>MXSCARNA</monospace> and <monospace>LARA</monospace>. Unlike the graph in the left panel, actual run times are shown, graphed as a function of sequence length, rather than logarithms of moving averages.</p>
      <p>In addition, <xref rid="pone.0227177.t004" ref-type="table">Table 4</xref> displays average pairwise global alignment F1 scores for <monospace>RNAmountAlign</monospace>, <monospace>LocARNA</monospace>, <monospace>LARA</monospace>, <monospace>FOLDALIGN</monospace>, <monospace>DYNALIGN</monospace>, <monospace>STRAL</monospace>, and <monospace>MXSCARNA</monospace> when benchmarked on 36 families from the <monospace>BRaliBase K2</monospace> database comprising altogether 8,976 RNA sequences with average length of 249.33. Averaging over all sequences, the F1 scores for the programs just mentioned were respectively 0.8370, 0.7808, 0.8406, 0.7977, 0.6822, 0.8247, 0.8402; i.e. F1 score 0.8406 of <monospace>LARA</monospace> and 0.8402 of <monospace>MXSCARNA</monospace> slightly exceeded the F1 score 0.8370 of <monospace>RNAmountAlign</monospace> and 0.8247 of <monospace>STRAL</monospace>, while other methods trailed by several percentage points. <xref ref-type="supplementary-material" rid="pone.0227177.s004">S4 Table</xref> indicates the statistical significance of difference between all 8,976 F1 scores. Morevoer, <xref ref-type="supplementary-material" rid="pone.0227177.s006">S6</xref> and <xref ref-type="supplementary-material" rid="pone.0227177.s007">S7</xref> Tables display values for global alignment sensitivity and positive predictive value, benchmarked on the same data for the same programs—these results are similar to the F1 scores in Tables <xref rid="pone.0227177.t002" ref-type="table">2</xref> and <xref rid="pone.0227177.t004" ref-type="table">4</xref>.</p>
      <p>Although there appears to be no universally accepted criterion for quality of local alignments, <xref rid="pone.0227177.t005" ref-type="table">Table 5</xref> shows pairwise local alignment comparisons for the above-mentioned methods supporting local alignment: <monospace>RNAmountAlign</monospace>, <monospace>FOLDALIGN</monospace>, and <monospace>LocARNA</monospace>. We had intended to include <monospace>SCARNA_LM</monospace> [<xref rid="pone.0227177.ref048" ref-type="bibr">48</xref>] in the benchmarking of multiple local alignment software; however, <monospace>SCARNA_LM</monospace> no longer appears to be maintained (The <monospace>SCARNA_LM</monospace> web server is no longer functional, and the authors did not respond to our request for the source code of <monospace>SCARNA_LM</monospace>). Since the reference alignments for the local benchmarking dataset are not known, and sensitivity depends upon the length of the reference alignment, we only report local alignment length and positive predictive value. Abbreviating <monospace>RNAmountAlign</monospace> by MA, <monospace>FOLDALIGN</monospace> by FA, and <monospace>LocARNA</monospace> by LOC, <xref rid="pone.0227177.t005" ref-type="table">Table 5</xref> shows average run time in seconds of MA (2.30 ± 2.12), FA (625.53 ± 2554.61), LOC (5317.96 ± 8585.19), average alignment length of reference alignments (118.67 ± 47.86), MA (50.35 ± 42.33), FA (114.86 ± 125.33), LOC (556.82 ± 227.00), and average PPV scores MA (0.53 ± 0.42), FA (0.64 ± 0.36), LOC (0.03 ± 0.04). <xref ref-type="supplementary-material" rid="pone.0227177.s005">S5 Table</xref> presents <italic>p</italic>-values for a 2-tailed paired Wilcoxon signed-rank test whether the difference in positive predictive values fo 1,500 pairwise local alignments.</p>
      <table-wrap id="pone.0227177.t005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0227177.t005</object-id>
        <label>Table 5</label>
        <caption>
          <title>Pairwise local alignment benchmarking.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0227177.t005g" xlink:href="pone.0227177.t005"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">TYPE</th>
                <th align="right" rowspan="1" colspan="1">SEED(LENGTH)</th>
                <th align="right" rowspan="1" colspan="1">MA(LENGTH)</th>
                <th align="right" rowspan="1" colspan="1">MA(PPV)</th>
                <th align="right" rowspan="1" colspan="1">MA(TIME)</th>
                <th align="right" rowspan="1" colspan="1">FA(LENGTH)</th>
                <th align="right" rowspan="1" colspan="1">FA(PPV)</th>
                <th align="right" rowspan="1" colspan="1">FA(TIME)</th>
                <th align="right" rowspan="1" colspan="1">LOC(LENGTH)</th>
                <th align="right" rowspan="1" colspan="1">LOC(PPV)</th>
                <th align="right" rowspan="1" colspan="1">LOC(TIME)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">5 8S rRNA</td>
                <td align="right" rowspan="1" colspan="1">158.48±7.40</td>
                <td align="right" rowspan="1" colspan="1">71.20±41.55</td>
                <td align="right" rowspan="1" colspan="1">0.80±0.32</td>
                <td align="right" rowspan="1" colspan="1">3.70±0.43</td>
                <td align="right" rowspan="1" colspan="1">168.33±89.23</td>
                <td align="right" rowspan="1" colspan="1">0.75±0.25</td>
                <td align="right" rowspan="1" colspan="1">509.56±411.83</td>
                <td align="right" rowspan="1" colspan="1">767.67±43.35</td>
                <td align="right" rowspan="1" colspan="1">0.01±0.03</td>
                <td align="right" rowspan="1" colspan="1">9571.39±6152.56</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">5S rRNA</td>
                <td align="right" rowspan="1" colspan="1">120.87±2.09</td>
                <td align="right" rowspan="1" colspan="1">34.79±25.44</td>
                <td align="right" rowspan="1" colspan="1">0.45±0.46</td>
                <td align="right" rowspan="1" colspan="1">1.90±0.13</td>
                <td align="right" rowspan="1" colspan="1">133.81±84.46</td>
                <td align="right" rowspan="1" colspan="1">0.65±0.34</td>
                <td align="right" rowspan="1" colspan="1">331.86±488.57</td>
                <td align="right" rowspan="1" colspan="1">584.00±23.69</td>
                <td align="right" rowspan="1" colspan="1">0.02±0.04</td>
                <td align="right" rowspan="1" colspan="1">3093.17±1934.60</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Cobalamin</td>
                <td align="right" rowspan="1" colspan="1">221.03±13.67</td>
                <td align="right" rowspan="1" colspan="1">28.60±16.77</td>
                <td align="right" rowspan="1" colspan="1">0.57±0.44</td>
                <td align="right" rowspan="1" colspan="1">7.67±1.14</td>
                <td align="right" rowspan="1" colspan="1">451.73±256.29</td>
                <td align="right" rowspan="1" colspan="1">0.22±0.28</td>
                <td align="right" rowspan="1" colspan="1">6830.15±9052.56</td>
                <td align="right" rowspan="1" colspan="1">1028.20±59.27</td>
                <td align="right" rowspan="1" colspan="1">0.02±0.02</td>
                <td align="right" rowspan="1" colspan="1">25712.40±15252.51</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Hammerhead 3</td>
                <td align="right" rowspan="1" colspan="1">64.24±11.08</td>
                <td align="right" rowspan="1" colspan="1">31.88±20.40</td>
                <td align="right" rowspan="1" colspan="1">0.38±0.42</td>
                <td align="right" rowspan="1" colspan="1">0.38±0.11</td>
                <td align="right" rowspan="1" colspan="1">36.91±31.83</td>
                <td align="right" rowspan="1" colspan="1">0.30±0.41</td>
                <td align="right" rowspan="1" colspan="1">23.95±11.81</td>
                <td align="right" rowspan="1" colspan="1">279.05±38.70</td>
                <td align="right" rowspan="1" colspan="1">0.04±0.06</td>
                <td align="right" rowspan="1" colspan="1">159.87±123.44</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">let-7</td>
                <td align="right" rowspan="1" colspan="1">85.73±3.11</td>
                <td align="right" rowspan="1" colspan="1">55.37±28.14</td>
                <td align="right" rowspan="1" colspan="1">0.75±0.22</td>
                <td align="right" rowspan="1" colspan="1">0.89±0.10</td>
                <td align="right" rowspan="1" colspan="1">72.95±27.35</td>
                <td align="right" rowspan="1" colspan="1">0.48±0.33</td>
                <td align="right" rowspan="1" colspan="1">65.51±28.66</td>
                <td align="right" rowspan="1" colspan="1">390.76±21.37</td>
                <td align="right" rowspan="1" colspan="1">0.04±0.05</td>
                <td align="right" rowspan="1" colspan="1">462.12±283.01</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Lysin</td>
                <td align="right" rowspan="1" colspan="1">193.91±13.07</td>
                <td align="right" rowspan="1" colspan="1">68.71±42.73</td>
                <td align="right" rowspan="1" colspan="1">0.30±0.33</td>
                <td align="right" rowspan="1" colspan="1">6.27±0.80</td>
                <td align="right" rowspan="1" colspan="1">163.76±104.21</td>
                <td align="right" rowspan="1" colspan="1">0.57±0.30</td>
                <td align="right" rowspan="1" colspan="1">554.25±730.12</td>
                <td align="right" rowspan="1" colspan="1">918.41±48.19</td>
                <td align="right" rowspan="1" colspan="1">0.03±0.04</td>
                <td align="right" rowspan="1" colspan="1">18690.26±10232.32</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">mir-10</td>
                <td align="right" rowspan="1" colspan="1">75.71±1.27</td>
                <td align="right" rowspan="1" colspan="1">55.09±21.97</td>
                <td align="right" rowspan="1" colspan="1">0.67±0.24</td>
                <td align="right" rowspan="1" colspan="1">0.72±0.04</td>
                <td align="right" rowspan="1" colspan="1">66.91±30.83</td>
                <td align="right" rowspan="1" colspan="1">0.48±0.36</td>
                <td align="right" rowspan="1" colspan="1">45.68±19.80</td>
                <td align="right" rowspan="1" colspan="1">358.55±15.96</td>
                <td align="right" rowspan="1" colspan="1">0.03±0.04</td>
                <td align="right" rowspan="1" colspan="1">333.63±227.10</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Purine</td>
                <td align="right" rowspan="1" colspan="1">102.01±0.93</td>
                <td align="right" rowspan="1" colspan="1">129.05±86.84</td>
                <td align="right" rowspan="1" colspan="1">0.41±0.39</td>
                <td align="right" rowspan="1" colspan="1">1.37±0.07</td>
                <td align="right" rowspan="1" colspan="1">69.80±6.70</td>
                <td align="right" rowspan="1" colspan="1">0.88±0.15</td>
                <td align="right" rowspan="1" colspan="1">87.27±30.47</td>
                <td align="right" rowspan="1" colspan="1">497.41±16.81</td>
                <td align="right" rowspan="1" colspan="1">0.03±0.05</td>
                <td align="right" rowspan="1" colspan="1">2395.40±1571.67</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">RFN element</td>
                <td align="right" rowspan="1" colspan="1">147.23±13.62</td>
                <td align="right" rowspan="1" colspan="1">44.11±24.91</td>
                <td align="right" rowspan="1" colspan="1">0.94±0.11</td>
                <td align="right" rowspan="1" colspan="1">2.83±0.56</td>
                <td align="right" rowspan="1" colspan="1">114.59±98.77</td>
                <td align="right" rowspan="1" colspan="1">0.80±0.24</td>
                <td align="right" rowspan="1" colspan="1">619.68±1289.50</td>
                <td align="right" rowspan="1" colspan="1">687.71±62.46</td>
                <td align="right" rowspan="1" colspan="1">0.03±0.05</td>
                <td align="right" rowspan="1" colspan="1">5893.83±3827.59</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">S-box leader</td>
                <td align="right" rowspan="1" colspan="1">120.13±16.14</td>
                <td align="right" rowspan="1" colspan="1">50.35±30.00</td>
                <td align="right" rowspan="1" colspan="1">0.57±0.36</td>
                <td align="right" rowspan="1" colspan="1">1.68±0.44</td>
                <td align="right" rowspan="1" colspan="1">88.72±60.79</td>
                <td align="right" rowspan="1" colspan="1">0.79±0.21</td>
                <td align="right" rowspan="1" colspan="1">190.03±493.08</td>
                <td align="right" rowspan="1" colspan="1">554.09±55.21</td>
                <td align="right" rowspan="1" colspan="1">0.03±0.04</td>
                <td align="right" rowspan="1" colspan="1">2399.58±1484.64</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SECIS</td>
                <td align="right" rowspan="1" colspan="1">68.55±2.88</td>
                <td align="right" rowspan="1" colspan="1">25.76±21.34</td>
                <td align="right" rowspan="1" colspan="1">0.05±0.19</td>
                <td align="right" rowspan="1" colspan="1">0.53±0.05</td>
                <td align="right" rowspan="1" colspan="1">54.25±53.42</td>
                <td align="right" rowspan="1" colspan="1">0.16±0.28</td>
                <td align="right" rowspan="1" colspan="1">51.07±65.81</td>
                <td align="right" rowspan="1" colspan="1">318.53±16.40</td>
                <td align="right" rowspan="1" colspan="1">0.02±0.03</td>
                <td align="right" rowspan="1" colspan="1">279.38±187.58</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SNORD113</td>
                <td align="right" rowspan="1" colspan="1">79.69±6.10</td>
                <td align="right" rowspan="1" colspan="1">40.03±23.27</td>
                <td align="right" rowspan="1" colspan="1">0.33±0.42</td>
                <td align="right" rowspan="1" colspan="1">0.75±0.07</td>
                <td align="right" rowspan="1" colspan="1">47.63±30.40</td>
                <td align="right" rowspan="1" colspan="1">0.62±0.40</td>
                <td align="right" rowspan="1" colspan="1">44.32±18.12</td>
                <td align="right" rowspan="1" colspan="1">373.69±21.77</td>
                <td align="right" rowspan="1" colspan="1">0.02±0.02</td>
                <td align="right" rowspan="1" colspan="1">641.43±421.62</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SRP bact</td>
                <td align="right" rowspan="1" colspan="1">96.20±9.99</td>
                <td align="right" rowspan="1" colspan="1">30.81±14.92</td>
                <td align="right" rowspan="1" colspan="1">0.69±0.41</td>
                <td align="right" rowspan="1" colspan="1">0.99±0.30</td>
                <td align="right" rowspan="1" colspan="1">105.08±82.04</td>
                <td align="right" rowspan="1" colspan="1">0.66±0.32</td>
                <td align="right" rowspan="1" colspan="1">225.15±336.93</td>
                <td align="right" rowspan="1" colspan="1">423.55±74.67</td>
                <td align="right" rowspan="1" colspan="1">0.02±0.04</td>
                <td align="right" rowspan="1" colspan="1">726.66±659.87</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">THI element</td>
                <td align="right" rowspan="1" colspan="1">117.20±11.95</td>
                <td align="right" rowspan="1" colspan="1">33.03±14.43</td>
                <td align="right" rowspan="1" colspan="1">0.51±0.45</td>
                <td align="right" rowspan="1" colspan="1">1.62±0.30</td>
                <td align="right" rowspan="1" colspan="1">84.45±85.58</td>
                <td align="right" rowspan="1" colspan="1">0.75±0.31</td>
                <td align="right" rowspan="1" colspan="1">253.89±352.01</td>
                <td align="right" rowspan="1" colspan="1">535.40±43.83</td>
                <td align="right" rowspan="1" colspan="1">0.02±0.02</td>
                <td align="right" rowspan="1" colspan="1">2319.39±1468.99</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">tRNA</td>
                <td align="right" rowspan="1" colspan="1">76.05±5.79</td>
                <td align="right" rowspan="1" colspan="1">37.31±45.09</td>
                <td align="right" rowspan="1" colspan="1">0.23±0.40</td>
                <td align="right" rowspan="1" colspan="1">0.70±0.09</td>
                <td align="right" rowspan="1" colspan="1">62.15±38.30</td>
                <td align="right" rowspan="1" colspan="1">0.67±0.40</td>
                <td align="right" rowspan="1" colspan="1">73.45±78.89</td>
                <td align="right" rowspan="1" colspan="1">360.29±24.06</td>
                <td align="right" rowspan="1" colspan="1">0.02±0.04</td>
                <td align="right" rowspan="1" colspan="1">479.15±265.22</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Tymo tRNA-like</td>
                <td align="right" rowspan="1" colspan="1">86.25±1.35</td>
                <td align="right" rowspan="1" colspan="1">41.27±21.96</td>
                <td align="right" rowspan="1" colspan="1">0.50±0.39</td>
                <td align="right" rowspan="1" colspan="1">0.79±0.05</td>
                <td align="right" rowspan="1" colspan="1">78.97±33.70</td>
                <td align="right" rowspan="1" colspan="1">0.76±0.21</td>
                <td align="right" rowspan="1" colspan="1">84.70±55.19</td>
                <td align="right" rowspan="1" colspan="1">409.13±14.22</td>
                <td align="right" rowspan="1" colspan="1">0.04±0.05</td>
                <td align="right" rowspan="1" colspan="1">684.12±411.97</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">U1</td>
                <td align="right" rowspan="1" colspan="1">167.16±2.58</td>
                <td align="right" rowspan="1" colspan="1">48.36±32.73</td>
                <td align="right" rowspan="1" colspan="1">0.69±0.34</td>
                <td align="right" rowspan="1" colspan="1">4.52±0.16</td>
                <td align="right" rowspan="1" colspan="1">221.36±121.42</td>
                <td align="right" rowspan="1" colspan="1">0.61±0.23</td>
                <td align="right" rowspan="1" colspan="1">1755.35±1255.41</td>
                <td align="right" rowspan="1" colspan="1">804.19±24.78</td>
                <td align="right" rowspan="1" colspan="1">0.03±0.05</td>
                <td align="right" rowspan="1" colspan="1">11142.21±6902.37</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">U4</td>
                <td align="right" rowspan="1" colspan="1">163.25±24.55</td>
                <td align="right" rowspan="1" colspan="1">50.64±27.53</td>
                <td align="right" rowspan="1" colspan="1">0.42±0.41</td>
                <td align="right" rowspan="1" colspan="1">3.72±1.30</td>
                <td align="right" rowspan="1" colspan="1">91.75±41.17</td>
                <td align="right" rowspan="1" colspan="1">0.79±0.20</td>
                <td align="right" rowspan="1" colspan="1">263.51±140.53</td>
                <td align="right" rowspan="1" colspan="1">742.17±84.30</td>
                <td align="right" rowspan="1" colspan="1">0.02±0.03</td>
                <td align="right" rowspan="1" colspan="1">9361.29±5839.12</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">UnaL2</td>
                <td align="right" rowspan="1" colspan="1">54.25±0.66</td>
                <td align="right" rowspan="1" colspan="1">48.80±25.71</td>
                <td align="right" rowspan="1" colspan="1">0.70±0.40</td>
                <td align="right" rowspan="1" colspan="1">0.36±0.01</td>
                <td align="right" rowspan="1" colspan="1">36.11±3.30</td>
                <td align="right" rowspan="1" colspan="1">0.99±0.04</td>
                <td align="right" rowspan="1" colspan="1">23.05±8.38</td>
                <td align="right" rowspan="1" colspan="1">263.79±8.94</td>
                <td align="right" rowspan="1" colspan="1">0.03±0.06</td>
                <td align="right" rowspan="1" colspan="1">171.59±104.10</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ykoK</td>
                <td align="right" rowspan="1" colspan="1">175.39±7.32</td>
                <td align="right" rowspan="1" colspan="1">82.05±58.19</td>
                <td align="right" rowspan="1" colspan="1">0.68±0.36</td>
                <td align="right" rowspan="1" colspan="1">4.67±0.45</td>
                <td align="right" rowspan="1" colspan="1">147.55±69.66</td>
                <td align="right" rowspan="1" colspan="1">0.81±0.20</td>
                <td align="right" rowspan="1" colspan="1">472.79±583.01</td>
                <td align="right" rowspan="1" colspan="1">844.27±31.56</td>
                <td align="right" rowspan="1" colspan="1">0.03±0.05</td>
                <td align="right" rowspan="1" colspan="1">12019.33±6178.91</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ykoK</td>
                <td align="right" rowspan="1" colspan="1">144.26±63.44</td>
                <td align="right" rowspan="1" colspan="1">81.06±54.94</td>
                <td align="right" rowspan="1" colspan="1">0.65±0.38</td>
                <td align="right" rowspan="1" colspan="1">4.74±0.45</td>
                <td align="right" rowspan="1" colspan="1">144.26±63.44</td>
                <td align="right" rowspan="1" colspan="1">0.81±0.20</td>
                <td align="right" rowspan="1" colspan="1">449.03±526.67</td>
                <td align="right" rowspan="1" colspan="1">482.97±27.04</td>
                <td align="right" rowspan="1" colspan="1">0.00±0.00</td>
                <td align="right" rowspan="1" colspan="1">12693.37±7330.66</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Pooled Average</td>
                <td align="right" rowspan="1" colspan="1">118.67±47.86</td>
                <td align="right" rowspan="1" colspan="1">50.35±42.33</td>
                <td align="right" rowspan="1" colspan="1">0.53±0.42</td>
                <td align="right" rowspan="1" colspan="1">2.30±2.12</td>
                <td align="right" rowspan="1" colspan="1">114.86±125.33</td>
                <td align="right" rowspan="1" colspan="1">0.64±0.36</td>
                <td align="right" rowspan="1" colspan="1">625.53±2554.61</td>
                <td align="right" rowspan="1" colspan="1">556.82±227.00</td>
                <td align="right" rowspan="1" colspan="1">0.03±0.04</td>
                <td align="right" rowspan="1" colspan="1">5317.96±8585.19</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="t005fn001">
            <p>Comparison of alignment length and positive predictive value (PPV) for <italic>pairwise local alignment</italic> by <monospace>RNAmountAlign</monospace> against the widely used local alignment software <monospace>FOLDALIGN</monospace> and <monospace>LocARNA</monospace>. Local alignment benchmarking was performed on 1500 pairwise alignments (75 alignments per family, 21 Rfam families) extracted from the Rfam 12.0 database [<xref rid="pone.0227177.ref034" ref-type="bibr">34</xref>], and prepared in a manner analogous to that of the dataset used in benchmarking <italic>multiple</italic> local alignment in [<xref rid="pone.0227177.ref048" ref-type="bibr">48</xref>]—see text for details. The 21 Rfam families are: RF00001, RF00002, RF00003, RF00004, RF00005, RF00008, RF00015, RF00027, RF00031, RF00050, RF00059, RF00104, RF00162, RF00167, RF00168, RF00169, RF00174, RF00181, RF00233, RF00380, RF00436. Parameters used in <xref ref-type="disp-formula" rid="pone.0227177.e035">Eq (17)</xref> of the main text for <monospace>RNAmountAlign</monospace> were structural similarity weight <italic>γ</italic> = 1/2, gap initiation <italic>g</italic><sub><italic>i</italic></sub> = −3, gap extension <italic>g</italic><sub><italic>e</italic></sub> = −1; since reference alignments were required to have at most 70% sequence identity, nucleotide similarity matrix RIBOSUM8570-25 was used in <monospace>RNAmountAlign</monospace>.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>Taken together, these results suggest that <monospace>RNAmountAlign</monospace> has comparable accuracy, but much faster run time, hence making it a potentially useful tool for genome processing applications. Here it should be stressed that all benchmarking results used equally weighted contributions of sequence and ensemble structural similarity; i.e. parameter <italic>γ</italic> = 1/2 when computing similarity by <xref ref-type="disp-formula" rid="pone.0227177.e035">Eq (17)</xref>.</p>
    </sec>
    <sec id="sec017">
      <title>Statistics for pairwise alignment</title>
      <p><xref ref-type="fig" rid="pone.0227177.g005">Fig 5</xref> shows fits of the relative frequency histogram of alignment scores with the normal (ND), extreme value (EVD) and gamma (GD) distributions, where local, semiglobal and global alignment scores are shown in panels from left to right. The EVD provides the best fit for local alignment sequence-structure similarity scores, as expected by Karlin-Altschul theory [<xref rid="pone.0227177.ref012" ref-type="bibr">12</xref>, <xref rid="pone.0227177.ref013" ref-type="bibr">13</xref>]. Moreover, <xref ref-type="fig" rid="pone.0227177.g006">Fig 6</xref> shows a 96% correlation between (expect) E-values computed by our implementation of the Karlin-Altschul method, and E-values obtained by EVD fitting of local alignment scores. In contrast, the ND provides the best fit for semiglobal sequence/structure alignment similarity scores, at least for the sequence considered in <xref ref-type="fig" rid="pone.0227177.g005">Fig 5</xref>. This is not an isolated phenomenon, as shown in <xref ref-type="fig" rid="pone.0227177.g006">Fig 6</xref>, which depicts scatter plots, Pearson correlation values and sums of squared residuals (SSRs) when computing <italic>p</italic>-values for semiglobal alignment scores between Rfam sequences and random RNA. As explained earlier, a pool of 2220 sequences from the Rfam 12.0 database [<xref rid="pone.0227177.ref034" ref-type="bibr">34</xref>] was created by selecting one sequence of length at most 200 nt from each family, with the property that base pair distance between its minimum free energy (MFE) structure and the Rfam consensus structure was a minimum. Then 500 sequences were randomly selected from this pool, and for each of five gap initiation and extension costs <italic>g</italic><sub><italic>i</italic></sub> = −5, −4, −3, −2, −1 with <inline-formula id="pone.0227177.e096"><alternatives><graphic xlink:href="pone.0227177.e096.jpg" id="pone.0227177.e096g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M96"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mn>3</mml:mn></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>. Taking each of the 500 sequences successively as query sequence and for each choice of parameters, 1000 random 400 nt RNAs were generated with the same expected nucleotide relative frequency as that of the query. For each alignment score <italic>z</italic> for query and random target, the <italic>p</italic>-value was computed as 1 minus the cumulative density function, 1 − <italic>CDF</italic>(<italic>z</italic>), for fitted normal (ND), extreme value (EVD) and gamma (GD) distributions, thus defining 1000 <italic>p</italic>-values. Additionally, a heuristic <italic>p</italic>-value was determined by calculating the proportion of alignment scores for given query that exceed <italic>z</italic>. For each set of 2.5 million (500 × 5 × 1000) <italic>p</italic>-values (heuristic, ND, EVD, GD), Pearson correlation values were computed and displayed in the upper triangular portion of <xref ref-type="fig" rid="pone.0227177.g006">Fig 6</xref>, with SSRs shown in parentheses. Note that residuals were computed for regression equation row = <italic>m</italic> ⋅ column + <italic>b</italic>, where column values constitute the independent variable. Assuming that heuristic <italic>p</italic>-values constitute the reference standard, it follows that <italic>p</italic>-values computed from the normal distribution correlate best with semiglobal alignment scores computed by <monospace>RNAmountAlign</monospace>. Earlier studies have suggested that protein global alignment similarity scores using PAM120, PAM250, BLOSUM50, and BLOSUM62 matrices appear to be fit best by the gamma distribution (GD) [<xref rid="pone.0227177.ref049" ref-type="bibr">49</xref>], and that semiglobal RNA sequence alignment similarity scores (with no contribution from structure) appear to be best fit by GD [<xref rid="pone.0227177.ref050" ref-type="bibr">50</xref>]. However, in our preliminary studies (not shown), it appears that the type of distribution (ND, EVD, GD) that best fits <monospace>RNAmountAlign</monospace> semiglobal alignment depends on the gap costs applied (indeed, for certain choices, EVD provides the best fit). Since there is no mathematical theory concerning alignment score distribution for global or semiglobal alignments, it must be up to the user to decide which distribution provides the most reasonable <italic>p</italic>-values.</p>
      <fig id="pone.0227177.g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0227177.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Relative frequency histograms of alignment scores for <italic>local</italic> (left), <italic>semiglobal</italic> (middle) and <italic>global</italic> (right) alignments of random RNAs produced by <monospace>RNAmountAlign</monospace>.</title>
          <p>For the 5S rRNA AY544430.1:375-465 from the Rfam 12.0 database having nucleotide relative frequencies <italic>p</italic><sub><italic>A</italic></sub> = 0.25, <italic>p</italic><sub><italic>C</italic></sub> = 0.27, <italic>p</italic><sub><italic>G</italic></sub> = 0.26, <italic>p</italic><sub><italic>U</italic></sub> = 0.21, we generated 10,000 random sequences having the same nucleotide relative frequencies, each of length 400 nt. For each method (local, semiglobal, global), <monospace>RNAmountAlign</monospace> was run using default parameters to determine the optimal pairwise alignment score, when aligning the 5S rRNA with each random RNA, thus producing relative frequency histograms which were subsequently fit by the normal distribution (ND), extreme value distribution (EVD) and gamma distribution (GD). As expected by Karlin-Altschul theory [<xref rid="pone.0227177.ref012" ref-type="bibr">12</xref>], local alignment scores are best fit by EVD, while semiglobal alignment scores are best fit by ND. Our conclusions of the best fitting distributions were additionally supported by d computations of variation distance, symmetrized Kullback-Leibler distance, and <italic>χ</italic><sup>2</sup> goodness-of-fit tests (data not shown).</p>
        </caption>
        <graphic xlink:href="pone.0227177.g005"/>
      </fig>
      <fig id="pone.0227177.g006" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0227177.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <p>(<bold>Left</bold>) Pearson correlation values and scatter plots for <italic>p</italic>-values of <italic>semiglobal alignment</italic> scores between Rfam sequences and random RNAs. For 500 Rfam sequences, 1000 random semiglobal alignments were computed for 5 different gap penalties yielding the total of 2.5 million alignment scores. For each score a <italic>p</italic>-value is computed assuming Normal (ND), Gamma (GD) and Extreme Value (EVD) distributions in order to investigate which distribution is closest to the heuristic <italic>p</italic>-value, that is assumed to be the gold standard. Heuristic <italic>p</italic>-value for score <italic>z</italic> is determined by the proportion of alignment scores that exceed <italic>z</italic>. For all 2.5 million <italic>p</italic>-values, pairwise Pearson correlation values were computed and displayed in the upper triangular portion of the figure, with sums of squared residuals shown in parentheses, and histograms of <italic>p</italic>-values along the diagonal. It follows that ND <italic>p</italic>-values correlate best with heuristic <italic>p</italic>-values. (<bold>Right</bold>) Scatter plot of E-values computed by EVD fitting, <italic>E</italic><sub>EVD</sub>, as well as our implementation of the Karlin-Altschul, <italic>E</italic><sub>KA</sub>, for <italic>pairwise local</italic> alignments. The regression equation is <italic>E</italic><sub>EVD</sub> = 0.1764 + 0.7991 · <italic>E</italic><sub>KA</sub>; Pearson correlation between <italic>E</italic><sub>EVD</sub> and <italic>E</italic><sub>KA</sub> is 96%, with correlation <italic>p</italic>-value of 2 ⋅ 10<sup>−16</sup> indicating that <italic>p</italic>-values obtained from these two methods are in well agreement. E-values were determined from local alignment scores computed by the genome scanning form of <monospace>RNAmountAlign</monospace> with query tRNA AB031215.1/9125-9195 and targets consisting of 300 nt windows from <italic>E. coli str. K-12</italic> MG1655 with GenBank accession code NC_000913.</p>
        </caption>
        <graphic xlink:href="pone.0227177.g006"/>
      </fig>
    </sec>
    <sec id="sec018">
      <title>Multiple alignment</title>
      <p>We benchmarked <monospace>RNAmountAlign</monospace> with the software <monospace>LARA</monospace>, <monospace>mLocARNA</monospace>, <monospace>FOLDALIGNM</monospace>, <monospace>Multilign</monospace>, <monospace>MXSCARNA</monospace>, and sequence only <monospace>MUSCLE</monospace> for <italic>multiple global</italic> K5 alignments in <monospace>BRAliBase 2.1</monospace>. <monospace>STRAL</monospace> is not included since the source code could not be compiled. <xref ref-type="fig" rid="pone.0227177.g007">Fig 7</xref> indicates average SPS and SCI as a function of average pairwise sequence identity (APSI). We used the <monospace>-sci</monospace> flag of <monospace>RNAalifold</monospace> to compute SCI from the output of each software without reference to the reference alignment. <xref ref-type="fig" rid="pone.0227177.g007">Fig 7</xref> indicates that SCI values for outputs from various alignment algorithms is higher than the SCI value from reference alignments, suggesting that the consensus structure obtained from sequence/structure alignment algorithms has a larger number of base pairs than the the consensus structure obtained from reference alignments (this phenomenon was also in [<xref rid="pone.0227177.ref051" ref-type="bibr">51</xref>]). <xref ref-type="fig" rid="pone.0227177.g007">Fig 7</xref> indicates that <monospace>RNAmountAlign</monospace> produces SPS scores comparable to <monospace>mLocARNA</monospace>, <monospace>LARA</monospace> and <monospace>MXSCARNA</monospace>, and higher than <monospace>Multilign</monospace> and <monospace>FOLDALIGNM</monospace> while the SCI score obtained from <monospace>RNAmountAlign</monospace> are lower than other software. Averaging over all sequences, the SPS scores for <monospace>RNAmountAlign</monospace>, <monospace>LARA</monospace>, <monospace>mLocARNA</monospace>, <monospace>FOLDALIGNM</monospace>, <monospace>Multilign</monospace>, <monospace>MXSCARNA</monospace>, and <monospace>MUSCLE</monospace> were respectively: 0.81 ± 0.18, 0.85 ± 0.15, 0.86 ± 0.15, 0.74 ± 0.24, 0.63 ± 0.17, 0.84 ± 0.15, and 0.82 ± 0.17, while SCI scores are respectively: 0.84 ± 0.24, 0.92 ± 0.22, 0.96 ± 0.21, 0.88 ± 0.23, 0.96 ± 0.21, 0.91 ± 0.20, and 0.79 ± 0.26. SPS score for each reference alignments is 1 by definition, and average SCI score over all reference alignments is 0.79 ± 0.26. <xref ref-type="fig" rid="pone.0227177.g008">Fig 8</xref> indicates software run time in seconds on a logarithmic scale. This figure clearly shows that <monospace>RNAmountAlign</monospace> has faster run time than all other structural alignment software in our benchmarking tests, thus confirming the earlier result from pairwise benchmarking.</p>
      <fig id="pone.0227177.g007" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0227177.g007</object-id>
        <label>Fig 7</label>
        <caption>
          <title>Sum-of-pairs (SPS) score (left) and structural conservation index (SCI) (right) for <italic>multiple global alignments</italic> using <monospace>RNAmountAlign</monospace>, <monospace>LARA</monospace>, <monospace>mLocARNA</monospace>, <monospace>FoldalignM</monospace>, <monospace>Multilign</monospace>, <monospace>MXSCARNA</monospace> and <monospace>MUSCLE</monospace>.</title>
          <p>SPS and SCI are shown as a function of average pairwise sequence identity(APSI). The k5 <monospace>BRAliBase 2.1</monospace> database was used for benchmarking. Moving averages taken for centered, symmetric windows of size 11.</p>
        </caption>
        <graphic xlink:href="pone.0227177.g007"/>
      </fig>
      <fig id="pone.0227177.g008" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0227177.g008</object-id>
        <label>Fig 8</label>
        <caption>
          <title>Run time of <italic>multiple global alignment</italic> for <monospace>RNAmountAlign</monospace>, <monospace>mLocARNA</monospace>, <monospace>LARA</monospace>, <monospace>FoldalignM</monospace>, <monospace>Multilign</monospace>, <monospace>MXSCARNA</monospace> and <monospace>MUSCLE</monospace>.</title>
          <p>Log run time is as shown a function of reference alignment length for K5 alignments in <monospace>BRAliBase 2.1</monospace>. For the structural <italic>multiple alignment</italic> algorithms benchmarked on this data, <monospace>RNAmountAlign</monospace> and <monospace>MXSCARNA</monospace> both appear to have the fastest runtime, while <monospace>RNAmountAlign</monospace> is faster than <monospace>MXSCARNA</monospace> for <italic>pairwise</italic> alignment.</p>
        </caption>
        <graphic xlink:href="pone.0227177.g008"/>
      </fig>
    </sec>
    <sec id="sec019">
      <title>Query scan</title>
      <p>We developed an extension of <monospace>RNAmountAlign</monospace>, called <monospace>RNAmountAlignScan</monospace>, which scans a target genome sequence to find hits having high sequence and structural similarity to a given query sequence. <monospace>RNAmountAlignScan</monospace> functions by computing optimal semiglobal alignments of the query to sliding windows of the target, then returns the aligned target segments sorted by <italic>p</italic>-value. For a query of length <italic>n</italic>, target genome of length <italic>m</italic>, window size <italic>w</italic> &gt; <italic>n</italic>, and window step size of <italic>s</italic>, a total of <inline-formula id="pone.0227177.e097"><alternatives><graphic xlink:href="pone.0227177.e097.jpg" id="pone.0227177.e097g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M97"><mml:mfrac><mml:mi>m</mml:mi><mml:mi>s</mml:mi></mml:mfrac></mml:math></alternatives></inline-formula> many semiglobal alignments must be computed, making the total run time of <monospace>RNAmountAlignScan</monospace>
<inline-formula id="pone.0227177.e098"><alternatives><graphic xlink:href="pone.0227177.e098.jpg" id="pone.0227177.e098g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M98"><mml:mrow><mml:mi>O</mml:mi><mml:mo>(</mml:mo><mml:mfrac><mml:mi>m</mml:mi><mml:mi>s</mml:mi></mml:mfrac><mml:msup><mml:mi>w</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. In order to show the utility of <monospace>RNAmountAlignScan</monospace>, we compared it with <monospace>RSEARCH</monospace> [<xref rid="pone.0227177.ref030" ref-type="bibr">30</xref>], <monospace>FOLDALIGN</monospace> and <monospace>RNAmountAlignScan</monospace>
<italic>sequence-only</italic> where only sequence homology is considered. <monospace>RSEARCH</monospace> takes a single query sequence with its secondary structure and performs local alignment with the target genome, in order to search for homologous RNA. For our comparison, we used the query sequence from <xref ref-type="fig" rid="pone.0227177.g006">Fig 6</xref>, a 71 nt tRNA from Rfam 12.0, selected with the property that the base pair distance between its MFE structure and its Rfam consensus structure is a minimum compared with other tRNAs from Rfam 12.0. As target genome, we used the <italic>E. coli</italic> K12 MG1655 genome having 4, 641, 652 nt. Since <monospace>tRNAscan-SE</monospace> [<xref rid="pone.0227177.ref052" ref-type="bibr">52</xref>] is generally considered to be the gold standard in tRNA prediction, we measured accuracy of the software by the amount of overlap between returned predictions and predicted tRNAs according to <monospace>tRNAscan-SE</monospace>. <monospace>tRNAscan-SE</monospace> found 49 full tRNA sequences on the forward strand and 37 on the reverse strand. Default parameters of each software package were used to search the query in the forward strand of <italic>E. coli</italic> genome (see <xref ref-type="supplementary-material" rid="pone.0227177.s003">S3 Table</xref>); in the case of <monospace>RNAmountAlignScan</monospace> this means gap initiation of −3, gap extension of −1, and sequence/structure weighting parameter <italic>γ</italic> = 0.5. <monospace>RNAmountAlignScan</monospace> was also used to scan the <italic>E. coli</italic> genome using sequence-only semiglobal alignments, in which gap parameters were unchanged, but with <italic>γ</italic> = 0. Genome scanning was performed using windows of 300 nt, with step size 200, thus ensuring an overlap of 100 nt between target segments—this resulted in a total of 23, 209 semiglobal alignments. We also tested <monospace>FOLDALIGN</monospace>, which provides an option to scan two sequences and return the best local alignment score for each pair of positions in the two sequences. The output from <monospace>FOLDALIGN</monospace> with this option then requires subsequent postprocessing using the <monospace>LocateHits</monospace> script included in <monospace>FOLDALIGN</monospace> in order to generate a list of non-overlapping local alignments. For the query tRNA described above, <monospace>FOLDALIGN</monospace> could not process the <italic>E. coli</italic> genome, and instead produced memory errors. There is a newly developed, specialized form of <monospace>FOLDALIGN</monospace>, called “Foldalign version 2.5.1_long_sequences” that we recently learned of from Jakob Havgaard through personal communication and can process long RNA sequences (of more than 30,000 nt) without such memory errors. <xref ref-type="fig" rid="pone.0227177.g009">Fig 9</xref> indicates the precision-recall plot for the top 49 and 37 tRNA predictions on the forward and reverse strands, respectively. <monospace>RSEARCH</monospace> is not shown in the plot because it reported 89 hits, none of which had any overlap with tRNAs predicted by <monospace>tRNAscan-SE</monospace> and thus its sensitivity and PPV are equal to zero. Sequence length of the predictions returned by <monospace>RSEARCH</monospace> was 11.73 ± 0.58. For calculation of PPV as a function of sensitivity, for each of the three methods on each strand, we sorted the predictions in descending order by <italic>p</italic>-value. Given the <italic>i</italic>-th prediction, we determined the number of predictions preceding the current <italic>i</italic>-th prediction (including the <italic>i</italic>-th), and calculated the number of true positives in that collection then divided this number by 49 for positive or 37 for reverse strands to obtain sensitivity. True positives are predictions with <italic>overlap proportion</italic> of greater than 0.8 to any of the <monospace>tRNAscan-SE</monospace> sequences. The overlap proportion between predictions and <monospace>tRNAscan-SE</monospace> is defined as the ratio |<italic>A</italic> ∩ <italic>B</italic>|/|<italic>B</italic>|, where <italic>A</italic> is a tRNA predicted by each software and <italic>B</italic> is a tRNA detected by <monospace>tRNAscan-SE</monospace>, the latter assumed to be the gold standard. <monospace>FOLDALIGN</monospace> with area under the curve of 0.90 and 0.64 for forward and reverse strands outperforms <monospace>RNAmountAlignScan</monospace> with 0.27 and 0.28 and <italic>sequence-only</italic> with 0.08 and 0.16. However, only one the <monospace>FOLDALIGN</monospace> predictions on each strand had <italic>p</italic>-value less than 0.1 while <monospace>RNAmountAlignScan</monospace> reported significant <italic>p</italic>-values for all of the true positives <xref ref-type="fig" rid="pone.0227177.g009">Fig 9</xref>. Moreover, <monospace>FOLDALIGN</monospace> finished in 12.06 hours while run time of <monospace>RNAmountAlign</monospace> was 1.63.</p>
      <fig id="pone.0227177.g009" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0227177.g009</object-id>
        <label>Fig 9</label>
        <caption>
          <p>(<bold>A</bold>) PPV-sensitivity (precision-recall) plot for tRNA query scan in <italic>E. coli</italic> genome. Measures are computed for the top 49 and 37 tRNA predictions in forward (<italic>left</italic>) and reverse (<italic>right</italic>) strands of <italic>E. coli</italic> genome, respectively. Since <monospace>RSEARCH</monospace> had no true positives and thus zero sensitivity and PPV, it is not shown here. <bold>(B)</bold> The predicted <italic>p</italic>-values of the top predictions for each software in forward (<italic>left</italic>) and reverse (<italic>right</italic>) strands.</p>
        </caption>
        <graphic xlink:href="pone.0227177.g009"/>
      </fig>
      <p><xref ref-type="fig" rid="pone.0227177.g010">Fig 10</xref> depicts the sequence and MFE structure of the first <italic>false positive</italic> of <monospace>RNAmountAlignScan</monospace>; i.e. that prediction having statistically significant sequence and structural similarity to the query tRNA, but which shares no overlap with a tRNA predicted by <monospace>tRNAscan-SE</monospace>. This prediction has 42% sequence identity to the query tRNA, and its MFE forms a cloverleaf secondary structure. In contrast to all other benchmarking computations of this paper, due to the memory requirements for genome scanning mode, each program for query search was run on a 24-processor Intel Xeon CPU E5-2440 2.40 GHz system with 198GB memory. The commands to run the software are given in <xref ref-type="supplementary-material" rid="pone.0227177.s003">S3 Table</xref>. Run time for <monospace>FOLDALIGN</monospace>, <monospace>RNAmountAlignScan</monospace>, and <monospace>RSEARCH</monospace> were respectively 12.06, 1.63, and 0.62 hours and memory usage were 0.57, 20.61 and 0.49 Gigabytes. The number of random RNAs used for <italic>p</italic>-value computation in both <monospace>RSEARCH</monospace> and <monospace>RNAmountAlignScan</monospace> was 1000, and both used the RIBOSUM 85-60 matrix. The outputs of all the program are available at <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.bc.edu/clotelab/RNAmountAlign/">http://bioinformatics.bc.edu/clotelab/RNAmountAlign/</ext-link>.</p>
      <fig id="pone.0227177.g010" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0227177.g010</object-id>
        <label>Fig 10</label>
        <caption>
          <title>The MFE secondary structure of an <italic>E. coli</italic> segment which is predicted to be a tRNA by <monospace>RNAmountAlignScan</monospace> and not by <monospace>tRNAscan-SE</monospace>.</title>
          <p>Two flanking nucleotides on both ends are added to the hit sequence. The structure is color-coded by base pairing probability generated by <monospace>RNAfold</monospace> web server, where red [resp. blue] base pairs (<italic>i</italic>, <italic>j</italic>) have base pairing probability <italic>p</italic><sub><italic>i</italic>,<italic>j</italic></sub> ≈ 1 [resp. <italic>p</italic><sub><italic>i</italic>,<italic>j</italic></sub> ≈ 0].</p>
        </caption>
        <graphic xlink:href="pone.0227177.g010"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec020">
    <title>Conclusion</title>
    <p><monospace>RNAmountAlign</monospace> is a new <monospace>C++</monospace> software package for RNA local, global, and semiglobal sequence/structure alignment, which provides accuracy comparable with that of a number of widely used programs, but provides much faster run time. <monospace>RNAmountAlign</monospace> additionally computes E-values for local alignments, using Karlin-Altschul statistics, as well as <italic>p</italic>-values for normal, extreme value and gamma distributions by parameter fitting.</p>
  </sec>
  <sec sec-type="supplementary-material" id="sec021">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pone.0227177.s001">
      <label>S1 Table</label>
      <caption>
        <title>Commands used for benchmarking various software packages for global alignment.</title>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pone.0227177.s001.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0227177.s002">
      <label>S2 Table</label>
      <caption>
        <title>Commands used for benchmarking various software packages for local alignment.</title>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pone.0227177.s002.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0227177.s003">
      <label>S3 Table</label>
      <caption>
        <title>Commands used for benchmarking software packages for query scan.</title>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pone.0227177.s003.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0227177.s004">
      <label>S4 Table</label>
      <caption>
        <title><italic>p</italic>-values from two-tailed paired Wilcoxon signed rank test of all 8,976 F1 scores for pairwise global alignments indicated in <xref rid="pone.0227177.t004" ref-type="table">Table 4</xref> of the main text.</title>
        <p>Tables of <italic>p</italic>-values computed separately for each family are available at <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.bc.edu/clotelab/RNAmountAlign">http://bioinformatics.bc.edu/clotelab/RNAmountAlign</ext-link>.</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pone.0227177.s004.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0227177.s005">
      <label>S5 Table</label>
      <caption>
        <title><italic>p</italic>-values from two-tailed paired Wilcoxon signed rank test of all 1500 positive predictive values for pairwise local alignments indicated in <xref rid="pone.0227177.t005" ref-type="table">Table 5</xref> of the main text.</title>
        <p>Tables of <italic>p</italic>-values computed separately for each family are available at <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.bc.edu/clotelab/RNAmountAlign">http://bioinformatics.bc.edu/clotelab/RNAmountAlign</ext-link>.</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pone.0227177.s005.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0227177.s006">
      <label>S6 Table</label>
      <caption>
        <title>Average sensitivity scores (± one standard deviation) for <italic>pairwise global alignment</italic> of <monospace>RNAmountAlign</monospace> and four widely used RNA sequence/structure alignment algorithms on the benchmarking set of 8,976 pairwise alignments from the <monospace>BRaliBase K2</monospace> database [<xref rid="pone.0227177.ref038" ref-type="bibr">38</xref>].</title>
        <p>For each indicated Rfam family, the the number of alignments (NumAln), sequence identity (SeqId), and sensitivity scores for <monospace>RNAmountAlign</monospace>, <monospace>LocARNA</monospace>, <monospace>LARA</monospace>, <monospace>FOLDALIGN</monospace>, <monospace>DYNALIGN</monospace>, <monospace>STRAL</monospace> and <monospace>MXSCARNA</monospace> are listed, along with pooled averages over all 8,976 pairwise alignments. Parameters used in <xref ref-type="disp-formula" rid="pone.0227177.e035">Eq (17)</xref> of the main text for <monospace>RNAmountAlign</monospace> were similarity matrix RIBOSUM85-60, structural similarity weight <italic>γ</italic> = 1/2, gap initiation <italic>g</italic><sub><italic>i</italic></sub> = −3, gap extension <italic>g</italic><sub><italic>e</italic></sub> = −1.</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pone.0227177.s006.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0227177.s007">
      <label>S7 Table</label>
      <caption>
        <title>Average positive predictive value (PPV) scores (± one standard deviation) for <italic>pairwise global</italic> alignment of <monospace>RNAmountAlign</monospace> and four widely used RNA sequence/structure alignment algorithms on the benchmarking set of 8,976 pairwise alignments from the <monospace>BRaliBase K2</monospace> database [<xref rid="pone.0227177.ref038" ref-type="bibr">38</xref>].</title>
        <p>For each indicated Rfam family, the the number of alignments (NumAln), sequence identity (SeqId), and PPV-scores for <monospace>RNAmountAlign</monospace>, <monospace>LocARNA</monospace>, <monospace>LARA</monospace>, <monospace>FOLDALIGN</monospace>, <monospace>DYNALIGN</monospace>, <monospace>STRAL</monospace> and <monospace>MXSCARNA</monospace> are listed, along with Pooled averages over all 8,976 pairwise alignments. Parameters used in <xref ref-type="disp-formula" rid="pone.0227177.e035">Eq (17)</xref> of the main text for <monospace>RNAmountAlign</monospace> were similarity matrix RIBOSUM85-60, structural similarity weight <italic>γ</italic> = 1/2, gap initiation <italic>g</italic><sub><italic>i</italic></sub> = −3, gap extension <italic>g</italic><sub><italic>e</italic></sub> = −1.</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pone.0227177.s007.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0227177.s008">
      <label>S8 Table</label>
      <caption>
        <title>Initial portion of a table that determines expected base pairing probabilities <italic>p</italic><sub><monospace>(</monospace></sub>, <italic>p</italic><sub>•</sub>, <italic>p</italic><sub><monospace>)</monospace></sub> as a function of nucleotide probabilities <italic>p<sub>A</sub></italic>, <italic>p<sub>C</sub></italic>, <italic>p<sub>G</sub></italic>, <italic>p<sub>U</sub></italic>.</title>
        <p>The full table (not shown) has 1770 rows. To determine average base pairing probabilities, given nucleotide probabilities <italic>p<sub>A</sub></italic>, <italic>p<sub>C</sub></italic>, <italic>p<sub>G</sub></italic>, <italic>p<sub>U</sub></italic>, a total of <italic>N</italic> = 10000 RNA sequences of length <italic>n</italic> = 200 were randomly generated to have the given expected nucleotide frequency. To compute <italic>p</italic><sub><monospace>(</monospace></sub> [resp. <italic>std</italic><sub><monospace>(</monospace></sub>], a library call of function <monospace>pf_fold()</monospace> from Vienna RNA Package [<xref rid="pone.0227177.ref004" ref-type="bibr">4</xref>] was made in order to determine <inline-formula id="pone.0227177.e099"><alternatives><graphic xlink:href="pone.0227177.e099.jpg" id="pone.0227177.e099g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M99"><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mspace width="4.pt"/><mml:mtext>pairs</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>to</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>right</mml:mtext><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> for position in each sequence, and the average [resp. standard deviation] was taken over all sequences and values <italic>i</italic> = 1, …, <italic>n</italic>. In a similar fashion, <italic>p</italic><sub>•</sub> and <italic>p</italic><sub><monospace>)</monospace></sub> were determined.</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pone.0227177.s008.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0227177.s009">
      <label>S1 Fig</label>
      <caption>
        <title>Consensus structure for the pairwise alignment indicated in <xref ref-type="fig" rid="pone.0227177.g001">Fig 1</xref> of the main text.</title>
        <p>The consensus structure is computed by a calling function <monospace>alifold()</monospace> from Vienna RNA Package. The figure is obtained from <monospace>RNAalifold</monospace> web server.</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pone.0227177.s009.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0227177.s010">
      <label>S2 Fig</label>
      <caption>
        <title>F1-score for <monospace>RNAmountAlign</monospace>, <monospace>LocARNA</monospace>, <monospace>LARA</monospace>, <monospace>FOLDALIGN</monospace>, <monospace>DYNALIGN</monospace>, <monospace>STRAL</monospace>, <monospace>MXSCARNA</monospace> and sequence-only alignments(<italic>γ</italic> = 0) for <italic>pairwise global alignment</italic>.</title>
        <p>Moving averages of F1-score for centered, symmetric windows of size 11 are shown as a function of sequence identity for pairwise alignments in the <monospace>BRAliBase 2.1</monospace> database used for benchmarking. Moving averages taken for centered, symmetric windows of size 11.</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pone.0227177.s010.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0227177.s011">
      <label>S3 Fig</label>
      <caption>
        <title>Average sensitivity (Sen) and positive predictive value (PPV) for <monospace>RNAmountAlign</monospace>, <monospace>LocARNA</monospace>, <monospace>LARA</monospace>, <monospace>FOLDALIGN</monospace>, <monospace>DYNALIGN</monospace>, <monospace>STRAL</monospace>, <monospace>MXSCARNA</monospace> and sequence-only alignments (<italic>γ</italic> = 0) for <italic>pairwise global alignment</italic>.</title>
        <p>Sensitivity is shown as a function of sequence identity for pairwise alignments in the <monospace>BRAliBase 2.1</monospace> database used for benchmarking. Moving averages taken for centered, symmetric windows of size 11.</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pone.0227177.s011.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0227177.s012">
      <label>S4 Fig</label>
      <caption>
        <title>Average pairwise sensitivity (left) and positive predictive value (right) for <italic>multiple global alignments</italic> using <monospace>RNAmountAlign</monospace>, <monospace>LARA</monospace>, <monospace>mLocARNA</monospace>, <monospace>FoldalignM</monospace> and <monospace>Multilign</monospace> in the k5 <monospace>BRAliBase 2.1</monospace> database used for benchmarking.</title>
        <p>Note that in our definition of <italic>Sen</italic> and <italic>PPV</italic>, pairs of the form (<italic>X</italic>, —) and (—, <italic>X</italic>) are also counted while SPS is the average pairwise sensitivity only considering aligned residue pairs (<xref ref-type="fig" rid="pone.0227177.g007">Fig 7</xref>). However, the results with and without gap counts, indicated in this figure and <xref ref-type="fig" rid="pone.0227177.g007">Fig 7</xref>, respectively, are very close. Moving averages taken for centered, symmetric windows of size 11.</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pone.0227177.s012.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0227177.s013">
      <label>S5 Fig</label>
      <caption>
        <title>Matthews Correlation Coefficient (MCC) for the quality of secondary structure prediction (see text) from each of <monospace>RNAmountAlign</monospace>, <monospace>LocARNA</monospace>, <monospace>LARA</monospace>, <monospace>FOLDALIGN</monospace>, <monospace>DYNALIGN</monospace>, <monospace>STRAL</monospace>, <monospace>MXSCARNA</monospace> and sequence-only alignments (<italic>γ</italic> = 0) for <italic>pairwise global alignment</italic>.</title>
        <p>Moving averages of MCC are computed for centered, symmetric windows of size 11 and shown as a function of sequence identity for a subset of 7, 154 reference pairwise alignments from k2 <monospace>BRAliBase 2.1</monospace>. Overall average MCC values ± one standard deviation are shown in parentheses. These 7, 154 alignments were selected with the property that both sequences in the alignment (exactly) appear in an Rfam family seed multiple alignment from Rfam 7.0, and so can be assigned an Rfam consensus secondary structure as described in the text. These consensus structures are taken as the reference structures in the computation of MCC. Predicted structures are obtained directly from the output of each software in the benchmarking test. For <monospace>RNAmountAlign</monospace> and for our in-house implementation of <monospace>STRAL</monospace>, the <monospace>-alifold</monospace> flag was used to compute the consensus structure by a function call to <monospace>alifold()</monospace> from <monospace>libRNA.a</monospace> in the <monospace>Vienna RNA Package</monospace>.</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pone.0227177.s013.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0227177.s014">
      <label>S6 Fig</label>
      <caption>
        <title>F1-score for <monospace>RNAmountAlign</monospace>, <monospace>LocARNA</monospace>, <monospace>LARA</monospace>, <monospace>FOLDALIGN</monospace>, <monospace>DYNALIGN</monospace>, <monospace>STRAL</monospace>, <monospace>MXSCARNA</monospace> and sequence-only alignments(<italic>γ</italic> = 0) for <italic>pairwise global alignment</italic>, where any failure of the benchmarked program to output an assignment is simply ignored.</title>
        <p>Moving averages of F1-score for centered, symmetric windows of size 11 are shown as a function of sequence identity for pairwise alignments in the <monospace>BRAliBase 2.1</monospace> database used for benchmarking. Moving averages taken for centered, symmetric windows of size 11. This figure should be compared with <xref ref-type="supplementary-material" rid="pone.0227177.s010">S2 Fig</xref>, where failure to output an alignment is counted as zero.</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pone.0227177.s014.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0227177.s015">
      <label>S7 Fig</label>
      <caption>
        <title>Average sensitivity (Sen) and positive predictive value (PPV) for <monospace>RNAmountAlign</monospace>, <monospace>LocARNA</monospace>, <monospace>LARA</monospace>, <monospace>FOLDALIGN</monospace>, <monospace>DYNALIGN</monospace>, <monospace>STRAL</monospace>, <monospace>MXSCARNA</monospace> and sequence-only alignments (<italic>γ</italic> = 0) for <italic>pairwise global alignment</italic>, where any failure of the benchmarked program to output an assignment is simply ignored.</title>
        <p>Sensitivity is shown as a function of sequence identity for pairwise alignments in the <monospace>BRAliBase 2.1</monospace> database used for benchmarking. Moving averages taken for centered, symmetric windows of size 11. This figure should be compared with <xref ref-type="supplementary-material" rid="pone.0227177.s011">S3 Fig</xref>, where failure to output an alignment is counted as zero.</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pone.0227177.s015.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0227177.s016">
      <label>S8 Fig</label>
      <caption>
        <title>Illustration of a potential weakness of <monospace>RNAmountAlign</monospace>.</title>
        <p>Using <monospace>RNAmountAlign</monospace> genome-scanning software, semiglobal alignments of the query tRNA AB031215.1/9125-9195 were made with each 300 nt window (successive window overlap of 200 nt) of the <italic>E. coli</italic> str. K-12 substr. MG1655 genome. This figure shows the MFE structure, color-coded by positional entropy [<xref rid="pone.0227177.ref053" ref-type="bibr">53</xref>], for the alignment of positions 696097-696164 with score −7.70, <italic>p</italic>-value of 4.145010 ⋅ 10<sup>−6</sup>. (gap costs <italic>g</italic><sub><italic>i</italic></sub> = −3, <italic>g</italic><sub><italic>i</italic></sub> = −1, <italic>γ</italic> = 0.5, scaling factor <italic>α</italic><sub>seq</sub> = 0.447648, shift term <italic>α</italic><sub>str</sub> = 0.304766, <italic>γ</italic> = 1/2). However, this RNA is clearly not a tRNA, since the three loops are not within the scope of a multiloop, and the variable loop is located in the wrong position, and the large positional entropy suggests that there is not an unambiguous structure. Moreover, this sequence is not one of the 40 tRNA genes/pseudogenes on the plus-strand predicted by <monospace>tRNAscan-SE</monospace> [<xref rid="pone.0227177.ref052" ref-type="bibr">52</xref>].</p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pone.0227177.s016.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0227177.s017">
      <label>S1 Appendix</label>
      <caption>
        <title>Software tutorial.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0227177.s017.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pone.0227177.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Levenshtein</surname><given-names>VI</given-names></name>. <article-title>Binary Codes Capable of Correcting Deletions, Insertions and Reversals</article-title>. <source>Soviet Physics Doklady</source>. <year>1966</year>;<volume>10</volume>:<fpage>707</fpage>.</mixed-citation>
    </ref>
    <ref id="pone.0227177.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Moulton</surname><given-names>V</given-names></name>, <name><surname>Zuker</surname><given-names>M</given-names></name>, <name><surname>Steel</surname><given-names>M</given-names></name>, <name><surname>Pointon</surname><given-names>R</given-names></name>, <name><surname>Penny</surname><given-names>D</given-names></name>. <article-title>Metrics on RNA secondary structures</article-title>. <source>Journal of Computational Biology</source>. <year>2000</year>;<volume>7</volume>:<fpage>277</fpage>–<lpage>292</lpage>. <pub-id pub-id-type="doi">10.1089/10665270050081522</pub-id><?supplied-pmid 10890402?><pub-id pub-id-type="pmid">10890402</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Shapiro</surname><given-names>BA</given-names></name>. <article-title>An algorithm for comparing multiple RNA secondary structures</article-title>. <source>Comput Appl Biosci</source>. <year>1988</year>;<volume>4</volume>(<issue>3</issue>):<fpage>387</fpage>–<lpage>393</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/4.3.387</pub-id><?supplied-pmid 2458170?><pub-id pub-id-type="pmid">2458170</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Lorenz</surname><given-names>R</given-names></name>, <name><surname>Bernhart</surname><given-names>SH</given-names></name>, <name><surname>Höner zu Siederdissen</surname><given-names>C</given-names></name>, <name><surname>Tafer</surname><given-names>H</given-names></name>, <name><surname>Flamm</surname><given-names>C</given-names></name>, <name><surname>Stadler</surname><given-names>PF</given-names></name>, <etal>et al</etal><article-title>ViennaRNA Package 2.0</article-title>. <source>Algorithms Mol Biol</source>. <year>2011</year>;<volume>6</volume>:<fpage>26</fpage><pub-id pub-id-type="doi">10.1186/1748-7188-6-26</pub-id><?supplied-pmid 22115189?><pub-id pub-id-type="pmid">22115189</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Voss</surname><given-names>B</given-names></name>, <name><surname>Meyer</surname><given-names>C</given-names></name>, <name><surname>Giegerich</surname><given-names>R</given-names></name>. <article-title>Evaluating the predictability of conformational switching in RNA</article-title>. <source>Bioinformatics</source>. <year>2004</year>;<volume>20</volume>(<issue>10</issue>):<fpage>1573</fpage>–<lpage>1582</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bth129</pub-id><?supplied-pmid 14962925?><pub-id pub-id-type="pmid">14962925</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref006">
      <label>6</label>
      <mixed-citation publication-type="other">Barsacchi M, Baù A, Bechini A. Extensive Assessment of Metrics on RNA Secondary Structures and Relative Ensembles. In: Proceedings of the 31st Annual ACM Symposium on Applied Computing. SAC’16. New York, NY, USA: ACM; 2016. p. 44–47. Available from: <ext-link ext-link-type="uri" xlink:href="http://doi.acm.org/10.1145/2851613.2851868">http://doi.acm.org/10.1145/2851613.2851868</ext-link>.</mixed-citation>
    </ref>
    <ref id="pone.0227177.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Ding</surname><given-names>Y</given-names></name>, <name><surname>Lawrence</surname><given-names>CE</given-names></name>. <article-title>A statistical sampling algorithm for RNA secondary structure prediction</article-title>. <source>Nucleic Acids Res</source>. <year>2003</year>;<volume>31</volume>(<issue>24</issue>):<fpage>7280</fpage>–<lpage>7301</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkg938</pub-id><?supplied-pmid 14654704?><pub-id pub-id-type="pmid">14654704</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Needleman</surname><given-names>SB</given-names></name>, <name><surname>Wunsch</surname><given-names>CD</given-names></name>. <article-title>A general method applicable to the search for similarities in the amino acid sequence of two proteins</article-title>. <source>J Mol Biol</source>. <year>1970</year>;<volume>48</volume>(<issue>3</issue>):<fpage>443</fpage>–<lpage>453</lpage>. <pub-id pub-id-type="doi">10.1016/0022-2836(70)90057-4</pub-id><?supplied-pmid 5420325?><pub-id pub-id-type="pmid">5420325</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Smith</surname><given-names>TF</given-names></name>, <name><surname>Waterman</surname><given-names>MS</given-names></name>. <article-title>Identification of common molecular subsequences</article-title>. <source>J Mol Biol</source>. <year>1981</year>;<volume>147</volume>(<issue>1</issue>):<fpage>195</fpage>–<lpage>197</lpage>. <pub-id pub-id-type="doi">10.1016/0022-2836(81)90087-5</pub-id><?supplied-pmid 7265238?><pub-id pub-id-type="pmid">7265238</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref010">
      <label>10</label>
      <mixed-citation publication-type="book"><name><surname>Gusfield</surname><given-names>D</given-names></name>. <source>Algorithms on Strings, Trees and Sequences: Computer Science and Computational Biology</source>. <publisher-name>Cambridge University</publisher-name>; <year>1997</year>.</mixed-citation>
    </ref>
    <ref id="pone.0227177.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Thompson</surname><given-names>JD</given-names></name>, <name><surname>Plewniak</surname><given-names>F</given-names></name>, <name><surname>Poch</surname><given-names>O</given-names></name>. <article-title>A comprehensive comparison of multiple sequence alignment programs</article-title>. <source>Nucleic Acids Res</source>. <year>1999</year>;<volume>27</volume>(<issue>13</issue>):<fpage>2682</fpage>–<lpage>2690</lpage>. <pub-id pub-id-type="doi">10.1093/nar/27.13.2682</pub-id><?supplied-pmid 10373585?><pub-id pub-id-type="pmid">10373585</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Karlin</surname><given-names>S</given-names></name>, <name><surname>Altschul</surname><given-names>SF</given-names></name>. <article-title>Methods for assessing the statistical significance of molecular sequence features by using general scoring schemes</article-title>. <source>Proc Natl Acad Sci USA</source>. <year>1990</year>;<volume>87</volume>(<issue>6</issue>):<fpage>2264</fpage>–<lpage>2268</lpage>. <?supplied-pmid 2315319?><pub-id pub-id-type="pmid">2315319</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Karlin</surname><given-names>S</given-names></name>, <name><surname>Dembo</surname><given-names>A</given-names></name>, <name><surname>Kawabata</surname><given-names>T</given-names></name>. <article-title>Statistical composition of high-scoring segments from molecular sequences</article-title>. <source>Annals of Statistics</source>. <year>1990</year>;<volume>18</volume>(<issue>2</issue>):<fpage>571</fpage>–<lpage>581</lpage>. <pub-id pub-id-type="doi">10.1214/aos/1176347616</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Bauer</surname><given-names>M</given-names></name>, <name><surname>Klau</surname><given-names>GW</given-names></name>, <name><surname>Reinert</surname><given-names>K</given-names></name>. <article-title>Accurate multiple sequence-structure alignment of RNA sequences using combinatorial optimization</article-title>. <source>BMC Bioinformatics</source>. <year>2007</year>;<volume>8</volume>:<fpage>271</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-8-271</pub-id><?supplied-pmid 17662141?><pub-id pub-id-type="pmid">17662141</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Havgaard</surname><given-names>JH</given-names></name>, <name><surname>Lyngsø</surname><given-names>R</given-names></name>, <name><surname>Stormo</surname><given-names>G</given-names></name>, <name><surname>Gorodkin</surname><given-names>J</given-names></name>. <article-title>Pairwise local structural alignment of RNA sequences with sequence similarity less than 40%</article-title>. <source>Bioinformatics</source>. <year>2005</year>;<volume>21</volume>(<issue>9</issue>). <pub-id pub-id-type="doi">10.1093/bioinformatics/bti279</pub-id><?supplied-pmid 15657094?><pub-id pub-id-type="pmid">15657094</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Havgaard</surname><given-names>J</given-names></name>, <name><surname>Kaur</surname><given-names>S</given-names></name>, <name><surname>Gorodkin</surname><given-names>J</given-names></name>. <article-title>Comparative ncRNA gene and structure prediction using Foldalign and FoldalignM</article-title>. <source>Curr Protoc Bioinformatics</source>. <year>2012</year>;<volume>0</volume>(<issue>O</issue>):<fpage>O</fpage>.</mixed-citation>
    </ref>
    <ref id="pone.0227177.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Sundfeld</surname><given-names>D</given-names></name>, <name><surname>Havgaard</surname><given-names>JH</given-names></name>, <name><surname>De Melo</surname><given-names>AC</given-names></name>, <name><surname>Gorodkin</surname><given-names>J</given-names></name>. <article-title>Foldalign 2.5: multithreaded implementation for pairwise structural RNA alignment</article-title>. <source>Bioinformatics</source>. <year>2016</year>;<volume>32</volume>(<issue>8</issue>):<fpage>1238</fpage>–<lpage>1240</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btv748</pub-id><?supplied-pmid 26704597?><pub-id pub-id-type="pmid">26704597</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Mathews</surname><given-names>DH</given-names></name>, <name><surname>Turner</surname><given-names>DH</given-names></name>. <article-title>Dynalign: an algorithm for finding the secondary structure common to two RNA sequences</article-title>. <source>J Mol Biol</source>. <year>2002</year>;<volume>317</volume>(<issue>2</issue>):<fpage>191</fpage>–<lpage>203</lpage>. <pub-id pub-id-type="doi">10.1006/jmbi.2001.5351</pub-id><?supplied-pmid 11902836?><pub-id pub-id-type="pmid">11902836</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Will</surname><given-names>S</given-names></name>, <name><surname>Reiche</surname><given-names>K</given-names></name>, <name><surname>Hofacker</surname><given-names>IL</given-names></name>, <name><surname>Stadler</surname><given-names>PF</given-names></name>, <name><surname>Backofen</surname><given-names>R</given-names></name>. <article-title>Inferring noncoding RNA families and classes by means of genome-scale structure-based clustering</article-title>. <source>PLoS Comput Biol</source>. <year>2007</year>;<volume>3</volume>(<issue>4</issue>):<fpage>e65</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.0030065</pub-id><?supplied-pmid 17432929?><pub-id pub-id-type="pmid">17432929</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Smith</surname><given-names>C</given-names></name>, <name><surname>Heyne</surname><given-names>S</given-names></name>, <name><surname>Richter</surname><given-names>AS</given-names></name>, <name><surname>Will</surname><given-names>S</given-names></name>, <name><surname>Backofen</surname><given-names>R</given-names></name>. <article-title>Freiburg RNA Tools: a web server integrating INTARNA, EXPARNA and LOCARNA</article-title>. <source>Nucleic Acids Res</source>. <year>2010</year>;<volume>38</volume>(<issue>Web</issue>):<fpage>W373</fpage>–<lpage>W377</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkq316</pub-id><?supplied-pmid 20444875?><pub-id pub-id-type="pmid">20444875</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Hofacker</surname><given-names>IL</given-names></name>, <name><surname>Bernhart</surname><given-names>SH</given-names></name>, <name><surname>Stadler</surname><given-names>PF</given-names></name>. <article-title>Alignment of RNA base pairing probability matrices</article-title>. <source>Bioinformatics</source>. <year>2004</year>;<volume>20</volume>(<issue>14</issue>):<fpage>2222</fpage>–<lpage>2227</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bth229</pub-id><?supplied-pmid 15073017?><pub-id pub-id-type="pmid">15073017</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Dalli</surname><given-names>D</given-names></name>, <name><surname>Wilm</surname><given-names>A</given-names></name>, <name><surname>Mainz</surname><given-names>I</given-names></name>, <name><surname>Steger</surname><given-names>G</given-names></name>. <article-title>STRAL: progressive alignment of non-coding RNA using base pairing probability vectors in quadratic time</article-title>. <source>Bioinformatics</source>. <year>2006</year>;<volume>22</volume>(<issue>13</issue>):<fpage>1593</fpage>–<lpage>1599</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btl142</pub-id><?supplied-pmid 16613908?><pub-id pub-id-type="pmid">16613908</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Tabei</surname><given-names>Y</given-names></name>, <name><surname>Kiryu</surname><given-names>H</given-names></name>, <name><surname>Kin</surname><given-names>T</given-names></name>, <name><surname>Asai</surname><given-names>K</given-names></name>. <article-title>A fast structural multiple alignment method for long RNA sequences</article-title>. <source>BMC Bioinformatics</source>. <year>2008</year>;<volume>9</volume>(<issue>1</issue>):<fpage>33</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-9-33</pub-id><?supplied-pmid 18215258?><pub-id pub-id-type="pmid">18215258</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Tabei</surname><given-names>Y</given-names></name>, <name><surname>Tsuda</surname><given-names>K</given-names></name>, <name><surname>Kin</surname><given-names>T</given-names></name>, <name><surname>Asai</surname><given-names>K</given-names></name>. <article-title>SCARNA: fast and accurate structural alignment of RNA sequences by matching fixed-length stem fragments</article-title>. <source>Bioinformatics</source>. <year>2006</year>;<volume>22</volume>(<issue>14</issue>):<fpage>1723</fpage>–<lpage>1729</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btl177</pub-id><?supplied-pmid 16690634?><pub-id pub-id-type="pmid">16690634</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Torarinsson</surname><given-names>E</given-names></name>, <name><surname>Havgaard</surname><given-names>JH</given-names></name>, <name><surname>Gorodkin</surname><given-names>J</given-names></name>. <article-title>Multiple structural alignment and clustering of RNA sequences</article-title>. <source>Bioinformatics</source>. <year>2007</year>;<volume>23</volume>(<issue>8</issue>):<fpage>926</fpage>–<lpage>932</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btm049</pub-id><?supplied-pmid 17324941?><pub-id pub-id-type="pmid">17324941</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Xu</surname><given-names>Z</given-names></name>, <name><surname>Mathews</surname><given-names>DH</given-names></name>. <article-title>Multilign: an algorithm to predict secondary structures conserved in multiple RNA sequences</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>(<issue>5</issue>):<fpage>626</fpage>–<lpage>632</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btq726</pub-id><?supplied-pmid 21193521?><pub-id pub-id-type="pmid">21193521</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Xu</surname><given-names>ZZ</given-names></name>, <name><surname>Mathews</surname><given-names>DH</given-names></name>. <article-title>Prediction of Secondary Structures Conserved in Multiple RNA Sequences</article-title>. <source>Methods Mol Biol</source>. <year>2016</year>;<volume>1490</volume>:<fpage>35</fpage>–<lpage>50</lpage>. <pub-id pub-id-type="doi">10.1007/978-1-4939-6433-8_3</pub-id><?supplied-pmid 27665591?><pub-id pub-id-type="pmid">27665591</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Notredame</surname><given-names>C</given-names></name>, <name><surname>Higgins</surname><given-names>DG</given-names></name>, <name><surname>Heringa</surname><given-names>J</given-names></name>. <article-title>T-Coffee: A novel method for fast and accurate multiple sequence alignment</article-title>. <source>J Mol Biol</source>. <year>2000</year>;<volume>302</volume>(<issue>1</issue>):<fpage>205</fpage>–<lpage>217</lpage>. <pub-id pub-id-type="doi">10.1006/jmbi.2000.4042</pub-id><?supplied-pmid 10964570?><pub-id pub-id-type="pmid">10964570</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Thompson</surname><given-names>JD</given-names></name>, <name><surname>Higgins</surname><given-names>DG</given-names></name>, <name><surname>Gibson</surname><given-names>TJ</given-names></name>. <article-title>CLUSTAL W: improving the sensitivity of progressive multiple sequence alignment through sequence weighting, position-specific gap penalties and weight matrix choice</article-title>. <source>Nucleic Acids Res</source>. <year>1994</year>;<volume>22</volume>(<issue>22</issue>):<fpage>4673</fpage>–<lpage>4680</lpage>. <pub-id pub-id-type="doi">10.1093/nar/22.22.4673</pub-id><?supplied-pmid 7984417?><pub-id pub-id-type="pmid">7984417</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Klein</surname><given-names>RJ</given-names></name>, <name><surname>Eddy</surname><given-names>SR</given-names></name>. <article-title>RSEARCH: Finding homologs of single structured RNA sequences</article-title>. <source>BMC Bioinformatics</source>. <year>2003</year>;<volume>4</volume>:<fpage>44</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-4-44</pub-id><?supplied-pmid 14499004?><pub-id pub-id-type="pmid">14499004</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Nawrocki</surname><given-names>EP</given-names></name>, <name><surname>Eddy</surname><given-names>SR</given-names></name>. <article-title>Infernal 1.1: 100-fold faster RNA homology searches</article-title>. <source>Bioinformatics</source>. <year>2013</year>;<volume>29</volume>(<issue>22</issue>):<fpage>2933</fpage>–<lpage>2935</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btt509</pub-id><?supplied-pmid 24008419?><pub-id pub-id-type="pmid">24008419</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Gotoh</surname><given-names>O</given-names></name>. <article-title>An improved algorithm for matching biological sequences</article-title>. <source>J Mol Biol</source>. <year>1982</year>;<volume>162</volume>(<issue>3</issue>):<fpage>705</fpage>–<lpage>708</lpage>. <pub-id pub-id-type="doi">10.1016/0022-2836(82)90398-9</pub-id><?supplied-pmid 7166760?><pub-id pub-id-type="pmid">7166760</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Ferre</surname><given-names>F</given-names></name>, <name><surname>Ponty</surname><given-names>Y</given-names></name>, <name><surname>Lorenz</surname><given-names>WA</given-names></name>, <name><surname>Clote</surname><given-names>P</given-names></name>. <article-title>DIAL: a web server for the pairwise alignment of two RNA three-dimensional structures using nucleotide, dihedral angle and base-pairing similarities</article-title>. <source>Nucleic Acids Res</source>. <year>2007</year>;<volume>35</volume>(<issue>Web</issue>):<fpage>W659</fpage>–<lpage>W668</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkm334</pub-id><?supplied-pmid 17567620?><pub-id pub-id-type="pmid">17567620</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Nawrocki</surname><given-names>EP</given-names></name>, <name><surname>Burge</surname><given-names>SW</given-names></name>, <name><surname>Bateman</surname><given-names>A</given-names></name>, <name><surname>Daub</surname><given-names>J</given-names></name>, <name><surname>Eberhardt</surname><given-names>RY</given-names></name>, <name><surname>Eddy</surname><given-names>SR</given-names></name>, <etal>et al</etal><article-title>Rfam 12.0: updates to the RNA families database</article-title>. <source>Nucleic Acids Res</source>. <year>2015</year>;<volume>43</volume>(<issue>Database</issue>):<fpage>D130</fpage>–<lpage>D137</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gku1063</pub-id><?supplied-pmid 25392425?><pub-id pub-id-type="pmid">25392425</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Turner</surname><given-names>DH</given-names></name>, <name><surname>Mathews</surname><given-names>DH</given-names></name>. <article-title>NNDB: the nearest neighbor parameter database for predicting stability of nucleic acid secondary structure</article-title>. <source>Nucleic Acids Res</source>. <year>2010</year>;<volume>38</volume>(<issue>Database</issue>):<fpage>D280</fpage>–<lpage>D282</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkp892</pub-id><?supplied-pmid 19880381?><pub-id pub-id-type="pmid">19880381</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Hogeweg</surname><given-names>P</given-names></name>, <name><surname>Hesper</surname><given-names>B</given-names></name>. <article-title>Energy directed folding of RNA sequences</article-title>. <source>Nucleic Acids Res</source>. <year>1984</year>;<volume>12</volume>(<issue>1</issue>):<fpage>67</fpage>–<lpage>74</lpage>. <pub-id pub-id-type="doi">10.1093/nar/12.1part1.67</pub-id><?supplied-pmid 6198625?><pub-id pub-id-type="pmid">6198625</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Huynen</surname><given-names>MA</given-names></name>, <name><surname>Perelson</surname><given-names>A</given-names></name>, <name><surname>Vieira</surname><given-names>WA</given-names></name>, <name><surname>Stadler</surname><given-names>PF</given-names></name>. <article-title>Base pairing probabilities in a complete HIV-1 RNA</article-title>. <source>J Comput Biol</source>. <year>1996</year>;<volume>3</volume>(<issue>2</issue>):<fpage>253</fpage>–<lpage>274</lpage>. <pub-id pub-id-type="doi">10.1089/cmb.1996.3.253</pub-id><?supplied-pmid 8811486?><pub-id pub-id-type="pmid">8811486</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Gardner</surname><given-names>PP</given-names></name>, <name><surname>Wilm</surname><given-names>A</given-names></name>, <name><surname>Washietl</surname><given-names>S</given-names></name>. <article-title>A benchmark of multiple sequence alignment programs upon structural RNAs</article-title>. <source>Nucleic Acids Res</source>. <year>2005</year>;<volume>33</volume>(<issue>8</issue>):<fpage>2433</fpage>–<lpage>2439</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gki541</pub-id><?supplied-pmid 15860779?><pub-id pub-id-type="pmid">15860779</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Smith</surname><given-names>TF</given-names></name>, <name><surname>Waterman</surname><given-names>MS</given-names></name>. <article-title>Comparison of biosequences</article-title>. <source>Advances in Applied Mathematics</source>. <year>1981</year>;<volume>2</volume>:<fpage>482</fpage>–<lpage>489</lpage>. <pub-id pub-id-type="doi">10.1016/0196-8858(81)90046-4</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Sellers</surname><given-names>PH</given-names></name>. <article-title>On the theory and computation of evolutionary distances</article-title>. <source>SIAM J Appl Math</source>. <year>1974</year>;<volume>26</volume>:<fpage>787</fpage>–<lpage>793</lpage>. <pub-id pub-id-type="doi">10.1137/0126070</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref041">
      <label>41</label>
      <mixed-citation publication-type="book"><name><surname>Waterman</surname><given-names>MS</given-names></name>. <source>Introduction to Computational Biology</source>. <publisher-name>Chapman and Hall/CRC</publisher-name>; <year>1995</year>.</mixed-citation>
    </ref>
    <ref id="pone.0227177.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Bashford</surname><given-names>D</given-names></name>, <name><surname>Chothia</surname><given-names>C</given-names></name>, <name><surname>Lesk</surname><given-names>AM</given-names></name>. <article-title>Determinants of a protein fold: Unique features of the globin amino acid sequences</article-title>. <source>Journal of Molecular Biology</source>. <year>1987</year>;<volume>196</volume>(<issue>1</issue>):<fpage>199</fpage>–<lpage>216</lpage>. <pub-id pub-id-type="doi">10.1016/0022-2836(87)90521-3</pub-id>. <?supplied-pmid 3656444?><pub-id pub-id-type="pmid">3656444</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Sievers</surname><given-names>F</given-names></name>, <name><surname>Wilm</surname><given-names>A</given-names></name>, <name><surname>Dineen</surname><given-names>D</given-names></name>, <name><surname>Gibson</surname><given-names>JJ</given-names></name>, <name><surname>Karplus</surname><given-names>K</given-names></name>, <name><surname>Li</surname><given-names>W</given-names></name>, <etal>et al</etal><article-title>Fast, scalable generation of high-quality protein multiple sequence alignments using Clustal Omega</article-title>. <source>Mol Syst Biol</source>. <year>2011</year>;<volume>7</volume>(<issue>539</issue>):<fpage>1</fpage>–<lpage>6</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0227177.ref044">
      <label>44</label>
      <mixed-citation publication-type="book"><name><surname>Sneath</surname><given-names>PHA</given-names></name>, <name><surname>Sokal</surname><given-names>RR</given-names></name>. <chapter-title>Numerical taxonomy</chapter-title><source>The principles and practice of numerical classification</source>. <publisher-loc>San Francisco</publisher-loc>, <publisher-name>W.H. Freeman and Company.</publisher-name>, <publisher-loc>USA</publisher-loc>: <publisher-name>Taylor &amp; Francis, Ltd.</publisher-name>; <year>1973</year>.</mixed-citation>
    </ref>
    <ref id="pone.0227177.ref045">
      <label>45</label>
      <mixed-citation publication-type="journal"><name><surname>Matthews</surname><given-names>BW</given-names></name>. <article-title>Comparison of the predicted and observed secondary structure of T4 phage lysozyme</article-title>. <source>Biochimica et Biophysica Acta (BBA)—Protein Structure</source>. <year>1975</year>;<volume>405</volume>(<issue>2</issue>):<fpage>442</fpage>–<lpage>451</lpage>. <pub-id pub-id-type="doi">10.1016/0005-2795(75)90109-9</pub-id>.</mixed-citation>
    </ref>
    <ref id="pone.0227177.ref046">
      <label>46</label>
      <mixed-citation publication-type="journal"><name><surname>Bernhart</surname><given-names>SH</given-names></name>, <name><surname>Hofacker</surname><given-names>IL</given-names></name>, <name><surname>Will</surname><given-names>S</given-names></name>, <name><surname>Gruber</surname><given-names>AR</given-names></name>, <name><surname>Stadler</surname><given-names>PF</given-names></name>. <article-title>RNAalifold: improved consensus structure prediction for RNA alignments</article-title>. <source>BMC Bioinformatics</source>. <year>2008</year>;<volume>9</volume>:<fpage>474</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-9-474</pub-id><?supplied-pmid 19014431?><pub-id pub-id-type="pmid">19014431</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref047">
      <label>47</label>
      <mixed-citation publication-type="journal"><name><surname>Clote</surname><given-names>P</given-names></name>, <name><surname>Ferre</surname><given-names>F</given-names></name>, <name><surname>Kranakis</surname><given-names>E</given-names></name>, <name><surname>Krizanc</surname><given-names>D</given-names></name>. <article-title>Structural RNA has lower folding energy than random RNA of the same dinucleotide frequency</article-title>. <source>RNA</source>. <year>2005</year>;<volume>11</volume>(<issue>5</issue>):<fpage>578</fpage>–<lpage>591</lpage>. <pub-id pub-id-type="doi">10.1261/rna.7220505</pub-id><?supplied-pmid 15840812?><pub-id pub-id-type="pmid">15840812</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref048">
      <label>48</label>
      <mixed-citation publication-type="journal"><name><surname>Tabei</surname><given-names>Y</given-names></name>, <name><surname>Asai</surname><given-names>K</given-names></name>. <article-title>A local multiple alignment method for detection of non-coding RNA sequences</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>(<issue>12</issue>):<fpage>1498</fpage>–<lpage>1505</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btp261</pub-id><?supplied-pmid 19376823?><pub-id pub-id-type="pmid">19376823</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref049">
      <label>49</label>
      <mixed-citation publication-type="journal"><name><surname>Pang</surname><given-names>H</given-names></name>, <name><surname>Tang</surname><given-names>J</given-names></name>, <name><surname>Chen</surname><given-names>SS</given-names></name>, <name><surname>Tao</surname><given-names>S</given-names></name>. <article-title>Statistical distributions of optimal global alignment scores of random protein sequences</article-title>. <source>BMC Bioinformatics</source>. <year>2005</year>;<volume>6</volume>:<fpage>257</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-6-257</pub-id><?supplied-pmid 16225696?><pub-id pub-id-type="pmid">16225696</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref050">
      <label>50</label>
      <mixed-citation publication-type="journal"><name><surname>Hertel</surname><given-names>J</given-names></name>, <name><surname>De Jong</surname><given-names>D</given-names></name>, <name><surname>Marz</surname><given-names>M</given-names></name>, <name><surname>Rose</surname><given-names>D</given-names></name>, <name><surname>Tafer</surname><given-names>H</given-names></name>, <name><surname>Tanzer</surname><given-names>A</given-names></name>, <etal>et al</etal><article-title>Non-coding RNA annotation of the genome of Trichoplax adhaerens</article-title>. <source>Nucleic Acids Res</source>. <year>2009</year>;<volume>37</volume>(<issue>5</issue>):<fpage>1602</fpage>–<lpage>1615</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkn1084</pub-id><?supplied-pmid 19151082?><pub-id pub-id-type="pmid">19151082</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref051">
      <label>51</label>
      <mixed-citation publication-type="journal"><name><surname>Smith</surname><given-names>MA</given-names></name>, <name><surname>Seemann</surname><given-names>SE</given-names></name>, <name><surname>Quek</surname><given-names>XC</given-names></name>, <name><surname>Mattick</surname><given-names>JS</given-names></name>. <article-title>DotAligner: identification and clustering of RNA structure motifs</article-title>. <source>Genome Biol</source>. <year>2017</year>;<volume>18</volume>(<issue>1</issue>):<fpage>244</fpage><pub-id pub-id-type="doi">10.1186/s13059-017-1371-3</pub-id><?supplied-pmid 29284541?><pub-id pub-id-type="pmid">29284541</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref052">
      <label>52</label>
      <mixed-citation publication-type="journal"><name><surname>Lowe</surname><given-names>TM</given-names></name>, <name><surname>Chan</surname><given-names>PP</given-names></name>. <article-title>tRNAscan-SE On-line: integrating search and context for analysis of transfer RNA genes</article-title>. <source>Nucleic Acids Research</source>. <year>2016</year>;<volume>44</volume>(<issue>W1</issue>):<fpage>W54</fpage>–<lpage>W57</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkw413</pub-id><?supplied-pmid 27174935?><pub-id pub-id-type="pmid">27174935</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0227177.ref053">
      <label>53</label>
      <mixed-citation publication-type="journal"><name><surname>Huynen</surname><given-names>M</given-names></name>, <name><surname>Gutell</surname><given-names>R</given-names></name>, <name><surname>Konings</surname><given-names>D</given-names></name>. <article-title>Assessing the reliability of RNA folding using statistical mechanics</article-title>. Edited by <name><surname>Draper</surname><given-names>D. E.</given-names></name><source>Journal of Molecular Biology</source>. <year>1997</year>;<volume>267</volume>(<issue>5</issue>):<fpage>1104</fpage>–<lpage>1112</lpage>. <pub-id pub-id-type="doi">10.1006/jmbi.1997.0889</pub-id>.<pub-id pub-id-type="pmid">9150399</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
