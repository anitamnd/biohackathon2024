<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7972341</article-id>
    <article-id pub-id-type="publisher-id">4050</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-021-04050-6</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>Dualmarker</italic>: a flexible toolset for exploratory analysis of combinatorial dual biomarkers for clinical efficacy</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Ma</surname>
          <given-names>Xiaopeng</given-names>
        </name>
        <address>
          <email>xiaopeng.ma@beigene.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Huang</surname>
          <given-names>Ruiqi</given-names>
        </name>
        <address>
          <email>ruiqi.huang@beigene.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wu</surname>
          <given-names>Xikun</given-names>
        </name>
        <address>
          <email>xikun.wu@beigene.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Pei</given-names>
        </name>
        <address>
          <email>pei.zhang@beigene.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.459355.b</institution-id><institution>BeiGene (Beijing) Co., Ltd., </institution></institution-wrap>Beijing, China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>17</day>
      <month>3</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>17</day>
      <month>3</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <elocation-id>127</elocation-id>
    <history>
      <date date-type="received">
        <day>7</day>
        <month>10</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>25</day>
        <month>2</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">An increasing number of clinical trials require biomarker-driven patient stratification, especially for revolutionary immune checkpoint blockade therapy. Due to the complicated interaction between a tumor and its microenvironment, single biomarkers, such as PDL1 protein level, tumor mutational burden (TMB), single gene mutation and expression, are far from satisfactory for response prediction or patient stratification. Recently, combinatorial biomarkers were reported to be more precise and powerful for predicting therapy response and identifying potential target populations with superior survival. However, there is a lack of dedicated tools for such combinatorial biomarker analysis.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">Here, we present <italic>dualmarker</italic>, an R package designed to facilitate the data exploration for dual biomarker combinations. Given two biomarkers, <italic>dualmarker</italic> comprehensively visualizes their association with drug response and patient survival through 14 types of plots, such as boxplots, scatterplots, ROCs, and Kaplan–Meier plots. Using logistic regression and Cox regression models, <italic>dualmarker</italic> evaluated the superiority of dual markers over single markers by comparing the data fitness of dual-marker versus single-marker models, which was utilized for de novo searching for new biomarker pairs. We demonstrated this straightforward workflow and comprehensive capability by using public biomarker data from one bladder cancer patient cohort (IMvigor210 study); we confirmed the previously reported biomarker pair TMB/TGF-beta signature and CXCL13 expression/ARID1A mutation for response and survival analyses, respectively. In addition, <italic>dualmarker</italic> de novo identified new biomarker partners, for example, in overall survival modelling, the model with combination of HMGB1 expression and ARID1A mutation had statistically better goodness-of-fit than the model with either HMGB1 or ARID1A as single marker.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">The <italic>dualmarker</italic> package is an open-source tool for the visualization and identification of combinatorial dual biomarkers. It streamlines the dual marker analysis flow into user-friendly functions and can be used for data exploration and hypothesis generation. Its code is freely available at GitHub at <ext-link ext-link-type="uri" xlink:href="https://github.com/maxiaopeng/dualmarker">https://github.com/maxiaopeng/dualmarker</ext-link> under MIT license.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Combinatory dual biomarker</kwd>
      <kwd>Logistic regression</kwd>
      <kwd>Cox model</kwd>
      <kwd>R package</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>BeiGene</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par11">With the rapid development of the biomarker detection technology, an increasing number of single predictive or diagnostic biomarkers have been identified and validated in retrospective studies or perspective trials. For example, in the revolutionary field of immune checkpoint blockade (ICB) [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>], such biomarkers include PDL1 protein level, gene expression profiling (GEP), gene mutation, and tumor mutation burden (TMB). However, cancer development is associated with a complicated tumor microenvironment (TME) and tumor/TME interactions involving multiple biological processes [<xref ref-type="bibr" rid="CR1">1</xref>], such as tumor proliferation, apoptosis, and angiogenesis. Indeed, each single biomarker can only reflect a small aspect of these intricate tumor and immune characteristics. So far, no single perfect marker has been developed for patient stratification for ICB therapy [<xref ref-type="bibr" rid="CR2">2</xref>].</p>
    <p id="Par12">In general, a combinatorial biomarker strategy that takes different TME-affecting components into account is needed [<xref ref-type="bibr" rid="CR3">3</xref>]. Several combinatorial biomarkers have been identified in recent years. For example, in one pan-cancer study, the combination of TMB and the T cell–inflamed gene expression profile (TIS) was able to predict response to pembrolizumab [<xref ref-type="bibr" rid="CR4">4</xref>]. In the Imvigor210 trial, TMB plus the TGF-beta gene signature predicted response to atezolizumab in urothelium carcinoma (UC) [<xref ref-type="bibr" rid="CR5">5</xref>]. A third study using the same dataset found that AIRD1A mutation in combination with CXCL13 gene expression predicted overall survival (OS) [<xref ref-type="bibr" rid="CR6">6</xref>]. In all these studies, combinatorial dual markers outperformed single markers in the prediction of response and survival.</p>
    <p id="Par13">The R language and its powerful packages for statistics and data visualization are widely used in biomarker data analysis, including the <italic>survival</italic> and <italic>survminer</italic> [<xref ref-type="bibr" rid="CR7">7</xref>] package for survival analysis and <italic>gClinBiomarker</italic> [<xref ref-type="bibr" rid="CR8">8</xref>] for univariate biomarker analysis. However, tools for dual biomarker analysis are not available to our knowledge.</p>
    <p id="Par14">Here, we describe <italic>dualmarker</italic>, a flexible toolset for combinatorial dual marker visualization and identification. <italic>dualmarker</italic> performs dual marker analysis via two distinct modules, one for in-depth evaluation of one specific biomarker pair and a second for de novo identification of biomarker pairs. Both modules are applicable for both categorical and continuous biomarkers using logistic regression and Cox survival models. We herein demonstrate its application using public biomarker data from the IMvigor210 clinical study [<xref ref-type="bibr" rid="CR5">5</xref>] by validation of reported biomarker pairs and the identification of novel pairs.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <sec id="Sec3">
      <title>Overview</title>
      <p id="Par15"><italic>Dualmarker</italic> assesses the correlation between biomarkers and clinical efficacy, including binary outcome (e.g. drug response) and survival data. It can evaluate a specific biomarker pair by comprehensive visualization and statistical analysis and searches for novel pairs from all dual marker combinations; It can also search for a second marker partner, namely, marker2 (M2) in combination with the chosen marker1 (M1) via logistic regression and the Cox regression model (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). The response status should be dichotomous to fit the logistic regression model, and marker1 or marker2 can be either a continuous variable (e.g., TMB, gene expression) or a dichotomous variable (e.g., gene mutation, mutated or wild-type). Ordinal variables with more than 2 levels are not supported in the current version. Continuous variables are used directly in the logistic/Cox regression model, and they are dichotomized to high and low levels, using the population median as a cutoff or user-specified value, to facilitate visualization. The dichotomization and combination of two markers produces four subgroups, each located in a quadrant, labeled as R1-R4 with dedicated colors throughout all plots (Fig. <xref rid="Fig1" ref-type="fig">1</xref>).<fig id="Fig1"><label>Fig. 1</label><caption><p>Framework of <italic>dualmarker. Dualmarker</italic> contains two parts: visualization of one specific marker pair and de novo identification of biomarker pairs for binary outcome (therapy response, upper left panels) and time-to-event outcome (survival, lower left panels). To facilitate visualization, both markers are dichotomized into positive/high and negative/low groups with four quadrants, labeled R1-R4 with dedicated colors. Both markers are shown in a scatter chart or Kaplan–Meier plot (KMplot, see detailed plots in Figs. <xref rid="Fig2" ref-type="fig">2</xref> and <xref rid="Fig3" ref-type="fig">3</xref>), and all plots can be easily generated by a single function: <italic>dm_pair</italic>. For de novo identification of dual-marker pair, four logistic regression models or Cox regression models are built depending on whether response or survival analysis is performed: two single-marker models and two dual-marker models with interaction (M1*M2) or without interaction (M1 + M2). To control any covariates, ‘cov’ option can also be added in the model. Each candidate is evaluated by model comparison, which compares the dual-marker models with the single ones using the likelihood ratio test (LRT). The -log10 <italic>p</italic> values from model comparisons of dual-vs-marker1 and dual-vs-marker2 are shown as scatterplots, with each dot representing a candidate biomarker pair (see detailed plots in Fig. <xref rid="Fig4" ref-type="fig">4</xref>); The analysis is performed by the <italic>dm_searhM2_logit/cox</italic> and <italic>dm_combM_logit/cox</italic> functions to search marker2 to combine with specific marker1 or search among all combinations of marker pairs, respectively</p></caption><graphic xlink:href="12859_2021_4050_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Visualizations</title>
      <p id="Par16"><italic>Dualmarker</italic> provides comprehensive visualizations of dual markers and reveals their association with response and survival. For response analysis, boxplots illustrate the correlation between response and a single marker (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a), and a scatterplot shows the inter-marker correlation (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b). In turn, the ROC curve, AUC and confidence interval demonstrate the performance of response prediction for single markers and logistic regression model of dual markers (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c). In addition, a series of four-quadrant plots reveals the group/quadrant size and the response rate of each group/quadrant, including an area proportion chart (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d), a quadrant statistic matrix (Fig. <xref rid="Fig2" ref-type="fig">2</xref>e), a doughnut plot (Fig. <xref rid="Fig2" ref-type="fig">2</xref>f) and a line chart (Fig. <xref rid="Fig2" ref-type="fig">2</xref>g, see the legend for a detailed description). For survival analysis, a Kaplan–Meier plot (KMplot) depicts the survival of a single marker and dual markers in four groups/quadrants, with a <italic>p</italic> value determined by the log-rank test (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a–c). Conditional KMplots represent the survival curve of marker1 on the condition of marker2 levels (positive/high or negative/low) and the survival curve of marker2 on the condition of marker1 levels (Fig. <xref rid="Fig3" ref-type="fig">3</xref>g), revealing the association between survival and marker1 in the context of marker2 levels and vice versa. In addition, similar four-quadrant plots show the group/quadrant size, median survival time and 95% confidence interval by an area proportion chart (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d), a quadrant statistic matrix (Fig. <xref rid="Fig3" ref-type="fig">3</xref>e) and a line chart (Fig. <xref rid="Fig3" ref-type="fig">3</xref>f, the Fig. <xref rid="Fig3" ref-type="fig">3</xref> legend contains detailed description of each chart). Both the response and survival visualizations are easily performed by the <italic>dm_pair</italic> function, which will generate over 14 plots simultaneously. In addition, there are flexible options in <italic>dm_pair</italic> to adjust labels, titles as well as the color schemes from palettes requested by the leading scientific journals (via R package <italic>ggsci</italic> [<xref ref-type="bibr" rid="CR9">9</xref>]) or by customer specification. Taken together, this panel of charts reveals the potential association between two markers, response and survival, in an intuitive and comprehensive manner.<fig id="Fig2"><label>Fig. 2</label><caption><p>Demonstration of biomarker pairs for response analysis using TMB (marker1) and the TGF-beta signature (marker2). Boxplots display the distribution of the biomarkers (left: TMB; right: TGF-beta) by response group (positive vs negative); Wilcoxon tests were employed to compare the response group for each biomarker (<bold>a</bold>). The scatterplot displays the inter-marker correlation with the color representing the response category, and red indicates positive (<bold>b</bold>). The ROC curve depicts the performance of the single marker and dual marker using a logistic regression model with or without marker interaction. The AUC and its confidence interval are presented on the plot as well (<bold>c</bold>). Samples were stratified into 4 groups/quadrants, and statistics for each group are shown (<bold>d</bold>–<bold>g</bold>). The area proportion chart shows the group size and independence test of two markers by Fisher’s exact test (<bold>d</bold>). The quadrant statistic matrix presents the group size, response rate and confidence interval (<bold>e</bold>). The doughnut plot illustrates both the relative group size (width of ring) and response rate (red arc fraction, <bold>f</bold>). The line chart shows the response rate in each quadrant/group and the potential statistical interaction between two markers, i.e., if two lines are crossed (<bold>g</bold>). All figures were generated by <italic>dualmarker</italic> (v0.1.0)</p></caption><graphic xlink:href="12859_2021_4050_Fig2_HTML" id="MO2"/></fig><fig id="Fig3"><label>Fig. 3</label><caption><p>Demonstration of survival analysis for one pair of markers, ARID1A mutation (marker1) and CXCL13 gene expression (marker2). KM plot of a single marker for mut_ARID1A (<bold>a</bold>) and CXCL13 expression (cut by median, <bold>b</bold>) and the dual markers (<bold>c</bold>). Four group sizes and independence tests using Fisher’s exact test (<bold>d</bold>), the median survival time and confidence interval in each group/quadrant are shown in a matrix (<bold>e</bold>) and line chart (<bold>f</bold>). Conditional KM plots show the survival curves of marker2 stratified by the marker1 level (<bold>g</bold>, upper panel) as well as marker1 within the context of the marker2 level (<bold>g</bold>, lower 2 panel) with the <italic>p</italic> values of log-rank test and adjusted <italic>p</italic> values by ‘Bonferroni’ method. All figures were generated by <italic>dualmarker</italic> (v0.1.0)</p></caption><graphic xlink:href="12859_2021_4050_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec5">
      <title>Logistic regression model</title>
      <p id="Par17">The logistic regression method was applied to predict the binary outcome of response. Different modeling strategies were considered to include one biomarker at a time, two biomarkers at the same time and the modeling interaction of the two biomarkers using the following four logistic regression models: model1, Resp ~ M1; model2, Resp ~ M2; model3, Resp ~ M1 + M2; and model4, Resp ~ M1 + M2 + M1:M2 (interaction term). Covariates can also be added in the models (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). Model comparisons were performed to evaluate the superiority of the dual-marker to single-marker model using the likelihood ratio test (LRT) with the R <italic>anova</italic> function. The performance of responder/non-responder classification of the biomarker(s) was evaluated using ROC/AUC by R package <italic>pROC</italic> [<xref ref-type="bibr" rid="CR10">10</xref>].</p>
    </sec>
    <sec id="Sec6">
      <title>Cox survival model</title>
      <p id="Par18">The Cox regression method was applied to predict survival. Four Cox regression models were produced, similar to the logistic regression models. The parametric part of the Cox model design is as follows: Model1, Surv ~ M1; Model 2, Surv ~ M2; Model 3, Surv ~ M1 + M2; Model 4, Surv ~ M1 + M2 + M1:M2 (interaction). Covariates can also be added in the models (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). As above, model comparisons were performed using the likelihood ratio test (LRT) implemented in R. The performance of event risk classification was evaluated using concordant probability by R package <italic>CPE</italic> [<xref ref-type="bibr" rid="CR11">11</xref>].</p>
    </sec>
    <sec id="Sec7">
      <title>Search for biomarker pairs</title>
      <p id="Par19">Based on the characterization of a single pair of biomarkers, we expanded the scope to biomarker partner searches. Using the models above, we searched for marker M2 to combine with marker M1 through the <italic>dm_searchM2_logit</italic> and <italic>dm_searchM2_cox</italic> functions, prioritizing marker2s with significant improvement in model fit in the dual-marker model versus the single-marker model. Candidate marker2s with significant LRT test <italic>p</italic> values are shown in a dot chart, which displays the signed -log10 <italic>p</italic> values, whereby the sign is the direction of the marker2 effect on response or survival as a single marker (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b). The models can also take covariates into consideration (Fig. <xref rid="Fig1" ref-type="fig">1</xref>) and adjust the <italic>p</italic> value for multiple comparisons. Furthermore, we expanded the scope to search all biomarker pairs, using <italic>dm_combM_logit</italic> and <italic>dm_combM_cox</italic> functions. Users can filter and get interesting dual-marker pairs using plenty of statistics and model performance metrics, for example, AUC for binary response analysis (logistic regression), concordant probability estimate (CPE) for survival analysis (Cox regression), <italic>p</italic> value of dual-vs-single model comparison and statistical interaction of two markers, et al. In summary, <italic>dualmarker</italic> package can search dual-marker pairs with or without given marker.<fig id="Fig4"><label>Fig. 4</label><caption><p>De-novo identification of marker2 from gene expression to combine with marker1 (mut_ARID1A). The dual marker Cox regression model was compared with the single marker model using marker1 and marker2 separately. The -log10 <italic>p</italic> values of the LRT test between models are shown on the x-axis and y-axis, and the dashed line indicates the <italic>p</italic> value = 0.01 (<bold>a</bold>). Top significant marker2s to combine with mut_ARID1A according to the significance of LRT in model comparison of the dual-marker model versus the mut_ARID1A single-marker model; dashed lines show <italic>p</italic> value = 0.01 and 0.05(<bold>b</bold>). The signed -log10-p value is provided, and the sign is the direction of the effect of marker2 on OS as a single marker. The arrow points to the known biomarker partners, CXCL13, IFNG and the novel gene HMGB1, which showed a statistical interaction with mut_ARID1A (<bold>c-e</bold>). Four quadrants/groups divided by mut_ARID1A and HMGB1 expression levels (high vs low, cut by population median) had significantly different OS values (<bold>c</bold>, <italic>p</italic> value = 0.0019, log-rank test for all group comparisons). ARID1A-mutated patients had longer OS under the condition of high HMGB1 but not low HMGB1 (<bold>d</bold>). Median survival time and confidence interval for each quadrant/group (<bold>e</bold>)</p></caption><graphic xlink:href="12859_2021_4050_Fig4_HTML" id="MO4"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Results</title>
    <p id="Par20">We applied <italic>dualmarker</italic> to analyze the biomarker data of the IMvigor210 trial [<xref ref-type="bibr" rid="CR5">5</xref>], including the baseline characterization of PDL1 IHC, gene expression profiling (GEP), tumor mutation burden (TMB) and gene mutations in 348 patients with advanced UC. To simplify the demonstration, for GEP, we focused on the tumor microenvironment-related genes (1392) listed in the HTG Precision immune-oncology panel [<xref ref-type="bibr" rid="CR12">12</xref>].</p>
    <sec id="Sec9">
      <title>Response analysis of one biomarker pair</title>
      <p id="Par21">We explored one previously reported biomarker pair, TMB and the TGF-beta gene expression signature [<xref ref-type="bibr" rid="CR5">5</xref>]. TMB was significantly higher in the responders than in the non-responders (Wilcoxon test, <italic>p</italic> value = 1.1e-7), whereas the TGF-beta gene signature score showed the opposite trend (Wilcoxon test, <italic>p</italic> value = 0.016, Fig. <xref rid="Fig2" ref-type="fig">2</xref>a). There was a weak negative correlation between TMB and the TGF-beta signature (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b, Spearman correlation R = − 0.16, <italic>p</italic> value = 0.007). Using the population median as the cutoff point, patients were stratified into 4 groups/quadrants, and a comparison of the 4 group sizes showed weak dependence between TMB and the TGF-beta signature (<italic>p</italic> value = 0.06, Fisher exact test, Fig. <xref rid="Fig2" ref-type="fig">2</xref>d). The TMB-high/TGF-beta-low group (quadrant R4) had the highest response rate (43%, 95% CI 0.3–0.56); the TMB-low/TGF-beta-high group (quadrant R2) had the lowest response rate (4%, 95% CI 0.01–0.12, Fig. <xref rid="Fig2" ref-type="fig">2</xref>e–g). This indicated that the R2 group was most refractory to PDL1 therapy among the four groups. In addition, logistic regression models were applied to predict response, and the two biomarker combinations yielded higher AUC values than the single TMB marker (AUC = 0.754, 95% CI 0.686–0.821 for the TMB*TGF-beta model with the biomarker interaction versus 0.728, 95% CI 0.652–0.804 for the single TMB marker model, Fig. <xref rid="Fig2" ref-type="fig">2</xref>c). Besides, the dual marker model (with marker interaction) had statistically better goodness-of-fit than the TMB single marker model using LRT test (<italic>p</italic> value = 0.0098).</p>
    </sec>
    <sec id="Sec10">
      <title>Survival analysis of one biomarker pair</title>
      <p id="Par22">Dual marker survival analysis was carried out using the pair of ARID1A mutations and CXCL13 gene expression as an example. This biomarker pair was reported to be associated with OS [<xref ref-type="bibr" rid="CR6">6</xref>]. We confirmed that patients with ARID1A mutations (marker1) had a longer OS (<italic>p</italic> value = 0.045, log-rank test, Fig. <xref rid="Fig3" ref-type="fig">3</xref>a; patients with higher expression of CXCL13 (marker2, population median as cutoff) also had a longer OS (<italic>p</italic> value = 0.0016, log-rank test, Fig. <xref rid="Fig3" ref-type="fig">3</xref>b). We then stratified the population into four groups/quadrants and observed a significant difference in survival (<italic>p</italic> value = 0.0085, log-rank test for comparison of all groups, Fig. <xref rid="Fig3" ref-type="fig">3</xref>c), with the R1 group (ARID1A-mut/CXCL13-high) showing the longest OS (median 17.7, CI 9.23-NA) and the R3 group (ARID1A-wt/CXCL13-low) the shortest OS (median 7.89, CI 5.52–9.86, Fig. <xref rid="Fig3" ref-type="fig">3</xref>e). Conditional KM plots further revealed a longer OS for the CXCL13-high group compared to the CXCL13-low group in ARID1A-mut (<italic>p</italic> value = 0.012, adjusted <italic>p</italic> value (Bonferroni) = 0.048, log-rank test) (Fig. <xref rid="Fig3" ref-type="fig">3</xref>g, upper 2 panels). Meanwhile, the ARID1A-mut group showed a trend of longer OS than the ARID1A-wildtype group in both CXCL13-high and CXCL13-low subgroups (Fig. <xref rid="Fig3" ref-type="fig">3</xref>g, lower 2 panels). No significant statistical interaction was observed between the two markers (Fig. <xref rid="Fig3" ref-type="fig">3</xref>f, p value = 0.4, Wald test of interaction term in the dual marker Cox model). Besides the descriptive statistic, visualization and comparison between subgroups of dual biomarkers, Cox model comparison showed that CXCL13/ARID1A dual marker model had significantly better fitness to the survival data than ARID1A single marker model (<italic>p</italic> value = 0.00047, likelihood ratio test) and CXCL13 single marker model (<italic>p</italic> value = 0.1, likelihood ratio test). The combination of these two biomarkers achieved a higher power of risk discrimination as suggested by the bigger CPE value of the dual marker (CPE is 0.583, 0.535 and 0.576 for dual-marker, ARID1A and CXCL13 single marker, respectively). Therefore, the combination of these two biomarkers might suggest improved patient characterization and stratification. All plots, statistic result of LRT, CPEs were generated by running single function <italic>dm_pair.</italic></p>
    </sec>
    <sec id="Sec11">
      <title>De novo identification of marker pairs</title>
      <p id="Par23">In <italic>dualmarker</italic>, given one specific marker (M1), another biomarker (M2) can be de novo identified using logistic regression for response status analysis and Cox models for survival analysis. An ideal dual marker model should be superior to either M1 alone or M2 alone. Therefore, we compared dual-marker models with M1 and M2 single marker models. Dual-marker models with and without interaction terms were both considered, and the model with smaller <italic>p</italic> value based on the LRT test was taken. The significance level (-log10 <italic>p</italic> value) for the dual-vs-M1 and dual-vs-M2 model comparisons is shown in the scatterplot in Fig. <xref rid="Fig4" ref-type="fig">4</xref>a. Goswami S et al. reported the combination of ARID1A mutation and CXCL13 expression predicts OS in three independent cohorts based on biological hypotheses [<xref ref-type="bibr" rid="CR6">6</xref>]. We searched among all gene expression biomarkers for combination with the ARID1A mutation (mut_ARID1A) in a data-driven manner. Using the <italic>dm_searchM2_cox</italic> function, we identified 97 genes (<italic>p</italic> value &lt; 0.01, LRT test) as dual-biomarker partner candidates to combined with mut_ARID1A, including CXCL13 and other important immune modulators such as IFNG and CXCL9/10 (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b). These genes represent the inflamed immune signature that contributes to the association between ARID1A and overall survival. We also found some markers, such as HMGB1, when combined with the ARID1A mutation, outperformed either ARID1A or HMGB1 single marker model (<italic>p</italic> value = 0.0012, <italic>p</italic> value = 0.0003, likelihood ratio test, Fig. <xref rid="Fig4" ref-type="fig">4</xref>a); Meanwhile, HMGB1 expression showed an interesting statistical interaction with the ARID1A mutation. Under HMGB1-high conditions, patients with ARID1A mutation had significantly longer OS (Quadrant R1 vs R2, <italic>p</italic> value = 0.0015, log-rank test); However, this association disappeared in the HMGB1-low population (Quadrant R3 vs R4, Fig. <xref rid="Fig4" ref-type="fig">4</xref>d, p value = 0.48, log-rank test). The interaction term in the Cox model was also significant (<italic>p</italic> value = 0.001, Wald test), indicating that HMGB1 may have an important role in predicting OS with the ARID1A mutation. The relationship between HMGB1 and ARID1A needs further validation and exploration. We showed the nominal <italic>p</italic> values here, and no dual marker pairs were significant (FDR &lt; 0.05) after <italic>p</italic> value adjustment using “BH” method, which may owe to the data set or the power of detection. However, such <italic>p</italic> value based prioritization strategy might identify interesting biomarker pairs before intensive study and validation.</p>
    </sec>
  </sec>
  <sec id="Sec12">
    <title>Discussion</title>
    <p id="Par24">Biomarker combination may increase the accuracy of efficacy prediction for cancer therapy via precise characterization and further stratification of patients. Such analysis might also reveal novel insight into the complicated cancer-TME interaction and help inform treatment strategy. Thus, an exploratory analysis tool for dual marker combination is valuable for streamlining the workflows.</p>
    <p id="Par25">To our knowledge, <italic>dualmarker</italic> is the first comprehensive R package for dual marker analysis. <italic>dualmarker</italic> involves various flexible and easy-to-use functions for dual marker characterization with two modules, generating over 14 types of plots to evaluate and visualize one biomarker pair. Here, we demonstrated its application in the well-studied Imvigor210 dataset and benchmarked the results with the original trial paper for the biomarker-pair example of the TMB/TGF-beta signature and ARID1A-mut/CXCL13 expression. Furthermore, powerful dual-marker pair searching functions can prioritize novel biomarker partners to use in combination with a pre-selected marker (M1). We searched key TME-related GEP markers in combination with ARID1A mutations using the Cox survival model and verified CXCL13 and IFNG as top candidates. We have also identified a novel statistically significant interaction between HMGB1 expression and the ARID1A mutation, representing that ARID1A mutated patients were with longer OS only in the HMGB1-high subgroup, while not in the HMGB1-low subgroup (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). This interaction would require further validation study.</p>
    <p id="Par26"><italic>Dualmarker</italic> is a powerful exploratory tool for biomarker data mining. It streamlines potential dual-marker visualization and identification; Its strengths are as follows: (1) comprehensive visualization of marker pairs with over 14 types of plots, including boxplots, scatterplots, ROCs, and Kaplan–Meier plots; (2) comprehensive performance evaluation of dual marker combination. It builds four regression models and summarizes the model parameters simultaneously; Meanwhile it provides comprehensive model performance evaluation, including ROC/AUC for binary response variable, concordance probability for time-to-event variable, model comparison of dual marker versus single marker in logistic regression and Cox regression. (3) novel biomarker pair identification function without predefined hypotheses; (4) applicable to both survival and response analyses and compatible with both continuous and categorical variables; (5) user friendly with only 5 core functions. The interface for dual marker visualization and statistics of response and survival is <italic>dm_pair,</italic> which is compatible with both continuous (e.g., gene expression, TMB) and categorical (e.g., mutation, PDL1 level) variables. De novo marker2 identification is achieved through <italic>dm_searchM2_logit</italic> and <italic>dm_serach_M2_cox</italic> for logistic and Cox regression, respectively; all dual biomarker combination can be evaluated using <italic>dm_combM_logit</italic> and <italic>dm_combM_cox</italic> function. A detailed and up-to-date tutorial can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/maxiaopeng/dualmarker">https://github.com/maxiaopeng/dualmarker</ext-link>. Thus, we expect wide usage of <italic>dualmarker</italic> in biomarker studies for the evaluation of biomarker pairs of interest and exploration of novel biomarker combinations for precise patient stratification as well as mechanism of action and resistance research.</p>
    <p id="Par27"><italic>Dualmarker</italic> is designed for data visualization and exploration purpose with some limits. Firstly, it can’t deal with the non-linear associations between predictors and the outcome for the four regression models, which needs methods such as restricted cubic spline and may be included in the package of the future version. Secondly, the regression model can include covariates, however, the current version can’t deal with the interactions between covariates and biomarkers. Thirdly, the package can’t handle ordinal variables, which need dichotomization aforehand, and it is not feasible for multiple (&gt; 2) marker analysis. Finally, evaluating all marker combination from thousands of biomarkers like gene expression profiles, is time-consuming, and parallel computation or other methods could be introduced to improve the computation efficiency.</p>
  </sec>
  <sec id="Sec13">
    <title>Conclusions</title>
    <p id="Par28">A new open-source software toolkit, which includes an R package <italic>dualmarker</italic> and accompanied tutorial, is presented. This package implements logistic regression and Cox survival analysis models, and the data visualization command can be easily applied for biomarker pair evaluation and novel biomarker combination identification.</p>
    <sec id="Sec14">
      <title>Availability and requirements</title>
      <p id="Par29">
        <list list-type="bullet">
          <list-item>
            <p id="Par30">Project name: <italic>dualmarker</italic></p>
          </list-item>
          <list-item>
            <p id="Par31">Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/maxiaopeng/dualmarker">https://github.com/maxiaopeng/dualmarker</ext-link></p>
          </list-item>
          <list-item>
            <p id="Par32">Operating system(s): Platform independent</p>
          </list-item>
          <list-item>
            <p id="Par33">Programming language: R</p>
          </list-item>
          <list-item>
            <p id="Par34">Other requirements: ggplot2, dplyr, pROC, survival, survminer, CPE, ggpubr</p>
          </list-item>
          <list-item>
            <p id="Par35">License: MIT License</p>
          </list-item>
          <list-item>
            <p id="Par36">Any restrictions to use by non-academics: no restrictions</p>
          </list-item>
        </list>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>AUC</term>
        <def>
          <p id="Par4">Area under the curve</p>
        </def>
      </def-item>
      <def-item>
        <term>CPE</term>
        <def>
          <p id="Par5">Concordant probability estimate</p>
        </def>
      </def-item>
      <def-item>
        <term>GEP</term>
        <def>
          <p id="Par6">Gene expression profiling</p>
        </def>
      </def-item>
      <def-item>
        <term>ICB</term>
        <def>
          <p id="Par7">Immune checkpoint blockade</p>
        </def>
      </def-item>
      <def-item>
        <term>OS</term>
        <def>
          <p id="Par8">Overall survival</p>
        </def>
      </def-item>
      <def-item>
        <term>ROC</term>
        <def>
          <p id="Par9">Receiver operating characteristic</p>
        </def>
      </def-item>
      <def-item>
        <term>TMB</term>
        <def>
          <p id="Par10">Tumor mutational burden</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>XM and PZ conceived the idea for <italic>dualmarker.</italic> XM developed the methods and R package. XM wrote the article. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This study was funded by BeiGene. Funding for open access charge: BeiGene.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p><italic>Dualmarker</italic> is freely available under the MIT license through the link <ext-link ext-link-type="uri" xlink:href="https://github.com/">https://github.com/</ext-link> maxiaopeng/dualmarker. The data that supports the findings of this study is available from IMvigor210 study (<ext-link ext-link-type="uri" xlink:href="http://research-pub.gene.com/IMvigor210CoreBiologies/">http://research-pub.gene.com/IMvigor210CoreBiologies/</ext-link>) with Creative Commons-BY-3.0 license.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par38">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par39">Authors are current BeiGene employees and shareholders. There are no other conflicts of interest to disclose.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hanahan</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Weinberg</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Hallmarks of cancer: The next generation</article-title>
        <source>Cell</source>
        <year>2011</year>
        <volume>144</volume>
        <fpage>646</fpage>
        <lpage>674</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2011.02.013</pub-id>
        <?supplied-pmid 21376230?>
        <pub-id pub-id-type="pmid">21376230</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Havel</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Chowell</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>TA</given-names>
          </name>
        </person-group>
        <article-title>The evolving landscape of biomarkers for checkpoint inhibitor immunotherapy</article-title>
        <source>Nat Rev Cancer</source>
        <year>2019</year>
        <volume>19</volume>
        <fpage>133</fpage>
        <lpage>150</lpage>
        <pub-id pub-id-type="doi">10.1038/s41568-019-0116-x</pub-id>
        <?supplied-pmid 30755690?>
        <pub-id pub-id-type="pmid">30755690</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Camidge</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Doebele</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Kerr</surname>
            <given-names>KM</given-names>
          </name>
        </person-group>
        <article-title>Comparing and contrasting predictive biomarkers for immunotherapy and targeted therapy of NSCLC</article-title>
        <source>Nat Rev Clin Oncol</source>
        <year>2019</year>
        <volume>16</volume>
        <fpage>341</fpage>
        <lpage>355</lpage>
        <pub-id pub-id-type="doi">10.1038/s41571-019-0173-9</pub-id>
        <?supplied-pmid 30718843?>
        <pub-id pub-id-type="pmid">30718843</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cristescu</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Mogg</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ayers</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Albright</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Yearley</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Pan-tumor genomic biomarkers for PD-1 checkpoint blockade-based immunotherapy</article-title>
        <source>Science</source>
        <year>2018</year>
        <volume>362</volume>
        <fpage>eaar3593</fpage>
        <pub-id pub-id-type="doi">10.1126/science.aar3593</pub-id>
        <pub-id pub-id-type="pmid">30309915</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mariathasan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Turley</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Nickles</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Castiglioni</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yuen</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>TGFβ attenuates tumour response to PD-L1 blockade by contributing to exclusion of T cells</article-title>
        <source>Nature</source>
        <year>2018</year>
        <volume>554</volume>
        <fpage>544</fpage>
        <lpage>548</lpage>
        <pub-id pub-id-type="doi">10.1038/nature25501</pub-id>
        <?supplied-pmid 6028240?>
        <pub-id pub-id-type="pmid">29443960</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goswami</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Anandhan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Szabo</surname>
            <given-names>PM</given-names>
          </name>
          <name>
            <surname>Basu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Blando</surname>
            <given-names>JM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ARID1A mutation plus CXCL13 expression act as combinatorial biomarkers to predict responses to immune checkpoint therapy in mUCC</article-title>
        <source>Sci Transl Med.</source>
        <year>2020</year>
        <volume>12</volume>
        <fpage>eabc4220</fpage>
        <pub-id pub-id-type="doi">10.1126/scitranslmed.abc4220</pub-id>
        <pub-id pub-id-type="pmid">32554706</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">Alboukadel Kassambara, Marcin Kosinski PB. survminer: Drawing Survival Curves using “ggplot2.” 2020. <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=survminer">https://cran.r-project.org/package=survminer</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <mixed-citation publication-type="other">Ning Leng, Alexey Pronin, Jemma Fan, Doug Kelkhoff, Christina Rabe KO. gClinBiomarker. 2020. <ext-link ext-link-type="uri" xlink:href="https://github.com/lengning/gClinBiomarker">https://github.com/lengning/gClinBiomarker</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Xiao N. ggsci: Scientific Journal and Sci-Fi Themed Color Palettes for “ggplot2.” 2018. <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=ggsci">https://cran.r-project.org/package=ggsci</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robin</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Turck</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Hainard</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tiberti</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Lisacek</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Sanchez</surname>
            <given-names>J-C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>pROC: an open-source package for R and S+ to analyze and compare ROC curves</article-title>
        <source>BMC Bioinform</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>77</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-12-77</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <mixed-citation publication-type="other">Qianxing Mo, Mithat Gonen GH. CPE: concordance probability estimates in survival analysis. 2018. <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=CPE">https://cran.r-project.org/package=CPE</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">TME related genes from HTG EdgeSeq Precision Immuno-Oncology Panel. <ext-link ext-link-type="uri" xlink:href="https://www.htgmolecular.com/assays/pip">https://www.htgmolecular.com/assays/pip</ext-link>.</mixed-citation>
    </ref>
  </ref-list>
</back>
