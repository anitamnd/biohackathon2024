<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10863255</article-id>
    <article-id pub-id-type="publisher-id">3178</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-024-03178-x</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>pyHiM: a new open-source, multi-platform software package for spatial genomics based on multiplexed DNA-FISH imaging</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Devos</surname>
          <given-names>Xavier</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Fiche</surname>
          <given-names>Jean-Bernard</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bardou</surname>
          <given-names>Marion</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Messina</surname>
          <given-names>Olivier</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Houbron</surname>
          <given-names>Christophe</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gurgo</surname>
          <given-names>Julian</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Schaeffer</surname>
          <given-names>Marie</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Götz</surname>
          <given-names>Markus</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Walter</surname>
          <given-names>Thomas</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mueller</surname>
          <given-names>Florian</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3339-2349</contrib-id>
        <name>
          <surname>Nollmann</surname>
          <given-names>Marcelo</given-names>
        </name>
        <address>
          <email>marcnol@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.121334.6</institution-id><institution-id institution-id-type="ISNI">0000 0001 2097 0141</institution-id><institution>Centre de Biologie Structurale, </institution><institution>Univ Montpellier, CNRS UMR 5048, INSERM U1054, </institution></institution-wrap>34090 Montpellier, France </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/013cjyk83</institution-id><institution-id institution-id-type="GRID">grid.440907.e</institution-id><institution-id institution-id-type="ISNI">0000 0004 1784 3645</institution-id><institution>Centre for Computational Biology (CBIO), </institution><institution>Mines Paris, PSL University, </institution></institution-wrap>75006 Paris, France </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/04t0gwh46</institution-id><institution-id institution-id-type="GRID">grid.418596.7</institution-id><institution-id institution-id-type="ISNI">0000 0004 0639 6384</institution-id><institution>Institut Curie, </institution></institution-wrap>75248 Paris, Cedex France </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/02vjkv261</institution-id><institution-id institution-id-type="GRID">grid.7429.8</institution-id><institution-id institution-id-type="ISNI">0000 0001 2186 6389</institution-id><institution>INSERM, U900, </institution></institution-wrap>75248 Paris, Cedex France </aff>
      <aff id="Aff5"><label>5</label>Imaging and Modeling Unit, Institut Pasteur, Université Paris Cité, Paris, France </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>13</day>
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>13</day>
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2024</year>
    </pub-date>
    <volume>25</volume>
    <elocation-id>47</elocation-id>
    <history>
      <date date-type="received">
        <day>7</day>
        <month>8</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>29</day>
        <month>1</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Genome-wide ensemble sequencing methods improved our understanding of chromatin organization in eukaryotes but lack the ability to capture single-cell heterogeneity and spatial organization. To overcome these limitations, new imaging-based methods have emerged, giving rise to the field of spatial genomics. Here, we present pyHiM, a user-friendly python toolbox specifically designed for the analysis of multiplexed DNA-FISH data and the reconstruction of chromatin traces in individual cells. pyHiM employs a modular architecture, allowing independent execution of analysis steps and customization according to sample specificity and computing resources. pyHiM aims to facilitate the democratization and standardization of spatial genomics analysis.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13059-024-03178-x.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Spatial genomics</kwd>
      <kwd>3D chromatin structure</kwd>
      <kwd>Transcription</kwd>
      <kwd>Imaging</kwd>
      <kwd>Bioimage informatics</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100019180</institution-id>
            <institution>HORIZON EUROPE European Research Council</institution>
          </institution-wrap>
        </funding-source>
        <award-id>724429</award-id>
        <principal-award-recipient>
          <name>
            <surname>Nollmann</surname>
            <given-names>Marcelo</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100007492</institution-id>
            <institution>Fondation Bettencourt Schueller</institution>
          </institution-wrap>
        </funding-source>
        <award-id>coup d'elan 2017</award-id>
        <principal-award-recipient>
          <name>
            <surname>Nollmann</surname>
            <given-names>Marcelo</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>francebioImaging</institution>
        </funding-source>
        <award-id>ANR-10-INBS-04</award-id>
        <principal-award-recipient>
          <name>
            <surname>Nollmann</surname>
            <given-names>Marcelo</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2024</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par2">In eukaryotes, the three-dimensional (3D) nuclear organization of chromatin is tightly controlled and plays an active role in gene regulation, DNA replication and DNA damage repair. In the last decade, genome-wide ensemble methods, such as Hi-C and 3C [<xref ref-type="bibr" rid="CR1">1</xref>], have revolutionized our understanding of genome structure at the megabase-to-kilobase scale by revealing the complex organization of chromatin into compartments, topologically associating domains, and chromatin loops [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>]. However, these bulk approaches are unable to dissect single-cell heterogeneity or preserve spatial information in tissue [<xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR6">6</xref>].</p>
    <p id="Par3">Recently, a new family of imaging-based methods was developed to trace the 3D conformation of chromatin in single cells, giving rise to the field of spatial genomics [<xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR11">11</xref>] (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). These techniques perform sequential imaging of genomic loci with a precision of a few tens of nanometers, allowing for the 3D mapping of a given region of chromatin at kilobase resolution in thousands of individual cells [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. Our specific implementation, called Hi-M, couples detection of chromatin structure and transcriptional output [<xref ref-type="bibr" rid="CR8">8</xref>] (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). Since their creation, spatial genomics methods based on sequential imaging were successfully used for the detection of short- and long-range chromatin interactions in multiple model systems, including mammalian cultured cells, fly embryos, and mouse tissues [<xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. Critically, imaging-based spatial genomics technologies complement transcriptomic surveys of single cells in their spatial context and thus have the potential to lead to important new discoveries in multiple fields, including 3D genomics, transcriptional regulation, DNA replication, or DNA repair.<fig id="Fig1"><label>Fig. 1</label><caption><p><bold>a</bold> Schematic description of Hi-M microscopy: Chromatin is imaged through multiple acquisition cycles, each targeting a specific genomic locus using a set of unique DNA-FISH oligonucleotides targeted by a complementary, fluorescently labeled oligonucleotide. A fiducial marker is simultaneously imaged to allow for registration and drift correction during post-processing. Using pyHiM, the 3D conformation of the target locus is reconstructed for each individual cell. <bold>b</bold> pyHiM is an open-source project hosted on GitHub. Extensive documentation and Jupyter notebooks are available for users and developers. <bold>c</bold> pyHiM is developed in Python and runs indifferently on Linux, Windows and macOS. <bold>d</bold> Input data: 3D images are organized by imaging channel (DAPI, fiducial, DNA-FISH spots, etc.) and FOV. A single json file combines all parameters needed to run the analysis pipeline. <bold>e</bold> 3D images are pre-processed by calculating the maximum intensity projection and applying 2D registration based on the fiducial images. <bold>f</bold> Masks for nuclei, oligopaint libraries, and DNA-FISH spots are computed using pre-trained deep learning models. Individual DNA-FISH spots are localized with sub-pixel accuracy using apiFISH (fork of big-FISH). <bold>g</bold> Individual traces are built by combining the localizations of all DNA-FISH spots detected within the same mask. Results are saved in ECSV format. <bold>f</bold> Post-processing analyses are performed to obtain pairwise distance and proximity frequency matrices for each combination of DNA loci and for different spatial regions of the sample containing different cell types</p></caption><graphic xlink:href="13059_2024_3178_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par4">In recent years, several efforts were made to promote a wider use of these new technologies by sharing experimental and image analysis protocols [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR13">13</xref>–<xref ref-type="bibr" rid="CR16">16</xref>]. However, democratization of spatial genomics will require the development of open-source and user-friendly software packages for reconstructing chromatin traces (i.e., unique sets of 3D coordinates describing a locus conformation in an individual cell) from raw, 3D, multicolor images [<xref ref-type="bibr" rid="CR17">17</xref>]. To this end, such software should (1) provide access to validated cutting-edge techniques required for the analysis of spatial genomics data, (2) use a license-free programming language, (3) provide extensive documentation and tutorials to guide new users and allow development of new functionalities, (4) adopt a modular architecture to facilitate adaptation to future developments in spatial genomics, and (5) use novel analysis methods to ensure robust, automatic analysis of large data sets (several Tb per experiment) without user input and in reasonable times.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <p id="Par5">To address these needs, we introduce pyHiM, an open-source, modular and scalable software toolbox specifically designed for sequential spatial genomics data analysis (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). pyHiM comes with extensive user and developer documentation, Jupyter Notebook tutorials, and a DNA-FISH dataset to guide new users through the main steps of a typical analysis pipeline (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). PyHiM can be easily installed using standard package management tools (conda and PyPi, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1a) and conveniently runs on Linux, Windows, and macOS (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c). A single human-readable configuration file is used to centralize all analysis parameters and can be edited thanks to a user-friendly graphical user interface (GUI) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1b). In addition, a command-line interface enables execution on multiple hardware platforms, from laptop computers to high-performance computing (HPC) clusters. Functionality can be tuned according to local hardware specifications, acquisition conditions (e.g., number of channels, size of 3D image stacks), and sample properties.</p>
    <p id="Par6">The analysis pipeline of pyHiM is organized in modules, each performing a specific analysis task. The inputs of pyHiM are 3D image stacks in the universal TIFF format (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a, d). Deconvolution of images before pyHiM execution is not mandatory for pyHiM analysis but, in our experience, improves the quality of the results and the statistics of reconstructed chromatin traces.</p>
    <p id="Par7">The pre-processing module organizes images by field of view (FOV) and by the type of probe imaged: DNA-FISH spots, nuclear/ oligopaint library masks, fiducial marks, or RNA expression. For each FOV, pyHiM first performs a projection and global registration using fiducial images acquired at each cycle as references (Fig. <xref rid="Fig1" ref-type="fig">1</xref>e). To improve the robustness of this step, we implemented a new method whereby the image is decomposed in blocks that are independently co-aligned. A polling step then determines the most popular global registration and applies it to the whole image (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2a). This step allows for a global correction of thermal drift and stage repeatability error even for cycles with fiducial images displaying local distortions. Samples such as embryos or tissues may often display local deformations during acquisition of different cycles which cannot be taken into account by global registration algorithms. Thus, we developed a new local registration algorithm that optimizes 3D registrations locally to correct for 3D sample deformations (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2b, c).</p>
    <p id="Par8">The spot detection module performs segmentation and localization of DNA-FISH spots with sub-pixel accuracy of all sequential imaging rounds, using a combination of Deep Learning (DL)-powered spot segmentation followed by robust and automated 3D Gaussian fitting. 3D-DL segmentation is performed using a StarDist neural network [<xref ref-type="bibr" rid="CR18">18</xref>] trained to robustly detect 3D-Point Spread Functions (PSF) in diverse sample types and illumination conditions. We obtained this network after extensive simulations of PSFs with different signal-to-noise ratios and inhomogeneous background levels. Next, based on the centroid position of each DL-mask, a robust 3D Gaussian fit of the intensity distribution is performed using apiFISH (Fig. <xref rid="Fig1" ref-type="fig">1</xref>f and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3) [<xref ref-type="bibr" rid="CR19">19</xref>].</p>
    <p id="Par9">The mask detection module segments nuclei in 3D using pre-trained StarDist neural networks models [<xref ref-type="bibr" rid="CR18">18</xref>] (Fig. <xref rid="Fig1" ref-type="fig">1</xref>f). Other custom models based on StarDist or other popular architectures (e.g., Cellpose [<xref ref-type="bibr" rid="CR20">20</xref>]) can also be integrated via a plugin. Finally, DNA-FISH spots localized within the same mask are combined into chromatin traces, which are assigned a universally unique identifier and tabulated in human-readable Enhanced Character-Separated Values (ECSV) format (Fig. <xref rid="Fig1" ref-type="fig">1</xref>g and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4a, b). Additional labels, based on RNA expression levels or spatial cell distribution, can be assigned to each single trace, allowing for cell/tissue-specific post-processing analysis (Fig. <xref rid="Fig1" ref-type="fig">1</xref>h).</p>
    <p id="Par10">Thanks to pyHiM’s modular architecture, each analysis step in the pipeline (registration, detection, tracing, etc.) can be run independently. Users can tailor the analysis workflow according to their sample specificity, acquisition conditions, and available computing resources (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a). Intermediate results, such as unfiltered localizations or traces, are saved in ECSV format after each module execution, allowing the user to perform custom data validation or additional analysis. Finally, each module produces reports in human-readable markdown files with snapshot images illustrating the performance of the analysis for each cycle and FOV. This allows the user to efficiently assess the quality of the analyses and eventually fine-tune parameters to improve them (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a–c and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S2, S3). pyHiM can successfully analyze experimental data acquired from a variety of sample types, ranging from fly embryos to mouse and human tissues (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d, e).<fig id="Fig2"><label>Fig. 2</label><caption><p><bold>a</bold> Illustration of a typical pyHiM analysis on mouse tissues: examples of raw data are shown in the top row and the most relevant pyHiM outputs are shown in the bottom row. From left to right, raw DAPI data are segmented to compute the 3D masks of each individual nucleus. Next, 2D and 3D registration of the fiducial is performed for each imaging cycle, and the quality of the correction can be quickly assessed based on the output image. Then, the localization of individual DNA-FISH spots is performed in two steps: first, a 3D mask of each DNA-FISH spot is computed using deep learning. Then, using the mask position as a reference, the sub-pixel localization of the spot is inferred using apiFISH. Scale bars = 8 μm. <bold>b</bold> Chromatin tracks are calculated by combining all individual DNA-FISH spot localizations detected within the same mask (DAPI, or locus). Each individual trace represents a snapshot of the locus conformation within a single cell (see reconstruction with two different orientations). <bold>c</bold> Data quality assessment: (top) the N-matrix represents the number of times that each pair of DNA loci was detected in the dataset and is indicative of their detection efficiency. (bottom) The distribution of pairwise distances between DNA-FISH spots in the same chromatin trace is plotted to ensure that there is no major error in the analysis (detection threshold, etc.). <bold>d</bold> Traces computed by pyHiM were sorted based on RNA expression profiles in NC14 fly embryos and assigned to specific cell types (e.g., mesoderm vs. neuroectoderm). Specific long-range interactions and chromatin organization are observed for each cell type. <bold>e</bold> Fast 2D analysis based only on the projected 3D data is used to optimize parameters and test data quality. An example from mouse tissue data shows the pairwise distance maps computed using 2D (top) and 3D (bottom) analysis. The 2D map captures most of the features that characterize the conformation of the locus. <bold>f</bold> Comparison of pyHiM execution times for different number of cycles and for a desktop computer (Intel(R) Core(TM) i7-8700 CPU @ 3.20 GHz, CPUs: 12, cores: 6, threads per core: 2, memory: 16 Gb) or a multi-threaded server (AMD EPYC 7702 64-Core Processor 3.34 GHz, CPUs: 256, cores: 128, threads per core: 2, memory: 512 Gb). <bold>g</bold> Performance of pyHiM using single-threaded or DASK-powered multi-threading</p></caption><graphic xlink:href="13059_2024_3178_Fig2_HTML" id="MO2"/></fig></p>
    <p id="Par11">pyHiM also offers a number of additional features that facilitate data formatting, result display, and post-processing. For instance, DNA-FISH spot detection efficiency and maps of the pairwise distance (PWD) distributions between DNA-FISH spots from different cycles (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c), or proximity frequency matrices for specific cell types (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d). Another important feature of pyHiM is its ability to perform rapid analysis in 2D (Fig. <xref rid="Fig2" ref-type="fig">2</xref>e). In this mode, pyHiM projects signals from DNA-FISH spots and masks in 2D and performs registration, segmentation, spot localization, and tracing in 2D. Contact maps computed using the 2D pipeline show all the relevant features of 3D maps (long-range contacts, TADs, etc.) but require ~ 5 × less computation time (Fig. <xref rid="Fig2" ref-type="fig">2</xref>e, f) and can therefore be used to quickly assess the quality of the acquired dataset before full 3D analysis.</p>
    <p id="Par12">Finally, a critical aspect of multiplexed DNA-FISH imaging is the amount of data generated, typically ~ 1–3 Tb per experiment depending on the number of cycles and the number of FOVs. To handle and analyze such large volumes of data in a reasonable time, we have implemented a parallelization mode based on the Dask Python package. For this, pyHiM analyzes data associated with different hybridization cycles in parallel, while keeping the technical aspects transparent to the user, leading to a drastic shortening in computation time (Fig. <xref rid="Fig2" ref-type="fig">2</xref>f, g). Conveniently, a reporting web-server based on Bokeh can be launched to monitor analysis status and performance in real-time (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4c). As a result, pyHiM can run indifferently on a laptop or an HPC cluster and be tuned according to the technical specificities of both (e.g., number of CPUs, available memory, availability of GPUs, etc.).</p>
  </sec>
  <sec id="Sec3">
    <title>Conclusions</title>
    <p id="Par13">In summary, we describe pyHiM, a modular, user-friendly, well-documented tool for chromatin tracing analysis based on sequential DNA-FISH imaging. pyHiM can be used to analyze data produced by Hi-M or by other spatial genomics methods. Thus, we envision that the adoption of pyHiM will enable the growth of a new user community for this active field of research. Indeed, as data acquisition and sample preparation become standard and even commercially available, a final bottleneck for widespread adoption will be the availability of flexible image analysis tool boxes dedicated to chromatin tracing. Thus, a well-tested and user-friendly analysis pipeline such as pyHiM will be key to break barriers to adoption of spatial genomics by users and microscopy facilities, to promote transparent image analysis pipelines in the field, and to create a large user community to accelerate discoveries and new developments. The modularity, open-source nature, and extensive developer documentation of pyHiM were purposefully designed to promote collaborative developments, to standardize and benchmark image analysis practices, and to facilitate reuse of existing algorithms to implement analysis tools for novel technologies in the blooming field of spatial genomics.</p>
  </sec>
  <sec id="Sec4">
    <title>Methods</title>
    <sec id="Sec5">
      <title>Inputs</title>
      <p id="Par14">The two minimal inputs of pyHiM are as follows: a dictionary of parameters (<italic>parameters.json</italic>) and a list of images to process. <italic>parameters.json</italic> contains acquisition parameters (e.g., pixel size), file formatting parameters (e.g., regular expression to decode filenames), and all the parameters that are required for the execution of each module in pyHiM. For detailed information on the <italic>parameters.json</italic> parameter file, please refer to our online resource: Input Parameters.</p>
      <p id="Par15">Input images can be of two types: DNA-FISH spots for a given cycle and masks used for tracing. The latter can be either nuclear masks (e.g., from DAPI labeling) or from a cycle where the whole oligopaint library is labeled and imaged at once. Both DNA-FISH and mask images must be accompanied by a corresponding fiducial image used for registration (see the “<xref rid="Sec7" ref-type="sec">Registration</xref>” section). Images are assumed to be in the universal and non-proprietary TIFF format. Use of deconvolved images is recommended but not compulsory.</p>
    </sec>
    <sec id="Sec6">
      <title>Projection</title>
      <p id="Par16">We developed a tool for image reprojection (module: <italic>makeProjections</italic>). This step is necessary for lateral global drift alignment (see the”Registration” section) and for the rapid visual inspection of input files. Sum and maximum projections are implemented and configured through the <italic>parameters.json</italic> parameters file. We recommend the former for masks and the latter for DNA-FISH images. makeProjections allows for the manual selection of the <italic>z</italic>-range and implements an automatic algorithm to robustly retrieve the in-focus plane. Briefly, this method estimates the optimal in-focus plane by calculating the maximum of the Laplacian of the intensity profile along the <italic>z</italic>-axis. The calculation is performed block-by-block to take into account local variability and sample drift. More details on the methods and the execution of this module can be found in the online description of the <italic>makeProjections</italic> module.</p>
    </sec>
    <sec id="Sec7">
      <title>Registration</title>
      <p id="Par17">We implemented two registration methods to obtain automatic and robust global and local realignments. The <italic>alignImages</italic> module performs global realignments by registering the 2D z-reprojected fiducial images using 2D cross-correlation. This method, however, can be unreliable when fiducial images contain impurities that vary between cycles. To solve this, we developed a second algorithm (<italic>alignByBlock</italic>) that uses block-by-block decomposition to determine the best registration for each block. This calculation is followed by a polling operation that retrieves the most satisfactory global registration. This second method is highly robust to impurities. More details on the methods and the execution of this module can be found in our online description of the <italic>alignImages</italic> module. Once registrations for each cycle are processed, the module <italic>appliesRegistrations</italic> re-interpolates 2D images of DNA-FISH spots and masks to provide a visual input of the performance of global registrations for each hybridization cycle.</p>
      <p id="Par18">Biological samples can display local deformations (typically in the hundreds of nm range) during the long-term acquisition times of a HiM dataset. These distortions cannot be properly corrected by global 2D realignment routines. To tackle this issue, we developed a new registration method that performs local 3D registration. In this method, images are first globally realigned in 2D. Next, fiducial images are decomposed in 3D blocks and each block is realigned by 3D cross-correlation and re-interpolation. The resulting local block corrections are stored as an ASTROPY table [<xref ref-type="bibr" rid="CR21">21</xref>] that is used by the <italic>register_localizations</italic> module (see section below). More details on the methods and the execution of this module can be found in our online description of the <italic>alignImages3D</italic> module.</p>
    </sec>
    <sec id="Sec8">
      <title>Segmentation and detection</title>
      <p id="Par19">Three different modules were built to deal with the segmentation and detection of DNA-FISH spots and masks. First, we developed a module for the segmentation and localization of masks and sources in 2D (module: <italic>SegmentMasks</italic>). Mask and DNA-FISH images are segmented using startdist with pre-trained networks. Segmented objects are filtered by size and shape, while merged objects are split using the watershed algorithm. DNA-FISH spots are fitted using the highly efficient DAOStarFinder algorithm from photutils [<xref ref-type="bibr" rid="CR22">22</xref>] and post-processed using <italic>filter_localizations</italic>.</p>
      <p id="Par20">Second, we developed a module specifically designed to segment masks in 3D (module: <italic>segmentMasks3D</italic>). <italic>segmentMasks3D</italic> relies on deep-learning segmentation using a network that we trained specifically to robustly segment nuclei in 3D with stardist [<xref ref-type="bibr" rid="CR23">23</xref>]<italic>.</italic> Other DL segmentation tools, such as cellpose [<xref ref-type="bibr" rid="CR20">20</xref>], can be used to further increase the flexibility of mask segmentation for different biological samples (script: mask_cellpose.py). <italic>segmentMasks3D</italic> then post-processes 3D masks by size and shape filtering, and applies a watershed algorithm to split merged masks. The output of <italic>segmentMasks3D</italic> is a localizations table used by the <italic>build_traces</italic> module to group localizations into single chromatin traces (see the “<xref rid="Sec9" ref-type="sec">Tracing</xref>” section) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3c). More details on the methods and the execution of this module can be found in our online description of the <italic>segmentMasks3D</italic> module.</p>
      <p id="Par21">Finally, we developed a module for the segmentation and localization of DNA-FISH spots (module: <italic>segmentSources3D</italic>). <italic>segmentSources3D</italic> segments DNA-FISH spots by using a stardist DL network trained to detect PSFs in 3D. This network was optimized by training the DL network on simulated data displaying large variations in signal-to-noise ratios, local background inhomogeneities, and intensity levels. After segmentation, <italic>segmentSources3D</italic> fits the intensity distributions within DNA-FISH spot masks with a 3D-Gaussian model using non-linear regression with functions from apiFISH [<xref ref-type="bibr" rid="CR19">19</xref>]. The output <italic>segmentSources3D</italic> is an ASTROPY table containing the <italic>xyz</italic> coordinates, identities, and properties of all the localizations. Localizations with low intensities are filtered in post-processing using the module <italic>filter_localizations</italic>. A final step before tracing involves the application of local registrations to the localization tables obtained from <italic>segmentMasks</italic> or from <italic>segmentSources3D using the register_localizations module.</italic> Our trained stardist DL networks were packed with pyHiM and are also available from our pyHiM OSF repository.</p>
    </sec>
    <sec id="Sec9">
      <title>Tracing</title>
      <p id="Par22">The final step involves the grouping of DNA-FISH spots belonging to the same chromatin fiber (module: <italic>build_traces</italic>). This can be accomplished in two manners. The first involves spatial clustering based on nearest-neighbor distances with the KDTree algorithm. This method works well for low-density samples, where nuclei are well-separated in space. The second, instead, relies on the use of user-provided masks. In this case, traces are built by grouping together the spots belonging to the same mask. Masks can be derived either from nuclei (e.g., from DAPI staining) or from a cycle labeling the entire oligopaint library. The output of <italic>build_traces</italic> is a trace table in ASTROPY format where each trace is stamped with a universal unique identifier to enable the automatic merging of multiple trace tables and to ensure traceability. We note that no corrections for missing or redundant barcode localizations are applied by <italic>build_traces</italic> as such corrections are often sample dependent. In pyHiM, these issues are handled by post-processing scripts (see below). More details on the methods and the execution of this module can be found in our online description of the <italic>build_traces</italic> module.</p>
      <p id="Par23">We developed several tools for post-processing of trace tables. <italic>Trace_assign_mask</italic> finds traces that match specific morphological or gene-expression patterns by matching trace localization with user-provided masks. <italic>Trace_combinator</italic> and <italic>trace_merge</italic> fuse traces from different FOVs or different experiments. <italic>Trace_filter</italic> is a general tool for filtering traces that can remove specific barcodes from a trace table, remove duplicated localizations from single traces, and perform spatial filtering. <italic>Trace_filter_advanced</italic>, instead, removes duplicate localizations based on distance constraints. Finally, <italic>trace_analyzer</italic> analyzes a trace table to calculate the distribution in the number of barcodes detected per trace, the number of times each barcode appears in single traces, and the spatial clustering of traces. We highlight the existence of more sophisticated methods to improve the quality of tracing [<xref ref-type="bibr" rid="CR24">24</xref>] that may be applied in combination with the post-processing scripts mentioned in this paragraph.</p>
      <p id="Par24">Finally, we developed an algorithm that builds maps from trace tables (module: <italic>build_matrix</italic>). This tool produces conventional pair-wise median distance maps by relying on kernel-density estimators to accurately calculate the maximum of each distance distribution, and calculates proximity distance maps for user-specified threshold distances. <italic>Build_matrix</italic> produces N-maps which contain the number of localizations detected for each combination of barcodes, a diagnostic tool that is fundamental to determine the performance of an experiment and the robustness of detection for each barcode pair. More details on the methods and execution of this module can be found in our online description of the <italic>build_matrix</italic> module.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec13">
      <title>Supplementary Information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2024_3178_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1.</bold> Supplementary figures.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2024_3178_MOESM2_ESM.docx">
            <caption>
              <p><bold>Additional file 2.</bold> Review history.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Xavier Devos and Jean-Bernard Fiche are co-first authors.</p>
    </fn>
  </fn-group>
  <ack>
    <sec id="FPar1">
      <title>Review history</title>
      <p id="Par25">The review history is available as Additional file <xref rid="MOESM2" ref-type="media">2</xref>.</p>
    </sec>
    <sec id="FPar2">
      <title>Peer review information</title>
      <p id="Par26">Veronique van den Berghe was the primary editor of this article and managed its editorial process and peer review in collaboration with the rest of the editorial team.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>X.D., J-B.F., C.H., and M.N. wrote the code for pyHiM. J-B.F developed and validated deep learning networks. X.D. wrote the documentation with help from M.S. and M.N. X.D., M.N., and O.M worked in the Jupyter lab tutorials. M.B., C.H., J.G., M.S., and M.G. participated in benchmarking and debugging activities. O.M. and M.S. collected the small dataset. J-B.F and M.N. wrote the manuscript. X.D. and J-B.F made the figures. M.N., F.M., and T.W. participated in the project design. All authors participated in the final edition of the manuscript.</p>
    <sec id="FPar3">
      <title>Authors’ Twitter/X handles</title>
      <p id="Par27">@marcnol (Marcelo Nollmann).</p>
    </sec>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This project was funded by the European Union’s Horizon 2020 Research and Innovation Program (EpiScope, Grant ID 724429, M.N.). We acknowledge the Bettencourt-Schueller Foundation for their prize ‘Coup d'élan pour la recherche Française’ and the France-BioImaging infrastructure supported by the French National Research Agency (grant ID ANR-10-INBS-04, “Investments for the Future”) for their funding through the cloudFISH project.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The latest stable and development versions of pyHiM are publicly available at our GitHub repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/marcnol/pyHiM">https://github.com/marcnol/pyHiM</ext-link> [<xref ref-type="bibr" rid="CR25">25</xref>]. The 0.9.1 release of pyHiM is permanently available at: <ext-link ext-link-type="uri" xlink:href="https://osf.io/updfw">https://osf.io/updfw</ext-link> (10.17605/OSF.IO/UPDFW).</p>
    <p>The online documentation is available at <ext-link ext-link-type="uri" xlink:href="https://pyhim.readthedocs.io/en/latest/">https://pyhim.readthedocs.io/en/latest/</ext-link> [<xref ref-type="bibr" rid="CR26">26</xref>].</p>
    <p>DL networks trained for pyHiM are available at our OSF repository: <ext-link ext-link-type="uri" xlink:href="https://osf.io/ugpyh/">https://osf.io/ugpyh/</ext-link> [<xref ref-type="bibr" rid="CR27">27</xref>].</p>
    <p>Minimal datasets for multiplexed DNA-FISH data are available from <ext-link ext-link-type="uri" xlink:href="https://osf.io/6egdc/">https://osf.io/6egdc/</ext-link> [<xref ref-type="bibr" rid="CR28">28</xref>].</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar4">
      <title>Ethics approval and consent to participate</title>
      <p id="Par28">Ethical approvals were not needed for this study.</p>
    </notes>
    <notes id="FPar5" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par29">The authors declare no competing interests. </p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kempfer</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Pombo</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Methods for mapping 3D chromosome architecture</article-title>
        <source>Nat Rev Genet</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>207</fpage>
        <lpage>226</lpage>
        <pub-id pub-id-type="doi">10.1038/s41576-019-0195-2</pub-id>
        <?supplied-pmid 31848476?>
        <pub-id pub-id-type="pmid">31848476</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dekker</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Heard</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Structural and functional diversity of topologically associating domains</article-title>
        <source>FEBS Lett</source>
        <year>2015</year>
        <volume>589</volume>
        <fpage>2877</fpage>
        <lpage>2884</lpage>
        <pub-id pub-id-type="doi">10.1016/j.febslet.2015.08.044</pub-id>
        <?supplied-pmid 26348399?>
        <pub-id pub-id-type="pmid">26348399</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <mixed-citation publication-type="other">Jerkovic I, Szabo Q, Bantignies F, Cavalli G. Higher-order chromosomal structures mediate genome function. J Mol Biol. 2019. 10.1016/j.jmb.2019.10.014.</mixed-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schaeffer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nollmann</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Contributions of 3D chromatin structure to cell-type-specific gene regulation</article-title>
        <source>Curr Opin Genet Dev</source>
        <year>2023</year>
        <volume>79</volume>
        <fpage>102032</fpage>
        <pub-id pub-id-type="doi">10.1016/j.gde.2023.102032</pub-id>
        <?supplied-pmid 36893484?>
        <pub-id pub-id-type="pmid">36893484</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bouwman</surname>
            <given-names>BAM</given-names>
          </name>
          <name>
            <surname>Crosetto</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Bienko</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The era of 3D and spatial genomics</article-title>
        <source>Trends Genet</source>
        <year>2022</year>
        <volume>38</volume>
        <fpage>1062</fpage>
        <lpage>1075</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tig.2022.05.010</pub-id>
        <?supplied-pmid 35680466?>
        <pub-id pub-id-type="pmid">35680466</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boettiger</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Advances in chromatin imaging at kilobase-scale resolution</article-title>
        <source>Trends Genet</source>
        <year>2020</year>
        <volume>36</volume>
        <fpage>273</fpage>
        <lpage>287</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tig.2019.12.010</pub-id>
        <?supplied-pmid 32007290?>
        <pub-id pub-id-type="pmid">32007290</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bintu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Mateo</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>J-H</given-names>
          </name>
          <name>
            <surname>Sinnott-Armstrong</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Parker</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kinrot</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yamaya</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Boettiger</surname>
            <given-names>AN</given-names>
          </name>
          <name>
            <surname>Zhuang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Super-resolution chromatin tracing reveals domains and co4operative interactions in single cells</article-title>
        <source>Science</source>
        <year>2018</year>
        <volume>362</volume>
        <issue>6413</issue>
        <fpage>eaau1783</fpage>
        <pub-id pub-id-type="doi">10.1126/science.aau1783</pub-id>
        <?supplied-pmid 30361340?>
        <pub-id pub-id-type="pmid">30361340</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <mixed-citation publication-type="other">Cardozo Gizzi AM, Cattoni DI, Fiche J-B, Espinola SM, Gurgo J, Messina O, Houbron C, Ogiyama Y, Papadopoulos GL, Cavalli G, Lagha M, Nollmann M. Microscopy-based chromosome conformation capture Enables simultaneous visualization of genome organization and transcription in intact organisms. Mol Cell.2019. 10.1016/j.molcel.2019.01.011.</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mateo</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Hafner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cinquini</surname>
            <given-names>IS</given-names>
          </name>
          <name>
            <surname>Walker</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Boettiger</surname>
            <given-names>AN</given-names>
          </name>
        </person-group>
        <article-title>Visualizing DNA folding and RNA in embryos at single-cell resolution</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>568</volume>
        <fpage>49</fpage>
        <lpage>54</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1035-4</pub-id>
        <?supplied-pmid 30886393?>
        <pub-id pub-id-type="pmid">30886393</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Radda</surname>
            <given-names>JSD</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Katz</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Multiplexed imaging of nucleome architectures in single cells of mammalian tissue</article-title>
        <source>Nat Commun</source>
        <year>2020</year>
        <volume>11</volume>
        <fpage>2907</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-16732-5</pub-id>
        <?supplied-pmid 32518300?>
        <pub-id pub-id-type="pmid">32518300</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Takei</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yun</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ollikainen</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Pierson</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Shah</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Thomassie</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Suo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Eng</surname>
            <given-names>C-HL</given-names>
          </name>
          <name>
            <surname>Guttman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>G-C</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Integrated spatial genomics reveals global architecture of single nuclei</article-title>
        <source>Nature</source>
        <year>2021</year>
        <volume>590</volume>
        <fpage>344</fpage>
        <lpage>350</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-020-03126-2</pub-id>
        <?supplied-pmid 33505024?>
        <pub-id pub-id-type="pmid">33505024</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Espinola</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Götz</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bellec</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Messina</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Fiche</surname>
            <given-names>J-B</given-names>
          </name>
          <name>
            <surname>Houbron</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Dejean</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Reim</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Cardozo Gizzi</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Lagha</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nollmann</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Cis-regulatory chromatin loops arise before TADs and gene activation, and are independent of cell fate during early Drosophila development</article-title>
        <source>Nat Genet</source>
        <year>2021</year>
        <volume>53</volume>
        <fpage>477</fpage>
        <lpage>486</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-021-00816-z</pub-id>
        <?supplied-pmid 33795867?>
        <pub-id pub-id-type="pmid">33795867</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cardozo Gizzi</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Espinola</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Gurgo</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Houbron</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Fiche</surname>
            <given-names>J-B</given-names>
          </name>
          <name>
            <surname>Cattoni</surname>
            <given-names>DI</given-names>
          </name>
          <name>
            <surname>Nollmann</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Direct and simultaneous observation of transcription and chromosome architecture in single cells with Hi-M</article-title>
        <source>Nat Protoc</source>
        <year>2020</year>
        <volume>15</volume>
        <fpage>840</fpage>
        <lpage>876</lpage>
        <pub-id pub-id-type="doi">10.1038/s41596-019-0269-9</pub-id>
        <?supplied-pmid 31969721?>
        <pub-id pub-id-type="pmid">31969721</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mateo</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Sinnott-Armstrong</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Boettiger</surname>
            <given-names>AN</given-names>
          </name>
        </person-group>
        <article-title>Tracing DNA paths and RNA profiles in cultured cells and tissues with ORCA</article-title>
        <source>Nat Protoc</source>
        <year>2021</year>
        <volume>16</volume>
        <fpage>1647</fpage>
        <lpage>1713</lpage>
        <pub-id pub-id-type="doi">10.1038/s41596-020-00478-x</pub-id>
        <?supplied-pmid 33619390?>
        <pub-id pub-id-type="pmid">33619390</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Radda</surname>
            <given-names>JSD</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Jin</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Chromatin tracing and multiplexed imaging of nucleome architectures (MINA) and RNAs in single mammalian cells and tissue</article-title>
        <source>Nat Protoc</source>
        <year>2021</year>
        <volume>16</volume>
        <fpage>2667</fpage>
        <lpage>2697</lpage>
        <pub-id pub-id-type="doi">10.1038/s41596-021-00518-0</pub-id>
        <?supplied-pmid 33903756?>
        <pub-id pub-id-type="pmid">33903756</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Barho F, Fiche J-B, Bardou M, Messina O, Martiniere A, Houbron C, Nollmann M. Qudi-HiM: an open-source acquisition software package for highly multiplexed sequential and combinatorial optical imaging. Open Research Europe. 2022;2, 46 Preprint at 10.12688/openreseurope.14641.2.</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Genome-wide tracing to decipher nuclear organization. Curr Opin Cell Biol. 2023;82:102175.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Schmidt U, Weigert M, Broaddus C, Myers G. in Medical Image Computing and Computer Assisted Intervention – MICCAI 2018 265–273 (Springer International Publishing, 2018).</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Imbert</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ouyang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Safieddine</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Coleno</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Zimmer</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bertrand</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Walter</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Mueller</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>FISH-quant v2: a scalable and modular tool for smFISH image analysis</article-title>
        <source>RNA</source>
        <year>2022</year>
        <volume>28</volume>
        <fpage>786</fpage>
        <lpage>795</lpage>
        <pub-id pub-id-type="doi">10.1261/rna.079073.121</pub-id>
        <?supplied-pmid 35347070?>
        <pub-id pub-id-type="pmid">35347070</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stringer</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Michaelos</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pachitariu</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Cellpose: a generalist algorithm for cellular segmentation</article-title>
        <source>Nat Methods</source>
        <year>2021</year>
        <volume>18</volume>
        <fpage>100</fpage>
        <lpage>106</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-020-01018-x</pub-id>
        <?supplied-pmid 33318659?>
        <pub-id pub-id-type="pmid">33318659</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robitaille</surname>
            <given-names>TP</given-names>
          </name>
          <name>
            <surname>Tollerud</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Greenfield</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Droettboom</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bray</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Aldcroft</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ginsburg</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Price-Whelan</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Kerzendorf</surname>
            <given-names>WE</given-names>
          </name>
          <name>
            <surname>Conley</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Crighton</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Barbary</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Muna</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ferguson</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Grollier</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Parikh</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Nair</surname>
            <given-names>PH</given-names>
          </name>
          <name>
            <surname>Günther</surname>
            <given-names>HM</given-names>
          </name>
          <name>
            <surname>Deil</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Woillez</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Conseil</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kramer</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Turner</surname>
            <given-names>JEH</given-names>
          </name>
          <name>
            <surname>Singer</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Fox</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Weaver</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Zabalza</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Edwards</surname>
            <given-names>ZI</given-names>
          </name>
          <name>
            <surname>Azalee Bostroem</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Burke</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Casey</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Crawford</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Dencheva</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Ely</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jenness</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Labrie</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lim</surname>
            <given-names>PL</given-names>
          </name>
          <name>
            <surname>Pierfederici</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Pontzen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ptak</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Refsdal</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Servillat</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Streicher</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Astropy: a community python package for astronomy</article-title>
        <source>Astron Astrophys Suppl Ser</source>
        <year>2013</year>
        <volume>558</volume>
        <fpage>A33</fpage>
        <pub-id pub-id-type="doi">10.1051/0004-6361/201322068</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Bradley L, Sipőcz B, Robitaille T, Tollerud E, Vinícius Z, Deil C, Barbary K, Wilson TJ, Busko I, Donath A, Günther HM, Cara M, Lim P L, Meßlinger S, Conseil S, Bostroem A, Droettboom M, Bray EM, Bratholm LA, Barentsen G, Craig M, Rathi S, Pascual S, Perren G, Georgiev IY, de Val-Borro M, Kerzendorf W, Bach YP, Quint B, Souchereau H. astropy/photutils: 1.5.0. (Zenodo, 2022). 10.5281/ZENODO.6825092.</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kleinberg</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Comellas</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Monaghan</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Shefelbine</surname>
            <given-names>SJ</given-names>
          </name>
        </person-group>
        <article-title>Usability of deep learning pipelines for 3D nuclei identification with Stardist and Cellpose</article-title>
        <source>Cells Dev</source>
        <year>2022</year>
        <volume>172</volume>
        <fpage>203806</fpage>
        <pub-id pub-id-type="doi">10.1016/j.cdev.2022.203806</pub-id>
        <?supplied-pmid 36029974?>
        <pub-id pub-id-type="pmid">36029974</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jia</surname>
            <given-names>BB</given-names>
          </name>
          <name>
            <surname>Jussila</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kern</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>A spatial genome aligner for resolving chromatin architectures from multiplexed DNA FISH</article-title>
        <source>Nat Biotechnol</source>
        <year>2023</year>
        <volume>41</volume>
        <fpage>1004</fpage>
        <lpage>1017</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-022-01568-9</pub-id>
        <?supplied-pmid 36593410?>
        <pub-id pub-id-type="pmid">36593410</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <mixed-citation publication-type="other">Devos X, Nollmann M. pyHiM: Multiplexed DNA-FISH data analysis pipeline. Github. 2023. <ext-link ext-link-type="uri" xlink:href="https://github.com/marcnol/pyHiM">https://github.com/marcnol/pyHiM</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">Devos X, Nollmann M. PyHiM documentation. Readthedocs. 2023. <ext-link ext-link-type="uri" xlink:href="https://pyhim.readthedocs.io/en/latest/">https://pyhim.readthedocs.io/en/latest/</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Fiche J-B, Devos X, Nollmann M. Stardist models for pyHiM. 2022. <ext-link ext-link-type="uri" xlink:href="https://osf.io/ugpyh/">https://osf.io/ugpyh/</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Messina O, Schaeffer M, Devos X, Fiche J-B. <ext-link ext-link-type="uri" xlink:href="http://paperpile.com/b/jloBXk/qync">http://paperpile.com/b/jloBXk/qync</ext-link> &amp; Nollmann, M. Small dataset for pyHiM. <ext-link ext-link-type="uri" xlink:href="https://osf.io/6egdc/">https://osf.io/6egdc/</ext-link>. 2023.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10863255</article-id>
    <article-id pub-id-type="publisher-id">3178</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-024-03178-x</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>pyHiM: a new open-source, multi-platform software package for spatial genomics based on multiplexed DNA-FISH imaging</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Devos</surname>
          <given-names>Xavier</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Fiche</surname>
          <given-names>Jean-Bernard</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bardou</surname>
          <given-names>Marion</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Messina</surname>
          <given-names>Olivier</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Houbron</surname>
          <given-names>Christophe</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gurgo</surname>
          <given-names>Julian</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Schaeffer</surname>
          <given-names>Marie</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Götz</surname>
          <given-names>Markus</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Walter</surname>
          <given-names>Thomas</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mueller</surname>
          <given-names>Florian</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3339-2349</contrib-id>
        <name>
          <surname>Nollmann</surname>
          <given-names>Marcelo</given-names>
        </name>
        <address>
          <email>marcnol@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.121334.6</institution-id><institution-id institution-id-type="ISNI">0000 0001 2097 0141</institution-id><institution>Centre de Biologie Structurale, </institution><institution>Univ Montpellier, CNRS UMR 5048, INSERM U1054, </institution></institution-wrap>34090 Montpellier, France </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/013cjyk83</institution-id><institution-id institution-id-type="GRID">grid.440907.e</institution-id><institution-id institution-id-type="ISNI">0000 0004 1784 3645</institution-id><institution>Centre for Computational Biology (CBIO), </institution><institution>Mines Paris, PSL University, </institution></institution-wrap>75006 Paris, France </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/04t0gwh46</institution-id><institution-id institution-id-type="GRID">grid.418596.7</institution-id><institution-id institution-id-type="ISNI">0000 0004 0639 6384</institution-id><institution>Institut Curie, </institution></institution-wrap>75248 Paris, Cedex France </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/02vjkv261</institution-id><institution-id institution-id-type="GRID">grid.7429.8</institution-id><institution-id institution-id-type="ISNI">0000 0001 2186 6389</institution-id><institution>INSERM, U900, </institution></institution-wrap>75248 Paris, Cedex France </aff>
      <aff id="Aff5"><label>5</label>Imaging and Modeling Unit, Institut Pasteur, Université Paris Cité, Paris, France </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>13</day>
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>13</day>
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2024</year>
    </pub-date>
    <volume>25</volume>
    <elocation-id>47</elocation-id>
    <history>
      <date date-type="received">
        <day>7</day>
        <month>8</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>29</day>
        <month>1</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Genome-wide ensemble sequencing methods improved our understanding of chromatin organization in eukaryotes but lack the ability to capture single-cell heterogeneity and spatial organization. To overcome these limitations, new imaging-based methods have emerged, giving rise to the field of spatial genomics. Here, we present pyHiM, a user-friendly python toolbox specifically designed for the analysis of multiplexed DNA-FISH data and the reconstruction of chromatin traces in individual cells. pyHiM employs a modular architecture, allowing independent execution of analysis steps and customization according to sample specificity and computing resources. pyHiM aims to facilitate the democratization and standardization of spatial genomics analysis.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13059-024-03178-x.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Spatial genomics</kwd>
      <kwd>3D chromatin structure</kwd>
      <kwd>Transcription</kwd>
      <kwd>Imaging</kwd>
      <kwd>Bioimage informatics</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100019180</institution-id>
            <institution>HORIZON EUROPE European Research Council</institution>
          </institution-wrap>
        </funding-source>
        <award-id>724429</award-id>
        <principal-award-recipient>
          <name>
            <surname>Nollmann</surname>
            <given-names>Marcelo</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100007492</institution-id>
            <institution>Fondation Bettencourt Schueller</institution>
          </institution-wrap>
        </funding-source>
        <award-id>coup d'elan 2017</award-id>
        <principal-award-recipient>
          <name>
            <surname>Nollmann</surname>
            <given-names>Marcelo</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>francebioImaging</institution>
        </funding-source>
        <award-id>ANR-10-INBS-04</award-id>
        <principal-award-recipient>
          <name>
            <surname>Nollmann</surname>
            <given-names>Marcelo</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2024</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par2">In eukaryotes, the three-dimensional (3D) nuclear organization of chromatin is tightly controlled and plays an active role in gene regulation, DNA replication and DNA damage repair. In the last decade, genome-wide ensemble methods, such as Hi-C and 3C [<xref ref-type="bibr" rid="CR1">1</xref>], have revolutionized our understanding of genome structure at the megabase-to-kilobase scale by revealing the complex organization of chromatin into compartments, topologically associating domains, and chromatin loops [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>]. However, these bulk approaches are unable to dissect single-cell heterogeneity or preserve spatial information in tissue [<xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR6">6</xref>].</p>
    <p id="Par3">Recently, a new family of imaging-based methods was developed to trace the 3D conformation of chromatin in single cells, giving rise to the field of spatial genomics [<xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR11">11</xref>] (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). These techniques perform sequential imaging of genomic loci with a precision of a few tens of nanometers, allowing for the 3D mapping of a given region of chromatin at kilobase resolution in thousands of individual cells [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. Our specific implementation, called Hi-M, couples detection of chromatin structure and transcriptional output [<xref ref-type="bibr" rid="CR8">8</xref>] (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). Since their creation, spatial genomics methods based on sequential imaging were successfully used for the detection of short- and long-range chromatin interactions in multiple model systems, including mammalian cultured cells, fly embryos, and mouse tissues [<xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. Critically, imaging-based spatial genomics technologies complement transcriptomic surveys of single cells in their spatial context and thus have the potential to lead to important new discoveries in multiple fields, including 3D genomics, transcriptional regulation, DNA replication, or DNA repair.<fig id="Fig1"><label>Fig. 1</label><caption><p><bold>a</bold> Schematic description of Hi-M microscopy: Chromatin is imaged through multiple acquisition cycles, each targeting a specific genomic locus using a set of unique DNA-FISH oligonucleotides targeted by a complementary, fluorescently labeled oligonucleotide. A fiducial marker is simultaneously imaged to allow for registration and drift correction during post-processing. Using pyHiM, the 3D conformation of the target locus is reconstructed for each individual cell. <bold>b</bold> pyHiM is an open-source project hosted on GitHub. Extensive documentation and Jupyter notebooks are available for users and developers. <bold>c</bold> pyHiM is developed in Python and runs indifferently on Linux, Windows and macOS. <bold>d</bold> Input data: 3D images are organized by imaging channel (DAPI, fiducial, DNA-FISH spots, etc.) and FOV. A single json file combines all parameters needed to run the analysis pipeline. <bold>e</bold> 3D images are pre-processed by calculating the maximum intensity projection and applying 2D registration based on the fiducial images. <bold>f</bold> Masks for nuclei, oligopaint libraries, and DNA-FISH spots are computed using pre-trained deep learning models. Individual DNA-FISH spots are localized with sub-pixel accuracy using apiFISH (fork of big-FISH). <bold>g</bold> Individual traces are built by combining the localizations of all DNA-FISH spots detected within the same mask. Results are saved in ECSV format. <bold>f</bold> Post-processing analyses are performed to obtain pairwise distance and proximity frequency matrices for each combination of DNA loci and for different spatial regions of the sample containing different cell types</p></caption><graphic xlink:href="13059_2024_3178_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par4">In recent years, several efforts were made to promote a wider use of these new technologies by sharing experimental and image analysis protocols [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR13">13</xref>–<xref ref-type="bibr" rid="CR16">16</xref>]. However, democratization of spatial genomics will require the development of open-source and user-friendly software packages for reconstructing chromatin traces (i.e., unique sets of 3D coordinates describing a locus conformation in an individual cell) from raw, 3D, multicolor images [<xref ref-type="bibr" rid="CR17">17</xref>]. To this end, such software should (1) provide access to validated cutting-edge techniques required for the analysis of spatial genomics data, (2) use a license-free programming language, (3) provide extensive documentation and tutorials to guide new users and allow development of new functionalities, (4) adopt a modular architecture to facilitate adaptation to future developments in spatial genomics, and (5) use novel analysis methods to ensure robust, automatic analysis of large data sets (several Tb per experiment) without user input and in reasonable times.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <p id="Par5">To address these needs, we introduce pyHiM, an open-source, modular and scalable software toolbox specifically designed for sequential spatial genomics data analysis (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). pyHiM comes with extensive user and developer documentation, Jupyter Notebook tutorials, and a DNA-FISH dataset to guide new users through the main steps of a typical analysis pipeline (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). PyHiM can be easily installed using standard package management tools (conda and PyPi, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1a) and conveniently runs on Linux, Windows, and macOS (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c). A single human-readable configuration file is used to centralize all analysis parameters and can be edited thanks to a user-friendly graphical user interface (GUI) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1b). In addition, a command-line interface enables execution on multiple hardware platforms, from laptop computers to high-performance computing (HPC) clusters. Functionality can be tuned according to local hardware specifications, acquisition conditions (e.g., number of channels, size of 3D image stacks), and sample properties.</p>
    <p id="Par6">The analysis pipeline of pyHiM is organized in modules, each performing a specific analysis task. The inputs of pyHiM are 3D image stacks in the universal TIFF format (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a, d). Deconvolution of images before pyHiM execution is not mandatory for pyHiM analysis but, in our experience, improves the quality of the results and the statistics of reconstructed chromatin traces.</p>
    <p id="Par7">The pre-processing module organizes images by field of view (FOV) and by the type of probe imaged: DNA-FISH spots, nuclear/ oligopaint library masks, fiducial marks, or RNA expression. For each FOV, pyHiM first performs a projection and global registration using fiducial images acquired at each cycle as references (Fig. <xref rid="Fig1" ref-type="fig">1</xref>e). To improve the robustness of this step, we implemented a new method whereby the image is decomposed in blocks that are independently co-aligned. A polling step then determines the most popular global registration and applies it to the whole image (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2a). This step allows for a global correction of thermal drift and stage repeatability error even for cycles with fiducial images displaying local distortions. Samples such as embryos or tissues may often display local deformations during acquisition of different cycles which cannot be taken into account by global registration algorithms. Thus, we developed a new local registration algorithm that optimizes 3D registrations locally to correct for 3D sample deformations (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2b, c).</p>
    <p id="Par8">The spot detection module performs segmentation and localization of DNA-FISH spots with sub-pixel accuracy of all sequential imaging rounds, using a combination of Deep Learning (DL)-powered spot segmentation followed by robust and automated 3D Gaussian fitting. 3D-DL segmentation is performed using a StarDist neural network [<xref ref-type="bibr" rid="CR18">18</xref>] trained to robustly detect 3D-Point Spread Functions (PSF) in diverse sample types and illumination conditions. We obtained this network after extensive simulations of PSFs with different signal-to-noise ratios and inhomogeneous background levels. Next, based on the centroid position of each DL-mask, a robust 3D Gaussian fit of the intensity distribution is performed using apiFISH (Fig. <xref rid="Fig1" ref-type="fig">1</xref>f and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3) [<xref ref-type="bibr" rid="CR19">19</xref>].</p>
    <p id="Par9">The mask detection module segments nuclei in 3D using pre-trained StarDist neural networks models [<xref ref-type="bibr" rid="CR18">18</xref>] (Fig. <xref rid="Fig1" ref-type="fig">1</xref>f). Other custom models based on StarDist or other popular architectures (e.g., Cellpose [<xref ref-type="bibr" rid="CR20">20</xref>]) can also be integrated via a plugin. Finally, DNA-FISH spots localized within the same mask are combined into chromatin traces, which are assigned a universally unique identifier and tabulated in human-readable Enhanced Character-Separated Values (ECSV) format (Fig. <xref rid="Fig1" ref-type="fig">1</xref>g and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4a, b). Additional labels, based on RNA expression levels or spatial cell distribution, can be assigned to each single trace, allowing for cell/tissue-specific post-processing analysis (Fig. <xref rid="Fig1" ref-type="fig">1</xref>h).</p>
    <p id="Par10">Thanks to pyHiM’s modular architecture, each analysis step in the pipeline (registration, detection, tracing, etc.) can be run independently. Users can tailor the analysis workflow according to their sample specificity, acquisition conditions, and available computing resources (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a). Intermediate results, such as unfiltered localizations or traces, are saved in ECSV format after each module execution, allowing the user to perform custom data validation or additional analysis. Finally, each module produces reports in human-readable markdown files with snapshot images illustrating the performance of the analysis for each cycle and FOV. This allows the user to efficiently assess the quality of the analyses and eventually fine-tune parameters to improve them (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a–c and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S2, S3). pyHiM can successfully analyze experimental data acquired from a variety of sample types, ranging from fly embryos to mouse and human tissues (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d, e).<fig id="Fig2"><label>Fig. 2</label><caption><p><bold>a</bold> Illustration of a typical pyHiM analysis on mouse tissues: examples of raw data are shown in the top row and the most relevant pyHiM outputs are shown in the bottom row. From left to right, raw DAPI data are segmented to compute the 3D masks of each individual nucleus. Next, 2D and 3D registration of the fiducial is performed for each imaging cycle, and the quality of the correction can be quickly assessed based on the output image. Then, the localization of individual DNA-FISH spots is performed in two steps: first, a 3D mask of each DNA-FISH spot is computed using deep learning. Then, using the mask position as a reference, the sub-pixel localization of the spot is inferred using apiFISH. Scale bars = 8 μm. <bold>b</bold> Chromatin tracks are calculated by combining all individual DNA-FISH spot localizations detected within the same mask (DAPI, or locus). Each individual trace represents a snapshot of the locus conformation within a single cell (see reconstruction with two different orientations). <bold>c</bold> Data quality assessment: (top) the N-matrix represents the number of times that each pair of DNA loci was detected in the dataset and is indicative of their detection efficiency. (bottom) The distribution of pairwise distances between DNA-FISH spots in the same chromatin trace is plotted to ensure that there is no major error in the analysis (detection threshold, etc.). <bold>d</bold> Traces computed by pyHiM were sorted based on RNA expression profiles in NC14 fly embryos and assigned to specific cell types (e.g., mesoderm vs. neuroectoderm). Specific long-range interactions and chromatin organization are observed for each cell type. <bold>e</bold> Fast 2D analysis based only on the projected 3D data is used to optimize parameters and test data quality. An example from mouse tissue data shows the pairwise distance maps computed using 2D (top) and 3D (bottom) analysis. The 2D map captures most of the features that characterize the conformation of the locus. <bold>f</bold> Comparison of pyHiM execution times for different number of cycles and for a desktop computer (Intel(R) Core(TM) i7-8700 CPU @ 3.20 GHz, CPUs: 12, cores: 6, threads per core: 2, memory: 16 Gb) or a multi-threaded server (AMD EPYC 7702 64-Core Processor 3.34 GHz, CPUs: 256, cores: 128, threads per core: 2, memory: 512 Gb). <bold>g</bold> Performance of pyHiM using single-threaded or DASK-powered multi-threading</p></caption><graphic xlink:href="13059_2024_3178_Fig2_HTML" id="MO2"/></fig></p>
    <p id="Par11">pyHiM also offers a number of additional features that facilitate data formatting, result display, and post-processing. For instance, DNA-FISH spot detection efficiency and maps of the pairwise distance (PWD) distributions between DNA-FISH spots from different cycles (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c), or proximity frequency matrices for specific cell types (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d). Another important feature of pyHiM is its ability to perform rapid analysis in 2D (Fig. <xref rid="Fig2" ref-type="fig">2</xref>e). In this mode, pyHiM projects signals from DNA-FISH spots and masks in 2D and performs registration, segmentation, spot localization, and tracing in 2D. Contact maps computed using the 2D pipeline show all the relevant features of 3D maps (long-range contacts, TADs, etc.) but require ~ 5 × less computation time (Fig. <xref rid="Fig2" ref-type="fig">2</xref>e, f) and can therefore be used to quickly assess the quality of the acquired dataset before full 3D analysis.</p>
    <p id="Par12">Finally, a critical aspect of multiplexed DNA-FISH imaging is the amount of data generated, typically ~ 1–3 Tb per experiment depending on the number of cycles and the number of FOVs. To handle and analyze such large volumes of data in a reasonable time, we have implemented a parallelization mode based on the Dask Python package. For this, pyHiM analyzes data associated with different hybridization cycles in parallel, while keeping the technical aspects transparent to the user, leading to a drastic shortening in computation time (Fig. <xref rid="Fig2" ref-type="fig">2</xref>f, g). Conveniently, a reporting web-server based on Bokeh can be launched to monitor analysis status and performance in real-time (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4c). As a result, pyHiM can run indifferently on a laptop or an HPC cluster and be tuned according to the technical specificities of both (e.g., number of CPUs, available memory, availability of GPUs, etc.).</p>
  </sec>
  <sec id="Sec3">
    <title>Conclusions</title>
    <p id="Par13">In summary, we describe pyHiM, a modular, user-friendly, well-documented tool for chromatin tracing analysis based on sequential DNA-FISH imaging. pyHiM can be used to analyze data produced by Hi-M or by other spatial genomics methods. Thus, we envision that the adoption of pyHiM will enable the growth of a new user community for this active field of research. Indeed, as data acquisition and sample preparation become standard and even commercially available, a final bottleneck for widespread adoption will be the availability of flexible image analysis tool boxes dedicated to chromatin tracing. Thus, a well-tested and user-friendly analysis pipeline such as pyHiM will be key to break barriers to adoption of spatial genomics by users and microscopy facilities, to promote transparent image analysis pipelines in the field, and to create a large user community to accelerate discoveries and new developments. The modularity, open-source nature, and extensive developer documentation of pyHiM were purposefully designed to promote collaborative developments, to standardize and benchmark image analysis practices, and to facilitate reuse of existing algorithms to implement analysis tools for novel technologies in the blooming field of spatial genomics.</p>
  </sec>
  <sec id="Sec4">
    <title>Methods</title>
    <sec id="Sec5">
      <title>Inputs</title>
      <p id="Par14">The two minimal inputs of pyHiM are as follows: a dictionary of parameters (<italic>parameters.json</italic>) and a list of images to process. <italic>parameters.json</italic> contains acquisition parameters (e.g., pixel size), file formatting parameters (e.g., regular expression to decode filenames), and all the parameters that are required for the execution of each module in pyHiM. For detailed information on the <italic>parameters.json</italic> parameter file, please refer to our online resource: Input Parameters.</p>
      <p id="Par15">Input images can be of two types: DNA-FISH spots for a given cycle and masks used for tracing. The latter can be either nuclear masks (e.g., from DAPI labeling) or from a cycle where the whole oligopaint library is labeled and imaged at once. Both DNA-FISH and mask images must be accompanied by a corresponding fiducial image used for registration (see the “<xref rid="Sec7" ref-type="sec">Registration</xref>” section). Images are assumed to be in the universal and non-proprietary TIFF format. Use of deconvolved images is recommended but not compulsory.</p>
    </sec>
    <sec id="Sec6">
      <title>Projection</title>
      <p id="Par16">We developed a tool for image reprojection (module: <italic>makeProjections</italic>). This step is necessary for lateral global drift alignment (see the”Registration” section) and for the rapid visual inspection of input files. Sum and maximum projections are implemented and configured through the <italic>parameters.json</italic> parameters file. We recommend the former for masks and the latter for DNA-FISH images. makeProjections allows for the manual selection of the <italic>z</italic>-range and implements an automatic algorithm to robustly retrieve the in-focus plane. Briefly, this method estimates the optimal in-focus plane by calculating the maximum of the Laplacian of the intensity profile along the <italic>z</italic>-axis. The calculation is performed block-by-block to take into account local variability and sample drift. More details on the methods and the execution of this module can be found in the online description of the <italic>makeProjections</italic> module.</p>
    </sec>
    <sec id="Sec7">
      <title>Registration</title>
      <p id="Par17">We implemented two registration methods to obtain automatic and robust global and local realignments. The <italic>alignImages</italic> module performs global realignments by registering the 2D z-reprojected fiducial images using 2D cross-correlation. This method, however, can be unreliable when fiducial images contain impurities that vary between cycles. To solve this, we developed a second algorithm (<italic>alignByBlock</italic>) that uses block-by-block decomposition to determine the best registration for each block. This calculation is followed by a polling operation that retrieves the most satisfactory global registration. This second method is highly robust to impurities. More details on the methods and the execution of this module can be found in our online description of the <italic>alignImages</italic> module. Once registrations for each cycle are processed, the module <italic>appliesRegistrations</italic> re-interpolates 2D images of DNA-FISH spots and masks to provide a visual input of the performance of global registrations for each hybridization cycle.</p>
      <p id="Par18">Biological samples can display local deformations (typically in the hundreds of nm range) during the long-term acquisition times of a HiM dataset. These distortions cannot be properly corrected by global 2D realignment routines. To tackle this issue, we developed a new registration method that performs local 3D registration. In this method, images are first globally realigned in 2D. Next, fiducial images are decomposed in 3D blocks and each block is realigned by 3D cross-correlation and re-interpolation. The resulting local block corrections are stored as an ASTROPY table [<xref ref-type="bibr" rid="CR21">21</xref>] that is used by the <italic>register_localizations</italic> module (see section below). More details on the methods and the execution of this module can be found in our online description of the <italic>alignImages3D</italic> module.</p>
    </sec>
    <sec id="Sec8">
      <title>Segmentation and detection</title>
      <p id="Par19">Three different modules were built to deal with the segmentation and detection of DNA-FISH spots and masks. First, we developed a module for the segmentation and localization of masks and sources in 2D (module: <italic>SegmentMasks</italic>). Mask and DNA-FISH images are segmented using startdist with pre-trained networks. Segmented objects are filtered by size and shape, while merged objects are split using the watershed algorithm. DNA-FISH spots are fitted using the highly efficient DAOStarFinder algorithm from photutils [<xref ref-type="bibr" rid="CR22">22</xref>] and post-processed using <italic>filter_localizations</italic>.</p>
      <p id="Par20">Second, we developed a module specifically designed to segment masks in 3D (module: <italic>segmentMasks3D</italic>). <italic>segmentMasks3D</italic> relies on deep-learning segmentation using a network that we trained specifically to robustly segment nuclei in 3D with stardist [<xref ref-type="bibr" rid="CR23">23</xref>]<italic>.</italic> Other DL segmentation tools, such as cellpose [<xref ref-type="bibr" rid="CR20">20</xref>], can be used to further increase the flexibility of mask segmentation for different biological samples (script: mask_cellpose.py). <italic>segmentMasks3D</italic> then post-processes 3D masks by size and shape filtering, and applies a watershed algorithm to split merged masks. The output of <italic>segmentMasks3D</italic> is a localizations table used by the <italic>build_traces</italic> module to group localizations into single chromatin traces (see the “<xref rid="Sec9" ref-type="sec">Tracing</xref>” section) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3c). More details on the methods and the execution of this module can be found in our online description of the <italic>segmentMasks3D</italic> module.</p>
      <p id="Par21">Finally, we developed a module for the segmentation and localization of DNA-FISH spots (module: <italic>segmentSources3D</italic>). <italic>segmentSources3D</italic> segments DNA-FISH spots by using a stardist DL network trained to detect PSFs in 3D. This network was optimized by training the DL network on simulated data displaying large variations in signal-to-noise ratios, local background inhomogeneities, and intensity levels. After segmentation, <italic>segmentSources3D</italic> fits the intensity distributions within DNA-FISH spot masks with a 3D-Gaussian model using non-linear regression with functions from apiFISH [<xref ref-type="bibr" rid="CR19">19</xref>]. The output <italic>segmentSources3D</italic> is an ASTROPY table containing the <italic>xyz</italic> coordinates, identities, and properties of all the localizations. Localizations with low intensities are filtered in post-processing using the module <italic>filter_localizations</italic>. A final step before tracing involves the application of local registrations to the localization tables obtained from <italic>segmentMasks</italic> or from <italic>segmentSources3D using the register_localizations module.</italic> Our trained stardist DL networks were packed with pyHiM and are also available from our pyHiM OSF repository.</p>
    </sec>
    <sec id="Sec9">
      <title>Tracing</title>
      <p id="Par22">The final step involves the grouping of DNA-FISH spots belonging to the same chromatin fiber (module: <italic>build_traces</italic>). This can be accomplished in two manners. The first involves spatial clustering based on nearest-neighbor distances with the KDTree algorithm. This method works well for low-density samples, where nuclei are well-separated in space. The second, instead, relies on the use of user-provided masks. In this case, traces are built by grouping together the spots belonging to the same mask. Masks can be derived either from nuclei (e.g., from DAPI staining) or from a cycle labeling the entire oligopaint library. The output of <italic>build_traces</italic> is a trace table in ASTROPY format where each trace is stamped with a universal unique identifier to enable the automatic merging of multiple trace tables and to ensure traceability. We note that no corrections for missing or redundant barcode localizations are applied by <italic>build_traces</italic> as such corrections are often sample dependent. In pyHiM, these issues are handled by post-processing scripts (see below). More details on the methods and the execution of this module can be found in our online description of the <italic>build_traces</italic> module.</p>
      <p id="Par23">We developed several tools for post-processing of trace tables. <italic>Trace_assign_mask</italic> finds traces that match specific morphological or gene-expression patterns by matching trace localization with user-provided masks. <italic>Trace_combinator</italic> and <italic>trace_merge</italic> fuse traces from different FOVs or different experiments. <italic>Trace_filter</italic> is a general tool for filtering traces that can remove specific barcodes from a trace table, remove duplicated localizations from single traces, and perform spatial filtering. <italic>Trace_filter_advanced</italic>, instead, removes duplicate localizations based on distance constraints. Finally, <italic>trace_analyzer</italic> analyzes a trace table to calculate the distribution in the number of barcodes detected per trace, the number of times each barcode appears in single traces, and the spatial clustering of traces. We highlight the existence of more sophisticated methods to improve the quality of tracing [<xref ref-type="bibr" rid="CR24">24</xref>] that may be applied in combination with the post-processing scripts mentioned in this paragraph.</p>
      <p id="Par24">Finally, we developed an algorithm that builds maps from trace tables (module: <italic>build_matrix</italic>). This tool produces conventional pair-wise median distance maps by relying on kernel-density estimators to accurately calculate the maximum of each distance distribution, and calculates proximity distance maps for user-specified threshold distances. <italic>Build_matrix</italic> produces N-maps which contain the number of localizations detected for each combination of barcodes, a diagnostic tool that is fundamental to determine the performance of an experiment and the robustness of detection for each barcode pair. More details on the methods and execution of this module can be found in our online description of the <italic>build_matrix</italic> module.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec13">
      <title>Supplementary Information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2024_3178_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1.</bold> Supplementary figures.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2024_3178_MOESM2_ESM.docx">
            <caption>
              <p><bold>Additional file 2.</bold> Review history.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Xavier Devos and Jean-Bernard Fiche are co-first authors.</p>
    </fn>
  </fn-group>
  <ack>
    <sec id="FPar1">
      <title>Review history</title>
      <p id="Par25">The review history is available as Additional file <xref rid="MOESM2" ref-type="media">2</xref>.</p>
    </sec>
    <sec id="FPar2">
      <title>Peer review information</title>
      <p id="Par26">Veronique van den Berghe was the primary editor of this article and managed its editorial process and peer review in collaboration with the rest of the editorial team.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>X.D., J-B.F., C.H., and M.N. wrote the code for pyHiM. J-B.F developed and validated deep learning networks. X.D. wrote the documentation with help from M.S. and M.N. X.D., M.N., and O.M worked in the Jupyter lab tutorials. M.B., C.H., J.G., M.S., and M.G. participated in benchmarking and debugging activities. O.M. and M.S. collected the small dataset. J-B.F and M.N. wrote the manuscript. X.D. and J-B.F made the figures. M.N., F.M., and T.W. participated in the project design. All authors participated in the final edition of the manuscript.</p>
    <sec id="FPar3">
      <title>Authors’ Twitter/X handles</title>
      <p id="Par27">@marcnol (Marcelo Nollmann).</p>
    </sec>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This project was funded by the European Union’s Horizon 2020 Research and Innovation Program (EpiScope, Grant ID 724429, M.N.). We acknowledge the Bettencourt-Schueller Foundation for their prize ‘Coup d'élan pour la recherche Française’ and the France-BioImaging infrastructure supported by the French National Research Agency (grant ID ANR-10-INBS-04, “Investments for the Future”) for their funding through the cloudFISH project.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The latest stable and development versions of pyHiM are publicly available at our GitHub repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/marcnol/pyHiM">https://github.com/marcnol/pyHiM</ext-link> [<xref ref-type="bibr" rid="CR25">25</xref>]. The 0.9.1 release of pyHiM is permanently available at: <ext-link ext-link-type="uri" xlink:href="https://osf.io/updfw">https://osf.io/updfw</ext-link> (10.17605/OSF.IO/UPDFW).</p>
    <p>The online documentation is available at <ext-link ext-link-type="uri" xlink:href="https://pyhim.readthedocs.io/en/latest/">https://pyhim.readthedocs.io/en/latest/</ext-link> [<xref ref-type="bibr" rid="CR26">26</xref>].</p>
    <p>DL networks trained for pyHiM are available at our OSF repository: <ext-link ext-link-type="uri" xlink:href="https://osf.io/ugpyh/">https://osf.io/ugpyh/</ext-link> [<xref ref-type="bibr" rid="CR27">27</xref>].</p>
    <p>Minimal datasets for multiplexed DNA-FISH data are available from <ext-link ext-link-type="uri" xlink:href="https://osf.io/6egdc/">https://osf.io/6egdc/</ext-link> [<xref ref-type="bibr" rid="CR28">28</xref>].</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar4">
      <title>Ethics approval and consent to participate</title>
      <p id="Par28">Ethical approvals were not needed for this study.</p>
    </notes>
    <notes id="FPar5" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par29">The authors declare no competing interests. </p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kempfer</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Pombo</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Methods for mapping 3D chromosome architecture</article-title>
        <source>Nat Rev Genet</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>207</fpage>
        <lpage>226</lpage>
        <pub-id pub-id-type="doi">10.1038/s41576-019-0195-2</pub-id>
        <?supplied-pmid 31848476?>
        <pub-id pub-id-type="pmid">31848476</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dekker</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Heard</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Structural and functional diversity of topologically associating domains</article-title>
        <source>FEBS Lett</source>
        <year>2015</year>
        <volume>589</volume>
        <fpage>2877</fpage>
        <lpage>2884</lpage>
        <pub-id pub-id-type="doi">10.1016/j.febslet.2015.08.044</pub-id>
        <?supplied-pmid 26348399?>
        <pub-id pub-id-type="pmid">26348399</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <mixed-citation publication-type="other">Jerkovic I, Szabo Q, Bantignies F, Cavalli G. Higher-order chromosomal structures mediate genome function. J Mol Biol. 2019. 10.1016/j.jmb.2019.10.014.</mixed-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schaeffer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nollmann</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Contributions of 3D chromatin structure to cell-type-specific gene regulation</article-title>
        <source>Curr Opin Genet Dev</source>
        <year>2023</year>
        <volume>79</volume>
        <fpage>102032</fpage>
        <pub-id pub-id-type="doi">10.1016/j.gde.2023.102032</pub-id>
        <?supplied-pmid 36893484?>
        <pub-id pub-id-type="pmid">36893484</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bouwman</surname>
            <given-names>BAM</given-names>
          </name>
          <name>
            <surname>Crosetto</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Bienko</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The era of 3D and spatial genomics</article-title>
        <source>Trends Genet</source>
        <year>2022</year>
        <volume>38</volume>
        <fpage>1062</fpage>
        <lpage>1075</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tig.2022.05.010</pub-id>
        <?supplied-pmid 35680466?>
        <pub-id pub-id-type="pmid">35680466</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boettiger</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Advances in chromatin imaging at kilobase-scale resolution</article-title>
        <source>Trends Genet</source>
        <year>2020</year>
        <volume>36</volume>
        <fpage>273</fpage>
        <lpage>287</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tig.2019.12.010</pub-id>
        <?supplied-pmid 32007290?>
        <pub-id pub-id-type="pmid">32007290</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bintu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Mateo</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>J-H</given-names>
          </name>
          <name>
            <surname>Sinnott-Armstrong</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Parker</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kinrot</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yamaya</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Boettiger</surname>
            <given-names>AN</given-names>
          </name>
          <name>
            <surname>Zhuang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Super-resolution chromatin tracing reveals domains and co4operative interactions in single cells</article-title>
        <source>Science</source>
        <year>2018</year>
        <volume>362</volume>
        <issue>6413</issue>
        <fpage>eaau1783</fpage>
        <pub-id pub-id-type="doi">10.1126/science.aau1783</pub-id>
        <?supplied-pmid 30361340?>
        <pub-id pub-id-type="pmid">30361340</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <mixed-citation publication-type="other">Cardozo Gizzi AM, Cattoni DI, Fiche J-B, Espinola SM, Gurgo J, Messina O, Houbron C, Ogiyama Y, Papadopoulos GL, Cavalli G, Lagha M, Nollmann M. Microscopy-based chromosome conformation capture Enables simultaneous visualization of genome organization and transcription in intact organisms. Mol Cell.2019. 10.1016/j.molcel.2019.01.011.</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mateo</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Hafner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cinquini</surname>
            <given-names>IS</given-names>
          </name>
          <name>
            <surname>Walker</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Boettiger</surname>
            <given-names>AN</given-names>
          </name>
        </person-group>
        <article-title>Visualizing DNA folding and RNA in embryos at single-cell resolution</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>568</volume>
        <fpage>49</fpage>
        <lpage>54</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1035-4</pub-id>
        <?supplied-pmid 30886393?>
        <pub-id pub-id-type="pmid">30886393</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Radda</surname>
            <given-names>JSD</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Katz</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Multiplexed imaging of nucleome architectures in single cells of mammalian tissue</article-title>
        <source>Nat Commun</source>
        <year>2020</year>
        <volume>11</volume>
        <fpage>2907</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-16732-5</pub-id>
        <?supplied-pmid 32518300?>
        <pub-id pub-id-type="pmid">32518300</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Takei</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yun</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ollikainen</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Pierson</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Shah</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Thomassie</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Suo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Eng</surname>
            <given-names>C-HL</given-names>
          </name>
          <name>
            <surname>Guttman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>G-C</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Integrated spatial genomics reveals global architecture of single nuclei</article-title>
        <source>Nature</source>
        <year>2021</year>
        <volume>590</volume>
        <fpage>344</fpage>
        <lpage>350</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-020-03126-2</pub-id>
        <?supplied-pmid 33505024?>
        <pub-id pub-id-type="pmid">33505024</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Espinola</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Götz</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bellec</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Messina</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Fiche</surname>
            <given-names>J-B</given-names>
          </name>
          <name>
            <surname>Houbron</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Dejean</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Reim</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Cardozo Gizzi</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Lagha</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nollmann</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Cis-regulatory chromatin loops arise before TADs and gene activation, and are independent of cell fate during early Drosophila development</article-title>
        <source>Nat Genet</source>
        <year>2021</year>
        <volume>53</volume>
        <fpage>477</fpage>
        <lpage>486</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-021-00816-z</pub-id>
        <?supplied-pmid 33795867?>
        <pub-id pub-id-type="pmid">33795867</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cardozo Gizzi</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Espinola</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Gurgo</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Houbron</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Fiche</surname>
            <given-names>J-B</given-names>
          </name>
          <name>
            <surname>Cattoni</surname>
            <given-names>DI</given-names>
          </name>
          <name>
            <surname>Nollmann</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Direct and simultaneous observation of transcription and chromosome architecture in single cells with Hi-M</article-title>
        <source>Nat Protoc</source>
        <year>2020</year>
        <volume>15</volume>
        <fpage>840</fpage>
        <lpage>876</lpage>
        <pub-id pub-id-type="doi">10.1038/s41596-019-0269-9</pub-id>
        <?supplied-pmid 31969721?>
        <pub-id pub-id-type="pmid">31969721</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mateo</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Sinnott-Armstrong</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Boettiger</surname>
            <given-names>AN</given-names>
          </name>
        </person-group>
        <article-title>Tracing DNA paths and RNA profiles in cultured cells and tissues with ORCA</article-title>
        <source>Nat Protoc</source>
        <year>2021</year>
        <volume>16</volume>
        <fpage>1647</fpage>
        <lpage>1713</lpage>
        <pub-id pub-id-type="doi">10.1038/s41596-020-00478-x</pub-id>
        <?supplied-pmid 33619390?>
        <pub-id pub-id-type="pmid">33619390</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Radda</surname>
            <given-names>JSD</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Jin</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Chromatin tracing and multiplexed imaging of nucleome architectures (MINA) and RNAs in single mammalian cells and tissue</article-title>
        <source>Nat Protoc</source>
        <year>2021</year>
        <volume>16</volume>
        <fpage>2667</fpage>
        <lpage>2697</lpage>
        <pub-id pub-id-type="doi">10.1038/s41596-021-00518-0</pub-id>
        <?supplied-pmid 33903756?>
        <pub-id pub-id-type="pmid">33903756</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Barho F, Fiche J-B, Bardou M, Messina O, Martiniere A, Houbron C, Nollmann M. Qudi-HiM: an open-source acquisition software package for highly multiplexed sequential and combinatorial optical imaging. Open Research Europe. 2022;2, 46 Preprint at 10.12688/openreseurope.14641.2.</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Genome-wide tracing to decipher nuclear organization. Curr Opin Cell Biol. 2023;82:102175.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Schmidt U, Weigert M, Broaddus C, Myers G. in Medical Image Computing and Computer Assisted Intervention – MICCAI 2018 265–273 (Springer International Publishing, 2018).</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Imbert</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ouyang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Safieddine</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Coleno</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Zimmer</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bertrand</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Walter</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Mueller</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>FISH-quant v2: a scalable and modular tool for smFISH image analysis</article-title>
        <source>RNA</source>
        <year>2022</year>
        <volume>28</volume>
        <fpage>786</fpage>
        <lpage>795</lpage>
        <pub-id pub-id-type="doi">10.1261/rna.079073.121</pub-id>
        <?supplied-pmid 35347070?>
        <pub-id pub-id-type="pmid">35347070</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stringer</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Michaelos</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pachitariu</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Cellpose: a generalist algorithm for cellular segmentation</article-title>
        <source>Nat Methods</source>
        <year>2021</year>
        <volume>18</volume>
        <fpage>100</fpage>
        <lpage>106</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-020-01018-x</pub-id>
        <?supplied-pmid 33318659?>
        <pub-id pub-id-type="pmid">33318659</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robitaille</surname>
            <given-names>TP</given-names>
          </name>
          <name>
            <surname>Tollerud</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Greenfield</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Droettboom</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bray</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Aldcroft</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ginsburg</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Price-Whelan</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Kerzendorf</surname>
            <given-names>WE</given-names>
          </name>
          <name>
            <surname>Conley</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Crighton</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Barbary</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Muna</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ferguson</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Grollier</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Parikh</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Nair</surname>
            <given-names>PH</given-names>
          </name>
          <name>
            <surname>Günther</surname>
            <given-names>HM</given-names>
          </name>
          <name>
            <surname>Deil</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Woillez</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Conseil</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kramer</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Turner</surname>
            <given-names>JEH</given-names>
          </name>
          <name>
            <surname>Singer</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Fox</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Weaver</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Zabalza</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Edwards</surname>
            <given-names>ZI</given-names>
          </name>
          <name>
            <surname>Azalee Bostroem</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Burke</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Casey</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Crawford</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Dencheva</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Ely</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jenness</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Labrie</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lim</surname>
            <given-names>PL</given-names>
          </name>
          <name>
            <surname>Pierfederici</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Pontzen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ptak</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Refsdal</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Servillat</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Streicher</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Astropy: a community python package for astronomy</article-title>
        <source>Astron Astrophys Suppl Ser</source>
        <year>2013</year>
        <volume>558</volume>
        <fpage>A33</fpage>
        <pub-id pub-id-type="doi">10.1051/0004-6361/201322068</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Bradley L, Sipőcz B, Robitaille T, Tollerud E, Vinícius Z, Deil C, Barbary K, Wilson TJ, Busko I, Donath A, Günther HM, Cara M, Lim P L, Meßlinger S, Conseil S, Bostroem A, Droettboom M, Bray EM, Bratholm LA, Barentsen G, Craig M, Rathi S, Pascual S, Perren G, Georgiev IY, de Val-Borro M, Kerzendorf W, Bach YP, Quint B, Souchereau H. astropy/photutils: 1.5.0. (Zenodo, 2022). 10.5281/ZENODO.6825092.</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kleinberg</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Comellas</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Monaghan</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Shefelbine</surname>
            <given-names>SJ</given-names>
          </name>
        </person-group>
        <article-title>Usability of deep learning pipelines for 3D nuclei identification with Stardist and Cellpose</article-title>
        <source>Cells Dev</source>
        <year>2022</year>
        <volume>172</volume>
        <fpage>203806</fpage>
        <pub-id pub-id-type="doi">10.1016/j.cdev.2022.203806</pub-id>
        <?supplied-pmid 36029974?>
        <pub-id pub-id-type="pmid">36029974</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jia</surname>
            <given-names>BB</given-names>
          </name>
          <name>
            <surname>Jussila</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kern</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>A spatial genome aligner for resolving chromatin architectures from multiplexed DNA FISH</article-title>
        <source>Nat Biotechnol</source>
        <year>2023</year>
        <volume>41</volume>
        <fpage>1004</fpage>
        <lpage>1017</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-022-01568-9</pub-id>
        <?supplied-pmid 36593410?>
        <pub-id pub-id-type="pmid">36593410</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <mixed-citation publication-type="other">Devos X, Nollmann M. pyHiM: Multiplexed DNA-FISH data analysis pipeline. Github. 2023. <ext-link ext-link-type="uri" xlink:href="https://github.com/marcnol/pyHiM">https://github.com/marcnol/pyHiM</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">Devos X, Nollmann M. PyHiM documentation. Readthedocs. 2023. <ext-link ext-link-type="uri" xlink:href="https://pyhim.readthedocs.io/en/latest/">https://pyhim.readthedocs.io/en/latest/</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Fiche J-B, Devos X, Nollmann M. Stardist models for pyHiM. 2022. <ext-link ext-link-type="uri" xlink:href="https://osf.io/ugpyh/">https://osf.io/ugpyh/</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Messina O, Schaeffer M, Devos X, Fiche J-B. <ext-link ext-link-type="uri" xlink:href="http://paperpile.com/b/jloBXk/qync">http://paperpile.com/b/jloBXk/qync</ext-link> &amp; Nollmann, M. Small dataset for pyHiM. <ext-link ext-link-type="uri" xlink:href="https://osf.io/6egdc/">https://osf.io/6egdc/</ext-link>. 2023.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10863255</article-id>
    <article-id pub-id-type="publisher-id">3178</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-024-03178-x</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>pyHiM: a new open-source, multi-platform software package for spatial genomics based on multiplexed DNA-FISH imaging</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Devos</surname>
          <given-names>Xavier</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Fiche</surname>
          <given-names>Jean-Bernard</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bardou</surname>
          <given-names>Marion</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Messina</surname>
          <given-names>Olivier</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Houbron</surname>
          <given-names>Christophe</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gurgo</surname>
          <given-names>Julian</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Schaeffer</surname>
          <given-names>Marie</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Götz</surname>
          <given-names>Markus</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Walter</surname>
          <given-names>Thomas</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mueller</surname>
          <given-names>Florian</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3339-2349</contrib-id>
        <name>
          <surname>Nollmann</surname>
          <given-names>Marcelo</given-names>
        </name>
        <address>
          <email>marcnol@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.121334.6</institution-id><institution-id institution-id-type="ISNI">0000 0001 2097 0141</institution-id><institution>Centre de Biologie Structurale, </institution><institution>Univ Montpellier, CNRS UMR 5048, INSERM U1054, </institution></institution-wrap>34090 Montpellier, France </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/013cjyk83</institution-id><institution-id institution-id-type="GRID">grid.440907.e</institution-id><institution-id institution-id-type="ISNI">0000 0004 1784 3645</institution-id><institution>Centre for Computational Biology (CBIO), </institution><institution>Mines Paris, PSL University, </institution></institution-wrap>75006 Paris, France </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/04t0gwh46</institution-id><institution-id institution-id-type="GRID">grid.418596.7</institution-id><institution-id institution-id-type="ISNI">0000 0004 0639 6384</institution-id><institution>Institut Curie, </institution></institution-wrap>75248 Paris, Cedex France </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/02vjkv261</institution-id><institution-id institution-id-type="GRID">grid.7429.8</institution-id><institution-id institution-id-type="ISNI">0000 0001 2186 6389</institution-id><institution>INSERM, U900, </institution></institution-wrap>75248 Paris, Cedex France </aff>
      <aff id="Aff5"><label>5</label>Imaging and Modeling Unit, Institut Pasteur, Université Paris Cité, Paris, France </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>13</day>
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>13</day>
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2024</year>
    </pub-date>
    <volume>25</volume>
    <elocation-id>47</elocation-id>
    <history>
      <date date-type="received">
        <day>7</day>
        <month>8</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>29</day>
        <month>1</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Genome-wide ensemble sequencing methods improved our understanding of chromatin organization in eukaryotes but lack the ability to capture single-cell heterogeneity and spatial organization. To overcome these limitations, new imaging-based methods have emerged, giving rise to the field of spatial genomics. Here, we present pyHiM, a user-friendly python toolbox specifically designed for the analysis of multiplexed DNA-FISH data and the reconstruction of chromatin traces in individual cells. pyHiM employs a modular architecture, allowing independent execution of analysis steps and customization according to sample specificity and computing resources. pyHiM aims to facilitate the democratization and standardization of spatial genomics analysis.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13059-024-03178-x.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Spatial genomics</kwd>
      <kwd>3D chromatin structure</kwd>
      <kwd>Transcription</kwd>
      <kwd>Imaging</kwd>
      <kwd>Bioimage informatics</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100019180</institution-id>
            <institution>HORIZON EUROPE European Research Council</institution>
          </institution-wrap>
        </funding-source>
        <award-id>724429</award-id>
        <principal-award-recipient>
          <name>
            <surname>Nollmann</surname>
            <given-names>Marcelo</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100007492</institution-id>
            <institution>Fondation Bettencourt Schueller</institution>
          </institution-wrap>
        </funding-source>
        <award-id>coup d'elan 2017</award-id>
        <principal-award-recipient>
          <name>
            <surname>Nollmann</surname>
            <given-names>Marcelo</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>francebioImaging</institution>
        </funding-source>
        <award-id>ANR-10-INBS-04</award-id>
        <principal-award-recipient>
          <name>
            <surname>Nollmann</surname>
            <given-names>Marcelo</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2024</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par2">In eukaryotes, the three-dimensional (3D) nuclear organization of chromatin is tightly controlled and plays an active role in gene regulation, DNA replication and DNA damage repair. In the last decade, genome-wide ensemble methods, such as Hi-C and 3C [<xref ref-type="bibr" rid="CR1">1</xref>], have revolutionized our understanding of genome structure at the megabase-to-kilobase scale by revealing the complex organization of chromatin into compartments, topologically associating domains, and chromatin loops [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>]. However, these bulk approaches are unable to dissect single-cell heterogeneity or preserve spatial information in tissue [<xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR6">6</xref>].</p>
    <p id="Par3">Recently, a new family of imaging-based methods was developed to trace the 3D conformation of chromatin in single cells, giving rise to the field of spatial genomics [<xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR11">11</xref>] (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). These techniques perform sequential imaging of genomic loci with a precision of a few tens of nanometers, allowing for the 3D mapping of a given region of chromatin at kilobase resolution in thousands of individual cells [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. Our specific implementation, called Hi-M, couples detection of chromatin structure and transcriptional output [<xref ref-type="bibr" rid="CR8">8</xref>] (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). Since their creation, spatial genomics methods based on sequential imaging were successfully used for the detection of short- and long-range chromatin interactions in multiple model systems, including mammalian cultured cells, fly embryos, and mouse tissues [<xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. Critically, imaging-based spatial genomics technologies complement transcriptomic surveys of single cells in their spatial context and thus have the potential to lead to important new discoveries in multiple fields, including 3D genomics, transcriptional regulation, DNA replication, or DNA repair.<fig id="Fig1"><label>Fig. 1</label><caption><p><bold>a</bold> Schematic description of Hi-M microscopy: Chromatin is imaged through multiple acquisition cycles, each targeting a specific genomic locus using a set of unique DNA-FISH oligonucleotides targeted by a complementary, fluorescently labeled oligonucleotide. A fiducial marker is simultaneously imaged to allow for registration and drift correction during post-processing. Using pyHiM, the 3D conformation of the target locus is reconstructed for each individual cell. <bold>b</bold> pyHiM is an open-source project hosted on GitHub. Extensive documentation and Jupyter notebooks are available for users and developers. <bold>c</bold> pyHiM is developed in Python and runs indifferently on Linux, Windows and macOS. <bold>d</bold> Input data: 3D images are organized by imaging channel (DAPI, fiducial, DNA-FISH spots, etc.) and FOV. A single json file combines all parameters needed to run the analysis pipeline. <bold>e</bold> 3D images are pre-processed by calculating the maximum intensity projection and applying 2D registration based on the fiducial images. <bold>f</bold> Masks for nuclei, oligopaint libraries, and DNA-FISH spots are computed using pre-trained deep learning models. Individual DNA-FISH spots are localized with sub-pixel accuracy using apiFISH (fork of big-FISH). <bold>g</bold> Individual traces are built by combining the localizations of all DNA-FISH spots detected within the same mask. Results are saved in ECSV format. <bold>f</bold> Post-processing analyses are performed to obtain pairwise distance and proximity frequency matrices for each combination of DNA loci and for different spatial regions of the sample containing different cell types</p></caption><graphic xlink:href="13059_2024_3178_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par4">In recent years, several efforts were made to promote a wider use of these new technologies by sharing experimental and image analysis protocols [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR13">13</xref>–<xref ref-type="bibr" rid="CR16">16</xref>]. However, democratization of spatial genomics will require the development of open-source and user-friendly software packages for reconstructing chromatin traces (i.e., unique sets of 3D coordinates describing a locus conformation in an individual cell) from raw, 3D, multicolor images [<xref ref-type="bibr" rid="CR17">17</xref>]. To this end, such software should (1) provide access to validated cutting-edge techniques required for the analysis of spatial genomics data, (2) use a license-free programming language, (3) provide extensive documentation and tutorials to guide new users and allow development of new functionalities, (4) adopt a modular architecture to facilitate adaptation to future developments in spatial genomics, and (5) use novel analysis methods to ensure robust, automatic analysis of large data sets (several Tb per experiment) without user input and in reasonable times.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <p id="Par5">To address these needs, we introduce pyHiM, an open-source, modular and scalable software toolbox specifically designed for sequential spatial genomics data analysis (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). pyHiM comes with extensive user and developer documentation, Jupyter Notebook tutorials, and a DNA-FISH dataset to guide new users through the main steps of a typical analysis pipeline (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). PyHiM can be easily installed using standard package management tools (conda and PyPi, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1a) and conveniently runs on Linux, Windows, and macOS (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c). A single human-readable configuration file is used to centralize all analysis parameters and can be edited thanks to a user-friendly graphical user interface (GUI) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1b). In addition, a command-line interface enables execution on multiple hardware platforms, from laptop computers to high-performance computing (HPC) clusters. Functionality can be tuned according to local hardware specifications, acquisition conditions (e.g., number of channels, size of 3D image stacks), and sample properties.</p>
    <p id="Par6">The analysis pipeline of pyHiM is organized in modules, each performing a specific analysis task. The inputs of pyHiM are 3D image stacks in the universal TIFF format (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a, d). Deconvolution of images before pyHiM execution is not mandatory for pyHiM analysis but, in our experience, improves the quality of the results and the statistics of reconstructed chromatin traces.</p>
    <p id="Par7">The pre-processing module organizes images by field of view (FOV) and by the type of probe imaged: DNA-FISH spots, nuclear/ oligopaint library masks, fiducial marks, or RNA expression. For each FOV, pyHiM first performs a projection and global registration using fiducial images acquired at each cycle as references (Fig. <xref rid="Fig1" ref-type="fig">1</xref>e). To improve the robustness of this step, we implemented a new method whereby the image is decomposed in blocks that are independently co-aligned. A polling step then determines the most popular global registration and applies it to the whole image (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2a). This step allows for a global correction of thermal drift and stage repeatability error even for cycles with fiducial images displaying local distortions. Samples such as embryos or tissues may often display local deformations during acquisition of different cycles which cannot be taken into account by global registration algorithms. Thus, we developed a new local registration algorithm that optimizes 3D registrations locally to correct for 3D sample deformations (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2b, c).</p>
    <p id="Par8">The spot detection module performs segmentation and localization of DNA-FISH spots with sub-pixel accuracy of all sequential imaging rounds, using a combination of Deep Learning (DL)-powered spot segmentation followed by robust and automated 3D Gaussian fitting. 3D-DL segmentation is performed using a StarDist neural network [<xref ref-type="bibr" rid="CR18">18</xref>] trained to robustly detect 3D-Point Spread Functions (PSF) in diverse sample types and illumination conditions. We obtained this network after extensive simulations of PSFs with different signal-to-noise ratios and inhomogeneous background levels. Next, based on the centroid position of each DL-mask, a robust 3D Gaussian fit of the intensity distribution is performed using apiFISH (Fig. <xref rid="Fig1" ref-type="fig">1</xref>f and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3) [<xref ref-type="bibr" rid="CR19">19</xref>].</p>
    <p id="Par9">The mask detection module segments nuclei in 3D using pre-trained StarDist neural networks models [<xref ref-type="bibr" rid="CR18">18</xref>] (Fig. <xref rid="Fig1" ref-type="fig">1</xref>f). Other custom models based on StarDist or other popular architectures (e.g., Cellpose [<xref ref-type="bibr" rid="CR20">20</xref>]) can also be integrated via a plugin. Finally, DNA-FISH spots localized within the same mask are combined into chromatin traces, which are assigned a universally unique identifier and tabulated in human-readable Enhanced Character-Separated Values (ECSV) format (Fig. <xref rid="Fig1" ref-type="fig">1</xref>g and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4a, b). Additional labels, based on RNA expression levels or spatial cell distribution, can be assigned to each single trace, allowing for cell/tissue-specific post-processing analysis (Fig. <xref rid="Fig1" ref-type="fig">1</xref>h).</p>
    <p id="Par10">Thanks to pyHiM’s modular architecture, each analysis step in the pipeline (registration, detection, tracing, etc.) can be run independently. Users can tailor the analysis workflow according to their sample specificity, acquisition conditions, and available computing resources (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a). Intermediate results, such as unfiltered localizations or traces, are saved in ECSV format after each module execution, allowing the user to perform custom data validation or additional analysis. Finally, each module produces reports in human-readable markdown files with snapshot images illustrating the performance of the analysis for each cycle and FOV. This allows the user to efficiently assess the quality of the analyses and eventually fine-tune parameters to improve them (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a–c and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S2, S3). pyHiM can successfully analyze experimental data acquired from a variety of sample types, ranging from fly embryos to mouse and human tissues (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d, e).<fig id="Fig2"><label>Fig. 2</label><caption><p><bold>a</bold> Illustration of a typical pyHiM analysis on mouse tissues: examples of raw data are shown in the top row and the most relevant pyHiM outputs are shown in the bottom row. From left to right, raw DAPI data are segmented to compute the 3D masks of each individual nucleus. Next, 2D and 3D registration of the fiducial is performed for each imaging cycle, and the quality of the correction can be quickly assessed based on the output image. Then, the localization of individual DNA-FISH spots is performed in two steps: first, a 3D mask of each DNA-FISH spot is computed using deep learning. Then, using the mask position as a reference, the sub-pixel localization of the spot is inferred using apiFISH. Scale bars = 8 μm. <bold>b</bold> Chromatin tracks are calculated by combining all individual DNA-FISH spot localizations detected within the same mask (DAPI, or locus). Each individual trace represents a snapshot of the locus conformation within a single cell (see reconstruction with two different orientations). <bold>c</bold> Data quality assessment: (top) the N-matrix represents the number of times that each pair of DNA loci was detected in the dataset and is indicative of their detection efficiency. (bottom) The distribution of pairwise distances between DNA-FISH spots in the same chromatin trace is plotted to ensure that there is no major error in the analysis (detection threshold, etc.). <bold>d</bold> Traces computed by pyHiM were sorted based on RNA expression profiles in NC14 fly embryos and assigned to specific cell types (e.g., mesoderm vs. neuroectoderm). Specific long-range interactions and chromatin organization are observed for each cell type. <bold>e</bold> Fast 2D analysis based only on the projected 3D data is used to optimize parameters and test data quality. An example from mouse tissue data shows the pairwise distance maps computed using 2D (top) and 3D (bottom) analysis. The 2D map captures most of the features that characterize the conformation of the locus. <bold>f</bold> Comparison of pyHiM execution times for different number of cycles and for a desktop computer (Intel(R) Core(TM) i7-8700 CPU @ 3.20 GHz, CPUs: 12, cores: 6, threads per core: 2, memory: 16 Gb) or a multi-threaded server (AMD EPYC 7702 64-Core Processor 3.34 GHz, CPUs: 256, cores: 128, threads per core: 2, memory: 512 Gb). <bold>g</bold> Performance of pyHiM using single-threaded or DASK-powered multi-threading</p></caption><graphic xlink:href="13059_2024_3178_Fig2_HTML" id="MO2"/></fig></p>
    <p id="Par11">pyHiM also offers a number of additional features that facilitate data formatting, result display, and post-processing. For instance, DNA-FISH spot detection efficiency and maps of the pairwise distance (PWD) distributions between DNA-FISH spots from different cycles (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c), or proximity frequency matrices for specific cell types (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d). Another important feature of pyHiM is its ability to perform rapid analysis in 2D (Fig. <xref rid="Fig2" ref-type="fig">2</xref>e). In this mode, pyHiM projects signals from DNA-FISH spots and masks in 2D and performs registration, segmentation, spot localization, and tracing in 2D. Contact maps computed using the 2D pipeline show all the relevant features of 3D maps (long-range contacts, TADs, etc.) but require ~ 5 × less computation time (Fig. <xref rid="Fig2" ref-type="fig">2</xref>e, f) and can therefore be used to quickly assess the quality of the acquired dataset before full 3D analysis.</p>
    <p id="Par12">Finally, a critical aspect of multiplexed DNA-FISH imaging is the amount of data generated, typically ~ 1–3 Tb per experiment depending on the number of cycles and the number of FOVs. To handle and analyze such large volumes of data in a reasonable time, we have implemented a parallelization mode based on the Dask Python package. For this, pyHiM analyzes data associated with different hybridization cycles in parallel, while keeping the technical aspects transparent to the user, leading to a drastic shortening in computation time (Fig. <xref rid="Fig2" ref-type="fig">2</xref>f, g). Conveniently, a reporting web-server based on Bokeh can be launched to monitor analysis status and performance in real-time (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4c). As a result, pyHiM can run indifferently on a laptop or an HPC cluster and be tuned according to the technical specificities of both (e.g., number of CPUs, available memory, availability of GPUs, etc.).</p>
  </sec>
  <sec id="Sec3">
    <title>Conclusions</title>
    <p id="Par13">In summary, we describe pyHiM, a modular, user-friendly, well-documented tool for chromatin tracing analysis based on sequential DNA-FISH imaging. pyHiM can be used to analyze data produced by Hi-M or by other spatial genomics methods. Thus, we envision that the adoption of pyHiM will enable the growth of a new user community for this active field of research. Indeed, as data acquisition and sample preparation become standard and even commercially available, a final bottleneck for widespread adoption will be the availability of flexible image analysis tool boxes dedicated to chromatin tracing. Thus, a well-tested and user-friendly analysis pipeline such as pyHiM will be key to break barriers to adoption of spatial genomics by users and microscopy facilities, to promote transparent image analysis pipelines in the field, and to create a large user community to accelerate discoveries and new developments. The modularity, open-source nature, and extensive developer documentation of pyHiM were purposefully designed to promote collaborative developments, to standardize and benchmark image analysis practices, and to facilitate reuse of existing algorithms to implement analysis tools for novel technologies in the blooming field of spatial genomics.</p>
  </sec>
  <sec id="Sec4">
    <title>Methods</title>
    <sec id="Sec5">
      <title>Inputs</title>
      <p id="Par14">The two minimal inputs of pyHiM are as follows: a dictionary of parameters (<italic>parameters.json</italic>) and a list of images to process. <italic>parameters.json</italic> contains acquisition parameters (e.g., pixel size), file formatting parameters (e.g., regular expression to decode filenames), and all the parameters that are required for the execution of each module in pyHiM. For detailed information on the <italic>parameters.json</italic> parameter file, please refer to our online resource: Input Parameters.</p>
      <p id="Par15">Input images can be of two types: DNA-FISH spots for a given cycle and masks used for tracing. The latter can be either nuclear masks (e.g., from DAPI labeling) or from a cycle where the whole oligopaint library is labeled and imaged at once. Both DNA-FISH and mask images must be accompanied by a corresponding fiducial image used for registration (see the “<xref rid="Sec7" ref-type="sec">Registration</xref>” section). Images are assumed to be in the universal and non-proprietary TIFF format. Use of deconvolved images is recommended but not compulsory.</p>
    </sec>
    <sec id="Sec6">
      <title>Projection</title>
      <p id="Par16">We developed a tool for image reprojection (module: <italic>makeProjections</italic>). This step is necessary for lateral global drift alignment (see the”Registration” section) and for the rapid visual inspection of input files. Sum and maximum projections are implemented and configured through the <italic>parameters.json</italic> parameters file. We recommend the former for masks and the latter for DNA-FISH images. makeProjections allows for the manual selection of the <italic>z</italic>-range and implements an automatic algorithm to robustly retrieve the in-focus plane. Briefly, this method estimates the optimal in-focus plane by calculating the maximum of the Laplacian of the intensity profile along the <italic>z</italic>-axis. The calculation is performed block-by-block to take into account local variability and sample drift. More details on the methods and the execution of this module can be found in the online description of the <italic>makeProjections</italic> module.</p>
    </sec>
    <sec id="Sec7">
      <title>Registration</title>
      <p id="Par17">We implemented two registration methods to obtain automatic and robust global and local realignments. The <italic>alignImages</italic> module performs global realignments by registering the 2D z-reprojected fiducial images using 2D cross-correlation. This method, however, can be unreliable when fiducial images contain impurities that vary between cycles. To solve this, we developed a second algorithm (<italic>alignByBlock</italic>) that uses block-by-block decomposition to determine the best registration for each block. This calculation is followed by a polling operation that retrieves the most satisfactory global registration. This second method is highly robust to impurities. More details on the methods and the execution of this module can be found in our online description of the <italic>alignImages</italic> module. Once registrations for each cycle are processed, the module <italic>appliesRegistrations</italic> re-interpolates 2D images of DNA-FISH spots and masks to provide a visual input of the performance of global registrations for each hybridization cycle.</p>
      <p id="Par18">Biological samples can display local deformations (typically in the hundreds of nm range) during the long-term acquisition times of a HiM dataset. These distortions cannot be properly corrected by global 2D realignment routines. To tackle this issue, we developed a new registration method that performs local 3D registration. In this method, images are first globally realigned in 2D. Next, fiducial images are decomposed in 3D blocks and each block is realigned by 3D cross-correlation and re-interpolation. The resulting local block corrections are stored as an ASTROPY table [<xref ref-type="bibr" rid="CR21">21</xref>] that is used by the <italic>register_localizations</italic> module (see section below). More details on the methods and the execution of this module can be found in our online description of the <italic>alignImages3D</italic> module.</p>
    </sec>
    <sec id="Sec8">
      <title>Segmentation and detection</title>
      <p id="Par19">Three different modules were built to deal with the segmentation and detection of DNA-FISH spots and masks. First, we developed a module for the segmentation and localization of masks and sources in 2D (module: <italic>SegmentMasks</italic>). Mask and DNA-FISH images are segmented using startdist with pre-trained networks. Segmented objects are filtered by size and shape, while merged objects are split using the watershed algorithm. DNA-FISH spots are fitted using the highly efficient DAOStarFinder algorithm from photutils [<xref ref-type="bibr" rid="CR22">22</xref>] and post-processed using <italic>filter_localizations</italic>.</p>
      <p id="Par20">Second, we developed a module specifically designed to segment masks in 3D (module: <italic>segmentMasks3D</italic>). <italic>segmentMasks3D</italic> relies on deep-learning segmentation using a network that we trained specifically to robustly segment nuclei in 3D with stardist [<xref ref-type="bibr" rid="CR23">23</xref>]<italic>.</italic> Other DL segmentation tools, such as cellpose [<xref ref-type="bibr" rid="CR20">20</xref>], can be used to further increase the flexibility of mask segmentation for different biological samples (script: mask_cellpose.py). <italic>segmentMasks3D</italic> then post-processes 3D masks by size and shape filtering, and applies a watershed algorithm to split merged masks. The output of <italic>segmentMasks3D</italic> is a localizations table used by the <italic>build_traces</italic> module to group localizations into single chromatin traces (see the “<xref rid="Sec9" ref-type="sec">Tracing</xref>” section) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3c). More details on the methods and the execution of this module can be found in our online description of the <italic>segmentMasks3D</italic> module.</p>
      <p id="Par21">Finally, we developed a module for the segmentation and localization of DNA-FISH spots (module: <italic>segmentSources3D</italic>). <italic>segmentSources3D</italic> segments DNA-FISH spots by using a stardist DL network trained to detect PSFs in 3D. This network was optimized by training the DL network on simulated data displaying large variations in signal-to-noise ratios, local background inhomogeneities, and intensity levels. After segmentation, <italic>segmentSources3D</italic> fits the intensity distributions within DNA-FISH spot masks with a 3D-Gaussian model using non-linear regression with functions from apiFISH [<xref ref-type="bibr" rid="CR19">19</xref>]. The output <italic>segmentSources3D</italic> is an ASTROPY table containing the <italic>xyz</italic> coordinates, identities, and properties of all the localizations. Localizations with low intensities are filtered in post-processing using the module <italic>filter_localizations</italic>. A final step before tracing involves the application of local registrations to the localization tables obtained from <italic>segmentMasks</italic> or from <italic>segmentSources3D using the register_localizations module.</italic> Our trained stardist DL networks were packed with pyHiM and are also available from our pyHiM OSF repository.</p>
    </sec>
    <sec id="Sec9">
      <title>Tracing</title>
      <p id="Par22">The final step involves the grouping of DNA-FISH spots belonging to the same chromatin fiber (module: <italic>build_traces</italic>). This can be accomplished in two manners. The first involves spatial clustering based on nearest-neighbor distances with the KDTree algorithm. This method works well for low-density samples, where nuclei are well-separated in space. The second, instead, relies on the use of user-provided masks. In this case, traces are built by grouping together the spots belonging to the same mask. Masks can be derived either from nuclei (e.g., from DAPI staining) or from a cycle labeling the entire oligopaint library. The output of <italic>build_traces</italic> is a trace table in ASTROPY format where each trace is stamped with a universal unique identifier to enable the automatic merging of multiple trace tables and to ensure traceability. We note that no corrections for missing or redundant barcode localizations are applied by <italic>build_traces</italic> as such corrections are often sample dependent. In pyHiM, these issues are handled by post-processing scripts (see below). More details on the methods and the execution of this module can be found in our online description of the <italic>build_traces</italic> module.</p>
      <p id="Par23">We developed several tools for post-processing of trace tables. <italic>Trace_assign_mask</italic> finds traces that match specific morphological or gene-expression patterns by matching trace localization with user-provided masks. <italic>Trace_combinator</italic> and <italic>trace_merge</italic> fuse traces from different FOVs or different experiments. <italic>Trace_filter</italic> is a general tool for filtering traces that can remove specific barcodes from a trace table, remove duplicated localizations from single traces, and perform spatial filtering. <italic>Trace_filter_advanced</italic>, instead, removes duplicate localizations based on distance constraints. Finally, <italic>trace_analyzer</italic> analyzes a trace table to calculate the distribution in the number of barcodes detected per trace, the number of times each barcode appears in single traces, and the spatial clustering of traces. We highlight the existence of more sophisticated methods to improve the quality of tracing [<xref ref-type="bibr" rid="CR24">24</xref>] that may be applied in combination with the post-processing scripts mentioned in this paragraph.</p>
      <p id="Par24">Finally, we developed an algorithm that builds maps from trace tables (module: <italic>build_matrix</italic>). This tool produces conventional pair-wise median distance maps by relying on kernel-density estimators to accurately calculate the maximum of each distance distribution, and calculates proximity distance maps for user-specified threshold distances. <italic>Build_matrix</italic> produces N-maps which contain the number of localizations detected for each combination of barcodes, a diagnostic tool that is fundamental to determine the performance of an experiment and the robustness of detection for each barcode pair. More details on the methods and execution of this module can be found in our online description of the <italic>build_matrix</italic> module.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec13">
      <title>Supplementary Information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2024_3178_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1.</bold> Supplementary figures.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2024_3178_MOESM2_ESM.docx">
            <caption>
              <p><bold>Additional file 2.</bold> Review history.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Xavier Devos and Jean-Bernard Fiche are co-first authors.</p>
    </fn>
  </fn-group>
  <ack>
    <sec id="FPar1">
      <title>Review history</title>
      <p id="Par25">The review history is available as Additional file <xref rid="MOESM2" ref-type="media">2</xref>.</p>
    </sec>
    <sec id="FPar2">
      <title>Peer review information</title>
      <p id="Par26">Veronique van den Berghe was the primary editor of this article and managed its editorial process and peer review in collaboration with the rest of the editorial team.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>X.D., J-B.F., C.H., and M.N. wrote the code for pyHiM. J-B.F developed and validated deep learning networks. X.D. wrote the documentation with help from M.S. and M.N. X.D., M.N., and O.M worked in the Jupyter lab tutorials. M.B., C.H., J.G., M.S., and M.G. participated in benchmarking and debugging activities. O.M. and M.S. collected the small dataset. J-B.F and M.N. wrote the manuscript. X.D. and J-B.F made the figures. M.N., F.M., and T.W. participated in the project design. All authors participated in the final edition of the manuscript.</p>
    <sec id="FPar3">
      <title>Authors’ Twitter/X handles</title>
      <p id="Par27">@marcnol (Marcelo Nollmann).</p>
    </sec>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This project was funded by the European Union’s Horizon 2020 Research and Innovation Program (EpiScope, Grant ID 724429, M.N.). We acknowledge the Bettencourt-Schueller Foundation for their prize ‘Coup d'élan pour la recherche Française’ and the France-BioImaging infrastructure supported by the French National Research Agency (grant ID ANR-10-INBS-04, “Investments for the Future”) for their funding through the cloudFISH project.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The latest stable and development versions of pyHiM are publicly available at our GitHub repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/marcnol/pyHiM">https://github.com/marcnol/pyHiM</ext-link> [<xref ref-type="bibr" rid="CR25">25</xref>]. The 0.9.1 release of pyHiM is permanently available at: <ext-link ext-link-type="uri" xlink:href="https://osf.io/updfw">https://osf.io/updfw</ext-link> (10.17605/OSF.IO/UPDFW).</p>
    <p>The online documentation is available at <ext-link ext-link-type="uri" xlink:href="https://pyhim.readthedocs.io/en/latest/">https://pyhim.readthedocs.io/en/latest/</ext-link> [<xref ref-type="bibr" rid="CR26">26</xref>].</p>
    <p>DL networks trained for pyHiM are available at our OSF repository: <ext-link ext-link-type="uri" xlink:href="https://osf.io/ugpyh/">https://osf.io/ugpyh/</ext-link> [<xref ref-type="bibr" rid="CR27">27</xref>].</p>
    <p>Minimal datasets for multiplexed DNA-FISH data are available from <ext-link ext-link-type="uri" xlink:href="https://osf.io/6egdc/">https://osf.io/6egdc/</ext-link> [<xref ref-type="bibr" rid="CR28">28</xref>].</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar4">
      <title>Ethics approval and consent to participate</title>
      <p id="Par28">Ethical approvals were not needed for this study.</p>
    </notes>
    <notes id="FPar5" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par29">The authors declare no competing interests. </p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kempfer</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Pombo</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Methods for mapping 3D chromosome architecture</article-title>
        <source>Nat Rev Genet</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>207</fpage>
        <lpage>226</lpage>
        <pub-id pub-id-type="doi">10.1038/s41576-019-0195-2</pub-id>
        <?supplied-pmid 31848476?>
        <pub-id pub-id-type="pmid">31848476</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dekker</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Heard</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Structural and functional diversity of topologically associating domains</article-title>
        <source>FEBS Lett</source>
        <year>2015</year>
        <volume>589</volume>
        <fpage>2877</fpage>
        <lpage>2884</lpage>
        <pub-id pub-id-type="doi">10.1016/j.febslet.2015.08.044</pub-id>
        <?supplied-pmid 26348399?>
        <pub-id pub-id-type="pmid">26348399</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <mixed-citation publication-type="other">Jerkovic I, Szabo Q, Bantignies F, Cavalli G. Higher-order chromosomal structures mediate genome function. J Mol Biol. 2019. 10.1016/j.jmb.2019.10.014.</mixed-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schaeffer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nollmann</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Contributions of 3D chromatin structure to cell-type-specific gene regulation</article-title>
        <source>Curr Opin Genet Dev</source>
        <year>2023</year>
        <volume>79</volume>
        <fpage>102032</fpage>
        <pub-id pub-id-type="doi">10.1016/j.gde.2023.102032</pub-id>
        <?supplied-pmid 36893484?>
        <pub-id pub-id-type="pmid">36893484</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bouwman</surname>
            <given-names>BAM</given-names>
          </name>
          <name>
            <surname>Crosetto</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Bienko</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The era of 3D and spatial genomics</article-title>
        <source>Trends Genet</source>
        <year>2022</year>
        <volume>38</volume>
        <fpage>1062</fpage>
        <lpage>1075</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tig.2022.05.010</pub-id>
        <?supplied-pmid 35680466?>
        <pub-id pub-id-type="pmid">35680466</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boettiger</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Advances in chromatin imaging at kilobase-scale resolution</article-title>
        <source>Trends Genet</source>
        <year>2020</year>
        <volume>36</volume>
        <fpage>273</fpage>
        <lpage>287</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tig.2019.12.010</pub-id>
        <?supplied-pmid 32007290?>
        <pub-id pub-id-type="pmid">32007290</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bintu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Mateo</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>J-H</given-names>
          </name>
          <name>
            <surname>Sinnott-Armstrong</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Parker</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kinrot</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yamaya</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Boettiger</surname>
            <given-names>AN</given-names>
          </name>
          <name>
            <surname>Zhuang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Super-resolution chromatin tracing reveals domains and co4operative interactions in single cells</article-title>
        <source>Science</source>
        <year>2018</year>
        <volume>362</volume>
        <issue>6413</issue>
        <fpage>eaau1783</fpage>
        <pub-id pub-id-type="doi">10.1126/science.aau1783</pub-id>
        <?supplied-pmid 30361340?>
        <pub-id pub-id-type="pmid">30361340</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <mixed-citation publication-type="other">Cardozo Gizzi AM, Cattoni DI, Fiche J-B, Espinola SM, Gurgo J, Messina O, Houbron C, Ogiyama Y, Papadopoulos GL, Cavalli G, Lagha M, Nollmann M. Microscopy-based chromosome conformation capture Enables simultaneous visualization of genome organization and transcription in intact organisms. Mol Cell.2019. 10.1016/j.molcel.2019.01.011.</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mateo</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Hafner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cinquini</surname>
            <given-names>IS</given-names>
          </name>
          <name>
            <surname>Walker</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Boettiger</surname>
            <given-names>AN</given-names>
          </name>
        </person-group>
        <article-title>Visualizing DNA folding and RNA in embryos at single-cell resolution</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>568</volume>
        <fpage>49</fpage>
        <lpage>54</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1035-4</pub-id>
        <?supplied-pmid 30886393?>
        <pub-id pub-id-type="pmid">30886393</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Radda</surname>
            <given-names>JSD</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Katz</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Multiplexed imaging of nucleome architectures in single cells of mammalian tissue</article-title>
        <source>Nat Commun</source>
        <year>2020</year>
        <volume>11</volume>
        <fpage>2907</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-16732-5</pub-id>
        <?supplied-pmid 32518300?>
        <pub-id pub-id-type="pmid">32518300</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Takei</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yun</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ollikainen</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Pierson</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Shah</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Thomassie</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Suo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Eng</surname>
            <given-names>C-HL</given-names>
          </name>
          <name>
            <surname>Guttman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>G-C</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Integrated spatial genomics reveals global architecture of single nuclei</article-title>
        <source>Nature</source>
        <year>2021</year>
        <volume>590</volume>
        <fpage>344</fpage>
        <lpage>350</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-020-03126-2</pub-id>
        <?supplied-pmid 33505024?>
        <pub-id pub-id-type="pmid">33505024</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Espinola</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Götz</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bellec</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Messina</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Fiche</surname>
            <given-names>J-B</given-names>
          </name>
          <name>
            <surname>Houbron</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Dejean</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Reim</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Cardozo Gizzi</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Lagha</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nollmann</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Cis-regulatory chromatin loops arise before TADs and gene activation, and are independent of cell fate during early Drosophila development</article-title>
        <source>Nat Genet</source>
        <year>2021</year>
        <volume>53</volume>
        <fpage>477</fpage>
        <lpage>486</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-021-00816-z</pub-id>
        <?supplied-pmid 33795867?>
        <pub-id pub-id-type="pmid">33795867</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cardozo Gizzi</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Espinola</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Gurgo</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Houbron</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Fiche</surname>
            <given-names>J-B</given-names>
          </name>
          <name>
            <surname>Cattoni</surname>
            <given-names>DI</given-names>
          </name>
          <name>
            <surname>Nollmann</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Direct and simultaneous observation of transcription and chromosome architecture in single cells with Hi-M</article-title>
        <source>Nat Protoc</source>
        <year>2020</year>
        <volume>15</volume>
        <fpage>840</fpage>
        <lpage>876</lpage>
        <pub-id pub-id-type="doi">10.1038/s41596-019-0269-9</pub-id>
        <?supplied-pmid 31969721?>
        <pub-id pub-id-type="pmid">31969721</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mateo</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Sinnott-Armstrong</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Boettiger</surname>
            <given-names>AN</given-names>
          </name>
        </person-group>
        <article-title>Tracing DNA paths and RNA profiles in cultured cells and tissues with ORCA</article-title>
        <source>Nat Protoc</source>
        <year>2021</year>
        <volume>16</volume>
        <fpage>1647</fpage>
        <lpage>1713</lpage>
        <pub-id pub-id-type="doi">10.1038/s41596-020-00478-x</pub-id>
        <?supplied-pmid 33619390?>
        <pub-id pub-id-type="pmid">33619390</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Radda</surname>
            <given-names>JSD</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Jin</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Chromatin tracing and multiplexed imaging of nucleome architectures (MINA) and RNAs in single mammalian cells and tissue</article-title>
        <source>Nat Protoc</source>
        <year>2021</year>
        <volume>16</volume>
        <fpage>2667</fpage>
        <lpage>2697</lpage>
        <pub-id pub-id-type="doi">10.1038/s41596-021-00518-0</pub-id>
        <?supplied-pmid 33903756?>
        <pub-id pub-id-type="pmid">33903756</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Barho F, Fiche J-B, Bardou M, Messina O, Martiniere A, Houbron C, Nollmann M. Qudi-HiM: an open-source acquisition software package for highly multiplexed sequential and combinatorial optical imaging. Open Research Europe. 2022;2, 46 Preprint at 10.12688/openreseurope.14641.2.</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Genome-wide tracing to decipher nuclear organization. Curr Opin Cell Biol. 2023;82:102175.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Schmidt U, Weigert M, Broaddus C, Myers G. in Medical Image Computing and Computer Assisted Intervention – MICCAI 2018 265–273 (Springer International Publishing, 2018).</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Imbert</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ouyang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Safieddine</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Coleno</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Zimmer</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bertrand</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Walter</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Mueller</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>FISH-quant v2: a scalable and modular tool for smFISH image analysis</article-title>
        <source>RNA</source>
        <year>2022</year>
        <volume>28</volume>
        <fpage>786</fpage>
        <lpage>795</lpage>
        <pub-id pub-id-type="doi">10.1261/rna.079073.121</pub-id>
        <?supplied-pmid 35347070?>
        <pub-id pub-id-type="pmid">35347070</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stringer</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Michaelos</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pachitariu</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Cellpose: a generalist algorithm for cellular segmentation</article-title>
        <source>Nat Methods</source>
        <year>2021</year>
        <volume>18</volume>
        <fpage>100</fpage>
        <lpage>106</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-020-01018-x</pub-id>
        <?supplied-pmid 33318659?>
        <pub-id pub-id-type="pmid">33318659</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robitaille</surname>
            <given-names>TP</given-names>
          </name>
          <name>
            <surname>Tollerud</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Greenfield</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Droettboom</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bray</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Aldcroft</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ginsburg</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Price-Whelan</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Kerzendorf</surname>
            <given-names>WE</given-names>
          </name>
          <name>
            <surname>Conley</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Crighton</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Barbary</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Muna</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ferguson</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Grollier</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Parikh</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Nair</surname>
            <given-names>PH</given-names>
          </name>
          <name>
            <surname>Günther</surname>
            <given-names>HM</given-names>
          </name>
          <name>
            <surname>Deil</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Woillez</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Conseil</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kramer</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Turner</surname>
            <given-names>JEH</given-names>
          </name>
          <name>
            <surname>Singer</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Fox</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Weaver</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Zabalza</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Edwards</surname>
            <given-names>ZI</given-names>
          </name>
          <name>
            <surname>Azalee Bostroem</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Burke</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Casey</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Crawford</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Dencheva</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Ely</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jenness</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Labrie</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lim</surname>
            <given-names>PL</given-names>
          </name>
          <name>
            <surname>Pierfederici</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Pontzen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ptak</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Refsdal</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Servillat</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Streicher</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Astropy: a community python package for astronomy</article-title>
        <source>Astron Astrophys Suppl Ser</source>
        <year>2013</year>
        <volume>558</volume>
        <fpage>A33</fpage>
        <pub-id pub-id-type="doi">10.1051/0004-6361/201322068</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Bradley L, Sipőcz B, Robitaille T, Tollerud E, Vinícius Z, Deil C, Barbary K, Wilson TJ, Busko I, Donath A, Günther HM, Cara M, Lim P L, Meßlinger S, Conseil S, Bostroem A, Droettboom M, Bray EM, Bratholm LA, Barentsen G, Craig M, Rathi S, Pascual S, Perren G, Georgiev IY, de Val-Borro M, Kerzendorf W, Bach YP, Quint B, Souchereau H. astropy/photutils: 1.5.0. (Zenodo, 2022). 10.5281/ZENODO.6825092.</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kleinberg</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Comellas</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Monaghan</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Shefelbine</surname>
            <given-names>SJ</given-names>
          </name>
        </person-group>
        <article-title>Usability of deep learning pipelines for 3D nuclei identification with Stardist and Cellpose</article-title>
        <source>Cells Dev</source>
        <year>2022</year>
        <volume>172</volume>
        <fpage>203806</fpage>
        <pub-id pub-id-type="doi">10.1016/j.cdev.2022.203806</pub-id>
        <?supplied-pmid 36029974?>
        <pub-id pub-id-type="pmid">36029974</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jia</surname>
            <given-names>BB</given-names>
          </name>
          <name>
            <surname>Jussila</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kern</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>A spatial genome aligner for resolving chromatin architectures from multiplexed DNA FISH</article-title>
        <source>Nat Biotechnol</source>
        <year>2023</year>
        <volume>41</volume>
        <fpage>1004</fpage>
        <lpage>1017</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-022-01568-9</pub-id>
        <?supplied-pmid 36593410?>
        <pub-id pub-id-type="pmid">36593410</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <mixed-citation publication-type="other">Devos X, Nollmann M. pyHiM: Multiplexed DNA-FISH data analysis pipeline. Github. 2023. <ext-link ext-link-type="uri" xlink:href="https://github.com/marcnol/pyHiM">https://github.com/marcnol/pyHiM</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">Devos X, Nollmann M. PyHiM documentation. Readthedocs. 2023. <ext-link ext-link-type="uri" xlink:href="https://pyhim.readthedocs.io/en/latest/">https://pyhim.readthedocs.io/en/latest/</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Fiche J-B, Devos X, Nollmann M. Stardist models for pyHiM. 2022. <ext-link ext-link-type="uri" xlink:href="https://osf.io/ugpyh/">https://osf.io/ugpyh/</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Messina O, Schaeffer M, Devos X, Fiche J-B. <ext-link ext-link-type="uri" xlink:href="http://paperpile.com/b/jloBXk/qync">http://paperpile.com/b/jloBXk/qync</ext-link> &amp; Nollmann, M. Small dataset for pyHiM. <ext-link ext-link-type="uri" xlink:href="https://osf.io/6egdc/">https://osf.io/6egdc/</ext-link>. 2023.</mixed-citation>
    </ref>
  </ref-list>
</back>
