<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8642913</article-id>
    <article-id pub-id-type="publisher-id">4474</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-021-04474-0</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>QuickPIV: Efficient 3D particle image velocimetry software applied to quantifying cellular migration during embryogenesis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3496-7207</contrib-id>
        <name>
          <surname>Pereyra</surname>
          <given-names>Marc</given-names>
        </name>
        <address>
          <email>pereyra@fias.uni-frankfurt.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Drusko</surname>
          <given-names>Armin</given-names>
        </name>
        <address>
          <email>armin.drusko@med.uni-heidelberg.de</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Krämer</surname>
          <given-names>Franziska</given-names>
        </name>
        <address>
          <email>franziska.kraemer@physikalischebiologie.de</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Strobl</surname>
          <given-names>Frederic</given-names>
        </name>
        <address>
          <email>frederic.strobl@physikalischebiologie.de</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Stelzer</surname>
          <given-names>Ernst H. K.</given-names>
        </name>
        <address>
          <email>stelzer@bio.uni-frankfurt.de</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Matthäus</surname>
          <given-names>Franziska</given-names>
        </name>
        <address>
          <email>matthaeus@fias.uni-frankfurt.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.417999.b</institution-id><institution-id institution-id-type="ISNI">0000 0000 9260 4223</institution-id><institution>Frankfurt Institute for Advanced Studies (FIAS) and Goethe Universität Frankfurt am Main, </institution></institution-wrap>Ruth-Moufang-Straße 1, 60438 Frankfurt am Main, Germany </aff>
      <aff id="Aff2"><label>2</label>Buchmann Institute for Molecular Life Sciences (BMLS), Max-von-Laue Straße 15, 60438 Frankfurt am Main, Germany </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.5253.1</institution-id><institution-id institution-id-type="ISNI">0000 0001 0328 4908</institution-id><institution>Heidelberg University Hospital, </institution></institution-wrap>Im Neuenheimer Feld 410, 69120 Heidelberg, Germany </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>4</day>
      <month>12</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>4</day>
      <month>12</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <elocation-id>579</elocation-id>
    <history>
      <date date-type="received">
        <day>3</day>
        <month>3</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>15</day>
        <month>10</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">The technical development of imaging techniques in life sciences has enabled the three-dimensional recording of living samples at increasing temporal resolutions. Dynamic 3D data sets of developing organisms allow for time-resolved quantitative analyses of morphogenetic changes in three dimensions, but require efficient and automatable analysis pipelines to tackle the resulting Terabytes of image data. Particle image velocimetry (PIV) is a robust and segmentation-free technique that is suitable for quantifying collective cellular migration on data sets with different labeling schemes. This paper presents the implementation of an efficient 3D PIV package using the Julia programming language—quickPIV. Our software is focused on optimizing CPU performance and ensuring the robustness of the PIV analyses on biological data.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">QuickPIV is three times faster than the Python implementation hosted in openPIV, both in 2D and 3D. Our software is also faster than the fastest 2D PIV package in openPIV, written in C++. The accuracy evaluation of our software on synthetic data agrees with the expected accuracies described in the literature. Additionally, by applying quickPIV to three data sets of the embryogenesis of <italic>Tribolium castaneum</italic>, we obtained vector fields that recapitulate the migration movements of gastrulation, both in nuclear and actin-labeled embryos. We show normalized squared error cross-correlation to be especially accurate in detecting translations in non-segmentable biological image data.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">The presented software addresses the need for a fast and open-source 3D PIV package in biological research. Currently, quickPIV offers efficient 2D and 3D PIV analyses featuring zero-normalized and normalized squared error cross-correlations, sub-pixel/voxel approximation, and multi-pass. Post-processing options include filtering and averaging of the resulting vector fields, extraction of velocity, divergence and collectiveness maps, simulation of pseudo-trajectories, and unit conversion. In addition, our software includes functions to visualize the 3D vector fields in Paraview.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Particle image velocimetry</kwd>
      <kwd>Light-sheet fluorescence microscopy</kwd>
      <kwd>Collective cell migration</kwd>
      <kwd>Julia</kwd>
      <kwd>3D image analysis</kwd>
      <kwd>Tribolium castaneum</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Deutsche Forschungsgemeinschaft</institution>
        </funding-source>
        <award-id>41498584</award-id>
        <principal-award-recipient>
          <name>
            <surname>Pereyra</surname>
            <given-names>Marc</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>LOEWE Hessen (DE)</institution>
        </funding-source>
        <award-id>DynaMem</award-id>
        <award-id>CMMS</award-id>
        <principal-award-recipient>
          <name>
            <surname>Drusko</surname>
            <given-names>Armin</given-names>
          </name>
          <name>
            <surname>Krämer</surname>
            <given-names>Franziska</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>LOEWE Hessen (DE)</institution>
        </funding-source>
        <award-id>DynaMem</award-id>
        <award-id>CMMS</award-id>
        <principal-award-recipient>
          <name>
            <surname>Krämer</surname>
            <given-names>Franziska</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001659</institution-id>
            <institution>Deutsche Forschungsgemeinschaft</institution>
          </institution-wrap>
        </funding-source>
        <award-id>41498584</award-id>
        <principal-award-recipient>
          <name>
            <surname>Krämer</surname>
            <given-names>Franziska</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100008662</institution-id>
            <institution>Joachim Herz Stiftung</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Cluster of Excellence Macromollecular Complexes (DE)</institution>
        </funding-source>
        <award-id>DFG, EXC 115</award-id>
        <principal-award-recipient>
          <name>
            <surname>Stelzer</surname>
            <given-names>Ernst H. K.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Johann Wolfgang Goethe-Universität, Frankfurt am Main (1022)</institution>
        </funding-source>
      </award-group>
      <open-access>
        <p>Open Access funding enabled and organized by Projekt DEAL.</p>
      </open-access>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par4">Cellular migration in multi-cellular organisms often involves tissues or groups of cells that maintain stable or transient cell-cell contacts to preserve tissue integrity, sustain spatial patterning, or to enable the relocation of non-motile cells [<xref ref-type="bibr" rid="CR1">1</xref>]. This phenomenon is generally known as collective cell migration, and it plays important roles in developmental processes, such as gastrulation or neural crest migration [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>], as well as in wound closure and cancer invasion [<xref ref-type="bibr" rid="CR4">4</xref>]. Studies of collective cell migration on 2D cell cultures only partially reflect the physiology and architecture of in vivo tissues. Three-dimensional systems—such as model organisms, spheroids or organoids—are preferable, as they maintain physiological cell structures, neighborhood interactions, or mechanical extracellular properties, which have been recognized to play a role in regulating collective cellular migration [<xref ref-type="bibr" rid="CR5">5</xref>–<xref ref-type="bibr" rid="CR7">7</xref>]. Besides confocal fluorescence microscopy, light-sheet fluorescence microscopy (LSFM) has become one of the preferred techniques for three-dimensional imaging of biological samples, owing to its fast acquisition times, excellent signal-to-noise ratios, high spatial resolutions [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>], and low phototoxicity and photobleaching levels [<xref ref-type="bibr" rid="CR10">10</xref>]. LSFM has been used to generate 3D time-lapse recordings of the complete embryonic morphogenesis of multiple model organisms [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. Based on light-sheet illumination, novel and improved imaging techniques are continuously being developed. For example, SCAPE (swept confocally-aligned planar excitation) microscopy offers more control over the viewing angle of the sample [<xref ref-type="bibr" rid="CR13">13</xref>], while SVIM (selective volume illumination microscopy) dramatically increases acquisition times by dilating the light-sheet, at the expense of spatial resolution [<xref ref-type="bibr" rid="CR14">14</xref>]. High temporal and spatial resolutions can be achieved with lattice light-sheet microscopy, where a combination of ultrathin light sheets and structured illumination are used [<xref ref-type="bibr" rid="CR15">15</xref>]. The two last-mentioned techniques are particularly promising for resolving cellular migration and tissue rearrangements during quick morphogenetic events.</p>
    <p id="Par5">In order to quantify collective cellular migration in dynamic 3D biological data sets, we developed quickPIV, a free and open-source particle image velocimetry (PIV) package that offers fast and robust 3D, as well as 2D, PIV analyses. While several free and open-source 2D PIV software are readily available [<xref ref-type="bibr" rid="CR16">16</xref>–<xref ref-type="bibr" rid="CR19">19</xref>], the same is not true for 3D implementations. To the best of our knowledge, the Python implementation hosted in openPIV is the only other free and open-source PIV package that supports 3D analyses [<xref ref-type="bibr" rid="CR18">18</xref>]. The fastest implementation in openPIV, however, corresponds to a 2D PIV implementation written in C++. Nevertheless, maintenance of this version was stopped in favor of the high-level and productive environment of its Python counterpart. In order to maximize performance without sacrificing productivity, our software is written in Julia, a modern programming language with high-level syntax similar to Python or Matlab that compiles to highly efficient code on par with C programs [<xref ref-type="bibr" rid="CR20">20</xref>]. This choice is motivated by the high data volumes of 3D time-lapse recordings, which makes the analysis of multiple data sets computationally very expensive. For instance, a single sequence of 3D images of a developing embryo can easily reach data sizes of several Terabytes. Hence, the design principles of Julia enabled us to prioritize the CPU performance of quickPIV, and together with further optimizations, made it possible to reduce the processing speed of a pair of 3D volumes to several seconds.</p>
    <p id="Par6">The next subsection introduces PIV and discusses the strengths and limitations of applying PIV on biological samples. This is followed by a detailed description of the pipeline and the features implemented in quickPIV. The evaluation of our software includes a performance comparison to the C++ (2D) and Python (2D and 3D) implementations hosted in openPIV, as well as the accuracy evaluation of quickPIV on synthetic data. Furthermore, we analyze the ability of quickPIV to characterize migration patterns on three 3D time-lapse data sets of the embryonic development of the red flour beetle <italic>Tribolium castaneum</italic> [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR22">22</xref>]. This is done by (1) simulating known translations on a 3D volume of <italic>T. castaneum</italic>, (2) validating the obtained vector fields against well-known migration patterns during the gastrulation of <italic>T. castaneum</italic>, and (3) by comparing the robustness of quickPIV on an embryo expressing both actin and nuclear molecular markers.</p>
    <sec id="Sec2">
      <title>Particle image velocimetry</title>
      <p id="Par7">Particle image velocimetry is a segmentation-free technique developed and established in the field of fluid dynamics to obtain displacement fields describing the motion of small tracer particles suspended in a flowing medium [<xref ref-type="bibr" rid="CR23">23</xref>]. If the density of seeding particles is not exceedingly high [<xref ref-type="bibr" rid="CR24">24</xref>], the motion of each suspended particle can generally be recovered through particle tracking velocimetry (PTV) [<xref ref-type="bibr" rid="CR25">25</xref>]. PTV is analog to single-cell tracking, requiring the segmentation of all particles in two consecutive recordings before establishing one-to-one correspondences between the particle positions. While the size and seeding density of the tracer particles in hydro- and aerodynamic PIV experiments can be tuned [<xref ref-type="bibr" rid="CR26">26</xref>], the segmentability of biological samples is challenged by factors with no or limited experimental control. For example, cell segmentation is hindered by low contrast of the molecular marker, irregular cell morphologies, or high cell densities. Instead of detecting and tracking individual objects, PIV relies on cross-correlation to find the translation that best aligns the intensity patterns contained inside any given sub-region between two consecutive recordings. Vector fields are generated by extracting displacement vectors from multiple sub-regions across the input data [<xref ref-type="bibr" rid="CR23">23</xref>].</p>
      <p id="Par8">The accuracy of PIV on biological data is mostly explained by the strengths and limitations of cross-correlation. In short, cross-correlation is a pattern-matching operation that is suitable for finding translations of the intensity distributions contained in two successive recordings [<xref ref-type="bibr" rid="CR27">27</xref>]. Therefore, PIV is appropriate for quantifying collective cell migration, which is dominated by a common translation of the migrating group of cells. Moreover, the pattern-matching nature of cross-correlation extends the application of PIV to non-segmentable data sets, including unstained samples or those stained with any persistent intra-cellular marker. PIV has been used to quantify cell migration in 2D model systems, such as wound healing assays [<xref ref-type="bibr" rid="CR28">28</xref>], tumor invasion [<xref ref-type="bibr" rid="CR29">29</xref>, <xref ref-type="bibr" rid="CR30">30</xref>], skin patterning [<xref ref-type="bibr" rid="CR31">31</xref>] and others [<xref ref-type="bibr" rid="CR32">32</xref>–<xref ref-type="bibr" rid="CR34">34</xref>]. Conversely, cross-correlation is challenged by transformations other than translations, such as rotations, shears or deformations. High temporal resolutions alleviate the contribution of these transformations by approximating them to local translations. Uncoordinated cellular migration also reduces the similarity of intensity patterns between successive recordings, which degrades the accuracy of PIV. However, if the cells are sufficiently different from each other such that they are unambiguously detected by cross-correlation, a PIV analysis matching the size of the cells can be used to effectively track the movement of independently migrating cell [<xref ref-type="bibr" rid="CR35">35</xref>, <xref ref-type="bibr" rid="CR36">36</xref>].</p>
    </sec>
  </sec>
  <sec id="Sec3">
    <title>Implementation</title>
    <p id="Par9">This section outlines the three-dimensional PIV pipeline implemented in quickPIV. The workflow of a PIV analysis in quickPIV is illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. This figure shows input volumes containing Gaussian particles to ease the visualization of the underlying translation. To accommodate all possible labeling schemes of biological samples, we generally refer to structures or intensity patterns in the analyzed data.<fig id="Fig1"><label>Fig. 1</label><caption><p>QuickPIV pipeline The PIV analysis starts by subdividing the input volumes, <inline-formula id="IEq53"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{t}$$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq53.gif"/></alternatives></inline-formula> and <inline-formula id="IEq54"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{t+1}$$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq54.gif"/></alternatives></inline-formula>, into a grid of cubic interrogation, <italic>IV</italic>, and search volumes, <italic>SV</italic>. Cross-correlation is performed between each <italic>IV</italic>[<italic>i</italic>, <italic>j</italic>, <italic>k</italic>] and <italic>SV</italic>[<italic>i</italic>, <italic>j</italic>, <italic>k</italic>] pair, and a displacement vector, (<italic>u</italic>[<italic>i</italic>, <italic>j</italic>, <italic>k</italic>], <italic>v</italic>[<italic>i</italic>, <italic>j</italic>, <italic>k</italic>], <italic>w</italic>[<italic>i</italic>, <italic>j</italic>, <italic>k</italic>]), is computed from each cross-correlation matrix through the position of the maximum peak relative to the center of the cross-correlation matrix. The computed vector components are added to the <italic>U</italic>, <italic>V</italic> and <italic>W</italic> matrices. Optionally, signal-to-noise ratios are computed from each cross-correlation matrix and added to <italic>SN</italic>. If multi-pass is used, the cross-correlation analysis is repeated at progressively lower scales, which is achieved by scaling down the <italic>interrogation size</italic>, <italic>overlap</italic> and <italic>search margin</italic> parameters at each iteration. During multi-pass, previously computed displacements offset the sampling of the search volumes, effectively refining the computed displacements at each iteration. In order to post-process the PIV-computed vector fields, quickPIV currently implements: signal-to-noise and vector magnitude filtering, space-time averaging, divergence maps, velocity maps, collectiveness maps, pseudo-trajectories and unit conversion. (a) Left, two <inline-formula id="IEq55"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$60\times 50 \times 50$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mn>60</mml:mn><mml:mo>×</mml:mo><mml:mn>50</mml:mn><mml:mo>×</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq55.gif"/></alternatives></inline-formula> voxel volumes are overlaid, with particles in <inline-formula id="IEq56"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_t$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq56.gif"/></alternatives></inline-formula> shown in red, and particles in <inline-formula id="IEq57"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{t+1}$$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq57.gif"/></alternatives></inline-formula> in blue. <italic>Interrogation volume size</italic> of <inline-formula id="IEq58"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$16 \times 16 \times 16$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mn>16</mml:mn><mml:mo>×</mml:mo><mml:mn>16</mml:mn><mml:mo>×</mml:mo><mml:mn>16</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq58.gif"/></alternatives></inline-formula> voxels leads to <inline-formula id="IEq59"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3\times 3 \times 3$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq59.gif"/></alternatives></inline-formula> subdivision of non-overlapping interrogation and search volumes. Right, with 50% <italic>overlap</italic> the grid subdivision size is <inline-formula id="IEq60"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$6 \times 5 \times 5$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mn>6</mml:mn><mml:mo>×</mml:mo><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq60.gif"/></alternatives></inline-formula>. (b) Example of 3D cross-correlation between <italic>IV</italic>[2, 2, 2] and <italic>SV</italic>[2, 2, 2]. The use of a <italic>search margin</italic> of 5 voxels is illustrated, enlarging the search volume by 5 voxels in all directions. (c) Example of displacement computation. For clarity, this example portrays low particle densities and big particle radii, which results in sub-optimal accuracy of the 3-point Gaussian sub-voxel approximation</p></caption><graphic xlink:href="12859_2021_4474_Fig1_HTML" id="MO11"/></fig></p>
    <p id="Par10">The input to a 3D PIV analysis is a pair of 3D volumes taken at consecutive time points, <inline-formula id="IEq1"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{t}[x,y,z]$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq1.gif"/></alternatives></inline-formula> and <inline-formula id="IEq2"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{t+1}[x,y,z]$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq2.gif"/></alternatives></inline-formula>, where (<italic>x</italic>, <italic>y</italic>, <italic>z</italic>) corresponds to the unique 3D coordinates of each voxel. Both input volumes are assumed to have the same dimensions. First, <inline-formula id="IEq3"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{t}$$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq3.gif"/></alternatives></inline-formula> is subdivided into a 3D grid of cubic sub-regions known as interrogation volumes, <italic>IV</italic>[<italic>i</italic>, <italic>j</italic>, <italic>k</italic>], each specified by its position in the grid, (<italic>i</italic>, <italic>j</italic>, <italic>k</italic>). The dimensions of the grid subdivision are determined by the interrogation volume size and the overlap between adjacent interrogation volumes, see Fig. <xref rid="Fig1" ref-type="fig">1</xref>a. For each interrogation volume, a corresponding search volume, <italic>SV</italic>[<italic>i</italic>, <italic>j</italic>, <italic>k</italic>], can be defined in <inline-formula id="IEq4"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{t+1}$$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq4.gif"/></alternatives></inline-formula>.</p>
    <p id="Par11">Structures moving inside <italic>IV</italic>[<italic>i</italic>, <italic>j</italic>, <italic>k</italic>] by a translation <inline-formula id="IEq5"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {s}} = (s_x, s_y, s_z)$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:mi mathvariant="bold">s</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq5.gif"/></alternatives></inline-formula> are expected to be found <inline-formula id="IEq6"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Vert {\mathbf {s}}\Vert$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mo stretchy="false">‖</mml:mo><mml:mi mathvariant="bold">s</mml:mi><mml:mo stretchy="false">‖</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq6.gif"/></alternatives></inline-formula> voxels away in the direction of the translation in <italic>SV</italic>[<italic>i</italic>, <italic>j</italic>, <italic>k</italic>]. The underlying translation, <inline-formula id="IEq7"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {s}}$$\end{document}</tex-math><mml:math id="M30"><mml:mi mathvariant="bold">s</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq7.gif"/></alternatives></inline-formula>, of the structures contained in <italic>IV</italic>[<italic>i</italic>, <italic>j</italic>, <italic>k</italic>] and <italic>SV</italic>[<italic>i</italic>, <italic>j</italic>, <italic>k</italic>] is recovered through a cross-correlation analysis [<xref ref-type="bibr" rid="CR27">27</xref>]. The cross-correlation between a pair of interrogation and search volumes results in a 3D cross-correlation matrix. In the absence of other transformations, the vector from the center to the maximum peak of the cross-correlation matrix reflects the underlying translation of the structures contained in <italic>IV</italic>[<italic>i</italic>, <italic>j</italic>, <italic>k</italic>] and <italic>SV</italic>[<italic>i</italic>, <italic>j</italic>, <italic>k</italic>]. The structures visible in <italic>IV</italic>[<italic>i</italic>, <italic>j</italic>, <italic>k</italic>] may move outside the borders of the corresponding <italic>SV</italic>[<italic>i</italic>, <italic>j</italic>, <italic>k</italic>]. This is known as out-of-frame loss, and it limits the ability of cross-correlation to match the spatial intensity distributions between the pair of interrogation and search volumes. This can be compensated by enlarging the search volumes by a given margin along all dimensions, designated as search margin in quickPIV. The search margin should not be much larger than the expected translation strength of the structures, as enlarging the search volumes comes at the expense of performance. Figure <xref rid="Fig1" ref-type="fig">1</xref>b depicts the cross-correlation of the central interrogation and search volumes in Fig. <xref rid="Fig1" ref-type="fig">1</xref>a, including a search margin of 5 voxels around the search volume.</p>
    <p id="Par12">By computing a displacement vector for each pair of interrogation and search volumes, PIV analyses generate a vector field that describes the velocity distribution of the structures contained in the input volumes. The components of the PIV-computed vector field are returned separately in three 3D matrices: <italic>U</italic>, <italic>V</italic> and <italic>W</italic>. It should be noted that the resolution of the final vector field is decided by the size of the interrogation volumes and their overlap, which determine the grid subdivision of <inline-formula id="IEq8"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{t}$$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq8.gif"/></alternatives></inline-formula> and <inline-formula id="IEq9"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{t+1}$$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq9.gif"/></alternatives></inline-formula>. Multi-pass is implemented to overcome this trade-off between resolution and the interrogation size of the PIV analysis.</p>
    <sec id="Sec4">
      <title>Cross-correlation</title>
      <p id="Par13">The cross-correlation of two one-dimensional real-valued functions is defined as:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}{}[ f \star g ](s) = \int _{-\infty }^{\infty } f(x)g(x + s) \mathrm {d}x \ , \end{aligned}$$\end{document}</tex-math><mml:math id="M36" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>f</mml:mi><mml:mo>⋆</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mi>∞</mml:mi></mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi><mml:mspace width="4pt"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4474_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <italic>s</italic> has the effect of shifting <italic>g</italic>(<italic>x</italic>) along the x-axis. Cross-correlation involves computing the dot product of <italic>f</italic>(<italic>x</italic>) and <inline-formula id="IEq10"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g(x+s)$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq10.gif"/></alternatives></inline-formula> for all possible values of <italic>s</italic>. Since the dot product entails a basic measure of similarity, the value of <italic>s</italic> that achieves the highest dot product represents the translation that best aligns the two functions.</p>
      <p id="Par14">The form of cross-correlation in Eq. (<xref rid="Equ1" ref-type="">1</xref>) is known as spatial cross-correlation. Discrete implementations of spatial cross-correlation have a 1D complexity of <inline-formula id="IEq11"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(N^2)$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq11.gif"/></alternatives></inline-formula>. Taking advantage of the convolution theorem, cross-correlation can be computed in the frequency domain through Fourier transforms of <italic>f</italic>(<italic>x</italic>) and <italic>g</italic>(<italic>x</italic>):<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} f \star g = {\mathcal {F}}^{-1}\{ \overline{{\mathcal {F}}\{f\}} \cdot {\mathcal {F}}\{g\}\} \ , \end{aligned}$$\end{document}</tex-math><mml:math id="M42" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>f</mml:mi><mml:mo>⋆</mml:mo><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mover><mml:mrow><mml:mi mathvariant="script">F</mml:mi><mml:mo stretchy="false">{</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>·</mml:mo><mml:mi mathvariant="script">F</mml:mi><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mspace width="4pt"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4474_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq12"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {F}}$$\end{document}</tex-math><mml:math id="M44"><mml:mi mathvariant="script">F</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq12.gif"/></alternatives></inline-formula> and <inline-formula id="IEq13"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {F}}^{-1}$$\end{document}</tex-math><mml:math id="M46"><mml:msup><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq13.gif"/></alternatives></inline-formula> denote the Fourier and inverse Fourier transforms, respectively. Each Fourier and inverse Fourier transform in Eq. (<xref rid="Equ2" ref-type="">2</xref>) can be computed efficiently with the Fast Fourier Transform (FFT) algorithm [<xref ref-type="bibr" rid="CR37">37</xref>], which has a 1D complexity of <inline-formula id="IEq14"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O( N \log {N} )$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>log</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq14.gif"/></alternatives></inline-formula>. Since Eq. (<xref rid="Equ2" ref-type="">2</xref>) does not involve any operations with higher complexities than FFT’s, the overall complexity of 1D cross-correlation in the frequency domain is <inline-formula id="IEq15"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O( N \log {N} )$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>log</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq15.gif"/></alternatives></inline-formula>. For this reason, cross-correlation in quickPIV is computed in the frequency domain. We rely on a Julia wrapper around the mature and optimized Fastest Fourier Transform of the West (FFTW) C library [<xref ref-type="bibr" rid="CR38">38</xref>] to compute all Fourier and inverse Fourier transforms. FFTW implementations of FFT generalize to multi-dimensional data, enabling the efficient three-dimensional computation of cross-correlation.</p>
      <p id="Par15">To tackle the bias of the dot product towards high intensities, we implemented zero-normalized cross-correlation (ZNCC). Considering <italic>IV</italic> and <italic>SV</italic> as a pair of 3D interrogation and search volumes, ZNCC is calculated at each translation of <italic>IV</italic> by:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} ZNCC[\mathbf{s }] = \sum _{x,y,z} \frac{ (IV[\mathbf{x }]-\mu _{IV})(SV[\mathbf{x } + \mathbf{s } ]-\mu _{SV}) }{ \sqrt{ \sum _{x,y,z}( IV[\mathbf{x }] - \mu _{IV} )^2 \sum _{x,y,z}( SV[\mathbf{x } + \mathbf{s }] - \mu _{SV} )^2 } } \, \end{aligned}$$\end{document}</tex-math><mml:math id="M52" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>Z</mml:mi><mml:mi>N</mml:mi><mml:mi>C</mml:mi><mml:mi>C</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="bold">s</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="italic">IV</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">s</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="italic">SV</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:msqrt><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="italic">IV</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">s</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="italic">SV</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mfrac><mml:mspace width="0.166667em"/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4474_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where <bold>x</bold> is a 3D index (<italic>x</italic>, <italic>y</italic>, <italic>z</italic>) running over all voxels of <italic>IV</italic>, <bold>s</bold> is the displacement vector <inline-formula id="IEq16"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(s_x,s_y,s_z)$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq16.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq17"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _{IV}$$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="italic">IV</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq17.gif"/></alternatives></inline-formula> and <inline-formula id="IEq18"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _{SV}$$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="italic">SV</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq18.gif"/></alternatives></inline-formula> are the average intensity values of the interrogation and search volumes, respectively. Zero-normalized cross-correlation is implemented efficiently in quickPIV following the work of Lewis, who noted that the numerator in Eq. (<xref rid="Equ3" ref-type="">3</xref>) can be computed efficiently in the frequency domain, while each sum in the denominator can be calculated with eight operations from an integral array of the search volume [<xref ref-type="bibr" rid="CR39">39</xref>].</p>
      <p id="Par16">To further improve the pattern-matching robustness of cross-correlation, quickPIV also offers normalized squared error cross-correlation (NSQECC). At each translation of <italic>IV</italic>, NSQECC is computed as [<xref ref-type="bibr" rid="CR40">40</xref>]:<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} NSQECC[\mathbf{s }] = \sum _{x,y,z} \frac{ (IV[\mathbf{x }]-SV[\mathbf{x } + \mathbf{s } ])^2 }{ \sqrt{\sum _{x,y,z}(IV[\mathbf{x }])^2 \sum _{x,y,z}(SV[\mathbf{x } + \mathbf{s }])^2 } } \ , \end{aligned}$$\end{document}</tex-math><mml:math id="M60" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mi>Q</mml:mi><mml:mi>E</mml:mi><mml:mi>C</mml:mi><mml:mi>C</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="bold">s</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>S</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">s</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:msqrt><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">s</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mfrac><mml:mspace width="4pt"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4474_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>where <bold>x</bold> is a 3D index (<italic>x</italic>, <italic>y</italic>, <italic>z</italic>) running over all voxels of <italic>IV</italic>, and <bold>s</bold> is the displacement vector <inline-formula id="IEq19"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(s_x,s_y,s_z)$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq19.gif"/></alternatives></inline-formula>. Following the example of [<xref ref-type="bibr" rid="CR39">39</xref>], Eq. (<xref rid="Equ4" ref-type="">4</xref>) is implemented efficiently in quickPIV by expressing the numerator and denominator in terms of three components: <inline-formula id="IEq20"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sum (IV[\mathbf{x }])^2$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:mo>∑</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq20.gif"/></alternatives></inline-formula>, which is constant, <inline-formula id="IEq21"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sum (SV[\mathbf{x }+\mathbf{s }])^2$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mo>∑</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">s</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq21.gif"/></alternatives></inline-formula>, which is computed efficiently for each translation from an integral array, and <inline-formula id="IEq22"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-2\sum (IV[\mathbf{x }]SV[\mathbf{x }+\mathbf{s }])$$\end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mo>∑</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mi>V</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mi>S</mml:mi><mml:mi>V</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">s</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq22.gif"/></alternatives></inline-formula>, which can be computed as an unnormalized cross-correlation in the frequency domain. For convenience, quickPIV implements the inverse of Eq. (<xref rid="Equ4" ref-type="">4</xref>), <inline-formula id="IEq23"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 / ( 1 + NSQECC[\mathbf{s }])$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mi>Q</mml:mi><mml:mi>E</mml:mi><mml:mi>C</mml:mi><mml:mi>C</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="bold">s</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq23.gif"/></alternatives></inline-formula>, to obtain a maximum peak at the translation that minimizes the differences between the interrogation and search volumes.</p>
    </sec>
    <sec id="Sec5">
      <title>Peak sub-voxel approximation</title>
      <p id="Par17">In order to detect non-integer translations, two sub-voxel interpolation methods are included in quickPIV: the centroid-based and the 3-point Gaussian sub-voxel approximations [<xref ref-type="bibr" rid="CR41">41</xref>]. In both methods, sub-voxel refinements are computed by considering the direct neighboring values around the maximum peak of the cross-correlation matrix. The centroid-based sub-voxel refinements, <inline-formula id="IEq24"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta$$\end{document}</tex-math><mml:math id="M72"><mml:mi mathvariant="normal">Δ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq24.gif"/></alternatives></inline-formula>, are computed by<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \Delta [\mathbf{d }] = \frac{C[\mathbf{x }+\mathbf{d }] - C[\mathbf{x }-\mathbf{d }]}{C[\mathbf{x }+\mathbf{d }] + C[\mathbf{x }] + C[\mathbf{x }-\mathbf{d }]} \ , \end{aligned}$$\end{document}</tex-math><mml:math id="M74" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="bold">d</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>C</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">d</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>-</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="bold">d</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">d</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="bold">d</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mfrac><mml:mspace width="4pt"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4474_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>where <italic>C</italic> refers to the cross-correlation matrix, <inline-formula id="IEq25"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{x }$$\end{document}</tex-math><mml:math id="M76"><mml:mi mathvariant="bold">x</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq25.gif"/></alternatives></inline-formula> are the voxel coordinates of the maximum peak in the cross-correlation matrix, and <inline-formula id="IEq26"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{d }$$\end{document}</tex-math><mml:math id="M78"><mml:mi mathvariant="bold">d</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq26.gif"/></alternatives></inline-formula> is the standard basis vector for each dimension, e.g. (1, 0, 0) for the first dimension. Following the same notation, the 3-point Gaussian sub-voxel refinement of the integer displacement is given by<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \Delta [\mathbf{d }] = \frac{ \ln { (C[\mathbf{x }+\mathbf{d }]) } - \ln { (C[\mathbf{x }-\mathbf{d }]) } }{ 2\;\ln {(C[\mathbf{x }+\mathbf{d }])} - 4\;\ln {(C[\mathbf{x }])} + 2\;\ln {(C[\mathbf{x }-\mathbf{d }])} } \ . \end{aligned}$$\end{document}</tex-math><mml:math id="M80" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="bold">d</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>ln</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">d</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mo>ln</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="bold">d</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mspace width="0.277778em"/><mml:mo>ln</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">d</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn><mml:mspace width="0.277778em"/><mml:mo>ln</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mspace width="0.277778em"/><mml:mo>ln</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="bold">d</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mspace width="4pt"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4474_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>To acquire sub-voxel precision, the interpolated <inline-formula id="IEq27"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta$$\end{document}</tex-math><mml:math id="M82"><mml:mi mathvariant="normal">Δ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq27.gif"/></alternatives></inline-formula> is added to the integer displacement vector from the maximum peak to the center of the cross-correlation matrix. QuickPIV defaults to the 3-point Gaussian sub-voxel approximation, which performs particularly well when the input volumes contain Gaussian particles, as the convolution of Gaussians produces another Gaussian distribution [<xref ref-type="bibr" rid="CR42">42</xref>].</p>
    </sec>
    <sec id="Sec6">
      <title>Multi-pass</title>
      <p id="Par18">We implemented a multi-pass procedure to increase the accuracy of the PIV analysis and to extend its dynamic range, i.e., the range of detectable displacements. While a search margin can be added to increase the dynamic range of a standard PIV analysis, it does not eliminate the dependence on small interrogation volumes to achieve high resolutions, which limits the specificity and enhances the noise of the intensity patterns contained in the interrogation volumes [<xref ref-type="bibr" rid="CR43">43</xref>]. Alternatively, high resolutions with good dynamic ranges can be achieved by combining large interrogation volumes with high overlaps. However, this approach is computationally expensive and increases the final resolution by adding redundancy between consecutive cross-correlation computations [<xref ref-type="bibr" rid="CR44">44</xref>].</p>
      <p id="Par19">The multi-pass algorithm starts the PIV analysis with up-scaled interrogation and search volumes, followed by iterative rounds of PIV analyses with gradually smaller interrogation size and search volumes. Additionally, the displacements calculated during previous rounds are used to offset the sampling of the search volumes at future rounds [<xref ref-type="bibr" rid="CR45">45</xref>]. The multi-pass factor <italic>f</italic> defines the number of total rounds that will be conducted. Therefore, multi-pass is enabled by setting <italic>f</italic> larger than 1. At each multi-pass round, the interrogation size, search margin and overlap parameters are scaled with respect to their user-defined values. The value of these parameters in each round <italic>r</italic> is computed as follows:<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \kappa _r = ( 1 + f - r )\ *\ \kappa _0 \ , \end{aligned}$$\end{document}</tex-math><mml:math id="M84" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>κ</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>f</mml:mi><mml:mo>-</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="4pt"/><mml:mrow/><mml:mo>∗</mml:mo><mml:mspace width="4pt"/><mml:msub><mml:mi>κ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mspace width="4pt"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4474_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq28"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\kappa _0$$\end{document}</tex-math><mml:math id="M86"><mml:msub><mml:mi>κ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq28.gif"/></alternatives></inline-formula> designates the user-defined value for interrogation size, search margin or overlap, <inline-formula id="IEq29"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\kappa _r$$\end{document}</tex-math><mml:math id="M88"><mml:msub><mml:mi>κ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq29.gif"/></alternatives></inline-formula> is the up-scaled value of these parameters at round <italic>r</italic>, and <italic>f</italic> is the multi-pass factor. The final round is performed with a factor of 1, i.e., the initial interrogation sizes.</p>
    </sec>
    <sec id="Sec7">
      <title>Post-processing</title>
      <p id="Par20">Some of the post-processing features explained below include local information around the vector being processed. In such cases, a square (2D) or cubic (3D) region is sampled around each post-processed vector. For instance, <inline-formula id="IEq30"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_x$$\end{document}</tex-math><mml:math id="M90"><mml:msub><mml:mi>r</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq30.gif"/></alternatives></inline-formula> and <inline-formula id="IEq31"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_y$$\end{document}</tex-math><mml:math id="M92"><mml:msub><mml:mi>r</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq31.gif"/></alternatives></inline-formula> define a square area around an arbitrary vector in a 2D vector field, <inline-formula id="IEq32"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_{i,j}$$\end{document}</tex-math><mml:math id="M94"><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq32.gif"/></alternatives></inline-formula>, given by <inline-formula id="IEq33"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L = \{ v_{i+r_x,j+r_y} \ | \ -r \le r_x \le r \ and \ -r \le r_y \le r \}$$\end{document}</tex-math><mml:math id="M96"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mspace width="4pt"/><mml:mo stretchy="false">|</mml:mo><mml:mspace width="4pt"/><mml:mo>-</mml:mo><mml:mi>r</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:mi>r</mml:mi><mml:mspace width="4pt"/><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mspace width="4pt"/><mml:mo>-</mml:mo><mml:mi>r</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq33.gif"/></alternatives></inline-formula>.</p>
      <sec id="Sec8">
        <title>Filtering</title>
        <p id="Par21">A PIV-computed vector is considered unreliable if it was computed from a cross-correlation matrix containing multiple peaks with similar heights as the maximum peak. This reveals uncertainty about the underlying displacement, which might be caused by unspecific structures, background noise and/or loss of structure pairs [<xref ref-type="bibr" rid="CR46">46</xref>, <xref ref-type="bibr" rid="CR47">47</xref>]. QuickPIV adopts the primary peak ratio, <italic>PPR</italic>, to measure the specificity of each computed vector,<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \mathrm {PPR} = \frac{C_{\max1}}{C_{\max2}} \ , \end{aligned}$$\end{document}</tex-math><mml:math id="M98" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="normal">PPR</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo movablelimits="true">max</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mo movablelimits="true">max</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mfrac><mml:mspace width="4pt"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4474_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq34"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{\rm max}{1}$$\end{document}</tex-math><mml:math id="M100"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi mathvariant="normal">max</mml:mi></mml:msub><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq34.gif"/></alternatives></inline-formula> is the height of the primary peak in the cross-correlation matrix and <inline-formula id="IEq35"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{\rm max}{2}$$\end{document}</tex-math><mml:math id="M102"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi mathvariant="normal">max</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq35.gif"/></alternatives></inline-formula> is the height of the secondary peak. Vectors with high <italic>PPR</italic> values are considered to have high signal-to-noise ratios [<xref ref-type="bibr" rid="CR48">48</xref>]. Therefore, quickPIV offers filtering of unreliable vectors by discarding those vectors with a <italic>PPR</italic> value lower than a given threshold, <inline-formula id="IEq36"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$th_{\rm PPR}$$\end{document}</tex-math><mml:math id="M104"><mml:mrow><mml:mi>t</mml:mi><mml:msub><mml:mi>h</mml:mi><mml:mi mathvariant="normal">PPR</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq36.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR48">48</xref>].</p>
        <p id="Par22">Additionally, quickPIV includes both global and local filtering in terms of vector magnitudes. Currently, quickPIV offers low pass and high pass filters of vector magnitudes, which can be concatenated to perform band-pass filtering. Global magnitude filtering can also be performed on those vectors whose magnitude is more than a certain number of standard deviations away from the mean magnitude of the vector field. Local magnitude filtering is implemented by discarding vectors whose magnitude is at least <italic>n</italic> standard deviations away from the mean magnitude, computed in a radius <italic>r</italic> around each vector.</p>
        <p id="Par23">All filtering functions in quickPIV accept an optional argument that is used to determine the replacement scheme of the filtered vectors. Currently, quickPIV offers three replacement functions: zero-replacement, mean replacement and median replacement. The former sets all components of the filtered vectors to zero. Both the mean and median replacement schemes are parametrized by the radius of the neighboring region used to compute the mean or median vector.</p>
      </sec>
      <sec id="Sec9">
        <title>Spatial and temporal averaging</title>
        <p id="Par24">Spatial and spatio-temporal averaging of the computed vector fields are included in quickPIV. Spatial averaging depends on one parameter: the radius, <inline-formula id="IEq37"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_s$$\end{document}</tex-math><mml:math id="M106"><mml:msub><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq37.gif"/></alternatives></inline-formula>, of the considered neighboring region around each vector. Different radii for each dimension can be provided by passing an array of values, <inline-formula id="IEq38"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[ r_x, r_y, r_z ]$$\end{document}</tex-math><mml:math id="M108"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq38.gif"/></alternatives></inline-formula>. Spatio-temporal averaging considers two parameters: the averaging radius in space and the number, <inline-formula id="IEq39"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_t$$\end{document}</tex-math><mml:math id="M110"><mml:msub><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq39.gif"/></alternatives></inline-formula>, of adjacent vectors along the time axis considered in the temporal averaging, e.g. <inline-formula id="IEq40"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{ v_{i,j,k,t+r} | -n_t \le r \le n_t \}$$\end{document}</tex-math><mml:math id="M112"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:mi>r</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq40.gif"/></alternatives></inline-formula>.</p>
      </sec>
      <sec id="Sec10">
        <title>Similarity-selective spatial averaging</title>
        <p id="Par25">Spatial averaging tends to dissolve vectors adjacent to the background and creates artifactual vectors in regions containing dissimilar vectors. A similarity-selective spatial averaging has been developed to overcome these limitations, and to enhance the visualization of collective migration. Two vectors are considered to be similar if they point in the same direction, which is established if their normalized dot product is greater than a user-defined threshold. Given any vector in the PIV-computed vector field, <inline-formula id="IEq41"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {v}[i,j,k]$$\end{document}</tex-math><mml:math id="M114"><mml:mrow><mml:mi mathvariant="bold">v</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq41.gif"/></alternatives></inline-formula>, an average vector is built by considering only those neighboring vectors at a radius <italic>r</italic> that are similar to <inline-formula id="IEq42"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf {v}[i,j,k]$$\end{document}</tex-math><mml:math id="M116"><mml:mrow><mml:mi mathvariant="bold">v</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq42.gif"/></alternatives></inline-formula>. The averaged vector is then normalized to unit length, and its magnitude is further re-scaled by the ratio between the number of similar neighboring vectors and the total number of neighboring vectors. Therefore, the effect of similarity-selective averaging is to average the direction of each vector among similar neighboring vectors, and to re-scale the magnitude of each vector by the local collectiveness.</p>
      </sec>
      <sec id="Sec11">
        <title>Mappings</title>
        <p id="Par26">QuickPIV provides functions for extracting several relevant quantities from the PIV-computed vector fields. Velocity maps are generated by returning the magnitude of each vector from a given vector field. QuickPIV implements convergence/divergence mappings to detect the presence of sinks and sources in the PIV-computed vector fields. This is done by generating a cube of normalized vectors that either converge (sink) or diverge (source) from the center of the cube, and cross-correlating this cube with the normalized vector field. This mapping is parametrized by the size of the cube, which determines the scale of the convergence/divergence map. Collectiveness maps are built by computing the number of neighboring vectors at a radius <italic>r</italic> from each vector in the vector field <inline-formula id="IEq43"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_{i,j}$$\end{document}</tex-math><mml:math id="M118"><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq43.gif"/></alternatives></inline-formula> whose normalized dot product is greater than a threshold.</p>
      </sec>
      <sec id="Sec12">
        <title>Pseudo-trajectories</title>
        <p id="Par27">Pseudo-trajectories can be generated with quickPIV to visualize the approximate paths of cells and tissues from the PIV-computed vector fields. When computing pseudo-trajectories, a user-defined number of particles is randomly distributed within the dimensions of the vector field. The position of each particle is rounded to integer coordinates in order to sample a displacement from the vector field, which shifts the particle from its current position. By repeating this process, a three-dimensional path is obtained for each simulated particle. It is possible to constrain the computation of pseudo-trajectories to a period of interest by specifying the start and end time points. Moreover, spatially interesting regions can be selected by specifying the spatial range over which to initialize the positions of the particles.</p>
      </sec>
      <sec id="Sec13">
        <title>Conversion to physical units</title>
        <p id="Par28">Last but not least, to convert voxel displacements into physically meaningful velocities both the frame rate and the physical units of each voxel dimension need to be taken into account. These values can be provided during the creation of the PIV-parameter object and quickPIV will automatically re-scale the resulting vector field after the analysis.</p>
      </sec>
    </sec>
    <sec id="Sec14">
      <title>QuickPIV accuracy evaluation</title>
      <p id="Par29">The correct implementation of a PIV analysis depends on its ability to detect translations. Accordingly, the accuracy of quickPIV is assessed by generating pairs of artificial images and volumes containing synthetic particles related by a known translation. Synthetic particles are rendered according to [<xref ref-type="bibr" rid="CR49">49</xref>]. The bias and random errors are computed to evaluate the agreement of quickPIV predictions to the known translations [<xref ref-type="bibr" rid="CR49">49</xref>]:<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp;\epsilon _{\rm bias} = \frac{1}{n}\sum _{i=1}^{n} | d_{PIV,i} - d_{\rm true} | \end{aligned}$$\end{document}</tex-math><mml:math id="M120" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mi mathvariant="normal">bias</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>I</mml:mi><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">true</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4474_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \epsilon_{\rm rand} = \sqrt{ \frac{1}{n} \sum _{i=1}^{n} {(d_{{\rm PIV},i}-\overline{d_{\rm PIV}})^2}} \end{aligned}$$\end{document}</tex-math><mml:math id="M122" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mi mathvariant="normal">rand</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi mathvariant="normal">PIV</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mover><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">PIV</mml:mi></mml:msub><mml:mo>¯</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4474_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq44"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_{{\rm PIV},i}$$\end{document}</tex-math><mml:math id="M124"><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi mathvariant="normal">PIV</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq44.gif"/></alternatives></inline-formula> is the <inline-formula id="IEq45"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i^{\mathrm {th}}$$\end{document}</tex-math><mml:math id="M126"><mml:msup><mml:mi>i</mml:mi><mml:mi mathvariant="normal">th</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq45.gif"/></alternatives></inline-formula> PIV-computed displacement, <inline-formula id="IEq46"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_{\rm true}$$\end{document}</tex-math><mml:math id="M128"><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">true</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq46.gif"/></alternatives></inline-formula> is the known translation, <inline-formula id="IEq47"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{d_{\rm PIV}}$$\end{document}</tex-math><mml:math id="M130"><mml:mover><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">PIV</mml:mi></mml:msub><mml:mo>¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq47.gif"/></alternatives></inline-formula> is the average PIV-computed displacement and <italic>n</italic> is the number of repeats. The bias and random errors represent the accuracy and the precision of quickPIV’s approximation of the underlying translation, respectively. The effect of the following parameters on the accuracy of quickPIV are evaluated, both in 2D and 3D: interrogation size, particle density, particle diameter, 3-point Gaussian sub-pixel approximation and the use of a search margin to correct for out-of-frame loss.</p>
    </sec>
    <sec id="Sec15">
      <title>QuickPIV performance evaluation</title>
      <p id="Par30">The performance of our software is evaluated by comparing the execution times of quickPIV with those of the C++ and Python implementations hosted in openPIV. First, we analyzed the time required to compute cross-correlation in the frequency domain with the three packages. By comparing the execution times of quickPIV and the C++ implementation, we can determine whether calling the FFTW C-library from Julia adds any noticeable overhead compared to C++. Since the Python implementation uses the NumPy library to compute the Fourier and inverse Fourier transforms, this test also reveals any performance differences between FFTW and NumPy. On the other hand, we compare the execution time of complete 2D and 3D PIV analyses between the three PIV packages. The set of parameters used in these PIV analyses are listed in the description of Table <xref rid="Tab1" ref-type="table">1</xref>.</p>
      <p id="Par31">For the sake of using a common benchmarking pipeline, language-specific packages for measuring the execution times are avoided. Each execution time measurement shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>e corresponds to the minimum execution time from 1000 repeated measurements. Taking the minimum execution time filters out random delays originating from background processes [<xref ref-type="bibr" rid="CR50">50</xref>]. The left panel in Fig. <xref rid="Fig2" ref-type="fig">2</xref>e illustrates the interference of background processes in the distribution of 1000 execution measurements of FFT cross-correlation. All measurements presented below were performed on a machine with an Intel Core i5-8300H processor <inline-formula id="IEq48"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$4\times 2.3$$\end{document}</tex-math><mml:math id="M132"><mml:mrow><mml:mn>4</mml:mn><mml:mo>×</mml:mo><mml:mn>2.3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq48.gif"/></alternatives></inline-formula> GHz. All PIV analyses were executed on a single thread.<fig id="Fig2"><label>Fig. 2</label><caption><p>Accuracy and performance evaluations of quickPIV. <bold>a</bold>–<bold>d</bold> Mean biases (red lines) and random errors (green error bars) of unnormalized PIV applied to synthetic data containing particles shifted by homogeneous translations. <bold>a</bold> PIV errors are reduced by increasing interrogation size. As illustrated under the 2D examples, the intensity patterns contained in small interrogation areas (5<inline-formula id="IEq61"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times$$\end{document}</tex-math><mml:math id="M134"><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq61.gif"/></alternatives></inline-formula>5 pixels) display unspecific structures, and are more susceptible to out-of-frame loss. The 2D analyses were performed on 200<inline-formula id="IEq62"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times$$\end{document}</tex-math><mml:math id="M136"><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq62.gif"/></alternatives></inline-formula>200 pixel images containing 5k particles, and 3D analyses on 200<inline-formula id="IEq63"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times$$\end{document}</tex-math><mml:math id="M138"><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq63.gif"/></alternatives></inline-formula>200<inline-formula id="IEq64"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times$$\end{document}</tex-math><mml:math id="M140"><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq64.gif"/></alternatives></inline-formula>200 voxel volumes with 100k particles. <bold>b</bold> Particle densities of around 15 particles per interrogation region minimize PIV errors. Low particle count are susceptible to out-of-frame loss, while high particle densities degrade PIV accuracies by producing uniform intensity patterns. Interrogation size during this evaluation was 10<inline-formula id="IEq65"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times$$\end{document}</tex-math><mml:math id="M142"><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq65.gif"/></alternatives></inline-formula>10 pixels and 10<inline-formula id="IEq66"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times$$\end{document}</tex-math><mml:math id="M144"><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq66.gif"/></alternatives></inline-formula>10<inline-formula id="IEq67"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times$$\end{document}</tex-math><mml:math id="M146"><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq67.gif"/></alternatives></inline-formula>10 voxels. <bold>c</bold> Particle sizes of 1-2 pixels achieve optimal PIV accuracies. The 2D examples show that large particle radii blur the intensity pattern inside the interrogation regions, reducing the pattern complexity. <bold>d</bold> Top, PIV accuracy under non-integer translations oscillates between 0.0 and 0.5. Bottom, with 3-point Gaussian interpolation, errors are reduced by an order of magnitude. The leftmost figures show a slight loss of accuracy due to out-of-frame loss as the translation strength increases. Adding a search margin greater than the translation strength completely compensates for this effect. <bold>e</bold> Left, execution times distribution of 1000 FFT computations on input images of <inline-formula id="IEq68"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$40 \times 40$$\end{document}</tex-math><mml:math id="M148"><mml:mrow><mml:mn>40</mml:mn><mml:mo>×</mml:mo><mml:mn>40</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq68.gif"/></alternatives></inline-formula> pixels. Background processes sporadically slow down FFT execution. Right, comparison of 2D FFT performance between Julia, C++ and Python for increasing input sizes. Julia and C++ calls of FFTW are equally fast, while the FFT implementation in NumPy is approximately three times slower. The execution time of FFT spikes when the input sizes are prime numbers, e.g. 23, 29 or 43</p></caption><graphic xlink:href="12859_2021_4474_Fig2_HTML" id="MO12"/></fig></p>
    </sec>
    <sec id="Sec16">
      <title>QuickPIV on the embryogenesis of <italic>Tribolium castaneum</italic></title>
      <p id="Par32">To test the accuracy of quickPIV on biological data, we analyzed three 3D time-lapse data sets of the embryonic development of <italic>T. castaneum</italic>: (1) two embryos from a hemizygous transgenic line that ubiquitously expresses nuclear-localized mEmerald and (2) one embryo from a double hemizygous transgenic line that expresses nuclear-localized mRuby2 ubiquitously and actin-binding Lifeact-mEmerald only in the serosa [<xref ref-type="bibr" rid="CR22">22</xref>]. Using LSFM, the embryos were recorded at intervals of (1) 30 minutes or (2) 20 minutes along 4 directions in rotation steps of 90<inline-formula id="IEq49"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{\circ }$$\end{document}</tex-math><mml:math id="M150"><mml:msup><mml:mrow/><mml:mo>∘</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq49.gif"/></alternatives></inline-formula> around the anterior-posterior axis in (1) one or (2) two fluorescence channels [<xref ref-type="bibr" rid="CR21">21</xref>]. The four directions were fused according to Preibisch et al. [<xref ref-type="bibr" rid="CR51">51</xref>] to generate evenly illuminated volumes with isotropic resolution. The fused volumes were cropped to <inline-formula id="IEq50"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1000\times 600 \times 600$$\end{document}</tex-math><mml:math id="M152"><mml:mrow><mml:mn>1000</mml:mn><mml:mo>×</mml:mo><mml:mn>600</mml:mn><mml:mo>×</mml:mo><mml:mn>600</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq50.gif"/></alternatives></inline-formula> voxels (height,width,depth), the embryos were manually placed in the center of the volumes and their anterior–posterior axis was manually aligned with the vertical axis.</p>
      <p id="Par33">Three time points during gastrulation were analyzed with quickPIV in the two embryos of data set (i). Two time points of the double hemizygous transgenic line (ii) were analyzed in both channels, allowing to compare the vector fields obtained from the Lifeact-mEmerald actin signal with those from the nuclear-localized mRuby2 marker. The PIV analyses were performed on both data sets with NSQECC. The vector fields resulting from these analyses are shown in Figs. <xref rid="Fig3" ref-type="fig">3</xref> and <xref rid="Fig4" ref-type="fig">4</xref>, post-processed with similarity-selective averaging with an averaging radius of 2 neighboring vectors and a similarity threshold of 0.5. The visualization of the embryo volumes and the computed vector fields has been done in Paraview 5.7.0.<fig id="Fig3"><label>Fig. 3</label><caption><p>3D PIV analysis on the embryogenesis of two <italic>T. castaneum</italic> embryos. Each vector field in <bold>a</bold>. 1–3 and <bold>b</bold>. 1-3 is plotted on top of the two volumes it was computed from, where the red signal corresponds to the initial time point and blue intensities belong to the consecutive time point. A few spurious vectors obtained on the background due to the fluorescence bleeding from the embryo were manually curated. Embryos are shown from their ventral and lateral sides. <bold>a-b.1</bold> At the onset of gastrulation, serosa nuclei at the anterior end of both analyzed embryos collectively spread towards the dorsal side of the embryos. Moreover, the central and posterior regions on the ventral side undergo coordinated condensation movements that will later give rise to the internalizing germband. <bold>a-b.2</bold> The wide-spread serosa cells over the anterior pole and the dorsal side engage in a highly coordinated movement of the tissue towards the posterior pole. Time points <bold>a-b.3</bold> are characterized by a highly collective flow of serosa cells towards the ventral side, leading to the emergence and closing of the serosa window. Serosa cells at the anterior pole, dorsal side and the posterior pole collectively migrate clock-wise towards the ventral midline, giving rise to a cell migration pattern resembling a vortex. <bold>c</bold> Exemplary post-processing analyses applied to the vector field shown in a.1. From left to right: velocity map showing higher velocities in red, divergence(purple)/convergence(cyan) map, collectiveness map displaying higher local collectiveness in yellow, and pseudo-trajectories at the anterior pole of the embryo in a.1) over 10 time points (5 h)</p></caption><graphic xlink:href="12859_2021_4474_Fig3_HTML" id="MO13"/></fig><fig id="Fig4"><label>Fig. 4</label><caption><p>Validation of quickPIV on non-segmentable data sets. <bold>a</bold> PIV analyses were performed on the actin signal of a double hemizygous transgenic embryo before (top) and during (bottom) gastrulation. For each time point, the two consecutive volumes analyzed with PIV are shown in red and blue, next to the computed vector fields after similarity-selective spatial averaging. <bold>b</bold> PIV was also performed for the same time points on the nuclear signal, and the resulting similarity-selective averaged vector fields are shown next to the actin vector fields. <bold>c</bold> The orientation similarity between each pair of vectors in the two channels is computed through their normalized dot product. The Euclidean error between each pair of vectors is computed as well to measure the combined magnitude and direction differences between the vectors. The scatter plot of these two quantities shows that most vectors are clustered around a region of high normalized dot product and low euclidean error, indicating good agreement between the vector fields in (<bold>a</bold>) and (<bold>b</bold>). <bold>d</bold> Three patterns of cell migration can be distinguished in the <italic>T. castaneum</italic> data set (i): Segmentable and trackable (S/T), segmentable and non-trackable (S/NT) and non-segmentable and non-trackable (NS/NT) nuclei. The serosa consists of segmentable nuclei. While some regions are easily trackable, in others it is difficult to establish unambiguous correspondences of the nuclei between the two time points. High cell densities render nuclei in the gastrulating embryo non-segmentable, and therefore non-trackable. <bold>e</bold> Three-dimensional mapping of the height of the maximum peak of NSQECC at each interrogation area during the PIV analysis of the two volumes in (<bold>d</bold>). High values are achieved both in the segmentable and trackable and non-segmentable regions of the embryo, indicating that the interrogation and search patterns in these regions are well approximated by a translation and high PIV accuracies are expected</p></caption><graphic xlink:href="12859_2021_4474_Fig4_HTML" id="MO14"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec17">
    <title>Results</title>
    <p id="Par34">The accuracy evaluation of quickPIV quantitatively reproduces the expected accuracies described in the PIV literature, attesting the correctness of our PIV implementation [<xref ref-type="bibr" rid="CR52">52</xref>–<xref ref-type="bibr" rid="CR55">55</xref>]. Our analysis shows a monotonic decrease of the total error (bias and random errors) with increasing interrogation sizes [<xref ref-type="bibr" rid="CR55">55</xref>], reaching errors as low as <inline-formula id="IEq51"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.02 \pm 0.01$$\end{document}</tex-math><mml:math id="M154"><mml:mrow><mml:mn>0.02</mml:mn><mml:mo>±</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq51.gif"/></alternatives></inline-formula> pixels/voxels (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a). This is the expected behavior in our synthetic tests, since all simulated particles are subjected to the same translation. Our results also agree on the presence of optimal values for both particle density and particle size [<xref ref-type="bibr" rid="CR52">52</xref>]. It can be appreciated from the 2D examples included in Fig. <xref rid="Fig2" ref-type="fig">2</xref>b and c that high particle densities and large particle sizes generate diffuse images that can not be unambiguously matched by cross-correlation. Without sub-pixel/voxel interpolation, the PIV analysis cannot capture the decimal components of the simulated translations, shown in the top row of Fig. <xref rid="Fig2" ref-type="fig">2</xref>d [<xref ref-type="bibr" rid="CR52">52</xref>, <xref ref-type="bibr" rid="CR53">53</xref>]. As described in the literature, the 3-point Gaussian sub-pixel approximation reduces this error by one order of magnitude (bottom row in Fig. <xref rid="Fig2" ref-type="fig">2</xref>d) [<xref ref-type="bibr" rid="CR56">56</xref>]. Moreover, search margins are needed to counteract the out-of-frame errors induced by increasing translation (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d, left panel). A search margin of 4 pixels/voxels (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d, middle and right panels) completely compensates this effect for all simulated translations.</p>
    <p id="Par35">We performed an analogous accuracy analysis on the <italic>T. castaneum</italic> data set, where we quantified the accuracy of quickPIV in detecting know translations on one 3D volume in data set (i). We observed that diffuse and unspecific patterns in the embryo induce biases when using ZNCC. These biases are completely avoided by using NSQECC, which detects the underlying translation with 100% accuracy given a sufficiently large search margin (see Figure S1). We further analyzed the height distribution of the maximum cross-correlation peaks during the PIV analysis with NSQECC of two consecutive volumes of <italic>T. castaneum</italic>, shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>e. High peaks are found in the collectively migrating serosa cells at the anterior pole of the embryo, which we classify as segmentable and trackable (S/T), and in the non-segmentable and non-trackable (NS/NT) gastrulating embryo, Fig. <xref rid="Fig4" ref-type="fig">4</xref>d. These high peaks indicate that cellular migration in these regions is well approximated by a collective translation, and that the intensity patterns between the interrogation and search volumes are not deformed, rotated or sheared significantly. Non-collective migration of the serosa cells reduces the height of the NSQECC peaks in the central regions of the extraembryonic membranes, which we consider to be segmentable but not easily trackable (S/NT), since cell correspondences between the two time points can not unambiguously be assessed visually, Fig. <xref rid="Fig4" ref-type="fig">4</xref>d. A three-dimensional visualization of the maximum peak distribution in Fig. <xref rid="Fig4" ref-type="fig">4</xref>e is provided in Video S1.</p>
    <p id="Par36">Performance-wise, calling the FFTW C-library is equally efficient from Julia and C++ (see Fig. <xref rid="Fig2" ref-type="fig">2</xref>e, right). In contrast, the performance of the NumPy implementation of the FFT algorithm is three times slower than the one provided in the FFTW library. This performance difference is translated to the complete 2D and 3D PIV analyses of the PIV packages, where the Python implementation in openPIV is consistently three times slower than both the C++ implementation (2D) and quickPIV (2D and 3D), see Table <xref rid="Tab1" ref-type="table">1</xref>. Our results also show that 2D PIV analyses are performed faster with quickPIV than with the C++ implementation in openPIV. Since both packages share the same cross-correlation performance, this difference can only be explained by compiler optimizations brought by Julia’s compilation pipeline, or by the ease of implementing good programming practices in Julia’s high-level environment. For instance, quickPIV avoids bound checks when possible, minimizes memory allocations by using in-place operations, and leverages SIMD (single instruction, multiple data) operations exposed by the Julia programming language.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Performance evaluation of complete PIV analyses</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">C++</th><th align="left">Python</th><th align="left">quickPIV</th></tr></thead><tbody><tr><td align="left">2D</td><td align="left">63 ms</td><td align="left">160.81 ms</td><td align="left">50.42 ms</td></tr><tr><td align="left">3D</td><td align="left">-</td><td align="left">59.72 s</td><td align="left">18.09 s</td></tr></tbody></table><table-wrap-foot><p>2D analyses were performed on a pair of images of size 512<inline-formula id="IEq69"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times$$\end{document}</tex-math><mml:math id="M156"><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq69.gif"/></alternatives></inline-formula>512 pixel, with the following PIV parameters: FFT cross-correlation, interrogation size of 32 pixels, no search margin, overlap of 16 pixels, no multi-pass, 3-point Gaussian subpixel approximation and peak-to-peak signal-to-noise algorithm. 3D analyses were performed on volumes with dimensions 512<inline-formula id="IEq70"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times$$\end{document}</tex-math><mml:math id="M158"><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq70.gif"/></alternatives></inline-formula>512<inline-formula id="IEq71"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times$$\end{document}</tex-math><mml:math id="M160"><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq71.gif"/></alternatives></inline-formula>123 pixels, and the following PIV parameters: FFT cross-correlation, interrogation size of (49, 49, 11), no search margin, overlap of (14, 14, 3), no multi-pass, 3-point Gaussian sub-voxel approximation and peak-to-peak signal-to-noise algorithm. The reported measurement are the minimum execution time from 1000 and 100 repeats, for the 2D and 3D analysis respectively</p></table-wrap-foot></table-wrap></p>
    <p id="Par37">From a practical standpoint, we found that performance of PIV analyses can be dramatically increased by subsampling the input volumes and removing the background interrogation areas from the PIV analysis. For example, a PIV analysis of two volumes of <italic>T. castaneum</italic> with the following parameters (interSize of 60 voxels, searchMargin of 0 voxels, overlap of 30 voxels and multi-pass factor of 2), while skipping interrogation volumes with a maximum intensity lower than 100, takes 29 minutes. After applying subsampling by a factor of 3, the analogous analysis on the subsampled data (interSize of 20 voxels, searchMargin of 0 voxels, overlap of 10 voxels and multi-pass factor of 2) takes 55 s to complete. The results shown in Figs. <xref rid="Fig3" ref-type="fig">3</xref> and <xref rid="Fig4" ref-type="fig">4</xref>, which were obtained after subsampling the input volumes by a factor of three in all dimensions, are in full agreement with the same analyses performed without subsampling (Fig. S2). The spatial resolution in this data set was very high, which is necessary to discern smaller structures. For motion analysis a lower image resolution is sufficient to obtain the same results. Before subsampling images, we, however, advise to test the agreement between the PIV vector fields in the original and a subsampled image.</p>
    <p id="Par38">The application of quickPIV to the two <italic>T. castaneum</italic> embryos of data set (i) is shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. The red and blue intensities correspond to the nuclear signal of the first and second input volumes, respectively, which aids in visualizing the underlying displacement of the nuclei between each pair of analyzed time points. The vector fields at the anterior regions of the embryos in Figs. <xref rid="Fig3" ref-type="fig">3</xref>a.1 and b.1 capture the underlying radially diverging pattern of cell migration towards the dorsal side of the embryo. Our PIV analyses also capture the coordinated condensation movement of the cells in the central and posterior regions, which will later give rise to the germband. These regions exhibit high cellular densities, challenging visual examination and rendering nuclei segmentation and tracking approaches unfeasible. Figure <xref rid="Fig3" ref-type="fig">3</xref>a.2 and b.2 are characterized by vastly coordinated movements of the wide-spread serosa cells over the anterior pole and along the dorsal side towards the posterior pole. Figures <xref rid="Fig3" ref-type="fig">3</xref>a.3 and b.3 depict a highly coordinated flow of serosa cells from the dorsal side over both, the posterior pole and the lateral equator, towards the ventral side, where they eventually give rise to the serosa window [<xref ref-type="bibr" rid="CR57">57</xref>]. These observations are not only consistent with previous studies of collective cell migration during the gastrulation of <italic>T. castaneum</italic>, which were obtained through 1D PIV analyses [<xref ref-type="bibr" rid="CR58">58</xref>] and manual 2D tracking of the extra-embryonic serosa cells [<xref ref-type="bibr" rid="CR59">59</xref>, <xref ref-type="bibr" rid="CR60">60</xref>], but for the first time describe this process in 3D. Figure <xref rid="Fig3" ref-type="fig">3</xref>c illustrates the velocity, divergence/convergence and collectiveness mappings as well as some computed pseudo-trajectories on the anterior region of the embryo.</p>
    <p id="Par39">Finally, the results from the analysis of the double hemizygous transgenic line, (ii), demonstrate the robustness of quickPIV on non-segmentable data. The agreement of the vector fields on the anterior pole of the embryo (which is non-segmentable in the actin signal, segmentable in the nuclear signal and exhibits high degrees of collective cell migration in both channels) indicates that PIV accuracies are independent of the segmentability of the input data sets, Figs. <xref rid="Fig4" ref-type="fig">4</xref>a and b. A quantitative comparison of the PIV vector fields between the nuclear and the actin stained volumes shows a high degree of similarity. This is illustrated in the scatter plot shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>c, exhibiting a high density in the area of large dot products and small Euclidean errors. The similarity of the actin and nuclear vector fields in highly dense non-segmentable regions further underlines the robustness of quickPIV regardless of the labeling scheme of the data sets.</p>
  </sec>
  <sec id="Sec18">
    <title>Conclusions</title>
    <p id="Par40">QuickPIV represents a free and open-source solution for performing efficient and robust quantification of collective cellular migration in the increasingly popular 3D dynamic data sets in life sciences. Our software includes several well established PIV features, such as multi-pass and sub-voxel peak approximation, as well as post-processing functions and visualization of the 3D vector fields in Paraview.</p>
    <p id="Par41">To our knowledge, quickPIV is the only free PIV software that offers normalized squared error cross-correlation (NSQECC), which we found to be necessary for accurately describing collective cell and tissue migration in non-segmentable data sets. By using NSQECC, we could quantify collective cell migration from the non-segmentable and highly dynamic actin signal in a double hemizygous transgenic embryo of <italic>T. castaneum</italic>. The resulting vector fields were in complete agreement with previously published descriptions of the gastrulation movements in <italic>T. castaneum</italic>, and showed a strong correlation with the vector fields obtained from the nuclear signal of the same embryo. Moreover, the height distribution of the maximum cross-correlation peaks further indicates that NSQECC is robust to non-segmentable data.</p>
    <p id="Par42">The performance evaluation of quickPIV shows that our software is three times faster in 2D and 3D analyses than the Python PIV implementation in openPIV, and also faster than the 2D implementation written in C++. This performance advantage is only possible because of the design of the Julia programming language and the optimization possibilities that it provides. By considering subsampling and excluding unnecessary regions of the input data (such as empty background), the quickPIV analysis of a pair of 3D volumes can be reduced to several seconds. These speeds are compatible with real-time PIV analyses, enabling the integration of PIV pipelines into smart microscopy techniques. For example, vector fields obtained with quickPIV could be used to automatically detect the onset of developmental events and adjust the acquisition parameters accordingly, e.g. laser power or acquisition interval.</p>
    <p id="Par43">Overall, we believe that 3D PIV analyses will play an important role in understanding 3D biological processes as novel 3D imaging techniques are developed and adopted. For example, SVIM can already achieve up to 100<inline-formula id="IEq52"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times$$\end{document}</tex-math><mml:math id="M162"><mml:mo>×</mml:mo></mml:math><inline-graphic xlink:href="12859_2021_4474_Article_IEq52.gif"/></alternatives></inline-formula> higher recording speeds than standard LSFM. Such high temporal resolutions increase the accuracy of PIV and make PIV the ideal solution for reliable and automated pipelines for quantifying collective cellular migration. However, the computational demands required to analyze such temporally resolved data sets can only be met by further optimizations of quickPIV’s performance. Therefore, future efforts will be directed towards adding multi-threading support and implementing our PIV analyses on a graphics card [<xref ref-type="bibr" rid="CR61">61</xref>].</p>
  </sec>
  <sec id="Sec19">
    <title>Availability and requirements</title>
    <p id="Par44">Project name: quickPIV</p>
    <p id="Par45">Project home page: https://github.com/Marc-3d/quickPIV</p>
    <p id="Par46">Operating system(s): Platform independent</p>
    <p id="Par47">Programming language: Julia</p>
    <p id="Par48">Other requirements: Julia1.3.1 or higher</p>
    <p id="Par49">License: MIT License</p>
    <p id="Par50">Any restrictions to use by non-academics: None.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec20">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2021_4474_MOESM1_ESM.avi">
            <caption>
              <p><bold>Additional file 1.</bold> This file contains a video animating the rotation and slicing of the three-dimensional distribution of the maximum peak heights at each interrogation area during the PIV analysis using NSQECC of two 3D volumes of data set (i).</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2021_4474_MOESM2_ESM.pdf">
            <caption>
              <p><bold>Additional file 2.</bold> This file contains <bold>Figs. 1</bold> and <bold>2</bold>. <bold>Figure S1</bold> reports the results form our synthetic accuracy evaluation on biological data, including the comparison between the accuracies obtained with ZNCC and NSQECC PIV analyses. <bold>Figure S2</bold> shows the same PIV analyses as Fig. <xref rid="Fig3" ref-type="fig">3</xref>, with the difference that no subsampling of the input volume was used to obtain the results in Figure S2.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Equal contributor: Marc Pereyra and Armin Drusko</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary Information</title>
    <p>The online version contains supplementary material available at 10.1186/s12859-021-04474-0.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author's contributions</title>
    <p>AD implemented the first quickPIV version, which included spatial and FFT cross-correlation, signal-to-noise measurements, multi-pass and sub-pixel approximation. MP added efficient ZNCC and NSQECC cross-correlation, implemented the accuracy and performance evaluations, performed the analysis on <italic>T. castaneum</italic>, prepared the figures for this paper, and maintains the current version of the package. FK generated the <italic>T. castaneum</italic> data sets (i and ii) analyzed in this paper. FS oversaw the recording of the <italic>T. castaneum</italic> embryos and provided the knowledge of the developmental processes of <italic>T. castaneum</italic> to contrast the PIV-computed vector fields. ES provided the microscopy setup and valuable insights on LSFM technology and <italic>T. castaneum</italic> development. FM conceptualised and supervised the implementation, as well as the performed analyses, and contributed in the figure preparation. MP, AD, FS and FM wrote the manuscript. FK and ES contributed to the preparation of the manuscript and proof-reading. All authors have read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Open Access funding enabled and organized by Projekt DEAL. MP and FM acknowledge funding by the Deutsche Forschungsgemeinschaft (DFG, German Research Foundation)—414985841. AD received funding from the LOEWE programme of the state of Hessen (DynaMem). FM is supported by the Giersch Foundation, Frankfurt am Main, and receives funding from the LOEWE programme of the state of Hessen (DynaMem, CMMS). FK received funding from the LOEWE programme of the state of Hessen (CMMS). EHKS was funded by the Cluster of Excellence—Frankfurt am Main for Macromolecular Complexes (CEF-MC, speaker Volker Dötsch) at the Buchmann Institute for Molecular Life Sciences (BMLS) at the Goethe Universität—Frankfurt am Main by the Deutsche Forschungsgemeinschaft (DFG, EXC 115). FS was funded by the Add-on Fellowship 2019 of the Joachim Herz Stiftung. EHKS and FS were funded by the Quantitative Structural Cell Biology Projects programme (Innovations- und Strukturentwicklungsinitiative ’Spitze aus der Breite’) of the state of Hessen. The funding body did not play any role in the design of the study and collection, analysis, and interpretation of data and in writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The data sets used and/or analyzed during the current study can be accessed through the following Zenodo 10.5281/zenodo.5504076.</p>
  </notes>
  <notes>
    <title>Declaration</title>
    <notes id="FPar2">
      <title>Ethics approval and consent to participate</title>
      <p id="Par51">Not applicable.</p>
    </notes>
    <notes id="FPar3">
      <title>Consent for publication</title>
      <p id="Par52">Not applicable</p>
    </notes>
    <notes id="FPar4">
      <title>Software and code</title>
      <p id="Par53">The source code and instructions to run the evaluation scripts of quickPIV are available at Github: <ext-link ext-link-type="uri" xlink:href="https://github.com/Marc-3d/quickPIV">https://github.com/Marc-3d/quickPIV</ext-link>. The source code of the presented release of quickPIV, v1.0, can be accessed through: <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/5530573#.YVGyMX1CTBU">https://zenodo.org/record/5530573#.YVGyMX1CTBU</ext-link>.</p>
    </notes>
    <notes id="FPar5" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par54">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Friedl</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gilmour</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Collective cell migration in morphogenesis, regeneration and cancer</article-title>
        <source>Nat Rev Mol Cell Biol</source>
        <year>2009</year>
        <volume>10</volume>
        <issue>7</issue>
        <fpage>445</fpage>
        <lpage>457</lpage>
        <pub-id pub-id-type="doi">10.1038/nrm2720</pub-id>
        <?supplied-pmid 19546857?>
        <pub-id pub-id-type="pmid">19546857</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chuai</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hughes</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Weijer</surname>
            <given-names>CJ</given-names>
          </name>
        </person-group>
        <article-title>Collective epithelial and mesenchymal cell migration during gastrulation</article-title>
        <source>Curr Genomics</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>4</issue>
        <fpage>267</fpage>
        <lpage>277</lpage>
        <pub-id pub-id-type="doi">10.2174/138920212800793357</pub-id>
        <?supplied-pmid 23204916?>
        <pub-id pub-id-type="pmid">23204916</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Szabó</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mayor</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Mechanisms of neural crest migration</article-title>
        <source>Annu Rev Genet</source>
        <year>2018</year>
        <volume>52</volume>
        <issue>1</issue>
        <fpage>43</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-genet-120417-031559</pub-id>
        <?supplied-pmid 30476447?>
        <pub-id pub-id-type="pmid">30476447</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Collective cell migration: implications for wound healing and cancer invasion</article-title>
        <source>Burns Trauma</source>
        <year>2013</year>
        <volume>1</volume>
        <issue>1</issue>
        <fpage>21</fpage>
        <pub-id pub-id-type="doi">10.4103/2321-3868.113331</pub-id>
        <?supplied-pmid 27574618?>
        <pub-id pub-id-type="pmid">27574618</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barriga</surname>
            <given-names>EH</given-names>
          </name>
          <name>
            <surname>Franze</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Charras</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Mayor</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Tissue stiffening coordinates morphogenesis by triggering collective cell migration in vivo</article-title>
        <source>Nature</source>
        <year>2018</year>
        <volume>554</volume>
        <issue>7693</issue>
        <fpage>523</fpage>
        <lpage>527</lpage>
        <pub-id pub-id-type="doi">10.1038/nature25742</pub-id>
        <?supplied-pmid 29443958?>
        <pub-id pub-id-type="pmid">29443958</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vedula</surname>
            <given-names>SRK</given-names>
          </name>
          <name>
            <surname>Leong</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Lai</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Hersen</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kabla</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Lim</surname>
            <given-names>CT</given-names>
          </name>
          <name>
            <surname>Ladoux</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Emerging modes of collective cell migration induced by geometrical constraints</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2012</year>
        <volume>109</volume>
        <issue>32</issue>
        <fpage>12974</fpage>
        <lpage>12979</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1119313109</pub-id>
        <?supplied-pmid 22814373?>
        <pub-id pub-id-type="pmid">22814373</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>S-Z</given-names>
          </name>
          <name>
            <surname>Ye</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>G-K</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>X-Q</given-names>
          </name>
        </person-group>
        <article-title>Dynamic migration modes of collective cells</article-title>
        <source>Biophys J</source>
        <year>2018</year>
        <volume>115</volume>
        <issue>9</issue>
        <fpage>1826</fpage>
        <lpage>1835</lpage>
        <pub-id pub-id-type="doi">10.1016/j.bpj.2018.09.010</pub-id>
        <?supplied-pmid 30297134?>
        <pub-id pub-id-type="pmid">30297134</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Santi</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>Light sheet fluorescence microscopy: a review</article-title>
        <source>J. Histochem. Cytochem.</source>
        <year>2011</year>
        <volume>59</volume>
        <issue>2</issue>
        <fpage>129</fpage>
        <lpage>138</lpage>
        <pub-id pub-id-type="doi">10.1369/0022155410394857</pub-id>
        <?supplied-pmid 21339178?>
        <pub-id pub-id-type="pmid">21339178</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Power</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Huisken</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A guide to light-sheet fluorescence microscopy for multiscale imaging</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>4</issue>
        <fpage>360</fpage>
        <lpage>373</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4224</pub-id>
        <?supplied-pmid 28362435?>
        <pub-id pub-id-type="pmid">28362435</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reynaud</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Krzic</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Greger</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Stelzer</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Light sheet-based fluorescence microscopy: more dimensions, more photons, and less photodamage</article-title>
        <source>HFSP J</source>
        <year>2008</year>
        <volume>2</volume>
        <fpage>266</fpage>
        <lpage>75</lpage>
        <pub-id pub-id-type="doi">10.2976/1.2974980</pub-id>
        <?supplied-pmid 19404438?>
        <pub-id pub-id-type="pmid">19404438</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kaufmann</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mickoleit</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Weber</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Huisken</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Multilayer mounting enables long-term imaging of zebrafish development in a light sheet microscope</article-title>
        <source>Development</source>
        <year>2012</year>
        <volume>139</volume>
        <issue>17</issue>
        <fpage>3242</fpage>
        <lpage>3247</lpage>
        <pub-id pub-id-type="doi">10.1242/dev.082586</pub-id>
        <?supplied-pmid 22872089?>
        <pub-id pub-id-type="pmid">22872089</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huisken</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Optical sectioning deep inside live embryos by selective plane illumination microscopy</article-title>
        <source>Science</source>
        <year>2004</year>
        <volume>305</volume>
        <issue>5686</issue>
        <fpage>1007</fpage>
        <lpage>1009</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1100035</pub-id>
        <?supplied-pmid 15310904?>
        <pub-id pub-id-type="pmid">15310904</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Voleti</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Patel</surname>
            <given-names>KB</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Campos</surname>
            <given-names>CP</given-names>
          </name>
          <name>
            <surname>Bharadwaj</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ford</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Casper</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>RW</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Wen</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kimura</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Targoff</surname>
            <given-names>KL</given-names>
          </name>
          <name>
            <surname>Hillman</surname>
            <given-names>EMC</given-names>
          </name>
        </person-group>
        <article-title>Real-time volumetric microscopy of in vivo dynamics and large-scale samples with SCAPE 2.0</article-title>
        <source>Nat Methods</source>
        <year>2019</year>
        <volume>16</volume>
        <issue>10</issue>
        <fpage>1054</fpage>
        <lpage>1062</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0579-4</pub-id>
        <?supplied-pmid 31562489?>
        <pub-id pub-id-type="pmid">31562489</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">Truong TV, Holland DB, Madaan S, Andreev A, Keomanee-Dizon K, Troll JV, Koo DES, McFall-Ngai MJ, Fraser SE. High-contrast, synchronous volumetric imaging with selective volume illumination microscopy. Commun Biol. 2020;3(1). 10.1038/s42003-020-0787-6.</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>B-C</given-names>
          </name>
          <name>
            <surname>Legant</surname>
            <given-names>WR</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Shao</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Milkie</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Davidson</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Janetopoulos</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>XS</given-names>
          </name>
          <name>
            <surname>Hammer</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>English</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Mimori-Kiyosue</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Romero</surname>
            <given-names>DP</given-names>
          </name>
          <name>
            <surname>Ritter</surname>
            <given-names>AT</given-names>
          </name>
          <name>
            <surname>Lippincott-Schwartz</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Fritz-Laylin</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Mullins</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Mitchell</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Bembenek</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Reymann</surname>
            <given-names>A-C</given-names>
          </name>
          <name>
            <surname>Böhme</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Grill</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Seydoux</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Tulu</surname>
            <given-names>US</given-names>
          </name>
          <name>
            <surname>Kiehart</surname>
            <given-names>DP</given-names>
          </name>
          <name>
            <surname>Betzig</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Lattice light-sheet microscopy: imaging molecules to embryos at high spatiotemporal resolution</article-title>
        <source>Science</source>
        <year>2014</year>
        <volume>346</volume>
        <issue>6208</issue>
        <fpage>1257998</fpage>
        <pub-id pub-id-type="doi">10.1126/science.1257998</pub-id>
        <?supplied-pmid 25342811?>
        <pub-id pub-id-type="pmid">25342811</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Sveen JK. An introduction to MatPIV v. 1.6.1. University of Oslo, Department of Mathematics;2004.</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Thielicke W, Stamhuis EJ. PIVlab - towards user-friendly, affordable and accurate digital particle image velocimetry in MATLAB. Journal of Open Research Software. 2014;2. 10.5334/jors.bl.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Liberzon A, Lasagna D, Aubert M, Bachant P, Käufer T, Jakirkham, Bauer A, Vodenicharski B, Dallas C, Borg J, Tomerast, Ranleu. OpenPIV/openpiv-python: OpenPIV - Python (v0.22.2) with a new extended search PIV grid option. Zenodo. 2020. 10.5281/ZENODO.3930343</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">JPIV. <ext-link ext-link-type="uri" xlink:href="https://eguvep.github.io/jpiv/">https://eguvep.github.io/jpiv/</ext-link></mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <mixed-citation publication-type="other">Bezanson J, Karpinski S, Shah VB, Edelman A. Julia: A fast dynamic language for technical computing. CoRR abs/1209.5145 (2012). arxiv 1209.5145</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <mixed-citation publication-type="other">Strobl F, Klees S, Stelzer EHK. Light sheet-based fluorescence microscopy of living or fixed and stained tribolium castaneum embryos (122). 2017. 10.3791/55629</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Strobl F, Stelzer EHK. A deterministic genotyping workflow reduces waste of transgenic individuals by two-thirds. Sci Rep. 2021;11(1). 10.1038/s41598-021-94288-0</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Adrian</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Twenty years of particle image velocimetry</article-title>
        <source>Exp Fluids</source>
        <year>2005</year>
        <volume>39</volume>
        <fpage>159</fpage>
        <lpage>169</lpage>
        <pub-id pub-id-type="doi">10.1007/s00348-005-0991-7</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Gollin D, Brevis W, Bowman ET, Shepley P. Performance of PIV and PTV for granular flow measurements. Granular Matter 2017;19(3). 10.1007/s10035-017-0730-9.</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ferrari</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Image analysis techniques for the study of turbulent flows</article-title>
        <source>EPJ Web of Conferences</source>
        <year>2017</year>
        <volume>143</volume>
        <fpage>01001</fpage>
        <pub-id pub-id-type="doi">10.1051/epjconf/201714301001</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Melling</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Tracer particles and seeding for particle image velocimetry</article-title>
        <source>Meas Sci Technol</source>
        <year>1997</year>
        <volume>8</volume>
        <issue>12</issue>
        <fpage>1406</fpage>
        <lpage>1416</lpage>
        <pub-id pub-id-type="doi">10.1088/0957-0233/8/12/005</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Keane</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Adrian</surname>
            <given-names>RJ</given-names>
          </name>
        </person-group>
        <article-title>Theory of cross-correlation analysis of PIV images</article-title>
        <source>Appl Sci Res</source>
        <year>1992</year>
        <volume>49</volume>
        <issue>3</issue>
        <fpage>191</fpage>
        <lpage>215</lpage>
        <pub-id pub-id-type="doi">10.1007/bf00384623</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Stichel D, Middleton AM, Müller BF, Depner S, Klingmüller U, Breuhahn K, Matthäus F. An individual-based model for collective cancer cell migration explains speed dynamics and phenotype variability in response to growth factors. NPJ Syst Biol Appl. 2017;3(1). 10.1038/s41540-017-0006-3.</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weiger</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Vedham</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Stuelten</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Shou</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Herrera</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sato</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Losert</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Parent</surname>
            <given-names>CA</given-names>
          </name>
        </person-group>
        <article-title>Real-time motion analysis reveals cell directionality as an indicator of breast cancer progression</article-title>
        <source>PLoS ONE</source>
        <year>2013</year>
        <volume>8</volume>
        <issue>3</issue>
        <fpage>58859</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0058859</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Müller</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Bovet</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Stichel</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Malz</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>González-Vallinas</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Middleton</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ehemann</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Schmitt</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Muley</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Meister</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Herpel</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Singer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Warth</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schirmacher</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Drasdo</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Matthäus</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Breuhahn</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Concomitant expression of far upstream element (FUSE ) binding protein (FBP ) interacting repressor (FIR) and its splice variants induce migration and invasion of non-small cell lung cancer (NSCLC) cells</article-title>
        <source>J Pathol</source>
        <year>2015</year>
        <volume>237</volume>
        <issue>3</issue>
        <fpage>390</fpage>
        <lpage>401</lpage>
        <pub-id pub-id-type="doi">10.1002/path.4588</pub-id>
        <?supplied-pmid 26177862?>
        <pub-id pub-id-type="pmid">26177862</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Glover</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Wells</surname>
            <given-names>KL</given-names>
          </name>
          <name>
            <surname>Matthäus</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Painter</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Ho</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Riddell</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Johansson</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Ford</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Jahoda</surname>
            <given-names>CAB</given-names>
          </name>
          <name>
            <surname>Klika</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Mort</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Headon</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Hierarchical patterning modes orchestrate hair follicle morphogenesis</article-title>
        <source>PLoS Biol</source>
        <year>2017</year>
        <volume>15</volume>
        <issue>7</issue>
        <fpage>2002117</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pbio.2002117</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Liao</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Mogilner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Losert</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Pan</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Collective cell migration has distinct directionality and speed dynamics</article-title>
        <source>Cell Mol Life Sci</source>
        <year>2017</year>
        <volume>74</volume>
        <issue>20</issue>
        <fpage>3841</fpage>
        <lpage>3850</lpage>
        <pub-id pub-id-type="doi">10.1007/s00018-017-2553-6</pub-id>
        <?supplied-pmid 28612218?>
        <pub-id pub-id-type="pmid">28612218</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zickus</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>3D + time blood flow mapping using spim-micropiv in the developing zebrafish heart</article-title>
        <source>Biomed Opt Express</source>
        <year>2018</year>
        <volume>9</volume>
        <issue>5</issue>
        <fpage>2418</fpage>
        <lpage>2435</lpage>
        <pub-id pub-id-type="doi">10.1364/BOE.9.002418</pub-id>
        <?supplied-pmid 29760998?>
        <pub-id pub-id-type="pmid">29760998</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <mixed-citation publication-type="other">Vennemann P, Lindken R, Hierck B, Westerweel J. Volumetric particle image velocimetry in the developing chicken heart. J Biomech. 2006;39. 10.1016/S0021-9290(06)85562-4.</mixed-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <mixed-citation publication-type="other">Cheng C-M, Chang Y-F, Wu C-M. Cross-correlation analysis for live-cell image trajectory. 2013;8911:89110. 10.1117/12.2034840.</mixed-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cornwell</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Mahadevan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Draper</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Joun</surname>
            <given-names>GL</given-names>
          </name>
          <name>
            <surname>Zoellner</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Asli</surname>
            <given-names>NS</given-names>
          </name>
          <name>
            <surname>Harvey</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Nordon</surname>
            <given-names>RE</given-names>
          </name>
        </person-group>
        <article-title>Trackpad: Software for semi-automated single-cell tracking and lineage annotation</article-title>
        <source>SoftwareX</source>
        <year>2020</year>
        <volume>11</volume>
        <fpage>100440</fpage>
        <pub-id pub-id-type="doi">10.1016/j.softx.2020.100440</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cooley</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Lewis</surname>
            <given-names>PAW</given-names>
          </name>
          <name>
            <surname>Welch</surname>
            <given-names>PD</given-names>
          </name>
        </person-group>
        <article-title>Historical notes on the fast fourier transform</article-title>
        <source>Proc IEEE</source>
        <year>1967</year>
        <volume>55</volume>
        <issue>10</issue>
        <fpage>1675</fpage>
        <lpage>1677</lpage>
        <pub-id pub-id-type="doi">10.1109/proc.1967.5959</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frigo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>SG</given-names>
          </name>
        </person-group>
        <article-title>The design and implementation of fftw3</article-title>
        <source>Proc IEEE</source>
        <year>2005</year>
        <volume>93</volume>
        <fpage>216</fpage>
        <lpage>231</lpage>
        <pub-id pub-id-type="doi">10.1109/JPROC.2004.840301</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <mixed-citation publication-type="other">Lewis JP. Fast normalized cross-correlation Ind Light Magic. 2001;10.</mixed-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <mixed-citation publication-type="other">Bradski, G.: The OpenCV Library. Dr. Dobbs Journal of Software Tools. 2000.</mixed-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <mixed-citation publication-type="other">Bastiaans R. Cross-correlation PIV; Theory. Faculty of Mechanical Engineering, Eindhoven: Implementation and Accuracy. Eindhoven University of Technology; 2000.</mixed-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <mixed-citation publication-type="other">Bromiley P. Products and convolutions of gaussian distributions. 2003.</mixed-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Scarano</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>A super-resolution particle image velocimetry interrogation approach by means of velocity second derivatives correlation</article-title>
        <source>Meas Sci Technol</source>
        <year>2004</year>
        <volume>15</volume>
        <fpage>475</fpage>
        <pub-id pub-id-type="doi">10.1088/0957-0233/15/2/023</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roth</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Katz</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Five techniques for increasing the speed and accuracy of PIV interrogation</article-title>
        <source>Meas Sci Technol</source>
        <year>2001</year>
        <volume>12</volume>
        <fpage>238</fpage>
        <pub-id pub-id-type="doi">10.1088/0957-0233/12/3/302</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Scarano</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Riethmuller</surname>
            <given-names>ML</given-names>
          </name>
        </person-group>
        <article-title>Iterative multigrid approach in PIV image processing with discrete window offset</article-title>
        <source>Exp Fluids</source>
        <year>1999</year>
        <volume>26</volume>
        <issue>6</issue>
        <fpage>513</fpage>
        <lpage>523</lpage>
        <pub-id pub-id-type="doi">10.1007/s003480050318</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <mixed-citation publication-type="other">Masullo A., Theunissen R: On dealing with multiple correlation peaks in PIV. Exp Fluids 2018;59(5). 10.1007/s00348-018-2542-z.</mixed-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Charonko</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Vlachos</surname>
            <given-names>PP</given-names>
          </name>
        </person-group>
        <article-title>Estimation of uncertainty bounds for individual particle image velocimetry measurements from cross-correlation peak ratio</article-title>
        <source>Meas Sci Technol</source>
        <year>2013</year>
        <volume>24</volume>
        <issue>6</issue>
        <fpage>065301</fpage>
        <pub-id pub-id-type="doi">10.1088/0957-0233/24/6/065301</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xue</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Charonko</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Vlachos</surname>
            <given-names>PP</given-names>
          </name>
        </person-group>
        <article-title>Particle image velocimetry correlation signal-to-noise ratio metrics and measurement uncertainty quantification</article-title>
        <source>Meas Sci Technol</source>
        <year>2014</year>
        <volume>25</volume>
        <issue>11</issue>
        <fpage>115301</fpage>
        <pub-id pub-id-type="doi">10.1088/0957-0233/25/11/115301</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <mixed-citation publication-type="other">Raffel M, Willert CE, Scarano F, Kähler CJ, Wereley ST, Kompenhans, J.: PIV Uncertainty and Measurement Accuracy, pp. 203–241. Springer, Cham (2018). 10.1007/978-3-319-68852-7_6.</mixed-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <mixed-citation publication-type="other">Chen, J., Revels, J.: Robust benchmarking in noisy environments. CoRR <bold>abs/1608.04295</bold> (2016). arxiv1608.04295</mixed-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Preibisch</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Amat</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Stamataki</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Sarov</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Singer</surname>
            <given-names>RH</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Tomancak</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Efficient bayesian-based multiview deconvolution</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <issue>6</issue>
        <fpage>645</fpage>
        <lpage>648</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2929</pub-id>
        <?supplied-pmid 24747812?>
        <pub-id pub-id-type="pmid">24747812</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <mixed-citation publication-type="other">Thielicke, W.: The flapping flight of birds: Analysis and application. PhD thesis, University of Groningen (2014)</mixed-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Michaelis</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Neal</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Wieneke</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Peak-locking reduction for particle image velocimetry</article-title>
        <source>Meas Sci Technol</source>
        <year>2016</year>
        <volume>27</volume>
        <issue>10</issue>
        <fpage>104005</fpage>
        <pub-id pub-id-type="doi">10.1088/0957-0233/27/10/104005</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nobach</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bodenschatz</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Limitations of accuracy in PIV due to individual variations of particle image intensities</article-title>
        <source>Exp Fluids</source>
        <year>2009</year>
        <volume>47</volume>
        <issue>1</issue>
        <fpage>27</fpage>
        <lpage>38</lpage>
        <pub-id pub-id-type="doi">10.1007/s00348-009-0627-4</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Merzkirch</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Gui</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>A comparative study of the MQD method and several correlation-based PIV evaluation algorithms</article-title>
        <source>Exp Fluids</source>
        <year>2000</year>
        <volume>28</volume>
        <issue>1</issue>
        <fpage>36</fpage>
        <lpage>44</lpage>
        <pub-id pub-id-type="doi">10.1007/s003480050005</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Forliti</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Strykowski</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Debatin</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Bias and precision errors of digital particle image velocimetry</article-title>
        <source>Exp Fluids</source>
        <year>2000</year>
        <volume>28</volume>
        <issue>5</issue>
        <fpage>436</fpage>
        <lpage>447</lpage>
        <pub-id pub-id-type="doi">10.1007/s003480050403</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Handel</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Grünfelder</surname>
            <given-names>CG</given-names>
          </name>
          <name>
            <surname>Roth</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sander</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Tribolium embryogenesis: a SEM study of cell shapes and movements from blastoderm to serosal closure</article-title>
        <source>Dev Genes Evol</source>
        <year>2000</year>
        <volume>210</volume>
        <issue>4</issue>
        <fpage>167</fpage>
        <lpage>179</lpage>
        <pub-id pub-id-type="doi">10.1007/s004270050301</pub-id>
        <?supplied-pmid 11180819?>
        <pub-id pub-id-type="pmid">11180819</pub-id>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Münster</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Jain</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mietke</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pavlopoulos</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Grill</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Tomancak</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Attachment of the blastoderm to the vitelline envelope affects gastrulation of insects</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>568</volume>
        <issue>7752</issue>
        <fpage>395</fpage>
        <lpage>399</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1044-3</pub-id>
        <?supplied-pmid 30918398?>
        <pub-id pub-id-type="pmid">30918398</pub-id>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benton</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Akam</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pavlopoulos</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Cell and tissue dynamics during tribolium embryogenesis revealed by versatile fluorescence labeling approaches</article-title>
        <source>Development</source>
        <year>2013</year>
        <volume>140</volume>
        <issue>15</issue>
        <fpage>3210</fpage>
        <lpage>3220</lpage>
        <pub-id pub-id-type="doi">10.1242/dev.096271</pub-id>
        <?supplied-pmid 23861059?>
        <pub-id pub-id-type="pmid">23861059</pub-id>
      </element-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <mixed-citation publication-type="other">Jain, A., Ulman, V., Mukherjee, A., Prakash, M., Cuenca, M.B., Pimpale, L.G., Münster, S., Haase, R., Panfilio, K.A., Jug, F., Grill, S.W., Tomancak, P., Pavlopoulos, A.: Regionalized tissue fluidization is required for epithelial gap closure during insect gastrulation. Nature Communications <bold>11</bold>(1) (2020). 10.1038/s41467-020-19356-x</mixed-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <mixed-citation publication-type="other">Liu Y, Zou Q, Luo S. GPU Accelerated Fourier Cross Correlation Computation and Its Application in Template Matching. 2011;163:484–91. 10.1007/978-3-642-25002-6_68.</mixed-citation>
    </ref>
  </ref-list>
</back>
