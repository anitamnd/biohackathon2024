<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4058950</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btu286</article-id>
    <article-id pub-id-type="publisher-id">btu286</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Ismb 2014 Proceedings Papers Committee</subject>
        <subj-group subj-group-type="heading">
          <subject>Original Papers</subject>
          <subj-group subj-group-type="heading">
            <subject>Sequence Analysis</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Stochastic EM-based TFBS motif discovery with MITSU</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Kilpatrick</surname>
          <given-names>Alastair M.</given-names>
        </name>
        <xref ref-type="aff" rid="btu286-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="btu286-COR1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ward</surname>
          <given-names>Bruce</given-names>
        </name>
        <xref ref-type="aff" rid="btu286-AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Aitken</surname>
          <given-names>Stuart</given-names>
        </name>
        <xref ref-type="aff" rid="btu286-AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="btu286-AFF1"><sup>1</sup>School of Informatics, University of Edinburgh, Informatics Forum, Edinburgh EH8 9AB, <sup>2</sup>School of Biological Sciences, University of Edinburgh, Edinburgh EH9 3JR and <sup>3</sup>MRC Human Genetics Unit, IGMM, University of Edinburgh, Western General Hospital, Edinburgh EH4 2XU, UK</aff>
    <author-notes>
      <corresp id="btu286-COR1">*To whom correspondence should be addressed.</corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>6</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>11</day>
      <month>6</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>11</day>
      <month>6</month>
      <year>2014</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>30</volume>
    <issue>12</issue>
    <fpage>i310</fpage>
    <lpage>i318</lpage>
    <permissions>
      <copyright-statement>© The Author 2014. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2014</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/3.0">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/3.0/">http://creativecommons.org/licenses/by-nc/3.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> The Expectation–Maximization (EM) algorithm has been successfully applied to the problem of transcription factor binding site (TFBS) motif discovery and underlies the most widely used motif discovery algorithms. In the wider field of probabilistic modelling, the stochastic EM (sEM) algorithm has been used to overcome some of the limitations of the EM algorithm; however, the application of sEM to motif discovery has not been fully explored.</p>
      <p><bold>Results:</bold> We present MITSU (Motif discovery by ITerative Sampling and Updating), a novel algorithm for motif discovery, which combines sEM with an improved approximation to the likelihood function, which is unconstrained with regard to the distribution of motif occurrences within the input dataset. The algorithm is evaluated quantitatively on realistic synthetic data and several collections of characterized prokaryotic TFBS motifs and shown to outperform EM and an alternative sEM-based algorithm, particularly in terms of site-level positive predictive value.</p>
      <p><bold>Availability and implementation:</bold> Java executable available for download at <ext-link ext-link-type="uri" xlink:href="http://www.sourceforge.net/p/mitsu-motif/">http://www.sourceforge.net/p/mitsu-motif/</ext-link>, supported on Linux/OS X.</p>
      <p>
        <bold>Contact:</bold>
        <email>a.m.kilpatrick@sms.ed.ac.uk</email>
      </p>
    </abstract>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 INTRODUCTION</title>
    <p>Transcription factor binding site (TFBS) motifs are short DNA sequence patterns that have important roles in genetic transcriptional regulation. These patterns are of considerable interest to biologists, as they are central to understanding the mechanisms of gene expression. The discovery and further analysis of TFBS motifs remains an important and challenging problem in bioinformatics [examples from the recent ENCODE project include <xref rid="btu286-B22" ref-type="bibr">Spivakov <italic>et al.</italic> (2012)</xref>, <xref rid="btu286-B26" ref-type="bibr">Whitfield <italic>et al.</italic> (2012)</xref> and <xref rid="btu286-B27" ref-type="bibr">Yip <italic>et al.</italic> (2012)</xref>,]; as a result, there is continued interest in developing algorithms for unsupervised discovery of TFBS motifs (<xref rid="btu286-B3" ref-type="bibr">Bailey <italic>et al.</italic>, 2010</xref>).</p>
    <p>The majority of TFBS discovery algorithms are probabilistic algorithms, which search the input data (usually a collection of promoter regions of coregulated genes) for sequences that are statistically over-represented. Deterministic algorithms make up a large proportion of commonly used algorithms for motif discovery. The deterministic Expectation–Maximization (EM) algorithm is one of the earliest probabilistic motif discovery algorithms (<xref rid="btu286-B18" ref-type="bibr">Lawrence and Reilly, 1990</xref>) and is the basis for a number of others, including the benchmark motif discovery algorithm MEME (<xref rid="btu286-B1" ref-type="bibr">Bailey and Elkan, 1994</xref>). However, the EM algorithm has several well-known limitations. For example, the EM algorithm is highly sensitive to its starting parameters. Owing to this sensitivity and the use of a local search strategy, the EM algorithm cannot be guaranteed to converge to the global maximum of the likelihood function, instead converging to an insignificant local maximum or saddle point of the likelihood function. In general, the steps of the EM algorithm can become either analytically or computationally intractable in many practical situations.</p>
    <p>The stochastic EM (sEM) algorithm is motivated by the limitations of the deterministic EM algorithm, particularly the issues of intractability. <xref rid="btu286-B8" ref-type="bibr">Celeux <italic>et al.</italic> (1995)</xref> note that the sEM algorithm is generally more successful than the EM algorithm owing to stochastic perturbations, which allow the sEM algorithm to escape stable fixed points of the EM algorithm such as insignificant local maxima of the likelihood function. In addition to this, retaining the underlying EM dynamics means that the sEM algorithm generally converges in a relatively small number of iterations in comparison with full stochastic methods.</p>
    <p>Stochastic variants of the EM algorithm have been applied to motif discovery previously; for example, the SEAM (<xref rid="btu286-B5" ref-type="bibr">Bi, 2007</xref>) and MCEMDA (<xref rid="btu286-B6" ref-type="bibr">Bi, 2009</xref>) algorithms. However, the power of sEM in a motif discovery context has not been fully explored. Most notably, these algorithms are limited to the ‘one occurrence per sequence’ (OOPS) model, which places a constraint on the distribution of motif occurrences within the input dataset. Further, algorithms based on stochastic variants of EM have so far not implemented features commonly found in other motif discovery algorithms, including the ability to automatically determine the most likely motif width from a range of plausible values.</p>
    <p>In this article, we present MITSU (Motif discovery by ITerative Sampling and Updating), a novel algorithm for TFBS motif discovery that combines a stochastic version of the EM algorithm with a derived dataset, which leads to an improved approximation of the likelihood function. Significantly, this likelihood function is unconstrained with regard to the number of motif occurrences in each input sequence. The algorithm also incorporates MCOIN, an information-based heuristic to automatically determine the most likely motif width (<xref rid="btu286-B17" ref-type="bibr">Kilpatrick <italic>et al.</italic>, 2013</xref>). MITSU is evaluated quantitatively on realistic synthetic data and several collections of previously characterized prokaryotic TFBS sequences and shown to outperform an EM-based algorithm and the SEAM algorithm, most notably in terms of site-level positive predictive value. The results of additional tests demonstrate that MITSU has significant advantages over current sEM-based approaches for motif discovery.</p>
  </sec>
  <sec id="SEC2">
    <title>2 APPROACH</title>
    <p>This article implements an approach based on sEM for the purpose of TFBS motif discovery. Given a joint distribution <inline-formula><mml:math id="n1"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Z</mml:mi></mml:mstyle><mml:mo stretchy="false">|</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> over observed variables <bold>X</bold> and latent variables <bold>Z</bold>, governed by parameters θ, the deterministic EM algorithm (<xref rid="btu286-B9" ref-type="bibr">Dempster <italic>et al.</italic>, 1977</xref>) maximizes the likelihood function <inline-formula><mml:math id="n2"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mo stretchy="false">|</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> with respect to θ. This likelihood function is intractable directly, so two steps are iteratively applied until some convergence criteria are reached to maximize the likelihood function. An initial estimate of the parameters is made, then the E-step calculates the expected value of the log likelihood function, with respect to the distribution of <bold>Z</bold> conditional on <bold>X</bold> under the current estimate of the parameters <inline-formula><mml:math id="n3"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>:
<disp-formula id="btu286-M1"><label>(1)</label><graphic xlink:href="btu286m1.jpg" position="float"/></disp-formula>
In the context of motif discovery, this can be viewed as calculating the probability for each width-<italic>w</italic> subsequence in the dataset that it is an occurrence of the motif, or equivalently estimating the position of occurrences of the motif within the input dataset. The M-step then evaluates a new estimate of the parameters by maximizing the expected value of the log likelihood function:
<disp-formula id="btu286-M2"><label>(2)</label><mml:math id="n5"><mml:mrow><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>argmax</mml:mtext></mml:mrow><mml:mi>θ</mml:mi></mml:munder><mml:mi mathvariant="script" class="calligraphy">Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula>
In the context of motif discovery, this can be viewed as reestimating the model parameters given the current estimates for the motif position within the input dataset.</p>
    <p>Stochastic variations of the EM algorithm first use Monte Carlo methods to draw a set of samples <inline-formula><mml:math id="n6"><mml:mrow><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> from the current approximation to the conditional predictive distribution <inline-formula><mml:math id="n7"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Z</mml:mi></mml:mstyle><mml:mo stretchy="false">|</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, before replacing the integral in the E-step of the EM algorithm <xref ref-type="disp-formula" rid="btu286-M1">Equation (1)</xref> with a finite sum over the drawn samples. The modified E-step is thus
<disp-formula id="btu286-M3"><label>(3)</label><mml:math id="n8"><mml:mrow><mml:msub><mml:mi mathvariant="script" class="calligraphy">Q</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>≈</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>M</mml:mi></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:mtext>ln</mml:mtext><mml:mspace width=".1em"/></mml:mrow></mml:mstyle><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Z</mml:mi></mml:mstyle><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">|</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula>
The M-Step then requires maximizing the <inline-formula><mml:math id="n9"><mml:mi mathvariant="script" class="calligraphy">Q</mml:mi></mml:math></inline-formula> function as before. This particular variation on the EM algorithm is known as the Monte Carlo EM (MCEM) algorithm (<xref rid="btu286-B25" ref-type="bibr">Wei and Tanner, 1990</xref>).</p>
    <p>Stochastic EM (<xref rid="btu286-B8" ref-type="bibr">Celeux <italic>et al.</italic>, 1995</xref>) can be viewed as a special case of MCEM, where only one sample is drawn at each iteration. In this case, the latent variables <bold>Z</bold> characterize which one of the mixture components is responsible for each point in the dataset, effectively making a ‘hard’ assignment of data points to mixture components, rather than the probabilistic weightings used by the EM algorithm. In the context of motif discovery, this would assign each data point to either the motif model <italic>or</italic> the background model. Formally, the sampling step (S-step, analogous to the E-step in EM) of the sEM algorithm replaces the computation of the <inline-formula><mml:math id="n10"><mml:mi mathvariant="script" class="calligraphy">Q</mml:mi></mml:math></inline-formula> function in the E-step by the simpler computation of <inline-formula><mml:math id="n11"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Z</mml:mi></mml:mstyle><mml:mo stretchy="false">|</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and simulation of a ‘pseudosample’ <italic>z</italic><sup>(</sup><italic><sup>t</sup></italic><sup>)</sup>. The update step (U-step, analogous to the M-step in EM) updates the model parameters θ<sup>(</sup><italic><sup>t</sup></italic><sup>)</sup> on the basis of the ‘pseudo-complete sample’ <inline-formula><mml:math id="n12"><mml:mrow><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, in the same way as normal.</p>
    <p>As noted above, one of the reasons for stochastic variations of EM being generally more successful than EM is that they have the ability to avoid insignificant local maxima of the likelihood function. This is achieved by choosing whether to accept or reject the new set of proposed model parameters in the U-step of the algorithm. Through this accept/reject mechanism, there is a non-zero probability of accepting new model parameters with a lower likelihood than the current parameters at each iteration of the algorithm (<xref rid="btu286-B8" ref-type="bibr">Celeux <italic>et al.</italic>, 1995</xref>). In contrast, deterministic EM is guaranteed not to decrease the likelihood and so may become trapped in local maxima or saddle points of the likelihood function.</p>
    <p>One significant limitation of the SEAM algorithm is that only the OOPS model is implemented. <xref rid="btu286-B5" ref-type="bibr">Bi (2007)</xref> suggests that the OOPS model may be extended to the two-component mixture (TCM) model (which is unconstrained with regard to the distribution of motif occurrences) by first discovering a motif using the OOPS model, then scanning the input sequences to discover further occurrences. However, this strategy may not be statistically robust. In this article, we take an approach that extends the OOPS model naturally to the ‘zero or one occurrences per sequence’ (ZOOPS) model, based on the original model definitions. We then continue this extension to a model that allows an arbitrary number of motif occurrences in each input sequence, using a previously described cutting heuristic.</p>
  </sec>
  <sec>
    <title>3 METHODS</title>
    <sec id="SEC3.1">
      <title>3.1 A sEM density for the OOPS model</title>
      <p>The idea underlying existing algorithms for motif discovery, which implement stochastic variants of EM (<xref rid="btu286-B5" ref-type="bibr">Bi, 2007</xref>, <xref rid="btu286-B6" ref-type="bibr">2009</xref>), is to replace the computation and maximization of <inline-formula><mml:math id="n13"><mml:mrow><mml:mi mathvariant="script" class="calligraphy">Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> by the much simpler computation of <inline-formula><mml:math id="n14"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, drawing a number of samples <italic>Z</italic><sup>(</sup><italic><sup>t</sup></italic><sup>)</sup> (S-step), followed by an update to θ based on the pseudo-complete samples (<italic>X</italic>,<italic>Z</italic><sup>(</sup><italic><sup>t</sup></italic><sup>)</sup>) (U-step). A suitable density to represent an input sequence <italic>X</italic><sub>i</sub> is required. We begin by confirming that the density used by <xref rid="btu286-B5" ref-type="bibr">Bi (2007)</xref> to represent an input sequence using the OOPS model is consistent with the OOPS model derived by <xref rid="btu286-B1" ref-type="bibr">Bailey and Elkan (1994)</xref>.</p>
      <p>We generalize the expression introduced by <xref rid="btu286-B1" ref-type="bibr">Bailey and Elkan (1994)</xref> to define the expectation of the missing data for position <italic>j</italic> in sequence <italic>i</italic> using the OOPS model as follows:
<disp-formula id="btu286-M4"><label>(4)</label><mml:math id="n15"><mml:mrow><mml:msubsup><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>≜</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>w</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mi>p</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>
where <italic>L</italic><sub>i</sub> is defined as the length of input sequence <italic>i</italic>, and <italic>w</italic> is defined as the motif width. Although <xref rid="btu286-B5" ref-type="bibr">Bi (2007)</xref> uses slightly different notation, we confirm that the definition used is equivalent to that of <xref rid="btu286-B1" ref-type="bibr">Bailey and Elkan (1994)</xref>. Defining <italic>k</italic> as the set of nucleotides, that is, <inline-formula><mml:math id="n16"><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, the conditional probability of sequence <italic>i</italic> given the hidden variables is defined in both methods as follows:
<disp-formula id="btu286-M5"><label>(5)</label><mml:math id="n17"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≜</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>  </mml:mtext><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>Δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>A</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:munderover><mml:mrow><mml:msubsup><mml:mi>θ</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mtext> </mml:mtext><mml:mi>I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle><mml:mspace width=".2em"/><mml:mtext> </mml:mtext><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>W</mml:mi></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>A</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:munderover><mml:mrow><mml:msubsup><mml:mi>θ</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mtext> </mml:mtext><mml:mi>I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mi>w</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
This may be viewed as the product of two terms: the first calculating the probability of the background positions and the second calculating the probability of the motif positions.</p>
      <p>Here, we generalize the expressions used by <xref rid="btu286-B1" ref-type="bibr">Bailey and Elkan (1994)</xref> to define the joint (log) likelihood function for the OOPS model as follows:
<disp-formula id="btu286-M6"><label>(6)</label><mml:math id="n18"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mtext>ln </mml:mtext><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≜</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>  </mml:mtext><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>w</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mtext>
</mml:mtext></mml:mstyle></mml:mrow></mml:mstyle><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mtext> ln </mml:mtext><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>N</mml:mi><mml:mtext> ln </mml:mtext><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>w</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
Again, despite notational differences, this can be shown to be equivalent to the expression as defined by <xref rid="btu286-B5" ref-type="bibr">Bi (2007)</xref>.</p>
      <p>To define a suitable density to represent an input sequence, <xref rid="btu286-B5" ref-type="bibr">Bi (2007)</xref> substitutes <xref ref-type="disp-formula" rid="btu286-M5">Equation (5)</xref> into <xref ref-type="disp-formula" rid="btu286-M4">Equation (4)</xref>; cancelling the ‘background’ terms and taking logs for efficiency results in the expression,
<disp-formula id="btu286-M7"><label>(7)</label><mml:math id="n19"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msubsup><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>  </mml:mtext><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mo>Φ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mtext> exp </mml:mtext><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>w</mml:mi></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>A</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:munderover><mml:mrow><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mi>l</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext> ln </mml:mtext><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>θ</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>θ</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
where <inline-formula><mml:math id="n20"><mml:mrow><mml:mo>Φ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is a normalizing factor such that
<disp-formula><mml:math id="n21"><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>w</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mi>p</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></disp-formula>
Discussion of the sEM S- and U-steps is deferred to the following section, where they are presented in the context of the ZOOPS model.</p>
    </sec>
    <sec id="SEC3.2">
      <title>3.2 Extending sEM to the ZOOPS model</title>
      <p>Here, we follow a similar method to derive an expression representing a sequence in the ZOOPS model. The ZOOPS model, introduced by <xref rid="btu286-B1" ref-type="bibr">Bailey and Elkan (1994)</xref>, assumes that the input sequences contain ‘zero or one occurrences per sequence’. The ZOOPS model requires an indicator variable that denotes whether a particular input sequence contains a motif occurrence. Here, the indicator variable <italic>Q</italic><sub>i</sub> is defined as <inline-formula><mml:math id="n22"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≜</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>w</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula>. That is, <italic>Q</italic><sub>i</sub> = 1 if sequence <italic>i</italic> contains a motif occurrence and 0 otherwise. The conditional likelihood for a sequence containing a motif occurrence remains the same [<xref ref-type="disp-formula" rid="btu286-M5">Equation (5)</xref>]. The conditional likelihood for a sequence that does not contain a motif occurrence is now defined as follows:
<disp-formula id="btu286-M8"><label>(8)</label><mml:math id="n23"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≜</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>A</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:munderover><mml:mrow><mml:msubsup><mml:mi>θ</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula>
Defining an additional variable γ as the prior probability of a motif occurring in a sequence and assuming a uniform prior distribution for motif occurrences within a sequence, it follows that the prior probability of a position in sequence <italic>i</italic> being a motif start site is
<disp-formula id="btu286-M9"><label>(9)</label><mml:math id="n24"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mi>γ</mml:mi><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>w</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>
For simplicity, the model parameters are now collected and denoted as <inline-formula><mml:math id="n25"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>γ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. It is noted that the model parameters now include the prior probability of a sequence containing a motif occurrence, in addition to the motif and background models from the OOPS model. It can be shown that the log likelihood function for the complete data in the ZOOPS model can be generalized as follows:
<disp-formula id="btu286-M10"><label>(10)</label><graphic xlink:href="btu286m10.jpg" position="float"/></disp-formula>
</p>
      <p>The expectation of the missing data for the ZOOPS model is therefore
<disp-formula id="btu286-M11"><label>(11)</label><mml:math id="n27"><mml:mrow><mml:msubsup><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>γ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>w</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>γ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mtext> </mml:mtext><mml:mo>+</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>w</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mi>p</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>γ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>w</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>
It can be shown that substituting <xref ref-type="disp-formula" rid="btu286-M5">Equations (5)</xref> and <xref ref-type="disp-formula" rid="btu286-M8">(8)</xref> into <xref ref-type="disp-formula" rid="btu286-M11">Equation (11)</xref> as required, then cancelling terms yields
<disp-formula id="btu286-M12"><label>(12)</label><mml:math id="n28"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msubsup><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext> </mml:mtext><mml:mfrac><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>W</mml:mi></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>A</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mi>w</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle><mml:mtext> </mml:mtext><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>w</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>γ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mtext> </mml:mtext><mml:mo>+</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>w</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>W</mml:mi></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>A</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mi>w</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle><mml:mtext> </mml:mtext><mml:mi>γ</mml:mi></mml:mrow><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
our expression representing a sequence in the ZOOPS model.</p>
      <p>The S-step of the sEM algorithm is implemented as described previously (<xref rid="btu286-B5" ref-type="bibr">Bi, 2007</xref>), drawing a sample <inline-formula><mml:math id="n29"><mml:mrow><mml:msub><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> from <xref ref-type="disp-formula" rid="btu286-M12">Equation (12)</xref> for each input sequence <inline-formula><mml:math id="n30"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>...</mml:mn><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. The U-step of the sEM algorithm requires the construction of a proposal model θ<italic>′</italic> based on the samples from the S-step. The parameter updates provided by <xref rid="btu286-B5" ref-type="bibr">Bi (2007)</xref> are altered here to account for the fact that not every sequence may contain a motif occurrence. The expected values of the <italic>Q</italic><sub>i</sub> variables are used to weight the samples from each sequence <italic>i</italic>. Here we define the parameters of our proposal model as
<disp-formula id="btu286-M13"><label>(13)</label><mml:math id="n31"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mspace width="-1em"/><mml:mo>′</mml:mo><mml:mspace width=".8em"/><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mi>I</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>′</mml:mo><mml:mo>+</mml:mo><mml:mi>w</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext>
</mml:mtext><mml:msubsup><mml:mi>Q</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>A</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:munderover><mml:mi>I</mml:mi></mml:mstyle></mml:mrow></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>′</mml:mo><mml:mo>+</mml:mo><mml:mi>w</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext>
</mml:mtext><mml:msubsup><mml:mi>Q</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>
for <inline-formula><mml:math id="n32"><mml:mrow><mml:mi>w</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>W</mml:mi></mml:mrow><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="n33"><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The parameters of the background model are not updated, but could be reestimated if required. <inline-formula><mml:math id="n34"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>A</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula> is a vector of pseudocounts, equivalent to a Dirichlet prior distribution. We also require an update for the other parameter γ. It can be shown that the proposal value for the fraction of sequences containing a motif occurrence is just that, based on the values of <inline-formula><mml:math id="n35"><mml:mrow><mml:msubsup><mml:mi>Q</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> calculated in the S-step:
<disp-formula id="btu286-M14"><label>(14)</label><mml:math id="n36"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>′</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:msubsup><mml:mi>Q</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula>
</p>
      <p>As in SEAM (<xref rid="btu286-B5" ref-type="bibr">Bi, 2007</xref>), the Metropolis algorithm is used to decide whether to keep our updated parameters. The energies of the current and proposal models, <inline-formula><mml:math id="n37"><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="n38"><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, respectively, are calculated (how this is done is described in Section 3.4) and the change in energy calculated:
<disp-formula id="btu286-M15"><label>(15)</label><mml:math id="n39"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
The Metropolis ratio is defined as
<disp-formula id="btu286-M16"><label>(16)</label><mml:math id="n40"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mtext>min </mml:mtext><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>exp</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>Δ</mml:mi><mml:mi>G</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
A random number <inline-formula><mml:math id="n41"><mml:mrow><mml:mi>u</mml:mi><mml:mspace width=".2em"/><mml:mo>∼</mml:mo><mml:mspace width=".2em"/><mml:mtext>Unif</mml:mtext><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is drawn and the parameters updated to the proposal parameters only if <italic>u</italic> is less than or equal to the Metropolis ratio, that is,
<disp-formula id="btu286-M17"><label>(17)</label><mml:math id="n42"><mml:mrow><mml:msubsup><mml:mi>θ</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>′</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width=".2em"/><mml:mtext> </mml:mtext><mml:mi>u</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>θ</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mspace width="-1.8em"/><mml:mtext>otherwise</mml:mtext><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>
for <inline-formula><mml:math id="n43"><mml:mrow><mml:mi>w</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>W</mml:mi></mml:mrow><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="n44"><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and
<disp-formula id="btu286-M18"><label>(18)</label><mml:math id="n45"><mml:mrow><mml:msup><mml:mi>γ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>γ</mml:mi><mml:mo>′</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width=".2em"/><mml:mtext> </mml:mtext><mml:mi>u</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>γ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mspace width="-1.8em"/><mml:mtext>otherwise</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>
</p>
    </sec>
    <sec id="SEC3.3">
      <title>3.3 Removing the ZOOPS constraint</title>
      <p>The ZOOPS model still enforces constraints on the distribution of motif occurrences; it is assumed that each input sequence contains at most one occurrence of a motif. However, there are many biological examples of promoter sequences that contain multiple copies of the same TFBS (<xref rid="btu286-B4" ref-type="bibr">Bembom <italic>et al.</italic>, 2007</xref>). This is the primary motivation for the TCM model introduced by <xref rid="btu286-B1" ref-type="bibr">Bailey and Elkan (1994)</xref>, which allows an arbitrary number of non-overlapping motif occurrences in each input sequence.</p>
      <p>The likelihood function for the TCM model is more computationally complex than those for the OOPS and ZOOPS models. As a result, exact methods based on the TCM model have been avoided in favour of more tractable approximations (<xref rid="btu286-B4" ref-type="bibr">Bembom <italic>et al.</italic>, 2007</xref>). The TCM model proposed by <xref rid="btu286-B1" ref-type="bibr">Bailey and Elkan (1994)</xref> uses a derived dataset consisting of all overlapping subsequences of width <italic>w</italic> from the original dataset. Some proportion of these subsequences are motif occurrences; the remainder are background. While the subsequences in this derived dataset are necessarily overlapping, the likelihood function is based on a sample of independent sequences (<xref rid="btu286-B4" ref-type="bibr">Bembom <italic>et al.</italic>, 2007</xref>). An additional smoothing step is required to reduce the degree to which two overlapping subsequences can both be assigned to the motif component of the model.</p>
      <p><xref rid="btu286-B16" ref-type="bibr">Keles <italic>et al.</italic> (2003)</xref> propose an alternative cutting heuristic, which involves deriving a different dataset from the original, then applying the ZOOPS model to each of the derived sequences. The main advantages of this method are that no additional steps are required to deal with the assumption of independence, and the approximation to the likelihood function is improved. This method is improved by <xref rid="btu286-B4" ref-type="bibr">Bembom <italic>et al.</italic> (2007)</xref> and we implement a similar method here. Briefly, the original dataset is cut into subsequences of a given length <italic>U</italic>, such that each subsequence contains the first (<italic>w</italic> − 1) positions of the next subsequence. The ZOOPS model is then applied to this derived dataset. The previous studies implementing this heuristic have shown that the method is fairly robust with respect to the choice of cut length <italic>U</italic> but have suggested that this parameter may be optimized using cross-validation (<xref rid="btu286-B4" ref-type="bibr">Bembom <italic>et al.</italic>, 2007</xref>; <xref rid="btu286-B16" ref-type="bibr">Keles <italic>et al.</italic>, 2003</xref>). Here, the cut heuristic is implemented as an inner loop within the motif discovery algorithm (Section 3.5). The ZOOPS model is applied to derived datasets with varying values of <italic>U</italic>, and the parameter settings that yield the highest energy value are returned as the best motif model. We show in Section 4.3 that the cut heuristic in combination with the ZOOPS model successfully allows discovery of multiple copies of the same motif within a single input sequence, in the context of motif discovery using sEM.</p>
    </sec>
    <sec id="SEC3.4">
      <title>3.4 Defining an energy function</title>
      <p>The original energy function used in the SEAM algorithm (<xref rid="btu286-B5" ref-type="bibr">Bi, 2007</xref>) becomes problematic when used with the cut heuristic used to implement discovery of multiple motifs within a single input sequence. The main problem stems from the fact that the energy function
<disp-formula id="btu286-M19"><label>(19)</label><mml:math id="n46"><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>A</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mtext> ln</mml:mtext><mml:mspace width=".2em"/><mml:mtext> </mml:mtext><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>W</mml:mi></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>A</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle><mml:mtext> ln</mml:mtext><mml:mspace width=".2em"/><mml:mtext> </mml:mtext><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
is scaled by the number of input sequences <italic>N</italic>; this is assumed to be constant in the SEAM algorithm and means that energies cannot be compared between datasets with differing values of <italic>N</italic>. Using the cutting heuristic means that the value of <italic>N</italic> may double, or triple, depending on the cut length (<italic>U</italic>). A way of fairly comparing motif energies is required. We are further interested in the properties of the energy function, particularly how it varies with changing motif conservation and varying values of γ. Here, we propose a modification to the original energy function such that
<disp-formula id="btu286-M20"><label>(20)</label><mml:math id="n47"><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>γ</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>A</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mspace width=".2em"/><mml:mtext> ln</mml:mtext><mml:mspace width=".2em"/><mml:mtext> </mml:mtext><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>W</mml:mi></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>A</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle><mml:mtext> ln</mml:mtext><mml:mspace width=".2em"/><mml:mtext> </mml:mtext><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
This modified energy function is maximized with a perfectly conserved motif occurring in each input sequence, and the γ<italic>N</italic> factor cancels in the case of datasets derived by the cut heuristic. It can be shown that the following useful properties hold:
<list list-type="order"><list-item><p>If two motifs are perfectly conserved, the motif with the higher number of occurrences will have a higher energy.</p></list-item><list-item><p>Given two motifs of equal prevalence and unequal motif conservation, the motif discovery algorithm will tend to discover the motif with the higher energy (equivalently, the higher motif conservation).</p></list-item><list-item><p>All else being equal, a higher proportion of sequences containing a motif occurrence will yield a higher energy.</p></list-item></list>
We adopt this modified energy function in MITSU but note that other alternative energy functions may be possible; because the sEM accept/reject mechanism is based on a difference of energies, substituting other energy functions based on the model entropy should have little effect on this mechanism.</p>
    </sec>
    <sec id="SEC3.5">
      <title>3.5 MITSU algorithm</title>
      <p>The pseudocode of MITSU is given as follows:</p>
      <p>
        <boxed-text id="btu286-BOX1" position="float">
          <p><bold>procedure</bold> MITSU algorithm</p>
          <p> create Markov background model</p>
          <p> <bold>for</bold>
<italic>w</italic> = <italic>w<sub>min</sub></italic>
<bold>to</bold>
<italic>w<sub>max</sub></italic>
<bold>do</bold></p>
          <p>  <bold>for</bold> cut length <bold>in</bold> {set of cut lengths}<bold>do</bold></p>
          <p>   <bold>for</bold>
<italic>n</italic> random seeds <bold>do</bold></p>
          <p>    <bold>for</bold> γ = <inline-formula><mml:math id="n48"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi>N</mml:mi></mml:msqrt></mml:mrow></mml:math></inline-formula>
<bold>to</bold> 1 <bold>by</bold> × 2 <bold>do</bold></p>
          <p>     run sEM on cut dataset using ZOOPS model at width <italic>w</italic>:</p>
          <p>     <bold>until</bold> convergence <bold>do</bold></p>
          <p>      S-step (<xref ref-type="disp-formula" rid="btu286-M12">Equation 12</xref>)</p>
          <p>      U-step (<xref ref-type="disp-formula" rid="btu286-M13 btu286-M14 btu286-M15 btu286-M16 btu286-M17 btu286-M18">Equations 13–18</xref>)</p>
          <p>     <bold>end</bold></p>
          <p>    <bold>end</bold></p>
          <p>   <bold>end</bold></p>
          <p>   return the best motif model over <italic>n</italic> random seeds &amp; varying γ</p>
          <p>  <bold>end</bold></p>
          <p>  return the best motif model over all cut lengths</p>
          <p> <bold>end</bold></p>
          <p> estimate most likely width <inline-formula><mml:math id="n49"><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> using MCOIN</p>
          <p> return motif model and list of predicted sites for <inline-formula><mml:math id="n50"><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula></p>
          <p><bold>end</bold> MITSU algorithm</p>
        </boxed-text>
      </p>
      <p>Although satisfactory convergence results for sEM and related algorithms have been obtained (<xref rid="btu286-B10" ref-type="bibr">Diebolt and Robert, 1990</xref>, <xref rid="btu286-B11" ref-type="bibr">1994</xref>), designing a stopping rule for sEM is challenging; <xref rid="btu286-B15" ref-type="bibr">Jank (2005)</xref> notes that a simple deterministic stopping rule may be triggered by what is a chance fluctuation stemming from the S-step of the algorithm. Following the recommendations of <xref rid="btu286-B7" ref-type="bibr">Booth and Hobert (1999)</xref>, we implement a deterministic stopping rule for several iterations to reduce the chance of a premature stop. After each iteration, the Euclidean distance between the previous and current motif models is calculated. If this distance is below a given threshold for three successive iterations, the algorithm is deemed to have converged; we choose the threshold here as 10<sup>−3</sup>. Stochastic EM generally takes longer to converge than deterministic EM (on tests with the CRP dataset used in Section 4.3, deterministic EM was approximately five times faster than MITSU, based on testing 1000 random seeds). However, as noted above, sEM usually converges faster than full stochastic methods. We accept this longer running time in exchange for increased accuracy in terms of predicted motif occurrences. We compare the convergence of MITSU with that of deterministic EM in Section 4.2.</p>
      <p>Motif occurrences are predicted using a Bayes-optimal classifier that has been described previously by <xref rid="btu286-B1" ref-type="bibr">Bailey and Elkan (1994)</xref>. Following the ZOOPS model, we predict at most one motif occurrence per sequence in the cut dataset; the cut heuristic means that more than one occurrence per sequence may be predicted when these predictions are mapped back to the original dataset.</p>
    </sec>
  </sec>
  <sec>
    <title>4 RESULTS AND DISCUSSION</title>
    <p>Here, we summarize and discuss the results of a number of tests that illustrate the advantages of a sEM-based approach for motif discovery and the performance advantages of MITSU in particular. Algorithmic performance is assessed through mean site-level sensitivity (<italic>sSn</italic>), mean site-level positive predictive value (<italic>sPPV</italic>) and the area under the receiver operating characteristic (ROC) curve (AUC). These measures are commonly used to assess the performance of motif discovery algorithms, for example, in the studies of <xref rid="btu286-B14" ref-type="bibr">Hu <italic>et al.</italic> (2005)</xref> and <xref rid="btu286-B24" ref-type="bibr">Tompa <italic>et al.</italic> (2005)</xref>. Following these studies, a predicted motif site is defined as a true-positive result if it overlaps the true site by at least a quarter of the motif width.</p>
    <sec id="SEC4.1">
      <title>4.1 Stochastic EM outperforms deterministic EM</title>
      <p>MITSU was evaluated quantitatively using a mixture of realistic synthetic and previously characterized real data. Datasets were constructed as described previously (<xref rid="btu286-B17" ref-type="bibr">Kilpatrick <italic>et al.</italic>, 2013</xref>). Briefly, five large data collections each consisting of 1000 datasets were constructed using synthetic motifs of varying conservation and realistic <italic>E</italic><italic>scherichia coli</italic> background sequence extracted from the EcoGene database (<xref rid="btu286-B21" ref-type="bibr">Rudd, 2000</xref>). A sixth data collection consisting of 20 datasets was constructed using known <italic>E.</italic><italic>coli</italic> TFBS sequences extracted from RegulonDB (<xref rid="btu286-B13" ref-type="bibr">Gama-Castro <italic>et al.</italic>, 2011</xref>). Finally, a data collection consisting of nine datasets was constructed using known TFBS motif sequences from diverse prokaryotic species. These motif sequences were discovered by ChIP methods. Background sequences for these datasets were constructed using synthetic data, altering the probability of choosing each nucleotide to reflect the species GC-content as required. <xref ref-type="table" rid="btu286-T1 btu286-T2 btu286-T3">Tables 1–3</xref> summarize the results of the tests on these data collections. For comparison, we also include the results of a deterministic EM-based motif discovery algorithm (<xref rid="btu286-B17" ref-type="bibr">Kilpatrick <italic>et al.</italic>, 2013</xref>) and SEAM. AUC results are not available for SEAM, as constructing a ROC curve requires ordering all subsequences according to their probability of being a motif occurrence. This is not possible in SEAM as a result of the method of prediction used.
<table-wrap id="btu286-T1" position="float"><label>Table 1.</label><caption><p>Realistic synthetic data: classification results</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="2" colspan="1">Conservation (mean bits/col)</th><th colspan="3" rowspan="1">Deterministic EM<hr/></th><th colspan="3" rowspan="1">SEAM<hr/></th><th colspan="3" rowspan="1">MITSU<hr/></th></tr><tr><th rowspan="1" colspan="1"><italic>sSn</italic></th><th rowspan="1" colspan="1"><italic>sPPV</italic></th><th rowspan="1" colspan="1">AUC</th><th rowspan="1" colspan="1"><italic>sSn</italic></th><th rowspan="1" colspan="1"><italic>sPPV</italic></th><th rowspan="1" colspan="1">AUC</th><th rowspan="1" colspan="1"><italic>sSn</italic></th><th rowspan="1" colspan="1"><italic>sPPV</italic></th><th rowspan="1" colspan="1">AUC</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">2.00</td><td rowspan="1" colspan="1">0.84</td><td rowspan="1" colspan="1">0.25</td><td rowspan="1" colspan="1"><bold>0.99</bold></td><td rowspan="1" colspan="1"><bold>1.00</bold></td><td rowspan="1" colspan="1"><bold>1.00</bold></td><td rowspan="1" colspan="1">—</td><td rowspan="1" colspan="1">0.70</td><td rowspan="1" colspan="1">0.74</td><td rowspan="1" colspan="1">0.97</td></tr><tr><td rowspan="1" colspan="1">1.49</td><td rowspan="1" colspan="1">0.26</td><td rowspan="1" colspan="1">0.07</td><td rowspan="1" colspan="1">0.98</td><td rowspan="1" colspan="1"><bold>0.93</bold></td><td rowspan="1" colspan="1">0.93</td><td rowspan="1" colspan="1">—</td><td rowspan="1" colspan="1">0.90</td><td rowspan="1" colspan="1"><bold>0.97</bold></td><td rowspan="1" colspan="1"><bold>1.00</bold></td></tr><tr><td rowspan="1" colspan="1">1.08</td><td rowspan="1" colspan="1">0.02</td><td rowspan="1" colspan="1">0.01</td><td rowspan="1" colspan="1">0.96</td><td rowspan="1" colspan="1">0.49</td><td rowspan="1" colspan="1">0.49</td><td rowspan="1" colspan="1">—</td><td rowspan="1" colspan="1"><bold>0.68</bold></td><td rowspan="1" colspan="1"><bold>0.77</bold></td><td rowspan="1" colspan="1"><bold>0.99</bold></td></tr><tr><td rowspan="1" colspan="1">0.76</td><td rowspan="1" colspan="1">0.00</td><td rowspan="1" colspan="1">0.00</td><td rowspan="1" colspan="1"><bold>0.94</bold></td><td rowspan="1" colspan="1">0.09</td><td rowspan="1" colspan="1">0.09</td><td rowspan="1" colspan="1">—</td><td rowspan="1" colspan="1"><bold>0.17</bold></td><td rowspan="1" colspan="1"><bold>0.19</bold></td><td rowspan="1" colspan="1"><bold>0.94</bold></td></tr><tr><td rowspan="1" colspan="1">0.51</td><td rowspan="1" colspan="1">0.00</td><td rowspan="1" colspan="1">0.00</td><td rowspan="1" colspan="1"><bold>0.93</bold></td><td rowspan="1" colspan="1">0.06</td><td rowspan="1" colspan="1">0.06</td><td rowspan="1" colspan="1">—</td><td rowspan="1" colspan="1"><bold>0.07</bold></td><td rowspan="1" colspan="1"><bold>0.08</bold></td><td rowspan="1" colspan="1"><bold>0.93</bold></td></tr></tbody></table><table-wrap-foot><fn id="btu286-TF1"><p><italic>Note</italic>: <italic>sSn, sPPV</italic> and AUC for five collections of realistic synthetic data with varying levels of motif conservation. Best results are printed in bold. In these tests, motif discovery was carried out only at the known motif width.</p></fn></table-wrap-foot></table-wrap>
<table-wrap id="btu286-T2" position="float"><label>Table 2.</label><caption><p><italic>Escherichia coli</italic> data: classification results</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="2" colspan="1">Conservation(mean bits/col)</th><th colspan="3" rowspan="1">Deterministic EM<hr/></th><th colspan="3" rowspan="1">SEAM<hr/></th><th colspan="3" rowspan="1">MITSU<hr/></th></tr><tr><th rowspan="1" colspan="1"><italic>sSn</italic></th><th rowspan="1" colspan="1"><italic>sPPV</italic></th><th rowspan="1" colspan="1">AUC</th><th rowspan="1" colspan="1"><italic>sSn</italic></th><th rowspan="1" colspan="1"><italic>sPPV</italic></th><th rowspan="1" colspan="1">AUC</th><th rowspan="1" colspan="1"><italic>sSn</italic></th><th rowspan="1" colspan="1"><italic>sPPV</italic></th><th rowspan="1" colspan="1">AUC</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">‘High’ (1.36)</td><td rowspan="1" colspan="1"><bold>0.81</bold></td><td rowspan="1" colspan="1">0.22</td><td rowspan="1" colspan="1">0.96</td><td rowspan="1" colspan="1">0.67</td><td rowspan="1" colspan="1">0.67</td><td rowspan="1" colspan="1">—</td><td rowspan="1" colspan="1">0.54</td><td rowspan="1" colspan="1"><bold>0.75</bold></td><td rowspan="1" colspan="1"><bold>0.98</bold></td></tr><tr><td rowspan="1" colspan="1">‘Low’ (0.78)</td><td rowspan="1" colspan="1">0.63</td><td rowspan="1" colspan="1">0.41</td><td rowspan="1" colspan="1">0.96</td><td rowspan="1" colspan="1"><bold>0.65</bold></td><td rowspan="1" colspan="1">0.65</td><td rowspan="1" colspan="1">—</td><td rowspan="1" colspan="1">0.57</td><td rowspan="1" colspan="1"><bold>0.71</bold></td><td rowspan="1" colspan="1"><bold>0.97</bold></td></tr><tr><td rowspan="1" colspan="1">Overall (1.13)</td><td rowspan="1" colspan="1"><bold>0.74</bold></td><td rowspan="1" colspan="1">0.30</td><td rowspan="1" colspan="1">0.96</td><td rowspan="1" colspan="1">0.66</td><td rowspan="1" colspan="1">0.66</td><td rowspan="1" colspan="1">—</td><td rowspan="1" colspan="1">0.55</td><td rowspan="1" colspan="1"><bold>0.73</bold></td><td rowspan="1" colspan="1"><bold>0.98</bold></td></tr></tbody></table><table-wrap-foot><fn id="btu286-TF2"><p><italic>Note</italic>: <italic>sSn</italic>, <italic>sPPV</italic> and AUC for 20 datasets created using previously characterized <italic>E.coli</italic> TFBS sequences. Best results are printed in bold. In these tests, motif discovery was carried out only at the experimentally determined motif width.</p></fn></table-wrap-foot></table-wrap>
<table-wrap id="btu286-T3" position="float"><label>Table 3.</label><caption><p>Diverse prokaryotic data: classification results</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="2" colspan="1">Conservation (mean bits/col)</th><th colspan="3" rowspan="1">Deterministic EM<hr/></th><th colspan="3" rowspan="1">SEAM<hr/></th><th colspan="3" rowspan="1">MITSU<hr/></th></tr><tr><th rowspan="1" colspan="1"><italic>SSn</italic></th><th rowspan="1" colspan="1"><italic>Sppv</italic></th><th rowspan="1" colspan="1">AUC</th><th rowspan="1" colspan="1"><italic>sSn</italic></th><th rowspan="1" colspan="1"><italic>sPPV</italic></th><th rowspan="1" colspan="1">AUC</th><th rowspan="1" colspan="1"><italic>sSn</italic></th><th rowspan="1" colspan="1"><italic>sPPV</italic></th><th rowspan="1" colspan="1">AUC</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">0.99</td><td rowspan="1" colspan="1">0.75</td><td rowspan="1" colspan="1">0.67</td><td rowspan="1" colspan="1">0.99</td><td rowspan="1" colspan="1">0.86</td><td rowspan="1" colspan="1">0.86</td><td rowspan="1" colspan="1">—</td><td rowspan="1" colspan="1"><bold>0.88</bold></td><td rowspan="1" colspan="1"><bold>0.92</bold></td><td rowspan="1" colspan="1"><bold>1.00</bold></td></tr></tbody></table><table-wrap-foot><fn id="btu286-TF3"><p><italic>Note</italic>: <italic>sSn</italic>, <italic>sPPV</italic> and AUC for nine datasets created using real prokaryotic data determined through ChIP experiments. Best results are printed in bold. In these tests, motif discovery was carried out only at the experimentally determined motif width.</p></fn></table-wrap-foot></table-wrap></p>
      <sec id="SEC4.1.1">
        <title>4.1.1 Realistic synthetic data</title>
        <p>Based on the results on realistic synthetic data shown in <xref ref-type="table" rid="btu286-T1">Table 1</xref>, we note that <italic>sSn</italic> and <italic>sPPV</italic> decrease with decreasing motif conservation for all three tested algorithms. We have noted this behaviour previously in deterministic EM (<xref rid="btu286-B17" ref-type="bibr">Kilpatrick <italic>et al.</italic>, 2013</xref>) and attribute the decrease in <italic>sSn</italic> to fewer sites being predicted overall and the decrease in <italic>sPPV</italic> to the background sites better matching the motif sites as conservation decreases, leading to an increase in the number of false-positive results.</p>
        <p>We note that, in the majority of tests, the results of MITSU outperform those of both the deterministic EM algorithm and SEAM, particularly with regard to <italic>sSn</italic> and <italic>sPPV.</italic> The increased performance at lower levels of motif conservation is particularly notable. The success of MITSU is attributable to making fewer, but more accurate, predictions. The predictions made are generally more cautious; previous false-positive predictions are now more likely to be classified as true-negative predictions. This significant reduction in the number of false-positive predictions explains the large increase in the <italic>sPPV</italic> values.</p>
        <p>We also note that the <italic>sSn</italic> and <italic>sPPV</italic> results for the sEM-based algorithms are less biased. The results for the deterministic EM algorithm, particularly at high levels of motif conservation, are skewed towards increasing <italic>sSn</italic>; that is, fewer false-negative predictions were made at the expense of having more false-positive predictions. SEAM and MITSU are more unbiased in this respect, producing fewer false predictions in general.</p>
      </sec>
      <sec id="SEC4.1.2">
        <title>4.1.2 Escherichia coli and prokaryotic ChIP data</title>
        <p><xref ref-type="table" rid="btu286-T2">Tables 2</xref> and <xref ref-type="table" rid="btu286-T3">3</xref> present the results of tests on previously characterized <italic>E.</italic><italic>coli</italic> TFBS sequences and TFBS sequences from diverse prokaryotes determined by ChIP experiments, respectively. The general trend remains the same: both sSn and sPPV decrease with decreasing motif conservation. We have reported previously that deterministic EM-based motif discovery achieves better classification results on previously characterized <italic>E.</italic><italic>coli</italic> data than could be expected given realistic synthetic data of a similar conservation (<xref rid="btu286-B17" ref-type="bibr">Kilpatrick <italic>et al.</italic>, 2013</xref>). Again, we attribute this improvement in performance to the differences in motif structure. Whereas the conservation of the synthetic motifs used here is independent of position, <xref rid="btu286-B12" ref-type="bibr">Eisen (2005)</xref> notes that real TFBS motifs with low mean conservation often have clusters of well-conserved positions; we believe that differences in the distribution of high and low conservation across true motifs in comparison with synthetic motifs explains the improvement in performance on real data. We note a similar trend here with the results of SEAM and MITSU, particularly at lower levels of motif conservation.</p>
        <p>As with the realistic synthetic data, MITSU is shown to increase <italic>sPPV</italic> by making fewer, more accurate, predictions (<xref ref-type="table" rid="btu286-T2">Table 2</xref>). We note that the <italic>sSn</italic> values are decreased to lower than the corresponding values from deterministic EM and (to a lesser extent) SEAM. This is a side effect of predicting fewer sites overall: ‘borderline’ predictions that may have been classified as true-positive results previously are now classed as false-negative results owing to the more cautious predictor. However, as with the realistic synthetic data results, we note that the <italic>sSn</italic> and <italic>sPPV</italic> values for MITSU are now less biased. Although MITSU uses a Bayes-optimal classifier for site prediction, the results of the <italic>E.</italic><italic>coli</italic> tests here suggest that a better balance between <italic>sSn</italic> and <italic>sPPV</italic> may be achieved with a different predictor. However, we note that the complexity of the computational problem and the wide structural variety of TFBS motifs may mean that it is not possible to improve on all measures in all cases.</p>
        <p>MITSU is shown to be particularly effective in cases where the deterministic EM-based algorithm returned poor results. <xref ref-type="fig" rid="btu286-F1">Figure 1</xref> displays ROC curves for the <italic>E.</italic><italic>coli</italic> TorR motif as discovered by both the deterministic EM and MITSU algorithms. This motif was poorly discovered by the deterministic EM algorithm (<italic>sSn</italic> = 0.10, <italic>sPPV</italic> = 0.03, AUC = 0.83); however, MITSU increases performance over all measures (<italic>sSn</italic> = 0.30, <italic>sPPV</italic> = 0.50, AUC = 0.98). As noted above, the significant improvement in <italic>sPPV</italic> is attributable to predicting fewer sites overall, reducing the number of false-positive results. In this case, the improvement in <italic>sSn</italic> is a result of an improved motif model, which better fits the known occurrences. Sequence logos representing the motifs discovered by both algorithms are shown in <xref ref-type="fig" rid="btu286-F2">Figure 2</xref>. Similar improvements in performance are also seen for the <italic>E.</italic><italic>coli</italic> FruR and RscB motifs.
<fig id="btu286-F1" position="float"><label>Fig. 1.</label><caption><p>ROC curves (plotted for 0 ≤ <italic>sFPR</italic> ≤ 0.5) for the <italic>E.coli</italic> TorR motif discovered by the deterministic EM algorithm (left) and MITSU (right). Curve colour illustrates the threshold of <inline-formula><mml:math id="n51"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, from highest (red) to lowest (blue)</p></caption><graphic xlink:href="btu286f1"/></fig>
<fig id="btu286-F2" position="float"><label>Fig. 2.</label><caption><p>Sequence logos representing the <italic>E.coli</italic> TorR motif as discovered by the deterministic EM algorithm (top) and MITSU (bottom)</p></caption><graphic xlink:href="btu286f2"/></fig></p>
        <p><xref ref-type="table" rid="btu286-T3">Table 3</xref> shows that for the diverse prokaryotic motifs, MITSU outperforms deterministic EM and SEAM in terms of all three performance measures. We note that the increase in <italic>sPPV</italic> is most significant. This result may be of particular interest to biologists, as it means that fewer false-positive results are predicted: sites which are predicted now are therefore more likely to be true TFBS occurrences. As with the <italic>E.</italic><italic>coli</italic> motifs above, we notice significant increases in performance for motifs that were relatively poorly discovered by deterministic EM, for example, the <italic>E.</italic><italic>coli</italic> CRP and RutR motifs and the <italic>B</italic><italic>acillus subtilis</italic> Spo0A motif.</p>
        <p>Further tests were carried out in which the MCOIN heuristic was used to determine the most likely motif width from a range of plausible widths (±4 bp of the experimentally determined motif width). When the true motif width is unknown, the performance of MITSU is decreased slightly; the overall results on the <italic>E.</italic><italic>coli</italic> dataset and the diverse prokaryotic dataset when using the MCOIN heuristic (<italic>sSn</italic> = 0.43, <italic>sPPV</italic> = 0.68, AUC = 0.97 and <italic>sSn</italic> = 0.85, <italic>sPPV</italic> = 0.88, AUC = 1.00, respectively) show that MITSU continues to outperform both deterministic EM and SEAM in terms of <italic>sPPV</italic> and AUC, but decreases in sensitivity compared with the previous results (<xref ref-type="table" rid="btu286-T2">Tables 2</xref> and <xref ref-type="table" rid="btu286-T3">3</xref>).</p>
      </sec>
    </sec>
    <sec id="SEC4.2">
      <title>4.2 Stochastic EM escapes local maxima</title>
      <p>One major motivation for the sEM algorithm is the fact that the deterministic EM algorithm cannot be guaranteed to converge to the global maximum of the likelihood function and may instead converge to a saddle point or local maximum of the likelihood function. While sEM also cannot be guaranteed to converge to the global maximum of the likelihood function, it can be demonstrated that the stochastic perturbations of sEM allow sEM-based algorithms to escape local maxima, which trap deterministic EM-based algorithms, in a motif discovery context.</p>
      <p>We construct a dataset comprising 10 sequences of 200 nt in length, each sequence containing a single occurrence of a perfectly conserved motif of width 8 bp. As before, <italic>E.</italic><italic>coli</italic> intergenic sequences extracted from EcoGene were used as background positions. Despite the relative simplicity of the dataset, we expect that there will be a large number of local maxima in the likelihood function, corresponding to patterns that are better conserved than the background but less well conserved than the motif of interest.</p>
      <p>Energy traces for two runs of both the deterministic EM algorithm and MITSU are shown in <xref ref-type="fig" rid="btu286-F3">Figure 3</xref>. Both algorithms are initialized with the same parameter values and allowed to run to convergence. Both traces illustrate one of the major differences between deterministic and sEM: while each iteration of deterministic EM is guaranteed not to decrease the likelihood, sEM has a non-zero probability of accepting new model parameters that decrease the likelihood, to escape local maxima of the likelihood function. The top trace illustrates a case where deterministic EM converges to a local maximum at around <inline-formula><mml:math id="n52"><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>0.52</mml:mn></mml:mrow></mml:math></inline-formula>. In contrast, although sEM spends ∼40 iterations around <inline-formula><mml:math id="n53"><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>0.70</mml:mn></mml:mrow></mml:math></inline-formula>, a small jump that decreases energy at iteration 53 is followed by several iterations, which dramatically increase the energy. Using our stopping rule, sEM converges at <inline-formula><mml:math id="n54"><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>0.14</mml:mn></mml:mrow></mml:math></inline-formula>, the energy corresponding to perfect discovery of the known motif. The lower trace in <xref ref-type="fig" rid="btu286-F3">Figure 3</xref> shows a case where both algorithms converge to <inline-formula><mml:math id="n55"><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>0.14</mml:mn></mml:mrow></mml:math></inline-formula>. This trace illustrates that deterministic EM generally converges faster than sEM, which can spend a relatively large number of iterations exploring lower energies before converging. However, we see this slower convergence as a small trade-off in exchange for more accurate motif models and binding site predictions, as shown in the top energy trace.
<fig id="btu286-F3" position="float"><label>Fig. 3.</label><caption><p>Energy traces for two runs of both the deterministic EM algorithm (blue) and MITSU (red) on a synthetic dataset containing a perfectly conserved motif of width 8 bp. Algorithm convergence is marked with ‘×’ in both cases. We note that the sEM algorithm allows MITSU to escape local maxima of the likelihood function, which can trap deterministic EM (top)</p></caption><graphic xlink:href="btu286f3"/></fig></p>
    </sec>
    <sec id="SEC4.3">
      <title>4.3 MITSU successfully discovers multiple motifs in a single sequence</title>
      <p>As noted in Section 3.3, the cut heuristic in combination with the ZOOPS model allows discovery of multiple motif occurrences within a single input sequence. We present a proof of principle using the well-known CRP dataset, used by <xref rid="btu286-B5" ref-type="bibr">Bi (2007)</xref>, <xref rid="btu286-B19" ref-type="bibr">Lawrence <italic>et al.</italic> (1993)</xref> and <xref rid="btu286-B23" ref-type="bibr">Stormo and Hartzell (1989)</xref>, among others. Briefly, CRP is a prokaryotic transcription factor that is important in the regulation of genes involved in energy metabolism. The CRP dataset consists of 18 sequences, each of which is 105 nt in length. The dataset contains 24 CRP binding sites determined by footprinting experiments or sequence similarity to confirmed binding sites; each sequence in the dataset contains one or two sites. Each binding site is 22 bp in length. <xref ref-type="fig" rid="btu286-F4">Figure 4</xref> (top) shows the CRP motif sequence logo constructed from the 24 binding sites in the dataset; we note that the low conservation and gapped nature of the CRP motif increases the challenge of computational discovery.
<fig id="btu286-F4" position="float"><label>Fig. 4.</label><caption><p>CRP motif sequence logos. From top: logo constructed from the 24 binding sites contained in the CRP dataset; logo representing the motif discovered by MITSU; logo representing the motif discovered by MEME when the number of known sites was not provided</p></caption><graphic xlink:href="btu286f4"/></fig></p>
      <p>We compare MITSU against MEME and assume that the true motif width is known; both algorithms are run at this width. MITSU was run with the cut length <italic>U</italic> equal to half the length of each input sequence. The results of this test show that MITSU predicted 28 binding sites (<italic>sSn</italic> = 0.71, <italic>sPPV</italic> = 0.61, AUC = 0.99) and successfully predicted both binding sites in the CE1CG, ARA and LAC sequences. The middle logo in <xref ref-type="fig" rid="btu286-F4">Figure 4</xref> represents the motif discovered by MITSU. Based on this result, MITSU compares well with MEME, which predicted 18 binding sites and failed to discover more than one site in a sequence using the TCM model when the total number of sites was not provided (<italic>sSn</italic> = 0.71, <italic>sPPV</italic> = 0.94). Fourteen of the sites predicted by MEME were also predicted by MITSU. The bottom logo in <xref ref-type="fig" rid="btu286-F4">Figure 4</xref> represents the motif discovered by MEME when the number of known sites was not provided. This motif is shifted by 3 bp compared with the motif constructed from the known binding sites. When the total number of sites was used as additional information, MEME predicted 24 binding sites and successfully predicted both binding sites in the CE1CG, DEOP2 and MALK sequences (<italic>sSn</italic> = <italic>sPPV</italic> = 0.83). Sixteen of the sites predicted by MEME were also predicted by MITSU.</p>
      <p>Comparing the sequence logos representing the motifs discovered by MITSU and MEME shown in <xref ref-type="fig" rid="btu286-F4">Figure 4</xref>, we note that the positions in the motif discovered by MITSU are generally underweighted compared with the known motif and that the positions in the motif discovered by MEME are generally overweighted. This difference in weighting is due to the number of sites predicted by each algorithm. Both algorithms return the same number of true-positive predictions; the number of false-negative predictions is also equal, leading to identical <italic>sSn</italic> results. MITSU predicts more false-positive sites than MEME, which leads to an underweighting of the positions in the model discovered by MITSU compared with that discovered by MEME. This also provides an explanation for the decreased <italic>sPPV</italic> result (0.61 versus 0.94, respectively). While there is room for improvement, the cutting heuristic is shown to successfully reproduce the TCM model in principle without additional heuristic optimizations to improve performance.</p>
    </sec>
  </sec>
  <sec>
    <title>5 CONCLUSION</title>
    <p>Computational discovery of TFBS motifs remains an important and challenging problem in bioinformatics. MITSU is a novel algorithm for motif discovery, based on sEM. MITSU has a clear advantage over deterministic algorithms in that it is less likely to converge to insignificant local maxima of the likelihood function owing to the sEM algorithm, improving results. We show that the sEM algorithm allows MITSU to escape these local maxima and converge to models with higher energies. MITSU also has advantages over existing sEM-based motif discovery algorithms as it is unconstrained with regard to the distribution of motif occurrences within the input dataset and incorporates useful features commonly found in modern motif discovery algorithms, such as automatic determination of motif width.</p>
    <p>Results of tests on several collections of realistic synthetic data and two collections of previously characterized prokaryotic data show that MITSU consistently outperforms deterministic EM and the SEAM algorithm for motif discovery in terms of site-level positive predictive value and generally performs at least as well in terms of overall correctness of results, based on ROC analysis. We note that the results returned by MITSU also often increase site-level sensitivity. Using the well-known CRP dataset, we demonstrate that MITSU combines a cut heuristic with the ZOOPS model to effectively reproduce a TCM model without the compromise of additional ‘smoothing’ steps.</p>
    <p>Future work will implement probabilistic (or ‘soft’) erasing to discover multiple different motifs within a single dataset and will investigate exploiting the Metropolis accept/reject mechanism to incorporate relevant model-level biological knowledge. Such heuristics will be important in further optimizing performance, as is the case for established motif discovery algorithms.</p>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENT</title>
    <p>The authors thank the reviewers for their valuable comments and suggestions.</p>
    <p><italic>Funding</italic>: <funding-source>Engineering and Physical Sciences Research Council</funding-source> (<award-id>Doctoral Studentship</award-id> to A.M.K.) and the <funding-source>Biotechnology and Biological Sciences Research Council</funding-source> (grant number <award-id>BB/I023461/1</award-id> to S.A. and A.M.K.).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="btu286-B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bailey</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Elkan</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Fitting a mixture model by expectation maximization to discover motifs in biopolymers</article-title>
        <source>Proc. Int. Conf. Intel.l Syst. Mol. Biol.</source>
        <year>1994</year>
        <volume>2</volume>
        <fpage>28</fpage>
        <lpage>36</lpage>
      </element-citation>
    </ref>
    <ref id="btu286-B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bailey</surname>
            <given-names>TL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The value of position-specific priors in motif discovery using MEME</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>179</fpage>
        <pub-id pub-id-type="pmid">20380693</pub-id>
      </element-citation>
    </ref>
    <ref id="btu286-B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bembom</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Supervised detection of conserved motifs in DNA sequences with cosmo</article-title>
        <source>Stat. Appl. Genet. Mol. Biol.</source>
        <year>2007</year>
        <volume>6</volume>
        <comment>Article 8</comment>
      </element-citation>
    </ref>
    <ref id="btu286-B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bi</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>SEAM: a stochastic EM-type algorithm for motif-finding in biopolymer sequences</article-title>
        <source>J. Bioinform. Comput. Biol.</source>
        <year>2007</year>
        <volume>5</volume>
        <fpage>47</fpage>
        <lpage>77</lpage>
        <pub-id pub-id-type="pmid">17477491</pub-id>
      </element-citation>
    </ref>
    <ref id="btu286-B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bi</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>A Monte Carlo EM algorithm for <italic>de novo</italic> motif discovery in biomolecular sequences</article-title>
        <source>IEEE/ACM Trans. Comput. Biol. Bioinform.</source>
        <year>2009</year>
        <volume>6</volume>
        <fpage>370</fpage>
        <lpage>386</lpage>
        <pub-id pub-id-type="pmid">19644166</pub-id>
      </element-citation>
    </ref>
    <ref id="btu286-B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Booth</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Hobert</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>Maximizing generalized linear mixed model likelihoods with an automated Monte Carlo EM algorithm</article-title>
        <source>J. R. Stat. Soc. B Methodol.</source>
        <year>1999</year>
        <volume>61</volume>
        <fpage>265</fpage>
        <lpage>285</lpage>
      </element-citation>
    </ref>
    <ref id="btu286-B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Celeux</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>On stochastic versions of the EM algorithm</article-title>
        <year>1995</year>
        <comment><italic>Rapport de Recherche-Institut National de Recherche en Informatique et en Automatique</italic>, No 2514</comment>
      </element-citation>
    </ref>
    <ref id="btu286-B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dempster</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Maximum likelihood from incomplete data via the EM algorithm</article-title>
        <source>J. R. Stat Soc B Methodol.</source>
        <year>1977</year>
        <volume>39</volume>
        <fpage>1</fpage>
        <lpage>38</lpage>
      </element-citation>
    </ref>
    <ref id="btu286-B10">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Diebolt</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Robert</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Bayesian estimation of finite mixture distributions: part II, sampling implementation</article-title>
        <year>1990</year>
        <comment><italic>Technical Report, 111</italic>. Laboratoire de Statistique Théorique et Appliquée, Université Paris VI</comment>
      </element-citation>
    </ref>
    <ref id="btu286-B11">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Diebolt</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Robert</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Estimation of finite mixture distributions through Bayesian sampling</article-title>
        <source>J. R. Stat Soc B Methodol.</source>
        <year>1994</year>
        <volume>56</volume>
        <fpage>363</fpage>
        <lpage>375</lpage>
      </element-citation>
    </ref>
    <ref id="btu286-B12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eisen</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>All motifs are NOT created equal: structural properties of transcription factor-DNA interactions and the inference of sequence specificity</article-title>
        <source>Genome Biol.</source>
        <year>2005</year>
        <volume>6</volume>
        <fpage>P7</fpage>
      </element-citation>
    </ref>
    <ref id="btu286-B13">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gama-Castro</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RegulonDB version 7.0: transcriptional regulation of <italic>Escherichia coli</italic> K-12 integrated within genetic sensory response units (Gensor Units)</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2011</year>
        <volume>39</volume>
        <issue>Suppl. 1</issue>
        <fpage>D98</fpage>
        <lpage>D105</lpage>
        <pub-id pub-id-type="pmid">21051347</pub-id>
      </element-citation>
    </ref>
    <ref id="btu286-B14">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hu</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Limitations and potentials of current motif discovery algorithms</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2005</year>
        <volume>33</volume>
        <fpage>4899</fpage>
        <lpage>4913</lpage>
        <pub-id pub-id-type="pmid">16284194</pub-id>
      </element-citation>
    </ref>
    <ref id="btu286-B15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jank</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Stochastic variants of EM: Monte Carlo, Quasi-Monte Carlo and more</article-title>
        <source>Proc. Am. Stat. Assoc</source>
        <year>2005</year>
      </element-citation>
    </ref>
    <ref id="btu286-B16">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Keles</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Supervised detection of regulatory motifs in DNA sequences</article-title>
        <source>Stat. Appl. Genet. Mol. Biol.</source>
        <year>2003</year>
        <volume>2</volume>
        <comment>Article 5</comment>
      </element-citation>
    </ref>
    <ref id="btu286-B17">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kilpatrick</surname>
            <given-names>AM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MCOIN: a novel heuristic for determining transcription factor binding site motif width</article-title>
        <source>Algorithms Mol. Biol.</source>
        <year>2013</year>
        <volume>8</volume>
        <fpage>16</fpage>
        <pub-id pub-id-type="pmid">23806098</pub-id>
      </element-citation>
    </ref>
    <ref id="btu286-B18">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lawrence</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Reilly</surname>
            <given-names>AA</given-names>
          </name>
        </person-group>
        <article-title>An expectation maximization (EM) algorithm for the identification and characterization of common sites in unaligned biopolymer sequences</article-title>
        <source>Proteins</source>
        <year>1990</year>
        <volume>7</volume>
        <fpage>41</fpage>
        <lpage>51</lpage>
        <pub-id pub-id-type="pmid">2184437</pub-id>
      </element-citation>
    </ref>
    <ref id="btu286-B19">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lawrence</surname>
            <given-names>CE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Detecting subtle sequence signals: a Gibbs sampling strategy for multiple alignment</article-title>
        <source>Science</source>
        <year>1993</year>
        <volume>262</volume>
        <fpage>208</fpage>
        <lpage>214</lpage>
        <pub-id pub-id-type="pmid">8211139</pub-id>
      </element-citation>
    </ref>
    <ref id="btu286-B21">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rudd</surname>
            <given-names>KE</given-names>
          </name>
        </person-group>
        <article-title>EcoGene: a genome sequence database for <italic>Escherichia coli</italic> K-12</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2000</year>
        <volume>28</volume>
        <fpage>60</fpage>
        <lpage>64</lpage>
        <pub-id pub-id-type="pmid">10592181</pub-id>
      </element-citation>
    </ref>
    <ref id="btu286-B22">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Spivakov</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Analysis of variation at transcription factor binding sites in <italic>Drosophila</italic> and humans</article-title>
        <source>Genome Biol.</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>R49</fpage>
        <pub-id pub-id-type="pmid">22950968</pub-id>
      </element-citation>
    </ref>
    <ref id="btu286-B23">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stormo</surname>
            <given-names>GD</given-names>
          </name>
          <name>
            <surname>Hartzell</surname>
            <given-names>GW</given-names>
          </name>
        </person-group>
        <article-title>Identifying protein-binding sites from unaligned DNA fragments</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>1989</year>
        <volume>86</volume>
        <fpage>1183</fpage>
        <lpage>1187</lpage>
        <pub-id pub-id-type="pmid">2919167</pub-id>
      </element-citation>
    </ref>
    <ref id="btu286-B24">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tompa</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Assessing computational tools for the discovery of transcription factor binding sites</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2005</year>
        <volume>23</volume>
        <fpage>137</fpage>
        <lpage>144</lpage>
        <pub-id pub-id-type="pmid">15637633</pub-id>
      </element-citation>
    </ref>
    <ref id="btu286-B25">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wei</surname>
            <given-names>GC</given-names>
          </name>
          <name>
            <surname>Tanner</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A Monte Carlo implementation of the EM algorithm and the poor man’s data augmentation algorithms</article-title>
        <source>J. Am. Stat. Assoc.</source>
        <year>1990</year>
        <volume>85</volume>
        <fpage>699</fpage>
        <lpage>704</lpage>
      </element-citation>
    </ref>
    <ref id="btu286-B26">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Whitfield</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Functional analysis of transcription factor binding sites in human promoters</article-title>
        <source>Genome Biol.</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>R50</fpage>
        <pub-id pub-id-type="pmid">22951020</pub-id>
      </element-citation>
    </ref>
    <ref id="btu286-B27">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yip</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Classification of human genomic regions based on experimentally determined binding sites of more than 100 transcription-related factors</article-title>
        <source>Genome Biol.</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>R48</fpage>
        <pub-id pub-id-type="pmid">22950945</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
