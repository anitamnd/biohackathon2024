<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Gigascience</journal-id>
    <journal-id journal-id-type="iso-abbrev">Gigascience</journal-id>
    <journal-id journal-id-type="publisher-id">gigascience</journal-id>
    <journal-title-group>
      <journal-title>GigaScience</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2047-217X</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5863215</article-id>
    <article-id pub-id-type="doi">10.1093/gigascience/giy005</article-id>
    <article-id pub-id-type="publisher-id">giy005</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Technical Note</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>GeneSeqToFamily: a Galaxy workflow to find gene families based on the Ensembl Compara GeneTrees pipeline</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-8941-444X</contrib-id>
        <name>
          <surname>Thanki</surname>
          <given-names>Anil S</given-names>
        </name>
        <!--<email>Anil.Thanki@earlham.ac.uk</email>-->
        <xref ref-type="aff" rid="aff1"/>
        <xref ref-type="corresp" rid="cor1"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0003-3627-5340</contrib-id>
        <name>
          <surname>Soranzo</surname>
          <given-names>Nicola</given-names>
        </name>
        <xref ref-type="aff" rid="aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0003-0111-191X</contrib-id>
        <name>
          <surname>Haerty</surname>
          <given-names>Wilfried</given-names>
        </name>
        <xref ref-type="aff" rid="aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-5589-7754</contrib-id>
        <name>
          <surname>Davey</surname>
          <given-names>Robert P</given-names>
        </name>
        <xref ref-type="aff" rid="aff1"/>
      </contrib>
    </contrib-group>
    <aff id="aff1">Earlham Institute, Norwich Research Park, Norwich NR4 7UZ, UK</aff>
    <author-notes>
      <corresp id="cor1"><bold>Correspondence address.</bold> Anil S. Thanki, Earlham Institute, Norwich Research Park, Norwich, NR4 7UZ, UK. E-mail: <email>Anil.Thanki@earlham.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>3</month>
      <year>2018</year>
    </pub-date>
    <pub-date iso-8601-date="2018-02-07" pub-type="epub">
      <day>07</day>
      <month>2</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>07</day>
      <month>2</month>
      <year>2018</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>7</volume>
    <issue>3</issue>
    <elocation-id>giy005</elocation-id>
    <history>
      <date date-type="accepted">
        <day>18</day>
        <month>1</month>
        <year>2018</year>
      </date>
      <date date-type="received">
        <day>30</day>
        <month>3</month>
        <year>2017</year>
      </date>
      <date date-type="rev-recd">
        <day>31</day>
        <month>7</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Authors 2018. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2018</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="giy005.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="abs1">
        <title>Background</title>
        <p>Gene duplication is a major factor contributing to evolutionary novelty, and the contraction or expansion of gene families has often been associated with morphological, physiological, and environmental adaptations. The study of homologous genes helps us to understand the evolution of gene families. It plays a vital role in finding ancestral gene duplication events as well as identifying genes that have diverged from a common ancestor under positive selection. There are various tools available, such as MSOAR, OrthoMCL, and HomoloGene, to identify gene families and visualize syntenic information between species, providing an overview of syntenic regions evolution at the family level. Unfortunately, none of them provide information about structural changes within genes, such as the conservation of ancestral exon boundaries among multiple genomes. The Ensembl GeneTrees computational pipeline generates gene trees based on coding sequences, provides details about exon conservation, and is used in the Ensembl Compara project to discover gene families.</p>
      </sec>
      <sec id="abs2">
        <title>Findings</title>
        <p>A certain amount of expertise is required to configure and run the Ensembl Compara GeneTrees pipeline via command line. Therefore, we converted this pipeline into a Galaxy workflow, called GeneSeqToFamily, and provided additional functionality. This workflow uses existing tools from the Galaxy ToolShed, as well as providing additional wrappers and tools that are required to run the workflow.</p>
      </sec>
      <sec id="abs3">
        <title>Conclusions</title>
        <p>GeneSeqToFamily represents the Ensembl GeneTrees pipeline as a set of interconnected Galaxy tools, so they can be run interactively within the Galaxy's user-friendly workflow environment while still providing the flexibility to tailor the analysis by changing configurations and tools if necessary. Additional tools allow users to subsequently visualize the gene families produced by the workflow, using the Aequatus.js interactive tool, which has been developed as part of the Aequatus software project.</p>
      </sec>
    </abstract>
    <kwd-group kwd-group-type="keywords">
      <kwd>Galaxy</kwd>
      <kwd>Pipeline</kwd>
      <kwd>Workflow</kwd>
      <kwd>Genomics</kwd>
      <kwd>Comparative Genomics</kwd>
      <kwd>Homology</kwd>
      <kwd>Orthology</kwd>
      <kwd>Paralogy</kwd>
      <kwd>Phylogeny</kwd>
      <kwd>Gene Family</kwd>
      <kwd>Alignment</kwd>
      <kwd>Compara</kwd>
      <kwd>Ensembl</kwd>
    </kwd-group>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="sec1">
    <title>Introduction</title>
    <p>The phylogenetic information inferred from the study of homologous genes helps us to understand the evolution of gene families (also referred to as “orthogroups”) that comprise genes sharing common descent [<xref rid="bib1" ref-type="bibr">1</xref>]. This plays a vital role in finding ancestral gene duplication events as well as in identifying regions under positive selection within species [<xref rid="bib2" ref-type="bibr">2</xref>]. In order to investigate these low-level comparisons between gene families, the Ensembl Compara GeneTrees gene orthology and paralogy prediction software suite [<xref rid="bib3" ref-type="bibr">3</xref>] was developed as a pipeline. The Ensembl GeneTrees pipeline uses TreeBest [<xref rid="bib4" ref-type="bibr">4</xref>, <xref rid="bib5" ref-type="bibr">5</xref>] (part of TreeFam [<xref rid="bib6" ref-type="bibr">6</xref>]), which implements multiple independent phylogenetic methods and can merge the results into a consensus tree while trying to minimize duplications and deletions relative to a known species tree. This allows TreeBeST to take advantage of the fact that DNA-based methods are often more accurate for closely related parts of trees, while protein-based trees are better at longer evolutionary distances.</p>
    <p>The Ensembl GeneTrees pipeline comprises 7 steps, starting from a set of protein sequences and performing similarity searching and multiple large-scale alignments to infer homology among them, using various tools: BLAST [<xref rid="bib7" ref-type="bibr">7</xref>], hcluster_sg [<xref rid="bib8" ref-type="bibr">8</xref>], T-Coffee [<xref rid="bib9" ref-type="bibr">9</xref>], and phylogenetic tree construction tools, including TreeBeST. While these tools are freely available, most are specific to certain computing environments, are only usable via the command line, and require many dependencies to be fulfilled. Therefore, users are not always sufficiently expert in system administration to install, run, and debug the various tools at each stage in a chain of processes. To help ease the complexity of running the GeneTrees pipeline, we employed the Galaxy bioinformatics analysis platform to relieve the burden of managing these system-level challenges.</p>
    <p>Galaxy is an open-source framework for running a broad collection of bioinformatics tools via a user-friendly web interface [<xref rid="bib10" ref-type="bibr">10</xref>]. No client software is required other than a recent web browser, and users are able to run tools singly or aggregated into interconnected pipelines, called “workflows”. Galaxy enables users to not only create but also share workflows with the community. In this way, it helps users who have little or no bioinformatics expertise to run potentially complex pipelines in order to analyze their own data and interrogate results within a single online platform. Furthermore, pipelines can be published in a scientific paper or in a repository such as myExperiment [<xref rid="bib11" ref-type="bibr">11</xref>] to encourage transparency and reproducibility.</p>
    <p>In addition to analytical tools, Galaxy also contains plugins [<xref rid="bib12" ref-type="bibr">12</xref>] for data visualization. Galaxy visualization plugins may be interactive and can be configured to visualize various data types, for example, bar plots, scatter plots, and phylogenetic trees. It is also possible to develop custom visualization plugins and easily integrate them into Galaxy. As the output of the GeneSeqToFamily workflow is not conducive to human readability, we also provide a data-to-visualization plugin based on the Aequatus software [<xref rid="bib13" ref-type="bibr">13</xref>]. Aequatus.js [<xref rid="bib14" ref-type="bibr">14</xref>] is a new JavaScript library for the visualization of homologous genes that we extracted from the standalone Aequatus software. It provides a detailed view of gene structure across gene families, including shared exon information within gene families alongside gene tree representations. It also shows details about the type of interrelation event that gave rise to the family, such as speciation, duplication, and gene splits.</p>
  </sec>
  <sec sec-type="methods" id="sec2">
    <title>Methods</title>
    <p>The GeneSeqToFamily workflow has been developed to run the Ensembl Compara software suite within the Galaxy environment (Galaxy, <ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/RRID:SCR_006281">RRID:SCR_006281</ext-link>), combining various tools alongside preconfigured parameters obtained from the Ensembl Compara pipeline to produce gene trees. Among the tools used in GeneSeqToFamily (listed in Table <xref ref-type="table" rid="tbl1">1</xref>), some were existing tools in the Galaxy ToolShed [<xref rid="bib15" ref-type="bibr">15</xref>], such as NCBI BLAST (NCBI BLAST, <ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/RRID:SCR_004870">RRID:SCR_004870</ext-link>), TranSeq (Transeq, <ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/RRID:SCR_015647">RRID:SCR_015647</ext-link>), Tranalign, and various format converters. Additional tools that are part of the pipeline were developed at the Earlham Institute (EI) and submitted to the ToolShed, that is, <italic>BLAST parser, hcluster_sg, hcluster_sg parser, T-Coffee, TreeBeST best</italic>, and <italic>Gene Alignment and Family Aggregator.</italic> Finally, we developed helper tools that are not part of the workflow itself but aid the generation of input data for the workflow, and these are also in the ToolShed, i.e. <italic>Get features by Ensembl ID, Get sequences by Ensembl ID, Select longest CDS per gene, ETE species tree generator</italic>, and <italic>GeneSeqToFamily preparation</italic>.</p>
    <table-wrap id="tbl1" orientation="portrait" position="float">
      <label>Table 1:</label>
      <caption>
        <p>Galaxy tools used in the workflow</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <th align="left" rowspan="1" colspan="1"/>
            <th align="left" rowspan="1" colspan="1"/>
            <th align="center" rowspan="1" colspan="1"/>
            <th align="center" colspan="2" rowspan="1">Developed at Earlham Institute</th>
            <th align="left" rowspan="1" colspan="1">Toolsheds</th>
          </tr>
          <tr>
            <th align="left" rowspan="1" colspan="1">Tool name</th>
            <th align="left" rowspan="1" colspan="1">Tool ID</th>
            <th align="left" rowspan="1" colspan="1">Version</th>
            <th align="left" rowspan="1" colspan="1">Tool</th>
            <th align="left" rowspan="1" colspan="1">Wrapper</th>
            <th align="left" rowspan="1" colspan="1">reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">Get sequences by Ensembl ID</td>
            <td rowspan="1" colspan="1">get_sequences</td>
            <td rowspan="1" colspan="1">0.1.2</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">[<xref rid="bib17" ref-type="bibr">17</xref>]</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Get features by Ensembl ID</td>
            <td rowspan="1" colspan="1">get_feature_info</td>
            <td rowspan="1" colspan="1">0.1.2</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">[<xref rid="bib18" ref-type="bibr">18</xref>]</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Select longest coding sequence per gene</td>
            <td rowspan="1" colspan="1">ensembl_longest_cds_per_gene</td>
            <td rowspan="1" colspan="1">0.0.2</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">[<xref rid="bib19" ref-type="bibr">19</xref>]</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">ETE species tree generator</td>
            <td rowspan="1" colspan="1">ete_species_tree_generator</td>
            <td rowspan="1" colspan="1">3.0.0b35</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">[<xref rid="bib20" ref-type="bibr">20</xref>]</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">GeneSeqToFamily preparation</td>
            <td rowspan="1" colspan="1">gstf_preparation</td>
            <td rowspan="1" colspan="1">0.4.0</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">[<xref rid="bib21" ref-type="bibr">21</xref>]</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Transeq</td>
            <td rowspan="1" colspan="1">EMBOSS: transeq101</td>
            <td rowspan="1" colspan="1">5.0.0</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">[<xref rid="bib22" ref-type="bibr">22</xref>]</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">NCBI BLAST+ makeblastdb</td>
            <td rowspan="1" colspan="1">ncbi_makeblastdb</td>
            <td rowspan="1" colspan="1">0.2.01</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">[<xref rid="bib23" ref-type="bibr">23</xref>]</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">NCBI BLAST+ blastp</td>
            <td rowspan="1" colspan="1">ncbi_blastp_wrapper</td>
            <td rowspan="1" colspan="1">0.2.01</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">[<xref rid="bib23" ref-type="bibr">23</xref>]</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">BLAST parser</td>
            <td rowspan="1" colspan="1">blast_parser</td>
            <td rowspan="1" colspan="1">0.1.2</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">[<xref rid="bib24" ref-type="bibr">24</xref>]</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">hcluster_sg</td>
            <td rowspan="1" colspan="1">hcluster_sg</td>
            <td rowspan="1" colspan="1">0.5.1.1</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">[<xref rid="bib25" ref-type="bibr">25</xref>]</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">hcluster_sg parser</td>
            <td rowspan="1" colspan="1">hcluster_sg_parser</td>
            <td rowspan="1" colspan="1">0.2.0</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">[<xref rid="bib26" ref-type="bibr">26</xref>]</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Filter by FASTA IDs</td>
            <td rowspan="1" colspan="1">filter_by_fasta_ids</td>
            <td rowspan="1" colspan="1">1.0</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">[<xref rid="bib27" ref-type="bibr">27</xref>]</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">T-Coffee</td>
            <td rowspan="1" colspan="1">t_coffee</td>
            <td rowspan="1" colspan="1">11.0.8</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">[<xref rid="bib28" ref-type="bibr">28</xref>]</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Tranalign</td>
            <td rowspan="1" colspan="1">EMBOSS: tranalign100</td>
            <td rowspan="1" colspan="1">5.0.0</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">[<xref rid="bib22" ref-type="bibr">22</xref>]</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">TreeBeST best</td>
            <td rowspan="1" colspan="1">treebest_best</td>
            <td rowspan="1" colspan="1">1.9.2</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">[<xref rid="bib29" ref-type="bibr">29</xref>]</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Gene Alignment and Family Aggregator</td>
            <td rowspan="1" colspan="1">gafa</td>
            <td rowspan="1" colspan="1">0.3.0</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">Yes</td>
            <td rowspan="1" colspan="1">[<xref rid="bib30" ref-type="bibr">30</xref>]</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Unique</td>
            <td rowspan="1" colspan="1">tp_sorted_uniq</td>
            <td rowspan="1" colspan="1">1.1.0</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">[<xref rid="bib31" ref-type="bibr">31</xref>]</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">FASTA-to-Tabular</td>
            <td rowspan="1" colspan="1">fasta2tab</td>
            <td rowspan="1" colspan="1">1.1.0</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">[<xref rid="bib32" ref-type="bibr">32</xref>]</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">UniProt ID mapping and retrieval</td>
            <td rowspan="1" colspan="1">uniprot_rest_interface</td>
            <td rowspan="1" colspan="1">0.1</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">No</td>
            <td rowspan="1" colspan="1">[<xref rid="bib33" ref-type="bibr">33</xref>]</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <p>The workflow comprises 7 main steps (see Figure <xref ref-type="fig" rid="fig1">1</xref>), starting with translation from input coding sequences (CDS) to protein sequences, finding subsequent pairwise alignments of those protein sequences using BLASTP, and then the generation of clusters from the alignments using hcluster_sg. The workflow then splits into 2 simultaneous paths, whereby in one path it performs the multiple sequence alignment (MSA) for each cluster using T-Coffee (T-Coffee, <ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/RRID:SCR_011818">RRID:SCR_011818</ext-link>), while in the other it generates a gene tree with TreeBeST taking the cluster alignment and a species tree as input. Finally, these paths merge to aggregate the MSA, the gene tree, and the gene feature information (eg, transcripts, exons) into an SQLite [<xref rid="bib16" ref-type="bibr">16</xref>] database for visualization and downstream reuse. All the workflow and data preparation steps are shown in Figure <xref ref-type="fig" rid="fig2">2</xref> and explained in detail below.</p>
  </sec>
  <sec id="sec3">
    <title>Data generation and preparation</title>
    <p>We developed a number of tools that assist in preparing the datasets needed by the workflows.</p>
    <sec id="sec3-1">
      <title/>
      <sec id="sec3-1-1">
        <title>Ensembl REST API tools</title>
        <p>Galaxy tools were developed that use the Ensembl REST API [<xref rid="bib34" ref-type="bibr">34</xref>] to retrieve sequence information (<italic>Get sequences by Ensembl ID</italic>) and feature information (<italic>Get features by Ensembl ID</italic>) by Ensembl ID from the Ensembl service. REST (REpresentational State Transfer) is an architecture style for designing networked applications [<xref rid="bib35" ref-type="bibr">35</xref>] that encourages the use of standardized HTTP technology to send and receive data between computers. As such, these tools are designed to help users to retrieve existing data from Ensembl rather than requiring them to manually download datasets to their own computers and then subsequently uploading them into the workflow.</p>
      </sec>
      <sec id="sec3-1-2">
        <title>ETE tools</title>
        <p>We have developed the <italic>ETE species tree generator</italic> Galaxy tool, which uses the ETE toolkit [<xref rid="bib36" ref-type="bibr">36</xref>] to generate a species tree from a list of species names or taxon IDs through the NCBI Taxonomy.</p>
      </sec>
    </sec>
  </sec>
  <sec id="sec4">
    <title>GeneSeqToFamily workflow</title>
    <sec id="sec4-1">
      <title>0. GeneSeqToFamily preparation</title>
      <p>Before GeneSeqToFamily can be run, a data preparation step must be carried out. We developed a tool called <italic>GeneSeqToFamily preparation</italic> to preprocess the input datasets (gene feature information and CDS) for the GeneSeqToFamily workflow. It converts a set of gene feature information files in GFF3 [<xref rid="bib37" ref-type="bibr">37</xref>] and/or JavaScript Object Notation (JSON) [<xref rid="bib38" ref-type="bibr">38</xref>] format to an SQLite database. It also modifies all CDS FASTA header lines by appending the species name to the transcript identifier, as required by <italic>TreeBeST best</italic>. It can also retain only the longest CDS sequence for each gene, as done in the GeneTrees pipeline.</p>
      <p>We decided to use an SQLite database to store the gene feature information because the GFF3 format has a relatively inconvenient and unstructured additional information field (9th column) and because searching is much faster and more memory efficient in a database than in a text file like JSON or GFF3, especially when dealing with feature information for multiple large genomes.</p>
    </sec>
    <sec id="sec4-2">
      <title>1. CDS translation</title>
      <sec id="sec4-2-1">
        <title>Transeq</title>
        <p>Transeq, part of the European Molecular Biology Open Software Suite (EMBOSS) (EMBOSS, <ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/RRID:SCR_008493">RRID:SCR_008493</ext-link>) [<xref rid="bib39" ref-type="bibr">39</xref>], is a tool to generate 6-frame translation of nucleic acid sequences to their corresponding peptide sequences. Here, we use Transeq to convert a CDS to protein sequences in order to run BLASTP (BLASTP, <ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/RRID:SCR_001010">RRID:SCR_001010</ext-link>) and find protein clusters. However, since downstream tools in the pipeline, such as TreeBeST, require nucleotide sequences to generate a gene tree, the protein sequences cannot be directly used as workflow input and are instead generated with Transeq.</p>
      </sec>
    </sec>
    <sec id="sec4-3">
      <title>2. Preclustering alignment</title>
      <sec id="sec4-3-1">
        <title>BLAST</title>
        <p>This workflow uses the BLAST wrappers [<xref rid="bib40" ref-type="bibr">40</xref>] developed to run BLAST+ tools within Galaxy. BLASTP is run over the set of sequences against the database of the same input, as is the case with BLAST-all, in order to form clusters of related sequences.</p>
      </sec>
      <sec id="sec4-3-2">
        <title>BLAST parser</title>
        <p>BLAST parser is a small Galaxy tool to convert the BLAST output into the input format required by hcluster_sg. It takes the BLAST 12-column output [<xref rid="bib41" ref-type="bibr">41</xref>] as input and generates a 3-column tabular file, comprising the BLAST query, the hit result, and the edge weight. The weight value is simply calculated as minus log<sub>10</sub> of the BLAST e-value divided by 2, replacing this with 100 if this value is greater than 100. It also removes the self-matching BLAST results and lets the user filter out non-Reciprocal Best Hits.</p>
      </sec>
    </sec>
    <sec id="sec4-4">
      <title>3. Cluster generation</title>
      <sec id="sec4-4-1">
        <title>hcluster_sg</title>
        <p>hcluster_sg performs clustering for sparse graphs. It reads an input file that describes the similarity between 2 sequences, and iterates through the process of grouping 2 nearest nodes at each iteration. hcluster_sg outputs a single list of gene clusters, each comprising a set of sequence IDs present in that cluster. This list needs to be reformatted using the <italic>hcluster_sg parser</italic> tool in order to be suitable for input into T-Coffee and TreeBeST (see below).</p>
      </sec>
      <sec id="sec4-4-2">
        <title>hcluster_sg parser</title>
        <p>hcluster_sg parser converts the hcluster_sg output into a collection of lists of IDs, 1 list for each cluster. Each of these clusters will then be used to generate a gene tree via TreeBeST. The tool can also filter out clusters with a number of elements outside a specified range. The IDs contained in all discarded clusters are collected in separate output dataset. Since TreeBeST requires at least 3 genes to generate a gene tree, we configured the tool to filter out clusters with less than 3 genes.</p>
        <p><italic>Filter by FASTA IDs</italic>, which is available from the Galaxy ToolShed, is used to create separate FASTA files using the sequence IDs listed in each gene cluster.</p>
      </sec>
    </sec>
    <sec id="sec4-5">
      <title>4. Cluster alignment</title>
      <sec id="sec4-5-1">
        <title>T-Coffee</title>
        <p>T-Coffee is a MSA package but can also be used to combine the output of other alignment methods (Clustal, MAFFT, Probcons, MUSCLE) into a single alignment. T-Coffee can align both nucleotide and protein sequences [<xref rid="bib9" ref-type="bibr">9</xref>]. We use it to align the protein sequences in each cluster generated by hcluster_sg.</p>
        <p>We modified the Galaxy wrapper for T-Coffee to take a single FASTA (as normal) and an optional list of FASTA IDs to filter. If a list of IDs is provided, the wrapper will pass only those sequences to T-Coffee, which will perform the MSA for that set of sequences, thus removing the need to create thousands of intermediate Galaxy datasets.</p>
      </sec>
    </sec>
    <sec id="sec4-6">
      <title>5. Gene tree construction</title>
      <sec id="sec4-6-1">
        <title>Tranalign</title>
        <p>Tranalign [<xref rid="bib39" ref-type="bibr">39</xref>] is a tool that reads a set of nucleotide sequences and a corresponding aligned set of protein sequences and returns a set of aligned nucleotide sequences. Here, we use it to generate CDS alignments of gene sequences using the protein alignments produced by T-Coffee.</p>
      </sec>
      <sec id="sec4-6-2">
        <title>TreeBeST “best”</title>
        <p>TreeBeST (Tree Building guided by Species Tree) is a tool to generate, manipulate, and display phylogenetic trees and can be used to build gene trees based on a known species tree.</p>
        <p>The “best” command of TreeBeST builds 5 different gene trees from a FASTA alignment file using different phylogenetic algorithms, then merges them into a single consensus tree using a species tree as a reference. In GeneSeqToFamily, <italic>TreeBeST “best”</italic> uses the nucleotide MSAs generated by Tranalign (at least 3 sequences are required) and a user-supplied species tree in Newick format [<xref rid="bib42" ref-type="bibr">42</xref>] (either produced by a third-party software or through the <italic>ETE species tree generator</italic> data preparation tool, described above) to produce a GeneTree for each family, represented also in Newick format. The resulting GeneTree also includes useful annotations specifying phylogenetic information of events responsible for the presence/absence of genes, for example, “S” means speciation event, “D” means duplication, and “DCS” denotes the duplication score.</p>
      </sec>
    </sec>
    <sec id="sec4-7">
      <title>6. Gene alignment and family aggregation</title>
      <sec id="sec4-7-1">
        <title>Gene alignment and family aggregator </title>
        <p>Gene alignment and family aggregator (<italic>GAFA</italic>) is a Galaxy tool that generates a single SQLite database containing the gene trees and MSAs, along with gene features, in order to provide a reusable, persistent data store for visualization of synteny information with Aequatus. <italic>GAFA</italic> requires gene trees in Newick format, the protein MSAs in fasta_aln format from <italic>T-Coffee</italic>, and gene feature information generated with the <italic>GeneSeqToFamily preparation</italic> tool.</p>
        <p>Internally, <italic>GAFA</italic> converts each MSA from fasta_aln format to a simple CIGAR string [<xref rid="bib43" ref-type="bibr">43</xref>]. An example of CIGAR strings for aligned sequences is shown in Figure <xref ref-type="fig" rid="fig3">3</xref>, in which each CIGAR string changes according to other sequences.</p>
        <fig id="fig1" orientation="portrait" position="float">
          <label>Figure 1:</label>
          <caption>
            <p>Overview of the GeneSeqToFamily workflow.</p>
          </caption>
          <graphic xlink:href="giy005fig1"/>
        </fig>
        <fig id="fig2" orientation="portrait" position="float">
          <label>Figure 2:</label>
          <caption>
            <p>Screenshot from the Galaxy Workflow Editor showing the GeneSeqToFamily workflow.</p>
          </caption>
          <graphic xlink:href="giy005fig2"/>
        </fig>
        <fig id="fig3" orientation="portrait" position="float">
          <label>Figure 3:</label>
          <caption>
            <p>Showing how CIGAR for multiple sequence alignment is generated.</p>
          </caption>
          <graphic xlink:href="giy005fig3"/>
        </fig>
        <p>The simple schema [<xref rid="bib44" ref-type="bibr">44</xref>] for the generated SQLite database is shown in Figure <xref ref-type="fig" rid="fig4">4</xref>.</p>
        <fig id="fig4" orientation="portrait" position="float">
          <label>Figure 4:</label>
          <caption>
            <p>Schema of the gene alignment and family aggregator (GAFA) SQLite database, where transcript_species is a database view.</p>
          </caption>
          <graphic xlink:href="giy005fig4"/>
        </fig>
      </sec>
    </sec>
    <sec id="sec4-8">
      <title>7. Visualization</title>
      <sec id="sec4-8-1">
        <title>Aequatus visualization plugin</title>
        <p>The SQLite database generated by the GAFA tool can be rendered using a new visualization plugin, Aequatus.js. The Aequatus.js library, developed as part of the Aequatus project, has been configured to be used within Galaxy to visualize homologous gene structure and gene family relationships. This allows users to interrogate not only the evolutionary history of the gene family but also the structural variation (exon gain/loss) within genes across the phylogeny. Aequatus.js is available to download from GitHub [<xref rid="bib44" ref-type="bibr">44</xref>], as visualization plugins cannot yet be submitted to the Galaxy ToolShed.</p>
      </sec>
    </sec>
  </sec>
  <sec id="sec5">
    <title>Finding homology information for orphan genes</title>
    <p>Although the GeneSeqToFamily workflow will assign most of the genes to orthogroups, many genes within a species might appear to be unique without homologous relationship to any other genes from other species. This observation could be the consequence of the parameters selected, choice of species, or incomplete annotations. This could also reflect real absence of homology, such as for rapidly evolving gene families. In addition to the GeneSeqToFamily workflow, we also developed 2 associated workflows to further annotate these genes by:
<list list-type="simple" id="lst1"><list-item><p>1) Retrieving a list of orphan genes from the GeneSeqToFamily workflow (see Figure <xref ref-type="fig" rid="fig5">5</xref>) as follows:
<list list-type="simple"><list-item><p>a) Find the IDs of the sequences present in the input CDS of the GeneSeqToFamily workflow but not in the result of <italic>BLAST parser</italic> from the same workflow.</p></list-item><list-item><p>b) Add to this list the IDs of the sequences discarded by <italic>hcluster_sg parser</italic>.</p></list-item><list-item><p>c) From the input CDS dataset, retrieve the respective sequence for each CDS ID (from the step above) using <italic>Filter by FASTA IDs</italic>.</p></list-item></list></p></list-item></list></p>
    <fig id="fig5" orientation="portrait" position="float">
      <label>Figure 5:</label>
      <caption>
        <p>Screenshot from the Galaxy Workflow Editor showing the orphan gene finding workflow.</p>
      </caption>
      <graphic xlink:href="giy005fig5"/>
    </fig>
    <p>These unique CDS can be fed into the SwissProt workflow below to find homologous genes in other species.
<list list-type="simple" id="lst3"><list-item><p>2) Finding homologous genes for some genes of interest using SwissProt (see Figure <xref ref-type="fig" rid="fig6">6</xref>) as follows:
<list list-type="simple"><list-item><p>a) Translate CDS into protein sequences using <italic>Transeq</italic>.</p></list-item><list-item><p>b) Run BLASTP for the protein sequences against the SwissProt database (from NCBI).</p></list-item><list-item><p>c) Extract UniProt IDs from these BLASTP results, using the preinstalled Galaxy tool <italic>Cut columns from a table</italic> (tool id <italic>Cut1</italic>).</p></list-item><list-item><p>d) Retrieve Ensembl IDs (representing genes and/or transcripts) for each UniProt ID using <italic>UniProt ID mapping and retrieval</italic>.</p></list-item><list-item><p>e) Get genomic information for each gene ID and CDS for each transcript ID from the core Ensembl database using <italic>Get features by Ensembl ID</italic> and <italic>Get sequences by Ensembl ID</italic>, respectively.</p></list-item></list></p></list-item></list></p>
    <fig id="fig6" orientation="portrait" position="float">
      <label>Figure 6:</label>
      <caption>
        <p>Screenshot from the Galaxy Workflow Editor showing the SwissProt workflow.</p>
      </caption>
      <graphic xlink:href="giy005fig6"/>
    </fig>
    <p>The results from this second workflow can be subsequently used as input to GeneSeqToFamily for familial analysis.</p>
  </sec>
  <sec sec-type="results" id="sec6">
    <title>Results</title>
    <p>To validate the biological relevance of results from the GeneSeqToFamily workflow, we analyzed a small set of 23 homologous genes (1 transcript per gene) from <italic>Pan troglodytes</italic> (chimpanzee), <italic>Homo sapiens</italic> (human), <italic>Rattus norvegicus</italic> (rat), <italic>Mus musculus</italic> (mouse), <italic>Sus scrofa</italic> (pig), and <italic>Canis familiaris</italic> (domesticated dog). These genes are a combination of those found in 3 gene families, that is, monoamine oxidases (MAO A and B), insulin receptor (INSR), and BRCA2, and were chosen because they are present in all 6 species yet distinct from each other.</p>
    <p>Before running the workflow, feature information and CDS for the selected genes were retrieved from the core Ensembl database using the helper tools described above (<italic>Get features by Ensembl ID</italic> and <italic>Get sequences by Ensembl ID</italic>, respectively), and CDS were filtered to keep the longest CDS per gene. A species tree was generated using <italic>ETE species tree generator</italic>, and inputs were prepared with <italic>GeneSeqToFamily preparation</italic>.</p>
    <p>We ran the GeneSeqToFamily workflow on these data using the default parameters of the Ensembl Compara pipeline (Table <xref ref-type="table" rid="tbl2">2</xref>, experiment D). This workflow generated 3 different gene trees, each matching exactly 1 gene family. Figures <xref ref-type="fig" rid="fig7">7</xref>–<xref ref-type="fig" rid="fig9">9</xref> show the resulting gene trees for MAO, BRCA2, and INSR gene families. Different colors of the nodes in each gene tree on the left-hand side of the visualization highlight potential evolutionary events, such as speciation, duplication, and gene splits. Homologous genes showing shared exons use the same color in each representation, including insertions (black blocks) and deletions (red lines). The GeneTrees for these genes are already available in Ensembl; we used them to validate our findings [<xref rid="bib45" ref-type="bibr">45–48</xref>]. Our gene trees agree perfectly with the Ensembl GeneTrees, showing that the workflow generates biologically valid results. We have provided the underlying data for this example along with the submitted workflow in figshare [<xref rid="bib49" ref-type="bibr">49</xref>].</p>
    <fig id="fig7" orientation="portrait" position="float">
      <label>Figure 7:</label>
      <caption>
        <p>Homologous genes of monoamine oxidase (MAO) of <italic>Canis familiaris</italic> from <italic>Mus musculus, Pan troglodytes, Homo sapiens, Rattus norvegicus, Sus scrofa</italic>, and <italic>Canis familiaris</italic>.</p>
      </caption>
      <graphic xlink:href="giy005fig7"/>
    </fig>
    <fig id="fig8" orientation="portrait" position="float">
      <label>Figure 8:</label>
      <caption>
        <p>Homologous genes of BRCA2 of <italic>Canis familiaris</italic> from <italic>Mus musculus, Pan troglodytes, Homo sapiens, Rattus norvegicus</italic>, and <italic>Sus scrofa</italic>.</p>
      </caption>
      <graphic xlink:href="giy005fig8"/>
    </fig>
    <fig id="fig9" orientation="portrait" position="float">
      <label>Figure 9:</label>
      <caption>
        <p>Homologous genes of insulin receptor (INSR) of <italic>Mus musculus</italic> from <italic>Pan troglodytes, Homo sapiens, Rattus norvegicus</italic>, and <italic>Sus scrofa</italic>.</p>
      </caption>
      <graphic xlink:href="giy005fig9"/>
    </fig>
    <table-wrap id="tbl2" orientation="portrait" position="float">
      <label>Table 2:</label>
      <caption>
        <p>Set of parameters used in BLASTP and hcluster_sg to compare results</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <th align="left" rowspan="1" colspan="1"/>
            <th align="center" rowspan="1" colspan="1"/>
            <th align="center" colspan="6" rowspan="1">Parameter set</th>
          </tr>
          <tr>
            <th align="left" rowspan="1" colspan="1">Tool</th>
            <th align="left" rowspan="1" colspan="1">Parameter</th>
            <th align="left" rowspan="1" colspan="1">A</th>
            <th align="left" rowspan="1" colspan="1">B</th>
            <th align="left" rowspan="1" colspan="1">C</th>
            <th align="left" rowspan="1" colspan="1">D</th>
            <th align="left" rowspan="1" colspan="1">E</th>
            <th align="left" rowspan="1" colspan="1">F</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">BLASTP</td>
            <td rowspan="1" colspan="1">Expectation value cutoff</td>
            <td rowspan="1" colspan="1">1e-03</td>
            <td rowspan="1" colspan="1">1e-03</td>
            <td rowspan="1" colspan="1">1e-03</td>
            <td rowspan="1" colspan="1">1e-10</td>
            <td rowspan="1" colspan="1">1e-10</td>
            <td rowspan="1" colspan="1">1e-10</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">Query coverage per hsp</td>
            <td rowspan="1" colspan="1">0</td>
            <td rowspan="1" colspan="1">0</td>
            <td rowspan="1" colspan="1">90</td>
            <td rowspan="1" colspan="1">0</td>
            <td rowspan="1" colspan="1">0</td>
            <td rowspan="1" colspan="1">90</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">hcluster_sg</td>
            <td rowspan="1" colspan="1">Minimum edge weight</td>
            <td rowspan="1" colspan="1">0</td>
            <td rowspan="1" colspan="1">20</td>
            <td rowspan="1" colspan="1">0</td>
            <td rowspan="1" colspan="1">0</td>
            <td rowspan="1" colspan="1">20</td>
            <td rowspan="1" colspan="1">20</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1"/>
            <td rowspan="1" colspan="1">Minimum edge density between a join</td>
            <td rowspan="1" colspan="1">0.34</td>
            <td rowspan="1" colspan="1">0.50</td>
            <td rowspan="1" colspan="1">0.34</td>
            <td rowspan="1" colspan="1">0.34</td>
            <td rowspan="1" colspan="1">0.50</td>
            <td rowspan="1" colspan="1">0.50</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <fn id="tb2fn1">
          <p>BLASTP was configured with maximum number of HSPs set to 1, and hcluster_sg with single link clusters set to “no” and maximum size set to 500.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>We also studied the impact of the most important tool parameters on the gene families reconstructed by the workflow by running it on larger datasets, in particular, the reference proteomes of 754,149 sequences from 66 species established by the Quest for Orthologs (QfO) consortium [<xref rid="bib50" ref-type="bibr">50</xref>]. We ran GeneSeqToFamily (up to the hcluster_sg step, where gene families are determined) with various sets of parameters (shown in Table <xref ref-type="table" rid="tbl2">2</xref>) and performed statistical analysis on the resulting gene families (Table <xref ref-type="table" rid="tbl3">3</xref>). Our results show that the number of gene families can vary quite distinctly with different BLASTP and hcluster_sg parameters. Stringent parameters (Parameter Set F) result in a large number of smaller families, while relaxed parameters (Parameter Set A) generate a small number of larger families, which may include distantly related genes. The parameters used by Ensembl Compara as default are shown in Parameter Set D.</p>
    <table-wrap id="tbl3" orientation="portrait" position="float">
      <label>Table 3:</label>
      <caption>
        <p>Results of the GeneSeqToFamily workflow run with 7 different sets of parameters, the complete list of which are shown in Table <xref ref-type="table" rid="tbl2">2</xref></p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <th align="center" colspan="7" rowspan="1">Summary</th>
          </tr>
          <tr>
            <th align="left" rowspan="1" colspan="1">Analysis</th>
            <th align="left" rowspan="1" colspan="1">A</th>
            <th align="left" rowspan="1" colspan="1">B</th>
            <th align="left" rowspan="1" colspan="1">C</th>
            <th align="left" rowspan="1" colspan="1">D</th>
            <th align="left" rowspan="1" colspan="1">E</th>
            <th align="left" rowspan="1" colspan="1">F</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">Number of genes</td>
            <td rowspan="1" colspan="1">754,149</td>
            <td rowspan="1" colspan="1">754,149</td>
            <td rowspan="1" colspan="1">754,149</td>
            <td rowspan="1" colspan="1">754,149</td>
            <td rowspan="1" colspan="1">754,149</td>
            <td rowspan="1" colspan="1">754,149</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Number of families</td>
            <td rowspan="1" colspan="1">58,272</td>
            <td rowspan="1" colspan="1">74,252</td>
            <td rowspan="1" colspan="1">83,900</td>
            <td rowspan="1" colspan="1">63,289</td>
            <td rowspan="1" colspan="1">74,309</td>
            <td rowspan="1" colspan="1">79,879</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Number of larger families (&gt;200)</td>
            <td rowspan="1" colspan="1">435</td>
            <td rowspan="1" colspan="1">168</td>
            <td rowspan="1" colspan="1">56</td>
            <td rowspan="1" colspan="1">350</td>
            <td rowspan="1" colspan="1">167</td>
            <td rowspan="1" colspan="1">46</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Number of smaller families (&lt;3)</td>
            <td rowspan="1" colspan="1">30,563</td>
            <td rowspan="1" colspan="1">40,530</td>
            <td rowspan="1" colspan="1">44,295</td>
            <td rowspan="1" colspan="1">33,308</td>
            <td rowspan="1" colspan="1">40,579</td>
            <td rowspan="1" colspan="1">41,794</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Families (&gt;3 and &lt;200)</td>
            <td rowspan="1" colspan="1">27,274</td>
            <td rowspan="1" colspan="1">33,556</td>
            <td rowspan="1" colspan="1">39,548</td>
            <td rowspan="1" colspan="1">29,628</td>
            <td rowspan="1" colspan="1">33,562</td>
            <td rowspan="1" colspan="1">38,039</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Largest family size</td>
            <td rowspan="1" colspan="1">615</td>
            <td rowspan="1" colspan="1">567</td>
            <td rowspan="1" colspan="1">556</td>
            <td rowspan="1" colspan="1">652</td>
            <td rowspan="1" colspan="1">561</td>
            <td rowspan="1" colspan="1">527</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Average family size</td>
            <td rowspan="1" colspan="1">11.38</td>
            <td rowspan="1" colspan="1">7.36</td>
            <td rowspan="1" colspan="1">5.36</td>
            <td rowspan="1" colspan="1">10.04</td>
            <td rowspan="1" colspan="1">7.35</td>
            <td rowspan="1" colspan="1">5.09</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <p>We also performed benchmarking using the QfO benchmarking service [<xref rid="bib50" ref-type="bibr">50</xref>]. QfO benchmarking focuses on assessing the accuracy of a tool to predict 1-to-1 orthology, while the GeneSeqToFamily workflow focuses on whole gene families, regardless of the type of homology among the members of a gene family. GeneSeqToFamily performs comparably to other tools benchmarked in QfO, even surpassing them for True Positive ortholog discovery in some parameter spaces. However, we found issues with the QfO service recording 1-to-many orthologs as false positives, hence reducing our overall specificity. Additional information about the corresponding results of benchmarking is available in Additional File 1.</p>
  </sec>
  <sec sec-type="conclusion" id="sec7">
    <title>Conclusion</title>
    <p>The ultimate goal of the GeneSeqToFamily is to provide a user-friendly workflow to analyze and discover homologous genes and their corresponding gene families using the Ensembl Compara GeneTrees pipeline within the Galaxy framework, where users can interrogate genes of interest without using the command-line while still providing the flexibility to tailor analysis by changing configurations and tools if necessary. We have shown it to be an accurate, robust, and reusable method to elucidate and analyze potentially large numbers of gene families in a range of model and nonmodel organisms. The workflow stores the resulting gene families into an SQLite database, which can be visualized using the Aequatus.js interactive tool, as well as shared as a complete reproducible container for potentially large gene family datasets.</p>
    <p>We invite the Galaxy community to undertake their own analyses and feedback improvements to various tools, and publish successful combinations of parameters used in the GeneSeqToFamily workflow to achieve better gene families for their datasets. We encourage this process by allowing users to share their own version of GeneSeqToFamily workflow for appraisal by the community.</p>
    <sec id="sec7-1">
      <title>Future directions</title>
      <p>In terms of core workflow functionality, we would like to incorporate pairwise alignment between pairs of genes for closely related species in addition of the MSA for the gene family, which will help users to compare orthologs and paralogs in greater detail.</p>
      <p>We also plan to explicitly include the PantherDB resources [<xref rid="bib51" ref-type="bibr">51</xref>]. Protein ANalysis THrough Evolutionary Relationships (PANTHER) is a classification system to characterize known proteins and genes according to family, molecular function, biological process, and pathway. The integration of PantherDB with GeneSeqToFamily will enable the automation of gene family validation and add supplementary information about those gene families, which could in turn be used to further validate novel genomics annotation.</p>
      <p>Finally, we intend to add the ability to query the <italic>GAFA</italic> SQLite database using keywords in order to make it easy for users to find gene trees that include their genes of interest without needing to delve into the database itself.</p>
    </sec>
  </sec>
  <sec id="sec8">
    <title>Availability and requirements</title>
    <p><bold>Project name:</bold> GeneSeqToFamily</p>
    <p><bold>Project home page:</bold><ext-link ext-link-type="uri" xlink:href="https://github.com/TGAC/earlham-galaxytools/tree/master/workflows/GeneSeqToFamily">https://github.com/TGAC/earlham-galaxytools/tree/master/workflows/GeneSeqToFamily</ext-link>.</p>
    <p>
      <bold>Archived version: 0.1.0</bold>
    </p>
    <p><bold>Operating system(s):</bold> Platform independent</p>
    <p><bold>Programming language:</bold> JavaScript, Perl, Python, XML, SQL</p>
    <p><bold>Other Requirements:</bold> Web Browser; for development: Galaxy</p>
    <p><bold>Any restrictions to use by non-academics:</bold> None</p>
    <p><bold>License:</bold> The MIT License (<ext-link ext-link-type="uri" xlink:href="https://opensource.org/licenses/MIT">https://opensource.org/licenses/MIT</ext-link>)</p>
  </sec>
  <sec id="sec9">
    <title>Availability of supporting data</title>
    <p>The example files and additional datasets supporting the results of this article are available in figshare [<xref rid="bib49" ref-type="bibr">49</xref>]. A virtual image for Galaxy with necessary tools and installed workflows is available at Earlham repos [<xref rid="bib52" ref-type="bibr">52</xref>]. Snapshots of the supporting data and code are hosted in the <italic>GigaScience</italic> GigaDB repository [<xref rid="bib53" ref-type="bibr">53</xref>].</p>
  </sec>
  <sec id="sec10">
    <title>Additional files</title>
    <p>Table S1: Examples of ortholog pairs that are counted as False Positives by QfO benchmarking but are considered orthologs in the Ensembl Compara database.</p>
    <p>Table S2: Set of parameters used in BLASTP and hcluster_sg to compare results. BLASTP was configured with maximum number of HSPs set to 1, hcluster_sg with single link clusters set to “no,” and maximum size set to 500.</p>
    <p>Figure S1: Showing results for benchmarking on Quest for Orthologs using parameters shown in Parameter Set A <ext-link ext-link-type="uri" xlink:href="http://orthology.benchmarkservice.org/cgi-bin/gateway.pl?f=CheckResults&amp;p1=2569682351ea7dfff3d5b083">http://orthology.benchmarkservice.org/cgi-bin/gateway.pl?f=CheckResults&amp;p1=2569682351ea7dfff3d5b083</ext-link>.</p>
    <p>Figure S2: Showing results for benchmarking on Quest for Orthologs using parameters shown in Parameter Set B <ext-link ext-link-type="uri" xlink:href="http://orthology.benchmarkservice.org/cgi-bin/gateway.pl?f=CheckResults&amp;p1=1038fba4ba15c369b3d25541">http://orthology.benchmarkservice.org/cgi-bin/gateway.pl?f=CheckResults&amp;p1=1038fba4ba15c369b3d25541</ext-link>.</p>
    <p>Figure S3: Showing results for benchmarking on Quest for Orthologs using parameters shown in Parameter Set C <ext-link ext-link-type="uri" xlink:href="http://orthology.benchmarkservice.org/cgi-bin/gateway.pl?f=CheckResults&amp;p1=ec4d223d24e0a7f54edd3692">http://orthology.benchmarkservice.org/cgi-bin/gateway.pl?f=CheckResults&amp;p1=ec4d223d24e0a7f54edd3692</ext-link>.</p>
    <p>Figure S4: Showing results for benchmarking on Quest for Orthologs using parameters shown in Parameter Set D <ext-link ext-link-type="uri" xlink:href="http://orthology.benchmarkservice.org/cgi-bin/gateway.pl?f=CheckResults&amp;p1=dc81a95f182f5b5bee2dab3f">http://orthology.benchmarkservice.org/cgi-bin/gateway.pl?f=CheckResults&amp;p1=dc81a95f182f5b5bee2dab3f</ext-link>.</p>
    <p>Figure S5: Showing results for benchmarking on Quest for Orthologs using parameters shown in Parameter Set E <ext-link ext-link-type="uri" xlink:href="http://orthology.benchmarkservice.org/cgi-bin/gateway.pl?f=CheckResults&amp;p1=9d35f843bcae077e917a6452">http://orthology.benchmarkservice.org/cgi-bin/gateway.pl?f=CheckResults&amp;p1=9d35f843bcae077e917a6452</ext-link>.</p>
    <p>Figure S6: Showing results for benchmarking on Quest for Orthologs using parameters shown in Parameter Set F <ext-link ext-link-type="uri" xlink:href="http://orthology.benchmarkservice.org/cgi-bin/gateway.pl?f=CheckResults&amp;p1=0cbd5a0267b87491252348d6">http://orthology.benchmarkservice.org/cgi-bin/gateway.pl?f=CheckResults&amp;p1=0cbd5a0267b87491252348d6</ext-link>.</p>
  </sec>
  <sec id="sec11">
    <title>Competing interests</title>
    <p>All authors report no competing interests.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>GIGA-D-17-00074_Original_Submission.pdf</label>
      <media xlink:href="giy005_giga-d-17-00074_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup2">
      <label>GIGA-D-17-00074_Revision_1.pdf</label>
      <media xlink:href="giy005_giga-d-17-00074_revision_1.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup3">
      <label>GIGA-D-17-00074_Revision_2.pdf</label>
      <media xlink:href="giy005_giga-d-17-00074_revision_2.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup4">
      <label>Response_to_Reviewer_Comments_Original_Submission.docx</label>
      <media xlink:href="giy005_response_to_reviewer_comments_original_submission.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup5">
      <label>Response_to_Reviewer_Comments_Revision_1.docx</label>
      <media xlink:href="giy005_response_to_reviewer_comments_revision_1.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup6">
      <label>Reviewer_1_Report_(Original_Submission) -- Kristoffer Forslund</label>
      <caption>
        <p>24 Apr 2017 Reviewed</p>
      </caption>
      <media xlink:href="giy005_reviewer_1_report_(original_submission).docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup7">
      <label>Reviewer_1_Report_(Revision_1) -- Kristoffer Forslund</label>
      <caption>
        <p>10 Aug 2017 Reviewed</p>
      </caption>
      <media xlink:href="giy005_reviewer_1_report_(revision_1).docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup8">
      <label>Reviewer_1_Report_(Revision_2) -- Kristoffer Forslund</label>
      <caption>
        <p>03 Jan 2018 Reviewed</p>
      </caption>
      <media xlink:href="giy005_reviewer_1_report_(revision_2).docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup9">
      <label>Reviewer_2_Report_(Original_Submission) -- Yvan Le Bras</label>
      <caption>
        <p>28 Apr 2017 Reviewed</p>
      </caption>
      <media xlink:href="giy005_reviewer_2_report_(original_submission).docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup10">
      <label>Supplemental material</label>
      <media xlink:href="giy005_supp.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>A.S.T., W.H., and R.P.D. are supported by BBSRC Institute Strategic Program grant funds awarded to EI. N.S. is funded under the BBSRC Biomathematics and Bioinformatics Training fund (2014) awarded to EI. This research was supported in part by the NBI Computing Infrastructure for Science Group, which provides technical support and maintenance to E’s high-performance computing cluster and storage systems, which enabled us to develop this workflow.</p>
    <p>We thank Matthieu Muffato from the European Bioinformatics Institute for his advice during the initial stage of the project.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="bib1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gabaldón</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Koonin</surname><given-names>EV</given-names></name></person-group><article-title>Functional and evolutionary implications of gene orthology</article-title>. <source>Nat Rev Genet</source>. <year>2013</year>;<volume>14</volume>(<issue>5</issue>):<fpage>360</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">23552219</pub-id></mixed-citation>
    </ref>
    <ref id="bib2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jensen</surname><given-names>JD</given-names></name>, <name name-style="western"><surname>Wong</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Aquadro</surname><given-names>CF</given-names></name></person-group><article-title>Approaches for identifying targets of positive selection</article-title>. <source>Trends in Genetics</source>. <year>2007</year>;<volume>23</volume>(<issue>11</issue>):<fpage>568</fpage>–<lpage>77</lpage>.<pub-id pub-id-type="pmid">17959267</pub-id></mixed-citation>
    </ref>
    <ref id="bib3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Vilella</surname><given-names>AJ</given-names></name>, <name name-style="western"><surname>Severin</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Ureta-Vidal</surname><given-names>A</given-names></name><etal/></person-group><article-title>EnsemblCompara GeneTrees: Complete, duplication-aware phylogenetic trees in vertebrates</article-title>. <source>Genome Research</source>. <year>2009</year>;<volume>19</volume>(<issue>2</issue>):<fpage>327</fpage>–<lpage>35</lpage>.<pub-id pub-id-type="pmid">19029536</pub-id></mixed-citation>
    </ref>
    <ref id="bib4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>Ensembl</collab></person-group><article-title>Ensembl/treebest</article-title>. <source>GitHub</source>. <comment><ext-link ext-link-type="uri" xlink:href="https://github.com/Ensembl/treebest">https://github.com/Ensembl/treebest</ext-link>. Accessed 26 Jan 2016</comment>.</mixed-citation>
    </ref>
    <ref id="bib5">
      <label>5.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Heng</surname><given-names>L</given-names></name></person-group><article-title>Constructing the TreeFam database</article-title>. <comment>The Institute of Theoretical Physics, Chinese Academic of Science</comment>; <year>2006</year><comment><ext-link ext-link-type="uri" xlink:href="http://pfigshare-u-files.s3.amazonaws.com/1421613/PhDthesisliheng2006English.pdf">http://pfigshare-u-files.s3.amazonaws.com/1421613/PhDthesisliheng2006English.pdf</ext-link></comment>.</mixed-citation>
    </ref>
    <ref id="bib6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ruan</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Chen</surname><given-names>Z</given-names></name><etal/></person-group><article-title>TreeFam: 2008 Update</article-title>. <source>Nucleic Acids Res</source>. <year>2008</year>;<volume>36</volume>(<issue>Database issue</issue>):<fpage>D735</fpage>–<lpage>40</lpage>.<pub-id pub-id-type="pmid">18056084</pub-id></mixed-citation>
    </ref>
    <ref id="bib7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Altschul</surname><given-names>SF</given-names></name>, <name name-style="western"><surname>Gish</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Miller</surname><given-names>W</given-names></name><etal/></person-group><article-title>Basic local alignment search tool</article-title>. <source>Journal of Molecular Biology</source>. <year>1990</year>;<volume>215</volume>(<issue>3</issue>):<fpage>403</fpage>–<lpage>10</lpage>.<pub-id pub-id-type="pmid">2231712</pub-id></mixed-citation>
    </ref>
    <ref id="bib8">
      <label>8.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>H</given-names></name><etal/></person-group><article-title>hcluster_sg: hierarchical clustering software for sparse graphs</article-title>. <comment><ext-link ext-link-type="uri" xlink:href="https://github.com/douglasgscofield/hcluster">https://github.com/douglasgscofield/hcluster</ext-link>. Accessed 26 Jan 2016</comment>.</mixed-citation>
    </ref>
    <ref id="bib9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Notredame</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Higgins</surname><given-names>DG</given-names></name>, <name name-style="western"><surname>Heringa</surname><given-names>J</given-names></name></person-group><article-title>T-Coffee: a novel method for fast and accurate multiple sequence alignment</article-title>. <source>Journal of Molecular Biology</source>. <year>2000</year>;<volume>302</volume>(<issue>1</issue>):<fpage>205</fpage>–<lpage>17</lpage>.<pub-id pub-id-type="pmid">10964570</pub-id></mixed-citation>
    </ref>
    <ref id="bib10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Afgan</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Baker</surname><given-names>D</given-names></name>, <name name-style="western"><surname>van den Beek</surname><given-names>M</given-names></name><etal/></person-group><article-title>The Galaxy platform for accessible, reproducible and collaborative biomedical analyses: 2016 update</article-title>. <source>Nucleic Acids Res</source>. <year>2016</year>;<volume>44</volume>(<issue>W1</issue>):<fpage>W3</fpage>–<lpage>W10</lpage>.<pub-id pub-id-type="pmid">27137889</pub-id></mixed-citation>
    </ref>
    <ref id="bib11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Goble</surname><given-names>CA</given-names></name>, <name name-style="western"><surname>Bhagat</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Aleksejevs</surname><given-names>S</given-names></name><etal/></person-group><article-title>myExperiment: a repository and social network for the sharing of bioinformatics workflows</article-title>. <source>Nucleic Acids Res</source>. <year>2010</year>;<volume>38</volume>(<issue>suppl_2</issue>):<fpage>W677</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">20501605</pub-id></mixed-citation>
    </ref>
    <ref id="bib12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Goecks</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Eberhard</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Too</surname><given-names>T</given-names></name><etal/></person-group><article-title>Web-based visual analysis for high-throughput genomics</article-title>. <source>BMC Genomics</source>. <year>2013</year>;<volume>14</volume>:<fpage>397</fpage>.<pub-id pub-id-type="pmid">23758618</pub-id></mixed-citation>
    </ref>
    <ref id="bib13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Thanki</surname><given-names>AS</given-names></name>, <name name-style="western"><surname>Ayling</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Herrero</surname><given-names>J</given-names></name><etal/></person-group><article-title>Aequatus: An open-source homology browser</article-title>. <source>bioRxiv</source>. <year>2016</year>;<fpage>055632</fpage><comment>doi:10.1101/055632</comment>.</mixed-citation>
    </ref>
    <ref id="bib14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>TGAC</collab></person-group><article-title>TGAC/aequatus.js</article-title>. <source>GitHub</source>. <comment><ext-link ext-link-type="uri" xlink:href="https://github.com/TGAC/aequatus.js">https://github.com/TGAC/aequatus.js</ext-link>. Accessed 26 Jan 2016</comment>.</mixed-citation>
    </ref>
    <ref id="bib15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Blankenberg</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Von Kuster</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Bouvier</surname><given-names>E</given-names></name><etal/></person-group><article-title>Dissemination of scientific software with Galaxy ToolShed</article-title>. <source>Genome Biol</source>. <year>2014</year>;<volume>15</volume>(<issue>2</issue>):<fpage>403</fpage>.<pub-id pub-id-type="pmid">25001293</pub-id></mixed-citation>
    </ref>
    <ref id="bib16">
      <label>16.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><collab>SQLite Home Page</collab></person-group><comment><ext-link ext-link-type="uri" xlink:href="https://www.sqlite.org/">https://www.sqlite.org/</ext-link>. Accessed 18 Nov 2016</comment>.</mixed-citation>
    </ref>
    <ref id="bib17">
      <label>17.</label>
      <mixed-citation publication-type="other"><collab>Get sequences by Ensembl ID: Galaxy Tool Shed</collab>. <comment><ext-link ext-link-type="uri" xlink:href="https://toolshed.g2.bx.psu.edu/view/earlhaminst/ensembl_get_sequences/">https://toolshed.g2.bx.psu.edu/view/earlhaminst/ensembl_get_sequences/</ext-link>. Accessed 20 Dec 2016</comment>.</mixed-citation>
    </ref>
    <ref id="bib18">
      <label>18.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><collab>Get features by Ensembl ID: Galaxy Tool Shed</collab></person-group><comment><ext-link ext-link-type="uri" xlink:href="https://toolshed.g2.bx.psu.edu/view/earlhaminst/ensembl_get_feature_info/">https://toolshed.g2.bx.psu.edu/view/earlhaminst/ensembl_get_feature_info/</ext-link>. Accessed 20 Dec 2016</comment>.</mixed-citation>
    </ref>
    <ref id="bib19">
      <label>19.</label>
      <mixed-citation publication-type="other"><collab>Select longest CDS per gene: Galaxy Tool Shed</collab>. <comment><ext-link ext-link-type="uri" xlink:href="https://toolshed.g2.bx.psu.edu/view/earlhaminst/ensembl_longest_cds_per_gene/">https://toolshed.g2.bx.psu.edu/view/earlhaminst/ensembl_longest_cds_per_gene/</ext-link>. Accessed 8 Mar 2017</comment>.</mixed-citation>
    </ref>
    <ref id="bib20">
      <label>20.</label>
      <mixed-citation publication-type="other"><collab>ETE species tree generator: Galaxy Tool Shed</collab>. <comment><ext-link ext-link-type="uri" xlink:href="https://toolshed.g2.bx.psu.edu/view/earlhaminst/ete/">https://toolshed.g2.bx.psu.edu/view/earlhaminst/ete/</ext-link>. Accessed 20 Dec 2016</comment>.</mixed-citation>
    </ref>
    <ref id="bib21">
      <label>21.</label>
      <mixed-citation publication-type="other"><collab>GeneSeqToFamily preparation: Galaxy Tool Shed</collab>. <comment><ext-link ext-link-type="uri" xlink:href="https://toolshed.g2.bx.psu.edu/view/earlhaminst/gstf_preparation/">https://toolshed.g2.bx.psu.edu/view/earlhaminst/gstf_preparation/</ext-link>. Accessed 17 Mar 2017</comment>.</mixed-citation>
    </ref>
    <ref id="bib22">
      <label>22.</label>
      <mixed-citation publication-type="other"><collab>EMBOSS: Galaxy Tool Shed</collab>. <comment><ext-link ext-link-type="uri" xlink:href="https://toolshed.g2.bx.psu.edu/view/devteam/emboss_5/">https://toolshed.g2.bx.psu.edu/view/devteam/emboss_5/</ext-link>. Accessed 21 Dec 2016</comment>.</mixed-citation>
    </ref>
    <ref id="bib23">
      <label>23.</label>
      <mixed-citation publication-type="other"><collab>NCBI BLAST plus: Galaxy Tool Shed</collab>. <comment><ext-link ext-link-type="uri" xlink:href="https://toolshed.g2.bx.psu.edu/view/devteam/ncbi_blast_plus">https://toolshed.g2.bx.psu.edu/view/devteam/ncbi_blast_plus</ext-link>. Accessed 21 Dec 2016</comment>.</mixed-citation>
    </ref>
    <ref id="bib24">
      <label>24.</label>
      <mixed-citation publication-type="other"><collab>BLAST parser: Galaxy Tool Shed</collab>. <comment><ext-link ext-link-type="uri" xlink:href="https://toolshed.g2.bx.psu.edu/view/earlhaminst/blast_parser/">https://toolshed.g2.bx.psu.edu/view/earlhaminst/blast_parser/</ext-link>. Accessed 20 Dec 2016</comment>.</mixed-citation>
    </ref>
    <ref id="bib25">
      <label>25.</label>
      <mixed-citation publication-type="other"><collab>hcluster_sg: Galaxy Tool Shed</collab>. <comment><ext-link ext-link-type="uri" xlink:href="https://toolshed.g2.bx.psu.edu/view/earlhaminst/hcluster_sg/">https://toolshed.g2.bx.psu.edu/view/earlhaminst/hcluster_sg/</ext-link>. Accessed 20 Dec 2016</comment>.</mixed-citation>
    </ref>
    <ref id="bib26">
      <label>26.</label>
      <mixed-citation publication-type="other"><collab>hcluster_sg parser: Galaxy Tool Shed</collab>. <comment><ext-link ext-link-type="uri" xlink:href="https://toolshed.g2.bx.psu.edu/view/earlhaminst/hcluster_sg_parser/">https://toolshed.g2.bx.psu.edu/view/earlhaminst/hcluster_sg_parser/</ext-link>. Acce-ssed 20 Dec 2016</comment>.</mixed-citation>
    </ref>
    <ref id="bib27">
      <label>27.</label>
      <mixed-citation publication-type="other"><collab>Filter by FASTA IDs: Galaxy Tool Shed</collab>. <comment><ext-link ext-link-type="uri" xlink:href="https://toolshed.g2.bx.psu.edu/view/galaxyp/filter_by_fasta_ids/">https://toolshed.g2.bx.psu.edu/view/galaxyp/filter_by_fasta_ids/</ext-link>. Accessed 21 Dec 2016</comment>.</mixed-citation>
    </ref>
    <ref id="bib28">
      <label>28.</label>
      <mixed-citation publication-type="other"><collab>T-Coffee: Galaxy Tool Shed</collab>. <comment><ext-link ext-link-type="uri" xlink:href="https://toolshed.g2.bx.psu.edu/view/earlhaminst/t_coffee/">https://toolshed.g2.bx.psu.edu/view/earlhaminst/t_coffee/</ext-link>. Accessed 20 Dec 2016</comment>.</mixed-citation>
    </ref>
    <ref id="bib29">
      <label>29.</label>
      <mixed-citation publication-type="other"><collab>TreeBeST best: Galaxy Tool Shed</collab>. <comment><ext-link ext-link-type="uri" xlink:href="https://toolshed.g2.bx.psu.edu/view/earlhaminst/treebest_best/">https://toolshed.g2.bx.psu.edu/view/earlhaminst/treebest_best/</ext-link>. Accessed 20 Dec 2016</comment>.</mixed-citation>
    </ref>
    <ref id="bib30">
      <label>30.</label>
      <mixed-citation publication-type="other"><comment>Gene Align and Family Aggregator (GAFA): Galaxy Tool Shed. <ext-link ext-link-type="uri" xlink:href="https://toolshed.g2.bx.psu.edu/view/earlhaminst/gafa/">https://toolshed.g2.bx.psu.edu/view/earlhaminst/gafa/</ext-link>. Accessed 21 Dec 2016</comment>.</mixed-citation>
    </ref>
    <ref id="bib31">
      <label>31.</label>
      <mixed-citation publication-type="other"><collab>text_processing: Galaxy Tool Shed</collab>. <comment><ext-link ext-link-type="uri" xlink:href="https://toolshed.g2.bx.psu.edu/view/bgruening/text_processing/">https://toolshed.g2.bx.psu.edu/view/bgruening/text_processing/</ext-link>. Accessed 19 Apr 2017</comment>.</mixed-citation>
    </ref>
    <ref id="bib32">
      <label>32.</label>
      <mixed-citation publication-type="other"><collab>FASTA-to-Tabular converter: Galaxy Tool Shed</collab>. <comment><ext-link ext-link-type="uri" xlink:href="https://toolshed.g2.bx.psu.edu/view/devteam/fasta_to_tabular/">https://toolshed.g2.bx.psu.edu/view/devteam/fasta_to_tabular/</ext-link>. Accessed 19 Apr 2017</comment>.</mixed-citation>
    </ref>
    <ref id="bib33">
      <label>33.</label>
      <mixed-citation publication-type="other"><collab>uniprot_rest_interface: Galaxy Tool Shed</collab>. <comment><ext-link ext-link-type="uri" xlink:href="https://toolshed.g2.bx.psu.edu/view/bgruening/uniprot_rest_interface/">https://toolshed.g2.bx.psu.edu/view/bgruening/uniprot_rest_interface/</ext-link>. Ac-cessed 20 Mar 2017</comment>.</mixed-citation>
    </ref>
    <ref id="bib34">
      <label>34.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yates</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Beal</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Keenan</surname><given-names>S</given-names></name><etal/></person-group><article-title>The Ensembl REST API: Ensembl data for any language</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>31</volume>(<issue>1</issue>):<fpage>143</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">25236461</pub-id></mixed-citation>
    </ref>
    <ref id="bib35">
      <label>35.</label>
      <mixed-citation publication-type="other"><collab>Representational State Transfer</collab>. <comment><ext-link ext-link-type="uri" xlink:href="http://www.peej.co.uk/articles/rest.html">http://www.peej.co.uk/articles/rest.html</ext-link>. Accessed 4 Feb 2016</comment>.</mixed-citation>
    </ref>
    <ref id="bib36">
      <label>36.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Huerta-Cepas</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Serra</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Bork</surname><given-names>P</given-names></name></person-group><article-title>ETE 3: Reconstruction, analysis, and visualization of phylogenomic data</article-title>. <source>Mol Biol Evol</source>. <year>2016</year>;<volume>33</volume>(<issue>6</issue>):<fpage>1635</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">26921390</pub-id></mixed-citation>
    </ref>
    <ref id="bib37">
      <label>37.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><collab>GFF3 - GMOD</collab></person-group><comment><ext-link ext-link-type="uri" xlink:href="http://gmod.org/wiki/GFF3">http://gmod.org/wiki/GFF3</ext-link>. Accessed 4 Feb 2016</comment>.</mixed-citation>
    </ref>
    <ref id="bib38">
      <label>38.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><collab>JSON</collab></person-group><comment><ext-link ext-link-type="uri" xlink:href="http://www.json.org">http://www.json.org</ext-link>. Accessed 4 Feb 2016</comment>.</mixed-citation>
    </ref>
    <ref id="bib39">
      <label>39.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rice</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Longden</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Bleasby</surname><given-names>A</given-names></name></person-group><article-title>EMBOSS: the European molecular biology open software suite</article-title>. <source>Trends in Genetics</source>. <year>2000</year>;<volume>16</volume>(<issue>6</issue>):<fpage>276</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">10827456</pub-id></mixed-citation>
    </ref>
    <ref id="bib40">
      <label>40.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cock</surname><given-names>PJA</given-names></name>, <name name-style="western"><surname>Chilton</surname><given-names>JM</given-names></name>, <name name-style="western"><surname>Grüning</surname><given-names>B</given-names></name><etal/></person-group><article-title>NCBI BLAST+ integrated into Galaxy</article-title>. <source>GigaScience</source>. <year>2015</year>;<volume>4</volume>:<fpage>39</fpage>.<pub-id pub-id-type="pmid">26336600</pub-id></mixed-citation>
    </ref>
    <ref id="bib41">
      <label>41.</label>
      <mixed-citation publication-type="other"><comment>National Center for Biotechnology Information (U.S.), Camacho C. BLAST(r) Command Line Applications User Manual</comment><year>2008</year><comment><ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/books/NBK279690/">https://www.ncbi.nlm.nih.gov/books/NBK279690/</ext-link>. Accessed 26 Feb 2018</comment>.</mixed-citation>
    </ref>
    <ref id="bib42">
      <label>42.</label>
      <mixed-citation publication-type="other"><collab>“Newick's 8:45” Tree Format Standard</collab>. <comment><ext-link ext-link-type="uri" xlink:href="http://evolution.genetics.washington.edu/phylip/newick_doc.html">http://evolution.genetics.washington.edu/phylip/newick_doc.html</ext-link>. Acce-ssed 8 Apr 2016</comment>.</mixed-citation>
    </ref>
    <ref id="bib43">
      <label>43.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><collab>Sequence Alignment/Map Format Specification</collab></person-group><comment><ext-link ext-link-type="uri" xlink:href="http://samtools.github.io/hts-specs/SAMv1.pdf">http://samtools.github.io/hts-specs/SAMv1.pdf</ext-link>. Accessed 20 Dec 2016</comment>.</mixed-citation>
    </ref>
    <ref id="bib44">
      <label>44.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>TGAC</collab></person-group><article-title>TGAC/earlham-galaxytools</article-title>. <source>GitHub</source>. <comment><ext-link ext-link-type="uri" xlink:href="https://github.com/TGAC/earlham-galaxytools">https://github.com/TGAC/earlham-galaxytools</ext-link>. Accessed 21 Mar 2016</comment>.</mixed-citation>
    </ref>
    <ref id="bib45">
      <label>45.</label>
      <mixed-citation publication-type="journal"><volume>Gene: BRAT1 (ENSG00000106009) - Gene tree - Homo sapiens - Ensembl genome browser 87</volume><comment><ext-link ext-link-type="uri" xlink:href="http://dec2016.archive.ensembl.org/Homo_sapiens/Gene/Compara_Tree?g=ENSG00000106009;r=7:2537877-2555727">http://dec2016.archive.ensembl.org/Homo_sapiens/Gene/Compara_Tree?g=ENSG00000106009;r=7:2537877-2555727</ext-link></comment>; <comment>Accessed 23 Dec 2016</comment>.</mixed-citation>
    </ref>
    <ref id="bib46">
      <label>46.</label>
      <mixed-citation publication-type="other"><collab>Gene: INSR (ENSG00000171105) - Gene tree - Homo sapiens - Ensembl genome browser 87</collab>. <comment><ext-link ext-link-type="uri" xlink:href="http://dec2016.archive.ensembl.org/Homo_sapiens/Gene/Compara_Tree?g=ENSG00000171105;r=19:7112255-7294034">http://dec2016.archive.ensembl.org/Homo_sapiens/Gene/Compara_Tree?g=ENSG00000171105;r=19:7112255-7294034</ext-link></comment>; <comment>Accessed 23 Dec 2016</comment>.</mixed-citation>
    </ref>
    <ref id="bib47">
      <label>47.</label>
      <mixed-citation publication-type="other"><collab>Gene: MAOA (ENSG00000189221) - Gene tree - Homo sapiens - Ensembl genome browser 87</collab>. <comment><ext-link ext-link-type="uri" xlink:href="http://dec2016.archive.ensembl.org/Homo_sapiens/Gene/Compara_Tree?g=ENSG00000189221;r=X:43654907-43746824">http://dec2016.archive.ensembl.org/Homo_sapiens/Gene/Compara_Tree?g=ENSG00000189221;r=X:43654907-43746824</ext-link></comment>; <comment>Accessed 23 Dec 2016</comment>.</mixed-citation>
    </ref>
    <ref id="bib48">
      <label>48.</label>
      <mixed-citation publication-type="other"><collab>Gene: MAOB (ENSG00000069535) - Gene tree - Homo sapiens - Ensembl genome browser 87</collab>. <comment><ext-link ext-link-type="uri" xlink:href="http://dec2016.archive.ensembl.org/Homo_sapiens/Gene/Compara_Tree?g=ENSG00000069535;r=X:43766611-43882447">http://dec2016.archive.ensembl.org/Homo_sapiens/Gene/Compara_Tree?g=ENSG00000069535;r=X:43766611-43882447</ext-link></comment>; <comment>Accessed 23 Dec 2016</comment>.</mixed-citation>
    </ref>
    <ref id="bib49">
      <label>49.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Thanki</surname><given-names>AS</given-names></name>, <name name-style="western"><surname>Soranzo</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Haerty</surname><given-names>W</given-names></name><etal/></person-group><article-title>GeneSeqToFamily.zip</article-title>. <year>2017</year><comment>doi:10.6084/m9.figshare.4484141.v15</comment>.</mixed-citation>
    </ref>
    <ref id="bib50">
      <label>50.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kuzniar</surname><given-names>A</given-names></name>, <name name-style="western"><surname>van Ham</surname><given-names>RCHJ</given-names></name>, <name name-style="western"><surname>Pongor</surname><given-names>S</given-names></name><etal/></person-group><article-title>The quest for orthologs: finding the corresponding gene across genomes</article-title>. <source>Trends in Genetics</source>. <year>2008</year>;<volume>24</volume>(<issue>11</issue>):<fpage>539</fpage>–<lpage>51</lpage>.<pub-id pub-id-type="pmid">18819722</pub-id></mixed-citation>
    </ref>
    <ref id="bib51">
      <label>51.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Mi</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Lazareva-Ulitsky</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Loo</surname><given-names>R</given-names></name><etal/></person-group><article-title>The PANTHER database of protein families, subfamilies, functions and pathways</article-title>. <source>Nucleic Acids Research</source>. <year>2004</year>;<volume>33</volume>(<issue>Database issue</issue>):<fpage>D284</fpage>–<lpage>8</lpage>.</mixed-citation>
    </ref>
    <ref id="bib52">
      <label>52.</label>
      <mixed-citation publication-type="other"><collab>Galaxy Virtual Image</collab>. <comment><ext-link ext-link-type="uri" xlink:href="http://repos.tgac.ac.uk/vms/Galaxy_with_GeneSeqToFamily.ova">http://repos.tgac.ac.uk/vms/Galaxy_with_GeneSeqToFamily.ova</ext-link>. Accessed 28 Jul 2017</comment>.</mixed-citation>
    </ref>
    <ref id="bib53">
      <label>53.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Thanki</surname><given-names>AS</given-names></name>, <name name-style="western"><surname>Soranzo</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Haerty</surname><given-names>W</given-names></name><etal/></person-group><article-title>Supporting data for “GeneSeqToFamily: a Galaxy workflow to find gene families based on the Ensembl Compara GeneTrees pipeline”</article-title>. <source>GigaScience Database</source><year>2018</year><comment><ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5524/100402">http://dx.doi.org/10.5524/100402</ext-link></comment>.</mixed-citation>
    </ref>
  </ref-list>
</back>
