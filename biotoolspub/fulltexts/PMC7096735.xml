<?DTDIdentifier.IdentifierValue -//ES//DTD journal article DTD version 5.6.0//EN//XML?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName art560.dtd?>
<?SourceDTD.Version 5.6.0?>
<?ConverterInfo.XSLTName elsevier2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<?origin publisher?>
<?FILEmeta_CSBJ459 xml ?>
<?FILEmain xml ?>
<?FILEmain pdf ?>
<?FILEgr1 jpg ?>
<?FILEgr2 jpg ?>
<?FILEgr3 jpg ?>
<?FILEgr4 jpg ?>
<?FILEgr5 jpg ?>
<?FILEgr6 jpg ?>
<?FILEga1 jpg ?>
<?FILEmmc1 xml ?>
<?properties open_access?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Comput Struct Biotechnol J</journal-id>
    <journal-id journal-id-type="iso-abbrev">Comput Struct Biotechnol J</journal-id>
    <journal-title-group>
      <journal-title>Computational and Structural Biotechnology Journal</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2001-0370</issn>
    <publisher>
      <publisher-name>Research Network of Computational and Structural Biotechnology</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7096735</article-id>
    <article-id pub-id-type="publisher-id">S2001-0370(20)30024-6</article-id>
    <article-id pub-id-type="doi">10.1016/j.csbj.2020.02.015</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Introducing the CSP Analyzer: A novel Machine Learning-based application for automated analysis of two-dimensional NMR spectra in NMR fragment-based screening</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="au005">
        <name>
          <surname>Fino</surname>
          <given-names>R.</given-names>
        </name>
        <xref rid="af005" ref-type="aff">a</xref>
        <xref rid="af010" ref-type="aff">b</xref>
        <xref rid="fn1" ref-type="fn">1</xref>
      </contrib>
      <contrib contrib-type="author" id="au010">
        <name>
          <surname>Byrne</surname>
          <given-names>R.</given-names>
        </name>
        <xref rid="af015" ref-type="aff">c</xref>
        <xref rid="fn1" ref-type="fn">1</xref>
      </contrib>
      <contrib contrib-type="author" id="au015">
        <name>
          <surname>Softley</surname>
          <given-names>C.A.</given-names>
        </name>
        <xref rid="af005" ref-type="aff">a</xref>
        <xref rid="af010" ref-type="aff">b</xref>
      </contrib>
      <contrib contrib-type="author" id="au020">
        <name>
          <surname>Sattler</surname>
          <given-names>M.</given-names>
        </name>
        <xref rid="af005" ref-type="aff">a</xref>
        <xref rid="af010" ref-type="aff">b</xref>
      </contrib>
      <contrib contrib-type="author" id="au025">
        <name>
          <surname>Schneider</surname>
          <given-names>G.</given-names>
        </name>
        <xref rid="af015" ref-type="aff">c</xref>
      </contrib>
      <contrib contrib-type="author" id="au030">
        <name>
          <surname>Popowicz</surname>
          <given-names>G.M.</given-names>
        </name>
        <email>grzegorz.popowicz@helmholtz-muenchen.de</email>
        <xref rid="af005" ref-type="aff">a</xref>
        <xref rid="af010" ref-type="aff">b</xref>
        <xref rid="cor1" ref-type="corresp">⁎</xref>
      </contrib>
    </contrib-group>
    <aff id="af005"><label>a</label>Institute of Structural Biology, Helmholtz Zentrum München, Neuherberg, Germany</aff>
    <aff id="af010"><label>b</label>Biomolecular NMR, Bayerisches NMR Zentrum and Center for Integrated Protein Science Munich at Chemistry Department, Technical University of Munich, Garching, Germany</aff>
    <aff id="af015"><label>c</label>Department of Chemistry and Applied Biosciences, Institute of Pharmaceutical Sciences, Swiss Federal Institute of Technology (ETH), Vladimir-Prelog-Weg 4, 8093 Zürich, Switzerland</aff>
    <author-notes>
      <corresp id="cor1"><label>⁎</label>Corresponding author. <email>grzegorz.popowicz@helmholtz-muenchen.de</email></corresp>
      <fn id="fn1">
        <label>1</label>
        <p id="np005">These authors contributed equally to this work.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="pmc-release">
      <day>28</day>
      <month>2</month>
      <year>2020</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on <pub-date
						pub-type="epub">.-->
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>28</day>
      <month>2</month>
      <year>2020</year>
    </pub-date>
    <volume>18</volume>
    <fpage>603</fpage>
    <lpage>611</lpage>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>1</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>14</day>
        <month>2</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>2</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2020 The Authors</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license license-type="CC BY" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article under the CC BY license (http://creativecommons.org/licenses/by/4.0/).</license-p>
      </license>
    </permissions>
    <abstract abstract-type="graphical" id="ab005">
      <title>Graphical abstract</title>
      <fig id="f0035" position="anchor">
        <graphic xlink:href="ga1"/>
      </fig>
    </abstract>
    <abstract id="ab010">
      <p>NMR-based screening, especially fragment-based drug discovery is a valuable approach in early-stage drug discovery. Monitoring fragment-binding in protein-detected 2D NMR experiments requires analysis of hundreds of spectra to detect chemical shift perturbations (CSPs) in the presence of ligands screened. Computational tools are available that simplify the tracking of CSPs in 2D NMR spectra. However, to the best of our knowledge, an efficient automated tool for the assessment and binning of multiple spectra for ligand binding has not yet been described. We present a novel and fast approach for analysis of multiple 2D HSQC spectra based on machine-learning-driven statistical discrimination. The CSP Analyzer features a C# frontend interfaced to a Python ML classifier. The software allows rapid evaluation of 2D screening data from large number of spectra, reducing user-introduced bias in the evaluation. The CSP Analyzer software package is available on GitHub <ext-link ext-link-type="uri" xlink:href="https://github.com/rubbs14/CSP-Analyzer/releases/tag/v1.0" id="ir005">https://github.com/rubbs14/CSP-Analyzer/releases/tag/v1.0</ext-link> under the GPL license 3.0 and is free to use for academic and commercial uses.</p>
    </abstract>
    <kwd-group id="kg005">
      <title>Keywords</title>
      <kwd>2-D NMR</kwd>
      <kwd>Fragment screening</kwd>
      <kwd>Machine-learning</kwd>
      <kwd>Automatic CSP analysis</kwd>
      <kwd>C# GUI</kwd>
      <kwd>Fragment-based drug discovery</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec id="s0005">
    <label>1</label>
    <title>Introduction</title>
    <p id="p0005">In recent times, fragment-based drug discovery (FBDD) has become progressively more important in early-stage drug design. Fragment-based screening (FBS) offers an efficient, rational, way to find small molecule inhibitors. By testing for binding of small fragments, a large chemical space can be tested with fewer molecules than with other approaches. This is due to the higher probability of a suitable binding pocket or position being present with lower complexity molecules <xref rid="b0005" ref-type="bibr">[1]</xref>, leading to higher efficiency (both screening efficiency and ligand efficiency), and elucidating possible starting points for further drug discovery. The binding sites of these fragments can then be located on the surface of the protein and from there, fragments connected or grown to maximize interactions with the surrounding area, eventually leading to hit and lead molecules. X-ray crystallography and nuclear magnetic resonance (NMR) can be used to both identify hits and get structural information about the binding. NMR, working in the solution state, and requiring low concentrations, is well placed to detect weakly-binding fragments, in an environment more representative of in vivo conditions. Since the turn of the century <xref rid="b0010" ref-type="bibr">[2]</xref>, FBS has grown in use, in both academic and industrial settings, owing to its speed and reliability at testing large chemical space with standard and cost-effective biophysical methods. As such, thousands-strong libraries can be quickly measured against a huge variety of biological targets.</p>
    <p id="p0010">With NMR, both target- and ligand-observed screening approaches are possible <xref rid="b0015" ref-type="bibr">[3]</xref>, <xref rid="b0020" ref-type="bibr">[4]</xref>, <xref rid="b0025" ref-type="bibr">[5]</xref>, <xref rid="b0030" ref-type="bibr">[6]</xref>, <xref rid="b0035" ref-type="bibr">[7]</xref>, <xref rid="b0040" ref-type="bibr">[8]</xref>. From a technical point of view, NMR FBS allows medium to large libraries of fragments (1000–5000 fragments) to be efficiently screened. Concerning binding affinity ranges, FBS by NMR allows detecting binding of ligands with affinities as weak as low millimolar <xref rid="b0010" ref-type="bibr">[2]</xref>. Furthermore, certain experiments may provide helpful insights into the kinetics and dynamics of fragment binding <xref rid="b0045" ref-type="bibr">[9]</xref>.</p>
    <p id="p0015">Ligand-observed NMR screening utilizes simple and sensitive 1D experiments (i.e. STD <xref rid="b0040" ref-type="bibr">[8]</xref>, WaterLOGSY <xref rid="b0050" ref-type="bibr">[10]</xref>, SLAPSTIC <xref rid="b0055" ref-type="bibr">[11]</xref>, T2 and T1rho <xref rid="b0060" ref-type="bibr">[12]</xref>) and requires no isotopic-labeling of the target protein, simplifying the experimental preparation. These ligand-observed NMR experiments are applicable to medium to very high molecular-weight targets. Depending on the ligand affinity, direct or competitive binding is monitored <xref rid="b0040" ref-type="bibr">[8]</xref>, <xref rid="b0045" ref-type="bibr">[9]</xref>, <xref rid="b0065" ref-type="bibr">[13]</xref>.</p>
    <p id="p0020">For smaller proteins (&lt;30 kDa), protein-observed 2D heteronuclear NMR experiments, such as <sup>1</sup>H, <sup>15</sup>N correlation (HSQC <xref rid="b0070" ref-type="bibr">[14]</xref>, SOFAST-HMQC <xref rid="b0075" ref-type="bibr">[15]</xref>) are also used <xref rid="b0080" ref-type="bibr">[16]</xref>. This requires isotope labeling of the target protein – often <sup>15</sup>N or <sup>13</sup>C alone for small proteins or combined with <sup>2</sup>H-labeling <xref rid="b0085" ref-type="bibr">[17]</xref> for larger proteins <xref rid="b0090" ref-type="bibr">[18]</xref>. As STD and T1rho, for example, work better with larger proteins as a result of slower tumbling, 2D experiments are especially preferred with small proteins as a reliable procedure that measures the direct effect on protein chemical environment, rather than transferred magnetization or change in ligand properties. It has the additional advantage, in cases where the amino acid shifts are assigned, that it gives an indication of possible binding regions by means of the peaks’ chemical shift perturbations (CSP) <xref rid="b0095" ref-type="bibr">[19]</xref>, <xref rid="b0100" ref-type="bibr">[20]</xref>, <xref rid="b0105" ref-type="bibr">[21]</xref>.</p>
    <p id="p0025">Automated analysis tools are available for 1D NMR experiments <xref rid="b0110" ref-type="bibr">[22]</xref>, <xref rid="b0115" ref-type="bibr">[23]</xref>, <xref rid="b0120" ref-type="bibr">[24]</xref> and 2D NMR experiments <xref rid="b0125" ref-type="bibr">[25]</xref>, <xref rid="b0130" ref-type="bibr">[26]</xref>, <xref rid="b0135" ref-type="bibr">[27]</xref>. These tools allow the analysis of 2D NMR titration experiments by tracking of CSP. Following titration assignments in order to determine rate constants as in NvMap <xref rid="b0125" ref-type="bibr">[25]</xref>, however, is quite different to the needs of fragment screening, which requires a more global view of whether the overall spectrum is significantly altered. In practice, this means that a significant number of peaks alter position or intensity or broaden upon addition of the fragment or ligand in question. Each spectrum measured with a fragment is overlaid with the reference spectrum and compared directly. This is easily done by eye, but, depending on the number of NMR spectra recorded in an FBS campaign, manual analysis can be time-consuming. The other significant issue with manual analysis is the addition of human bias. Whether as a result of tiredness, splitting the analysis over multiple sessions, or simply as a result of comparison with those already considered, the same spectrum can be classified differently depending on its position within the dataset. Automation or partial automation of this process would improve efficiency and accuracy, as well as reducing opportunities for the introduction of human bias. It would enable direct comparisons of achieved hit rates with different proteins, as currently these campaigns are often analyzed by different people, leading to differences in subjective evaluation of the spectra. As far as we are aware, fast and reliable automated analysis software for the simultaneous analysis of large numbers of 2D NMR spectra that provides useful binning for hit identification has not been reported in the literature.</p>
    <p id="p0030">In this work, we present a novel approach for very fast analysis of hundreds of 2D NMR spectra in FBS based on advanced machine-learning-driven statistical discrimination. Our CSP Analyzer features a C# frontend that is interfaced with a Python Machine Learning classifier.</p>
    <p id="p0035">According to the principles of target-based NMR 2D FBS, the software is designed to identify the “active” fragments by comparing each spectrum (protein with fragment or fragment pool) in a screening set to its reference spectrum (protein only). This operation does not require the assignment of the peaks because the statistics are based on the fingerprinting of each spectrum properties (peaks position, peaks scattering, intensities, etc.). In other words, the algorithms included in the package are capable of indicating, with good recall, the “most different” experiments to the reference spectrum. The software is designed to enable either partial or fully automated hit determination from measured 2-D spectra, depending on the user’s requirements, thus being a versatile tool for FBS campaigns by NMR.</p>
  </sec>
  <sec id="s0010">
    <label>2</label>
    <title>Results</title>
    <p id="p0040">To train the machine-learning (ML) model, we focused on developing an input representation, borrowing heavily from advances in computer vision, to enable multi-protein spectral analysis without retraining for each new target of interest. We optimized our architecture for the particulars of this challenge, specifically recognizing the relative importance, and rarity, of ‘active’ vs. ‘inactive’ spectra. To accomplish these objectives, we adopted a mixture of strategies, engineering a useful feature representation that draws on computer vision methodology, and through synthetic data enhancement, weighting, and hyperparameter optimization.</p>
    <p id="p0045">We tested the program and the ML discriminator on our in-house datasets of NMR-based fragment screening of four different protein targets. We refer in this work to the “active” spectra as the spectra of those fragments that cause CSP, when compared to the protein reference spectrum for each dataset. On the other hand, the “inactive” spectra are the spectra generated by fragments that are not interacting with the protein, thus not causing any noticeable CSP. A “broken” spectrum is defined when problems in locking or shimming of the samples caused unreadable or very noisy spectra.</p>
    <p id="p0050">Spectral CSP plots were generated using the TopSpin 3.2 (Bruker) automatic peak picking algorithm and exported as XML files for each experiment, keeping the minimum intensity contour threshold limits as the intensity of the reference spectrum in the dataset. The limits for the F1 and F2 dimensions of the spectra were also set in order to exclude the noise due to the water signal in the F1 region (lower limit higher than 6 ppm) in order to avoid peak picking of the noise signals. While this approach is subject to the accuracy of the peak picking capabilities of TopSpin software, we decided to use this method to test our proof-of-concept ML-based discriminator.</p>
    <p id="p0055">We trained the ML model using randomly-picked experiments from all four protein datasets which were previously processed by expert NMR spectroscopists. The total set of experiments available for analysis consisted of 1611 2-D HSQC NMR spectra recorded after screening our in-house library of 1500 fragments. The full dataset contained both spectra recorded using cocktail pools of fragments, as well as single ligand pools used for deconvolution. The screening campaigns were conducted against four different protein targets. A total number of 32 active spectra were then mixed with randomly-picked inactive and noisy spectra coming from each of the available protein datasets, creating training sets consisting of 100 spectra (6.2% of the total number of spectra). The aim of the mixed sampling was to avoid overfitting of the model and avoid introducing a bias toward one of the datasets with the highest amount of active spectra. We then trained the discriminator using a training set of randomly-picked selections from active and inactive spectra in all the datasets. Validation was then performed on all the available experiments. Even with a small training set, the algorithm was capable of identifying the spectra correctly with good efficiency (<xref rid="f0005" ref-type="fig">Fig. 1</xref>).<fig id="f0005"><label>Fig. 1</label><caption><p>Machine Learning-based discriminator results for protein datasets. In Figure is reported the overall performance of the ML analysis. Correct predictions refer to the number of experiments that were identified correctly by the ML-based discriminator, as compared to the user selection (marked as “active” or “inactive”, depending on the CSPs). False positives refer to those experiments that were predicted as “inactive” while the manual user marked them as “active”. False negatives refer to the number of experiments that were marked as “active” by the ML-based discriminator but marked as “inactive” by the user. The results displayed are referred to FBS campaigns against four different proteins. For each protein, the first stacked column represents the distribution of the experiments after manual selection; the second column summarizes the results of the automated analysis. The third stacked column shows the distribution of the statistics of the discriminator, reporting for each protein the number of correct predictions, false positives and false negatives in the corresponding datasets.</p></caption><graphic xlink:href="gr1"/></fig></p>
    <p id="p0060">The relatively high number of false positives identified by the ML analysis is due to the fact that the algorithm was designed in order to include all the spectral plots that are consistently different from the given reference spectrum. While this approach impacts negatively on the overall accuracy of the predictions, it keeps the number of false negatives as low as possible. Ultimately, the purpose of this method is to avoid the case that potentially active compounds are not identified and reported to the user during the FBS campaign data processing.</p>
    <p id="p0065">On the other hand, noisy spectra or partially failed experiments may be reported as actives when they are not. In light of this, the parameters chosen for peak picking in TopSpin are crucial for a correct analysis. Protein 4 is an example of a dataset containing experiments with very variable background noise and low-intensity local peak clustering. Due to this behavior, the identification of active pools for this specific target represented a challenging task even for the human experimentalist. Nevertheless, the ML analysis was capable of recalling the interesting experiments keeping the false-negative rate low, thus confirming its robustness and efficiency.</p>
    <p id="p0070">With an average model accuracy of 0.87, we demonstrated that the ML-discriminator can be used to assist in the rapid processing of hundreds of spectra, whilst maintaining good reliability.</p>
    <p id="p0075">Furthermore, with the graphical user interface (GUI) of the CSP Analyzer, which is designed to handle, display and process several hundred spectra as efficiently as possible, the user can easily keep track of the status of the analysis and get an overall estimation of the dataset quality. At the end of the analysis, all the data can be exported and saved either as a PDF report or as an Excel spreadsheet.</p>
  </sec>
  <sec id="s0015">
    <label>3</label>
    <title>Frontend</title>
    <sec id="s0020">
      <label>3.1</label>
      <title>GUIi</title>
      <p id="p0080">The GUI for the CSP analyzer (<xref rid="f0010" ref-type="fig">Fig. 2</xref>) is written in C# using the .NET Framework 4.6 available in Microsoft Visual Studio 2017 Community Edition. Plots and graphs use the LiveCharts 0.9.1 libraries <xref rid="b0140" ref-type="bibr">[28]</xref>.<fig id="f0010"><label>Fig. 2</label><caption><p>GUI of the CSP Analyzer.</p></caption><graphic xlink:href="gr2"/></fig></p>
      <p id="p0085">The user can browse through folders, select and load the XML file for the reference spectrum in the dataset. A custom lower-bound intensity threshold high-pass filter can be set independently for the reference and for the dataset in order to deal with eventual noisy peak picking. Once the reference is loaded, the spectral plot XML files for the desired dataset can be loaded at once by selecting a folder that contains all of the files. Only experiments that contain the proper “peaklist.xml” files will be displayed and overlaid with the reference spectrum. A message will display a log of the loading process, reporting back to the user in the event of an empty folder (i.e. failed experiment).</p>
      <p id="p0090">The user interface displays useful information about the NMR screening data, such as the total number of peaks in both the reference spectrum and the dataset spectrum, the peak number difference between the overlaid experiments, the minimum and the maximum intensity, the average minimum and maximum intensities in the dataset and the average number of peaks in the dataset experiments. <xref rid="f0015" ref-type="fig">Fig. 3</xref> shows a side-by-side comparison of the spectra rendering for experiments marked respectively as active, inactive and broken or noisy spectrum from the processed datasets used for validation and analysis.<fig id="f0015"><label>Fig. 3</label><caption><p>Side-by-side comparison of CSP maps for experiments marked as active (A, B), inactive (C, D) and noisy or broken spectrum (E, F). For reader reference: TopSpin visualization is always shown in the left panel, while CSP Analyzer rendering results are always shown in the right panel. The diameter of the peaks in the CSP Analyzer rendering corresponds to the absolute intensity of the peak in the output XML file after TopSpin peak picking. After mouse-over on a peak, its coordinates and the intensity will be shown as a popup message. If the automatic analysis is performed, the spectra can be clustered by their activity and the user can cycle to the selected subset only from the respective panel in the GUI.</p></caption><graphic xlink:href="gr3"/></fig></p>
      <p id="p0095">A control module can be used to skim quickly through the dataset experiments. A go-to function allows quick navigation to the selected experiment.</p>
      <p id="p0100">All the plots are fully zoomable and the probability and peak difference distribution bar plots are also clickable. Customized keyboard shortcuts are available in order to facilitate the use of the program (<xref rid="f0020" ref-type="fig">Fig. 4</xref>).<fig id="f0020"><label>Fig. 4</label><caption><p>A list of available keyboard shortcuts for the CSP Analyzer GUI.</p></caption><graphic xlink:href="gr4"/></fig></p>
      <p id="p0105">Furthermore, clicking on the “Help” button, the user can access a troubleshooting guide for known issues (such as memory exceptions that may be caused by the Conda environment distributed with the software package) and some guidelines to optimize peak picking in TopSpin. To this purpose, a string-generator module can be used to easily generate command-line strings with the proper syntax required by TopSpin peak-picking automation.</p>
      <p id="p0110">Before running the ML-backend discriminator for analysis, the software converts the spectra loaded according to the noise-filter to JSON strings using the Newtonsoft JSON serializer libraries available for C# .NET framework. <xref rid="b0145" ref-type="bibr">[29]</xref> The processed JSON may be also be saved to a custom path for further processing (i.e. for training purposes). After the analysis, the user can selectively display the subsets marked as “active” or as “inactive” by the ML-discriminator and use the player module to skim through the desired experiments. A list of keyboard shortcuts can be displayed by clicking on the corresponding button. The user can mark a spectrum in the dataset manually as “active” or “inactive” using the respective buttons in the overlay area. The status can be reset at any time using the respective button.</p>
      <p id="p0115">Clicking the “Export” button a new window (<xref rid="f0025" ref-type="fig">Fig. 5</xref>) with a detailed overview of the analysis data will be shown; the user can choose if print the analysis output (either sending the job to an installed printer or to PDF) or export the data analysis to Excel for further processing.<fig id="f0025"><label>Fig. 5</label><caption><p>Export window with printing preview and a sample dataset exported to Excel.</p></caption><graphic xlink:href="gr5"/></fig></p>
      <p id="p0120">Distributed with the software package is provided a separate program, named PeakListExtractor.exe, that can be used to retrieve only the peak lists generated after peak picking preserving the same folder-tree structure used by TopSpin, thus avoiding to copy the full experiments data on the local drive. For the ease of deployability for this and future versions of the CSP Analyzer, we decided to build a Miniconda environment (<ext-link ext-link-type="uri" xlink:href="https://docs.conda.io/en/latest/miniconda.html" id="ir010">https://docs.conda.io/en/latest/miniconda.html</ext-link>) containing the framework and the libraries required for the ML discriminator which is distributed with the software release.</p>
      <p id="p0125">The software package can be downloaded from GitHub <ext-link ext-link-type="uri" xlink:href="https://github.com/rubbs14/CSP-Analyzer/releases/tag/v1.0" id="ir015">https://github.com/rubbs14/CSP-Analyzer/releases/tag/v1.0</ext-link> as a Visual Studio C# project, which can then be compiled to generate the binaries (among with the Miniconda3 and the ML framework) needed to run the program. The project can be also forked from the original GitHub repository. A demo dataset for testing the correct installation is provided alongside the build binaries and is located in the folder from where the software is launched.</p>
    </sec>
  </sec>
  <sec id="s0025">
    <label>4</label>
    <title>Backend</title>
    <sec id="s0030">
      <label>4.1</label>
      <title>Computational assessment</title>
      <p id="p0130">Whilst in the early versions of the software we approached the active identification issue using a purely analytical method based on local distance calculation using a customized version of the Hungarian algorithm (HA) <xref rid="b0150" ref-type="bibr">[30]</xref>, this approach was seen to give an high false-negative rate (FNR), defined as the ratio of false negatives to the sum of false-negative and true positives.</p>
      <p id="p0135">In our modified HA routine, for each spectrum in the dataset a local search for nearby the assigned reference peaks is computed. If the distance of the peaks in the tested spectrum to the peaks in the reference is more than 0 and below a defined threshold (0.4 ppm for the F1 and 0.04 ppm for F2), then the peak is considered as a “moved” and its shift is added to the total sum of differences reported to the user for each spectrum. If the shift is above this threshold the peak is defined as “missing” and the total number of “missing” peaks is also presented to the user, thus indicating some interaction with the protein or an acquisition problem; such a spectrum is thus considered as an active upon user review. If there are no peaks moving, then the spectrum is marked as inactive.</p>
      <p id="p0140">In <xref rid="t0005" ref-type="table">Table 1</xref> is reported a side-by-side comparison of the performances between the analytical approach based on the customized Hungarian method and our ML-based discriminator.<table-wrap position="float" id="t0005"><label>Table 1</label><caption><p>Comparison of HA and ML discriminators versus the user selection for each protein tested. FP and FN refer to false positives and false negatives respectively; TA and TI refer to predicted true actives and predicted true inactives. CP is the total number of correct predictions (TA + TI); accuracy is the correct prediction rate and is defined as CP over the number of the total experiments. FNR refers to the false-negative rate and is defined as the ratio between the number of FN to the sum of the TA and FN; FPR is the false-positive rate, defined as the ratio between the number of FP and the sum of the TI and FP. Sensitivity is calculated as 1 – FNR; specificity is calculated as TI over the sum of TI and FP. MCC is the Matthews correlation coefficient <xref rid="b0155" ref-type="bibr">[31]</xref>.</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th colspan="2">Protein 1</th><th colspan="2">Protein 2</th><th colspan="2">Protein 3</th><th colspan="2">Protein 4</th><th colspan="2">Total</th></tr></thead><tbody><tr><td>Actives<sub>Manual</sub></td><td colspan="2">13</td><td colspan="2">67</td><td colspan="2">45</td><td colspan="2">51</td><td colspan="2">176</td></tr><tr><td>Inactives<sub>Manual</sub></td><td colspan="2">321</td><td colspan="2">212</td><td colspan="2">519</td><td colspan="2">383</td><td colspan="2">1435</td></tr><tr><td>Total</td><td colspan="2">334</td><td colspan="2">279</td><td colspan="2">564</td><td colspan="2">434</td><td colspan="2">1611</td></tr><tr><td colspan="11">  </td></tr><tr><td/><td>HA</td><td>ML</td><td>HA</td><td>ML</td><td>HA</td><td>ML</td><td>HA</td><td>ML</td><td>HA</td><td>ML</td></tr><tr><td colspan="11"><hr/></td></tr><tr><td>Actives</td><td>1</td><td>28</td><td>53</td><td>73</td><td>6</td><td>63</td><td>97</td><td>128</td><td>157</td><td>292</td></tr><tr><td>Inactives</td><td>333</td><td>306</td><td>226</td><td>206</td><td>558</td><td>501</td><td>337</td><td>306</td><td>1454</td><td>1319</td></tr><tr><td>FP</td><td>1</td><td>20</td><td>15</td><td>11</td><td>6</td><td>40</td><td>74</td><td>95</td><td>96</td><td>166</td></tr><tr><td>FN</td><td>13</td><td>5</td><td>29</td><td>5</td><td>45</td><td>22</td><td>28</td><td>18</td><td>115</td><td>50</td></tr><tr><td>TA</td><td>0</td><td>8</td><td>38</td><td>62</td><td>0</td><td>23</td><td>23</td><td>33</td><td>61</td><td>126</td></tr><tr><td>TI</td><td>320</td><td>301</td><td>197</td><td>201</td><td>513</td><td>479</td><td>309</td><td>288</td><td>1339</td><td>1269</td></tr><tr><td>CP</td><td>320</td><td>309</td><td>235</td><td>263</td><td>513</td><td>502</td><td>332</td><td>321</td><td>1400</td><td>1395</td></tr><tr><td>Accuracy</td><td>0.96</td><td>0.93</td><td>0.84</td><td>0.94</td><td>0.91</td><td>0.89</td><td>0.76</td><td>0.74</td><td>0.87</td><td>0.87</td></tr><tr><td>FP (%)</td><td>0.30</td><td>5.99</td><td>5.38</td><td>3.94</td><td>1.06</td><td>7.09</td><td>17.05</td><td>21.89</td><td>5.96</td><td>10.30</td></tr><tr><td>FN (%)</td><td>3.89</td><td>1.50</td><td>10.39</td><td>1.79</td><td>7.98</td><td>3.90</td><td>6.45</td><td>4.15</td><td>7.14</td><td>3.10</td></tr><tr><td>Sensitivity</td><td>0.00</td><td>0.62</td><td>0.57</td><td>0.93</td><td>0.00</td><td>0.51</td><td>0.45</td><td>0.65</td><td>0.35</td><td>0.72</td></tr><tr><td>Specificity</td><td>1.00</td><td>0.94</td><td>0.93</td><td>0.95</td><td>0.99</td><td>0.92</td><td>0.81</td><td>0.75</td><td>0.93</td><td>0.88</td></tr><tr><td>FNR</td><td>1.00</td><td>0.38</td><td>0.43</td><td>0.07</td><td>1.00</td><td>0.49</td><td>0.55</td><td>0.35</td><td>0.65</td><td>0.28</td></tr><tr><td>FPR</td><td>0.00</td><td>0.06</td><td>0.07</td><td>0.05</td><td>0.01</td><td>0.08</td><td>0.19</td><td>0.25</td><td>0.07</td><td>0.12</td></tr><tr><td>MCC</td><td>−0.01</td><td>0.39</td><td>0.54</td><td>0.85</td><td>−0.03</td><td>0.37</td><td>0.20</td><td>0.28</td><td>0.29</td><td>0.49</td></tr></tbody></table></table-wrap></p>
      <p id="p0145">While the overall accuracy of both HA and ML discriminators are comparable, the FNR is considerably lower for the ML-based analysis. This is a highly desired feature for an automatic discriminator because a high number of false negatives means that some of the active fragments may not be considered during the processing of the FBS data.</p>
      <p id="p0150">Our model had to cope with three major issues to make successful predictions; first, that protein spectra vary substantially from protein to protein, second, that the binding of a ligand results in different peak behavior depending on which specific residues it interacts with, and thirdly, that we have very imbalanced outcomes, with, in general, many more inactives than actives, but with the minority class the more interesting of the two for end-users.</p>
      <p id="p0155">From the user perspective, we aimed to create intuitive, reliable software to facilitate the rapid analysis of many spectra, and rigorously distinguish the actives from the inactives, to help the user optimizing their workflow and standardizing results.</p>
    </sec>
    <sec id="s0035">
      <label>4.2</label>
      <title>Spectrum processing</title>
      <p id="p0160">To minimize the difficulty of resolving the first and second issues, we optimized the input representation passed to our machine-learning model by adopting a range of approaches from the field of computer vision and image analysis. This results in a fifteen element vector for each spectrum, representing the structural transformation between it and the spectrum provided as a reference.</p>
      <p id="p0165">Broadly, these can be divided into two approaches, descriptor-based and statistical. Beginning with the descriptor approaches, the histograms of oriented gradients (HOG) approach <xref rid="b0160" ref-type="bibr">[32]</xref> describes the distribution of ‘edges’ (regions of high peak concentration) in an image, capturing information on local contours, silhouette, and some associated textural information. The local peak contour map is then binned, and compared to a similarly-prepared reference representation.</p>
      <p id="p0170">To account for the appearance and disappearance of peaks, we also register the translation of our query on the reference <xref rid="b0165" ref-type="bibr">[33]</xref>. This approach determines the shifts that would be required to map one onto the other by cross-correlation, with a zero-error, zero-phase result indicating that they are identical. Rather than using the shifts themselves, we consider the error term which incorporates them, and the sum of the phase-difference. The phase-difference term takes the sum of the absolute position-wise differences between spectra.</p>
      <p id="p0175">The last of these is the oriented FAST and rotated BRIEF (ORB) <xref rid="b0170" ref-type="bibr">[34]</xref> method for point-matching. It differs from the other methods discussed in that it attempts an explicit mapping between points in the reference and the query spectra, and can cope with an affine transformation from one to the other. We then calculate pairwise distances between the observed features and retain the largest ten of these to capture those points with most movement, which are likely those corresponding to the on-target binding, if present. In addition, we take the median of all ORB distance values to give a more general measure of the degree of peak-shifting between spectra.</p>
      <p id="p0180">Coming from another perspective, we begin with the structural similarity index <xref rid="b0175" ref-type="bibr">[35]</xref>. This is a highly noise-sensitive measure of the structural ‘integrity’ of our query spectrum compared to the reference. Its inclusion allows for the incorporation of information about the relative noisiness of our spectrum, and also a bulk-similarity measure. When compared to mean square error (MSE), a simple measure of the squared intensity difference, pixel-to-pixel, of two images, the structural similarity index produces a more human-consistent value, punishing images with a lot of Gaussian noise <xref rid="b0180" ref-type="bibr">[36]</xref>. Similarly, we employ the well-established Hu moment estimation <xref rid="b0185" ref-type="bibr">[37]</xref> to calculate the invariant properties of the reference and query spectra. These allow us to capture information about the localized dispersion of peaks in our frame of reference. We then take a simple paired-distance approach to compare the similarity of the two spectra. The final elements of this statistical approach that are included are the traditional normalized MSE and peak signal-to-noise ratio as absolute comparators, although their performance is somewhat lower than the aforementioned methods on most image-analysis tasks. As an additional simple metric, we include the difference in Jensen-Shannon entropy between the spectra (<xref rid="f0030" ref-type="fig">Fig. 6</xref>).<fig id="f0030"><label>Fig. 6</label><caption><p>Overview of the ML discriminator approach. Given a set of CSP peak lists (prepared as discussed above), along with a chosen reference peak list, the program calculates a set of computer vision-based descriptors for each. During training, the provided peak lists have an associated label, indicating whether or not they are associated with a binding event. These labels are then used, in the first instance, to facilitate synthetic enhancement through the SMOTE-ENN data synthesis approach, essentially generating ‘fake’ examples of what a binding-associated peak list looks like. In both training and prediction modes, each peak list is then compared to the annotated reference, and the set of per-element distances used passed to a dimensionality-reduction approach (PCA). Finally, these reduced, comparative distance vectors are passed to a support-vector classifier (SVC). In the case of training, the associated labels are also provided to this algorithm, in which case it is directed to learn a maximally-separating hyperplane between the set of peak lists considered active, and those considered inactive. In addition, the kernel is directed to learn a calibrated probability, i.e. to produce probabilistic assessments of a given novel peak list indicating binding, given what it has seen before. In the prediction case, this ‘pseudo-probability’ is then returned to the end-user.</p></caption><graphic xlink:href="gr6"/></fig></p>
    </sec>
    <sec id="s0040">
      <label>4.3</label>
      <title>Machine-learning discriminator</title>
      <p id="p0185">From the machine-learning perspective, the imbalance in our data classes represents a significant challenge, with the regions of our descriptor space containing inactives considerably more densely populated than the rest. This also means that any machine-learning algorithm can perform relatively well by always predicting a spectrum as inactive, given their relative abundance. Two solutions to this problem are to weight our predictions, such that the model places equal importance on the relatively few actives as the many inactives, or data synthesis (also known as oversampling), where we create pseudo-actives, based on similarity in their descriptor representation. For training our model, we trialed both of these methods, ultimately deciding on the latter on the basis of performance.</p>
      <p id="p0190">The synthetic active spectra were generated combining synthetic minority over-sampling technique (SMOTE) <xref rid="b0190" ref-type="bibr">[38]</xref> with edited nearest-neighbor under-sampling (ENN) <xref rid="b0195" ref-type="bibr">[39]</xref> (SMOTE-ENN). SMOTE generates new data examples by considering pairs of active spectra, and generating synthetic data with descriptor vectors intermediate between the two samples. ENN cleans up the resulting data representation by removing points whose nearest neighbors have mixed classes. We used this to balance the number of experimental inactives and mixed experimental-synthetic active spectra.</p>
      <p id="p0195">To reduce the impact of highly-correlated data in our input representation, we undertook dimensionality reduction of the input by means of principal components analysis (PCA), projecting into a lower-dimensional space and identifying combinations of input features which capture most of the variance in the data. Given the impact of widely-varying units in estimating the contribution of each component, it was necessary to first normalize each element of the vectors by use of a robust scaler which scales according to the interquartile range. This method is somewhat more resilient in the presence of outliers than mean scaling.</p>
      <p id="p0200">As we wished to delineate a region of this space that captures inactive spectra, support-vector classification (SVC) was a natural choice. Briefly, this approach transforms a set of data that cannot be easily separated in the input space into a higher-dimensional space where it is possible, using a kernel approach. We utilized a radial basis function kernel, with heavy error penalization (C = 3), and enable classification probability estimation. This latter component is accomplished by Platt scaling, which fits a logistic regression model to the classification scores produced by the model. This allows us to return some measure of the model’s confidence about any given spectrum to the end-user, and therefore to rank them in a natural way. Our parameters were optimized so as to minimize the false-negative rate.</p>
    </sec>
  </sec>
  <sec id="s0045">
    <label>5</label>
    <title>Conclusions and future development</title>
    <p id="p0205">Our method is capable of discriminating and recalling with good reliability the spectra which show sufficient change, promoting greater efficiency in screening analysis, and reduction of human bias induced by the repetitive nature of the task. While the program currently relies on third-party software for peak picking, future versions might directly utilize raw NMR time-domain data in order to create a comprehensive NMR analysis tool for FBDD. Allowing the user to adjust the intensity levels to their needs and set the thresholds for peak picking, would be a logical extension of the GUI. We also considered implementing functionalities to bridge the visualization module with available NMR data processing and visualization tools currently available, such as NMRPipe <xref rid="b0200" ref-type="bibr">[40]</xref>, PINT <xref rid="b0205" ref-type="bibr">[41]</xref>, NMRView <xref rid="b0210" ref-type="bibr">[42]</xref>, Sparky <xref rid="b0215" ref-type="bibr">[43]</xref>, and CCPNMR <xref rid="b0135" ref-type="bibr">[27]</xref>. While the CSP Analyzer was designed to screen HSQC <sup>1</sup>H-<sup>15</sup>N spectra, it could also be used for <sup>1</sup>H–<sup>13</sup>C or any other bidimensional experiment. To facilitate this, a module for automatic recognition of the F1 and F2 dimensions could be added. We also considered the development of a KNIME <xref rid="b0220" ref-type="bibr">[44]</xref> node for the CSP Analyzer which could then be interfaced with a general workflow for batch NMR data processing.</p>
    <p id="p0210">The backend utilizes several established computer vision approaches, coupled with Machine Learning, to achieve solid results in the recall of active-labeled spectra. Future work might replace this image-based approach with a model that can directly analyze waveform data <xref rid="b0225" ref-type="bibr">[45]</xref>, perhaps combined with some more direct means of determining which noise level can be safely ignored <xref rid="b0230" ref-type="bibr">[46]</xref>.</p>
    <p id="p0215">Overall, however, the relatively simple framework set out here sufficed to achieve good recall on a laborious task. It is uncertain how much of the gap from perfect recall to that achieved is owing to ambiguity and variation between experts in analysis of these spectra, but, in general, we could demonstrate that the speed of NMR FBDD data analysis can be greatly improved using our implementation of Machine Learning methods without a substantial decline in accuracy.</p>
  </sec>
  <sec id="s0050">
    <label>6</label>
    <title>Materials and methods</title>
    <sec id="s0055">
      <label>6.1</label>
      <title>NMR fragment-based screening</title>
      <p id="p0220">The in-house libraries of fragments were purchased from Thermo. Aqueous protein solutions of approximately 100 μM concentration with 10% D<sub>2</sub>O were added to 1.8 µL of fragment cocktails dissolved in deuterated DMSO in a 96-well plate with a total volume of 180 µL. Samples of 160 µL were then transferred to 3 mm NMR tubes using a Gilson liquid handling robot and So-fast HMQC or HSQC spectra were recorded at 298 K using Bruker Avance 600 MHz spectrometer equipped with a 5 mm QCI cryo-cooled probe head. A reference sample was made with d6-DMSO instead of fragment solution.</p>
    </sec>
  </sec>
  <sec id="s0060">
    <title>Fundings</title>
    <p id="p0225">This work was supported by the <funding-source id="gp005">European Union’s Framework Programme for Research and Innovation Horizon 2020</funding-source> (2014–2020) under the Marie Skłodowska-Curie Grant Agreement No. 675555, Accelerated Early staGe drug dIScovery (AEGIS) for the economic support. This work is also supported by the <funding-source id="gp010">Helmholtz Association Initiative and Networking Funds</funding-source> under project number ZT-I-0003.</p>
  </sec>
  <sec id="s0065">
    <title>Author contributions</title>
    <p id="p0230">R.F. designed and wrote the code for the GUI and all the C# modules in the frontend application framework, R.B. wrote and validated the ML algorithm and built the Miniconda environment for the backend processing; C.A.S. expressed some of the proteins used in the NMR screening; R.F., C.A.S., and G.M.P. recorded and processed NMR spectra. M.S., G.S., and G.M.P. provided assistance and technical supervision. R.F., R.B., and C.A.S. wrote the manuscript and M.S., G.S., and G.M.P. helped with corrections and scientific advice.</p>
  </sec>
  <sec id="s0070">
    <title>Declaration of competing interest</title>
    <p id="p0235">The authors declare no conflict of interest.</p>
  </sec>
  <sec id="s0075">
    <title>CRediT authorship contribution statement</title>
    <p id="p0240"><bold>R. Fino:</bold> Conceptualization, Methodology, Software, Validation, Formal analysis, Investigation, Data curation, Writing - original draft, Writing - review &amp; editing, Visualization. <bold>R. Byrne:</bold> Conceptualization, Methodology, Software, Validation, Formal analysis, Data curation, Writing - original draft, Writing - review &amp; editing, Visualization. <bold>C.A. Softley:</bold> Resources, Investigation, Data curation, Writing - original draft, Writing - review &amp; editing. <bold>M. Sattler:</bold> Supervision, Project administration, Writing - review &amp; editing, Funding acquisition. <bold>G. Schneider:</bold> Supervision, Project administration, Writing - review &amp; editing, Funding acquisition. <bold>G.M. Popowicz:</bold> Conceptualization, Methodology, Software, Writing - review &amp; editing, Supervision, Project administration, Funding acquisition.</p>
  </sec>
</body>
<back>
  <ref-list id="bi005">
    <title>References</title>
    <ref id="b0005">
      <label>1</label>
      <element-citation publication-type="journal" id="h0005">
        <person-group person-group-type="author">
          <name>
            <surname>Hann</surname>
            <given-names>M.M.</given-names>
          </name>
          <name>
            <surname>Leach</surname>
            <given-names>A.R.</given-names>
          </name>
          <name>
            <surname>Harper</surname>
            <given-names>G.</given-names>
          </name>
        </person-group>
        <article-title>Molecular complexity and its impact on the probability of finding leads for drug discovery</article-title>
        <source>J Chem Inf Comput Sci</source>
        <volume>41</volume>
        <issue>3</issue>
        <year>2001</year>
        <fpage>856</fpage>
        <lpage>864</lpage>
        <pub-id pub-id-type="pmid">11410068</pub-id>
      </element-citation>
    </ref>
    <ref id="b0010">
      <label>2</label>
      <element-citation publication-type="journal" id="h0010">
        <person-group person-group-type="author">
          <name>
            <surname>Rees</surname>
            <given-names>D.C.</given-names>
          </name>
        </person-group>
        <article-title>Fragment-based lead discovery</article-title>
        <source>Nat Rev Drug Discovery</source>
        <volume>3</volume>
        <issue>8</issue>
        <year>2004</year>
        <fpage>660</fpage>
        <pub-id pub-id-type="pmid">15286733</pub-id>
      </element-citation>
    </ref>
    <ref id="b0015">
      <label>3</label>
      <element-citation publication-type="journal" id="h0015">
        <person-group person-group-type="author">
          <name>
            <surname>Hajduk</surname>
            <given-names>P.J.</given-names>
          </name>
        </person-group>
        <article-title>NMR-based screening of proteins containing 13C-labeled methyl groups</article-title>
        <source>J Am Chem Soc</source>
        <volume>122</volume>
        <issue>33</issue>
        <year>2000</year>
        <fpage>7898</fpage>
        <lpage>7904</lpage>
      </element-citation>
    </ref>
    <ref id="b0020">
      <label>4</label>
      <element-citation publication-type="journal" id="h0020">
        <person-group person-group-type="author">
          <name>
            <surname>Gossert</surname>
            <given-names>A.D.</given-names>
          </name>
          <name>
            <surname>Jahnke</surname>
            <given-names>W.</given-names>
          </name>
        </person-group>
        <article-title>NMR in drug discovery: a practical guide to identification and validation of ligands interacting with biological macromolecules</article-title>
        <source>Prog Nucl Magn Reson Spectrosc</source>
        <volume>97</volume>
        <year>2016</year>
        <fpage>82</fpage>
        <lpage>125</lpage>
        <pub-id pub-id-type="pmid">27888841</pub-id>
      </element-citation>
    </ref>
    <ref id="b0025">
      <label>5</label>
      <element-citation publication-type="journal" id="h0025">
        <person-group person-group-type="author">
          <name>
            <surname>Jhoti</surname>
            <given-names>H.</given-names>
          </name>
        </person-group>
        <article-title>Fragment-based screening using X-ray crystallography and NMR spectroscopy</article-title>
        <source>Curr Opin Chem Biol</source>
        <volume>11</volume>
        <issue>5</issue>
        <year>2007</year>
        <fpage>485</fpage>
        <lpage>493</lpage>
        <pub-id pub-id-type="pmid">17851109</pub-id>
      </element-citation>
    </ref>
    <ref id="b0030">
      <label>6</label>
      <element-citation publication-type="journal" id="h0030">
        <person-group person-group-type="author">
          <name>
            <surname>Ludwig</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Guenther</surname>
            <given-names>U.L.</given-names>
          </name>
        </person-group>
        <article-title>Ligand based NMR methods for drug discovery</article-title>
        <source>Front Biosci</source>
        <volume>14</volume>
        <issue>4565–74</issue>
        <year>2009</year>
        <fpage>24</fpage>
      </element-citation>
    </ref>
    <ref id="b0035">
      <label>7</label>
      <element-citation publication-type="journal" id="h0035">
        <person-group person-group-type="author">
          <name>
            <surname>Mayer</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>B.</given-names>
          </name>
        </person-group>
        <article-title>Characterization of ligand binding by saturation transfer difference NMR spectroscopy</article-title>
        <source>Angew Chem Int Ed</source>
        <volume>38</volume>
        <issue>12</issue>
        <year>1999</year>
        <fpage>1784</fpage>
        <lpage>1788</lpage>
      </element-citation>
    </ref>
    <ref id="b0040">
      <label>8</label>
      <element-citation publication-type="journal" id="h0040">
        <person-group person-group-type="author">
          <name>
            <surname>Viegas</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Saturation-transfer difference (STD) NMR: a simple and fast method for ligand screening and characterization of protein binding</article-title>
        <source>J Chem Educ</source>
        <volume>88</volume>
        <issue>7</issue>
        <year>2011</year>
        <fpage>990</fpage>
        <lpage>994</lpage>
      </element-citation>
    </ref>
    <ref id="b0045">
      <label>9</label>
      <element-citation publication-type="journal" id="h0045">
        <person-group person-group-type="author">
          <name>
            <surname>Angulo</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Enríquez-Navas</surname>
            <given-names>P.M.</given-names>
          </name>
          <name>
            <surname>Nieto</surname>
            <given-names>P.M.</given-names>
          </name>
        </person-group>
        <article-title>Ligand–receptor binding affinities from saturation transfer difference (STD) NMR spectroscopy: the binding isotherm of STD initial growth rates</article-title>
        <source>Chem Eur J</source>
        <volume>16</volume>
        <issue>26</issue>
        <year>2010</year>
        <fpage>7803</fpage>
        <lpage>7812</lpage>
        <pub-id pub-id-type="pmid">20496354</pub-id>
      </element-citation>
    </ref>
    <ref id="b0050">
      <label>10</label>
      <element-citation publication-type="journal" id="h0050">
        <person-group person-group-type="author">
          <name>
            <surname>Dalvit</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <article-title>WaterLOGSY as a method for primary NMR screening: practical aspects and range of applicability</article-title>
        <source>J Biomol NMR</source>
        <volume>21</volume>
        <issue>4</issue>
        <year>2001</year>
        <fpage>349</fpage>
        <lpage>359</lpage>
        <pub-id pub-id-type="pmid">11824754</pub-id>
      </element-citation>
    </ref>
    <ref id="b0055">
      <label>11</label>
      <element-citation publication-type="journal" id="h0055">
        <person-group person-group-type="author">
          <name>
            <surname>Jahnke</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Rüdisser</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Zurini</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Spin label enhanced NMR screening</article-title>
        <source>J Am Chem Soc</source>
        <volume>123</volume>
        <issue>13</issue>
        <year>2001</year>
        <fpage>3149</fpage>
        <lpage>3150</lpage>
        <pub-id pub-id-type="pmid">11457032</pub-id>
      </element-citation>
    </ref>
    <ref id="b0060">
      <label>12</label>
      <element-citation publication-type="journal" id="h0060">
        <person-group person-group-type="author">
          <name>
            <surname>Hajduk</surname>
            <given-names>P.J.</given-names>
          </name>
          <name>
            <surname>Olejniczak</surname>
            <given-names>E.T.</given-names>
          </name>
          <name>
            <surname>Fesik</surname>
            <given-names>S.W.</given-names>
          </name>
        </person-group>
        <article-title>One-dimensional relaxation-and diffusion-edited NMR methods for screening compounds that bind to macromolecules</article-title>
        <source>J Am Chem Soc</source>
        <volume>119</volume>
        <issue>50</issue>
        <year>1997</year>
        <fpage>12257</fpage>
        <lpage>12261</lpage>
      </element-citation>
    </ref>
    <ref id="b0065">
      <label>13</label>
      <element-citation publication-type="journal" id="h0065">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Y.S.</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Wyss</surname>
            <given-names>D.F.</given-names>
          </name>
        </person-group>
        <article-title>Competition STD NMR for the detection of high-affinity ligands and NMR-based screening</article-title>
        <source>Magn Reson Chem</source>
        <volume>42</volume>
        <issue>6</issue>
        <year>2004</year>
        <fpage>485</fpage>
        <lpage>489</lpage>
        <pub-id pub-id-type="pmid">15137040</pub-id>
      </element-citation>
    </ref>
    <ref id="b0070">
      <label>14</label>
      <element-citation publication-type="journal" id="h0070">
        <person-group person-group-type="author">
          <name>
            <surname>Bodenhausen</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Ruben</surname>
            <given-names>D.J.</given-names>
          </name>
        </person-group>
        <article-title>Natural abundance nitrogen-15 NMR by enhanced heteronuclear spectroscopy</article-title>
        <source>Chem Phys Lett</source>
        <volume>69</volume>
        <issue>1</issue>
        <year>1980</year>
        <fpage>185</fpage>
        <lpage>189</lpage>
      </element-citation>
    </ref>
    <ref id="b0075">
      <label>15</label>
      <element-citation publication-type="journal" id="h0075">
        <person-group person-group-type="author">
          <name>
            <surname>Schanda</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Brutscher</surname>
            <given-names>B.</given-names>
          </name>
        </person-group>
        <article-title>Very fast two-dimensional NMR spectroscopy for real-time investigation of dynamic events in proteins on the time scale of seconds</article-title>
        <source>J Am Chem Soc</source>
        <volume>127</volume>
        <issue>22</issue>
        <year>2005</year>
        <fpage>8014</fpage>
        <lpage>8015</lpage>
        <pub-id pub-id-type="pmid">15926816</pub-id>
      </element-citation>
    </ref>
    <ref id="b0080">
      <label>16</label>
      <element-citation publication-type="journal" id="h0080">
        <person-group person-group-type="author">
          <name>
            <surname>Amero</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <article-title>Fast two-dimensional NMR spectroscopy of high molecular weight protein assemblies</article-title>
        <source>J Am Chem Soc</source>
        <volume>131</volume>
        <issue>10</issue>
        <year>2009</year>
        <fpage>3448</fpage>
        <lpage>3449</lpage>
        <pub-id pub-id-type="pmid">19243101</pub-id>
      </element-citation>
    </ref>
    <ref id="b0085">
      <label>17</label>
      <element-citation publication-type="journal" id="h0085">
        <person-group person-group-type="author">
          <name>
            <surname>Sattler</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Fesik</surname>
            <given-names>S.W.</given-names>
          </name>
        </person-group>
        <article-title>Use of deuterium labeling in NMR: overcoming a sizeable problem</article-title>
        <source>Structure</source>
        <volume>4</volume>
        <issue>11</issue>
        <year>1996</year>
        <fpage>1245</fpage>
        <lpage>1249</lpage>
        <pub-id pub-id-type="pmid">8939758</pub-id>
      </element-citation>
    </ref>
    <ref id="b0090">
      <label>18</label>
      <element-citation publication-type="journal" id="h0090">
        <person-group person-group-type="author">
          <name>
            <surname>Gardner</surname>
            <given-names>K.H.</given-names>
          </name>
          <name>
            <surname>Kay</surname>
            <given-names>L.E.</given-names>
          </name>
        </person-group>
        <article-title>The use of 2h, 13c, 15n multidimensional nmr gto study the structure and dynamics of proteins</article-title>
        <source>Annu Rev Biophys Biomol Struct</source>
        <volume>27</volume>
        <issue>1</issue>
        <year>1998</year>
        <fpage>357</fpage>
        <lpage>406</lpage>
        <pub-id pub-id-type="pmid">9646872</pub-id>
      </element-citation>
    </ref>
    <ref id="b0095">
      <label>19</label>
      <element-citation publication-type="journal" id="h0095">
        <person-group person-group-type="author">
          <name>
            <surname>Chuang</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Characterization of the drug binding specificity of rat liver fatty acid binding protein</article-title>
        <source>J Med Chem</source>
        <volume>51</volume>
        <issue>13</issue>
        <year>2008</year>
        <fpage>3755</fpage>
        <lpage>3764</lpage>
        <pub-id pub-id-type="pmid">18533710</pub-id>
      </element-citation>
    </ref>
    <ref id="b0100">
      <label>20</label>
      <element-citation publication-type="journal" id="h0100">
        <person-group person-group-type="author">
          <name>
            <surname>Patil</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>Characterization of two distinct modes of drug binding to human intestinal fatty acid binding protein</article-title>
        <source>ACS Chem Biol</source>
        <volume>9</volume>
        <issue>11</issue>
        <year>2014</year>
        <fpage>2526</fpage>
        <lpage>2534</lpage>
        <pub-id pub-id-type="pmid">25144524</pub-id>
      </element-citation>
    </ref>
    <ref id="b0105">
      <label>21</label>
      <element-citation publication-type="journal" id="h0105">
        <person-group person-group-type="author">
          <name>
            <surname>Sundell</surname>
            <given-names>G.N.</given-names>
          </name>
        </person-group>
        <article-title>The sign of nuclear magnetic resonance chemical shift difference as a determinant of the origin of binding selectivity: elucidation of the position dependence of phosphorylation in ligands binding to scribble PDZ1</article-title>
        <source>Biochemistry</source>
        <volume>57</volume>
        <issue>1</issue>
        <year>2017</year>
        <fpage>66</fpage>
        <lpage>71</lpage>
        <pub-id pub-id-type="pmid">29144123</pub-id>
      </element-citation>
    </ref>
    <ref id="b0110">
      <label>22</label>
      <element-citation publication-type="journal" id="h0110">
        <person-group person-group-type="author">
          <name>
            <surname>East</surname>
            <given-names>K.W.</given-names>
          </name>
        </person-group>
        <article-title>NMRdock: lightweight and modular NMR processing</article-title>
        <source>bioRxiv</source>
        <year>2019</year>
        <object-id pub-id-type="publisher-id">679688</object-id>
      </element-citation>
    </ref>
    <ref id="b0115">
      <label>23</label>
      <element-citation publication-type="journal" id="h0115">
        <person-group person-group-type="author">
          <name>
            <surname>Peng</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <article-title>Fast and efficient fragment-based lead generation by fully automated processing and analysis of ligand-observed NMR binding data</article-title>
        <source>J Med Chem</source>
        <volume>59</volume>
        <issue>7</issue>
        <year>2016</year>
        <fpage>3303</fpage>
        <lpage>3310</lpage>
        <pub-id pub-id-type="pmid">26964888</pub-id>
      </element-citation>
    </ref>
    <ref id="b0120">
      <label>24</label>
      <element-citation publication-type="book" id="h0120">
        <person-group person-group-type="author">
          <name>
            <surname>Willcott</surname>
            <given-names>M.R.</given-names>
          </name>
        </person-group>
        <chapter-title>MestRe Nova</chapter-title>
        <year>2009</year>
        <publisher-name>ACS Publications</publisher-name>
      </element-citation>
    </ref>
    <ref id="b0125">
      <label>25</label>
      <element-citation publication-type="journal" id="h0125">
        <person-group person-group-type="author">
          <name>
            <surname>Fukui</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y.</given-names>
          </name>
        </person-group>
        <article-title>NvMap: automated analysis of NMR chemical shift perturbation data</article-title>
        <source>Bioinformatics</source>
        <volume>23</volume>
        <issue>3</issue>
        <year>2006</year>
        <fpage>378</fpage>
        <lpage>380</lpage>
        <pub-id pub-id-type="pmid">17118956</pub-id>
      </element-citation>
    </ref>
    <ref id="b0130">
      <label>26</label>
      <element-citation publication-type="journal" id="h0130">
        <person-group person-group-type="author">
          <name>
            <surname>Peng</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <article-title>Automated evaluation of chemical shift perturbation spectra: New approaches to quantitative analysis of receptor-ligand interaction NMR spectra</article-title>
        <source>J Biomol NMR</source>
        <volume>29</volume>
        <issue>4</issue>
        <year>2004</year>
        <fpage>491</fpage>
        <lpage>504</lpage>
        <pub-id pub-id-type="pmid">15243180</pub-id>
      </element-citation>
    </ref>
    <ref id="b0135">
      <label>27</label>
      <element-citation publication-type="journal" id="h0135">
        <person-group person-group-type="author">
          <name>
            <surname>Vranken</surname>
            <given-names>W.F.</given-names>
          </name>
        </person-group>
        <article-title>The CCPN data model for NMR spectroscopy: development of a software pipeline</article-title>
        <source>Proteins Struct Funct Bioinf</source>
        <volume>59</volume>
        <issue>4</issue>
        <year>2005</year>
        <fpage>687</fpage>
        <lpage>696</lpage>
      </element-citation>
    </ref>
    <ref id="b0140">
      <label>28</label>
      <mixed-citation publication-type="other" id="h0140">Rodriguez, A., LiveCharts (0.9.97) – Simple, flexible, interactive &amp; powerful data visualization for .Net 2017</mixed-citation>
    </ref>
    <ref id="b0145">
      <label>29</label>
      <mixed-citation publication-type="other" id="h0145">Novak, M., Serialization Performance comparison (C#/.NET)–Formats &amp; Frameworks (XML–DataContractSerializer &amp; XmlSerializer, BinaryFormatter, JSON–Newtonsoft &amp; ServiceStack. Text, Protobuf, MsgPack). 2014, March.</mixed-citation>
    </ref>
    <ref id="b0150">
      <label>30</label>
      <element-citation publication-type="journal" id="h0150">
        <person-group person-group-type="author">
          <name>
            <surname>Kuhn</surname>
            <given-names>H.W.</given-names>
          </name>
        </person-group>
        <article-title>The Hungarian method for the assignment problem</article-title>
        <source>Naval research logistics quarterly</source>
        <volume>2</volume>
        <issue>1–2</issue>
        <year>1955</year>
        <fpage>83</fpage>
        <lpage>97</lpage>
      </element-citation>
    </ref>
    <ref id="b0155">
      <label>31</label>
      <element-citation publication-type="journal" id="h0155">
        <person-group person-group-type="author">
          <name>
            <surname>Matthews</surname>
            <given-names>B.W.</given-names>
          </name>
        </person-group>
        <article-title>Comparison of the predicted and observed secondary structure of T4 phage lysozyme</article-title>
        <source>Biochim Biophys Acta (BBA)-Protein Struct</source>
        <volume>405</volume>
        <issue>2</issue>
        <year>1975</year>
        <fpage>442</fpage>
        <lpage>451</lpage>
      </element-citation>
    </ref>
    <ref id="b0160">
      <label>32</label>
      <mixed-citation publication-type="other" id="h0160">Dalal, N. and B. Triggs. Histograms of oriented gradients for human detection. 2005</mixed-citation>
    </ref>
    <ref id="b0165">
      <label>33</label>
      <element-citation publication-type="journal" id="h0165">
        <person-group person-group-type="author">
          <name>
            <surname>Guizar-Sicairos</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Thurman</surname>
            <given-names>S.T.</given-names>
          </name>
          <name>
            <surname>Fienup</surname>
            <given-names>J.R.</given-names>
          </name>
        </person-group>
        <article-title>Efficient subpixel image registration algorithms</article-title>
        <source>Opt Lett</source>
        <volume>33</volume>
        <issue>2</issue>
        <year>2008</year>
        <fpage>156</fpage>
        <lpage>158</lpage>
        <pub-id pub-id-type="pmid">18197224</pub-id>
      </element-citation>
    </ref>
    <ref id="b0170">
      <label>34</label>
      <mixed-citation publication-type="other" id="h0170">Rublee, E., et al. ORB: an efficient alternative to SIFT or SURF. in ICCV. 2011. Citeseer.</mixed-citation>
    </ref>
    <ref id="b0175">
      <label>35</label>
      <element-citation publication-type="journal" id="h0175">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Z.</given-names>
          </name>
        </person-group>
        <article-title>Image quality assessment: from error visibility to structural similarity</article-title>
        <source>IEEE Trans Image Process</source>
        <volume>13</volume>
        <issue>4</issue>
        <year>2004</year>
        <fpage>600</fpage>
        <lpage>612</lpage>
        <pub-id pub-id-type="pmid">15376593</pub-id>
      </element-citation>
    </ref>
    <ref id="b0180">
      <label>36</label>
      <element-citation publication-type="journal" id="h0180">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Bovik</surname>
            <given-names>A.C.</given-names>
          </name>
        </person-group>
        <article-title>Mean squared error: Love it or leave it? A new look at signal fidelity measures</article-title>
        <source>IEEE Signal Process Mag</source>
        <volume>26</volume>
        <issue>1</issue>
        <year>2009</year>
        <fpage>98</fpage>
        <lpage>117</lpage>
      </element-citation>
    </ref>
    <ref id="b0185">
      <label>37</label>
      <element-citation publication-type="journal" id="h0185">
        <person-group person-group-type="author">
          <name>
            <surname>Hu</surname>
            <given-names>M.-K.</given-names>
          </name>
        </person-group>
        <article-title>Visual pattern recognition by moment invariants</article-title>
        <source>IRE Trans Inf Theory</source>
        <volume>8</volume>
        <issue>2</issue>
        <year>1962</year>
        <fpage>179</fpage>
        <lpage>187</lpage>
      </element-citation>
    </ref>
    <ref id="b0190">
      <label>38</label>
      <element-citation publication-type="journal" id="h0190">
        <person-group person-group-type="author">
          <name>
            <surname>Batista</surname>
            <given-names>G.E.</given-names>
          </name>
          <name>
            <surname>Prati</surname>
            <given-names>R.C.</given-names>
          </name>
          <name>
            <surname>Monard</surname>
            <given-names>M.C.</given-names>
          </name>
        </person-group>
        <article-title>A study of the behavior of several methods for balancing machine learning training data</article-title>
        <source>ACM SIGKDD Explor Newsl</source>
        <volume>6</volume>
        <issue>1</issue>
        <year>2004</year>
        <fpage>20</fpage>
        <lpage>29</lpage>
      </element-citation>
    </ref>
    <ref id="b0195">
      <label>39</label>
      <element-citation publication-type="journal" id="h0195">
        <person-group person-group-type="author">
          <name>
            <surname>Wilson</surname>
            <given-names>D.L.</given-names>
          </name>
        </person-group>
        <article-title>Asymptotic properties of nearest neighbor rules using edited data</article-title>
        <source>IEEE Trans Syst Man Cybern</source>
        <volume>3</volume>
        <year>1972</year>
        <fpage>408</fpage>
        <lpage>421</lpage>
      </element-citation>
    </ref>
    <ref id="b0200">
      <label>40</label>
      <element-citation publication-type="journal" id="h0200">
        <person-group person-group-type="author">
          <name>
            <surname>Delaglio</surname>
            <given-names>F.</given-names>
          </name>
        </person-group>
        <article-title>NMRPipe: a multidimensional spectral processing system based on UNIX pipes</article-title>
        <source>J Biomol NMR</source>
        <volume>6</volume>
        <issue>3</issue>
        <year>1995</year>
        <fpage>277</fpage>
        <lpage>293</lpage>
        <pub-id pub-id-type="pmid">8520220</pub-id>
      </element-citation>
    </ref>
    <ref id="b0205">
      <label>41</label>
      <element-citation publication-type="journal" id="h0205">
        <person-group person-group-type="author">
          <name>
            <surname>Ahlner</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>PINT: a software for integration of peak volumes and extraction of relaxation rates</article-title>
        <source>J Biomol NMR</source>
        <volume>56</volume>
        <issue>3</issue>
        <year>2013</year>
        <fpage>191</fpage>
        <lpage>202</lpage>
        <pub-id pub-id-type="pmid">23657843</pub-id>
      </element-citation>
    </ref>
    <ref id="b0210">
      <label>42</label>
      <element-citation publication-type="book" id="h0210">
        <person-group person-group-type="author">
          <name>
            <surname>Johnson</surname>
            <given-names>B.A.</given-names>
          </name>
        </person-group>
        <chapter-title>Using NMRView to visualize and analyze the NMR spectra of macromolecules</chapter-title>
        <source>Protein NMR Techniques</source>
        <year>2004</year>
        <publisher-name>Springer</publisher-name>
        <fpage>313</fpage>
        <lpage>352</lpage>
      </element-citation>
    </ref>
    <ref id="b0215">
      <label>43</label>
      <element-citation publication-type="journal" id="h0215">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Tonelli</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Markley</surname>
            <given-names>J.L.</given-names>
          </name>
        </person-group>
        <article-title>NMRFAM-SPARKY: enhanced software for biomolecular NMR spectroscopy</article-title>
        <source>Bioinformatics</source>
        <volume>31</volume>
        <issue>8</issue>
        <year>2014</year>
        <fpage>1325</fpage>
        <lpage>1327</lpage>
        <pub-id pub-id-type="pmid">25505092</pub-id>
      </element-citation>
    </ref>
    <ref id="b0220">
      <label>44</label>
      <element-citation publication-type="journal" id="h0220">
        <person-group person-group-type="author">
          <name>
            <surname>Berthold</surname>
            <given-names>M.R.</given-names>
          </name>
        </person-group>
        <article-title>KNIME-the Konstanz information miner: version 2.0 and beyond</article-title>
        <source>ACM SIGKDD Explor Newsl</source>
        <volume>11</volume>
        <issue>1</issue>
        <year>2009</year>
        <fpage>26</fpage>
        <lpage>31</lpage>
      </element-citation>
    </ref>
    <ref id="b0225">
      <label>45</label>
      <mixed-citation publication-type="other" id="h0225">Oord, A.v.d., et al., Wavenet: a generative model for raw audio. arXiv preprint arXiv:1609.03499, 2016.</mixed-citation>
    </ref>
    <ref id="b0230">
      <label>46</label>
      <element-citation publication-type="journal" id="h0230">
        <person-group person-group-type="author">
          <name>
            <surname>Vincent</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>Stacked denoising autoencoders: Learning useful representations in a deep network with a local denoising criterion</article-title>
        <source>J Mach Learn Res</source>
        <volume>11</volume>
        <year>2010</year>
        <fpage>3371</fpage>
        <lpage>3408</lpage>
      </element-citation>
    </ref>
  </ref-list>
  <sec id="s0085" sec-type="supplementary-material">
    <label>Appendix A</label>
    <title>Supplementary data</title>
    <p id="p0255">The following are the Supplementary data to this article:<supplementary-material content-type="local-data" id="m0005"><caption><title>Supplementary data 1</title></caption><media xlink:href="mmc1.xml"/></supplementary-material></p>
  </sec>
  <ack id="ak005">
    <title>Acknowledgments</title>
    <p>R.F. would like to thank Dr. Frank Delaglio for his suggestions and feedback and Prof. Michael Nilges for his help and supervision.</p>
  </ack>
  <fn-group>
    <fn id="s0080" fn-type="supplementary-material">
      <label>Appendix A</label>
      <p id="p0250">Supplementary data to this article can be found online at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.csbj.2020.02.015" id="ir020">https://doi.org/10.1016/j.csbj.2020.02.015</ext-link>.</p>
    </fn>
  </fn-group>
</back>
