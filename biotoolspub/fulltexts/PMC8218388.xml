<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8218388</article-id>
    <article-id pub-id-type="publisher-id">2404</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-021-02404-0</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SPARK-X: non-parametric modeling enables scalable and robust detection of spatial expression patterns for large spatial transcriptomic studies</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zhu</surname>
          <given-names>Jiaqiang</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sun</surname>
          <given-names>Shiquan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4331-7599</contrib-id>
        <name>
          <surname>Zhou</surname>
          <given-names>Xiang</given-names>
        </name>
        <address>
          <email>xzhousph@umich.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.214458.e</institution-id><institution-id institution-id-type="ISNI">0000000086837370</institution-id><institution>Department of Biostatistics, </institution><institution>University of Michigan, </institution></institution-wrap>Ann Arbor, MI 48109 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.214458.e</institution-id><institution-id institution-id-type="ISNI">0000000086837370</institution-id><institution>Center for Statistical Genetics, </institution><institution>University of Michigan, </institution></institution-wrap>Ann Arbor, MI 48109 USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.43169.39</institution-id><institution-id institution-id-type="ISNI">0000 0001 0599 1243</institution-id><institution>Department of Epidemiology and Biostatistics, </institution><institution>Xi’an Jiaotong University, </institution></institution-wrap>Xi’an, Shaanxi 710061 P.R. China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>21</day>
      <month>6</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>21</day>
      <month>6</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <elocation-id>184</elocation-id>
    <history>
      <date date-type="received">
        <day>22</day>
        <month>10</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>7</day>
        <month>6</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Spatial transcriptomic studies are becoming increasingly common and large, posing important statistical and computational challenges for many analytic tasks. Here, we present SPARK-X, a non-parametric method for rapid and effective detection of spatially expressed genes in large spatial transcriptomic studies. SPARK-X not only produces effective type I error control and high power but also brings orders of magnitude computational savings. We apply SPARK-X to analyze three large datasets, one of which is only analyzable by SPARK-X. In these data, SPARK-X identifies many spatially expressed genes including those that are spatially expressed within the same cell type, revealing new biological insights.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13059-021-02404-0.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Spatial transcriptomics</kwd>
      <kwd>SE analysis</kwd>
      <kwd>Covariance test</kwd>
      <kwd>Non-parametric modeling</kwd>
      <kwd>Slide-seq</kwd>
      <kwd>HDST</kwd>
      <kwd>SPARK</kwd>
      <kwd>SPARK-X</kwd>
      <kwd>Spatial expression pattern</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000051</institution-id>
            <institution>National Human Genome Research Institute</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01HG009124</award-id>
        <award-id>R01HG011883</award-id>
        <principal-award-recipient>
          <name>
            <surname>Zhou</surname>
            <given-names>Xiang</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000057</institution-id>
            <institution>National Institute of General Medical Sciences</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01GM126553</award-id>
        <award-id>R01GM144960</award-id>
        <principal-award-recipient>
          <name>
            <surname>Zhou</surname>
            <given-names>Xiang</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100008982</institution-id>
            <institution>National Science Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>DMS1712933</award-id>
        <principal-award-recipient>
          <name>
            <surname>Zhou</surname>
            <given-names>Xiang</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>National Institutes of Health </institution>
        </funding-source>
        <award-id>R01HD088558</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par2">Spatially resolved transcriptomic studies perform gene-expression profiling with spatial localization information on tissues and cell cultures [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>]. These studies allow us to examine the spatial expression patterns of genes on the tissue [<xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR6">6</xref>], characterizing local structures and microenvironments [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>] and detecting cell-cell interactions across spatial locations [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>]. Spatial transcriptomic studies are enabled by various spatial transcriptomic technologies that are rapidly evolving. While early spatial transcriptomic technologies are often small in scale with relatively low spatial resolution [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>], recent technologies, such as Slide-seq [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>] and high-definition spatial transcriptomics (HDST) [<xref ref-type="bibr" rid="CR15">15</xref>], have enabled transcriptome-wide profiling at micron resolution on tens or hundreds of thousands of spatial locations. The resulting large-scale spatial transcriptomic data, limited by sequencing depth, are also in sparse forms, with a prevalence of low counts and a substantial fraction of zero values (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). The sheer scale of these recent spatial transcriptomic data, paired with their sparse form, has created enormous computational and statistical challenges for many spatial transcriptomic analytic tasks.</p>
    <p id="Par3">A key analytic task in spatial transcriptomic studies is to identify genes that display spatial expression patterns, commonly referred to as SE genes. Such SE analysis is an important first step towards characterizing the spatial and functional organization of complex tissues [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>]. Common methods for performing SE analysis include trendsceek [<xref ref-type="bibr" rid="CR4">4</xref>], SpatialDE [<xref ref-type="bibr" rid="CR5">5</xref>], and SPARK [<xref ref-type="bibr" rid="CR6">6</xref>]. Unfortunately, even the latter two computationally efficient methods are not readily applicable for analyzing large-scale sparse spatial transcriptomic data that are being collected today [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR18">18</xref>]. Specifically, the computational complexity of both SpatialDE and SPARK scales cubically with respect to the number of spatial locations. Consequently, it would take days to months for either method to analyze large-scale spatial transcriptomic data. Similarly, the memory requirement of both SpatialDE and SPARK also scales cubically with respect to the number of spatial locations. Analyzing large-scale spatial transcriptomic data by either method would require dozens to thousands of GB physical RAM memory, which can be challenging to satisfy even on large computing clusters [<xref ref-type="bibr" rid="CR19">19</xref>]. Finally, the large-scale spatial transcriptomic data are often in the form of sparse counts with a prevalence of zero values. While the large fraction of zeros is not due to dropout events and can be effectively accounted for by an over-dispersed Poisson distribution (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S14), such sparse data is nevertheless challenging to model parametrically. Specifically, direct modeling of sparse count data with a negative binomial distribution or other over-dispersed Poisson distributions incurs algorithm stability issues [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR21">21</xref>], and, as will be shown below, can lead to a failure of convergence in more than 90% of genes in large-scale spatial transcriptomic data. On the other hand, approximate modeling of sparse count data by a Gaussian distribution as in SpatialDE and the Gaussian version of SPARK is not ideal either [<xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR23">23</xref>], as such parametric approximation leads to both power loss and failure of type I error control at small <italic>P</italic> values that are essential for detecting SE genes at the transcriptome-wide significance level.</p>
    <p id="Par4">Here, we present SPARK-X (SPARK-eXpedited), a scalable non-parametric test for SE analysis, that addresses the aforementioned challenges. SPARK-X builds upon a robust covariance test framework [<xref ref-type="bibr" rid="CR24">24</xref>–<xref ref-type="bibr" rid="CR27">27</xref>] and extends it to incorporating a variety of spatial kernels for non-parametric spatial modeling of sparse count data from large spatial transcriptomic studies. With additional algebraic innovations, SPARK-X reduces computational complexity and physical RAM memory requirement for SE analysis from cubic to linear with respect to the number of spatial locations, resulting in several orders of computational speed improvements and several orders of physical RAM memory savings as compared to existing approaches. Importantly, due to its non-parametric nature, SPARK-X is algorithmically stable and statistically robust with respect to the underlying data generative process, providing calibrated type I error control and improved power across a range of data types collected through a variety of technical platforms. We illustrate the benefits of SPARK-X via applications to three large-scale spatial transcriptomic data collected by different technologies, one of which is only analyzable by SPARK-X. In the analysis, we identified many new SE genes including those that display spatial expression pattern within the same cell type. These SE genes are involved in synaptic organization and functional compartmentalization of the cerebellum and involved in lateral inhibition and odor discrimination in the olfactory system.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>Simulations</title>
      <p id="Par5">A method schematic of SPARK-X is shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>A, with details provided in the “<xref rid="Sec8" ref-type="sec">Methods</xref>” section. We performed realistic simulations (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S16A) to evaluate the performance of SPARK-X and compare it with three existing approaches, the Poisson version of SPARK (SPARK), the Gaussian version of SPARK (SPARK-G) and SpatialDE. Simulation details are provided in the “<xref rid="Sec8" ref-type="sec">Methods</xref>”. Briefly, in each scenario, we generated coordinates for a fixed number of spatial locations through a random-point-pattern Poisson process and simulated 10,000 genes on the spatial locations based on a negative binomial distribution using parameters inferred from real data. We examined both type I error control under the null hypothesis and power for identifying SE genes under various alternatives. In the null simulations, all genes are non-SE genes with expression levels randomly distributed across spatial locations without any spatial patterns (Fig. <xref rid="Fig1" ref-type="fig">1</xref>D). In the alternative simulations, 9000 genes are non-SE genes, while 1000 genes are SE genes whose expression levels display one of the three spatial patterns (hotspot, streak and gradient; Fig. <xref rid="Fig1" ref-type="fig">1</xref>D). Because some methods fail to control for type I error, we measured power in the alternative simulations based on false discovery rate (FDR) to ensure fair comparison among methods—though <italic>P</italic> values from SPARK-X are well calibrated across scenarios and thus can be directly used in place of FDR for declaring significance. In the simulations, we varied the number of samples; varied the sparsity of the data to be moderate (average 62.1% zeros; similar to early spatial transcriptomics data) or high (average 99.5% zeros; similar to recent Slide-seq data); varied SE strength for SE genes to be either weak, moderate, or strong; and varied a set of other relevant parameters.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Method schematic of SPARK-X and simulation results. <bold>A</bold> Schematic of the SPARK-X method. <bold>B</bold> Computational time of different methods for analyzing data with different sample sizes in the simulations. Plot shows computational time in minutes (y-axis) for analyzing 10,000 genes with different sample sizes (x-axis) for different methods. Compared methods include SPARK-X (red), SPARK (sky blue), SPARK-G (green) and SpatialDE (steel blue). <bold>C</bold> Random access memory (RAM) of different methods for analyzing data with different sample sizes in the simulations. Plot shows computational memory in gigabytes (y-axis) for analyzing 10,000 genes with different sample sizes (x-axis) for different methods. Computations are carried out using a single thread of an Intel Xeon E5-2683 2.00 GHz processor. SPARK-X is much more computationally efficient than SPARK, SPARK-G, and SpatialDE. For ease of computation, we did not apply SPARK to the data with sample size greater than 3000 and did not apply SPARK-G and SpatialDE to the data with sample size greater than 30,000. <bold>D</bold> Representative genes displaying random pattern and other three spatial expression patterns. <bold>E</bold> Quantile–quantile plot of the observed −log<sub>10</sub>(<italic>P</italic>) from different methods against the expected −log<sub>10</sub>(<italic>P</italic>) under the null simulations with high sparsity (<italic>μ</italic> = 0.005). <italic>P</italic> values were combined across ten simulation replicates. Simulations were performed under moderate sample size (n = 10,000) and moderate dispersion (2.5). <bold>F</bold> Power plots show the proportion of true positives (y-axis) detected by different methods at a range of sample sizes (x-axis) for the alternative simulations with high sparsity at an FDR cutoff of 0.05. Simulations were performed under a moderate fraction of marked cells (20%) and moderate SE strength (threefold) for the hotspot and streak patterns or under moderate SE strength (30% cells displaying expression gradient) for the gradient pattern</p></caption><graphic xlink:href="13059_2021_2404_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par6">In the null simulations, we found that SPARK-X produces well-calibrated <italic>P</italic> values at transcriptome-wide significance levels (Fig. <xref rid="Fig1" ref-type="fig">1</xref>E and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2B), regardless of the data sparsity level. When data sparsity is moderate, both SPARK and SPARK-G yield reasonably calibrated <italic>P</italic> values as observed in previous studies [<xref ref-type="bibr" rid="CR6">6</xref>]. However, when data sparsity is high, SPARK fails to converge for all genes while SPARK-G produces inflated <italic>P</italic> values. The failure of SPARK for sparse data depends on the sparsity level of the input data and is presumably due to the numerical instability of the penalized quasi-likelihood algorithm when the outcome consists of low read counts with a high percentage of zero values. Such algorithmic issue is not restricted to SPARK and appears to be general for fitting algorithms of the generalized linear models such as the negative binomial model (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2). The failure of SPARK-G in controlling for type I error in sparse data is presumably due to the inaccurate approximation of sparse count data with a Gaussian distribution and the fact that the variance stability transformation can no longer properly remove the correlation between mean and variance there [<xref ref-type="bibr" rid="CR28">28</xref>]. SpatialDE produces overly conservative <italic>P</italic> values when data sparsity is moderate and unduly inflated <italic>P</italic> values when sparsity is high. The failure of SpatialDE in controlling type I errors in these settings is presumably due to its Gaussian modeling of count data, use of an asymptotic test in place of an exact test, and/or use of an <italic>ad hoc</italic> minimal <italic>P</italic> value combination rule. The <italic>P</italic> value calibration results in terms of genomic inflation factor for different methods are consistent across a range of sample sizes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1).</p>
      <p id="Par7">In the alternative simulations, we found that SPARK-X is as powerful as SPARK when data sparsity is moderate (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2C) and is more powerful than all other methods when data sparsity is high (Fig. <xref rid="Fig1" ref-type="fig">1</xref>F). Specifically, when data sparsity is moderate, both SPARK-X and SPARK are more powerful than SPARK-G and SpatialDE in detecting streak and hotspot patterns, regardless of sample size. SPARK-X, SPARK-G, and SPARK are more powerful than SpatialDE in detecting the gradient pattern when the sample size is small, though all four methods have comparable power when the sample size is moderate or large. When data sparsity is high, SPARK-X is more powerful than both SPARK-G and SpatialDE, while SPARK fails to converge for all genes. The power gain by SPARK-X over SPARK-G and SpatialDE for sparse data increases with increasing sample size. The power comparison results hold across a range of simulation settings (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S3 and S4), highlighting the robust performance of SPARK-X for analyzing large sparse spatial transcriptomic data.</p>
      <p id="Par8">Importantly, SPARK-X is much more computationally efficient than the other methods, with orders of magnitude improvement in terms of computation time and memory requirement (Fig. <xref rid="Fig1" ref-type="fig">1</xref>B, C). For example, it takes SPARK-G and SpatialDE 1125 and 770 min, respectively, to analyze a data with 10,000 genes and 20,000 spatial locations. In contrast, it only takes SPARK-X 1 min to analyze the same data. Similarly, while SPARK-G and SpatialDE require 21.2 and 55.3 gigabytes (GB) of physical RAM memory, respectively, SPARK-X only requires 0.32 GB. The computation gain by SPARK-X is even more appreciable in data with larger samples. Indeed, with moderate computation resource, SPARK-X is the only method applicable to data with sample size exceeding around 30,000.</p>
    </sec>
    <sec id="Sec4">
      <title>SPARK-X enables powerful SE analysis in the Slide-seq cerebellum data</title>
      <p id="Par9">We applied SPARK-X along with SPARK-G and SpatialDE to analyze three published data obtained with three different spatial transcriptomic technologies: one by Slide-seq, one by Slide-seqV2, and the other by HDST (details in “<xref rid="Sec8" ref-type="sec">Methods</xref>”). We did not apply the Poisson version of SPARK to analyze any of these data due to its excessive computational requirements there.</p>
      <p id="Par10">The first data we examined is a mouse cerebellum data generated through Slide-seq [<xref ref-type="bibr" rid="CR13">13</xref>], consisting of gene expression measurements for 17,729 genes on 25,551 beads. Consistent with simulations, we found that SPARK-X produced calibrated <italic>P</italic> values under permuted null, while SPARK-G and SpatialDE did not (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A). Also consistent with simulations, SPARK identified more SE genes as compared to SPARK-G and SpatialDE across a range of empirical FDRs (Fig. <xref rid="Fig2" ref-type="fig">2</xref>B, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S5 and S6). For example, at an FDR of 1%, SPARK-X identified 2336 SE genes, which is approximately ten times more than that detected by SPARK-G (which identified 212, among which 180 overlapped with SPARK-X; Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5A). SpatialDE was unable to detect any SE genes in the data, consistent with its low power in large-scale sparse data as observed in the simulations.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Analyzing the mouse cerebellum Slide-seq data. <bold>A</bold> Quantile–quantile plot of the observed −log<sub>10</sub>(<italic>P</italic>) from different methods against the expected −log<sub>10</sub>(<italic>P</italic>) under the null condition in the permuted Slide-seq data. <italic>P</italic> values were combined across ten permutation replicates. Compared methods include SPARK-X (red), SPARK-G (green) and SpatialDE (steel blue). <bold>B</bold> Power plot shows the number of genes with spatial expression pattern (y-axis) identified by different methods at a range of FDRs (x-axis) in the Slide-seq data. <bold>C</bold> Bar plots show the computation time and RAM usage of different methods for analyzing the mouse cerebellum Slide-seq data. <bold>D</bold> An illustration of the mouse cerebellum, where a cross-section shows its lobular organization. <bold>E</bold> Bar plot displays the percentage of SE genes identified by either SPARK-X (red) or SPARK-G (green) or both (orange) that were also validated in two gene lists: one from the Harmonizome database (left) and the other from literature (right; Wizeman et al). <bold>F</bold> Visualization of three representative SE genes identified only by SPARK-X in the Slide-seq data. The top panel shows in situ hybridization results for the three genes obtained from the Allen Brain Atlas. The bottom panel shows relative gene-expression levels (green, high; antique-white, low), with <italic>P</italic> values from SPARK-X displayed inside parentheses</p></caption><graphic xlink:href="13059_2021_2404_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par11">We provided three lines of evidence to support the validity of SE genes detected by SPARK-X. First, we found that SE genes only detected by SPARK-X expressed on comparable number of spots as compared to the SE genes detected by both methods (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5A). In contrast, most SE genes only detected by SPARK-G appeared to be expressed on very few spots (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5A and S5C), suggesting potentially false signals. Second, we obtained a list of 2632 genes related to mouse cerebellum from the Harmonizome database [<xref ref-type="bibr" rid="CR29">29</xref>]. Reassuringly, 22% of the unique SE genes identified by SPARK-X were in the Harmonizome list, while only 3% of the unique SE genes identified by SPARK-G were in the same list (Fig. <xref rid="Fig2" ref-type="fig">2</xref>E). Third, we obtained a list of 4152 cell type-specific genes identified in a recent single-cell RNA sequencing study in the mouse cerebellum [<xref ref-type="bibr" rid="CR30">30</xref>]. Again, 41% of the unique SE genes identified by SPARK-X were in the marker list, while only 19% of the unique SE genes identified by SPARK-G were in the same list (Fig. <xref rid="Fig2" ref-type="fig">2</xref>E). These three validation analyses provide convergence support for the higher power of SPARK-X.</p>
      <p id="Par12">We performed functional enrichment analyses on SE genes detected by SPARK-X and SPARK-G (“<xref rid="Sec8" ref-type="sec">Methods</xref>”). A total of 808 enriched Gene Ontology (GO) terms (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5B and Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S4) and 328 Reactome pathways were identified based on SPARK-X SE genes, while only 223 GO terms (overlap = 115) and 56 Reactome pathways (overlap = 46) were identified based on SPARK-G SE genes. Many enriched GO terms identified only by SPARK-X were directly related to synaptic organization of the cerebellum. For example, one enriched GO term was peripheral nervous system development (GO 0007422; <italic>P</italic> = 1.57 × 10<sup>− 3</sup>). Its representative gene <italic>Fa2h</italic> encodes the fatty acid 2-hydroxylase and is highly enriched in oligodendrocytes (Fig. <xref rid="Fig2" ref-type="fig">2</xref>D, F). Fatty acid 2-hydroxylase is known to play an important role in synthesizing myelin galactolipids on oligodendrocytes and facilitates the subsequent myelination that is essential for axon protection and signal transduction [<xref ref-type="bibr" rid="CR31">31</xref>]. Another enriched GO term was synapse organization (GO 0050808; <italic>P</italic> = 3.19 × 10<sup>− 11</sup>). Its representative gene <italic>Cbln1</italic> encodes a cerebellum-specific precursor protein precerebellin and is highly enriched in the granular layer as supported by previous in situ hybridization evidence [<xref ref-type="bibr" rid="CR32">32</xref>] (Fig. <xref rid="Fig2" ref-type="fig">2</xref>F). Precerebellin is a unique synapse organizer for matching and maintaining pre- and post-synaptic elements between parallel fibers and Purkinje cells in the cerebellum and a key for the functional induction of long-term depression there [<xref ref-type="bibr" rid="CR33">33</xref>]. As a last example, the GO term of neurotransmitter secretion regulation is only identified by SPARK-X (GO 0046928; <italic>P</italic> = 2.56 × 10<sup>− 5</sup>). Its representative gene <italic>Kcnc3</italic> encodes the Potassium voltage-gated channel subunit Kv3.3 and is enriched in the Purkinje cells (Fig. <xref rid="Fig2" ref-type="fig">2</xref>F). <italic>Kcnc3</italic> plays an important role in regulating the frequency, shape, and duration of action potentials in the Purkinje cells and facilitates motor coordination [<xref ref-type="bibr" rid="CR34">34</xref>, <xref ref-type="bibr" rid="CR35">35</xref>]. Overall, the new SE genes and GO terms identified by SPARK-X reveal important spatial and functional organization of the cerebellum that are missed by other SE methods, highlighting the benefits of running SE analysis with SPARK-X.</p>
    </sec>
    <sec id="Sec5">
      <title>SPARK-X enables detection of SE genes not explained by cell types in the Slide-seqV2 cerebellum data</title>
      <p id="Par13">The second data we examined is another mouse cerebellum data generated through Slide-seqV2 [<xref ref-type="bibr" rid="CR14">14</xref>], consisting of gene expression measurements for 20,117 genes on 11,626 beads. In the analysis, SPARK-X produced calibrated <italic>P</italic> values under permuted null, while SPARK-G and SpatialDE did not (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S7A). SPARK-X identified 688 SE genes, which is approximately six times more than that detected by SPARK-G (which identified 112, among which 68 overlapped with SPARK-X; Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S7B). SpatialDE was unable to detect any SE genes in the data. Functional enrichment analyses on SE genes detected by SPARK-X identified 595 enriched GO terms and 61 Reactome pathways, many of which are again directly related to synaptic organization of the cerebellum (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S7D and Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S5).</p>
      <p id="Par14">One important feature of SPARK-X is its ability to control for covariates in the SE analysis. Such feature, when paired with the high sensitivity of Slide-seqV2 technology, provides us with a unique opportunity to investigate the extent to which SE genes display spatial expression pattern beyond those explained by spatial distribution of cell types. To do so, we inferred cell type compositions on majority of the spatial locations (82.2%) using RCTD [<xref ref-type="bibr" rid="CR36">36</xref>] and treated the inferred compositions as covariates for SE analysis on these spatial locations (details in “<xref rid="Sec8" ref-type="sec">Methods</xref>”; Fig. <xref rid="Fig3" ref-type="fig">3</xref>A and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S8A). SPARK-X identified 281 and 518 SE genes with and without controlling for cell type compositions, respectively (overlap = 258, Fig. <xref rid="Fig3" ref-type="fig">3</xref>C), with calibrated <italic>P</italic> values under permuted null in the corresponding analyses (Fig. <xref rid="Fig3" ref-type="fig">3</xref>B). The result suggests that approximately half of the SE genes can be accounted for by the spatial distribution of cell types, consistent with our parallel analysis result that 46.7% SE genes were cell type markers identified in a recent single-cell RNA sequencing study in the mouse cerebellum [<xref ref-type="bibr" rid="CR30">30</xref>]. For example, cell type marker genes, such as <italic>Cadm3</italic> and <italic>Gria1</italic> (Fig. <xref rid="Fig3" ref-type="fig">3</xref>D), were no longer SE genes conditional on the cell type composition, suggesting that their spatial expression patterns were primarily driven by the spatial distribution of the corresponding cell types. On the other hand, SE genes such as <italic>Ptprt</italic> and <italic>Aldoc</italic> remained significant after controlling for cell type compositions (Fig. <xref rid="Fig3" ref-type="fig">3</xref>D and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S8B). A careful examination shows that <italic>Ptprt</italic> is highly expressed in a subset of granule cells in the anterior lobe of the cerebellum while <italic>Aldoc</italic> is highly expressed in a subset of Purkinje cells in the posterior lobe (Fig. <xref rid="Fig3" ref-type="fig">3</xref>D). Such distinctive and complementary spatial expression patterns of <italic>Ptprt</italic> and <italic>Aldoc</italic> in the anterior versus posterior lobe highlight the regional specification and functional compartmentalization of the cerebellum. <italic>Ptprt</italic> encodes the protein tyrosine phosphatase receptor rho (PTP<italic>ρ</italic>) that regulates synapse formation through interacting with cell adhesion molecules [<xref ref-type="bibr" rid="CR37">37</xref>]. The expression pattern of <italic>Ptprt</italic> coincides with the granule cell lineage boundary between the anterior and posterior lobules around lobule VI [<xref ref-type="bibr" rid="CR38">38</xref>, <xref ref-type="bibr" rid="CR39">39</xref>], supporting its potential role in the function of granule cells in sensorimotor transmission that is specialized in the anterior cerebellar cortex [<xref ref-type="bibr" rid="CR40">40</xref>]. On the other hand, <italic>Aldoc</italic> encodes aldolase C, which is a brain-specific glycolytic isozyme and a well-known cerebellum compartmentation maker. <italic>Aldoc</italic> is expressed in Purkinje cells in a longitudinal striped fashion in the cerebellum. Each <italic>Aldoc</italic> expressed stripe receives enhanced glutamatergic innervations from climbing fibers originated from specific subnuclei of the inferior olive and projects to distinct subdivision of the deep cerebellar nuclei that further sends inhibitory projections back to the inferior olive [<xref ref-type="bibr" rid="CR41">41</xref>–<xref ref-type="bibr" rid="CR43">43</xref>]. Each <italic>Aldoc</italic> strip thus represents an anatomically connected olivocerebellar-nuclear module, with highly synchronous neuronal activity observable within each module and asynchronous activity between modules [<xref ref-type="bibr" rid="CR44">44</xref>]. Notably, both <italic>Ptprt</italic> and <italic>Aldoc</italic> were also detected as SE genes, along with many others, in a cell type SE specific analysis where we applied SPARK-X to a subset of spatial locations that are dominated by either Purkinje cells or granule cells to directly detect genes that display spatial expression pattern within a cell type (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S9). Overall, the structural and functional compartmentalization in the cerebellum revealed by cell type adjusted SE analysis highlights the utility of SPARK-X.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Analyzing the mouse cerebellum Slide-seqV2 data. <bold>A</bold> Spatial distribution of all major cell types in the Slide-seqV2 data. Cells are colored by cell types shown in the legend, where the cell type information were predicted using RCTD. <bold>B</bold> Quantile–quantile plot of the observed −log<sub>10</sub>(<italic>P</italic>) from different methods against the expected −log<sub>10</sub>(<italic>P</italic>) under the null condition in the permuted Slide-seqV2 data. <italic>P</italic> values were combined across ten permutation replicates. Permutations were run with SPARK-X with (tan) or without (pale green) adjusting for cell types. <bold>C</bold> Venn diagram shows the overlap in SE genes identified by SPARK-X with (tan) or without (pale green) adjusting for cell types. <bold>D</bold> Spatial distribution of predicted cell types (left two panels; blue represents cell type) and spatial expression pattern of four representative SE genes (middle and right panels; green represents high expression while antique-white represents low expression) in Slide-seqV2 data. <italic>P</italic> values from SPARK-X with (left side of the arrow) or without (right side of the arrow) adjusting for cell types are shown inside parentheses</p></caption><graphic xlink:href="13059_2021_2404_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec6">
      <title>SPARK-X enables scalable SE analysis of the HDST olfactory bulb data</title>
      <p id="Par15">SPARK-X provides substantial computational gains over the other methods. For example, in the first data, it took SPARK-X 3 min to analyze the whole data, while it took 56 h for SPARK-G and 47 h for SpatialDE, respectively (Fig. <xref rid="Fig2" ref-type="fig">2</xref>C and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). In the second data, it took SPARK-X 2 min to analyze the whole data, while it took 13 h for SPARK-G and 8 h for SpatialDE, respectively (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S7C and Table S1). The computational gain of SPARK-X becomes even more apparent in the third data, which is a mouse olfactory bulb data collected through HDST, consisting of 19,913 genes measured on 177,455 spots (Fig. <xref rid="Fig4" ref-type="fig">4</xref>A). This data is particularly challenging for existing SE methods due to the large number of spots measured there. Specifically, it would take an estimated 114 and 80 days if we use SPARK-G and SpatialDE to analyze the data. These two methods would also require 2100 and 3500 GB of memory, respectively (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). The high computational requirements for SPARK-G and SpatialDE thus exclude their use in the data. In contrast, SPARK-X requires 0.42 GB memory and 3 min of computing time and is the only SE method applicable to the data.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Analyzing mouse olfactory bulb HDST data. <bold>A</bold> H&amp;E image of mouse olfactory bulb (left panel) and matching morphological annotation (middle panel) in the HDST data. Spots are colored by morphological layer shown in the legend (right panel), where the layer annotations were from ref [<xref ref-type="bibr" rid="CR15">15</xref>]. H&amp;E image reproduced from ref. [<xref ref-type="bibr" rid="CR15">15</xref>] with permission. <bold>B</bold> Visualization of three representative SE genes identified only by SPARK-X in the HDST data. The top panels show in situ hybridization of the three genes obtained from the Allen Brain Atlas. The bottom panels show spatial expression patterns of the three genes at single-cell-level resolution (green, high expression; antique-white, low expression). <italic>P</italic> values from SPARK-X are shown inside parentheses. <bold>C</bold> Heatmap shows expression level of 125 SE genes (columns) across eight major morphological layers (rows). Colored bar at the bottom represents five gene clusters. RMS, rostral migratory system; E, ependymal cell zone; GCL, granule cell layer; IPL, internal plexiform layer; M/T, mitral layer; EPL, external plexiform layer; GL, glomerular layer; ONL, olfactory nerve layer</p></caption><graphic xlink:href="13059_2021_2404_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par16">In the analysis, SPARK-X identified a total 125 SE genes, with calibrated <italic>P</italic> values under permuted null (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S10A). Almost all SE genes showed clear spatial expression patterns that were cross validated by in situ hybridization in the Allen Brain Atlas [<xref ref-type="bibr" rid="CR45">45</xref>] (Fig. <xref rid="Fig4" ref-type="fig">4</xref>B and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S10E). The 125 SE genes are clustered into five clusters that were enriched in distinct morphological layers of the olfactory bulb (Fig. <xref rid="Fig4" ref-type="fig">4</xref>C and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S10C). Functional enrichment analyses identified 377 enriched GO terms and 39 Reactome pathways, many of which are related to synaptic organization and signaling (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S10D and Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Table S6). For example, one enriched GO term is synaptic membrane (GO:0097060, <italic>P</italic> = 2.50 × 10<sup>− 15</sup>), with a representative gene <italic>Kctd12</italic>. <italic>Kctd12</italic> encodes an auxiliary GABA<sub>B</sub> receptor subunit [<xref ref-type="bibr" rid="CR46">46</xref>] and is observed to be highly expressed in the olfactory nerve layer (Fig. <xref rid="Fig4" ref-type="fig">4</xref>B, C), consistent with its enrichment in the glomerulus [<xref ref-type="bibr" rid="CR47">47</xref>]. Another enriched GO term is the GABA-ergic synapse (GO: 0098982, <italic>P</italic> = 1.19 × 10<sup>− 5</sup>) with a representative gene <italic>Gphn</italic>. <italic>Gphn</italic> encodes the protein gephyrin and is observed here to be highly expressed in the mitral layer and external plexiform layer. Similar to GABA-ergic synapse, glutamatergic synapse (GO: 0098978, <italic>P</italic> = 3.35 × 10<sup>− 15</sup>) is also enriched. The representative gene of glutamatergic synapse, <italic>Dlg2</italic>, encodes a membrane-associated guanylate kinase and is observed here to be highly expressed in both the granule cell layer and the mitral layer. The complementary expression pattern of inhibitory GABA-ergic and excitatory glutamatergic neurons as represented by <italic>Gphn</italic> and <italic>Dlg2</italic> are consistent with the spatial organization of lateral inhibition: mitral cells activate granule cells that in turn inhibits nearby mitral cells, leading to robust odor processing and discrimination in the olfactory bulb [<xref ref-type="bibr" rid="CR48">48</xref>–<xref ref-type="bibr" rid="CR52">52</xref>].</p>
      <p id="Par17">We performed conditional analysis to investigate the extent to which SE genes display spatial expression pattern beyond those explained by the spatial distribution of cell types. Specifically, we extracted 103,602 spots with confident cell type assignment in the original study (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S11D) and treated the assigned cell types as covariates for SE analysis on these spatial locations (details in “<xref rid="Sec8" ref-type="sec">Methods</xref>”). SPARK-X identified 36 and 66 SE genes with and without controlling for cell types, respectively (overlap = 35, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S11C), with calibrated <italic>P</italic> values under the permuted null in the corresponding analyses (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S11A). The results suggest that more than half of the SE genes can be accounted for by the spatial distribution of cell types, consistent with our parallel analysis result that 59.1% SE genes were cell type markers identified in a recent single-cell RNA sequencing study in the mouse olfactory bulb [<xref ref-type="bibr" rid="CR53">53</xref>]. Careful examination of the detected SE genes suggests that genes that remained significant after controlling for cell types often display spatial expression pattern across multiple cell types or within the same cell type (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S11E and S11F). For example, <italic>Camk1d</italic> is enriched in the ventral part of multiple olfactory bulb layers including the external plexiform layer and the glomerular layer. <italic>Camk1d</italic> is also detected as an SE gene when we applied SPARK-X to a subtype of inhibitory neurons, the olfactory bulb inner horizontal cells, to directly detect SE genes that display spatial expression pattern within the cell type. In particular, <italic>Camk1d</italic> is specifically enriched in a subset of these inhibitory neurons that reside outside the granule cell layer (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S11F). As another example, <italic>Kcnip1</italic> is also an SE gene that is detected in both conditional analysis and cell type-specific analysis. <italic>Kcnip1</italic> displays similar spatial expression pattern as the <italic>Camk1d</italic> and its <italic>P</italic> value becomes slightly more significant after controlling for cell types (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S11E). <italic>Camk1d</italic> encodes the calcium/calmodulin-dependent protein kinase that operates in the calcium-triggered CaMKK-CaMK1 signaling cascade [<xref ref-type="bibr" rid="CR54">54</xref>] and <italic>Kcnip1</italic> encodes the cytosolic voltage-gated potassium channel-interacting protein that regulates neuronal membrane excitability [<xref ref-type="bibr" rid="CR55">55</xref>]. Their known roles in regulating signaling pathways in inhibitory neurons, paired with their restricted spatial expression in a subset of inhibitory neurons in the external plexiform and glomerular layers, suggest their potential involvement in lateral inhibition in the olfactory bulb.</p>
    </sec>
  </sec>
  <sec id="Sec7">
    <title>Discussion</title>
    <p id="Par18">We have presented a new method, SPARK-X, for identifying SE genes in large-scale sparse spatial transcriptomic data. In comparison to existing approaches, SPARK-X is highly computationally efficient, produces well-calibrated <italic>P</italic> values and ensures robust performance for large spatial transcriptomic data sets collected across a range of technologies. The modeling framework of SPARK-X is also flexible, allowing for potential future extensions towards transcriptome-wide joint modeling of correlated genes. We have illustrated the benefits of SPARK-X through in-depth analyses of three large spatial transcriptomic studies.</p>
    <p id="Par19">SPARK-X relies on a non-parametric covariance test for detecting spatial expression patterns. Its non-parametric feature distinguishes it from existing SE methods that are primarily parametric in nature. Non-parametric modeling in SPARK-X ensures its robust performance under various data generating processes in different spatial transcriptomic technologies, leading to calibrated <italic>P</italic> values and improved power for SE analysis. Such robust performance of SPARK-X is especially beneficial for analyzing spatial transcriptomic data that are both large-scale and sparse. Compared with small-sample studies, large-scale spatial transcriptomic studies are better powered, more reproducible, and are thus becoming increasingly common. We recognize, however, that many spatial transcriptomic studies are still carried out on moderate number of spatial locations and that some spatial transcriptomic data are non-sparse [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR56">56</xref>]. Spatial transcriptomic data measured on a small number of spatial locations (e.g., hundreds or thousands) from early spatial transcriptomic technologies can often be modeled effectively through an over-dispersed Poisson distribution [<xref ref-type="bibr" rid="CR6">6</xref>]. Consequently, parametric modeling of spatial count data through generalized linear mixed model framework such as the Poisson version of SPARK performs well for these technologies. Indeed, as demonstrated through our simulations, SPARK and SPARK-X have comparable power for detecting the hotspot pattern under small-sample settings, though SPARK-X outperforms SPARK on other patterns or with larger samples. The benefits of SPARK-X over SPARK on detecting SE genes can also be observed in other small data sets collected from other technologies. For example, on a human heart Visium data, which contains 20,904 genes measured on 4247 spots (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S12), SPARK-X identified 1536 SE genes while SPARK identified 644 (533 overlapped; Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S12C). Both these methods produced calibrated <italic>P</italic> values under permuted null (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S12A). On a human ovarian cancer Visium data, which contains 1198 genes measured on 3492 spots, SPARK-X identified 651 SE genes while SPARK identified 579 (474 overlapped; Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S13C). Importantly, many cancer-related KEGG and Reactome pathways can only be identified based on the SE genes detected by SPARK-X (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S13G and Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Table S7), highlighting the benefits of SPARK-X analysis. Besides small data, some recent large spatial transcriptomic technologies yield non-sparse count. For example, the STARmap technology measures expression levels on tens of thousands of spatial locations but only for two dozen of genes. Consequently, the read depth per gene from STARmap can be reasonably high, resulting in non-sparse high-count data with almost no zero values (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). For such high-count non-sparse data, the Gaussian distribution as employed in SPARK-G is an effective approximation to the underlying over-dispersed Poisson data generating process. We applied both SPARK-G and SPARK-X on the mouse visual cortex STARmap data that consists of 23 known cell type marker and 5 activity-regulated genes measured on 32,845 cells (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S14 and S15). In the analysis, both SPARK-G and SPARK-X produced calibrated <italic>P</italic> values under permuted null and were able to detect all 28 genes as SE genes. Despite the similar performance of SPARK-G and SPARK-X for this non-sparse data, the memory saving by SPARK-X in this data remains substantial: while SPARK-G required 43.45 GB, SPARK-X only used 0.19 GB (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). Therefore, SPARK-X serves as an effective complement of existing SE analysis approaches, especially for large-scale spatial transcriptomic studies.</p>
    <p id="Par20">We have primarily used the projection covariance function to measure similarity in either gene expression or coordinates between location pairs. Such similarity measurement is expressed effectively as a product of two input variables from the location pair and quantifies their coordinated deviation from the mean. The product of two input variables is commonly used as a key ingredient in many covariance functions other than the projection covariance function [<xref ref-type="bibr" rid="CR57">57</xref>–<xref ref-type="bibr" rid="CR59">59</xref>]. While the product of two input variables represents one important similarity measurement, other similarity measurements exist. For example, one could use the Euclidean distance, minimum [<xref ref-type="bibr" rid="CR60">60</xref>, <xref ref-type="bibr" rid="CR61">61</xref>], powered minimum [<xref ref-type="bibr" rid="CR62">62</xref>], and other ways [<xref ref-type="bibr" rid="CR63">63</xref>–<xref ref-type="bibr" rid="CR65">65</xref>] to measure similarity between two variables. Different similarity measurements used in various covariance functions [<xref ref-type="bibr" rid="CR64">64</xref>–<xref ref-type="bibr" rid="CR66">66</xref>] can be easily incorporated into SPARK-X to achieve optimal detection of distinct spatial expression patterns. In the present study, we only used the projection covariance function as it allows us to achieve orders of magnitude of computational gains as compared with other approaches. The projection covariance function is also robust and well powered to detect a range of spatial expression patterns, both simple and complex, in simulations and real datasets. Despite these benefits of the projection covariance function, we note that the statistical power of the SPARK-X will likely benefit from the use of other covariance functions in addition to the projection covariance function. Due to computational reasons, we did not examine other covariance functions but instead explored the use of different transformations on the coordinates to incorporate into SPARK-X a wide range of distance covariance matrices. While the number of detected SE genes varies across different distance covariance matrices, combining the association evidence across all matrices as in SPARK-X achieves higher power than using any individual matrix alone (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3). Future methodological development for exploring the use of other covariance functions as well as other transformations in a computationally efficient manner may help improve the power of SPARK-X further.</p>
  </sec>
  <sec id="Sec8">
    <title>Methods</title>
    <sec id="Sec9">
      <title>Method overview</title>
      <p id="Par21">We aim to identify genes that display spatial expression patterns, commonly referred to as SE genes, in large-scale spatially resolved transcriptomic studies. These large-scale studies rely on various high-throughput spatial transcriptomic technologies [<xref ref-type="bibr" rid="CR13">13</xref>–<xref ref-type="bibr" rid="CR15">15</xref>] and collect gene expression measurements on tens or hundreds of thousands of spatial locations. Gene expression measurements in these large-scale spatial transcriptomic studies are often in the form of low counts with a large fraction of zero values. For SE analysis, we examine one gene at a time and consider its expression measurements collected on <italic>n</italic> different spatial locations. We refer to the spatial locations as samples in the present study. Depending on the technology, a sample may be a single cell (in the case of STARmap technology) or a cell-sized local region (in the case of HDST technology) or a local region that consists of dozens of cells (in the case of Slide-seq and Visium technologies). The sampled locations have known spatial coordinates recorded during the experiment. We denote <bold><italic>s</italic></bold><sub><bold><italic>i</italic></bold></sub> as the <italic>d</italic>-vector of spatial coordinates for <italic>i</italic>th sample, with <italic>i</italic> ∈ (1, …, <italic>n</italic>), and <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \boldsymbol{S}={\left({\boldsymbol{s}}_1^T,\cdots, {\boldsymbol{s}}_n^T\right)}^T $$\end{document}</tex-math><mml:math id="M2" display="inline"><mml:mi mathvariant="bold-italic">S</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mfenced close=")" open="(" separators=",,"><mml:msubsup><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:msubsup><mml:mo>⋯</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mi>n</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mfenced><mml:mi>T</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13059_2021_2404_Article_IEq1.gif"/></alternatives></inline-formula> as the corresponding <italic>n</italic> × <italic>d</italic> matrix of spatial coordinates. These spatial coordinates vary continuously over a two-dimensional space (<italic>d</italic> = 2; <bold><italic>s</italic></bold><sub><bold><italic>i</italic></bold></sub> = (<italic>s</italic><sub><italic>i</italic>1</sub>, <italic>s</italic><sub><italic>i</italic>2</sub>) ∈ <italic>R</italic><sup>2</sup>) or a three-dimensional space (<italic>d</italic> = 3; <bold><italic>s</italic></bold><sub><bold><italic>i</italic></bold></sub> = (<italic>s</italic><sub><italic>i</italic>1</sub>, <italic>s</italic><sub><italic>i</italic>2</sub>, <italic>s</italic><sub><italic>i</italic>3</sub>) ∈ <italic>R</italic><sup>3</sup>) depending on the technology. We denote <italic>y</italic><sub><italic>i</italic></sub>(<bold><italic>s</italic></bold><sub><bold><italic>i</italic></bold></sub>) as the gene-expression measurement for the <italic>i</italic>th sample and <bold><italic>y =</italic></bold> (<italic>y</italic><sub>1</sub>(<bold><italic>s</italic></bold><sub>1</sub>), <bold><italic>⋯</italic></bold>, <italic>y</italic><sub><italic>n</italic></sub>(<bold><italic>s</italic></bold><sub><italic>n</italic></sub>))<sup><italic>T</italic></sup> as the <italic>n</italic>-vector of gene expression across all samples. We assume that both <bold><italic>y</italic></bold> and each coordinate of <bold><italic>S</italic></bold> has been centered and scaled to have mean 0 and standard deviation of 1. Centering and scaling do not influence type I error control but can affect statistical power. Here, our goal is to test whether the expression level of the gene of focus display any spatial expression pattern. Equivalently, we aim to test whether <bold><italic>y</italic></bold> is dependent on the spatial coordinates <bold><italic>S</italic></bold>. We rely on a general class of covariance tests [<xref ref-type="bibr" rid="CR24">24</xref>–<xref ref-type="bibr" rid="CR27">27</xref>], which includes the Hilber-Schmidt independence criteria test [<xref ref-type="bibr" rid="CR24">24</xref>] and the distance covariance test [<xref ref-type="bibr" rid="CR25">25</xref>] as special cases, to perform SE analysis in a non-parametric fashion. Non-parametric testing ensures robust performance and wide applicability of our method to spatial transcriptomic data that are collected from various technologies with potentially different data features and different data generating mechanisms. Our method builds upon the following intuition: if <bold><italic>y</italic></bold> is independent of <bold><italic>S</italic></bold>, then the spatial distance between two locations <italic>i</italic> and <italic>j</italic> would also be independent of the gene-expression difference between the two locations. Consequently, we can construct two sample by sample relationship matrices, one based on gene expression and one based on spatial coordinates, to examine whether these two matrices are more similar to each other than expected by chance alone.</p>
      <p id="Par22">Technically, we construct an expression covariance matrix based on the gene-expression levels as an <italic>n</italic> by <italic>n</italic> matrix <bold><italic>E = y</italic></bold>(<bold><italic>y</italic></bold><sup><bold><italic>T</italic></bold></sup><bold><italic>y</italic></bold>)<sup><bold><italic>−</italic></bold><bold>1</bold></sup><bold><italic>y</italic></bold><sup><bold><italic>T</italic></bold></sup>. We also construct a distance covariance matrix for all samples based on spatial locations as an <italic>n</italic> by <italic>n</italic> matrix <bold><italic>Σ = S</italic></bold>(<bold><italic>S</italic></bold><sup><bold><italic>T</italic></bold></sup><bold><italic>S</italic></bold>)<sup><bold><italic>−</italic></bold><bold>1</bold></sup><bold><italic>S</italic></bold><sup><bold><italic>T</italic></bold></sup>. We refer to both matrices as the covariance matrices as they are generated from the projection covariance function and possess the two key covariance matrix properties including being symmetric and positive semi-definite. A covariance matrix is also known as a kernel matrix and a covariance function is also known as a kernel function. The projection covariance function has been widely used in many applications in genetics [<xref ref-type="bibr" rid="CR67">67</xref>–<xref ref-type="bibr" rid="CR69">69</xref>]. For both matrices, we center them as <bold><italic>E</italic></bold><sub><italic>C</italic></sub> <bold><italic>= HEH</italic></bold> and <bold><italic>Σ</italic></bold><sub><italic>C</italic></sub> <bold><italic>= HΣH</italic></bold>, where <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \boldsymbol{H}=\left(\boldsymbol{I}-{\mathbf{1}}_n{\mathbf{1}}_n^{\boldsymbol{T}}/n\right) $$\end{document}</tex-math><mml:math id="M4" display="inline"><mml:mi mathvariant="bold-italic">H</mml:mi><mml:mo mathvariant="bold-italic">=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mo mathvariant="bold-italic">−</mml:mo><mml:msub><mml:mn mathvariant="bold">1</mml:mn><mml:mi>n</mml:mi></mml:msub><mml:msubsup><mml:mn mathvariant="bold">1</mml:mn><mml:mi>n</mml:mi><mml:mi mathvariant="bold-italic">T</mml:mi></mml:msubsup><mml:mo>/</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2021_2404_Article_IEq2.gif"/></alternatives></inline-formula> with <bold><italic>I</italic></bold> being an <italic>n</italic> by <italic>n</italic> identity matrix and <bold>1</bold><sub><italic>n</italic></sub> being an <italic>n</italic>-vector of 1s. Centering does not alter results here as we have already centered both <bold><italic>y</italic></bold> and <bold><italic>S</italic></bold> before constructing these covariance matrices. We then construct the following test statistic:</p>
      <p id="Par23">
        <disp-formula id="Equa">
          <alternatives>
            <tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ T= trace\left({\boldsymbol{E}}_C{\boldsymbol{\varSigma}}_C\right)/n. $$\end{document}</tex-math>
            <mml:math id="M6" display="block">
              <mml:mi>T</mml:mi>
              <mml:mo>=</mml:mo>
              <mml:mtext mathvariant="italic">trace</mml:mtext>
              <mml:mfenced close=")" open="(">
                <mml:mrow>
                  <mml:msub>
                    <mml:mi mathvariant="bold-italic">E</mml:mi>
                    <mml:mi>C</mml:mi>
                  </mml:msub>
                  <mml:msub>
                    <mml:mi mathvariant="bold-italic">Σ</mml:mi>
                    <mml:mi>C</mml:mi>
                  </mml:msub>
                </mml:mrow>
              </mml:mfenced>
              <mml:mo>/</mml:mo>
              <mml:mi>n</mml:mi>
              <mml:mo>.</mml:mo>
            </mml:math>
            <graphic xlink:href="13059_2021_2404_Article_Equa.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p id="Par24">Intuitively, each element in either covariance matrix measures the similarity between pairs of locations in terms of their coordinated deviation from the mean. When <italic>y</italic> and <bold><italic>S</italic></bold> are independent of each other, the similarity measurement between a location pair in terms of gene expression will not be correlated with the similarity measurement between the location pair in terms of distance. Consequently, the test statistics <italic>T</italic>, which is effectively a summation of the products between the two similarity measurements across all location pairs, will be small. When <italic>y</italic> and <bold><italic>S</italic></bold> are not independent of each other, the similarity measurement in terms of gene expression will be correlated with the similarity measurement in terms of the distance across location pairs, thus leading to a large test statistics <italic>T</italic>. Formally, under the null hypothesis that <bold><italic>y</italic></bold> and <bold><italic>S</italic></bold> are independent of each other, <italic>T</italic> asymptotically follows a mixture of chi-square distributions [<xref ref-type="bibr" rid="CR27">27</xref>]</p>
      <p id="Par25">
        <disp-formula id="Equb">
          <alternatives>
            <tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \frac{1}{n^2}{\sum}_{i,j}{\lambda}_{E,i}{\lambda}_{\varSigma, j}{z}_{ij}^2, $$\end{document}</tex-math>
            <mml:math id="M8" display="block">
              <mml:mfrac>
                <mml:mn>1</mml:mn>
                <mml:msup>
                  <mml:mi>n</mml:mi>
                  <mml:mn>2</mml:mn>
                </mml:msup>
              </mml:mfrac>
              <mml:msub>
                <mml:mo>∑</mml:mo>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:msub>
                <mml:mi>λ</mml:mi>
                <mml:mrow>
                  <mml:mi>E</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>i</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:msub>
                <mml:mi>λ</mml:mi>
                <mml:mrow>
                  <mml:mi>Σ</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:msubsup>
                <mml:mi>z</mml:mi>
                <mml:mi mathvariant="italic">ij</mml:mi>
                <mml:mn>2</mml:mn>
              </mml:msubsup>
              <mml:mo>,</mml:mo>
            </mml:math>
            <graphic xlink:href="13059_2021_2404_Article_Equb.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p id="Par26">where <italic>λ</italic><sub><italic>E</italic>, <italic>i</italic></sub> is the <italic>i</italic>th ordered non-zero eigenvalue of <bold><italic>E</italic></bold><sub><bold><italic>C</italic></bold></sub>; <italic>λ</italic><sub><italic>Σ</italic>, <italic>j</italic></sub> is the <italic>j</italic>th ordered non-zero eigenvalue of <bold><italic>Σ</italic></bold><sub><bold><italic>C</italic></bold></sub>; and <inline-formula id="IEq3"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {z}_{ij}^2 $$\end{document}</tex-math><mml:math id="M10" display="inline"><mml:msubsup><mml:mi>z</mml:mi><mml:mi mathvariant="italic">ij</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2021_2404_Article_IEq3.gif"/></alternatives></inline-formula> are independent and identically distributed <inline-formula id="IEq4"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\chi}_1^2 $$\end{document}</tex-math><mml:math id="M12" display="inline"><mml:msubsup><mml:mi>χ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2021_2404_Article_IEq4.gif"/></alternatives></inline-formula> variables. An extremely large <italic>T</italic> that is rare under the above null distribution constitutes evidence against the null hypothesis. Consequently, we can compute a <italic>P</italic> value to measure the probability of encountering the same or a larger <italic>T</italic> as observed in the data based on the null distribution. The <italic>P</italic> value for testing the null hypothesis can be calculated using Davies’ exact method [<xref ref-type="bibr" rid="CR70">70</xref>].</p>
      <p id="Par27">We employ several important algebraic manipulations to ensure that both computational complexity and memory requirement of our method are linear with respect to the number of spatial locations. First, we note that the eigenvalues of <bold><italic>E</italic></bold><sub><bold><italic>C</italic></bold></sub> and <bold><italic>Σ</italic></bold><sub><bold><italic>C</italic></bold></sub> are equivalent to the eigenvalues of (<bold><italic>y</italic></bold><sup><bold><italic>T</italic></bold></sup><bold><italic>y</italic></bold> )<sup><bold><italic>−</italic></bold><bold>1</bold></sup><bold><italic>y</italic></bold><sup><bold><italic>T</italic></bold></sup><bold><italic>Hy</italic></bold> (a scalar) and (<bold><italic>S</italic></bold><sup><bold><italic>T</italic></bold></sup><bold><italic>S</italic></bold>)<sup><bold><italic>−</italic></bold><bold>1</bold></sup><bold><italic>S</italic></bold><sup><bold><italic>T</italic></bold></sup><bold><italic>HS</italic></bold> (a <italic>d</italic> × <italic>d</italic> matrix) [<xref ref-type="bibr" rid="CR71">71</xref>], respectively. The computational cost for obtaining these eigenvalues based on the later forms is only <italic>O</italic>(<italic>nd</italic><sup>2</sup>). Second, we note that
<disp-formula id="Equc"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ Tr\left({\boldsymbol{E}}_{\boldsymbol{c}}{\boldsymbol{\Sigma}}_{\boldsymbol{c}}\right)= Tr\left(\boldsymbol{y}{\left({\boldsymbol{y}}^{\boldsymbol{T}}\boldsymbol{y}\right)}^{-\mathbf{1}}{\boldsymbol{y}}^{\boldsymbol{T}}\boldsymbol{H}\boldsymbol{\Sigma } \boldsymbol{H}\right)={\left({\boldsymbol{y}}^{\boldsymbol{T}}\boldsymbol{y}\right)}^{-\mathbf{1}} Tr\left({\boldsymbol{y}}^{\boldsymbol{T}}\boldsymbol{H}\boldsymbol{\Sigma } \boldsymbol{H}\boldsymbol{y}\right). $$\end{document}</tex-math><mml:math id="M14" display="block"><mml:mi mathvariant="italic">Tr</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">E</mml:mi><mml:mi mathvariant="bold-italic">c</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="bold">Σ</mml:mi><mml:mi mathvariant="bold-italic">c</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi mathvariant="italic">Tr</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi mathvariant="bold-italic">T</mml:mi></mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow></mml:mfenced><mml:mrow><mml:mo>−</mml:mo><mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi mathvariant="bold-italic">T</mml:mi></mml:msup><mml:mi mathvariant="bold-italic">H</mml:mi><mml:mi mathvariant="bold">Σ</mml:mi><mml:mi mathvariant="bold-italic">H</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi mathvariant="bold-italic">T</mml:mi></mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow></mml:mfenced><mml:mrow><mml:mo>−</mml:mo><mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="italic">Tr</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mi mathvariant="bold-italic">T</mml:mi></mml:msup><mml:mi mathvariant="bold-italic">H</mml:mi><mml:mi mathvariant="bold">Σ</mml:mi><mml:mi mathvariant="bold-italic">Hy</mml:mi></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:math><graphic xlink:href="13059_2021_2404_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par28">Consequently, we never need to compute <bold><italic>E</italic></bold>, <bold><italic>Σ</italic></bold> and their centered versions <bold><italic>E</italic></bold><sub><italic>C</italic></sub> and <bold><italic>Σ</italic></bold><sub><italic>C</italic></sub> throughout the algorithm. Instead, we only need to compute the key quantities <bold><italic>y</italic></bold><sup><bold><italic>T</italic></bold></sup><bold><italic>y</italic></bold>, <bold><italic>y</italic></bold><sup><bold><italic>T</italic></bold></sup><bold><italic>Hy</italic></bold>, <bold><italic>S</italic></bold><sup><bold><italic>T</italic></bold></sup><bold><italic>S</italic></bold>, <bold><italic>S</italic></bold><sup><bold><italic>T</italic></bold></sup><bold><italic>HS</italic></bold>, and <bold><italic>y</italic></bold><sup><bold><italic>T</italic></bold></sup><bold><italic>H</italic></bold><bold>Σ</bold><bold><italic>Hy</italic></bold>, all of which require at most <italic>O</italic>(<italic>nd</italic><sup>2</sup>) computational complexity and <italic>O</italic>(<italic>nd</italic>) memory requirement. Specifically, these key quantities can be computed efficiently in the following forms:</p>
      <p id="Par29">
        <disp-formula id="Equd">
          <alternatives>
            <tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\boldsymbol{y}}^{\boldsymbol{T}}\boldsymbol{Hy}={\left(\boldsymbol{Hy}\right)}^{\boldsymbol{T}}\left(\boldsymbol{Hy}\right)={\left(\boldsymbol{y}-\overline{y}\right)}^{\boldsymbol{T}}\left(\boldsymbol{y}-\overline{y}\right), $$\end{document}</tex-math>
            <mml:math id="M16" display="block">
              <mml:msup>
                <mml:mi mathvariant="bold-italic">y</mml:mi>
                <mml:mi mathvariant="bold-italic">T</mml:mi>
              </mml:msup>
              <mml:mi mathvariant="bold-italic">Hy</mml:mi>
              <mml:mo>=</mml:mo>
              <mml:msup>
                <mml:mfenced close=")" open="(">
                  <mml:mi mathvariant="bold-italic">Hy</mml:mi>
                </mml:mfenced>
                <mml:mi mathvariant="bold-italic">T</mml:mi>
              </mml:msup>
              <mml:mfenced close=")" open="(">
                <mml:mi mathvariant="bold-italic">Hy</mml:mi>
              </mml:mfenced>
              <mml:mo>=</mml:mo>
              <mml:msup>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:mi mathvariant="bold-italic">y</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mover accent="true">
                      <mml:mi>y</mml:mi>
                      <mml:mo stretchy="true">¯</mml:mo>
                    </mml:mover>
                  </mml:mrow>
                </mml:mfenced>
                <mml:mi mathvariant="bold-italic">T</mml:mi>
              </mml:msup>
              <mml:mfenced close=")" open="(">
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">y</mml:mi>
                  <mml:mo>−</mml:mo>
                  <mml:mover accent="true">
                    <mml:mi>y</mml:mi>
                    <mml:mo stretchy="true">¯</mml:mo>
                  </mml:mover>
                </mml:mrow>
              </mml:mfenced>
              <mml:mo>,</mml:mo>
            </mml:math>
            <graphic xlink:href="13059_2021_2404_Article_Equd.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
        <disp-formula id="Eque">
          <alternatives>
            <tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\boldsymbol{S}}^{\boldsymbol{T}}\boldsymbol{HS}={\left(\boldsymbol{HS}\right)}^{\boldsymbol{T}}\left(\boldsymbol{HS}\right)={\left(\boldsymbol{S}-\frac{\mathbf{1}{\mathbf{1}}^{\boldsymbol{T}}}{\boldsymbol{n}}\boldsymbol{S}\right)}^{\boldsymbol{T}}\left(\boldsymbol{S}-\frac{\mathbf{1}{\mathbf{1}}^{\boldsymbol{T}}}{\boldsymbol{n}}\boldsymbol{S}\right), $$\end{document}</tex-math>
            <mml:math id="M18" display="block">
              <mml:msup>
                <mml:mi mathvariant="bold-italic">S</mml:mi>
                <mml:mi mathvariant="bold-italic">T</mml:mi>
              </mml:msup>
              <mml:mi mathvariant="bold-italic">HS</mml:mi>
              <mml:mo mathvariant="bold-italic">=</mml:mo>
              <mml:msup>
                <mml:mfenced close=")" open="(">
                  <mml:mi mathvariant="bold-italic">HS</mml:mi>
                </mml:mfenced>
                <mml:mi mathvariant="bold-italic">T</mml:mi>
              </mml:msup>
              <mml:mfenced close=")" open="(">
                <mml:mi mathvariant="bold-italic">HS</mml:mi>
              </mml:mfenced>
              <mml:mo mathvariant="bold-italic">=</mml:mo>
              <mml:msup>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:mi mathvariant="bold-italic">S</mml:mi>
                    <mml:mo mathvariant="bold-italic">−</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mn mathvariant="bold">1</mml:mn>
                        <mml:msup>
                          <mml:mn mathvariant="bold">1</mml:mn>
                          <mml:mi mathvariant="bold-italic">T</mml:mi>
                        </mml:msup>
                      </mml:mrow>
                      <mml:mi mathvariant="bold-italic">n</mml:mi>
                    </mml:mfrac>
                    <mml:mi mathvariant="bold-italic">S</mml:mi>
                  </mml:mrow>
                </mml:mfenced>
                <mml:mi mathvariant="bold-italic">T</mml:mi>
              </mml:msup>
              <mml:mfenced close=")" open="(">
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">S</mml:mi>
                  <mml:mo mathvariant="bold-italic">−</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mn mathvariant="bold">1</mml:mn>
                      <mml:msup>
                        <mml:mn mathvariant="bold">1</mml:mn>
                        <mml:mi mathvariant="bold-italic">T</mml:mi>
                      </mml:msup>
                    </mml:mrow>
                    <mml:mi mathvariant="bold-italic">n</mml:mi>
                  </mml:mfrac>
                  <mml:mi mathvariant="bold-italic">S</mml:mi>
                </mml:mrow>
              </mml:mfenced>
              <mml:mo mathvariant="bold-italic">,</mml:mo>
            </mml:math>
            <graphic xlink:href="13059_2021_2404_Article_Eque.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
        <disp-formula id="Equf">
          <alternatives>
            <tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\boldsymbol{y}}^{\boldsymbol{T}}\boldsymbol{H}\boldsymbol{\Sigma } \boldsymbol{H}\boldsymbol{y}={\boldsymbol{y}}^{\boldsymbol{T}}\boldsymbol{H}\boldsymbol{S}{\left({\boldsymbol{S}}^{\boldsymbol{T}}\boldsymbol{S}\right)}^{-\mathbf{1}}{\boldsymbol{S}}^{\boldsymbol{T}}\boldsymbol{H}\boldsymbol{y}={\left(\boldsymbol{y}-\overline{y}\right)}^{\boldsymbol{T}}\boldsymbol{S}{\left({\boldsymbol{S}}^{\boldsymbol{T}}\boldsymbol{S}\right)}^{-\mathbf{1}}{\boldsymbol{S}}^{\boldsymbol{T}}\left(\boldsymbol{y}-\overline{y}\right). $$\end{document}</tex-math>
            <mml:math id="M20" display="block">
              <mml:msup>
                <mml:mi mathvariant="bold-italic">y</mml:mi>
                <mml:mi mathvariant="bold-italic">T</mml:mi>
              </mml:msup>
              <mml:mi mathvariant="bold-italic">H</mml:mi>
              <mml:mi mathvariant="bold">Σ</mml:mi>
              <mml:mi mathvariant="bold-italic">Hy</mml:mi>
              <mml:mo>=</mml:mo>
              <mml:msup>
                <mml:mi mathvariant="bold-italic">y</mml:mi>
                <mml:mi mathvariant="bold-italic">T</mml:mi>
              </mml:msup>
              <mml:mi mathvariant="bold-italic">HS</mml:mi>
              <mml:msup>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:msup>
                      <mml:mi mathvariant="bold-italic">S</mml:mi>
                      <mml:mi mathvariant="bold-italic">T</mml:mi>
                    </mml:msup>
                    <mml:mi mathvariant="bold-italic">S</mml:mi>
                  </mml:mrow>
                </mml:mfenced>
                <mml:mrow>
                  <mml:mo>−</mml:mo>
                  <mml:mn mathvariant="bold">1</mml:mn>
                </mml:mrow>
              </mml:msup>
              <mml:msup>
                <mml:mi mathvariant="bold-italic">S</mml:mi>
                <mml:mi mathvariant="bold-italic">T</mml:mi>
              </mml:msup>
              <mml:mi mathvariant="bold-italic">Hy</mml:mi>
              <mml:mo>=</mml:mo>
              <mml:msup>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:mi mathvariant="bold-italic">y</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mover accent="true">
                      <mml:mi>y</mml:mi>
                      <mml:mo stretchy="true">¯</mml:mo>
                    </mml:mover>
                  </mml:mrow>
                </mml:mfenced>
                <mml:mi mathvariant="bold-italic">T</mml:mi>
              </mml:msup>
              <mml:mi mathvariant="bold-italic">S</mml:mi>
              <mml:msup>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:msup>
                      <mml:mi mathvariant="bold-italic">S</mml:mi>
                      <mml:mi mathvariant="bold-italic">T</mml:mi>
                    </mml:msup>
                    <mml:mi mathvariant="bold-italic">S</mml:mi>
                  </mml:mrow>
                </mml:mfenced>
                <mml:mrow>
                  <mml:mo>−</mml:mo>
                  <mml:mn mathvariant="bold">1</mml:mn>
                </mml:mrow>
              </mml:msup>
              <mml:msup>
                <mml:mi mathvariant="bold-italic">S</mml:mi>
                <mml:mi mathvariant="bold-italic">T</mml:mi>
              </mml:msup>
              <mml:mfenced close=")" open="(">
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">y</mml:mi>
                  <mml:mo>−</mml:mo>
                  <mml:mover accent="true">
                    <mml:mi>y</mml:mi>
                    <mml:mo stretchy="true">¯</mml:mo>
                  </mml:mover>
                </mml:mrow>
              </mml:mfenced>
              <mml:mo>.</mml:mo>
            </mml:math>
            <graphic xlink:href="13059_2021_2404_Article_Equf.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p id="Par30">Finally, we note that the quantities involving <bold><italic>S</italic></bold>, including the computation of <bold><italic>S</italic></bold><sup><bold><italic>T</italic></bold></sup><bold><italic>S</italic></bold> and <bold><italic>S</italic></bold><sup><bold><italic>T</italic></bold></sup><bold><italic>HS</italic></bold> as well as the eigen decomposition of (<bold><italic>S</italic></bold><sup><bold><italic>T</italic></bold></sup><bold><italic>S</italic></bold>)<sup><bold><italic>−</italic></bold><bold>1</bold></sup><bold><italic>S</italic></bold><sup><bold><italic>T</italic></bold></sup><bold><italic>HS</italic></bold>, only need to be performed once at the beginning and need not to be re-computed for every gene in turn. The quantities involving <bold><italic>y</italic></bold>, including <bold><italic>y</italic></bold><sup><bold><italic>T</italic></bold></sup><bold><italic>y</italic></bold>, <bold><italic>y</italic></bold><sup><bold><italic>T</italic></bold></sup><bold><italic>Hy</italic></bold>, and <bold><italic>y</italic></bold><sup><bold><italic>T</italic></bold></sup><bold><italic>H</italic></bold><bold>Σ</bold><bold><italic>Hy</italic></bold>, would vary across genes but could be computed efficiently relying on the sparsity of <bold><italic>y</italic></bold>. Indeed, these three quantities can be computed with a computational complexity that scales linearly with respect to the number of samples with non-zero values, resulting in substantial computational savings for large sparse data. Therefore, our method has an overall computational complexity of <italic>O</italic>(<italic>nd</italic><sup>2</sup> + <italic>pn</italic> ′ <italic>d</italic>) and memory requirement of <italic>O</italic>(<italic>nd</italic><sup>2</sup>), where <italic>p</italic> is the number of analyzed genes and <italic>n</italic>′ is the number of spatial locations with non-zero counts averaged across genes.</p>
      <p id="Par31">The statistical power of the above covariance test will inevitably depend on how the distance covariance matrix <bold><italic>Σ</italic></bold> is constructed and how it matches the true underlying spatial pattern displayed by the gene of interest. While the above projection kernel construction allows us to achieve orders of magnitude of computational gains as compared to other kernels such as the Gaussian and periodic kernels used in SPARK, it is likely not optimal in detecting every possible expression patterns encountered in real data. For example, the projection kernel is likely suboptimal in detecting focal expression patterns that are targeted by Gaussian kernels or periodical expression patterns that are targeted by periodic kernels. To ensure robust identification of SE genes across various possible spatial expression patterns, we consider different transformations of the spatial coordinates <bold><italic>s</italic></bold><sub><bold><italic>i</italic></bold></sub> and subsequent construction of different distance covariance matrices. Specifically, we applied five Gaussian transformations on the coordinates <bold><italic>s</italic></bold><sub><bold><italic>i</italic></bold></sub> = (<italic>s</italic><sub><italic>i</italic>1</sub>, <italic>s</italic><sub><italic>i</italic>2</sub>) to obtain five sets of transformed coordinates <bold><italic>s</italic></bold>′<sub><bold><italic>i</italic></bold></sub> = (<italic>s</italic>′<sub><italic>i</italic>1</sub>, <italic>s</italic>′<sub><italic>i</italic>2</sub>) , with <inline-formula id="IEq5"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {s}_{i1}^{\prime }=\mathit{\exp}\left(\frac{-{s}_{i1}^2}{2{\sigma}_1^2}\right) $$\end{document}</tex-math><mml:math id="M22" display="inline"><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mo mathvariant="italic">exp</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2021_2404_Article_IEq5.gif"/></alternatives></inline-formula> being the transformed x-coordinate and <inline-formula id="IEq6"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {s}_{i2}^{\prime }=\mathit{\exp}\left(\frac{-{s}_{i2}^2}{2{\sigma}_2^2}\right) $$\end{document}</tex-math><mml:math id="M24" display="inline"><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mo mathvariant="italic">exp</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2021_2404_Article_IEq6.gif"/></alternatives></inline-formula> being the transformed y-coordinate in each set. In the transformation, we used different smoothness parameters <italic>σ</italic><sub>1</sub> and <italic>σ</italic><sub>2</sub> in each set to cover a range of possible local covariance patterns. In addition, we applied five cosine transformations on <bold><italic>s</italic></bold><sub><bold><italic>i</italic></bold></sub> to obtain another five sets of transformed coordinates <bold><italic>s</italic></bold>′<sub><bold><italic>i</italic></bold></sub>, with <inline-formula id="IEq7"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {s}_{i1}^{\prime }=\cos \left(\frac{2\pi {s}_{i1}}{\phi_1}\right) $$\end{document}</tex-math><mml:math id="M26" display="inline"><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mo>cos</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2021_2404_Article_IEq7.gif"/></alternatives></inline-formula> being the transformed x-coordinate and <inline-formula id="IEq8"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {s}_{i2}^{\prime }=\cos \left(\frac{2\pi {s}_{i2}}{\phi_2}\right) $$\end{document}</tex-math><mml:math id="M28" display="inline"><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mo>cos</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfrac></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2021_2404_Article_IEq8.gif"/></alternatives></inline-formula> being the transformed y-coordinate in each set. We also used different periodicity parameters <italic>ϕ</italic><sub>1</sub> and <italic>ϕ</italic><sub>2</sub> in each set to cover a range of possible periodic patterns. The transformation parameters <italic>σ</italic><sub>1</sub>, <italic>σ</italic><sub>2</sub>, <italic>ϕ</italic><sub>1</sub>, and <italic>ϕ</italic><sub>2</sub> are predetermined using the 20%, 40%, 60%, 80%, and 100% quantiles of the absolute values of the <italic>x</italic> and <italic>y</italic> coordinates in the data. Using the empirical quantiles of the data to construct different covariance matrices follows the main ideas of [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>]. Compared to the alternative approach of fixing the transformation parameters to some predetermined values, using the quantiles of the data for transformation has the benefits of being invariant to any scale transformation of the original data and allows us to construct the distance covariance matrices in a data-dependent fashion.</p>
      <p id="Par32">We used each transformed <inline-formula id="IEq9"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\boldsymbol{s}}_{\boldsymbol{i}}^{\prime } $$\end{document}</tex-math><mml:math id="M30" display="inline"><mml:msubsup><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mi mathvariant="bold-italic">i</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2021_2404_Article_IEq9.gif"/></alternatives></inline-formula> to construct a distance covariance matrix as described above, resulting in a total of ten transformed distance covariance matrices in addition to the untransformed distance covariance matrix (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S17). Intuitively, the kernel constructed based on the untransformed coordinates is likely useful to detect linear expression pattern across the coordinates. The kernels constructed based on the cosine transformed coordinates are likely useful to detect periodic expression patterns on the tissue. While the kernels constructed based on the Gaussian transformed coordinates are likely useful to detect focal expression patterns on the tissue. Therefore, combining the original and transformed distance covariance matrices would allow us to detect a wide variety of spatial expression patterns encountered in real data. To do so, we computed a <italic>P</italic> value using Davies’ method for each distance covariance matrix. We then combined all eleven <italic>P</italic> values into a single <italic>P</italic> value through the Cauchy <italic>P</italic> value combination rule [<xref ref-type="bibr" rid="CR72">72</xref>, <xref ref-type="bibr" rid="CR73">73</xref>].</p>
      <p id="Par33">We have so far described the method in the absence of covariates. In the presence of covariates, we can replace the <italic>n</italic>-vector <bold>1</bold><sub><italic>n</italic></sub> in the <bold><italic>H</italic></bold> matrix with a corresponding covariate matrix <bold><italic>X</italic></bold> of dimensionality <italic>n</italic> by <italic>q</italic>. The covariate matrix contains a column of 1’s that represents the intercept, with the remaining columns representing the measurements for the <italic>q</italic>-1 covariates. Therefore, the centering matrix becomes <bold><italic>H =</italic></bold> (<bold><italic>I − X</italic></bold>(<bold><italic>X</italic></bold><sup><bold><italic>T</italic></bold></sup><bold><italic>X</italic></bold>)<sup><bold><italic>−</italic></bold><bold>1</bold></sup><bold><italic>X</italic></bold><sup><bold><italic>T</italic></bold></sup>). Despite this change, the other steps remain the same.</p>
      <p id="Par34">We refer to the above method as SPARK-X (SPARK-eXpedited), which is implemented in the SPARK R package with underlying efficient C/C++ code linked through Rcpp and with multiple threads computing capability. The software, together with all the analysis code for reproducing the results presented in the present study, are freely available at <ext-link ext-link-type="uri" xlink:href="http://www.xzlab.org/software.html">www.xzlab.org/software.html</ext-link>.</p>
    </sec>
    <sec id="Sec10">
      <title>Simulation designs</title>
      <p id="Par35">We performed extensive simulations to comprehensively evaluate the performance of SPARK-X along with several other existing methods. To make simulations as realistic as possible, we simulated data based on parameters inferred from two published data sets that include a spatial transcriptomic (ST) data set [<xref ref-type="bibr" rid="CR11">11</xref>] and a Slide-seq data set (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S16). The two data sets represent two different gene-expression data structures, with the ST data representing a moderately sparse data with 60% of zero values and the Slide-seq data representing a highly sparse data with 99.4% of zero values (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). In the simulations, we first randomly simulated the coordinates for a fixed number of spatial locations (<italic>n</italic>) through a random-point-pattern Poisson process. On these spatial locations, we simulated expression levels for 10,000 genes based on a negative binomial distribution with details provided below. These 10,000 genes were all non-SE genes in the null simulations and consisted of 1000 SE genes and 9000 non-SE genes in the power simulations. For both non-SE genes and SE genes, we varied the dispersion parameter of the negative binomial distribution to be either 0.1, 0.2, or 1 for the moderately sparse setting and to be either 1, 2.5, or 5 for the highly sparse setting. These values were selected to match the scale of dispersion parameter estimated in the two real data sets. For the non-SE genes, we varied the mean parameter of the negative binomial distribution to be either 0.005 or 0.5. The low value of 0.005 corresponds to the median mean estimate in the Slide-seq data and represents a highly sparse gene-expression setting. The high value of 0.5 corresponds to the median mean estimate in the ST data and represents a moderately sparse gene-expression setting. For the SE genes, we simulated their expression levels to display three distinct spatial patterns (hotspot, streak, and gradient patterns, Fig. <xref rid="Fig1" ref-type="fig">1</xref>D).</p>
      <p id="Par36">Specifically, for the first two spatial patterns, we created either a circle (for hotspot pattern) or a band (for streak pattern) in the middle of the panel and marked spatial locations residing in these areas. The size of the circle and the size of the band were designed so that the marked spatial locations inside these areas represent a fixed proportion of all spatial locations, with the proportion set to be either 10%, 20%, or 30%. The expression measurements of the non-marked spatial locations were randomly generated from a negative binomial distribution with the mean parameter set to be 0.005 or 0.5. For the moderately sparse setting, the expression measurements of the marked spatial locations were generated from a negative binomial distribution with a mean parameter being either 1.5, 2, or 3 times higher than that in the non-marked spatial locations (for 500 SE genes) or 2/3, 1/2, or 1/3 of that in the non-marked spatial locations (for 500 SE genes), representing low, moderate, or high SE signal strength, respectively. For the highly sparse setting, the expression measurements of the marked spatial locations were generated from a negative binomial distribution with a mean parameter being either 2, 3, or 4 higher than that in the non-marked spatial locations (for 500 SE genes) or 1/2, 1/3, or 1/4 of that in the in the non-marked spatial locations (for 500 SE genes), representing low, moderate, or high SE signal strength, respectively.</p>
      <p id="Par37">For the gradient pattern, the expression levels of a fraction of spatial locations (=20%, 30%, or 40%) were set either in an increasing order (for 500 SE genes) or a decreasing order (for the other 500 SE genes) along the x-axis. The three fractions used correspond to low, moderate, or high SE signal strength in this setting, respectively. In particular, we generated the expression measurements for all spatial locations from a negative binomial distribution. For each SE gene, we randomly selected a fraction of spatial locations where we assigned their gene-expression values in either increasing or decreasing order back to them based on their x-axis coordinates. In contrast, the expression measurements for the non-SE genes were randomly assigned to all spatial locations, regardless of their spatial locations.</p>
      <p id="Par38">In all these simulations, we varied the number of spatial locations (n = 300, 500, 1000, 2000, or 3000 for the moderate sparsity setting and n = 3000, 10,000, 20,000, 30,000, or 50,000 for the highly sparse setting), the expression sparsity level (moderate or high, as measured by the mean parameter in the negative binomial distribution), the noise level (low, moderate or high noise, as measured by the dispersion parameter in the negative binomial distribution), the SE strength (weak, moderate, or strong, as measured by fold change in the mean parameter for the first two spatial patterns and by the fraction of spatial locations displaying expression gradient for the third spatial pattern), as well as the fraction of spatial locations in the focal/streak area for the first two spatial patterns.</p>
    </sec>
    <sec id="Sec11">
      <title>Real data analysis</title>
      <sec id="Sec12">
        <title>Slide-seq data</title>
        <p id="Par39">Slide-seq is a technology which enables transcriptome-wide measurements with 10-micron spatial resolution by transferring RNA from tissue sections onto a surface covered in DNA-barcoded beads with known positions and inferring the locations of RNA using a sequencing-by-ligation strategy. We obtained the Slide-seq dataset collected on the mouse cerebellum from Broad Institute’s single-cell repository (<ext-link ext-link-type="uri" xlink:href="https://singlecell.broadinstitute.org/single_cell/">https://singlecell.broadinstitute.org/single_cell/</ext-link>) with ID SCP354. We used the file “Puck_180430_6” which contains 18,671 genes measured on 25,551 beads with known spatial location information. The bead size is approaching the size of mammalian cells (10 microns), though each bead may overlap with multiple cells. After filtering out mitochondrial genes and genes that are not expressed on any bead, we analyzed a final set of 17,729 genes on 25,551 beads. The data is highly sparse with 99.46% entries being 0 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1).</p>
      </sec>
      <sec id="Sec13">
        <title>Slide-seqV2 data</title>
        <p id="Par40">Slide-seqV2 is a technology that builds upon on Slide-seq with modifications to library generation, bead synthesis, and array-indexing, thereby markedly improving the mRNA capture sensitivity. We obtained the Slide-seqV2 dataset collected on the mouse cerebellum from Broad Institute’s single-cell repository with ID SCP948. The data contains 23,096 genes measured on 39,496 beads with known spatial location information. The bead size is the same as that in the Slide-seq data. Following [<xref ref-type="bibr" rid="CR36">36</xref>], we first cropped the region of interest and filtered out beads with UMIs less than 100. After filtering out mitochondrial genes and genes that are not expressed on any bead, we analyzed a final set of 20,117 genes on 11,626 beads. While the capture sensitivity is improved in the Slide-seqV2 as compared to Slide-seqV1, the Slide-seqV2 data is still highly sparse with 98.35% entries being zero (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1).</p>
        <p id="Par41">We performed cell decomposition and conditional SE analysis on the Slide-seqV2 data. Specifically, we used the recently developed RCTD software [<xref ref-type="bibr" rid="CR36">36</xref>] (v.1.0.0) to infer cell type composition on each spatial location. Following the original RCTD paper, we used a single-nucleus RNA-seq data [<xref ref-type="bibr" rid="CR74">74</xref>] to serve as the reference panel for RCTD fitting, which contains 19 cell types. In the analysis, RCTD rejected 1494 beads and assigned cell type labels to 11,061 cells confidently from 9554 beads. We converted the inferred cell types into binary indicators and used them as covariates in SE analysis. Because RCTD produced confident cell type assignment using a set of 3338 genes (after RCTD filtering) on 11,061 cells (inferred from 9554 beads), we performed analysis on these genes and locations in the covariate adjusted SE analysis.</p>
        <p id="Par42">Besides conditional SE analysis, we also performed the cell type-specific SE analysis in the data. Specifically, we rely on the cell type composition estimates from RCTD to extract the locations that are dominated by Purkinje cells or granular cells. The Purkinje cells are primarily located in the thin Purkinje cell layer while the granule cells are primarily located in the thick granular layer; both layers are of highly irregular shapes. After removing genes with no expression on any of the selected cells, we performed SE analysis using SPARK-X for 3006 genes on 652 Purkinje cells and 3288 genes on 5891 granule cells.</p>
      </sec>
      <sec id="Sec14">
        <title>High-definition spatial transcriptomics data</title>
        <p id="Par43">High-definition spatial transcriptomics is a method to capture RNA from tissue sections on a dense, spatially barcoded bead array, allowing transcriptome-wide measurements with 2-micron resolution. We obtained the HDST dataset collected on the mouse olfactory bulb from Broad Institute’s single-cell repository with ID SCP420. We used the file “CN24_D1” which contains 19,951 genes measured in 181,380 spots with known spatial location information. Each spot is a 2-micron well, approaching one fifth of the size of mammalian cells. We filtered out mitochondrial genes and genes that are not expressed on any spot and we removed spots with no gene-expression count. We analyzed a final set of 19,913 genes on 177,455 spots. The HDST data is extremely sparse with 99.96% of entries being 0 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). We performed clustering analysis on the detected SE genes. To do so, for each gene in turn, we log transformed the raw count and scaled the transformed value further to have a mean of zero and standard deviation of one across all spots. We then used the hierarchical agglomerative clustering algorithm in the R package <italic>amap</italic> (v.0.8–18) to cluster identified SE genes into five gene groups.</p>
        <p id="Par44">We performed conditional SE analysis on a subset of the HDST data to examine the extent to which SE genes display spatial expression pattern beyond those explained by spatial distribution of cell types. To do so, we first extracted the most likely cell type for each spot based on the original publication and kept the spots with confident cell type assignment (<italic>P</italic>-adjust&lt; 0.05). After filtering out mitochondrial genes and genes that are not expressed on any spots, we analyzed a final set of 17,121 genes on 103,602 spots. There are 63 cell types including non-neuronal cell types and multiple neuronal subtypes clustered in the original publication. We treated the assigned cell types as covariates for SE analysis on these spots.</p>
        <p id="Par45">We also performed cell type-specific SE analysis on a subtype of inhibitory neurons, the olfactory bulb inner horizontal cells (OBINH2). We selected these inhibitory neurons as they have the largest cell numbers among all cell types in the data. In the analysis, we extracted spatial locations that are labeled as OBINH2 neurons and removed genes that are not expressed on any of the extracted locations. In total, we analyzed 11,504 genes measured on 15,650 spatial locations in the cell type-specific SE analysis.</p>
      </sec>
      <sec id="Sec15">
        <title>10X Visium data</title>
        <p id="Par46">The 10X Visium is a platform that builds upon on the original Spatial Transcriptomics technology with improvements on both resolution (55-micron resolution, with smaller distance between barcoded regions) and experimental time. We obtained a Visium dataset collected on the human heart tissue from the 10X Visium spatial gene-expression repository (<ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/spatial-gene-expression/datasets/1.1.0/V1_Human_Heart">https://support.10xgenomics.com/spatial-gene-expression/datasets/1.1.0/V1_Human_Heart</ext-link>). The data contains 36,601 genes measured on 4247 spots with known spatial location information. Each spot is a 55-micron well. We filtered out mitochondrial genes and genes that are not expressed in any spot. We analyzed a final set of 20,904 genes on 4247 spots. The 10X Visium human heart data is relatively sparse with 90.81% of entries being 0 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). In addition, we also obtained a Visium dataset collected on the human ovarian cancer tissue from the 10X Visium spatial gene-expression repository (<ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/spatial-gene-expression/datasets/1.2.0/Targeted_Visium_Human_OvarianCancer_Pan_Cancer">https://support.10xgenomics.com/spatial-gene-expression/datasets/1.2.0/Targeted_Visium_Human_OvarianCancer_Pan_Cancer</ext-link>). The data contains 1198 genes measured on the 3493 spots. After removing spot with no gene-expression count, we analyzed a final set of 1198 genes on 3492 spots. Since this data is generated with an enriched library prepared using the Human Pan-Cancer Panel, only 73.78% of entries are 0.</p>
      </sec>
      <sec id="Sec16">
        <title>STARmap data</title>
        <p id="Par47">Spatially resolved Transcript Amplicon Readout Mapping (STARmap) is a technology for 3D intact-tissue RNA sequencing. STARmap integrates hydrogel-tissue chemistry, targeted signal amplification, and in situ sequencing. We obtained the STARmap dataset collected on the mouse visual cortex from STARmap resources (<ext-link ext-link-type="uri" xlink:href="https://www.starmapresources.com/data">https://www.starmapresources.com/data</ext-link>). We used the data collected in the sequentially encoded experiment, which contains 28 genes measured in 33,598 cells with known 3D spatial location information. These 28 genes include 23 cell type markers and 5 activity-regulated genes. After filtering out cells with no gene-expression count, we analyzed a final set of 28 genes on 32,845 cells. The STARmap data are of high counts with almost no zero values (1.2% zeros; Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). We followed the procedures in the original paper [<xref ref-type="bibr" rid="CR75">75</xref>] for cell type clustering. Specifically, we first applied log transformation to the raw count data and obtained the relative gene-expression levels through adjusting for the log-scale total read counts. We then clustered cells into inhibitory neurons, excitatory neurons, and non-neuronal cells using <italic>Gad1</italic>, <italic>Slc17a7</italic>, and four non-neuronal genes (<italic>Flt1</italic>, <italic>Mbp</italic>, <italic>Ctss</italic>, <italic>Gja1</italic>) using the K-means clustering algorithm.</p>
        <p id="Par48">For each of the above datasets, we performed permutations to construct an empirical null distribution of <italic>P</italic> values for each method by permuting the bead/spot/cell coordinates either ten times (for Slide-seq, Slide-seqV2, HDST, and 10X Visium data) or a thousand times (for STARmap data). Afterwards, we examined control of type I errors by the different methods on the basis of the empirical null distribution of <italic>P</italic> values. We declared an SE gene as significant based on an empirical FDR threshold of 0.01. We note that standard <italic>P</italic> value cutoffs such as Bonferroni-corrected <italic>P</italic> value threshold can also be used for SPARK-X due to its calibrated type I error control.</p>
      </sec>
      <sec id="Sec17">
        <title>SE gene validation and functional gene set enrichment analysis</title>
        <p id="Par49">For the Slide-seq data, we obtained lists of genes that can be used to serve as unbiased validation for the SE genes identified by different methods. Specifically, we obtained the cerebellum gene list from the Harmonizome database [<xref ref-type="bibr" rid="CR29">29</xref>], which consists of 2632 cerebellum-related genes identified in two datasets (Allen Brain Atlas adult mouse brain tissue gene-expression profiles; and TISSUES curated tissue protein expression evidence scores). In addition, we obtained a gene list from Wizeman et al. [<xref ref-type="bibr" rid="CR30">30</xref>], which contains 4152 cell type markers genes in cerebellum. We used the two gene lists to validate the SE genes identified by different methods.</p>
        <p id="Par50">We also performed functional gene set enrichment analysis on the significant SE genes identified by SPARK-X and SPARK-G. We performed enrichment analyses using the R package clusterProfiler [<xref ref-type="bibr" rid="CR76">76</xref>] (v.3.12.0) with GO terms and Reactome pathways. In the package, we used the default “BH” method for multiple-testing correction and set the default number of permutations to be 1000. We declared enrichment significance based on an FDR of 0.05.</p>
      </sec>
      <sec id="Sec18">
        <title>Compared methods</title>
        <p id="Par51">We compared SPARK-X with three existing methods for detecting genes with spatial expression patterns: SPARK (v.1.1.0) [<xref ref-type="bibr" rid="CR6">6</xref>], SPARK-G (the Gaussian version of SPARK), and SpatialDE (v.1.1.3) [<xref ref-type="bibr" rid="CR5">5</xref>]. We did not include the trendsceek in the comparison due to its high computational burden. For example, it takes trendsceek 40 h to analyze a simulated data with 10,000 genes measured on 300 locations, which is 5000 times slower than SPARK-X. The computational burden of trendsceek becomes even heavier on larger datasets. We applied all four methods to the simulated data with SPARK being restricted to the settings that have a sample size ≤ 3000 due to its heavy computational burden. We applied SPARK-X, SPARK-G, and SpatialDE to the Slide-seq and Slide-seqV2 data. The SPARK-G and SpatialDE are not scalable when the sample size is over approximately 30,000. Therefore, we did not apply these two methods to the HDST data. The SpatialDE gave out error when we applied it to the STARmap data; thus, we only present the results from SPARK-X and SPARK-G there. For SPARK and SpatialDE, we adopted their default settings to filter data. Specifically, for SPARK, we filtered out genes that are expressed in less than 10% of the spatial locations and selected spatial locations with at least ten total read counts; for SpatialDE, we filtered out genes with aggregate expression count less than three and selected spatial locations with at least ten total read counts. For the SPARK-G, we did not perform any additional filtering. The number of analyzed gene for each method is provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec19">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2021_2404_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1: Supplementary information.</bold> It includes all the supplementary figures and tables.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2021_2404_MOESM2_ESM.xlsx">
            <caption>
              <p><bold>Additional file 2: Supplementary Table 4.</bold> Enrichment analysis of SE genes for the mouse cerebellum Slide-seq data.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="13059_2021_2404_MOESM3_ESM.xlsx">
            <caption>
              <p><bold>Additional file 3: Supplementary Table 5.</bold> Enrichment analysis of SE genes for the mouse cerebellum Slide-seqV2 data.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="13059_2021_2404_MOESM4_ESM.xlsx">
            <caption>
              <p><bold>Additional file 4: Supplementary Table 6.</bold> Enrichment analysis of SE genes for the mouse olfactory bulb HDST data.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="13059_2021_2404_MOESM5_ESM.xlsx">
            <caption>
              <p><bold>Additional file 5: Supplementary Table 7.</bold> Enrichment analysis of SE genes for the human ovarian cancer Visium data.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="13059_2021_2404_MOESM6_ESM.docx">
            <caption>
              <p><bold>Additional file 6.</bold> Review history.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We gratefully thank Mr. Dylan M. Cable for his technical assistance in the RCTD application.</p>
    <sec id="FPar1">
      <title>Review history</title>
      <p id="Par52">The review history is available as Additional file <xref rid="MOESM6" ref-type="media">6</xref>.</p>
    </sec>
    <sec id="FPar2">
      <title>Peer review information</title>
      <p id="Par53">Barbara Cheifet was the primary editor of this article and managed its editorial process and peer review in collaboration with the rest of the editorial team.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>XZ conceived the idea and provided funding support. JZ and XZ designed the experiments. JZ developed the method and implemented the software, with help from SS. JZ performed simulations and analyzed real data. JZ and XZ wrote the manuscript with input from SS. The authors read and approved the final manuscript.</p>
    <sec id="FPar3">
      <title>Authors’ information</title>
      <p id="Par54">Twitter handles: @ZhuJiaqiang (Jiaqiang Zhu); @SunShiquan (Shiquan Sun); @xzlab_org (Xiang Zhou).</p>
    </sec>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This study was supported by the National Institutes of Health (NIH) Grants R01HG009124, R01GM126553, R01HG011883, R01GM144960, and the National Science Foundation (NSF) Grant DMS1712933. J.Z. was also supported by NIH Grant R01HD088558 (PI Tung).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>All codes, processed data, and analysis results in this paper are publicly available at GitHub [<xref ref-type="bibr" rid="CR77">77</xref>] and Zenodo [<xref ref-type="bibr" rid="CR78">78</xref>]. The source code is released under the MIT license. Slide-seq data, Slide-seqV2 data, and HDST data are available at Broad Institute’s single-cell repository (<ext-link ext-link-type="uri" xlink:href="https://singlecell.broadinstitute.org/single_cell/">https://singlecell.broadinstitute.org/single_cell/</ext-link>) with ID SCP354, SCP948, and SCP420. The 10X Visium data sets are available at <ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/spatial-gene-expression/datasets/1.1.0/V1_Human_Heart">https://support.10xgenomics.com/spatial-gene-expression/datasets/1.1.0/V1_Human_Heart</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/spatial-gene-expression/datasets/1.2.0/Targeted_Visium_Human_OvarianCancer_Pan_Cancer">https://support.10xgenomics.com/spatial-gene-expression/datasets/1.2.0/Targeted_Visium_Human_OvarianCancer_Pan_Cancer</ext-link>. The STARmap data set is available at <ext-link ext-link-type="uri" xlink:href="https://www.starmapresources.com/data">https://www.starmapresources.com/data</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar4">
      <title>Ethics approval and consent to participate</title>
      <p id="Par55">No ethical approval was required for this study. All utilized public data sets were generated by other organizations that obtained ethical approval.</p>
    </notes>
    <notes id="FPar5">
      <title>Consent for publication</title>
      <p id="Par56">Not applicable.</p>
    </notes>
    <notes id="FPar6" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par57">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Asp</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Giacomello</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Larsson</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Fürth</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Qian</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A spatiotemporal organ-wide gene expression and cell atlas of the developing human heart</article-title>
        <source>Cell</source>
        <year>2019</year>
        <volume>179</volume>
        <issue>7</issue>
        <fpage>1647</fpage>
        <lpage>60. e19</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2019.11.025</pub-id>
        <pub-id pub-id-type="pmid">31835037</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ortiz</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Navarro</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Jurek</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Märtin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lundeberg</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Meletis</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Molecular atlas of the adult mouse brain</article-title>
        <source>Sci Adv</source>
        <year>2020</year>
        <volume>6</volume>
        <issue>26</issue>
        <fpage>eabb3446</fpage>
        <pub-id pub-id-type="doi">10.1126/sciadv.abb3446</pub-id>
        <pub-id pub-id-type="pmid">32637622</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Merritt</surname>
            <given-names>CR</given-names>
          </name>
          <name>
            <surname>Ong</surname>
            <given-names>GT</given-names>
          </name>
          <name>
            <surname>Church</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Barker</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Danaher</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Geiss</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Hoang</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Jung</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>McKay-Fleisch</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Norgaard</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Sorg</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Sprague</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Warren</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Warren</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Webster</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Zollinger</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Dunaway</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Mills</surname>
            <given-names>GB</given-names>
          </name>
          <name>
            <surname>Beechem</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>Multiplex digital spatial profiling of proteins and RNA in fixed tissue</article-title>
        <source>Nat Biotechnol</source>
        <year>2020</year>
        <volume>38</volume>
        <issue>5</issue>
        <fpage>586</fpage>
        <lpage>599</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-020-0472-9</pub-id>
        <?supplied-pmid 32393914?>
        <pub-id pub-id-type="pmid">32393914</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edsgard</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Johnsson</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Sandberg</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Identification of spatial expression trends in single-cell gene expression data</article-title>
        <source>Nat Methods.</source>
        <year>2018</year>
        <volume>15</volume>
        <issue>5</issue>
        <fpage>339</fpage>
        <lpage>342</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4634</pub-id>
        <?supplied-pmid 29553578?>
        <pub-id pub-id-type="pmid">29553578</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Svensson</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Stegle</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>SpatialDE: identification of spatially variable genes</article-title>
        <source>Nat Methods.</source>
        <year>2018</year>
        <volume>15</volume>
        <issue>5</issue>
        <fpage>343</fpage>
        <lpage>346</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4636</pub-id>
        <?supplied-pmid 29553579?>
        <pub-id pub-id-type="pmid">29553579</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sun</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Statistical analysis of spatial expression patterns for spatially resolved transcriptomic studies</article-title>
        <source>Nat Methods.</source>
        <year>2020</year>
        <volume>17</volume>
        <issue>2</issue>
        <fpage>193</fpage>
        <lpage>200</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0701-7</pub-id>
        <?supplied-pmid 31988518?>
        <pub-id pub-id-type="pmid">31988518</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ji</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Rubin</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Thrane</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Reynolds</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Meyers</surname>
            <given-names>RM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multimodal analysis of composition and spatial architecture in human squamous cell carcinoma</article-title>
        <source>Cell</source>
        <year>2020</year>
        <volume>182</volume>
        <issue>2</issue>
        <fpage>497</fpage>
        <lpage>514. e22</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2020.05.039</pub-id>
        <pub-id pub-id-type="pmid">32579974</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Shah</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dries</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>G-C</given-names>
          </name>
        </person-group>
        <article-title>Identification of spatially associated subpopulations by combining scRNAseq and sequential fluorescence in situ hybridization data</article-title>
        <source>Nat Biotechnol</source>
        <year>2018</year>
        <volume>36</volume>
        <issue>12</issue>
        <fpage>1183</fpage>
        <lpage>1190</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4260</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ghazanfar</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Patrick</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>Z-G</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>JYH</given-names>
          </name>
        </person-group>
        <article-title>Investigating higher-order interactions in single-cell data with scHOT</article-title>
        <source>Nat Methods.</source>
        <year>2020</year>
        <volume>17</volume>
        <issue>8</issue>
        <fpage>799</fpage>
        <lpage>806</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-020-0885-x</pub-id>
        <?supplied-pmid 32661426?>
        <pub-id pub-id-type="pmid">32661426</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Arnol</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Schapiro</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Bodenmiller</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Saez-Rodriguez</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Stegle</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Modeling cell-cell interactions from spatial molecular data with spatial variance component analysis</article-title>
        <source>Cell Rep</source>
        <year>2019</year>
        <volume>29</volume>
        <issue>1</issue>
        <fpage>202</fpage>
        <lpage>11. e6</lpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2019.08.077</pub-id>
        <pub-id pub-id-type="pmid">31577949</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ståhl</surname>
            <given-names>PL</given-names>
          </name>
          <name>
            <surname>Salmén</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Vickovic</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lundmark</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Navarro</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Magnusson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Giacomello</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Asp</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Westholm</surname>
            <given-names>JO</given-names>
          </name>
          <name>
            <surname>Huss</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mollbrink</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Linnarsson</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Codeluppi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Borg</surname>
            <given-names>Å</given-names>
          </name>
          <name>
            <surname>Pontén</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Costea</surname>
            <given-names>PI</given-names>
          </name>
          <name>
            <surname>Sahlén</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mulder</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bergmann</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Lundeberg</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Frisén</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Visualization and analysis of gene expression in tissue sections by spatial transcriptomics</article-title>
        <source>Science.</source>
        <year>2016</year>
        <volume>353</volume>
        <issue>6294</issue>
        <fpage>78</fpage>
        <lpage>82</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aaf2403</pub-id>
        <?supplied-pmid 27365449?>
        <pub-id pub-id-type="pmid">27365449</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>W-T</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Craessaerts</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Pavie</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Frigerio</surname>
            <given-names>CS</given-names>
          </name>
          <name>
            <surname>Corthout</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Qian</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Laláková</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kühnemund</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Voytyuk</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Wolfs</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Spatial transcriptomics and in situ sequencing to study Alzheimer’s disease</article-title>
        <source>Cell.</source>
        <year>2020</year>
        <volume>182</volume>
        <issue>4</issue>
        <fpage>976</fpage>
        <lpage>91</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2020.06.038</pub-id>
        <pub-id pub-id-type="pmid">32702314</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rodriques</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Stickels</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Goeva</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Murray</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Vanderburg</surname>
            <given-names>CR</given-names>
          </name>
          <name>
            <surname>Welch</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Macosko</surname>
            <given-names>EZ</given-names>
          </name>
        </person-group>
        <article-title>Slide-seq: a scalable technology for measuring genome-wide expression at high spatial resolution</article-title>
        <source>Science.</source>
        <year>2019</year>
        <volume>363</volume>
        <issue>6434</issue>
        <fpage>1463</fpage>
        <lpage>1467</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aaw1219</pub-id>
        <?supplied-pmid 30923225?>
        <pub-id pub-id-type="pmid">30923225</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stickels</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Murray</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Marshall</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Di Bella</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Arlotta</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Macosko</surname>
            <given-names>EZ</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Highly sensitive spatial transcriptomics at near-cellular resolution with Slide-seqV2</article-title>
        <source>Nat Biotechnol.</source>
        <year>2021</year>
        <volume>39</volume>
        <issue>3</issue>
        <fpage>313</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-020-0739-1</pub-id>
        <pub-id pub-id-type="pmid">33288904</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vickovic</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Eraslan</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Salmen</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Klughammer</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Stenbeck</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Schapiro</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>High-definition spatial transcriptomics for in situ tissue profiling</article-title>
        <source>Nat Methods.</source>
        <year>2019</year>
        <volume>16</volume>
        <issue>10</issue>
        <fpage>987</fpage>
        <lpage>990</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0548-y</pub-id>
        <?supplied-pmid 31501547?>
        <pub-id pub-id-type="pmid">31501547</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ruzzo</surname>
            <given-names>WL</given-names>
          </name>
        </person-group>
        <article-title>Spatial modeling of prostate cancer metabolic gene expression reveals extensive heterogeneity and selective vulnerabilities</article-title>
        <source>Sci Rep.</source>
        <year>2020</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="doi">10.1038/s41598-019-56847-4</pub-id>
        <pub-id pub-id-type="pmid">31913322</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Maynard KR, Collado-Torres L, Weber LM, Uytingco C, Barry BK, Williams SR, Catallini JL, Tran MN, Besich Z, Tippani M, Chew J. Transcriptome-scale spatial gene expression in the human dorsolateral prefrontal cortex. Nat Neurosci. 2021;24(3):425–36.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dries</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Dong</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Eng</surname>
            <given-names>C-HL</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Giotto: a toolbox for integrative analysis and visualization of spatial expression data</article-title>
        <source>Genome Biol</source>
        <year>2021</year>
        <volume>22</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>31</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-021-02286-2</pub-id>
        <pub-id pub-id-type="pmid">33397451</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Accurate and scalable construction of polygenic scores in large biobank data sets</article-title>
        <source>Am J Hum Genet.</source>
        <year>2020</year>
        <volume>106</volume>
        <issue>5</issue>
        <fpage>679</fpage>
        <lpage>93</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ajhg.2020.03.013</pub-id>
        <pub-id pub-id-type="pmid">32330416</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <mixed-citation publication-type="other">BinTayyash N, Georgaka S, John S, Ahmed S, Boukouvalas A, Hensman J, et al. Non-parametric modelling of temporal and spatial counts data from RNA-seq experiments. Preprint at bioRxiv. 2020. 10.1101/2020.07.29.227207.</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <collab>BD VWR</collab>
        </person-group>
        <source>Modern applied statistics with S</source>
        <year>2002</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lea</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Tung</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>A flexible, efficient binomial mixed model for identifying differential DNA methylation in bisulfite sequencing data</article-title>
        <source>PLoS Genet</source>
        <year>2015</year>
        <volume>11</volume>
        <issue>11</issue>
        <fpage>e1005650</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1005650</pub-id>
        <?supplied-pmid 26599596?>
        <pub-id pub-id-type="pmid">26599596</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sun</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hood</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Scott</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Mukherjee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tung</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Differential expression analysis for RNAseq using Poisson mixed models</article-title>
        <source>Nucleic Acids Res</source>
        <year>2017</year>
        <volume>45</volume>
        <issue>11</issue>
        <fpage>e106</fpage>
        <lpage>e10e</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkx204</pub-id>
        <pub-id pub-id-type="pmid">28369632</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Gretton A, Fukumizu K, Teo CH, Song L, Schölkopf B, Smola AJ. A kernel statistical test of independence. In Nips, Vol. 20; 2007 Jan 1. p. 585–92.</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Szekely</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Rizzo</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Bakirov</surname>
            <given-names>NK</given-names>
          </name>
        </person-group>
        <article-title>Measuring and testing dependence by correlation of distances</article-title>
        <source>Ann Statist.</source>
        <year>2007</year>
        <volume>35</volume>
        <issue>6</issue>
        <fpage>2769</fpage>
        <lpage>2794</lpage>
        <pub-id pub-id-type="doi">10.1214/009053607000000505</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kosorok</surname>
            <given-names>MR</given-names>
          </name>
        </person-group>
        <article-title>On Brownian distance covariance and high dimensional data</article-title>
        <source>Ann Appl Stat.</source>
        <year>2009</year>
        <volume>3</volume>
        <issue>4</issue>
        <fpage>1266</fpage>
        <lpage>1269</lpage>
        <pub-id pub-id-type="doi">10.1214/09-AOAS312</pub-id>
        <?supplied-pmid 20574547?>
        <pub-id pub-id-type="pmid">20574547</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Zhang K, Peters J, Janzing D, Schölkopf B. Kernel-based conditional independence test and application in causal discovery. In: Proceedings of the 27th Conference on Uncertainty in Artificial Intelligence; 2011. p. 804–13. </mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Warton</surname>
            <given-names>DI</given-names>
          </name>
        </person-group>
        <article-title>Why you cannot transform your way out of trouble for small counts</article-title>
        <source>Biometrics.</source>
        <year>2018</year>
        <volume>74</volume>
        <issue>1</issue>
        <fpage>362</fpage>
        <lpage>368</lpage>
        <pub-id pub-id-type="doi">10.1111/biom.12728</pub-id>
        <?supplied-pmid 28504821?>
        <pub-id pub-id-type="pmid">28504821</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Rouillard AD, Gundersen GW, Fernandez NF, Wang Z, Monteiro CD, McDermott MG, et al. The harmonizome: a collection of processed datasets gathered to serve and mine knowledge about genes and proteins. Database. 2016;2016. 10.1093/database/baw100.</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">Wizeman JW, Guo Q, Wilion EM, Li JY. Specification of diverse cell types during early neurogenesis of the mouse cerebellum. Elife. 2019;8. 10.7554/eLife.42388.</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Potter</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Kern</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Fullbright</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Bielawski</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Scherer</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Yum</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Venkata</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Akbar Ali Khan</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Rohrer</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Hama</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Central nervous system dysfunction in a mouse model of FA2H deficiency</article-title>
        <source>Glia.</source>
        <year>2011</year>
        <volume>59</volume>
        <issue>7</issue>
        <fpage>1009</fpage>
        <lpage>1021</lpage>
        <pub-id pub-id-type="doi">10.1002/glia.21172</pub-id>
        <?supplied-pmid 21491498?>
        <pub-id pub-id-type="pmid">21491498</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hirai</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Pang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Bao</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Miyazaki</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Miura</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Parris</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rong</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Watanabe</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yuzaki</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Morgan</surname>
            <given-names>JI</given-names>
          </name>
        </person-group>
        <article-title>Cbln1 is essential for synaptic integrity and plasticity in the cerebellum</article-title>
        <source>Nat Neurosci</source>
        <year>2005</year>
        <volume>8</volume>
        <issue>11</issue>
        <fpage>1534</fpage>
        <lpage>1541</lpage>
        <pub-id pub-id-type="doi">10.1038/nn1576</pub-id>
        <?supplied-pmid 16234806?>
        <pub-id pub-id-type="pmid">16234806</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ito-Ishida</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Miura</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Emi</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Matsuda</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Iijima</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kondo</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kohda</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Watanabe</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yuzaki</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Cbln1 regulates rapid formation and maintenance of excitatory synapses in mature cerebellar Purkinje cells in vitro and in vivo</article-title>
        <source>J Neurosci</source>
        <year>2008</year>
        <volume>28</volume>
        <issue>23</issue>
        <fpage>5920</fpage>
        <lpage>5930</lpage>
        <pub-id pub-id-type="doi">10.1523/JNEUROSCI.1030-08.2008</pub-id>
        <?supplied-pmid 18524896?>
        <pub-id pub-id-type="pmid">18524896</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hurlock</surname>
            <given-names>EC</given-names>
          </name>
          <name>
            <surname>Bose</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pierce</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Joho</surname>
            <given-names>RH</given-names>
          </name>
        </person-group>
        <article-title>Rescue of motor coordination by Purkinje cell-targeted restoration of Kv3. 3 channels in Kcnc3-null mice requires Kcnc1</article-title>
        <source>J Neurosci</source>
        <year>2009</year>
        <volume>29</volume>
        <issue>50</issue>
        <fpage>15735</fpage>
        <lpage>15744</lpage>
        <pub-id pub-id-type="doi">10.1523/JNEUROSCI.4048-09.2009</pub-id>
        <?supplied-pmid 20016089?>
        <pub-id pub-id-type="pmid">20016089</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hurlock</surname>
            <given-names>EC</given-names>
          </name>
          <name>
            <surname>McMahon</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Joho</surname>
            <given-names>RH</given-names>
          </name>
        </person-group>
        <article-title>Purkinje-cell-restricted restoration of Kv3. 3 function restores complex spikes and rescues motor coordination in Kcnc3 mutants</article-title>
        <source>J Neurosci</source>
        <year>2008</year>
        <volume>28</volume>
        <issue>18</issue>
        <fpage>4640</fpage>
        <lpage>4648</lpage>
        <pub-id pub-id-type="doi">10.1523/JNEUROSCI.5486-07.2008</pub-id>
        <?supplied-pmid 18448641?>
        <pub-id pub-id-type="pmid">18448641</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <mixed-citation publication-type="other">Cable DM, Murray E, Zou LS, Goeva A, Macosko EZ, Chen F, Irizarry RA. Robust decomposition of cell type mixtures in spatial transcriptomics. Nat Biotechnol. 2021:1–10.</mixed-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lim</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Kwon</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Moon</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jeong</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>BC</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Ryu</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>DY</given-names>
          </name>
          <name>
            <surname>Chung</surname>
            <given-names>BH</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Myung</surname>
            <given-names>PK</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>JR</given-names>
          </name>
        </person-group>
        <article-title>Synapse formation regulated by protein tyrosine phosphatase receptor T through interaction with cell adhesion molecules and Fyn</article-title>
        <source>EMBO J</source>
        <year>2009</year>
        <volume>28</volume>
        <issue>22</issue>
        <fpage>3564</fpage>
        <lpage>3578</lpage>
        <pub-id pub-id-type="doi">10.1038/emboj.2009.289</pub-id>
        <?supplied-pmid 19816407?>
        <pub-id pub-id-type="pmid">19816407</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Consalez</surname>
            <given-names>GG</given-names>
          </name>
          <name>
            <surname>Hawkes</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>The compartmental restriction of cerebellar interneurons</article-title>
        <source>Front Neural Circuits</source>
        <year>2013</year>
        <volume>6</volume>
        <fpage>123</fpage>
        <pub-id pub-id-type="doi">10.3389/fncir.2012.00123</pub-id>
        <pub-id pub-id-type="pmid">23346049</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Besco</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Popesco</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Davuluri</surname>
            <given-names>RV</given-names>
          </name>
          <name>
            <surname>Frostholm</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rotter</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Genomic structure and alternative splicing of murine R2B receptor protein tyrosine phosphatases (PTPκ, μ, ρ and PCP-2)</article-title>
        <source>BMC Genomics.</source>
        <year>2004</year>
        <volume>5</volume>
        <issue>1</issue>
        <fpage>14</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-5-14</pub-id>
        <?supplied-pmid 15040814?>
        <pub-id pub-id-type="pmid">15040814</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <mixed-citation publication-type="other">Lackey EP, Heck DH, Sillitoe RV. Recent advances in understanding the mechanisms of cerebellar granule cell development and function and their contribution to behavior. F1000Research. 2018;7:1142.</mixed-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tsutsumi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hidaka</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Isomura</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Matsuzaki</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sakimura</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kano</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kitamura</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Modular organization of cerebellar climbing fiber inputs during goal-directed behavior</article-title>
        <source>Elife.</source>
        <year>2019</year>
        <volume>8</volume>
        <fpage>e47021</fpage>
        <pub-id pub-id-type="doi">10.7554/eLife.47021</pub-id>
        <?supplied-pmid 31596238?>
        <pub-id pub-id-type="pmid">31596238</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sugihara</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Shinoda</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Molecular, topographic, and functional organization of the cerebellar cortex: a study with combined aldolase C and olivocerebellar labeling</article-title>
        <source>J Neurosci</source>
        <year>2004</year>
        <volume>24</volume>
        <issue>40</issue>
        <fpage>8771</fpage>
        <lpage>8785</lpage>
        <pub-id pub-id-type="doi">10.1523/JNEUROSCI.1961-04.2004</pub-id>
        <?supplied-pmid 15470143?>
        <pub-id pub-id-type="pmid">15470143</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cerminara</surname>
            <given-names>NL</given-names>
          </name>
          <name>
            <surname>Lang</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Sillitoe</surname>
            <given-names>RV</given-names>
          </name>
          <name>
            <surname>Apps</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Redefining the cerebellar cortex as an assembly of non-uniform Purkinje cell microcircuits</article-title>
        <source>Nat Rev Neurosci</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>2</issue>
        <fpage>79</fpage>
        <lpage>93</lpage>
        <pub-id pub-id-type="doi">10.1038/nrn3886</pub-id>
        <?supplied-pmid 25601779?>
        <pub-id pub-id-type="pmid">25601779</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tsutsumi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yamazaki</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Miyazaki</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Watanabe</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sakimura</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kano</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kitamura</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Structure–function relationships between aldolase C/zebrin II expression and complex spike synchrony in the cerebellum</article-title>
        <source>J Neurosci</source>
        <year>2015</year>
        <volume>35</volume>
        <issue>2</issue>
        <fpage>843</fpage>
        <lpage>852</lpage>
        <pub-id pub-id-type="doi">10.1523/JNEUROSCI.2170-14.2015</pub-id>
        <?supplied-pmid 25589776?>
        <pub-id pub-id-type="pmid">25589776</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lein</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Hawrylycz</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Ao</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Ayres</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bensinger</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bernard</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Boe</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Boguski</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Brockway</surname>
            <given-names>KS</given-names>
          </name>
          <name>
            <surname>Byrnes</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Chi Chin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Chong</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Crook</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Czaplinska</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Dang</surname>
            <given-names>CN</given-names>
          </name>
          <name>
            <surname>Datta</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dee</surname>
            <given-names>NR</given-names>
          </name>
          <name>
            <surname>Desaki</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Desta</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Diep</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Dolbeare</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Donelan</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Dong</surname>
            <given-names>HW</given-names>
          </name>
          <name>
            <surname>Dougherty</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Duncan</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Ebbert</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Eichele</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Estin</surname>
            <given-names>LK</given-names>
          </name>
          <name>
            <surname>Faber</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Facer</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Fields</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Fischer</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Fliss</surname>
            <given-names>TP</given-names>
          </name>
          <name>
            <surname>Frensley</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gates</surname>
            <given-names>SN</given-names>
          </name>
          <name>
            <surname>Glattfelder</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Halverson</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Hart</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Hohmann</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Howell</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Jeung</surname>
            <given-names>DP</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Karr</surname>
            <given-names>PT</given-names>
          </name>
          <name>
            <surname>Kawal</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kidney</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Knapik</surname>
            <given-names>RH</given-names>
          </name>
          <name>
            <surname>Kuan</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Lake</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Laramee</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Larsen</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Lau</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lemon</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Luong</surname>
            <given-names>LT</given-names>
          </name>
          <name>
            <surname>Michaels</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Morgan</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Morgan</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Mortrud</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Mosqueda</surname>
            <given-names>NF</given-names>
          </name>
          <name>
            <surname>Ng</surname>
            <given-names>LL</given-names>
          </name>
          <name>
            <surname>Ng</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Orta</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Overly</surname>
            <given-names>CC</given-names>
          </name>
          <name>
            <surname>Pak</surname>
            <given-names>TH</given-names>
          </name>
          <name>
            <surname>Parry</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Pathak</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Pearson</surname>
            <given-names>OC</given-names>
          </name>
          <name>
            <surname>Puchalski</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Riley</surname>
            <given-names>ZL</given-names>
          </name>
          <name>
            <surname>Rockett</surname>
            <given-names>HR</given-names>
          </name>
          <name>
            <surname>Rowland</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Royall</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Ruiz</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Sarno</surname>
            <given-names>NR</given-names>
          </name>
          <name>
            <surname>Schaffnit</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Shapovalova</surname>
            <given-names>NV</given-names>
          </name>
          <name>
            <surname>Sivisay</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Slaughterbeck</surname>
            <given-names>CR</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>BI</given-names>
          </name>
          <name>
            <surname>Sodt</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Stewart</surname>
            <given-names>NN</given-names>
          </name>
          <name>
            <surname>Stumpf</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Sunkin</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Sutram</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tam</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Teemer</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Thaller</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Varnam</surname>
            <given-names>LR</given-names>
          </name>
          <name>
            <surname>Visel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Whitlock</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Wohnoutka</surname>
            <given-names>PE</given-names>
          </name>
          <name>
            <surname>Wolkey</surname>
            <given-names>CK</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>VY</given-names>
          </name>
          <name>
            <surname>Wood</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yaylaoglu</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Youngstrom</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Feng Yuan</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Zwingman</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>AR</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide atlas of gene expression in the adult mouse brain</article-title>
        <source>Nature.</source>
        <year>2007</year>
        <volume>445</volume>
        <issue>7124</issue>
        <fpage>168</fpage>
        <lpage>176</lpage>
        <pub-id pub-id-type="doi">10.1038/nature05453</pub-id>
        <?supplied-pmid 17151600?>
        <pub-id pub-id-type="pmid">17151600</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schwenk</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Metz</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zolles</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Turecek</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Fritzius</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Bildl</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Tarusawa</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Kulik</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Unger</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ivankova</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Seddik</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Tiao</surname>
            <given-names>JY</given-names>
          </name>
          <name>
            <surname>Rajalu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Trojanova</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rohde</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Gassmann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schulte</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Fakler</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Bettler</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Native GABA B receptors are heteromultimers with a family of auxiliary subunits</article-title>
        <source>Nature.</source>
        <year>2010</year>
        <volume>465</volume>
        <issue>7295</issue>
        <fpage>231</fpage>
        <lpage>235</lpage>
        <pub-id pub-id-type="doi">10.1038/nature08964</pub-id>
        <?supplied-pmid 20400944?>
        <pub-id pub-id-type="pmid">20400944</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bonino</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Cantino</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Sassoè-Pognetto</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Cellular and subcellular localization of γ-aminobutyric acidB receptors in the rat olfactory bulb</article-title>
        <source>Neurosci Lett</source>
        <year>1999</year>
        <volume>274</volume>
        <issue>3</issue>
        <fpage>195</fpage>
        <lpage>198</lpage>
        <pub-id pub-id-type="doi">10.1016/S0304-3940(99)00697-7</pub-id>
        <?supplied-pmid 10548423?>
        <pub-id pub-id-type="pmid">10548423</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Margrie</surname>
            <given-names>TW</given-names>
          </name>
          <name>
            <surname>Sakmann</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Urban</surname>
            <given-names>NN</given-names>
          </name>
        </person-group>
        <article-title>Action potential propagation in mitral cell lateral dendrites is decremental and controls recurrent and lateral inhibition in the mammalian olfactory bulb</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2001</year>
        <volume>98</volume>
        <issue>1</issue>
        <fpage>319</fpage>
        <lpage>324</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.98.1.319</pub-id>
        <?supplied-pmid 11120888?>
        <pub-id pub-id-type="pmid">11120888</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nunes</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Kuner</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Disinhibition of olfactory bulb granule cells accelerates odour discrimination in mice</article-title>
        <source>Nat Commun</source>
        <year>2015</year>
        <volume>6</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>13</lpage>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <mixed-citation publication-type="other">Geramita MA, Burton SD, Urban NN. Distinct lateral inhibitory circuits drive parallel processing of sensory information in the mammalian olfactory bulb. Elife. 2016;5. 10.7554/eLife.16039.</mixed-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Isaacson</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Strowbridge</surname>
            <given-names>BW</given-names>
          </name>
        </person-group>
        <article-title>Olfactory reciprocal synapses: dendritic signaling in the CNS</article-title>
        <source>Neuron.</source>
        <year>1998</year>
        <volume>20</volume>
        <issue>4</issue>
        <fpage>749</fpage>
        <lpage>761</lpage>
        <pub-id pub-id-type="doi">10.1016/S0896-6273(00)81013-2</pub-id>
        <?supplied-pmid 9581766?>
        <pub-id pub-id-type="pmid">9581766</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hamilton</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Heinbockel</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ennis</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Szabo</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Erdelyi</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Hayar</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Properties of external plexiform layer interneurons in mouse olfactory bulb slices</article-title>
        <source>Neuroscience.</source>
        <year>2005</year>
        <volume>133</volume>
        <issue>3</issue>
        <fpage>819</fpage>
        <lpage>829</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroscience.2005.03.008</pub-id>
        <?supplied-pmid 15896912?>
        <pub-id pub-id-type="pmid">15896912</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tepe</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Pekarek</surname>
            <given-names>BT</given-names>
          </name>
          <name>
            <surname>Hunt</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>JF</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-seq of mouse olfactory bulb reveals cellular heterogeneity and activity-dependent molecular census of adult-born neurons</article-title>
        <source>Cell Rep</source>
        <year>2018</year>
        <volume>25</volume>
        <issue>10</issue>
        <fpage>2689</fpage>
        <lpage>703.e3</lpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2018.11.034</pub-id>
        <pub-id pub-id-type="pmid">30517858</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Verploegen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lammers</surname>
            <given-names>J-WJ</given-names>
          </name>
          <name>
            <surname>Koenderman</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Coffer</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>Identification and characterization of CKLiK, a novel granulocyte Ca++/calmodulin-dependent kinase</article-title>
        <source>Blood J Am Soc Hematol</source>
        <year>2000</year>
        <volume>96</volume>
        <issue>9</issue>
        <fpage>3215</fpage>
        <lpage>3223</lpage>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>An</surname>
            <given-names>WF</given-names>
          </name>
          <name>
            <surname>Bowlby</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Betty</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Cao</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ling</surname>
            <given-names>H-P</given-names>
          </name>
          <name>
            <surname>Mendoza</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Hinson</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Mattsson</surname>
            <given-names>KI</given-names>
          </name>
          <name>
            <surname>Strassle</surname>
            <given-names>BW</given-names>
          </name>
          <name>
            <surname>Trimmer</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Rhodes</surname>
            <given-names>KJ</given-names>
          </name>
        </person-group>
        <article-title>Modulation of A-type potassium channels by a family of calcium sensors</article-title>
        <source>Nature.</source>
        <year>2000</year>
        <volume>403</volume>
        <issue>6769</issue>
        <fpage>553</fpage>
        <lpage>556</lpage>
        <pub-id pub-id-type="doi">10.1038/35000592</pub-id>
        <?supplied-pmid 10676964?>
        <pub-id pub-id-type="pmid">10676964</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maniatis</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Äijö</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Vickovic</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Braine</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Mollbrink</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fagegaltier</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Andrusivová</surname>
            <given-names>Ž</given-names>
          </name>
          <name>
            <surname>Saarenpää</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Saiz-Castro</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Cuevas</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Watters</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lundeberg</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bonneau</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Phatnani</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Spatiotemporal dynamics of molecular pathology in amyotrophic lateral sclerosis</article-title>
        <source>Science.</source>
        <year>2019</year>
        <volume>364</volume>
        <issue>6435</issue>
        <fpage>89</fpage>
        <lpage>93</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aav9776</pub-id>
        <?supplied-pmid 30948552?>
        <pub-id pub-id-type="pmid">30948552</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>H-T</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>C-J</given-names>
          </name>
        </person-group>
        <article-title>A study on sigmoid kernels for SVM and the training of non-PSD kernels by SMO-type methods</article-title>
        <source>Submitted Neural Comput</source>
        <year>2003</year>
        <volume>3</volume>
        <issue>1-32</issue>
        <fpage>16</fpage>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Heckman</surname>
            <given-names>NE</given-names>
          </name>
          <name>
            <surname>Wand</surname>
            <given-names>MP</given-names>
          </name>
        </person-group>
        <article-title>Local polynomial kernel regression for generalized linear models and quasi-likelihood functions</article-title>
        <source>J Am Stat Assoc</source>
        <year>1995</year>
        <volume>90</volume>
        <issue>429</issue>
        <fpage>141</fpage>
        <lpage>150</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.1995.10476496</pub-id>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Antoniadis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Paparoditis</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Sapatinas</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>A functional wavelet–kernel approach for time series prediction</article-title>
        <source>J R Stat Soc Series B (Statistical Methodology).</source>
        <year>2006</year>
        <volume>68</volume>
        <issue>5</issue>
        <fpage>837</fpage>
        <lpage>857</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1467-9868.2006.00569.x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <mixed-citation publication-type="other">Barla A, Odone F, Verri A. Histogram intersection kernel for image classification. In: Proceedings 2003 international conference on image processing (Cat. No. 03CH37429), Vol. 3. IEEE; 2003 Sep 14. p. III-513.</mixed-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <mixed-citation publication-type="other">Wu J, Rehg JM. Beyond the euclidean distance: Creating effective visual codebooks using the histogram intersection kernel. In: 2009 IEEE 12th International Conference on Computer Vision. IEEE; 2009 Sep 29. p. 630–7.</mixed-citation>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <mixed-citation publication-type="other">Boughorbel S, Tarel JP, Boujemaa N. Generalized histogram intersection kernel for image recognition. In: IEEE International Conference on Image Processing 2005, Vol. 3. IEEE; 2005 Sep 14. p. III-161.</mixed-citation>
    </ref>
    <ref id="CR63">
      <label>63.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Genton</surname>
            <given-names>MG</given-names>
          </name>
        </person-group>
        <article-title>Classes of kernels for machine learning: a statistics perspective</article-title>
        <source>J Mach Learn Res</source>
        <year>2001</year>
        <volume>2</volume>
        <issue>Dec</issue>
        <fpage>299</fpage>
        <lpage>312</lpage>
      </element-citation>
    </ref>
    <ref id="CR64">
      <label>64.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vishwanathan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Smola</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>Fast kernels for string and tree matching</article-title>
        <source>Kernel Methods Comput Biol</source>
        <year>2004</year>
        <volume>15</volume>
        <fpage>113</fpage>
        <lpage>130</lpage>
      </element-citation>
    </ref>
    <ref id="CR65">
      <label>65.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="editor">
          <name>
            <surname>Sahami</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Heilman</surname>
            <given-names>TD</given-names>
          </name>
        </person-group>
        <source>A web-based kernel function for measuring the similarity of short text snippets. Proceedings of the 15th international conference on World Wide Web</source>
        <year>2006</year>
      </element-citation>
    </ref>
    <ref id="CR66">
      <label>66.</label>
      <mixed-citation publication-type="other">Srebro N. How good is a kernel when used as a similarity measure?. In: International Conference on Computational Learning Theory. Berlin, Heidelberg: Springer; 2007 Jun 13. p. 323–35.</mixed-citation>
    </ref>
    <ref id="CR67">
      <label>67.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Broadaway</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Cutler</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Duncan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Moore</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Ware</surname>
            <given-names>EB</given-names>
          </name>
          <name>
            <surname>Jhun</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Bielak</surname>
            <given-names>LF</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Peyser</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Kardia</surname>
            <given-names>SLR</given-names>
          </name>
          <name>
            <surname>Ghosh</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Epstein</surname>
            <given-names>MP</given-names>
          </name>
        </person-group>
        <article-title>A statistical approach for testing cross-phenotype effects of rare variants</article-title>
        <source>Am J Hum Genet</source>
        <year>2016</year>
        <volume>98</volume>
        <issue>3</issue>
        <fpage>525</fpage>
        <lpage>540</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ajhg.2016.01.017</pub-id>
        <?supplied-pmid 26942286?>
        <pub-id pub-id-type="pmid">26942286</pub-id>
      </element-citation>
    </ref>
    <ref id="CR68">
      <label>68.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wessel</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Schork</surname>
            <given-names>NJ</given-names>
          </name>
        </person-group>
        <article-title>Generalized genomic distance–based regression methodology for multilocus association analysis</article-title>
        <source>Am J Hum Genet</source>
        <year>2006</year>
        <volume>79</volume>
        <issue>5</issue>
        <fpage>792</fpage>
        <lpage>806</lpage>
        <pub-id pub-id-type="doi">10.1086/508346</pub-id>
        <?supplied-pmid 17033957?>
        <pub-id pub-id-type="pmid">17033957</pub-id>
      </element-citation>
    </ref>
    <ref id="CR69">
      <label>69.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhan</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Plantinga</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <article-title>A fast small-sample kernel independence test for microbiome community-level association analysis</article-title>
        <source>Biometrics.</source>
        <year>2017</year>
        <volume>73</volume>
        <issue>4</issue>
        <fpage>1453</fpage>
        <lpage>1463</lpage>
        <pub-id pub-id-type="doi">10.1111/biom.12684</pub-id>
        <?supplied-pmid 28295177?>
        <pub-id pub-id-type="pmid">28295177</pub-id>
      </element-citation>
    </ref>
    <ref id="CR70">
      <label>70.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Davies</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Algorithm</surname>
            <given-names>AS</given-names>
          </name>
        </person-group>
        <article-title>155: The distribution of a linear combination of χ&lt;sup&gt;2&lt;/sup&gt; random variables</article-title>
        <source>J R Stat Soc Series C (Applied Statistics).</source>
        <year>1980</year>
        <volume>29</volume>
        <issue>3</issue>
        <fpage>323</fpage>
        <lpage>333</lpage>
      </element-citation>
    </ref>
    <ref id="CR71">
      <label>71.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Horn</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>CR</given-names>
          </name>
        </person-group>
        <source>Matrix analysis: Cambridge university press</source>
        <year>2012</year>
      </element-citation>
    </ref>
    <ref id="CR72">
      <label>72.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Morrison</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Boerwinkle</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>ACAT: a fast and powerful p value combination method for rare-variant analysis in sequencing studies</article-title>
        <source>Am J Hum Genet.</source>
        <year>2019</year>
        <volume>104</volume>
        <issue>3</issue>
        <fpage>410</fpage>
        <lpage>421</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ajhg.2019.01.002</pub-id>
        <?supplied-pmid 30849328?>
        <pub-id pub-id-type="pmid">30849328</pub-id>
      </element-citation>
    </ref>
    <ref id="CR73">
      <label>73.</label>
      <mixed-citation publication-type="other">Pillai NS, Meng X-L. An unexpected encounter with Cauchy and Lévy. Ann Stat. 2016;44(5):2089–97. </mixed-citation>
    </ref>
    <ref id="CR74">
      <label>74.</label>
      <mixed-citation publication-type="other">Kozareva V, Martin C, Osorno T, Rudolph, S, Guo C, Vanderburg C, Nadaf, N.M., Regev A, Regehr W, Macosko E. A transcriptomic atlas of the mouse cerebellum reveals regional specializations and novel cell types. Preprint at bioRxiv. 2020. 10.1101/2020.03.04.976407.</mixed-citation>
    </ref>
    <ref id="CR75">
      <label>75.</label>
      <mixed-citation publication-type="other">Wang X, Allen WE, Wright MA, Sylwestrak EL, Samusik N, Vesuna S, et al. Three-dimensional intact-tissue sequencing of single-cell transcriptional states. Science. 2018;361(6400):eaat5691</mixed-citation>
    </ref>
    <ref id="CR76">
      <label>76.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>LG</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>QY</given-names>
          </name>
        </person-group>
        <article-title>clusterProfiler: an R package for comparing biological themes among gene clusters</article-title>
        <source>OMICS.</source>
        <year>2012</year>
        <volume>16</volume>
        <issue>5</issue>
        <fpage>284</fpage>
        <lpage>287</lpage>
        <pub-id pub-id-type="doi">10.1089/omi.2011.0118</pub-id>
        <?supplied-pmid 22455463?>
        <pub-id pub-id-type="pmid">22455463</pub-id>
      </element-citation>
    </ref>
    <ref id="CR77">
      <label>77.</label>
      <mixed-citation publication-type="other">Zhu J, Sun S, Zhou X. SPARK: spatial pattern recognition via kernels. Github. 2021; <ext-link ext-link-type="uri" xlink:href="https://github.com/xzhoulab/SPARK">https://github.com/xzhoulab/SPARK</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR78">
      <label>78.</label>
      <mixed-citation publication-type="other">Zhu J, Sun S, Zhou X. SPARK-X: non-parametric modeling enables scalable and robust detection of spatial expression patterns for large spatial transcriptomic studies. Zenodo. 2021. 10.5281/zenodo.4903349.</mixed-citation>
    </ref>
  </ref-list>
</back>
