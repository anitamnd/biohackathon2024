<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Genomics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Genomics</journal-id>
    <journal-title-group>
      <journal-title>BMC Genomics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2164</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9710181</article-id>
    <article-id pub-id-type="publisher-id">9021</article-id>
    <article-id pub-id-type="doi">10.1186/s12864-022-09021-6</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Beta-PSMC: uncovering more detailed population history using beta distribution</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Liu</surname>
          <given-names>Junfeng</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ji</surname>
          <given-names>Xianchao</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9829-6561</contrib-id>
        <name>
          <surname>Chen</surname>
          <given-names>Hua</given-names>
        </name>
        <address>
          <email>chenh@big.ac.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.464209.d</institution-id><institution-id institution-id-type="ISNI">0000 0004 0644 6935</institution-id><institution>CAS Key Laboratory of Genomic and Precision Medicine, </institution><institution>Beijing Institute of Genomics, Chinese Academy of Sciences, </institution></institution-wrap>Beijing, 100101 China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.464209.d</institution-id><institution-id institution-id-type="ISNI">0000 0004 0644 6935</institution-id><institution>China National Center for Bioinformation, </institution></institution-wrap>Beijing, 100101 China </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.410726.6</institution-id><institution-id institution-id-type="ISNI">0000 0004 1797 8419</institution-id><institution>School of Future Technology, </institution><institution>University of Chinese Academy of Sciences, </institution></institution-wrap>Beijing, 100049 China </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.9227.e</institution-id><institution-id institution-id-type="ISNI">0000000119573309</institution-id><institution>CAS Center for Excellence in Animal Evolution and Genetics, </institution><institution>Chinese Academy of Sciences, </institution></institution-wrap>Kunming, 650223 China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>30</day>
      <month>11</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>30</day>
      <month>11</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>23</volume>
    <elocation-id>785</elocation-id>
    <history>
      <date date-type="received">
        <day>4</day>
        <month>2</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>16</day>
        <month>11</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Inferring the demographic history of a population is essential in population genetic studies. Though the inference methods based on the sequentially Markov coalescent can present the population history in detail, these methods assume that the population size remains unchanged in each time interval during discretizing the hidden state in the hidden Markov model. Therefore, these methods fail to uncover the detailed population history in each time interval.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We present a new method called Beta-PSMC, which introduces the probability density function of a beta distribution with a broad variety of shapes into the Pairwise Sequentially Markovian Coalescent (PSMC) model to refine the population history in each discretized time interval in place of the assumption that the population size is unchanged. Using simulation, we demonstrate that Beta-PSMC can uncover more detailed population history, and improve the accuracy and resolution of the recent population history inference. We also apply Beta-PSMC to infer the population history of Adélie penguin and find that the fluctuation in population size is contrary to the temperature change 15–27 thousand years ago.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">Beta-PSMC extends PSMC by allowing more detailed fluctuation of population size in each discretized time interval with the probability density function of beta distribution and will serve as a useful tool for population genetics.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12864-022-09021-6.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Demography inference</kwd>
      <kwd>Beta distribution</kwd>
      <kwd>Sequentially Markov coalescent</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>the National Key R&amp;D Program of China</institution>
        </funding-source>
        <award-id>2018YFC1406902</award-id>
        <principal-award-recipient>
          <name>
            <surname>Chen</surname>
            <given-names>Hua</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>the National Natural Science Foundation of China</institution>
        </funding-source>
        <award-id>31571370</award-id>
        <award-id>91731302</award-id>
        <principal-award-recipient>
          <name>
            <surname>Chen</surname>
            <given-names>Hua</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par7">Population history and demographic inference is a fundamental question in population genetic studies [<xref ref-type="bibr" rid="CR1">1</xref>]. Over the past few years, many methods have been developed to infer population history with genome-scale data. Some approaches are based on allele frequency spectrum (aka, site frequency spectrum (SFS)) [<xref ref-type="bibr" rid="CR2">2</xref>–<xref ref-type="bibr" rid="CR6">6</xref>], which use diffusion process and coalescent process to construct SFS under various population history. The methods on the framework of diffusion process need a predefined simplified population model to infer population history, which are not suitable for the estimation of demography under very complex scenarios. Although model-flexible, the existing methods on the framework of coalescent process assume that the population size remains constant during the coalescent time [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR6">6</xref>]. The other approaches are based on sequential Markov coalescent (SMC) [<xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR10">10</xref>], which spatially model recombination and coalescent events, to reveal more detailed population history using some form of hidden Markov model (HMM). Since the states of latent variables in the HMM-SMC methods are coalescence times which are continuous and infinite, HMM-SMC methods discretize them by dividing coalescence-times into a finite number of time intervals and assume that the function <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uplambda \left(t\right)$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi mathvariant="normal">λ</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12864_2022_9021_Article_IEq1.gif"/></alternatives></inline-formula>, which is scaled to population size, is a constant in each time interval. The assumption is a simplified approximation, and the model can describe the complex population history accurately when the time intervals are sufficiently small. Increasing the number of time intervals and discretization points dramatically increases the computational burden and running time, and makes the computation intractable [<xref ref-type="bibr" rid="CR11">11</xref>].</p>
    <p id="Par8">Here, we present a new method, Beta-PSMC, that extends PSMC by replacing the function <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uplambda \left(t\right)$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi mathvariant="normal">λ</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12864_2022_9021_Article_IEq2.gif"/></alternatives></inline-formula> within each time interval with the probability density function of beta distribution, which has two positive shape parameters denoted by <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M6"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12864_2022_9021_Article_IEq3.gif"/></alternatives></inline-formula> and <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M8"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12864_2022_9021_Article_IEq4.gif"/></alternatives></inline-formula>. Beta-PSMC can model a wide variety of changes of population size in each discretized time interval, as the beta distribution has flexible shapes, including <italic>J</italic>-shape, reverse <italic>J</italic>-shape, <italic>U</italic>-shape and reverse <italic>U</italic>-shape. Furthermore, a constant is a specific case of the function <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uplambda \left(t\right)$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi mathvariant="normal">λ</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12864_2022_9021_Article_IEq5.gif"/></alternatives></inline-formula> in Beta-PSMC when setting <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha =\beta =1$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12864_2022_9021_Article_IEq6.gif"/></alternatives></inline-formula>. Therefore, Beta-PSMC can elucidate fine population history by further providing unprecedented details within each discretized time interval.</p>
    <p id="Par9">To validate the performance of our method, we conducted evaluation on Beta-PSMC using simulated data. We demonstrated that Beta-PSMC can uncover more detailed population size changes compared with PSMC, especially for the recent population history. We also applied Beta-PSMC to the genome of Adélie penguins to infer their population history during the Last Glacial. The results showed that there was negative correlation between the fluctuation of population size and temperature change 15–27 thousand years ago.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <p id="Par10">WE validated Beta-PSMC and compared it with PSMC with simulated data from a population history comprised of multiple epochs of population growths and declines (details in the Supplementary Materials). In order to scale results to real time, we assumed 25 years per generation and a mutation rate of 2.5 × 10<sup>–8</sup> per generation per nucleotide [<xref ref-type="bibr" rid="CR7">7</xref>]. The results in Fig. <xref rid="Fig1" ref-type="fig">1</xref>A showed that Beta-PSMC can recover the zigzag varying pattern of population size with a good resolution. Moreover, Beta-PSMC demonstrates better performance than PSMC in inferring recent population history (Fig. <xref rid="Fig1" ref-type="fig">1</xref>A-D). We also tried to improve the estimates of PSMC by refining discretization. Although PSMC has significantly better inference of population history from 3 thousand years ago (KYA) to the more distant past (Fig. <xref rid="Fig1" ref-type="fig">1</xref>B-D), the estimates within 2000 years remain poor (Fig. <xref rid="Fig1" ref-type="fig">1</xref>C-D).<fig id="Fig1"><label>Fig. 1</label><caption><p>The inferred history of the simulated data from a population history with a series of population growth and decline. For Beta-PSMC, the number of discretized time intervals is 20 and the number of subintervals of each time interval is 3. <bold>A</bold> The number of discretized time intervals for PSMC is 64. <bold>B</bold> The number of discretized time intervals for PSMC is 104. <bold>C</bold> The number of discretized time intervals for PSMC is 154. <bold>D</bold> The number of discretized time intervals for PSMC is 204. <italic>g,</italic> generation time; <italic>μ</italic>, mutation rate</p></caption><graphic xlink:href="12864_2022_9021_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par11">Beta-PSMC subdivides each time interval into <italic>k</italic> subintervals for a given discretization, and employs two more parameters than PSMC. To compare the running time of Beta-PSMC and PSMC, we applied both methods to the same simulated data and repeated 10 times. When the number of time intervals is <italic>n</italic> and the number of subintervals is <italic>k</italic>, the average of running time of Beta-PSMC is close to that of PSMC with <italic>n</italic> × <italic>k</italic> intervals (Supplementary Table S<xref rid="MOESM1" ref-type="media">1</xref>). Although Beta-PSMC with the same <italic>n</italic> is slower than PSMC, Beta-PSMC needs fewer time intervals when inferring population history with good resolution (Fig. <xref rid="Fig1" ref-type="fig">1</xref>).</p>
    <p id="Par12">We applied Beta-PSMC and PSMC to infer the population dynamics of Adélie penguin with the published genome sequence [<xref ref-type="bibr" rid="CR12">12</xref>] (Supplementary Fig. S<xref rid="MOESM1" ref-type="media">1</xref>). The population history of Adélie penguin between 100 and 10 KYA is of specific interest, since the population dynamics of Adélie penguin is hypothesized to be strongly influenced by the Antarctic climatic variation during the last glaciation [<xref ref-type="bibr" rid="CR12">12</xref>]. In contrast with PSMC, Beta-PSMC uncovered more detailed population history in the period of 15–27 KYA; the effective population size of Adélie decreases gradually from about 20 KYA after increasing gradually from 27 KYA. This fluctuation in the period of 15–27 KYA is contrary to the trend of temperature change (Supplementary Fig. S<xref rid="MOESM1" ref-type="media">1</xref>), indicating that the effective population size of Adélie penguin may be strongly affected by Antarctic climate. Hu et al. [<xref ref-type="bibr" rid="CR13">13</xref>] reconstructed the population history of Adélie at Ross Island over the past 700 years by determining organic markers in a sediment profile and found that the population sizes of Adélie penguin were the highest in the Little Ice Age. Their conclusion that the population size of Adélie was the highest during a cold period is consistent with our inferred history during the last glaciation.</p>
  </sec>
  <sec id="Sec3">
    <title>Discussion</title>
    <p id="Par13">Beta-PSMC extends the PSMC method by splitting time intervals into subintervals to achieve higher accuracy in demographic inference, however, running time also increases with the number of subintervals (Supplementary Table S<xref rid="MOESM1" ref-type="media">1</xref>). We analyzed the effect of subinterval numbers using simulated data by running Beta-PSMC with different subinterval numbers: <italic>k</italic> = 2, <italic>k</italic> = 3, <italic>k</italic> = 5, and <italic>k</italic> = 7 respectively. The results showed that the estimates were rough when <italic>k</italic> = 2 (Supplementary Fig. S<xref rid="MOESM1" ref-type="media">2</xref>A) and the similar performance with good resolution could be achieved when <italic>k</italic> = 3, <italic>k</italic> = 5, and <italic>k</italic> = 7 (Supplementary Fig. S<xref rid="MOESM1" ref-type="media">2</xref>B-D). This implies that a smaller subinterval number, e.g., <italic>k</italic> = 3 is sufficient for the accuracy of most demographic scenarios.</p>
    <p id="Par14">Another advantage of Beta-PSMC over PSMC is on the inference of recent demographic history. PSMC provides poor estimates of population sizes for recent history (&lt; 10KYA) due to limited information of recombination and coalescence events during that time range from a single individual genome. The accuracy of estimates even declined with the increase of number of discretized time intervals when inferring the population history with one sharp bottleneck followed by an exponential growth within 10KYA (Supplementary Fig. S<xref rid="MOESM1" ref-type="media">3</xref>A-D). This is due to the fact that refining discretization results in the decline of recombination events in each recent discretized time interval, which further reduces the power of PSMC. In order to increase the power of Beta-PSMC for inferring recent demographic history, we combine the first three discretized time intervals to accumulate more recombination events, and use the shape of the probability density function of beta distribution to allow for population size fluctuation during the time interval. The simulation results indicate that the strategy is valid (Supplementary Fig. S<xref rid="MOESM1" ref-type="media">3</xref>E-F). Compared with PSMC, Beta-PSMC improves the inference accuracy and resolution for the recent population history by using the probability density function of beta distribution. However, the above strategy is not available for the recent population history with one sharp bottleneck followed by an instant growth (Supplementary Fig. S<xref rid="MOESM1" ref-type="media">4</xref>A-B). Although more recombination events are helpful to increase the power of Beta-PSMC for inferring recent demographic history, there exists the instant change of population size in the combined discretized time interval. Regrettably, the shape of the probability density function of beta distribution is continuous and not available for the instant change of population size in the combined discretized time interval (Supplementary Fig. S<xref rid="MOESM1" ref-type="media">4</xref>A). If the instant growth happened more early, the inference accuracy was improved due to the continuous population size in the combined discretized time interval (Supplementary Fig. S<xref rid="MOESM1" ref-type="media">4</xref>B).</p>
    <p id="Par15">It should be emphasized that the probability density function of beta distribution in Beta-PSMC is used to approximate the varying population size in each discretized time interval based on the observed sequences, and is different from another smoothing step for the estimated population sizes from different time intervals. For each discretized time interval, there are five main types of the fluctuation of population size: gradual growth, gradual decline, gradual growth after gradual decline, gradual decline after growth, and no fluctuation. The above five types can be described by the probability density function of beta distribution with two parameters, which has flexible shapes, such as <italic>J</italic>-shape, reverse <italic>J</italic>-shape, <italic>U</italic>-shape, reverse <italic>U</italic>-shape and straight line shape. Although a second-order polynomial can also be used to approximate the five types of the fluctuation of population size, there are three parameters in the second-order polynomial. The other type of spline, such as cubic spline and B-spline, can be used to approximate the more complicated fluctuation of population size, but there are more parameters to be estimated.</p>
    <p id="Par16">Although Beta-PSMC improves the performance of PSMC, it has three disadvantages. The first disadvantage is that Beta-PSMC failed to improve the inference accuracy for the instant change, especially in the recent population history (Supplementary Fig. S<xref rid="MOESM1" ref-type="media">4</xref>A-B). This is because the shape of the probability density function of beta distribution is continuous and not available for the instant change of population size in the given time interval. The second disadvantage is that the curve of population size generated from Beta-PSMC is not smooth at the joint between adjacent time intervals (Supplementary Fig. S<xref rid="MOESM1" ref-type="media">5</xref>A-B). This is due to the singular boundary point of each discretized time interval. In order to smooth the curve of population size, a quadratic curve fitting was used at the joint between adjacent time intervals (Supplementary Fig. S<xref rid="MOESM1" ref-type="media">5</xref>C-D). The last disadvantage is that the choice of some parameters can significantly influence the estimation results. Firstly, the number of subintervals can affect the estimation results (Supplementary Fig. S<xref rid="MOESM1" ref-type="media">2</xref>A-D). According to the simulation results, we advise to choose the number of subintervals of 3. Secondly, the pattern of parameter vectors can also affect the estimation results. In order to improve the estimation, we adopt the strategy as follows: Each discretized time interval is spanned by one parameter vector; If the estimated result is singular in one discretized time interval (Supplementary Fig. S<xref rid="MOESM1" ref-type="media">3</xref>E), the discretized time interval is combined with adjacent discretized time intervals and then spanned by one parameter vector until the estimated result is no longer singular (Supplementary Fig. S<xref rid="MOESM1" ref-type="media">3</xref>F).</p>
  </sec>
  <sec id="Sec4">
    <title>Conclusions</title>
    <p id="Par17">PSMC can infer the demographic history accurately using a single personal genome for a wide time range, serving as a very popular tool in population genetic studies. The Beta-PSMC method presented in this paper extends PSMC by allowing more detailed fluctuation of population size in each discretized time interval with the probability density function of beta distribution. This is especially useful for some scenarios that the population size fluctuates and thus improves the fine-scale inference of complex demographic history during some short time intervals; Furthermore, Beta-PSMC in some degree improves the accuracy and resolution for the recent population history inference. We expect Beta-PSMC to supplement PSMC towards a flexible tool for inferring population history using genomic data.</p>
  </sec>
  <sec id="Sec5">
    <title>Methods</title>
    <sec id="Sec6">
      <title>Beta-PSMC model</title>
      <p id="Par18">Beta-PSMC method is an extension of the widely used PSMC method [<xref ref-type="bibr" rid="CR7">7</xref>]. It is different from PSMC in modeling the scaled population size in each discretized time interval when discretizing coalescence-times. PSMC sets <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0\le {t}_{0}&lt;{t}_{1}&lt;\cdots &lt;{t}_{n}&lt;{t}_{n+1}=\infty$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:mo>⋯</mml:mo><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12864_2022_9021_Article_IEq7.gif"/></alternatives></inline-formula> and assumes the function <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uplambda \left(t\right)$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mi mathvariant="normal">λ</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12864_2022_9021_Article_IEq8.gif"/></alternatives></inline-formula>, which is scaled to population size, is a constant <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\uplambda }_{i}\left(i=0,\cdots ,n\right)$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:msub><mml:mi mathvariant="normal">λ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12864_2022_9021_Article_IEq9.gif"/></alternatives></inline-formula> in each discretized time interval <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left[{t}_{i},\left.{t}_{i+1}\right)\right.$$\end{document}</tex-math><mml:math id="M20"><mml:mfenced open="["><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mfenced close=")"><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mfenced></mml:mfenced></mml:math><inline-graphic xlink:href="12864_2022_9021_Article_IEq10.gif"/></alternatives></inline-formula>. Given a maximum of the most recent common ancestor (TMRCA) <italic>T</italic><sub><italic>max</italic></sub>, PSMC sets the boundaries of discretized time intervals to be <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${t}_{i}=0.1exp\left[{}^{i}\!\left/ \!{}_{n}\right.log\left(1+{T}_{max}\right)\right]-0.1, i=0,\cdots ,n$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mfenced close="]" open="["><mml:msup><mml:mrow/><mml:mi>i</mml:mi></mml:msup><mml:mspace width="-0.166667em"/><mml:mfenced open="/"><mml:mspace width="-0.166667em"/><mml:msub><mml:mrow/><mml:mi>n</mml:mi></mml:msub></mml:mfenced><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">max</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mfenced><mml:mo>-</mml:mo><mml:mn>0.1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12864_2022_9021_Article_IEq11.gif"/></alternatives></inline-formula>. For each discretized time interval <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left[{t}_{i},\left.{t}_{i+1}\right)\right.$$\end{document}</tex-math><mml:math id="M24"><mml:mfenced open="["><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mfenced close=")"><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mfenced></mml:mfenced></mml:math><inline-graphic xlink:href="12864_2022_9021_Article_IEq12.gif"/></alternatives></inline-formula> when <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0\le i&lt;n$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12864_2022_9021_Article_IEq13.gif"/></alternatives></inline-formula>, Beta-PSMC adopts a form of the function <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uplambda \left(t\right)$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mi mathvariant="normal">λ</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12864_2022_9021_Article_IEq14.gif"/></alternatives></inline-formula> as follows,<disp-formula id="Equa"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uplambda \left(t\right)=f\left(\frac{t-{t}_{i}}{{t}_{i+1}-{t}_{i}};{\alpha }_{i},{\beta }_{i}\right)\times {\uplambda }_{i} (1)$$\end{document}</tex-math><mml:math id="M30" display="block"><mml:mrow><mml:mi mathvariant="normal">λ</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>;</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo>×</mml:mo><mml:msub><mml:mi mathvariant="normal">λ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><graphic xlink:href="12864_2022_9021_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par19">where <inline-formula id="IEq15"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f\left(x;{\alpha }_{i},{\beta }_{i}\right)$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:mi>f</mml:mi><mml:mfenced close=")" open="("><mml:mi>x</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12864_2022_9021_Article_IEq15.gif"/></alternatives></inline-formula> is the probability density function of beta distribution and <inline-formula id="IEq16"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left({\alpha }_{i},{\beta }_{i}\right)$$\end{document}</tex-math><mml:math id="M34"><mml:mfenced close=")" open="("><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:math><inline-graphic xlink:href="12864_2022_9021_Article_IEq16.gif"/></alternatives></inline-formula> are two shape parameters of beta distribution; <inline-formula id="IEq17"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x=\frac{t-{t}_{i}}{{t}_{i+1}-{t}_{i}}$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math><inline-graphic xlink:href="12864_2022_9021_Article_IEq17.gif"/></alternatives></inline-formula> and <inline-formula id="IEq18"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${t}_{i}\le t&lt;{t}_{i+1}$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:mi>t</mml:mi><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12864_2022_9021_Article_IEq18.gif"/></alternatives></inline-formula>; <inline-formula id="IEq19"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\uplambda }_{i}$$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mi mathvariant="normal">λ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12864_2022_9021_Article_IEq19.gif"/></alternatives></inline-formula> is a constant. In the time interval <inline-formula id="IEq20"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left[{t}_{n},\left.{t}_{n+1}\right)\right.$$\end{document}</tex-math><mml:math id="M42"><mml:mfenced open="["><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mfenced close=")"><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mfenced></mml:mfenced></mml:math><inline-graphic xlink:href="12864_2022_9021_Article_IEq20.gif"/></alternatives></inline-formula>, Beta-PSMC assumes the function <inline-formula id="IEq21"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uplambda \left(t\right)$$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:mi mathvariant="normal">λ</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12864_2022_9021_Article_IEq21.gif"/></alternatives></inline-formula> to be a constant <inline-formula id="IEq22"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\uplambda }_{n}$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mi mathvariant="normal">λ</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12864_2022_9021_Article_IEq22.gif"/></alternatives></inline-formula>. In order to estimate the shape parameters of the beta distribution in each discretized time interval <inline-formula id="IEq23"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left[{t}_{i},\left.{t}_{i+1}\right)\right.$$\end{document}</tex-math><mml:math id="M48"><mml:mfenced open="["><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mfenced close=")"><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mfenced></mml:mfenced></mml:math><inline-graphic xlink:href="12864_2022_9021_Article_IEq23.gif"/></alternatives></inline-formula>, <inline-formula id="IEq24"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uplambda \left(t\right)$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:mi mathvariant="normal">λ</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12864_2022_9021_Article_IEq24.gif"/></alternatives></inline-formula> is discretized into <inline-formula id="IEq25"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\uplambda }_{i,j}\left(j=0,\cdots ,k-1\right)$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:msub><mml:mi mathvariant="normal">λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12864_2022_9021_Article_IEq25.gif"/></alternatives></inline-formula> subintervals according to the following equation,<disp-formula id="Equb"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\lambda }_{i,j}=\frac{1}{{t}_{i+1,j}-{t}_{i,j}}{\int }_{{t}_{i,j}}^{{t}_{i+1,j}}\uplambda \left(t\right)dt (2)$$\end{document}</tex-math><mml:math id="M54" display="block"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:msubsup><mml:mi mathvariant="normal">λ</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><graphic xlink:href="12864_2022_9021_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par20">where <inline-formula id="IEq26"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${t}_{i,j}={t}_{i}+\frac{j}{k}\left({t}_{i+1}-{t}_{i}\right)$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mfrac><mml:mfenced close=")" open="("><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12864_2022_9021_Article_IEq26.gif"/></alternatives></inline-formula> and <inline-formula id="IEq27"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${t}_{i+1,j}={t}_{i}+\frac{j+1}{k}\left({t}_{i+1}-{t}_{i}\right), j=0,\cdots ,k-1$$\end{document}</tex-math><mml:math id="M58"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:mfrac><mml:mfenced close=")" open="("><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12864_2022_9021_Article_IEq27.gif"/></alternatives></inline-formula>.</p>
      <p id="Par21">Then, the <italic>n</italic> × <italic>k</italic> scaled population sizes, which are functions of the parameter vector <inline-formula id="IEq28"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left({{\uplambda }_{i},\alpha }_{i},{\beta }_{i}\right) 0\le i&lt;n$$\end{document}</tex-math><mml:math id="M60"><mml:mrow><mml:mfenced close=")" open="("><mml:msub><mml:mrow><mml:msub><mml:mi mathvariant="normal">λ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12864_2022_9021_Article_IEq28.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq29"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\uplambda }_{n}$$\end{document}</tex-math><mml:math id="M62"><mml:msub><mml:mi mathvariant="normal">λ</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12864_2022_9021_Article_IEq29.gif"/></alternatives></inline-formula> are estimated by fitting the likelihood function to the observation data using the expectation–maximization (EM) algorithm similar to PSMC. Finally, the probability density function of beta distribution with the estimated parameters <inline-formula id="IEq30"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left({{\uplambda }_{i},\alpha }_{i},{\beta }_{i}\right) 0\le i&lt;n$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:mfenced close=")" open="("><mml:msub><mml:mrow><mml:msub><mml:mi mathvariant="normal">λ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12864_2022_9021_Article_IEq30.gif"/></alternatives></inline-formula> is used to present the fluctuation of population size in the discretized time interval <inline-formula id="IEq31"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left[{t}_{i},\left.{t}_{i+1}\right)\right.$$\end{document}</tex-math><mml:math id="M66"><mml:mfenced open="["><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mfenced close=")"><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mfenced></mml:mfenced></mml:math><inline-graphic xlink:href="12864_2022_9021_Article_IEq31.gif"/></alternatives></inline-formula>.</p>
    </sec>
    <sec id="Sec7">
      <title>Coalescent simulation</title>
      <p id="Par22">One hundred haploid sequences of 10 Mb were simulated in three scenarios. In each scenario, the number of samples is 100 and all sample size is one genome. In the first scenario, the population experiences a series of population growths and declines (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). In the second scenario, a sharp bottleneck is followed by an exponential expansion (Fig. S3). In the third scenario, a sharp bottleneck is followed by an instant growth (Fig. S4). We assumed the generation time of 25 years. The neutral mutation rate was chosen to be 2.5 × 10–8 per generation per site. The program msHOT was used to generate the simulated data.</p>
    </sec>
    <sec id="Sec8">
      <title>User-specified parameter settings for Beta-PSMC</title>
      <p id="Par23">To improve the accuracy and resolution of demographic inference, blocks of adjacent discretized time intervals can be combined to have the same parameter vector via a user-specified pattern. When analyzing the simulated data from the first scenario, the setting for Beta-PSMC is ‘20*1’, which means each of the 20 parameter vectors spans one discretized time interval. For the simulated data from the second scenario, the setting is ‘1*3 + 17*1’, with the first parameter vector spanning the first three discretized time intervals and each of the next 17 parameter vectors for one discretized time interval. In addition, one discretized time interval or combined discretized time interval can also be divided equally into independent intervals, each of which is spanned by one parameter vector.</p>
    </sec>
    <sec id="Sec9">
      <title>Scaling to real time and population size</title>
      <p id="Par24"><inline-formula id="IEq32"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\theta }_{0}=4{N}_{0}\mu$$\end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>μ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12864_2022_9021_Article_IEq32.gif"/></alternatives></inline-formula> Of Beta-PSMC, which is similar to that of PSMC, is the scaled mutation rate, where <inline-formula id="IEq33"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu$$\end{document}</tex-math><mml:math id="M70"><mml:mi>μ</mml:mi></mml:math><inline-graphic xlink:href="12864_2022_9021_Article_IEq33.gif"/></alternatives></inline-formula> is the point mutation rate. The estimated TMRCA is in units of <inline-formula id="IEq34"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2{N}_{0}$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12864_2022_9021_Article_IEq34.gif"/></alternatives></inline-formula> generations, and <inline-formula id="IEq35"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uplambda \left(t\right)$$\end{document}</tex-math><mml:math id="M74"><mml:mrow><mml:mi mathvariant="normal">λ</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12864_2022_9021_Article_IEq35.gif"/></alternatives></inline-formula> is scaled to <inline-formula id="IEq36"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{0}$$\end{document}</tex-math><mml:math id="M76"><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12864_2022_9021_Article_IEq36.gif"/></alternatives></inline-formula> as well. The mutation rate should be specified to estimate <inline-formula id="IEq37"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N}_{0}={\theta }_{0}/4\mu$$\end{document}</tex-math><mml:math id="M78"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:mn>4</mml:mn><mml:mi>μ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12864_2022_9021_Article_IEq37.gif"/></alternatives></inline-formula>. To convert generations to years, the generation time is specified.</p>
    </sec>
    <sec id="Sec10">
      <title>Smoothing fits</title>
      <p id="Par25">In each discretized time interval, the curve of population size generated from Beta-PSMC is described by the probability density function of beta distribution with two inferred shape parameters. However, the connections of curves between adjacent time intervals are not smooth (Supplementary Fig. S<xref rid="MOESM1" ref-type="media">5</xref>A-B). In order to smooth curves among these time intervals, 5% from the left side of the curve of population size and 10% from the right side are discarded and then a quadratic curve fitting was used to connect the curves of population size between adjacent time intervals (Supplementary Fig. S<xref rid="MOESM1" ref-type="media">5</xref>C-D). The curve of population size was defined in the interval [0,1]. The 5% from the left side of the curve means the interval [0,0.05] and the 10% from the right means the interval (0.9,1). Three selected points of two adjacent intervals, two of which are at 0.8 and 0.9 of the previous interval and the last is at 0.05 of the next interval, are used to quadratic curve fitting.</p>
    </sec>
    <sec id="Sec11">
      <title>Read alignment and calling the consensus sequence</title>
      <p id="Par26">Adélie penguin genomic data was obtained from the NCBI Sequence Read Archive (SRR1145007). These sequence reads were mapped by Bowtie2 [<xref ref-type="bibr" rid="CR14">14</xref>] against the Adélie penguin reference genome [<xref ref-type="bibr" rid="CR15">15</xref>]. The diploid consensus sequence was obtained using the ‘pileup’ command of the SAMtools software package [<xref ref-type="bibr" rid="CR16">16</xref>]. The commands are in the Supplementary Materials.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec12">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12864_2022_9021_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1:</bold><bold>Table </bold><bold>S</bold><bold>1.</bold> The running times ofBeta-PSMC and PSMC on the simulation data based on the population history witha series of population growths and declines. Note. For Beta-PSMC, thenumber of discretized time intervals is 10. “<italic>n</italic>=30; k=3”: the number ofdiscretized time intervals is 30 for PSMC and the number of subintervals foreach time interval is 3. The unit of running time is minute. The number ofrepeats is 10. <bold>Fig.S1.</bold> Population sizes through time inferred from Adélie penguin genomesequences. The data of temperature change is from Li et al. (2014). g,generation time; μ, mutation rate. <bold>Fig. S2.</bold> The population history inferred with Beta-PSMCwith different subinterval settings for a simulated data from a population witha series of growths and declines. (A) The number of subintervals for each timeinterval is 2. (B) The number of subintervals for each time interval is 3. (C)The number of subintervals for each time interval is 5. (D) The number ofsubintervals for each time interval is 7. g, generation time; μ, mutation rate. <bold>Fig. S3.</bold> The population history inferred with PSMC and Beta-PSMC withdifferent settings for a simulated data from a population with one sharpbottleneck followed by an exponential expansion. For Beta-PSMC, the number of subintervalsfor each time interval is 3. (A) The number of discretized time intervals is 20for PSMC and the user-specified pattern is “20*1”. (B) The number ofdiscretized time intervals is 30 for PSMC and the user-specified pattern is“30*1”. (C) The number of discretized time intervals is 40 for PSMC and theuser-specified pattern is “40*1”. (D) The number of discretized time intervalsis 50 for PSMC and the user-specified pattern is “50*1”. (E) The number ofdiscretized time intervals is 20 for Beta-PSMC and the user-specified patternis “20*1”. (F) The number of discretized time intervals is 20 for Beta-PSMC andthe user-specified pattern is “1*3+17*1”. g, generation time; μ, mutation rate. <bold>Fig. S4.</bold> The population history inferred with PSMC and Beta-PSMC for asimulated data from a population with one sharp bottleneck followed by an instantgrowth. For Beta-PSMC, the number of subintervals for each time interval is 3. Thenumber of discretized time intervals is 20 for Beta-PSMC and the user-specifiedpattern is “1*4+16*1”. The number of discretized time intervals is 64 for PSMCand the user-specified pattern is “4+25*2+4+6”. g, generation time; μ, mutation rate. (A) The instant growth happened at 20thousand years ago (KYA). (B) The instant growth happened at 80KYA. <bold>Fig. S5.</bold> Smoothing the connections between adjacent timeintervals to improve the inference of demographic history. g, generation time; μ, mutation rate. The number of subintervals for each timeinterval is 3.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>SMC</term>
        <def>
          <p id="Par4">Sequentially Markovian Coalescent</p>
        </def>
      </def-item>
      <def-item>
        <term>PSMC</term>
        <def>
          <p id="Par5">Pairwise Sequentially Markovian Coalescent</p>
        </def>
      </def-item>
      <def-item>
        <term>HMM</term>
        <def>
          <p id="Par6">Hidden Markov Model</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank two anonymous reviewers and the editor for many critical and constructive comments, which have led to improvement of our article.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>J.L. developed the method and performed simulations. X.J. performed the smoothing fits. J.L. and H.C. wrote the manuscript. H.C. supervised the study. The author(s) read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by the National Key R&amp;D Program of China [2018YFC1406902 to H.C.] and the National Natural Science Foundation of China (Grant No. 31571370 and 91731302). The funding bodies played no role in the design of the study and collection, analysis, and interpretation of data and in writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>Beta-PSMC is implemented in C and is available under the MIT License. The source code and documentation are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/chenh-big/Beta-PSMC">https://github.com/chenh-big/Beta-PSMC</ext-link>. The genomic data of Adélie penguin are from the NCBI (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/">https://www.ncbi.nlm.nih.gov/sra/</ext-link>) under accession number SRR1145007.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par27">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par28">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par29">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <mixed-citation publication-type="other">Chen, H. (2015) Population genetic studies in the genomic sequencing era. Dong wu xue yan jiu = Zoological research, 36, 223–232.</mixed-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Fu</surname>
            <given-names>Y-X</given-names>
          </name>
        </person-group>
        <article-title>Exploring population size changes using SNP frequency spectra</article-title>
        <source>Nat Genet</source>
        <year>2015</year>
        <volume>47</volume>
        <fpage>555</fpage>
        <lpage>U172</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.3254</pub-id>
        <?supplied-pmid 25848749?>
        <pub-id pub-id-type="pmid">25848749</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gutenkunst</surname>
            <given-names>RN</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Inferring the joint demographic history of multiple populations from multidimensional SNP frequency data</article-title>
        <source>PLoS Genet</source>
        <year>2009</year>
        <volume>5</volume>
        <fpage>e1000695</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1000695</pub-id>
        <?supplied-pmid 19851460?>
        <pub-id pub-id-type="pmid">19851460</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bhaskar</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>YX</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>YS</given-names>
          </name>
        </person-group>
        <article-title>Efficient inference of population size histories and locus-specific mutation rates from large-sample genomic variation data</article-title>
        <source>Genome Res</source>
        <year>2015</year>
        <volume>25</volume>
        <fpage>268</fpage>
        <lpage>279</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.178756.114</pub-id>
        <?supplied-pmid 25564017?>
        <pub-id pub-id-type="pmid">25564017</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Fu</surname>
            <given-names>Y-X</given-names>
          </name>
        </person-group>
        <article-title>Stairway plot 2: demographic history inference with folded SNP frequency spectra</article-title>
        <source>Genome Biol</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>280</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-020-02196-9</pub-id>
        <?supplied-pmid 33203475?>
        <pub-id pub-id-type="pmid">33203475</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Excoffier</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>fastsimcoal2: femographic inference under complex evolutionary scenarios</article-title>
        <source>Bioinformatics</source>
        <year>2021</year>
        <volume>37</volume>
        <fpage>4882</fpage>
        <lpage>4885</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btab468</pub-id>
        <pub-id pub-id-type="pmid">34164653</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Inference of human population history from individual whole-genome sequences</article-title>
        <source>Nature</source>
        <year>2011</year>
        <volume>475</volume>
        <fpage>493</fpage>
        <lpage>U484</lpage>
        <pub-id pub-id-type="doi">10.1038/nature10231</pub-id>
        <?supplied-pmid 21753753?>
        <pub-id pub-id-type="pmid">21753753</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schiffels</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Inferring human population size and separation history from multiple genome sequences</article-title>
        <source>Nat Genet</source>
        <year>2014</year>
        <volume>46</volume>
        <fpage>919</fpage>
        <lpage>925</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.3015</pub-id>
        <?supplied-pmid 24952747?>
        <pub-id pub-id-type="pmid">24952747</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Terhorst</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Robust and scalable inference of population history froth hundreds of unphased whole genomes</article-title>
        <source>Nat Genet</source>
        <year>2017</year>
        <volume>49</volume>
        <fpage>303</fpage>
        <lpage>309</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.3748</pub-id>
        <?supplied-pmid 28024154?>
        <pub-id pub-id-type="pmid">28024154</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McVean</surname>
            <given-names>GAT</given-names>
          </name>
          <name>
            <surname>Cardin</surname>
            <given-names>NJ</given-names>
          </name>
        </person-group>
        <article-title>Approximating the coalescent with recombination</article-title>
        <source>Philosophical Transactions of the Royal Society B-Biological Sciences</source>
        <year>2005</year>
        <volume>360</volume>
        <fpage>1387</fpage>
        <lpage>1393</lpage>
        <pub-id pub-id-type="doi">10.1098/rstb.2005.1673</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Spence</surname>
            <given-names>JP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Inference of population history using coalescent HMMs: review and outlook</article-title>
        <source>Curr Opin Genet Dev</source>
        <year>2018</year>
        <volume>53</volume>
        <fpage>70</fpage>
        <lpage>76</lpage>
        <pub-id pub-id-type="doi">10.1016/j.gde.2018.07.002</pub-id>
        <?supplied-pmid 30056275?>
        <pub-id pub-id-type="pmid">30056275</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Li, C. et al. (2014) Two Antarctic penguin genomes reveal insights into their evolutionary history and molecular changes related to the Antarctic environment. Gigascience, 3.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Hu, Q.-H. et al. (2013) Increase in penguin populations during the Little Ice Age in the Ross Sea, Antarctica. Scientific Reports, 3.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Fast gapped-read alignment with Bowtie 2</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>357</fpage>
        <lpage>U354</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1923</pub-id>
        <?supplied-pmid 22388286?>
        <pub-id pub-id-type="pmid">22388286</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Lambert</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Genomic data from Adelie penguin (Pygoscelis adeliae)</article-title>
        <source>GigaScience</source>
        <year>2011</year>
        <pub-id pub-id-type="doi">10.5524/100006</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Sequence Alignment/Map format and SAMtools</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id>
        <?supplied-pmid 19505943?>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
