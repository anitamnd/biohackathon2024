<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5330023</article-id>
    <article-id pub-id-type="publisher-id">1549</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-017-1549-4</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>BBCAnalyzer: a visual approach to facilitate variant calling</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5011-0641</contrib-id>
        <name>
          <surname>Sandmann</surname>
          <given-names>Sarah</given-names>
        </name>
        <address>
          <email>sarah.sandmann@uni-muenster.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>de Graaf</surname>
          <given-names>Aniek O.</given-names>
        </name>
        <address>
          <email>Aniek.deGraaf@radboudumc.nl</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dugas</surname>
          <given-names>Martin</given-names>
        </name>
        <address>
          <email>Martin.Dugas@ukmuenster.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2172 9288</institution-id><institution-id institution-id-type="GRID">grid.5949.1</institution-id><institution/><institution>Institute of Medical Informatics, University of Münster, </institution></institution-wrap>Albert-Schweitzer-Campus 1, Münster, 48149 Germany </aff>
      <aff id="Aff2"><label>2</label>Laboratory Hematology, RadboudUMC, Geert Grooteplein zuid 8, Nijmegen, 6525 Netherlands </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>28</day>
      <month>2</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>28</day>
      <month>2</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2017</year>
    </pub-date>
    <volume>18</volume>
    <elocation-id>133</elocation-id>
    <history>
      <date date-type="received">
        <day>22</day>
        <month>10</month>
        <year>2016</year>
      </date>
      <date date-type="accepted">
        <day>16</day>
        <month>2</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2017</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>Deriving valid variant calling results from raw next-generation sequencing data is a particularly challenging task, especially with respect to clinical diagnostics and personalized medicine. However, when using classic variant calling software, the user usually obtains nothing more than a list of variants that pass the corresponding caller’s internal filters. Any expected mutations (e.g. hotspot mutations), that have not been called by the software, need to be investigated manually.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>BBCAnalyzer (Bases By CIGAR Analyzer) provides a novel visual approach to facilitate this step of time-consuming, manual inspection of common mutation sites. BBCAnalyzer is able to visualize base counts at predefined positions or regions in any sequence alignment data that are available as BAM files. Thereby, the tool provides a straightforward solution for evaluating any list of expected mutations like hotspot mutations, or even whole regions of interest. In addition to an ordinary textual report, BBCAnalyzer reports highly customizable plots. Information on the counted number of bases, the reference bases, known mutations or polymorphisms, called mutations and base qualities is summarized in a single plot. By uniting this information in a graphical way, the user may easily decide on a variant being present or not – completely independent of any internal filters or frequency thresholds.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>BBCAnalyzer provides a unique, novel approach to facilitate variant calling where classical tools frequently fail to call. The R package is freely available at <ext-link ext-link-type="uri" xlink:href="http://bioconductor.org">http://bioconductor.org</ext-link>. The local web application is available at Additional file <xref rid="MOESM2" ref-type="media">2</xref>. A documentation of the R package (Additional file <xref rid="MOESM1" ref-type="media">1</xref>) as well as the web application (Additional file <xref rid="MOESM2" ref-type="media">2</xref>) with detailed descriptions, examples of all input- and output elements, exemplary code as well as exemplary data are included. A video demonstrates the exemplary usage of the local web application (Additional file 3).</p>
        <p>
          <media xlink:href="12859_2017_1549_MOESM3_ESM.mp4" id="MOESM3">
            <caption>
              <p>Additional file 3: Supplement_3. Video demonstrating the exemplary usage of the web application “BBCAnalyzer”. (MP4 11571 kb)</p>
            </caption>
          </media>
        </p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s12859-017-1549-4) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Variant calling</kwd>
      <kwd>Next-generation sequencing</kwd>
      <kwd>Visualization</kwd>
      <kwd>Personalized medicine</kwd>
      <kwd>Hotspot mutations</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>ERA-Net TRANSCAN</institution>
        </funding-source>
        <award-id>BMBF 01KT1401</award-id>
      </award-group>
      <award-group>
        <funding-source>
          <institution>H2020</institution>
        </funding-source>
        <award-id>634789</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2017</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Personalized medicine is striving to find its way into clinical routine. Some therapeutic decisions are already influenced by the presence or absence of certain mutations. Sequencing in such contexts is usually performed using next-generation sequencing (NGS). However, the analysis of NGS data may be complicated by a number of reasons. On the one hand, false positive calls due to artifacts in the sequencing data may harm the results. On the other hand, false negative calls due to low variant allele frequencies or bad coverage of certain regions can lead to true mutations not being detected.</p>
    <p>There are many of programs in terms of variant calling, like GATK [<xref ref-type="bibr" rid="CR1">1</xref>] or SAMtools [<xref ref-type="bibr" rid="CR2">2</xref>]. However, – apart from some user-definable thresholds – these programs are usually a black box. They take a BAM file as input, apply a number of partially complex filtration steps and return a VCF file containing a list of likely variants. Variants with low allelic frequencies – even if they are known hotspot mutations – are usually excluded to keep the number of false positive calls low. Even recently developed sophisticated approaches like MutAid [<xref ref-type="bibr" rid="CR3">3</xref>] that provide a complete data analysis pipeline for Sanger- and next-generation sequencing data, including different mapping and variant calling algorithms, finally report a VCF file per sample and a variant summary table. Furthermore, tools developed for NGS analysis in a clinical setting, e.g. CSN and CAVA [<xref ref-type="bibr" rid="CR4">4</xref>], usually focus on the correct annotation of previously called variants.</p>
    <p>To our knowledge, there are no freely available variant calling tool that can use as input a list of likely mutations that should be considered with an especially low allelic frequency. Neither is it possible to perform a comparable analysis of positions where no variant is called, but the user is interested in the raw number of bases. As a consequence, a manual, time-consuming inspection of all sites where mutations are expected but not called is necessary.</p>
    <p>The integrative genomics viewer (IGV) [<xref ref-type="bibr" rid="CR5">5</xref>] provides such an option for the manual investigation of the different number of bases, deletions and insertions at any position in the genome. However, it is time consuming to load different samples into the program and to look at the different positions of interest. Moreover, there is no way of automatically summing up and visualizing the base counts for a list of positions in IGV. Other tools, like the R packages Rsamtools [<xref ref-type="bibr" rid="CR6">6</xref>] and VariantTools [<xref ref-type="bibr" rid="CR7">7</xref>], provide options for counting the number of bases and determining quality summaries at a selected set of positions. However, as the output is textual, programming one’s own solution for visualization is necessary. Altogether, this does not appear to be a satisfactory solution for clinical routine.</p>
    <p>In the use case of medical diagnostics, a tool performing detailed analyses of those locations where mutations are expected – but not always called – may prove to be very useful. Low allelic frequency and bad base quality may often explain why calls are missed. However, in case of missing calls this information is not included in a VCF file and is difficult to obtain from IGV.</p>
    <p>To facilitate the analysis of called and uncalled mutations, we developed BBCAnalyzer (Bases By CIGAR Analyzer). Just like common variant callers, the application uses a BAM file as input. It analyzes the CIGAR strings that characterize the mapped reads and reports the number of bases, deletions and insertions at any predefined position or region in comparison to any reference genome in a novel visual- and a common textual way. The analysis as well as the plots may be customized in a number of ways.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p>BBCAnalyzer is implemented in R and available at <ext-link ext-link-type="uri" xlink:href="http://bioconductor.org">http://bioconductor.org</ext-link>. Additionally, a web application for BBCAnalyzer is available at Additional file <xref rid="MOESM2" ref-type="media">2</xref>. The tool works with any sequence alignment data that are available as BAM files.</p>
    <sec id="Sec3">
      <title>Input</title>
      <p>In addition to the BAM files to be analyzed, BBCAnalyzer needs the corresponding BAI files. When using BBCAnalyzer as a classical R package, a file summing up the sample names and a target file containing the positions or regions to be analyzed have to be provided. When using BBCAnalyzer as a web application, the sample names and the target regions to be analyzed have to be provided in an input field. Optionally, a VCF file containing known mutations or polymorphisms and VCF files for each sample resulting from earlier performed variant calling may be provided.</p>
    </sec>
    <sec id="Sec4">
      <title>Preparation of the plotting</title>
      <p>Prior to the actual plotting, BBCAnalyzer performs various steps of preparation.</p>
      <p>First, an analysis of the target region is performed. BBCAnalyzer is able to deal with target regions as well as single target bases.</p>
      <p>Next, detected bases, deletions and insertions at every defined position are written out by analyzing available CIGAR strings. Furthermore, the quality for every base (also insertions) is written out. A threshold for excluding reads with bad mapping quality may be defined. BBCAnalyzer equally copes with uncovered positions as well as insertions &gt;1 bp.</p>
      <p>Subsequently, the number of detected bases, deletions and insertions at every position is summed up. Additionally, mean quality of detected bases – including insertions and for the inserted bases only – is calculated. A threshold may be set to exclude bases with bad quality. The number of excluded bases is counted and reported separately. In case of VCF files being available for every sample, the expected number of bases, deletions and insertions are determined based on the called alternate alleles and the assigned genotypes.</p>
      <p>Finally, the ratios of the detected bases, deletions and insertions (additionally) are determined. Based on the ratios, up to six different calls are reported. A threshold may be set to ignore variants with a minor ratio. In the case of an available VCF file containing the called variants for every sample, the call – taking into account the reference allele, the alternate alleles and the genotype – is determined.</p>
    </sec>
    <sec id="Sec5">
      <title>Plotting</title>
      <p>The essential feature of BBCAnalyzer is its plotting functionality. On the basis of the determined base counts, bar plots are generated. The user can choose between one bar plot per sample, focusing the analysis on various target bases at a time, or one bar plot per position, setting the focus of the analysis on the direct comparison of many BAM files at a single position. In addition, the absolute or relative number of counts can be plotted (see Fig. <xref rid="Fig1" ref-type="fig">1</xref>).
<fig id="Fig1"><label>Fig. 1</label><caption><p>Exemplary output file from real patient data generated by Illumina NextSeq. Relative number of reads at <italic>seven positions</italic> analyzed in case of sample “Example_Illumina”. Reference bases are <italic>plotted</italic> at the <italic>negative y axis</italic>, detected bases in the mapped reads are <italic>plotted</italic> at the <italic>positive y axis</italic> (marked 5% threshold). Likely SNV at chr1:115,258,747 (reference C, ∼70% of the reads with high-quality C and ∼30% of the reads with high-quality T). No variant at chr2:25,467,204 (reference G, ∼100% of the reads with high-quality G). Unlikely SNV at chr2:198,267,280 (reference C, ∼95% of the reads with low-quality C, ∼5% of the reads with low-quality A). Likely deletion at chr4:106,157,106 (reference A, ∼75% of the reads with high quality A, ∼25% of the reads with deleted A). Known homozygous SNP at chr17:7,579,472 (reference G, polymorphism C displayed as additional reference base, ∼100% of the reads with high-quality C). Possible insertion of a “G”, but unlikely deletion at chr20:31,022,442 (reference G, ∼97% of the reads with high-quality G, ∼3% of the reads with deleted G, ∼30% of the reads with inserted high-quality G). Likely SNV at chr21:44,514,777 (reference T, ∼65% of the reads with high-quality T, ∼35% of the reads with high-quality G)</p></caption><graphic xlink:href="12859_2017_1549_Fig1_HTML" id="MO1"/></fig>
</p>
      <p>In each case, the previously determined numbers of detected bases, deletions and insertions are plotted on the positive y axis of the bar plot. The bars are colored according to the base (adenine: green; cytosine: blue; guanine: yellow; thymine: red; deletion: black; insertion: color of the inserted base or bases plus purple edge). If the mean quality of the bases is considered, a lower and an upper boundary may be set. A high mean quality close to the upper bound leads to a darker coloring of the bar.</p>
      <p>In addition to the counted bases, the reference bases (hg19 in Fig. <xref rid="Fig1" ref-type="fig">1</xref>) at the targeted positions are plotted on the negative y axis. In doing so, single nucleotide variants (SNVs) may directly be identified (Fig. <xref rid="Fig1" ref-type="fig">1</xref>, chr1:115,258,747 or chr21:44,514,777 in comparison to chr2:198,267,280).</p>
      <p>If a VCF file containing known variants, e.g. originating from dbSNP [<xref ref-type="bibr" rid="CR8">8</xref>], is given, additional reference bases are included in the plots at the corresponding positions (Fig. <xref rid="Fig1" ref-type="fig">1</xref>, chr17:7,579,472).</p>
      <p>BBCAnalyzer is able to visualize insertions of 1 bp (Fig. <xref rid="Fig1" ref-type="fig">1</xref>, chr20:31,022,442), but also long insertions of &gt; 1 bp by repeatedly analyzing the same position. This is even possible, when many samples are analyzed in parallel, but the corresponding position is not covered in all cases. Furthermore, BBCAnalyzer is able to cope with different inserted bases at the same position by plotting them as stacked bars.</p>
      <p>An exemplary visualization of a deletion is displayed at position chr4:106,157,106 in Fig. <xref rid="Fig1" ref-type="fig">1</xref>.</p>
      <p>If VCF files for all samples are provided, the expected number of bases, deletions and insertions on the basis of the assigned genotype are added to the bar plots using dashed lines.</p>
      <p>To account for the ratio of detected bases, deletions and insertions – even if their absolute numbers are chosen to be plotted –, a vector may be defined giving the ratios at which horizontal lines shall be drawn in the plots, e.g. 25, 50 and 75%. However, this function may also be used to mark a variant calling threshold at e.g. 5% (Fig. <xref rid="Fig1" ref-type="fig">1</xref>).</p>
    </sec>
    <sec id="Sec6">
      <title>Output</title>
      <p>The bases and their qualities at every analyzed position, the absolute number of counts and the relative frequencies together with the corresponding calls get reported as separate TXT files.</p>
      <p>When using BBCAnalyzer as an R package, the user can provide an output directory for the plots. If he does, all plots generated by BBCAnalyzer get automatically saved as PNG files. Otherwise, the plots are returned to the workspace.</p>
      <p>When using BBCAnalyzer as a web application, all plots generated by BBCAnalyzer get automatically saved as PNG files in the given output directory. Additionally, all plots get displayed in the application’s output panel.</p>
    </sec>
  </sec>
  <sec id="Sec7">
    <title>Results and discussion</title>
    <p>The performance of every variant calling tool is influenced by numerous parameters. General characteristics of the data, e.g. average coverage or the level of sequencing errors, can prevent a true mutation from being called, but variant-specific characteristics, e.g. the variant allele frequency or the surrounding bases may also influence mutation calling. Calling mutations in repetitive regions as well as low-frequency mutations is especially challenging.</p>
    <p>With the help of two exemplary cases of real sequencing data (Illumina NextSeq) from patients with myelodysplastic syndrome (MDS), we show how BBCAnalyzer is able to facilitate variant calling where common variant calling tools frequently fail.</p>
    <sec id="Sec8">
      <title>Using BBCAnalyzer to detect mutations in repetitive regions</title>
      <p>Depending on the repeated motive, calling mutations in repetitive regions can be very challenging. As an example, we consider the insertion of G in case of a homopolymeric stretch of eight Gs (chr20:31022442;insG). This mutation in ASXL1 is regarded as a hotspot mutation for MDS and other myeloid malignancies.</p>
      <p>We perform variant calling with two standard tools: GATK and SAMtools. Five sets of sequencing data are analyzed (UPN1-UPN5). Only in case of UPN1 the expected mutation on ASXL1 is called. Furthermore, the mutation is only called by GATK, not by SAMtools. GATK reports a depth of <italic>DP</italic>=188. 142 reads containing the reference allele and 43 reads containing the alternate allele are reported. Thus, the allelic frequency is <italic>VAF</italic>=0.23. The presence of the mutation in UPN1 was confirmed by Sanger sequencing [<xref ref-type="bibr" rid="CR9">9</xref>].</p>
      <p>In addition to classical variant calling, we use BBCAnalyzer to analyze position chr20:31,022,442. The results are displayed in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. The following options were defined: no vcf input for every sample, no file containing known mutations, reference genome hg19, MQ threshold=60, BQ threshold=50 (ASCII coded; corresponds to Phred quality score of 17), frequency threshold=0.01, quality lower bound=58 (ASCII coded; corresponds to Phred quality score of 25), quality upper bound=63 (ASCII coded; corresponds to Phred quality score of 30), mark at 20%, plot relative number of bases, return one plot per analyzed position.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Analysis of position chr20:31,022,442 with BBCAnalyzer. Relative number of reads (<italic>one bar plot</italic> per position; marked 20% threshold): UPN1 and UPN4 feature an inserted G in almost 30% of the reads, while samples UPN2, UPN3 and UPN5 feature no significant difference between the number of reads containing a deletion and the number of reads containing an insertion. Thus, only samples UPN1 and UPN4 are likely to feature the mutation chr20:31,022,441 A &gt;AG</p></caption><graphic xlink:href="12859_2017_1549_Fig2_HTML" id="MO2"/></fig>
</p>
      <p>The analysis of position chr20:31,022,442 with BBCAnalyzer underlines our previous findings in case of sample UPN1. More than 20% of the reads feature an inserted G. However, the frequencies determined by BBCAnalyzer differ considerable from the ones reported by GATK. 4855 reads contain the reference allele, 10 reads contain an A, 159 a deletion, 1394 an insertion and 56 are excluded due to low base quality. Obviously, GATK applies a number of filters by default that exclude a majority of calls.</p>
      <p>Considering the remaining sequencing data, it becomes obvious that samples UPN2, UPN3 and UPN5 feature no significant difference between the number of reads containing a deletion and the number of reads containing an insertion. It is thus likely, that these samples do not have a true mutation at the analyzed position. Sanger sequencing also indicated that the mutation was not present in these samples. Sample UPN4 however shows results that are very similar compared to UPN1. 12,355 reads contain the reference allele, 21 reads contain an A, 2 reads contain a C, 1 read contains a T, 370 reads contain a deletion, 4051 reads contain an insertion and 183 reads are excluded due to low base quality. Thus, the allelic frequency of the insertion is <italic>VAF</italic>=0.32. Again we perform Sanger sequencing and indeed the presence of the mutation was confirmed, although it has neither been called by GATK, nor by SAMtools.</p>
    </sec>
    <sec id="Sec9">
      <title>Using BBCAnalyzer to detect low-frequency mutations</title>
      <p>Detecting low-frequency mutations in NGS data is, even if data features a low level of sequencing errors, very challenging. Some mutations, like chr1:115,258,744;C &gt;A on NRAS, are important hotspot mutations that occur in various types of cancer at various VAFs. NRAS mutations may occur at low frequency and seem to be associated with transformation to more aggressive disease. Therefore, it may be relevant to detect these mutations already at a subclonal level. For a common variant calling tool, like GATK or SAMtools, it is practically impossible to detect such a variant.</p>
      <p>Based on the real Illumina NextSeq sequencing data we simulate five sets of sequencing data using ART_Illumina 2.5.8 [<xref ref-type="bibr" rid="CR10">10</xref>]. To account for specific sequencing errors, we determine a read quality profile on the basis of the real Illumina data and use it for the subsequent simulation. Average coverage of the simulated samples corresponds to average coverage of the real samples (4034x). Using bam surgeon [<xref ref-type="bibr" rid="CR11">11</xref>] we simulate the hotspot mutation in NRAS in case of three out of five samples with an expected allelic frequency of <italic>VAF</italic>=0.03.</p>
      <p>We perform variant calling on our simulated samples using GATK and SAMtools. However, both tools are unable to detect the mutation we simulated in any of the three samples. In addition to classical variant calling, we again perform analysis of position chr1:115,258,744 using BBCAnalyzer. The results of the simulated samples are displayed in Fig. <xref rid="Fig3" ref-type="fig">3</xref>A. The following options were defined: no vcf input for every sample, no file containing known mutations, reference genome hg19, MQ threshold=60, BQ threshold=50 (ASCII coded; corresponds to Phred quality score of 17), frequency threshold=0.01, quality lower bound=58 (ASCII coded; corresponds to Phred quality score of 25), quality upper bound=63 (ASCII coded; corresponds to Phred quality score of 30), mark at 3%, plot relative number of bases, return one plot per analyzed position.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Analysis of position chr1:115,258,744 with BBCAnalyzer. Relative number of reads (<italic>one bar plot</italic> per position; marked 3% threshold): <bold>a</bold>: Simulated data. A low-frequency mutation (C &gt;A) can be observed in case of samples SIM1, SIM2 and SIM3, but not in samples SIM4 and SIM5. <bold>b</bold>: Real data. Similar to the simulated data, the same low-frequency mutation can be observed in case of sample UPN1, but not in samples UPN2-UPN5. Thus, samples UPN1 is likely to feature the mutation chr1:115,258,744 C &gt;A</p></caption><graphic xlink:href="12859_2017_1549_Fig3_HTML" id="MO3"/></fig>
</p>
      <p>The plot shows that the hotspot mutation on NRAS is clearly visible in case of SIM1, SIM2 and SIM3. The observed frequency matches our expectations. Furthermore, it can be observed that the base quality of both, reads featuring the reference- and reads featuring the alternate allele, is high.</p>
      <p>Just like in case of the simulated data, we analyze five sets of real Illumina NextSeq sequencing data. Again, GATK and SAMtools do not report a mutation at chr1:115,258,744 in case of any of the analyzed samples. However, when using BBCAnalyze, the mutation is visible in case of UPN1 (see Fig. <xref rid="Fig3" ref-type="fig">3</xref>B). The allelic frequency is <italic>VAF</italic>=0.02. Altogether, BBCAnalyzer detects 10,048 reads containing the reference allele, 247 reads containing an A, 12 reads containing a T, 14 reads containing a deletion and 231 reads being excluded due to low base quality. However, similar to the simulated data, reads featuring the reference- and reads featuring the alternate allele have a high base quality. It thus appears likely, that sample UPN1 actually contains the NRAS mutation.</p>
      <p>As there is no way of validating mutations at such a low allelic frequency using Sanger sequencing, we sequenced the sample a second time on Illumina NextSeq (completely separate experiment with target enrichment, library preparation and sequencing). The same mutation can be observed with a similar frequency. Therefore, we assume that sample UPN1 actually features the low-frequency hotspot mutation in NRAS, although GATK and SAMtools both fail to call it.</p>
    </sec>
  </sec>
  <sec id="Sec10" sec-type="conclusion">
    <title>Conclusions</title>
    <p>Different from common variant calling tools, we present an application that provides a novel, visual approach to facilitate variant calling. Information on the counted number of bases, the reference bases, known mutations or polymorphisms, called mutations and base qualities is united in a novel graphical way. Thereby, BBCAnalyzer provides a solution for otherwise time-consuming, manual inspection of sites where mutations are expected but not called. Considering examples of mutations in repetitive regions and low-frequency mutations, we have shown how BBCAnalyzer can facilitate variant calling where classical tools frequently fail. Additionally, BBCAnalyzer is not only available as a classical R package, but also in form of an intuitively usable web application. This enables a potentially wide usage of our tool – not only by bioinformaticians, but also biologists and clinicians.</p>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec11">
        <title>Additional files</title>
        <p>
          <media position="anchor" xlink:href="12859_2017_1549_MOESM1_ESM.pdf" id="MOESM1">
            <label>Additional file 1</label>
            <caption>
              <p>Supplement_1. Detailed documentation of the R package “BBCAnalyzer”. (PDF 377 kb)</p>
            </caption>
          </media>
        </p>
        <p>
          <media position="anchor" xlink:href="12859_2017_1549_MOESM2_ESM.zip" id="MOESM2">
            <label>Additional file 2</label>
            <caption>
              <p>Supplement_2. Scripts and documentation of the web application “BBCAnalyzer”. (ZIP 709 kb)</p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>IGV</term>
        <def>
          <p>Integrative genomics viewer</p>
        </def>
      </def-item>
      <def-item>
        <term>MDS</term>
        <def>
          <p>Myelodysplastic syndrome</p>
        </def>
      </def-item>
      <def-item>
        <term>NGS</term>
        <def>
          <p>Next-generation sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>SNV</term>
        <def>
          <p>Single nucleotide variant</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank the Genome Technology Center, Radboud university medical center, for performing the NextSeq500 sequencing runs.</p>
    <sec id="d29e563">
      <title>Funding</title>
      <p>This work is supported by EU grants Triage-MDS (ERA-Net TRANSCAN grant no. BMBF 01KT1401) and MDS-RIGHT (grant no. 634789). The funding did not play any role in the design or conclusion of this study.</p>
    </sec>
    <sec id="d29e568">
      <title>Availability of data and materials</title>
      <p>The R-package BBCAnalyzer, its source code, detailed documentation including a manual and a vignette with examples and exemplary data are freely available at <ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/release/bioc/html/BBCAnalyzer.html">http://bioconductor.org/packages/release/bioc/html/BBCAnalyzer.html</ext-link> (license: LGPL-3).</p>
      <p>Detailed documentation of the R-package BBCAnalyzer is provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>. The source code (written in R), a manual and a vignette with examples and exemplary data are freely available at the project’s homepage <ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/release/bioc/html/BBCAnalyzer.html">http://bioconductor.org/packages/release/bioc/html/BBCAnalyzer.html</ext-link>
(license: LGPL-3; operating systems: Linux, Windows, Mac OS; requirements: R). The web application BBCAnalyzer including all necessary scripts and a detailed documentation is provided in Additional file <xref rid="MOESM2" ref-type="media">2</xref> (requirements: RStudio, Shiny). A video demonstrating the web application’s exemplary usage is provided in Additional file 3.</p>
    </sec>
    <sec id="d29e591">
      <title>Authors’ contributions</title>
      <p>SS conceived and implemented the software and analyzed the data. AOdG performed validation experiments. SS wrote the original manuscript. AOdG and MD critically revised the original manuscript. MD supervised the project. All authors read and approved the final manuscript.</p>
    </sec>
    <sec id="d29e596">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="d29e601">
      <title>Consent for publication</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="d29e606">
      <title>Ethics approval and consent to participate</title>
      <p>For our examples, we analyzed sequencing data that were generated in a study approved by MEC: Medisch Ethische Toetsingscommissie (METc; Medical Ethical Committee) of the Vrije Universiteit Medisch Centrum (VUmc; VU University Medical Center Amsterdam) (EudraCT nr.: 2008-002195-10). All participants provided written informed consent to participate in this study. The ethics committee approved this consent procedure.</p>
    </sec>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DePristo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Banks</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Poplin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Garimella</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Maguire</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hartl</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Philippakis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>del Angel</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Rivas</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Hanna</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>McKenna</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fennell</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kernytsky</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sivachenko</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cibulskis</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Gabriel</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Altshuler</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Daly</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A framework for variation discovery and genotyping using next-generation dna sequencing data</article-title>
        <source>Nat Genet</source>
        <year>2011</year>
        <volume>43</volume>
        <fpage>491</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.806</pub-id>
        <?supplied-pmid 21478889?>
        <pub-id pub-id-type="pmid">21478889</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Handsaker</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wysoker</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fennell</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Homer</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Marth</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Abecasis</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
          <collab>1000 genome project data processing subgroup</collab>
        </person-group>
        <article-title>The sequence alignment/map (sam) format and samtools</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2078</fpage>
        <lpage>079</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id>
        <?supplied-pmid 19505943?>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pandey</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Pabinger</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kriegner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Weinhäusel</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>MutAid: Sanger and NGS based integrated pipeline for mutation identification, validation and annotation in human molecular genetics</article-title>
        <source>PLoS ONE</source>
        <year>2016</year>
        <volume>11</volume>
        <fpage>1</fpage>
        <lpage>22</lpage>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Münz</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ruark</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Renwick</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ramsay</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Clarke</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mahamdallie</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cloke</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Seal</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Strydom</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lunter</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Rahman</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>CSN and CAVA: variant annotation tools for rapid, robust next-generation sequencing analysis in the clinical setting</article-title>
        <source>Genome Med</source>
        <year>2015</year>
        <volume>7</volume>
        <fpage>1</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1186/s13073-015-0195-6</pub-id>
        <pub-id pub-id-type="pmid">25606059</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Thorvaldsdóttir</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Winckler</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Guttman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Getz</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Mesirov</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>Integrative genomics viewer</article-title>
        <source>Nat Biotechnol</source>
        <year>2011</year>
        <volume>29</volume>
        <fpage>24</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1754</pub-id>
        <?supplied-pmid 21221095?>
        <pub-id pub-id-type="pmid">21221095</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <mixed-citation publication-type="other">Morgan M, Pagès H, Obenchain V, Hayden N. Rsamtools: binary alignment (BAM), FASTA, variant call (BCF) and tabix file import. R package version 1.26.1. 2016. <ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/release/bioc/html/Rsamtools.html">http://bioconductor.org/packages/release/bioc/html/Rsamtools.html</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <mixed-citation publication-type="other">Lawrence M, Degenhardt J, Gentleman R. VariantTools: tools for working with generic variants R package version 1.16.0. 2016. <ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/release/bioc/html/VariantTools.html">http://bioconductor.org/packages/release/bioc/html/VariantTools.html</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sherry</surname>
            <given-names>ST</given-names>
          </name>
          <name>
            <surname>Ward</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Kholodov</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Baker</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Phan</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Smigielski</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Sirotkin</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>dbSNP: the NCBI database of genetic variation</article-title>
        <source>Nucleic Acids Res</source>
        <year>2001</year>
        <volume>29</volume>
        <fpage>308</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/29.1.308</pub-id>
        <?supplied-pmid 11125122?>
        <pub-id pub-id-type="pmid">11125122</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sanger</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Nicklen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Coulson</surname>
            <given-names>AR</given-names>
          </name>
        </person-group>
        <article-title>DNA sequencing with chain-terminationg inhibitors</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>1977</year>
        <volume>74</volume>
        <fpage>5463</fpage>
        <lpage>467</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.74.12.5463</pub-id>
        <?supplied-pmid 271968?>
        <pub-id pub-id-type="pmid">271968</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Marth</surname>
            <given-names>GT</given-names>
          </name>
        </person-group>
        <article-title>ART: a next-generation sequencing read simulator</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>593</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr708</pub-id>
        <?supplied-pmid 22199392?>
        <pub-id pub-id-type="pmid">22199392</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ewing</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Houlahan</surname>
            <given-names>KE</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ellrott</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Caloian</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Yamaguchi</surname>
            <given-names>TN</given-names>
          </name>
          <name>
            <surname>Bare</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>P’ng</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Waggott</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Sabelnykova</surname>
            <given-names>VY</given-names>
          </name>
          <collab>ICGC-TCGA DREAM Somatic Mutation Calling Challenge participants</collab>
          <name>
            <surname>Kellen</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Norman</surname>
            <given-names>TC</given-names>
          </name>
          <name>
            <surname>Haussler</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Friend</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Stolovitzky</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Margolin</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Stuart</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Boutros</surname>
            <given-names>PC</given-names>
          </name>
        </person-group>
        <article-title>Combining tumor genome simulation with crowdsourcing to benchmark somatic single-nucleotide-variant detection</article-title>
        <source>Nat Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <fpage>623</fpage>
        <lpage>30</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3407</pub-id>
        <?supplied-pmid 25984700?>
        <pub-id pub-id-type="pmid">25984700</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
