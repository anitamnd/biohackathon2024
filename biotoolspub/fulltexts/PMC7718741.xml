<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">G3 (Bethesda)</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genetics</journal-id>
    <journal-id journal-id-type="hwp">G3: Genes, Genomes, Genetics</journal-id>
    <journal-id journal-id-type="pmc">G3: Genes, Genomes, Genetics</journal-id>
    <journal-id journal-id-type="publisher-id">G3: Genes, Genomes, Genetics</journal-id>
    <journal-title-group>
      <journal-title>G3: Genes|Genomes|Genetics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2160-1836</issn>
    <publisher>
      <publisher-name>Genetics Society of America</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7718741</article-id>
    <article-id pub-id-type="pmid">33093185</article-id>
    <article-id pub-id-type="publisher-id">GGG_401874</article-id>
    <article-id pub-id-type="doi">10.1534/g3.120.401874</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software and Data Resources</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>GWideCodeML: A Python Package for Testing Evolutionary Hypotheses at the Genome-Wide Level</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-5700-4462</contrib-id>
        <name>
          <surname>Macías</surname>
          <given-names>Laura G.</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">*</xref>
        <xref ref-type="aff" rid="aff2">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0003-1024-954X</contrib-id>
        <name>
          <surname>Barrio</surname>
          <given-names>Eladio</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">*</xref>
        <xref ref-type="aff" rid="aff2">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0003-1714-6703</contrib-id>
        <name>
          <surname>Toft</surname>
          <given-names>Christina</given-names>
        </name>
        <xref ref-type="aff" rid="aff3">
          <sup>‡</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>1</sup>
        </xref>
      </contrib>
      <aff id="aff1"><label>*</label>Departament de Genètica, Universitat de València, Burjassot, Valencia, Spain</aff>
      <aff id="aff2"><label>†</label>Departamento de Biotecnología de los Alimentos, Instituto de Agroquímica y Tecnología de los Alimentos (IATA), CSIC, Paterna, Valencia, Spain</aff>
      <aff id="aff3"><label>‡</label>Program for Systems Biology of Molecular Interactions and Regulation, Institute for Integrative Systems Biology (I2SysBio; UV-CSIC), Valencia, Spain</aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><label>1</label>Corresponding author: E-mail: <email>christina.toft@uv.es</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>22</day>
      <month>10</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>12</month>
      <year>2020</year>
    </pub-date>
    <volume>10</volume>
    <issue>12</issue>
    <fpage>4369</fpage>
    <lpage>4372</lpage>
    <history>
      <date date-type="received">
        <day>14</day>
        <month>6</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>10</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2020 Macias <italic>et al.</italic></copyright-statement>
      <copyright-year>2020</copyright-year>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:title="pdf" xlink:href="4369.pdf"/>
    <abstract>
      <p>One of the most widely used programs for detecting positive selection, at the molecular level, is the program <italic>codeml</italic>, which is implemented in the Phylogenetic Analysis by Maximum Likelihood (PAML) package. However, it has a limitation when it comes to genome-wide studies, as it runs on a gene-by-gene basis. Furthermore, the size of such studies will depend on the number of orthologous genes the genomes have income and these are often restricted to only account for instances where a one-to-one relationship is observed between the genomes. In this work, we present GWideCodeML, a Python package, which runs a genome-wide <italic>codeml</italic> with the option of parallelization. To maximize the number of analyzed genes, the package allows for a variable number of taxa in the alignments and will automatically prune the topology to fit each of them, before running <italic>codeml</italic>.</p>
    </abstract>
    <kwd-group>
      <kwd>Positive selection</kwd>
      <kwd>Comparative genomics</kwd>
      <kwd>Genome analysis</kwd>
      <kwd>Molecular evolution</kwd>
      <kwd>Protein sequence analysis</kwd>
      <kwd>Python</kwd>
    </kwd-group>
    <counts>
      <fig-count count="1"/>
      <table-count count="2"/>
      <equation-count count="0"/>
      <ref-count count="24"/>
      <page-count count="4"/>
    </counts>
  </article-meta>
</front>
<body>
  <p>With the rise of the genomic era, comparative analyses are gaining interest and are becoming more feasible due to the increase of available genomes. Testing evolutionary hypotheses to measure selective pressure in coding sequences is a common approach in evolutionary biology projects. To do this, there are different bioinformatic tools and resources like the PAML package (<xref rid="bib21" ref-type="bibr">Yang 2007</xref>)⁠. Within this package, <italic>codeml</italic> allows estimating the ratio (ω) between non-synonymous and synonymous substitutions in protein-coding sequences. The assumption that synonymous mutations accumulate neutrally, implies that ω can be used as a measure of the selective pressure on the coding sequence. In a neutral evolutionary scenario, this ratio will remain equal to one while it will be less or greater than one under purifying and positive selection, respectively. <italic>Codeml</italic> can be run with different assumptions, including the most used: ω is constant along the whole coding sequence but it can vary among branches (branch model), ω remains constant among branches but it can differ among codon sites in a coding sequence (site model) or assuming that <italic>ω</italic> varies both among branches and sites (branch-site model). The desired model, along with other parameters, is given to <italic>codeml</italic> through the control file, along with the coding-sequence alignment of orthologous genes and the species tree.</p>
  <p>Implementing <italic>codeml</italic> in an automatic workflow for a genome-wide approach has its challenges. Among these is the negative correlation between the number of genomes and the number of orthologs shared among them implying that increasing the number of genomes to improve the statistical power of the method will result in reducing the number of analyzed genes. However, the lack of one particular gene, in any of the analyzed species, might not be critical for the analysis if the number of remaining orthologs is substantial.</p>
  <p>In this work, we provide a Python package, GwideCodeML, that can be used for running <italic>codeml</italic> on a set of orthologous coding sequences under site, branch or branch-site models. This package automatically generates the files necessary to run the <italic>codeml</italic> program including pruning of the topology to match each of the alignments in cases where some taxa are missing compared to the species tree. A dataset of two <italic>Saccharomyces</italic> species is used for testing our program. The package allowed the use of several outgroup species without decreasing the number of genes included in the analysis.</p>
  <sec sec-type="methods" id="s1">
    <title>Methods</title>
    <sec id="s2">
      <title>Input files</title>
      <p>GWideCodeML requires as input, a directory with codon-aligned orthologous sequences in FASTA format and a NEWICK-format tree topology containing all the species included in the analysis (<xref ref-type="fig" rid="fig1">Figure 1</xref>). A common denominator between the names within the FASTA file and the taxa (<italic>e.g.</italic>, species and/or strain names) within the tree, is also required. It should be noted that the pipeline itself does not handle possible duplication events and the users should make sure the FASTA files contain a maximum of one sequence per species/strain. Besides, the users need to provide optional configuration parameters such as the model to be tested. Furthermore, it is possible to set a minimum number of species/strains, either belonging to the foreground branch and/or to the outgroup, to filter out alignments with low statistical power. Whether the users decide to test a branch, branch-site model, or to set a threshold, a text file with a list of branch label information is also required as input. In the case of branch and branch-site model, an integer should be added after the branch label to indicate which clade the taxon belongs to. Specifying integers other than 0 and 1 - used for the background and foreground, respectively - will allow for multiple branch testing. In these cases, the workflow will be run for each of the specified foreground clades (integers greater than 0).</p>
      <fig id="fig1" fig-type="figure" orientation="portrait" position="float">
        <label>Figure 1</label>
        <caption>
          <p>Schematization of the GwideCodeML workflow divided in the three main parts: required input, preprocessing steps necessary for creating control <italic>codeml</italic> files necessary for testing both null and alternative hypotheses. The last part of the pipeline shows the output file obtained after running LRTs on the <italic>codeml</italic> results file. This output file contains all the candidate genes of being under positive selection.</p>
        </caption>
        <graphic xlink:href="4369f1"/>
      </fig>
    </sec>
    <sec id="s3">
      <title>Pipeline execution</title>
      <p>Codon-aligned sequences are passed through the workflow if: i) only one gene per taxon is found and ii) they pass the threshold of the number of sequences, which by default is set to 0. Hereafter, sequence names are compared between the alignment file and the species tree. The tree will be pruned until it only contains the taxa present within the alignment.</p>
      <p>From this step onwards, the workflow performance will depend on the model selected by the user (branch, site, branch-site, or custom). In the case of the branch or branch-site model, the new tree created (pruned or original) will be used to indicate the foreground branch. Hereafter, the control files necessary to run both the alternative and null hypotheses are created and <italic>codeml</italic> (included in the PAML v4.9 package) is run with each of them. This is the most time-consuming step, however, the package allows parallelization of this task when the user provides a maximum number of threads to be used by the program set by the <italic>-p</italic> optional parameter. Once <italic>codeml</italic> has finished, GWideCodeML parses the output files to perform a Likelihood Ratio Test (LRT) to assess the level of significance between the two hypotheses. This last part is optional, allowing the users to analyze <italic>codeml</italic> results by themselves or letting the pipeline do it for them. When branch or branch-site models have been selected, GWideCodeML will optionally (-gene_trees option) run FastTree (<xref rid="bib13" ref-type="bibr">Price <italic>et al.</italic> 2010</xref>) on each of the alignments and compare the topologies of the gene and species tree focusing on the foreground branches. In cases where the studied clade is not monophyletic between the two trees, the user will be informed.</p>
    </sec>
    <sec id="s4">
      <title>Nested models implemented in the pipeline</title>
      <p>Three nested models have been implemented in GWideCodeML for their execution. The branch model allows dN/dS ratio to vary among branches assuming this ratio remains constant among codons (<xref rid="bib19" ref-type="bibr">Yang 1998</xref>; <xref rid="bib22" ref-type="bibr">Yang and Nielsen 1998</xref>)⁠. This model is useful for detecting positive selection acting on a particular branch and it uses M0 (one-ratio model) and two-ratios model (<xref rid="bib5" ref-type="bibr">Goldman and Yang 1994</xref>) as null and alternative hypothesis testing, respectively.</p>
      <p>Site model assumes dN/dS ratio might be different among codons of the coding sequence provided (<xref rid="bib12" ref-type="bibr">Nielsen and Yang 1998</xref>; <xref rid="bib20" ref-type="bibr">Yang 2000</xref>)⁠. To test this, model M1a or NearlyNeutral and M2a or PositiveSelection (<xref rid="bib22" ref-type="bibr">Yang and Nielsen 1998</xref>; <xref rid="bib23" ref-type="bibr">Yang <italic>et al.</italic> 2005</xref>) are built-in on the workflow as null and alternative hypotheses, respectively. Finally, the branch-site model is a combination of the two previous approaches as it allows dN/dS ratio to vary among branches and codon sites. Model A null and model A have been used in our package to test both null and alternative hypotheses (<xref rid="bib23" ref-type="bibr">Yang <italic>et al.</italic> 2005</xref>; <xref rid="bib24" ref-type="bibr">Zhang <italic>et al.</italic> 2005</xref>)⁠.</p>
      <p>The three described models are nested and therefore a LRT can be applied to assess the level of significance of the null hypothesis. In cases where the <italic>p</italic>-value obtained from the LRT is lower than 0.05, the null hypothesis is rejected and this gene is further investigated. Additionally, it is possible to vary the level of significance by applying the Bonferroni’s test correction (<xref rid="bib11" ref-type="bibr">Miller 1981</xref>) when multiple branches are tested. This method has been proved to be effective and usable (<xref rid="bib1" ref-type="bibr">Anisimova and Yang 2007</xref>) in the correction of the level of significance for null hypothesis rejection depending on the number of hypotheses tested.</p>
      <p>Rejecting the null hypothesis means that the alternative hypothesis is more likely than null for the given species topology and alignment. In addition to the LRT, it is necessary to check whether dN/dS ratio is greater than one in the foreground branch (branch or branch-site models) to determine if a gene is a candidate gene of being under positive selection. Moreover, in the cases of site and branch-site models, <italic>codeml</italic> offers two methods for calculating posterior probabilities for site classes to identify codons under positive selection when the LRT is significant. These methods are naïve empirical Bayes (NEB) and Bayes empirical Bayes (BEB) (<xref rid="bib23" ref-type="bibr">Yang <italic>et al.</italic> 2005</xref>)⁠. PAML authors highly recommend ignoring NEB output and use BEB instead so the package extracts codon positions with a probability greater than 0.9 of being under positive selection according to BEB results when the LRT is significant.</p>
    </sec>
    <sec id="s5">
      <title>Additional options and modules</title>
      <p>GWideCodeml contains a number of additional scripts and options which can aid the users in preparing the input files or acquire further information about the data. They include i) a module which allows the users to align their codon sequences with three different aligners (Mafft, Muscle or Prank). ii) another module which helps the users to create the alignment necessary to reconstruct a robust species phylogeny by selecting the genes containing sequences for all species included in the analysis. iii) The workflow works with the provided species phylogeny, however, it is possible to set the parameter -gene_tree, and the program will flag the genes where the studied clade is not monophyletic in the species and gene trees. iv) In the case of the branch and branch-site models, the option -dnds will parse the foreground and background ω’s into a separate output file. v) a module which performs a Bonferroni’s test correction when multiple branch testing has been performed.</p>
    </sec>
    <sec id="s6">
      <title>Output files</title>
      <p>The final output of the pipeline is a text file with a list containing genes under positive selection according to the analysis performed. Additionally, when the site or branch-site model is selected, gene names are accompanied with the codon positions in the alignment under positive selection. A gene may have one or more codon positions under positive selection.</p>
    </sec>
    <sec id="s7">
      <title>Case-study</title>
      <p>A genome dataset of two species of <italic>Saccharomyces</italic>, <italic>S. cerevisiae</italic> and <italic>S. kudriavzevii</italic>, was used for testing the performance of our package. These genomes had already been analyzed in a previous work (<xref rid="bib9" ref-type="bibr">Macías <italic>et al.</italic> 2019</xref>)⁠, where the dataset was conformed of nine genomes: four annotated genomes of each of the <italic>Saccharomyces</italic> species and <italic>Torulaspora delbrueckii</italic> as the outgroup species. For testing this package we increased this dataset, particularly the outgroup, with 18 annotated yeast genomes from The Yeast Gene Order Browser (<xref rid="bib2" ref-type="bibr">Byrne and Wolfe 2005</xref>)⁠, a database which also contains information on the homology of different species of the Saccharomycotina subphylum.</p>
      <p>In the analysis of selection performed in <xref rid="bib9" ref-type="bibr">Macías <italic>et al.</italic>, (2019)</xref> with nine genomes, the number of genes analyzed was limited by the number of common orthologous genes shared among them: 4165 genes. In the tested dataset here, which included 26 yeast genomes, only 2753 genes were shared among all species. By setting a minimum number of three background species necessary for testing the evolutionary hypotheses on a gene and four strains in the foreground branch, our pipeline almost doubled the genes analyzed to 4920 genes.</p>
    </sec>
    <sec id="s8">
      <title>GWideCodeML compared to other software</title>
      <p>Several bioinformatics resources have been developed to simplify and/or automate positive selection analyses. Some of these tools are aimed at facilitating the running of <italic>codeml</italic> and visualize the results in one task, meaning that the users need to run the program gene by gene (<xref rid="bib17" ref-type="bibr">Stern <italic>et al.</italic> 2007</xref>; <xref rid="bib4" ref-type="bibr">Delport <italic>et al.</italic> 2010</xref>; <xref rid="bib16" ref-type="bibr">Steinway <italic>et al.</italic> 2010</xref>; <xref rid="bib18" ref-type="bibr">Xu and Yang 2013</xref>)⁠. There are also other tools created for running <italic>codeml</italic> in a genome-wide framework like GwideCodeML. Most of these tools have overlapping features among them and when compared to the package presented here (<xref rid="t1" ref-type="table">Table 1</xref>). The main benefit of our package, when compared to the others, is the combination of features that makes it possible to test site, branch and branch-site models on filtered orthologs with a variable number of sequences among them. PosiGene (<xref rid="bib15" ref-type="bibr">Sahm <italic>et al.</italic> 2017</xref>) is the only one of the three published programs which is able to run with a variable number of taxa in the orthologs, it does this by generating a gene tree for each run or as GWideCodeML, prunes the provided species tree to fit each of the alignments. When looking for positive selection, it is important to have a correct topology, however, both species and gene trees have their problems. In the case of gene trees, incorrect topology can occur due to long-branch attraction and natural variation between genes due to the stochastic nature of mutations (<xref rid="bib3" ref-type="bibr">Castresana 2007</xref>; <xref rid="bib8" ref-type="bibr">Jeffroy <italic>et al.</italic> 2006</xref>; <xref rid="bib14" ref-type="bibr">Rokas and Carroll 2006</xref>). On the other hand, occurrences of horizontal gene transfer will result in the species topology being incorrect. GWideCodeML uses the species tree, but the package will flag the genes where the conservation of the taxa in the studied clade is not the same in the species and gene topology. Furthermore, PosiGene⁠, along with POTION (<xref rid="bib7" ref-type="bibr">Hongo <italic>et al.</italic> 2015</xref>)⁠, can perform some of the pre-processing steps, although they have been developed to run only one specific model. In contrast, LMAP (<xref rid="bib10" ref-type="bibr">Maldonado <italic>et al.</italic> 2016</xref>)⁠ is the most flexible regarding the models it offers, the three different nested models along with custom settings, although it lacks the pre-processing steps necessary to run them on a dataset composed of orthologs with a heterogeneous number of sequences. Other features which set GWideCodeML apart from the other three software is that it allows for testing multiple branches in the same run and it contains a module for multiple hypothesis testing.</p>
      <table-wrap id="t1" orientation="portrait" position="float">
        <label>Table 1</label>
        <caption>
          <title>Overlapping features between GWideCodeML and other bioinformatics tools. *<sup>1</sup> Built-in models: site model (SM), branch model (BM), branch-site model (BSM). *<sup>2</sup> PosiGene generates a new tree for each gene, where GWideCodeML prunes the provided species tree</title>
        </caption>
        <table frame="border" rules="groups">
          <col width="30.73%" span="1"/>
          <col width="16.16%" span="1"/>
          <col width="14.54%" span="1"/>
          <col width="17.04%" span="1"/>
          <col width="21.53%" span="1"/>
          <thead>
            <tr>
              <th valign="middle" align="center" scope="col" rowspan="1" colspan="1">Feature</th>
              <th valign="middle" align="center" scope="col" rowspan="1" colspan="1">LMAP</th>
              <th valign="middle" align="center" scope="col" rowspan="1" colspan="1">POTION</th>
              <th valign="middle" align="center" scope="col" rowspan="1" colspan="1">PosiGene</th>
              <th valign="middle" align="center" scope="col" rowspan="1" colspan="1">GWideCodeML</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td valign="middle" scope="row" rowspan="1" colspan="1">Built-in models *<sup>1</sup></td>
              <td valign="middle" align="center" rowspan="1" colspan="1">SM, BM, BSM</td>
              <td valign="middle" align="center" rowspan="1" colspan="1">SM</td>
              <td valign="middle" align="center" rowspan="1" colspan="1">BSM</td>
              <td valign="middle" align="center" rowspan="1" colspan="1">SM, BM, BSM</td>
            </tr>
            <tr>
              <td valign="middle" scope="row" rowspan="1" colspan="1">Run costume models</td>
              <td valign="middle" align="center" rowspan="1" colspan="1">Yes</td>
              <td valign="middle" align="center" rowspan="1" colspan="1">—</td>
              <td valign="middle" align="center" rowspan="1" colspan="1">—</td>
              <td valign="middle" align="center" rowspan="1" colspan="1">Yes</td>
            </tr>
            <tr>
              <td valign="middle" scope="row" rowspan="1" colspan="1">Easy branch labeling</td>
              <td valign="middle" align="center" rowspan="1" colspan="1">Yes</td>
              <td valign="middle" align="center" rowspan="1" colspan="1">—</td>
              <td valign="middle" align="center" rowspan="1" colspan="1">Yes</td>
              <td valign="middle" align="center" rowspan="1" colspan="1">Yes</td>
            </tr>
            <tr>
              <td valign="middle" scope="row" rowspan="1" colspan="1">Automatic pruning *<sup>2</sup></td>
              <td valign="middle" align="center" rowspan="1" colspan="1">—</td>
              <td valign="middle" align="center" rowspan="1" colspan="1">—</td>
              <td valign="middle" align="center" rowspan="1" colspan="1">Yes</td>
              <td valign="middle" align="center" rowspan="1" colspan="1">Yes</td>
            </tr>
            <tr>
              <td valign="middle" scope="row" rowspan="1" colspan="1">Filter out low quality orthologs</td>
              <td valign="middle" align="center" rowspan="1" colspan="1">—</td>
              <td valign="middle" align="center" rowspan="1" colspan="1">Yes</td>
              <td valign="middle" align="center" rowspan="1" colspan="1">Yes</td>
              <td valign="middle" align="center" rowspan="1" colspan="1">Yes</td>
            </tr>
            <tr>
              <td valign="middle" scope="row" rowspan="1" colspan="1">Multithreading</td>
              <td valign="middle" align="center" rowspan="1" colspan="1">Yes</td>
              <td valign="middle" align="center" rowspan="1" colspan="1">Yes</td>
              <td valign="middle" align="center" rowspan="1" colspan="1">Yes</td>
              <td valign="middle" align="center" rowspan="1" colspan="1">Yes</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec sec-type="data-availability" id="s9">
      <title>Data availability</title>
      <p>The GWideCodeML package is implemented in Python and is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/lauguma/gwidecodeml">https://github.com/lauguma/gwidecodeml</ext-link></p>
    </sec>
  </sec>
  <sec sec-type="results|discussion" id="s10">
    <title>Results And Discussion</title>
    <p>This package not only allowed us to analyze a higher number of genes but it has also dramatically increased the statistical power of our study by including more species. If we compared the number of significant genes obtained using only nine genomes and the branch-site model tested here, we can see our package also increased the number of positive results (<xref rid="t2" ref-type="table">Table 2</xref>). More specifically, we obtained 30 and 32 genes under positive selection in <italic>S. kudriavzevii</italic> and <italic>S. cerevisiae</italic> branches, respectively, in <xref rid="bib9" ref-type="bibr">Macías <italic>et al.</italic>, (2019)</xref>. However, using GWideCodeML under the branch-site model assumption, we obtained 137 and 96 in <italic>S. kudriavzevii</italic> and <italic>S. cerevisiae</italic> branches, as gene candidates to be under positive selection. Increasing the number of outgroup species has been demonstrated to affect the power of detecting sites under positive selection (<xref rid="bib6" ref-type="bibr">Goodswen <italic>et al.</italic> 2018</xref>)⁠.</p>
    <table-wrap id="t2" orientation="portrait" position="float">
      <label>Table 2</label>
      <caption>
        <title>Case-study results. Number of detected genes under positive selection after running GwideCodeML twice, one for each branch, using the three built-in nested models. *<sup>1</sup>. In site models, there is no dN/dS ratio variation among branches, therefore, it was run once</title>
      </caption>
      <table frame="border" rules="groups">
        <col width="16.68%" span="1"/>
        <col width="29.17%" span="1"/>
        <col width="37.49%" span="1"/>
        <col width="16.66%" span="1"/>
        <thead>
          <tr>
            <th valign="middle" align="center" scope="col" rowspan="1" colspan="1">Model</th>
            <th valign="middle" align="center" scope="col" rowspan="1" colspan="1">Nested models (null <italic>vs.</italic> alternative hypotheses)</th>
            <th valign="middle" align="center" scope="col" rowspan="1" colspan="1">No. genes under positive selection in <italic>Sk</italic> branch</th>
            <th valign="middle" align="center" scope="col" rowspan="1" colspan="1">No. genes under positive selection in <italic>Sc</italic> branch</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td valign="middle" scope="row" rowspan="1" colspan="1">Branch</td>
            <td valign="middle" align="center" rowspan="1" colspan="1">M0 <italic>vs.</italic> two-ratios</td>
            <td valign="middle" align="char" char="." rowspan="1" colspan="1">83</td>
            <td valign="middle" align="char" char="." rowspan="1" colspan="1">31</td>
          </tr>
          <tr>
            <td valign="middle" scope="row" rowspan="1" colspan="1">Branch-site</td>
            <td valign="middle" align="center" rowspan="1" colspan="1">MA<sub>null</sub>
<italic>vs.</italic> MA</td>
            <td valign="middle" align="char" char="." rowspan="1" colspan="1">137</td>
            <td valign="middle" align="char" char="." rowspan="1" colspan="1">96</td>
          </tr>
          <tr>
            <td valign="top" scope="row" rowspan="1" colspan="1">Site</td>
            <td valign="top" align="center" rowspan="1" colspan="1">M1a <italic>vs.</italic> M2a</td>
            <td valign="top" align="center" rowspan="1" colspan="1">32<sup>*1</sup></td>
            <td valign="top" align="center" rowspan="1" colspan="1">32<sup>*1</sup></td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <p>Besides, our package facilitates the running of additional models such as branch and site models. The combination of the results of the three approaches tested can provide more depth on how positive selection has been acting on the studied clade.</p>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>The computations were performed on Tirant III of the Spanish Supercomputing Network (Servei d’Informàtica of the University of Valencia).</p>
  </ack>
  <fn-group>
    <fn id="fn1">
      <p>Communicating editor: P. Morrell</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>Literature Cited</title>
    <ref id="bib1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Anisimova</surname><given-names>M.</given-names></name>, and <name name-style="western"><surname>Yang</surname><given-names>Z.</given-names></name></person-group>, <year>2007</year> <article-title>Multiple hypothesis testing to detect lineages under positive selection that affects only a few sites.</article-title><source>Mol. Biol. Evol.</source><volume>24</volume>: <fpage>1219</fpage>–<lpage>1228</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/msm042</pub-id><pub-id pub-id-type="pmid">17339634</pub-id></mixed-citation>
    </ref>
    <ref id="bib2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Byrne</surname><given-names>K. P.</given-names></name>, and <name name-style="western"><surname>Wolfe</surname><given-names>K. H.</given-names></name></person-group>, <year>2005</year> <article-title>The Yeast Gene Order Browser: combining curated homology and syntenic context reveals gene fate in polyploid species.</article-title><source>Genome Res.</source><volume>15</volume>: <fpage>1456</fpage>–<lpage>1461</lpage>. <pub-id pub-id-type="doi">10.1101/gr.3672305</pub-id><pub-id pub-id-type="pmid">16169922</pub-id></mixed-citation>
    </ref>
    <ref id="bib3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Castresana</surname><given-names>J.</given-names></name></person-group>, <year>2007</year> <article-title>Topological variation in single-gene phylogenetic trees.</article-title><source>Genome Biol.</source><volume>8</volume>: <fpage>216</fpage><pub-id pub-id-type="doi">10.1186/gb-2007-8-6-216</pub-id><pub-id pub-id-type="pmid">17567929</pub-id></mixed-citation>
    </ref>
    <ref id="bib4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Delport</surname><given-names>W.</given-names></name>, <name name-style="western"><surname>Poon</surname><given-names>A. F. Y.</given-names></name>, <name name-style="western"><surname>Frost</surname><given-names>S. D. W.</given-names></name>, and <name name-style="western"><surname>Kosakovsky Pond</surname><given-names>S. L.</given-names></name></person-group>, <year>2010</year> <article-title>Datamonkey 2010: A suite of phylogenetic analysis tools for evolutionary biology.</article-title><source>Bioinformatics</source><volume>26</volume>: <fpage>2455</fpage>–<lpage>2457</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btq429</pub-id><pub-id pub-id-type="pmid">20671151</pub-id></mixed-citation>
    </ref>
    <ref id="bib5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Goldman</surname><given-names>N.</given-names></name>, and <name name-style="western"><surname>Yang</surname><given-names>Z.</given-names></name></person-group>, <year>1994</year> <article-title>A codon-based model of nucleotide substitution for protein-coding DNA sequences.</article-title><source>Mol. Biol. Evol.</source><volume>11</volume>: <fpage>725</fpage>–<lpage>736</lpage>. <pub-id pub-id-type="doi">10.1093/oxfordjournals.molbev.a040153</pub-id><pub-id pub-id-type="pmid">7968486</pub-id></mixed-citation>
    </ref>
    <ref id="bib6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Goodswen</surname><given-names>S. J.</given-names></name>, <name name-style="western"><surname>Kennedy</surname><given-names>P. J.</given-names></name>, and <name name-style="western"><surname>Ellis</surname><given-names>J. T.</given-names></name></person-group>, <year>2018</year> <article-title>A gene-based positive selection detection approach to identify vaccine candidates using Toxoplasma gondii as a test case protozoan pathogen.</article-title><source>Front. Genet.</source><volume>9</volume>: <fpage>332</fpage><pub-id pub-id-type="doi">10.3389/fgene.2018.00332</pub-id><pub-id pub-id-type="pmid">30177953</pub-id></mixed-citation>
    </ref>
    <ref id="bib7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hongo</surname><given-names>J. A.</given-names></name>, <name name-style="western"><surname>de Castro</surname><given-names>G. M.</given-names></name>, <name name-style="western"><surname>Cintra</surname><given-names>L. C.</given-names></name>, <name name-style="western"><surname>Zerlotini</surname><given-names>A.</given-names></name>, and <name name-style="western"><surname>Lobo</surname><given-names>F. P.</given-names></name></person-group>, <year>2015</year> <article-title>POTION: An end-to-end pipeline for positive Darwinian selection detection in genome-scale data through phylogenetic comparison of protein-coding genes.</article-title><source>BMC Genomics</source><volume>16</volume>: <fpage>567</fpage><pub-id pub-id-type="doi">10.1186/s12864-015-1765-0</pub-id><pub-id pub-id-type="pmid">26231214</pub-id></mixed-citation>
    </ref>
    <ref id="bib8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jeffroy</surname><given-names>O.</given-names></name>, <name name-style="western"><surname>Brinkmann</surname><given-names>H.</given-names></name>, <name name-style="western"><surname>Delsuc</surname><given-names>F.</given-names></name>, and <name name-style="western"><surname>Philippe</surname><given-names>H.</given-names></name></person-group>, <year>2006</year> <article-title>Phylogenomics: the beginning of incongruence?</article-title><source>Trends Genet.</source><volume>22</volume>: <fpage>225</fpage>–<lpage>231</lpage>. <pub-id pub-id-type="doi">10.1016/j.tig.2006.02.003</pub-id><pub-id pub-id-type="pmid">16490279</pub-id></mixed-citation>
    </ref>
    <ref id="bib9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Macías</surname><given-names>L. G.</given-names></name>, <name name-style="western"><surname>Morard</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Toft</surname><given-names>C.</given-names></name>, and <name name-style="western"><surname>Barrio</surname><given-names>E.</given-names></name></person-group>, <year>2019</year> <article-title>Comparative genomics between Saccharomyces kudriavzevii and S. cerevisiae applied to identify mechanisms involved in adaptation.</article-title><source>Front. Genet.</source><volume>10</volume>: <fpage>187</fpage><pub-id pub-id-type="doi">10.3389/fgene.2019.00187</pub-id><pub-id pub-id-type="pmid">30930934</pub-id></mixed-citation>
    </ref>
    <ref id="bib10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Maldonado</surname><given-names>E.</given-names></name>, <name name-style="western"><surname>Almeida</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Escalona</surname><given-names>T.</given-names></name>, <name name-style="western"><surname>Khan</surname><given-names>I.</given-names></name>, <name name-style="western"><surname>Vasconcelos</surname><given-names>V.</given-names></name><etal/></person-group>, <year>2016</year> <article-title>LMAP: Lightweight Multigene Analyses in PAML.</article-title><source>BMC Bioinformatics</source><volume>17</volume>: <fpage>354</fpage><pub-id pub-id-type="doi">10.1186/s12859-016-1204-5</pub-id><pub-id pub-id-type="pmid">27597435</pub-id></mixed-citation>
    </ref>
    <ref id="bib11">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Miller</surname><given-names>R. G. J.</given-names></name></person-group>, <year>1981</year>, pp. <fpage>67</fpage>–<lpage>70</lpage> in <source>Simultaneous statistical inference</source>, <publisher-name>Springer-Verlag</publisher-name>, <publisher-loc>New York</publisher-loc>
<pub-id pub-id-type="doi">10.1007/978-1-4613-8122-8</pub-id></mixed-citation>
    </ref>
    <ref id="bib12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Nielsen</surname><given-names>R.</given-names></name>, and <name name-style="western"><surname>Yang</surname><given-names>Z.</given-names></name></person-group>, <year>1998</year> <article-title>Likelihood models for detecting positively selected amino acid sites and applications to the HIV-1 envelope gene.</article-title><source>Genetics</source><volume>148</volume>: <fpage>929</fpage>–<lpage>936</lpage>.<pub-id pub-id-type="pmid">9539414</pub-id></mixed-citation>
    </ref>
    <ref id="bib13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Price</surname><given-names>M. N.</given-names></name>, <name name-style="western"><surname>Dehal</surname><given-names>P. S.</given-names></name>, and <name name-style="western"><surname>Arkin</surname><given-names>A. P.</given-names></name></person-group>, <year>2010</year> <article-title>FastTree 2–Approximately Maximum-Likelihood Trees for Large Alignments.</article-title><source>PLoS One</source><volume>5</volume>: <fpage>e9490</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0009490</pub-id><pub-id pub-id-type="pmid">20224823</pub-id></mixed-citation>
    </ref>
    <ref id="bib14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rokas</surname><given-names>A.</given-names></name>, and <name name-style="western"><surname>Carroll</surname><given-names>S. B.</given-names></name></person-group>, <year>2006</year> <article-title>Bushes in the tree of life.</article-title><source>PLoS Biol.</source><volume>4</volume>: <fpage>e352</fpage><pub-id pub-id-type="doi">10.1371/journal.pbio.0040352</pub-id><pub-id pub-id-type="pmid">17105342</pub-id></mixed-citation>
    </ref>
    <ref id="bib15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sahm</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Bens</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Platzer</surname><given-names>M.</given-names></name>, and <name name-style="western"><surname>Szafranski</surname><given-names>K.</given-names></name></person-group>, <year>2017</year> <article-title>PosiGene: Automated and easy-to-use pipeline for genome-wide detection of positively selected genes.</article-title><source>Nucleic Acids Res.</source><volume>45</volume>: <fpage>e100</fpage><pub-id pub-id-type="doi">10.1093/nar/gkx179</pub-id><pub-id pub-id-type="pmid">28334822</pub-id></mixed-citation>
    </ref>
    <ref id="bib16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Steinway</surname><given-names>S. N.</given-names></name>, <name name-style="western"><surname>Dannenfelser</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Laucius</surname><given-names>C. D.</given-names></name>, <name name-style="western"><surname>Hayes</surname><given-names>J. E.</given-names></name>, and <name name-style="western"><surname>Nayak</surname><given-names>S.</given-names></name></person-group>, <year>2010</year> <article-title>JCoDA: A tool for detecting evolutionary selection.</article-title><source>BMC Bioinformatics</source><volume>11</volume>: <fpage>284</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-11-284</pub-id><pub-id pub-id-type="pmid">20507581</pub-id></mixed-citation>
    </ref>
    <ref id="bib17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Stern</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Doron-Faigenboim</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Erez</surname><given-names>E.</given-names></name>, <name name-style="western"><surname>Martz</surname><given-names>E.</given-names></name>, <name name-style="western"><surname>Bacharach</surname><given-names>E.</given-names></name><etal/></person-group>, <year>2007</year> <article-title>Selecton 2007: Advanced models for detecting positive and purifying selection using a Bayesian inference approach.</article-title><source>Nucleic Acids Res.</source><volume>35</volume>: <fpage>W506</fpage>–<lpage>W511</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkm382</pub-id><pub-id pub-id-type="pmid">17586822</pub-id></mixed-citation>
    </ref>
    <ref id="bib18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Xu</surname><given-names>B.</given-names></name>, and <name name-style="western"><surname>Yang</surname><given-names>Z.</given-names></name></person-group>, <year>2013</year> <article-title>PamlX: A graphical user interface for PAML.</article-title><source>Mol. Biol. Evol.</source><volume>30</volume>: <fpage>2723</fpage>–<lpage>2724</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/mst179</pub-id><pub-id pub-id-type="pmid">24105918</pub-id></mixed-citation>
    </ref>
    <ref id="bib19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yang</surname><given-names>Z.</given-names></name></person-group>, <year>1998</year> <article-title>Likelihood ratio tests for detecting positive selection and application to primate lysozyme evolution.</article-title><source>Mol. Biol. Evol.</source><volume>15</volume>: <fpage>568</fpage>–<lpage>573</lpage>. <pub-id pub-id-type="doi">10.1093/oxfordjournals.molbev.a025957</pub-id><pub-id pub-id-type="pmid">9580986</pub-id></mixed-citation>
    </ref>
    <ref id="bib20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yang</surname><given-names>Z.</given-names></name></person-group>, <year>2000</year> <article-title>Maximum likelihood estimation on large phylogenies and analysis of adaptive evolution in human influenza virus A.</article-title><source>J. Mol. Evol.</source><volume>51</volume>: <fpage>423</fpage>–<lpage>432</lpage>. <pub-id pub-id-type="doi">10.1007/s002390010105</pub-id><pub-id pub-id-type="pmid">11080365</pub-id></mixed-citation>
    </ref>
    <ref id="bib21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yang</surname><given-names>Z.</given-names></name></person-group>, <year>2007</year> <article-title>PAML 4: Phylogenetic Analysis by Maximum Likelihood.</article-title><source>Mol. Biol. Evol.</source><volume>24</volume>: <fpage>1586</fpage>–<lpage>1591</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/msm088</pub-id><pub-id pub-id-type="pmid">17483113</pub-id></mixed-citation>
    </ref>
    <ref id="bib22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yang</surname><given-names>Z.</given-names></name>, and <name name-style="western"><surname>Nielsen</surname><given-names>R.</given-names></name></person-group>, <year>1998</year> <article-title>Synonymous and nonsynonymous rate variation in nuclear genes of mammals.</article-title><source>J. Mol. Evol.</source><volume>46</volume>: <fpage>409</fpage>–<lpage>418</lpage>. <pub-id pub-id-type="doi">10.1007/PL00006320</pub-id><pub-id pub-id-type="pmid">9541535</pub-id></mixed-citation>
    </ref>
    <ref id="bib23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yang</surname><given-names>Z.</given-names></name>, <name name-style="western"><surname>Wong</surname><given-names>W. S. W.</given-names></name>, and <name name-style="western"><surname>Nielsen</surname><given-names>R.</given-names></name></person-group>, <year>2005</year> <article-title>Bayes Empirical Bayes Inference of Amino Acid Sites Under Positive Selection.</article-title><source>Mol. Biol. Evol.</source><volume>22</volume>: <fpage>1107</fpage>–<lpage>1118</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/msi097</pub-id><pub-id pub-id-type="pmid">15689528</pub-id></mixed-citation>
    </ref>
    <ref id="bib24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhang</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Nielsen</surname><given-names>R.</given-names></name>, and <name name-style="western"><surname>Yang</surname><given-names>Z.</given-names></name></person-group>, <year>2005</year> <article-title>Evaluation of an improved branch-site likelihood method for detecting positive selection at the molecular level.</article-title><source>Mol. Biol. Evol.</source><volume>22</volume>: <fpage>2472</fpage>–<lpage>2479</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/msi237</pub-id><pub-id pub-id-type="pmid">16107592</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
